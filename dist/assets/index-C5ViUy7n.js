(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();function sb(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var yS={exports:{}},Cp={},_S={exports:{}},Wt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Uf=Symbol.for("react.element"),ab=Symbol.for("react.portal"),ob=Symbol.for("react.fragment"),lb=Symbol.for("react.strict_mode"),cb=Symbol.for("react.profiler"),ub=Symbol.for("react.provider"),db=Symbol.for("react.context"),fb=Symbol.for("react.forward_ref"),hb=Symbol.for("react.suspense"),pb=Symbol.for("react.memo"),gb=Symbol.for("react.lazy"),Dy=Symbol.iterator;function mb(t){return t===null||typeof t!="object"?null:(t=Dy&&t[Dy]||t["@@iterator"],typeof t=="function"?t:null)}var ES={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},SS=Object.assign,wS={};function Ru(t,e,r){this.props=t,this.context=e,this.refs=wS,this.updater=r||ES}Ru.prototype.isReactComponent={};Ru.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Ru.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function TS(){}TS.prototype=Ru.prototype;function Gx(t,e,r){this.props=t,this.context=e,this.refs=wS,this.updater=r||ES}var Kx=Gx.prototype=new TS;Kx.constructor=Gx;SS(Kx,Ru.prototype);Kx.isPureReactComponent=!0;var Py=Array.isArray,AS=Object.prototype.hasOwnProperty,Yx={current:null},CS={key:!0,ref:!0,__self:!0,__source:!0};function kS(t,e,r){var n,i={},s=null,a=null;if(e!=null)for(n in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(s=""+e.key),e)AS.call(e,n)&&!CS.hasOwnProperty(n)&&(i[n]=e[n]);var o=arguments.length-2;if(o===1)i.children=r;else if(1<o){for(var l=Array(o),u=0;u<o;u++)l[u]=arguments[u+2];i.children=l}if(t&&t.defaultProps)for(n in o=t.defaultProps,o)i[n]===void 0&&(i[n]=o[n]);return{$$typeof:Uf,type:t,key:s,ref:a,props:i,_owner:Yx.current}}function xb(t,e){return{$$typeof:Uf,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Xx(t){return typeof t=="object"&&t!==null&&t.$$typeof===Uf}function vb(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var Oy=/\/+/g;function mg(t,e){return typeof t=="object"&&t!==null&&t.key!=null?vb(""+t.key):e.toString(36)}function ih(t,e,r,n,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case Uf:case ab:a=!0}}if(a)return a=t,i=i(a),t=n===""?"."+mg(a,0):n,Py(i)?(r="",t!=null&&(r=t.replace(Oy,"$&/")+"/"),ih(i,e,r,"",function(u){return u})):i!=null&&(Xx(i)&&(i=xb(i,r+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(Oy,"$&/")+"/")+t)),e.push(i)),1;if(a=0,n=n===""?".":n+":",Py(t))for(var o=0;o<t.length;o++){s=t[o];var l=n+mg(s,o);a+=ih(s,e,r,l,i)}else if(l=mb(t),typeof l=="function")for(t=l.call(t),o=0;!(s=t.next()).done;)s=s.value,l=n+mg(s,o++),a+=ih(s,e,r,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function y0(t,e,r){if(t==null)return t;var n=[],i=0;return ih(t,n,"","",function(s){return e.call(r,s,i++)}),n}function yb(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Oi={current:null},sh={transition:null},_b={ReactCurrentDispatcher:Oi,ReactCurrentBatchConfig:sh,ReactCurrentOwner:Yx};function FS(){throw Error("act(...) is not supported in production builds of React.")}Wt.Children={map:y0,forEach:function(t,e,r){y0(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return y0(t,function(){e++}),e},toArray:function(t){return y0(t,function(e){return e})||[]},only:function(t){if(!Xx(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Wt.Component=Ru;Wt.Fragment=ob;Wt.Profiler=cb;Wt.PureComponent=Gx;Wt.StrictMode=lb;Wt.Suspense=hb;Wt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=_b;Wt.act=FS;Wt.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=SS({},t.props),i=t.key,s=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,a=Yx.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var o=t.type.defaultProps;for(l in e)AS.call(e,l)&&!CS.hasOwnProperty(l)&&(n[l]=e[l]===void 0&&o!==void 0?o[l]:e[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var u=0;u<l;u++)o[u]=arguments[u+2];n.children=o}return{$$typeof:Uf,type:t.type,key:i,ref:s,props:n,_owner:a}};Wt.createContext=function(t){return t={$$typeof:db,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:ub,_context:t},t.Consumer=t};Wt.createElement=kS;Wt.createFactory=function(t){var e=kS.bind(null,t);return e.type=t,e};Wt.createRef=function(){return{current:null}};Wt.forwardRef=function(t){return{$$typeof:fb,render:t}};Wt.isValidElement=Xx;Wt.lazy=function(t){return{$$typeof:gb,_payload:{_status:-1,_result:t},_init:yb}};Wt.memo=function(t,e){return{$$typeof:pb,type:t,compare:e===void 0?null:e}};Wt.startTransition=function(t){var e=sh.transition;sh.transition={};try{t()}finally{sh.transition=e}};Wt.unstable_act=FS;Wt.useCallback=function(t,e){return Oi.current.useCallback(t,e)};Wt.useContext=function(t){return Oi.current.useContext(t)};Wt.useDebugValue=function(){};Wt.useDeferredValue=function(t){return Oi.current.useDeferredValue(t)};Wt.useEffect=function(t,e){return Oi.current.useEffect(t,e)};Wt.useId=function(){return Oi.current.useId()};Wt.useImperativeHandle=function(t,e,r){return Oi.current.useImperativeHandle(t,e,r)};Wt.useInsertionEffect=function(t,e){return Oi.current.useInsertionEffect(t,e)};Wt.useLayoutEffect=function(t,e){return Oi.current.useLayoutEffect(t,e)};Wt.useMemo=function(t,e){return Oi.current.useMemo(t,e)};Wt.useReducer=function(t,e,r){return Oi.current.useReducer(t,e,r)};Wt.useRef=function(t){return Oi.current.useRef(t)};Wt.useState=function(t){return Oi.current.useState(t)};Wt.useSyncExternalStore=function(t,e,r){return Oi.current.useSyncExternalStore(t,e,r)};Wt.useTransition=function(){return Oi.current.useTransition()};Wt.version="18.3.1";_S.exports=Wt;var ye=_S.exports;const ah=sb(ye);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Eb=ye,Sb=Symbol.for("react.element"),wb=Symbol.for("react.fragment"),Tb=Object.prototype.hasOwnProperty,Ab=Eb.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Cb={key:!0,ref:!0,__self:!0,__source:!0};function bS(t,e,r){var n,i={},s=null,a=null;r!==void 0&&(s=""+r),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(a=e.ref);for(n in e)Tb.call(e,n)&&!Cb.hasOwnProperty(n)&&(i[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)i[n]===void 0&&(i[n]=e[n]);return{$$typeof:Sb,type:t,key:s,ref:a,props:i,_owner:Ab.current}}Cp.Fragment=wb;Cp.jsx=bS;Cp.jsxs=bS;yS.exports=Cp;var c=yS.exports,ym={},IS={exports:{}},xs={},NS={exports:{}},RS={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(Ce,ie){var be=Ce.length;Ce.push(ie);e:for(;0<be;){var Me=be-1>>>1,Y=Ce[Me];if(0<i(Y,ie))Ce[Me]=ie,Ce[be]=Y,be=Me;else break e}}function r(Ce){return Ce.length===0?null:Ce[0]}function n(Ce){if(Ce.length===0)return null;var ie=Ce[0],be=Ce.pop();if(be!==ie){Ce[0]=be;e:for(var Me=0,Y=Ce.length,re=Y>>>1;Me<re;){var ne=2*(Me+1)-1,X=Ce[ne],_e=ne+1,Te=Ce[_e];if(0>i(X,be))_e<Y&&0>i(Te,X)?(Ce[Me]=Te,Ce[_e]=be,Me=_e):(Ce[Me]=X,Ce[ne]=be,Me=ne);else if(_e<Y&&0>i(Te,be))Ce[Me]=Te,Ce[_e]=be,Me=_e;else break e}}return ie}function i(Ce,ie){var be=Ce.sortIndex-ie.sortIndex;return be!==0?be:Ce.id-ie.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();t.unstable_now=function(){return a.now()-o}}var l=[],u=[],f=1,p=null,g=3,m=!1,y=!1,x=!1,S=typeof setTimeout=="function"?setTimeout:null,A=typeof clearTimeout=="function"?clearTimeout:null,C=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function E(Ce){for(var ie=r(u);ie!==null;){if(ie.callback===null)n(u);else if(ie.startTime<=Ce)n(u),ie.sortIndex=ie.expirationTime,e(l,ie);else break;ie=r(u)}}function O(Ce){if(x=!1,E(Ce),!y)if(r(l)!==null)y=!0,De(Q);else{var ie=r(u);ie!==null&&ke(O,ie.startTime-Ce)}}function Q(Ce,ie){y=!1,x&&(x=!1,A(F),F=-1),m=!0;var be=g;try{for(E(ie),p=r(l);p!==null&&(!(p.expirationTime>ie)||Ce&&!D());){var Me=p.callback;if(typeof Me=="function"){p.callback=null,g=p.priorityLevel;var Y=Me(p.expirationTime<=ie);ie=t.unstable_now(),typeof Y=="function"?p.callback=Y:p===r(l)&&n(l),E(ie)}else n(l);p=r(l)}if(p!==null)var re=!0;else{var ne=r(u);ne!==null&&ke(O,ne.startTime-ie),re=!1}return re}finally{p=null,g=be,m=!1}}var H=!1,w=null,F=-1,T=5,N=-1;function D(){return!(t.unstable_now()-N<T)}function P(){if(w!==null){var Ce=t.unstable_now();N=Ce;var ie=!0;try{ie=w(!0,Ce)}finally{ie?R():(H=!1,w=null)}}else H=!1}var R;if(typeof C=="function")R=function(){C(P)};else if(typeof MessageChannel<"u"){var Xe=new MessageChannel,Se=Xe.port2;Xe.port1.onmessage=P,R=function(){Se.postMessage(null)}}else R=function(){S(P,0)};function De(Ce){w=Ce,H||(H=!0,R())}function ke(Ce,ie){F=S(function(){Ce(t.unstable_now())},ie)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Ce){Ce.callback=null},t.unstable_continueExecution=function(){y||m||(y=!0,De(Q))},t.unstable_forceFrameRate=function(Ce){0>Ce||125<Ce?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<Ce?Math.floor(1e3/Ce):5},t.unstable_getCurrentPriorityLevel=function(){return g},t.unstable_getFirstCallbackNode=function(){return r(l)},t.unstable_next=function(Ce){switch(g){case 1:case 2:case 3:var ie=3;break;default:ie=g}var be=g;g=ie;try{return Ce()}finally{g=be}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(Ce,ie){switch(Ce){case 1:case 2:case 3:case 4:case 5:break;default:Ce=3}var be=g;g=Ce;try{return ie()}finally{g=be}},t.unstable_scheduleCallback=function(Ce,ie,be){var Me=t.unstable_now();switch(typeof be=="object"&&be!==null?(be=be.delay,be=typeof be=="number"&&0<be?Me+be:Me):be=Me,Ce){case 1:var Y=-1;break;case 2:Y=250;break;case 5:Y=1073741823;break;case 4:Y=1e4;break;default:Y=5e3}return Y=be+Y,Ce={id:f++,callback:ie,priorityLevel:Ce,startTime:be,expirationTime:Y,sortIndex:-1},be>Me?(Ce.sortIndex=be,e(u,Ce),r(l)===null&&Ce===r(u)&&(x?(A(F),F=-1):x=!0,ke(O,be-Me))):(Ce.sortIndex=Y,e(l,Ce),y||m||(y=!0,De(Q))),Ce},t.unstable_shouldYield=D,t.unstable_wrapCallback=function(Ce){var ie=g;return function(){var be=g;g=ie;try{return Ce.apply(this,arguments)}finally{g=be}}}})(RS);NS.exports=RS;var kb=NS.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Fb=ye,gs=kb;function Be(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var DS=new Set,Jd={};function uc(t,e){hu(t,e),hu(t+"Capture",e)}function hu(t,e){for(Jd[t]=e,t=0;t<e.length;t++)DS.add(e[t])}var no=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),_m=Object.prototype.hasOwnProperty,bb=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,My={},By={};function Ib(t){return _m.call(By,t)?!0:_m.call(My,t)?!1:bb.test(t)?By[t]=!0:(My[t]=!0,!1)}function Nb(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function Rb(t,e,r,n){if(e===null||typeof e>"u"||Nb(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Mi(t,e,r,n,i,s,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=a}var si={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){si[t]=new Mi(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];si[e]=new Mi(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){si[t]=new Mi(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){si[t]=new Mi(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){si[t]=new Mi(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){si[t]=new Mi(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){si[t]=new Mi(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){si[t]=new Mi(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){si[t]=new Mi(t,5,!1,t.toLowerCase(),null,!1,!1)});var qx=/[\-:]([a-z])/g;function Qx(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(qx,Qx);si[e]=new Mi(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(qx,Qx);si[e]=new Mi(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(qx,Qx);si[e]=new Mi(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){si[t]=new Mi(t,1,!1,t.toLowerCase(),null,!1,!1)});si.xlinkHref=new Mi("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){si[t]=new Mi(t,1,!1,t.toLowerCase(),null,!0,!0)});function Jx(t,e,r,n){var i=si.hasOwnProperty(e)?si[e]:null;(i!==null?i.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Rb(e,r,i,n)&&(r=null),n||i===null?Ib(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):i.mustUseProperty?t[i.propertyName]=r===null?i.type===3?!1:"":r:(e=i.attributeName,n=i.attributeNamespace,r===null?t.removeAttribute(e):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var po=Fb.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,_0=Symbol.for("react.element"),Lc=Symbol.for("react.portal"),Uc=Symbol.for("react.fragment"),Zx=Symbol.for("react.strict_mode"),Em=Symbol.for("react.profiler"),PS=Symbol.for("react.provider"),OS=Symbol.for("react.context"),e1=Symbol.for("react.forward_ref"),Sm=Symbol.for("react.suspense"),wm=Symbol.for("react.suspense_list"),t1=Symbol.for("react.memo"),Bo=Symbol.for("react.lazy"),MS=Symbol.for("react.offscreen"),jy=Symbol.iterator;function sd(t){return t===null||typeof t!="object"?null:(t=jy&&t[jy]||t["@@iterator"],typeof t=="function"?t:null)}var en=Object.assign,xg;function yd(t){if(xg===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);xg=e&&e[1]||""}return`
`+xg+t}var vg=!1;function yg(t,e){if(!t||vg)return"";vg=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var n=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){n=u}t.call(e.prototype)}else{try{throw Error()}catch(u){n=u}t()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=n.stack.split(`
`),a=i.length-1,o=s.length-1;1<=a&&0<=o&&i[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(i[a]!==s[o]){if(a!==1||o!==1)do if(a--,o--,0>o||i[a]!==s[o]){var l=`
`+i[a].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=a&&0<=o);break}}}finally{vg=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?yd(t):""}function Db(t){switch(t.tag){case 5:return yd(t.type);case 16:return yd("Lazy");case 13:return yd("Suspense");case 19:return yd("SuspenseList");case 0:case 2:case 15:return t=yg(t.type,!1),t;case 11:return t=yg(t.type.render,!1),t;case 1:return t=yg(t.type,!0),t;default:return""}}function Tm(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Uc:return"Fragment";case Lc:return"Portal";case Em:return"Profiler";case Zx:return"StrictMode";case Sm:return"Suspense";case wm:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case OS:return(t.displayName||"Context")+".Consumer";case PS:return(t._context.displayName||"Context")+".Provider";case e1:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case t1:return e=t.displayName||null,e!==null?e:Tm(t.type)||"Memo";case Bo:e=t._payload,t=t._init;try{return Tm(t(e))}catch{}}return null}function Pb(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Tm(e);case 8:return e===Zx?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function ul(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function BS(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Ob(t){var e=BS(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,s=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(a){n=""+a,s.call(this,a)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(a){n=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function E0(t){t._valueTracker||(t._valueTracker=Ob(t))}function jS(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=BS(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function Ch(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Am(t,e){var r=e.checked;return en({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function Ly(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=ul(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function LS(t,e){e=e.checked,e!=null&&Jx(t,"checked",e,!1)}function Cm(t,e){LS(t,e);var r=ul(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?km(t,e.type,r):e.hasOwnProperty("defaultValue")&&km(t,e.type,ul(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Uy(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function km(t,e,r){(e!=="number"||Ch(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var _d=Array.isArray;function Zc(t,e,r,n){if(t=t.options,e){e={};for(var i=0;i<r.length;i++)e["$"+r[i]]=!0;for(r=0;r<t.length;r++)i=e.hasOwnProperty("$"+t[r].value),t[r].selected!==i&&(t[r].selected=i),i&&n&&(t[r].defaultSelected=!0)}else{for(r=""+ul(r),e=null,i=0;i<t.length;i++){if(t[i].value===r){t[i].selected=!0,n&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function Fm(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Be(91));return en({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Vy(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(Be(92));if(_d(r)){if(1<r.length)throw Error(Be(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:ul(r)}}function US(t,e){var r=ul(e.value),n=ul(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function zy(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function VS(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function bm(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?VS(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var S0,zS=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,i){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(S0=S0||document.createElement("div"),S0.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=S0.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Zd(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var Id={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Mb=["Webkit","ms","Moz","O"];Object.keys(Id).forEach(function(t){Mb.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Id[e]=Id[t]})});function WS(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||Id.hasOwnProperty(t)&&Id[t]?(""+e).trim():e+"px"}function HS(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=WS(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,i):t[r]=i}}var Bb=en({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Im(t,e){if(e){if(Bb[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Be(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Be(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Be(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Be(62))}}function Nm(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Rm=null;function r1(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Dm=null,eu=null,tu=null;function Wy(t){if(t=Wf(t)){if(typeof Dm!="function")throw Error(Be(280));var e=t.stateNode;e&&(e=Np(e),Dm(t.stateNode,t.type,e))}}function $S(t){eu?tu?tu.push(t):tu=[t]:eu=t}function GS(){if(eu){var t=eu,e=tu;if(tu=eu=null,Wy(t),e)for(t=0;t<e.length;t++)Wy(e[t])}}function KS(t,e){return t(e)}function YS(){}var _g=!1;function XS(t,e,r){if(_g)return t(e,r);_g=!0;try{return KS(t,e,r)}finally{_g=!1,(eu!==null||tu!==null)&&(YS(),GS())}}function ef(t,e){var r=t.stateNode;if(r===null)return null;var n=Np(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(Be(231,e,typeof r));return r}var Pm=!1;if(no)try{var ad={};Object.defineProperty(ad,"passive",{get:function(){Pm=!0}}),window.addEventListener("test",ad,ad),window.removeEventListener("test",ad,ad)}catch{Pm=!1}function jb(t,e,r,n,i,s,a,o,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(r,u)}catch(f){this.onError(f)}}var Nd=!1,kh=null,Fh=!1,Om=null,Lb={onError:function(t){Nd=!0,kh=t}};function Ub(t,e,r,n,i,s,a,o,l){Nd=!1,kh=null,jb.apply(Lb,arguments)}function Vb(t,e,r,n,i,s,a,o,l){if(Ub.apply(this,arguments),Nd){if(Nd){var u=kh;Nd=!1,kh=null}else throw Error(Be(198));Fh||(Fh=!0,Om=u)}}function dc(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function qS(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Hy(t){if(dc(t)!==t)throw Error(Be(188))}function zb(t){var e=t.alternate;if(!e){if(e=dc(t),e===null)throw Error(Be(188));return e!==t?null:t}for(var r=t,n=e;;){var i=r.return;if(i===null)break;var s=i.alternate;if(s===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return Hy(i),t;if(s===n)return Hy(i),e;s=s.sibling}throw Error(Be(188))}if(r.return!==n.return)r=i,n=s;else{for(var a=!1,o=i.child;o;){if(o===r){a=!0,r=i,n=s;break}if(o===n){a=!0,n=i,r=s;break}o=o.sibling}if(!a){for(o=s.child;o;){if(o===r){a=!0,r=s,n=i;break}if(o===n){a=!0,n=s,r=i;break}o=o.sibling}if(!a)throw Error(Be(189))}}if(r.alternate!==n)throw Error(Be(190))}if(r.tag!==3)throw Error(Be(188));return r.stateNode.current===r?t:e}function QS(t){return t=zb(t),t!==null?JS(t):null}function JS(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=JS(t);if(e!==null)return e;t=t.sibling}return null}var ZS=gs.unstable_scheduleCallback,$y=gs.unstable_cancelCallback,Wb=gs.unstable_shouldYield,Hb=gs.unstable_requestPaint,pn=gs.unstable_now,$b=gs.unstable_getCurrentPriorityLevel,n1=gs.unstable_ImmediatePriority,ew=gs.unstable_UserBlockingPriority,bh=gs.unstable_NormalPriority,Gb=gs.unstable_LowPriority,tw=gs.unstable_IdlePriority,kp=null,Fa=null;function Kb(t){if(Fa&&typeof Fa.onCommitFiberRoot=="function")try{Fa.onCommitFiberRoot(kp,t,void 0,(t.current.flags&128)===128)}catch{}}var ra=Math.clz32?Math.clz32:qb,Yb=Math.log,Xb=Math.LN2;function qb(t){return t>>>=0,t===0?32:31-(Yb(t)/Xb|0)|0}var w0=64,T0=4194304;function Ed(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Ih(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,i=t.suspendedLanes,s=t.pingedLanes,a=r&268435455;if(a!==0){var o=a&~i;o!==0?n=Ed(o):(s&=a,s!==0&&(n=Ed(s)))}else a=r&~i,a!==0?n=Ed(a):s!==0&&(n=Ed(s));if(n===0)return 0;if(e!==0&&e!==n&&!(e&i)&&(i=n&-n,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-ra(e),i=1<<r,n|=t[r],e&=~i;return n}function Qb(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Jb(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var a=31-ra(s),o=1<<a,l=i[a];l===-1?(!(o&r)||o&n)&&(i[a]=Qb(o,e)):l<=e&&(t.expiredLanes|=o),s&=~o}}function Mm(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function rw(){var t=w0;return w0<<=1,!(w0&4194240)&&(w0=64),t}function Eg(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function Vf(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-ra(e),t[e]=r}function Zb(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var i=31-ra(r),s=1<<i;e[i]=0,n[i]=-1,t[i]=-1,r&=~s}}function i1(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-ra(r),i=1<<n;i&e|t[n]&e&&(t[n]|=e),r&=~i}}var Er=0;function nw(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var iw,s1,sw,aw,ow,Bm=!1,A0=[],Qo=null,Jo=null,Zo=null,tf=new Map,rf=new Map,Lo=[],eI="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Gy(t,e){switch(t){case"focusin":case"focusout":Qo=null;break;case"dragenter":case"dragleave":Jo=null;break;case"mouseover":case"mouseout":Zo=null;break;case"pointerover":case"pointerout":tf.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":rf.delete(e.pointerId)}}function od(t,e,r,n,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},e!==null&&(e=Wf(e),e!==null&&s1(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function tI(t,e,r,n,i){switch(e){case"focusin":return Qo=od(Qo,t,e,r,n,i),!0;case"dragenter":return Jo=od(Jo,t,e,r,n,i),!0;case"mouseover":return Zo=od(Zo,t,e,r,n,i),!0;case"pointerover":var s=i.pointerId;return tf.set(s,od(tf.get(s)||null,t,e,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,rf.set(s,od(rf.get(s)||null,t,e,r,n,i)),!0}return!1}function lw(t){var e=Ol(t.target);if(e!==null){var r=dc(e);if(r!==null){if(e=r.tag,e===13){if(e=qS(r),e!==null){t.blockedOn=e,ow(t.priority,function(){sw(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function oh(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=jm(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);Rm=n,r.target.dispatchEvent(n),Rm=null}else return e=Wf(r),e!==null&&s1(e),t.blockedOn=r,!1;e.shift()}return!0}function Ky(t,e,r){oh(t)&&r.delete(e)}function rI(){Bm=!1,Qo!==null&&oh(Qo)&&(Qo=null),Jo!==null&&oh(Jo)&&(Jo=null),Zo!==null&&oh(Zo)&&(Zo=null),tf.forEach(Ky),rf.forEach(Ky)}function ld(t,e){t.blockedOn===e&&(t.blockedOn=null,Bm||(Bm=!0,gs.unstable_scheduleCallback(gs.unstable_NormalPriority,rI)))}function nf(t){function e(i){return ld(i,t)}if(0<A0.length){ld(A0[0],t);for(var r=1;r<A0.length;r++){var n=A0[r];n.blockedOn===t&&(n.blockedOn=null)}}for(Qo!==null&&ld(Qo,t),Jo!==null&&ld(Jo,t),Zo!==null&&ld(Zo,t),tf.forEach(e),rf.forEach(e),r=0;r<Lo.length;r++)n=Lo[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<Lo.length&&(r=Lo[0],r.blockedOn===null);)lw(r),r.blockedOn===null&&Lo.shift()}var ru=po.ReactCurrentBatchConfig,Nh=!0;function nI(t,e,r,n){var i=Er,s=ru.transition;ru.transition=null;try{Er=1,a1(t,e,r,n)}finally{Er=i,ru.transition=s}}function iI(t,e,r,n){var i=Er,s=ru.transition;ru.transition=null;try{Er=4,a1(t,e,r,n)}finally{Er=i,ru.transition=s}}function a1(t,e,r,n){if(Nh){var i=jm(t,e,r,n);if(i===null)Ng(t,e,n,Rh,r),Gy(t,n);else if(tI(i,t,e,r,n))n.stopPropagation();else if(Gy(t,n),e&4&&-1<eI.indexOf(t)){for(;i!==null;){var s=Wf(i);if(s!==null&&iw(s),s=jm(t,e,r,n),s===null&&Ng(t,e,n,Rh,r),s===i)break;i=s}i!==null&&n.stopPropagation()}else Ng(t,e,n,null,r)}}var Rh=null;function jm(t,e,r,n){if(Rh=null,t=r1(n),t=Ol(t),t!==null)if(e=dc(t),e===null)t=null;else if(r=e.tag,r===13){if(t=qS(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Rh=t,null}function cw(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch($b()){case n1:return 1;case ew:return 4;case bh:case Gb:return 16;case tw:return 536870912;default:return 16}default:return 16}}var $o=null,o1=null,lh=null;function uw(){if(lh)return lh;var t,e=o1,r=e.length,n,i="value"in $o?$o.value:$o.textContent,s=i.length;for(t=0;t<r&&e[t]===i[t];t++);var a=r-t;for(n=1;n<=a&&e[r-n]===i[s-n];n++);return lh=i.slice(t,1<n?1-n:void 0)}function ch(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function C0(){return!0}function Yy(){return!1}function vs(t){function e(r,n,i,s,a){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(r=t[o],this[o]=r?r(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?C0:Yy,this.isPropagationStopped=Yy,this}return en(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=C0)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=C0)},persist:function(){},isPersistent:C0}),e}var Du={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},l1=vs(Du),zf=en({},Du,{view:0,detail:0}),sI=vs(zf),Sg,wg,cd,Fp=en({},zf,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:c1,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==cd&&(cd&&t.type==="mousemove"?(Sg=t.screenX-cd.screenX,wg=t.screenY-cd.screenY):wg=Sg=0,cd=t),Sg)},movementY:function(t){return"movementY"in t?t.movementY:wg}}),Xy=vs(Fp),aI=en({},Fp,{dataTransfer:0}),oI=vs(aI),lI=en({},zf,{relatedTarget:0}),Tg=vs(lI),cI=en({},Du,{animationName:0,elapsedTime:0,pseudoElement:0}),uI=vs(cI),dI=en({},Du,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),fI=vs(dI),hI=en({},Du,{data:0}),qy=vs(hI),pI={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},gI={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},mI={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function xI(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=mI[t])?!!e[t]:!1}function c1(){return xI}var vI=en({},zf,{key:function(t){if(t.key){var e=pI[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=ch(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?gI[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:c1,charCode:function(t){return t.type==="keypress"?ch(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?ch(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),yI=vs(vI),_I=en({},Fp,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Qy=vs(_I),EI=en({},zf,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:c1}),SI=vs(EI),wI=en({},Du,{propertyName:0,elapsedTime:0,pseudoElement:0}),TI=vs(wI),AI=en({},Fp,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),CI=vs(AI),kI=[9,13,27,32],u1=no&&"CompositionEvent"in window,Rd=null;no&&"documentMode"in document&&(Rd=document.documentMode);var FI=no&&"TextEvent"in window&&!Rd,dw=no&&(!u1||Rd&&8<Rd&&11>=Rd),Jy=" ",Zy=!1;function fw(t,e){switch(t){case"keyup":return kI.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function hw(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Vc=!1;function bI(t,e){switch(t){case"compositionend":return hw(e);case"keypress":return e.which!==32?null:(Zy=!0,Jy);case"textInput":return t=e.data,t===Jy&&Zy?null:t;default:return null}}function II(t,e){if(Vc)return t==="compositionend"||!u1&&fw(t,e)?(t=uw(),lh=o1=$o=null,Vc=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return dw&&e.locale!=="ko"?null:e.data;default:return null}}var NI={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function e2(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!NI[t.type]:e==="textarea"}function pw(t,e,r,n){$S(n),e=Dh(e,"onChange"),0<e.length&&(r=new l1("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var Dd=null,sf=null;function RI(t){Aw(t,0)}function bp(t){var e=Hc(t);if(jS(e))return t}function DI(t,e){if(t==="change")return e}var gw=!1;if(no){var Ag;if(no){var Cg="oninput"in document;if(!Cg){var t2=document.createElement("div");t2.setAttribute("oninput","return;"),Cg=typeof t2.oninput=="function"}Ag=Cg}else Ag=!1;gw=Ag&&(!document.documentMode||9<document.documentMode)}function r2(){Dd&&(Dd.detachEvent("onpropertychange",mw),sf=Dd=null)}function mw(t){if(t.propertyName==="value"&&bp(sf)){var e=[];pw(e,sf,t,r1(t)),XS(RI,e)}}function PI(t,e,r){t==="focusin"?(r2(),Dd=e,sf=r,Dd.attachEvent("onpropertychange",mw)):t==="focusout"&&r2()}function OI(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return bp(sf)}function MI(t,e){if(t==="click")return bp(e)}function BI(t,e){if(t==="input"||t==="change")return bp(e)}function jI(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var aa=typeof Object.is=="function"?Object.is:jI;function af(t,e){if(aa(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!_m.call(e,i)||!aa(t[i],e[i]))return!1}return!0}function n2(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function i2(t,e){var r=n2(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=n2(r)}}function xw(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?xw(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function vw(){for(var t=window,e=Ch();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=Ch(t.document)}return e}function d1(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function LI(t){var e=vw(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&xw(r.ownerDocument.documentElement,r)){if(n!==null&&d1(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=r.textContent.length,s=Math.min(n.start,i);n=n.end===void 0?s:Math.min(n.end,i),!t.extend&&s>n&&(i=n,n=s,s=i),i=i2(r,s);var a=i2(r,n);i&&a&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>n?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var UI=no&&"documentMode"in document&&11>=document.documentMode,zc=null,Lm=null,Pd=null,Um=!1;function s2(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Um||zc==null||zc!==Ch(n)||(n=zc,"selectionStart"in n&&d1(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Pd&&af(Pd,n)||(Pd=n,n=Dh(Lm,"onSelect"),0<n.length&&(e=new l1("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=zc)))}function k0(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var Wc={animationend:k0("Animation","AnimationEnd"),animationiteration:k0("Animation","AnimationIteration"),animationstart:k0("Animation","AnimationStart"),transitionend:k0("Transition","TransitionEnd")},kg={},yw={};no&&(yw=document.createElement("div").style,"AnimationEvent"in window||(delete Wc.animationend.animation,delete Wc.animationiteration.animation,delete Wc.animationstart.animation),"TransitionEvent"in window||delete Wc.transitionend.transition);function Ip(t){if(kg[t])return kg[t];if(!Wc[t])return t;var e=Wc[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in yw)return kg[t]=e[r];return t}var _w=Ip("animationend"),Ew=Ip("animationiteration"),Sw=Ip("animationstart"),ww=Ip("transitionend"),Tw=new Map,a2="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function yl(t,e){Tw.set(t,e),uc(e,[t])}for(var Fg=0;Fg<a2.length;Fg++){var bg=a2[Fg],VI=bg.toLowerCase(),zI=bg[0].toUpperCase()+bg.slice(1);yl(VI,"on"+zI)}yl(_w,"onAnimationEnd");yl(Ew,"onAnimationIteration");yl(Sw,"onAnimationStart");yl("dblclick","onDoubleClick");yl("focusin","onFocus");yl("focusout","onBlur");yl(ww,"onTransitionEnd");hu("onMouseEnter",["mouseout","mouseover"]);hu("onMouseLeave",["mouseout","mouseover"]);hu("onPointerEnter",["pointerout","pointerover"]);hu("onPointerLeave",["pointerout","pointerover"]);uc("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));uc("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));uc("onBeforeInput",["compositionend","keypress","textInput","paste"]);uc("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));uc("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));uc("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Sd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),WI=new Set("cancel close invalid load scroll toggle".split(" ").concat(Sd));function o2(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,Vb(n,e,void 0,t),t.currentTarget=null}function Aw(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],i=n.event;n=n.listeners;e:{var s=void 0;if(e)for(var a=n.length-1;0<=a;a--){var o=n[a],l=o.instance,u=o.currentTarget;if(o=o.listener,l!==s&&i.isPropagationStopped())break e;o2(i,o,u),s=l}else for(a=0;a<n.length;a++){if(o=n[a],l=o.instance,u=o.currentTarget,o=o.listener,l!==s&&i.isPropagationStopped())break e;o2(i,o,u),s=l}}}if(Fh)throw t=Om,Fh=!1,Om=null,t}function Pr(t,e){var r=e[$m];r===void 0&&(r=e[$m]=new Set);var n=t+"__bubble";r.has(n)||(Cw(e,t,2,!1),r.add(n))}function Ig(t,e,r){var n=0;e&&(n|=4),Cw(r,t,n,e)}var F0="_reactListening"+Math.random().toString(36).slice(2);function of(t){if(!t[F0]){t[F0]=!0,DS.forEach(function(r){r!=="selectionchange"&&(WI.has(r)||Ig(r,!1,t),Ig(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[F0]||(e[F0]=!0,Ig("selectionchange",!1,e))}}function Cw(t,e,r,n){switch(cw(e)){case 1:var i=nI;break;case 4:i=iI;break;default:i=a1}r=i.bind(null,e,r,t),i=void 0,!Pm||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),n?i!==void 0?t.addEventListener(e,r,{capture:!0,passive:i}):t.addEventListener(e,r,!0):i!==void 0?t.addEventListener(e,r,{passive:i}):t.addEventListener(e,r,!1)}function Ng(t,e,r,n,i){var s=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var a=n.tag;if(a===3||a===4){var o=n.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(a===4)for(a=n.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;a=a.return}for(;o!==null;){if(a=Ol(o),a===null)return;if(l=a.tag,l===5||l===6){n=s=a;continue e}o=o.parentNode}}n=n.return}XS(function(){var u=s,f=r1(r),p=[];e:{var g=Tw.get(t);if(g!==void 0){var m=l1,y=t;switch(t){case"keypress":if(ch(r)===0)break e;case"keydown":case"keyup":m=yI;break;case"focusin":y="focus",m=Tg;break;case"focusout":y="blur",m=Tg;break;case"beforeblur":case"afterblur":m=Tg;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=Xy;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=oI;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=SI;break;case _w:case Ew:case Sw:m=uI;break;case ww:m=TI;break;case"scroll":m=sI;break;case"wheel":m=CI;break;case"copy":case"cut":case"paste":m=fI;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=Qy}var x=(e&4)!==0,S=!x&&t==="scroll",A=x?g!==null?g+"Capture":null:g;x=[];for(var C=u,E;C!==null;){E=C;var O=E.stateNode;if(E.tag===5&&O!==null&&(E=O,A!==null&&(O=ef(C,A),O!=null&&x.push(lf(C,O,E)))),S)break;C=C.return}0<x.length&&(g=new m(g,y,null,r,f),p.push({event:g,listeners:x}))}}if(!(e&7)){e:{if(g=t==="mouseover"||t==="pointerover",m=t==="mouseout"||t==="pointerout",g&&r!==Rm&&(y=r.relatedTarget||r.fromElement)&&(Ol(y)||y[io]))break e;if((m||g)&&(g=f.window===f?f:(g=f.ownerDocument)?g.defaultView||g.parentWindow:window,m?(y=r.relatedTarget||r.toElement,m=u,y=y?Ol(y):null,y!==null&&(S=dc(y),y!==S||y.tag!==5&&y.tag!==6)&&(y=null)):(m=null,y=u),m!==y)){if(x=Xy,O="onMouseLeave",A="onMouseEnter",C="mouse",(t==="pointerout"||t==="pointerover")&&(x=Qy,O="onPointerLeave",A="onPointerEnter",C="pointer"),S=m==null?g:Hc(m),E=y==null?g:Hc(y),g=new x(O,C+"leave",m,r,f),g.target=S,g.relatedTarget=E,O=null,Ol(f)===u&&(x=new x(A,C+"enter",y,r,f),x.target=E,x.relatedTarget=S,O=x),S=O,m&&y)t:{for(x=m,A=y,C=0,E=x;E;E=bc(E))C++;for(E=0,O=A;O;O=bc(O))E++;for(;0<C-E;)x=bc(x),C--;for(;0<E-C;)A=bc(A),E--;for(;C--;){if(x===A||A!==null&&x===A.alternate)break t;x=bc(x),A=bc(A)}x=null}else x=null;m!==null&&l2(p,g,m,x,!1),y!==null&&S!==null&&l2(p,S,y,x,!0)}}e:{if(g=u?Hc(u):window,m=g.nodeName&&g.nodeName.toLowerCase(),m==="select"||m==="input"&&g.type==="file")var Q=DI;else if(e2(g))if(gw)Q=BI;else{Q=OI;var H=PI}else(m=g.nodeName)&&m.toLowerCase()==="input"&&(g.type==="checkbox"||g.type==="radio")&&(Q=MI);if(Q&&(Q=Q(t,u))){pw(p,Q,r,f);break e}H&&H(t,g,u),t==="focusout"&&(H=g._wrapperState)&&H.controlled&&g.type==="number"&&km(g,"number",g.value)}switch(H=u?Hc(u):window,t){case"focusin":(e2(H)||H.contentEditable==="true")&&(zc=H,Lm=u,Pd=null);break;case"focusout":Pd=Lm=zc=null;break;case"mousedown":Um=!0;break;case"contextmenu":case"mouseup":case"dragend":Um=!1,s2(p,r,f);break;case"selectionchange":if(UI)break;case"keydown":case"keyup":s2(p,r,f)}var w;if(u1)e:{switch(t){case"compositionstart":var F="onCompositionStart";break e;case"compositionend":F="onCompositionEnd";break e;case"compositionupdate":F="onCompositionUpdate";break e}F=void 0}else Vc?fw(t,r)&&(F="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(F="onCompositionStart");F&&(dw&&r.locale!=="ko"&&(Vc||F!=="onCompositionStart"?F==="onCompositionEnd"&&Vc&&(w=uw()):($o=f,o1="value"in $o?$o.value:$o.textContent,Vc=!0)),H=Dh(u,F),0<H.length&&(F=new qy(F,t,null,r,f),p.push({event:F,listeners:H}),w?F.data=w:(w=hw(r),w!==null&&(F.data=w)))),(w=FI?bI(t,r):II(t,r))&&(u=Dh(u,"onBeforeInput"),0<u.length&&(f=new qy("onBeforeInput","beforeinput",null,r,f),p.push({event:f,listeners:u}),f.data=w))}Aw(p,e)})}function lf(t,e,r){return{instance:t,listener:e,currentTarget:r}}function Dh(t,e){for(var r=e+"Capture",n=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=ef(t,r),s!=null&&n.unshift(lf(t,s,i)),s=ef(t,e),s!=null&&n.push(lf(t,s,i))),t=t.return}return n}function bc(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function l2(t,e,r,n,i){for(var s=e._reactName,a=[];r!==null&&r!==n;){var o=r,l=o.alternate,u=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&u!==null&&(o=u,i?(l=ef(r,s),l!=null&&a.unshift(lf(r,l,o))):i||(l=ef(r,s),l!=null&&a.push(lf(r,l,o)))),r=r.return}a.length!==0&&t.push({event:e,listeners:a})}var HI=/\r\n?/g,$I=/\u0000|\uFFFD/g;function c2(t){return(typeof t=="string"?t:""+t).replace(HI,`
`).replace($I,"")}function b0(t,e,r){if(e=c2(e),c2(t)!==e&&r)throw Error(Be(425))}function Ph(){}var Vm=null,zm=null;function Wm(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Hm=typeof setTimeout=="function"?setTimeout:void 0,GI=typeof clearTimeout=="function"?clearTimeout:void 0,u2=typeof Promise=="function"?Promise:void 0,KI=typeof queueMicrotask=="function"?queueMicrotask:typeof u2<"u"?function(t){return u2.resolve(null).then(t).catch(YI)}:Hm;function YI(t){setTimeout(function(){throw t})}function Rg(t,e){var r=e,n=0;do{var i=r.nextSibling;if(t.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){t.removeChild(i),nf(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);nf(e)}function el(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function d2(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var Pu=Math.random().toString(36).slice(2),Ca="__reactFiber$"+Pu,cf="__reactProps$"+Pu,io="__reactContainer$"+Pu,$m="__reactEvents$"+Pu,XI="__reactListeners$"+Pu,qI="__reactHandles$"+Pu;function Ol(t){var e=t[Ca];if(e)return e;for(var r=t.parentNode;r;){if(e=r[io]||r[Ca]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=d2(t);t!==null;){if(r=t[Ca])return r;t=d2(t)}return e}t=r,r=t.parentNode}return null}function Wf(t){return t=t[Ca]||t[io],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Hc(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Be(33))}function Np(t){return t[cf]||null}var Gm=[],$c=-1;function _l(t){return{current:t}}function Mr(t){0>$c||(t.current=Gm[$c],Gm[$c]=null,$c--)}function Ir(t,e){$c++,Gm[$c]=t.current,t.current=e}var dl={},Ei=_l(dl),Xi=_l(!1),Yl=dl;function pu(t,e){var r=t.type.contextTypes;if(!r)return dl;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in r)i[s]=e[s];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function qi(t){return t=t.childContextTypes,t!=null}function Oh(){Mr(Xi),Mr(Ei)}function f2(t,e,r){if(Ei.current!==dl)throw Error(Be(168));Ir(Ei,e),Ir(Xi,r)}function kw(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in e))throw Error(Be(108,Pb(t)||"Unknown",i));return en({},r,n)}function Mh(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||dl,Yl=Ei.current,Ir(Ei,t),Ir(Xi,Xi.current),!0}function h2(t,e,r){var n=t.stateNode;if(!n)throw Error(Be(169));r?(t=kw(t,e,Yl),n.__reactInternalMemoizedMergedChildContext=t,Mr(Xi),Mr(Ei),Ir(Ei,t)):Mr(Xi),Ir(Xi,r)}var $a=null,Rp=!1,Dg=!1;function Fw(t){$a===null?$a=[t]:$a.push(t)}function QI(t){Rp=!0,Fw(t)}function El(){if(!Dg&&$a!==null){Dg=!0;var t=0,e=Er;try{var r=$a;for(Er=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}$a=null,Rp=!1}catch(i){throw $a!==null&&($a=$a.slice(t+1)),ZS(n1,El),i}finally{Er=e,Dg=!1}}return null}var Gc=[],Kc=0,Bh=null,jh=0,Ns=[],Rs=0,Xl=null,Ga=1,Ka="";function Il(t,e){Gc[Kc++]=jh,Gc[Kc++]=Bh,Bh=t,jh=e}function bw(t,e,r){Ns[Rs++]=Ga,Ns[Rs++]=Ka,Ns[Rs++]=Xl,Xl=t;var n=Ga;t=Ka;var i=32-ra(n)-1;n&=~(1<<i),r+=1;var s=32-ra(e)+i;if(30<s){var a=i-i%5;s=(n&(1<<a)-1).toString(32),n>>=a,i-=a,Ga=1<<32-ra(e)+i|r<<i|n,Ka=s+t}else Ga=1<<s|r<<i|n,Ka=t}function f1(t){t.return!==null&&(Il(t,1),bw(t,1,0))}function h1(t){for(;t===Bh;)Bh=Gc[--Kc],Gc[Kc]=null,jh=Gc[--Kc],Gc[Kc]=null;for(;t===Xl;)Xl=Ns[--Rs],Ns[Rs]=null,Ka=Ns[--Rs],Ns[Rs]=null,Ga=Ns[--Rs],Ns[Rs]=null}var hs=null,fs=null,$r=!1,Js=null;function Iw(t,e){var r=Ps(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function p2(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,hs=t,fs=el(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,hs=t,fs=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=Xl!==null?{id:Ga,overflow:Ka}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=Ps(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,hs=t,fs=null,!0):!1;default:return!1}}function Km(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Ym(t){if($r){var e=fs;if(e){var r=e;if(!p2(t,e)){if(Km(t))throw Error(Be(418));e=el(r.nextSibling);var n=hs;e&&p2(t,e)?Iw(n,r):(t.flags=t.flags&-4097|2,$r=!1,hs=t)}}else{if(Km(t))throw Error(Be(418));t.flags=t.flags&-4097|2,$r=!1,hs=t}}}function g2(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;hs=t}function I0(t){if(t!==hs)return!1;if(!$r)return g2(t),$r=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Wm(t.type,t.memoizedProps)),e&&(e=fs)){if(Km(t))throw Nw(),Error(Be(418));for(;e;)Iw(t,e),e=el(e.nextSibling)}if(g2(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Be(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){fs=el(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}fs=null}}else fs=hs?el(t.stateNode.nextSibling):null;return!0}function Nw(){for(var t=fs;t;)t=el(t.nextSibling)}function gu(){fs=hs=null,$r=!1}function p1(t){Js===null?Js=[t]:Js.push(t)}var JI=po.ReactCurrentBatchConfig;function ud(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Be(309));var n=r.stateNode}if(!n)throw Error(Be(147,t));var i=n,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(a){var o=i.refs;a===null?delete o[s]:o[s]=a},e._stringRef=s,e)}if(typeof t!="string")throw Error(Be(284));if(!r._owner)throw Error(Be(290,t))}return t}function N0(t,e){throw t=Object.prototype.toString.call(e),Error(Be(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function m2(t){var e=t._init;return e(t._payload)}function Rw(t){function e(A,C){if(t){var E=A.deletions;E===null?(A.deletions=[C],A.flags|=16):E.push(C)}}function r(A,C){if(!t)return null;for(;C!==null;)e(A,C),C=C.sibling;return null}function n(A,C){for(A=new Map;C!==null;)C.key!==null?A.set(C.key,C):A.set(C.index,C),C=C.sibling;return A}function i(A,C){return A=il(A,C),A.index=0,A.sibling=null,A}function s(A,C,E){return A.index=E,t?(E=A.alternate,E!==null?(E=E.index,E<C?(A.flags|=2,C):E):(A.flags|=2,C)):(A.flags|=1048576,C)}function a(A){return t&&A.alternate===null&&(A.flags|=2),A}function o(A,C,E,O){return C===null||C.tag!==6?(C=Ug(E,A.mode,O),C.return=A,C):(C=i(C,E),C.return=A,C)}function l(A,C,E,O){var Q=E.type;return Q===Uc?f(A,C,E.props.children,O,E.key):C!==null&&(C.elementType===Q||typeof Q=="object"&&Q!==null&&Q.$$typeof===Bo&&m2(Q)===C.type)?(O=i(C,E.props),O.ref=ud(A,C,E),O.return=A,O):(O=mh(E.type,E.key,E.props,null,A.mode,O),O.ref=ud(A,C,E),O.return=A,O)}function u(A,C,E,O){return C===null||C.tag!==4||C.stateNode.containerInfo!==E.containerInfo||C.stateNode.implementation!==E.implementation?(C=Vg(E,A.mode,O),C.return=A,C):(C=i(C,E.children||[]),C.return=A,C)}function f(A,C,E,O,Q){return C===null||C.tag!==7?(C=Vl(E,A.mode,O,Q),C.return=A,C):(C=i(C,E),C.return=A,C)}function p(A,C,E){if(typeof C=="string"&&C!==""||typeof C=="number")return C=Ug(""+C,A.mode,E),C.return=A,C;if(typeof C=="object"&&C!==null){switch(C.$$typeof){case _0:return E=mh(C.type,C.key,C.props,null,A.mode,E),E.ref=ud(A,null,C),E.return=A,E;case Lc:return C=Vg(C,A.mode,E),C.return=A,C;case Bo:var O=C._init;return p(A,O(C._payload),E)}if(_d(C)||sd(C))return C=Vl(C,A.mode,E,null),C.return=A,C;N0(A,C)}return null}function g(A,C,E,O){var Q=C!==null?C.key:null;if(typeof E=="string"&&E!==""||typeof E=="number")return Q!==null?null:o(A,C,""+E,O);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case _0:return E.key===Q?l(A,C,E,O):null;case Lc:return E.key===Q?u(A,C,E,O):null;case Bo:return Q=E._init,g(A,C,Q(E._payload),O)}if(_d(E)||sd(E))return Q!==null?null:f(A,C,E,O,null);N0(A,E)}return null}function m(A,C,E,O,Q){if(typeof O=="string"&&O!==""||typeof O=="number")return A=A.get(E)||null,o(C,A,""+O,Q);if(typeof O=="object"&&O!==null){switch(O.$$typeof){case _0:return A=A.get(O.key===null?E:O.key)||null,l(C,A,O,Q);case Lc:return A=A.get(O.key===null?E:O.key)||null,u(C,A,O,Q);case Bo:var H=O._init;return m(A,C,E,H(O._payload),Q)}if(_d(O)||sd(O))return A=A.get(E)||null,f(C,A,O,Q,null);N0(C,O)}return null}function y(A,C,E,O){for(var Q=null,H=null,w=C,F=C=0,T=null;w!==null&&F<E.length;F++){w.index>F?(T=w,w=null):T=w.sibling;var N=g(A,w,E[F],O);if(N===null){w===null&&(w=T);break}t&&w&&N.alternate===null&&e(A,w),C=s(N,C,F),H===null?Q=N:H.sibling=N,H=N,w=T}if(F===E.length)return r(A,w),$r&&Il(A,F),Q;if(w===null){for(;F<E.length;F++)w=p(A,E[F],O),w!==null&&(C=s(w,C,F),H===null?Q=w:H.sibling=w,H=w);return $r&&Il(A,F),Q}for(w=n(A,w);F<E.length;F++)T=m(w,A,F,E[F],O),T!==null&&(t&&T.alternate!==null&&w.delete(T.key===null?F:T.key),C=s(T,C,F),H===null?Q=T:H.sibling=T,H=T);return t&&w.forEach(function(D){return e(A,D)}),$r&&Il(A,F),Q}function x(A,C,E,O){var Q=sd(E);if(typeof Q!="function")throw Error(Be(150));if(E=Q.call(E),E==null)throw Error(Be(151));for(var H=Q=null,w=C,F=C=0,T=null,N=E.next();w!==null&&!N.done;F++,N=E.next()){w.index>F?(T=w,w=null):T=w.sibling;var D=g(A,w,N.value,O);if(D===null){w===null&&(w=T);break}t&&w&&D.alternate===null&&e(A,w),C=s(D,C,F),H===null?Q=D:H.sibling=D,H=D,w=T}if(N.done)return r(A,w),$r&&Il(A,F),Q;if(w===null){for(;!N.done;F++,N=E.next())N=p(A,N.value,O),N!==null&&(C=s(N,C,F),H===null?Q=N:H.sibling=N,H=N);return $r&&Il(A,F),Q}for(w=n(A,w);!N.done;F++,N=E.next())N=m(w,A,F,N.value,O),N!==null&&(t&&N.alternate!==null&&w.delete(N.key===null?F:N.key),C=s(N,C,F),H===null?Q=N:H.sibling=N,H=N);return t&&w.forEach(function(P){return e(A,P)}),$r&&Il(A,F),Q}function S(A,C,E,O){if(typeof E=="object"&&E!==null&&E.type===Uc&&E.key===null&&(E=E.props.children),typeof E=="object"&&E!==null){switch(E.$$typeof){case _0:e:{for(var Q=E.key,H=C;H!==null;){if(H.key===Q){if(Q=E.type,Q===Uc){if(H.tag===7){r(A,H.sibling),C=i(H,E.props.children),C.return=A,A=C;break e}}else if(H.elementType===Q||typeof Q=="object"&&Q!==null&&Q.$$typeof===Bo&&m2(Q)===H.type){r(A,H.sibling),C=i(H,E.props),C.ref=ud(A,H,E),C.return=A,A=C;break e}r(A,H);break}else e(A,H);H=H.sibling}E.type===Uc?(C=Vl(E.props.children,A.mode,O,E.key),C.return=A,A=C):(O=mh(E.type,E.key,E.props,null,A.mode,O),O.ref=ud(A,C,E),O.return=A,A=O)}return a(A);case Lc:e:{for(H=E.key;C!==null;){if(C.key===H)if(C.tag===4&&C.stateNode.containerInfo===E.containerInfo&&C.stateNode.implementation===E.implementation){r(A,C.sibling),C=i(C,E.children||[]),C.return=A,A=C;break e}else{r(A,C);break}else e(A,C);C=C.sibling}C=Vg(E,A.mode,O),C.return=A,A=C}return a(A);case Bo:return H=E._init,S(A,C,H(E._payload),O)}if(_d(E))return y(A,C,E,O);if(sd(E))return x(A,C,E,O);N0(A,E)}return typeof E=="string"&&E!==""||typeof E=="number"?(E=""+E,C!==null&&C.tag===6?(r(A,C.sibling),C=i(C,E),C.return=A,A=C):(r(A,C),C=Ug(E,A.mode,O),C.return=A,A=C),a(A)):r(A,C)}return S}var mu=Rw(!0),Dw=Rw(!1),Lh=_l(null),Uh=null,Yc=null,g1=null;function m1(){g1=Yc=Uh=null}function x1(t){var e=Lh.current;Mr(Lh),t._currentValue=e}function Xm(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function nu(t,e){Uh=t,g1=Yc=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Yi=!0),t.firstContext=null)}function Bs(t){var e=t._currentValue;if(g1!==t)if(t={context:t,memoizedValue:e,next:null},Yc===null){if(Uh===null)throw Error(Be(308));Yc=t,Uh.dependencies={lanes:0,firstContext:t}}else Yc=Yc.next=t;return e}var Ml=null;function v1(t){Ml===null?Ml=[t]:Ml.push(t)}function Pw(t,e,r,n){var i=e.interleaved;return i===null?(r.next=r,v1(e)):(r.next=i.next,i.next=r),e.interleaved=r,so(t,n)}function so(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var jo=!1;function y1(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ow(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Ja(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function tl(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,rr&2){var i=n.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),n.pending=e,so(t,r)}return i=n.interleaved,i===null?(e.next=e,v1(n)):(e.next=i.next,i.next=e),n.interleaved=e,so(t,r)}function uh(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,i1(t,r)}}function x2(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?i=s=a:s=s.next=a,r=r.next}while(r!==null);s===null?i=s=e:s=s.next=e}else i=s=e;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function Vh(t,e,r,n){var i=t.updateQueue;jo=!1;var s=i.firstBaseUpdate,a=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var l=o,u=l.next;l.next=null,a===null?s=u:a.next=u,a=l;var f=t.alternate;f!==null&&(f=f.updateQueue,o=f.lastBaseUpdate,o!==a&&(o===null?f.firstBaseUpdate=u:o.next=u,f.lastBaseUpdate=l))}if(s!==null){var p=i.baseState;a=0,f=u=l=null,o=s;do{var g=o.lane,m=o.eventTime;if((n&g)===g){f!==null&&(f=f.next={eventTime:m,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var y=t,x=o;switch(g=e,m=r,x.tag){case 1:if(y=x.payload,typeof y=="function"){p=y.call(m,p,g);break e}p=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=x.payload,g=typeof y=="function"?y.call(m,p,g):y,g==null)break e;p=en({},p,g);break e;case 2:jo=!0}}o.callback!==null&&o.lane!==0&&(t.flags|=64,g=i.effects,g===null?i.effects=[o]:g.push(o))}else m={eventTime:m,lane:g,tag:o.tag,payload:o.payload,callback:o.callback,next:null},f===null?(u=f=m,l=p):f=f.next=m,a|=g;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;g=o,o=g.next,g.next=null,i.lastBaseUpdate=g,i.shared.pending=null}}while(!0);if(f===null&&(l=p),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=f,e=i.shared.interleaved,e!==null){i=e;do a|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);Ql|=a,t.lanes=a,t.memoizedState=p}}function v2(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(Be(191,i));i.call(n)}}}var Hf={},ba=_l(Hf),uf=_l(Hf),df=_l(Hf);function Bl(t){if(t===Hf)throw Error(Be(174));return t}function _1(t,e){switch(Ir(df,e),Ir(uf,t),Ir(ba,Hf),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:bm(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=bm(e,t)}Mr(ba),Ir(ba,e)}function xu(){Mr(ba),Mr(uf),Mr(df)}function Mw(t){Bl(df.current);var e=Bl(ba.current),r=bm(e,t.type);e!==r&&(Ir(uf,t),Ir(ba,r))}function E1(t){uf.current===t&&(Mr(ba),Mr(uf))}var qr=_l(0);function zh(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Pg=[];function S1(){for(var t=0;t<Pg.length;t++)Pg[t]._workInProgressVersionPrimary=null;Pg.length=0}var dh=po.ReactCurrentDispatcher,Og=po.ReactCurrentBatchConfig,ql=0,Zr=null,Nn=null,Wn=null,Wh=!1,Od=!1,ff=0,ZI=0;function ci(){throw Error(Be(321))}function w1(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!aa(t[r],e[r]))return!1;return!0}function T1(t,e,r,n,i,s){if(ql=s,Zr=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,dh.current=t===null||t.memoizedState===null?nN:iN,t=r(n,i),Od){s=0;do{if(Od=!1,ff=0,25<=s)throw Error(Be(301));s+=1,Wn=Nn=null,e.updateQueue=null,dh.current=sN,t=r(n,i)}while(Od)}if(dh.current=Hh,e=Nn!==null&&Nn.next!==null,ql=0,Wn=Nn=Zr=null,Wh=!1,e)throw Error(Be(300));return t}function A1(){var t=ff!==0;return ff=0,t}function Aa(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Wn===null?Zr.memoizedState=Wn=t:Wn=Wn.next=t,Wn}function js(){if(Nn===null){var t=Zr.alternate;t=t!==null?t.memoizedState:null}else t=Nn.next;var e=Wn===null?Zr.memoizedState:Wn.next;if(e!==null)Wn=e,Nn=t;else{if(t===null)throw Error(Be(310));Nn=t,t={memoizedState:Nn.memoizedState,baseState:Nn.baseState,baseQueue:Nn.baseQueue,queue:Nn.queue,next:null},Wn===null?Zr.memoizedState=Wn=t:Wn=Wn.next=t}return Wn}function hf(t,e){return typeof e=="function"?e(t):e}function Mg(t){var e=js(),r=e.queue;if(r===null)throw Error(Be(311));r.lastRenderedReducer=t;var n=Nn,i=n.baseQueue,s=r.pending;if(s!==null){if(i!==null){var a=i.next;i.next=s.next,s.next=a}n.baseQueue=i=s,r.pending=null}if(i!==null){s=i.next,n=n.baseState;var o=a=null,l=null,u=s;do{var f=u.lane;if((ql&f)===f)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:t(n,u.action);else{var p={lane:f,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(o=l=p,a=n):l=l.next=p,Zr.lanes|=f,Ql|=f}u=u.next}while(u!==null&&u!==s);l===null?a=n:l.next=o,aa(n,e.memoizedState)||(Yi=!0),e.memoizedState=n,e.baseState=a,e.baseQueue=l,r.lastRenderedState=n}if(t=r.interleaved,t!==null){i=t;do s=i.lane,Zr.lanes|=s,Ql|=s,i=i.next;while(i!==t)}else i===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function Bg(t){var e=js(),r=e.queue;if(r===null)throw Error(Be(311));r.lastRenderedReducer=t;var n=r.dispatch,i=r.pending,s=e.memoizedState;if(i!==null){r.pending=null;var a=i=i.next;do s=t(s,a.action),a=a.next;while(a!==i);aa(s,e.memoizedState)||(Yi=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),r.lastRenderedState=s}return[s,n]}function Bw(){}function jw(t,e){var r=Zr,n=js(),i=e(),s=!aa(n.memoizedState,i);if(s&&(n.memoizedState=i,Yi=!0),n=n.queue,C1(Vw.bind(null,r,n,t),[t]),n.getSnapshot!==e||s||Wn!==null&&Wn.memoizedState.tag&1){if(r.flags|=2048,pf(9,Uw.bind(null,r,n,i,e),void 0,null),Gn===null)throw Error(Be(349));ql&30||Lw(r,e,i)}return i}function Lw(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=Zr.updateQueue,e===null?(e={lastEffect:null,stores:null},Zr.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function Uw(t,e,r,n){e.value=r,e.getSnapshot=n,zw(e)&&Ww(t)}function Vw(t,e,r){return r(function(){zw(e)&&Ww(t)})}function zw(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!aa(t,r)}catch{return!0}}function Ww(t){var e=so(t,1);e!==null&&na(e,t,1,-1)}function y2(t){var e=Aa();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:hf,lastRenderedState:t},e.queue=t,t=t.dispatch=rN.bind(null,Zr,t),[e.memoizedState,t]}function pf(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=Zr.updateQueue,e===null?(e={lastEffect:null,stores:null},Zr.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function Hw(){return js().memoizedState}function fh(t,e,r,n){var i=Aa();Zr.flags|=t,i.memoizedState=pf(1|e,r,void 0,n===void 0?null:n)}function Dp(t,e,r,n){var i=js();n=n===void 0?null:n;var s=void 0;if(Nn!==null){var a=Nn.memoizedState;if(s=a.destroy,n!==null&&w1(n,a.deps)){i.memoizedState=pf(e,r,s,n);return}}Zr.flags|=t,i.memoizedState=pf(1|e,r,s,n)}function _2(t,e){return fh(8390656,8,t,e)}function C1(t,e){return Dp(2048,8,t,e)}function $w(t,e){return Dp(4,2,t,e)}function Gw(t,e){return Dp(4,4,t,e)}function Kw(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Yw(t,e,r){return r=r!=null?r.concat([t]):null,Dp(4,4,Kw.bind(null,e,t),r)}function k1(){}function Xw(t,e){var r=js();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&w1(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function qw(t,e){var r=js();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&w1(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function Qw(t,e,r){return ql&21?(aa(r,e)||(r=rw(),Zr.lanes|=r,Ql|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Yi=!0),t.memoizedState=r)}function eN(t,e){var r=Er;Er=r!==0&&4>r?r:4,t(!0);var n=Og.transition;Og.transition={};try{t(!1),e()}finally{Er=r,Og.transition=n}}function Jw(){return js().memoizedState}function tN(t,e,r){var n=nl(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},Zw(t))eT(e,r);else if(r=Pw(t,e,r,n),r!==null){var i=Di();na(r,t,n,i),tT(r,e,n)}}function rN(t,e,r){var n=nl(t),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(Zw(t))eT(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var a=e.lastRenderedState,o=s(a,r);if(i.hasEagerState=!0,i.eagerState=o,aa(o,a)){var l=e.interleaved;l===null?(i.next=i,v1(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}r=Pw(t,e,i,n),r!==null&&(i=Di(),na(r,t,n,i),tT(r,e,n))}}function Zw(t){var e=t.alternate;return t===Zr||e!==null&&e===Zr}function eT(t,e){Od=Wh=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function tT(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,i1(t,r)}}var Hh={readContext:Bs,useCallback:ci,useContext:ci,useEffect:ci,useImperativeHandle:ci,useInsertionEffect:ci,useLayoutEffect:ci,useMemo:ci,useReducer:ci,useRef:ci,useState:ci,useDebugValue:ci,useDeferredValue:ci,useTransition:ci,useMutableSource:ci,useSyncExternalStore:ci,useId:ci,unstable_isNewReconciler:!1},nN={readContext:Bs,useCallback:function(t,e){return Aa().memoizedState=[t,e===void 0?null:e],t},useContext:Bs,useEffect:_2,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,fh(4194308,4,Kw.bind(null,e,t),r)},useLayoutEffect:function(t,e){return fh(4194308,4,t,e)},useInsertionEffect:function(t,e){return fh(4,2,t,e)},useMemo:function(t,e){var r=Aa();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=Aa();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=tN.bind(null,Zr,t),[n.memoizedState,t]},useRef:function(t){var e=Aa();return t={current:t},e.memoizedState=t},useState:y2,useDebugValue:k1,useDeferredValue:function(t){return Aa().memoizedState=t},useTransition:function(){var t=y2(!1),e=t[0];return t=eN.bind(null,t[1]),Aa().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=Zr,i=Aa();if($r){if(r===void 0)throw Error(Be(407));r=r()}else{if(r=e(),Gn===null)throw Error(Be(349));ql&30||Lw(n,e,r)}i.memoizedState=r;var s={value:r,getSnapshot:e};return i.queue=s,_2(Vw.bind(null,n,s,t),[t]),n.flags|=2048,pf(9,Uw.bind(null,n,s,r,e),void 0,null),r},useId:function(){var t=Aa(),e=Gn.identifierPrefix;if($r){var r=Ka,n=Ga;r=(n&~(1<<32-ra(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=ff++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=ZI++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},iN={readContext:Bs,useCallback:Xw,useContext:Bs,useEffect:C1,useImperativeHandle:Yw,useInsertionEffect:$w,useLayoutEffect:Gw,useMemo:qw,useReducer:Mg,useRef:Hw,useState:function(){return Mg(hf)},useDebugValue:k1,useDeferredValue:function(t){var e=js();return Qw(e,Nn.memoizedState,t)},useTransition:function(){var t=Mg(hf)[0],e=js().memoizedState;return[t,e]},useMutableSource:Bw,useSyncExternalStore:jw,useId:Jw,unstable_isNewReconciler:!1},sN={readContext:Bs,useCallback:Xw,useContext:Bs,useEffect:C1,useImperativeHandle:Yw,useInsertionEffect:$w,useLayoutEffect:Gw,useMemo:qw,useReducer:Bg,useRef:Hw,useState:function(){return Bg(hf)},useDebugValue:k1,useDeferredValue:function(t){var e=js();return Nn===null?e.memoizedState=t:Qw(e,Nn.memoizedState,t)},useTransition:function(){var t=Bg(hf)[0],e=js().memoizedState;return[t,e]},useMutableSource:Bw,useSyncExternalStore:jw,useId:Jw,unstable_isNewReconciler:!1};function qs(t,e){if(t&&t.defaultProps){e=en({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function qm(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:en({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var Pp={isMounted:function(t){return(t=t._reactInternals)?dc(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=Di(),i=nl(t),s=Ja(n,i);s.payload=e,r!=null&&(s.callback=r),e=tl(t,s,i),e!==null&&(na(e,t,i,n),uh(e,t,i))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=Di(),i=nl(t),s=Ja(n,i);s.tag=1,s.payload=e,r!=null&&(s.callback=r),e=tl(t,s,i),e!==null&&(na(e,t,i,n),uh(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=Di(),n=nl(t),i=Ja(r,n);i.tag=2,e!=null&&(i.callback=e),e=tl(t,i,n),e!==null&&(na(e,t,n,r),uh(e,t,n))}};function E2(t,e,r,n,i,s,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,s,a):e.prototype&&e.prototype.isPureReactComponent?!af(r,n)||!af(i,s):!0}function rT(t,e,r){var n=!1,i=dl,s=e.contextType;return typeof s=="object"&&s!==null?s=Bs(s):(i=qi(e)?Yl:Ei.current,n=e.contextTypes,s=(n=n!=null)?pu(t,i):dl),e=new e(r,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Pp,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function S2(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&Pp.enqueueReplaceState(e,e.state,null)}function Qm(t,e,r,n){var i=t.stateNode;i.props=r,i.state=t.memoizedState,i.refs={},y1(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=Bs(s):(s=qi(e)?Yl:Ei.current,i.context=pu(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(qm(t,e,s,r),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Pp.enqueueReplaceState(i,i.state,null),Vh(t,r,i,n),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function vu(t,e){try{var r="",n=e;do r+=Db(n),n=n.return;while(n);var i=r}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function jg(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function Jm(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var aN=typeof WeakMap=="function"?WeakMap:Map;function nT(t,e,r){r=Ja(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){Gh||(Gh=!0,lx=n),Jm(t,e)},r}function iT(t,e,r){r=Ja(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var i=e.value;r.payload=function(){return n(i)},r.callback=function(){Jm(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){Jm(t,e),typeof n!="function"&&(rl===null?rl=new Set([this]):rl.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),r}function w2(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new aN;var i=new Set;n.set(e,i)}else i=n.get(e),i===void 0&&(i=new Set,n.set(e,i));i.has(r)||(i.add(r),t=_N.bind(null,t,e,r),e.then(t,t))}function T2(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function A2(t,e,r,n,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=Ja(-1,1),e.tag=2,tl(r,e,1))),r.lanes|=1),t)}var oN=po.ReactCurrentOwner,Yi=!1;function Ii(t,e,r,n){e.child=t===null?Dw(e,null,r,n):mu(e,t.child,r,n)}function C2(t,e,r,n,i){r=r.render;var s=e.ref;return nu(e,i),n=T1(t,e,r,n,s,i),r=A1(),t!==null&&!Yi?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,ao(t,e,i)):($r&&r&&f1(e),e.flags|=1,Ii(t,e,n,i),e.child)}function k2(t,e,r,n,i){if(t===null){var s=r.type;return typeof s=="function"&&!O1(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=s,sT(t,e,s,n,i)):(t=mh(r.type,null,n,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var a=s.memoizedProps;if(r=r.compare,r=r!==null?r:af,r(a,n)&&t.ref===e.ref)return ao(t,e,i)}return e.flags|=1,t=il(s,n),t.ref=e.ref,t.return=e,e.child=t}function sT(t,e,r,n,i){if(t!==null){var s=t.memoizedProps;if(af(s,n)&&t.ref===e.ref)if(Yi=!1,e.pendingProps=n=s,(t.lanes&i)!==0)t.flags&131072&&(Yi=!0);else return e.lanes=t.lanes,ao(t,e,i)}return Zm(t,e,r,n,i)}function aT(t,e,r){var n=e.pendingProps,i=n.children,s=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ir(qc,os),os|=r;else{if(!(r&1073741824))return t=s!==null?s.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Ir(qc,os),os|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,Ir(qc,os),os|=n}else s!==null?(n=s.baseLanes|r,e.memoizedState=null):n=r,Ir(qc,os),os|=n;return Ii(t,e,i,r),e.child}function oT(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function Zm(t,e,r,n,i){var s=qi(r)?Yl:Ei.current;return s=pu(e,s),nu(e,i),r=T1(t,e,r,n,s,i),n=A1(),t!==null&&!Yi?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,ao(t,e,i)):($r&&n&&f1(e),e.flags|=1,Ii(t,e,r,i),e.child)}function F2(t,e,r,n,i){if(qi(r)){var s=!0;Mh(e)}else s=!1;if(nu(e,i),e.stateNode===null)hh(t,e),rT(e,r,n),Qm(e,r,n,i),n=!0;else if(t===null){var a=e.stateNode,o=e.memoizedProps;a.props=o;var l=a.context,u=r.contextType;typeof u=="object"&&u!==null?u=Bs(u):(u=qi(r)?Yl:Ei.current,u=pu(e,u));var f=r.getDerivedStateFromProps,p=typeof f=="function"||typeof a.getSnapshotBeforeUpdate=="function";p||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==n||l!==u)&&S2(e,a,n,u),jo=!1;var g=e.memoizedState;a.state=g,Vh(e,n,a,i),l=e.memoizedState,o!==n||g!==l||Xi.current||jo?(typeof f=="function"&&(qm(e,r,f,n),l=e.memoizedState),(o=jo||E2(e,r,o,n,g,l,u))?(p||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=l),a.props=n,a.state=l,a.context=u,n=o):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{a=e.stateNode,Ow(t,e),o=e.memoizedProps,u=e.type===e.elementType?o:qs(e.type,o),a.props=u,p=e.pendingProps,g=a.context,l=r.contextType,typeof l=="object"&&l!==null?l=Bs(l):(l=qi(r)?Yl:Ei.current,l=pu(e,l));var m=r.getDerivedStateFromProps;(f=typeof m=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==p||g!==l)&&S2(e,a,n,l),jo=!1,g=e.memoizedState,a.state=g,Vh(e,n,a,i);var y=e.memoizedState;o!==p||g!==y||Xi.current||jo?(typeof m=="function"&&(qm(e,r,m,n),y=e.memoizedState),(u=jo||E2(e,r,u,n,g,y,l)||!1)?(f||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(n,y,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(n,y,l)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=y),a.props=n,a.state=y,a.context=l,n=u):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),n=!1)}return ex(t,e,r,n,s,i)}function ex(t,e,r,n,i,s){oT(t,e);var a=(e.flags&128)!==0;if(!n&&!a)return i&&h2(e,r,!1),ao(t,e,s);n=e.stateNode,oN.current=e;var o=a&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&a?(e.child=mu(e,t.child,null,s),e.child=mu(e,null,o,s)):Ii(t,e,o,s),e.memoizedState=n.state,i&&h2(e,r,!0),e.child}function lT(t){var e=t.stateNode;e.pendingContext?f2(t,e.pendingContext,e.pendingContext!==e.context):e.context&&f2(t,e.context,!1),_1(t,e.containerInfo)}function b2(t,e,r,n,i){return gu(),p1(i),e.flags|=256,Ii(t,e,r,n),e.child}var tx={dehydrated:null,treeContext:null,retryLane:0};function rx(t){return{baseLanes:t,cachePool:null,transitions:null}}function cT(t,e,r){var n=e.pendingProps,i=qr.current,s=!1,a=(e.flags&128)!==0,o;if((o=a)||(o=t!==null&&t.memoizedState===null?!1:(i&2)!==0),o?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),Ir(qr,i&1),t===null)return Ym(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=n.children,t=n.fallback,s?(n=e.mode,s=e.child,a={mode:"hidden",children:a},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=Bp(a,n,0,null),t=Vl(t,n,r,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=rx(r),e.memoizedState=tx,t):F1(e,a));if(i=t.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return lN(t,e,a,n,o,i,r);if(s){s=n.fallback,a=e.mode,i=t.child,o=i.sibling;var l={mode:"hidden",children:n.children};return!(a&1)&&e.child!==i?(n=e.child,n.childLanes=0,n.pendingProps=l,e.deletions=null):(n=il(i,l),n.subtreeFlags=i.subtreeFlags&14680064),o!==null?s=il(o,s):(s=Vl(s,a,r,null),s.flags|=2),s.return=e,n.return=e,n.sibling=s,e.child=n,n=s,s=e.child,a=t.child.memoizedState,a=a===null?rx(r):{baseLanes:a.baseLanes|r,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=t.childLanes&~r,e.memoizedState=tx,n}return s=t.child,t=s.sibling,n=il(s,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function F1(t,e){return e=Bp({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function R0(t,e,r,n){return n!==null&&p1(n),mu(e,t.child,null,r),t=F1(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function lN(t,e,r,n,i,s,a){if(r)return e.flags&256?(e.flags&=-257,n=jg(Error(Be(422))),R0(t,e,a,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=n.fallback,i=e.mode,n=Bp({mode:"visible",children:n.children},i,0,null),s=Vl(s,i,a,null),s.flags|=2,n.return=e,s.return=e,n.sibling=s,e.child=n,e.mode&1&&mu(e,t.child,null,a),e.child.memoizedState=rx(a),e.memoizedState=tx,s);if(!(e.mode&1))return R0(t,e,a,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var o=n.dgst;return n=o,s=Error(Be(419)),n=jg(s,n,void 0),R0(t,e,a,n)}if(o=(a&t.childLanes)!==0,Yi||o){if(n=Gn,n!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|a)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,so(t,i),na(n,t,i,-1))}return P1(),n=jg(Error(Be(421))),R0(t,e,a,n)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=EN.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,fs=el(i.nextSibling),hs=e,$r=!0,Js=null,t!==null&&(Ns[Rs++]=Ga,Ns[Rs++]=Ka,Ns[Rs++]=Xl,Ga=t.id,Ka=t.overflow,Xl=e),e=F1(e,n.children),e.flags|=4096,e)}function I2(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),Xm(t.return,e,r)}function Lg(t,e,r,n,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function uT(t,e,r){var n=e.pendingProps,i=n.revealOrder,s=n.tail;if(Ii(t,e,n.children,r),n=qr.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&I2(t,r,e);else if(t.tag===19)I2(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(Ir(qr,n),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(r=e.child,i=null;r!==null;)t=r.alternate,t!==null&&zh(t)===null&&(i=r),r=r.sibling;r=i,r===null?(i=e.child,e.child=null):(i=r.sibling,r.sibling=null),Lg(e,!1,i,r,s);break;case"backwards":for(r=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&zh(t)===null){e.child=i;break}t=i.sibling,i.sibling=r,r=i,i=t}Lg(e,!0,r,null,s);break;case"together":Lg(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function hh(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function ao(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),Ql|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Be(153));if(e.child!==null){for(t=e.child,r=il(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=il(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function cN(t,e,r){switch(e.tag){case 3:lT(e),gu();break;case 5:Mw(e);break;case 1:qi(e.type)&&Mh(e);break;case 4:_1(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,i=e.memoizedProps.value;Ir(Lh,n._currentValue),n._currentValue=i;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(Ir(qr,qr.current&1),e.flags|=128,null):r&e.child.childLanes?cT(t,e,r):(Ir(qr,qr.current&1),t=ao(t,e,r),t!==null?t.sibling:null);Ir(qr,qr.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return uT(t,e,r);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ir(qr,qr.current),n)break;return null;case 22:case 23:return e.lanes=0,aT(t,e,r)}return ao(t,e,r)}var dT,nx,fT,hT;dT=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};nx=function(){};fT=function(t,e,r,n){var i=t.memoizedProps;if(i!==n){t=e.stateNode,Bl(ba.current);var s=null;switch(r){case"input":i=Am(t,i),n=Am(t,n),s=[];break;case"select":i=en({},i,{value:void 0}),n=en({},n,{value:void 0}),s=[];break;case"textarea":i=Fm(t,i),n=Fm(t,n),s=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=Ph)}Im(r,n);var a;r=null;for(u in i)if(!n.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var o=i[u];for(a in o)o.hasOwnProperty(a)&&(r||(r={}),r[a]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Jd.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in n){var l=n[u];if(o=i!=null?i[u]:void 0,n.hasOwnProperty(u)&&l!==o&&(l!=null||o!=null))if(u==="style")if(o){for(a in o)!o.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(r||(r={}),r[a]="");for(a in l)l.hasOwnProperty(a)&&o[a]!==l[a]&&(r||(r={}),r[a]=l[a])}else r||(s||(s=[]),s.push(u,r)),r=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Jd.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&Pr("scroll",t),s||o===l||(s=[])):(s=s||[]).push(u,l))}r&&(s=s||[]).push("style",r);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};hT=function(t,e,r,n){r!==n&&(e.flags|=4)};function dd(t,e){if(!$r)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function ui(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function uN(t,e,r){var n=e.pendingProps;switch(h1(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ui(e),null;case 1:return qi(e.type)&&Oh(),ui(e),null;case 3:return n=e.stateNode,xu(),Mr(Xi),Mr(Ei),S1(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(I0(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Js!==null&&(dx(Js),Js=null))),nx(t,e),ui(e),null;case 5:E1(e);var i=Bl(df.current);if(r=e.type,t!==null&&e.stateNode!=null)fT(t,e,r,n,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(Be(166));return ui(e),null}if(t=Bl(ba.current),I0(e)){n=e.stateNode,r=e.type;var s=e.memoizedProps;switch(n[Ca]=e,n[cf]=s,t=(e.mode&1)!==0,r){case"dialog":Pr("cancel",n),Pr("close",n);break;case"iframe":case"object":case"embed":Pr("load",n);break;case"video":case"audio":for(i=0;i<Sd.length;i++)Pr(Sd[i],n);break;case"source":Pr("error",n);break;case"img":case"image":case"link":Pr("error",n),Pr("load",n);break;case"details":Pr("toggle",n);break;case"input":Ly(n,s),Pr("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},Pr("invalid",n);break;case"textarea":Vy(n,s),Pr("invalid",n)}Im(r,s),i=null;for(var a in s)if(s.hasOwnProperty(a)){var o=s[a];a==="children"?typeof o=="string"?n.textContent!==o&&(s.suppressHydrationWarning!==!0&&b0(n.textContent,o,t),i=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&b0(n.textContent,o,t),i=["children",""+o]):Jd.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&Pr("scroll",n)}switch(r){case"input":E0(n),Uy(n,s,!0);break;case"textarea":E0(n),zy(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=Ph)}n=i,e.updateQueue=n,n!==null&&(e.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=VS(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=a.createElement(r,{is:n.is}):(t=a.createElement(r),r==="select"&&(a=t,n.multiple?a.multiple=!0:n.size&&(a.size=n.size))):t=a.createElementNS(t,r),t[Ca]=e,t[cf]=n,dT(t,e,!1,!1),e.stateNode=t;e:{switch(a=Nm(r,n),r){case"dialog":Pr("cancel",t),Pr("close",t),i=n;break;case"iframe":case"object":case"embed":Pr("load",t),i=n;break;case"video":case"audio":for(i=0;i<Sd.length;i++)Pr(Sd[i],t);i=n;break;case"source":Pr("error",t),i=n;break;case"img":case"image":case"link":Pr("error",t),Pr("load",t),i=n;break;case"details":Pr("toggle",t),i=n;break;case"input":Ly(t,n),i=Am(t,n),Pr("invalid",t);break;case"option":i=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},i=en({},n,{value:void 0}),Pr("invalid",t);break;case"textarea":Vy(t,n),i=Fm(t,n),Pr("invalid",t);break;default:i=n}Im(r,i),o=i;for(s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="style"?HS(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&zS(t,l)):s==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&Zd(t,l):typeof l=="number"&&Zd(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Jd.hasOwnProperty(s)?l!=null&&s==="onScroll"&&Pr("scroll",t):l!=null&&Jx(t,s,l,a))}switch(r){case"input":E0(t),Uy(t,n,!1);break;case"textarea":E0(t),zy(t);break;case"option":n.value!=null&&t.setAttribute("value",""+ul(n.value));break;case"select":t.multiple=!!n.multiple,s=n.value,s!=null?Zc(t,!!n.multiple,s,!1):n.defaultValue!=null&&Zc(t,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=Ph)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return ui(e),null;case 6:if(t&&e.stateNode!=null)hT(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(Be(166));if(r=Bl(df.current),Bl(ba.current),I0(e)){if(n=e.stateNode,r=e.memoizedProps,n[Ca]=e,(s=n.nodeValue!==r)&&(t=hs,t!==null))switch(t.tag){case 3:b0(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&b0(n.nodeValue,r,(t.mode&1)!==0)}s&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Ca]=e,e.stateNode=n}return ui(e),null;case 13:if(Mr(qr),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if($r&&fs!==null&&e.mode&1&&!(e.flags&128))Nw(),gu(),e.flags|=98560,s=!1;else if(s=I0(e),n!==null&&n.dehydrated!==null){if(t===null){if(!s)throw Error(Be(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Be(317));s[Ca]=e}else gu(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;ui(e),s=!1}else Js!==null&&(dx(Js),Js=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||qr.current&1?Pn===0&&(Pn=3):P1())),e.updateQueue!==null&&(e.flags|=4),ui(e),null);case 4:return xu(),nx(t,e),t===null&&of(e.stateNode.containerInfo),ui(e),null;case 10:return x1(e.type._context),ui(e),null;case 17:return qi(e.type)&&Oh(),ui(e),null;case 19:if(Mr(qr),s=e.memoizedState,s===null)return ui(e),null;if(n=(e.flags&128)!==0,a=s.rendering,a===null)if(n)dd(s,!1);else{if(Pn!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=zh(t),a!==null){for(e.flags|=128,dd(s,!1),n=a.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)s=r,t=n,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,t=a.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return Ir(qr,qr.current&1|2),e.child}t=t.sibling}s.tail!==null&&pn()>yu&&(e.flags|=128,n=!0,dd(s,!1),e.lanes=4194304)}else{if(!n)if(t=zh(a),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),dd(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!$r)return ui(e),null}else 2*pn()-s.renderingStartTime>yu&&r!==1073741824&&(e.flags|=128,n=!0,dd(s,!1),e.lanes=4194304);s.isBackwards?(a.sibling=e.child,e.child=a):(r=s.last,r!==null?r.sibling=a:e.child=a,s.last=a)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=pn(),e.sibling=null,r=qr.current,Ir(qr,n?r&1|2:r&1),e):(ui(e),null);case 22:case 23:return D1(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?os&1073741824&&(ui(e),e.subtreeFlags&6&&(e.flags|=8192)):ui(e),null;case 24:return null;case 25:return null}throw Error(Be(156,e.tag))}function dN(t,e){switch(h1(e),e.tag){case 1:return qi(e.type)&&Oh(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return xu(),Mr(Xi),Mr(Ei),S1(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return E1(e),null;case 13:if(Mr(qr),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Be(340));gu()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Mr(qr),null;case 4:return xu(),null;case 10:return x1(e.type._context),null;case 22:case 23:return D1(),null;case 24:return null;default:return null}}var D0=!1,mi=!1,fN=typeof WeakSet=="function"?WeakSet:Set,tt=null;function Xc(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){sn(t,e,n)}else r.current=null}function ix(t,e,r){try{r()}catch(n){sn(t,e,n)}}var N2=!1;function hN(t,e){if(Vm=Nh,t=vw(),d1(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var a=0,o=-1,l=-1,u=0,f=0,p=t,g=null;t:for(;;){for(var m;p!==r||i!==0&&p.nodeType!==3||(o=a+i),p!==s||n!==0&&p.nodeType!==3||(l=a+n),p.nodeType===3&&(a+=p.nodeValue.length),(m=p.firstChild)!==null;)g=p,p=m;for(;;){if(p===t)break t;if(g===r&&++u===i&&(o=a),g===s&&++f===n&&(l=a),(m=p.nextSibling)!==null)break;p=g,g=p.parentNode}p=m}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(zm={focusedElem:t,selectionRange:r},Nh=!1,tt=e;tt!==null;)if(e=tt,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,tt=t;else for(;tt!==null;){e=tt;try{var y=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var x=y.memoizedProps,S=y.memoizedState,A=e.stateNode,C=A.getSnapshotBeforeUpdate(e.elementType===e.type?x:qs(e.type,x),S);A.__reactInternalSnapshotBeforeUpdate=C}break;case 3:var E=e.stateNode.containerInfo;E.nodeType===1?E.textContent="":E.nodeType===9&&E.documentElement&&E.removeChild(E.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Be(163))}}catch(O){sn(e,e.return,O)}if(t=e.sibling,t!==null){t.return=e.return,tt=t;break}tt=e.return}return y=N2,N2=!1,y}function Md(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&ix(e,r,s)}i=i.next}while(i!==n)}}function Op(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function sx(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function pT(t){var e=t.alternate;e!==null&&(t.alternate=null,pT(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Ca],delete e[cf],delete e[$m],delete e[XI],delete e[qI])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function gT(t){return t.tag===5||t.tag===3||t.tag===4}function R2(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||gT(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function ax(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=Ph));else if(n!==4&&(t=t.child,t!==null))for(ax(t,e,r),t=t.sibling;t!==null;)ax(t,e,r),t=t.sibling}function ox(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(ox(t,e,r),t=t.sibling;t!==null;)ox(t,e,r),t=t.sibling}var Jn=null,Qs=!1;function Ro(t,e,r){for(r=r.child;r!==null;)mT(t,e,r),r=r.sibling}function mT(t,e,r){if(Fa&&typeof Fa.onCommitFiberUnmount=="function")try{Fa.onCommitFiberUnmount(kp,r)}catch{}switch(r.tag){case 5:mi||Xc(r,e);case 6:var n=Jn,i=Qs;Jn=null,Ro(t,e,r),Jn=n,Qs=i,Jn!==null&&(Qs?(t=Jn,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):Jn.removeChild(r.stateNode));break;case 18:Jn!==null&&(Qs?(t=Jn,r=r.stateNode,t.nodeType===8?Rg(t.parentNode,r):t.nodeType===1&&Rg(t,r),nf(t)):Rg(Jn,r.stateNode));break;case 4:n=Jn,i=Qs,Jn=r.stateNode.containerInfo,Qs=!0,Ro(t,e,r),Jn=n,Qs=i;break;case 0:case 11:case 14:case 15:if(!mi&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var s=i,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&ix(r,e,a),i=i.next}while(i!==n)}Ro(t,e,r);break;case 1:if(!mi&&(Xc(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){sn(r,e,o)}Ro(t,e,r);break;case 21:Ro(t,e,r);break;case 22:r.mode&1?(mi=(n=mi)||r.memoizedState!==null,Ro(t,e,r),mi=n):Ro(t,e,r);break;default:Ro(t,e,r)}}function D2(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new fN),e.forEach(function(n){var i=SN.bind(null,t,n);r.has(n)||(r.add(n),n.then(i,i))})}}function Ks(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var s=t,a=e,o=a;e:for(;o!==null;){switch(o.tag){case 5:Jn=o.stateNode,Qs=!1;break e;case 3:Jn=o.stateNode.containerInfo,Qs=!0;break e;case 4:Jn=o.stateNode.containerInfo,Qs=!0;break e}o=o.return}if(Jn===null)throw Error(Be(160));mT(s,a,i),Jn=null,Qs=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(u){sn(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)xT(e,t),e=e.sibling}function xT(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Ks(e,t),_a(t),n&4){try{Md(3,t,t.return),Op(3,t)}catch(x){sn(t,t.return,x)}try{Md(5,t,t.return)}catch(x){sn(t,t.return,x)}}break;case 1:Ks(e,t),_a(t),n&512&&r!==null&&Xc(r,r.return);break;case 5:if(Ks(e,t),_a(t),n&512&&r!==null&&Xc(r,r.return),t.flags&32){var i=t.stateNode;try{Zd(i,"")}catch(x){sn(t,t.return,x)}}if(n&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,a=r!==null?r.memoizedProps:s,o=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&LS(i,s),Nm(o,a);var u=Nm(o,s);for(a=0;a<l.length;a+=2){var f=l[a],p=l[a+1];f==="style"?HS(i,p):f==="dangerouslySetInnerHTML"?zS(i,p):f==="children"?Zd(i,p):Jx(i,f,p,u)}switch(o){case"input":Cm(i,s);break;case"textarea":US(i,s);break;case"select":var g=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var m=s.value;m!=null?Zc(i,!!s.multiple,m,!1):g!==!!s.multiple&&(s.defaultValue!=null?Zc(i,!!s.multiple,s.defaultValue,!0):Zc(i,!!s.multiple,s.multiple?[]:"",!1))}i[cf]=s}catch(x){sn(t,t.return,x)}}break;case 6:if(Ks(e,t),_a(t),n&4){if(t.stateNode===null)throw Error(Be(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(x){sn(t,t.return,x)}}break;case 3:if(Ks(e,t),_a(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{nf(e.containerInfo)}catch(x){sn(t,t.return,x)}break;case 4:Ks(e,t),_a(t);break;case 13:Ks(e,t),_a(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(N1=pn())),n&4&&D2(t);break;case 22:if(f=r!==null&&r.memoizedState!==null,t.mode&1?(mi=(u=mi)||f,Ks(e,t),mi=u):Ks(e,t),_a(t),n&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!f&&t.mode&1)for(tt=t,f=t.child;f!==null;){for(p=tt=f;tt!==null;){switch(g=tt,m=g.child,g.tag){case 0:case 11:case 14:case 15:Md(4,g,g.return);break;case 1:Xc(g,g.return);var y=g.stateNode;if(typeof y.componentWillUnmount=="function"){n=g,r=g.return;try{e=n,y.props=e.memoizedProps,y.state=e.memoizedState,y.componentWillUnmount()}catch(x){sn(n,r,x)}}break;case 5:Xc(g,g.return);break;case 22:if(g.memoizedState!==null){O2(p);continue}}m!==null?(m.return=g,tt=m):O2(p)}f=f.sibling}e:for(f=null,p=t;;){if(p.tag===5){if(f===null){f=p;try{i=p.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=p.stateNode,l=p.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=WS("display",a))}catch(x){sn(t,t.return,x)}}}else if(p.tag===6){if(f===null)try{p.stateNode.nodeValue=u?"":p.memoizedProps}catch(x){sn(t,t.return,x)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===t)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===t)break e;for(;p.sibling===null;){if(p.return===null||p.return===t)break e;f===p&&(f=null),p=p.return}f===p&&(f=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:Ks(e,t),_a(t),n&4&&D2(t);break;case 21:break;default:Ks(e,t),_a(t)}}function _a(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(gT(r)){var n=r;break e}r=r.return}throw Error(Be(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(Zd(i,""),n.flags&=-33);var s=R2(t);ox(t,s,i);break;case 3:case 4:var a=n.stateNode.containerInfo,o=R2(t);ax(t,o,a);break;default:throw Error(Be(161))}}catch(l){sn(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function pN(t,e,r){tt=t,vT(t)}function vT(t,e,r){for(var n=(t.mode&1)!==0;tt!==null;){var i=tt,s=i.child;if(i.tag===22&&n){var a=i.memoizedState!==null||D0;if(!a){var o=i.alternate,l=o!==null&&o.memoizedState!==null||mi;o=D0;var u=mi;if(D0=a,(mi=l)&&!u)for(tt=i;tt!==null;)a=tt,l=a.child,a.tag===22&&a.memoizedState!==null?M2(i):l!==null?(l.return=a,tt=l):M2(i);for(;s!==null;)tt=s,vT(s),s=s.sibling;tt=i,D0=o,mi=u}P2(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,tt=s):P2(t)}}function P2(t){for(;tt!==null;){var e=tt;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:mi||Op(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!mi)if(r===null)n.componentDidMount();else{var i=e.elementType===e.type?r.memoizedProps:qs(e.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&v2(e,s,n);break;case 3:var a=e.updateQueue;if(a!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}v2(e,a,r)}break;case 5:var o=e.stateNode;if(r===null&&e.flags&4){r=o;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var f=u.memoizedState;if(f!==null){var p=f.dehydrated;p!==null&&nf(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Be(163))}mi||e.flags&512&&sx(e)}catch(g){sn(e,e.return,g)}}if(e===t){tt=null;break}if(r=e.sibling,r!==null){r.return=e.return,tt=r;break}tt=e.return}}function O2(t){for(;tt!==null;){var e=tt;if(e===t){tt=null;break}var r=e.sibling;if(r!==null){r.return=e.return,tt=r;break}tt=e.return}}function M2(t){for(;tt!==null;){var e=tt;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{Op(4,e)}catch(l){sn(e,r,l)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var i=e.return;try{n.componentDidMount()}catch(l){sn(e,i,l)}}var s=e.return;try{sx(e)}catch(l){sn(e,s,l)}break;case 5:var a=e.return;try{sx(e)}catch(l){sn(e,a,l)}}}catch(l){sn(e,e.return,l)}if(e===t){tt=null;break}var o=e.sibling;if(o!==null){o.return=e.return,tt=o;break}tt=e.return}}var gN=Math.ceil,$h=po.ReactCurrentDispatcher,b1=po.ReactCurrentOwner,Os=po.ReactCurrentBatchConfig,rr=0,Gn=null,An=null,ni=0,os=0,qc=_l(0),Pn=0,gf=null,Ql=0,Mp=0,I1=0,Bd=null,Ki=null,N1=0,yu=1/0,Ha=null,Gh=!1,lx=null,rl=null,P0=!1,Go=null,Kh=0,jd=0,cx=null,ph=-1,gh=0;function Di(){return rr&6?pn():ph!==-1?ph:ph=pn()}function nl(t){return t.mode&1?rr&2&&ni!==0?ni&-ni:JI.transition!==null?(gh===0&&(gh=rw()),gh):(t=Er,t!==0||(t=window.event,t=t===void 0?16:cw(t.type)),t):1}function na(t,e,r,n){if(50<jd)throw jd=0,cx=null,Error(Be(185));Vf(t,r,n),(!(rr&2)||t!==Gn)&&(t===Gn&&(!(rr&2)&&(Mp|=r),Pn===4&&Uo(t,ni)),Qi(t,n),r===1&&rr===0&&!(e.mode&1)&&(yu=pn()+500,Rp&&El()))}function Qi(t,e){var r=t.callbackNode;Jb(t,e);var n=Ih(t,t===Gn?ni:0);if(n===0)r!==null&&$y(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&$y(r),e===1)t.tag===0?QI(B2.bind(null,t)):Fw(B2.bind(null,t)),KI(function(){!(rr&6)&&El()}),r=null;else{switch(nw(n)){case 1:r=n1;break;case 4:r=ew;break;case 16:r=bh;break;case 536870912:r=tw;break;default:r=bh}r=CT(r,yT.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function yT(t,e){if(ph=-1,gh=0,rr&6)throw Error(Be(327));var r=t.callbackNode;if(iu()&&t.callbackNode!==r)return null;var n=Ih(t,t===Gn?ni:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=Yh(t,n);else{e=n;var i=rr;rr|=2;var s=ET();(Gn!==t||ni!==e)&&(Ha=null,yu=pn()+500,Ul(t,e));do try{vN();break}catch(o){_T(t,o)}while(!0);m1(),$h.current=s,rr=i,An!==null?e=0:(Gn=null,ni=0,e=Pn)}if(e!==0){if(e===2&&(i=Mm(t),i!==0&&(n=i,e=ux(t,i))),e===1)throw r=gf,Ul(t,0),Uo(t,n),Qi(t,pn()),r;if(e===6)Uo(t,n);else{if(i=t.current.alternate,!(n&30)&&!mN(i)&&(e=Yh(t,n),e===2&&(s=Mm(t),s!==0&&(n=s,e=ux(t,s))),e===1))throw r=gf,Ul(t,0),Uo(t,n),Qi(t,pn()),r;switch(t.finishedWork=i,t.finishedLanes=n,e){case 0:case 1:throw Error(Be(345));case 2:Nl(t,Ki,Ha);break;case 3:if(Uo(t,n),(n&130023424)===n&&(e=N1+500-pn(),10<e)){if(Ih(t,0)!==0)break;if(i=t.suspendedLanes,(i&n)!==n){Di(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Hm(Nl.bind(null,t,Ki,Ha),e);break}Nl(t,Ki,Ha);break;case 4:if(Uo(t,n),(n&4194240)===n)break;for(e=t.eventTimes,i=-1;0<n;){var a=31-ra(n);s=1<<a,a=e[a],a>i&&(i=a),n&=~s}if(n=i,n=pn()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*gN(n/1960))-n,10<n){t.timeoutHandle=Hm(Nl.bind(null,t,Ki,Ha),n);break}Nl(t,Ki,Ha);break;case 5:Nl(t,Ki,Ha);break;default:throw Error(Be(329))}}}return Qi(t,pn()),t.callbackNode===r?yT.bind(null,t):null}function ux(t,e){var r=Bd;return t.current.memoizedState.isDehydrated&&(Ul(t,e).flags|=256),t=Yh(t,e),t!==2&&(e=Ki,Ki=r,e!==null&&dx(e)),t}function dx(t){Ki===null?Ki=t:Ki.push.apply(Ki,t)}function mN(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!aa(s(),i))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Uo(t,e){for(e&=~I1,e&=~Mp,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-ra(e),n=1<<r;t[r]=-1,e&=~n}}function B2(t){if(rr&6)throw Error(Be(327));iu();var e=Ih(t,0);if(!(e&1))return Qi(t,pn()),null;var r=Yh(t,e);if(t.tag!==0&&r===2){var n=Mm(t);n!==0&&(e=n,r=ux(t,n))}if(r===1)throw r=gf,Ul(t,0),Uo(t,e),Qi(t,pn()),r;if(r===6)throw Error(Be(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Nl(t,Ki,Ha),Qi(t,pn()),null}function R1(t,e){var r=rr;rr|=1;try{return t(e)}finally{rr=r,rr===0&&(yu=pn()+500,Rp&&El())}}function Jl(t){Go!==null&&Go.tag===0&&!(rr&6)&&iu();var e=rr;rr|=1;var r=Os.transition,n=Er;try{if(Os.transition=null,Er=1,t)return t()}finally{Er=n,Os.transition=r,rr=e,!(rr&6)&&El()}}function D1(){os=qc.current,Mr(qc)}function Ul(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,GI(r)),An!==null)for(r=An.return;r!==null;){var n=r;switch(h1(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Oh();break;case 3:xu(),Mr(Xi),Mr(Ei),S1();break;case 5:E1(n);break;case 4:xu();break;case 13:Mr(qr);break;case 19:Mr(qr);break;case 10:x1(n.type._context);break;case 22:case 23:D1()}r=r.return}if(Gn=t,An=t=il(t.current,null),ni=os=e,Pn=0,gf=null,I1=Mp=Ql=0,Ki=Bd=null,Ml!==null){for(e=0;e<Ml.length;e++)if(r=Ml[e],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,s=r.pending;if(s!==null){var a=s.next;s.next=i,n.next=a}r.pending=n}Ml=null}return t}function _T(t,e){do{var r=An;try{if(m1(),dh.current=Hh,Wh){for(var n=Zr.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}Wh=!1}if(ql=0,Wn=Nn=Zr=null,Od=!1,ff=0,b1.current=null,r===null||r.return===null){Pn=1,gf=e,An=null;break}e:{var s=t,a=r.return,o=r,l=e;if(e=ni,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,f=o,p=f.tag;if(!(f.mode&1)&&(p===0||p===11||p===15)){var g=f.alternate;g?(f.updateQueue=g.updateQueue,f.memoizedState=g.memoizedState,f.lanes=g.lanes):(f.updateQueue=null,f.memoizedState=null)}var m=T2(a);if(m!==null){m.flags&=-257,A2(m,a,o,s,e),m.mode&1&&w2(s,u,e),e=m,l=u;var y=e.updateQueue;if(y===null){var x=new Set;x.add(l),e.updateQueue=x}else y.add(l);break e}else{if(!(e&1)){w2(s,u,e),P1();break e}l=Error(Be(426))}}else if($r&&o.mode&1){var S=T2(a);if(S!==null){!(S.flags&65536)&&(S.flags|=256),A2(S,a,o,s,e),p1(vu(l,o));break e}}s=l=vu(l,o),Pn!==4&&(Pn=2),Bd===null?Bd=[s]:Bd.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var A=nT(s,l,e);x2(s,A);break e;case 1:o=l;var C=s.type,E=s.stateNode;if(!(s.flags&128)&&(typeof C.getDerivedStateFromError=="function"||E!==null&&typeof E.componentDidCatch=="function"&&(rl===null||!rl.has(E)))){s.flags|=65536,e&=-e,s.lanes|=e;var O=iT(s,o,e);x2(s,O);break e}}s=s.return}while(s!==null)}wT(r)}catch(Q){e=Q,An===r&&r!==null&&(An=r=r.return);continue}break}while(!0)}function ET(){var t=$h.current;return $h.current=Hh,t===null?Hh:t}function P1(){(Pn===0||Pn===3||Pn===2)&&(Pn=4),Gn===null||!(Ql&268435455)&&!(Mp&268435455)||Uo(Gn,ni)}function Yh(t,e){var r=rr;rr|=2;var n=ET();(Gn!==t||ni!==e)&&(Ha=null,Ul(t,e));do try{xN();break}catch(i){_T(t,i)}while(!0);if(m1(),rr=r,$h.current=n,An!==null)throw Error(Be(261));return Gn=null,ni=0,Pn}function xN(){for(;An!==null;)ST(An)}function vN(){for(;An!==null&&!Wb();)ST(An)}function ST(t){var e=AT(t.alternate,t,os);t.memoizedProps=t.pendingProps,e===null?wT(t):An=e,b1.current=null}function wT(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=dN(r,e),r!==null){r.flags&=32767,An=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Pn=6,An=null;return}}else if(r=uN(r,e,os),r!==null){An=r;return}if(e=e.sibling,e!==null){An=e;return}An=e=t}while(e!==null);Pn===0&&(Pn=5)}function Nl(t,e,r){var n=Er,i=Os.transition;try{Os.transition=null,Er=1,yN(t,e,r,n)}finally{Os.transition=i,Er=n}return null}function yN(t,e,r,n){do iu();while(Go!==null);if(rr&6)throw Error(Be(327));r=t.finishedWork;var i=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(Be(177));t.callbackNode=null,t.callbackPriority=0;var s=r.lanes|r.childLanes;if(Zb(t,s),t===Gn&&(An=Gn=null,ni=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||P0||(P0=!0,CT(bh,function(){return iu(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=Os.transition,Os.transition=null;var a=Er;Er=1;var o=rr;rr|=4,b1.current=null,hN(t,r),xT(r,t),LI(zm),Nh=!!Vm,zm=Vm=null,t.current=r,pN(r),Hb(),rr=o,Er=a,Os.transition=s}else t.current=r;if(P0&&(P0=!1,Go=t,Kh=i),s=t.pendingLanes,s===0&&(rl=null),Kb(r.stateNode),Qi(t,pn()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)i=e[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(Gh)throw Gh=!1,t=lx,lx=null,t;return Kh&1&&t.tag!==0&&iu(),s=t.pendingLanes,s&1?t===cx?jd++:(jd=0,cx=t):jd=0,El(),null}function iu(){if(Go!==null){var t=nw(Kh),e=Os.transition,r=Er;try{if(Os.transition=null,Er=16>t?16:t,Go===null)var n=!1;else{if(t=Go,Go=null,Kh=0,rr&6)throw Error(Be(331));var i=rr;for(rr|=4,tt=t.current;tt!==null;){var s=tt,a=s.child;if(tt.flags&16){var o=s.deletions;if(o!==null){for(var l=0;l<o.length;l++){var u=o[l];for(tt=u;tt!==null;){var f=tt;switch(f.tag){case 0:case 11:case 15:Md(8,f,s)}var p=f.child;if(p!==null)p.return=f,tt=p;else for(;tt!==null;){f=tt;var g=f.sibling,m=f.return;if(pT(f),f===u){tt=null;break}if(g!==null){g.return=m,tt=g;break}tt=m}}}var y=s.alternate;if(y!==null){var x=y.child;if(x!==null){y.child=null;do{var S=x.sibling;x.sibling=null,x=S}while(x!==null)}}tt=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,tt=a;else e:for(;tt!==null;){if(s=tt,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Md(9,s,s.return)}var A=s.sibling;if(A!==null){A.return=s.return,tt=A;break e}tt=s.return}}var C=t.current;for(tt=C;tt!==null;){a=tt;var E=a.child;if(a.subtreeFlags&2064&&E!==null)E.return=a,tt=E;else e:for(a=C;tt!==null;){if(o=tt,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:Op(9,o)}}catch(Q){sn(o,o.return,Q)}if(o===a){tt=null;break e}var O=o.sibling;if(O!==null){O.return=o.return,tt=O;break e}tt=o.return}}if(rr=i,El(),Fa&&typeof Fa.onPostCommitFiberRoot=="function")try{Fa.onPostCommitFiberRoot(kp,t)}catch{}n=!0}return n}finally{Er=r,Os.transition=e}}return!1}function j2(t,e,r){e=vu(r,e),e=nT(t,e,1),t=tl(t,e,1),e=Di(),t!==null&&(Vf(t,1,e),Qi(t,e))}function sn(t,e,r){if(t.tag===3)j2(t,t,r);else for(;e!==null;){if(e.tag===3){j2(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(rl===null||!rl.has(n))){t=vu(r,t),t=iT(e,t,1),e=tl(e,t,1),t=Di(),e!==null&&(Vf(e,1,t),Qi(e,t));break}}e=e.return}}function _N(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=Di(),t.pingedLanes|=t.suspendedLanes&r,Gn===t&&(ni&r)===r&&(Pn===4||Pn===3&&(ni&130023424)===ni&&500>pn()-N1?Ul(t,0):I1|=r),Qi(t,e)}function TT(t,e){e===0&&(t.mode&1?(e=T0,T0<<=1,!(T0&130023424)&&(T0=4194304)):e=1);var r=Di();t=so(t,e),t!==null&&(Vf(t,e,r),Qi(t,r))}function EN(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),TT(t,r)}function SN(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,i=t.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(Be(314))}n!==null&&n.delete(e),TT(t,r)}var AT;AT=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||Xi.current)Yi=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return Yi=!1,cN(t,e,r);Yi=!!(t.flags&131072)}else Yi=!1,$r&&e.flags&1048576&&bw(e,jh,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;hh(t,e),t=e.pendingProps;var i=pu(e,Ei.current);nu(e,r),i=T1(null,e,n,t,i,r);var s=A1();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,qi(n)?(s=!0,Mh(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,y1(e),i.updater=Pp,e.stateNode=i,i._reactInternals=e,Qm(e,n,t,r),e=ex(null,e,n,!0,s,r)):(e.tag=0,$r&&s&&f1(e),Ii(null,e,i,r),e=e.child),e;case 16:n=e.elementType;e:{switch(hh(t,e),t=e.pendingProps,i=n._init,n=i(n._payload),e.type=n,i=e.tag=TN(n),t=qs(n,t),i){case 0:e=Zm(null,e,n,t,r);break e;case 1:e=F2(null,e,n,t,r);break e;case 11:e=C2(null,e,n,t,r);break e;case 14:e=k2(null,e,n,qs(n.type,t),r);break e}throw Error(Be(306,n,""))}return e;case 0:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:qs(n,i),Zm(t,e,n,i,r);case 1:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:qs(n,i),F2(t,e,n,i,r);case 3:e:{if(lT(e),t===null)throw Error(Be(387));n=e.pendingProps,s=e.memoizedState,i=s.element,Ow(t,e),Vh(e,n,null,r);var a=e.memoizedState;if(n=a.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=vu(Error(Be(423)),e),e=b2(t,e,n,r,i);break e}else if(n!==i){i=vu(Error(Be(424)),e),e=b2(t,e,n,r,i);break e}else for(fs=el(e.stateNode.containerInfo.firstChild),hs=e,$r=!0,Js=null,r=Dw(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(gu(),n===i){e=ao(t,e,r);break e}Ii(t,e,n,r)}e=e.child}return e;case 5:return Mw(e),t===null&&Ym(e),n=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,a=i.children,Wm(n,i)?a=null:s!==null&&Wm(n,s)&&(e.flags|=32),oT(t,e),Ii(t,e,a,r),e.child;case 6:return t===null&&Ym(e),null;case 13:return cT(t,e,r);case 4:return _1(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=mu(e,null,n,r):Ii(t,e,n,r),e.child;case 11:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:qs(n,i),C2(t,e,n,i,r);case 7:return Ii(t,e,e.pendingProps,r),e.child;case 8:return Ii(t,e,e.pendingProps.children,r),e.child;case 12:return Ii(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,i=e.pendingProps,s=e.memoizedProps,a=i.value,Ir(Lh,n._currentValue),n._currentValue=a,s!==null)if(aa(s.value,a)){if(s.children===i.children&&!Xi.current){e=ao(t,e,r);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var o=s.dependencies;if(o!==null){a=s.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(s.tag===1){l=Ja(-1,r&-r),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var f=u.pending;f===null?l.next=l:(l.next=f.next,f.next=l),u.pending=l}}s.lanes|=r,l=s.alternate,l!==null&&(l.lanes|=r),Xm(s.return,r,e),o.lanes|=r;break}l=l.next}}else if(s.tag===10)a=s.type===e.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(Be(341));a.lanes|=r,o=a.alternate,o!==null&&(o.lanes|=r),Xm(a,r,e),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===e){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}Ii(t,e,i.children,r),e=e.child}return e;case 9:return i=e.type,n=e.pendingProps.children,nu(e,r),i=Bs(i),n=n(i),e.flags|=1,Ii(t,e,n,r),e.child;case 14:return n=e.type,i=qs(n,e.pendingProps),i=qs(n.type,i),k2(t,e,n,i,r);case 15:return sT(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:qs(n,i),hh(t,e),e.tag=1,qi(n)?(t=!0,Mh(e)):t=!1,nu(e,r),rT(e,n,i),Qm(e,n,i,r),ex(null,e,n,!0,t,r);case 19:return uT(t,e,r);case 22:return aT(t,e,r)}throw Error(Be(156,e.tag))};function CT(t,e){return ZS(t,e)}function wN(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ps(t,e,r,n){return new wN(t,e,r,n)}function O1(t){return t=t.prototype,!(!t||!t.isReactComponent)}function TN(t){if(typeof t=="function")return O1(t)?1:0;if(t!=null){if(t=t.$$typeof,t===e1)return 11;if(t===t1)return 14}return 2}function il(t,e){var r=t.alternate;return r===null?(r=Ps(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function mh(t,e,r,n,i,s){var a=2;if(n=t,typeof t=="function")O1(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case Uc:return Vl(r.children,i,s,e);case Zx:a=8,i|=8;break;case Em:return t=Ps(12,r,e,i|2),t.elementType=Em,t.lanes=s,t;case Sm:return t=Ps(13,r,e,i),t.elementType=Sm,t.lanes=s,t;case wm:return t=Ps(19,r,e,i),t.elementType=wm,t.lanes=s,t;case MS:return Bp(r,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case PS:a=10;break e;case OS:a=9;break e;case e1:a=11;break e;case t1:a=14;break e;case Bo:a=16,n=null;break e}throw Error(Be(130,t==null?t:typeof t,""))}return e=Ps(a,r,e,i),e.elementType=t,e.type=n,e.lanes=s,e}function Vl(t,e,r,n){return t=Ps(7,t,n,e),t.lanes=r,t}function Bp(t,e,r,n){return t=Ps(22,t,n,e),t.elementType=MS,t.lanes=r,t.stateNode={isHidden:!1},t}function Ug(t,e,r){return t=Ps(6,t,null,e),t.lanes=r,t}function Vg(t,e,r){return e=Ps(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function AN(t,e,r,n,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Eg(0),this.expirationTimes=Eg(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Eg(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function M1(t,e,r,n,i,s,a,o,l){return t=new AN(t,e,r,o,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Ps(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},y1(s),t}function CN(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Lc,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function kT(t){if(!t)return dl;t=t._reactInternals;e:{if(dc(t)!==t||t.tag!==1)throw Error(Be(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(qi(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Be(171))}if(t.tag===1){var r=t.type;if(qi(r))return kw(t,r,e)}return e}function FT(t,e,r,n,i,s,a,o,l){return t=M1(r,n,!0,t,i,s,a,o,l),t.context=kT(null),r=t.current,n=Di(),i=nl(r),s=Ja(n,i),s.callback=e??null,tl(r,s,i),t.current.lanes=i,Vf(t,i,n),Qi(t,n),t}function jp(t,e,r,n){var i=e.current,s=Di(),a=nl(i);return r=kT(r),e.context===null?e.context=r:e.pendingContext=r,e=Ja(s,a),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=tl(i,e,a),t!==null&&(na(t,i,a,s),uh(t,i,a)),a}function Xh(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function L2(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function B1(t,e){L2(t,e),(t=t.alternate)&&L2(t,e)}function kN(){return null}var bT=typeof reportError=="function"?reportError:function(t){console.error(t)};function j1(t){this._internalRoot=t}Lp.prototype.render=j1.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Be(409));jp(t,e,null,null)};Lp.prototype.unmount=j1.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Jl(function(){jp(null,t,null,null)}),e[io]=null}};function Lp(t){this._internalRoot=t}Lp.prototype.unstable_scheduleHydration=function(t){if(t){var e=aw();t={blockedOn:null,target:t,priority:e};for(var r=0;r<Lo.length&&e!==0&&e<Lo[r].priority;r++);Lo.splice(r,0,t),r===0&&lw(t)}};function L1(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Up(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function U2(){}function FN(t,e,r,n,i){if(i){if(typeof n=="function"){var s=n;n=function(){var u=Xh(a);s.call(u)}}var a=FT(e,n,t,0,null,!1,!1,"",U2);return t._reactRootContainer=a,t[io]=a.current,of(t.nodeType===8?t.parentNode:t),Jl(),a}for(;i=t.lastChild;)t.removeChild(i);if(typeof n=="function"){var o=n;n=function(){var u=Xh(l);o.call(u)}}var l=M1(t,0,!1,null,null,!1,!1,"",U2);return t._reactRootContainer=l,t[io]=l.current,of(t.nodeType===8?t.parentNode:t),Jl(function(){jp(e,l,r,n)}),l}function Vp(t,e,r,n,i){var s=r._reactRootContainer;if(s){var a=s;if(typeof i=="function"){var o=i;i=function(){var l=Xh(a);o.call(l)}}jp(e,a,t,i)}else a=FN(r,e,t,i,n);return Xh(a)}iw=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=Ed(e.pendingLanes);r!==0&&(i1(e,r|1),Qi(e,pn()),!(rr&6)&&(yu=pn()+500,El()))}break;case 13:Jl(function(){var n=so(t,1);if(n!==null){var i=Di();na(n,t,1,i)}}),B1(t,1)}};s1=function(t){if(t.tag===13){var e=so(t,134217728);if(e!==null){var r=Di();na(e,t,134217728,r)}B1(t,134217728)}};sw=function(t){if(t.tag===13){var e=nl(t),r=so(t,e);if(r!==null){var n=Di();na(r,t,e,n)}B1(t,e)}};aw=function(){return Er};ow=function(t,e){var r=Er;try{return Er=t,e()}finally{Er=r}};Dm=function(t,e,r){switch(e){case"input":if(Cm(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var i=Np(n);if(!i)throw Error(Be(90));jS(n),Cm(n,i)}}}break;case"textarea":US(t,r);break;case"select":e=r.value,e!=null&&Zc(t,!!r.multiple,e,!1)}};KS=R1;YS=Jl;var bN={usingClientEntryPoint:!1,Events:[Wf,Hc,Np,$S,GS,R1]},fd={findFiberByHostInstance:Ol,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},IN={bundleType:fd.bundleType,version:fd.version,rendererPackageName:fd.rendererPackageName,rendererConfig:fd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:po.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=QS(t),t===null?null:t.stateNode},findFiberByHostInstance:fd.findFiberByHostInstance||kN,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var O0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!O0.isDisabled&&O0.supportsFiber)try{kp=O0.inject(IN),Fa=O0}catch{}}xs.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=bN;xs.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!L1(e))throw Error(Be(200));return CN(t,e,null,r)};xs.createRoot=function(t,e){if(!L1(t))throw Error(Be(299));var r=!1,n="",i=bT;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=M1(t,1,!1,null,null,r,!1,n,i),t[io]=e.current,of(t.nodeType===8?t.parentNode:t),new j1(e)};xs.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Be(188)):(t=Object.keys(t).join(","),Error(Be(268,t)));return t=QS(e),t=t===null?null:t.stateNode,t};xs.flushSync=function(t){return Jl(t)};xs.hydrate=function(t,e,r){if(!Up(e))throw Error(Be(200));return Vp(null,t,e,!0,r)};xs.hydrateRoot=function(t,e,r){if(!L1(t))throw Error(Be(405));var n=r!=null&&r.hydratedSources||null,i=!1,s="",a=bT;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(a=r.onRecoverableError)),e=FT(e,null,t,1,r??null,i,!1,s,a),t[io]=e.current,of(t),n)for(t=0;t<n.length;t++)r=n[t],i=r._getVersion,i=i(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,i]:e.mutableSourceEagerHydrationData.push(r,i);return new Lp(e)};xs.render=function(t,e,r){if(!Up(e))throw Error(Be(200));return Vp(null,t,e,!1,r)};xs.unmountComponentAtNode=function(t){if(!Up(t))throw Error(Be(40));return t._reactRootContainer?(Jl(function(){Vp(null,null,t,!1,function(){t._reactRootContainer=null,t[io]=null})}),!0):!1};xs.unstable_batchedUpdates=R1;xs.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!Up(r))throw Error(Be(200));if(t==null||t._reactInternals===void 0)throw Error(Be(38));return Vp(t,e,r,!1,n)};xs.version="18.3.1-next-f1338f8080-20240426";function IT(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(IT)}catch(t){console.error(t)}}IT(),IS.exports=xs;var NN=IS.exports,V2=NN;ym.createRoot=V2.createRoot,ym.hydrateRoot=V2.hydrateRoot;/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var qh={};qh.version="0.18.5";var NT=1252,RN=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],U1={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},V1=function(t){RN.indexOf(t)!=-1&&(NT=U1[0]=t)};function DN(){V1(1252)}var Zs=function(t){V1(t)};function z1(){Zs(1200),DN()}function z2(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function PN(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function RT(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var wd=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?PN(t.slice(2)):e==254&&r==255?RT(t.slice(2)):e==65279?t.slice(1):t},M0=function(e){return String.fromCharCode(e)},W2=function(e){return String.fromCharCode(e)},mf,Ko="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function xf(t){for(var e="",r=0,n=0,i=0,s=0,a=0,o=0,l=0,u=0;u<t.length;)r=t.charCodeAt(u++),s=r>>2,n=t.charCodeAt(u++),a=(r&3)<<4|n>>4,i=t.charCodeAt(u++),o=(n&15)<<2|i>>6,l=i&63,isNaN(n)?o=l=64:isNaN(i)&&(l=64),e+=Ko.charAt(s)+Ko.charAt(a)+Ko.charAt(o)+Ko.charAt(l);return e}function ms(t){var e="",r=0,n=0,i=0,s=0,a=0,o=0,l=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<t.length;)s=Ko.indexOf(t.charAt(u++)),a=Ko.indexOf(t.charAt(u++)),r=s<<2|a>>4,e+=String.fromCharCode(r),o=Ko.indexOf(t.charAt(u++)),n=(a&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(n)),l=Ko.indexOf(t.charAt(u++)),i=(o&3)<<6|l,l!==64&&(e+=String.fromCharCode(i));return e}var Lt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),go=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function fl(t){return Lt?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function H2(t){return Lt?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var us=function(e){return Lt?go(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function zp(t){if(typeof ArrayBuffer>"u")return us(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n!=t.length;++n)r[n]=t.charCodeAt(n)&255;return e}function Sl(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function ON(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}function W1(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return W1(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var Hn=Lt?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:go(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),i=0;for(e=0,r=0;e<t.length;r+=i,++e)if(i=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function MN(t){for(var e=[],r=0,n=t.length+250,i=fl(t.length+255),s=0;s<t.length;++s){var a=t.charCodeAt(s);if(a<128)i[r++]=a;else if(a<2048)i[r++]=192|a>>6&31,i[r++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=t.charCodeAt(++s)&1023;i[r++]=240|a>>8&7,i[r++]=128|a>>2&63,i[r++]=128|o>>6&15|(a&3)<<4,i[r++]=128|o&63}else i[r++]=224|a>>12&15,i[r++]=128|a>>6&63,i[r++]=128|a&63;r>n&&(e.push(i.slice(0,r)),r=0,i=fl(65535),n=65530)}return e.push(i.slice(0,r)),Hn(e)}var Pi=/\u0000/g,Td=/[\u0001-\u0006]/g;function su(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function ea(t,e){var r=""+t;return r.length>=e?r:an("0",e-r.length)+r}function H1(t,e){var r=""+t;return r.length>=e?r:an(" ",e-r.length)+r}function Qh(t,e){var r=""+t;return r.length>=e?r:r+an(" ",e-r.length)}function BN(t,e){var r=""+Math.round(t);return r.length>=e?r:an("0",e-r.length)+r}function jN(t,e){var r=""+t;return r.length>=e?r:an("0",e-r.length)+r}var $2=Math.pow(2,32);function Ic(t,e){if(t>$2||t<-$2)return BN(t,e);var r=Math.round(t);return jN(r,e)}function Jh(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var G2=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],zg=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function LN(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var pt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},K2={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},UN={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Zh(t,e,r){for(var n=t<0?-1:1,i=t*n,s=0,a=1,o=0,l=1,u=0,f=0,p=Math.floor(i);u<e&&(p=Math.floor(i),o=p*a+s,f=p*u+l,!(i-p<5e-8));)i=1/(i-p),s=a,a=o,l=u,u=f;if(f>e&&(u>e?(f=l,o=s):(f=u,o=a)),!r)return[0,n*o,f];var g=Math.floor(n*o/f);return[g,n*o-g*f,f]}function jl(t,e,r){if(t>2958465||t<0)return null;var n=t|0,i=Math.floor(86400*(t-n)),s=0,a=[],o={D:n,T:i,u:86400*(t-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++n,++o.D)),n===60)a=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)a=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),a=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),n<60&&(s=(s+6)%7),r&&(s=GN(l,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=s,o}var DT=new Date(1899,11,31,0,0,0),VN=DT.getTime(),zN=new Date(1900,2,1,0,0,0);function PT(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=zN&&(r+=24*60*60*1e3),(r-(VN+(t.getTimezoneOffset()-DT.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function $1(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function WN(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function HN(t){var e=t<0?12:11,r=$1(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function $N(t){var e=$1(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function vf(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=HN(t):e===10?r=t.toFixed(10).substr(0,12):r=$N(t),$1(WN(r.toUpperCase()))}function Zl(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):vf(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return Ls(14,PT(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function GN(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function KN(t,e,r,n){var i="",s=0,a=0,o=r.y,l,u=0;switch(t){case 98:o=r.y+543;case 121:switch(e.length){case 1:case 2:l=o%100,u=2;break;default:l=o%1e4,u=4;break}break;case 109:switch(e.length){case 1:case 2:l=r.m,u=e.length;break;case 3:return zg[r.m-1][1];case 5:return zg[r.m-1][0];default:return zg[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:l=r.d,u=e.length;break;case 3:return G2[r.q][0];default:return G2[r.q][1]}break;case 104:switch(e.length){case 1:case 2:l=1+(r.H+11)%12,u=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:l=r.H,u=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:l=r.M,u=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?ea(r.S,e.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,s=Math.round(a*(r.S+r.u)),s>=60*a&&(s=0),e==="s"?s===0?"0":""+s/a:(i=ea(s,2+n),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}u=e.length===3?1:2;break;case 101:l=o,u=1;break}var f=u>0?ea(l,u):"";return f}function Yo(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var OT=/%/g;function YN(t,e,r){var n=e.replace(OT,""),i=e.length-n.length;return Za(t,n,r*Math.pow(10,2*i))+an("%",i)}function XN(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Za(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function MT(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+MT(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),r.indexOf("e")===-1){var a=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,u,f){return l+u+f.substr(0,(i+s)%i)+"."+f.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var BT=/# (\?+)( ?)\/( ?)(\d+)/;function qN(t,e,r){var n=parseInt(t[4],10),i=Math.round(e*n),s=Math.floor(i/n),a=i-s*n,o=n;return r+(s===0?"":""+s)+" "+(a===0?an(" ",t[1].length+1+t[4].length):H1(a,t[1].length)+t[2]+"/"+t[3]+ea(o,t[4].length))}function QN(t,e,r){return r+(e===0?"":""+e)+an(" ",t[1].length+2+t[4].length)}var jT=/^#*0*\.([0#]+)/,LT=/\).*[0#]/,UT=/\(###\) ###\\?-####/;function Ni(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function Y2(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function X2(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function JN(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function ZN(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Cs(t,e,r){if(t.charCodeAt(0)===40&&!e.match(LT)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Cs("n",n,r):"("+Cs("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return XN(t,e,r);if(e.indexOf("%")!==-1)return YN(t,e,r);if(e.indexOf("E")!==-1)return MT(e,r);if(e.charCodeAt(0)===36)return"$"+Cs(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),u=r<0?"-":"";if(e.match(/^00+$/))return u+Ic(l,e.length);if(e.match(/^[#?]+$/))return i=Ic(r,0),i==="0"&&(i=""),i.length>e.length?i:Ni(e.substr(0,e.length-i.length))+i;if(s=e.match(BT))return qN(s,l,u);if(e.match(/^#+0+$/))return u+Ic(l,e.length-e.indexOf("0"));if(s=e.match(jT))return i=Y2(r,s[1].length).replace(/^([^\.]+)$/,"$1."+Ni(s[1])).replace(/\.$/,"."+Ni(s[1])).replace(/\.(\d*)$/,function(y,x){return"."+x+an("0",Ni(s[1]).length-x.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return u+Y2(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return u+Yo(Ic(l,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Cs(t,e,-r):Yo(""+(Math.floor(r)+JN(r,s[1].length)))+"."+ea(X2(r,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return Cs(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=su(Cs(t,e.replace(/[\\-]/g,""),r)),a=0,su(su(e.replace(/\\/g,"")).replace(/[0#]/g,function(y){return a<i.length?i.charAt(a++):y==="0"?"0":""}));if(e.match(UT))return i=Cs(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var f="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=Zh(l,Math.pow(10,a)-1,!1),i=""+u,f=Za("n",s[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),i+=f+s[2]+"/"+s[3],f=Qh(o[2],a),f.length<s[4].length&&(f=Ni(s[4].substr(s[4].length-f.length))+f),i+=f,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=Zh(l,Math.pow(10,a)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?H1(o[1],a)+s[2]+"/"+s[3]+Qh(o[2],a):an(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=Ic(r,0),e.length<=i.length?i:Ni(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var p=e.indexOf(".")-a,g=e.length-i.length-p;return Ni(e.substr(0,p)+i+e.substr(e.length-g))}if(s=e.match(/^00,000\.([#0]*0)$/))return a=X2(r,s[1].length),r<0?"-"+Cs(t,e,-r):Yo(ZN(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?ea(0,3-y.length):"")+y})+"."+ea(a,s[1].length);switch(e){case"###,##0.00":return Cs(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var m=Yo(Ic(l,0));return m!=="0"?u+m:"";case"###,###.00":return Cs(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Cs(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function eR(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Za(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function tR(t,e,r){var n=e.replace(OT,""),i=e.length-n.length;return Za(t,n,r*Math.pow(10,2*i))+an("%",i)}function VT(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+VT(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!r.match(/[Ee]/)){var a=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,u,f){return l+u+f.substr(0,(i+s)%i)+"."+f.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Sa(t,e,r){if(t.charCodeAt(0)===40&&!e.match(LT)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Sa("n",n,r):"("+Sa("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return eR(t,e,r);if(e.indexOf("%")!==-1)return tR(t,e,r);if(e.indexOf("E")!==-1)return VT(e,r);if(e.charCodeAt(0)===36)return"$"+Sa(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),u=r<0?"-":"";if(e.match(/^00+$/))return u+ea(l,e.length);if(e.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>e.length?i:Ni(e.substr(0,e.length-i.length))+i;if(s=e.match(BT))return QN(s,l,u);if(e.match(/^#+0+$/))return u+ea(l,e.length-e.indexOf("0"));if(s=e.match(jT))return i=(""+r).replace(/^([^\.]+)$/,"$1."+Ni(s[1])).replace(/\.$/,"."+Ni(s[1])),i=i.replace(/\.(\d*)$/,function(y,x){return"."+x+an("0",Ni(s[1]).length-x.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return u+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return u+Yo(""+l);if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Sa(t,e,-r):Yo(""+r)+"."+an("0",s[1].length);if(s=e.match(/^#,#*,#0/))return Sa(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=su(Sa(t,e.replace(/[\\-]/g,""),r)),a=0,su(su(e.replace(/\\/g,"")).replace(/[0#]/g,function(y){return a<i.length?i.charAt(a++):y==="0"?"0":""}));if(e.match(UT))return i=Sa(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var f="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=Zh(l,Math.pow(10,a)-1,!1),i=""+u,f=Za("n",s[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),i+=f+s[2]+"/"+s[3],f=Qh(o[2],a),f.length<s[4].length&&(f=Ni(s[4].substr(s[4].length-f.length))+f),i+=f,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=Zh(l,Math.pow(10,a)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?H1(o[1],a)+s[2]+"/"+s[3]+Qh(o[2],a):an(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=""+r,e.length<=i.length?i:Ni(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var p=e.indexOf(".")-a,g=e.length-i.length-p;return Ni(e.substr(0,p)+i+e.substr(e.length-g))}if(s=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Sa(t,e,-r):Yo(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?ea(0,3-y.length):"")+y})+"."+ea(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var m=Yo(""+l);return m!=="0"?u+m:"";default:if(e.match(/\.[0#?]*$/))return Sa(t,e.slice(0,e.lastIndexOf(".")),r)+Ni(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Za(t,e,r){return(r|0)===r?Sa(t,e,r):Cs(t,e,r)}function rR(t){for(var e=[],r=!1,n=0,i=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(i,n-i),i=n+1}if(e[e.length]=t.substr(i),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var zT=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Ou(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":Jh(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(zT))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function nR(t,e,r,n){for(var i=[],s="",a=0,o="",l="t",u,f,p,g="H";a<t.length;)switch(o=t.charAt(a)){case"G":if(!Jh(t,a))throw new Error("unrecognized character "+o+" in "+t);i[i.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(p=t.charCodeAt(++a))!==34&&a<t.length;)s+=String.fromCharCode(p);i[i.length]={t:"t",v:s},++a;break;case"\\":var m=t.charAt(++a),y=m==="("||m===")"?m:"t";i[i.length]={t:y,v:m},++a;break;case"_":i[i.length]={t:"t",v:" "},a+=2;break;case"@":i[i.length]={t:"T",v:e},++a;break;case"B":case"b":if(t.charAt(a+1)==="1"||t.charAt(a+1)==="2"){if(u==null&&(u=jl(e,r,t.charAt(a+1)==="2"),u==null))return"";i[i.length]={t:"X",v:t.substr(a,2)},l=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||u==null&&(u=jl(e,r),u==null))return"";for(s=o;++a<t.length&&t.charAt(a).toLowerCase()===o;)s+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=g),i[i.length]={t:o,v:s},l=o;break;case"A":case"a":case"":var x={t:o,v:o};if(u==null&&(u=jl(e,r)),t.substr(a,3).toUpperCase()==="A/P"?(u!=null&&(x.v=u.H>=12?"P":"A"),x.t="T",g="h",a+=3):t.substr(a,5).toUpperCase()==="AM/PM"?(u!=null&&(x.v=u.H>=12?"PM":"AM"),x.t="T",a+=5,g="h"):t.substr(a,5).toUpperCase()==="/"?(u!=null&&(x.v=u.H>=12?"":""),x.t="T",a+=5,g="h"):(x.t="t",++a),u==null&&x.t==="T")return"";i[i.length]=x,l=o;break;case"[":for(s=o;t.charAt(a++)!=="]"&&a<t.length;)s+=t.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(zT)){if(u==null&&(u=jl(e,r),u==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",Ou(t)||(i[i.length]={t:"t",v:s}));break;case".":if(u!=null){for(s=o;++a<t.length&&(o=t.charAt(a))==="0";)s+=o;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++a<t.length&&"0#?.,E+-%".indexOf(o=t.charAt(a))>-1;)s+=o;i[i.length]={t:"n",v:s};break;case"?":for(s=o;t.charAt(++a)===o;)s+=o;i[i.length]={t:o,v:s},l=o;break;case"*":++a,(t.charAt(a)==" "||t.charAt(a)=="*")&&++a;break;case"(":case")":i[i.length]={t:n===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;a<t.length&&"0123456789".indexOf(t.charAt(++a))>-1;)s+=t.charAt(a);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:o,v:o},++a;break;case"$":i[i.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+t);i[i.length]={t:"t",v:o},++a;break}var S=0,A=0,C;for(a=i.length-1,l="t";a>=0;--a)switch(i[a].t){case"h":case"H":i[a].t=g,l="h",S<1&&(S=1);break;case"s":(C=i[a].v.match(/\.0+$/))&&(A=Math.max(A,C[0].length-1)),S<3&&(S=3);case"d":case"y":case"M":case"e":l=i[a].t;break;case"m":l==="s"&&(i[a].t="M",S<2&&(S=2));break;case"X":break;case"Z":S<1&&i[a].v.match(/[Hh]/)&&(S=1),S<2&&i[a].v.match(/[Mm]/)&&(S=2),S<3&&i[a].v.match(/[Ss]/)&&(S=3)}switch(S){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var E="",O;for(a=0;a<i.length;++a)switch(i[a].t){case"t":case"T":case" ":case"D":break;case"X":i[a].v="",i[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[a].v=KN(i[a].t.charCodeAt(0),i[a].v,u,A),i[a].t="t";break;case"n":case"?":for(O=a+1;i[O]!=null&&((o=i[O].t)==="?"||o==="D"||(o===" "||o==="t")&&i[O+1]!=null&&(i[O+1].t==="?"||i[O+1].t==="t"&&i[O+1].v==="/")||i[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[O].v==="/"||i[O].v===" "&&i[O+1]!=null&&i[O+1].t=="?"));)i[a].v+=i[O].v,i[O]={v:"",t:";"},++O;E+=i[a].v,a=O-1;break;case"G":i[a].t="t",i[a].v=Zl(e,r);break}var Q="",H,w;if(E.length>0){E.charCodeAt(0)==40?(H=e<0&&E.charCodeAt(0)===45?-e:e,w=Za("n",E,H)):(H=e<0&&n>1?-e:e,w=Za("n",E,H),H<0&&i[0]&&i[0].t=="t"&&(w=w.substr(1),i[0].v="-"+i[0].v)),O=w.length-1;var F=i.length;for(a=0;a<i.length;++a)if(i[a]!=null&&i[a].t!="t"&&i[a].v.indexOf(".")>-1){F=a;break}var T=i.length;if(F===i.length&&w.indexOf("E")===-1){for(a=i.length-1;a>=0;--a)i[a]==null||"n?".indexOf(i[a].t)===-1||(O>=i[a].v.length-1?(O-=i[a].v.length,i[a].v=w.substr(O+1,i[a].v.length)):O<0?i[a].v="":(i[a].v=w.substr(0,O+1),O=-1),i[a].t="t",T=a);O>=0&&T<i.length&&(i[T].v=w.substr(0,O+1)+i[T].v)}else if(F!==i.length&&w.indexOf("E")===-1){for(O=w.indexOf(".")-1,a=F;a>=0;--a)if(!(i[a]==null||"n?".indexOf(i[a].t)===-1)){for(f=i[a].v.indexOf(".")>-1&&a===F?i[a].v.indexOf(".")-1:i[a].v.length-1,Q=i[a].v.substr(f+1);f>=0;--f)O>=0&&(i[a].v.charAt(f)==="0"||i[a].v.charAt(f)==="#")&&(Q=w.charAt(O--)+Q);i[a].v=Q,i[a].t="t",T=a}for(O>=0&&T<i.length&&(i[T].v=w.substr(0,O+1)+i[T].v),O=w.indexOf(".")+1,a=F;a<i.length;++a)if(!(i[a]==null||"n?(".indexOf(i[a].t)===-1&&a!==F)){for(f=i[a].v.indexOf(".")>-1&&a===F?i[a].v.indexOf(".")+1:0,Q=i[a].v.substr(0,f);f<i[a].v.length;++f)O<w.length&&(Q+=w.charAt(O++));i[a].v=Q,i[a].t="t",T=a}}}for(a=0;a<i.length;++a)i[a]!=null&&"n?".indexOf(i[a].t)>-1&&(H=n>1&&e<0&&a>0&&i[a-1].v==="-"?-e:e,i[a].v=Za(i[a].t,i[a].v,H),i[a].t="t");var N="";for(a=0;a!==i.length;++a)i[a]!=null&&(N+=i[a].v);return N}var q2=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Q2(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function iR(t,e){var r=rR(t),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var a=r[0].match(q2),o=r[1].match(q2);return Q2(e,a)?[n,r[0]]:Q2(e,o)?[n,r[1]]:[n,r[a!=null&&o!=null?2:1]]}return[n,s]}function Ls(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:pt)[t],n==null&&(n=r.table&&r.table[K2[t]]||pt[K2[t]]),n==null&&(n=UN[t]||"General");break}if(Jh(n,0))return Zl(e,r);e instanceof Date&&(e=PT(e,r.date1904));var i=iR(n,e);if(Jh(i[1]))return Zl(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return nR(i[1],e,r,i[0])}function eo(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(pt[r]==null){e<0&&(e=r);continue}if(pt[r]==t){e=r;break}}e<0&&(e=391)}return pt[e]=t,e}function Wp(t){for(var e=0;e!=392;++e)t[e]!==void 0&&eo(t[e],e)}function Mu(){pt=LN()}var sR={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},WT=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function aR(t){var e=typeof t=="number"?pt[t]:t;return e=e.replace(WT,"(\\d+)"),new RegExp("^"+e+"$")}function oR(t,e,r){var n=-1,i=-1,s=-1,a=-1,o=-1,l=-1;(e.match(WT)||[]).forEach(function(p,g){var m=parseInt(r[g+1],10);switch(p.toLowerCase().charAt(0)){case"y":n=m;break;case"d":s=m;break;case"h":a=m;break;case"s":l=m;break;case"m":a>=0?o=m:i=m;break}}),l>=0&&o==-1&&i>=0&&(o=i,i=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var f=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return a==-1&&o==-1&&l==-1?u:n==-1&&i==-1&&s==-1?f:u+"T"+f}var lR=function(){var t={};t.version="1.2.0";function e(){for(var w=0,F=new Array(256),T=0;T!=256;++T)w=T,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,F[T]=w;return typeof Int32Array<"u"?new Int32Array(F):F}var r=e();function n(w){var F=0,T=0,N=0,D=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(N=0;N!=256;++N)D[N]=w[N];for(N=0;N!=256;++N)for(T=w[N],F=256+N;F<4096;F+=256)T=D[F]=T>>>8^w[T&255];var P=[];for(N=1;N!=16;++N)P[N-1]=typeof Int32Array<"u"?D.subarray(N*256,N*256+256):D.slice(N*256,N*256+256);return P}var i=n(r),s=i[0],a=i[1],o=i[2],l=i[3],u=i[4],f=i[5],p=i[6],g=i[7],m=i[8],y=i[9],x=i[10],S=i[11],A=i[12],C=i[13],E=i[14];function O(w,F){for(var T=F^-1,N=0,D=w.length;N<D;)T=T>>>8^r[(T^w.charCodeAt(N++))&255];return~T}function Q(w,F){for(var T=F^-1,N=w.length-15,D=0;D<N;)T=E[w[D++]^T&255]^C[w[D++]^T>>8&255]^A[w[D++]^T>>16&255]^S[w[D++]^T>>>24]^x[w[D++]]^y[w[D++]]^m[w[D++]]^g[w[D++]]^p[w[D++]]^f[w[D++]]^u[w[D++]]^l[w[D++]]^o[w[D++]]^a[w[D++]]^s[w[D++]]^r[w[D++]];for(N+=15;D<N;)T=T>>>8^r[(T^w[D++])&255];return~T}function H(w,F){for(var T=F^-1,N=0,D=w.length,P=0,R=0;N<D;)P=w.charCodeAt(N++),P<128?T=T>>>8^r[(T^P)&255]:P<2048?(T=T>>>8^r[(T^(192|P>>6&31))&255],T=T>>>8^r[(T^(128|P&63))&255]):P>=55296&&P<57344?(P=(P&1023)+64,R=w.charCodeAt(N++)&1023,T=T>>>8^r[(T^(240|P>>8&7))&255],T=T>>>8^r[(T^(128|P>>2&63))&255],T=T>>>8^r[(T^(128|R>>6&15|(P&3)<<4))&255],T=T>>>8^r[(T^(128|R&63))&255]):(T=T>>>8^r[(T^(224|P>>12&15))&255],T=T>>>8^r[(T^(128|P>>6&63))&255],T=T>>>8^r[(T^(128|P&63))&255]);return~T}return t.table=r,t.bstr=O,t.buf=Q,t.str=H,t}(),ct=function(){var e={};e.version="1.2.1";function r(I,G){for(var j=I.split("/"),V=G.split("/"),q=0,J=0,pe=Math.min(j.length,V.length);q<pe;++q){if(J=j[q].length-V[q].length)return J;if(j[q]!=V[q])return j[q]<V[q]?-1:1}return j.length-V.length}function n(I){if(I.charAt(I.length-1)=="/")return I.slice(0,-1).indexOf("/")===-1?I:n(I.slice(0,-1));var G=I.lastIndexOf("/");return G===-1?I:I.slice(0,G+1)}function i(I){if(I.charAt(I.length-1)=="/")return i(I.slice(0,-1));var G=I.lastIndexOf("/");return G===-1?I:I.slice(G+1)}function s(I,G){typeof G=="string"&&(G=new Date(G));var j=G.getHours();j=j<<6|G.getMinutes(),j=j<<5|G.getSeconds()>>>1,I.write_shift(2,j);var V=G.getFullYear()-1980;V=V<<4|G.getMonth()+1,V=V<<5|G.getDate(),I.write_shift(2,V)}function a(I){var G=I.read_shift(2)&65535,j=I.read_shift(2)&65535,V=new Date,q=j&31;j>>>=5;var J=j&15;j>>>=4,V.setMilliseconds(0),V.setFullYear(j+1980),V.setMonth(J-1),V.setDate(q);var pe=G&31;G>>>=5;var ve=G&63;return G>>>=6,V.setHours(G),V.setMinutes(ve),V.setSeconds(pe<<1),V}function o(I){ei(I,0);for(var G={},j=0;I.l<=I.length-4;){var V=I.read_shift(2),q=I.read_shift(2),J=I.l+q,pe={};switch(V){case 21589:j=I.read_shift(1),j&1&&(pe.mtime=I.read_shift(4)),q>5&&(j&2&&(pe.atime=I.read_shift(4)),j&4&&(pe.ctime=I.read_shift(4))),pe.mtime&&(pe.mt=new Date(pe.mtime*1e3));break}I.l=J,G[V]=pe}return G}var l;function u(){return l||(l={})}function f(I,G){if(I[0]==80&&I[1]==75)return la(I,G);if((I[0]|32)==109&&(I[1]|32)==105)return ua(I,G);if(I.length<512)throw new Error("CFB file size "+I.length+" < 512");var j=3,V=512,q=0,J=0,pe=0,ve=0,he=0,de=[],ge=I.slice(0,512);ei(ge,0);var we=p(ge);switch(j=we[0],j){case 3:V=512;break;case 4:V=4096;break;case 0:if(we[1]==0)return la(I,G);default:throw new Error("Major Version: Expected 3 or 4 saw "+j)}V!==512&&(ge=I.slice(0,V),ei(ge,28));var ze=I.slice(0,V);g(ge,j);var je=ge.read_shift(4,"i");if(j===3&&je!==0)throw new Error("# Directory Sectors: Expected 0 saw "+je);ge.l+=4,pe=ge.read_shift(4,"i"),ge.l+=4,ge.chk("00100000","Mini Stream Cutoff Size: "),ve=ge.read_shift(4,"i"),q=ge.read_shift(4,"i"),he=ge.read_shift(4,"i"),J=ge.read_shift(4,"i");for(var Pe=-1,We=0;We<109&&(Pe=ge.read_shift(4,"i"),!(Pe<0));++We)de[We]=Pe;var ut=m(I,V);S(he,J,ut,V,de);var mr=C(ut,pe,de,V);mr[pe].name="!Directory",q>0&&ve!==R&&(mr[ve].name="!MiniFAT"),mr[de[0]].name="!FAT",mr.fat_addrs=de,mr.ssz=V;var sr={},Xt=[],ki=[],Va=[];E(pe,mr,ut,Xt,q,sr,ki,ve),y(ki,Va,Xt),Xt.shift();var es={FileIndex:ki,FullPaths:Va};return G&&G.raw&&(es.raw={header:ze,sectors:ut}),es}function p(I){if(I[I.l]==80&&I[I.l+1]==75)return[0,0];I.chk(Xe,"Header Signature: "),I.l+=16;var G=I.read_shift(2,"u");return[I.read_shift(2,"u"),G]}function g(I,G){var j=9;switch(I.l+=2,j=I.read_shift(2)){case 9:if(G!=3)throw new Error("Sector Shift: Expected 9 saw "+j);break;case 12:if(G!=4)throw new Error("Sector Shift: Expected 12 saw "+j);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+j)}I.chk("0600","Mini Sector Shift: "),I.chk("000000000000","Reserved: ")}function m(I,G){for(var j=Math.ceil(I.length/G)-1,V=[],q=1;q<j;++q)V[q-1]=I.slice(q*G,(q+1)*G);return V[j-1]=I.slice(j*G),V}function y(I,G,j){for(var V=0,q=0,J=0,pe=0,ve=0,he=j.length,de=[],ge=[];V<he;++V)de[V]=ge[V]=V,G[V]=j[V];for(;ve<ge.length;++ve)V=ge[ve],q=I[V].L,J=I[V].R,pe=I[V].C,de[V]===V&&(q!==-1&&de[q]!==q&&(de[V]=de[q]),J!==-1&&de[J]!==J&&(de[V]=de[J])),pe!==-1&&(de[pe]=V),q!==-1&&V!=de[V]&&(de[q]=de[V],ge.lastIndexOf(q)<ve&&ge.push(q)),J!==-1&&V!=de[V]&&(de[J]=de[V],ge.lastIndexOf(J)<ve&&ge.push(J));for(V=1;V<he;++V)de[V]===V&&(J!==-1&&de[J]!==J?de[V]=de[J]:q!==-1&&de[q]!==q&&(de[V]=de[q]));for(V=1;V<he;++V)if(I[V].type!==0){if(ve=V,ve!=de[ve])do ve=de[ve],G[V]=G[ve]+"/"+G[V];while(ve!==0&&de[ve]!==-1&&ve!=de[ve]);de[V]=-1}for(G[0]+="/",V=1;V<he;++V)I[V].type!==2&&(G[V]+="/")}function x(I,G,j){for(var V=I.start,q=I.size,J=[],pe=V;j&&q>0&&pe>=0;)J.push(G.slice(pe*P,pe*P+P)),q-=P,pe=Dl(j,pe*4);return J.length===0?Ee(0):Hn(J).slice(0,I.size)}function S(I,G,j,V,q){var J=R;if(I===R){if(G!==0)throw new Error("DIFAT chain shorter than expected")}else if(I!==-1){var pe=j[I],ve=(V>>>2)-1;if(!pe)return;for(var he=0;he<ve&&(J=Dl(pe,he*4))!==R;++he)q.push(J);S(Dl(pe,V-4),G-1,j,V,q)}}function A(I,G,j,V,q){var J=[],pe=[];q||(q=[]);var ve=V-1,he=0,de=0;for(he=G;he>=0;){q[he]=!0,J[J.length]=he,pe.push(I[he]);var ge=j[Math.floor(he*4/V)];if(de=he*4&ve,V<4+de)throw new Error("FAT boundary crossed: "+he+" 4 "+V);if(!I[ge])break;he=Dl(I[ge],de)}return{nodes:J,data:c_([pe])}}function C(I,G,j,V){var q=I.length,J=[],pe=[],ve=[],he=[],de=V-1,ge=0,we=0,ze=0,je=0;for(ge=0;ge<q;++ge)if(ve=[],ze=ge+G,ze>=q&&(ze-=q),!pe[ze]){he=[];var Pe=[];for(we=ze;we>=0;){Pe[we]=!0,pe[we]=!0,ve[ve.length]=we,he.push(I[we]);var We=j[Math.floor(we*4/V)];if(je=we*4&de,V<4+je)throw new Error("FAT boundary crossed: "+we+" 4 "+V);if(!I[We]||(we=Dl(I[We],je),Pe[we]))break}J[ze]={nodes:ve,data:c_([he])}}return J}function E(I,G,j,V,q,J,pe,ve){for(var he=0,de=V.length?2:0,ge=G[I].data,we=0,ze=0,je;we<ge.length;we+=128){var Pe=ge.slice(we,we+128);ei(Pe,64),ze=Pe.read_shift(2),je=J1(Pe,0,ze-de),V.push(je);var We={name:je,type:Pe.read_shift(1),color:Pe.read_shift(1),L:Pe.read_shift(4,"i"),R:Pe.read_shift(4,"i"),C:Pe.read_shift(4,"i"),clsid:Pe.read_shift(16),state:Pe.read_shift(4,"i"),start:0,size:0},ut=Pe.read_shift(2)+Pe.read_shift(2)+Pe.read_shift(2)+Pe.read_shift(2);ut!==0&&(We.ct=O(Pe,Pe.l-8));var mr=Pe.read_shift(2)+Pe.read_shift(2)+Pe.read_shift(2)+Pe.read_shift(2);mr!==0&&(We.mt=O(Pe,Pe.l-8)),We.start=Pe.read_shift(4,"i"),We.size=Pe.read_shift(4,"i"),We.size<0&&We.start<0&&(We.size=We.type=0,We.start=R,We.name=""),We.type===5?(he=We.start,q>0&&he!==R&&(G[he].name="!StreamData")):We.size>=4096?(We.storage="fat",G[We.start]===void 0&&(G[We.start]=A(j,We.start,G.fat_addrs,G.ssz)),G[We.start].name=We.name,We.content=G[We.start].data.slice(0,We.size)):(We.storage="minifat",We.size<0?We.size=0:he!==R&&We.start!==R&&G[he]&&(We.content=x(We,G[he].data,(G[ve]||{}).data))),We.content&&ei(We.content,0),J[je]=We,pe.push(We)}}function O(I,G){return new Date((cs(I,G+4)/1e7*Math.pow(2,32)+cs(I,G)/1e7-11644473600)*1e3)}function Q(I,G){return u(),f(l.readFileSync(I),G)}function H(I,G){var j=G&&G.type;switch(j||Lt&&Buffer.isBuffer(I)&&(j="buffer"),j||"base64"){case"file":return Q(I,G);case"base64":return f(us(ms(I)),G);case"binary":return f(us(I),G)}return f(I,G)}function w(I,G){var j=G||{},V=j.root||"Root Entry";if(I.FullPaths||(I.FullPaths=[]),I.FileIndex||(I.FileIndex=[]),I.FullPaths.length!==I.FileIndex.length)throw new Error("inconsistent CFB structure");I.FullPaths.length===0&&(I.FullPaths[0]=V+"/",I.FileIndex[0]={name:V,type:5}),j.CLSID&&(I.FileIndex[0].clsid=j.CLSID),F(I)}function F(I){var G="Sh33tJ5";if(!ct.find(I,"/"+G)){var j=Ee(4);j[0]=55,j[1]=j[3]=50,j[2]=54,I.FileIndex.push({name:G,type:2,content:j,size:4,L:69,R:69,C:69}),I.FullPaths.push(I.FullPaths[0]+G),T(I)}}function T(I,G){w(I);for(var j=!1,V=!1,q=I.FullPaths.length-1;q>=0;--q){var J=I.FileIndex[q];switch(J.type){case 0:V?j=!0:(I.FileIndex.pop(),I.FullPaths.pop());break;case 1:case 2:case 5:V=!0,isNaN(J.R*J.L*J.C)&&(j=!0),J.R>-1&&J.L>-1&&J.R==J.L&&(j=!0);break;default:j=!0;break}}if(!(!j&&!G)){var pe=new Date(1987,1,19),ve=0,he=Object.create?Object.create(null):{},de=[];for(q=0;q<I.FullPaths.length;++q)he[I.FullPaths[q]]=!0,I.FileIndex[q].type!==0&&de.push([I.FullPaths[q],I.FileIndex[q]]);for(q=0;q<de.length;++q){var ge=n(de[q][0]);V=he[ge],V||(de.push([ge,{name:i(ge).replace("/",""),type:1,clsid:De,ct:pe,mt:pe,content:null}]),he[ge]=!0)}for(de.sort(function(je,Pe){return r(je[0],Pe[0])}),I.FullPaths=[],I.FileIndex=[],q=0;q<de.length;++q)I.FullPaths[q]=de[q][0],I.FileIndex[q]=de[q][1];for(q=0;q<de.length;++q){var we=I.FileIndex[q],ze=I.FullPaths[q];if(we.name=i(ze).replace("/",""),we.L=we.R=we.C=-(we.color=1),we.size=we.content?we.content.length:0,we.start=0,we.clsid=we.clsid||De,q===0)we.C=de.length>1?1:-1,we.size=0,we.type=5;else if(ze.slice(-1)=="/"){for(ve=q+1;ve<de.length&&n(I.FullPaths[ve])!=ze;++ve);for(we.C=ve>=de.length?-1:ve,ve=q+1;ve<de.length&&n(I.FullPaths[ve])!=n(ze);++ve);we.R=ve>=de.length?-1:ve,we.type=1}else n(I.FullPaths[q+1]||"")==n(ze)&&(we.R=q+1),we.type=2}}}function N(I,G){var j=G||{};if(j.fileType=="mad")return Vr(I,j);switch(T(I),j.fileType){case"zip":return zs(I,j)}var V=function(je){for(var Pe=0,We=0,ut=0;ut<je.FileIndex.length;++ut){var mr=je.FileIndex[ut];if(mr.content){var sr=mr.content.length;sr>0&&(sr<4096?Pe+=sr+63>>6:We+=sr+511>>9)}}for(var Xt=je.FullPaths.length+3>>2,ki=Pe+7>>3,Va=Pe+127>>7,es=ki+We+Xt+Va,dr=es+127>>7,da=dr<=109?0:Math.ceil((dr-109)/127);es+dr+da+127>>7>dr;)da=++dr<=109?0:Math.ceil((dr-109)/127);var Fr=[1,da,dr,Va,Xt,We,Pe,0];return je.FileIndex[0].size=Pe<<6,Fr[7]=(je.FileIndex[0].start=Fr[0]+Fr[1]+Fr[2]+Fr[3]+Fr[4]+Fr[5])+(Fr[6]+7>>3),Fr}(I),q=Ee(V[7]<<9),J=0,pe=0;{for(J=0;J<8;++J)q.write_shift(1,Se[J]);for(J=0;J<8;++J)q.write_shift(2,0);for(q.write_shift(2,62),q.write_shift(2,3),q.write_shift(2,65534),q.write_shift(2,9),q.write_shift(2,6),J=0;J<3;++J)q.write_shift(2,0);for(q.write_shift(4,0),q.write_shift(4,V[2]),q.write_shift(4,V[0]+V[1]+V[2]+V[3]-1),q.write_shift(4,0),q.write_shift(4,4096),q.write_shift(4,V[3]?V[0]+V[1]+V[2]-1:R),q.write_shift(4,V[3]),q.write_shift(-4,V[1]?V[0]-1:R),q.write_shift(4,V[1]),J=0;J<109;++J)q.write_shift(-4,J<V[2]?V[1]+J:-1)}if(V[1])for(pe=0;pe<V[1];++pe){for(;J<236+pe*127;++J)q.write_shift(-4,J<V[2]?V[1]+J:-1);q.write_shift(-4,pe===V[1]-1?R:pe+1)}var ve=function(je){for(pe+=je;J<pe-1;++J)q.write_shift(-4,J+1);je&&(++J,q.write_shift(-4,R))};for(pe=J=0,pe+=V[1];J<pe;++J)q.write_shift(-4,ke.DIFSECT);for(pe+=V[2];J<pe;++J)q.write_shift(-4,ke.FATSECT);ve(V[3]),ve(V[4]);for(var he=0,de=0,ge=I.FileIndex[0];he<I.FileIndex.length;++he)ge=I.FileIndex[he],ge.content&&(de=ge.content.length,!(de<4096)&&(ge.start=pe,ve(de+511>>9)));for(ve(V[6]+7>>3);q.l&511;)q.write_shift(-4,ke.ENDOFCHAIN);for(pe=J=0,he=0;he<I.FileIndex.length;++he)ge=I.FileIndex[he],ge.content&&(de=ge.content.length,!(!de||de>=4096)&&(ge.start=pe,ve(de+63>>6)));for(;q.l&511;)q.write_shift(-4,ke.ENDOFCHAIN);for(J=0;J<V[4]<<2;++J){var we=I.FullPaths[J];if(!we||we.length===0){for(he=0;he<17;++he)q.write_shift(4,0);for(he=0;he<3;++he)q.write_shift(4,-1);for(he=0;he<12;++he)q.write_shift(4,0);continue}ge=I.FileIndex[J],J===0&&(ge.start=ge.size?ge.start-1:R);var ze=J===0&&j.root||ge.name;if(de=2*(ze.length+1),q.write_shift(64,ze,"utf16le"),q.write_shift(2,de),q.write_shift(1,ge.type),q.write_shift(1,ge.color),q.write_shift(-4,ge.L),q.write_shift(-4,ge.R),q.write_shift(-4,ge.C),ge.clsid)q.write_shift(16,ge.clsid,"hex");else for(he=0;he<4;++he)q.write_shift(4,0);q.write_shift(4,ge.state||0),q.write_shift(4,0),q.write_shift(4,0),q.write_shift(4,0),q.write_shift(4,0),q.write_shift(4,ge.start),q.write_shift(4,ge.size),q.write_shift(4,0)}for(J=1;J<I.FileIndex.length;++J)if(ge=I.FileIndex[J],ge.size>=4096)if(q.l=ge.start+1<<9,Lt&&Buffer.isBuffer(ge.content))ge.content.copy(q,q.l,0,ge.size),q.l+=ge.size+511&-512;else{for(he=0;he<ge.size;++he)q.write_shift(1,ge.content[he]);for(;he&511;++he)q.write_shift(1,0)}for(J=1;J<I.FileIndex.length;++J)if(ge=I.FileIndex[J],ge.size>0&&ge.size<4096)if(Lt&&Buffer.isBuffer(ge.content))ge.content.copy(q,q.l,0,ge.size),q.l+=ge.size+63&-64;else{for(he=0;he<ge.size;++he)q.write_shift(1,ge.content[he]);for(;he&63;++he)q.write_shift(1,0)}if(Lt)q.l=q.length;else for(;q.l<q.length;)q.write_shift(1,0);return q}function D(I,G){var j=I.FullPaths.map(function(he){return he.toUpperCase()}),V=j.map(function(he){var de=he.split("/");return de[de.length-(he.slice(-1)=="/"?2:1)]}),q=!1;G.charCodeAt(0)===47?(q=!0,G=j[0].slice(0,-1)+G):q=G.indexOf("/")!==-1;var J=G.toUpperCase(),pe=q===!0?j.indexOf(J):V.indexOf(J);if(pe!==-1)return I.FileIndex[pe];var ve=!J.match(Td);for(J=J.replace(Pi,""),ve&&(J=J.replace(Td,"!")),pe=0;pe<j.length;++pe)if((ve?j[pe].replace(Td,"!"):j[pe]).replace(Pi,"")==J||(ve?V[pe].replace(Td,"!"):V[pe]).replace(Pi,"")==J)return I.FileIndex[pe];return null}var P=64,R=-2,Xe="d0cf11e0a1b11ae1",Se=[208,207,17,224,161,177,26,225],De="00000000000000000000000000000000",ke={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:R,FREESECT:-1,HEADER_SIGNATURE:Xe,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:De,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Ce(I,G,j){u();var V=N(I,j);l.writeFileSync(G,V)}function ie(I){for(var G=new Array(I.length),j=0;j<I.length;++j)G[j]=String.fromCharCode(I[j]);return G.join("")}function be(I,G){var j=N(I,G);switch(G&&G.type||"buffer"){case"file":return u(),l.writeFileSync(G.filename,j),j;case"binary":return typeof j=="string"?j:ie(j);case"base64":return xf(typeof j=="string"?j:ie(j));case"buffer":if(Lt)return Buffer.isBuffer(j)?j:go(j);case"array":return typeof j=="string"?us(j):j}return j}var Me;function Y(I){try{var G=I.InflateRaw,j=new G;if(j._processChunk(new Uint8Array([3,0]),j._finishFlushFlag),j.bytesRead)Me=I;else throw new Error("zlib does not expose bytesRead")}catch(V){console.error("cannot use native zlib: "+(V.message||V))}}function re(I,G){if(!Me)return Vs(I,G);var j=Me.InflateRaw,V=new j,q=V._processChunk(I.slice(I.l),V._finishFlushFlag);return I.l+=V.bytesRead,q}function ne(I){return Me?Me.deflateRawSync(I):yt(I)}var X=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],_e=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Te=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Le(I){var G=(I<<1|I<<11)&139536|(I<<5|I<<15)&558144;return(G>>16|G>>8|G)&255}for(var Ne=typeof Uint8Array<"u",Ie=Ne?new Uint8Array(256):[],ot=0;ot<256;++ot)Ie[ot]=Le(ot);function ee(I,G){var j=Ie[I&255];return G<=8?j>>>8-G:(j=j<<8|Ie[I>>8&255],G<=16?j>>>16-G:(j=j<<8|Ie[I>>16&255],j>>>24-G))}function Ot(I,G){var j=G&7,V=G>>>3;return(I[V]|(j<=6?0:I[V+1]<<8))>>>j&3}function wt(I,G){var j=G&7,V=G>>>3;return(I[V]|(j<=5?0:I[V+1]<<8))>>>j&7}function Mt(I,G){var j=G&7,V=G>>>3;return(I[V]|(j<=4?0:I[V+1]<<8))>>>j&15}function St(I,G){var j=G&7,V=G>>>3;return(I[V]|(j<=3?0:I[V+1]<<8))>>>j&31}function Ke(I,G){var j=G&7,V=G>>>3;return(I[V]|(j<=1?0:I[V+1]<<8))>>>j&127}function wr(I,G,j){var V=G&7,q=G>>>3,J=(1<<j)-1,pe=I[q]>>>V;return j<8-V||(pe|=I[q+1]<<8-V,j<16-V)||(pe|=I[q+2]<<16-V,j<24-V)||(pe|=I[q+3]<<24-V),pe&J}function rn(I,G,j){var V=G&7,q=G>>>3;return V<=5?I[q]|=(j&7)<<V:(I[q]|=j<<V&255,I[q+1]=(j&7)>>8-V),G+3}function Cn(I,G,j){var V=G&7,q=G>>>3;return j=(j&1)<<V,I[q]|=j,G+1}function Bi(I,G,j){var V=G&7,q=G>>>3;return j<<=V,I[q]|=j&255,j>>>=8,I[q+1]=j,G+8}function ji(I,G,j){var V=G&7,q=G>>>3;return j<<=V,I[q]|=j&255,j>>>=8,I[q+1]=j&255,I[q+2]=j>>>8,G+16}function Li(I,G){var j=I.length,V=2*j>G?2*j:G+5,q=0;if(j>=G)return I;if(Lt){var J=H2(V);if(I.copy)I.copy(J);else for(;q<I.length;++q)J[q]=I[q];return J}else if(Ne){var pe=new Uint8Array(V);if(pe.set)pe.set(I);else for(;q<j;++q)pe[q]=I[q];return pe}return I.length=V,I}function Gr(I){for(var G=new Array(I),j=0;j<I;++j)G[j]=0;return G}function Ui(I,G,j){var V=1,q=0,J=0,pe=0,ve=0,he=I.length,de=Ne?new Uint16Array(32):Gr(32);for(J=0;J<32;++J)de[J]=0;for(J=he;J<j;++J)I[J]=0;he=I.length;var ge=Ne?new Uint16Array(he):Gr(he);for(J=0;J<he;++J)de[q=I[J]]++,V<q&&(V=q),ge[J]=0;for(de[0]=0,J=1;J<=V;++J)de[J+16]=ve=ve+de[J-1]<<1;for(J=0;J<he;++J)ve=I[J],ve!=0&&(ge[J]=de[ve+16]++);var we=0;for(J=0;J<he;++J)if(we=I[J],we!=0)for(ve=ee(ge[J],V)>>V-we,pe=(1<<V+4-we)-1;pe>=0;--pe)G[ve|pe<<we]=we&15|J<<4;return V}var gr=Ne?new Uint16Array(512):Gr(512),Kr=Ne?new Uint16Array(32):Gr(32);if(!Ne){for(var Nr=0;Nr<512;++Nr)gr[Nr]=0;for(Nr=0;Nr<32;++Nr)Kr[Nr]=0}(function(){for(var I=[],G=0;G<32;G++)I.push(5);Ui(I,Kr,32);var j=[];for(G=0;G<=143;G++)j.push(8);for(;G<=255;G++)j.push(9);for(;G<=279;G++)j.push(7);for(;G<=287;G++)j.push(8);Ui(j,gr,288)})();var Ai=function(){for(var G=Ne?new Uint8Array(32768):[],j=0,V=0;j<Te.length-1;++j)for(;V<Te[j+1];++V)G[V]=j;for(;V<32768;++V)G[V]=29;var q=Ne?new Uint8Array(259):[];for(j=0,V=0;j<_e.length-1;++j)for(;V<_e[j+1];++V)q[V]=j;function J(ve,he){for(var de=0;de<ve.length;){var ge=Math.min(65535,ve.length-de),we=de+ge==ve.length;for(he.write_shift(1,+we),he.write_shift(2,ge),he.write_shift(2,~ge&65535);ge-- >0;)he[he.l++]=ve[de++]}return he.l}function pe(ve,he){for(var de=0,ge=0,we=Ne?new Uint16Array(32768):[];ge<ve.length;){var ze=Math.min(65535,ve.length-ge);if(ze<10){for(de=rn(he,de,+(ge+ze==ve.length)),de&7&&(de+=8-(de&7)),he.l=de/8|0,he.write_shift(2,ze),he.write_shift(2,~ze&65535);ze-- >0;)he[he.l++]=ve[ge++];de=he.l*8;continue}de=rn(he,de,+(ge+ze==ve.length)+2);for(var je=0;ze-- >0;){var Pe=ve[ge];je=(je<<5^Pe)&32767;var We=-1,ut=0;if((We=we[je])&&(We|=ge&-32768,We>ge&&(We-=32768),We<ge))for(;ve[We+ut]==ve[ge+ut]&&ut<250;)++ut;if(ut>2){Pe=q[ut],Pe<=22?de=Bi(he,de,Ie[Pe+1]>>1)-1:(Bi(he,de,3),de+=5,Bi(he,de,Ie[Pe-23]>>5),de+=3);var mr=Pe<8?0:Pe-4>>2;mr>0&&(ji(he,de,ut-_e[Pe]),de+=mr),Pe=G[ge-We],de=Bi(he,de,Ie[Pe]>>3),de-=3;var sr=Pe<4?0:Pe-2>>1;sr>0&&(ji(he,de,ge-We-Te[Pe]),de+=sr);for(var Xt=0;Xt<ut;++Xt)we[je]=ge&32767,je=(je<<5^ve[ge])&32767,++ge;ze-=ut-1}else Pe<=143?Pe=Pe+48:de=Cn(he,de,1),de=Bi(he,de,Ie[Pe]),we[je]=ge&32767,++ge}de=Bi(he,de,0)-1}return he.l=(de+7)/8|0,he.l}return function(he,de){return he.length<8?J(he,de):pe(he,de)}}();function yt(I){var G=Ee(50+Math.floor(I.length*1.1)),j=Ai(I,G);return G.slice(0,j)}var Rr=Ne?new Uint16Array(32768):Gr(32768),Lr=Ne?new Uint16Array(32768):Gr(32768),Ur=Ne?new Uint16Array(128):Gr(128),Bn=1,yo=1;function _o(I,G){var j=St(I,G)+257;G+=5;var V=St(I,G)+1;G+=5;var q=Mt(I,G)+4;G+=4;for(var J=0,pe=Ne?new Uint8Array(19):Gr(19),ve=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],he=1,de=Ne?new Uint8Array(8):Gr(8),ge=Ne?new Uint8Array(8):Gr(8),we=pe.length,ze=0;ze<q;++ze)pe[X[ze]]=J=wt(I,G),he<J&&(he=J),de[J]++,G+=3;var je=0;for(de[0]=0,ze=1;ze<=he;++ze)ge[ze]=je=je+de[ze-1]<<1;for(ze=0;ze<we;++ze)(je=pe[ze])!=0&&(ve[ze]=ge[je]++);var Pe=0;for(ze=0;ze<we;++ze)if(Pe=pe[ze],Pe!=0){je=Ie[ve[ze]]>>8-Pe;for(var We=(1<<7-Pe)-1;We>=0;--We)Ur[je|We<<Pe]=Pe&7|ze<<3}var ut=[];for(he=1;ut.length<j+V;)switch(je=Ur[Ke(I,G)],G+=je&7,je>>>=3){case 16:for(J=3+Ot(I,G),G+=2,je=ut[ut.length-1];J-- >0;)ut.push(je);break;case 17:for(J=3+wt(I,G),G+=3;J-- >0;)ut.push(0);break;case 18:for(J=11+Ke(I,G),G+=7;J-- >0;)ut.push(0);break;default:ut.push(je),he<je&&(he=je);break}var mr=ut.slice(0,j),sr=ut.slice(j);for(ze=j;ze<286;++ze)mr[ze]=0;for(ze=V;ze<30;++ze)sr[ze]=0;return Bn=Ui(mr,Rr,286),yo=Ui(sr,Lr,30),G}function $u(I,G){if(I[0]==3&&!(I[1]&3))return[fl(G),2];for(var j=0,V=0,q=H2(G||1<<18),J=0,pe=q.length>>>0,ve=0,he=0;!(V&1);){if(V=wt(I,j),j+=3,V>>>1)V>>1==1?(ve=9,he=5):(j=_o(I,j),ve=Bn,he=yo);else{j&7&&(j+=8-(j&7));var de=I[j>>>3]|I[(j>>>3)+1]<<8;if(j+=32,de>0)for(!G&&pe<J+de&&(q=Li(q,J+de),pe=q.length);de-- >0;)q[J++]=I[j>>>3],j+=8;continue}for(;;){!G&&pe<J+32767&&(q=Li(q,J+32767),pe=q.length);var ge=wr(I,j,ve),we=V>>>1==1?gr[ge]:Rr[ge];if(j+=we&15,we>>>=4,!(we>>>8&255))q[J++]=we;else{if(we==256)break;we-=257;var ze=we<8?0:we-4>>2;ze>5&&(ze=0);var je=J+_e[we];ze>0&&(je+=wr(I,j,ze),j+=ze),ge=wr(I,j,he),we=V>>>1==1?Kr[ge]:Lr[ge],j+=we&15,we>>>=4;var Pe=we<4?0:we-2>>1,We=Te[we];for(Pe>0&&(We+=wr(I,j,Pe),j+=Pe),!G&&pe<je&&(q=Li(q,je+100),pe=q.length);J<je;)q[J]=q[J-We],++J}}}return G?[q,j+7>>>3]:[q.slice(0,J),j+7>>>3]}function Vs(I,G){var j=I.slice(I.l||0),V=$u(j,G);return I.l+=V[1],V[0]}function Al(I,G){if(I)typeof console<"u"&&console.error(G);else throw new Error(G)}function la(I,G){var j=I;ei(j,0);var V=[],q=[],J={FileIndex:V,FullPaths:q};w(J,{root:G.root});for(var pe=j.length-4;(j[pe]!=80||j[pe+1]!=75||j[pe+2]!=5||j[pe+3]!=6)&&pe>=0;)--pe;j.l=pe+4,j.l+=4;var ve=j.read_shift(2);j.l+=6;var he=j.read_shift(4);for(j.l=he,pe=0;pe<ve;++pe){j.l+=20;var de=j.read_shift(4),ge=j.read_shift(4),we=j.read_shift(2),ze=j.read_shift(2),je=j.read_shift(2);j.l+=8;var Pe=j.read_shift(4),We=o(j.slice(j.l+we,j.l+we+ze));j.l+=we+ze+je;var ut=j.l;j.l=Pe+4,ja(j,de,ge,J,We),j.l=ut}return J}function ja(I,G,j,V,q){I.l+=2;var J=I.read_shift(2),pe=I.read_shift(2),ve=a(I);if(J&8257)throw new Error("Unsupported ZIP encryption");for(var he=I.read_shift(4),de=I.read_shift(4),ge=I.read_shift(4),we=I.read_shift(2),ze=I.read_shift(2),je="",Pe=0;Pe<we;++Pe)je+=String.fromCharCode(I[I.l++]);if(ze){var We=o(I.slice(I.l,I.l+ze));(We[21589]||{}).mt&&(ve=We[21589].mt),((q||{})[21589]||{}).mt&&(ve=q[21589].mt)}I.l+=ze;var ut=I.slice(I.l,I.l+de);switch(pe){case 8:ut=re(I,ge);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+pe)}var mr=!1;J&8&&(he=I.read_shift(4),he==134695760&&(he=I.read_shift(4),mr=!0),de=I.read_shift(4),ge=I.read_shift(4)),de!=G&&Al(mr,"Bad compressed size: "+G+" != "+de),ge!=j&&Al(mr,"Bad uncompressed size: "+j+" != "+ge),_s(V,je,ut,{unsafe:!0,mt:ve})}function zs(I,G){var j=G||{},V=[],q=[],J=Ee(1),pe=j.compression?8:0,ve=0,he=0,de=0,ge=0,we=0,ze=I.FullPaths[0],je=ze,Pe=I.FileIndex[0],We=[],ut=0;for(he=1;he<I.FullPaths.length;++he)if(je=I.FullPaths[he].slice(ze.length),Pe=I.FileIndex[he],!(!Pe.size||!Pe.content||je=="Sh33tJ5")){var mr=ge,sr=Ee(je.length);for(de=0;de<je.length;++de)sr.write_shift(1,je.charCodeAt(de)&127);sr=sr.slice(0,sr.l),We[we]=lR.buf(Pe.content,0);var Xt=Pe.content;pe==8&&(Xt=ne(Xt)),J=Ee(30),J.write_shift(4,67324752),J.write_shift(2,20),J.write_shift(2,ve),J.write_shift(2,pe),Pe.mt?s(J,Pe.mt):J.write_shift(4,0),J.write_shift(-4,We[we]),J.write_shift(4,Xt.length),J.write_shift(4,Pe.content.length),J.write_shift(2,sr.length),J.write_shift(2,0),ge+=J.length,V.push(J),ge+=sr.length,V.push(sr),ge+=Xt.length,V.push(Xt),J=Ee(46),J.write_shift(4,33639248),J.write_shift(2,0),J.write_shift(2,20),J.write_shift(2,ve),J.write_shift(2,pe),J.write_shift(4,0),J.write_shift(-4,We[we]),J.write_shift(4,Xt.length),J.write_shift(4,Pe.content.length),J.write_shift(2,sr.length),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(4,0),J.write_shift(4,mr),ut+=J.l,q.push(J),ut+=sr.length,q.push(sr),++we}return J=Ee(22),J.write_shift(4,101010256),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(2,we),J.write_shift(2,we),J.write_shift(4,ut),J.write_shift(4,ge),J.write_shift(2,0),Hn([Hn(V),Hn(q),J])}var ce={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ur(I,G){if(I.ctype)return I.ctype;var j=I.name||"",V=j.match(/\.([^\.]+)$/);return V&&ce[V[1]]||G&&(V=(j=G).match(/[\.\\]([^\.\\])+$/),V&&ce[V[1]])?ce[V[1]]:"application/octet-stream"}function ca(I){for(var G=xf(I),j=[],V=0;V<G.length;V+=76)j.push(G.slice(V,V+76));return j.join(`\r
`)+`\r
`}function La(I){var G=I.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(de){var ge=de.charCodeAt(0).toString(16).toUpperCase();return"="+(ge.length==1?"0"+ge:ge)});G=G.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),G.charAt(0)==`
`&&(G="=0D"+G.slice(1)),G=G.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var j=[],V=G.split(`\r
`),q=0;q<V.length;++q){var J=V[q];if(J.length==0){j.push("");continue}for(var pe=0;pe<J.length;){var ve=76,he=J.slice(pe,pe+ve);he.charAt(ve-1)=="="?ve--:he.charAt(ve-2)=="="?ve-=2:he.charAt(ve-3)=="="&&(ve-=3),he=J.slice(pe,pe+ve),pe+=ve,pe<J.length&&(he+="="),j.push(he)}}return j.join(`\r
`)}function Ua(I){for(var G=[],j=0;j<I.length;++j){for(var V=I[j];j<=I.length&&V.charAt(V.length-1)=="=";)V=V.slice(0,V.length-1)+I[++j];G.push(V)}for(var q=0;q<G.length;++q)G[q]=G[q].replace(/[=][0-9A-Fa-f]{2}/g,function(J){return String.fromCharCode(parseInt(J.slice(1),16))});return us(G.join(`\r
`))}function ys(I,G,j){for(var V="",q="",J="",pe,ve=0;ve<10;++ve){var he=G[ve];if(!he||he.match(/^\s*$/))break;var de=he.match(/^(.*?):\s*([^\s].*)$/);if(de)switch(de[1].toLowerCase()){case"content-location":V=de[2].trim();break;case"content-type":J=de[2].trim();break;case"content-transfer-encoding":q=de[2].trim();break}}switch(++ve,q.toLowerCase()){case"base64":pe=us(ms(G.slice(ve).join("")));break;case"quoted-printable":pe=Ua(G.slice(ve));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+q)}var ge=_s(I,V.slice(j.length),pe,{unsafe:!0});J&&(ge.ctype=J)}function ua(I,G){if(ie(I.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var j=G&&G.root||"",V=(Lt&&Buffer.isBuffer(I)?I.toString("binary"):ie(I)).split(`\r
`),q=0,J="";for(q=0;q<V.length;++q)if(J=V[q],!!/^Content-Location:/i.test(J)&&(J=J.slice(J.indexOf("file")),j||(j=J.slice(0,J.lastIndexOf("/")+1)),J.slice(0,j.length)!=j))for(;j.length>0&&(j=j.slice(0,j.length-1),j=j.slice(0,j.lastIndexOf("/")+1),J.slice(0,j.length)!=j););var pe=(V[1]||"").match(/boundary="(.*?)"/);if(!pe)throw new Error("MAD cannot find boundary");var ve="--"+(pe[1]||""),he=[],de=[],ge={FileIndex:he,FullPaths:de};w(ge);var we,ze=0;for(q=0;q<V.length;++q){var je=V[q];je!==ve&&je!==ve+"--"||(ze++&&ys(ge,V.slice(we,q),j),we=q)}return ge}function Vr(I,G){var j=G||{},V=j.boundary||"SheetJS";V="------="+V;for(var q=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+V.slice(2)+'"',"","",""],J=I.FullPaths[0],pe=J,ve=I.FileIndex[0],he=1;he<I.FullPaths.length;++he)if(pe=I.FullPaths[he].slice(J.length),ve=I.FileIndex[he],!(!ve.size||!ve.content||pe=="Sh33tJ5")){pe=pe.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(ut){return"_x"+ut.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(ut){return"_u"+ut.charCodeAt(0).toString(16)+"_"});for(var de=ve.content,ge=Lt&&Buffer.isBuffer(de)?de.toString("binary"):ie(de),we=0,ze=Math.min(1024,ge.length),je=0,Pe=0;Pe<=ze;++Pe)(je=ge.charCodeAt(Pe))>=32&&je<128&&++we;var We=we>=ze*4/5;q.push(V),q.push("Content-Location: "+(j.root||"file:///C:/SheetJS/")+pe),q.push("Content-Transfer-Encoding: "+(We?"quoted-printable":"base64")),q.push("Content-Type: "+ur(ve,pe)),q.push(""),q.push(We?La(ge):ca(ge))}return q.push(V+`--\r
`),q.join(`\r
`)}function kn(I){var G={};return w(G,I),G}function _s(I,G,j,V){var q=V&&V.unsafe;q||w(I);var J=!q&&ct.find(I,G);if(!J){var pe=I.FullPaths[0];G.slice(0,pe.length)==pe?pe=G:(pe.slice(-1)!="/"&&(pe+="/"),pe=(pe+G).replace("//","/")),J={name:i(G),type:2},I.FileIndex.push(J),I.FullPaths.push(pe),q||ct.utils.cfb_gc(I)}return J.content=j,J.size=j?j.length:0,V&&(V.CLSID&&(J.clsid=V.CLSID),V.mt&&(J.mt=V.mt),V.ct&&(J.ct=V.ct)),J}function Es(I,G){w(I);var j=ct.find(I,G);if(j){for(var V=0;V<I.FileIndex.length;++V)if(I.FileIndex[V]==j)return I.FileIndex.splice(V,1),I.FullPaths.splice(V,1),!0}return!1}function Gu(I,G,j){w(I);var V=ct.find(I,G);if(V){for(var q=0;q<I.FileIndex.length;++q)if(I.FileIndex[q]==V)return I.FileIndex[q].name=i(j),I.FullPaths[q]=j,!0}return!1}function Ci(I){T(I,!0)}return e.find=D,e.read=H,e.parse=f,e.write=be,e.writeFile=Ce,e.utils={cfb_new:kn,cfb_add:_s,cfb_del:Es,cfb_mov:Gu,cfb_gc:Ci,ReadShift:Ld,CheckField:dA,prep_blob:ei,bconcat:Hn,use_zlib:Y,_deflateRaw:yt,_inflateRaw:Vs,consts:ke},e}();function cR(t){return typeof t=="string"?zp(t):Array.isArray(t)?ON(t):t}function $f(t,e,r){if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=zp(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var n=r=="utf8"?ka(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var i=new Blob([cR(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,t);if(typeof saveAs<"u")return saveAs(i,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:t,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=t,a.href=s,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(t);return o.open("w"),o.encoding="binary",Array.isArray(e)&&(e=Sl(e)),o.write(e),o.close(),e}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+t)}function uR(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function cn(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function J2(t,e){for(var r=[],n=cn(t),i=0;i!==n.length;++i)r[t[n[i]][e]]==null&&(r[t[n[i]][e]]=n[i]);return r}function Hp(t){for(var e=[],r=cn(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}function $p(t){for(var e=[],r=cn(t),n=0;n!==r.length;++n)e[t[r[n]]]=parseInt(r[n],10);return e}function dR(t){for(var e=[],r=cn(t),n=0;n!==r.length;++n)e[t[r[n]]]==null&&(e[t[r[n]]]=[]),e[t[r[n]]].push(r[n]);return e}var ep=new Date(1899,11,30,0,0,0);function Mn(t,e){var r=t.getTime(),n=ep.getTime()+(t.getTimezoneOffset()-ep.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var HT=new Date,fR=ep.getTime()+(HT.getTimezoneOffset()-ep.getTimezoneOffset())*6e4,Z2=HT.getTimezoneOffset();function Gp(t){var e=new Date;return e.setTime(t*24*60*60*1e3+fR),e.getTimezoneOffset()!==Z2&&e.setTime(e.getTime()+(e.getTimezoneOffset()-Z2)*6e4),e}function hR(t){var e=0,r=0,n=!1,i=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var s=1;s!=i.length;++s)if(i[s]){switch(r=1,s>3&&(n=!0),i[s].slice(i[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[s].slice(i[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(i[s],10)}return e}var e_=new Date("2017-02-19T19:06:09.000Z"),$T=isNaN(e_.getFullYear())?new Date("2/19/17"):e_,pR=$T.getFullYear()==2017;function Br(t,e){var r=new Date(t);if(pR)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if($T.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=t.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return t.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function ec(t,e){if(Lt&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return ka(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return ka(RT(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return ka(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return ka(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],i=0;i!=t.length;++i)n.push(String.fromCharCode(t[i]));return n.join("")}function jr(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=jr(t[r]));return e}function an(t,e){for(var r="";r.length<e;)r+=t;return r}function ia(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return r=-r,s}),!isNaN(e=Number(n)))?e/r:e}var gR=["january","february","march","april","may","june","july","august","september","october","november","december"];function _u(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),i=e.getMonth(),s=e.getDate();if(isNaN(s))return r;var a=t.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&gR.indexOf(a)==-1)return r}else if(a.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||s>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var mR=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(t||typeof n=="string")return r.split(n);for(var s=r.split(n),a=[s[0]],o=1;o<s.length;++o)a.push(i),a.push(s[o]);return a}}();function GT(t){return t?t.content&&t.type?ec(t.content,!0):t.data?wd(t.data):t.asNodeBuffer&&Lt?wd(t.asNodeBuffer().toString("binary")):t.asBinary?wd(t.asBinary()):t._data&&t._data.getContent?wd(ec(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function KT(t){if(!t)return null;if(t.data)return z2(t.data);if(t.asNodeBuffer&&Lt)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?z2(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function xR(t){return t&&t.name.slice(-4)===".bin"?KT(t):GT(t)}function bs(t,e){for(var r=t.FullPaths||cn(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var a=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==a||i==a)return t.files?t.files[r[s]]:t.FileIndex[s]}return null}function G1(t,e){var r=bs(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function wn(t,e,r){if(!r)return xR(G1(t,e));if(!e)return null;try{return wn(t,e)}catch{return null}}function ds(t,e,r){if(!r)return GT(G1(t,e));if(!e)return null;try{return ds(t,e)}catch{return null}}function vR(t,e,r){return KT(G1(t,e))}function t_(t){for(var e=t.FullPaths||cn(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function Rt(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return Lt?n=go(r):n=MN(r),ct.utils.cfb_add(t,e,n)}ct.utils.cfb_add(t,e,r)}else t.file(e,r)}function K1(){return ct.utils.cfb_new()}function YT(t,e){switch(e.type){case"base64":return ct.read(t,{type:"base64"});case"binary":return ct.read(t,{type:"binary"});case"buffer":case"array":return ct.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function Ad(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var mn=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,yR=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,r_=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,_R=/<[^>]*>/g,Ti=mn.match(r_)?r_:_R,ER=/<\w*:/,SR=/<(\/?)\w+:/;function xt(t,e,r){for(var n={},i=0,s=0;i!==t.length&&!((s=t.charCodeAt(i))===32||s===10||s===13);++i);if(e||(n[0]=t.slice(0,i)),i===t.length)return n;var a=t.match(yR),o=0,l="",u=0,f="",p="",g=1;if(a)for(u=0;u!=a.length;++u){for(p=a[u],s=0;s!=p.length&&p.charCodeAt(s)!==61;++s);for(f=p.slice(0,s).trim();p.charCodeAt(s+1)==32;)++s;for(g=(i=p.charCodeAt(s+1))==34||i==39?1:0,l=p.slice(s+1+g,p.length-g),o=0;o!=f.length&&f.charCodeAt(o)!==58;++o);if(o===f.length)f.indexOf("_")>0&&(f=f.slice(0,f.indexOf("_"))),n[f]=l,n[f.toLowerCase()]=l;else{var m=(o===5&&f.slice(0,5)==="xmlns"?"xmlns":"")+f.slice(o+1);if(n[m]&&f.slice(o-3,o)=="ext")continue;n[m]=l,n[m.toLowerCase()]=l}}return n}function Ma(t){return t.replace(SR,"<$1")}var XT={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Y1=Hp(XT),nr=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",s=i.indexOf("<![CDATA[");if(s==-1)return i.replace(t,function(o,l){return XT[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(e,function(o,l){return String.fromCharCode(parseInt(l,16))});var a=i.indexOf("]]>");return r(i.slice(0,s))+i.slice(s+9,a)+r(i.slice(a+3))}}(),X1=/[&<>'"]/g,wR=/[\u0000-\u0008\u000b-\u001f]/g;function _r(t){var e=t+"";return e.replace(X1,function(r){return Y1[r]}).replace(wR,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function n_(t){return _r(t).replace(/ /g,"_x0020_")}var qT=/[\u0000-\u001f]/g;function q1(t){var e=t+"";return e.replace(X1,function(r){return Y1[r]}).replace(/\n/g,"<br/>").replace(qT,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function TR(t){var e=t+"";return e.replace(X1,function(r){return Y1[r]}).replace(qT,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var i_=function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}}();function AR(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function Or(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Wg(t){for(var e="",r=0,n=0,i=0,s=0,a=0,o=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(i=t.charCodeAt(r++),n>191&&n<224){a=(n&31)<<6,a|=i&63,e+=String.fromCharCode(a);continue}if(s=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}a=t.charCodeAt(r++),o=((n&7)<<18|(i&63)<<12|(s&63)<<6|a&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function s_(t){var e=fl(2*t.length),r,n,i=1,s=0,a=0,o;for(n=0;n<t.length;n+=i)i=1,(o=t.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(t.charCodeAt(n+1)&63),i=2):o<240?(r=(o&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),i=3):(i=4,r=(o&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,a=55296+(r>>>10&1023),r=56320+(r&1023)),a!==0&&(e[s++]=a&255,e[s++]=a>>>8,a=0),e[s++]=r%256,e[s++]=r>>>8;return e.slice(0,s).toString("ucs2")}function a_(t){return go(t,"binary").toString("utf8")}var B0="foo bar baz",Tr=Lt&&(a_(B0)==Wg(B0)&&a_||s_(B0)==Wg(B0)&&s_)||Wg,ka=Lt?function(t){return go(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,i=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},yf=function(){var t={};return function(r,n){var i=r+"|"+(n||"");return t[i]?t[i]:t[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),QT=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<t.length;++i)n=n.replace(t[i][0],t[i][1]);return n}}(),CR=function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),kR=/<\/?(?:vt:)?variant>/g,FR=/<(?:vt:)([^>]*)>([\s\S]*)</;function o_(t,e){var r=xt(t),n=t.match(CR(r.baseType))||[],i=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(s){var a=s.replace(kR,"").match(FR);a&&i.push({v:Tr(a[2]),t:a[1]})}),i}var JT=/(^\s|\s$|\n)/;function ti(t,e){return"<"+t+(e.match(JT)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function _f(t){return cn(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function $e(t,e,r){return"<"+t+(r!=null?_f(r):"")+(e!=null?(e.match(JT)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function fx(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function bR(t,e){switch(typeof t){case"string":var r=$e("vt:lpwstr",_r(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return $e((t|0)==t?"vt:i4":"vt:r8",_r(String(t)));case"boolean":return $e("vt:bool",t?"true":"false")}if(t instanceof Date)return $e("vt:filetime",fx(t));throw new Error("Unable to serialize "+t)}function Q1(t){if(Lt&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return Tr(Sl(W1(t)));throw new Error("Bad input format: expected Buffer or string")}var Ef=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Rn={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},fc=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],ls={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function IR(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),i=t[e+6]&15,s=5;s>=0;--s)i=i*256+t[e+s];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function NR(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,i=0,s=0,a=n?-e:e;isFinite(a)?a==0?i=s=0:(i=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(e)?26985:0);for(var o=0;o<=5;++o,s/=256)t[r+o]=s&255;t[r+6]=(i&15)<<4|s&15,t[r+7]=i>>4|n}var l_=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var i=0,s=t[0][n].length;i<s;i+=r)e.push.apply(e,t[0][n].slice(i,i+r));return e},c_=Lt?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:go(e)})):l_(t)}:l_,u_=function(t,e,r){for(var n=[],i=e;i<r;i+=2)n.push(String.fromCharCode(Ya(t,i)));return n.join("").replace(Pi,"")},J1=Lt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(Pi,""):u_(t,e,r)}:u_,d_=function(t,e,r){for(var n=[],i=e;i<e+r;++i)n.push(("0"+t[i].toString(16)).slice(-2));return n.join("")},ZT=Lt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):d_(t,e,r)}:d_,f_=function(t,e,r){for(var n=[],i=e;i<r;i++)n.push(String.fromCharCode(Oc(t,i)));return n.join("")},Gf=Lt?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):f_(e,r,n)}:f_,eA=function(t,e){var r=cs(t,e);return r>0?Gf(t,e+4,e+4+r-1):""},tA=eA,rA=function(t,e){var r=cs(t,e);return r>0?Gf(t,e+4,e+4+r-1):""},nA=rA,iA=function(t,e){var r=2*cs(t,e);return r>0?Gf(t,e+4,e+4+r-1):""},sA=iA,aA=function(e,r){var n=cs(e,r);return n>0?J1(e,r+4,r+4+n):""},oA=aA,lA=function(t,e){var r=cs(t,e);return r>0?Gf(t,e+4,e+4+r):""},cA=lA,uA=function(t,e){return IR(t,e)},tp=uA,Z1=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Lt&&(tA=function(e,r){if(!Buffer.isBuffer(e))return eA(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},nA=function(e,r){if(!Buffer.isBuffer(e))return rA(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},sA=function(e,r){if(!Buffer.isBuffer(e))return iA(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},oA=function(e,r){if(!Buffer.isBuffer(e))return aA(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},cA=function(e,r){if(!Buffer.isBuffer(e))return lA(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},tp=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):uA(e,r)},Z1=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Oc=function(t,e){return t[e]},Ya=function(t,e){return t[e+1]*256+t[e]},RR=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},cs=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},Dl=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},DR=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function Ld(t,e){var r="",n,i,s=[],a,o,l,u;switch(e){case"dbcs":if(u=this.l,Lt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(l=0;l<t;++l)r+=String.fromCharCode(Ya(this,u)),u+=2;t*=2;break;case"utf8":r=Gf(this,this.l,this.l+t);break;case"utf16le":t*=2,r=J1(this,this.l,this.l+t);break;case"wstr":return Ld.call(this,t,"dbcs");case"lpstr-ansi":r=tA(this,this.l),t=4+cs(this,this.l);break;case"lpstr-cp":r=nA(this,this.l),t=4+cs(this,this.l);break;case"lpwstr":r=sA(this,this.l),t=4+2*cs(this,this.l);break;case"lpp4":t=4+cs(this,this.l),r=oA(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+cs(this,this.l),r=cA(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(a=Oc(this,this.l+t++))!==0;)s.push(M0(a));r=s.join("");break;case"_wstr":for(t=0,r="";(a=Ya(this,this.l+t))!==0;)s.push(M0(a)),t+=2;t+=2,r=s.join("");break;case"dbcs-cont":for(r="",u=this.l,l=0;l<t;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return a=Oc(this,u),this.l=u+1,o=Ld.call(this,t-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(M0(Ya(this,u))),u+=2}r=s.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,l=0;l!=t;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return a=Oc(this,u),this.l=u+1,o=Ld.call(this,t-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(M0(Oc(this,u))),u+=1}r=s.join("");break;default:switch(t){case 1:return n=Oc(this,this.l),this.l++,n;case 2:return n=(e==="i"?RR:Ya)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(t>0?Dl:DR)(this,this.l),this.l+=4,n):(i=cs(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return t==8?i=tp(this,this.l):i=tp([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;t=8;case 16:r=ZT(this,this.l,t);break}}return this.l+=t,r}var PR=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},OR=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},MR=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function BR(t,e,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=e.length;++i)MR(this,e.charCodeAt(i),this.l+2*i);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;n=e.length}else if(r==="hex"){for(;i<t;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+t,this.length);for(i=0;i<Math.min(e.length,t);++i){var a=e.charCodeAt(i);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,PR(this,e,this.l);break;case 8:if(n=8,r==="f"){NR(this,e,this.l);break}case 16:break;case-4:n=4,OR(this,e,this.l);break}return this.l+=n,this}function dA(t,e){var r=ZT(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function ei(t,e){t.l=e,t.read_shift=Ld,t.chk=dA,t.write_shift=BR}function Si(t,e){t.l+=e}function Ee(t){var e=fl(t);return ei(e,0),e}function mo(t,e,r){if(t){var n,i,s;ei(t,t.l||0);for(var a=t.length,o=0,l=0;t.l<a;){o=t.read_shift(1),o&128&&(o=(o&127)+((t.read_shift(1)&127)<<7));var u=kf[o]||kf[65535];for(n=t.read_shift(1),s=n&127,i=1;i<4&&n&128;++i)s+=((n=t.read_shift(1))&127)<<7*i;l=t.l+s;var f=u.f&&u.f(t,s,r);if(t.l=l,e(f,u,o))return}}}function Ji(){var t=[],e=Lt?256:2048,r=function(u){var f=Ee(u);return ei(f,0),f},n=r(e),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},s=function(u){return n&&u<n.length-n.l?n:(i(),n=r(Math.max(u+1,e)))},a=function(){return i(),Hn(t)},o=function(u){i(),n=u,n.l==null&&(n.l=n.length),s(e)};return{next:s,push:o,end:a,_bufs:t}}function Fe(t,e,r,n){var i=+e,s;if(!isNaN(i)){n||(n=kf[i].p||(r||[]).length||0),s=1+(i>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var a=t.next(s);i<=127?a.write_shift(1,i):(a.write_shift(1,(i&127)+128),a.write_shift(1,i>>7));for(var o=0;o!=4;++o)if(n>=128)a.write_shift(1,(n&127)+128),n>>=7;else{a.write_shift(1,n);break}n>0&&Z1(r)&&t.push(r)}}function Ud(t,e,r){var n=jr(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function h_(t,e,r){var n=jr(t);return n.s=Ud(n.s,e.s,r),n.e=Ud(n.e,e.s,r),n}function Vd(t,e){if(t.cRel&&t.c<0)for(t=jr(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=jr(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=gt(t);return!t.cRel&&t.cRel!=null&&(r=UR(r)),!t.rRel&&t.rRel!=null&&(r=jR(r)),r}function Hg(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+Qr(t.s.c)+":"+(t.e.cRel?"":"$")+Qr(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+gn(t.s.r)+":"+(t.e.rRel?"":"$")+gn(t.e.r):Vd(t.s,e.biff)+":"+Vd(t.e,e.biff)}function ev(t){return parseInt(LR(t),10)-1}function gn(t){return""+(t+1)}function jR(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function LR(t){return t.replace(/\$(\d+)$/,"$1")}function tv(t){for(var e=VR(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function Qr(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function UR(t){return t.replace(/^([A-Z])/,"$$$1")}function VR(t){return t.replace(/^\$([A-Z])/,"$1")}function zR(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Jr(t){for(var e=0,r=0,n=0;n<t.length;++n){var i=t.charCodeAt(n);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:e-1}}function gt(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function Zi(t){var e=t.indexOf(":");return e==-1?{s:Jr(t),e:Jr(t)}:{s:Jr(t.slice(0,e)),e:Jr(t.slice(e+1))}}function Nt(t,e){return typeof e>"u"||typeof e=="number"?Nt(t.s,t.e):(typeof t!="string"&&(t=gt(t)),typeof e!="string"&&(e=gt(e)),t==e?t:t+":"+e)}function ir(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,s=t.length;for(r=0;n<s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.s.c=--r,r=0;n<s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(e.s.r=--r,n===s||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.e.c=--r,r=0;n!=s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return e.e.r=--r,e}function p_(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=Ls(t.z,r?Mn(e):e)}catch{}try{return t.w=Ls((t.XF||{}).numFmtId||(r?14:0),r?Mn(e):e)}catch{return""+e}}function oo(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?xo[t.v]||t.v:e==null?p_(t,t.v):p_(t,e))}function wl(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function fA(t,e,r){var n=r||{},i=t?Array.isArray(t):n.dense,s=t||(i?[]:{}),a=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?Jr(n.origin):n.origin;a=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var f=ir(s["!ref"]);u.s.c=f.s.c,u.s.r=f.s.r,u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),a==-1&&(u.e.r=a=f.e.r+1)}for(var p=0;p!=e.length;++p)if(e[p]){if(!Array.isArray(e[p]))throw new Error("aoa_to_sheet expects an array of arrays");for(var g=0;g!=e[p].length;++g)if(!(typeof e[p][g]>"u")){var m={v:e[p][g]},y=a+p,x=o+g;if(u.s.r>y&&(u.s.r=y),u.s.c>x&&(u.s.c=x),u.e.r<y&&(u.e.r=y),u.e.c<x&&(u.e.c=x),e[p][g]&&typeof e[p][g]=="object"&&!Array.isArray(e[p][g])&&!(e[p][g]instanceof Date))m=e[p][g];else if(Array.isArray(m.v)&&(m.f=e[p][g][1],m.v=m.v[0]),m.v===null)if(m.f)m.t="n";else if(n.nullError)m.t="e",m.v=0;else if(n.sheetStubs)m.t="z";else continue;else typeof m.v=="number"?m.t="n":typeof m.v=="boolean"?m.t="b":m.v instanceof Date?(m.z=n.dateNF||pt[14],n.cellDates?(m.t="d",m.w=Ls(m.z,Mn(m.v))):(m.t="n",m.v=Mn(m.v),m.w=Ls(m.z,m.v))):m.t="s";if(i)s[y]||(s[y]=[]),s[y][x]&&s[y][x].z&&(m.z=s[y][x].z),s[y][x]=m;else{var S=gt({c:x,r:y});s[S]&&s[S].z&&(m.z=s[S].z),s[S]=m}}}return u.s.c<1e7&&(s["!ref"]=Nt(u)),s}function Bu(t,e){return fA(null,t,e)}function WR(t){return t.read_shift(4,"i")}function sa(t,e){return e||(e=Ee(4)),e.write_shift(4,t),e}function _i(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function $n(t,e){var r=!1;return e==null&&(r=!0,e=Ee(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function HR(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function $R(t,e){return e||(e=Ee(4)),e.write_shift(2,0),e.write_shift(2,0),e}function rv(t,e){var r=t.l,n=t.read_shift(1),i=_i(t),s=[],a={t:i,h:i};if(n&1){for(var o=t.read_shift(4),l=0;l!=o;++l)s.push(HR(t));a.r=s}else a.r=[{ich:0,ifnt:0}];return t.l=r+e,a}function GR(t,e){var r=!1;return e==null&&(r=!0,e=Ee(15+4*t.t.length)),e.write_shift(1,0),$n(t.t,e),r?e.slice(0,e.l):e}var KR=rv;function YR(t,e){var r=!1;return e==null&&(r=!0,e=Ee(23+4*t.t.length)),e.write_shift(1,1),$n(t.t,e),e.write_shift(4,1),$R({},e),r?e.slice(0,e.l):e}function Us(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function hc(t,e){return e==null&&(e=Ee(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function pc(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function gc(t,e){return e==null&&(e=Ee(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var XR=_i,hA=$n;function nv(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function rp(t,e){var r=!1;return e==null&&(r=!0,e=Ee(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var qR=_i,hx=nv,iv=rp;function sv(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var i=n===0?tp([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):Dl(e,0)>>2;return r?i/100:i}function pA(t,e){e==null&&(e=Ee(4));var r=0,n=0,i=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?n=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(n=1,r=1),n)e.write_shift(-4,((r?i:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function gA(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function QR(t,e){return e||(e=Ee(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var mc=gA,ju=QR;function yi(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function tc(t,e){return(e||Ee(8)).write_shift(8,t,"f")}function JR(t){var e={},r=t.read_shift(1),n=r>>>1,i=t.read_shift(1),s=t.read_shift(2,"i"),a=t.read_shift(1),o=t.read_shift(1),l=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=i;var u=zl[i];u&&(e.rgb=wf(u));break;case 2:e.rgb=wf([a,o,l]);break;case 3:e.theme=i;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function np(t,e){if(e||(e=Ee(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function ZR(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function eD(t,e){e||(e=Ee(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}function mA(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function tD(t){return mA(t,1)}function rD(t){return mA(t,2)}var av=2,Gi=3,j0=11,g_=12,ip=19,L0=64,nD=65,iD=71,sD=4108,aD=4126,Vn=80,xA=81,oD=[Vn,xA],px={1:{n:"CodePage",t:av},2:{n:"Category",t:Vn},3:{n:"PresentationFormat",t:Vn},4:{n:"ByteCount",t:Gi},5:{n:"LineCount",t:Gi},6:{n:"ParagraphCount",t:Gi},7:{n:"SlideCount",t:Gi},8:{n:"NoteCount",t:Gi},9:{n:"HiddenCount",t:Gi},10:{n:"MultimediaClipCount",t:Gi},11:{n:"ScaleCrop",t:j0},12:{n:"HeadingPairs",t:sD},13:{n:"TitlesOfParts",t:aD},14:{n:"Manager",t:Vn},15:{n:"Company",t:Vn},16:{n:"LinksUpToDate",t:j0},17:{n:"CharacterCount",t:Gi},19:{n:"SharedDoc",t:j0},22:{n:"HyperlinksChanged",t:j0},23:{n:"AppVersion",t:Gi,p:"version"},24:{n:"DigSig",t:nD},26:{n:"ContentType",t:Vn},27:{n:"ContentStatus",t:Vn},28:{n:"Language",t:Vn},29:{n:"Version",t:Vn},255:{},2147483648:{n:"Locale",t:ip},2147483651:{n:"Behavior",t:ip},1919054434:{}},gx={1:{n:"CodePage",t:av},2:{n:"Title",t:Vn},3:{n:"Subject",t:Vn},4:{n:"Author",t:Vn},5:{n:"Keywords",t:Vn},6:{n:"Comments",t:Vn},7:{n:"Template",t:Vn},8:{n:"LastAuthor",t:Vn},9:{n:"RevNumber",t:Vn},10:{n:"EditTime",t:L0},11:{n:"LastPrinted",t:L0},12:{n:"CreatedDate",t:L0},13:{n:"ModifiedDate",t:L0},14:{n:"PageCount",t:Gi},15:{n:"WordCount",t:Gi},16:{n:"CharCount",t:Gi},17:{n:"Thumbnail",t:iD},18:{n:"Application",t:Vn},19:{n:"DocSecurity",t:Gi},255:{},2147483648:{n:"Locale",t:ip},2147483651:{n:"Behavior",t:ip},1919054434:{}},m_={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},lD=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function cD(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var uD=cD([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),zl=jr(uD),xo={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},vA={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},mx={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},U0={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function ov(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function dD(t){var e=ov();if(!t||!t.match)return e;var r={};if((t.match(Ti)||[]).forEach(function(n){var i=xt(n);switch(i[0].replace(ER,"<")){case"<?xml":break;case"<Types":e.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":e[mx[i.ContentType]]!==void 0&&e[mx[i.ContentType]].push(i.PartName);break}}),e.xmlns!==Rn.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}function yA(t,e){var r=dR(mx),n=[],i;n[n.length]=mn,n[n.length]=$e("Types",null,{xmlns:Rn.CT,"xmlns:xsd":Rn.xsd,"xmlns:xsi":Rn.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return $e("Default",null,{Extension:l[0],ContentType:l[1]})}));var s=function(l){t[l]&&t[l].length>0&&(i=t[l][0],n[n.length]=$e("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:U0[l][e.bookType]||U0[l].xlsx}))},a=function(l){(t[l]||[]).forEach(function(u){n[n.length]=$e("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:U0[l][e.bookType]||U0[l].xlsx})})},o=function(l){(t[l]||[]).forEach(function(u){n[n.length]=$e("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[l][0]})})};return s("workbooks"),a("sheets"),a("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),a("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Vt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Sf(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function zd(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(Ti)||[]).forEach(function(i){var s=xt(i);if(s[0]==="<Relationship"){var a={};a.Type=s.Type,a.Target=s.Target,a.Id=s.Id,s.TargetMode&&(a.TargetMode=s.TargetMode);var o=s.TargetMode==="External"?s.Target:Ad(s.Target,e);r[o]=a,n[s.Id]=a}}),r["!id"]=n,r}function au(t){var e=[mn,$e("Relationships",null,{xmlns:Rn.RELS})];return cn(t["!id"]).forEach(function(r){e[e.length]=$e("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function yr(t,e,r,n,i,s){if(i||(i={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,i.Id="rId"+e,i.Type=n,i.Target=r,[Vt.HLINK,Vt.XPATH,Vt.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),t["!id"][i.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][i.Id]=i,t[("/"+i.Target).replace("//","/")]=i,e}var fD="application/vnd.oasis.opendocument.spreadsheet";function hD(t,e){for(var r=Q1(t),n,i;n=Ef.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=xt(n[0],!1),i.path=="/"&&i.type!==fD)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}function pD(t){var e=[mn];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function x_(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function gD(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function mD(t){var e=[mn];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(x_(t[r][0],t[r][1])),e.push(gD("",t[r][0]));return e.push(x_("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function _A(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+qh.version+"</meta:generator></office:meta></office:document-meta>"}var Ms=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],xD=function(){for(var t=new Array(Ms.length),e=0;e<Ms.length;++e){var r=Ms[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function EA(t){var e={};t=Tr(t);for(var r=0;r<Ms.length;++r){var n=Ms[r],i=t.match(xD[r]);i!=null&&i.length>0&&(e[n[1]]=nr(i[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=Br(e[n[1]]))}return e}function $g(t,e,r,n,i){i[t]!=null||e==null||e===""||(i[t]=e,e=_r(e),n[n.length]=r?$e(t,e,r):ti(t,e))}function SA(t,e){var r=e||{},n=[mn,$e("cp:coreProperties",null,{"xmlns:cp":Rn.CORE_PROPS,"xmlns:dc":Rn.dc,"xmlns:dcterms":Rn.dcterms,"xmlns:dcmitype":Rn.dcmitype,"xmlns:xsi":Rn.xsi})],i={};if(!t&&!r.Props)return n.join("");t&&(t.CreatedDate!=null&&$g("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:fx(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),t.ModifiedDate!=null&&$g("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:fx(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var s=0;s!=Ms.length;++s){var a=Ms[s],o=r.Props&&r.Props[a[1]]!=null?r.Props[a[1]]:t?t[a[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&$g(a[0],o,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Wl=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],wA=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function TA(t,e,r,n){var i=[];if(typeof t=="string")i=o_(t,n);else for(var s=0;s<t.length;++s)i=i.concat(t[s].map(function(f){return{v:f}}));var a=typeof e=="string"?o_(e,n).map(function(f){return f.v}):e,o=0,l=0;if(a.length>0)for(var u=0;u!==i.length;u+=2){switch(l=+i[u+1].v,i[u].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=a.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=l,r.DefinedNames=a.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=a.slice(o,o+l);break}o+=l}}function vD(t,e,r){var n={};return e||(e={}),t=Tr(t),Wl.forEach(function(i){var s=(t.match(yf(i[0]))||[])[1];switch(i[2]){case"string":s&&(e[i[1]]=nr(s));break;case"bool":e[i[1]]=s==="true";break;case"raw":var a=t.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));a&&a.length>0&&(n[i[1]]=a[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&TA(n.HeadingPairs,n.TitlesOfParts,e,r),e}function AA(t){var e=[],r=$e;return t||(t={}),t.Application="SheetJS",e[e.length]=mn,e[e.length]=$e("Properties",null,{xmlns:Rn.EXT_PROPS,"xmlns:vt":Rn.vt}),Wl.forEach(function(n){if(t[n[1]]!==void 0){var i;switch(n[2]){case"string":i=_r(String(t[n[1]]));break;case"bool":i=t[n[1]]?"true":"false";break}i!==void 0&&(e[e.length]=r(n[0],i))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+_r(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var yD=/<[^>]+>[^<]*/g;function _D(t,e){var r={},n="",i=t.match(yD);if(i)for(var s=0;s!=i.length;++s){var a=i[s],o=xt(a);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=nr(o.name);break;case"</property>":n=null;break;default:if(a.indexOf("<vt:")===0){var l=a.split(">"),u=l[0].slice(4),f=l[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[n]=nr(f);break;case"bool":r[n]=Or(f);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(f,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(f);break;case"filetime":case"date":r[n]=Br(f);break;case"cy":case"error":r[n]=nr(f);break;default:if(u.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",a,u,l)}}else if(a.slice(0,2)!=="</"){if(e.WTF)throw new Error(a)}}}return r}function CA(t){var e=[mn,$e("Properties",null,{xmlns:Rn.CUST_PROPS,"xmlns:vt":Rn.vt})];if(!t)return e.join("");var r=1;return cn(t).forEach(function(i){++r,e[e.length]=$e("property",bR(t[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:_r(i)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var xx={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Gg;function ED(t,e,r){Gg||(Gg=Hp(xx)),e=Gg[e]||e,t[e]=r}function SD(t,e){var r=[];return cn(xx).map(function(n){for(var i=0;i<Ms.length;++i)if(Ms[i][1]==n)return Ms[i];for(i=0;i<Wl.length;++i)if(Wl[i][1]==n)return Wl[i];throw n}).forEach(function(n){if(t[n[1]]!=null){var i=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:t[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(ti(xx[n[1]]||n[1],i))}}),$e("DocumentProperties",r.join(""),{xmlns:ls.o})}function wD(t,e){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return t&&cn(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)){for(var a=0;a<Ms.length;++a)if(s==Ms[a][1])return;for(a=0;a<Wl.length;++a)if(s==Wl[a][1])return;for(a=0;a<r.length;++a)if(s==r[a])return;var o=t[s],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),i.push($e(n_(s),o,{"dt:dt":l}))}}),e&&cn(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)&&!(t&&Object.prototype.hasOwnProperty.call(t,s))){var a=e[s],o="string";typeof a=="number"?(o="float",a=String(a)):a===!0||a===!1?(o="boolean",a=a?"1":"0"):a instanceof Date?(o="dateTime.tz",a=a.toISOString()):a=String(a),i.push($e(n_(s),a,{"dt:dt":o}))}}),"<"+n+' xmlns="'+ls.o+'">'+i.join("")+"</"+n+">"}function lv(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function TD(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,n=r%Math.pow(2,32),i=(r-n)/Math.pow(2,32);n*=1e7,i*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),i+=s);var a=Ee(8);return a.write_shift(4,n),a.write_shift(4,i),a}function kA(t,e,r){var n=t.l,i=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return i}function FA(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function bA(t,e,r){return e===31?FA(t):kA(t,e,r)}function vx(t,e,r){return bA(t,e,r===!1?0:4)}function AD(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return bA(t,e,0)}function CD(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var i=t.l;r[n]=t.read_shift(0,"lpwstr").replace(Pi,""),t.l-i&2&&(t.l+=2)}return r}function kD(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(Pi,"");return r}function FD(t){var e=t.l,r=sp(t,xA);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=sp(t,Gi);return[r,n]}function bD(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(FD(t));return r}function v_(t,e){for(var r=t.read_shift(4),n={},i=0;i!=r;++i){var s=t.read_shift(4),a=t.read_shift(4);n[s]=t.read_shift(a,e===1200?"utf16le":"utf8").replace(Pi,"").replace(Td,"!"),e===1200&&a%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function IA(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function ID(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function sp(t,e,r){var n=t.read_shift(2),i,s=r||{};if(t.l+=2,e!==g_&&n!==e&&oD.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===g_?n:e){case 2:return i=t.read_shift(2,"i"),s.raw||(t.l+=2),i;case 3:return i=t.read_shift(4,"i"),i;case 11:return t.read_shift(4)!==0;case 19:return i=t.read_shift(4),i;case 30:return kA(t,n,4).replace(Pi,"");case 31:return FA(t);case 64:return lv(t);case 65:return IA(t);case 71:return ID(t);case 80:return vx(t,n,!s.raw).replace(Pi,"");case 81:return AD(t,n).replace(Pi,"");case 4108:return bD(t);case 4126:case 4127:return n==4127?CD(t):kD(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function y_(t,e){var r=Ee(4),n=Ee(4);switch(r.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,e);break;case 5:n=Ee(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=TD(e);break;case 31:case 80:for(n=Ee(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return Hn([r,n])}function __(t,e){var r=t.l,n=t.read_shift(4),i=t.read_shift(4),s=[],a=0,o=0,l=-1,u={};for(a=0;a!=i;++a){var f=t.read_shift(4),p=t.read_shift(4);s[a]=[f,p+r]}s.sort(function(C,E){return C[1]-E[1]});var g={};for(a=0;a!=i;++a){if(t.l!==s[a][1]){var m=!0;if(a>0&&e)switch(e[s[a-1][0]].t){case 2:t.l+2===s[a][1]&&(t.l+=2,m=!1);break;case 80:t.l<=s[a][1]&&(t.l=s[a][1],m=!1);break;case 4108:t.l<=s[a][1]&&(t.l=s[a][1],m=!1);break}if((!e||a==0)&&t.l<=s[a][1]&&(m=!1,t.l=s[a][1]),m)throw new Error("Read Error: Expected address "+s[a][1]+" at "+t.l+" :"+a)}if(e){var y=e[s[a][0]];if(g[y.n]=sp(t,y.t,{raw:!0}),y.p==="version"&&(g[y.n]=String(g[y.n]>>16)+"."+("0000"+String(g[y.n]&65535)).slice(-4)),y.n=="CodePage")switch(g[y.n]){case 0:g[y.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Zs(o=g[y.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+g[y.n])}}else if(s[a][0]===1){if(o=g.CodePage=sp(t,av),Zs(o),l!==-1){var x=t.l;t.l=s[l][1],u=v_(t,o),t.l=x}}else if(s[a][0]===0){if(o===0){l=a,t.l=s[a+1][1];continue}u=v_(t,o)}else{var S=u[s[a][0]],A;switch(t[t.l]){case 65:t.l+=4,A=IA(t);break;case 30:t.l+=4,A=vx(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,A=vx(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,A=t.read_shift(4,"i");break;case 19:t.l+=4,A=t.read_shift(4);break;case 5:t.l+=4,A=t.read_shift(8,"f");break;case 11:t.l+=4,A=fn(t,4);break;case 64:t.l+=4,A=Br(lv(t));break;default:throw new Error("unparsed value: "+t[t.l])}g[S]=A}}return t.l=r+n,g}var NA=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function ND(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function E_(t,e,r){var n=Ee(8),i=[],s=[],a=8,o=0,l=Ee(8),u=Ee(8);if(l.write_shift(4,2),l.write_shift(4,1200),u.write_shift(4,1),s.push(l),i.push(u),a+=8+l.length,!e){u=Ee(8),u.write_shift(4,0),i.unshift(u);var f=[Ee(4)];for(f[0].write_shift(4,t.length),o=0;o<t.length;++o){var p=t[o][0];for(l=Ee(8+2*(p.length+1)+(p.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,p.length+1),l.write_shift(0,p,"dbcs");l.l!=l.length;)l.write_shift(1,0);f.push(l)}l=Hn(f),s.unshift(l),a+=8+l.length}for(o=0;o<t.length;++o)if(!(e&&!e[t[o][0]])&&!(NA.indexOf(t[o][0])>-1||wA.indexOf(t[o][0])>-1)&&t[o][1]!=null){var g=t[o][1],m=0;if(e){m=+e[t[o][0]];var y=r[m];if(y.p=="version"&&typeof g=="string"){var x=g.split(".");g=(+x[0]<<16)+(+x[1]||0)}l=y_(y.t,g)}else{var S=ND(g);S==-1&&(S=31,g=String(g)),l=y_(S,g)}s.push(l),u=Ee(8),u.write_shift(4,e?m:2+o),i.push(u),a+=8+l.length}var A=8*(s.length+1);for(o=0;o<s.length;++o)i[o].write_shift(4,A),A+=s[o].length;return n.write_shift(4,a),n.write_shift(4,s.length),Hn([n].concat(i).concat(s))}function S_(t,e,r){var n=t.content;if(!n)return{};ei(n,0);var i,s,a,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var u=n.read_shift(4),f=n.read_shift(16);if(f!==ct.utils.consts.HEADER_CLSID&&f!==r)throw new Error("Bad PropertySet CLSID "+f);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(s=n.read_shift(16),o=n.read_shift(4),i===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);i===2&&(a=n.read_shift(16),l=n.read_shift(4));var p=__(n,e),g={SystemIdentifier:u};for(var m in p)g[m]=p[m];if(g.FMTID=s,i===1)return g;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var y;try{y=__(n,null)}catch{}for(m in y)g[m]=y[m];return g.FMTID=[s,a],g}function w_(t,e,r,n,i,s){var a=Ee(i?68:48),o=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,ct.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,i?2:1),a.write_shift(16,e,"hex"),a.write_shift(4,i?68:48);var l=E_(t,r,n);if(o.push(l),i){var u=E_(i,null,null);a.write_shift(16,s,"hex"),a.write_shift(4,68+l.length),o.push(u)}return Hn(o)}function Do(t,e){return t.read_shift(e),null}function RD(t,e){e||(e=Ee(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function DD(t,e,r){for(var n=[],i=t.l+e;t.l<i;)n.push(r(t,i-t.l));if(i!==t.l)throw new Error("Slurp error");return n}function fn(t,e){return t.read_shift(e)===1}function Ri(t,e){return e||(e=Ee(2)),e.write_shift(2,+!!t),e}function Tn(t){return t.read_shift(2,"u")}function Is(t,e){return e||(e=Ee(2)),e.write_shift(2,t),e}function RA(t,e){return DD(t,e,Tn)}function PD(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function DA(t,e,r){return r||(r=Ee(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function Kf(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=t.read_shift(1);s&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var a=n?t.read_shift(n,i):"";return a}function OD(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,i=r&8,s=1+(r&1),a=0,o,l={};i&&(a=t.read_shift(2)),n&&(o=t.read_shift(4));var u=s==2?"dbcs-cont":"sbcs-cont",f=e===0?"":t.read_shift(e,u);return i&&(t.l+=4*a),n&&(t.l+=o),l.t=f,i||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function MD(t){var e=t.t||"",r=Ee(3);r.write_shift(2,e.length),r.write_shift(1,1);var n=Ee(2*e.length);n.write_shift(2*e.length,e,"utf16le");var i=[r,n];return Hn(i)}function rc(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var i=t.read_shift(1);return i===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function Yf(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):rc(t,n,r)}function xc(t,e,r){if(r.biff>5)return Yf(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function PA(t,e,r){return r||(r=Ee(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function BD(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function jD(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var i=t.read_shift((n?e-24:e)>>1,"utf16le").replace(Pi,"");return n&&(t.l+=24),i}function LD(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=t.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var s=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var a=t.read_shift(s>>1,"utf16le").replace(Pi,"");return r+a}function UD(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return jD(t);case"0303000000000000c000000000000046":return LD(t);default:throw new Error("Unsupported Moniker "+r)}}function V0(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(Pi,""):"";return r}function T_(t,e){e||(e=Ee(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function VD(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=t.read_shift(2);t.l+=2;var s,a,o,l,u="",f,p;i&16&&(s=V0(t,r-t.l)),i&128&&(a=V0(t,r-t.l)),(i&257)===257&&(o=V0(t,r-t.l)),(i&257)===1&&(l=UD(t,r-t.l)),i&8&&(u=V0(t,r-t.l)),i&32&&(f=t.read_shift(16)),i&64&&(p=lv(t)),t.l=r;var g=a||o||l||"";g&&u&&(g+="#"+u),g||(g="#"+u),i&2&&g.charAt(0)=="/"&&g.charAt(1)!="/"&&(g="file://"+g);var m={Target:g};return f&&(m.guid=f),p&&(m.time=p),s&&(m.Tooltip=s),m}function zD(t){var e=Ee(512),r=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),s=i>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}e.write_shift(4,2),e.write_shift(4,s);var a=[8,6815827,6619237,4849780,83];for(r=0;r<a.length;++r)e.write_shift(4,a[r]);if(s==28)n=n.slice(1),T_(n,e);else if(s&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<a.length;++r)e.write_shift(1,parseInt(a[r],16));var o=i>-1?n.slice(0,i):n;for(e.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)e.write_shift(2,o.charCodeAt(r));e.write_shift(2,0),s&8&&T_(i>-1?n.slice(i+1):"",e)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<a.length;++r)e.write_shift(1,parseInt(a[r],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(e.write_shift(2,l),e.write_shift(4,n.length-3*l+1),r=0;r<n.length-3*l;++r)e.write_shift(1,n.charCodeAt(r+3*l)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function OA(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),i=t.read_shift(1);return[e,r,n,i]}function MA(t,e){var r=OA(t);return r[3]=0,r}function Ba(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function nc(t,e,r,n){return n||(n=Ee(6)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r||0),n}function WD(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function HD(t,e,r){return e===0?"":xc(t,e,r)}function $D(t,e,r){var n=r.biff>8?4:2,i=t.read_shift(n),s=t.read_shift(n,"i"),a=t.read_shift(n,"i");return[i,s,a]}function BA(t){var e=t.read_shift(2),r=sv(t);return[e,r]}function GD(t,e,r){t.l+=4,e-=4;var n=t.l+e,i=Kf(t,e,r),s=t.read_shift(2);if(n-=t.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return t.l+=s,i}function Kp(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2);return{s:{c:n,r:e},e:{c:i,r}}}function jA(t,e){return e||(e=Ee(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function LA(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),i=t.read_shift(1);return{s:{c:n,r:e},e:{c:i,r}}}var KD=LA;function UA(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function YD(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function XD(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function di(t){t.l+=2,t.l+=t.read_shift(2)}var qD={0:di,4:di,5:di,6:di,7:XD,8:di,9:di,10:di,11:di,12:di,13:YD,14:di,15:di,16:di,17:di,18:di,19:di,20:di,21:UA};function QD(t,e){for(var r=t.l+e,n=[];t.l<r;){var i=t.read_shift(2);t.l-=2;try{n.push(qD[i](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function z0(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function cv(t,e,r){var n=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=Ee(i);return s.write_shift(2,n),s.write_shift(2,e),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function JD(t,e){return e===0||t.read_shift(2),1200}function ZD(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,i=xc(t,0,r);return t.read_shift(e+n-t.l),i}function e3(t,e){var r=!e||e.biff==8,n=Ee(r?112:54);for(n.write_shift(e.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function t3(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function r3(t,e,r){var n=t.read_shift(4),i=t.read_shift(1)&3,s=t.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var a=Kf(t,0,r);return a.length===0&&(a="Sheet1"),{pos:n,hs:i,dt:s,name:a}}function n3(t,e){var r=!e||e.biff>=8?2:1,n=Ee(8+r*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function i3(t,e){for(var r=t.l+e,n=t.read_shift(4),i=t.read_shift(4),s=[],a=0;a!=i&&t.l<r;++a)s.push(OD(t));return s.Count=n,s.Unique=i,s}function s3(t,e){var r=Ee(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var n=[],i=0;i<t.length;++i)n[i]=MD(t[i]);var s=Hn([r].concat(n));return s.parts=[r.length].concat(n.map(function(a){return a.length})),s}function a3(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function o3(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function l3(t){var e=WD(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function c3(t){return t.read_shift(2),t.read_shift(4)}function A_(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var i=t.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,i]}function u3(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2),l=t.read_shift(2),u=t.read_shift(2);return{Pos:[e,r],Dim:[n,i],Flags:s,CurTab:a,FirstTab:o,Selected:l,TabRatio:u}}function d3(){var t=Ee(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function f3(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function h3(t){var e=Ee(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function p3(){}function g3(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=Kf(t,0,r),n}function m3(t,e){var r=t.name||"Arial",n=e&&e.biff==5,i=n?15+r.length:16+2*r.length,s=Ee(i);return s.write_shift(2,t.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function x3(t){var e=Ba(t);return e.isst=t.read_shift(4),e}function v3(t,e,r,n){var i=Ee(10);return nc(t,e,n,i),i.write_shift(4,r),i}function y3(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,i=Ba(t);r.biff==2&&t.l++;var s=Yf(t,n-t.l,r);return i.val=s,i}function _3(t,e,r,n,i){var s=!i||i.biff==8,a=Ee(8+ +s+(1+s)*r.length);return nc(t,e,n,a),a.write_shift(2,r.length),s&&a.write_shift(1,1),a.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),a}function E3(t,e,r){var n=t.read_shift(2),i=xc(t,0,r);return[n,i]}function S3(t,e,r,n){var i=r&&r.biff==5;n||(n=Ee(i?3+e.length:5+2*e.length)),n.write_shift(2,t),n.write_shift(i?1:2,e.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}var w3=xc;function C_(t,e,r){var n=t.l+e,i=r.biff==8||!r.biff?4:2,s=t.read_shift(i),a=t.read_shift(i),o=t.read_shift(2),l=t.read_shift(2);return t.l=n,{s:{r:s,c:o},e:{r:a,c:l}}}function T3(t,e){var r=e.biff==8||!e.biff?4:2,n=Ee(2*r+6);return n.write_shift(r,t.s.r),n.write_shift(r,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function A3(t){var e=t.read_shift(2),r=t.read_shift(2),n=BA(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function C3(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),s=[];t.l<r;)s.push(BA(t));if(t.l!==r)throw new Error("MulRK read error");var a=t.read_shift(2);if(s.length!=a-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:a,rkrec:s}}function k3(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),s=[];t.l<r;)s.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var a=t.read_shift(2);if(s.length!=a-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:a,ixfe:s}}function F3(t,e,r,n){var i={},s=t.read_shift(4),a=t.read_shift(4),o=t.read_shift(4),l=t.read_shift(2);return i.patternType=lD[o>>26],n.cellStyles&&(i.alc=s&7,i.fWrap=s>>3&1,i.alcV=s>>4&7,i.fJustLast=s>>7&1,i.trot=s>>8&255,i.cIndent=s>>16&15,i.fShrinkToFit=s>>20&1,i.iReadOrder=s>>22&2,i.fAtrNum=s>>26&1,i.fAtrFnt=s>>27&1,i.fAtrAlc=s>>28&1,i.fAtrBdr=s>>29&1,i.fAtrPat=s>>30&1,i.fAtrProt=s>>31&1,i.dgLeft=a&15,i.dgRight=a>>4&15,i.dgTop=a>>8&15,i.dgBottom=a>>12&15,i.icvLeft=a>>16&127,i.icvRight=a>>23&127,i.grbitDiag=a>>30&3,i.icvTop=o&127,i.icvBottom=o>>7&127,i.icvDiag=o>>14&127,i.dgDiag=o>>21&15,i.icvFore=l&127,i.icvBack=l>>7&127,i.fsxButton=l>>14&1),i}function b3(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=F3(t,e,n.fStyle,r),n}function k_(t,e,r,n){var i=r&&r.biff==5;n||(n=Ee(i?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,e<<4));var s=0;return t.numFmtId>0&&i&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function I3(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function N3(t){var e=Ee(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function F_(t,e,r){var n=Ba(t);(r.biff==2||e==9)&&++t.l;var i=PD(t);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function R3(t,e,r,n,i,s){var a=Ee(8);return nc(t,e,n,a),DA(r,s,a),a}function D3(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Ba(t),i=yi(t);return n.val=i,n}function P3(t,e,r,n){var i=Ee(14);return nc(t,e,n,i),tc(r,i),i}var b_=HD;function O3(t,e,r){var n=t.l+e,i=t.read_shift(2),s=t.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,i];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var a=rc(t,s),o=[];n>t.l;)o.push(Yf(t));return[s,i,a,o]}function I_(t,e,r){var n=t.read_shift(2),i,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=GD(t,e-2,r)),s.body=i||t.read_shift(e-2),typeof i=="string"&&(s.Name=i),s}var M3=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function N_(t,e,r){var n=t.l+e,i=t.read_shift(2),s=t.read_shift(1),a=t.read_shift(1),o=t.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),l=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var u=rc(t,a,r);i&32&&(u=M3[u.charCodeAt(0)]);var f=n-t.l;r&&r.biff==2&&--f;var p=n==t.l||o===0||!(f>0)?[]:Q5(t,f,r,o);return{chKey:s,Name:u,itab:l,rgce:p}}function VA(t,e,r){if(r.biff<8)return B3(t,e,r);for(var n=[],i=t.l+e,s=t.read_shift(r.biff>8?4:2);s--!==0;)n.push($D(t,r.biff>8?12:6,r));if(t.l!=i)throw new Error("Bad ExternSheet: "+t.l+" != "+i);return n}function B3(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=Kf(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function j3(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),i=t.read_shift(2),s=rc(t,n,r),a=rc(t,i,r);return[s,a]}function L3(t,e,r){var n=LA(t);t.l++;var i=t.read_shift(1);return e-=8,[J5(t,e,r),i,n]}function R_(t,e,r){var n=KD(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,X5(t,e,r)]}function U3(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function V3(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),o=xc(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:i},o,a,s]}}function z3(t,e,r){return V3(t,e,r)}function W3(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(Kp(t));return r}function H3(t){var e=Ee(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)jA(t[r],e);return e}function $3(t,e,r){if(r&&r.biff<8)return K3(t,e,r);var n=UA(t),i=QD(t,e-22,n[1]);return{cmo:n,ft:i}}var G3={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var i=t.read_shift(1);return t.l+=i,t.l=r,{fmt:n}}};function K3(t,e,r){t.l+=4;var n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var a=[];return a.push((G3[n]||Si)(t,e,r)),{cmo:[i,n,s],ft:a}}function Y3(t,e,r){var n=t.l,i="";try{t.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],a;[0,5,7,11,12,14].indexOf(s)==-1?t.l+=6:a=BD(t,6,r);var o=t.read_shift(2);t.read_shift(2),Tn(t,2);var l=t.read_shift(2);t.l+=l;for(var u=1;u<t.lens.length-1;++u){if(t.l-n!=t.lens[u])throw new Error("TxO: bad continue record");var f=t[t.l],p=rc(t,t.lens[u+1]-t.lens[u]-1);if(i+=p,i.length>=(f?o:2*o))break}if(i.length!==o&&i.length!==o*2)throw new Error("cchText: "+o+" != "+i.length);return t.l=n+e,{t:i}}catch{return t.l=n+e,{t:i}}}function X3(t,e){var r=Kp(t);t.l+=16;var n=VD(t,e-24);return[r,n]}function q3(t){var e=Ee(24),r=Jr(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)e.write_shift(1,parseInt(n[i],16));return Hn([e,zD(t[1])])}function Q3(t,e){t.read_shift(2);var r=Kp(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(Pi,""),[r,n]}function J3(t){var e=t[1].Tooltip,r=Ee(10+2*(e.length+1));r.write_shift(2,2048);var n=Jr(t[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<e.length;++i)r.write_shift(2,e.charCodeAt(i));return r.write_shift(2,0),r}function Z3(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=m_[r]||r,r=t.read_shift(2),e[1]=m_[r]||r,e}function e6(t){return t||(t=Ee(4)),t.write_shift(2,1),t.write_shift(2,1),t}function t6(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(MA(t));return r}function r6(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(MA(t));return r}function n6(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function zA(t,e,r){if(!r.cellStyles)return Si(t,e);var n=r&&r.biff>=12?4:2,i=t.read_shift(n),s=t.read_shift(n),a=t.read_shift(n),o=t.read_shift(n),l=t.read_shift(2);n==2&&(t.l+=2);var u={s:i,e:s,w:a,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(u.level=l>>8&7),u}function i6(t,e){var r=Ee(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var n=0;return t.hidden&&(n|=1),r.write_shift(1,n),n=t.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function s6(t,e){var r={};return e<32||(t.l+=16,r.header=yi(t),r.footer=yi(t),t.l+=2),r}function a6(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var i=t.read_shift(1);return t.l+=3,i&16&&(n.area=!0),n}function o6(t){for(var e=Ee(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}var l6=Ba,c6=RA,u6=Yf;function d6(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,i}function f6(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Ba(t);++t.l;var i=xc(t,e-7,r);return n.t="str",n.val=i,n}function h6(t){var e=Ba(t);++t.l;var r=yi(t);return e.t="n",e.val=r,e}function p6(t,e,r){var n=Ee(15);return Jf(n,t,e),n.write_shift(8,r,"f"),n}function g6(t){var e=Ba(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function m6(t,e,r){var n=Ee(9);return Jf(n,t,e),n.write_shift(2,r),n}function x6(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function v6(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function y6(t,e,r){var n=t.l+e,i=Ba(t),s=t.read_shift(2),a=rc(t,s,r);return t.l=n,i.t="str",i.val=a,i}var _6=[2,3,48,49,131,139,140,245],yx=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=Hp({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var u=[],f=fl(1);switch(l.type){case"base64":f=us(ms(o));break;case"binary":f=us(o);break;case"buffer":case"array":f=o;break}ei(f,0);var p=f.read_shift(1),g=!!(p&136),m=!1,y=!1;switch(p){case 2:break;case 3:break;case 48:m=!0,g=!0;break;case 49:m=!0,g=!0;break;case 131:break;case 139:break;case 140:y=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+p.toString(16))}var x=0,S=521;p==2&&(x=f.read_shift(2)),f.l+=3,p!=2&&(x=f.read_shift(4)),x>1048576&&(x=1e6),p!=2&&(S=f.read_shift(2));var A=f.read_shift(2),C=l.codepage||1252;p!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(C=t[f[f.l]]),f.l+=1,f.l+=2),y&&(f.l+=36);for(var E=[],O={},Q=Math.min(f.length,p==2?521:S-10-(m?264:0)),H=y?32:11;f.l<Q&&f[f.l]!=13;)switch(O={},O.name=mf.utils.decode(C,f.slice(f.l,f.l+H)).replace(/[\u0000\r\n].*$/g,""),f.l+=H,O.type=String.fromCharCode(f.read_shift(1)),p!=2&&!y&&(O.offset=f.read_shift(4)),O.len=f.read_shift(1),p==2&&(O.offset=f.read_shift(2)),O.dec=f.read_shift(1),O.name.length&&E.push(O),p!=2&&(f.l+=y?13:14),O.type){case"B":(!m||O.len!=8)&&l.WTF&&console.log("Skipping "+O.name+":"+O.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+O.name+":"+O.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+O.type)}if(f[f.l]!==13&&(f.l=S-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=S;var w=0,F=0;for(u[0]=[],F=0;F!=E.length;++F)u[0][F]=E[F].name;for(;x-- >0;){if(f[f.l]===42){f.l+=A;continue}for(++f.l,u[++w]=[],F=0,F=0;F!=E.length;++F){var T=f.slice(f.l,f.l+E[F].len);f.l+=E[F].len,ei(T,0);var N=mf.utils.decode(C,T);switch(E[F].type){case"C":N.trim().length&&(u[w][F]=N.replace(/\s+$/,""));break;case"D":N.length===8?u[w][F]=new Date(+N.slice(0,4),+N.slice(4,6)-1,+N.slice(6,8)):u[w][F]=N;break;case"F":u[w][F]=parseFloat(N.trim());break;case"+":case"I":u[w][F]=y?T.read_shift(-4,"i")^2147483648:T.read_shift(4,"i");break;case"L":switch(N.trim().toUpperCase()){case"Y":case"T":u[w][F]=!0;break;case"N":case"F":u[w][F]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+N+"|")}break;case"M":if(!g)throw new Error("DBF Unexpected MEMO for type "+p.toString(16));u[w][F]="##MEMO##"+(y?parseInt(N.trim(),10):T.read_shift(4));break;case"N":N=N.replace(/\u0000/g,"").trim(),N&&N!="."&&(u[w][F]=+N||0);break;case"@":u[w][F]=new Date(T.read_shift(-8,"f")-621356832e5);break;case"T":u[w][F]=new Date((T.read_shift(4)-2440588)*864e5+T.read_shift(4));break;case"Y":u[w][F]=T.read_shift(4,"i")/1e4+T.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[w][F]=-T.read_shift(-8,"f");break;case"B":if(m&&E[F].len==8){u[w][F]=T.read_shift(8,"f");break}case"G":case"P":T.l+=E[F].len;break;case"0":if(E[F].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+E[F].type)}}}if(p!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return l&&l.sheetRows&&(u=u.slice(0,l.sheetRows)),l.DBF=E,u}function n(o,l){var u=l||{};u.dateNF||(u.dateNF="yyyymmdd");var f=Bu(r(o,u),u);return f["!cols"]=u.DBF.map(function(p){return{wch:p.len,DBF:p}}),delete u.DBF,f}function i(o,l){try{return wl(n(o,l),l)}catch(u){if(l&&l.WTF)throw u}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,l){var u=l||{};if(+u.codepage>=0&&Zs(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var f=Ji(),p=lp(o,{header:1,raw:!0,cellDates:!0}),g=p[0],m=p.slice(1),y=o["!cols"]||[],x=0,S=0,A=0,C=1;for(x=0;x<g.length;++x){if(((y[x]||{}).DBF||{}).name){g[x]=y[x].DBF.name,++A;continue}if(g[x]!=null){if(++A,typeof g[x]=="number"&&(g[x]=g[x].toString(10)),typeof g[x]!="string")throw new Error("DBF Invalid column name "+g[x]+" |"+typeof g[x]+"|");if(g.indexOf(g[x])!==x){for(S=0;S<1024;++S)if(g.indexOf(g[x]+"_"+S)==-1){g[x]+="_"+S;break}}}}var E=ir(o["!ref"]),O=[],Q=[],H=[];for(x=0;x<=E.e.c-E.s.c;++x){var w="",F="",T=0,N=[];for(S=0;S<m.length;++S)m[S][x]!=null&&N.push(m[S][x]);if(N.length==0||g[x]==null){O[x]="?";continue}for(S=0;S<N.length;++S){switch(typeof N[S]){case"number":F="B";break;case"string":F="C";break;case"boolean":F="L";break;case"object":F=N[S]instanceof Date?"D":"C";break;default:F="C"}T=Math.max(T,String(N[S]).length),w=w&&w!=F?"C":F}T>250&&(T=250),F=((y[x]||{}).DBF||{}).type,F=="C"&&y[x].DBF.len>T&&(T=y[x].DBF.len),w=="B"&&F=="N"&&(w="N",H[x]=y[x].DBF.dec,T=y[x].DBF.len),Q[x]=w=="C"||F=="N"?T:s[w]||0,C+=Q[x],O[x]=w}var D=f.next(32);for(D.write_shift(4,318902576),D.write_shift(4,m.length),D.write_shift(2,296+32*A),D.write_shift(2,C),x=0;x<4;++x)D.write_shift(4,0);for(D.write_shift(4,0|(+e[NT]||3)<<8),x=0,S=0;x<g.length;++x)if(g[x]!=null){var P=f.next(32),R=(g[x].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);P.write_shift(1,R,"sbcs"),P.write_shift(1,O[x]=="?"?"C":O[x],"sbcs"),P.write_shift(4,S),P.write_shift(1,Q[x]||s[O[x]]||0),P.write_shift(1,H[x]||0),P.write_shift(1,2),P.write_shift(4,0),P.write_shift(1,0),P.write_shift(4,0),P.write_shift(4,0),S+=Q[x]||s[O[x]]||0}var Xe=f.next(264);for(Xe.write_shift(4,13),x=0;x<65;++x)Xe.write_shift(4,0);for(x=0;x<m.length;++x){var Se=f.next(C);for(Se.write_shift(1,0),S=0;S<g.length;++S)if(g[S]!=null)switch(O[S]){case"L":Se.write_shift(1,m[x][S]==null?63:m[x][S]?84:70);break;case"B":Se.write_shift(8,m[x][S]||0,"f");break;case"N":var De="0";for(typeof m[x][S]=="number"&&(De=m[x][S].toFixed(H[S]||0)),A=0;A<Q[S]-De.length;++A)Se.write_shift(1,32);Se.write_shift(1,De,"sbcs");break;case"D":m[x][S]?(Se.write_shift(4,("0000"+m[x][S].getFullYear()).slice(-4),"sbcs"),Se.write_shift(2,("00"+(m[x][S].getMonth()+1)).slice(-2),"sbcs"),Se.write_shift(2,("00"+m[x][S].getDate()).slice(-2),"sbcs")):Se.write_shift(8,"00000000","sbcs");break;case"C":var ke=String(m[x][S]!=null?m[x][S]:"").slice(0,Q[S]);for(Se.write_shift(1,ke,"sbcs"),A=0;A<Q[S]-ke.length;++A)Se.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:i,to_sheet:n,from_sheet:a}}(),WA=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+cn(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(g,m){var y=t[m];return typeof y=="number"?W2(y):y},n=function(g,m,y){var x=m.charCodeAt(0)-32<<4|y.charCodeAt(0)-48;return x==59?g:W2(x)};t["|"]=254;function i(g,m){switch(m.type){case"base64":return s(ms(g),m);case"binary":return s(g,m);case"buffer":return s(Lt&&Buffer.isBuffer(g)?g.toString("binary"):Sl(g),m);case"array":return s(ec(g),m)}throw new Error("Unrecognized type "+m.type)}function s(g,m){var y=g.split(/[\n\r]+/),x=-1,S=-1,A=0,C=0,E=[],O=[],Q=null,H={},w=[],F=[],T=[],N=0,D;for(+m.codepage>=0&&Zs(+m.codepage);A!==y.length;++A){N=0;var P=y[A].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),R=P.replace(/;;/g,"\0").split(";").map(function(X){return X.replace(/\u0000/g,";")}),Xe=R[0],Se;if(P.length>0)switch(Xe){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":R[1].charAt(0)=="P"&&O.push(P.slice(3).replace(/;;/g,";"));break;case"C":var De=!1,ke=!1,Ce=!1,ie=!1,be=-1,Me=-1;for(C=1;C<R.length;++C)switch(R[C].charAt(0)){case"A":break;case"X":S=parseInt(R[C].slice(1))-1,ke=!0;break;case"Y":for(x=parseInt(R[C].slice(1))-1,ke||(S=0),D=E.length;D<=x;++D)E[D]=[];break;case"K":Se=R[C].slice(1),Se.charAt(0)==='"'?Se=Se.slice(1,Se.length-1):Se==="TRUE"?Se=!0:Se==="FALSE"?Se=!1:isNaN(ia(Se))?isNaN(_u(Se).getDate())||(Se=Br(Se)):(Se=ia(Se),Q!==null&&Ou(Q)&&(Se=Gp(Se))),De=!0;break;case"E":ie=!0;var Y=ou(R[C].slice(1),{r:x,c:S});E[x][S]=[E[x][S],Y];break;case"S":Ce=!0,E[x][S]=[E[x][S],"S5S"];break;case"G":break;case"R":be=parseInt(R[C].slice(1))-1;break;case"C":Me=parseInt(R[C].slice(1))-1;break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+P)}if(De&&(E[x][S]&&E[x][S].length==2?E[x][S][0]=Se:E[x][S]=Se,Q=null),Ce){if(ie)throw new Error("SYLK shared formula cannot have own formula");var re=be>-1&&E[be][Me];if(!re||!re[1])throw new Error("SYLK shared formula cannot find base");E[x][S][1]=oC(re[1],{r:x-be,c:S-Me})}break;case"F":var ne=0;for(C=1;C<R.length;++C)switch(R[C].charAt(0)){case"X":S=parseInt(R[C].slice(1))-1,++ne;break;case"Y":for(x=parseInt(R[C].slice(1))-1,D=E.length;D<=x;++D)E[D]=[];break;case"M":N=parseInt(R[C].slice(1))/20;break;case"F":break;case"G":break;case"P":Q=O[parseInt(R[C].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(T=R[C].slice(1).split(" "),D=parseInt(T[0],10);D<=parseInt(T[1],10);++D)N=parseInt(T[2],10),F[D-1]=N===0?{hidden:!0}:{wch:N},hl(F[D-1]);break;case"C":S=parseInt(R[C].slice(1))-1,F[S]||(F[S]={});break;case"R":x=parseInt(R[C].slice(1))-1,w[x]||(w[x]={}),N>0?(w[x].hpt=N,w[x].hpx=Su(N)):N===0&&(w[x].hidden=!0);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+P)}ne<1&&(Q=null);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+P)}}return w.length>0&&(H["!rows"]=w),F.length>0&&(H["!cols"]=F),m&&m.sheetRows&&(E=E.slice(0,m.sheetRows)),[E,H]}function a(g,m){var y=i(g,m),x=y[0],S=y[1],A=Bu(x,m);return cn(S).forEach(function(C){A[C]=S[C]}),A}function o(g,m){return wl(a(g,m),m)}function l(g,m,y,x){var S="C;Y"+(y+1)+";X"+(x+1)+";K";switch(g.t){case"n":S+=g.v||0,g.f&&!g.F&&(S+=";E"+gv(g.f,{r:y,c:x}));break;case"b":S+=g.v?"TRUE":"FALSE";break;case"e":S+=g.w||g.v;break;case"d":S+='"'+(g.w||g.v)+'"';break;case"s":S+='"'+g.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return S}function u(g,m){m.forEach(function(y,x){var S="F;W"+(x+1)+" "+(x+1)+" ";y.hidden?S+="0":(typeof y.width=="number"&&!y.wpx&&(y.wpx=Tf(y.width)),typeof y.wpx=="number"&&!y.wch&&(y.wch=Af(y.wpx)),typeof y.wch=="number"&&(S+=Math.round(y.wch))),S.charAt(S.length-1)!=" "&&g.push(S)})}function f(g,m){m.forEach(function(y,x){var S="F;";y.hidden?S+="M0;":y.hpt?S+="M"+20*y.hpt+";":y.hpx&&(S+="M"+20*Cf(y.hpx)+";"),S.length>2&&g.push(S+"R"+(x+1))})}function p(g,m){var y=["ID;PWXL;N;E"],x=[],S=ir(g["!ref"]),A,C=Array.isArray(g),E=`\r
`;y.push("P;PGeneral"),y.push("F;P0;DG0G8;M255"),g["!cols"]&&u(y,g["!cols"]),g["!rows"]&&f(y,g["!rows"]),y.push("B;Y"+(S.e.r-S.s.r+1)+";X"+(S.e.c-S.s.c+1)+";D"+[S.s.c,S.s.r,S.e.c,S.e.r].join(" "));for(var O=S.s.r;O<=S.e.r;++O)for(var Q=S.s.c;Q<=S.e.c;++Q){var H=gt({r:O,c:Q});A=C?(g[O]||[])[Q]:g[H],!(!A||A.v==null&&(!A.f||A.F))&&x.push(l(A,g,O,Q))}return y.join(E)+E+x.join(E)+E+"E"+E}return{to_workbook:o,to_sheet:a,from_sheet:p}}(),HA=function(){function t(s,a){switch(a.type){case"base64":return e(ms(s),a);case"binary":return e(s,a);case"buffer":return e(Lt&&Buffer.isBuffer(s)?s.toString("binary"):Sl(s),a);case"array":return e(ec(s),a)}throw new Error("Unrecognized type "+a.type)}function e(s,a){for(var o=s.split(`
`),l=-1,u=-1,f=0,p=[];f!==o.length;++f){if(o[f].trim()==="BOT"){p[++l]=[],u=0;continue}if(!(l<0)){var g=o[f].trim().split(","),m=g[0],y=g[1];++f;for(var x=o[f]||"";(x.match(/["]/g)||[]).length&1&&f<o.length-1;)x+=`
`+o[++f];switch(x=x.trim(),+m){case-1:if(x==="BOT"){p[++l]=[],u=0;continue}else if(x!=="EOD")throw new Error("Unrecognized DIF special command "+x);break;case 0:x==="TRUE"?p[l][u]=!0:x==="FALSE"?p[l][u]=!1:isNaN(ia(y))?isNaN(_u(y).getDate())?p[l][u]=y:p[l][u]=Br(y):p[l][u]=ia(y),++u;break;case 1:x=x.slice(1,x.length-1),x=x.replace(/""/g,'"'),x&&x.match(/^=".*"$/)&&(x=x.slice(2,-1)),p[l][u++]=x!==""?x:null;break}if(x==="EOD")break}}return a&&a.sheetRows&&(p=p.slice(0,a.sheetRows)),p}function r(s,a){return Bu(t(s,a),a)}function n(s,a){return wl(r(s,a),a)}var i=function(){var s=function(l,u,f,p,g){l.push(u),l.push(f+","+p),l.push('"'+g.replace(/"/g,'""')+'"')},a=function(l,u,f,p){l.push(u+","+f),l.push(u==1?'"'+p.replace(/"/g,'""')+'"':p)};return function(l){var u=[],f=ir(l["!ref"]),p,g=Array.isArray(l);s(u,"TABLE",0,1,"sheetjs"),s(u,"VECTORS",0,f.e.r-f.s.r+1,""),s(u,"TUPLES",0,f.e.c-f.s.c+1,""),s(u,"DATA",0,0,"");for(var m=f.s.r;m<=f.e.r;++m){a(u,-1,0,"BOT");for(var y=f.s.c;y<=f.e.c;++y){var x=gt({r:m,c:y});if(p=g?(l[m]||[])[y]:l[x],!p){a(u,1,0,"");continue}switch(p.t){case"n":var S=p.w;!S&&p.v!=null&&(S=p.v),S==null?p.f&&!p.F?a(u,1,0,"="+p.f):a(u,1,0,""):a(u,0,S,"V");break;case"b":a(u,0,p.v?1:0,p.v?"TRUE":"FALSE");break;case"s":a(u,1,0,isNaN(p.v)?p.v:'="'+p.v+'"');break;case"d":p.w||(p.w=Ls(p.z||pt[14],Mn(Br(p.v)))),a(u,0,p.w,"V");break;default:a(u,1,0,"")}}}a(u,-1,0,"EOD");var A=`\r
`,C=u.join(A);return C}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),$A=function(){function t(p){return p.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(p){return p.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(p,g){for(var m=p.split(`
`),y=-1,x=-1,S=0,A=[];S!==m.length;++S){var C=m[S].trim().split(":");if(C[0]==="cell"){var E=Jr(C[1]);if(A.length<=E.r)for(y=A.length;y<=E.r;++y)A[y]||(A[y]=[]);switch(y=E.r,x=E.c,C[2]){case"t":A[y][x]=t(C[3]);break;case"v":A[y][x]=+C[3];break;case"vtf":var O=C[C.length-1];case"vtc":switch(C[3]){case"nl":A[y][x]=!!+C[4];break;default:A[y][x]=+C[4];break}C[2]=="vtf"&&(A[y][x]=[A[y][x],O])}}}return g&&g.sheetRows&&(A=A.slice(0,g.sheetRows)),A}function n(p,g){return Bu(r(p,g),g)}function i(p,g){return wl(n(p,g),g)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function u(p){if(!p||!p["!ref"])return"";for(var g=[],m=[],y,x="",S=Zi(p["!ref"]),A=Array.isArray(p),C=S.s.r;C<=S.e.r;++C)for(var E=S.s.c;E<=S.e.c;++E)if(x=gt({r:C,c:E}),y=A?(p[C]||[])[E]:p[x],!(!y||y.v==null||y.t==="z")){switch(m=["cell",x,"t"],y.t){case"s":case"str":m.push(e(y.v));break;case"n":y.f?(m[2]="vtf",m[3]="n",m[4]=y.v,m[5]=e(y.f)):(m[2]="v",m[3]=y.v);break;case"b":m[2]="vt"+(y.f?"f":"c"),m[3]="nl",m[4]=y.v?"1":"0",m[5]=e(y.f||(y.v?"TRUE":"FALSE"));break;case"d":var O=Mn(Br(y.v));m[2]="vtc",m[3]="nd",m[4]=""+O,m[5]=y.w||Ls(y.z||pt[14],O);break;case"e":continue}g.push(m.join(":"))}return g.push("sheet:c:"+(S.e.c-S.s.c+1)+":r:"+(S.e.r-S.s.r+1)+":tvf:1"),g.push("valueformat:1:text-wiki"),g.join(`
`)}function f(p){return[s,a,o,a,u(p),l].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:f}}(),Eu=function(){function t(f,p,g,m,y){y.raw?p[g][m]=f:f===""||(f==="TRUE"?p[g][m]=!0:f==="FALSE"?p[g][m]=!1:isNaN(ia(f))?isNaN(_u(f).getDate())?p[g][m]=f:p[g][m]=Br(f):p[g][m]=ia(f))}function e(f,p){var g=p||{},m=[];if(!f||f.length===0)return m;for(var y=f.split(/[\r\n]/),x=y.length-1;x>=0&&y[x].length===0;)--x;for(var S=10,A=0,C=0;C<=x;++C)A=y[C].indexOf(" "),A==-1?A=y[C].length:A++,S=Math.max(S,A);for(C=0;C<=x;++C){m[C]=[];var E=0;for(t(y[C].slice(0,S).trim(),m,C,E,g),E=1;E<=(y[C].length-S)/10+1;++E)t(y[C].slice(S+(E-1)*10,S+E*10).trim(),m,C,E,g)}return g.sheetRows&&(m=m.slice(0,g.sheetRows)),m}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(f){for(var p={},g=!1,m=0,y=0;m<f.length;++m)(y=f.charCodeAt(m))==34?g=!g:!g&&y in r&&(p[y]=(p[y]||0)+1);y=[];for(m in p)Object.prototype.hasOwnProperty.call(p,m)&&y.push([p[m],m]);if(!y.length){p=n;for(m in p)Object.prototype.hasOwnProperty.call(p,m)&&y.push([p[m],m])}return y.sort(function(x,S){return x[0]-S[0]||n[x[1]]-n[S[1]]}),r[y.pop()[1]]||44}function s(f,p){var g=p||{},m="",y=g.dense?[]:{},x={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(m=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(m=f.charAt(4),f=f.slice(6)):m=i(f.slice(0,1024)):g&&g.FS?m=g.FS:m=i(f.slice(0,1024));var S=0,A=0,C=0,E=0,O=0,Q=m.charCodeAt(0),H=!1,w=0,F=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var T=g.dateNF!=null?aR(g.dateNF):null;function N(){var D=f.slice(E,O),P={};if(D.charAt(0)=='"'&&D.charAt(D.length-1)=='"'&&(D=D.slice(1,-1).replace(/""/g,'"')),D.length===0)P.t="z";else if(g.raw)P.t="s",P.v=D;else if(D.trim().length===0)P.t="s",P.v=D;else if(D.charCodeAt(0)==61)D.charCodeAt(1)==34&&D.charCodeAt(D.length-1)==34?(P.t="s",P.v=D.slice(2,-1).replace(/""/g,'"')):O8(D)?(P.t="n",P.f=D.slice(1)):(P.t="s",P.v=D);else if(D=="TRUE")P.t="b",P.v=!0;else if(D=="FALSE")P.t="b",P.v=!1;else if(!isNaN(C=ia(D)))P.t="n",g.cellText!==!1&&(P.w=D),P.v=C;else if(!isNaN(_u(D).getDate())||T&&D.match(T)){P.z=g.dateNF||pt[14];var R=0;T&&D.match(T)&&(D=oR(D,g.dateNF,D.match(T)||[]),R=1),g.cellDates?(P.t="d",P.v=Br(D,R)):(P.t="n",P.v=Mn(Br(D,R))),g.cellText!==!1&&(P.w=Ls(P.z,P.v instanceof Date?Mn(P.v):P.v)),g.cellNF||delete P.z}else P.t="s",P.v=D;if(P.t=="z"||(g.dense?(y[S]||(y[S]=[]),y[S][A]=P):y[gt({c:A,r:S})]=P),E=O+1,F=f.charCodeAt(E),x.e.c<A&&(x.e.c=A),x.e.r<S&&(x.e.r=S),w==Q)++A;else if(A=0,++S,g.sheetRows&&g.sheetRows<=S)return!0}e:for(;O<f.length;++O)switch(w=f.charCodeAt(O)){case 34:F===34&&(H=!H);break;case Q:case 10:case 13:if(!H&&N())break e;break}return O-E>0&&N(),y["!ref"]=Nt(x),y}function a(f,p){return!(p&&p.PRN)||p.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?s(f,p):Bu(e(f,p),p)}function o(f,p){var g="",m=p.type=="string"?[0,0,0,0]:wv(f,p);switch(p.type){case"base64":g=ms(f);break;case"binary":g=f;break;case"buffer":p.codepage==65001?g=f.toString("utf8"):p.codepage&&typeof mf<"u"||(g=Lt&&Buffer.isBuffer(f)?f.toString("binary"):Sl(f));break;case"array":g=ec(f);break;case"string":g=f;break;default:throw new Error("Unrecognized type "+p.type)}return m[0]==239&&m[1]==187&&m[2]==191?g=Tr(g.slice(3)):p.type!="string"&&p.type!="buffer"&&p.codepage==65001?g=Tr(g):p.type=="binary"&&typeof mf<"u",g.slice(0,19)=="socialcalc:version:"?$A.to_sheet(p.type=="string"?g:Tr(g),p):a(g,p)}function l(f,p){return wl(o(f,p),p)}function u(f){for(var p=[],g=ir(f["!ref"]),m,y=Array.isArray(f),x=g.s.r;x<=g.e.r;++x){for(var S=[],A=g.s.c;A<=g.e.c;++A){var C=gt({r:x,c:A});if(m=y?(f[x]||[])[A]:f[C],!m||m.v==null){S.push("          ");continue}for(var E=(m.w||(oo(m),m.w)||"").slice(0,10);E.length<10;)E+=" ";S.push(E+(A===0?" ":""))}p.push(S.join(""))}return p.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:u}}();function E6(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var i=WA.to_workbook(t,r);return r.WTF=n,i}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return Eu.to_workbook(t,e)}}var Hl=function(){function t(Y,re,ne){if(Y){ei(Y,Y.l||0);for(var X=ne.Enum||be;Y.l<Y.length;){var _e=Y.read_shift(2),Te=X[_e]||X[65535],Le=Y.read_shift(2),Ne=Y.l+Le,Ie=Te.f&&Te.f(Y,Le,ne);if(Y.l=Ne,re(Ie,Te,_e))return}}}function e(Y,re){switch(re.type){case"base64":return r(us(ms(Y)),re);case"binary":return r(us(Y),re);case"buffer":case"array":return r(Y,re)}throw"Unsupported type "+re.type}function r(Y,re){if(!Y)return Y;var ne=re||{},X=ne.dense?[]:{},_e="Sheet1",Te="",Le=0,Ne={},Ie=[],ot=[],ee={s:{r:0,c:0},e:{r:0,c:0}},Ot=ne.sheetRows||0;if(Y[2]==0&&(Y[3]==8||Y[3]==9)&&Y.length>=16&&Y[14]==5&&Y[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(Y[2]==2)ne.Enum=be,t(Y,function(Ke,wr,rn){switch(rn){case 0:ne.vers=Ke,Ke>=4096&&(ne.qpro=!0);break;case 6:ee=Ke;break;case 204:Ke&&(Te=Ke);break;case 222:Te=Ke;break;case 15:case 51:ne.qpro||(Ke[1].v=Ke[1].v.slice(1));case 13:case 14:case 16:rn==14&&(Ke[2]&112)==112&&(Ke[2]&15)>1&&(Ke[2]&15)<15&&(Ke[1].z=ne.dateNF||pt[14],ne.cellDates&&(Ke[1].t="d",Ke[1].v=Gp(Ke[1].v))),ne.qpro&&Ke[3]>Le&&(X["!ref"]=Nt(ee),Ne[_e]=X,Ie.push(_e),X=ne.dense?[]:{},ee={s:{r:0,c:0},e:{r:0,c:0}},Le=Ke[3],_e=Te||"Sheet"+(Le+1),Te="");var Cn=ne.dense?(X[Ke[0].r]||[])[Ke[0].c]:X[gt(Ke[0])];if(Cn){Cn.t=Ke[1].t,Cn.v=Ke[1].v,Ke[1].z!=null&&(Cn.z=Ke[1].z),Ke[1].f!=null&&(Cn.f=Ke[1].f);break}ne.dense?(X[Ke[0].r]||(X[Ke[0].r]=[]),X[Ke[0].r][Ke[0].c]=Ke[1]):X[gt(Ke[0])]=Ke[1];break}},ne);else if(Y[2]==26||Y[2]==14)ne.Enum=Me,Y[2]==14&&(ne.qpro=!0,Y.l=0),t(Y,function(Ke,wr,rn){switch(rn){case 204:_e=Ke;break;case 22:Ke[1].v=Ke[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Ke[3]>Le&&(X["!ref"]=Nt(ee),Ne[_e]=X,Ie.push(_e),X=ne.dense?[]:{},ee={s:{r:0,c:0},e:{r:0,c:0}},Le=Ke[3],_e="Sheet"+(Le+1)),Ot>0&&Ke[0].r>=Ot)break;ne.dense?(X[Ke[0].r]||(X[Ke[0].r]=[]),X[Ke[0].r][Ke[0].c]=Ke[1]):X[gt(Ke[0])]=Ke[1],ee.e.c<Ke[0].c&&(ee.e.c=Ke[0].c),ee.e.r<Ke[0].r&&(ee.e.r=Ke[0].r);break;case 27:Ke[14e3]&&(ot[Ke[14e3][0]]=Ke[14e3][1]);break;case 1537:ot[Ke[0]]=Ke[1],Ke[0]==Le&&(_e=Ke[1]);break}},ne);else throw new Error("Unrecognized LOTUS BOF "+Y[2]);if(X["!ref"]=Nt(ee),Ne[Te||_e]=X,Ie.push(Te||_e),!ot.length)return{SheetNames:Ie,Sheets:Ne};for(var wt={},Mt=[],St=0;St<ot.length;++St)Ne[Ie[St]]?(Mt.push(ot[St]||Ie[St]),wt[ot[St]]=Ne[ot[St]]||Ne[Ie[St]]):(Mt.push(ot[St]),wt[ot[St]]={"!ref":"A1"});return{SheetNames:Mt,Sheets:wt}}function n(Y,re){var ne=re||{};if(+ne.codepage>=0&&Zs(+ne.codepage),ne.type=="string")throw new Error("Cannot write WK1 to JS string");var X=Ji(),_e=ir(Y["!ref"]),Te=Array.isArray(Y),Le=[];Ge(X,0,s(1030)),Ge(X,6,l(_e));for(var Ne=Math.min(_e.e.r,8191),Ie=_e.s.r;Ie<=Ne;++Ie)for(var ot=gn(Ie),ee=_e.s.c;ee<=_e.e.c;++ee){Ie===_e.s.r&&(Le[ee]=Qr(ee));var Ot=Le[ee]+ot,wt=Te?(Y[Ie]||[])[ee]:Y[Ot];if(!(!wt||wt.t=="z"))if(wt.t=="n")(wt.v|0)==wt.v&&wt.v>=-32768&&wt.v<=32767?Ge(X,13,m(Ie,ee,wt.v)):Ge(X,14,x(Ie,ee,wt.v));else{var Mt=oo(wt);Ge(X,15,p(Ie,ee,Mt.slice(0,239)))}}return Ge(X,1),X.end()}function i(Y,re){var ne=re||{};if(+ne.codepage>=0&&Zs(+ne.codepage),ne.type=="string")throw new Error("Cannot write WK3 to JS string");var X=Ji();Ge(X,0,a(Y));for(var _e=0,Te=0;_e<Y.SheetNames.length;++_e)(Y.Sheets[Y.SheetNames[_e]]||{})["!ref"]&&Ge(X,27,ie(Y.SheetNames[_e],Te++));var Le=0;for(_e=0;_e<Y.SheetNames.length;++_e){var Ne=Y.Sheets[Y.SheetNames[_e]];if(!(!Ne||!Ne["!ref"])){for(var Ie=ir(Ne["!ref"]),ot=Array.isArray(Ne),ee=[],Ot=Math.min(Ie.e.r,8191),wt=Ie.s.r;wt<=Ot;++wt)for(var Mt=gn(wt),St=Ie.s.c;St<=Ie.e.c;++St){wt===Ie.s.r&&(ee[St]=Qr(St));var Ke=ee[St]+Mt,wr=ot?(Ne[wt]||[])[St]:Ne[Ke];if(!(!wr||wr.t=="z"))if(wr.t=="n")Ge(X,23,N(wt,St,Le,wr.v));else{var rn=oo(wr);Ge(X,22,w(wt,St,Le,rn.slice(0,239)))}}++Le}}return Ge(X,1),X.end()}function s(Y){var re=Ee(2);return re.write_shift(2,Y),re}function a(Y){var re=Ee(26);re.write_shift(2,4096),re.write_shift(2,4),re.write_shift(4,0);for(var ne=0,X=0,_e=0,Te=0;Te<Y.SheetNames.length;++Te){var Le=Y.SheetNames[Te],Ne=Y.Sheets[Le];if(!(!Ne||!Ne["!ref"])){++_e;var Ie=Zi(Ne["!ref"]);ne<Ie.e.r&&(ne=Ie.e.r),X<Ie.e.c&&(X=Ie.e.c)}}return ne>8191&&(ne=8191),re.write_shift(2,ne),re.write_shift(1,_e),re.write_shift(1,X),re.write_shift(2,0),re.write_shift(2,0),re.write_shift(1,1),re.write_shift(1,2),re.write_shift(4,0),re.write_shift(4,0),re}function o(Y,re,ne){var X={s:{c:0,r:0},e:{c:0,r:0}};return re==8&&ne.qpro?(X.s.c=Y.read_shift(1),Y.l++,X.s.r=Y.read_shift(2),X.e.c=Y.read_shift(1),Y.l++,X.e.r=Y.read_shift(2),X):(X.s.c=Y.read_shift(2),X.s.r=Y.read_shift(2),re==12&&ne.qpro&&(Y.l+=2),X.e.c=Y.read_shift(2),X.e.r=Y.read_shift(2),re==12&&ne.qpro&&(Y.l+=2),X.s.c==65535&&(X.s.c=X.e.c=X.s.r=X.e.r=0),X)}function l(Y){var re=Ee(8);return re.write_shift(2,Y.s.c),re.write_shift(2,Y.s.r),re.write_shift(2,Y.e.c),re.write_shift(2,Y.e.r),re}function u(Y,re,ne){var X=[{c:0,r:0},{t:"n",v:0},0,0];return ne.qpro&&ne.vers!=20768?(X[0].c=Y.read_shift(1),X[3]=Y.read_shift(1),X[0].r=Y.read_shift(2),Y.l+=2):(X[2]=Y.read_shift(1),X[0].c=Y.read_shift(2),X[0].r=Y.read_shift(2)),X}function f(Y,re,ne){var X=Y.l+re,_e=u(Y,re,ne);if(_e[1].t="s",ne.vers==20768){Y.l++;var Te=Y.read_shift(1);return _e[1].v=Y.read_shift(Te,"utf8"),_e}return ne.qpro&&Y.l++,_e[1].v=Y.read_shift(X-Y.l,"cstr"),_e}function p(Y,re,ne){var X=Ee(7+ne.length);X.write_shift(1,255),X.write_shift(2,re),X.write_shift(2,Y),X.write_shift(1,39);for(var _e=0;_e<X.length;++_e){var Te=ne.charCodeAt(_e);X.write_shift(1,Te>=128?95:Te)}return X.write_shift(1,0),X}function g(Y,re,ne){var X=u(Y,re,ne);return X[1].v=Y.read_shift(2,"i"),X}function m(Y,re,ne){var X=Ee(7);return X.write_shift(1,255),X.write_shift(2,re),X.write_shift(2,Y),X.write_shift(2,ne,"i"),X}function y(Y,re,ne){var X=u(Y,re,ne);return X[1].v=Y.read_shift(8,"f"),X}function x(Y,re,ne){var X=Ee(13);return X.write_shift(1,255),X.write_shift(2,re),X.write_shift(2,Y),X.write_shift(8,ne,"f"),X}function S(Y,re,ne){var X=Y.l+re,_e=u(Y,re,ne);if(_e[1].v=Y.read_shift(8,"f"),ne.qpro)Y.l=X;else{var Te=Y.read_shift(2);O(Y.slice(Y.l,Y.l+Te),_e),Y.l+=Te}return _e}function A(Y,re,ne){var X=re&32768;return re&=-32769,re=(X?Y:0)+(re>=8192?re-16384:re),(X?"":"$")+(ne?Qr(re):gn(re))}var C={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},E=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function O(Y,re){ei(Y,0);for(var ne=[],X=0,_e="",Te="",Le="",Ne="";Y.l<Y.length;){var Ie=Y[Y.l++];switch(Ie){case 0:ne.push(Y.read_shift(8,"f"));break;case 1:Te=A(re[0].c,Y.read_shift(2),!0),_e=A(re[0].r,Y.read_shift(2),!1),ne.push(Te+_e);break;case 2:{var ot=A(re[0].c,Y.read_shift(2),!0),ee=A(re[0].r,Y.read_shift(2),!1);Te=A(re[0].c,Y.read_shift(2),!0),_e=A(re[0].r,Y.read_shift(2),!1),ne.push(ot+ee+":"+Te+_e)}break;case 3:if(Y.l<Y.length){console.error("WK1 premature formula end");return}break;case 4:ne.push("("+ne.pop()+")");break;case 5:ne.push(Y.read_shift(2));break;case 6:{for(var Ot="";Ie=Y[Y.l++];)Ot+=String.fromCharCode(Ie);ne.push('"'+Ot.replace(/"/g,'""')+'"')}break;case 8:ne.push("-"+ne.pop());break;case 23:ne.push("+"+ne.pop());break;case 22:ne.push("NOT("+ne.pop()+")");break;case 20:case 21:Ne=ne.pop(),Le=ne.pop(),ne.push(["AND","OR"][Ie-20]+"("+Le+","+Ne+")");break;default:if(Ie<32&&E[Ie])Ne=ne.pop(),Le=ne.pop(),ne.push(Le+E[Ie]+Ne);else if(C[Ie]){if(X=C[Ie][1],X==69&&(X=Y[Y.l++]),X>ne.length){console.error("WK1 bad formula parse 0x"+Ie.toString(16)+":|"+ne.join("|")+"|");return}var wt=ne.slice(-X);ne.length-=X,ne.push(C[Ie][0]+"("+wt.join(",")+")")}else return Ie<=7?console.error("WK1 invalid opcode "+Ie.toString(16)):Ie<=24?console.error("WK1 unsupported op "+Ie.toString(16)):Ie<=30?console.error("WK1 invalid opcode "+Ie.toString(16)):Ie<=115?console.error("WK1 unsupported function opcode "+Ie.toString(16)):console.error("WK1 unrecognized opcode "+Ie.toString(16))}}ne.length==1?re[1].f=""+ne[0]:console.error("WK1 bad formula parse |"+ne.join("|")+"|")}function Q(Y){var re=[{c:0,r:0},{t:"n",v:0},0];return re[0].r=Y.read_shift(2),re[3]=Y[Y.l++],re[0].c=Y[Y.l++],re}function H(Y,re){var ne=Q(Y);return ne[1].t="s",ne[1].v=Y.read_shift(re-4,"cstr"),ne}function w(Y,re,ne,X){var _e=Ee(6+X.length);_e.write_shift(2,Y),_e.write_shift(1,ne),_e.write_shift(1,re),_e.write_shift(1,39);for(var Te=0;Te<X.length;++Te){var Le=X.charCodeAt(Te);_e.write_shift(1,Le>=128?95:Le)}return _e.write_shift(1,0),_e}function F(Y,re){var ne=Q(Y);ne[1].v=Y.read_shift(2);var X=ne[1].v>>1;if(ne[1].v&1)switch(X&7){case 0:X=(X>>3)*5e3;break;case 1:X=(X>>3)*500;break;case 2:X=(X>>3)/20;break;case 3:X=(X>>3)/200;break;case 4:X=(X>>3)/2e3;break;case 5:X=(X>>3)/2e4;break;case 6:X=(X>>3)/16;break;case 7:X=(X>>3)/64;break}return ne[1].v=X,ne}function T(Y,re){var ne=Q(Y),X=Y.read_shift(4),_e=Y.read_shift(4),Te=Y.read_shift(2);if(Te==65535)return X===0&&_e===3221225472?(ne[1].t="e",ne[1].v=15):X===0&&_e===3489660928?(ne[1].t="e",ne[1].v=42):ne[1].v=0,ne;var Le=Te&32768;return Te=(Te&32767)-16446,ne[1].v=(1-Le*2)*(_e*Math.pow(2,Te+32)+X*Math.pow(2,Te)),ne}function N(Y,re,ne,X){var _e=Ee(14);if(_e.write_shift(2,Y),_e.write_shift(1,ne),_e.write_shift(1,re),X==0)return _e.write_shift(4,0),_e.write_shift(4,0),_e.write_shift(2,65535),_e;var Te=0,Le=0,Ne=0,Ie=0;return X<0&&(Te=1,X=-X),Le=Math.log2(X)|0,X/=Math.pow(2,Le-31),Ie=X>>>0,Ie&2147483648||(X/=2,++Le,Ie=X>>>0),X-=Ie,Ie|=2147483648,Ie>>>=0,X*=Math.pow(2,32),Ne=X>>>0,_e.write_shift(4,Ne),_e.write_shift(4,Ie),Le+=16383+(Te?32768:0),_e.write_shift(2,Le),_e}function D(Y,re){var ne=T(Y);return Y.l+=re-14,ne}function P(Y,re){var ne=Q(Y),X=Y.read_shift(4);return ne[1].v=X>>6,ne}function R(Y,re){var ne=Q(Y),X=Y.read_shift(8,"f");return ne[1].v=X,ne}function Xe(Y,re){var ne=R(Y);return Y.l+=re-10,ne}function Se(Y,re){return Y[Y.l+re-1]==0?Y.read_shift(re,"cstr"):""}function De(Y,re){var ne=Y[Y.l++];ne>re-1&&(ne=re-1);for(var X="";X.length<ne;)X+=String.fromCharCode(Y[Y.l++]);return X}function ke(Y,re,ne){if(!(!ne.qpro||re<21)){var X=Y.read_shift(1);Y.l+=17,Y.l+=1,Y.l+=2;var _e=Y.read_shift(re-21,"cstr");return[X,_e]}}function Ce(Y,re){for(var ne={},X=Y.l+re;Y.l<X;){var _e=Y.read_shift(2);if(_e==14e3){for(ne[_e]=[0,""],ne[_e][0]=Y.read_shift(2);Y[Y.l];)ne[_e][1]+=String.fromCharCode(Y[Y.l]),Y.l++;Y.l++}}return ne}function ie(Y,re){var ne=Ee(5+Y.length);ne.write_shift(2,14e3),ne.write_shift(2,re);for(var X=0;X<Y.length;++X){var _e=Y.charCodeAt(X);ne[ne.l++]=_e>127?95:_e}return ne[ne.l++]=0,ne}var be={0:{n:"BOF",f:Tn},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:g},14:{n:"NUMBER",f:y},15:{n:"LABEL",f},16:{n:"FORMULA",f:S},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Se},222:{n:"SHEETNAMELP",f:De},65535:{n:""}},Me={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:H},23:{n:"NUMBER17",f:T},24:{n:"NUMBER18",f:F},25:{n:"FORMULA19",f:D},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Ce},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:P},38:{n:"??"},39:{n:"NUMBER27",f:R},40:{n:"FORMULA28",f:Xe},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Se},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ke},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:e}}();function S6(t){var e={},r=t.match(Ti),n=0,i=!1;if(r)for(;n!=r.length;++n){var s=xt(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;e.cp=U1[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=s.val;break;case"<sz":e.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":s.rgb&&(e.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+s[0])}}return e}var w6=function(){var t=yf("t"),e=yf("rPr");function r(s){var a=s.match(t);if(!a)return{t:"s",v:""};var o={t:"s",v:nr(a[1])},l=s.match(e);return l&&(o.s=S6(l[1])),o}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(a){return a.replace(n,"").split(i).map(r).filter(function(o){return o.v})}}(),T6=function(){var e=/(\r\n|\n)/g;function r(i,s,a){var o=[];i.u&&o.push("text-decoration: underline;"),i.uval&&o.push("text-underline-style:"+i.uval+";"),i.sz&&o.push("font-size:"+i.sz+"pt;"),i.outline&&o.push("text-effect: outline;"),i.shadow&&o.push("text-shadow: auto;"),s.push('<span style="'+o.join("")+'">'),i.b&&(s.push("<b>"),a.push("</b>")),i.i&&(s.push("<i>"),a.push("</i>")),i.strike&&(s.push("<s>"),a.push("</s>"));var l=i.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(s.push("<"+l+">"),a.push("</"+l+">")),a.push("</span>"),i}function n(i){var s=[[],i.v,[]];return i.v?(i.s&&r(i.s,s[0],s[2]),s[0].join("")+s[1].replace(e,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),A6=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,C6=/<(?:\w+:)?r>/,k6=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function uv(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=nr(Tr(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Tr(t),r&&(n.h=q1(n.t))):t.match(C6)&&(n.r=Tr(t),n.t=nr(Tr((t.replace(k6,"").match(A6)||[]).join("").replace(Ti,""))),r&&(n.h=T6(w6(n.r)))),n):{t:""}}var F6=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,b6=/<(?:\w+:)?(?:si|sstItem)>/g,I6=/<\/(?:\w+:)?(?:si|sstItem)>/;function N6(t,e){var r=[],n="";if(!t)return r;var i=t.match(F6);if(i){n=i[2].replace(b6,"").split(I6);for(var s=0;s!=n.length;++s){var a=uv(n[s].trim(),e);a!=null&&(r[r.length]=a)}i=xt(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}var R6=/^\s|\s$|[\t\n\r]/;function GA(t,e){if(!e.bookSST)return"";var r=[mn];r[r.length]=$e("sst",null,{xmlns:fc[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var i=t[n],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(R6)&&(s+=' xml:space="preserve"'),s+=">"+_r(i.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function D6(t){return[t.read_shift(4),t.read_shift(4)]}function P6(t,e){var r=[],n=!1;return mo(t,function(s,a,o){switch(o){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(a.T,!n||e.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function O6(t,e){return e||(e=Ee(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var M6=GR;function B6(t){var e=Ji();Fe(e,159,O6(t));for(var r=0;r<t.length;++r)Fe(e,19,M6(t[r]));return Fe(e,160),e.end()}function KA(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function to(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function j6(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=to(t,4),e.U=to(t,4),e.W=to(t,4),e}function L6(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},i=t.read_shift(4),s=[];i-- >0;)s.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=s,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function U6(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(L6(t));return e}function V6(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function z6(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=to(t,4),e.U=to(t,4),e.W=to(t,4),e}function W6(t){var e=z6(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function YA(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function XA(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function H6(t){var e=to(t);switch(e.Minor){case 2:return[e.Minor,$6(t)];case 3:return[e.Minor,G6()];case 4:return[e.Minor,K6(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function $6(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=YA(t,r),i=XA(t,t.length-t.l);return{t:"Std",h:n,v:i}}function G6(){throw new Error("File is password-protected: ECMA-376 Extensible")}function K6(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(Ti,function(s){var a=xt(s);switch(Ma(a[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(o){n[o]=a[o]});break;case"<dataIntegrity":n.encryptedHmacKey=a.encryptedHmacKey,n.encryptedHmacValue=a.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=a.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(a);break;default:throw a[0]}}),n}function Y6(t,e){var r={},n=r.EncryptionVersionInfo=to(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var i=t.read_shift(4);return e-=4,r.EncryptionHeader=YA(t,i),e-=i,r.EncryptionVerifier=XA(t,e),r}function X6(t){var e={},r=e.EncryptionVersionInfo=to(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function dv(t){var e=0,r,n=KA(t),i=n.length+1,s,a,o,l,u;for(r=fl(i),r[0]=n.length,s=1;s!=i;++s)r[s]=n[s-1];for(s=i-1;s>=0;--s)a=r[s],o=e&16384?1:0,l=e<<1&32767,u=o|l,e=u^a;return e^52811}var qA=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(a){return(a/2|a*128)&255},i=function(a,o){return n(a^o)},s=function(a){for(var o=e[a.length-1],l=104,u=a.length-1;u>=0;--u)for(var f=a[u],p=0;p!=7;++p)f&64&&(o^=r[l]),f*=2,--l;return o};return function(a){for(var o=KA(a),l=s(o),u=o.length,f=fl(16),p=0;p!=16;++p)f[p]=0;var g,m,y;for((u&1)===1&&(g=l>>8,f[u]=i(t[0],g),--u,g=l&255,m=o[o.length-1],f[u]=i(m,g));u>0;)--u,g=l>>8,f[u]=i(o[u],g),--u,g=l&255,f[u]=i(o[u],g);for(u=15,y=15-o.length;y>0;)g=l>>8,f[u]=i(t[y],g),--u,--y,g=l&255,f[u]=i(o[u],g),--u,--y;return f}}(),q6=function(t,e,r,n,i){i||(i=e),n||(n=qA(t));var s,a;for(s=0;s!=e.length;++s)a=e[s],a^=n[r],a=(a>>5|a<<3)&255,i[s]=a,++r;return[i,r,n]},Q6=function(t){var e=0,r=qA(t);return function(n){var i=q6("",n,e,r);return e=i[1],i[0]}};function J6(t,e,r,n){var i={key:Tn(t),verificationBytes:Tn(t)};return r.password&&(i.verifier=dv(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=Q6(r.password)),i}function Z6(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=X6(t):n.Data=Y6(t,e),n}function eP(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?Z6(t,e-2,n):J6(t,r.biff>=8?e:e-2,r,n),n}var QA=function(){function t(i,s){switch(s.type){case"base64":return e(ms(i),s);case"binary":return e(i,s);case"buffer":return e(Lt&&Buffer.isBuffer(i)?i.toString("binary"):Sl(i),s);case"array":return e(ec(i),s)}throw new Error("Unrecognized type "+s.type)}function e(i,s){var a=s||{},o=a.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(f,p){Array.isArray(o)&&(o[p]=[]);for(var g=/\\\w+\b/g,m=0,y,x=-1;y=g.exec(f);){switch(y[0]){case"\\cell":var S=f.slice(m,g.lastIndex-y[0].length);if(S[0]==" "&&(S=S.slice(1)),++x,S.length){var A={v:S,t:"s"};Array.isArray(o)?o[p][x]=A:o[gt({r:p,c:x})]=A}break}m=g.lastIndex}x>u.e.c&&(u.e.c=x)}),o["!ref"]=Nt(u),o}function r(i,s){return wl(t(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],a=ir(i["!ref"]),o,l=Array.isArray(i),u=a.s.r;u<=a.e.r;++u){s.push("\\trowd\\trautofit1");for(var f=a.s.c;f<=a.e.c;++f)s.push("\\cellx"+(f+1));for(s.push("\\pard\\intbl"),f=a.s.c;f<=a.e.c;++f){var p=gt({r:u,c:f});o=l?(i[u]||[])[f]:i[p],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(oo(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function tP(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function wf(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function rP(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,i=Math.max(e,r,n),s=Math.min(e,r,n),a=i-s;if(a===0)return[0,0,e];var o=0,l=0,u=i+s;switch(l=a/(u>1?2-u:u),i){case e:o=((r-n)/a+6)%6;break;case r:o=(n-e)/a+2;break;case n:o=(e-r)/a+4;break}return[o/6,l,u/2]}function nP(t){var e=t[0],r=t[1],n=t[2],i=r*2*(n<.5?n:1-n),s=n-i/2,a=[s,s,s],o=6*e,l;if(r!==0)switch(o|0){case 0:case 6:l=i*o,a[0]+=i,a[1]+=l;break;case 1:l=i*(2-o),a[0]+=l,a[1]+=i;break;case 2:l=i*(o-2),a[1]+=i,a[2]+=l;break;case 3:l=i*(4-o),a[1]+=l,a[2]+=i;break;case 4:l=i*(o-4),a[2]+=i,a[0]+=l;break;case 5:l=i*(6-o),a[2]+=l,a[0]+=i;break}for(var u=0;u!=3;++u)a[u]=Math.round(a[u]*255);return a}function ap(t,e){if(e===0)return t;var r=rP(tP(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),wf(nP(r))}var JA=6,iP=15,sP=1,xi=JA;function Tf(t){return Math.floor((t+Math.round(128/xi)/256)*xi)}function Af(t){return Math.floor((t-5)/xi*100+.5)/100}function op(t){return Math.round((t*xi+5)/xi*256)/256}function Kg(t){return op(Af(Tf(t)))}function fv(t){var e=Math.abs(t-Kg(t)),r=xi;if(e>.005)for(xi=sP;xi<iP;++xi)Math.abs(t-Kg(t))<=e&&(e=Math.abs(t-Kg(t)),r=xi);xi=r}function hl(t){t.width?(t.wpx=Tf(t.width),t.wch=Af(t.wpx),t.MDW=xi):t.wpx?(t.wch=Af(t.wpx),t.width=op(t.wch),t.MDW=xi):typeof t.wch=="number"&&(t.width=op(t.wch),t.wpx=Tf(t.width),t.MDW=xi),t.customWidth&&delete t.customWidth}var aP=96,ZA=aP;function Cf(t){return t*96/ZA}function Su(t){return t*ZA/96}var oP={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function lP(t,e,r,n){e.Borders=[];var i={},s=!1;(t[0].match(Ti)||[]).forEach(function(a){var o=xt(a);switch(Ma(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},o.diagonalUp&&(i.diagonalUp=Or(o.diagonalUp)),o.diagonalDown&&(i.diagonalDown=Or(o.diagonalDown)),e.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in borders")}})}function cP(t,e,r,n){e.Fills=[];var i={},s=!1;(t[0].match(Ti)||[]).forEach(function(a){var o=xt(a);switch(Ma(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},e.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":o.patternType&&(i.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),o.indexed&&(i.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(i.bgColor.theme=parseInt(o.theme,10)),o.tint&&(i.bgColor.tint=parseFloat(o.tint)),o.rgb&&(i.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),o.theme&&(i.fgColor.theme=parseInt(o.theme,10)),o.tint&&(i.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(i.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fills")}})}function uP(t,e,r,n){e.Fonts=[];var i={},s=!1;(t[0].match(Ti)||[]).forEach(function(a){var o=xt(a);switch(Ma(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(i),i={};break;case"<name":o.val&&(i.name=Tr(o.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=o.val?Or(o.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=o.val?Or(o.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(o.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=o.val?Or(o.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=o.val?Or(o.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=o.val?Or(o.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=o.val?Or(o.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=o.val?Or(o.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":o.val&&(i.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(i.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(i.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(i.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=U1[parseInt(o.val,10)];break;case"<color":if(i.color||(i.color={}),o.auto&&(i.color.auto=Or(o.auto)),o.rgb)i.color.rgb=o.rgb.slice(-6);else if(o.indexed){i.color.index=parseInt(o.indexed,10);var l=zl[i.color.index];i.color.index==81&&(l=zl[1]),l||(l=zl[1]),i.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(i.color.theme=parseInt(o.theme,10),o.tint&&(i.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=ap(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fonts")}})}function dP(t,e,r){e.NumberFmt=[];for(var n=cn(pt),i=0;i<n.length;++i)e.NumberFmt[n[i]]=pt[n[i]];var s=t[0].match(Ti);if(s)for(i=0;i<s.length;++i){var a=xt(s[i]);switch(Ma(a[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=nr(Tr(a.formatCode)),l=parseInt(a.numFmtId,10);if(e.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&e.NumberFmt[l]!=null;--l);e.NumberFmt[l]=o}eo(o,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+a[0]+" in numFmts")}}}function fP(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)t[n]!=null&&(e[e.length]=$e("numFmt",null,{numFmtId:n,formatCode:_r(t[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=$e("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var W0=["numFmtId","fillId","fontId","borderId","xfId"],H0=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function hP(t,e,r){e.CellXf=[];var n,i=!1;(t[0].match(Ti)||[]).forEach(function(s){var a=xt(s),o=0;switch(Ma(a[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=a,delete n[0],o=0;o<W0.length;++o)n[W0[o]]&&(n[W0[o]]=parseInt(n[W0[o]],10));for(o=0;o<H0.length;++o)n[H0[o]]&&(n[H0[o]]=Or(n[H0[o]]));if(e.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[o]){n.numFmtId=o;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};a.vertical&&(l.vertical=a.vertical),a.horizontal&&(l.horizontal=a.horizontal),a.textRotation!=null&&(l.textRotation=a.textRotation),a.indent&&(l.indent=a.indent),a.wrapText&&(l.wrapText=Or(a.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+a[0]+" in cellXfs")}})}function pP(t){var e=[];return e[e.length]=$e("cellXfs",null),t.forEach(function(r){e[e.length]=$e("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=$e("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var gP=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,u){var f={};if(!o)return f;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var p;return(p=o.match(e))&&dP(p,f,u),(p=o.match(i))&&uP(p,f,l,u),(p=o.match(n))&&cP(p,f,l,u),(p=o.match(s))&&lP(p,f,l,u),(p=o.match(r))&&hP(p,f,u),f}}();function eC(t,e){var r=[mn,$e("styleSheet",null,{xmlns:fc[0],"xmlns:vt":Rn.vt})],n;return t.SSF&&(n=fP(t.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=pP(e.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function mP(t,e){var r=t.read_shift(2),n=_i(t);return[r,n]}function xP(t,e,r){r||(r=Ee(6+4*e.length)),r.write_shift(2,t),$n(e,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function vP(t,e,r){var n={};n.sz=t.read_shift(2)/20;var i=ZR(t);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=t.read_shift(2);switch(s===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=t.read_shift(1);a!=0&&(n.underline=a);var o=t.read_shift(1);o>0&&(n.family=o);var l=t.read_shift(1);switch(l>0&&(n.charset=l),t.l++,n.color=JR(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=_i(t),n}function yP(t,e){e||(e=Ee(25+4*32)),e.write_shift(2,t.sz*20),eD(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),np(t.color,e);var n=0;return n=2,e.write_shift(1,n),$n(t.name,e),e.length>e.l?e.slice(0,e.l):e}var _P=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Yg,EP=Si;function D_(t,e){e||(e=Ee(4*3+8*7+16*1)),Yg||(Yg=Hp(_P));var r=Yg[t.patternType];r==null&&(r=40),e.write_shift(4,r);var n=0;if(r!=40)for(np({auto:1},e),np({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function SP(t,e){var r=t.l+e,n=t.read_shift(2),i=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:i}}function tC(t,e,r){r||(r=Ee(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function hd(t,e){return e||(e=Ee(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var wP=Si;function TP(t,e){return e||(e=Ee(51)),e.write_shift(1,0),hd(null,e),hd(null,e),hd(null,e),hd(null,e),hd(null,e),e.length>e.l?e.slice(0,e.l):e}function AP(t,e){return e||(e=Ee(12+4*10)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),rp(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function CP(t,e,r){var n=Ee(2052);return n.write_shift(4,t),rp(e,n),rp(r,n),n.length>n.l?n.slice(0,n.l):n}function kP(t,e,r){var n={};n.NumberFmt=[];for(var i in pt)n.NumberFmt[i]=pt[i];n.CellXf=[],n.Fonts=[];var s=[],a=!1;return mo(t,function(l,u,f){switch(f){case 44:n.NumberFmt[l[0]]=l[1],eo(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(l.color.rgb=ap(e.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:s.push(f),a=!0;break;case 38:s.pop(),a=!1;break;default:if(u.T>0)s.push(f);else if(u.T<0)s.pop();else if(!a||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+f.toString(16))}}),n}function FP(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&++r}),r!=0&&(Fe(t,615,sa(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&Fe(t,44,xP(i,e[i]))}),Fe(t,616))}}function bP(t){var e=1;Fe(t,611,sa(e)),Fe(t,43,yP({sz:12,color:{theme:1},name:"Calibri",family:2})),Fe(t,612)}function IP(t){var e=2;Fe(t,603,sa(e)),Fe(t,45,D_({patternType:"none"})),Fe(t,45,D_({patternType:"gray125"})),Fe(t,604)}function NP(t){var e=1;Fe(t,613,sa(e)),Fe(t,46,TP()),Fe(t,614)}function RP(t){var e=1;Fe(t,626,sa(e)),Fe(t,47,tC({numFmtId:0},65535)),Fe(t,627)}function DP(t,e){Fe(t,617,sa(e.length)),e.forEach(function(r){Fe(t,47,tC(r,0))}),Fe(t,618)}function PP(t){var e=1;Fe(t,619,sa(e)),Fe(t,48,AP({xfId:0,name:"Normal"})),Fe(t,620)}function OP(t){var e=0;Fe(t,505,sa(e)),Fe(t,506)}function MP(t){var e=0;Fe(t,508,CP(e,"TableStyleMedium9","PivotStyleMedium4")),Fe(t,509)}function BP(t,e){var r=Ji();return Fe(r,278),FP(r,t.SSF),bP(r),IP(r),NP(r),RP(r),DP(r,e.cellXfs),PP(r),OP(r),MP(r),Fe(r,279),r.end()}var jP=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function LP(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(Ti)||[]).forEach(function(i){var s=xt(i);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(e.themeElements.clrScheme[jP.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function UP(){}function VP(){}var zP=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,WP=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,HP=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function $P(t,e,r){e.themeElements={};var n;[["clrScheme",zP,LP],["fontScheme",WP,UP],["fmtScheme",HP,VP]].forEach(function(i){if(!(n=t.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,e,r)})}var GP=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function rC(t,e){(!t||t.length===0)&&(t=hv());var r,n={};if(!(r=t.match(GP)))throw new Error("themeElements not found in theme");return $P(r[0],n,e),n.raw=t,n}function hv(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[mn];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function KP(t,e,r){var n=t.l+e,i=t.read_shift(4);if(i!==124226){if(!r.cellStyles){t.l=n;return}var s=t.slice(t.l);t.l=n;var a;try{a=YT(s,{type:"array"})}catch{return}var o=ds(a,"theme/theme/theme1.xml",!0);if(o)return rC(o,r)}}function YP(t){return t.read_shift(4)}function XP(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=qP(t,4);break;case 2:e.xclrValue=OA(t);break;case 3:e.xclrValue=YP(t);break;case 4:t.l+=4;break}return t.l+=8,e}function qP(t,e){return Si(t,e)}function QP(t,e){return Si(t,e)}function JP(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=XP(t);break;case 6:n[1]=QP(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function ZP(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var i=t.read_shift(2),s=[];i-- >0;)s.push(JP(t,r-t.l));return{ixfe:n,ext:s}}function e8(t,e){e.forEach(function(r){switch(r[0]){}})}function t8(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:_i(t)}}function r8(t){var e=Ee(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),$n(t.name,e),e.slice(0,e.l)}function n8(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function i8(t){var e=Ee(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function s8(t,e){var r=Ee(8+2*e.length);return r.write_shift(4,t),$n(e,r),r.slice(0,r.l)}function a8(t){return t.l+=4,t.read_shift(4)!=0}function o8(t,e){var r=Ee(8);return r.write_shift(4,t),r.write_shift(4,1),r}function l8(t,e,r){var n={Types:[],Cell:[],Value:[]},i=r||{},s=[],a=!1,o=2;return mo(t,function(l,u,f){switch(f){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(p){o==1?n.Cell.push({type:n.Types[p[0]-1].name,index:p[1]}):o==0&&n.Value.push({type:n.Types[p[0]-1].name,index:p[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:s.push(f),a=!0;break;case 36:s.pop(),a=!1;break;default:if(!u.T){if(!a||i.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}}),n}function c8(){var t=Ji();return Fe(t,332),Fe(t,334,sa(1)),Fe(t,335,r8({name:"XLDAPR",version:12e4,flags:3496657072})),Fe(t,336),Fe(t,339,s8(1,"XLDAPR")),Fe(t,52),Fe(t,35,sa(514)),Fe(t,4096,sa(0)),Fe(t,4097,Is(1)),Fe(t,36),Fe(t,53),Fe(t,340),Fe(t,337,o8(1)),Fe(t,51,i8([[1,0]])),Fe(t,338),Fe(t,333),t.end()}function u8(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var i=!1,s=2,a;return t.replace(Ti,function(o){var l=xt(o);switch(Ma(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<n.Types.length;++u)n.Types[u].name==l.name&&(a=n.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):s==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!a)break;a.offsets||(a.offsets=[]),a.offsets.push(+l.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function nC(){var t=[mn];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function d8(t){var e=[];if(!t)return e;var r=1;return(t.match(Ti)||[]).forEach(function(n){var i=xt(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,e.push(i);break}}),e}function f8(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=gt(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function h8(t,e,r){var n=[];return mo(t,function(s,a,o){switch(o){case 63:n.push(s);break;default:if(!a.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function p8(t,e,r,n){if(!t)return t;var i=n||{},s=!1;mo(t,function(o,l,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!l.T){if(!s||i.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},i)}function g8(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}var Qc=1024;function iC(t,e){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[$e("xml",null,{"xmlns:v":ls.v,"xmlns:o":ls.o,"xmlns:x":ls.x,"xmlns:mv":ls.mv}).replace(/\/>/,">"),$e("o:shapelayout",$e("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),$e("v:shapetype",[$e("v:stroke",null,{joinstyle:"miter"}),$e("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Qc<t*1e3;)Qc+=1e3;return e.forEach(function(s){var a=Jr(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?$e("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=$e("v:fill",l,o),f={on:"t",obscured:"t"};++Qc,i=i.concat(["<v:shape"+_f({id:"_x0000_s"+Qc,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,$e("v:shadow",null,f),$e("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",ti("x:Anchor",[a.c+1,0,a.r+1,0,a.c+3,20,a.r+5,20].join(",")),ti("x:AutoFill","False"),ti("x:Row",String(a.r)),ti("x:Column",String(a.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function P_(t,e,r,n){var i=Array.isArray(t),s;e.forEach(function(a){var o=Jr(a.ref);if(i?(t[o.r]||(t[o.r]=[]),s=t[o.r][o.c]):s=t[a.ref],!s){s={t:"z"},i?t[o.r][o.c]=s:t[a.ref]=s;var l=ir(t["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var u=Nt(l);u!==t["!ref"]&&(t["!ref"]=u)}s.c||(s.c=[]);var f={a:a.author,t:a.t,r:a.r,T:r};a.h&&(f.h=a.h);for(var p=s.c.length-1;p>=0;--p){if(!r&&s.c[p].T)return;r&&!s.c[p].T&&s.c.splice(p,1)}if(r&&n){for(p=0;p<n.length;++p)if(f.a==n[p].id){f.a=n[p].name||f.a;break}}s.c.push(f)})}function m8(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var s=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=xt(o[0]),u={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},f=Jr(l.ref);if(!(e.sheetRows&&e.sheetRows<=f.r)){var p=a.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),g=!!p&&!!p[1]&&uv(p[1])||{r:"",t:"",h:""};u.r=g.r,g.r=="<t></t>"&&(g.t=g.h=""),u.t=(g.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(u.h=g.h),n.push(u)}}}}),n}function sC(t){var e=[mn,$e("comments",null,{xmlns:fc[0]})],r=[];return e.push("<authors>"),t.forEach(function(n){n[1].forEach(function(i){var s=_r(i.a);r.indexOf(s)==-1&&(r.push(s),e.push("<author>"+s+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),e.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(n){var i=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(l){l.a&&(i=r.indexOf(_r(l.a))),s.push(l.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),s.length<=1)e.push(ti("t",_r(s[0]||"")));else{for(var a=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)a+=`Reply:
    `+s[o]+`
`;e.push(ti("t",_r(a)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function x8(t,e){var r=[],n=!1,i={},s=0;return t.replace(Ti,function(o,l){var u=xt(o);switch(Ma(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":s=l+o.length;break;case"</text>":i.t=t.slice(s,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return o}),r}function v8(t,e,r){var n=[mn,$e("ThreadedComments",null,{xmlns:Rn.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(i){var s="";(i[1]||[]).forEach(function(a,o){if(!a.T){delete a.ID;return}a.a&&e.indexOf(a.a)==-1&&e.push(a.a);var l={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?s=l.id:l.parentId=s,a.ID=l.id,a.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(a.a)).slice(-12)+"}"),n.push($e("threadedComment",ti("text",a.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function y8(t,e){var r=[],n=!1;return t.replace(Ti,function(s){var a=xt(s);switch(Ma(a[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:a.displayname,id:a.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+a[0]+" in threaded comments")}return s}),r}function _8(t){var e=[mn,$e("personList",null,{xmlns:Rn.TCMNT,"xmlns:x":fc[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,n){e.push($e("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function E8(t){var e={};e.iauthor=t.read_shift(4);var r=mc(t);return e.rfx=r.s,e.ref=gt(r.s),t.l+=16,e}function S8(t,e){return e==null&&(e=Ee(36)),e.write_shift(4,t[1].iauthor),ju(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var w8=_i;function T8(t){return $n(t.slice(0,54))}function A8(t,e){var r=[],n=[],i={},s=!1;return mo(t,function(o,l,u){switch(u){case 632:n.push(o);break;case 635:i=o;break;case 637:i.t=o.t,i.h=o.h,i.r=o.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,e.sheetRows&&i.rfx&&e.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!s||e.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}function C8(t){var e=Ji(),r=[];return Fe(e,628),Fe(e,630),t.forEach(function(n){n[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),Fe(e,632,T8(i.a)))})}),Fe(e,631),Fe(e,633),t.forEach(function(n){n[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var s={s:Jr(n[0]),e:Jr(n[0])};Fe(e,635,S8([s,i])),i.t&&i.t.length>0&&Fe(e,637,YR(i)),Fe(e,636),delete i.iauthor})}),Fe(e,634),Fe(e,629),e.end()}var k8="application/vnd.ms-office.vbaProject";function F8(t){var e=ct.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");ct.utils.cfb_add(e,i,t.FileIndex[n].content)}}),ct.write(e)}function b8(t,e){e.FullPaths.forEach(function(r,n){if(n!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&ct.utils.cfb_add(t,i,e.FileIndex[n].content)}})}var aC=["xlsb","xlsm","xlam","biff8","xla"];function I8(){return{"!type":"dialog"}}function N8(){return{"!type":"dialog"}}function R8(){return{"!type":"macro"}}function D8(){return{"!type":"macro"}}var ou=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,i,s,a){var o=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var u=s.length>0?parseInt(s,10)|0:0,f=a.length>0?parseInt(a,10)|0:0;return o?f+=e.c:--f,l?u+=e.r:--u,i+(o?"":"$")+Qr(f)+(l?"":"$")+gn(u)}return function(i,s){return e=s,i.replace(t,r)}}(),pv=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,gv=function(){return function(e,r){return e.replace(pv,function(n,i,s,a,o,l){var u=tv(a)-(s?0:r.c),f=ev(l)-(o?0:r.r),p=f==0?"":o?f+1:"["+f+"]",g=u==0?"":s?u+1:"["+u+"]";return i+"R"+p+"C"+g})}}();function oC(t,e){return t.replace(pv,function(r,n,i,s,a,o){return n+(i=="$"?i+s:Qr(tv(s)+e.c))+(a=="$"?a+o:gn(ev(o)+e.r))})}function P8(t,e,r){var n=Zi(e),i=n.s,s=Jr(r),a={r:s.r-i.r,c:s.c-i.c};return oC(t,a)}function O8(t){return t.length!=1}function O_(t){return t.replace(/_xlfn\./g,"")}function _n(t){t.l+=1}function pl(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function lC(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return cC(t);r.biff==12&&(n=4)}var i=t.read_shift(n),s=t.read_shift(n),a=pl(t),o=pl(t);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function cC(t){var e=pl(t),r=pl(t),n=t.read_shift(1),i=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function M8(t,e,r){if(r.biff<8)return cC(t);var n=t.read_shift(r.biff==12?4:2),i=t.read_shift(r.biff==12?4:2),s=pl(t),a=pl(t);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}function uC(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return B8(t);var n=t.read_shift(r&&r.biff==12?4:2),i=pl(t);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function B8(t){var e=pl(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function j8(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function L8(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return U8(t);var i=t.read_shift(n>=12?4:2),s=t.read_shift(2),a=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;i>524287;)i-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:a,rRel:o}}function U8(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),i==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:i,rRel:n}}function V8(t,e,r){var n=(t[t.l++]&96)>>5,i=lC(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function z8(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}var a=lC(t,s,r);return[n,i,a]}function W8(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function H8(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}return t.l+=s,[n,i]}function $8(t,e,r){var n=(t[t.l++]&96)>>5,i=M8(t,e-1,r);return[n,i]}function G8(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function M_(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function K8(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(t.read_shift(r&&r.biff==2?1:2));return i}function Y8(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function X8(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function q8(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function Q8(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function dC(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function J8(t){return t.read_shift(2),dC(t)}function Z8(t){return t.read_shift(2),dC(t)}function e5(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=uC(t,0,r);return[n,i]}function t5(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=L8(t,0,r);return[n,i]}function r5(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var s=uC(t,0,r);return[n,i,s]}function n5(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(r&&r.biff<=3?1:2);return[aO[i],pC[i],n]}function i5(t,e,r){var n=t[t.l++],i=t.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:s5(t);return[i,(s[0]===0?pC:sO)[s[1]]]}function s5(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function a5(t,e,r){t.l+=r&&r.biff==2?3:4}function o5(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function l5(t){return t.l++,xo[t.read_shift(1)]}function c5(t){return t.l++,t.read_shift(2)}function u5(t){return t.l++,t.read_shift(1)!==0}function d5(t){return t.l++,yi(t)}function f5(t,e,r){return t.l++,Kf(t,e-1,r)}function h5(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=fn(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=xo[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=yi(t);break;case 2:r[1]=xc(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function p5(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((r.biff==12?mc:Kp)(t));return i}function g5(t,e,r){var n=0,i=0;r.biff==12?(n=t.read_shift(4),i=t.read_shift(4)):(i=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var s=0,a=[];s!=n&&(a[s]=[]);++s)for(var o=0;o!=i;++o)a[s][o]=h5(t,r.biff);return a}function m5(t,e,r){var n=t.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,s=t.read_shift(i);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,s]}function x5(t,e,r){if(r.biff==5)return v5(t);var n=t.read_shift(1)>>>5&3,i=t.read_shift(2),s=t.read_shift(4);return[n,i,s]}function v5(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function y5(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function _5(t,e,r){var n=t.read_shift(1)>>>5&3,i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function E5(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function S5(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return t.l+=s,[n,i]}var w5=Si,T5=Si,A5=Si;function Xf(t,e,r){return t.l+=2,[j8(t)]}function mv(t){return t.l+=6,[]}var C5=Xf,k5=mv,F5=mv,b5=Xf;function fC(t){return t.l+=2,[Tn(t),t.read_shift(2)&1]}var I5=Xf,N5=fC,R5=mv,D5=Xf,P5=Xf,O5=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function M5(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i=t.read_shift(2),s=t.read_shift(2),a=O5[r>>2&31];return{ixti:e,coltype:r&3,rt:a,idx:n,c:i,C:s}}function B5(t){return t.l+=2,[t.read_shift(4)]}function j5(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function L5(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function U5(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function V5(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function z5(t){return t.l+=4,[0,0]}var B_={1:{n:"PtgExp",f:o5},2:{n:"PtgTbl",f:A5},3:{n:"PtgAdd",f:_n},4:{n:"PtgSub",f:_n},5:{n:"PtgMul",f:_n},6:{n:"PtgDiv",f:_n},7:{n:"PtgPower",f:_n},8:{n:"PtgConcat",f:_n},9:{n:"PtgLt",f:_n},10:{n:"PtgLe",f:_n},11:{n:"PtgEq",f:_n},12:{n:"PtgGe",f:_n},13:{n:"PtgGt",f:_n},14:{n:"PtgNe",f:_n},15:{n:"PtgIsect",f:_n},16:{n:"PtgUnion",f:_n},17:{n:"PtgRange",f:_n},18:{n:"PtgUplus",f:_n},19:{n:"PtgUminus",f:_n},20:{n:"PtgPercent",f:_n},21:{n:"PtgParen",f:_n},22:{n:"PtgMissArg",f:_n},23:{n:"PtgStr",f:f5},26:{n:"PtgSheet",f:j5},27:{n:"PtgEndSheet",f:L5},28:{n:"PtgErr",f:l5},29:{n:"PtgBool",f:u5},30:{n:"PtgInt",f:c5},31:{n:"PtgNum",f:d5},32:{n:"PtgArray",f:G8},33:{n:"PtgFunc",f:n5},34:{n:"PtgFuncVar",f:i5},35:{n:"PtgName",f:m5},36:{n:"PtgRef",f:e5},37:{n:"PtgArea",f:V8},38:{n:"PtgMemArea",f:y5},39:{n:"PtgMemErr",f:w5},40:{n:"PtgMemNoMem",f:T5},41:{n:"PtgMemFunc",f:_5},42:{n:"PtgRefErr",f:E5},43:{n:"PtgAreaErr",f:W8},44:{n:"PtgRefN",f:t5},45:{n:"PtgAreaN",f:$8},46:{n:"PtgMemAreaN",f:U5},47:{n:"PtgMemNoMemN",f:V5},57:{n:"PtgNameX",f:x5},58:{n:"PtgRef3d",f:r5},59:{n:"PtgArea3d",f:z8},60:{n:"PtgRefErr3d",f:S5},61:{n:"PtgAreaErr3d",f:H8},255:{}},W5={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},H5={1:{n:"PtgElfLel",f:fC},2:{n:"PtgElfRw",f:D5},3:{n:"PtgElfCol",f:C5},6:{n:"PtgElfRwV",f:P5},7:{n:"PtgElfColV",f:b5},10:{n:"PtgElfRadical",f:I5},11:{n:"PtgElfRadicalS",f:R5},13:{n:"PtgElfColS",f:k5},15:{n:"PtgElfColSV",f:F5},16:{n:"PtgElfRadicalLel",f:N5},25:{n:"PtgList",f:M5},29:{n:"PtgSxName",f:B5},255:{}},$5={0:{n:"PtgAttrNoop",f:z5},1:{n:"PtgAttrSemi",f:Q8},2:{n:"PtgAttrIf",f:X8},4:{n:"PtgAttrChoose",f:K8},8:{n:"PtgAttrGoto",f:Y8},16:{n:"PtgAttrSum",f:a5},32:{n:"PtgAttrBaxcel",f:M_},33:{n:"PtgAttrBaxcel",f:M_},64:{n:"PtgAttrSpace",f:J8},65:{n:"PtgAttrSpaceSemi",f:Z8},128:{n:"PtgAttrIfError",f:q8},255:{}};function qf(t,e,r,n){if(n.biff<8)return Si(t,e);for(var i=t.l+e,s=[],a=0;a!==r.length;++a)switch(r[a][0]){case"PtgArray":r[a][1]=g5(t,0,n),s.push(r[a][1]);break;case"PtgMemArea":r[a][2]=p5(t,r[a][1],n),s.push(r[a][2]);break;case"PtgExp":n&&n.biff==12&&(r[a][1][1]=t.read_shift(4),s.push(r[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[a][0]}return e=i-t.l,e!==0&&s.push(Si(t,e)),s}function Qf(t,e,r){for(var n=t.l+e,i,s,a=[];n!=t.l;)e=n-t.l,s=t[t.l],i=B_[s]||B_[W5[s]],(s===24||s===25)&&(i=(s===24?H5:$5)[t[t.l+1]]),!i||!i.f?Si(t,e):a.push([i.n,i.f(t,e,r)]);return a}function G5(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],i=[],s=0;s<n.length;++s){var a=n[s];if(a)switch(a[0]){case 2:i.push('"'+a[1].replace(/"/g,'""')+'"');break;default:i.push(a[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var K5={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Y5(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function hC(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(t[n[0]][0]){case 357:return i=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return t[n[0]][0][3]?(i=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function j_(t,e,r){var n=hC(t,e,r);return n=="#REF"?n:Y5(n,r)}function gi(t,e,r,n,i){var s=i&&i.biff||8,a={s:{c:0,r:0}},o=[],l,u,f,p=0,g=0,m,y="";if(!t[0]||!t[0][0])return"";for(var x=-1,S="",A=0,C=t[0].length;A<C;++A){var E=t[0][A];switch(E[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),u=o.pop(),x>=0){switch(t[0][x][1][0]){case 0:S=an(" ",t[0][x][1][1]);break;case 1:S=an("\r",t[0][x][1][1]);break;default:if(S="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][x][1][0])}u=u+S,x=-1}o.push(u+K5[E[0]]+l);break;case"PtgIsect":l=o.pop(),u=o.pop(),o.push(u+" "+l);break;case"PtgUnion":l=o.pop(),u=o.pop(),o.push(u+","+l);break;case"PtgRange":l=o.pop(),u=o.pop(),o.push(u+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=Ud(E[1][1],a,i),o.push(Vd(f,s));break;case"PtgRefN":f=r?Ud(E[1][1],r,i):E[1][1],o.push(Vd(f,s));break;case"PtgRef3d":p=E[1][1],f=Ud(E[1][2],a,i),y=j_(n,p,i),o.push(y+"!"+Vd(f,s));break;case"PtgFunc":case"PtgFuncVar":var O=E[1][0],Q=E[1][1];O||(O=0),O&=127;var H=O==0?[]:o.slice(-O);o.length-=O,Q==="User"&&(Q=H.shift()),o.push(Q+"("+H.join(",")+")");break;case"PtgBool":o.push(E[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(E[1]);break;case"PtgNum":o.push(String(E[1]));break;case"PtgStr":o.push('"'+E[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(E[1]);break;case"PtgAreaN":m=h_(E[1][1],r?{s:r}:a,i),o.push(Hg(m,i));break;case"PtgArea":m=h_(E[1][1],a,i),o.push(Hg(m,i));break;case"PtgArea3d":p=E[1][1],m=E[1][2],y=j_(n,p,i),o.push(y+"!"+Hg(m,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":g=E[1][2];var w=(n.names||[])[g-1]||(n[0]||[])[g],F=w?w.Name:"SH33TJSNAME"+String(g);F&&F.slice(0,6)=="_xlfn."&&!i.xlfn&&(F=F.slice(6)),o.push(F);break;case"PtgNameX":var T=E[1][1];g=E[1][2];var N;if(i.biff<=5)T<0&&(T=-T),n[T]&&(N=n[T][g]);else{var D="";if(((n[T]||[])[0]||[])[0]==14849||(((n[T]||[])[0]||[])[0]==1025?n[T][g]&&n[T][g].itab>0&&(D=n.SheetNames[n[T][g].itab-1]+"!"):D=n.SheetNames[g-1]+"!"),n[T]&&n[T][g])D+=n[T][g].Name;else if(n[0]&&n[0][g])D+=n[0][g].Name;else{var P=(hC(n,T,i)||"").split(";;");P[g-1]?D=P[g-1]:D+="SH33TJSERRX"}o.push(D);break}N||(N={Name:"SH33TJSERRY"}),o.push(N.Name);break;case"PtgParen":var R="(",Xe=")";if(x>=0){switch(S="",t[0][x][1][0]){case 2:R=an(" ",t[0][x][1][1])+R;break;case 3:R=an("\r",t[0][x][1][1])+R;break;case 4:Xe=an(" ",t[0][x][1][1])+Xe;break;case 5:Xe=an("\r",t[0][x][1][1])+Xe;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][x][1][0])}x=-1}o.push(R+o.pop()+Xe);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":f={c:E[1][1],r:E[1][0]};var Se={c:r.c,r:r.r};if(n.sharedf[gt(f)]){var De=n.sharedf[gt(f)];o.push(gi(De,a,Se,n,i))}else{var ke=!1;for(l=0;l!=n.arrayf.length;++l)if(u=n.arrayf[l],!(f.c<u[0].s.c||f.c>u[0].e.c)&&!(f.r<u[0].s.r||f.r>u[0].e.r)){o.push(gi(u[1],a,Se,n,i)),ke=!0;break}ke||o.push(E[1])}break;case"PtgArray":o.push("{"+G5(E[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":x=A;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+E[1].idx+"[#"+E[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(E));default:throw new Error("Unrecognized Formula Token: "+String(E))}var Ce=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&x>=0&&Ce.indexOf(t[0][A][0])==-1){E=t[0][x];var ie=!0;switch(E[1][0]){case 4:ie=!1;case 0:S=an(" ",E[1][1]);break;case 5:ie=!1;case 1:S=an("\r",E[1][1]);break;default:if(S="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+E[1][0])}o.push((ie?S:"")+o.pop()+(ie?"":S)),x=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function X5(t,e,r){var n=t.l+e,i=r.biff==2?1:2,s,a=t.read_shift(i);if(a==65535)return[[],Si(t,e-2)];var o=Qf(t,a,r);return e!==a+i&&(s=qf(t,e-a-i,o,r)),t.l=n,[o,s]}function q5(t,e,r){var n=t.l+e,i=r.biff==2?1:2,s,a=t.read_shift(i);if(a==65535)return[[],Si(t,e-2)];var o=Qf(t,a,r);return e!==a+i&&(s=qf(t,e-a-i,o,r)),t.l=n,[o,s]}function Q5(t,e,r,n){var i=t.l+e,s=Qf(t,n,r),a;return i!==t.l&&(a=qf(t,i-t.l,s,r)),[s,a]}function J5(t,e,r){var n=t.l+e,i,s=t.read_shift(2),a=Qf(t,s,r);return s==65535?[[],Si(t,e-2)]:(e!==s+2&&(i=qf(t,n-s-2,a,r)),[a,i])}function Z5(t){var e;if(Ya(t,t.l+6)!==65535)return[yi(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function eO(t){if(t==null){var e=Ee(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return tc(t);return tc(0)}function Xg(t,e,r){var n=t.l+e,i=Ba(t);r.biff==2&&++t.l;var s=Z5(t),a=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var o=q5(t,n-t.l,r);return{cell:i,val:s[0],formula:o,shared:a>>3&1,tt:s[1]}}function tO(t,e,r,n,i){var s=nc(e,r,i),a=eO(t.v),o=Ee(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var u=Ee(t.bf.length),f=0;f<t.bf.length;++f)u[f]=t.bf[f];var p=Hn([s,a,o,u]);return p}function Yp(t,e,r){var n=t.read_shift(4),i=Qf(t,n,r),s=t.read_shift(4),a=s>0?qf(t,s,i,r):null;return[i,a]}var rO=Yp,Xp=Yp,nO=Yp,iO=Yp,sO={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},pC={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},aO={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function L_(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function oO(t){var e="of:="+t.replace(pv,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function qg(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function lO(t){return t.replace(/\./,"!")}var Wd={},lu={},Hd=typeof Map<"u";function xv(t,e,r){var n=0,i=t.length;if(r){if(Hd?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var s=Hd?r.get(e):r[e];n<s.length;++n)if(t[s[n]].t===e)return t.Count++,s[n]}}else for(;n<i;++n)if(t[n].t===e)return t.Count++,n;return t[i]={t:e},t.Count++,t.Unique++,r&&(Hd?(r.has(e)||r.set(e,[]),r.get(e).push(i)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(i))),i}function qp(t,e){var r={min:t+1,max:t+1},n=-1;return e.MDW&&(xi=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?n=Af(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(r.width=op(n),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function $l(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function Tl(t,e,r){var n=r.revssf[e.z!=null?e.z:"General"],i=60,s=t.length;if(n==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){eo(e.z,i),r.ssf[i]=e.z,r.revssf[e.z]=n=i;break}}for(i=0;i!=s;++i)if(t[i].numFmtId===n)return i;return t[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function gC(t,e,r,n,i,s){try{n.cellNF&&(t.z=pt[e])}catch(o){if(n.WTF)throw o}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=Br(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(pt[e]==null&&eo(sR[e]||"General",e),t.t==="e")t.w=t.w||xo[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=vf(t.v);else if(t.t==="d"){var a=Mn(t.v);(a|0)===a?t.w=a.toString(10):t.w=vf(a)}else{if(t.v===void 0)return"";t.w=Zl(t.v,lu)}else t.t==="d"?t.w=Ls(e,Mn(t.v),lu):t.w=Ls(e,t.v,lu)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{t.s=s.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=ap(i.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=i.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=ap(i.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=i.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&s.Fills)throw o}}}function cO(t,e,r){if(t&&t["!ref"]){var n=ir(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function uO(t,e){var r=ir(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=Nt(r))}var dO=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,fO=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,hO=/<(?:\w:)?hyperlink [^>]*>/mg,pO=/"(\w*:\w*)"/,gO=/<(?:\w:)?col\b[^>]*[\/]?>/g,mO=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,xO=/<(?:\w:)?pageMargins[^>]*\/>/g,mC=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,vO=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,yO=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function _O(t,e,r,n,i,s,a){if(!t)return t;n||(n={"!id":{}});var o=e.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",f="",p=t.match(fO);p?(u=t.slice(0,p.index),f=t.slice(p.index+p[0].length)):u=f=t;var g=u.match(mC);g?vv(g[0],o,i,r):(g=u.match(vO))&&SO(g[0],g[1]||"",o,i,r);var m=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(m>0){var y=u.slice(m,m+50).match(pO);y&&uO(o,y[1])}var x=u.match(yO);x&&x[1]&&OO(x[1],i);var S=[];if(e.cellStyles){var A=u.match(gO);A&&IO(S,A)}p&&jO(p[1],o,e,l,s,a);var C=f.match(mO);C&&(o["!autofilter"]=RO(C[0]));var E=[],O=f.match(dO);if(O)for(m=0;m!=O.length;++m)E[m]=ir(O[m].slice(O[m].indexOf('"')+1));var Q=f.match(hO);Q&&kO(o,Q,n);var H=f.match(xO);if(H&&(o["!margins"]=FO(xt(H[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=Nt(l)),e.sheetRows>0&&o["!ref"]){var w=ir(o["!ref"]);e.sheetRows<=+w.e.r&&(w.e.r=e.sheetRows-1,w.e.r>l.e.r&&(w.e.r=l.e.r),w.e.r<w.s.r&&(w.s.r=w.e.r),w.e.c>l.e.c&&(w.e.c=l.e.c),w.e.c<w.s.c&&(w.s.c=w.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Nt(w))}return S.length>0&&(o["!cols"]=S),E.length>0&&(o["!merges"]=E),o}function EO(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+Nt(t[r])+'"/>';return e+"</mergeCells>"}function vv(t,e,r,n){var i=xt(t);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=nr(Tr(i.codeName)))}function SO(t,e,r,n,i){vv(t.slice(0,t.indexOf(">")),r,n,i)}function wO(t,e,r,n,i){var s=!1,a={},o=null;if(n.bookType!=="xlsx"&&e.vbaraw){var l=e.SheetNames[r];try{e.Workbook&&(l=e.Workbook.Sheets[r].CodeName||l)}catch{}s=!0,a.codeName=ka(_r(l))}if(t&&t["!outline"]){var u={summaryBelow:1,summaryRight:1};t["!outline"].above&&(u.summaryBelow=0),t["!outline"].left&&(u.summaryRight=0),o=(o||"")+$e("outlinePr",null,u)}!s&&!o||(i[i.length]=$e("sheetPr",o,a))}var TO=["objects","scenarios","selectLockedCells","selectUnlockedCells"],AO=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function CO(t){var e={sheet:1};return TO.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),AO.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=dv(t.password).toString(16).toUpperCase()),$e("sheetProtection",null,e)}function kO(t,e,r){for(var n=Array.isArray(t),i=0;i!=e.length;++i){var s=xt(Tr(e[i]),!0);if(!s.ref)return;var a=((r||{})["!id"]||[])[s.id];a?(s.Target=a.Target,s.location&&(s.Target+="#"+nr(s.location))):(s.Target="#"+nr(s.location),a={Target:s.Target,TargetMode:"Internal"}),s.Rel=a,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=ir(s.ref),l=o.s.r;l<=o.e.r;++l)for(var u=o.s.c;u<=o.e.c;++u){var f=gt({c:u,r:l});n?(t[l]||(t[l]=[]),t[l][u]||(t[l][u]={t:"z",v:void 0}),t[l][u].l=s):(t[f]||(t[f]={t:"z",v:void 0}),t[f].l=s)}}}function FO(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function bO(t){return $l(t),$e("pageMargins",null,t)}function IO(t,e){for(var r=!1,n=0;n!=e.length;++n){var i=xt(e[n],!0);i.hidden&&(i.hidden=Or(i.hidden));var s=parseInt(i.min,10)-1,a=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,fv(i.width)),hl(i);s<=a;)t[s++]=jr(i)}}function NO(t,e){for(var r=["<cols>"],n,i=0;i!=e.length;++i)(n=e[i])&&(r[r.length]=$e("col",null,qp(i,n)));return r[r.length]="</cols>",r.join("")}function RO(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}function DO(t,e,r,n){var i=typeof t.ref=="string"?t.ref:Nt(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,a=Zi(i);a.s.r==a.e.r&&(a.e.r=Zi(e["!ref"]).e.r,i=Nt(a));for(var o=0;o<s.length;++o){var l=s[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+i;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),$e("autoFilter",null,{ref:i})}var PO=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function OO(t,e){e.Views||(e.Views=[{}]),(t.match(PO)||[]).forEach(function(r,n){var i=xt(r);e.Views[n]||(e.Views[n]={}),+i.zoomScale&&(e.Views[n].zoom=+i.zoomScale),Or(i.rightToLeft)&&(e.Views[n].RTL=!0)})}function MO(t,e,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),$e("sheetViews",$e("sheetView",null,i),{})}function BO(t,e,r,n){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var i="",s=t.t,a=t.v;if(t.t!=="z")switch(t.t){case"b":i=t.v?"1":"0";break;case"n":i=""+t.v;break;case"e":i=xo[t.v];break;case"d":n&&n.cellDates?i=Br(t.v,-1).toISOString():(t=jr(t),t.t="n",i=""+(t.v=Mn(Br(t.v)))),typeof t.z>"u"&&(t.z=pt[14]);break;default:i=t.v;break}var o=ti("v",_r(i)),l={r:e},u=Tl(n.cellXfs,t,n);switch(u!==0&&(l.s=u),t.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=ti("v",""+xv(n.Strings,t.v,n.revStrings)),l.t="s";break}l.t="str";break}if(t.t!=s&&(t.t=s,t.v=a),typeof t.f=="string"&&t.f){var f=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;o=$e("f",_r(t.f),f)+(t.v!=null?o:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(l.cm=1),$e("c",o,l)}var jO=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,s=yf("v"),a=yf("f");return function(l,u,f,p,g,m){for(var y=0,x="",S=[],A=[],C=0,E=0,O=0,Q="",H,w,F=0,T=0,N,D,P=0,R=0,Xe=Array.isArray(m.CellXf),Se,De=[],ke=[],Ce=Array.isArray(u),ie=[],be={},Me=!1,Y=!!f.sheetStubs,re=l.split(e),ne=0,X=re.length;ne!=X;++ne){x=re[ne].trim();var _e=x.length;if(_e!==0){var Te=0;e:for(y=0;y<_e;++y)switch(x[y]){case">":if(x[y-1]!="/"){++y;break e}if(f&&f.cellStyles){if(w=xt(x.slice(Te,y),!0),F=w.r!=null?parseInt(w.r,10):F+1,T=-1,f.sheetRows&&f.sheetRows<F)continue;be={},Me=!1,w.ht&&(Me=!0,be.hpt=parseFloat(w.ht),be.hpx=Su(be.hpt)),w.hidden=="1"&&(Me=!0,be.hidden=!0),w.outlineLevel!=null&&(Me=!0,be.level=+w.outlineLevel),Me&&(ie[F-1]=be)}break;case"<":Te=y;break}if(Te>=y)break;if(w=xt(x.slice(Te,y),!0),F=w.r!=null?parseInt(w.r,10):F+1,T=-1,!(f.sheetRows&&f.sheetRows<F)){p.s.r>F-1&&(p.s.r=F-1),p.e.r<F-1&&(p.e.r=F-1),f&&f.cellStyles&&(be={},Me=!1,w.ht&&(Me=!0,be.hpt=parseFloat(w.ht),be.hpx=Su(be.hpt)),w.hidden=="1"&&(Me=!0,be.hidden=!0),w.outlineLevel!=null&&(Me=!0,be.level=+w.outlineLevel),Me&&(ie[F-1]=be)),S=x.slice(y).split(t);for(var Le=0;Le!=S.length&&S[Le].trim().charAt(0)=="<";++Le);for(S=S.slice(Le),y=0;y!=S.length;++y)if(x=S[y].trim(),x.length!==0){if(A=x.match(r),C=y,E=0,O=0,x="<c "+(x.slice(0,1)=="<"?">":"")+x,A!=null&&A.length===2){for(C=0,Q=A[1],E=0;E!=Q.length&&!((O=Q.charCodeAt(E)-64)<1||O>26);++E)C=26*C+O;--C,T=C}else++T;for(E=0;E!=x.length&&x.charCodeAt(E)!==62;++E);if(++E,w=xt(x.slice(0,E),!0),w.r||(w.r=gt({r:F-1,c:T})),Q=x.slice(E),H={t:""},(A=Q.match(s))!=null&&A[1]!==""&&(H.v=nr(A[1])),f.cellFormula){if((A=Q.match(a))!=null&&A[1]!==""){if(H.f=nr(Tr(A[1])).replace(/\r\n/g,`
`),f.xlfn||(H.f=O_(H.f)),A[0].indexOf('t="array"')>-1)H.F=(Q.match(i)||[])[1],H.F.indexOf(":")>-1&&De.push([ir(H.F),H.F]);else if(A[0].indexOf('t="shared"')>-1){D=xt(A[0]);var Ne=nr(Tr(A[1]));f.xlfn||(Ne=O_(Ne)),ke[parseInt(D.si,10)]=[D,Ne,w.r]}}else(A=Q.match(/<f[^>]*\/>/))&&(D=xt(A[0]),ke[D.si]&&(H.f=P8(ke[D.si][1],ke[D.si][2],w.r)));var Ie=Jr(w.r);for(E=0;E<De.length;++E)Ie.r>=De[E][0].s.r&&Ie.r<=De[E][0].e.r&&Ie.c>=De[E][0].s.c&&Ie.c<=De[E][0].e.c&&(H.F=De[E][1])}if(w.t==null&&H.v===void 0)if(H.f||H.F)H.v=0,H.t="n";else if(Y)H.t="z";else continue;else H.t=w.t||"n";switch(p.s.c>T&&(p.s.c=T),p.e.c<T&&(p.e.c=T),H.t){case"n":if(H.v==""||H.v==null){if(!Y)continue;H.t="z"}else H.v=parseFloat(H.v);break;case"s":if(typeof H.v>"u"){if(!Y)continue;H.t="z"}else N=Wd[parseInt(H.v,10)],H.v=N.t,H.r=N.r,f.cellHTML&&(H.h=N.h);break;case"str":H.t="s",H.v=H.v!=null?Tr(H.v):"",f.cellHTML&&(H.h=q1(H.v));break;case"inlineStr":A=Q.match(n),H.t="s",A!=null&&(N=uv(A[1]))?(H.v=N.t,f.cellHTML&&(H.h=N.h)):H.v="";break;case"b":H.v=Or(H.v);break;case"d":f.cellDates?H.v=Br(H.v,1):(H.v=Mn(Br(H.v,1)),H.t="n");break;case"e":(!f||f.cellText!==!1)&&(H.w=H.v),H.v=vA[H.v];break}if(P=R=0,Se=null,Xe&&w.s!==void 0&&(Se=m.CellXf[w.s],Se!=null&&(Se.numFmtId!=null&&(P=Se.numFmtId),f.cellStyles&&Se.fillId!=null&&(R=Se.fillId))),gC(H,P,R,f,g,m),f.cellDates&&Xe&&H.t=="n"&&Ou(pt[P])&&(H.t="d",H.v=Gp(H.v)),w.cm&&f.xlmeta){var ot=(f.xlmeta.Cell||[])[+w.cm-1];ot&&ot.type=="XLDAPR"&&(H.D=!0)}if(Ce){var ee=Jr(w.r);u[ee.r]||(u[ee.r]=[]),u[ee.r][ee.c]=H}else u[w.r]=H}}}}ie.length>0&&(u["!rows"]=ie)}}();function LO(t,e,r,n){var i=[],s=[],a=ir(t["!ref"]),o="",l,u="",f=[],p=0,g=0,m=t["!rows"],y=Array.isArray(t),x={r:u},S,A=-1;for(g=a.s.c;g<=a.e.c;++g)f[g]=Qr(g);for(p=a.s.r;p<=a.e.r;++p){for(s=[],u=gn(p),g=a.s.c;g<=a.e.c;++g){l=f[g]+u;var C=y?(t[p]||[])[g]:t[l];C!==void 0&&(o=BO(C,l,t,e))!=null&&s.push(o)}(s.length>0||m&&m[p])&&(x={r:u},m&&m[p]&&(S=m[p],S.hidden&&(x.hidden=1),A=-1,S.hpx?A=Cf(S.hpx):S.hpt&&(A=S.hpt),A>-1&&(x.ht=A,x.customHeight=1),S.level&&(x.outlineLevel=S.level)),i[i.length]=$e("row",s.join(""),x))}if(m)for(;p<m.length;++p)m&&m[p]&&(x={r:p+1},S=m[p],S.hidden&&(x.hidden=1),A=-1,S.hpx?A=Cf(S.hpx):S.hpt&&(A=S.hpt),A>-1&&(x.ht=A,x.customHeight=1),S.level&&(x.outlineLevel=S.level),i[i.length]=$e("row","",x));return i.join("")}function xC(t,e,r,n){var i=[mn,$e("worksheet",null,{xmlns:fc[0],"xmlns:r":Rn.r})],s=r.SheetNames[t],a=0,o="",l=r.Sheets[s];l==null&&(l={});var u=l["!ref"]||"A1",f=ir(u);if(f.e.c>16383||f.e.r>1048575){if(e.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575),u=Nt(f)}n||(n={}),l["!comments"]=[];var p=[];wO(l,r,t,e,i),i[i.length]=$e("dimension",null,{ref:u}),i[i.length]=MO(l,e,t,r),e.sheetFormat&&(i[i.length]=$e("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(i[i.length]=NO(l,l["!cols"])),i[a=i.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=LO(l,e),o.length>0&&(i[i.length]=o)),i.length>a+1&&(i[i.length]="</sheetData>",i[a]=i[a].replace("/>",">")),l["!protect"]&&(i[i.length]=CO(l["!protect"])),l["!autofilter"]!=null&&(i[i.length]=DO(l["!autofilter"],l,r,t)),l["!merges"]!=null&&l["!merges"].length>0&&(i[i.length]=EO(l["!merges"]));var g=-1,m,y=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(x){x[1].Target&&(m={ref:x[0]},x[1].Target.charAt(0)!="#"&&(y=yr(n,-1,_r(x[1].Target).replace(/#.*$/,""),Vt.HLINK),m["r:id"]="rId"+y),(g=x[1].Target.indexOf("#"))>-1&&(m.location=_r(x[1].Target.slice(g+1))),x[1].Tooltip&&(m.tooltip=_r(x[1].Tooltip)),i[i.length]=$e("hyperlink",null,m))}),i[i.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(i[i.length]=bO(l["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(i[i.length]=ti("ignoredErrors",$e("ignoredError",null,{numberStoredAsText:1,sqref:u}))),p.length>0&&(y=yr(n,-1,"../drawings/drawing"+(t+1)+".xml",Vt.DRAW),i[i.length]=$e("drawing",null,{"r:id":"rId"+y}),l["!drawing"]=p),l["!comments"].length>0&&(y=yr(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",Vt.VML),i[i.length]=$e("legacyDrawing",null,{"r:id":"rId"+y}),l["!legacy"]=y),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function UO(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var i=t.read_shift(2);t.l+=1;var s=t.read_shift(1);return t.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=i/20),r}function VO(t,e,r){var n=Ee(145),i=(r["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var s=320;i.hpx?s=Cf(i.hpx)*20:i.hpt&&(s=i.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var a=0;i.level&&(a|=i.level),i.hidden&&(a|=16),(i.hpx||i.hpt)&&(a|=32),n.write_shift(1,a),n.write_shift(1,0);var o=0,l=n.l;n.l+=4;for(var u={r:t,c:0},f=0;f<16;++f)if(!(e.s.c>f+1<<10||e.e.c<f<<10)){for(var p=-1,g=-1,m=f<<10;m<f+1<<10;++m){u.c=m;var y=Array.isArray(r)?(r[u.r]||[])[u.c]:r[gt(u)];y&&(p<0&&(p=m),g=m)}p<0||(++o,n.write_shift(4,p),n.write_shift(4,g))}var x=n.l;return n.l=l,n.write_shift(4,o),n.l=x,n.length>n.l?n.slice(0,n.l):n}function zO(t,e,r,n){var i=VO(n,r,e);(i.length>17||(e["!rows"]||[])[n])&&Fe(t,0,i)}var WO=mc,HO=ju;function $O(){}function GO(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=XR(t),r}function KO(t,e,r){r==null&&(r=Ee(84+4*t.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),r.write_shift(1,n);for(var i=1;i<3;++i)r.write_shift(1,0);return np({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),hA(t,r),r.slice(0,r.l)}function YO(t){var e=Us(t);return[e]}function XO(t,e,r){return r==null&&(r=Ee(8)),hc(e,r)}function qO(t){var e=pc(t);return[e]}function QO(t,e,r){return r==null&&(r=Ee(4)),gc(e,r)}function JO(t){var e=Us(t),r=t.read_shift(1);return[e,r,"b"]}function ZO(t,e,r){return r==null&&(r=Ee(9)),hc(e,r),r.write_shift(1,t.v?1:0),r}function eM(t){var e=pc(t),r=t.read_shift(1);return[e,r,"b"]}function tM(t,e,r){return r==null&&(r=Ee(5)),gc(e,r),r.write_shift(1,t.v?1:0),r}function rM(t){var e=Us(t),r=t.read_shift(1);return[e,r,"e"]}function nM(t,e,r){return r==null&&(r=Ee(9)),hc(e,r),r.write_shift(1,t.v),r}function iM(t){var e=pc(t),r=t.read_shift(1);return[e,r,"e"]}function sM(t,e,r){return r==null&&(r=Ee(8)),gc(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function aM(t){var e=Us(t),r=t.read_shift(4);return[e,r,"s"]}function oM(t,e,r){return r==null&&(r=Ee(12)),hc(e,r),r.write_shift(4,e.v),r}function lM(t){var e=pc(t),r=t.read_shift(4);return[e,r,"s"]}function cM(t,e,r){return r==null&&(r=Ee(8)),gc(e,r),r.write_shift(4,e.v),r}function uM(t){var e=Us(t),r=yi(t);return[e,r,"n"]}function dM(t,e,r){return r==null&&(r=Ee(16)),hc(e,r),tc(t.v,r),r}function vC(t){var e=pc(t),r=yi(t);return[e,r,"n"]}function fM(t,e,r){return r==null&&(r=Ee(12)),gc(e,r),tc(t.v,r),r}function hM(t){var e=Us(t),r=sv(t);return[e,r,"n"]}function pM(t,e,r){return r==null&&(r=Ee(12)),hc(e,r),pA(t.v,r),r}function gM(t){var e=pc(t),r=sv(t);return[e,r,"n"]}function mM(t,e,r){return r==null&&(r=Ee(8)),gc(e,r),pA(t.v,r),r}function xM(t){var e=Us(t),r=rv(t);return[e,r,"is"]}function vM(t){var e=Us(t),r=_i(t);return[e,r,"str"]}function yM(t,e,r){return r==null&&(r=Ee(12+4*t.v.length)),hc(e,r),$n(t.v,r),r.length>r.l?r.slice(0,r.l):r}function _M(t){var e=pc(t),r=_i(t);return[e,r,"str"]}function EM(t,e,r){return r==null&&(r=Ee(8+4*t.v.length)),gc(e,r),$n(t.v,r),r.length>r.l?r.slice(0,r.l):r}function SM(t,e,r){var n=t.l+e,i=Us(t);i.r=r["!row"];var s=t.read_shift(1),a=[i,s,"b"];if(r.cellFormula){t.l+=2;var o=Xp(t,n-t.l,r);a[3]=gi(o,null,i,r.supbooks,r)}else t.l=n;return a}function wM(t,e,r){var n=t.l+e,i=Us(t);i.r=r["!row"];var s=t.read_shift(1),a=[i,s,"e"];if(r.cellFormula){t.l+=2;var o=Xp(t,n-t.l,r);a[3]=gi(o,null,i,r.supbooks,r)}else t.l=n;return a}function TM(t,e,r){var n=t.l+e,i=Us(t);i.r=r["!row"];var s=yi(t),a=[i,s,"n"];if(r.cellFormula){t.l+=2;var o=Xp(t,n-t.l,r);a[3]=gi(o,null,i,r.supbooks,r)}else t.l=n;return a}function AM(t,e,r){var n=t.l+e,i=Us(t);i.r=r["!row"];var s=_i(t),a=[i,s,"str"];if(r.cellFormula){t.l+=2;var o=Xp(t,n-t.l,r);a[3]=gi(o,null,i,r.supbooks,r)}else t.l=n;return a}var CM=mc,kM=ju;function FM(t,e){return e==null&&(e=Ee(4)),e.write_shift(4,t),e}function bM(t,e){var r=t.l+e,n=mc(t),i=nv(t),s=_i(t),a=_i(t),o=_i(t);t.l=r;var l={rfx:n,relId:i,loc:s,display:o};return a&&(l.Tooltip=a),l}function IM(t,e){var r=Ee(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));ju({s:Jr(t[0]),e:Jr(t[0])},r),iv("rId"+e,r);var n=t[1].Target.indexOf("#"),i=n==-1?"":t[1].Target.slice(n+1);return $n(i||"",r),$n(t[1].Tooltip||"",r),$n("",r),r.slice(0,r.l)}function NM(){}function RM(t,e,r){var n=t.l+e,i=gA(t),s=t.read_shift(1),a=[i];if(a[2]=s,r.cellFormula){var o=rO(t,n-t.l,r);a[1]=o}else t.l=n;return a}function DM(t,e,r){var n=t.l+e,i=mc(t),s=[i];if(r.cellFormula){var a=iO(t,n-t.l,r);s[1]=a,t.l=n}else t.l=n;return s}function PM(t,e,r){r==null&&(r=Ee(18));var n=qp(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var i=0;return e.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),e.level&&(i|=e.level<<8),r.write_shift(2,i),r}var yC=["left","right","top","bottom","header","footer"];function OM(t){var e={};return yC.forEach(function(r){e[r]=yi(t)}),e}function MM(t,e){return e==null&&(e=Ee(6*8)),$l(t),yC.forEach(function(r){tc(t[r],e)}),e}function BM(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function jM(t,e,r){r==null&&(r=Ee(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function LM(t){var e=Ee(24);return e.write_shift(4,4),e.write_shift(4,1),ju(t,e),e}function UM(t,e){return e==null&&(e=Ee(16*4+2)),e.write_shift(2,t.password?dv(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function VM(){}function zM(){}function WM(t,e,r,n,i,s,a){if(!t)return t;var o=e||{};n||(n={"!id":{}});var l=o.dense?[]:{},u,f={s:{r:2e6,c:2e6},e:{r:0,c:0}},p=!1,g=!1,m,y,x,S,A,C,E,O,Q,H=[];o.biff=12,o["!row"]=0;var w=0,F=!1,T=[],N={},D=o.supbooks||i.supbooks||[[]];if(D.sharedf=N,D.arrayf=T,D.SheetNames=i.SheetNames||i.Sheets.map(function(Ce){return Ce.name}),!o.supbooks&&(o.supbooks=D,i.Names))for(var P=0;P<i.Names.length;++P)D[0][P+1]=i.Names[P];var R=[],Xe=[],Se=!1;kf[16]={n:"BrtShortReal",f:vC};var De;if(mo(t,function(ie,be,Me){if(!g)switch(Me){case 148:u=ie;break;case 0:m=ie,o.sheetRows&&o.sheetRows<=m.r&&(g=!0),O=gn(S=m.r),o["!row"]=m.r,(ie.hidden||ie.hpt||ie.level!=null)&&(ie.hpt&&(ie.hpx=Su(ie.hpt)),Xe[ie.r]=ie);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(y={t:ie[2]},ie[2]){case"n":y.v=ie[1];break;case"s":E=Wd[ie[1]],y.v=E.t,y.r=E.r;break;case"b":y.v=!!ie[1];break;case"e":y.v=ie[1],o.cellText!==!1&&(y.w=xo[y.v]);break;case"str":y.t="s",y.v=ie[1];break;case"is":y.t="s",y.v=ie[1].t;break}if((x=a.CellXf[ie[0].iStyleRef])&&gC(y,x.numFmtId,null,o,s,a),A=ie[0].c==-1?A+1:ie[0].c,o.dense?(l[S]||(l[S]=[]),l[S][A]=y):l[Qr(A)+O]=y,o.cellFormula){for(F=!1,w=0;w<T.length;++w){var Y=T[w];m.r>=Y[0].s.r&&m.r<=Y[0].e.r&&A>=Y[0].s.c&&A<=Y[0].e.c&&(y.F=Nt(Y[0]),F=!0)}!F&&ie.length>3&&(y.f=ie[3])}if(f.s.r>m.r&&(f.s.r=m.r),f.s.c>A&&(f.s.c=A),f.e.r<m.r&&(f.e.r=m.r),f.e.c<A&&(f.e.c=A),o.cellDates&&x&&y.t=="n"&&Ou(pt[x.numFmtId])){var re=jl(y.v);re&&(y.t="d",y.v=new Date(re.y,re.m-1,re.d,re.H,re.M,re.S,re.u))}De&&(De.type=="XLDAPR"&&(y.D=!0),De=void 0);break;case 1:case 12:if(!o.sheetStubs||p)break;y={t:"z",v:void 0},A=ie[0].c==-1?A+1:ie[0].c,o.dense?(l[S]||(l[S]=[]),l[S][A]=y):l[Qr(A)+O]=y,f.s.r>m.r&&(f.s.r=m.r),f.s.c>A&&(f.s.c=A),f.e.r<m.r&&(f.e.r=m.r),f.e.c<A&&(f.e.c=A),De&&(De.type=="XLDAPR"&&(y.D=!0),De=void 0);break;case 176:H.push(ie);break;case 49:De=((o.xlmeta||{}).Cell||[])[ie-1];break;case 494:var ne=n["!id"][ie.relId];for(ne?(ie.Target=ne.Target,ie.loc&&(ie.Target+="#"+ie.loc),ie.Rel=ne):ie.relId==""&&(ie.Target="#"+ie.loc),S=ie.rfx.s.r;S<=ie.rfx.e.r;++S)for(A=ie.rfx.s.c;A<=ie.rfx.e.c;++A)o.dense?(l[S]||(l[S]=[]),l[S][A]||(l[S][A]={t:"z",v:void 0}),l[S][A].l=ie):(C=gt({c:A,r:S}),l[C]||(l[C]={t:"z",v:void 0}),l[C].l=ie);break;case 426:if(!o.cellFormula)break;T.push(ie),Q=o.dense?l[S][A]:l[Qr(A)+O],Q.f=gi(ie[1],f,{r:m.r,c:A},D,o),Q.F=Nt(ie[0]);break;case 427:if(!o.cellFormula)break;N[gt(ie[0].s)]=ie[1],Q=o.dense?l[S][A]:l[Qr(A)+O],Q.f=gi(ie[1],f,{r:m.r,c:A},D,o);break;case 60:if(!o.cellStyles)break;for(;ie.e>=ie.s;)R[ie.e--]={width:ie.w/256,hidden:!!(ie.flags&1),level:ie.level},Se||(Se=!0,fv(ie.w/256)),hl(R[ie.e+1]);break;case 161:l["!autofilter"]={ref:Nt(ie)};break;case 476:l["!margins"]=ie;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),ie.name&&(i.Sheets[r].CodeName=ie.name),(ie.above||ie.left)&&(l["!outline"]={above:ie.above,left:ie.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),ie.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:p=!0;break;case 36:p=!1;break;case 37:p=!0;break;case 38:p=!1;break;default:if(!be.T){if(!p||o.WTF)throw new Error("Unexpected record 0x"+Me.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(f.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(l["!ref"]=Nt(u||f)),o.sheetRows&&l["!ref"]){var ke=ir(l["!ref"]);o.sheetRows<=+ke.e.r&&(ke.e.r=o.sheetRows-1,ke.e.r>f.e.r&&(ke.e.r=f.e.r),ke.e.r<ke.s.r&&(ke.s.r=ke.e.r),ke.e.c>f.e.c&&(ke.e.c=f.e.c),ke.e.c<ke.s.c&&(ke.s.c=ke.e.c),l["!fullref"]=l["!ref"],l["!ref"]=Nt(ke))}return H.length>0&&(l["!merges"]=H),R.length>0&&(l["!cols"]=R),Xe.length>0&&(l["!rows"]=Xe),l}function HM(t,e,r,n,i,s,a){if(e.v===void 0)return!1;var o="";switch(e.t){case"b":o=e.v?"1":"0";break;case"d":e=jr(e),e.z=e.z||pt[14],e.v=Mn(Br(e.v)),e.t="n";break;case"n":case"e":o=""+e.v;break;default:o=e.v;break}var l={r,c:n};switch(l.s=Tl(i.cellXfs,e,i),e.l&&s["!links"].push([gt(l),e.l]),e.c&&s["!comments"].push([gt(l),e.c]),e.t){case"s":case"str":return i.bookSST?(o=xv(i.Strings,e.v,i.revStrings),l.t="s",l.v=o,a?Fe(t,18,cM(e,l)):Fe(t,7,oM(e,l))):(l.t="str",a?Fe(t,17,EM(e,l)):Fe(t,6,yM(e,l))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?a?Fe(t,13,mM(e,l)):Fe(t,2,pM(e,l)):a?Fe(t,16,fM(e,l)):Fe(t,5,dM(e,l)),!0;case"b":return l.t="b",a?Fe(t,15,tM(e,l)):Fe(t,4,ZO(e,l)),!0;case"e":return l.t="e",a?Fe(t,14,sM(e,l)):Fe(t,3,nM(e,l)),!0}return a?Fe(t,12,QO(e,l)):Fe(t,1,XO(e,l)),!0}function $M(t,e,r,n){var i=ir(e["!ref"]||"A1"),s,a="",o=[];Fe(t,145);var l=Array.isArray(e),u=i.e.r;e["!rows"]&&(u=Math.max(i.e.r,e["!rows"].length-1));for(var f=i.s.r;f<=u;++f){a=gn(f),zO(t,e,i,f);var p=!1;if(f<=i.e.r)for(var g=i.s.c;g<=i.e.c;++g){f===i.s.r&&(o[g]=Qr(g)),s=o[g]+a;var m=l?(e[f]||[])[g]:e[s];if(!m){p=!1;continue}p=HM(t,m,f,g,n,e,p)}}Fe(t,146)}function GM(t,e){!e||!e["!merges"]||(Fe(t,177,FM(e["!merges"].length)),e["!merges"].forEach(function(r){Fe(t,176,kM(r))}),Fe(t,178))}function KM(t,e){!e||!e["!cols"]||(Fe(t,390),e["!cols"].forEach(function(r,n){r&&Fe(t,60,PM(n,r))}),Fe(t,391))}function YM(t,e){!e||!e["!ref"]||(Fe(t,648),Fe(t,649,LM(ir(e["!ref"]))),Fe(t,650))}function XM(t,e,r){e["!links"].forEach(function(n){if(n[1].Target){var i=yr(r,-1,n[1].Target.replace(/#.*$/,""),Vt.HLINK);Fe(t,494,IM(n,i))}}),delete e["!links"]}function qM(t,e,r,n){if(e["!comments"].length>0){var i=yr(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Vt.VML);Fe(t,551,iv("rId"+i)),e["!legacy"]=i}}function QM(t,e,r,n){if(e["!autofilter"]){var i=e["!autofilter"],s=typeof i.ref=="string"?i.ref:Nt(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,o=Zi(s);o.s.r==o.e.r&&(o.e.r=Zi(e["!ref"]).e.r,s=Nt(o));for(var l=0;l<a.length;++l){var u=a[l];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+s;break}}l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),Fe(t,161,ju(ir(s))),Fe(t,162)}}function JM(t,e,r){Fe(t,133),Fe(t,137,jM(e,r)),Fe(t,138),Fe(t,134)}function ZM(t,e){e["!protect"]&&Fe(t,535,UM(e["!protect"]))}function eB(t,e,r,n){var i=Ji(),s=r.SheetNames[t],a=r.Sheets[s]||{},o=s;try{r&&r.Workbook&&(o=r.Workbook.Sheets[t].CodeName||o)}catch{}var l=ir(a["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(e.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],Fe(i,129),(r.vbaraw||a["!outline"])&&Fe(i,147,KO(o,a["!outline"])),Fe(i,148,HO(l)),JM(i,a,r.Workbook),KM(i,a),$M(i,a,t,e),ZM(i,a),QM(i,a,r,t),GM(i,a),XM(i,a,n),a["!margins"]&&Fe(i,476,MM(a["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&YM(i,a),qM(i,a,t,n),Fe(i,130),i.end()}function tB(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var a=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);a&&(e[+a[1]]=r?+a[2]:a[2])});var i=nr((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[e,i,n]}function rB(t,e,r,n,i,s){var a=s||{"!type":"chart"};if(!t)return s;var o=0,l=0,u="A",f={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(p){var g=tB(p);f.s.r=f.s.c=0,f.e.c=o,u=Qr(o),g[0].forEach(function(m,y){a[u+gn(y)]={t:"n",v:m,z:g[1]},l=y}),f.e.r<l&&(f.e.r=l),++o}),o>0&&(a["!ref"]=Nt(f)),a}function nB(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a,o=t.match(mC);return o&&vv(o[0],s,i,r),(a=t.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=a[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function iB(t,e){t.l+=10;var r=_i(t);return{name:r}}function sB(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a=!1;return mo(t,function(l,u,f){switch(f){case 550:s["!rel"]=l;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),l.name&&(i.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!a||e.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}},e),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var yv=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],aB=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],oB=[],lB=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function U_(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],i=0;i!=e.length;++i){var s=e[i];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=Or(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function V_(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=Or(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function _C(t){V_(t.WBProps,yv),V_(t.CalcPr,lB),U_(t.WBView,aB),U_(t.Sheets,oB),lu.date1904=Or(t.WBProps.date1904)}function cB(t){return!t.Workbook||!t.Workbook.WBProps?"false":Or(t.Workbook.WBProps.date1904)?"true":"false"}var uB="][*?/\\".split("");function EC(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return uB.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function dB(t,e,r){t.forEach(function(n,i){EC(n);for(var s=0;s<i;++s)if(n==t[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var a=e&&e[i]&&e[i].CodeName||n;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function fB(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];dB(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)cO(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}var hB=/<\w+:workbook/;function pB(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",s={},a=0;if(t.replace(Ti,function(l,u){var f=xt(l);switch(Ma(f[0])){case"<?xml":break;case"<workbook":l.match(hB)&&(i="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=f[i];break;case"</workbook>":break;case"<fileVersion":delete f[0],r.AppVersion=f;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":yv.forEach(function(p){if(f[p[0]]!=null)switch(p[2]){case"bool":r.WBProps[p[0]]=Or(f[p[0]]);break;case"int":r.WBProps[p[0]]=parseInt(f[p[0]],10);break;default:r.WBProps[p[0]]=f[p[0]]}}),f.codeName&&(r.WBProps.CodeName=Tr(f.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete f[0],r.WBView.push(f);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(f.state){case"hidden":f.Hidden=1;break;case"veryHidden":f.Hidden=2;break;default:f.Hidden=0}delete f.state,f.name=nr(Tr(f.name)),delete f[0],r.Sheets.push(f);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=Tr(f.name),f.comment&&(s.Comment=f.comment),f.localSheetId&&(s.Sheet=+f.localSheetId),Or(f.hidden||"0")&&(s.Hidden=!0),a=u+l.length;break;case"</definedName>":s.Ref=nr(Tr(t.slice(a,u))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete f[0],r.CalcPr=f;break;case"<calcPr/>":delete f[0],r.CalcPr=f;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+f[0]+" in workbook")}return l}),fc.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return _C(r),r}function SC(t){var e=[mn];e[e.length]=$e("workbook",null,{xmlns:fc[0],"xmlns:r":Rn.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(yv.forEach(function(o){t.Workbook.WBProps[o[0]]!=null&&t.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=t.Workbook.WBProps[o[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=$e("workbookPr",null,n);var i=t.Workbook&&t.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(e[e.length]="<bookViews>",s=0;s!=t.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==t.SheetNames.length&&(s=0),e[e.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",s=0;s!=t.SheetNames.length;++s){var a={name:_r(t.SheetNames[s].slice(0,31))};if(a.sheetId=""+(s+1),a["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}e[e.length]=$e("sheet",null,a)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(e[e.length]=$e("definedName",_r(o.Ref),l))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function gB(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=hx(t),r.name=_i(t),r}function mB(t,e){return e||(e=Ee(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),iv(t.strRelID,e),$n(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function xB(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var i=e>8?_i(t):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function vB(t,e){e||(e=Ee(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),hA(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function yB(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function _B(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var i=t.read_shift(4),s=qR(t),a=nO(t,0,r),o=nv(t);t.l=n;var l={Name:s,Ptg:a};return i<268435455&&(l.Sheet=i),o&&(l.Comment=o),l}function EB(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;e||(e={}),e.biff=12;var s=[],a=[[]];return a.SheetNames=[],a.XTI=[],kf[16]={n:"BrtFRTArchID$",f:yB},mo(t,function(l,u,f){switch(f){case 156:a.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(e.SID=l.Sheet),l.Ref=gi(l.Ptg,null,null,a,e),delete e.SID,delete l.Ptg,s.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:a[0].length?a.push([f,l]):a[0]=[f,l],a[a.length-1].XTI=[];break;case 362:a.length===0&&(a[0]=[],a[0].XTI=[]),a[a.length-1].XTI=a[a.length-1].XTI.concat(l),a.XTI=a.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(f),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(f),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!u.T){if(!i||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}},e),_C(r),r.Names=s,r.supbooks=a,r}function SB(t,e){Fe(t,143);for(var r=0;r!=e.SheetNames.length;++r){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,i={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};Fe(t,156,mB(i))}Fe(t,144)}function wB(t,e){e||(e=Ee(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return $n("SheetJS",e),$n(qh.version,e),$n(qh.version,e),$n("7262",e),e.length>e.l?e.slice(0,e.l):e}function TB(t,e){e||(e=Ee(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function AB(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,n=0,i=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&i==-1?i=n:r[n].Hidden==1&&s==-1&&(s=n);s>i||(Fe(t,135),Fe(t,158,TB(i)),Fe(t,136))}}function CB(t,e){var r=Ji();return Fe(r,131),Fe(r,128,wB()),Fe(r,153,vB(t.Workbook&&t.Workbook.WBProps||null)),AB(r,t),SB(r,t),Fe(r,132),r.end()}function kB(t,e,r){return e.slice(-4)===".bin"?EB(t,r):pB(t,r)}function FB(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?WM(t,n,r,i,s,a,o):_O(t,n,r,i,s,a,o)}function bB(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?sB(t,n,r,i,s):nB(t,n,r,i,s)}function IB(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?R8():D8()}function NB(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?I8():N8()}function RB(t,e,r,n){return e.slice(-4)===".bin"?kP(t,r,n):gP(t,r,n)}function DB(t,e,r){return rC(t,r)}function PB(t,e,r){return e.slice(-4)===".bin"?P6(t,r):N6(t,r)}function OB(t,e,r){return e.slice(-4)===".bin"?A8(t,r):m8(t,r)}function MB(t,e,r){return e.slice(-4)===".bin"?h8(t):d8(t)}function BB(t,e,r,n){return r.slice(-4)===".bin"?p8(t,e,r,n):void 0}function jB(t,e,r){return e.slice(-4)===".bin"?l8(t,e,r):u8(t,e,r)}function LB(t,e,r){return(e.slice(-4)===".bin"?CB:SC)(t)}function UB(t,e,r,n,i){return(e.slice(-4)===".bin"?eB:xC)(t,r,n,i)}function VB(t,e,r){return(e.slice(-4)===".bin"?BP:eC)(t,r)}function zB(t,e,r){return(e.slice(-4)===".bin"?B6:GA)(t,r)}function WB(t,e,r){return(e.slice(-4)===".bin"?C8:sC)(t)}function HB(t){return(t.slice(-4)===".bin"?c8:nC)()}var wC=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,TC=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Ys(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var i=t.match(wC),s,a,o,l;if(i)for(l=0;l!=i.length;++l)s=i[l].match(TC),(a=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(a+1),n[o]=s[2].slice(1,s[2].length-1));return n}function $B(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(wC),i,s,a,o;if(n)for(o=0;o!=n.length;++o)i=n[o].match(TC),(s=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?a="xmlns"+i[1].slice(6):a=i[1].slice(s+1),r[a]=i[2].slice(1,i[2].length-1));return r}var $d;function GB(t,e){var r=$d[t]||nr(t);return r==="General"?Zl(e):Ls(r,e)}function KB(t,e,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=Or(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=Br(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[nr(e)]=i}function YB(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||xo[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=vf(t.v):t.w=Zl(t.v):t.w=GB(e||"General",t.v)}catch(s){if(r.WTF)throw s}try{var n=$d[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&Ou(n)){var i=jl(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(s){if(r.WTF)throw s}}}function XB(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=oP[n.Pattern]||n.Pattern)}t[e.ID]=e}function qB(t,e,r,n,i,s,a,o,l,u){var f="General",p=n.StyleID,g={};u=u||{};var m=[],y=0;for(p===void 0&&o&&(p=o.StyleID),p===void 0&&a&&(p=a.StyleID);s[p]!==void 0&&(s[p].nf&&(f=s[p].nf),s[p].Interior&&m.push(s[p].Interior),!!s[p].Parent);)p=s[p].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Or(t);break;case"String":n.t="s",n.r=i_(nr(t)),n.v=t.indexOf("<")>-1?nr(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(Br(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=nr(t):n.v<60&&(n.v=n.v-1),(!f||f=="General")&&(f="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=vA[t],u.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=i_(e||t));break}if(YB(n,f,u),u.cellFormula!==!1)if(n.Formula){var x=nr(n.Formula);x.charCodeAt(0)==61&&(x=x.slice(1)),n.f=ou(x,i),delete n.Formula,n.ArrayRange=="RC"?n.F=ou("RC:RC",i):n.ArrayRange&&(n.F=ou(n.ArrayRange,i),l.push([ir(n.F),n.F]))}else for(y=0;y<l.length;++y)i.r>=l[y][0].s.r&&i.r<=l[y][0].e.r&&i.c>=l[y][0].s.c&&i.c<=l[y][0].e.c&&(n.F=l[y][1]);u.cellStyles&&(m.forEach(function(S){!g.patternType&&S.patternType&&(g.patternType=S.patternType)}),n.s=g),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function QB(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function Qg(t,e){var r=e||{};Mu();var n=wd(Q1(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Tr(n));var i=n.slice(0,1024).toLowerCase(),s=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var a=jr(r);return a.type="string",Eu.to_workbook(n,a)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(wr){i.indexOf("<"+wr)>=0&&(s=!0)}),s)return Mj(n,r);$d={"General Number":"General","General Date":pt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":pt[15],"Short Date":pt[14],"Long Time":pt[19],"Medium Time":pt[18],"Short Time":pt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:pt[2],Standard:pt[4],Percent:pt[10],Scientific:pt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],u,f={},p=[],g=r.dense?[]:{},m="",y={},x={},S=Ys('<Data ss:Type="String">'),A=0,C=0,E=0,O={s:{r:2e6,c:2e6},e:{r:0,c:0}},Q={},H={},w="",F=0,T=[],N={},D={},P=0,R=[],Xe=[],Se={},De=[],ke,Ce=!1,ie=[],be=[],Me={},Y=0,re=0,ne={Sheets:[],WBProps:{date1904:!1}},X={};Ef.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var _e="";o=Ef.exec(n);)switch(o[3]=(_e=o[3]).toLowerCase()){case"data":if(_e=="data"){if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?qB(n.slice(A,o.index),w,S,l[l.length-1][0]=="comment"?Se:y,{c:C,r:E},Q,De[C],x,ie,r):(w="",S=Ys(o[0]),A=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(Xe.length>0&&(y.c=Xe),(!r.sheetRows||r.sheetRows>E)&&y.v!==void 0&&(r.dense?(g[E]||(g[E]=[]),g[E][C]=y):g[Qr(C)+gn(E)]=y),y.HRef&&(y.l={Target:nr(y.HRef)},y.HRefScreenTip&&(y.l.Tooltip=y.HRefScreenTip),delete y.HRef,delete y.HRefScreenTip),(y.MergeAcross||y.MergeDown)&&(Y=C+(parseInt(y.MergeAcross,10)|0),re=E+(parseInt(y.MergeDown,10)|0),T.push({s:{c:C,r:E},e:{c:Y,r:re}})),!r.sheetStubs)y.MergeAcross?C=Y+1:++C;else if(y.MergeAcross||y.MergeDown){for(var Te=C;Te<=Y;++Te)for(var Le=E;Le<=re;++Le)(Te>C||Le>E)&&(r.dense?(g[Le]||(g[Le]=[]),g[Le][Te]={t:"z"}):g[Qr(Te)+gn(Le)]={t:"z"});C=Y+1}else++C;else y=$B(o[0]),y.Index&&(C=+y.Index-1),C<O.s.c&&(O.s.c=C),C>O.e.c&&(O.e.c=C),o[0].slice(-2)==="/>"&&++C,Xe=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(E<O.s.r&&(O.s.r=E),E>O.e.r&&(O.e.r=E),o[0].slice(-2)==="/>"&&(x=Ys(o[0]),x.Index&&(E=+x.Index-1)),C=0,++E):(x=Ys(o[0]),x.Index&&(E=+x.Index-1),Me={},(x.AutoFitHeight=="0"||x.Height)&&(Me.hpx=parseInt(x.Height,10),Me.hpt=Cf(Me.hpx),be[E]=Me),x.Hidden=="1"&&(Me.hidden=!0,be[E]=Me));break;case"worksheet":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));p.push(m),O.s.r<=O.e.r&&O.s.c<=O.e.c&&(g["!ref"]=Nt(O),r.sheetRows&&r.sheetRows<=O.e.r&&(g["!fullref"]=g["!ref"],O.e.r=r.sheetRows-1,g["!ref"]=Nt(O))),T.length&&(g["!merges"]=T),De.length>0&&(g["!cols"]=De),be.length>0&&(g["!rows"]=be),f[m]=g}else O={s:{r:2e6,c:2e6},e:{r:0,c:0}},E=C=0,l.push([o[3],!1]),u=Ys(o[0]),m=nr(u.Name),g=r.dense?[]:{},T=[],ie=[],be=[],X={name:m,Hidden:0},ne.Sheets.push(X);break;case"table":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),De=[],Ce=!1}break;case"style":o[1]==="/"?XB(Q,H,r):H=Ys(o[0]);break;case"numberformat":H.nf=nr(Ys(o[0]).Format||"General"),$d[H.nf]&&(H.nf=$d[H.nf]);for(var Ne=0;Ne!=392&&pt[Ne]!=H.nf;++Ne);if(Ne==392){for(Ne=57;Ne!=392;++Ne)if(pt[Ne]==null){eo(H.nf,Ne);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(ke=Ys(o[0]),ke.Hidden&&(ke.hidden=!0,delete ke.Hidden),ke.Width&&(ke.wpx=parseInt(ke.Width,10)),!Ce&&ke.wpx>10){Ce=!0,xi=JA;for(var Ie=0;Ie<De.length;++Ie)De[Ie]&&hl(De[Ie])}Ce&&hl(ke),De[ke.Index-1||De.length]=ke;for(var ot=0;ot<+ke.Span;++ot)De[De.length]=jr(ke);break;case"namedrange":if(o[1]==="/")break;ne.Names||(ne.Names=[]);var ee=xt(o[0]),Ot={Name:ee.Name,Ref:ou(ee.RefersTo.slice(1),{r:0,c:0})};ne.Sheets.length>0&&(Ot.Sheet=ne.Sheets.length-1),ne.Names.push(Ot);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?w+=n.slice(F,o.index):F=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;H.Interior=Ys(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?ED(N,_e,n.slice(P,o.index)):P=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));QB(Se),Xe.push(Se)}else l.push([o[3],!1]),u=Ys(o[0]),Se={a:u.Author};break;case"autofilter":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var wt=Ys(o[0]);g["!autofilter"]={ref:ou(wt.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return G_(n,r);var Mt=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Mt=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Mt=!1}break;case"excelworkbook":switch(o[3]){case"date1904":ne.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Mt=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:Mt=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(P,o.index)){case"SheetHidden":X.Hidden=1;break;case"SheetVeryHidden":X.Hidden=2;break}else P=o.index+o[0].length;break;case"header":g["!margins"]||$l(g["!margins"]={},"xlml"),isNaN(+xt(o[0]).Margin)||(g["!margins"].header=+xt(o[0]).Margin);break;case"footer":g["!margins"]||$l(g["!margins"]={},"xlml"),isNaN(+xt(o[0]).Margin)||(g["!margins"].footer=+xt(o[0]).Margin);break;case"pagemargins":var St=xt(o[0]);g["!margins"]||$l(g["!margins"]={},"xlml"),isNaN(+St.Top)||(g["!margins"].top=+St.Top),isNaN(+St.Left)||(g["!margins"].left=+St.Left),isNaN(+St.Right)||(g["!margins"].right=+St.Right),isNaN(+St.Bottom)||(g["!margins"].bottom=+St.Bottom);break;case"displayrighttoleft":ne.Views||(ne.Views=[]),ne.Views[0]||(ne.Views[0]={}),ne.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Mt=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Mt=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Mt=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Mt=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Mt=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Mt=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Mt=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Mt=!1}break;case"smarttags":break;default:Mt=!1;break}if(Mt||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?KB(D,_e,R,n.slice(P,o.index)):(R=o,P=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var Ke={};return!r.bookSheets&&!r.bookProps&&(Ke.Sheets=f),Ke.SheetNames=p,Ke.Workbook=ne,Ke.SSF=jr(pt),Ke.Props=N,Ke.Custprops=D,Ke}function _x(t,e){switch(Ev(e=e||{}),e.type||"base64"){case"base64":return Qg(ms(t),e);case"binary":case"buffer":case"file":return Qg(t,e);case"array":return Qg(Sl(t),e)}}function JB(t,e){var r=[];return t.Props&&r.push(SD(t.Props,e)),t.Custprops&&r.push(wD(t.Props,t.Custprops)),r.join("")}function ZB(){return""}function ej(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,i){var s=[];s.push($e("NumberFormat",null,{"ss:Format":_r(pt[n.numFmtId])}));var a={"ss:ID":"s"+(21+i)};r.push($e("Style",s.join(""),a))}),$e("Styles",r.join(""))}function AC(t){return $e("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+gv(t.Ref,{r:0,c:0})})}function tj(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],n=0;n<e.length;++n){var i=e[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(AC(i)))}return $e("Names",r.join(""))}function rj(t,e,r,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,s=[],a=0;a<i.length;++a){var o=i[a];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||s.push(AC(o)))}return s.join("")}function nj(t,e,r,n){if(!t)return"";var i=[];if(t["!margins"]&&(i.push("<PageSetup>"),t["!margins"].header&&i.push($e("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&i.push($e("Footer",null,{"x:Margin":t["!margins"].footer})),i.push($e("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push($e("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),t["!protect"]&&(i.push(ti("ProtectContents","True")),t["!protect"].objects&&i.push(ti("ProtectObjects","True")),t["!protect"].scenarios&&i.push(ti("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?i.push(ti("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&i.push(ti("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){t["!protect"][a[0]]&&i.push("<"+a[1]+"/>")})),i.length==0?"":$e("WorksheetOptions",i.join(""),{xmlns:ls.x})}function ij(t){return t.map(function(e){var r=AR(e.t||""),n=$e("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return $e("Comment",n,{"ss:Author":e.a})}).join("")}function sj(t,e,r,n,i,s,a){if(!t||t.v==null&&t.f==null)return"";var o={};if(t.f&&(o["ss:Formula"]="="+_r(gv(t.f,a))),t.F&&t.F.slice(0,e.length)==e){var l=Jr(t.F.slice(e.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==a.r?"":"["+(l.r-a.r)+"]")+"C"+(l.c==a.c?"":"["+(l.c-a.c)+"]")}if(t.l&&t.l.Target&&(o["ss:HRef"]=_r(t.l.Target),t.l.Tooltip&&(o["x:HRefScreenTip"]=_r(t.l.Tooltip))),r["!merges"])for(var u=r["!merges"],f=0;f!=u.length;++f)u[f].s.c!=a.c||u[f].s.r!=a.r||(u[f].e.c>u[f].s.c&&(o["ss:MergeAcross"]=u[f].e.c-u[f].s.c),u[f].e.r>u[f].s.r&&(o["ss:MergeDown"]=u[f].e.r-u[f].s.r));var p="",g="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":p="Number",g=String(t.v);break;case"b":p="Boolean",g=t.v?"1":"0";break;case"e":p="Error",g=xo[t.v];break;case"d":p="DateTime",g=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||pt[14]);break;case"s":p="String",g=TR(t.v||"");break}var m=Tl(n.cellXfs,t,n);o["ss:StyleID"]="s"+(21+m),o["ss:Index"]=a.c+1;var y=t.v!=null?g:"",x=t.t=="z"?"":'<Data ss:Type="'+p+'">'+y+"</Data>";return(t.c||[]).length>0&&(x+=ij(t.c)),$e("Cell",x,o)}function aj(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=Su(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function oj(t,e,r,n){if(!t["!ref"])return"";var i=ir(t["!ref"]),s=t["!merges"]||[],a=0,o=[];t["!cols"]&&t["!cols"].forEach(function(S,A){hl(S);var C=!!S.width,E=qp(A,S),O={"ss:Index":A+1};C&&(O["ss:Width"]=Tf(E.width)),S.hidden&&(O["ss:Hidden"]="1"),o.push($e("Column",null,O))});for(var l=Array.isArray(t),u=i.s.r;u<=i.e.r;++u){for(var f=[aj(u,(t["!rows"]||[])[u])],p=i.s.c;p<=i.e.c;++p){var g=!1;for(a=0;a!=s.length;++a)if(!(s[a].s.c>p)&&!(s[a].s.r>u)&&!(s[a].e.c<p)&&!(s[a].e.r<u)){(s[a].s.c!=p||s[a].s.r!=u)&&(g=!0);break}if(!g){var m={r:u,c:p},y=gt(m),x=l?(t[u]||[])[p]:t[y];f.push(sj(x,y,t,e,r,n,m))}}f.push("</Row>"),f.length>2&&o.push(f.join(""))}return o.join("")}function lj(t,e,r){var n=[],i=r.SheetNames[t],s=r.Sheets[i],a=s?rj(s,e,t,r):"";return a.length>0&&n.push("<Names>"+a+"</Names>"),a=s?oj(s,e,t,r):"",a.length>0&&n.push("<Table>"+a+"</Table>"),n.push(nj(s,e,t,r)),n.join("")}function cj(t,e){e||(e={}),t.SSF||(t.SSF=jr(pt)),t.SSF&&(Mu(),Wp(t.SSF),e.revssf=$p(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],Tl(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(JB(t,e)),r.push(ZB()),r.push(""),r.push("");for(var n=0;n<t.SheetNames.length;++n)r.push($e("Worksheet",lj(n,e,t),{"ss:Name":_r(t.SheetNames[n])}));return r[2]=ej(t,e),r[3]=tj(t),mn+$e("Workbook",r.join(""),{xmlns:ls.ss,"xmlns:o":ls.o,"xmlns:x":ls.x,"xmlns:ss":ls.ss,"xmlns:dt":ls.dt,"xmlns:html":ls.html})}function uj(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=tD(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=rD(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var dj=[60,1084,2066,2165,2175];function fj(t,e,r,n,i){var s=n,a=[],o=r.slice(r.l,r.l+s);if(i&&i.enc&&i.enc.insitu&&o.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(o)}a.push(o),r.l+=s;for(var l=Ya(r,r.l),u=Ex[l],f=0;u!=null&&dj.indexOf(l)>-1;)s=Ya(r,r.l+2),f=r.l+4,l==2066?f+=4:(l==2165||l==2175)&&(f+=12),o=r.slice(f,r.l+4+s),a.push(o),r.l+=4+s,u=Ex[l=Ya(r,r.l)];var p=Hn(a);ei(p,0);var g=0;p.lens=[];for(var m=0;m<a.length;++m)p.lens.push(g),g+=a[m].length;if(p.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+p.length+" < "+n;return e.f(p,p.length,i)}function Ea(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=pt[n])}catch(s){if(e.WTF)throw s}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||xo[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=vf(t.v):t.w=Zl(t.v):t.w=Ls(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(s){if(e.WTF)throw s}if(e.cellDates&&n&&t.t=="n"&&Ou(pt[n]||String(n))){var i=jl(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function $0(t,e,r){return{v:t,ixfe:e,t:r}}function hj(t,e){var r={opts:{}},n={},i=e.dense?[]:{},s={},a={},o=null,l=[],u="",f={},p,g="",m,y,x,S,A={},C=[],E,O,Q=[],H=[],w={Sheets:[],WBProps:{date1904:!1},Views:[{}]},F={},T=function(yt){return yt<8?zl[yt]:yt<64&&H[yt-8]||zl[yt]},N=function(yt,Rr,Lr){var Ur=Rr.XF.data;if(!(!Ur||!Ur.patternType||!Lr||!Lr.cellStyles)){Rr.s={},Rr.s.patternType=Ur.patternType;var Bn;(Bn=wf(T(Ur.icvFore)))&&(Rr.s.fgColor={rgb:Bn}),(Bn=wf(T(Ur.icvBack)))&&(Rr.s.bgColor={rgb:Bn})}},D=function(yt,Rr,Lr){if(!(Me>1)&&!(Lr.sheetRows&&yt.r>=Lr.sheetRows)){if(Lr.cellStyles&&Rr.XF&&Rr.XF.data&&N(yt,Rr,Lr),delete Rr.ixfe,delete Rr.XF,p=yt,g=gt(yt),(!a||!a.s||!a.e)&&(a={s:{r:0,c:0},e:{r:0,c:0}}),yt.r<a.s.r&&(a.s.r=yt.r),yt.c<a.s.c&&(a.s.c=yt.c),yt.r+1>a.e.r&&(a.e.r=yt.r+1),yt.c+1>a.e.c&&(a.e.c=yt.c+1),Lr.cellFormula&&Rr.f){for(var Ur=0;Ur<C.length;++Ur)if(!(C[Ur][0].s.c>yt.c||C[Ur][0].s.r>yt.r)&&!(C[Ur][0].e.c<yt.c||C[Ur][0].e.r<yt.r)){Rr.F=Nt(C[Ur][0]),(C[Ur][0].s.c!=yt.c||C[Ur][0].s.r!=yt.r)&&delete Rr.f,Rr.f&&(Rr.f=""+gi(C[Ur][1],a,yt,ie,P));break}}Lr.dense?(i[yt.r]||(i[yt.r]=[]),i[yt.r][yt.c]=Rr):i[g]=Rr}},P={enc:!1,sbcch:0,snames:[],sharedf:A,arrayf:C,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(P.password=e.password);var R,Xe=[],Se=[],De=[],ke=[],Ce=!1,ie=[];ie.SheetNames=P.snames,ie.sharedf=P.sharedf,ie.arrayf=P.arrayf,ie.names=[],ie.XTI=[];var be=0,Me=0,Y=0,re=[],ne=[],X;P.codepage=1200,Zs(1200);for(var _e=!1;t.l<t.length-1;){var Te=t.l,Le=t.read_shift(2);if(Le===0&&be===10)break;var Ne=t.l===t.length?0:t.read_shift(2),Ie=Ex[Le];if(Ie&&Ie.f){if(e.bookSheets&&be===133&&Le!==133)break;if(be=Le,Ie.r===2||Ie.r==12){var ot=t.read_shift(2);if(Ne-=2,!P.enc&&ot!==Le&&((ot&255)<<8|ot>>8)!==Le)throw new Error("rt mismatch: "+ot+"!="+Le);Ie.r==12&&(t.l+=10,Ne-=10)}var ee={};if(Le===10?ee=Ie.f(t,Ne,P):ee=fj(Le,Ie,t,Ne,P),Me==0&&[9,521,1033,2057].indexOf(be)===-1)continue;switch(Le){case 34:r.opts.Date1904=w.WBProps.date1904=ee;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(P.enc||(t.l=0),P.enc=ee,!e.password)throw new Error("File is password-protected");if(ee.valid==null)throw new Error("Encryption scheme unsupported");if(!ee.valid)throw new Error("Password is incorrect");break;case 92:P.lastuser=ee;break;case 66:var Ot=Number(ee);switch(Ot){case 21010:Ot=1200;break;case 32768:Ot=1e4;break;case 32769:Ot=1252;break}Zs(P.codepage=Ot),_e=!0;break;case 317:P.rrtabid=ee;break;case 25:P.winlocked=ee;break;case 439:r.opts.RefreshAll=ee;break;case 12:r.opts.CalcCount=ee;break;case 16:r.opts.CalcDelta=ee;break;case 17:r.opts.CalcIter=ee;break;case 13:r.opts.CalcMode=ee;break;case 14:r.opts.CalcPrecision=ee;break;case 95:r.opts.CalcSaveRecalc=ee;break;case 15:P.CalcRefMode=ee;break;case 2211:r.opts.FullCalc=ee;break;case 129:ee.fDialog&&(i["!type"]="dialog"),ee.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),ee.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:Q.push(ee);break;case 430:ie.push([ee]),ie[ie.length-1].XTI=[];break;case 35:case 547:ie[ie.length-1].push(ee);break;case 24:case 536:X={Name:ee.Name,Ref:gi(ee.rgce,a,null,ie,P)},ee.itab>0&&(X.Sheet=ee.itab-1),ie.names.push(X),ie[0]||(ie[0]=[],ie[0].XTI=[]),ie[ie.length-1].push(ee),ee.Name=="_xlnm._FilterDatabase"&&ee.itab>0&&ee.rgce&&ee.rgce[0]&&ee.rgce[0][0]&&ee.rgce[0][0][0]=="PtgArea3d"&&(ne[ee.itab-1]={ref:Nt(ee.rgce[0][0][1][2])});break;case 22:P.ExternCount=ee;break;case 23:ie.length==0&&(ie[0]=[],ie[0].XTI=[]),ie[ie.length-1].XTI=ie[ie.length-1].XTI.concat(ee),ie.XTI=ie.XTI.concat(ee);break;case 2196:if(P.biff<8)break;X!=null&&(X.Comment=ee[1]);break;case 18:i["!protect"]=ee;break;case 19:ee!==0&&P.WTF&&console.error("Password verifier: "+ee);break;case 133:s[ee.pos]=ee,P.snames.push(ee.name);break;case 10:{if(--Me)break;if(a.e){if(a.e.r>0&&a.e.c>0){if(a.e.r--,a.e.c--,i["!ref"]=Nt(a),e.sheetRows&&e.sheetRows<=a.e.r){var wt=a.e.r;a.e.r=e.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=Nt(a),a.e.r=wt}a.e.r++,a.e.c++}Xe.length>0&&(i["!merges"]=Xe),Se.length>0&&(i["!objects"]=Se),De.length>0&&(i["!cols"]=De),ke.length>0&&(i["!rows"]=ke),w.Sheets.push(F)}u===""?f=i:n[u]=i,i=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(P.biff===8&&(P.biff={9:2,521:3,1033:4}[Le]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[ee.BIFFVer]||8),P.biffguess=ee.BIFFVer==0,ee.BIFFVer==0&&ee.dt==4096&&(P.biff=5,_e=!0,Zs(P.codepage=28591)),P.biff==8&&ee.BIFFVer==0&&ee.dt==16&&(P.biff=2),Me++)break;if(i=e.dense?[]:{},P.biff<8&&!_e&&(_e=!0,Zs(P.codepage=e.codepage||1252)),P.biff<5||ee.BIFFVer==0&&ee.dt==4096){u===""&&(u="Sheet1"),a={s:{r:0,c:0},e:{r:0,c:0}};var Mt={pos:t.l-Ne,name:u};s[Mt.pos]=Mt,P.snames.push(u)}else u=(s[Te]||{name:""}).name;ee.dt==32&&(i["!type"]="chart"),ee.dt==64&&(i["!type"]="macro"),Xe=[],Se=[],P.arrayf=C=[],De=[],ke=[],Ce=!1,F={Hidden:(s[Te]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(e.dense?(i[ee.r]||[])[ee.c]:i[gt({c:ee.c,r:ee.r})])&&++ee.c,E={ixfe:ee.ixfe,XF:Q[ee.ixfe]||{},v:ee.val,t:"n"},Y>0&&(E.z=re[E.ixfe>>8&63]),Ea(E,e,r.opts.Date1904),D({c:ee.c,r:ee.r},E,e);break;case 5:case 517:E={ixfe:ee.ixfe,XF:Q[ee.ixfe],v:ee.val,t:ee.t},Y>0&&(E.z=re[E.ixfe>>8&63]),Ea(E,e,r.opts.Date1904),D({c:ee.c,r:ee.r},E,e);break;case 638:E={ixfe:ee.ixfe,XF:Q[ee.ixfe],v:ee.rknum,t:"n"},Y>0&&(E.z=re[E.ixfe>>8&63]),Ea(E,e,r.opts.Date1904),D({c:ee.c,r:ee.r},E,e);break;case 189:for(var St=ee.c;St<=ee.C;++St){var Ke=ee.rkrec[St-ee.c][0];E={ixfe:Ke,XF:Q[Ke],v:ee.rkrec[St-ee.c][1],t:"n"},Y>0&&(E.z=re[E.ixfe>>8&63]),Ea(E,e,r.opts.Date1904),D({c:St,r:ee.r},E,e)}break;case 6:case 518:case 1030:{if(ee.val=="String"){o=ee;break}if(E=$0(ee.val,ee.cell.ixfe,ee.tt),E.XF=Q[E.ixfe],e.cellFormula){var wr=ee.formula;if(wr&&wr[0]&&wr[0][0]&&wr[0][0][0]=="PtgExp"){var rn=wr[0][0][1][0],Cn=wr[0][0][1][1],Bi=gt({r:rn,c:Cn});A[Bi]?E.f=""+gi(ee.formula,a,ee.cell,ie,P):E.F=((e.dense?(i[rn]||[])[Cn]:i[Bi])||{}).F}else E.f=""+gi(ee.formula,a,ee.cell,ie,P)}Y>0&&(E.z=re[E.ixfe>>8&63]),Ea(E,e,r.opts.Date1904),D(ee.cell,E,e),o=ee}break;case 7:case 519:if(o)o.val=ee,E=$0(ee,o.cell.ixfe,"s"),E.XF=Q[E.ixfe],e.cellFormula&&(E.f=""+gi(o.formula,a,o.cell,ie,P)),Y>0&&(E.z=re[E.ixfe>>8&63]),Ea(E,e,r.opts.Date1904),D(o.cell,E,e),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{C.push(ee);var ji=gt(ee[0].s);if(m=e.dense?(i[ee[0].s.r]||[])[ee[0].s.c]:i[ji],e.cellFormula&&m){if(!o||!ji||!m)break;m.f=""+gi(ee[1],a,ee[0],ie,P),m.F=Nt(ee[0])}}break;case 1212:{if(!e.cellFormula)break;if(g){if(!o)break;A[gt(o.cell)]=ee[0],m=e.dense?(i[o.cell.r]||[])[o.cell.c]:i[gt(o.cell)],(m||{}).f=""+gi(ee[0],a,p,ie,P)}}break;case 253:E=$0(l[ee.isst].t,ee.ixfe,"s"),l[ee.isst].h&&(E.h=l[ee.isst].h),E.XF=Q[E.ixfe],Y>0&&(E.z=re[E.ixfe>>8&63]),Ea(E,e,r.opts.Date1904),D({c:ee.c,r:ee.r},E,e);break;case 513:e.sheetStubs&&(E={ixfe:ee.ixfe,XF:Q[ee.ixfe],t:"z"},Y>0&&(E.z=re[E.ixfe>>8&63]),Ea(E,e,r.opts.Date1904),D({c:ee.c,r:ee.r},E,e));break;case 190:if(e.sheetStubs)for(var Li=ee.c;Li<=ee.C;++Li){var Gr=ee.ixfe[Li-ee.c];E={ixfe:Gr,XF:Q[Gr],t:"z"},Y>0&&(E.z=re[E.ixfe>>8&63]),Ea(E,e,r.opts.Date1904),D({c:Li,r:ee.r},E,e)}break;case 214:case 516:case 4:E=$0(ee.val,ee.ixfe,"s"),E.XF=Q[E.ixfe],Y>0&&(E.z=re[E.ixfe>>8&63]),Ea(E,e,r.opts.Date1904),D({c:ee.c,r:ee.r},E,e);break;case 0:case 512:Me===1&&(a=ee);break;case 252:l=ee;break;case 1054:if(P.biff==4){re[Y++]=ee[1];for(var Ui=0;Ui<Y+163&&pt[Ui]!=ee[1];++Ui);Ui>=163&&eo(ee[1],Y+163)}else eo(ee[1],ee[0]);break;case 30:{re[Y++]=ee;for(var gr=0;gr<Y+163&&pt[gr]!=ee;++gr);gr>=163&&eo(ee,Y+163)}break;case 229:Xe=Xe.concat(ee);break;case 93:Se[ee.cmo[0]]=P.lastobj=ee;break;case 438:P.lastobj.TxO=ee;break;case 127:P.lastobj.ImData=ee;break;case 440:for(S=ee[0].s.r;S<=ee[0].e.r;++S)for(x=ee[0].s.c;x<=ee[0].e.c;++x)m=e.dense?(i[S]||[])[x]:i[gt({c:x,r:S})],m&&(m.l=ee[1]);break;case 2048:for(S=ee[0].s.r;S<=ee[0].e.r;++S)for(x=ee[0].s.c;x<=ee[0].e.c;++x)m=e.dense?(i[S]||[])[x]:i[gt({c:x,r:S})],m&&m.l&&(m.l.Tooltip=ee[1]);break;case 28:{if(P.biff<=5&&P.biff>=2)break;m=e.dense?(i[ee[0].r]||[])[ee[0].c]:i[gt(ee[0])];var Kr=Se[ee[2]];m||(e.dense?(i[ee[0].r]||(i[ee[0].r]=[]),m=i[ee[0].r][ee[0].c]={t:"z"}):m=i[gt(ee[0])]={t:"z"},a.e.r=Math.max(a.e.r,ee[0].r),a.s.r=Math.min(a.s.r,ee[0].r),a.e.c=Math.max(a.e.c,ee[0].c),a.s.c=Math.min(a.s.c,ee[0].c)),m.c||(m.c=[]),y={a:ee[1],t:Kr.TxO.t},m.c.push(y)}break;case 2173:e8(Q[ee.ixfe],ee.ext);break;case 125:{if(!P.cellStyles)break;for(;ee.e>=ee.s;)De[ee.e--]={width:ee.w/256,level:ee.level||0,hidden:!!(ee.flags&1)},Ce||(Ce=!0,fv(ee.w/256)),hl(De[ee.e+1])}break;case 520:{var Nr={};ee.level!=null&&(ke[ee.r]=Nr,Nr.level=ee.level),ee.hidden&&(ke[ee.r]=Nr,Nr.hidden=!0),ee.hpt&&(ke[ee.r]=Nr,Nr.hpt=ee.hpt,Nr.hpx=Su(ee.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||$l(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Le]]=ee;break;case 161:i["!margins"]||$l(i["!margins"]={}),i["!margins"].header=ee.header,i["!margins"].footer=ee.footer;break;case 574:ee.RTL&&(w.Views[0].RTL=!0);break;case 146:H=ee;break;case 2198:R=ee;break;case 140:O=ee;break;case 442:u?F.CodeName=ee||F.name:w.WBProps.CodeName=ee||"ThisWorkbook";break}}else Ie||console.error("Missing Info for XLS Record 0x"+Le.toString(16)),t.l+=Ne}return r.SheetNames=cn(s).sort(function(Ai,yt){return Number(Ai)-Number(yt)}).map(function(Ai){return s[Ai].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&f["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=f)):r.Preamble=f,r.Sheets&&ne.forEach(function(Ai,yt){r.Sheets[r.SheetNames[yt]]["!autofilter"]=Ai}),r.Strings=l,r.SSF=jr(pt),P.enc&&(r.Encryption=P.enc),R&&(r.Themes=R),r.Metadata={},O!==void 0&&(r.Metadata.Country=O),ie.names.length>0&&(w.Names=ie.names),r.Workbook=w,r}var Gd={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function pj(t,e,r){var n=ct.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=S_(n,px,Gd.DSI);for(var s in i)e[s]=i[s]}catch(u){if(r.WTF)throw u}var a=ct.find(t,"/!SummaryInformation");if(a&&a.size>0)try{var o=S_(a,gx,Gd.SI);for(var l in o)e[l]==null&&(e[l]=o[l])}catch(u){if(r.WTF)throw u}e.HeadingPairs&&e.TitlesOfParts&&(TA(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function gj(t,e){var r=[],n=[],i=[],s=0,a,o=J2(px,"n"),l=J2(gx,"n");if(t.Props)for(a=cn(t.Props),s=0;s<a.length;++s)(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(l,a[s])?n:i).push([a[s],t.Props[a[s]]]);if(t.Custprops)for(a=cn(t.Custprops),s=0;s<a.length;++s)Object.prototype.hasOwnProperty.call(t.Props||{},a[s])||(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(l,a[s])?n:i).push([a[s],t.Custprops[a[s]]]);var u=[];for(s=0;s<i.length;++s)NA.indexOf(i[s][0])>-1||wA.indexOf(i[s][0])>-1||i[s][1]!=null&&u.push(i[s]);n.length&&ct.utils.cfb_add(e,"/SummaryInformation",w_(n,Gd.SI,l,gx)),(r.length||u.length)&&ct.utils.cfb_add(e,"/DocumentSummaryInformation",w_(r,Gd.DSI,o,px,u.length?u:null,Gd.UDI))}function CC(t,e){e||(e={}),Ev(e),z1(),e.codepage&&V1(e.codepage);var r,n;if(t.FullPaths){if(ct.find(t,"/encryption"))throw new Error("File is password-protected");r=ct.find(t,"!CompObj"),n=ct.find(t,"/Workbook")||ct.find(t,"/Book")}else{switch(e.type){case"base64":t=us(ms(t));break;case"binary":t=us(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}ei(t,0),n={content:t}}var i,s;if(r&&uj(r),e.bookProps&&!e.bookSheets)i={};else{var a=Lt?"buffer":"array";if(n&&n.content)i=hj(n.content,e);else if((s=ct.find(t,"PerfectOffice_MAIN"))&&s.content)i=Hl.to_workbook(s.content,(e.type=a,e));else if((s=ct.find(t,"NativeContent_MAIN"))&&s.content)i=Hl.to_workbook(s.content,(e.type=a,e));else throw(s=ct.find(t,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&ct.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=F8(t))}var o={};return t.FullPaths&&pj(t,o,e),i.Props=i.Custprops=o,e.bookFiles&&(i.cfb=t),i}function mj(t,e){var r=e||{},n=ct.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return ct.utils.cfb_add(n,i,kC(t,r)),r.biff==8&&(t.Props||t.Custprops)&&gj(t,n),r.biff==8&&t.vbaraw&&b8(n,ct.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var kf={0:{f:UO},1:{f:YO},2:{f:hM},3:{f:rM},4:{f:JO},5:{f:uM},6:{f:vM},7:{f:aM},8:{f:AM},9:{f:TM},10:{f:SM},11:{f:wM},12:{f:qO},13:{f:gM},14:{f:iM},15:{f:eM},16:{f:vC},17:{f:_M},18:{f:lM},19:{f:rv},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:_B},40:{},42:{},43:{f:vP},44:{f:mP},45:{f:EP},46:{f:wP},47:{f:SP},48:{},49:{f:WR},50:{},51:{f:n8},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:zA},62:{f:xM},63:{f:f8},64:{f:VM},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Si,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:BM},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:GO},148:{f:WO,p:16},151:{f:NM},152:{},153:{f:xB},154:{},155:{},156:{f:gB},157:{},158:{},159:{T:1,f:D6},160:{T:-1},161:{T:1,f:mc},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:CM},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:t8},336:{T:-1},337:{f:a8,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:hx},357:{},358:{},359:{},360:{T:1},361:{},362:{f:VA},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:RM},427:{f:DM},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:OM},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:$O},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:bM},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:hx},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:w8},633:{T:1},634:{T:-1},635:{T:1,f:E8},636:{T:-1},637:{f:KR},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:iB},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:zM},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Ex={6:{f:Xg},10:{f:Do},12:{f:Tn},13:{f:Tn},14:{f:fn},15:{f:fn},16:{f:yi},17:{f:fn},18:{f:fn},19:{f:Tn},20:{f:b_},21:{f:b_},23:{f:VA},24:{f:N_},25:{f:fn},26:{},27:{},28:{f:z3},29:{},34:{f:fn},35:{f:I_},38:{f:yi},39:{f:yi},40:{f:yi},41:{f:yi},42:{f:fn},43:{f:fn},47:{f:eP},49:{f:g3},51:{f:Tn},60:{},61:{f:u3},64:{f:fn},65:{f:p3},66:{f:Tn},77:{},80:{},81:{},82:{},85:{f:Tn},89:{},90:{},91:{},92:{f:ZD},93:{f:$3},94:{},95:{f:fn},96:{},97:{},99:{f:fn},125:{f:zA},128:{f:I3},129:{f:t3},130:{f:Tn},131:{f:fn},132:{f:fn},133:{f:r3},134:{},140:{f:Z3},141:{f:Tn},144:{},146:{f:r6},151:{},152:{},153:{},154:{},155:{},156:{f:Tn},157:{},158:{},160:{f:c6},161:{f:s6},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:C3},190:{f:k3},193:{f:Do},197:{},198:{},199:{},200:{},201:{},202:{f:fn},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Tn},220:{},221:{f:fn},222:{},224:{f:b3},225:{f:JD},226:{f:Do},227:{},229:{f:W3},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:i3},253:{f:x3},255:{f:a3},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:RA},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:fn},353:{f:Do},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:O3},431:{f:fn},432:{},433:{},434:{},437:{},438:{f:Y3},439:{f:fn},440:{f:X3},441:{},442:{f:Yf},443:{},444:{f:Tn},445:{},446:{},448:{f:Do},449:{f:c3,r:2},450:{f:Do},512:{f:C_},513:{f:l6},515:{f:D3},516:{f:y3},517:{f:F_},519:{f:u6},520:{f:o3},523:{},545:{f:R_},549:{f:A_},566:{},574:{f:f3},638:{f:A3},659:{},1048:{},1054:{f:E3},1084:{},1212:{f:L3},2048:{f:Q3},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:z0},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Do},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:n6,r:12},2173:{f:ZP,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:fn,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:j3,r:12},2197:{},2198:{f:KP,r:12},2199:{},2200:{},2201:{},2202:{f:U3,r:12},2203:{f:Do},2204:{},2205:{},2206:{},2207:{},2211:{f:l3},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Tn},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:a6},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:t6},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:C_},1:{},2:{f:g6},3:{f:h6},4:{f:f6},5:{f:F_},7:{f:x6},8:{},9:{f:z0},11:{},22:{f:Tn},30:{f:w3},31:{},32:{},33:{f:R_},36:{},37:{f:A_},50:{f:v6},62:{},52:{},67:{},68:{f:Tn},69:{},86:{},126:{},127:{f:d6},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:y6},223:{},234:{},354:{},421:{},518:{f:Xg},521:{f:z0},536:{f:N_},547:{f:I_},561:{},579:{},1030:{f:Xg},1033:{f:z0},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Ge(t,e,r,n){var i=e;if(!isNaN(i)){var s=n||(r||[]).length||0,a=t.next(4);a.write_shift(2,i),a.write_shift(2,s),s>0&&Z1(r)&&t.push(r)}}function xj(t,e,r,n){var i=(r||[]).length||0;if(i<=8224)return Ge(t,e,r,i);var s=e;if(!isNaN(s)){for(var a=r.parts||[],o=0,l=0,u=0;u+(a[o]||8224)<=8224;)u+=a[o]||8224,o++;var f=t.next(4);for(f.write_shift(2,s),f.write_shift(2,u),t.push(r.slice(l,l+u)),l+=u;l<i;){for(f=t.next(4),f.write_shift(2,60),u=0;u+(a[o]||8224)<=8224;)u+=a[o]||8224,o++;f.write_shift(2,u),t.push(r.slice(l,l+u)),l+=u}}}function Jf(t,e,r){return t||(t=Ee(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function vj(t,e,r,n){var i=Ee(9);return Jf(i,t,e),DA(r,n||"b",i),i}function yj(t,e,r){var n=Ee(8+2*r.length);return Jf(n,t,e),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function _j(t,e,r,n){if(e.v!=null)switch(e.t){case"d":case"n":var i=e.t=="d"?Mn(Br(e.v)):e.v;i==(i|0)&&i>=0&&i<65536?Ge(t,2,m6(r,n,i)):Ge(t,3,p6(r,n,i));return;case"b":case"e":Ge(t,5,vj(r,n,e.v,e.t));return;case"s":case"str":Ge(t,4,yj(r,n,(e.v||"").slice(0,255)));return}Ge(t,1,Jf(null,r,n))}function Ej(t,e,r,n){var i=Array.isArray(e),s=ir(e["!ref"]||"A1"),a,o="",l=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),a=Nt(s)}for(var u=s.s.r;u<=s.e.r;++u){o=gn(u);for(var f=s.s.c;f<=s.e.c;++f){u===s.s.r&&(l[f]=Qr(f)),a=l[f]+o;var p=i?(e[u]||[])[f]:e[a];p&&_j(t,p,u,f)}}}function Sj(t,e){for(var r=e||{},n=Ji(),i=0,s=0;s<t.SheetNames.length;++s)t.SheetNames[s]==r.sheet&&(i=s);if(i==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Ge(n,r.biff==4?1033:r.biff==3?521:9,cv(t,16,r)),Ej(n,t.Sheets[t.SheetNames[i]],i,r),Ge(n,10),n.end()}function wj(t,e,r){Ge(t,49,m3({sz:12,name:"Arial"},r))}function Tj(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&Ge(t,1054,S3(i,e[i],r))})}function Aj(t,e){var r=Ee(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Ge(t,2151,r),r=Ee(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),jA(ir(e["!ref"]||"A1"),r),r.write_shift(4,4),Ge(t,2152,r)}function Cj(t,e){for(var r=0;r<16;++r)Ge(t,224,k_({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){Ge(t,224,k_(n,0,e))})}function kj(t,e){for(var r=0;r<e["!links"].length;++r){var n=e["!links"][r];Ge(t,440,q3(n)),n[1].Tooltip&&Ge(t,2048,J3(n))}delete e["!links"]}function Fj(t,e){if(e){var r=0;e.forEach(function(n,i){++r<=256&&n&&Ge(t,125,i6(qp(i,n),i))})}}function bj(t,e,r,n,i){var s=16+Tl(i.cellXfs,e,i);if(e.v==null&&!e.bf){Ge(t,513,nc(r,n,s));return}if(e.bf)Ge(t,6,tO(e,r,n,i,s));else switch(e.t){case"d":case"n":var a=e.t=="d"?Mn(Br(e.v)):e.v;Ge(t,515,P3(r,n,a,s));break;case"b":case"e":Ge(t,517,R3(r,n,e.v,s,i,e.t));break;case"s":case"str":if(i.bookSST){var o=xv(i.Strings,e.v,i.revStrings);Ge(t,253,v3(r,n,o,s))}else Ge(t,516,_3(r,n,(e.v||"").slice(0,255),s,i));break;default:Ge(t,513,nc(r,n,s))}}function Ij(t,e,r){var n=Ji(),i=r.SheetNames[t],s=r.Sheets[i]||{},a=(r||{}).Workbook||{},o=(a.Sheets||[])[t]||{},l=Array.isArray(s),u=e.biff==8,f,p="",g=[],m=ir(s["!ref"]||"A1"),y=u?65536:16384;if(m.e.c>255||m.e.r>=y){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");m.e.c=Math.min(m.e.c,255),m.e.r=Math.min(m.e.c,y-1)}Ge(n,2057,cv(r,16,e)),Ge(n,13,Is(1)),Ge(n,12,Is(100)),Ge(n,15,Ri(!0)),Ge(n,17,Ri(!1)),Ge(n,16,tc(.001)),Ge(n,95,Ri(!0)),Ge(n,42,Ri(!1)),Ge(n,43,Ri(!1)),Ge(n,130,Is(1)),Ge(n,128,N3()),Ge(n,131,Ri(!1)),Ge(n,132,Ri(!1)),u&&Fj(n,s["!cols"]),Ge(n,512,T3(m,e)),u&&(s["!links"]=[]);for(var x=m.s.r;x<=m.e.r;++x){p=gn(x);for(var S=m.s.c;S<=m.e.c;++S){x===m.s.r&&(g[S]=Qr(S)),f=g[S]+p;var A=l?(s[x]||[])[S]:s[f];A&&(bj(n,A,x,S,e),u&&A.l&&s["!links"].push([f,A.l]))}}var C=o.CodeName||o.name||i;return u&&Ge(n,574,h3((a.Views||[])[0])),u&&(s["!merges"]||[]).length&&Ge(n,229,H3(s["!merges"])),u&&kj(n,s),Ge(n,442,PA(C)),u&&Aj(n,s),Ge(n,10),n.end()}function Nj(t,e,r){var n=Ji(),i=(t||{}).Workbook||{},s=i.Sheets||[],a=i.WBProps||{},o=r.biff==8,l=r.biff==5;if(Ge(n,2057,cv(t,5,r)),r.bookType=="xla"&&Ge(n,135),Ge(n,225,o?Is(1200):null),Ge(n,193,RD(2)),l&&Ge(n,191),l&&Ge(n,192),Ge(n,226),Ge(n,92,e3("SheetJS",r)),Ge(n,66,Is(o?1200:1252)),o&&Ge(n,353,Is(0)),o&&Ge(n,448),Ge(n,317,o6(t.SheetNames.length)),o&&t.vbaraw&&Ge(n,211),o&&t.vbaraw){var u=a.CodeName||"ThisWorkbook";Ge(n,442,PA(u))}Ge(n,156,Is(17)),Ge(n,25,Ri(!1)),Ge(n,18,Ri(!1)),Ge(n,19,Is(0)),o&&Ge(n,431,Ri(!1)),o&&Ge(n,444,Is(0)),Ge(n,61,d3()),Ge(n,64,Ri(!1)),Ge(n,141,Is(0)),Ge(n,34,Ri(cB(t)=="true")),Ge(n,14,Ri(!0)),o&&Ge(n,439,Ri(!1)),Ge(n,218,Is(0)),wj(n,t,r),Tj(n,t.SSF,r),Cj(n,r),o&&Ge(n,352,Ri(!1));var f=n.end(),p=Ji();o&&Ge(p,140,e6()),o&&r.Strings&&xj(p,252,s3(r.Strings)),Ge(p,10);var g=p.end(),m=Ji(),y=0,x=0;for(x=0;x<t.SheetNames.length;++x)y+=(o?12:11)+(o?2:1)*t.SheetNames[x].length;var S=f.length+y+g.length;for(x=0;x<t.SheetNames.length;++x){var A=s[x]||{};Ge(m,133,n3({pos:S,hs:A.Hidden||0,dt:0,name:t.SheetNames[x]},r)),S+=e[x].length}var C=m.end();if(y!=C.length)throw new Error("BS8 "+y+" != "+C.length);var E=[];return f.length&&E.push(f),C.length&&E.push(C),g.length&&E.push(g),Hn(E)}function Rj(t,e){var r=e||{},n=[];t&&!t.SSF&&(t.SSF=jr(pt)),t&&t.SSF&&(Mu(),Wp(t.SSF),r.revssf=$p(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Sv(r),r.cellXfs=[],Tl(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var i=0;i<t.SheetNames.length;++i)n[n.length]=Ij(i,r,t);return n.unshift(Nj(t,n,r)),Hn(n)}function kC(t,e){for(var r=0;r<=t.SheetNames.length;++r){var n=t.Sheets[t.SheetNames[r]];if(!(!n||!n["!ref"])){var i=Zi(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=e||{};switch(s.biff||2){case 8:case 5:return Rj(t,e);case 4:case 3:case 2:return Sj(t,e)}throw new Error("invalid type "+s.bookType+" for BIFF")}function z_(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var i=t.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var s=t.match(/<\/table/i),a=i.index,o=s&&s.index||t.length,l=mR(t.slice(a,o),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,f=0,p=0,g=0,m={s:{r:1e7,c:1e7},e:{r:0,c:0}},y=[];for(a=0;a<l.length;++a){var x=l[a].trim(),S=x.slice(0,3).toLowerCase();if(S=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}f=0;continue}if(!(S!="<td"&&S!="<th")){var A=x.split(/<\/t[dh]>/i);for(o=0;o<A.length;++o){var C=A[o].trim();if(C.match(/<t[dh]/i)){for(var E=C,O=0;E.charAt(0)=="<"&&(O=E.indexOf(">"))>-1;)E=E.slice(O+1);for(var Q=0;Q<y.length;++Q){var H=y[Q];H.s.c==f&&H.s.r<u&&u<=H.e.r&&(f=H.e.c+1,Q=-1)}var w=xt(C.slice(0,C.indexOf(">")));g=w.colspan?+w.colspan:1,((p=+w.rowspan)>1||g>1)&&y.push({s:{r:u,c:f},e:{r:u+(p||1)-1,c:f+g-1}});var F=w.t||w["data-t"]||"";if(!E.length){f+=g;continue}if(E=QT(E),m.s.r>u&&(m.s.r=u),m.e.r<u&&(m.e.r=u),m.s.c>f&&(m.s.c=f),m.e.c<f&&(m.e.c=f),!E.length){f+=g;continue}var T={t:"s",v:E};r.raw||!E.trim().length||F=="s"||(E==="TRUE"?T={t:"b",v:!0}:E==="FALSE"?T={t:"b",v:!1}:isNaN(ia(E))?isNaN(_u(E).getDate())||(T={t:"d",v:Br(E)},r.cellDates||(T={t:"n",v:Mn(T.v)}),T.z=r.dateNF||pt[14]):T={t:"n",v:ia(E)}),r.dense?(n[u]||(n[u]=[]),n[u][f]=T):n[gt({r:u,c:f})]=T,f+=g}}}}return n["!ref"]=Nt(m),y.length&&(n["!merges"]=y),n}function Dj(t,e,r,n){for(var i=t["!merges"]||[],s=[],a=e.s.c;a<=e.e.c;++a){for(var o=0,l=0,u=0;u<i.length;++u)if(!(i[u].s.r>r||i[u].s.c>a)&&!(i[u].e.r<r||i[u].e.c<a)){if(i[u].s.r<r||i[u].s.c<a){o=-1;break}o=i[u].e.r-i[u].s.r+1,l=i[u].e.c-i[u].s.c+1;break}if(!(o<0)){var f=gt({r,c:a}),p=n.dense?(t[r]||[])[a]:t[f],g=p&&p.v!=null&&(p.h||q1(p.w||(oo(p),p.w)||""))||"",m={};o>1&&(m.rowspan=o),l>1&&(m.colspan=l),n.editable?g='<span contenteditable="true">'+g+"</span>":p&&(m["data-t"]=p&&p.t||"z",p.v!=null&&(m["data-v"]=p.v),p.z!=null&&(m["data-z"]=p.z),p.l&&(p.l.Target||"#").charAt(0)!="#"&&(g='<a href="'+p.l.Target+'">'+g+"</a>")),m.id=(n.id||"sjs")+"-"+f,s.push($e("td",g,m))}}var y="<tr>";return y+s.join("")+"</tr>"}var Pj='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',Oj="</body></html>";function Mj(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return wl(z_(r[0],e),e);var n=Av();return r.forEach(function(i,s){Cv(n,z_(i,e),"Sheet"+(s+1))}),n}function Bj(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function FC(t,e){var r=e||{},n=r.header!=null?r.header:Pj,i=r.footer!=null?r.footer:Oj,s=[n],a=Zi(t["!ref"]);r.dense=Array.isArray(t),s.push(Bj(t,a,r));for(var o=a.s.r;o<=a.e.r;++o)s.push(Dj(t,a,o,r));return s.push("</table>"+i),s.join("")}function bC(t,e,r){var n=r||{},i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var a=typeof n.origin=="string"?Jr(n.origin):n.origin;i=a.r,s=a.c}var o=e.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),u={s:{r:0,c:0},e:{r:i,c:s}};if(t["!ref"]){var f=Zi(t["!ref"]);u.s.r=Math.min(u.s.r,f.s.r),u.s.c=Math.min(u.s.c,f.s.c),u.e.r=Math.max(u.e.r,f.e.r),u.e.c=Math.max(u.e.c,f.e.c),i==-1&&(u.e.r=i=f.e.r+1)}var p=[],g=0,m=t["!rows"]||(t["!rows"]=[]),y=0,x=0,S=0,A=0,C=0,E=0;for(t["!cols"]||(t["!cols"]=[]);y<o.length&&x<l;++y){var O=o[y];if(W_(O)){if(n.display)continue;m[x]={hidden:!0}}var Q=O.children;for(S=A=0;S<Q.length;++S){var H=Q[S];if(!(n.display&&W_(H))){var w=H.hasAttribute("data-v")?H.getAttribute("data-v"):H.hasAttribute("v")?H.getAttribute("v"):QT(H.innerHTML),F=H.getAttribute("data-z")||H.getAttribute("z");for(g=0;g<p.length;++g){var T=p[g];T.s.c==A+s&&T.s.r<x+i&&x+i<=T.e.r&&(A=T.e.c+1-s,g=-1)}E=+H.getAttribute("colspan")||1,((C=+H.getAttribute("rowspan")||1)>1||E>1)&&p.push({s:{r:x+i,c:A+s},e:{r:x+i+(C||1)-1,c:A+s+(E||1)-1}});var N={t:"s",v:w},D=H.getAttribute("data-t")||H.getAttribute("t")||"";w!=null&&(w.length==0?N.t=D||"z":n.raw||w.trim().length==0||D=="s"||(w==="TRUE"?N={t:"b",v:!0}:w==="FALSE"?N={t:"b",v:!1}:isNaN(ia(w))?isNaN(_u(w).getDate())||(N={t:"d",v:Br(w)},n.cellDates||(N={t:"n",v:Mn(N.v)}),N.z=n.dateNF||pt[14]):N={t:"n",v:ia(w)})),N.z===void 0&&F!=null&&(N.z=F);var P="",R=H.getElementsByTagName("A");if(R&&R.length)for(var Xe=0;Xe<R.length&&!(R[Xe].hasAttribute("href")&&(P=R[Xe].getAttribute("href"),P.charAt(0)!="#"));++Xe);P&&P.charAt(0)!="#"&&(N.l={Target:P}),n.dense?(t[x+i]||(t[x+i]=[]),t[x+i][A+s]=N):t[gt({c:A+s,r:x+i})]=N,u.e.c<A+s&&(u.e.c=A+s),A+=E}}++x}return p.length&&(t["!merges"]=(t["!merges"]||[]).concat(p)),u.e.r=Math.max(u.e.r,x-1+i),t["!ref"]=Nt(u),x>=l&&(t["!fullref"]=Nt((u.e.r=o.length-y+x-1+i,u))),t}function IC(t,e){var r=e||{},n=r.dense?[]:{};return bC(n,t,e)}function jj(t,e){return wl(IC(t,e),e)}function W_(t){var e="",r=Lj(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function Lj(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function Uj(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=nr(e.replace(/<[^>]*>/g,""));return[r]}var H_={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function NC(t,e){var r=e||{},n=Q1(t),i=[],s,a,o={name:""},l="",u=0,f,p,g={},m=[],y=r.dense?[]:{},x,S,A={value:""},C="",E=0,O=[],Q=-1,H=-1,w={s:{r:1e6,c:1e7},e:{r:0,c:0}},F=0,T={},N=[],D={},P=0,R=0,Xe=[],Se=1,De=1,ke=[],Ce={Names:[]},ie={},be=["",""],Me=[],Y={},re="",ne=0,X=!1,_e=!1,Te=0;for(Ef.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");x=Ef.exec(n);)switch(x[3]=x[3].replace(/_.*$/,"")){case"table":case"":x[1]==="/"?(w.e.c>=w.s.c&&w.e.r>=w.s.r?y["!ref"]=Nt(w):y["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=w.e.r&&(y["!fullref"]=y["!ref"],w.e.r=r.sheetRows-1,y["!ref"]=Nt(w)),N.length&&(y["!merges"]=N),Xe.length&&(y["!rows"]=Xe),f.name=f.||f.name,typeof JSON<"u"&&JSON.stringify(f),m.push(f.name),g[f.name]=y,_e=!1):x[0].charAt(x[0].length-2)!=="/"&&(f=xt(x[0],!1),Q=H=-1,w.s.r=w.s.c=1e7,w.e.r=w.e.c=0,y=r.dense?[]:{},N=[],Xe=[],_e=!0);break;case"table-row-group":x[1]==="/"?--F:++F;break;case"table-row":case"":if(x[1]==="/"){Q+=Se,Se=1;break}if(p=xt(x[0],!1),p.?Q=p.-1:Q==-1&&(Q=0),Se=+p["number-rows-repeated"]||1,Se<10)for(Te=0;Te<Se;++Te)F>0&&(Xe[Q+Te]={level:F});H=-1;break;case"covered-table-cell":x[1]!=="/"&&++H,r.sheetStubs&&(r.dense?(y[Q]||(y[Q]=[]),y[Q][H]={t:"z"}):y[gt({r:Q,c:H})]={t:"z"}),C="",O=[];break;case"table-cell":case"":if(x[0].charAt(x[0].length-2)==="/")++H,A=xt(x[0],!1),De=parseInt(A["number-columns-repeated"]||"1",10),S={t:"z",v:null},A.formula&&r.cellFormula!=!1&&(S.f=L_(nr(A.formula))),(A.||A["value-type"])=="string"&&(S.t="s",S.v=nr(A["string-value"]||""),r.dense?(y[Q]||(y[Q]=[]),y[Q][H]=S):y[gt({r:Q,c:H})]=S),H+=De-1;else if(x[1]!=="/"){++H,C="",E=0,O=[],De=1;var Le=Se?Q+Se-1:Q;if(H>w.e.c&&(w.e.c=H),H<w.s.c&&(w.s.c=H),Q<w.s.r&&(w.s.r=Q),Le>w.e.r&&(w.e.r=Le),A=xt(x[0],!1),Me=[],Y={},S={t:A.||A["value-type"],v:null},r.cellFormula)if(A.formula&&(A.formula=nr(A.formula)),A["number-matrix-columns-spanned"]&&A["number-matrix-rows-spanned"]&&(P=parseInt(A["number-matrix-rows-spanned"],10)||0,R=parseInt(A["number-matrix-columns-spanned"],10)||0,D={s:{r:Q,c:H},e:{r:Q+P-1,c:H+R-1}},S.F=Nt(D),ke.push([D,S.F])),A.formula)S.f=L_(A.formula);else for(Te=0;Te<ke.length;++Te)Q>=ke[Te][0].s.r&&Q<=ke[Te][0].e.r&&H>=ke[Te][0].s.c&&H<=ke[Te][0].e.c&&(S.F=ke[Te][1]);switch((A["number-columns-spanned"]||A["number-rows-spanned"])&&(P=parseInt(A["number-rows-spanned"],10)||0,R=parseInt(A["number-columns-spanned"],10)||0,D={s:{r:Q,c:H},e:{r:Q+P-1,c:H+R-1}},N.push(D)),A["number-columns-repeated"]&&(De=parseInt(A["number-columns-repeated"],10)),S.t){case"boolean":S.t="b",S.v=Or(A["boolean-value"]);break;case"float":S.t="n",S.v=parseFloat(A.value);break;case"percentage":S.t="n",S.v=parseFloat(A.value);break;case"currency":S.t="n",S.v=parseFloat(A.value);break;case"date":S.t="d",S.v=Br(A["date-value"]),r.cellDates||(S.t="n",S.v=Mn(S.v)),S.z="m/d/yy";break;case"time":S.t="n",S.v=hR(A["time-value"])/86400,r.cellDates&&(S.t="d",S.v=Gp(S.v)),S.z="HH:MM:SS";break;case"number":S.t="n",S.v=parseFloat(A.);break;default:if(S.t==="string"||S.t==="text"||!S.t)S.t="s",A["string-value"]!=null&&(C=nr(A["string-value"]),O=[]);else throw new Error("Unsupported value type "+S.t)}}else{if(X=!1,S.t==="s"&&(S.v=C||"",O.length&&(S.R=O),X=E==0),ie.Target&&(S.l=ie),Me.length>0&&(S.c=Me,Me=[]),C&&r.cellText!==!1&&(S.w=C),X&&(S.t="z",delete S.v),(!X||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=Q))for(var Ne=0;Ne<Se;++Ne){if(De=parseInt(A["number-columns-repeated"]||"1",10),r.dense)for(y[Q+Ne]||(y[Q+Ne]=[]),y[Q+Ne][H]=Ne==0?S:jr(S);--De>0;)y[Q+Ne][H+De]=jr(S);else for(y[gt({r:Q+Ne,c:H})]=S;--De>0;)y[gt({r:Q+Ne,c:H+De})]=jr(S);w.e.c<=H&&(w.e.c=H)}De=parseInt(A["number-columns-repeated"]||"1",10),H+=De-1,De=0,S={},C="",O=[]}ie={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(x[1]==="/"){if((s=i.pop())[0]!==x[3])throw"Bad state: "+s}else x[0].charAt(x[0].length-2)!=="/"&&i.push([x[3],!0]);break;case"annotation":if(x[1]==="/"){if((s=i.pop())[0]!==x[3])throw"Bad state: "+s;Y.t=C,O.length&&(Y.R=O),Y.a=re,Me.push(Y)}else x[0].charAt(x[0].length-2)!=="/"&&i.push([x[3],!1]);re="",ne=0,C="",E=0,O=[];break;case"creator":x[1]==="/"?re=n.slice(ne,x.index):ne=x.index+x[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(x[1]==="/"){if((s=i.pop())[0]!==x[3])throw"Bad state: "+s}else x[0].charAt(x[0].length-2)!=="/"&&i.push([x[3],!1]);C="",E=0,O=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(x[1]==="/"){if(T[o.name]=l,(s=i.pop())[0]!==x[3])throw"Bad state: "+s}else x[0].charAt(x[0].length-2)!=="/"&&(l="",o=xt(x[0],!1),i.push([x[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":a=xt(x[0],!1),l+=H_[x[3]][a.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":a=xt(x[0],!1),l+=H_[x[3]][a.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(x[0].slice(-2)==="/>")break;if(x[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(u,x.index);break}else u=x.index+x[0].length;break;case"named-range":a=xt(x[0],!1),be=qg(a["cell-range-address"]);var Ie={Name:a.name,Ref:be[0]+"!"+be[1]};_e&&(Ie.Sheet=m.length),Ce.Names.push(Ie);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(x[1]==="/"&&(!A||!A["string-value"])){var ot=Uj(n.slice(E,x.index));C=(C.length>0?C+`
`:"")+ot[0]}else xt(x[0],!1),E=x.index+x[0].length;break;case"s":break;case"database-range":if(x[1]==="/")break;try{be=qg(xt(x[0])["target-range-address"]),g[be[0]]["!autofilter"]={ref:be[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(x[1]!=="/"){if(ie=xt(x[0],!1),!ie.href)break;ie.Target=nr(ie.href),delete ie.href,ie.Target.charAt(0)=="#"&&ie.Target.indexOf(".")>-1?(be=qg(ie.Target.slice(1)),ie.Target="#"+be[0]+"!"+be[1]):ie.Target.match(/^\.\.[\\\/]/)&&(ie.Target=ie.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(x[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(x)}}var ee={Sheets:g,SheetNames:m,Workbook:Ce};return r.bookSheets&&delete ee.Sheets,ee}function $_(t,e){e=e||{},bs(t,"META-INF/manifest.xml")&&hD(wn(t,"META-INF/manifest.xml"),e);var r=ds(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=NC(Tr(r),e);return bs(t,"meta.xml")&&(n.Props=EA(wn(t,"meta.xml"))),n}function G_(t,e){return NC(t,e)}var Vj=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+_f({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return mn+e}}(),K_=function(){var t=function(s){return _r(s).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,a,o){var l=[];l.push('      <table:table table:name="'+_r(a.SheetNames[o])+`" table:style-name="ta1">
`);var u=0,f=0,p=Zi(s["!ref"]||"A1"),g=s["!merges"]||[],m=0,y=Array.isArray(s);if(s["!cols"])for(f=0;f<=p.e.c;++f)l.push("        <table:table-column"+(s["!cols"][f]?' table:style-name="co'+s["!cols"][f].ods+'"':"")+`></table:table-column>
`);var x="",S=s["!rows"]||[];for(u=0;u<p.s.r;++u)x=S[u]?' table:style-name="ro'+S[u].ods+'"':"",l.push("        <table:table-row"+x+`></table:table-row>
`);for(;u<=p.e.r;++u){for(x=S[u]?' table:style-name="ro'+S[u].ods+'"':"",l.push("        <table:table-row"+x+`>
`),f=0;f<p.s.c;++f)l.push(e);for(;f<=p.e.c;++f){var A=!1,C={},E="";for(m=0;m!=g.length;++m)if(!(g[m].s.c>f)&&!(g[m].s.r>u)&&!(g[m].e.c<f)&&!(g[m].e.r<u)){(g[m].s.c!=f||g[m].s.r!=u)&&(A=!0),C["table:number-columns-spanned"]=g[m].e.c-g[m].s.c+1,C["table:number-rows-spanned"]=g[m].e.r-g[m].s.r+1;break}if(A){l.push(r);continue}var O=gt({r:u,c:f}),Q=y?(s[u]||[])[f]:s[O];if(Q&&Q.f&&(C["table:formula"]=_r(oO(Q.f)),Q.F&&Q.F.slice(0,O.length)==O)){var H=Zi(Q.F);C["table:number-matrix-columns-spanned"]=H.e.c-H.s.c+1,C["table:number-matrix-rows-spanned"]=H.e.r-H.s.r+1}if(!Q){l.push(e);continue}switch(Q.t){case"b":E=Q.v?"TRUE":"FALSE",C["office:value-type"]="boolean",C["office:boolean-value"]=Q.v?"true":"false";break;case"n":E=Q.w||String(Q.v||0),C["office:value-type"]="float",C["office:value"]=Q.v||0;break;case"s":case"str":E=Q.v==null?"":Q.v,C["office:value-type"]="string";break;case"d":E=Q.w||Br(Q.v).toISOString(),C["office:value-type"]="date",C["office:date-value"]=Br(Q.v).toISOString(),C["table:style-name"]="ce1";break;default:l.push(e);continue}var w=t(E);if(Q.l&&Q.l.Target){var F=Q.l.Target;F=F.charAt(0)=="#"?"#"+lO(F.slice(1)):F,F.charAt(0)!="#"&&!F.match(/^\w+:/)&&(F="../"+F),w=$e("text:a",w,{"xlink:href":F.replace(/&/g,"&amp;")})}l.push("          "+$e("table:table-cell",$e("text:p",w,{}),C)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},i=function(s,a){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;a.SheetNames.map(function(u){return a.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var f=0;f<u["!cols"].length;++f)if(u["!cols"][f]){var p=u["!cols"][f];if(p.width==null&&p.wpx==null&&p.wch==null)continue;hl(p),p.ods=o;var g=u["!cols"][f].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+g+`"/>
`),s.push(`  </style:style>
`),++o}}});var l=0;a.SheetNames.map(function(u){return a.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var f=0;f<u["!rows"].length;++f)if(u["!rows"][f]){u["!rows"][f].ods=l;var p=u["!rows"][f].hpx+"px";s.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+p+`"/>
`),s.push(`  </style:style>
`),++l}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(a,o){var l=[mn],u=_f({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),f=_f({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+u+f+`>
`),l.push(_A().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+u+`>
`),i(l,a),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var p=0;p!=a.SheetNames.length;++p)l.push(n(a.Sheets[a.SheetNames[p]],a,p));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function RC(t,e){if(e.bookType=="fods")return K_(t,e);var r=K1(),n="",i=[],s=[];return n="mimetype",Rt(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Rt(r,n,K_(t,e)),i.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",Rt(r,n,Vj(t,e)),i.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",Rt(r,n,mn+_A()),i.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",Rt(r,n,mD(s)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Rt(r,n,pD(i)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function ic(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Sx(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):Tr(Sl(t))}function zj(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):us(ka(t))}function Wj(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var n=0;n<e.length;++n)if(t[r+n]!=e[n])continue e;return!0}return!1}function gl(t){var e=t.reduce(function(i,s){return i+s.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(i){r.set(i,n),n+=i.length}),r}function Y_(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function Hj(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,i=e+13;i>=e;--i)n=n*256+t[i];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function $j(t,e,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,n-6176);t[e+15]|=n>>7,t[e+14]|=(n&127)<<1;for(var s=0;i>=1;++s,i/=256)t[e+s]=i&255;t[e+15]|=r>=0?0:128}function Ff(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function vr(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function ln(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function lr(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],i=Ff(t,r),s=i&7;i=Math.floor(i/8);var a=0,o;if(i==0)break;switch(s){case 0:{for(var l=r[0];t[r[0]++]>=128;);o=t.slice(l,r[0])}break;case 5:a=4,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 1:a=8,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 2:a=Ff(t,r),o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var u={data:o,type:s};e[i]==null?e[i]=[u]:e[i].push(u)}return e}function Qn(t){var e=[];return t.forEach(function(r,n){r.forEach(function(i){i.data&&(e.push(vr(n*8+i.type)),i.type==2&&e.push(vr(i.data.length)),e.push(i.data))})}),gl(e)}function _v(t,e){return(t==null?void 0:t.map(function(r){return e(r.data)}))||[]}function ks(t){for(var e,r=[],n=[0];n[0]<t.length;){var i=Ff(t,n),s=lr(t.slice(n[0],n[0]+i));n[0]+=i;var a={id:ln(s[1][0].data),messages:[]};s[2].forEach(function(o){var l=lr(o.data),u=ln(l[3][0].data);a.messages.push({meta:l,data:t.slice(n[0],n[0]+u)}),n[0]+=u}),(e=s[3])!=null&&e[0]&&(a.merge=ln(s[3][0].data)>>>0>0),r.push(a)}return r}function Nc(t){var e=[];return t.forEach(function(r){var n=[];n[1]=[{data:vr(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:vr(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(a){i.push(a.data),a.meta[3]=[{type:0,data:vr(a.data.length)}],n[2].push({data:Qn(a.meta),type:2})});var s=Qn(n);e.push(vr(s.length)),e.push(s),i.forEach(function(a){return e.push(a)})}),gl(e)}function Gj(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=Ff(e,r),i=[];r[0]<e.length;){var s=e[r[0]]&3;if(s==0){var a=e[r[0]++]>>2;if(a<60)++a;else{var o=a-59;a=e[r[0]],o>1&&(a|=e[r[0]+1]<<8),o>2&&(a|=e[r[0]+2]<<16),o>3&&(a|=e[r[0]+3]<<24),a>>>=0,a++,r[0]+=o}i.push(e.slice(r[0],r[0]+a)),r[0]+=a;continue}else{var l=0,u=0;if(s==1?(u=(e[r[0]]>>2&7)+4,l=(e[r[0]++]&224)<<3,l|=e[r[0]++]):(u=(e[r[0]++]>>2)+1,s==2?(l=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(l=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),i=[gl(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(u>=l)for(i.push(i[0].slice(-l)),u-=l;u>=i[i.length-1].length;)i.push(i[i.length-1]),u-=i[i.length-1].length;i.push(i[0].slice(-l,-l+u))}}var f=gl(i);if(f.length!=n)throw new Error("Unexpected length: ".concat(f.length," != ").concat(n));return f}function Fs(t){for(var e=[],r=0;r<t.length;){var n=t[r++],i=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(Gj(n,t.slice(r,r+i))),r+=i}if(r!==t.length)throw new Error("data is not a valid framed stream!");return gl(e)}function Rc(t){for(var e=[],r=0;r<t.length;){var n=Math.min(t.length-r,268435455),i=new Uint8Array(4);e.push(i);var s=vr(n),a=s.length;e.push(s),n<=60?(a++,e.push(new Uint8Array([n-1<<2]))):n<=256?(a+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(a+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(a+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(a+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(t.slice(r,r+n)),a+=n,i[0]=0,i[1]=a&255,i[2]=a>>8&255,i[3]=a>>16&255,r+=n}return gl(e)}function Kj(t,e,r,n){var i=ic(t),s=i.getUint32(4,!0),a=(n>1?12:8)+Y_(s&(n>1?3470:398))*4,o=-1,l=-1,u=NaN,f=new Date(2001,0,1);s&512&&(o=i.getUint32(a,!0),a+=4),a+=Y_(s&(n>1?12288:4096))*4,s&16&&(l=i.getUint32(a,!0),a+=4),s&32&&(u=i.getFloat64(a,!0),a+=8),s&64&&(f.setTime(f.getTime()+i.getFloat64(a,!0)*1e3),a+=8);var p;switch(t[2]){case 0:break;case 2:p={t:"n",v:u};break;case 3:p={t:"s",v:e[l]};break;case 5:p={t:"d",v:f};break;case 6:p={t:"b",v:u>0};break;case 7:p={t:"n",v:u/86400};break;case 8:p={t:"e",v:0};break;case 9:if(o>-1)p={t:"s",v:r[o]};else if(l>-1)p={t:"s",v:e[l]};else if(!isNaN(u))p={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return p}function Yj(t,e,r){var n=ic(t),i=n.getUint32(8,!0),s=12,a=-1,o=-1,l=NaN,u=NaN,f=new Date(2001,0,1);i&1&&(l=Hj(t,s),s+=16),i&2&&(u=n.getFloat64(s,!0),s+=8),i&4&&(f.setTime(f.getTime()+n.getFloat64(s,!0)*1e3),s+=8),i&8&&(o=n.getUint32(s,!0),s+=4),i&16&&(a=n.getUint32(s,!0),s+=4);var p;switch(t[1]){case 0:break;case 2:p={t:"n",v:l};break;case 3:p={t:"s",v:e[o]};break;case 5:p={t:"d",v:f};break;case 6:p={t:"b",v:u>0};break;case 7:p={t:"n",v:u/86400};break;case 8:p={t:"e",v:0};break;case 9:if(a>-1)p={t:"s",v:r[a]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)));break;case 10:p={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)))}return p}function Jg(t,e){var r=new Uint8Array(32),n=ic(r),i=12,s=0;switch(r[0]=5,t.t){case"n":r[1]=2,$j(r,i,t.v),s|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,t.v?1:0,!0),s|=2,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,n.setUint32(i,e.indexOf(t.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,s,!0),r.slice(0,i)}function Zg(t,e){var r=new Uint8Array(32),n=ic(r),i=12,s=0;switch(r[0]=3,t.t){case"n":r[2]=2,n.setFloat64(i,t.v,!0),s|=32,i+=8;break;case"b":r[2]=6,n.setFloat64(i,t.v?1:0,!0),s|=32,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,n.setUint32(i,e.indexOf(t.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,s,!0),r.slice(0,i)}function Xj(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return Kj(t,e,r,t[0]);case 5:return Yj(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function hi(t){var e=lr(t);return Ff(e[1][0].data)}function X_(t,e){var r=lr(e.data),n=ln(r[1][0].data),i=r[3],s=[];return(i||[]).forEach(function(a){var o=lr(a.data),l=ln(o[1][0].data)>>>0;switch(n){case 1:s[l]=Sx(o[3][0].data);break;case 8:{var u=t[hi(o[9][0].data)][0],f=lr(u.data),p=t[hi(f[1][0].data)][0],g=ln(p.meta[1][0].data);if(g!=2001)throw new Error("2000 unexpected reference to ".concat(g));var m=lr(p.data);s[l]=m[3].map(function(y){return Sx(y.data)}).join("")}break}}),s}function qj(t,e){var r,n,i,s,a,o,l,u,f,p,g,m,y,x,S=lr(t),A=ln(S[1][0].data)>>>0,C=ln(S[2][0].data)>>>0,E=((n=(r=S[8])==null?void 0:r[0])==null?void 0:n.data)&&ln(S[8][0].data)>0||!1,O,Q;if((s=(i=S[7])==null?void 0:i[0])!=null&&s.data&&e!=0)O=(o=(a=S[7])==null?void 0:a[0])==null?void 0:o.data,Q=(u=(l=S[6])==null?void 0:l[0])==null?void 0:u.data;else if((p=(f=S[4])==null?void 0:f[0])!=null&&p.data&&e!=1)O=(m=(g=S[4])==null?void 0:g[0])==null?void 0:m.data,Q=(x=(y=S[3])==null?void 0:y[0])==null?void 0:x.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var H=E?4:1,w=ic(O),F=[],T=0;T<O.length/2;++T){var N=w.getUint16(T*2,!0);N<65535&&F.push([T,N])}if(F.length!=C)throw"Expected ".concat(C," cells, found ").concat(F.length);var D=[];for(T=0;T<F.length-1;++T)D[F[T][0]]=Q.subarray(F[T][1]*H,F[T+1][1]*H);return F.length>=1&&(D[F[F.length-1][0]]=Q.subarray(F[F.length-1][1]*H)),{R:A,cells:D}}function Qj(t,e){var r,n=lr(e.data),i=(r=n==null?void 0:n[7])!=null&&r[0]?ln(n[7][0].data)>>>0>0?1:0:-1,s=_v(n[5],function(a){return qj(a,i)});return{nrows:ln(n[4][0].data)>>>0,data:s.reduce(function(a,o){return a[o.R]||(a[o.R]=[]),o.cells.forEach(function(l,u){if(a[o.R][u])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(u));a[o.R][u]=l}),a},[])}}function Jj(t,e,r){var n,i=lr(e.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(ln(i[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(s.e.c=(ln(i[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=Nt(s);var a=lr(i[4][0].data),o=X_(t,t[hi(a[4][0].data)][0]),l=(n=a[17])!=null&&n[0]?X_(t,t[hi(a[17][0].data)][0]):[],u=lr(a[3][0].data),f=0;u[1].forEach(function(p){var g=lr(p.data),m=t[hi(g[2][0].data)][0],y=ln(m.meta[1][0].data);if(y!=6002)throw new Error("6001 unexpected reference to ".concat(y));var x=Qj(t,m);x.data.forEach(function(S,A){S.forEach(function(C,E){var O=gt({r:f+A,c:E}),Q=Xj(C,o,l);Q&&(r[O]=Q)})}),f+=x.nrows})}function Zj(t,e){var r=lr(e.data),n={"!ref":"A1"},i=t[hi(r[2][0].data)],s=ln(i[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return Jj(t,i[0],n),n}function eL(t,e){var r,n=lr(e.data),i={name:(r=n[1])!=null&&r[0]?Sx(n[1][0].data):"",sheets:[]},s=_v(n[2],hi);return s.forEach(function(a){t[a].forEach(function(o){var l=ln(o.meta[1][0].data);l==6e3&&i.sheets.push(Zj(t,o))})}),i}function tL(t,e){var r=Av(),n=lr(e.data),i=_v(n[1],hi);if(i.forEach(function(s){t[s].forEach(function(a){var o=ln(a.meta[1][0].data);if(o==2){var l=eL(t,a);l.sheets.forEach(function(u,f){Cv(r,u,f==0?l.name:l.name+"_"+f,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function em(t){var e,r,n,i,s={},a=[];if(t.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var u;try{u=Fs(l.content)}catch(p){return console.log("?? "+l.content.length+" "+(p.message||p))}var f;try{f=ks(u)}catch(p){return console.log("## "+(p.message||p))}f.forEach(function(p){s[p.id]=p.messages,a.push(p.id)})}}),!a.length)throw new Error("File has no messages");var o=((i=(n=(r=(e=s==null?void 0:s[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&ln(s[1][0].meta[1][0].data)==1&&s[1][0];if(o||a.forEach(function(l){s[l].forEach(function(u){var f=ln(u.meta[1][0].data)>>>0;if(f==1)if(!o)o=u;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return tL(s,o)}function rL(t,e,r){var n,i,s,a;if(!((n=t[6])!=null&&n[0])||!((i=t[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var o=((a=(s=t[8])==null?void 0:s[0])==null?void 0:a.data)&&ln(t[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,u=ic(t[7][0].data),f=0,p=[],g=ic(t[4][0].data),m=0,y=[],x=0;x<e.length;++x){if(e[x]==null){u.setUint16(x*2,65535,!0),g.setUint16(x*2,65535);continue}u.setUint16(x*2,f,!0),g.setUint16(x*2,m,!0);var S,A;switch(typeof e[x]){case"string":S=Jg({t:"s",v:e[x]},r),A=Zg({t:"s",v:e[x]},r);break;case"number":S=Jg({t:"n",v:e[x]},r),A=Zg({t:"n",v:e[x]},r);break;case"boolean":S=Jg({t:"b",v:e[x]},r),A=Zg({t:"b",v:e[x]},r);break;default:throw new Error("Unsupported value "+e[x])}p.push(S),f+=S.length,y.push(A),m+=A.length,++l}for(t[2][0].data=vr(l);x<t[7][0].data.length/2;++x)u.setUint16(x*2,65535,!0),g.setUint16(x*2,65535,!0);return t[6][0].data=gl(p),t[3][0].data=gl(y),l}function nL(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Zi(r["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(Nt(n)));var s=lp(r,{range:n,header:1}),a=["~Sh33tJ5~"];s.forEach(function(re){return re.forEach(function(ne){typeof ne=="string"&&a.push(ne)})});var o={},l=[],u=ct.read(e.numbers,{type:"base64"});u.FileIndex.map(function(re,ne){return[re,u.FullPaths[ne]]}).forEach(function(re){var ne=re[0],X=re[1];if(ne.type==2&&ne.name.match(/\.iwa/)){var _e=ne.content,Te=Fs(_e),Le=ks(Te);Le.forEach(function(Ne){l.push(Ne.id),o[Ne.id]={deps:[],location:X,type:ln(Ne.messages[0].meta[1][0].data)}})}}),l.sort(function(re,ne){return re-ne});var f=l.filter(function(re){return re>1}).map(function(re){return[re,vr(re)]});u.FileIndex.map(function(re,ne){return[re,u.FullPaths[ne]]}).forEach(function(re){var ne=re[0];if(re[1],!!ne.name.match(/\.iwa/)){var X=ks(Fs(ne.content));X.forEach(function(_e){_e.messages.forEach(function(Te){f.forEach(function(Le){_e.messages.some(function(Ne){return ln(Ne.meta[1][0].data)!=11006&&Wj(Ne.data,Le[1])})&&o[Le[0]].deps.push(_e.id)})})})}});for(var p=ct.find(u,o[1].location),g=ks(Fs(p.content)),m,y=0;y<g.length;++y){var x=g[y];x.id==1&&(m=x)}var S=hi(lr(m.messages[0].data)[1][0].data);for(p=ct.find(u,o[S].location),g=ks(Fs(p.content)),y=0;y<g.length;++y)x=g[y],x.id==S&&(m=x);for(S=hi(lr(m.messages[0].data)[2][0].data),p=ct.find(u,o[S].location),g=ks(Fs(p.content)),y=0;y<g.length;++y)x=g[y],x.id==S&&(m=x);for(S=hi(lr(m.messages[0].data)[2][0].data),p=ct.find(u,o[S].location),g=ks(Fs(p.content)),y=0;y<g.length;++y)x=g[y],x.id==S&&(m=x);var A=lr(m.messages[0].data);{A[6][0].data=vr(n.e.r+1),A[7][0].data=vr(n.e.c+1);var C=hi(A[46][0].data),E=ct.find(u,o[C].location),O=ks(Fs(E.content));{for(var Q=0;Q<O.length&&O[Q].id!=C;++Q);if(O[Q].id!=C)throw"Bad ColumnRowUIDMapArchive";var H=lr(O[Q].messages[0].data);H[1]=[],H[2]=[],H[3]=[];for(var w=0;w<=n.e.c;++w){var F=[];F[1]=F[2]=[{type:0,data:vr(w+420690)}],H[1].push({type:2,data:Qn(F)}),H[2].push({type:0,data:vr(w)}),H[3].push({type:0,data:vr(w)})}H[4]=[],H[5]=[],H[6]=[];for(var T=0;T<=n.e.r;++T)F=[],F[1]=F[2]=[{type:0,data:vr(T+726270)}],H[4].push({type:2,data:Qn(F)}),H[5].push({type:0,data:vr(T)}),H[6].push({type:0,data:vr(T)});O[Q].messages[0].data=Qn(H)}E.content=Rc(Nc(O)),E.size=E.content.length,delete A[46];var N=lr(A[4][0].data);{N[7][0].data=vr(n.e.r+1);var D=lr(N[1][0].data),P=hi(D[2][0].data);E=ct.find(u,o[P].location),O=ks(Fs(E.content));{if(O[0].id!=P)throw"Bad HeaderStorageBucket";var R=lr(O[0].messages[0].data);for(T=0;T<s.length;++T){var Xe=lr(R[2][0].data);Xe[1][0].data=vr(T),Xe[4][0].data=vr(s[T].length),R[2][T]={type:R[2][0].type,data:Qn(Xe)}}O[0].messages[0].data=Qn(R)}E.content=Rc(Nc(O)),E.size=E.content.length;var Se=hi(N[2][0].data);E=ct.find(u,o[Se].location),O=ks(Fs(E.content));{if(O[0].id!=Se)throw"Bad HeaderStorageBucket";for(R=lr(O[0].messages[0].data),w=0;w<=n.e.c;++w)Xe=lr(R[2][0].data),Xe[1][0].data=vr(w),Xe[4][0].data=vr(n.e.r+1),R[2][w]={type:R[2][0].type,data:Qn(Xe)};O[0].messages[0].data=Qn(R)}E.content=Rc(Nc(O)),E.size=E.content.length;var De=hi(N[4][0].data);(function(){for(var re=ct.find(u,o[De].location),ne=ks(Fs(re.content)),X,_e=0;_e<ne.length;++_e){var Te=ne[_e];Te.id==De&&(X=Te)}var Le=lr(X.messages[0].data);{Le[3]=[];var Ne=[];a.forEach(function(ee,Ot){Ne[1]=[{type:0,data:vr(Ot)}],Ne[2]=[{type:0,data:vr(1)}],Ne[3]=[{type:2,data:zj(ee)}],Le[3].push({type:2,data:Qn(Ne)})})}X.messages[0].data=Qn(Le);var Ie=Nc(ne),ot=Rc(Ie);re.content=ot,re.size=re.content.length})();var ke=lr(N[3][0].data);{var Ce=ke[1][0];delete ke[2];var ie=lr(Ce.data);{var be=hi(ie[2][0].data);(function(){for(var re=ct.find(u,o[be].location),ne=ks(Fs(re.content)),X,_e=0;_e<ne.length;++_e){var Te=ne[_e];Te.id==be&&(X=Te)}var Le=lr(X.messages[0].data);{delete Le[6],delete ke[7];var Ne=new Uint8Array(Le[5][0].data);Le[5]=[];for(var Ie=0,ot=0;ot<=n.e.r;++ot){var ee=lr(Ne);Ie+=rL(ee,s[ot],a),ee[1][0].data=vr(ot),Le[5].push({data:Qn(ee),type:2})}Le[1]=[{type:0,data:vr(n.e.c+1)}],Le[2]=[{type:0,data:vr(n.e.r+1)}],Le[3]=[{type:0,data:vr(Ie)}],Le[4]=[{type:0,data:vr(n.e.r+1)}]}X.messages[0].data=Qn(Le);var Ot=Nc(ne),wt=Rc(Ot);re.content=wt,re.size=re.content.length})()}Ce.data=Qn(ie)}N[3][0].data=Qn(ke)}A[4][0].data=Qn(N)}m.messages[0].data=Qn(A);var Me=Nc(g),Y=Rc(Me);return p.content=Y,p.size=p.content.length,u}function DC(t){return function(r){for(var n=0;n!=t.length;++n){var i=t[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function Ev(t){DC([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function Sv(t){DC([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function iL(t){return Vt.WS.indexOf(t)>-1?"sheet":t==Vt.CS?"chart":t==Vt.DS?"dialog":t==Vt.MS?"macro":t&&t.length?t:"sheet"}function sL(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,iL(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function aL(t,e,r,n,i,s,a,o,l,u,f,p){try{s[n]=zd(ds(t,r,!0),e);var g=wn(t,e),m;switch(o){case"sheet":m=FB(g,e,i,l,s[n],u,f,p);break;case"chart":if(m=bB(g,e,i,l,s[n],u,f,p),!m||!m["!drawel"])break;var y=Ad(m["!drawel"].Target,e),x=Sf(y),S=g8(ds(t,y,!0),zd(ds(t,x,!0),y)),A=Ad(S,y),C=Sf(A);m=rB(ds(t,A,!0),A,l,zd(ds(t,C,!0),A),u,m);break;case"macro":m=IB(g,e,i,l,s[n],u,f,p);break;case"dialog":m=NB(g,e,i,l,s[n],u,f,p);break;default:throw new Error("Unrecognized sheet type "+o)}a[n]=m;var E=[];s&&s[n]&&cn(s[n]).forEach(function(O){var Q="";if(s[n][O].Type==Vt.CMNT){Q=Ad(s[n][O].Target,e);var H=OB(wn(t,Q,!0),Q,l);if(!H||!H.length)return;P_(m,H,!1)}s[n][O].Type==Vt.TCMNT&&(Q=Ad(s[n][O].Target,e),E=E.concat(x8(wn(t,Q,!0),l)))}),E&&E.length&&P_(m,E,!0,l.people||[])}catch(O){if(l.WTF)throw O}}function As(t){return t.charAt(0)=="/"?t.slice(1):t}function oL(t,e){if(Mu(),e=e||{},Ev(e),bs(t,"META-INF/manifest.xml")||bs(t,"objectdata.xml"))return $_(t,e);if(bs(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof em<"u"){if(t.FileIndex)return em(t);var r=ct.utils.cfb_new();return t_(t).forEach(function(Xe){Rt(r,Xe,vR(t,Xe))}),em(r)}throw new Error("Unsupported NUMBERS file")}if(!bs(t,"[Content_Types].xml"))throw bs(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):bs(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=t_(t),i=dD(ds(t,"[Content_Types].xml")),s=!1,a,o;if(i.workbooks.length===0&&(o="xl/workbook.xml",wn(t,o,!0)&&i.workbooks.push(o)),i.workbooks.length===0){if(o="xl/workbook.bin",!wn(t,o,!0))throw new Error("Could not find workbook");i.workbooks.push(o),s=!0}i.workbooks[0].slice(-3)=="bin"&&(s=!0);var l={},u={};if(!e.bookSheets&&!e.bookProps){if(Wd=[],i.sst)try{Wd=PB(wn(t,As(i.sst)),i.sst,e)}catch(Xe){if(e.WTF)throw Xe}e.cellStyles&&i.themes.length&&(l=DB(ds(t,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],e)),i.style&&(u=RB(wn(t,As(i.style)),i.style,l,e))}i.links.map(function(Xe){try{var Se=zd(ds(t,Sf(As(Xe))),Xe);return BB(wn(t,As(Xe)),Se,Xe,e)}catch{}});var f=kB(wn(t,As(i.workbooks[0])),i.workbooks[0],e),p={},g="";i.coreprops.length&&(g=wn(t,As(i.coreprops[0]),!0),g&&(p=EA(g)),i.extprops.length!==0&&(g=wn(t,As(i.extprops[0]),!0),g&&vD(g,p,e)));var m={};(!e.bookSheets||e.bookProps)&&i.custprops.length!==0&&(g=ds(t,As(i.custprops[0]),!0),g&&(m=_D(g,e)));var y={};if((e.bookSheets||e.bookProps)&&(f.Sheets?a=f.Sheets.map(function(Se){return Se.name}):p.Worksheets&&p.SheetNames.length>0&&(a=p.SheetNames),e.bookProps&&(y.Props=p,y.Custprops=m),e.bookSheets&&typeof a<"u"&&(y.SheetNames=a),e.bookSheets?y.SheetNames:e.bookProps))return y;a={};var x={};e.bookDeps&&i.calcchain&&(x=MB(wn(t,As(i.calcchain)),i.calcchain));var S=0,A={},C,E;{var O=f.Sheets;p.Worksheets=O.length,p.SheetNames=[];for(var Q=0;Q!=O.length;++Q)p.SheetNames[Q]=O[Q].name}var H=s?"bin":"xml",w=i.workbooks[0].lastIndexOf("/"),F=(i.workbooks[0].slice(0,w+1)+"_rels/"+i.workbooks[0].slice(w+1)+".rels").replace(/^\//,"");bs(t,F)||(F="xl/_rels/workbook."+H+".rels");var T=zd(ds(t,F,!0),F.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(e.xlmeta=jB(wn(t,As(i.metadata[0])),i.metadata[0],e)),(i.people||[]).length>=1&&(e.people=y8(wn(t,As(i.people[0])),e)),T&&(T=sL(T,f.Sheets));var N=wn(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(S=0;S!=p.Worksheets;++S){var D="sheet";if(T&&T[S]?(C="xl/"+T[S][1].replace(/[\/]?xl\//,""),bs(t,C)||(C=T[S][1]),bs(t,C)||(C=F.replace(/_rels\/.*$/,"")+T[S][1]),D=T[S][2]):(C="xl/worksheets/sheet"+(S+1-N)+"."+H,C=C.replace(/sheet0\./,"sheet.")),E=C.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(S!=e.sheets)continue e;break;case"string":if(p.SheetNames[S].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var P=!1,R=0;R!=e.sheets.length;++R)typeof e.sheets[R]=="number"&&e.sheets[R]==S&&(P=1),typeof e.sheets[R]=="string"&&e.sheets[R].toLowerCase()==p.SheetNames[S].toLowerCase()&&(P=1);if(!P)continue e}}aL(t,C,E,p.SheetNames[S],S,A,a,D,e,f,l,u)}return y={Directory:i,Workbook:f,Props:p,Custprops:m,Deps:x,Sheets:a,SheetNames:p.SheetNames,Strings:Wd,Styles:u,Themes:l,SSF:jr(pt)},e&&e.bookFiles&&(t.files?(y.keys=n,y.files=t.files):(y.keys=[],y.files={},t.FullPaths.forEach(function(Xe,Se){Xe=Xe.replace(/^Root Entry[\/]/,""),y.keys.push(Xe),y.files[Xe]=t.FileIndex[Se]}))),e&&e.bookVBA&&(i.vba.length>0?y.vbaraw=wn(t,As(i.vba[0]),!0):i.defaults&&i.defaults.bin===k8&&(y.vbaraw=wn(t,"xl/vbaProject.bin",!0))),y}function lL(t,e){var r=e||{},n="Workbook",i=ct.find(t,n);try{if(n="/!DataSpaces/Version",i=ct.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(j6(i.content),n="/!DataSpaces/DataSpaceMap",i=ct.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=U6(i.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=ct.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=V6(i.content);if(a.length!=1||a[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=ct.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);W6(i.content)}catch{}if(n="/EncryptionInfo",i=ct.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=H6(i.content);if(n="/EncryptedPackage",i=ct.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],i.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function cL(t,e){return e.bookType=="ods"?RC(t,e):e.bookType=="numbers"?nL(t,e):e.bookType=="xlsb"?uL(t,e):dL(t,e)}function uL(t,e){Qc=1024,t&&!t.SSF&&(t.SSF=jr(pt)),t&&t.SSF&&(Mu(),Wp(t.SSF),e.revssf=$p(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Hd?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",n=aC.indexOf(e.bookType)>-1,i=ov();Sv(e=e||{});var s=K1(),a="",o=0;if(e.cellXfs=[],Tl(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),a="docProps/core.xml",Rt(s,a,SA(t.Props,e)),i.coreprops.push(a),yr(e.rels,2,a,Vt.CORE_PROPS),a="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],u=0;u<t.SheetNames.length;++u)(t.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(t.SheetNames[u]);t.Props.SheetNames=l}for(t.Props.Worksheets=t.Props.SheetNames.length,Rt(s,a,AA(t.Props)),i.extprops.push(a),yr(e.rels,3,a,Vt.EXT_PROPS),t.Custprops!==t.Props&&cn(t.Custprops||{}).length>0&&(a="docProps/custom.xml",Rt(s,a,CA(t.Custprops)),i.custprops.push(a),yr(e.rels,4,a,Vt.CUST_PROPS)),o=1;o<=t.SheetNames.length;++o){var f={"!id":{}},p=t.Sheets[t.SheetNames[o-1]],g=(p||{})["!type"]||"sheet";switch(g){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,Rt(s,a,UB(o-1,a,e,t,f)),i.sheets.push(a),yr(e.wbrels,-1,"worksheets/sheet"+o+"."+r,Vt.WS[0])}if(p){var m=p["!comments"],y=!1,x="";m&&m.length>0&&(x="xl/comments"+o+"."+r,Rt(s,x,WB(m,x)),i.comments.push(x),yr(f,-1,"../comments"+o+"."+r,Vt.CMNT),y=!0),p["!legacy"]&&y&&Rt(s,"xl/drawings/vmlDrawing"+o+".vml",iC(o,p["!comments"])),delete p["!comments"],delete p["!legacy"]}f["!id"].rId1&&Rt(s,Sf(a),au(f))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+r,Rt(s,a,zB(e.Strings,a,e)),i.strs.push(a),yr(e.wbrels,-1,"sharedStrings."+r,Vt.SST)),a="xl/workbook."+r,Rt(s,a,LB(t,a)),i.workbooks.push(a),yr(e.rels,1,a,Vt.WB),a="xl/theme/theme1.xml",Rt(s,a,hv(t.Themes,e)),i.themes.push(a),yr(e.wbrels,-1,"theme/theme1.xml",Vt.THEME),a="xl/styles."+r,Rt(s,a,VB(t,a,e)),i.styles.push(a),yr(e.wbrels,-1,"styles."+r,Vt.STY),t.vbaraw&&n&&(a="xl/vbaProject.bin",Rt(s,a,t.vbaraw),i.vba.push(a),yr(e.wbrels,-1,"vbaProject.bin",Vt.VBA)),a="xl/metadata."+r,Rt(s,a,HB(a)),i.metadata.push(a),yr(e.wbrels,-1,"metadata."+r,Vt.XLMETA),Rt(s,"[Content_Types].xml",yA(i,e)),Rt(s,"_rels/.rels",au(e.rels)),Rt(s,"xl/_rels/workbook."+r+".rels",au(e.wbrels)),delete e.revssf,delete e.ssf,s}function dL(t,e){Qc=1024,t&&!t.SSF&&(t.SSF=jr(pt)),t&&t.SSF&&(Mu(),Wp(t.SSF),e.revssf=$p(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Hd?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",n=aC.indexOf(e.bookType)>-1,i=ov();Sv(e=e||{});var s=K1(),a="",o=0;if(e.cellXfs=[],Tl(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),a="docProps/core.xml",Rt(s,a,SA(t.Props,e)),i.coreprops.push(a),yr(e.rels,2,a,Vt.CORE_PROPS),a="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],u=0;u<t.SheetNames.length;++u)(t.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(t.SheetNames[u]);t.Props.SheetNames=l}t.Props.Worksheets=t.Props.SheetNames.length,Rt(s,a,AA(t.Props)),i.extprops.push(a),yr(e.rels,3,a,Vt.EXT_PROPS),t.Custprops!==t.Props&&cn(t.Custprops||{}).length>0&&(a="docProps/custom.xml",Rt(s,a,CA(t.Custprops)),i.custprops.push(a),yr(e.rels,4,a,Vt.CUST_PROPS));var f=["SheetJ5"];for(e.tcid=0,o=1;o<=t.SheetNames.length;++o){var p={"!id":{}},g=t.Sheets[t.SheetNames[o-1]],m=(g||{})["!type"]||"sheet";switch(m){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,Rt(s,a,xC(o-1,e,t,p)),i.sheets.push(a),yr(e.wbrels,-1,"worksheets/sheet"+o+"."+r,Vt.WS[0])}if(g){var y=g["!comments"],x=!1,S="";if(y&&y.length>0){var A=!1;y.forEach(function(C){C[1].forEach(function(E){E.T==!0&&(A=!0)})}),A&&(S="xl/threadedComments/threadedComment"+o+"."+r,Rt(s,S,v8(y,f,e)),i.threadedcomments.push(S),yr(p,-1,"../threadedComments/threadedComment"+o+"."+r,Vt.TCMNT)),S="xl/comments"+o+"."+r,Rt(s,S,sC(y)),i.comments.push(S),yr(p,-1,"../comments"+o+"."+r,Vt.CMNT),x=!0}g["!legacy"]&&x&&Rt(s,"xl/drawings/vmlDrawing"+o+".vml",iC(o,g["!comments"])),delete g["!comments"],delete g["!legacy"]}p["!id"].rId1&&Rt(s,Sf(a),au(p))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+r,Rt(s,a,GA(e.Strings,e)),i.strs.push(a),yr(e.wbrels,-1,"sharedStrings."+r,Vt.SST)),a="xl/workbook."+r,Rt(s,a,SC(t)),i.workbooks.push(a),yr(e.rels,1,a,Vt.WB),a="xl/theme/theme1.xml",Rt(s,a,hv(t.Themes,e)),i.themes.push(a),yr(e.wbrels,-1,"theme/theme1.xml",Vt.THEME),a="xl/styles."+r,Rt(s,a,eC(t,e)),i.styles.push(a),yr(e.wbrels,-1,"styles."+r,Vt.STY),t.vbaraw&&n&&(a="xl/vbaProject.bin",Rt(s,a,t.vbaraw),i.vba.push(a),yr(e.wbrels,-1,"vbaProject.bin",Vt.VBA)),a="xl/metadata."+r,Rt(s,a,nC()),i.metadata.push(a),yr(e.wbrels,-1,"metadata."+r,Vt.XLMETA),f.length>1&&(a="xl/persons/person.xml",Rt(s,a,_8(f)),i.people.push(a),yr(e.wbrels,-1,"persons/person.xml",Vt.PEOPLE)),Rt(s,"[Content_Types].xml",yA(i,e)),Rt(s,"_rels/.rels",au(e.rels)),Rt(s,"xl/_rels/workbook."+r+".rels",au(e.wbrels)),delete e.revssf,delete e.ssf,s}function wv(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=ms(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function fL(t,e){return ct.find(t,"EncryptedPackage")?lL(t,e):CC(t,e)}function hL(t,e){var r,n=t,i=e||{};return i.type||(i.type=Lt&&Buffer.isBuffer(t)?"buffer":"base64"),r=YT(n,i),oL(r,i)}function PC(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return _x(t.slice(r),e);default:break e}return Eu.to_workbook(t,e)}function pL(t,e){var r="",n=wv(t,e);switch(e.type){case"base64":r=ms(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=ec(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Tr(r)),e.type="binary",PC(r,e)}function gL(t,e){var r=t;return e.type=="base64"&&(r=ms(r)),r=mf.utils.decode(1200,r.slice(2),"str"),e.type="binary",PC(r,e)}function mL(t){return t.match(/[^\x00-\x7F]/)?ka(t):t}function tm(t,e,r,n){return n?(r.type="string",Eu.to_workbook(t,r)):Eu.to_workbook(e,r)}function Pl(t,e){z1();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return Pl(new Uint8Array(t),(r=jr(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,i=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),lu={},r.dateNF&&(lu.dateNF=r.dateNF),r.type||(r.type=Lt&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=Lt?"buffer":"binary",n=uR(t),typeof Uint8Array<"u"&&!Lt&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=mL(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var a=new ArrayBuffer(3),o=new Uint8Array(a);if(o.foo="bar",!o.foo)return r=jr(r),r.type="array",Pl(W1(n),r)}switch((i=wv(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return fL(ct.read(n,r),r);break;case 9:if(i[1]<=8)return CC(n,r);break;case 60:return _x(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return E6(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return HA.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?hL(n,r):tm(t,n,r,s);case 239:return i[3]===60?_x(n,r):tm(t,n,r,s);case 255:if(i[1]===254)return gL(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return Hl.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return Hl.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return yx.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return QA.to_workbook(n,r);break;case 10:case 13:case 32:return pL(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return _6.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?yx.to_workbook(n,r):tm(t,n,r,s)}function OC(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return $f(e.file,ct.write(t,{type:Lt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return ct.write(t,e)}function xL(t,e){var r=jr(e||{}),n=cL(t,r);return vL(n,r)}function vL(t,e){var r={},n=Lt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=n;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var i=t.FullPaths?ct.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(e.type=="binary"||e.type=="base64")return i;i=new Uint8Array(zp(i))}return e.password&&typeof encrypt_agile<"u"?OC(encrypt_agile(i,e.password),e):e.type==="file"?$f(e.file,i):e.type=="string"?Tr(i):i}function yL(t,e){var r=e||{},n=mj(t,r);return OC(n,r)}function wa(t,e,r){r||(r="");var n=r+t;switch(e.type){case"base64":return xf(ka(n));case"binary":return ka(n);case"string":return t;case"file":return $f(e.file,n,"utf8");case"buffer":return Lt?go(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):wa(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function _L(t,e){switch(e.type){case"base64":return xf(t);case"binary":return t;case"string":return t;case"file":return $f(e.file,t,"binary");case"buffer":return Lt?go(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function G0(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",n=0;n<t.length;++n)r+=String.fromCharCode(t[n]);return e.type=="base64"?xf(r):e.type=="string"?Tr(r):r;case"file":return $f(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function MC(t,e){z1(),fB(t);var r=jr(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=MC(t,r);return r.type="array",zp(n)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=t.SheetNames.indexOf(r.sheet),!t.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return wa(cj(t,r),r);case"slk":case"sylk":return wa(WA.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"htm":case"html":return wa(FC(t.Sheets[t.SheetNames[i]],r),r);case"txt":return _L(BC(t.Sheets[t.SheetNames[i]],r),r);case"csv":return wa(Tv(t.Sheets[t.SheetNames[i]],r),r,"\uFEFF");case"dif":return wa(HA.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"dbf":return G0(yx.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"prn":return wa(Eu.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"rtf":return wa(QA.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"eth":return wa($A.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"fods":return wa(RC(t,r),r);case"wk1":return G0(Hl.sheet_to_wk1(t.Sheets[t.SheetNames[i]],r),r);case"wk3":return G0(Hl.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),G0(kC(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),yL(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return xL(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function EL(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(t.bookType=r.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function Dc(t,e,r){var n={};return n.type="file",n.file=e,EL(n),MC(t,n)}function SL(t,e,r,n,i,s,a,o){var l=gn(r),u=o.defval,f=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),p=!0,g=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(g,"__rowNum__",{value:r,enumerable:!1})}catch{g.__rowNum__=r}else g.__rowNum__=r;if(!a||t[r])for(var m=e.s.c;m<=e.e.c;++m){var y=a?t[r][m]:t[n[m]+l];if(y===void 0||y.t===void 0){if(u===void 0)continue;s[m]!=null&&(g[s[m]]=u);continue}var x=y.v;switch(y.t){case"z":if(x==null)break;continue;case"e":x=x==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+y.t)}if(s[m]!=null){if(x==null)if(y.t=="e"&&x===null)g[s[m]]=null;else if(u!==void 0)g[s[m]]=u;else if(f&&x===null)g[s[m]]=null;else continue;else g[s[m]]=f&&(y.t!=="n"||y.t==="n"&&o.rawNumbers!==!1)?x:oo(y,x,o);x!=null&&(p=!1)}}return{row:g,isempty:p}}function lp(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,s=[],a=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},u=e||{},f=u.range!=null?u.range:t["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof f){case"string":l=ir(f);break;case"number":l=ir(t["!ref"]),l.s.r=f;break;default:l=f}n>0&&(i=0);var p=gn(l.s.r),g=[],m=[],y=0,x=0,S=Array.isArray(t),A=l.s.r,C=0,E={};S&&!t[A]&&(t[A]=[]);var O=u.skipHidden&&t["!cols"]||[],Q=u.skipHidden&&t["!rows"]||[];for(C=l.s.c;C<=l.e.c;++C)if(!(O[C]||{}).hidden)switch(g[C]=Qr(C),r=S?t[A][C]:t[g[C]+p],n){case 1:s[C]=C-l.s.c;break;case 2:s[C]=g[C];break;case 3:s[C]=u.header[C-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=a=oo(r,null,u),x=E[a]||0,!x)E[a]=1;else{do o=a+"_"+x++;while(E[o]);E[a]=x,E[o]=1}s[C]=o}for(A=l.s.r+i;A<=l.e.r;++A)if(!(Q[A]||{}).hidden){var H=SL(t,l,A,g,n,s,S,u);(H.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(m[y++]=H.row)}return m.length=y,m}var q_=/"/g;function wL(t,e,r,n,i,s,a,o){for(var l=!0,u=[],f="",p=gn(r),g=e.s.c;g<=e.e.c;++g)if(n[g]){var m=o.dense?(t[r]||[])[g]:t[n[g]+p];if(m==null)f="";else if(m.v!=null){l=!1,f=""+(o.rawNumbers&&m.t=="n"?m.v:oo(m,null,o));for(var y=0,x=0;y!==f.length;++y)if((x=f.charCodeAt(y))===i||x===s||x===34||o.forceQuotes){f='"'+f.replace(q_,'""')+'"';break}f=="ID"&&(f='"ID"')}else m.f!=null&&!m.F?(l=!1,f="="+m.f,f.indexOf(",")>=0&&(f='"'+f.replace(q_,'""')+'"')):f="";u.push(f)}return o.blankrows===!1&&l?null:u.join(a)}function Tv(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var i=ir(t["!ref"]),s=n.FS!==void 0?n.FS:",",a=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),u=new RegExp((s=="|"?"\\|":s)+"+$"),f="",p=[];n.dense=Array.isArray(t);for(var g=n.skipHidden&&t["!cols"]||[],m=n.skipHidden&&t["!rows"]||[],y=i.s.c;y<=i.e.c;++y)(g[y]||{}).hidden||(p[y]=Qr(y));for(var x=0,S=i.s.r;S<=i.e.r;++S)(m[S]||{}).hidden||(f=wL(t,i,S,p,a,l,s,n),f!=null&&(n.strip&&(f=f.replace(u,"")),(f||n.blankrows!==!1)&&r.push((x++?o:"")+f)));return delete n.dense,r.join("")}function BC(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=Tv(t,e);return r}function TL(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var i=ir(t["!ref"]),s="",a=[],o,l=[],u=Array.isArray(t);for(o=i.s.c;o<=i.e.c;++o)a[o]=Qr(o);for(var f=i.s.r;f<=i.e.r;++f)for(s=gn(f),o=i.s.c;o<=i.e.c;++o)if(e=a[o]+s,r=u?(t[f]||[])[o]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=e+"="+n}return l}function jC(t,e,r){var n=r||{},i=+!n.skipHeader,s=t||{},a=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?Jr(n.origin):n.origin;a=l.r,o=l.c}var u,f={s:{c:0,r:0},e:{c:o,r:a+e.length-1+i}};if(s["!ref"]){var p=ir(s["!ref"]);f.e.c=Math.max(f.e.c,p.e.c),f.e.r=Math.max(f.e.r,p.e.r),a==-1&&(a=p.e.r+1,f.e.r=a+e.length-1+i)}else a==-1&&(a=0,f.e.r=e.length-1+i);var g=n.header||[],m=0;e.forEach(function(x,S){cn(x).forEach(function(A){(m=g.indexOf(A))==-1&&(g[m=g.length]=A);var C=x[A],E="z",O="",Q=gt({c:o+m,r:a+S+i});u=bf(s,Q),C&&typeof C=="object"&&!(C instanceof Date)?s[Q]=C:(typeof C=="number"?E="n":typeof C=="boolean"?E="b":typeof C=="string"?E="s":C instanceof Date?(E="d",n.cellDates||(E="n",C=Mn(C)),O=n.dateNF||pt[14]):C===null&&n.nullError&&(E="e",C=0),u?(u.t=E,u.v=C,delete u.w,delete u.R,O&&(u.z=O)):s[Q]=u={t:E,v:C},O&&(u.z=O))})}),f.e.c=Math.max(f.e.c,o+g.length-1);var y=gn(a);if(i)for(m=0;m<g.length;++m)s[Qr(m+o)+y]={t:"s",v:g[m]};return s["!ref"]=Nt(f),s}function AL(t,e){return jC(null,t,e)}function bf(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=Jr(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?bf(t,gt(e)):bf(t,gt({r:e,c:r||0}))}function CL(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function Av(){return{SheetNames:[],Sheets:{}}}function Cv(t,e,r,n){var i=1;if(!r)for(;i<=65535&&t.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var a=s&&s[1]||r;for(++i;i<=65535&&t.SheetNames.indexOf(r=a+i)!=-1;++i);}if(EC(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function kL(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=CL(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function FL(t,e){return t.z=e,t}function LC(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function bL(t,e,r){return LC(t,"#"+e,r)}function IL(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function NL(t,e,r,n){for(var i=typeof e!="string"?e:ir(e),s=typeof e=="string"?e:Nt(e),a=i.s.r;a<=i.e.r;++a)for(var o=i.s.c;o<=i.e.c;++o){var l=bf(t,a,o);l.t="n",l.F=s,delete l.v,a==i.s.r&&o==i.s.c&&(l.f=r,n&&(l.D=!0))}return t}var kr={encode_col:Qr,encode_row:gn,encode_cell:gt,encode_range:Nt,decode_col:tv,decode_row:ev,split_cell:zR,decode_cell:Jr,decode_range:Zi,format_cell:oo,sheet_add_aoa:fA,sheet_add_json:jC,sheet_add_dom:bC,aoa_to_sheet:Bu,json_to_sheet:AL,table_to_sheet:IC,table_to_book:jj,sheet_to_csv:Tv,sheet_to_txt:BC,sheet_to_json:lp,sheet_to_html:FC,sheet_to_formulae:TL,sheet_to_row_object_array:lp,sheet_get_cell:bf,book_new:Av,book_append_sheet:Cv,book_set_sheet_visibility:kL,cell_set_number_format:FL,cell_set_hyperlink:LC,cell_set_internal_link:bL,cell_add_comment:IL,sheet_set_array_formula:NL,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var RL={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DL=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Pt=(t,e)=>{const r=ye.forwardRef(({color:n="currentColor",size:i=24,strokeWidth:s=2,absoluteStrokeWidth:a,className:o="",children:l,...u},f)=>ye.createElement("svg",{ref:f,...RL,width:i,height:i,stroke:n,strokeWidth:a?Number(s)*24/Number(i):s,className:["lucide",`lucide-${DL(t)}`,o].join(" "),...u},[...e.map(([p,g])=>ye.createElement(p,g)),...Array.isArray(l)?l:[l]]));return r.displayName=`${t}`,r};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q_=Pt("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J_=Pt("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PL=Pt("BellRing",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}],["path",{d:"M4 2C2.8 3.7 2 5.7 2 8",key:"tap9e0"}],["path",{d:"M22 8c0-2.3-.8-4.3-2-6",key:"5bb3ad"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z_=Pt("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eE=Pt("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OL=Pt("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tE=Pt("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rE=Pt("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rm=Pt("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ML=Pt("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K0=Pt("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nm=Pt("Clipboard",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BL=Pt("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Po=Pt("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jL=Pt("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pc=Pt("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pd=Pt("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gd=Pt("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const im=Pt("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nE=Pt("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y0=Pt("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X0=Pt("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LL=Pt("Merge",[["path",{d:"m8 6 4-4 4 4",key:"ybng9g"}],["path",{d:"M12 2v10.3a4 4 0 0 1-1.172 2.872L4 22",key:"1hyw0i"}],["path",{d:"m20 22-5-5",key:"1m27yz"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UL=Pt("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q0=Pt("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sm=Pt("PlusCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const md=Pt("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iE=Pt("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oo=Pt("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1-2-1Z",key:"wqdwcb"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17V7",key:"pyj7ub"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VL=Pt("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zL=Pt("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q0=Pt("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sE=Pt("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WL=Pt("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aE=Pt("Table",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HL=Pt("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2h0a3.13 3.13 0 0 1 3 3.88Z",key:"y3tblf"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const as=Pt("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xs=Pt("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oE=Pt("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ta=Pt("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);var lE={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UC=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=i&63|128):(i&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=i&63|128):(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=i&63|128)}return e},$L=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const i=t[r++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[r++];e[n++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[r++],a=t[r++],o=t[r++],l=((i&7)<<18|(s&63)<<12|(a&63)<<6|o&63)-65536;e[n++]=String.fromCharCode(55296+(l>>10)),e[n++]=String.fromCharCode(56320+(l&1023))}else{const s=t[r++],a=t[r++];e[n++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},VC={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<t.length;i+=3){const s=t[i],a=i+1<t.length,o=a?t[i+1]:0,l=i+2<t.length,u=l?t[i+2]:0,f=s>>2,p=(s&3)<<4|o>>4;let g=(o&15)<<2|u>>6,m=u&63;l||(m=64,a||(g=64)),n.push(r[f],r[p],r[g],r[m])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(UC(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):$L(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<t.length;){const s=r[t.charAt(i++)],o=i<t.length?r[t.charAt(i)]:0;++i;const u=i<t.length?r[t.charAt(i)]:64;++i;const p=i<t.length?r[t.charAt(i)]:64;if(++i,s==null||o==null||u==null||p==null)throw new GL;const g=s<<2|o>>4;if(n.push(g),u!==64){const m=o<<4&240|u>>2;if(n.push(m),p!==64){const y=u<<6&192|p;n.push(y)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class GL extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const KL=function(t){const e=UC(t);return VC.encodeByteArray(e,!0)},cp=function(t){return KL(t).replace(/\./g,"")},zC=function(t){try{return VC.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YL(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XL=()=>YL().__FIREBASE_DEFAULTS__,qL=()=>{if(typeof process>"u"||typeof lE>"u")return;const t=lE.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},QL=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&zC(t[1]);return e&&JSON.parse(e)},Qp=()=>{try{return XL()||qL()||QL()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},WC=t=>{var e,r;return(r=(e=Qp())===null||e===void 0?void 0:e.emulatorHosts)===null||r===void 0?void 0:r[t]},JL=t=>{const e=WC(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},HC=()=>{var t;return(t=Qp())===null||t===void 0?void 0:t.config},$C=t=>{var e;return(e=Qp())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZL{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e9(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t);return[cp(JSON.stringify(r)),cp(JSON.stringify(a)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wi(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function t9(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(wi())}function r9(){var t;const e=(t=Qp())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function n9(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function i9(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function s9(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function a9(){const t=wi();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function o9(){return!r9()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function l9(){try{return typeof indexedDB=="object"}catch{return!1}}function c9(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u9="FirebaseError";class vo extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=u9,Object.setPrototypeOf(this,vo.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Zf.prototype.create)}}class Zf{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?d9(s,n):"Error",o=`${this.serviceName}: ${a} (${i}).`;return new vo(i,o,n)}}function d9(t,e){return t.replace(f9,(r,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const f9=/\{\$([^}]+)}/g;function h9(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function up(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const i of r){if(!n.includes(i))return!1;const s=t[i],a=e[i];if(cE(s)&&cE(a)){if(!up(s,a))return!1}else if(s!==a)return!1}for(const i of n)if(!r.includes(i))return!1;return!0}function cE(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e0(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function p9(t,e){const r=new g9(t,e);return r.subscribe.bind(r)}class g9{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let i;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");m9(e,["next","error","complete"])?i=e:i={next:e,error:r,complete:n},i.next===void 0&&(i.next=am),i.error===void 0&&(i.error=am),i.complete===void 0&&(i.complete=am);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function m9(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function am(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oa(t){return t&&t._delegate?t._delegate:t}class sc{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rl="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x9{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new ZL;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:r});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){var r;const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(r=e==null?void 0:e.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(y9(e))try{this.getOrInitializeService({instanceIdentifier:Rl})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(r);try{const s=this.getOrInitializeService({instanceIdentifier:i});n.resolve(s)}catch{}}}}clearInstance(e=Rl){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Rl){return this.instances.has(e)}getOptions(e=Rl){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[s,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(s);n===o&&a.resolve(i)}return i}onInit(e,r){var n;const i=this.normalizeInstanceIdentifier(r),s=(n=this.onInitCallbacks.get(i))!==null&&n!==void 0?n:new Set;s.add(e),this.onInitCallbacks.set(i,s);const a=this.instances.get(i);return a&&e(a,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const i of n)try{i(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:v9(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=Rl){return this.component?this.component.multipleInstances?e:Rl:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function v9(t){return t===Rl?void 0:t}function y9(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _9{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new x9(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Yt;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Yt||(Yt={}));const E9={debug:Yt.DEBUG,verbose:Yt.VERBOSE,info:Yt.INFO,warn:Yt.WARN,error:Yt.ERROR,silent:Yt.SILENT},S9=Yt.INFO,w9={[Yt.DEBUG]:"log",[Yt.VERBOSE]:"log",[Yt.INFO]:"info",[Yt.WARN]:"warn",[Yt.ERROR]:"error"},T9=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),i=w9[e];if(i)console[i](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class kv{constructor(e){this.name=e,this._logLevel=S9,this._logHandler=T9,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Yt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?E9[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Yt.DEBUG,...e),this._logHandler(this,Yt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Yt.VERBOSE,...e),this._logHandler(this,Yt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Yt.INFO,...e),this._logHandler(this,Yt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Yt.WARN,...e),this._logHandler(this,Yt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Yt.ERROR,...e),this._logHandler(this,Yt.ERROR,...e)}}const A9=(t,e)=>e.some(r=>t instanceof r);let uE,dE;function C9(){return uE||(uE=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function k9(){return dE||(dE=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const GC=new WeakMap,wx=new WeakMap,KC=new WeakMap,om=new WeakMap,Fv=new WeakMap;function F9(t){const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",a)},s=()=>{r(sl(t.result)),i()},a=()=>{n(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",a)});return e.then(r=>{r instanceof IDBCursor&&GC.set(r,t)}).catch(()=>{}),Fv.set(e,t),e}function b9(t){if(wx.has(t))return;const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",a),t.removeEventListener("abort",a)},s=()=>{r(),i()},a=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",a),t.addEventListener("abort",a)});wx.set(t,e)}let Tx={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return wx.get(t);if(e==="objectStoreNames")return t.objectStoreNames||KC.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return sl(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function I9(t){Tx=t(Tx)}function N9(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(lm(this),e,...r);return KC.set(n,e.sort?e.sort():[e]),sl(n)}:k9().includes(t)?function(...e){return t.apply(lm(this),e),sl(GC.get(this))}:function(...e){return sl(t.apply(lm(this),e))}}function R9(t){return typeof t=="function"?N9(t):(t instanceof IDBTransaction&&b9(t),A9(t,C9())?new Proxy(t,Tx):t)}function sl(t){if(t instanceof IDBRequest)return F9(t);if(om.has(t))return om.get(t);const e=R9(t);return e!==t&&(om.set(t,e),Fv.set(e,t)),e}const lm=t=>Fv.get(t);function D9(t,e,{blocked:r,upgrade:n,blocking:i,terminated:s}={}){const a=indexedDB.open(t,e),o=sl(a);return n&&a.addEventListener("upgradeneeded",l=>{n(sl(a.result),l.oldVersion,l.newVersion,sl(a.transaction),l)}),r&&a.addEventListener("blocked",l=>r(l.oldVersion,l.newVersion,l)),o.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),o}const P9=["get","getKey","getAll","getAllKeys","count"],O9=["put","add","delete","clear"],cm=new Map;function fE(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(cm.get(e))return cm.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,i=O9.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||P9.includes(r)))return;const s=async function(a,...o){const l=this.transaction(a,i?"readwrite":"readonly");let u=l.store;return n&&(u=u.index(o.shift())),(await Promise.all([u[r](...o),i&&l.done]))[0]};return cm.set(e,s),s}I9(t=>({...t,get:(e,r,n)=>fE(e,r)||t.get(e,r,n),has:(e,r)=>!!fE(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M9{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(B9(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function B9(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Ax="@firebase/app",hE="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lo=new kv("@firebase/app"),j9="@firebase/app-compat",L9="@firebase/analytics-compat",U9="@firebase/analytics",V9="@firebase/app-check-compat",z9="@firebase/app-check",W9="@firebase/auth",H9="@firebase/auth-compat",$9="@firebase/database",G9="@firebase/data-connect",K9="@firebase/database-compat",Y9="@firebase/functions",X9="@firebase/functions-compat",q9="@firebase/installations",Q9="@firebase/installations-compat",J9="@firebase/messaging",Z9="@firebase/messaging-compat",e7="@firebase/performance",t7="@firebase/performance-compat",r7="@firebase/remote-config",n7="@firebase/remote-config-compat",i7="@firebase/storage",s7="@firebase/storage-compat",a7="@firebase/firestore",o7="@firebase/vertexai-preview",l7="@firebase/firestore-compat",c7="firebase",u7="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cx="[DEFAULT]",d7={[Ax]:"fire-core",[j9]:"fire-core-compat",[U9]:"fire-analytics",[L9]:"fire-analytics-compat",[z9]:"fire-app-check",[V9]:"fire-app-check-compat",[W9]:"fire-auth",[H9]:"fire-auth-compat",[$9]:"fire-rtdb",[G9]:"fire-data-connect",[K9]:"fire-rtdb-compat",[Y9]:"fire-fn",[X9]:"fire-fn-compat",[q9]:"fire-iid",[Q9]:"fire-iid-compat",[J9]:"fire-fcm",[Z9]:"fire-fcm-compat",[e7]:"fire-perf",[t7]:"fire-perf-compat",[r7]:"fire-rc",[n7]:"fire-rc-compat",[i7]:"fire-gcs",[s7]:"fire-gcs-compat",[a7]:"fire-fst",[l7]:"fire-fst-compat",[o7]:"fire-vertex","fire-js":"fire-js",[c7]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dp=new Map,f7=new Map,kx=new Map;function pE(t,e){try{t.container.addComponent(e)}catch(r){lo.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function wu(t){const e=t.name;if(kx.has(e))return lo.debug(`There were multiple attempts to register component ${e}.`),!1;kx.set(e,t);for(const r of dp.values())pE(r,t);for(const r of f7.values())pE(r,t);return!0}function bv(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function Xo(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h7={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},al=new Zf("app","Firebase",h7);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p7{constructor(e,r,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new sc("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw al.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lu=u7;function YC(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n=Object.assign({name:Cx,automaticDataCollectionEnabled:!1},e),i=n.name;if(typeof i!="string"||!i)throw al.create("bad-app-name",{appName:String(i)});if(r||(r=HC()),!r)throw al.create("no-options");const s=dp.get(i);if(s){if(up(r,s.options)&&up(n,s.config))return s;throw al.create("duplicate-app",{appName:i})}const a=new _9(i);for(const l of kx.values())a.addComponent(l);const o=new p7(r,n,a);return dp.set(i,o),o}function XC(t=Cx){const e=dp.get(t);if(!e&&t===Cx&&HC())return YC();if(!e)throw al.create("no-app",{appName:t});return e}function ol(t,e,r){var n;let i=(n=d7[t])!==null&&n!==void 0?n:t;r&&(i+=`-${r}`);const s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){const o=[`Unable to register library "${i}" with version "${e}":`];s&&o.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&a&&o.push("and"),a&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),lo.warn(o.join(" "));return}wu(new sc(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g7="firebase-heartbeat-database",m7=1,If="firebase-heartbeat-store";let um=null;function qC(){return um||(um=D9(g7,m7,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(If)}catch(r){console.warn(r)}}}}).catch(t=>{throw al.create("idb-open",{originalErrorMessage:t.message})})),um}async function x7(t){try{const r=(await qC()).transaction(If),n=await r.objectStore(If).get(QC(t));return await r.done,n}catch(e){if(e instanceof vo)lo.warn(e.message);else{const r=al.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});lo.warn(r.message)}}}async function gE(t,e){try{const n=(await qC()).transaction(If,"readwrite");await n.objectStore(If).put(e,QC(t)),await n.done}catch(r){if(r instanceof vo)lo.warn(r.message);else{const n=al.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});lo.warn(n.message)}}}function QC(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v7=1024,y7=30*24*60*60*1e3;class _7{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new S7(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=mE();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(a=>a.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const o=new Date(a.date).valueOf();return Date.now()-o<=y7}),this._storage.overwrite(this._heartbeatsCache))}catch(n){lo.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=mE(),{heartbeatsToSend:n,unsentEntries:i}=E7(this._heartbeatsCache.heartbeats),s=cp(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(r){return lo.warn(r),""}}}function mE(){return new Date().toISOString().substring(0,10)}function E7(t,e=v7){const r=[];let n=t.slice();for(const i of t){const s=r.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),xE(r)>e){s.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),xE(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class S7{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return l9()?c9().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await x7(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return gE(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return gE(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function xE(t){return cp(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w7(t){wu(new sc("platform-logger",e=>new M9(e),"PRIVATE")),wu(new sc("heartbeat",e=>new _7(e),"PRIVATE")),ol(Ax,hE,t),ol(Ax,hE,"esm2017"),ol("fire-js","")}w7("");var T7="firebase",A7="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ol(T7,A7,"app");var vE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Gl,JC;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(w,F){function T(){}T.prototype=F.prototype,w.D=F.prototype,w.prototype=new T,w.prototype.constructor=w,w.C=function(N,D,P){for(var R=Array(arguments.length-2),Xe=2;Xe<arguments.length;Xe++)R[Xe-2]=arguments[Xe];return F.prototype[D].apply(N,R)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(w,F,T){T||(T=0);var N=Array(16);if(typeof F=="string")for(var D=0;16>D;++D)N[D]=F.charCodeAt(T++)|F.charCodeAt(T++)<<8|F.charCodeAt(T++)<<16|F.charCodeAt(T++)<<24;else for(D=0;16>D;++D)N[D]=F[T++]|F[T++]<<8|F[T++]<<16|F[T++]<<24;F=w.g[0],T=w.g[1],D=w.g[2];var P=w.g[3],R=F+(P^T&(D^P))+N[0]+3614090360&4294967295;F=T+(R<<7&4294967295|R>>>25),R=P+(D^F&(T^D))+N[1]+3905402710&4294967295,P=F+(R<<12&4294967295|R>>>20),R=D+(T^P&(F^T))+N[2]+606105819&4294967295,D=P+(R<<17&4294967295|R>>>15),R=T+(F^D&(P^F))+N[3]+3250441966&4294967295,T=D+(R<<22&4294967295|R>>>10),R=F+(P^T&(D^P))+N[4]+4118548399&4294967295,F=T+(R<<7&4294967295|R>>>25),R=P+(D^F&(T^D))+N[5]+1200080426&4294967295,P=F+(R<<12&4294967295|R>>>20),R=D+(T^P&(F^T))+N[6]+2821735955&4294967295,D=P+(R<<17&4294967295|R>>>15),R=T+(F^D&(P^F))+N[7]+4249261313&4294967295,T=D+(R<<22&4294967295|R>>>10),R=F+(P^T&(D^P))+N[8]+1770035416&4294967295,F=T+(R<<7&4294967295|R>>>25),R=P+(D^F&(T^D))+N[9]+2336552879&4294967295,P=F+(R<<12&4294967295|R>>>20),R=D+(T^P&(F^T))+N[10]+4294925233&4294967295,D=P+(R<<17&4294967295|R>>>15),R=T+(F^D&(P^F))+N[11]+2304563134&4294967295,T=D+(R<<22&4294967295|R>>>10),R=F+(P^T&(D^P))+N[12]+1804603682&4294967295,F=T+(R<<7&4294967295|R>>>25),R=P+(D^F&(T^D))+N[13]+4254626195&4294967295,P=F+(R<<12&4294967295|R>>>20),R=D+(T^P&(F^T))+N[14]+2792965006&4294967295,D=P+(R<<17&4294967295|R>>>15),R=T+(F^D&(P^F))+N[15]+1236535329&4294967295,T=D+(R<<22&4294967295|R>>>10),R=F+(D^P&(T^D))+N[1]+4129170786&4294967295,F=T+(R<<5&4294967295|R>>>27),R=P+(T^D&(F^T))+N[6]+3225465664&4294967295,P=F+(R<<9&4294967295|R>>>23),R=D+(F^T&(P^F))+N[11]+643717713&4294967295,D=P+(R<<14&4294967295|R>>>18),R=T+(P^F&(D^P))+N[0]+3921069994&4294967295,T=D+(R<<20&4294967295|R>>>12),R=F+(D^P&(T^D))+N[5]+3593408605&4294967295,F=T+(R<<5&4294967295|R>>>27),R=P+(T^D&(F^T))+N[10]+38016083&4294967295,P=F+(R<<9&4294967295|R>>>23),R=D+(F^T&(P^F))+N[15]+3634488961&4294967295,D=P+(R<<14&4294967295|R>>>18),R=T+(P^F&(D^P))+N[4]+3889429448&4294967295,T=D+(R<<20&4294967295|R>>>12),R=F+(D^P&(T^D))+N[9]+568446438&4294967295,F=T+(R<<5&4294967295|R>>>27),R=P+(T^D&(F^T))+N[14]+3275163606&4294967295,P=F+(R<<9&4294967295|R>>>23),R=D+(F^T&(P^F))+N[3]+4107603335&4294967295,D=P+(R<<14&4294967295|R>>>18),R=T+(P^F&(D^P))+N[8]+1163531501&4294967295,T=D+(R<<20&4294967295|R>>>12),R=F+(D^P&(T^D))+N[13]+2850285829&4294967295,F=T+(R<<5&4294967295|R>>>27),R=P+(T^D&(F^T))+N[2]+4243563512&4294967295,P=F+(R<<9&4294967295|R>>>23),R=D+(F^T&(P^F))+N[7]+1735328473&4294967295,D=P+(R<<14&4294967295|R>>>18),R=T+(P^F&(D^P))+N[12]+2368359562&4294967295,T=D+(R<<20&4294967295|R>>>12),R=F+(T^D^P)+N[5]+4294588738&4294967295,F=T+(R<<4&4294967295|R>>>28),R=P+(F^T^D)+N[8]+2272392833&4294967295,P=F+(R<<11&4294967295|R>>>21),R=D+(P^F^T)+N[11]+1839030562&4294967295,D=P+(R<<16&4294967295|R>>>16),R=T+(D^P^F)+N[14]+4259657740&4294967295,T=D+(R<<23&4294967295|R>>>9),R=F+(T^D^P)+N[1]+2763975236&4294967295,F=T+(R<<4&4294967295|R>>>28),R=P+(F^T^D)+N[4]+1272893353&4294967295,P=F+(R<<11&4294967295|R>>>21),R=D+(P^F^T)+N[7]+4139469664&4294967295,D=P+(R<<16&4294967295|R>>>16),R=T+(D^P^F)+N[10]+3200236656&4294967295,T=D+(R<<23&4294967295|R>>>9),R=F+(T^D^P)+N[13]+681279174&4294967295,F=T+(R<<4&4294967295|R>>>28),R=P+(F^T^D)+N[0]+3936430074&4294967295,P=F+(R<<11&4294967295|R>>>21),R=D+(P^F^T)+N[3]+3572445317&4294967295,D=P+(R<<16&4294967295|R>>>16),R=T+(D^P^F)+N[6]+76029189&4294967295,T=D+(R<<23&4294967295|R>>>9),R=F+(T^D^P)+N[9]+3654602809&4294967295,F=T+(R<<4&4294967295|R>>>28),R=P+(F^T^D)+N[12]+3873151461&4294967295,P=F+(R<<11&4294967295|R>>>21),R=D+(P^F^T)+N[15]+530742520&4294967295,D=P+(R<<16&4294967295|R>>>16),R=T+(D^P^F)+N[2]+3299628645&4294967295,T=D+(R<<23&4294967295|R>>>9),R=F+(D^(T|~P))+N[0]+4096336452&4294967295,F=T+(R<<6&4294967295|R>>>26),R=P+(T^(F|~D))+N[7]+1126891415&4294967295,P=F+(R<<10&4294967295|R>>>22),R=D+(F^(P|~T))+N[14]+2878612391&4294967295,D=P+(R<<15&4294967295|R>>>17),R=T+(P^(D|~F))+N[5]+4237533241&4294967295,T=D+(R<<21&4294967295|R>>>11),R=F+(D^(T|~P))+N[12]+1700485571&4294967295,F=T+(R<<6&4294967295|R>>>26),R=P+(T^(F|~D))+N[3]+2399980690&4294967295,P=F+(R<<10&4294967295|R>>>22),R=D+(F^(P|~T))+N[10]+4293915773&4294967295,D=P+(R<<15&4294967295|R>>>17),R=T+(P^(D|~F))+N[1]+2240044497&4294967295,T=D+(R<<21&4294967295|R>>>11),R=F+(D^(T|~P))+N[8]+1873313359&4294967295,F=T+(R<<6&4294967295|R>>>26),R=P+(T^(F|~D))+N[15]+4264355552&4294967295,P=F+(R<<10&4294967295|R>>>22),R=D+(F^(P|~T))+N[6]+2734768916&4294967295,D=P+(R<<15&4294967295|R>>>17),R=T+(P^(D|~F))+N[13]+1309151649&4294967295,T=D+(R<<21&4294967295|R>>>11),R=F+(D^(T|~P))+N[4]+4149444226&4294967295,F=T+(R<<6&4294967295|R>>>26),R=P+(T^(F|~D))+N[11]+3174756917&4294967295,P=F+(R<<10&4294967295|R>>>22),R=D+(F^(P|~T))+N[2]+718787259&4294967295,D=P+(R<<15&4294967295|R>>>17),R=T+(P^(D|~F))+N[9]+3951481745&4294967295,w.g[0]=w.g[0]+F&4294967295,w.g[1]=w.g[1]+(D+(R<<21&4294967295|R>>>11))&4294967295,w.g[2]=w.g[2]+D&4294967295,w.g[3]=w.g[3]+P&4294967295}n.prototype.u=function(w,F){F===void 0&&(F=w.length);for(var T=F-this.blockSize,N=this.B,D=this.h,P=0;P<F;){if(D==0)for(;P<=T;)i(this,w,P),P+=this.blockSize;if(typeof w=="string"){for(;P<F;)if(N[D++]=w.charCodeAt(P++),D==this.blockSize){i(this,N),D=0;break}}else for(;P<F;)if(N[D++]=w[P++],D==this.blockSize){i(this,N),D=0;break}}this.h=D,this.o+=F},n.prototype.v=function(){var w=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);w[0]=128;for(var F=1;F<w.length-8;++F)w[F]=0;var T=8*this.o;for(F=w.length-8;F<w.length;++F)w[F]=T&255,T/=256;for(this.u(w),w=Array(16),F=T=0;4>F;++F)for(var N=0;32>N;N+=8)w[T++]=this.g[F]>>>N&255;return w};function s(w,F){var T=o;return Object.prototype.hasOwnProperty.call(T,w)?T[w]:T[w]=F(w)}function a(w,F){this.h=F;for(var T=[],N=!0,D=w.length-1;0<=D;D--){var P=w[D]|0;N&&P==F||(T[D]=P,N=!1)}this.g=T}var o={};function l(w){return-128<=w&&128>w?s(w,function(F){return new a([F|0],0>F?-1:0)}):new a([w|0],0>w?-1:0)}function u(w){if(isNaN(w)||!isFinite(w))return p;if(0>w)return S(u(-w));for(var F=[],T=1,N=0;w>=T;N++)F[N]=w/T|0,T*=4294967296;return new a(F,0)}function f(w,F){if(w.length==0)throw Error("number format error: empty string");if(F=F||10,2>F||36<F)throw Error("radix out of range: "+F);if(w.charAt(0)=="-")return S(f(w.substring(1),F));if(0<=w.indexOf("-"))throw Error('number format error: interior "-" character');for(var T=u(Math.pow(F,8)),N=p,D=0;D<w.length;D+=8){var P=Math.min(8,w.length-D),R=parseInt(w.substring(D,D+P),F);8>P?(P=u(Math.pow(F,P)),N=N.j(P).add(u(R))):(N=N.j(T),N=N.add(u(R)))}return N}var p=l(0),g=l(1),m=l(16777216);t=a.prototype,t.m=function(){if(x(this))return-S(this).m();for(var w=0,F=1,T=0;T<this.g.length;T++){var N=this.i(T);w+=(0<=N?N:4294967296+N)*F,F*=4294967296}return w},t.toString=function(w){if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(y(this))return"0";if(x(this))return"-"+S(this).toString(w);for(var F=u(Math.pow(w,6)),T=this,N="";;){var D=O(T,F).g;T=A(T,D.j(F));var P=((0<T.g.length?T.g[0]:T.h)>>>0).toString(w);if(T=D,y(T))return P+N;for(;6>P.length;)P="0"+P;N=P+N}},t.i=function(w){return 0>w?0:w<this.g.length?this.g[w]:this.h};function y(w){if(w.h!=0)return!1;for(var F=0;F<w.g.length;F++)if(w.g[F]!=0)return!1;return!0}function x(w){return w.h==-1}t.l=function(w){return w=A(this,w),x(w)?-1:y(w)?0:1};function S(w){for(var F=w.g.length,T=[],N=0;N<F;N++)T[N]=~w.g[N];return new a(T,~w.h).add(g)}t.abs=function(){return x(this)?S(this):this},t.add=function(w){for(var F=Math.max(this.g.length,w.g.length),T=[],N=0,D=0;D<=F;D++){var P=N+(this.i(D)&65535)+(w.i(D)&65535),R=(P>>>16)+(this.i(D)>>>16)+(w.i(D)>>>16);N=R>>>16,P&=65535,R&=65535,T[D]=R<<16|P}return new a(T,T[T.length-1]&-2147483648?-1:0)};function A(w,F){return w.add(S(F))}t.j=function(w){if(y(this)||y(w))return p;if(x(this))return x(w)?S(this).j(S(w)):S(S(this).j(w));if(x(w))return S(this.j(S(w)));if(0>this.l(m)&&0>w.l(m))return u(this.m()*w.m());for(var F=this.g.length+w.g.length,T=[],N=0;N<2*F;N++)T[N]=0;for(N=0;N<this.g.length;N++)for(var D=0;D<w.g.length;D++){var P=this.i(N)>>>16,R=this.i(N)&65535,Xe=w.i(D)>>>16,Se=w.i(D)&65535;T[2*N+2*D]+=R*Se,C(T,2*N+2*D),T[2*N+2*D+1]+=P*Se,C(T,2*N+2*D+1),T[2*N+2*D+1]+=R*Xe,C(T,2*N+2*D+1),T[2*N+2*D+2]+=P*Xe,C(T,2*N+2*D+2)}for(N=0;N<F;N++)T[N]=T[2*N+1]<<16|T[2*N];for(N=F;N<2*F;N++)T[N]=0;return new a(T,0)};function C(w,F){for(;(w[F]&65535)!=w[F];)w[F+1]+=w[F]>>>16,w[F]&=65535,F++}function E(w,F){this.g=w,this.h=F}function O(w,F){if(y(F))throw Error("division by zero");if(y(w))return new E(p,p);if(x(w))return F=O(S(w),F),new E(S(F.g),S(F.h));if(x(F))return F=O(w,S(F)),new E(S(F.g),F.h);if(30<w.g.length){if(x(w)||x(F))throw Error("slowDivide_ only works with positive integers.");for(var T=g,N=F;0>=N.l(w);)T=Q(T),N=Q(N);var D=H(T,1),P=H(N,1);for(N=H(N,2),T=H(T,2);!y(N);){var R=P.add(N);0>=R.l(w)&&(D=D.add(T),P=R),N=H(N,1),T=H(T,1)}return F=A(w,D.j(F)),new E(D,F)}for(D=p;0<=w.l(F);){for(T=Math.max(1,Math.floor(w.m()/F.m())),N=Math.ceil(Math.log(T)/Math.LN2),N=48>=N?1:Math.pow(2,N-48),P=u(T),R=P.j(F);x(R)||0<R.l(w);)T-=N,P=u(T),R=P.j(F);y(P)&&(P=g),D=D.add(P),w=A(w,R)}return new E(D,w)}t.A=function(w){return O(this,w).h},t.and=function(w){for(var F=Math.max(this.g.length,w.g.length),T=[],N=0;N<F;N++)T[N]=this.i(N)&w.i(N);return new a(T,this.h&w.h)},t.or=function(w){for(var F=Math.max(this.g.length,w.g.length),T=[],N=0;N<F;N++)T[N]=this.i(N)|w.i(N);return new a(T,this.h|w.h)},t.xor=function(w){for(var F=Math.max(this.g.length,w.g.length),T=[],N=0;N<F;N++)T[N]=this.i(N)^w.i(N);return new a(T,this.h^w.h)};function Q(w){for(var F=w.g.length+1,T=[],N=0;N<F;N++)T[N]=w.i(N)<<1|w.i(N-1)>>>31;return new a(T,w.h)}function H(w,F){var T=F>>5;F%=32;for(var N=w.g.length-T,D=[],P=0;P<N;P++)D[P]=0<F?w.i(P+T)>>>F|w.i(P+T+1)<<32-F:w.i(P+T);return new a(D,w.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,JC=n,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=u,a.fromString=f,Gl=a}).apply(typeof vE<"u"?vE:typeof self<"u"?self:typeof window<"u"?window:{});var J0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var ZC,Cd,ek,xh,Fx,tk,rk,nk;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(d,v,k){return d==Array.prototype||d==Object.prototype||(d[v]=k.value),d};function r(d){d=[typeof globalThis=="object"&&globalThis,d,typeof window=="object"&&window,typeof self=="object"&&self,typeof J0=="object"&&J0];for(var v=0;v<d.length;++v){var k=d[v];if(k&&k.Math==Math)return k}throw Error("Cannot find global object")}var n=r(this);function i(d,v){if(v)e:{var k=n;d=d.split(".");for(var B=0;B<d.length-1;B++){var ue=d[B];if(!(ue in k))break e;k=k[ue]}d=d[d.length-1],B=k[d],v=v(B),v!=B&&v!=null&&e(k,d,{configurable:!0,writable:!0,value:v})}}function s(d,v){d instanceof String&&(d+="");var k=0,B=!1,ue={next:function(){if(!B&&k<d.length){var xe=k++;return{value:v(xe,d[xe]),done:!1}}return B=!0,{done:!0,value:void 0}}};return ue[Symbol.iterator]=function(){return ue},ue}i("Array.prototype.values",function(d){return d||function(){return s(this,function(v,k){return k})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},o=this||self;function l(d){var v=typeof d;return v=v!="object"?v:d?Array.isArray(d)?"array":v:"null",v=="array"||v=="object"&&typeof d.length=="number"}function u(d){var v=typeof d;return v=="object"&&d!=null||v=="function"}function f(d,v,k){return d.call.apply(d.bind,arguments)}function p(d,v,k){if(!d)throw Error();if(2<arguments.length){var B=Array.prototype.slice.call(arguments,2);return function(){var ue=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(ue,B),d.apply(v,ue)}}return function(){return d.apply(v,arguments)}}function g(d,v,k){return g=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?f:p,g.apply(null,arguments)}function m(d,v){var k=Array.prototype.slice.call(arguments,1);return function(){var B=k.slice();return B.push.apply(B,arguments),d.apply(this,B)}}function y(d,v){function k(){}k.prototype=v.prototype,d.aa=v.prototype,d.prototype=new k,d.prototype.constructor=d,d.Qb=function(B,ue,xe){for(var He=Array(arguments.length-2),er=2;er<arguments.length;er++)He[er-2]=arguments[er];return v.prototype[ue].apply(B,He)}}function x(d){const v=d.length;if(0<v){const k=Array(v);for(let B=0;B<v;B++)k[B]=d[B];return k}return[]}function S(d,v){for(let k=1;k<arguments.length;k++){const B=arguments[k];if(l(B)){const ue=d.length||0,xe=B.length||0;d.length=ue+xe;for(let He=0;He<xe;He++)d[ue+He]=B[He]}else d.push(B)}}class A{constructor(v,k){this.i=v,this.j=k,this.h=0,this.g=null}get(){let v;return 0<this.h?(this.h--,v=this.g,this.g=v.next,v.next=null):v=this.i(),v}}function C(d){return/^[\s\xa0]*$/.test(d)}function E(){var d=o.navigator;return d&&(d=d.userAgent)?d:""}function O(d){return O[" "](d),d}O[" "]=function(){};var Q=E().indexOf("Gecko")!=-1&&!(E().toLowerCase().indexOf("webkit")!=-1&&E().indexOf("Edge")==-1)&&!(E().indexOf("Trident")!=-1||E().indexOf("MSIE")!=-1)&&E().indexOf("Edge")==-1;function H(d,v,k){for(const B in d)v.call(k,d[B],B,d)}function w(d,v){for(const k in d)v.call(void 0,d[k],k,d)}function F(d){const v={};for(const k in d)v[k]=d[k];return v}const T="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function N(d,v){let k,B;for(let ue=1;ue<arguments.length;ue++){B=arguments[ue];for(k in B)d[k]=B[k];for(let xe=0;xe<T.length;xe++)k=T[xe],Object.prototype.hasOwnProperty.call(B,k)&&(d[k]=B[k])}}function D(d){var v=1;d=d.split(":");const k=[];for(;0<v&&d.length;)k.push(d.shift()),v--;return d.length&&k.push(d.join(":")),k}function P(d){o.setTimeout(()=>{throw d},0)}function R(){var d=ie;let v=null;return d.g&&(v=d.g,d.g=d.g.next,d.g||(d.h=null),v.next=null),v}class Xe{constructor(){this.h=this.g=null}add(v,k){const B=Se.get();B.set(v,k),this.h?this.h.next=B:this.g=B,this.h=B}}var Se=new A(()=>new De,d=>d.reset());class De{constructor(){this.next=this.g=this.h=null}set(v,k){this.h=v,this.g=k,this.next=null}reset(){this.next=this.g=this.h=null}}let ke,Ce=!1,ie=new Xe,be=()=>{const d=o.Promise.resolve(void 0);ke=()=>{d.then(Me)}};var Me=()=>{for(var d;d=R();){try{d.h.call(d.g)}catch(k){P(k)}var v=Se;v.j(d),100>v.h&&(v.h++,d.next=v.g,v.g=d)}Ce=!1};function Y(){this.s=this.s,this.C=this.C}Y.prototype.s=!1,Y.prototype.ma=function(){this.s||(this.s=!0,this.N())},Y.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function re(d,v){this.type=d,this.g=this.target=v,this.defaultPrevented=!1}re.prototype.h=function(){this.defaultPrevented=!0};var ne=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var d=!1,v=Object.defineProperty({},"passive",{get:function(){d=!0}});try{const k=()=>{};o.addEventListener("test",k,v),o.removeEventListener("test",k,v)}catch{}return d}();function X(d,v){if(re.call(this,d?d.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,d){var k=this.type=d.type,B=d.changedTouches&&d.changedTouches.length?d.changedTouches[0]:null;if(this.target=d.target||d.srcElement,this.g=v,v=d.relatedTarget){if(Q){e:{try{O(v.nodeName);var ue=!0;break e}catch{}ue=!1}ue||(v=null)}}else k=="mouseover"?v=d.fromElement:k=="mouseout"&&(v=d.toElement);this.relatedTarget=v,B?(this.clientX=B.clientX!==void 0?B.clientX:B.pageX,this.clientY=B.clientY!==void 0?B.clientY:B.pageY,this.screenX=B.screenX||0,this.screenY=B.screenY||0):(this.clientX=d.clientX!==void 0?d.clientX:d.pageX,this.clientY=d.clientY!==void 0?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0),this.button=d.button,this.key=d.key||"",this.ctrlKey=d.ctrlKey,this.altKey=d.altKey,this.shiftKey=d.shiftKey,this.metaKey=d.metaKey,this.pointerId=d.pointerId||0,this.pointerType=typeof d.pointerType=="string"?d.pointerType:_e[d.pointerType]||"",this.state=d.state,this.i=d,d.defaultPrevented&&X.aa.h.call(this)}}y(X,re);var _e={2:"touch",3:"pen",4:"mouse"};X.prototype.h=function(){X.aa.h.call(this);var d=this.i;d.preventDefault?d.preventDefault():d.returnValue=!1};var Te="closure_listenable_"+(1e6*Math.random()|0),Le=0;function Ne(d,v,k,B,ue){this.listener=d,this.proxy=null,this.src=v,this.type=k,this.capture=!!B,this.ha=ue,this.key=++Le,this.da=this.fa=!1}function Ie(d){d.da=!0,d.listener=null,d.proxy=null,d.src=null,d.ha=null}function ot(d){this.src=d,this.g={},this.h=0}ot.prototype.add=function(d,v,k,B,ue){var xe=d.toString();d=this.g[xe],d||(d=this.g[xe]=[],this.h++);var He=Ot(d,v,B,ue);return-1<He?(v=d[He],k||(v.fa=!1)):(v=new Ne(v,this.src,xe,!!B,ue),v.fa=k,d.push(v)),v};function ee(d,v){var k=v.type;if(k in d.g){var B=d.g[k],ue=Array.prototype.indexOf.call(B,v,void 0),xe;(xe=0<=ue)&&Array.prototype.splice.call(B,ue,1),xe&&(Ie(v),d.g[k].length==0&&(delete d.g[k],d.h--))}}function Ot(d,v,k,B){for(var ue=0;ue<d.length;++ue){var xe=d[ue];if(!xe.da&&xe.listener==v&&xe.capture==!!k&&xe.ha==B)return ue}return-1}var wt="closure_lm_"+(1e6*Math.random()|0),Mt={};function St(d,v,k,B,ue){if(Array.isArray(v)){for(var xe=0;xe<v.length;xe++)St(d,v[xe],k,B,ue);return null}return k=Ui(k),d&&d[Te]?d.K(v,k,u(B)?!!B.capture:!1,ue):Ke(d,v,k,!1,B,ue)}function Ke(d,v,k,B,ue,xe){if(!v)throw Error("Invalid event type");var He=u(ue)?!!ue.capture:!!ue,er=Li(d);if(er||(d[wt]=er=new ot(d)),k=er.add(v,k,B,He,xe),k.proxy)return k;if(B=wr(),k.proxy=B,B.src=d,B.listener=k,d.addEventListener)ne||(ue=He),ue===void 0&&(ue=!1),d.addEventListener(v.toString(),B,ue);else if(d.attachEvent)d.attachEvent(Bi(v.toString()),B);else if(d.addListener&&d.removeListener)d.addListener(B);else throw Error("addEventListener and attachEvent are unavailable.");return k}function wr(){function d(k){return v.call(d.src,d.listener,k)}const v=ji;return d}function rn(d,v,k,B,ue){if(Array.isArray(v))for(var xe=0;xe<v.length;xe++)rn(d,v[xe],k,B,ue);else B=u(B)?!!B.capture:!!B,k=Ui(k),d&&d[Te]?(d=d.i,v=String(v).toString(),v in d.g&&(xe=d.g[v],k=Ot(xe,k,B,ue),-1<k&&(Ie(xe[k]),Array.prototype.splice.call(xe,k,1),xe.length==0&&(delete d.g[v],d.h--)))):d&&(d=Li(d))&&(v=d.g[v.toString()],d=-1,v&&(d=Ot(v,k,B,ue)),(k=-1<d?v[d]:null)&&Cn(k))}function Cn(d){if(typeof d!="number"&&d&&!d.da){var v=d.src;if(v&&v[Te])ee(v.i,d);else{var k=d.type,B=d.proxy;v.removeEventListener?v.removeEventListener(k,B,d.capture):v.detachEvent?v.detachEvent(Bi(k),B):v.addListener&&v.removeListener&&v.removeListener(B),(k=Li(v))?(ee(k,d),k.h==0&&(k.src=null,v[wt]=null)):Ie(d)}}}function Bi(d){return d in Mt?Mt[d]:Mt[d]="on"+d}function ji(d,v){if(d.da)d=!0;else{v=new X(v,this);var k=d.listener,B=d.ha||d.src;d.fa&&Cn(d),d=k.call(B,v)}return d}function Li(d){return d=d[wt],d instanceof ot?d:null}var Gr="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ui(d){return typeof d=="function"?d:(d[Gr]||(d[Gr]=function(v){return d.handleEvent(v)}),d[Gr])}function gr(){Y.call(this),this.i=new ot(this),this.M=this,this.F=null}y(gr,Y),gr.prototype[Te]=!0,gr.prototype.removeEventListener=function(d,v,k,B){rn(this,d,v,k,B)};function Kr(d,v){var k,B=d.F;if(B)for(k=[];B;B=B.F)k.push(B);if(d=d.M,B=v.type||v,typeof v=="string")v=new re(v,d);else if(v instanceof re)v.target=v.target||d;else{var ue=v;v=new re(B,d),N(v,ue)}if(ue=!0,k)for(var xe=k.length-1;0<=xe;xe--){var He=v.g=k[xe];ue=Nr(He,B,!0,v)&&ue}if(He=v.g=d,ue=Nr(He,B,!0,v)&&ue,ue=Nr(He,B,!1,v)&&ue,k)for(xe=0;xe<k.length;xe++)He=v.g=k[xe],ue=Nr(He,B,!1,v)&&ue}gr.prototype.N=function(){if(gr.aa.N.call(this),this.i){var d=this.i,v;for(v in d.g){for(var k=d.g[v],B=0;B<k.length;B++)Ie(k[B]);delete d.g[v],d.h--}}this.F=null},gr.prototype.K=function(d,v,k,B){return this.i.add(String(d),v,!1,k,B)},gr.prototype.L=function(d,v,k,B){return this.i.add(String(d),v,!0,k,B)};function Nr(d,v,k,B){if(v=d.i.g[String(v)],!v)return!0;v=v.concat();for(var ue=!0,xe=0;xe<v.length;++xe){var He=v[xe];if(He&&!He.da&&He.capture==k){var er=He.listener,bn=He.ha||He.src;He.fa&&ee(d.i,He),ue=er.call(bn,B)!==!1&&ue}}return ue&&!B.defaultPrevented}function Ai(d,v,k){if(typeof d=="function")k&&(d=g(d,k));else if(d&&typeof d.handleEvent=="function")d=g(d.handleEvent,d);else throw Error("Invalid listener argument");return 2147483647<Number(v)?-1:o.setTimeout(d,v||0)}function yt(d){d.g=Ai(()=>{d.g=null,d.i&&(d.i=!1,yt(d))},d.l);const v=d.h;d.h=null,d.m.apply(null,v)}class Rr extends Y{constructor(v,k){super(),this.m=v,this.l=k,this.h=null,this.i=!1,this.g=null}j(v){this.h=arguments,this.g?this.i=!0:yt(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Lr(d){Y.call(this),this.h=d,this.g={}}y(Lr,Y);var Ur=[];function Bn(d){H(d.g,function(v,k){this.g.hasOwnProperty(k)&&Cn(v)},d),d.g={}}Lr.prototype.N=function(){Lr.aa.N.call(this),Bn(this)},Lr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var yo=o.JSON.stringify,_o=o.JSON.parse,$u=class{stringify(d){return o.JSON.stringify(d,void 0)}parse(d){return o.JSON.parse(d,void 0)}};function Vs(){}Vs.prototype.h=null;function Al(d){return d.h||(d.h=d.i())}function la(){}var ja={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function zs(){re.call(this,"d")}y(zs,re);function ce(){re.call(this,"c")}y(ce,re);var ur={},ca=null;function La(){return ca=ca||new gr}ur.La="serverreachability";function Ua(d){re.call(this,ur.La,d)}y(Ua,re);function ys(d){const v=La();Kr(v,new Ua(v))}ur.STAT_EVENT="statevent";function ua(d,v){re.call(this,ur.STAT_EVENT,d),this.stat=v}y(ua,re);function Vr(d){const v=La();Kr(v,new ua(v,d))}ur.Ma="timingevent";function kn(d,v){re.call(this,ur.Ma,d),this.size=v}y(kn,re);function _s(d,v){if(typeof d!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){d()},v)}function Es(){this.g=!0}Es.prototype.xa=function(){this.g=!1};function Gu(d,v,k,B,ue,xe){d.info(function(){if(d.g)if(xe)for(var He="",er=xe.split("&"),bn=0;bn<er.length;bn++){var Qt=er[bn].split("=");if(1<Qt.length){var In=Qt[0];Qt=Qt[1];var Ln=In.split("_");He=2<=Ln.length&&Ln[1]=="type"?He+(In+"="+Qt+"&"):He+(In+"=redacted&")}}else He=null;else He=xe;return"XMLHTTP REQ ("+B+") [attempt "+ue+"]: "+v+`
`+k+`
`+He})}function Ci(d,v,k,B,ue,xe,He){d.info(function(){return"XMLHTTP RESP ("+B+") [ attempt "+ue+"]: "+v+`
`+k+`
`+xe+" "+He})}function I(d,v,k,B){d.info(function(){return"XMLHTTP TEXT ("+v+"): "+j(d,k)+(B?" "+B:"")})}function G(d,v){d.info(function(){return"TIMEOUT: "+v})}Es.prototype.info=function(){};function j(d,v){if(!d.g)return v;if(!v)return null;try{var k=JSON.parse(v);if(k){for(d=0;d<k.length;d++)if(Array.isArray(k[d])){var B=k[d];if(!(2>B.length)){var ue=B[1];if(Array.isArray(ue)&&!(1>ue.length)){var xe=ue[0];if(xe!="noop"&&xe!="stop"&&xe!="close")for(var He=1;He<ue.length;He++)ue[He]=""}}}}return yo(k)}catch{return v}}var V={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},q={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},J;function pe(){}y(pe,Vs),pe.prototype.g=function(){return new XMLHttpRequest},pe.prototype.i=function(){return{}},J=new pe;function ve(d,v,k,B){this.j=d,this.i=v,this.l=k,this.R=B||1,this.U=new Lr(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new he}function he(){this.i=null,this.g="",this.h=!1}var de={},ge={};function we(d,v,k){d.L=1,d.v=pa(Vi(v)),d.m=k,d.P=!0,ze(d,null)}function ze(d,v){d.F=Date.now(),We(d),d.A=Vi(d.v);var k=d.A,B=d.R;Array.isArray(B)||(B=[String(B)]),un(k.i,"t",B),d.C=0,k=d.j.J,d.h=new he,d.g=Ts(d.j,k?v:null,!d.m),0<d.O&&(d.M=new Rr(g(d.Y,d,d.g),d.O)),v=d.U,k=d.g,B=d.ca;var ue="readystatechange";Array.isArray(ue)||(ue&&(Ur[0]=ue.toString()),ue=Ur);for(var xe=0;xe<ue.length;xe++){var He=St(k,ue[xe],B||v.handleEvent,!1,v.h||v);if(!He)break;v.g[He.key]=He}v=d.H?F(d.H):{},d.m?(d.u||(d.u="POST"),v["Content-Type"]="application/x-www-form-urlencoded",d.g.ea(d.A,d.u,d.m,v)):(d.u="GET",d.g.ea(d.A,d.u,null,v)),ys(),Gu(d.i,d.u,d.A,d.l,d.R,d.m)}ve.prototype.ca=function(d){d=d.target;const v=this.M;v&&Xr(d)==3?v.j():this.Y(d)},ve.prototype.Y=function(d){try{if(d==this.g)e:{const Ln=Xr(this.g);var v=this.g.Ba();const No=this.g.Z();if(!(3>Ln)&&(Ln!=3||this.g&&(this.h.h||this.g.oa()||oi(this.g)))){this.J||Ln!=4||v==7||(v==8||0>=No?ys(3):ys(2)),mr(this);var k=this.g.Z();this.X=k;t:if(je(this)){var B=oi(this.g);d="";var ue=B.length,xe=Xr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Xt(this),sr(this);var He="";break t}this.h.i=new o.TextDecoder}for(v=0;v<ue;v++)this.h.h=!0,d+=this.h.i.decode(B[v],{stream:!(xe&&v==ue-1)});B.length=0,this.h.g+=d,this.C=0,He=this.h.g}else He=this.g.oa();if(this.o=k==200,Ci(this.i,this.u,this.A,this.l,this.R,Ln,k),this.o){if(this.T&&!this.K){t:{if(this.g){var er,bn=this.g;if((er=bn.g?bn.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!C(er)){var Qt=er;break t}}Qt=null}if(k=Qt)I(this.i,this.l,k,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,ki(this,k);else{this.o=!1,this.s=3,Vr(12),Xt(this),sr(this);break e}}if(this.P){k=!0;let Hi;for(;!this.J&&this.C<He.length;)if(Hi=Pe(this,He),Hi==ge){Ln==4&&(this.s=4,Vr(14),k=!1),I(this.i,this.l,null,"[Incomplete Response]");break}else if(Hi==de){this.s=4,Vr(15),I(this.i,this.l,He,"[Invalid Chunk]"),k=!1;break}else I(this.i,this.l,Hi,null),ki(this,Hi);if(je(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ln!=4||He.length!=0||this.h.h||(this.s=1,Vr(16),k=!1),this.o=this.o&&k,!k)I(this.i,this.l,He,"[Invalid Chunked Response]"),Xt(this),sr(this);else if(0<He.length&&!this.W){this.W=!0;var In=this.j;In.g==this&&In.ba&&!In.M&&(In.j.info("Great, no buffering proxy detected. Bytes received: "+He.length),Zu(In),In.M=!0,Vr(11))}}else I(this.i,this.l,He,null),ki(this,He);Ln==4&&Xt(this),this.o&&!this.J&&(Ln==4?ns(this.j,this):(this.o=!1,We(this)))}else f0(this.g),k==400&&0<He.indexOf("Unknown SID")?(this.s=3,Vr(12)):(this.s=0,Vr(13)),Xt(this),sr(this)}}}catch{}finally{}};function je(d){return d.g?d.u=="GET"&&d.L!=2&&d.j.Ca:!1}function Pe(d,v){var k=d.C,B=v.indexOf(`
`,k);return B==-1?ge:(k=Number(v.substring(k,B)),isNaN(k)?de:(B+=1,B+k>v.length?ge:(v=v.slice(B,B+k),d.C=B+k,v)))}ve.prototype.cancel=function(){this.J=!0,Xt(this)};function We(d){d.S=Date.now()+d.I,ut(d,d.I)}function ut(d,v){if(d.B!=null)throw Error("WatchDog timer not null");d.B=_s(g(d.ba,d),v)}function mr(d){d.B&&(o.clearTimeout(d.B),d.B=null)}ve.prototype.ba=function(){this.B=null;const d=Date.now();0<=d-this.S?(G(this.i,this.A),this.L!=2&&(ys(),Vr(17)),Xt(this),this.s=2,sr(this)):ut(this,this.S-d)};function sr(d){d.j.G==0||d.J||ns(d.j,d)}function Xt(d){mr(d);var v=d.M;v&&typeof v.ma=="function"&&v.ma(),d.M=null,Bn(d.U),d.g&&(v=d.g,d.g=null,v.abort(),v.ma())}function ki(d,v){try{var k=d.j;if(k.G!=0&&(k.g==d||Fr(k.h,d))){if(!d.K&&Fr(k.h,d)&&k.G==3){try{var B=k.Da.g.parse(v)}catch{B=null}if(Array.isArray(B)&&B.length==3){var ue=B;if(ue[0]==0){e:if(!k.u){if(k.g)if(k.g.F+3e3<d.F)Fl(k),$t(k);else break e;Ac(k),Vr(18)}}else k.za=ue[1],0<k.za-k.T&&37500>ue[2]&&k.F&&k.v==0&&!k.C&&(k.C=_s(g(k.Za,k),6e3));if(1>=da(k.h)&&k.ca){try{k.ca()}catch{}k.ca=void 0}}else Wa(k,11)}else if((d.K||k.g==d)&&Fl(k),!C(v))for(ue=k.Da.g.parse(v),v=0;v<ue.length;v++){let Qt=ue[v];if(k.T=Qt[0],Qt=Qt[1],k.G==2)if(Qt[0]=="c"){k.K=Qt[1],k.ia=Qt[2];const In=Qt[3];In!=null&&(k.la=In,k.j.info("VER="+k.la));const Ln=Qt[4];Ln!=null&&(k.Aa=Ln,k.j.info("SVER="+k.Aa));const No=Qt[5];No!=null&&typeof No=="number"&&0<No&&(B=1.5*No,k.L=B,k.j.info("backChannelRequestTimeoutMs_="+B)),B=k;const Hi=d.g;if(Hi){const Cc=Hi.g?Hi.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Cc){var xe=B.h;xe.g||Cc.indexOf("spdy")==-1&&Cc.indexOf("quic")==-1&&Cc.indexOf("h2")==-1||(xe.j=xe.l,xe.g=new Set,xe.h&&(za(xe,xe.h),xe.h=null))}if(B.D){const kc=Hi.g?Hi.g.getResponseHeader("X-HTTP-Session-Id"):null;kc&&(B.ya=kc,It(B.I,B.D,kc))}}k.G=3,k.l&&k.l.ua(),k.ba&&(k.R=Date.now()-d.F,k.j.info("Handshake RTT: "+k.R+"ms")),B=k;var He=d;if(B.qa=bl(B,B.J?B.ia:null,B.W),He.K){bt(B.h,He);var er=He,bn=B.L;bn&&(er.I=bn),er.B&&(mr(er),We(er)),B.g=He}else Ju(B);0<k.i.length&&Fo(k)}else Qt[0]!="stop"&&Qt[0]!="close"||Wa(k,7);else k.G==3&&(Qt[0]=="stop"||Qt[0]=="close"?Qt[0]=="stop"?Wa(k,7):xa(k):Qt[0]!="noop"&&k.l&&k.l.ta(Qt),k.v=0)}}ys(4)}catch{}}var Va=class{constructor(d,v){this.g=d,this.map=v}};function es(d){this.l=d||10,o.PerformanceNavigationTiming?(d=o.performance.getEntriesByType("navigation"),d=0<d.length&&(d[0].nextHopProtocol=="hq"||d[0].nextHopProtocol=="h2")):d=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=d?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function dr(d){return d.h?!0:d.g?d.g.size>=d.j:!1}function da(d){return d.h?1:d.g?d.g.size:0}function Fr(d,v){return d.h?d.h==v:d.g?d.g.has(v):!1}function za(d,v){d.g?d.g.add(v):d.h=v}function bt(d,v){d.h&&d.h==v?d.h=null:d.g&&d.g.has(v)&&d.g.delete(v)}es.prototype.cancel=function(){if(this.i=fa(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const d of this.g.values())d.cancel();this.g.clear()}};function fa(d){if(d.h!=null)return d.i.concat(d.h.D);if(d.g!=null&&d.g.size!==0){let v=d.i;for(const k of d.g.values())v=v.concat(k.D);return v}return x(d.i)}function qt(d){if(d.V&&typeof d.V=="function")return d.V();if(typeof Map<"u"&&d instanceof Map||typeof Set<"u"&&d instanceof Set)return Array.from(d.values());if(typeof d=="string")return d.split("");if(l(d)){for(var v=[],k=d.length,B=0;B<k;B++)v.push(d[B]);return v}v=[],k=0;for(B in d)v[k++]=d[B];return v}function ts(d){if(d.na&&typeof d.na=="function")return d.na();if(!d.V||typeof d.V!="function"){if(typeof Map<"u"&&d instanceof Map)return Array.from(d.keys());if(!(typeof Set<"u"&&d instanceof Set)){if(l(d)||typeof d=="string"){var v=[];d=d.length;for(var k=0;k<d;k++)v.push(k);return v}v=[],k=0;for(const B in d)v[k++]=B;return v}}}function xn(d,v){if(d.forEach&&typeof d.forEach=="function")d.forEach(v,void 0);else if(l(d)||typeof d=="string")Array.prototype.forEach.call(d,v,void 0);else for(var k=ts(d),B=qt(d),ue=B.length,xe=0;xe<ue;xe++)v.call(void 0,B[xe],k&&k[xe],d)}var ha=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Eo(d,v){if(d){d=d.split("&");for(var k=0;k<d.length;k++){var B=d[k].indexOf("="),ue=null;if(0<=B){var xe=d[k].substring(0,B);ue=d[k].substring(B+1)}else xe=d[k];v(xe,ue?decodeURIComponent(ue.replace(/\+/g," ")):"")}}}function Fi(d){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,d instanceof Fi){this.h=d.h,So(this,d.j),this.o=d.o,this.g=d.g,zi(this,d.s),this.l=d.l;var v=d.i,k=new jn;k.i=v.i,v.g&&(k.g=new Map(v.g),k.h=v.h),wo(this,k),this.m=d.m}else d&&(v=String(d).match(ha))?(this.h=!1,So(this,v[1]||"",!0),this.o=Kn(v[2]||""),this.g=Kn(v[3]||"",!0),zi(this,v[4]),this.l=Kn(v[5]||"",!0),wo(this,v[6]||"",!0),this.m=Kn(v[7]||"")):(this.h=!1,this.i=new jn(null,this.h))}Fi.prototype.toString=function(){var d=[],v=this.j;v&&d.push(ga(v,Ws,!0),":");var k=this.g;return(k||v=="file")&&(d.push("//"),(v=this.o)&&d.push(ga(v,Ws,!0),"@"),d.push(encodeURIComponent(String(k)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),k=this.s,k!=null&&d.push(":",String(k))),(k=this.l)&&(this.g&&k.charAt(0)!="/"&&d.push("/"),d.push(ga(k,k.charAt(0)=="/"?Ao:Ku,!0))),(k=this.i.toString())&&d.push("?",k),(k=this.m)&&d.push("#",ga(k,_c)),d.join("")};function Vi(d){return new Fi(d)}function So(d,v,k){d.j=k?Kn(v,!0):v,d.j&&(d.j=d.j.replace(/:$/,""))}function zi(d,v){if(v){if(v=Number(v),isNaN(v)||0>v)throw Error("Bad port number "+v);d.s=v}else d.s=null}function wo(d,v,k){v instanceof jn?(d.i=v,fg(d.i,d.h)):(k||(v=ga(v,Yn)),d.i=new jn(v,d.h))}function It(d,v,k){d.i.set(v,k)}function pa(d){return It(d,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),d}function Kn(d,v){return d?v?decodeURI(d.replace(/%25/g,"%2525")):decodeURIComponent(d):""}function ga(d,v,k){return typeof d=="string"?(d=encodeURI(d).replace(v,To),k&&(d=d.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d):null}function To(d){return d=d.charCodeAt(0),"%"+(d>>4&15).toString(16)+(d&15).toString(16)}var Ws=/[#\/\?@]/g,Ku=/[#\?:]/g,Ao=/[#\?]/g,Yn=/[#\?@]/g,_c=/#/g;function jn(d,v){this.h=this.g=null,this.i=d||null,this.j=!!v}function rs(d){d.g||(d.g=new Map,d.h=0,d.i&&Eo(d.i,function(v,k){d.add(decodeURIComponent(v.replace(/\+/g," ")),k)}))}t=jn.prototype,t.add=function(d,v){rs(this),this.i=null,d=Hs(this,d);var k=this.g.get(d);return k||this.g.set(d,k=[]),k.push(v),this.h+=1,this};function Wi(d,v){rs(d),v=Hs(d,v),d.g.has(v)&&(d.i=null,d.h-=d.g.get(v).length,d.g.delete(v))}function Ec(d,v){return rs(d),v=Hs(d,v),d.g.has(v)}t.forEach=function(d,v){rs(this),this.g.forEach(function(k,B){k.forEach(function(ue){d.call(v,ue,B,this)},this)},this)},t.na=function(){rs(this);const d=Array.from(this.g.values()),v=Array.from(this.g.keys()),k=[];for(let B=0;B<v.length;B++){const ue=d[B];for(let xe=0;xe<ue.length;xe++)k.push(v[B])}return k},t.V=function(d){rs(this);let v=[];if(typeof d=="string")Ec(this,d)&&(v=v.concat(this.g.get(Hs(this,d))));else{d=Array.from(this.g.values());for(let k=0;k<d.length;k++)v=v.concat(d[k])}return v},t.set=function(d,v){return rs(this),this.i=null,d=Hs(this,d),Ec(this,d)&&(this.h-=this.g.get(d).length),this.g.set(d,[v]),this.h+=1,this},t.get=function(d,v){return d?(d=this.V(d),0<d.length?String(d[0]):v):v};function un(d,v,k){Wi(d,v),0<k.length&&(d.i=null,d.g.set(Hs(d,v),x(k)),d.h+=k.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const d=[],v=Array.from(this.g.keys());for(var k=0;k<v.length;k++){var B=v[k];const xe=encodeURIComponent(String(B)),He=this.V(B);for(B=0;B<He.length;B++){var ue=xe;He[B]!==""&&(ue+="="+encodeURIComponent(String(He[B]))),d.push(ue)}}return this.i=d.join("&")};function Hs(d,v){return v=String(v),d.j&&(v=v.toLowerCase()),v}function fg(d,v){v&&!d.j&&(rs(d),d.i=null,d.g.forEach(function(k,B){var ue=B.toLowerCase();B!=ue&&(Wi(this,B),un(this,ue,k))},d)),d.j=v}function Sc(d,v){const k=new Es;if(o.Image){const B=new Image;B.onload=m(Ss,k,"TestLoadImage: loaded",!0,v,B),B.onerror=m(Ss,k,"TestLoadImage: error",!1,v,B),B.onabort=m(Ss,k,"TestLoadImage: abort",!1,v,B),B.ontimeout=m(Ss,k,"TestLoadImage: timeout",!1,v,B),o.setTimeout(function(){B.ontimeout&&B.ontimeout()},1e4),B.src=d}else v(!1)}function u0(d,v){const k=new Es,B=new AbortController,ue=setTimeout(()=>{B.abort(),Ss(k,"TestPingServer: timeout",!1,v)},1e4);fetch(d,{signal:B.signal}).then(xe=>{clearTimeout(ue),xe.ok?Ss(k,"TestPingServer: ok",!0,v):Ss(k,"TestPingServer: server error",!1,v)}).catch(()=>{clearTimeout(ue),Ss(k,"TestPingServer: error",!1,v)})}function Ss(d,v,k,B,ue){try{ue&&(ue.onload=null,ue.onerror=null,ue.onabort=null,ue.ontimeout=null),B(k)}catch{}}function Tt(){this.g=new $u}function Cl(d,v,k){const B=k||"";try{xn(d,function(ue,xe){let He=ue;u(ue)&&(He=yo(ue)),v.push(B+xe+"="+encodeURIComponent(He))})}catch(ue){throw v.push(B+"type="+encodeURIComponent("_badmap")),ue}}function Ar(d){this.l=d.Ub||null,this.j=d.eb||!1}y(Ar,Vs),Ar.prototype.g=function(){return new $s(this.l,this.j)},Ar.prototype.i=function(d){return function(){return d}}({});function $s(d,v){gr.call(this),this.D=d,this.o=v,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}y($s,gr),t=$s.prototype,t.open=function(d,v){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=d,this.A=v,this.readyState=1,ko(this)},t.send=function(d){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const v={headers:this.u,method:this.B,credentials:this.m,cache:void 0};d&&(v.body=d),(this.D||o).fetch(new Request(this.A,v)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Co(this)),this.readyState=0},t.Sa=function(d){if(this.g&&(this.l=d,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=d.headers,this.readyState=2,ko(this)),this.g&&(this.readyState=3,ko(this),this.g)))if(this.responseType==="arraybuffer")d.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in d){if(this.j=d.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Yu(this)}else d.text().then(this.Ra.bind(this),this.ga.bind(this))};function Yu(d){d.j.read().then(d.Pa.bind(d)).catch(d.ga.bind(d))}t.Pa=function(d){if(this.g){if(this.o&&d.value)this.response.push(d.value);else if(!this.o){var v=d.value?d.value:new Uint8Array(0);(v=this.v.decode(v,{stream:!d.done}))&&(this.response=this.responseText+=v)}d.done?Co(this):ko(this),this.readyState==3&&Yu(this)}},t.Ra=function(d){this.g&&(this.response=this.responseText=d,Co(this))},t.Qa=function(d){this.g&&(this.response=d,Co(this))},t.ga=function(){this.g&&Co(this)};function Co(d){d.readyState=4,d.l=null,d.j=null,d.v=null,ko(d)}t.setRequestHeader=function(d,v){this.u.append(d,v)},t.getResponseHeader=function(d){return this.h&&this.h.get(d.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const d=[],v=this.h.entries();for(var k=v.next();!k.done;)k=k.value,d.push(k[0]+": "+k[1]),k=v.next();return d.join(`\r
`)};function ko(d){d.onreadystatechange&&d.onreadystatechange.call(d)}Object.defineProperty($s.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(d){this.m=d?"include":"same-origin"}});function wc(d){let v="";return H(d,function(k,B){v+=B,v+=":",v+=k,v+=`\r
`}),v}function Tc(d,v,k){e:{for(B in k){var B=!1;break e}B=!0}B||(k=wc(k),typeof d=="string"?k!=null&&encodeURIComponent(String(k)):It(d,v,k))}function Dr(d){gr.call(this),this.headers=new Map,this.o=d||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}y(Dr,gr);var d0=/^https?$/i,kl=["POST","PUT"];t=Dr.prototype,t.Ha=function(d){this.J=d},t.ea=function(d,v,k,B){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+d);v=v?v.toUpperCase():"GET",this.D=d,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():J.g(),this.v=this.o?Al(this.o):Al(J),this.g.onreadystatechange=g(this.Ea,this);try{this.B=!0,this.g.open(v,String(d),!0),this.B=!1}catch(xe){Xu(this,xe);return}if(d=k||"",k=new Map(this.headers),B)if(Object.getPrototypeOf(B)===Object.prototype)for(var ue in B)k.set(ue,B[ue]);else if(typeof B.keys=="function"&&typeof B.get=="function")for(const xe of B.keys())k.set(xe,B.get(xe));else throw Error("Unknown input type for opt_headers: "+String(B));B=Array.from(k.keys()).find(xe=>xe.toLowerCase()=="content-type"),ue=o.FormData&&d instanceof o.FormData,!(0<=Array.prototype.indexOf.call(kl,v,void 0))||B||ue||k.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[xe,He]of k)this.g.setRequestHeader(xe,He);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Xn(this),this.u=!0,this.g.send(d),this.u=!1}catch(xe){Xu(this,xe)}};function Xu(d,v){d.h=!1,d.g&&(d.j=!0,d.g.abort(),d.j=!1),d.l=v,d.m=5,qu(d),Yr(d)}function qu(d){d.A||(d.A=!0,Kr(d,"complete"),Kr(d,"error"))}t.abort=function(d){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=d||7,Kr(this,"complete"),Kr(this,"abort"),Yr(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Yr(this,!0)),Dr.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Fn(this):this.bb())},t.bb=function(){Fn(this)};function Fn(d){if(d.h&&typeof a<"u"&&(!d.v[1]||Xr(d)!=4||d.Z()!=2)){if(d.u&&Xr(d)==4)Ai(d.Ea,0,d);else if(Kr(d,"readystatechange"),Xr(d)==4){d.h=!1;try{const He=d.Z();e:switch(He){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var v=!0;break e;default:v=!1}var k;if(!(k=v)){var B;if(B=He===0){var ue=String(d.D).match(ha)[1]||null;!ue&&o.self&&o.self.location&&(ue=o.self.location.protocol.slice(0,-1)),B=!d0.test(ue?ue.toLowerCase():"")}k=B}if(k)Kr(d,"complete"),Kr(d,"success");else{d.m=6;try{var xe=2<Xr(d)?d.g.statusText:""}catch{xe=""}d.l=xe+" ["+d.Z()+"]",qu(d)}}finally{Yr(d)}}}}function Yr(d,v){if(d.g){Xn(d);const k=d.g,B=d.v[0]?()=>{}:null;d.g=null,d.v=null,v||Kr(d,"ready");try{k.onreadystatechange=B}catch{}}}function Xn(d){d.I&&(o.clearTimeout(d.I),d.I=null)}t.isActive=function(){return!!this.g};function Xr(d){return d.g?d.g.readyState:0}t.Z=function(){try{return 2<Xr(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(d){if(this.g){var v=this.g.responseText;return d&&v.indexOf(d)==0&&(v=v.substring(d.length)),_o(v)}};function oi(d){try{if(!d.g)return null;if("response"in d.g)return d.g.response;switch(d.H){case"":case"text":return d.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in d.g)return d.g.mozResponseArrayBuffer}return null}catch{return null}}function f0(d){const v={};d=(d.g&&2<=Xr(d)&&d.g.getAllResponseHeaders()||"").split(`\r
`);for(let B=0;B<d.length;B++){if(C(d[B]))continue;var k=D(d[B]);const ue=k[0];if(k=k[1],typeof k!="string")continue;k=k.trim();const xe=v[ue]||[];v[ue]=xe,xe.push(k)}w(v,function(B){return B.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function ma(d,v,k){return k&&k.internalChannelParams&&k.internalChannelParams[d]||v}function Ht(d){this.Aa=0,this.i=[],this.j=new Es,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=ma("failFast",!1,d),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=ma("baseRetryDelayMs",5e3,d),this.cb=ma("retryDelaySeedMs",1e4,d),this.Wa=ma("forwardChannelMaxRetries",2,d),this.wa=ma("forwardChannelRequestTimeoutMs",2e4,d),this.pa=d&&d.xmlHttpFactory||void 0,this.Xa=d&&d.Tb||void 0,this.Ca=d&&d.useFetchStreams||!1,this.L=void 0,this.J=d&&d.supportsCrossDomainXhr||!1,this.K="",this.h=new es(d&&d.concurrentRequestLimit),this.Da=new Tt,this.P=d&&d.fastHandshake||!1,this.O=d&&d.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=d&&d.Rb||!1,d&&d.xa&&this.j.xa(),d&&d.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&d&&d.detectBufferingProxy||!1,this.ja=void 0,d&&d.longPollingTimeout&&0<d.longPollingTimeout&&(this.ja=d.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Ht.prototype,t.la=8,t.G=1,t.connect=function(d,v,k,B){Vr(0),this.W=d,this.H=v||{},k&&B!==void 0&&(this.H.OSID=k,this.H.OAID=B),this.F=this.X,this.I=bl(this,null,this.W),Fo(this)};function xa(d){if(qn(d),d.G==3){var v=d.U++,k=Vi(d.I);if(It(k,"SID",d.K),It(k,"RID",v),It(k,"TYPE","terminate"),ws(d,k),v=new ve(d,d.j,v),v.L=2,v.v=pa(Vi(k)),k=!1,o.navigator&&o.navigator.sendBeacon)try{k=o.navigator.sendBeacon(v.v.toString(),"")}catch{}!k&&o.Image&&(new Image().src=v.v,k=!0),k||(v.g=Ts(v.j,null),v.g.ea(v.v)),v.F=Date.now(),We(v)}p0(d)}function $t(d){d.g&&(Zu(d),d.g.cancel(),d.g=null)}function qn(d){$t(d),d.u&&(o.clearTimeout(d.u),d.u=null),Fl(d),d.h.cancel(),d.s&&(typeof d.s=="number"&&o.clearTimeout(d.s),d.s=null)}function Fo(d){if(!dr(d.h)&&!d.s){d.s=!0;var v=d.Ga;ke||be(),Ce||(ke(),Ce=!0),ie.add(v,d),d.B=0}}function Qu(d,v){return da(d.h)>=d.h.j-(d.s?1:0)?!1:d.s?(d.i=v.D.concat(d.i),!0):d.G==1||d.G==2||d.B>=(d.Va?0:d.Wa)?!1:(d.s=_s(g(d.Ga,d,v),h0(d,d.B)),d.B++,!0)}t.Ga=function(d){if(this.s)if(this.s=null,this.G==1){if(!d){this.U=Math.floor(1e5*Math.random()),d=this.U++;const ue=new ve(this,this.j,d);let xe=this.o;if(this.S&&(xe?(xe=F(xe),N(xe,this.S)):xe=this.S),this.m!==null||this.O||(ue.H=xe,xe=null),this.P)e:{for(var v=0,k=0;k<this.i.length;k++){t:{var B=this.i[k];if("__data__"in B.map&&(B=B.map.__data__,typeof B=="string")){B=B.length;break t}B=void 0}if(B===void 0)break;if(v+=B,4096<v){v=k;break e}if(v===4096||k===this.i.length-1){v=k+1;break e}}v=1e3}else v=1e3;v=va(this,ue,v),k=Vi(this.I),It(k,"RID",d),It(k,"CVER",22),this.D&&It(k,"X-HTTP-Session-Id",this.D),ws(this,k),xe&&(this.O?v="headers="+encodeURIComponent(String(wc(xe)))+"&"+v:this.m&&Tc(k,this.m,xe)),za(this.h,ue),this.Ua&&It(k,"TYPE","init"),this.P?(It(k,"$req",v),It(k,"SID","null"),ue.T=!0,we(ue,k,null)):we(ue,k,v),this.G=2}}else this.G==3&&(d?zr(this,d):this.i.length==0||dr(this.h)||zr(this))};function zr(d,v){var k;v?k=v.l:k=d.U++;const B=Vi(d.I);It(B,"SID",d.K),It(B,"RID",k),It(B,"AID",d.T),ws(d,B),d.m&&d.o&&Tc(B,d.m,d.o),k=new ve(d,d.j,k,d.B+1),d.m===null&&(k.H=d.o),v&&(d.i=v.D.concat(d.i)),v=va(d,k,1e3),k.I=Math.round(.5*d.wa)+Math.round(.5*d.wa*Math.random()),za(d.h,k),we(k,B,v)}function ws(d,v){d.H&&H(d.H,function(k,B){It(v,B,k)}),d.l&&xn({},function(k,B){It(v,B,k)})}function va(d,v,k){k=Math.min(d.i.length,k);var B=d.l?g(d.l.Na,d.l,d):null;e:{var ue=d.i;let xe=-1;for(;;){const He=["count="+k];xe==-1?0<k?(xe=ue[0].g,He.push("ofs="+xe)):xe=0:He.push("ofs="+xe);let er=!0;for(let bn=0;bn<k;bn++){let Qt=ue[bn].g;const In=ue[bn].map;if(Qt-=xe,0>Qt)xe=Math.max(0,ue[bn].g-100),er=!1;else try{Cl(In,He,"req"+Qt+"_")}catch{B&&B(In)}}if(er){B=He.join("&");break e}}}return d=d.i.splice(0,k),v.D=d,B}function Ju(d){if(!d.g&&!d.u){d.Y=1;var v=d.Fa;ke||be(),Ce||(ke(),Ce=!0),ie.add(v,d),d.v=0}}function Ac(d){return d.g||d.u||3<=d.v?!1:(d.Y++,d.u=_s(g(d.Fa,d),h0(d,d.v)),d.v++,!0)}t.Fa=function(){if(this.u=null,bo(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var d=2*this.R;this.j.info("BP detection timer enabled: "+d),this.A=_s(g(this.ab,this),d)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Vr(10),$t(this),bo(this))};function Zu(d){d.A!=null&&(o.clearTimeout(d.A),d.A=null)}function bo(d){d.g=new ve(d,d.j,"rpc",d.Y),d.m===null&&(d.g.H=d.o),d.g.O=0;var v=Vi(d.qa);It(v,"RID","rpc"),It(v,"SID",d.K),It(v,"AID",d.T),It(v,"CI",d.F?"0":"1"),!d.F&&d.ja&&It(v,"TO",d.ja),It(v,"TYPE","xmlhttp"),ws(d,v),d.m&&d.o&&Tc(v,d.m,d.o),d.L&&(d.g.I=d.L);var k=d.g;d=d.ia,k.L=1,k.v=pa(Vi(v)),k.m=null,k.P=!0,ze(k,d)}t.Za=function(){this.C!=null&&(this.C=null,$t(this),Ac(this),Vr(19))};function Fl(d){d.C!=null&&(o.clearTimeout(d.C),d.C=null)}function ns(d,v){var k=null;if(d.g==v){Fl(d),Zu(d),d.g=null;var B=2}else if(Fr(d.h,v))k=v.D,bt(d.h,v),B=1;else return;if(d.G!=0){if(v.o)if(B==1){k=v.m?v.m.length:0,v=Date.now()-v.F;var ue=d.B;B=La(),Kr(B,new kn(B,k)),Fo(d)}else Ju(d);else if(ue=v.s,ue==3||ue==0&&0<v.X||!(B==1&&Qu(d,v)||B==2&&Ac(d)))switch(k&&0<k.length&&(v=d.h,v.i=v.i.concat(k)),ue){case 1:Wa(d,5);break;case 4:Wa(d,10);break;case 3:Wa(d,6);break;default:Wa(d,2)}}}function h0(d,v){let k=d.Ta+Math.floor(Math.random()*d.cb);return d.isActive()||(k*=2),k*v}function Wa(d,v){if(d.j.info("Error code "+v),v==2){var k=g(d.fb,d),B=d.Xa;const ue=!B;B=new Fi(B||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||So(B,"https"),pa(B),ue?Sc(B.toString(),k):u0(B.toString(),k)}else Vr(2);d.G=0,d.l&&d.l.sa(v),p0(d),qn(d)}t.fb=function(d){d?(this.j.info("Successfully pinged google.com"),Vr(2)):(this.j.info("Failed to ping google.com"),Vr(1))};function p0(d){if(d.G=0,d.ka=[],d.l){const v=fa(d.h);(v.length!=0||d.i.length!=0)&&(S(d.ka,v),S(d.ka,d.i),d.h.i.length=0,x(d.i),d.i.length=0),d.l.ra()}}function bl(d,v,k){var B=k instanceof Fi?Vi(k):new Fi(k);if(B.g!="")v&&(B.g=v+"."+B.g),zi(B,B.s);else{var ue=o.location;B=ue.protocol,v=v?v+"."+ue.hostname:ue.hostname,ue=+ue.port;var xe=new Fi(null);B&&So(xe,B),v&&(xe.g=v),ue&&zi(xe,ue),k&&(xe.l=k),B=xe}return k=d.D,v=d.ya,k&&v&&It(B,k,v),It(B,"VER",d.la),ws(d,B),B}function Ts(d,v,k){if(v&&!d.J)throw Error("Can't create secondary domain capable XhrIo object.");return v=d.Ca&&!d.pa?new Dr(new Ar({eb:k})):new Dr(d.pa),v.Ha(d.J),v}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function ed(){}t=ed.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Io(){}Io.prototype.g=function(d,v){return new bi(d,v)};function bi(d,v){gr.call(this),this.g=new Ht(v),this.l=d,this.h=v&&v.messageUrlParams||null,d=v&&v.messageHeaders||null,v&&v.clientProtocolHeaderRequired&&(d?d["X-Client-Protocol"]="webchannel":d={"X-Client-Protocol":"webchannel"}),this.g.o=d,d=v&&v.initMessageHeaders||null,v&&v.messageContentType&&(d?d["X-WebChannel-Content-Type"]=v.messageContentType:d={"X-WebChannel-Content-Type":v.messageContentType}),v&&v.va&&(d?d["X-WebChannel-Client-Profile"]=v.va:d={"X-WebChannel-Client-Profile":v.va}),this.g.S=d,(d=v&&v.Sb)&&!C(d)&&(this.g.m=d),this.v=v&&v.supportsCrossDomainXhr||!1,this.u=v&&v.sendRawJson||!1,(v=v&&v.httpSessionIdParam)&&!C(v)&&(this.g.D=v,d=this.h,d!==null&&v in d&&(d=this.h,v in d&&delete d[v])),this.j=new Gs(this)}y(bi,gr),bi.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},bi.prototype.close=function(){xa(this.g)},bi.prototype.o=function(d){var v=this.g;if(typeof d=="string"){var k={};k.__data__=d,d=k}else this.u&&(k={},k.__data__=yo(d),d=k);v.i.push(new Va(v.Ya++,d)),v.G==3&&Fo(v)},bi.prototype.N=function(){this.g.l=null,delete this.j,xa(this.g),delete this.g,bi.aa.N.call(this)};function Cr(d){zs.call(this),d.__headers__&&(this.headers=d.__headers__,this.statusCode=d.__status__,delete d.__headers__,delete d.__status__);var v=d.__sm__;if(v){e:{for(const k in v){d=k;break e}d=void 0}(this.i=d)&&(d=this.i,v=v!==null&&d in v?v[d]:void 0),this.data=v}else this.data=d}y(Cr,zs);function li(){ce.call(this),this.status=1}y(li,ce);function Gs(d){this.g=d}y(Gs,ed),Gs.prototype.ua=function(){Kr(this.g,"a")},Gs.prototype.ta=function(d){Kr(this.g,new Cr(d))},Gs.prototype.sa=function(d){Kr(this.g,new li)},Gs.prototype.ra=function(){Kr(this.g,"b")},Io.prototype.createWebChannel=Io.prototype.g,bi.prototype.send=bi.prototype.o,bi.prototype.open=bi.prototype.m,bi.prototype.close=bi.prototype.close,nk=function(){return new Io},rk=function(){return La()},tk=ur,Fx={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},V.NO_ERROR=0,V.TIMEOUT=8,V.HTTP_ERROR=6,xh=V,q.COMPLETE="complete",ek=q,la.EventType=ja,ja.OPEN="a",ja.CLOSE="b",ja.ERROR="c",ja.MESSAGE="d",gr.prototype.listen=gr.prototype.K,Cd=la,Dr.prototype.listenOnce=Dr.prototype.L,Dr.prototype.getLastError=Dr.prototype.Ka,Dr.prototype.getLastErrorCode=Dr.prototype.Ba,Dr.prototype.getStatus=Dr.prototype.Z,Dr.prototype.getResponseJson=Dr.prototype.Oa,Dr.prototype.getResponseText=Dr.prototype.oa,Dr.prototype.send=Dr.prototype.ea,Dr.prototype.setWithCredentials=Dr.prototype.Ha,ZC=Dr}).apply(typeof J0<"u"?J0:typeof self<"u"?self:typeof window<"u"?window:{});const yE="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pi{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}pi.UNAUTHENTICATED=new pi(null),pi.GOOGLE_CREDENTIALS=new pi("google-credentials-uid"),pi.FIRST_PARTY=new pi("first-party-uid"),pi.MOCK_USER=new pi("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Uu="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ac=new kv("@firebase/firestore");function xd(){return ac.logLevel}function nt(t,...e){if(ac.logLevel<=Yt.DEBUG){const r=e.map(Iv);ac.debug(`Firestore (${Uu}): ${t}`,...r)}}function co(t,...e){if(ac.logLevel<=Yt.ERROR){const r=e.map(Iv);ac.error(`Firestore (${Uu}): ${t}`,...r)}}function Tu(t,...e){if(ac.logLevel<=Yt.WARN){const r=e.map(Iv);ac.warn(`Firestore (${Uu}): ${t}`,...r)}}function Iv(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Et(t="Unexpected state"){const e=`FIRESTORE (${Uu}) INTERNAL ASSERTION FAILED: `+t;throw co(e),new Error(e)}function Sr(t,e){t||Et()}function kt(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oe={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class dt extends vo{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ll{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ik{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class C7{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(pi.UNAUTHENTICATED))}shutdown(){}}class k7{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class F7{constructor(e){this.t=e,this.currentUser=pi.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){Sr(this.o===void 0);let n=this.i;const i=l=>this.i!==n?(n=this.i,r(l)):Promise.resolve();let s=new ll;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new ll,e.enqueueRetryable(()=>i(this.currentUser))};const a=()=>{const l=s;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},o=l=>{nt("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(l=>o(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?o(l):(nt("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new ll)}},0),a()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(nt("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Sr(typeof n.accessToken=="string"),new ik(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Sr(e===null||typeof e=="string"),new pi(e)}}class b7{constructor(e,r,n){this.l=e,this.h=r,this.P=n,this.type="FirstParty",this.user=pi.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class I7{constructor(e,r,n){this.l=e,this.h=r,this.P=n}getToken(){return Promise.resolve(new b7(this.l,this.h,this.P))}start(e,r){e.enqueueRetryable(()=>r(pi.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class N7{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class R7{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,r){Sr(this.o===void 0);const n=s=>{s.error!=null&&nt("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const a=s.token!==this.R;return this.R=s.token,nt("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?r(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>n(s))};const i=s=>{nt("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):nt("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(Sr(typeof r.token=="string"),this.R=r.token,new N7(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D7(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sk{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=Math.floor(256/e.length)*e.length;let n="";for(;n.length<20;){const i=D7(40);for(let s=0;s<i.length;++s)n.length<20&&i[s]<r&&(n+=e.charAt(i[s]%e.length))}return n}}function cr(t,e){return t<e?-1:t>e?1:0}function Au(t,e,r){return t.length===e.length&&t.every((n,i)=>r(n,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class On{constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new dt(Oe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new dt(Oe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<-62135596800)throw new dt(Oe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new dt(Oe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return On.fromMillis(Date.now())}static fromDate(e){return On.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*r));return new On(r,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?cr(this.nanoseconds,e.nanoseconds):cr(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ct{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Ct(e)}static min(){return new Ct(new On(0,0))}static max(){return new Ct(new On(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nf{constructor(e,r,n){r===void 0?r=0:r>e.length&&Et(),n===void 0?n=e.length-r:n>e.length-r&&Et(),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return Nf.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof Nf?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let i=0;i<n;i++){const s=e.get(i),a=r.get(i);if(s<a)return-1;if(s>a)return 1}return e.length<r.length?-1:e.length>r.length?1:0}}class on extends Nf{construct(e,r,n){return new on(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new dt(Oe.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(i=>i.length>0))}return new on(r)}static emptyPath(){return new on([])}}const P7=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ri extends Nf{construct(e,r,n){return new ri(e,r,n)}static isValidIdentifier(e){return P7.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ri.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new ri(["__name__"])}static fromServerFormat(e){const r=[];let n="",i=0;const s=()=>{if(n.length===0)throw new dt(Oe.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let a=!1;for(;i<e.length;){const o=e[i];if(o==="\\"){if(i+1===e.length)throw new dt(Oe.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new dt(Oe.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=l,i+=2}else o==="`"?(a=!a,i++):o!=="."||a?(n+=o,i++):(s(),i++)}if(s(),a)throw new dt(Oe.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ri(r)}static emptyPath(){return new ri([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ht{constructor(e){this.path=e}static fromPath(e){return new ht(on.fromString(e))}static fromName(e){return new ht(on.fromString(e).popFirst(5))}static empty(){return new ht(on.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&on.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return on.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ht(new on(e.slice()))}}function O7(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,i=Ct.fromTimestamp(n===1e9?new On(r+1,0):new On(r,n));return new ml(i,ht.empty(),e)}function M7(t){return new ml(t.readTime,t.key,-1)}class ml{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new ml(Ct.min(),ht.empty(),-1)}static max(){return new ml(Ct.max(),ht.empty(),-1)}}function B7(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=ht.comparator(t.documentKey,e.documentKey),r!==0?r:cr(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j7="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class L7{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function t0(t){if(t.code!==Oe.FAILED_PRECONDITION||t.message!==j7)throw t;nt("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Re{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&Et(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new Re((n,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(n,i)},this.catchCallback=s=>{this.wrapFailure(r,s).next(n,i)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof Re?r:Re.resolve(r)}catch(r){return Re.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):Re.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):Re.reject(r)}static resolve(e){return new Re((r,n)=>{r(e)})}static reject(e){return new Re((r,n)=>{n(e)})}static waitFor(e){return new Re((r,n)=>{let i=0,s=0,a=!1;e.forEach(o=>{++i,o.next(()=>{++s,a&&s===i&&r()},l=>n(l))}),a=!0,s===i&&r()})}static or(e){let r=Re.resolve(!1);for(const n of e)r=r.next(i=>i?Re.resolve(i):n());return r}static forEach(e,r){const n=[];return e.forEach((i,s)=>{n.push(r.call(this,i,s))}),this.waitFor(n)}static mapArray(e,r){return new Re((n,i)=>{const s=e.length,a=new Array(s);let o=0;for(let l=0;l<s;l++){const u=l;r(e[u]).next(f=>{a[u]=f,++o,o===s&&n(a)},f=>i(f))}})}static doWhile(e,r){return new Re((n,i)=>{const s=()=>{e()===!0?r().next(()=>{s()},i):n()};s()})}}function U7(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function r0(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nv{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ie(n),this.se=n=>r.writeSequenceNumber(n))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Nv.oe=-1;function Jp(t){return t==null}function fp(t){return t===0&&1/t==-1/0}function V7(t){return typeof t=="number"&&Number.isInteger(t)&&!fp(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _E(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function Vu(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function ak(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tn{constructor(e,r){this.comparator=e,this.root=r||Zn.EMPTY}insert(e,r){return new tn(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,Zn.BLACK,null,null))}remove(e){return new tn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Zn.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return r+n.left.size;i<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Z0(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Z0(this.root,e,this.comparator,!1)}getReverseIterator(){return new Z0(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Z0(this.root,e,this.comparator,!0)}}class Z0{constructor(e,r,n,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=r?n(e.key,r):1,r&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Zn{constructor(e,r,n,i,s){this.key=e,this.value=r,this.color=n??Zn.RED,this.left=i??Zn.EMPTY,this.right=s??Zn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,i,s){return new Zn(e??this.key,r??this.value,n??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let i=this;const s=n(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,r,n),null):s===0?i.copy(null,r,null,null,null):i.copy(null,null,null,null,i.right.insert(e,r,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Zn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,i=this;if(r(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,r),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),r(e,i.key)===0){if(i.right.isEmpty())return Zn.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,r))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Zn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Zn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Et();const e=this.left.check();if(e!==this.right.check())throw Et();return e+(this.isRed()?0:1)}}Zn.EMPTY=null,Zn.RED=!0,Zn.BLACK=!1;Zn.EMPTY=new class{constructor(){this.size=0}get key(){throw Et()}get value(){throw Et()}get color(){throw Et()}get left(){throw Et()}get right(){throw Et()}copy(e,r,n,i,s){return this}insert(e,r,n){return new Zn(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ii{constructor(e){this.comparator=e,this.data=new tn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;r(i.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new EE(this.data.getIterator())}getIteratorFrom(e){return new EE(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof ii)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const i=r.getNext().key,s=n.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new ii(this.comparator);return r.data=e,r}}class EE{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ta{constructor(e){this.fields=e,e.sort(ri.comparator)}static empty(){return new ta([])}unionWith(e){let r=new ii(ri.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new ta(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return Au(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ok extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ai{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new ok("Invalid base64 string: "+s):s}}(e);return new ai(r)}static fromUint8Array(e){const r=function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s}(e);return new ai(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return cr(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ai.EMPTY_BYTE_STRING=new ai("");const z7=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function xl(t){if(Sr(!!t),typeof t=="string"){let e=0;const r=z7.exec(t);if(Sr(!!r),r[1]){let i=r[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:hn(t.seconds),nanos:hn(t.nanos)}}function hn(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function oc(t){return typeof t=="string"?ai.fromBase64String(t):ai.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rv(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="server_timestamp"}function Dv(t){const e=t.mapValue.fields.__previous_value__;return Rv(e)?Dv(e):e}function Rf(t){const e=xl(t.mapValue.fields.__local_write_time__.timestampValue);return new On(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W7{constructor(e,r,n,i,s,a,o,l,u){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=o,this.longPollingOptions=l,this.useFetchStreams=u}}class Df{constructor(e,r){this.projectId=e,this.database=r||"(default)"}static empty(){return new Df("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Df&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eh={mapValue:{}};function lc(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Rv(t)?4:$7(t)?9007199254740991:H7(t)?10:11:Et()}function Pa(t,e){if(t===e)return!0;const r=lc(t);if(r!==lc(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Rf(t).isEqual(Rf(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const a=xl(i.timestampValue),o=xl(s.timestampValue);return a.seconds===o.seconds&&a.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return oc(i.bytesValue).isEqual(oc(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return hn(i.geoPointValue.latitude)===hn(s.geoPointValue.latitude)&&hn(i.geoPointValue.longitude)===hn(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return hn(i.integerValue)===hn(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const a=hn(i.doubleValue),o=hn(s.doubleValue);return a===o?fp(a)===fp(o):isNaN(a)&&isNaN(o)}return!1}(t,e);case 9:return Au(t.arrayValue.values||[],e.arrayValue.values||[],Pa);case 10:case 11:return function(i,s){const a=i.mapValue.fields||{},o=s.mapValue.fields||{};if(_E(a)!==_E(o))return!1;for(const l in a)if(a.hasOwnProperty(l)&&(o[l]===void 0||!Pa(a[l],o[l])))return!1;return!0}(t,e);default:return Et()}}function Pf(t,e){return(t.values||[]).find(r=>Pa(r,e))!==void 0}function Cu(t,e){if(t===e)return 0;const r=lc(t),n=lc(e);if(r!==n)return cr(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return cr(t.booleanValue,e.booleanValue);case 2:return function(s,a){const o=hn(s.integerValue||s.doubleValue),l=hn(a.integerValue||a.doubleValue);return o<l?-1:o>l?1:o===l?0:isNaN(o)?isNaN(l)?0:-1:1}(t,e);case 3:return SE(t.timestampValue,e.timestampValue);case 4:return SE(Rf(t),Rf(e));case 5:return cr(t.stringValue,e.stringValue);case 6:return function(s,a){const o=oc(s),l=oc(a);return o.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(s,a){const o=s.split("/"),l=a.split("/");for(let u=0;u<o.length&&u<l.length;u++){const f=cr(o[u],l[u]);if(f!==0)return f}return cr(o.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,a){const o=cr(hn(s.latitude),hn(a.latitude));return o!==0?o:cr(hn(s.longitude),hn(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return wE(t.arrayValue,e.arrayValue);case 10:return function(s,a){var o,l,u,f;const p=s.fields||{},g=a.fields||{},m=(o=p.value)===null||o===void 0?void 0:o.arrayValue,y=(l=g.value)===null||l===void 0?void 0:l.arrayValue,x=cr(((u=m==null?void 0:m.values)===null||u===void 0?void 0:u.length)||0,((f=y==null?void 0:y.values)===null||f===void 0?void 0:f.length)||0);return x!==0?x:wE(m,y)}(t.mapValue,e.mapValue);case 11:return function(s,a){if(s===eh.mapValue&&a===eh.mapValue)return 0;if(s===eh.mapValue)return 1;if(a===eh.mapValue)return-1;const o=s.fields||{},l=Object.keys(o),u=a.fields||{},f=Object.keys(u);l.sort(),f.sort();for(let p=0;p<l.length&&p<f.length;++p){const g=cr(l[p],f[p]);if(g!==0)return g;const m=Cu(o[l[p]],u[f[p]]);if(m!==0)return m}return cr(l.length,f.length)}(t.mapValue,e.mapValue);default:throw Et()}}function SE(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return cr(t,e);const r=xl(t),n=xl(e),i=cr(r.seconds,n.seconds);return i!==0?i:cr(r.nanos,n.nanos)}function wE(t,e){const r=t.values||[],n=e.values||[];for(let i=0;i<r.length&&i<n.length;++i){const s=Cu(r[i],n[i]);if(s)return s}return cr(r.length,n.length)}function ku(t){return bx(t)}function bx(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=xl(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return oc(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return ht.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",i=!0;for(const s of r.values||[])i?i=!1:n+=",",n+=bx(s);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let i="{",s=!0;for(const a of n)s?s=!1:i+=",",i+=`${a}:${bx(r.fields[a])}`;return i+"}"}(t.mapValue):Et()}function Ix(t){return!!t&&"integerValue"in t}function Pv(t){return!!t&&"arrayValue"in t}function TE(t){return!!t&&"nullValue"in t}function AE(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function vh(t){return!!t&&"mapValue"in t}function H7(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="__vector__"}function Kd(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Vu(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=Kd(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=Kd(t.arrayValue.values[r]);return e}return Object.assign({},t)}function $7(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ds{constructor(e){this.value=e}static empty(){return new Ds({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!vh(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=Kd(r)}setAll(e){let r=ri.emptyPath(),n={},i=[];e.forEach((a,o)=>{if(!r.isImmediateParentOf(o)){const l=this.getFieldsMap(r);this.applyChanges(l,n,i),n={},i=[],r=o.popLast()}a?n[o.lastSegment()]=Kd(a):i.push(o.lastSegment())});const s=this.getFieldsMap(r);this.applyChanges(s,n,i)}delete(e){const r=this.field(e.popLast());vh(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return Pa(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=r.mapValue.fields[e.get(n)];vh(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=i),r=i}return r.mapValue.fields}applyChanges(e,r,n){Vu(r,(i,s)=>e[i]=s);for(const i of n)delete e[i]}clone(){return new Ds(Kd(this.value))}}function lk(t){const e=[];return Vu(t.fields,(r,n)=>{const i=new ri([r]);if(vh(n)){const s=lk(n.mapValue).fields;if(s.length===0)e.push(i);else for(const a of s)e.push(i.child(a))}else e.push(i)}),new ta(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vi{constructor(e,r,n,i,s,a,o){this.key=e,this.documentType=r,this.version=n,this.readTime=i,this.createTime=s,this.data=a,this.documentState=o}static newInvalidDocument(e){return new vi(e,0,Ct.min(),Ct.min(),Ct.min(),Ds.empty(),0)}static newFoundDocument(e,r,n,i){return new vi(e,1,r,Ct.min(),n,i,0)}static newNoDocument(e,r){return new vi(e,2,r,Ct.min(),Ct.min(),Ds.empty(),0)}static newUnknownDocument(e,r){return new vi(e,3,r,Ct.min(),Ct.min(),Ds.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(Ct.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ds.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ds.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ct.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof vi&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new vi(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hp{constructor(e,r){this.position=e,this.inclusive=r}}function CE(t,e,r){let n=0;for(let i=0;i<t.position.length;i++){const s=e[i],a=t.position[i];if(s.field.isKeyField()?n=ht.comparator(ht.fromName(a.referenceValue),r.key):n=Cu(a,r.data.field(s.field)),s.dir==="desc"&&(n*=-1),n!==0)break}return n}function kE(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!Pa(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pp{constructor(e,r="asc"){this.field=e,this.dir=r}}function G7(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ck{}class Dn extends ck{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new Y7(e,r,n):r==="array-contains"?new Q7(e,n):r==="in"?new J7(e,n):r==="not-in"?new Z7(e,n):r==="array-contains-any"?new eU(e,n):new Dn(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new X7(e,n):new q7(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&this.matchesComparison(Cu(r,this.value)):r!==null&&lc(this.value)===lc(r)&&this.matchesComparison(Cu(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Et()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Oa extends ck{constructor(e,r){super(),this.filters=e,this.op=r,this.ae=null}static create(e,r){return new Oa(e,r)}matches(e){return uk(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function uk(t){return t.op==="and"}function dk(t){return K7(t)&&uk(t)}function K7(t){for(const e of t.filters)if(e instanceof Oa)return!1;return!0}function Nx(t){if(t instanceof Dn)return t.field.canonicalString()+t.op.toString()+ku(t.value);if(dk(t))return t.filters.map(e=>Nx(e)).join(",");{const e=t.filters.map(r=>Nx(r)).join(",");return`${t.op}(${e})`}}function fk(t,e){return t instanceof Dn?function(n,i){return i instanceof Dn&&n.op===i.op&&n.field.isEqual(i.field)&&Pa(n.value,i.value)}(t,e):t instanceof Oa?function(n,i){return i instanceof Oa&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((s,a,o)=>s&&fk(a,i.filters[o]),!0):!1}(t,e):void Et()}function hk(t){return t instanceof Dn?function(r){return`${r.field.canonicalString()} ${r.op} ${ku(r.value)}`}(t):t instanceof Oa?function(r){return r.op.toString()+" {"+r.getFilters().map(hk).join(" ,")+"}"}(t):"Filter"}class Y7 extends Dn{constructor(e,r,n){super(e,r,n),this.key=ht.fromName(n.referenceValue)}matches(e){const r=ht.comparator(e.key,this.key);return this.matchesComparison(r)}}class X7 extends Dn{constructor(e,r){super(e,"in",r),this.keys=pk("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class q7 extends Dn{constructor(e,r){super(e,"not-in",r),this.keys=pk("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function pk(t,e){var r;return(((r=e.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(n=>ht.fromName(n.referenceValue))}class Q7 extends Dn{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return Pv(r)&&Pf(r.arrayValue,this.value)}}class J7 extends Dn{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&Pf(this.value.arrayValue,r)}}class Z7 extends Dn{constructor(e,r){super(e,"not-in",r)}matches(e){if(Pf(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&!Pf(this.value.arrayValue,r)}}class eU extends Dn{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!Pv(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>Pf(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tU{constructor(e,r=null,n=[],i=[],s=null,a=null,o=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=i,this.limit=s,this.startAt=a,this.endAt=o,this.ue=null}}function FE(t,e=null,r=[],n=[],i=null,s=null,a=null){return new tU(t,e,r,n,i,s,a)}function Ov(t){const e=kt(t);if(e.ue===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>Nx(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(s){return s.field.canonicalString()+s.dir}(n)).join(","),Jp(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>ku(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>ku(n)).join(",")),e.ue=r}return e.ue}function Mv(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!G7(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!fk(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!kE(t.startAt,e.startAt)&&kE(t.endAt,e.endAt)}function Rx(t){return ht.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zp{constructor(e,r=null,n=[],i=[],s=null,a="F",o=null,l=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=i,this.limit=s,this.limitType=a,this.startAt=o,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function rU(t,e,r,n,i,s,a,o){return new Zp(t,e,r,n,i,s,a,o)}function eg(t){return new Zp(t)}function bE(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function nU(t){return t.collectionGroup!==null}function Yd(t){const e=kt(t);if(e.ce===null){e.ce=[];const r=new Set;for(const s of e.explicitOrderBy)e.ce.push(s),r.add(s.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let o=new ii(ri.comparator);return a.filters.forEach(l=>{l.getFlattenedFilters().forEach(u=>{u.isInequality()&&(o=o.add(u.field))})}),o})(e).forEach(s=>{r.has(s.canonicalString())||s.isKeyField()||e.ce.push(new pp(s,n))}),r.has(ri.keyField().canonicalString())||e.ce.push(new pp(ri.keyField(),n))}return e.ce}function Ia(t){const e=kt(t);return e.le||(e.le=iU(e,Yd(t))),e.le}function iU(t,e){if(t.limitType==="F")return FE(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new pp(i.field,s)});const r=t.endAt?new hp(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new hp(t.startAt.position,t.startAt.inclusive):null;return FE(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function Dx(t,e,r){return new Zp(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function tg(t,e){return Mv(Ia(t),Ia(e))&&t.limitType===e.limitType}function gk(t){return`${Ov(Ia(t))}|lt:${t.limitType}`}function Mc(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(i=>hk(i)).join(", ")}]`),Jp(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(i=>ku(i)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(i=>ku(i)).join(",")),`Target(${n})`}(Ia(t))}; limitType=${t.limitType})`}function rg(t,e){return e.isFoundDocument()&&function(n,i){const s=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):ht.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)}(t,e)&&function(n,i){for(const s of Yd(n))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(n,i){for(const s of n.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(n,i){return!(n.startAt&&!function(a,o,l){const u=CE(a,o,l);return a.inclusive?u<=0:u<0}(n.startAt,Yd(n),i)||n.endAt&&!function(a,o,l){const u=CE(a,o,l);return a.inclusive?u>=0:u>0}(n.endAt,Yd(n),i))}(t,e)}function sU(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function mk(t){return(e,r)=>{let n=!1;for(const i of Yd(t)){const s=aU(i,e,r);if(s!==0)return s;n=n||i.field.isKeyField()}return 0}}function aU(t,e,r){const n=t.field.isKeyField()?ht.comparator(e.key,r.key):function(s,a,o){const l=a.data.field(s),u=o.data.field(s);return l!==null&&u!==null?Cu(l,u):Et()}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return Et()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zu{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[i,s]of n)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,r]);i.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[r]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Vu(this.inner,(r,n)=>{for(const[i,s]of n)e(i,s)})}isEmpty(){return ak(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oU=new tn(ht.comparator);function uo(){return oU}const xk=new tn(ht.comparator);function kd(...t){let e=xk;for(const r of t)e=e.insert(r.key,r);return e}function vk(t){let e=xk;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function Ll(){return Xd()}function yk(){return Xd()}function Xd(){return new zu(t=>t.toString(),(t,e)=>t.isEqual(e))}const lU=new tn(ht.comparator),cU=new ii(ht.comparator);function Kt(...t){let e=cU;for(const r of t)e=e.add(r);return e}const uU=new ii(cr);function dU(){return uU}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bv(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:fp(e)?"-0":e}}function _k(t){return{integerValue:""+t}}function fU(t,e){return V7(e)?_k(e):Bv(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ng{constructor(){this._=void 0}}function hU(t,e,r){return t instanceof gp?function(i,s){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Rv(s)&&(s=Dv(s)),s&&(a.fields.__previous_value__=s),{mapValue:a}}(r,e):t instanceof Of?Sk(t,e):t instanceof Mf?wk(t,e):function(i,s){const a=Ek(i,s),o=IE(a)+IE(i.Pe);return Ix(a)&&Ix(i.Pe)?_k(o):Bv(i.serializer,o)}(t,e)}function pU(t,e,r){return t instanceof Of?Sk(t,e):t instanceof Mf?wk(t,e):r}function Ek(t,e){return t instanceof mp?function(n){return Ix(n)||function(s){return!!s&&"doubleValue"in s}(n)}(e)?e:{integerValue:0}:null}class gp extends ng{}class Of extends ng{constructor(e){super(),this.elements=e}}function Sk(t,e){const r=Tk(e);for(const n of t.elements)r.some(i=>Pa(i,n))||r.push(n);return{arrayValue:{values:r}}}class Mf extends ng{constructor(e){super(),this.elements=e}}function wk(t,e){let r=Tk(e);for(const n of t.elements)r=r.filter(i=>!Pa(i,n));return{arrayValue:{values:r}}}class mp extends ng{constructor(e,r){super(),this.serializer=e,this.Pe=r}}function IE(t){return hn(t.integerValue||t.doubleValue)}function Tk(t){return Pv(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function gU(t,e){return t.field.isEqual(e.field)&&function(n,i){return n instanceof Of&&i instanceof Of||n instanceof Mf&&i instanceof Mf?Au(n.elements,i.elements,Pa):n instanceof mp&&i instanceof mp?Pa(n.Pe,i.Pe):n instanceof gp&&i instanceof gp}(t.transform,e.transform)}class mU{constructor(e,r){this.version=e,this.transformResults=r}}class ro{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new ro}static exists(e){return new ro(void 0,e)}static updateTime(e){return new ro(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function yh(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class ig{}function Ak(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new kk(t.key,ro.none()):new n0(t.key,t.data,ro.none());{const r=t.data,n=Ds.empty();let i=new ii(ri.comparator);for(let s of e.fields)if(!i.has(s)){let a=r.field(s);a===null&&s.length>1&&(s=s.popLast(),a=r.field(s)),a===null?n.delete(s):n.set(s,a),i=i.add(s)}return new vc(t.key,n,new ta(i.toArray()),ro.none())}}function xU(t,e,r){t instanceof n0?function(i,s,a){const o=i.value.clone(),l=RE(i.fieldTransforms,s,a.transformResults);o.setAll(l),s.convertToFoundDocument(a.version,o).setHasCommittedMutations()}(t,e,r):t instanceof vc?function(i,s,a){if(!yh(i.precondition,s))return void s.convertToUnknownDocument(a.version);const o=RE(i.fieldTransforms,s,a.transformResults),l=s.data;l.setAll(Ck(i)),l.setAll(o),s.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(t,e,r):function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,r)}function qd(t,e,r,n){return t instanceof n0?function(s,a,o,l){if(!yh(s.precondition,a))return o;const u=s.value.clone(),f=DE(s.fieldTransforms,l,a);return u.setAll(f),a.convertToFoundDocument(a.version,u).setHasLocalMutations(),null}(t,e,r,n):t instanceof vc?function(s,a,o,l){if(!yh(s.precondition,a))return o;const u=DE(s.fieldTransforms,l,a),f=a.data;return f.setAll(Ck(s)),f.setAll(u),a.convertToFoundDocument(a.version,f).setHasLocalMutations(),o===null?null:o.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(p=>p.field))}(t,e,r,n):function(s,a,o){return yh(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):o}(t,e,r)}function vU(t,e){let r=null;for(const n of t.fieldTransforms){const i=e.data.field(n.field),s=Ek(n.transform,i||null);s!=null&&(r===null&&(r=Ds.empty()),r.set(n.field,s))}return r||null}function NE(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&Au(n,i,(s,a)=>gU(s,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class n0 extends ig{constructor(e,r,n,i=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class vc extends ig{constructor(e,r,n,i,s=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function Ck(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function RE(t,e,r){const n=new Map;Sr(t.length===r.length);for(let i=0;i<r.length;i++){const s=t[i],a=s.transform,o=e.data.field(s.field);n.set(s.field,pU(a,o,r[i]))}return n}function DE(t,e,r){const n=new Map;for(const i of t){const s=i.transform,a=r.data.field(i.field);n.set(i.field,hU(s,a,e))}return n}class kk extends ig{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class yU extends ig{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _U{constructor(e,r,n,i){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&xU(s,e,n[i])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=qd(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=qd(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=yk();return this.mutations.forEach(i=>{const s=e.get(i.key),a=s.overlayedDocument;let o=this.applyToLocalView(a,s.mutatedFields);o=r.has(i.key)?null:o;const l=Ak(a,o);l!==null&&n.set(i.key,l),a.isValidDocument()||a.convertToNoDocument(Ct.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),Kt())}isEqual(e){return this.batchId===e.batchId&&Au(this.mutations,e.mutations,(r,n)=>NE(r,n))&&Au(this.baseMutations,e.baseMutations,(r,n)=>NE(r,n))}}class jv{constructor(e,r,n,i){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=i}static from(e,r,n){Sr(e.mutations.length===n.length);let i=function(){return lU}();const s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,n[a].version);return new jv(e,r,n,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EU{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SU{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Sn,Zt;function wU(t){switch(t){default:return Et();case Oe.CANCELLED:case Oe.UNKNOWN:case Oe.DEADLINE_EXCEEDED:case Oe.RESOURCE_EXHAUSTED:case Oe.INTERNAL:case Oe.UNAVAILABLE:case Oe.UNAUTHENTICATED:return!1;case Oe.INVALID_ARGUMENT:case Oe.NOT_FOUND:case Oe.ALREADY_EXISTS:case Oe.PERMISSION_DENIED:case Oe.FAILED_PRECONDITION:case Oe.ABORTED:case Oe.OUT_OF_RANGE:case Oe.UNIMPLEMENTED:case Oe.DATA_LOSS:return!0}}function Fk(t){if(t===void 0)return co("GRPC error has no .code"),Oe.UNKNOWN;switch(t){case Sn.OK:return Oe.OK;case Sn.CANCELLED:return Oe.CANCELLED;case Sn.UNKNOWN:return Oe.UNKNOWN;case Sn.DEADLINE_EXCEEDED:return Oe.DEADLINE_EXCEEDED;case Sn.RESOURCE_EXHAUSTED:return Oe.RESOURCE_EXHAUSTED;case Sn.INTERNAL:return Oe.INTERNAL;case Sn.UNAVAILABLE:return Oe.UNAVAILABLE;case Sn.UNAUTHENTICATED:return Oe.UNAUTHENTICATED;case Sn.INVALID_ARGUMENT:return Oe.INVALID_ARGUMENT;case Sn.NOT_FOUND:return Oe.NOT_FOUND;case Sn.ALREADY_EXISTS:return Oe.ALREADY_EXISTS;case Sn.PERMISSION_DENIED:return Oe.PERMISSION_DENIED;case Sn.FAILED_PRECONDITION:return Oe.FAILED_PRECONDITION;case Sn.ABORTED:return Oe.ABORTED;case Sn.OUT_OF_RANGE:return Oe.OUT_OF_RANGE;case Sn.UNIMPLEMENTED:return Oe.UNIMPLEMENTED;case Sn.DATA_LOSS:return Oe.DATA_LOSS;default:return Et()}}(Zt=Sn||(Sn={}))[Zt.OK=0]="OK",Zt[Zt.CANCELLED=1]="CANCELLED",Zt[Zt.UNKNOWN=2]="UNKNOWN",Zt[Zt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Zt[Zt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Zt[Zt.NOT_FOUND=5]="NOT_FOUND",Zt[Zt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Zt[Zt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Zt[Zt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Zt[Zt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Zt[Zt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Zt[Zt.ABORTED=10]="ABORTED",Zt[Zt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Zt[Zt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Zt[Zt.INTERNAL=13]="INTERNAL",Zt[Zt.UNAVAILABLE=14]="UNAVAILABLE",Zt[Zt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TU(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AU=new Gl([4294967295,4294967295],0);function PE(t){const e=TU().encode(t),r=new JC;return r.update(e),new Uint8Array(r.digest())}function OE(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Gl([r,n],0),new Gl([i,s],0)]}class Lv{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new Fd(`Invalid padding: ${r}`);if(n<0)throw new Fd(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Fd(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new Fd(`Invalid padding when bitmap length is 0: ${r}`);this.Ie=8*e.length-r,this.Te=Gl.fromNumber(this.Ie)}Ee(e,r,n){let i=e.add(r.multiply(Gl.fromNumber(n)));return i.compare(AU)===1&&(i=new Gl([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const r=PE(e),[n,i]=OE(r);for(let s=0;s<this.hashCount;s++){const a=this.Ee(n,i,s);if(!this.de(a))return!1}return!0}static create(e,r,n){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new Lv(s,i,r);return n.forEach(o=>a.insert(o)),a}insert(e){if(this.Ie===0)return;const r=PE(e),[n,i]=OE(r);for(let s=0;s<this.hashCount;s++){const a=this.Ee(n,i,s);this.Ae(a)}}Ae(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class Fd extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sg{constructor(e,r,n,i,s){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const i=new Map;return i.set(e,i0.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new sg(Ct.min(),i,new tn(cr),uo(),Kt())}}class i0{constructor(e,r,n,i,s){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new i0(n,r,Kt(),Kt(),Kt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _h{constructor(e,r,n,i){this.Re=e,this.removedTargetIds=r,this.key=n,this.Ve=i}}class bk{constructor(e,r){this.targetId=e,this.me=r}}class Ik{constructor(e,r,n=ai.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=i}}class ME{constructor(){this.fe=0,this.ge=jE(),this.pe=ai.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Kt(),r=Kt(),n=Kt();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:r=r.add(i);break;case 1:n=n.add(i);break;default:Et()}}),new i0(this.pe,this.ye,e,r,n)}Ce(){this.we=!1,this.ge=jE()}Fe(e,r){this.we=!0,this.ge=this.ge.insert(e,r)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Sr(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class CU{constructor(e){this.Le=e,this.Be=new Map,this.ke=uo(),this.qe=BE(),this.Qe=new tn(cr)}Ke(e){for(const r of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(r,e.Ve):this.Ue(r,e.key,e.Ve);for(const r of e.removedTargetIds)this.Ue(r,e.key,e.Ve)}We(e){this.forEachTarget(e,r=>{const n=this.Ge(r);switch(e.state){case 0:this.ze(r)&&n.De(e.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(e.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(r);break;case 3:this.ze(r)&&(n.Ne(),n.De(e.resumeToken));break;case 4:this.ze(r)&&(this.je(r),n.De(e.resumeToken));break;default:Et()}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.Be.forEach((n,i)=>{this.ze(i)&&r(i)})}He(e){const r=e.targetId,n=e.me.count,i=this.Je(r);if(i){const s=i.target;if(Rx(s))if(n===0){const a=new ht(s.path);this.Ue(r,a,vi.newNoDocument(a,Ct.min()))}else Sr(n===1);else{const a=this.Ye(r);if(a!==n){const o=this.Ze(e),l=o?this.Xe(o,e,a):1;if(l!==0){this.je(r);const u=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(r,u)}}}}}Ze(e){const r=e.me.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:s=0}=r;let a,o;try{a=oc(n).toUint8Array()}catch(l){if(l instanceof ok)return Tu("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{o=new Lv(a,i,s)}catch(l){return Tu(l instanceof Fd?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return o.Ie===0?null:o}Xe(e,r,n){return r.me.count===n-this.nt(e,r.targetId)?0:2}nt(e,r){const n=this.Le.getRemoteKeysForTarget(r);let i=0;return n.forEach(s=>{const a=this.Le.tt(),o=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(o)||(this.Ue(r,s,null),i++)}),i}rt(e){const r=new Map;this.Be.forEach((s,a)=>{const o=this.Je(a);if(o){if(s.current&&Rx(o.target)){const l=new ht(o.target.path);this.ke.get(l)!==null||this.it(a,l)||this.Ue(a,l,vi.newNoDocument(l,e))}s.be&&(r.set(a,s.ve()),s.Ce())}});let n=Kt();this.qe.forEach((s,a)=>{let o=!0;a.forEachWhile(l=>{const u=this.Je(l);return!u||u.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)}),o&&(n=n.add(s))}),this.ke.forEach((s,a)=>a.setReadTime(e));const i=new sg(e,r,this.Qe,this.ke,n);return this.ke=uo(),this.qe=BE(),this.Qe=new tn(cr),i}$e(e,r){if(!this.ze(e))return;const n=this.it(e,r.key)?2:0;this.Ge(e).Fe(r.key,n),this.ke=this.ke.insert(r.key,r),this.qe=this.qe.insert(r.key,this.st(r.key).add(e))}Ue(e,r,n){if(!this.ze(e))return;const i=this.Ge(e);this.it(e,r)?i.Fe(r,1):i.Me(r),this.qe=this.qe.insert(r,this.st(r).delete(e)),n&&(this.ke=this.ke.insert(r,n))}removeTarget(e){this.Be.delete(e)}Ye(e){const r=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let r=this.Be.get(e);return r||(r=new ME,this.Be.set(e,r)),r}st(e){let r=this.qe.get(e);return r||(r=new ii(cr),this.qe=this.qe.insert(e,r)),r}ze(e){const r=this.Je(e)!==null;return r||nt("WatchChangeAggregator","Detected inactive target",e),r}Je(e){const r=this.Be.get(e);return r&&r.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new ME),this.Le.getRemoteKeysForTarget(e).forEach(r=>{this.Ue(e,r,null)})}it(e,r){return this.Le.getRemoteKeysForTarget(e).has(r)}}function BE(){return new tn(ht.comparator)}function jE(){return new tn(ht.comparator)}const kU={asc:"ASCENDING",desc:"DESCENDING"},FU={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},bU={and:"AND",or:"OR"};class IU{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function Px(t,e){return t.useProto3Json||Jp(e)?e:{value:e}}function xp(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Nk(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function NU(t,e){return xp(t,e.toTimestamp())}function Na(t){return Sr(!!t),Ct.fromTimestamp(function(r){const n=xl(r);return new On(n.seconds,n.nanos)}(t))}function Uv(t,e){return Ox(t,e).canonicalString()}function Ox(t,e){const r=function(i){return new on(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?r:r.child(e)}function Rk(t){const e=on.fromString(t);return Sr(Bk(e)),e}function Mx(t,e){return Uv(t.databaseId,e.path)}function dm(t,e){const r=Rk(e);if(r.get(1)!==t.databaseId.projectId)throw new dt(Oe.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new dt(Oe.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new ht(Pk(r))}function Dk(t,e){return Uv(t.databaseId,e)}function RU(t){const e=Rk(t);return e.length===4?on.emptyPath():Pk(e)}function Bx(t){return new on(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Pk(t){return Sr(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function LE(t,e,r){return{name:Mx(t,e),fields:r.value.mapValue.fields}}function DU(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:Et()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(u,f){return u.useProto3Json?(Sr(f===void 0||typeof f=="string"),ai.fromBase64String(f||"")):(Sr(f===void 0||f instanceof Buffer||f instanceof Uint8Array),ai.fromUint8Array(f||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,o=a&&function(u){const f=u.code===void 0?Oe.UNKNOWN:Fk(u.code);return new dt(f,u.message||"")}(a);r=new Ik(n,i,s,o||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const i=dm(t,n.document.name),s=Na(n.document.updateTime),a=n.document.createTime?Na(n.document.createTime):Ct.min(),o=new Ds({mapValue:{fields:n.document.fields}}),l=vi.newFoundDocument(i,s,a,o),u=n.targetIds||[],f=n.removedTargetIds||[];r=new _h(u,f,l.key,l)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const i=dm(t,n.document),s=n.readTime?Na(n.readTime):Ct.min(),a=vi.newNoDocument(i,s),o=n.removedTargetIds||[];r=new _h([],o,a.key,a)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const i=dm(t,n.document),s=n.removedTargetIds||[];r=new _h([],s,i,null)}else{if(!("filter"in e))return Et();{e.filter;const n=e.filter;n.targetId;const{count:i=0,unchangedNames:s}=n,a=new SU(i,s),o=n.targetId;r=new bk(o,a)}}return r}function PU(t,e){let r;if(e instanceof n0)r={update:LE(t,e.key,e.value)};else if(e instanceof kk)r={delete:Mx(t,e.key)};else if(e instanceof vc)r={update:LE(t,e.key,e.data),updateMask:WU(e.fieldMask)};else{if(!(e instanceof yU))return Et();r={verify:Mx(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(s,a){const o=a.transform;if(o instanceof gp)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof Of)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof Mf)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof mp)return{fieldPath:a.field.canonicalString(),increment:o.Pe};throw Et()}(0,n))),e.precondition.isNone||(r.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:NU(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Et()}(t,e.precondition)),r}function OU(t,e){return t&&t.length>0?(Sr(e!==void 0),t.map(r=>function(i,s){let a=i.updateTime?Na(i.updateTime):Na(s);return a.isEqual(Ct.min())&&(a=Na(s)),new mU(a,i.transformResults||[])}(r,e))):[]}function MU(t,e){return{documents:[Dk(t,e.path)]}}function BU(t,e){const r={structuredQuery:{}},n=e.path;let i;e.collectionGroup!==null?(i=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=Dk(t,i);const s=function(u){if(u.length!==0)return Mk(Oa.create(u,"and"))}(e.filters);s&&(r.structuredQuery.where=s);const a=function(u){if(u.length!==0)return u.map(f=>function(g){return{field:Bc(g.field),direction:UU(g.dir)}}(f))}(e.orderBy);a&&(r.structuredQuery.orderBy=a);const o=Px(t,e.limit);return o!==null&&(r.structuredQuery.limit=o),e.startAt&&(r.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{_t:r,parent:i}}function jU(t){let e=RU(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let i=null;if(n>0){Sr(n===1);const f=r.from[0];f.allDescendants?i=f.collectionId:e=e.child(f.collectionId)}let s=[];r.where&&(s=function(p){const g=Ok(p);return g instanceof Oa&&dk(g)?g.getFilters():[g]}(r.where));let a=[];r.orderBy&&(a=function(p){return p.map(g=>function(y){return new pp(jc(y.field),function(S){switch(S){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(y.direction))}(g))}(r.orderBy));let o=null;r.limit&&(o=function(p){let g;return g=typeof p=="object"?p.value:p,Jp(g)?null:g}(r.limit));let l=null;r.startAt&&(l=function(p){const g=!!p.before,m=p.values||[];return new hp(m,g)}(r.startAt));let u=null;return r.endAt&&(u=function(p){const g=!p.before,m=p.values||[];return new hp(m,g)}(r.endAt)),rU(e,i,a,s,o,"F",l,u)}function LU(t,e){const r=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Et()}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function Ok(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=jc(r.unaryFilter.field);return Dn.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=jc(r.unaryFilter.field);return Dn.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=jc(r.unaryFilter.field);return Dn.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=jc(r.unaryFilter.field);return Dn.create(a,"!=",{nullValue:"NULL_VALUE"});default:return Et()}}(t):t.fieldFilter!==void 0?function(r){return Dn.create(jc(r.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Et()}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return Oa.create(r.compositeFilter.filters.map(n=>Ok(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Et()}}(r.compositeFilter.op))}(t):Et()}function UU(t){return kU[t]}function VU(t){return FU[t]}function zU(t){return bU[t]}function Bc(t){return{fieldPath:t.canonicalString()}}function jc(t){return ri.fromServerFormat(t.fieldPath)}function Mk(t){return t instanceof Dn?function(r){if(r.op==="=="){if(AE(r.value))return{unaryFilter:{field:Bc(r.field),op:"IS_NAN"}};if(TE(r.value))return{unaryFilter:{field:Bc(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(AE(r.value))return{unaryFilter:{field:Bc(r.field),op:"IS_NOT_NAN"}};if(TE(r.value))return{unaryFilter:{field:Bc(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Bc(r.field),op:VU(r.op),value:r.value}}}(t):t instanceof Oa?function(r){const n=r.getFilters().map(i=>Mk(i));return n.length===1?n[0]:{compositeFilter:{op:zU(r.op),filters:n}}}(t):Et()}function WU(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function Bk(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qo{constructor(e,r,n,i,s=Ct.min(),a=Ct.min(),o=ai.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=o,this.expectedCount=l}withSequenceNumber(e){return new qo(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new qo(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new qo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new qo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HU{constructor(e){this.ct=e}}function $U(t){const e=jU({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Dx(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GU{constructor(){this.un=new KU}addToCollectionParentIndex(e,r){return this.un.add(r),Re.resolve()}getCollectionParents(e,r){return Re.resolve(this.un.getEntries(r))}addFieldIndex(e,r){return Re.resolve()}deleteFieldIndex(e,r){return Re.resolve()}deleteAllFieldIndexes(e){return Re.resolve()}createTargetIndexes(e,r){return Re.resolve()}getDocumentsMatchingTarget(e,r){return Re.resolve(null)}getIndexType(e,r){return Re.resolve(0)}getFieldIndexes(e,r){return Re.resolve([])}getNextCollectionGroupToUpdate(e){return Re.resolve(null)}getMinOffset(e,r){return Re.resolve(ml.min())}getMinOffsetFromCollectionGroup(e,r){return Re.resolve(ml.min())}updateCollectionGroup(e,r,n){return Re.resolve()}updateIndexEntries(e,r){return Re.resolve()}}class KU{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r]||new ii(on.comparator),s=!i.has(n);return this.index[r]=i.add(n),s}has(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r];return i&&i.has(n)}getEntries(e){return(this.index[e]||new ii(on.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fu{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new Fu(0)}static kn(){return new Fu(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YU{constructor(){this.changes=new zu(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,vi.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?Re.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XU{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qU{constructor(e,r,n,i){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,r))).next(i=>(n!==null&&qd(n.mutation,i,ta.empty(),On.now()),i))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,Kt()).next(()=>n))}getLocalViewOfDocuments(e,r,n=Kt()){const i=Ll();return this.populateOverlays(e,i,r).next(()=>this.computeViews(e,r,i,n).next(s=>{let a=kd();return s.forEach((o,l)=>{a=a.insert(o,l.overlayedDocument)}),a}))}getOverlayedDocuments(e,r){const n=Ll();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,Kt()))}populateOverlays(e,r,n){const i=[];return n.forEach(s=>{r.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((a,o)=>{r.set(a,o)})})}computeViews(e,r,n,i){let s=uo();const a=Xd(),o=function(){return Xd()}();return r.forEach((l,u)=>{const f=n.get(u.key);i.has(u.key)&&(f===void 0||f.mutation instanceof vc)?s=s.insert(u.key,u):f!==void 0?(a.set(u.key,f.mutation.getFieldMask()),qd(f.mutation,u,f.mutation.getFieldMask(),On.now())):a.set(u.key,ta.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((u,f)=>a.set(u,f)),r.forEach((u,f)=>{var p;return o.set(u,new XU(f,(p=a.get(u))!==null&&p!==void 0?p:null))}),o))}recalculateAndSaveOverlays(e,r){const n=Xd();let i=new tn((a,o)=>a-o),s=Kt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(a=>{for(const o of a)o.keys().forEach(l=>{const u=r.get(l);if(u===null)return;let f=n.get(l)||ta.empty();f=o.applyToLocalView(u,f),n.set(l,f);const p=(i.get(o.batchId)||Kt()).add(l);i=i.insert(o.batchId,p)})}).next(()=>{const a=[],o=i.getReverseIterator();for(;o.hasNext();){const l=o.getNext(),u=l.key,f=l.value,p=yk();f.forEach(g=>{if(!s.has(g)){const m=Ak(r.get(g),n.get(g));m!==null&&p.set(g,m),s=s.add(g)}}),a.push(this.documentOverlayCache.saveOverlays(e,u,p))}return Re.waitFor(a)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,i){return function(a){return ht.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):nU(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,i):this.getDocumentsMatchingCollectionQuery(e,r,n,i)}getNextDocuments(e,r,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,i).next(s=>{const a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,i-s.size):Re.resolve(Ll());let o=-1,l=s;return a.next(u=>Re.forEach(u,(f,p)=>(o<p.largestBatchId&&(o=p.largestBatchId),s.get(f)?Re.resolve():this.remoteDocumentCache.getEntry(e,f).next(g=>{l=l.insert(f,g)}))).next(()=>this.populateOverlays(e,u,s)).next(()=>this.computeViews(e,l,u,Kt())).next(f=>({batchId:o,changes:vk(f)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new ht(r)).next(n=>{let i=kd();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,r,n,i){const s=r.collectionGroup;let a=kd();return this.indexManager.getCollectionParents(e,s).next(o=>Re.forEach(o,l=>{const u=function(p,g){return new Zp(g,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)}(r,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,u,n,i).next(f=>{f.forEach((p,g)=>{a=a.insert(p,g)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,r,n,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,s,i))).next(a=>{s.forEach((l,u)=>{const f=u.getKey();a.get(f)===null&&(a=a.insert(f,vi.newInvalidDocument(f)))});let o=kd();return a.forEach((l,u)=>{const f=s.get(l);f!==void 0&&qd(f.mutation,u,ta.empty(),On.now()),rg(r,u)&&(o=o.insert(l,u))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QU{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,r){return Re.resolve(this.hr.get(r))}saveBundleMetadata(e,r){return this.hr.set(r.id,function(i){return{id:i.id,version:i.version,createTime:Na(i.createTime)}}(r)),Re.resolve()}getNamedQuery(e,r){return Re.resolve(this.Pr.get(r))}saveNamedQuery(e,r){return this.Pr.set(r.name,function(i){return{name:i.name,query:$U(i.bundledQuery),readTime:Na(i.readTime)}}(r)),Re.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JU{constructor(){this.overlays=new tn(ht.comparator),this.Ir=new Map}getOverlay(e,r){return Re.resolve(this.overlays.get(r))}getOverlays(e,r){const n=Ll();return Re.forEach(r,i=>this.getOverlay(e,i).next(s=>{s!==null&&n.set(i,s)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((i,s)=>{this.ht(e,r,s)}),Re.resolve()}removeOverlaysForBatchId(e,r,n){const i=this.Ir.get(n);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(n)),Re.resolve()}getOverlaysForCollection(e,r,n){const i=Ll(),s=r.length+1,a=new ht(r.child("")),o=this.overlays.getIteratorFrom(a);for(;o.hasNext();){const l=o.getNext().value,u=l.getKey();if(!r.isPrefixOf(u.path))break;u.path.length===s&&l.largestBatchId>n&&i.set(l.getKey(),l)}return Re.resolve(i)}getOverlaysForCollectionGroup(e,r,n,i){let s=new tn((u,f)=>u-f);const a=this.overlays.getIterator();for(;a.hasNext();){const u=a.getNext().value;if(u.getKey().getCollectionGroup()===r&&u.largestBatchId>n){let f=s.get(u.largestBatchId);f===null&&(f=Ll(),s=s.insert(u.largestBatchId,f)),f.set(u.getKey(),u)}}const o=Ll(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((u,f)=>o.set(u,f)),!(o.size()>=i)););return Re.resolve(o)}ht(e,r,n){const i=this.overlays.get(n.key);if(i!==null){const a=this.Ir.get(i.largestBatchId).delete(n.key);this.Ir.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(n.key,new EU(r,n));let s=this.Ir.get(r);s===void 0&&(s=Kt(),this.Ir.set(r,s)),this.Ir.set(r,s.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZU{constructor(){this.sessionToken=ai.EMPTY_BYTE_STRING}getSessionToken(e){return Re.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,Re.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vv{constructor(){this.Tr=new ii(zn.Er),this.dr=new ii(zn.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,r){const n=new zn(e,r);this.Tr=this.Tr.add(n),this.dr=this.dr.add(n)}Rr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Vr(new zn(e,r))}mr(e,r){e.forEach(n=>this.removeReference(n,r))}gr(e){const r=new ht(new on([])),n=new zn(r,e),i=new zn(r,e+1),s=[];return this.dr.forEachInRange([n,i],a=>{this.Vr(a),s.push(a.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const r=new ht(new on([])),n=new zn(r,e),i=new zn(r,e+1);let s=Kt();return this.dr.forEachInRange([n,i],a=>{s=s.add(a.key)}),s}containsKey(e){const r=new zn(e,0),n=this.Tr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class zn{constructor(e,r){this.key=e,this.wr=r}static Er(e,r){return ht.comparator(e.key,r.key)||cr(e.wr,r.wr)}static Ar(e,r){return cr(e.wr,r.wr)||ht.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eV{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.Sr=1,this.br=new ii(zn.Er)}checkEmpty(e){return Re.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,i){const s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new _U(s,r,n,i);this.mutationQueue.push(a);for(const o of i)this.br=this.br.add(new zn(o.key,s)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return Re.resolve(a)}lookupMutationBatch(e,r){return Re.resolve(this.Dr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,i=this.vr(n),s=i<0?0:i;return Re.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return Re.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return Re.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new zn(r,0),i=new zn(r,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([n,i],a=>{const o=this.Dr(a.wr);s.push(o)}),Re.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new ii(cr);return r.forEach(i=>{const s=new zn(i,0),a=new zn(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,a],o=>{n=n.add(o.wr)})}),Re.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,i=n.length+1;let s=n;ht.isDocumentKey(s)||(s=s.child(""));const a=new zn(new ht(s),0);let o=new ii(cr);return this.br.forEachWhile(l=>{const u=l.key.path;return!!n.isPrefixOf(u)&&(u.length===i&&(o=o.add(l.wr)),!0)},a),Re.resolve(this.Cr(o))}Cr(e){const r=[];return e.forEach(n=>{const i=this.Dr(n);i!==null&&r.push(i)}),r}removeMutationBatch(e,r){Sr(this.Fr(r.batchId,"removed")===0),this.mutationQueue.shift();let n=this.br;return Re.forEach(r.mutations,i=>{const s=new zn(i.key,r.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=n})}On(e){}containsKey(e,r){const n=new zn(r,0),i=this.br.firstAfterOrEqual(n);return Re.resolve(r.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,Re.resolve()}Fr(e,r){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const r=this.vr(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tV{constructor(e){this.Mr=e,this.docs=function(){return new tn(ht.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,i=this.docs.get(n),s=i?i.size:0,a=this.Mr(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return Re.resolve(n?n.document.mutableCopy():vi.newInvalidDocument(r))}getEntries(e,r){let n=uo();return r.forEach(i=>{const s=this.docs.get(i);n=n.insert(i,s?s.document.mutableCopy():vi.newInvalidDocument(i))}),Re.resolve(n)}getDocumentsMatchingQuery(e,r,n,i){let s=uo();const a=r.path,o=new ht(a.child("")),l=this.docs.getIteratorFrom(o);for(;l.hasNext();){const{key:u,value:{document:f}}=l.getNext();if(!a.isPrefixOf(u.path))break;u.path.length>a.length+1||B7(M7(f),n)<=0||(i.has(f.key)||rg(r,f))&&(s=s.insert(f.key,f.mutableCopy()))}return Re.resolve(s)}getAllFromCollectionGroup(e,r,n,i){Et()}Or(e,r){return Re.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new rV(this)}getSize(e){return Re.resolve(this.size)}}class rV extends YU{constructor(e){super(),this.cr=e}applyChanges(e){const r=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?r.push(this.cr.addEntry(e,i)):this.cr.removeEntry(n)}),Re.waitFor(r)}getFromCache(e,r){return this.cr.getEntry(e,r)}getAllFromCache(e,r){return this.cr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nV{constructor(e){this.persistence=e,this.Nr=new zu(r=>Ov(r),Mv),this.lastRemoteSnapshotVersion=Ct.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Vv,this.targetCount=0,this.kr=Fu.Bn()}forEachTarget(e,r){return this.Nr.forEach((n,i)=>r(i)),Re.resolve()}getLastRemoteSnapshotVersion(e){return Re.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Re.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),Re.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.Lr&&(this.Lr=r),Re.resolve()}Kn(e){this.Nr.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.kr=new Fu(r),this.highestTargetId=r),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,r){return this.Kn(r),this.targetCount+=1,Re.resolve()}updateTargetData(e,r){return this.Kn(r),Re.resolve()}removeTargetData(e,r){return this.Nr.delete(r.target),this.Br.gr(r.targetId),this.targetCount-=1,Re.resolve()}removeTargets(e,r,n){let i=0;const s=[];return this.Nr.forEach((a,o)=>{o.sequenceNumber<=r&&n.get(o.targetId)===null&&(this.Nr.delete(a),s.push(this.removeMatchingKeysForTargetId(e,o.targetId)),i++)}),Re.waitFor(s).next(()=>i)}getTargetCount(e){return Re.resolve(this.targetCount)}getTargetData(e,r){const n=this.Nr.get(r)||null;return Re.resolve(n)}addMatchingKeys(e,r,n){return this.Br.Rr(r,n),Re.resolve()}removeMatchingKeys(e,r,n){this.Br.mr(r,n);const i=this.persistence.referenceDelegate,s=[];return i&&r.forEach(a=>{s.push(i.markPotentiallyOrphaned(e,a))}),Re.waitFor(s)}removeMatchingKeysForTargetId(e,r){return this.Br.gr(r),Re.resolve()}getMatchingKeysForTargetId(e,r){const n=this.Br.yr(r);return Re.resolve(n)}containsKey(e,r){return Re.resolve(this.Br.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iV{constructor(e,r){this.qr={},this.overlays={},this.Qr=new Nv(0),this.Kr=!1,this.Kr=!0,this.$r=new ZU,this.referenceDelegate=e(this),this.Ur=new nV(this),this.indexManager=new GU,this.remoteDocumentCache=function(i){return new tV(i)}(n=>this.referenceDelegate.Wr(n)),this.serializer=new HU(r),this.Gr=new QU(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new JU,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.qr[e.toKey()];return n||(n=new eV(r,this.referenceDelegate),this.qr[e.toKey()]=n),n}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,r,n){nt("MemoryPersistence","Starting transaction:",e);const i=new sV(this.Qr.next());return this.referenceDelegate.zr(),n(i).next(s=>this.referenceDelegate.jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Hr(e,r){return Re.or(Object.values(this.qr).map(n=>()=>n.containsKey(e,r)))}}class sV extends L7{constructor(e){super(),this.currentSequenceNumber=e}}class zv{constructor(e){this.persistence=e,this.Jr=new Vv,this.Yr=null}static Zr(e){return new zv(e)}get Xr(){if(this.Yr)return this.Yr;throw Et()}addReference(e,r,n){return this.Jr.addReference(n,r),this.Xr.delete(n.toString()),Re.resolve()}removeReference(e,r,n){return this.Jr.removeReference(n,r),this.Xr.add(n.toString()),Re.resolve()}markPotentiallyOrphaned(e,r){return this.Xr.add(r.toString()),Re.resolve()}removeTarget(e,r){this.Jr.gr(r.targetId).forEach(i=>this.Xr.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(i=>{i.forEach(s=>this.Xr.add(s.toString()))}).next(()=>n.removeTargetData(e,r))}zr(){this.Yr=new Set}jr(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Re.forEach(this.Xr,n=>{const i=ht.fromPath(n);return this.ei(e,i).next(s=>{s||r.removeEntry(i,Ct.min())})}).next(()=>(this.Yr=null,r.apply(e)))}updateLimboDocument(e,r){return this.ei(e,r).next(n=>{n?this.Xr.delete(r.toString()):this.Xr.add(r.toString())})}Wr(e){return 0}ei(e,r){return Re.or([()=>Re.resolve(this.Jr.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Hr(e,r)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wv{constructor(e,r,n,i){this.targetId=e,this.fromCache=r,this.$i=n,this.Ui=i}static Wi(e,r){let n=Kt(),i=Kt();for(const s of r.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new Wv(e,r.fromCache,n,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aV{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oV{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return o9()?8:U7(wi())>0?6:4}()}initialize(e,r){this.Ji=e,this.indexManager=r,this.Gi=!0}getDocumentsMatchingQuery(e,r,n,i){const s={result:null};return this.Yi(e,r).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.Zi(e,r,i,n).next(a=>{s.result=a})}).next(()=>{if(s.result)return;const a=new aV;return this.Xi(e,r,a).next(o=>{if(s.result=o,this.zi)return this.es(e,r,a,o.size)})}).next(()=>s.result)}es(e,r,n,i){return n.documentReadCount<this.ji?(xd()<=Yt.DEBUG&&nt("QueryEngine","SDK will not create cache indexes for query:",Mc(r),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),Re.resolve()):(xd()<=Yt.DEBUG&&nt("QueryEngine","Query:",Mc(r),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.Hi*i?(xd()<=Yt.DEBUG&&nt("QueryEngine","The SDK decides to create cache indexes for query:",Mc(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ia(r))):Re.resolve())}Yi(e,r){if(bE(r))return Re.resolve(null);let n=Ia(r);return this.indexManager.getIndexType(e,n).next(i=>i===0?null:(r.limit!==null&&i===1&&(r=Dx(r,null,"F"),n=Ia(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(s=>{const a=Kt(...s);return this.Ji.getDocuments(e,a).next(o=>this.indexManager.getMinOffset(e,n).next(l=>{const u=this.ts(r,o);return this.ns(r,u,a,l.readTime)?this.Yi(e,Dx(r,null,"F")):this.rs(e,u,r,l)}))})))}Zi(e,r,n,i){return bE(r)||i.isEqual(Ct.min())?Re.resolve(null):this.Ji.getDocuments(e,n).next(s=>{const a=this.ts(r,s);return this.ns(r,a,n,i)?Re.resolve(null):(xd()<=Yt.DEBUG&&nt("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Mc(r)),this.rs(e,a,r,O7(i,-1)).next(o=>o))})}ts(e,r){let n=new ii(mk(e));return r.forEach((i,s)=>{rg(e,s)&&(n=n.add(s))}),n}ns(e,r,n,i){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const s=e.limitType==="F"?r.last():r.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Xi(e,r,n){return xd()<=Yt.DEBUG&&nt("QueryEngine","Using full collection scan to execute query:",Mc(r)),this.Ji.getDocumentsMatchingQuery(e,r,ml.min(),n)}rs(e,r,n,i){return this.Ji.getDocumentsMatchingQuery(e,n,i).next(s=>(r.forEach(a=>{s=s.insert(a.key,a)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lV{constructor(e,r,n,i){this.persistence=e,this.ss=r,this.serializer=i,this.os=new tn(cr),this._s=new zu(s=>Ov(s),Mv),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(n)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new qU(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.os))}}function cV(t,e,r,n){return new lV(t,e,r,n)}async function jk(t,e){const r=kt(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let i;return r.mutationQueue.getAllMutationBatches(n).next(s=>(i=s,r.ls(e),r.mutationQueue.getAllMutationBatches(n))).next(s=>{const a=[],o=[];let l=Kt();for(const u of i){a.push(u.batchId);for(const f of u.mutations)l=l.add(f.key)}for(const u of s){o.push(u.batchId);for(const f of u.mutations)l=l.add(f.key)}return r.localDocuments.getDocuments(n,l).next(u=>({hs:u,removedBatchIds:a,addedBatchIds:o}))})})}function uV(t,e){const r=kt(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=e.batch.keys(),s=r.cs.newChangeBuffer({trackRemovals:!0});return function(o,l,u,f){const p=u.batch,g=p.keys();let m=Re.resolve();return g.forEach(y=>{m=m.next(()=>f.getEntry(l,y)).next(x=>{const S=u.docVersions.get(y);Sr(S!==null),x.version.compareTo(S)<0&&(p.applyToRemoteDocument(x,u),x.isValidDocument()&&(x.setReadTime(u.commitVersion),f.addEntry(x)))})}),m.next(()=>o.mutationQueue.removeMutationBatch(l,p))}(r,n,e,s).next(()=>s.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(o){let l=Kt();for(let u=0;u<o.mutationResults.length;++u)o.mutationResults[u].transformResults.length>0&&(l=l.add(o.batch.mutations[u].key));return l}(e))).next(()=>r.localDocuments.getDocuments(n,i))})}function Lk(t){const e=kt(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Ur.getLastRemoteSnapshotVersion(r))}function dV(t,e){const r=kt(t),n=e.snapshotVersion;let i=r.os;return r.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const a=r.cs.newChangeBuffer({trackRemovals:!0});i=r.os;const o=[];e.targetChanges.forEach((f,p)=>{const g=i.get(p);if(!g)return;o.push(r.Ur.removeMatchingKeys(s,f.removedDocuments,p).next(()=>r.Ur.addMatchingKeys(s,f.addedDocuments,p)));let m=g.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(p)!==null?m=m.withResumeToken(ai.EMPTY_BYTE_STRING,Ct.min()).withLastLimboFreeSnapshotVersion(Ct.min()):f.resumeToken.approximateByteSize()>0&&(m=m.withResumeToken(f.resumeToken,n)),i=i.insert(p,m),function(x,S,A){return x.resumeToken.approximateByteSize()===0||S.snapshotVersion.toMicroseconds()-x.snapshotVersion.toMicroseconds()>=3e8?!0:A.addedDocuments.size+A.modifiedDocuments.size+A.removedDocuments.size>0}(g,m,f)&&o.push(r.Ur.updateTargetData(s,m))});let l=uo(),u=Kt();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&o.push(r.persistence.referenceDelegate.updateLimboDocument(s,f))}),o.push(fV(s,a,e.documentUpdates).next(f=>{l=f.Ps,u=f.Is})),!n.isEqual(Ct.min())){const f=r.Ur.getLastRemoteSnapshotVersion(s).next(p=>r.Ur.setTargetsMetadata(s,s.currentSequenceNumber,n));o.push(f)}return Re.waitFor(o).next(()=>a.apply(s)).next(()=>r.localDocuments.getLocalViewOfDocuments(s,l,u)).next(()=>l)}).then(s=>(r.os=i,s))}function fV(t,e,r){let n=Kt(),i=Kt();return r.forEach(s=>n=n.add(s)),e.getEntries(t,n).next(s=>{let a=uo();return r.forEach((o,l)=>{const u=s.get(o);l.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(o)),l.isNoDocument()&&l.version.isEqual(Ct.min())?(e.removeEntry(o,l.readTime),a=a.insert(o,l)):!u.isValidDocument()||l.version.compareTo(u.version)>0||l.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(l),a=a.insert(o,l)):nt("LocalStore","Ignoring outdated watch update for ",o,". Current version:",u.version," Watch version:",l.version)}),{Ps:a,Is:i}})}function hV(t,e){const r=kt(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=-1),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function pV(t,e){const r=kt(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return r.Ur.getTargetData(n,e).next(s=>s?(i=s,Re.resolve(i)):r.Ur.allocateTargetId(n).next(a=>(i=new qo(e,a,"TargetPurposeListen",n.currentSequenceNumber),r.Ur.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=r.os.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(r.os=r.os.insert(n.targetId,n),r._s.set(e,n.targetId)),n})}async function jx(t,e,r){const n=kt(t),i=n.os.get(e),s=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",s,a=>n.persistence.referenceDelegate.removeTarget(a,i))}catch(a){if(!r0(a))throw a;nt("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}n.os=n.os.remove(e),n._s.delete(i.target)}function UE(t,e,r){const n=kt(t);let i=Ct.min(),s=Kt();return n.persistence.runTransaction("Execute query","readwrite",a=>function(l,u,f){const p=kt(l),g=p._s.get(f);return g!==void 0?Re.resolve(p.os.get(g)):p.Ur.getTargetData(u,f)}(n,a,Ia(e)).next(o=>{if(o)return i=o.lastLimboFreeSnapshotVersion,n.Ur.getMatchingKeysForTargetId(a,o.targetId).next(l=>{s=l})}).next(()=>n.ss.getDocumentsMatchingQuery(a,e,r?i:Ct.min(),r?s:Kt())).next(o=>(gV(n,sU(e),o),{documents:o,Ts:s})))}function gV(t,e,r){let n=t.us.get(e)||Ct.min();r.forEach((i,s)=>{s.readTime.compareTo(n)>0&&(n=s.readTime)}),t.us.set(e,n)}class VE{constructor(){this.activeTargetIds=dU()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class mV{constructor(){this.so=new VE,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,r,n){this.oo[e]=r}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new VE,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xV{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zE{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){nt("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){nt("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let th=null;function fm(){return th===null?th=function(){return 268435456+Math.round(2147483648*Math.random())}():th++,"0x"+th.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vV={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yV{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fi="WebChannelConnection";class _V extends class{constructor(r){this.databaseInfo=r,this.databaseId=r.databaseId;const n=r.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=n+"://"+r.host,this.vo=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Fo(){return!1}Mo(r,n,i,s,a){const o=fm(),l=this.xo(r,n.toUriEncodedString());nt("RestConnection",`Sending RPC '${r}' ${o}:`,l,i);const u={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(u,s,a),this.No(r,l,u,i).then(f=>(nt("RestConnection",`Received RPC '${r}' ${o}: `,f),f),f=>{throw Tu("RestConnection",`RPC '${r}' ${o} failed with error: `,f,"url: ",l,"request:",i),f})}Lo(r,n,i,s,a,o){return this.Mo(r,n,i,s,a)}Oo(r,n,i){r["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Uu}(),r["Content-Type"]="text/plain",this.databaseInfo.appId&&(r["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,a)=>r[a]=s),i&&i.headers.forEach((s,a)=>r[a]=s)}xo(r,n){const i=vV[r];return`${this.Do}/v1/${n}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,r,n,i){const s=fm();return new Promise((a,o)=>{const l=new ZC;l.setWithCredentials(!0),l.listenOnce(ek.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case xh.NO_ERROR:const f=l.getResponseJson();nt(fi,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(f)),a(f);break;case xh.TIMEOUT:nt(fi,`RPC '${e}' ${s} timed out`),o(new dt(Oe.DEADLINE_EXCEEDED,"Request time out"));break;case xh.HTTP_ERROR:const p=l.getStatus();if(nt(fi,`RPC '${e}' ${s} failed with status:`,p,"response text:",l.getResponseText()),p>0){let g=l.getResponseJson();Array.isArray(g)&&(g=g[0]);const m=g==null?void 0:g.error;if(m&&m.status&&m.message){const y=function(S){const A=S.toLowerCase().replace(/_/g,"-");return Object.values(Oe).indexOf(A)>=0?A:Oe.UNKNOWN}(m.status);o(new dt(y,m.message))}else o(new dt(Oe.UNKNOWN,"Server responded with status "+l.getStatus()))}else o(new dt(Oe.UNAVAILABLE,"Connection failed."));break;default:Et()}}finally{nt(fi,`RPC '${e}' ${s} completed.`)}});const u=JSON.stringify(i);nt(fi,`RPC '${e}' ${s} sending request:`,i),l.send(r,"POST",u,n,15)})}Bo(e,r,n){const i=fm(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=nk(),o=rk(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(l.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Oo(l.initMessageHeaders,r,n),l.encodeInitMessageHeaders=!0;const f=s.join("");nt(fi,`Creating RPC '${e}' stream ${i}: ${f}`,l);const p=a.createWebChannel(f,l);let g=!1,m=!1;const y=new yV({Io:S=>{m?nt(fi,`Not sending because RPC '${e}' stream ${i} is closed:`,S):(g||(nt(fi,`Opening RPC '${e}' stream ${i} transport.`),p.open(),g=!0),nt(fi,`RPC '${e}' stream ${i} sending:`,S),p.send(S))},To:()=>p.close()}),x=(S,A,C)=>{S.listen(A,E=>{try{C(E)}catch(O){setTimeout(()=>{throw O},0)}})};return x(p,Cd.EventType.OPEN,()=>{m||(nt(fi,`RPC '${e}' stream ${i} transport opened.`),y.yo())}),x(p,Cd.EventType.CLOSE,()=>{m||(m=!0,nt(fi,`RPC '${e}' stream ${i} transport closed`),y.So())}),x(p,Cd.EventType.ERROR,S=>{m||(m=!0,Tu(fi,`RPC '${e}' stream ${i} transport errored:`,S),y.So(new dt(Oe.UNAVAILABLE,"The operation could not be completed")))}),x(p,Cd.EventType.MESSAGE,S=>{var A;if(!m){const C=S.data[0];Sr(!!C);const E=C,O=E.error||((A=E[0])===null||A===void 0?void 0:A.error);if(O){nt(fi,`RPC '${e}' stream ${i} received error:`,O);const Q=O.status;let H=function(T){const N=Sn[T];if(N!==void 0)return Fk(N)}(Q),w=O.message;H===void 0&&(H=Oe.INTERNAL,w="Unknown error status: "+Q+" with message "+O.message),m=!0,y.So(new dt(H,w)),p.close()}else nt(fi,`RPC '${e}' stream ${i} received:`,C),y.bo(C)}}),x(o,tk.STAT_EVENT,S=>{S.stat===Fx.PROXY?nt(fi,`RPC '${e}' stream ${i} detected buffering proxy`):S.stat===Fx.NOPROXY&&nt(fi,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{y.wo()},0),y}}function hm(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ag(t){return new IU(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uk{constructor(e,r,n=1e3,i=1.5,s=6e4){this.ui=e,this.timerId=r,this.ko=n,this.qo=i,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const r=Math.floor(this.Ko+this.zo()),n=Math.max(0,Date.now()-this.Uo),i=Math.max(0,r-n);i>0&&nt("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vk{constructor(e,r,n,i,s,a,o,l){this.ui=e,this.Ho=n,this.Jo=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=o,this.listener=l,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new Uk(e,r)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,r){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():r&&r.code===Oe.RESOURCE_EXHAUSTED?(co(r.toString()),co("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):r&&r.code===Oe.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(r)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),r=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.Yo===r&&this.P_(n,i)},n=>{e(()=>{const i=new dt(Oe.UNKNOWN,"Fetching auth token failed: "+n.message);return this.I_(i)})})}P_(e,r){const n=this.h_(this.Yo);this.stream=this.T_(e,r),this.stream.Eo(()=>{n(()=>this.listener.Eo())}),this.stream.Ro(()=>{n(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{n(()=>this.I_(i))}),this.stream.onMessage(i=>{n(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return nt("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return r=>{this.ui.enqueueAndForget(()=>this.Yo===e?r():(nt("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class EV extends Vk{constructor(e,r,n,i,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,i,a),this.serializer=s}T_(e,r){return this.connection.Bo("Listen",e,r)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const r=DU(this.serializer,e),n=function(s){if(!("targetChange"in s))return Ct.min();const a=s.targetChange;return a.targetIds&&a.targetIds.length?Ct.min():a.readTime?Na(a.readTime):Ct.min()}(e);return this.listener.d_(r,n)}A_(e){const r={};r.database=Bx(this.serializer),r.addTarget=function(s,a){let o;const l=a.target;if(o=Rx(l)?{documents:MU(s,l)}:{query:BU(s,l)._t},o.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){o.resumeToken=Nk(s,a.resumeToken);const u=Px(s,a.expectedCount);u!==null&&(o.expectedCount=u)}else if(a.snapshotVersion.compareTo(Ct.min())>0){o.readTime=xp(s,a.snapshotVersion.toTimestamp());const u=Px(s,a.expectedCount);u!==null&&(o.expectedCount=u)}return o}(this.serializer,e);const n=LU(this.serializer,e);n&&(r.labels=n),this.a_(r)}R_(e){const r={};r.database=Bx(this.serializer),r.removeTarget=e,this.a_(r)}}class SV extends Vk{constructor(e,r,n,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,i,a),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,r){return this.connection.Bo("Write",e,r)}E_(e){return Sr(!!e.streamToken),this.lastStreamToken=e.streamToken,Sr(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){Sr(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const r=OU(e.writeResults,e.commitTime),n=Na(e.commitTime);return this.listener.g_(n,r)}p_(){const e={};e.database=Bx(this.serializer),this.a_(e)}m_(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>PU(this.serializer,n))};this.a_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wV extends class{}{constructor(e,r,n,i){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new dt(Oe.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,r,n,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Mo(e,Ox(r,n),i,s,a)).catch(s=>{throw s.name==="FirebaseError"?(s.code===Oe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new dt(Oe.UNKNOWN,s.toString())})}Lo(e,r,n,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,o])=>this.connection.Lo(e,Ox(r,n),i,a,o,s)).catch(a=>{throw a.name==="FirebaseError"?(a.code===Oe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new dt(Oe.UNKNOWN,a.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class TV{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(co(r),this.D_=!1):nt("OnlineStateTracker",r)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AV{constructor(e,r,n,i,s){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(a=>{n.enqueueAndForget(async()=>{yc(this)&&(nt("RemoteStore","Restarting streams for network reachability change."),await async function(l){const u=kt(l);u.L_.add(4),await s0(u),u.q_.set("Unknown"),u.L_.delete(4),await og(u)}(this))})}),this.q_=new TV(n,i)}}async function og(t){if(yc(t))for(const e of t.B_)await e(!0)}async function s0(t){for(const e of t.B_)await e(!1)}function zk(t,e){const r=kt(t);r.N_.has(e.targetId)||(r.N_.set(e.targetId,e),Kv(r)?Gv(r):Wu(r).r_()&&$v(r,e))}function Hv(t,e){const r=kt(t),n=Wu(r);r.N_.delete(e),n.r_()&&Wk(r,e),r.N_.size===0&&(n.r_()?n.o_():yc(r)&&r.q_.set("Unknown"))}function $v(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ct.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}Wu(t).A_(e)}function Wk(t,e){t.Q_.xe(e),Wu(t).R_(e)}function Gv(t){t.Q_=new CU({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),Wu(t).start(),t.q_.v_()}function Kv(t){return yc(t)&&!Wu(t).n_()&&t.N_.size>0}function yc(t){return kt(t).L_.size===0}function Hk(t){t.Q_=void 0}async function CV(t){t.q_.set("Online")}async function kV(t){t.N_.forEach((e,r)=>{$v(t,e)})}async function FV(t,e){Hk(t),Kv(t)?(t.q_.M_(e),Gv(t)):t.q_.set("Unknown")}async function bV(t,e,r){if(t.q_.set("Online"),e instanceof Ik&&e.state===2&&e.cause)try{await async function(i,s){const a=s.cause;for(const o of s.targetIds)i.N_.has(o)&&(await i.remoteSyncer.rejectListen(o,a),i.N_.delete(o),i.Q_.removeTarget(o))}(t,e)}catch(n){nt("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),await vp(t,n)}else if(e instanceof _h?t.Q_.Ke(e):e instanceof bk?t.Q_.He(e):t.Q_.We(e),!r.isEqual(Ct.min()))try{const n=await Lk(t.localStore);r.compareTo(n)>=0&&await function(s,a){const o=s.Q_.rt(a);return o.targetChanges.forEach((l,u)=>{if(l.resumeToken.approximateByteSize()>0){const f=s.N_.get(u);f&&s.N_.set(u,f.withResumeToken(l.resumeToken,a))}}),o.targetMismatches.forEach((l,u)=>{const f=s.N_.get(l);if(!f)return;s.N_.set(l,f.withResumeToken(ai.EMPTY_BYTE_STRING,f.snapshotVersion)),Wk(s,l);const p=new qo(f.target,l,u,f.sequenceNumber);$v(s,p)}),s.remoteSyncer.applyRemoteEvent(o)}(t,r)}catch(n){nt("RemoteStore","Failed to raise snapshot:",n),await vp(t,n)}}async function vp(t,e,r){if(!r0(e))throw e;t.L_.add(1),await s0(t),t.q_.set("Offline"),r||(r=()=>Lk(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{nt("RemoteStore","Retrying IndexedDB access"),await r(),t.L_.delete(1),await og(t)})}function $k(t,e){return e().catch(r=>vp(t,r,e))}async function lg(t){const e=kt(t),r=vl(e);let n=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;IV(e);)try{const i=await hV(e.localStore,n);if(i===null){e.O_.length===0&&r.o_();break}n=i.batchId,NV(e,i)}catch(i){await vp(e,i)}Gk(e)&&Kk(e)}function IV(t){return yc(t)&&t.O_.length<10}function NV(t,e){t.O_.push(e);const r=vl(t);r.r_()&&r.V_&&r.m_(e.mutations)}function Gk(t){return yc(t)&&!vl(t).n_()&&t.O_.length>0}function Kk(t){vl(t).start()}async function RV(t){vl(t).p_()}async function DV(t){const e=vl(t);for(const r of t.O_)e.m_(r.mutations)}async function PV(t,e,r){const n=t.O_.shift(),i=jv.from(n,e,r);await $k(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await lg(t)}async function OV(t,e){e&&vl(t).V_&&await async function(n,i){if(function(a){return wU(a)&&a!==Oe.ABORTED}(i.code)){const s=n.O_.shift();vl(n).s_(),await $k(n,()=>n.remoteSyncer.rejectFailedWrite(s.batchId,i)),await lg(n)}}(t,e),Gk(t)&&Kk(t)}async function WE(t,e){const r=kt(t);r.asyncQueue.verifyOperationInProgress(),nt("RemoteStore","RemoteStore received new credentials");const n=yc(r);r.L_.add(3),await s0(r),n&&r.q_.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.L_.delete(3),await og(r)}async function MV(t,e){const r=kt(t);e?(r.L_.delete(2),await og(r)):e||(r.L_.add(2),await s0(r),r.q_.set("Unknown"))}function Wu(t){return t.K_||(t.K_=function(r,n,i){const s=kt(r);return s.w_(),new EV(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:CV.bind(null,t),Ro:kV.bind(null,t),mo:FV.bind(null,t),d_:bV.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),Kv(t)?Gv(t):t.q_.set("Unknown")):(await t.K_.stop(),Hk(t))})),t.K_}function vl(t){return t.U_||(t.U_=function(r,n,i){const s=kt(r);return s.w_(),new SV(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:RV.bind(null,t),mo:OV.bind(null,t),f_:DV.bind(null,t),g_:PV.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await lg(t)):(await t.U_.stop(),t.O_.length>0&&(nt("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yv{constructor(e,r,n,i,s){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=i,this.removalCallback=s,this.deferred=new ll,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,i,s){const a=Date.now()+n,o=new Yv(e,r,a,i,s);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new dt(Oe.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Xv(t,e){if(co("AsyncQueue",`${e}: ${t}`),r0(t))return new dt(Oe.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cu{constructor(e){this.comparator=e?(r,n)=>e(r,n)||ht.comparator(r.key,n.key):(r,n)=>ht.comparator(r.key,n.key),this.keyedMap=kd(),this.sortedSet=new tn(this.comparator)}static emptySet(e){return new cu(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof cu)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const i=r.getNext().key,s=n.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new cu;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HE{constructor(){this.W_=new tn(ht.comparator)}track(e){const r=e.doc.key,n=this.W_.get(r);n?e.type!==0&&n.type===3?this.W_=this.W_.insert(r,e):e.type===3&&n.type!==1?this.W_=this.W_.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.W_=this.W_.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.W_=this.W_.remove(r):e.type===1&&n.type===2?this.W_=this.W_.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):Et():this.W_=this.W_.insert(r,e)}G_(){const e=[];return this.W_.inorderTraversal((r,n)=>{e.push(n)}),e}}class bu{constructor(e,r,n,i,s,a,o,l,u){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=o,this.excludesMetadataChanges=l,this.hasCachedResults=u}static fromInitialDocuments(e,r,n,i,s){const a=[];return r.forEach(o=>{a.push({type:0,doc:o})}),new bu(e,r,cu.emptySet(r),a,n,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&tg(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let i=0;i<r.length;i++)if(r[i].type!==n[i].type||!r[i].doc.isEqual(n[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BV{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class jV{constructor(){this.queries=$E(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(r,n){const i=kt(r),s=i.queries;i.queries=$E(),s.forEach((a,o)=>{for(const l of o.j_)l.onError(n)})})(this,new dt(Oe.ABORTED,"Firestore shutting down"))}}function $E(){return new zu(t=>gk(t),tg)}async function Yk(t,e){const r=kt(t);let n=3;const i=e.query;let s=r.queries.get(i);s?!s.H_()&&e.J_()&&(n=2):(s=new BV,n=e.J_()?0:1);try{switch(n){case 0:s.z_=await r.onListen(i,!0);break;case 1:s.z_=await r.onListen(i,!1);break;case 2:await r.onFirstRemoteStoreListen(i)}}catch(a){const o=Xv(a,`Initialization of query '${Mc(e.query)}' failed`);return void e.onError(o)}r.queries.set(i,s),s.j_.push(e),e.Z_(r.onlineState),s.z_&&e.X_(s.z_)&&qv(r)}async function Xk(t,e){const r=kt(t),n=e.query;let i=3;const s=r.queries.get(n);if(s){const a=s.j_.indexOf(e);a>=0&&(s.j_.splice(a,1),s.j_.length===0?i=e.J_()?0:1:!s.H_()&&e.J_()&&(i=2))}switch(i){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function LV(t,e){const r=kt(t);let n=!1;for(const i of e){const s=i.query,a=r.queries.get(s);if(a){for(const o of a.j_)o.X_(i)&&(n=!0);a.z_=i}}n&&qv(r)}function UV(t,e,r){const n=kt(t),i=n.queries.get(e);if(i)for(const s of i.j_)s.onError(r);n.queries.delete(e)}function qv(t){t.Y_.forEach(e=>{e.next()})}var Lx,GE;(GE=Lx||(Lx={})).ea="default",GE.Cache="cache";class qk{constructor(e,r,n){this.query=e,this.ta=r,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=n||{}}X_(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)i.type!==3&&n.push(i);e=new bu(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.na?this.ia(e)&&(this.ta.next(e),r=!0):this.sa(e,this.onlineState)&&(this.oa(e),r=!0),this.ra=e,r}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let r=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),r=!0),r}sa(e,r){if(!e.fromCache||!this.J_())return!0;const n=r!=="Offline";return(!this.options._a||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const r=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}oa(e){e=bu.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Lx.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qk{constructor(e){this.key=e}}class Jk{constructor(e){this.key=e}}class VV{constructor(e,r){this.query=e,this.Ta=r,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Kt(),this.mutatedKeys=Kt(),this.Aa=mk(e),this.Ra=new cu(this.Aa)}get Va(){return this.Ta}ma(e,r){const n=r?r.fa:new HE,i=r?r.Ra:this.Ra;let s=r?r.mutatedKeys:this.mutatedKeys,a=i,o=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((f,p)=>{const g=i.get(f),m=rg(this.query,p)?p:null,y=!!g&&this.mutatedKeys.has(g.key),x=!!m&&(m.hasLocalMutations||this.mutatedKeys.has(m.key)&&m.hasCommittedMutations);let S=!1;g&&m?g.data.isEqual(m.data)?y!==x&&(n.track({type:3,doc:m}),S=!0):this.ga(g,m)||(n.track({type:2,doc:m}),S=!0,(l&&this.Aa(m,l)>0||u&&this.Aa(m,u)<0)&&(o=!0)):!g&&m?(n.track({type:0,doc:m}),S=!0):g&&!m&&(n.track({type:1,doc:g}),S=!0,(l||u)&&(o=!0)),S&&(m?(a=a.add(m),s=x?s.add(f):s.delete(f)):(a=a.delete(f),s=s.delete(f)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const f=this.query.limitType==="F"?a.last():a.first();a=a.delete(f.key),s=s.delete(f.key),n.track({type:1,doc:f})}return{Ra:a,fa:n,ns:o,mutatedKeys:s}}ga(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,i){const s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const a=e.fa.G_();a.sort((f,p)=>function(m,y){const x=S=>{switch(S){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Et()}};return x(m)-x(y)}(f.type,p.type)||this.Aa(f.doc,p.doc)),this.pa(n),i=i!=null&&i;const o=r&&!i?this.ya():[],l=this.da.size===0&&this.current&&!i?1:0,u=l!==this.Ea;return this.Ea=l,a.length!==0||u?{snapshot:new bu(this.query,e.Ra,s,a,e.mutatedKeys,l===0,u,!1,!!n&&n.resumeToken.approximateByteSize()>0),wa:o}:{wa:o}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new HE,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(r=>this.Ta=this.Ta.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ta=this.Ta.delete(r)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=Kt(),this.Ra.forEach(n=>{this.Sa(n.key)&&(this.da=this.da.add(n.key))});const r=[];return e.forEach(n=>{this.da.has(n)||r.push(new Jk(n))}),this.da.forEach(n=>{e.has(n)||r.push(new Qk(n))}),r}ba(e){this.Ta=e.Ts,this.da=Kt();const r=this.ma(e.documents);return this.applyChanges(r,!0)}Da(){return bu.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class zV{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class WV{constructor(e){this.key=e,this.va=!1}}class HV{constructor(e,r,n,i,s,a){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Ca={},this.Fa=new zu(o=>gk(o),tg),this.Ma=new Map,this.xa=new Set,this.Oa=new tn(ht.comparator),this.Na=new Map,this.La=new Vv,this.Ba={},this.ka=new Map,this.qa=Fu.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function $V(t,e,r=!0){const n=iF(t);let i;const s=n.Fa.get(e);return s?(n.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=await Zk(n,e,r,!0),i}async function GV(t,e){const r=iF(t);await Zk(r,e,!0,!1)}async function Zk(t,e,r,n){const i=await pV(t.localStore,Ia(e)),s=i.targetId,a=t.sharedClientState.addLocalQueryTarget(s,r);let o;return n&&(o=await KV(t,e,s,a==="current",i.resumeToken)),t.isPrimaryClient&&r&&zk(t.remoteStore,i),o}async function KV(t,e,r,n,i){t.Ka=(p,g,m)=>async function(x,S,A,C){let E=S.view.ma(A);E.ns&&(E=await UE(x.localStore,S.query,!1).then(({documents:w})=>S.view.ma(w,E)));const O=C&&C.targetChanges.get(S.targetId),Q=C&&C.targetMismatches.get(S.targetId)!=null,H=S.view.applyChanges(E,x.isPrimaryClient,O,Q);return YE(x,S.targetId,H.wa),H.snapshot}(t,p,g,m);const s=await UE(t.localStore,e,!0),a=new VV(e,s.Ts),o=a.ma(s.documents),l=i0.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",i),u=a.applyChanges(o,t.isPrimaryClient,l);YE(t,r,u.wa);const f=new zV(e,r,a);return t.Fa.set(e,f),t.Ma.has(r)?t.Ma.get(r).push(e):t.Ma.set(r,[e]),u.snapshot}async function YV(t,e,r){const n=kt(t),i=n.Fa.get(e),s=n.Ma.get(i.targetId);if(s.length>1)return n.Ma.set(i.targetId,s.filter(a=>!tg(a,e))),void n.Fa.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await jx(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),r&&Hv(n.remoteStore,i.targetId),Ux(n,i.targetId)}).catch(t0)):(Ux(n,i.targetId),await jx(n.localStore,i.targetId,!0))}async function XV(t,e){const r=kt(t),n=r.Fa.get(e),i=r.Ma.get(n.targetId);r.isPrimaryClient&&i.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),Hv(r.remoteStore,n.targetId))}async function qV(t,e,r){const n=nz(t);try{const i=await function(a,o){const l=kt(a),u=On.now(),f=o.reduce((m,y)=>m.add(y.key),Kt());let p,g;return l.persistence.runTransaction("Locally write mutations","readwrite",m=>{let y=uo(),x=Kt();return l.cs.getEntries(m,f).next(S=>{y=S,y.forEach((A,C)=>{C.isValidDocument()||(x=x.add(A))})}).next(()=>l.localDocuments.getOverlayedDocuments(m,y)).next(S=>{p=S;const A=[];for(const C of o){const E=vU(C,p.get(C.key).overlayedDocument);E!=null&&A.push(new vc(C.key,E,lk(E.value.mapValue),ro.exists(!0)))}return l.mutationQueue.addMutationBatch(m,u,A,o)}).next(S=>{g=S;const A=S.applyToLocalDocumentSet(p,x);return l.documentOverlayCache.saveOverlays(m,S.batchId,A)})}).then(()=>({batchId:g.batchId,changes:vk(p)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(a,o,l){let u=a.Ba[a.currentUser.toKey()];u||(u=new tn(cr)),u=u.insert(o,l),a.Ba[a.currentUser.toKey()]=u}(n,i.batchId,r),await a0(n,i.changes),await lg(n.remoteStore)}catch(i){const s=Xv(i,"Failed to persist write");r.reject(s)}}async function eF(t,e){const r=kt(t);try{const n=await dV(r.localStore,e);e.targetChanges.forEach((i,s)=>{const a=r.Na.get(s);a&&(Sr(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?a.va=!0:i.modifiedDocuments.size>0?Sr(a.va):i.removedDocuments.size>0&&(Sr(a.va),a.va=!1))}),await a0(r,n,e)}catch(n){await t0(n)}}function KE(t,e,r){const n=kt(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const i=[];n.Fa.forEach((s,a)=>{const o=a.view.Z_(e);o.snapshot&&i.push(o.snapshot)}),function(a,o){const l=kt(a);l.onlineState=o;let u=!1;l.queries.forEach((f,p)=>{for(const g of p.j_)g.Z_(o)&&(u=!0)}),u&&qv(l)}(n.eventManager,e),i.length&&n.Ca.d_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function QV(t,e,r){const n=kt(t);n.sharedClientState.updateQueryState(e,"rejected",r);const i=n.Na.get(e),s=i&&i.key;if(s){let a=new tn(ht.comparator);a=a.insert(s,vi.newNoDocument(s,Ct.min()));const o=Kt().add(s),l=new sg(Ct.min(),new Map,new tn(cr),a,o);await eF(n,l),n.Oa=n.Oa.remove(s),n.Na.delete(e),Qv(n)}else await jx(n.localStore,e,!1).then(()=>Ux(n,e,r)).catch(t0)}async function JV(t,e){const r=kt(t),n=e.batch.batchId;try{const i=await uV(r.localStore,e);rF(r,n,null),tF(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await a0(r,i)}catch(i){await t0(i)}}async function ZV(t,e,r){const n=kt(t);try{const i=await function(a,o){const l=kt(a);return l.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let f;return l.mutationQueue.lookupMutationBatch(u,o).next(p=>(Sr(p!==null),f=p.keys(),l.mutationQueue.removeMutationBatch(u,p))).next(()=>l.mutationQueue.performConsistencyCheck(u)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(u,f,o)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,f)).next(()=>l.localDocuments.getDocuments(u,f))})}(n.localStore,e);rF(n,e,r),tF(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await a0(n,i)}catch(i){await t0(i)}}function tF(t,e){(t.ka.get(e)||[]).forEach(r=>{r.resolve()}),t.ka.delete(e)}function rF(t,e,r){const n=kt(t);let i=n.Ba[n.currentUser.toKey()];if(i){const s=i.get(e);s&&(r?s.reject(r):s.resolve(),i=i.remove(e)),n.Ba[n.currentUser.toKey()]=i}}function Ux(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Ma.get(e))t.Fa.delete(n),r&&t.Ca.$a(n,r);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(n=>{t.La.containsKey(n)||nF(t,n)})}function nF(t,e){t.xa.delete(e.path.canonicalString());const r=t.Oa.get(e);r!==null&&(Hv(t.remoteStore,r),t.Oa=t.Oa.remove(e),t.Na.delete(r),Qv(t))}function YE(t,e,r){for(const n of r)n instanceof Qk?(t.La.addReference(n.key,e),ez(t,n)):n instanceof Jk?(nt("SyncEngine","Document no longer in limbo: "+n.key),t.La.removeReference(n.key,e),t.La.containsKey(n.key)||nF(t,n.key)):Et()}function ez(t,e){const r=e.key,n=r.path.canonicalString();t.Oa.get(r)||t.xa.has(n)||(nt("SyncEngine","New document in limbo: "+r),t.xa.add(n),Qv(t))}function Qv(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const r=new ht(on.fromString(e)),n=t.qa.next();t.Na.set(n,new WV(r)),t.Oa=t.Oa.insert(r,n),zk(t.remoteStore,new qo(Ia(eg(r.path)),n,"TargetPurposeLimboResolution",Nv.oe))}}async function a0(t,e,r){const n=kt(t),i=[],s=[],a=[];n.Fa.isEmpty()||(n.Fa.forEach((o,l)=>{a.push(n.Ka(l,e,r).then(u=>{var f;if((u||r)&&n.isPrimaryClient){const p=u?!u.fromCache:(f=r==null?void 0:r.targetChanges.get(l.targetId))===null||f===void 0?void 0:f.current;n.sharedClientState.updateQueryState(l.targetId,p?"current":"not-current")}if(u){i.push(u);const p=Wv.Wi(l.targetId,u);s.push(p)}}))}),await Promise.all(a),n.Ca.d_(i),await async function(l,u){const f=kt(l);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>Re.forEach(u,g=>Re.forEach(g.$i,m=>f.persistence.referenceDelegate.addReference(p,g.targetId,m)).next(()=>Re.forEach(g.Ui,m=>f.persistence.referenceDelegate.removeReference(p,g.targetId,m)))))}catch(p){if(!r0(p))throw p;nt("LocalStore","Failed to update sequence numbers: "+p)}for(const p of u){const g=p.targetId;if(!p.fromCache){const m=f.os.get(g),y=m.snapshotVersion,x=m.withLastLimboFreeSnapshotVersion(y);f.os=f.os.insert(g,x)}}}(n.localStore,s))}async function tz(t,e){const r=kt(t);if(!r.currentUser.isEqual(e)){nt("SyncEngine","User change. New user:",e.toKey());const n=await jk(r.localStore,e);r.currentUser=e,function(s,a){s.ka.forEach(o=>{o.forEach(l=>{l.reject(new dt(Oe.CANCELLED,a))})}),s.ka.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await a0(r,n.hs)}}function rz(t,e){const r=kt(t),n=r.Na.get(e);if(n&&n.va)return Kt().add(n.key);{let i=Kt();const s=r.Ma.get(e);if(!s)return i;for(const a of s){const o=r.Fa.get(a);i=i.unionWith(o.view.Va)}return i}}function iF(t){const e=kt(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=eF.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=rz.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=QV.bind(null,e),e.Ca.d_=LV.bind(null,e.eventManager),e.Ca.$a=UV.bind(null,e.eventManager),e}function nz(t){const e=kt(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=JV.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=ZV.bind(null,e),e}class yp{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=ag(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,r){return null}Ha(e,r){return null}za(e){return cV(this.persistence,new oV,e.initialUser,this.serializer)}Ga(e){return new iV(zv.Zr,this.serializer)}Wa(e){return new mV}async terminate(){var e,r;(e=this.gcScheduler)===null||e===void 0||e.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}yp.provider={build:()=>new yp};class Vx{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>KE(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=tz.bind(null,this.syncEngine),await MV(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new jV}()}createDatastore(e){const r=ag(e.databaseInfo.databaseId),n=function(s){return new _V(s)}(e.databaseInfo);return function(s,a,o,l){return new wV(s,a,o,l)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,i,s,a,o){return new AV(n,i,s,a,o)}(this.localStore,this.datastore,e.asyncQueue,r=>KE(this.syncEngine,r,0),function(){return zE.D()?new zE:new xV}())}createSyncEngine(e,r){return function(i,s,a,o,l,u,f){const p=new HV(i,s,a,o,l,u);return f&&(p.Qa=!0),p}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await async function(i){const s=kt(i);nt("RemoteStore","RemoteStore shutting down."),s.L_.add(5),await s0(s),s.k_.shutdown(),s.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}Vx.provider={build:()=>new Vx};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sF{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):co("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iz{constructor(e,r,n,i,s){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=i,this.user=pi.UNAUTHENTICATED,this.clientId=sk.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(n,async a=>{nt("FirestoreClient","Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(n,a=>(nt("FirestoreClient","Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ll;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=Xv(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function pm(t,e){t.asyncQueue.verifyOperationInProgress(),nt("FirestoreClient","Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async i=>{n.isEqual(i)||(await jk(e.localStore,i),n=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function XE(t,e){t.asyncQueue.verifyOperationInProgress();const r=await sz(t);nt("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>WE(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,i)=>WE(e.remoteStore,i)),t._onlineComponents=e}async function sz(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){nt("FirestoreClient","Using user provided OfflineComponentProvider");try{await pm(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(i){return i.name==="FirebaseError"?i.code===Oe.FAILED_PRECONDITION||i.code===Oe.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(r))throw r;Tu("Error using user provided cache. Falling back to memory cache: "+r),await pm(t,new yp)}}else nt("FirestoreClient","Using default OfflineComponentProvider"),await pm(t,new yp);return t._offlineComponents}async function aF(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(nt("FirestoreClient","Using user provided OnlineComponentProvider"),await XE(t,t._uninitializedComponentsProvider._online)):(nt("FirestoreClient","Using default OnlineComponentProvider"),await XE(t,new Vx))),t._onlineComponents}function az(t){return aF(t).then(e=>e.syncEngine)}async function zx(t){const e=await aF(t),r=e.eventManager;return r.onListen=$V.bind(null,e.syncEngine),r.onUnlisten=YV.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=GV.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=XV.bind(null,e.syncEngine),r}function oz(t,e,r={}){const n=new ll;return t.asyncQueue.enqueueAndForget(async()=>function(s,a,o,l,u){const f=new sF({next:g=>{f.Za(),a.enqueueAndForget(()=>Xk(s,p));const m=g.docs.has(o);!m&&g.fromCache?u.reject(new dt(Oe.UNAVAILABLE,"Failed to get document because the client is offline.")):m&&g.fromCache&&l&&l.source==="server"?u.reject(new dt(Oe.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(g)},error:g=>u.reject(g)}),p=new qk(eg(o.path),f,{includeMetadataChanges:!0,_a:!0});return Yk(s,p)}(await zx(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oF(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qE=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lz(t,e,r){if(!r)throw new dt(Oe.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function cz(t,e,r,n){if(e===!0&&n===!0)throw new dt(Oe.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function QE(t){if(!ht.isDocumentKey(t))throw new dt(Oe.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Jv(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Et()}function cl(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new dt(Oe.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=Jv(t);throw new dt(Oe.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JE{constructor(e){var r,n;if(e.host===void 0){if(e.ssl!==void 0)throw new dt(Oe.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(r=e.ssl)===null||r===void 0||r;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new dt(Oe.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}cz("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=oF((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new dt(Oe.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new dt(Oe.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new dt(Oe.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Zv{constructor(e,r,n,i){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new JE({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new dt(Oe.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new dt(Oe.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new JE(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new C7;switch(n.type){case"firstParty":return new I7(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new dt(Oe.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=qE.get(r);n&&(nt("ComponentProvider","Removing Datastore"),qE.delete(r),n.terminate())}(this),Promise.resolve()}}function uz(t,e,r,n={}){var i;const s=(t=cl(t,Zv))._getSettings(),a=`${e}:${r}`;if(s.host!=="firestore.googleapis.com"&&s.host!==a&&Tu("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:a,ssl:!1})),n.mockUserToken){let o,l;if(typeof n.mockUserToken=="string")o=n.mockUserToken,l=pi.MOCK_USER;else{o=e9(n.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);const u=n.mockUserToken.sub||n.mockUserToken.user_id;if(!u)throw new dt(Oe.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new pi(u)}t._authCredentials=new k7(new ik(o,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cg{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new cg(this.firestore,e,this._query)}}class ps{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Bf(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new ps(this.firestore,e,this._key)}}class Bf extends cg{constructor(e,r,n){super(e,r,eg(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new ps(this.firestore,null,new ht(e))}withConverter(e){return new Bf(this.firestore,e,this._path)}}function ey(t,e,...r){if(t=oa(t),arguments.length===1&&(e=sk.newId()),lz("doc","path",e),t instanceof Zv){const n=on.fromString(e,...r);return QE(n),new ps(t,null,new ht(n))}{if(!(t instanceof ps||t instanceof Bf))throw new dt(Oe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(on.fromString(e,...r));return QE(n),new ps(t.firestore,t instanceof Bf?t.converter:null,new ht(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZE{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new Uk(this,"async_queue_retry"),this.Vu=()=>{const n=hm();n&&nt("AsyncQueue","Visibility state changed to "+n.visibilityState),this.t_.jo()},this.mu=e;const r=hm();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const r=hm();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const r=new ll;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!r0(e))throw e;nt("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const r=this.mu.then(()=>(this.du=!0,e().catch(n=>{this.Eu=n,this.du=!1;const i=function(a){let o=a.message||"";return a.stack&&(o=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),o}(n);throw co("INTERNAL UNHANDLED ERROR: ",i),n}).then(n=>(this.du=!1,n))));return this.mu=r,r}enqueueAfterDelay(e,r,n){this.fu(),this.Ru.indexOf(e)>-1&&(r=0);const i=Yv.createAndSchedule(this,e,r,n,s=>this.yu(s));return this.Tu.push(i),i}fu(){this.Eu&&Et()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const r of this.Tu)if(r.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.Tu)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const r=this.Tu.indexOf(e);this.Tu.splice(r,1)}}function eS(t){return function(r,n){if(typeof r!="object"||r===null)return!1;const i=r;for(const s of n)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}class jf extends Zv{constructor(e,r,n,i){super(e,r,n,i),this.type="firestore",this._queue=new ZE,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new ZE(e),this._firestoreClient=void 0,await e}}}function dz(t,e){const r=typeof t=="object"?t:XC(),n=typeof t=="string"?t:"(default)",i=bv(r,"firestore").getImmediate({identifier:n});if(!i._initialized){const s=JL("firestore");s&&uz(i,...s)}return i}function ty(t){if(t._terminated)throw new dt(Oe.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||fz(t),t._firestoreClient}function fz(t){var e,r,n;const i=t._freezeSettings(),s=function(o,l,u,f){return new W7(o,l,u,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,oF(f.experimentalLongPollingOptions),f.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._componentsProvider||!((r=i.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((n=i.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(t._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),t._firestoreClient=new iz(t._authCredentials,t._appCheckCredentials,t._queue,s,t._componentsProvider&&function(o){const l=o==null?void 0:o._online.build();return{_offline:o==null?void 0:o._offline.build(l),_online:l}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iu{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Iu(ai.fromBase64String(e))}catch(r){throw new dt(Oe.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new Iu(ai.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ry{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new dt(Oe.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ri(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lF{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ny{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new dt(Oe.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new dt(Oe.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return cr(this._lat,e._lat)||cr(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iy{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,i){if(n.length!==i.length)return!1;for(let s=0;s<n.length;++s)if(n[s]!==i[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hz=/^__.*__$/;class pz{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new vc(e,this.data,this.fieldMask,r,this.fieldTransforms):new n0(e,this.data,r,this.fieldTransforms)}}function cF(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Et()}}class sy{constructor(e,r,n,i,s,a){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=i,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new sy(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),i=this.Fu({path:n,xu:!1});return i.Ou(e),i}Nu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),i=this.Fu({path:n,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return _p(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(cF(this.Cu)&&hz.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class gz{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||ag(e)}Qu(e,r,n,i=!1){return new sy({Cu:e,methodName:r,qu:n,path:ri.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function mz(t){const e=t._freezeSettings(),r=ag(t._databaseId);return new gz(t._databaseId,!!e.ignoreUndefinedProperties,r)}function xz(t,e,r,n,i,s={}){const a=t.Qu(s.merge||s.mergeFields?2:0,e,r,i);hF("Data must be an object, but it was:",a,n);const o=dF(n,a);let l,u;if(s.merge)l=new ta(a.fieldMask),u=a.fieldTransforms;else if(s.mergeFields){const f=[];for(const p of s.mergeFields){const g=vz(e,p,r);if(!a.contains(g))throw new dt(Oe.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);_z(f,g)||f.push(g)}l=new ta(f),u=a.fieldTransforms.filter(p=>l.covers(p.field))}else l=null,u=a.fieldTransforms;return new pz(new Ds(o),l,u)}function uF(t,e){if(fF(t=oa(t)))return hF("Unsupported field value:",e,t),dF(t,e);if(t instanceof lF)return function(n,i){if(!cF(i.Cu))throw i.Bu(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${n._methodName}() is not currently supported inside arrays`);const s=n._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(n,i){const s=[];let a=0;for(const o of n){let l=uF(o,i.Lu(a));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),a++}return{arrayValue:{values:s}}}(t,e)}return function(n,i){if((n=oa(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return fU(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const s=On.fromDate(n);return{timestampValue:xp(i.serializer,s)}}if(n instanceof On){const s=new On(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:xp(i.serializer,s)}}if(n instanceof ny)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Iu)return{bytesValue:Nk(i.serializer,n._byteString)};if(n instanceof ps){const s=i.databaseId,a=n.firestore._databaseId;if(!a.isEqual(s))throw i.Bu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Uv(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof iy)return function(a,o){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:a.toArray().map(l=>{if(typeof l!="number")throw o.Bu("VectorValues must only contain numeric values.");return Bv(o.serializer,l)})}}}}}}(n,i);throw i.Bu(`Unsupported field value: ${Jv(n)}`)}(t,e)}function dF(t,e){const r={};return ak(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Vu(t,(n,i)=>{const s=uF(i,e.Mu(n));s!=null&&(r[n]=s)}),{mapValue:{fields:r}}}function fF(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof On||t instanceof ny||t instanceof Iu||t instanceof ps||t instanceof lF||t instanceof iy)}function hF(t,e,r){if(!fF(r)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(r)){const n=Jv(r);throw n==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+n)}}function vz(t,e,r){if((e=oa(e))instanceof ry)return e._internalPath;if(typeof e=="string")return pF(t,e);throw _p("Field path arguments must be of type string or ",t,!1,void 0,r)}const yz=new RegExp("[~\\*/\\[\\]]");function pF(t,e,r){if(e.search(yz)>=0)throw _p(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new ry(...e.split("."))._internalPath}catch{throw _p(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function _p(t,e,r,n,i){const s=n&&!n.isEmpty(),a=i!==void 0;let o=`Function ${e}() called with invalid data`;r&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(s||a)&&(l+=" (found",s&&(l+=` in field ${n}`),a&&(l+=` in document ${i}`),l+=")"),new dt(Oe.INVALID_ARGUMENT,o+t+l)}function _z(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gF{constructor(e,r,n,i,s){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new ps(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new Ez(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(mF("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class Ez extends gF{data(){return super.data()}}function mF(t,e){return typeof e=="string"?pF(t,e):e instanceof ry?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sz(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new dt(Oe.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class wz{convertValue(e,r="none"){switch(lc(e)){case 0:return null;case 1:return e.booleanValue;case 2:return hn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(oc(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw Et()}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return Vu(e,(i,s)=>{n[i]=this.convertValue(s,r)}),n}convertVectorValue(e){var r,n,i;const s=(i=(n=(r=e.fields)===null||r===void 0?void 0:r.value.arrayValue)===null||n===void 0?void 0:n.values)===null||i===void 0?void 0:i.map(a=>hn(a.doubleValue));return new iy(s)}convertGeoPoint(e){return new ny(hn(e.latitude),hn(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=Dv(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(Rf(e));default:return null}}convertTimestamp(e){const r=xl(e);return new On(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=on.fromString(e);Sr(Bk(n));const i=new Df(n.get(1),n.get(3)),s=new ht(n.popFirst(5));return i.isEqual(r)||co(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tz(t,e,r){let n;return n=t?t.toFirestore(e):e,n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bd{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class xF extends gF{constructor(e,r,n,i,s,a){super(e,r,n,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new Eh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(mF("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}}class Eh extends xF{data(e={}){return super.data(e)}}class Az{constructor(e,r,n,i){this._firestore=e,this._userDataWriter=r,this._snapshot=i,this.metadata=new bd(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new Eh(this._firestore,this._userDataWriter,n.key,n,new bd(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new dt(Oe.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(o=>{const l=new Eh(i._firestore,i._userDataWriter,o.doc.key,o.doc,new bd(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);return o.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(o=>s||o.type!==3).map(o=>{const l=new Eh(i._firestore,i._userDataWriter,o.doc.key,o.doc,new bd(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);let u=-1,f=-1;return o.type!==0&&(u=a.indexOf(o.doc.key),a=a.delete(o.doc.key)),o.type!==1&&(a=a.add(o.doc),f=a.indexOf(o.doc.key)),{type:Cz(o.type),doc:l,oldIndex:u,newIndex:f}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}}function Cz(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Et()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kz(t){t=cl(t,ps);const e=cl(t.firestore,jf);return oz(ty(e),t._key).then(r=>yF(e,t,r))}class vF extends wz{constructor(e){super(),this.firestore=e}convertBytes(e){return new Iu(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new ps(this.firestore,null,r)}}function Fz(t,e,r){t=cl(t,ps);const n=cl(t.firestore,jf),i=Tz(t.converter,e);return Iz(n,[xz(mz(n),"setDoc",t._key,i,t.converter!==null,r).toMutation(t._key,ro.none())])}function bz(t,...e){var r,n,i;t=oa(t);let s={includeMetadataChanges:!1,source:"default"},a=0;typeof e[a]!="object"||eS(e[a])||(s=e[a],a++);const o={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(eS(e[a])){const p=e[a];e[a]=(r=p.next)===null||r===void 0?void 0:r.bind(p),e[a+1]=(n=p.error)===null||n===void 0?void 0:n.bind(p),e[a+2]=(i=p.complete)===null||i===void 0?void 0:i.bind(p)}let l,u,f;if(t instanceof ps)u=cl(t.firestore,jf),f=eg(t._key.path),l={next:p=>{e[a]&&e[a](yF(u,t,p))},error:e[a+1],complete:e[a+2]};else{const p=cl(t,cg);u=cl(p.firestore,jf),f=p._query;const g=new vF(u);l={next:m=>{e[a]&&e[a](new Az(u,g,p,m))},error:e[a+1],complete:e[a+2]},Sz(t._query)}return function(g,m,y,x){const S=new sF(x),A=new qk(m,S,y);return g.asyncQueue.enqueueAndForget(async()=>Yk(await zx(g),A)),()=>{S.Za(),g.asyncQueue.enqueueAndForget(async()=>Xk(await zx(g),A))}}(ty(u),f,o,l)}function Iz(t,e){return function(n,i){const s=new ll;return n.asyncQueue.enqueueAndForget(async()=>qV(await az(n),i,s)),s.promise}(ty(t),e)}function yF(t,e,r){const n=r.docs.get(e._key),i=new vF(t);return new xF(t,i,e._key,n,new bd(r.hasPendingWrites,r.fromCache),e.converter)}(function(e,r=!0){(function(i){Uu=i})(Lu),wu(new sc("firestore",(n,{instanceIdentifier:i,options:s})=>{const a=n.getProvider("app").getImmediate(),o=new jf(new F7(n.getProvider("auth-internal")),new R7(n.getProvider("app-check-internal")),function(u,f){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new dt(Oe.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Df(u.options.projectId,f)}(a,i),a);return s=Object.assign({useFetchStreams:r},s),o._setSettings(s),o},"PUBLIC").setMultipleInstances(!0)),ol(yE,"4.7.3",e),ol(yE,"4.7.3","esm2017")})();function ay(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function _F(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Nz=_F,EF=new Zf("auth","Firebase",_F());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ep=new kv("@firebase/auth");function Rz(t,...e){Ep.logLevel<=Yt.WARN&&Ep.warn(`Auth (${Lu}): ${t}`,...e)}function Sh(t,...e){Ep.logLevel<=Yt.ERROR&&Ep.error(`Auth (${Lu}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fo(t,...e){throw oy(t,...e)}function Ra(t,...e){return oy(t,...e)}function SF(t,e,r){const n=Object.assign(Object.assign({},Nz()),{[e]:r});return new Zf("auth","Firebase",n).create(e,{appName:t.name})}function Kl(t){return SF(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function oy(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return EF.create(t,...e)}function _t(t,e,...r){if(!t)throw oy(e,...r)}function Xa(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Sh(e),new Error(e)}function ho(t,e){t||Xa(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wx(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function Dz(){return tS()==="http:"||tS()==="https:"}function tS(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pz(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Dz()||i9()||"connection"in navigator)?navigator.onLine:!0}function Oz(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o0{constructor(e,r){this.shortDelay=e,this.longDelay=r,ho(r>e,"Short delay should be less than long delay!"),this.isMobile=t9()||s9()}get(){return Pz()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ly(t,e){ho(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wF{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Xa("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Xa("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Xa("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mz={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bz=new o0(3e4,6e4);function cy(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Hu(t,e,r,n,i={}){return TF(t,i,async()=>{let s={},a={};n&&(e==="GET"?a=n:s={body:JSON.stringify(n)});const o=e0(Object.assign({key:t.config.apiKey},a)).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const u=Object.assign({method:e,headers:l},s);return n9()||(u.referrerPolicy="no-referrer"),wF.fetch()(AF(t,t.config.apiHost,r,o),u)})}async function TF(t,e,r){t._canInitEmulator=!1;const n=Object.assign(Object.assign({},Mz),e);try{const i=new Lz(t),s=await Promise.race([r(),i.promise]);i.clearNetworkTimeout();const a=await s.json();if("needConfirmation"in a)throw rh(t,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{const o=s.ok?a.errorMessage:a.error.message,[l,u]=o.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw rh(t,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw rh(t,"email-already-in-use",a);if(l==="USER_DISABLED")throw rh(t,"user-disabled",a);const f=n[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw SF(t,f,u);fo(t,f)}}catch(i){if(i instanceof vo)throw i;fo(t,"network-request-failed",{message:String(i)})}}async function jz(t,e,r,n,i={}){const s=await Hu(t,e,r,n,i);return"mfaPendingCredential"in s&&fo(t,"multi-factor-auth-required",{_serverResponse:s}),s}function AF(t,e,r,n){const i=`${e}${r}?${n}`;return t.config.emulator?ly(t.config,i):`${t.config.apiScheme}://${i}`}class Lz{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(Ra(this.auth,"network-request-failed")),Bz.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function rh(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const i=Ra(t,e,n);return i.customData._tokenResponse=r,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Uz(t,e){return Hu(t,"POST","/v1/accounts:delete",e)}async function CF(t,e){return Hu(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qd(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Vz(t,e=!1){const r=oa(t),n=await r.getIdToken(e),i=uy(n);_t(i&&i.exp&&i.auth_time&&i.iat,r.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,a=s==null?void 0:s.sign_in_provider;return{claims:i,token:n,authTime:Qd(gm(i.auth_time)),issuedAtTime:Qd(gm(i.iat)),expirationTime:Qd(gm(i.exp)),signInProvider:a||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function gm(t){return Number(t)*1e3}function uy(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return Sh("JWT malformed, contained fewer than 3 sections"),null;try{const i=zC(r);return i?JSON.parse(i):(Sh("Failed to decode base64 JWT payload"),null)}catch(i){return Sh("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function rS(t){const e=uy(t);return _t(e,"internal-error"),_t(typeof e.exp<"u","internal-error"),_t(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Lf(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof vo&&zz(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function zz({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wz{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var r;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const i=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hx{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=Qd(this.lastLoginAt),this.creationTime=Qd(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Sp(t){var e;const r=t.auth,n=await t.getIdToken(),i=await Lf(t,CF(r,{idToken:n}));_t(i==null?void 0:i.users.length,r,"internal-error");const s=i.users[0];t._notifyReloadListener(s);const a=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?kF(s.providerUserInfo):[],o=$z(t.providerData,a),l=t.isAnonymous,u=!(t.email&&s.passwordHash)&&!(o!=null&&o.length),f=l?u:!1,p={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new Hx(s.createdAt,s.lastLoginAt),isAnonymous:f};Object.assign(t,p)}async function Hz(t){const e=oa(t);await Sp(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function $z(t,e){return[...t.filter(n=>!e.some(i=>i.providerId===n.providerId)),...e]}function kF(t){return t.map(e=>{var{providerId:r}=e,n=ay(e,["providerId"]);return{providerId:r,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Gz(t,e){const r=await TF(t,{},async()=>{const n=e0({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,a=AF(t,i,"/v1/token",`key=${s}`),o=await t._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",wF.fetch()(a,{method:"POST",headers:o,body:n})});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function Kz(t,e){return Hu(t,"POST","/v2/accounts:revokeToken",cy(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uu{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){_t(e.idToken,"internal-error"),_t(typeof e.idToken<"u","internal-error"),_t(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):rS(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){_t(e.length!==0,"internal-error");const r=rS(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(_t(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:i,expiresIn:s}=await Gz(e,r);this.updateTokensAndExpiration(n,i,Number(s))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:i,expirationTime:s}=r,a=new uu;return n&&(_t(typeof n=="string","internal-error",{appName:e}),a.refreshToken=n),i&&(_t(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),s&&(_t(typeof s=="number","internal-error",{appName:e}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new uu,this.toJSON())}_performRefresh(){return Xa("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mo(t,e){_t(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class qa{constructor(e){var{uid:r,auth:n,stsTokenManager:i}=e,s=ay(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Wz(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Hx(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const r=await Lf(this,this.stsTokenManager.getToken(this.auth,e));return _t(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return Vz(this,e)}reload(){return Hz(this)}_assign(e){this!==e&&(_t(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>Object.assign({},r)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new qa(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(e){_t(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await Sp(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Xo(this.auth.app))return Promise.reject(Kl(this.auth));const e=await this.getIdToken();return await Lf(this,Uz(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){var n,i,s,a,o,l,u,f;const p=(n=r.displayName)!==null&&n!==void 0?n:void 0,g=(i=r.email)!==null&&i!==void 0?i:void 0,m=(s=r.phoneNumber)!==null&&s!==void 0?s:void 0,y=(a=r.photoURL)!==null&&a!==void 0?a:void 0,x=(o=r.tenantId)!==null&&o!==void 0?o:void 0,S=(l=r._redirectEventId)!==null&&l!==void 0?l:void 0,A=(u=r.createdAt)!==null&&u!==void 0?u:void 0,C=(f=r.lastLoginAt)!==null&&f!==void 0?f:void 0,{uid:E,emailVerified:O,isAnonymous:Q,providerData:H,stsTokenManager:w}=r;_t(E&&w,e,"internal-error");const F=uu.fromJSON(this.name,w);_t(typeof E=="string",e,"internal-error"),Mo(p,e.name),Mo(g,e.name),_t(typeof O=="boolean",e,"internal-error"),_t(typeof Q=="boolean",e,"internal-error"),Mo(m,e.name),Mo(y,e.name),Mo(x,e.name),Mo(S,e.name),Mo(A,e.name),Mo(C,e.name);const T=new qa({uid:E,auth:e,email:g,emailVerified:O,displayName:p,isAnonymous:Q,photoURL:y,phoneNumber:m,tenantId:x,stsTokenManager:F,createdAt:A,lastLoginAt:C});return H&&Array.isArray(H)&&(T.providerData=H.map(N=>Object.assign({},N))),S&&(T._redirectEventId=S),T}static async _fromIdTokenResponse(e,r,n=!1){const i=new uu;i.updateFromServerResponse(r);const s=new qa({uid:r.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await Sp(s),s}static async _fromGetAccountInfoResponse(e,r,n){const i=r.users[0];_t(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?kF(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),o=new uu;o.updateFromIdToken(n);const l=new qa({uid:i.localId,auth:e,stsTokenManager:o,isAnonymous:a}),u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Hx(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(l,u),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nS=new Map;function Qa(t){ho(t instanceof Function,"Expected a class definition");let e=nS.get(t);return e?(ho(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,nS.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FF{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}FF.type="NONE";const iS=FF;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wh(t,e,r){return`firebase:${t}:${e}:${r}`}class du{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:i,name:s}=this.auth;this.fullUserKey=wh(this.userKey,i.apiKey,s),this.fullPersistenceKey=wh("persistence",i.apiKey,s),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?qa._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new du(Qa(iS),e,n);const i=(await Promise.all(r.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let s=i[0]||Qa(iS);const a=wh(n,e.config.apiKey,e.name);let o=null;for(const u of r)try{const f=await u._get(a);if(f){const p=qa._fromJSON(e,f);u!==s&&(o=p),s=u;break}}catch{}const l=i.filter(u=>u._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new du(s,e,n):(s=l[0],o&&await s._set(a,o.toJSON()),await Promise.all(r.map(async u=>{if(u!==s)try{await u._remove(a)}catch{}})),new du(s,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sS(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(RF(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(bF(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(PF(e))return"Blackberry";if(OF(e))return"Webos";if(IF(e))return"Safari";if((e.includes("chrome/")||NF(e))&&!e.includes("edge/"))return"Chrome";if(DF(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function bF(t=wi()){return/firefox\//i.test(t)}function IF(t=wi()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function NF(t=wi()){return/crios\//i.test(t)}function RF(t=wi()){return/iemobile/i.test(t)}function DF(t=wi()){return/android/i.test(t)}function PF(t=wi()){return/blackberry/i.test(t)}function OF(t=wi()){return/webos/i.test(t)}function dy(t=wi()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function Yz(t=wi()){var e;return dy(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function Xz(){return a9()&&document.documentMode===10}function MF(t=wi()){return dy(t)||DF(t)||OF(t)||PF(t)||/windows phone/i.test(t)||RF(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BF(t,e=[]){let r;switch(t){case"Browser":r=sS(wi());break;case"Worker":r=`${sS(wi())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${Lu}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qz{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=s=>new Promise((a,o)=>{try{const l=e(s);a(l)}catch(l){o(l)}});n.onAbort=r,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const i of r)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Qz(t,e={}){return Hu(t,"GET","/v2/passwordPolicy",cy(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jz=6;class Zz{constructor(e){var r,n,i,s;const a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=a.minPasswordLength)!==null&&r!==void 0?r:Jz,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(n=e.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var r,n,i,s,a,o;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(r=l.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(n=l.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),l.isValid&&(l.isValid=(i=l.containsLowercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(s=l.containsUppercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(a=l.containsNumericCharacter)!==null&&a!==void 0?a:!0),l.isValid&&(l.isValid=(o=l.containsNonAlphanumericCharacter)!==null&&o!==void 0?o:!0),l}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),i&&(r.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eW{constructor(e,r,n,i){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new aS(this),this.idTokenSubscription=new aS(this),this.beforeStateQueue=new qz(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=EF,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=Qa(r)),this._initializationPromise=this.queue(async()=>{var n,i;if(!this._deleted&&(this.persistenceManager=await du.create(this,e),!this._deleted)){if(!((n=this._popupRedirectResolver)===null||n===void 0)&&n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await CF(this,{idToken:e}),n=await qa._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var r;if(Xo(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(o,o))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let i=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,o=i==null?void 0:i._redirectEventId,l=await this.tryRedirectSignIn(e);(!a||a===o)&&(l!=null&&l.user)&&(i=l.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(a){i=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return _t(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await Sp(e)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=Oz()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Xo(this.app))return Promise.reject(Kl(this));const r=e?oa(e):null;return r&&_t(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&_t(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Xo(this.app)?Promise.reject(Kl(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Xo(this.app)?Promise.reject(Kl(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Qa(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await Qz(this),r=new Zz(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Zf("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await Kz(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&Qa(e)||this._popupRedirectResolver;_t(r,this,"argument-error"),this.redirectPersistenceManager=await du.create(this,[Qa(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(r=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,i){if(this._deleted)return()=>{};const s=typeof r=="function"?r:r.next.bind(r);let a=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(_t(o,this,"internal-error"),o.then(()=>{a||s(this.currentUser)}),typeof r=="function"){const l=e.addObserver(r,n,i);return()=>{a=!0,l()}}else{const l=e.addObserver(r);return()=>{a=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return _t(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=BF(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);const n=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());n&&(r["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(r["X-Firebase-AppCheck"]=i),r}async _getAppCheckToken(){var e;const r=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return r!=null&&r.error&&Rz(`Error while retrieving App Check token: ${r.error}`),r==null?void 0:r.token}}function fy(t){return oa(t)}class aS{constructor(e){this.auth=e,this.observer=null,this.addObserver=p9(r=>this.observer=r)}get next(){return _t(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let hy={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function tW(t){hy=t}function rW(t){return hy.loadJS(t)}function nW(){return hy.gapiScript}function iW(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sW(t,e){const r=bv(t,"auth");if(r.isInitialized()){const i=r.getImmediate(),s=r.getOptions();if(up(s,e??{}))return i;fo(i,"already-initialized")}return r.initialize({options:e})}function aW(t,e){const r=(e==null?void 0:e.persistence)||[],n=(Array.isArray(r)?r:[r]).map(Qa);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function oW(t,e,r){const n=fy(t);_t(n._canInitEmulator,n,"emulator-config-failed"),_t(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const i=!1,s=jF(e),{host:a,port:o}=lW(e),l=o===null?"":`:${o}`;n.config.emulator={url:`${s}//${a}${l}/`},n.settings.appVerificationDisabledForTesting=!0,n.emulatorConfig=Object.freeze({host:a,port:o,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),cW()}function jF(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function lW(t){const e=jF(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const s=i[1];return{host:s,port:oS(n.substr(s.length+1))}}else{const[s,a]=n.split(":");return{host:s,port:oS(a)}}}function oS(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function cW(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LF{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return Xa("not implemented")}_getIdTokenResponse(e){return Xa("not implemented")}_linkToIdToken(e,r){return Xa("not implemented")}_getReauthenticationResolver(e){return Xa("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fu(t,e){return jz(t,"POST","/v1/accounts:signInWithIdp",cy(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uW="http://localhost";class cc extends LF{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new cc(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):fo("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:i}=r,s=ay(r,["providerId","signInMethod"]);if(!n||!i)return null;const a=new cc(n,i);return a.idToken=s.idToken||void 0,a.accessToken=s.accessToken||void 0,a.secret=s.secret,a.nonce=s.nonce,a.pendingToken=s.pendingToken||null,a}_getIdTokenResponse(e){const r=this.buildRequest();return fu(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,fu(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,fu(e,r)}buildRequest(){const e={requestUri:uW,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=e0(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UF{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l0 extends UF{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vo extends l0{constructor(){super("facebook.com")}static credential(e){return cc._fromParams({providerId:Vo.PROVIDER_ID,signInMethod:Vo.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Vo.credentialFromTaggedObject(e)}static credentialFromError(e){return Vo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Vo.credential(e.oauthAccessToken)}catch{return null}}}Vo.FACEBOOK_SIGN_IN_METHOD="facebook.com";Vo.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zo extends l0{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return cc._fromParams({providerId:zo.PROVIDER_ID,signInMethod:zo.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return zo.credentialFromTaggedObject(e)}static credentialFromError(e){return zo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return zo.credential(r,n)}catch{return null}}}zo.GOOGLE_SIGN_IN_METHOD="google.com";zo.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wo extends l0{constructor(){super("github.com")}static credential(e){return cc._fromParams({providerId:Wo.PROVIDER_ID,signInMethod:Wo.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Wo.credentialFromTaggedObject(e)}static credentialFromError(e){return Wo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Wo.credential(e.oauthAccessToken)}catch{return null}}}Wo.GITHUB_SIGN_IN_METHOD="github.com";Wo.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ho extends l0{constructor(){super("twitter.com")}static credential(e,r){return cc._fromParams({providerId:Ho.PROVIDER_ID,signInMethod:Ho.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return Ho.credentialFromTaggedObject(e)}static credentialFromError(e){return Ho.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return Ho.credential(r,n)}catch{return null}}}Ho.TWITTER_SIGN_IN_METHOD="twitter.com";Ho.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nu{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,i=!1){const s=await qa._fromIdTokenResponse(e,n,i),a=lS(n);return new Nu({user:s,providerId:a,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const i=lS(n);return new Nu({user:e,providerId:i,_tokenResponse:n,operationType:r})}}function lS(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wp extends vo{constructor(e,r,n,i){var s;super(r.code,r.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,wp.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,i){return new wp(e,r,n,i)}}function VF(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?wp._fromErrorAndOperation(t,s,e,n):s})}async function dW(t,e,r=!1){const n=await Lf(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return Nu._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fW(t,e,r=!1){const{auth:n}=t;if(Xo(n.app))return Promise.reject(Kl(n));const i="reauthenticate";try{const s=await Lf(t,VF(n,i,e,t),r);_t(s.idToken,n,"internal-error");const a=uy(s.idToken);_t(a,n,"internal-error");const{sub:o}=a;return _t(t.uid===o,n,"user-mismatch"),Nu._forOperation(t,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&fo(n,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hW(t,e,r=!1){if(Xo(t.app))return Promise.reject(Kl(t));const n="signIn",i=await VF(t,n,e),s=await Nu._fromIdTokenResponse(t,n,i);return r||await t._updateCurrentUser(s.user),s}function pW(t,e,r,n){return oa(t).onIdTokenChanged(e,r,n)}function gW(t,e,r){return oa(t).beforeAuthStateChanged(e,r)}const Tp="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zF{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(Tp,"1"),this.storage.removeItem(Tp),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mW=1e3,xW=10;class WF extends zF{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=MF(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),i=this.localCache[r];n!==i&&e(r,i,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((a,o,l)=>{this.notifyListeners(a,l)});return}const n=e.key;r?this.detachListener():this.stopPolling();const i=()=>{const a=this.storage.getItem(n);!r&&this.localCache[n]===a||this.notifyListeners(n,a)},s=this.storage.getItem(n);Xz()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,xW):i()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},mW)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}WF.type="LOCAL";const vW=WF;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HF extends zF{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}HF.type="SESSION";const $F=HF;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yW(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ug{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(i=>i.isListeningto(e));if(r)return r;const n=new ug(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:i,data:s}=r.data,a=this.handlersMap[i];if(!(a!=null&&a.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const o=Array.from(a).map(async u=>u(r.origin,s)),l=await yW(o);r.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:l})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}ug.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function py(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _W{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,a;return new Promise((o,l)=>{const u=py("",20);i.port1.start();const f=setTimeout(()=>{l(new Error("unsupported_event"))},n);a={messageChannel:i,onMessage(p){const g=p;if(g.data.eventId===u)switch(g.data.status){case"ack":clearTimeout(f),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),o(g.data.response);break;default:clearTimeout(f),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:u,data:r},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Da(){return window}function EW(t){Da().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GF(){return typeof Da().WorkerGlobalScope<"u"&&typeof Da().importScripts=="function"}async function SW(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function wW(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function TW(){return GF()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KF="firebaseLocalStorageDb",AW=1,Ap="firebaseLocalStorage",YF="fbase_key";class c0{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function dg(t,e){return t.transaction([Ap],e?"readwrite":"readonly").objectStore(Ap)}function CW(){const t=indexedDB.deleteDatabase(KF);return new c0(t).toPromise()}function $x(){const t=indexedDB.open(KF,AW);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(Ap,{keyPath:YF})}catch(i){r(i)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(Ap)?e(n):(n.close(),await CW(),e(await $x()))})})}async function cS(t,e,r){const n=dg(t,!0).put({[YF]:e,value:r});return new c0(n).toPromise()}async function kW(t,e){const r=dg(t,!1).get(e),n=await new c0(r).toPromise();return n===void 0?null:n.value}function uS(t,e){const r=dg(t,!0).delete(e);return new c0(r).toPromise()}const FW=800,bW=3;class XF{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await $x(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>bW)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return GF()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=ug._getInstance(TW()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var e,r;if(this.activeServiceWorker=await SW(),!this.activeServiceWorker)return;this.sender=new _W(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((e=n[0])===null||e===void 0)&&e.fulfilled&&!((r=n[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||wW()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await $x();return await cS(e,Tp,"1"),await uS(e,Tp),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>cS(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>kW(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>uS(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=dg(i,!1).getAll();return new c0(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),r.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),r.push(i));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),FW)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}XF.type="LOCAL";const IW=XF;new o0(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NW(t,e){return e?Qa(e):(_t(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gy extends LF{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return fu(e,this._buildIdpRequest())}_linkToIdToken(e,r){return fu(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return fu(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function RW(t){return hW(t.auth,new gy(t),t.bypassAuthState)}function DW(t){const{auth:e,user:r}=t;return _t(r,e,"internal-error"),fW(r,new gy(t),t.bypassAuthState)}async function PW(t){const{auth:e,user:r}=t;return _t(r,e,"internal-error"),dW(r,new gy(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qF{constructor(e,r,n,i,s=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:i,tenantId:s,error:a,type:o}=e;if(a){this.reject(a);return}const l={auth:this.auth,requestUri:r,sessionId:n,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(l))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return RW;case"linkViaPopup":case"linkViaRedirect":return PW;case"reauthViaPopup":case"reauthViaRedirect":return DW;default:fo(this.auth,"internal-error")}}resolve(e){ho(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ho(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OW=new o0(2e3,1e4);class Jc extends qF{constructor(e,r,n,i,s){super(e,r,i,s),this.provider=n,this.authWindow=null,this.pollId=null,Jc.currentPopupAction&&Jc.currentPopupAction.cancel(),Jc.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return _t(e,this.auth,"internal-error"),e}async onExecution(){ho(this.filter.length===1,"Popup operations only handle one event");const e=py();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(Ra(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Ra(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Jc.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if(!((n=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Ra(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,OW.get())};e()}}Jc.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MW="pendingRedirect",Th=new Map;class BW extends qF{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=Th.get(this.auth._key());if(!e){try{const n=await jW(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}Th.set(this.auth._key(),e)}return this.bypassAuthState||Th.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function jW(t,e){const r=VW(e),n=UW(t);if(!await n._isAvailable())return!1;const i=await n._get(r)==="true";return await n._remove(r),i}function LW(t,e){Th.set(t._key(),e)}function UW(t){return Qa(t._redirectPersistence)}function VW(t){return wh(MW,t.config.apiKey,t.name)}async function zW(t,e,r=!1){if(Xo(t.app))return Promise.reject(Kl(t));const n=fy(t),i=NW(n,e),a=await new BW(n,i,r).execute();return a&&!r&&(delete a.user._redirectEventId,await n._persistUserIfCurrent(a.user),await n._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WW=10*60*1e3;class HW{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!$W(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!QF(e)){const i=((n=e.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";r.onError(Ra(this.auth,i))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=WW&&this.cachedEventUids.clear(),this.cachedEventUids.has(dS(e))}saveEventToCache(e){this.cachedEventUids.add(dS(e)),this.lastProcessedEventTime=Date.now()}}function dS(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function QF({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function $W(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return QF(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function GW(t,e={}){return Hu(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KW=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,YW=/^https?/;async function XW(t){if(t.config.emulator)return;const{authorizedDomains:e}=await GW(t);for(const r of e)try{if(qW(r))return}catch{}fo(t,"unauthorized-domain")}function qW(t){const e=Wx(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const a=new URL(t);return a.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&a.hostname===n}if(!YW.test(r))return!1;if(KW.test(t))return n===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QW=new o0(3e4,6e4);function fS(){const t=Da().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function JW(t){return new Promise((e,r)=>{var n,i,s;function a(){fS(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{fS(),r(Ra(t,"network-request-failed"))},timeout:QW.get()})}if(!((i=(n=Da().gapi)===null||n===void 0?void 0:n.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=Da().gapi)===null||s===void 0)&&s.load)a();else{const o=iW("iframefcb");return Da()[o]=()=>{gapi.load?a():r(Ra(t,"network-request-failed"))},rW(`${nW()}?onload=${o}`).catch(l=>r(l))}}).catch(e=>{throw Ah=null,e})}let Ah=null;function ZW(t){return Ah=Ah||JW(t),Ah}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eH=new o0(5e3,15e3),tH="__/auth/iframe",rH="emulator/auth/iframe",nH={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},iH=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function sH(t){const e=t.config;_t(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?ly(e,rH):`https://${t.config.authDomain}/${tH}`,n={apiKey:e.apiKey,appName:t.name,v:Lu},i=iH.get(t.config.apiHost);i&&(n.eid=i);const s=t._getFrameworks();return s.length&&(n.fw=s.join(",")),`${r}?${e0(n).slice(1)}`}async function aH(t){const e=await ZW(t),r=Da().gapi;return _t(r,t,"internal-error"),e.open({where:document.body,url:sH(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:nH,dontclear:!0},n=>new Promise(async(i,s)=>{await n.restyle({setHideOnLeave:!1});const a=Ra(t,"network-request-failed"),o=Da().setTimeout(()=>{s(a)},eH.get());function l(){Da().clearTimeout(o),i(n)}n.ping(l).then(l,()=>{s(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oH={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},lH=500,cH=600,uH="_blank",dH="http://localhost";class hS{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function fH(t,e,r,n=lH,i=cH){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-n)/2,0).toString();let o="";const l=Object.assign(Object.assign({},oH),{width:n.toString(),height:i.toString(),top:s,left:a}),u=wi().toLowerCase();r&&(o=NF(u)?uH:r),bF(u)&&(e=e||dH,l.scrollbars="yes");const f=Object.entries(l).reduce((g,[m,y])=>`${g}${m}=${y},`,"");if(Yz(u)&&o!=="_self")return hH(e||"",o),new hS(null);const p=window.open(e||"",o,f);_t(p,t,"popup-blocked");try{p.focus()}catch{}return new hS(p)}function hH(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pH="__/auth/handler",gH="emulator/auth/handler",mH=encodeURIComponent("fac");async function pS(t,e,r,n,i,s){_t(t.config.authDomain,t,"auth-domain-config-required"),_t(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:Lu,eventId:i};if(e instanceof UF){e.setDefaultLanguage(t.languageCode),a.providerId=e.providerId||"",h9(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,p]of Object.entries({}))a[f]=p}if(e instanceof l0){const f=e.getScopes().filter(p=>p!=="");f.length>0&&(a.scopes=f.join(","))}t.tenantId&&(a.tid=t.tenantId);const o=a;for(const f of Object.keys(o))o[f]===void 0&&delete o[f];const l=await t._getAppCheckToken(),u=l?`#${mH}=${encodeURIComponent(l)}`:"";return`${xH(t)}?${e0(o).slice(1)}${u}`}function xH({config:t}){return t.emulator?ly(t,gH):`https://${t.authDomain}/${pH}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mm="webStorageSupport";class vH{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=$F,this._completeRedirectFn=zW,this._overrideRedirectResult=LW}async _openPopup(e,r,n,i){var s;ho((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const a=await pS(e,r,n,Wx(),i);return fH(e,a,py())}async _openRedirect(e,r,n,i){await this._originValidation(e);const s=await pS(e,r,n,Wx(),i);return EW(s),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:i,promise:s}=this.eventManagers[r];return i?Promise.resolve(i):(ho(s,"If manager is not set, promise should be"),s)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await aH(e),n=new HW(e);return r.register("authEvent",i=>(_t(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:n.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(mm,{type:mm},i=>{var s;const a=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[mm];a!==void 0&&r(!!a),fo(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=XW(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return MF()||IF()||dy()}}const yH=vH;var gS="@firebase/auth",mS="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _H{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){_t(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EH(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function SH(t){wu(new sc("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=n.options;_t(a&&!a.includes(":"),"invalid-api-key",{appName:n.name});const l={apiKey:a,authDomain:o,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:BF(t)},u=new eW(n,i,s,l);return aW(u,r),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),wu(new sc("auth-internal",e=>{const r=fy(e.getProvider("auth").getImmediate());return(n=>new _H(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),ol(gS,mS,EH(t)),ol(gS,mS,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wH=5*60,TH=$C("authIdTokenMaxAge")||wH;let xS=null;const AH=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>TH)return;const i=r==null?void 0:r.token;xS!==i&&(xS=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function CH(t=XC()){const e=bv(t,"auth");if(e.isInitialized())return e.getImmediate();const r=sW(t,{popupRedirectResolver:yH,persistence:[IW,vW,$F]}),n=$C("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(n,location.origin);if(location.origin===s.origin){const a=AH(s.toString());gW(r,a,()=>a(r.currentUser)),pW(r,o=>a(o))}}const i=WC("auth");return i&&oW(r,`http://${i}`),r}function kH(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}tW({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=i=>{const s=Ra("internal-error");s.customData=i,r(s)},n.type="text/javascript",n.charset="UTF-8",kH().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});SH("Browser");const FH={apiKey:"AIzaSyAZZ0804o11q-hS6p7XJZNK_FPGJgXpmPc",authDomain:"finance-automation-b28e8.firebaseapp.com",projectId:"finance-automation-b28e8",storageBucket:"finance-automation-b28e8.firebasestorage.app",messagingSenderId:"832501526859",appId:"1:832501526859:web:3a64f40f9db732af1b78ce"},JF=YC(FH),my=dz(JF);CH(JF);const vd=async(t,e)=>{try{return await Fz(ey(my,"appState",t),{masterData:e.masterData||[],servicesData:e.servicesData||[],ledgerEntries:e.ledgerEntries||[],receipts:e.receipts||[],creditNotes:e.creditNotes||[],openingBalances:e.openingBalances||{},mailerImages:e.mailerImages||{},mailerLogo:e.mailerLogo||null,companyConfig:e.companyConfig||{},nextInvoiceNo:e.nextInvoiceNo||1,nextCombineNo:e.nextCombineNo||1,nextReceiptNo:e.nextReceiptNo||1,nextCreditNoteNo:e.nextCreditNoteNo||1,nextServiceInvoiceNo:e.nextServiceInvoiceNo||1,invoiceValues:e.invoiceValues||{},notifications:e.notifications||[],whatsappSettings:e.whatsappSettings||{},partyMaster:e.partyMaster||[],followups:e.followups||[],userPasswords:e.userPasswords||{},updatedAt:new Date().toISOString()}),!0}catch(r){return console.error("Error saving app state:",r),!1}},vS=async t=>{try{const e=await kz(ey(my,"appState",t));return e.exists()?e.data():null}catch(e){return console.error("Error loading app state:",e),null}},bH=(t,e)=>{const r=ey(my,"appState",t);return bz(r,n=>{n.exists()&&e(n.data())},n=>{console.error("Error in real-time listener:",n)})},at=t=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:2,maximumFractionDigits:2}).format(t||0),tr=t=>""+new Intl.NumberFormat("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2}).format(t||0),At=t=>{if(!t)return"-";const e=new Date(t);if(isNaN(e.getTime()))return t;const r=e.getDate().toString().padStart(2,"0"),n=e.toLocaleString("en-US",{month:"short"}),i=e.getFullYear();return`${r}-${n}-${i}`},IH=t=>{if(!t)return"-";const e=new Date(t);if(isNaN(e.getTime()))return t;const r=e.getDate(),n=e.toLocaleString("en-US",{month:"short"}),i=e.getFullYear();return`${r}${(a=>{if(a>3&&a<21)return"th";switch(a%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}})(r)} ${n}, ${i}`},xm=t=>{const e=["","One","Two","Three","Four","Five","Six","Seven","Eight","Nine","Ten","Eleven","Twelve","Thirteen","Fourteen","Fifteen","Sixteen","Seventeen","Eighteen","Nineteen"],r=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"];if(t===0)return"Zero";const n=l=>l<20?e[l]:l<100?r[Math.floor(l/10)]+(l%10?" "+e[l%10]:""):e[Math.floor(l/100)]+" Hundred"+(l%100?" "+n(l%100):""),i=l=>l<1e3?n(l):l<1e5?n(Math.floor(l/1e3))+" Thousand"+(l%1e3?" "+n(l%1e3):""):l<1e7?n(Math.floor(l/1e5))+" Lakh"+(l%1e5?" "+i(l%1e5):""):n(Math.floor(l/1e7))+" Crore"+(l%1e7?" "+i(l%1e7):""),s=Math.floor(t),a=Math.round((t-s)*100);let o="INR "+i(s);return a>0&&(o+=" and "+i(a)+" Paise"),o+" Only"},NH=t=>{if(!t)return"";const e=/[\w.-]+@[\w.-]+\.\w+/g,r=t.match(e);return r?r[0]:""},RH=t=>({Approved:{bg:"#DCFCE7",text:"#166534",border:"#86EFAC"},Created:{bg:"#DBEAFE",text:"#1E40AF",border:"#93C5FD"},"Need Edits":{bg:"#FEE2E2",text:"#991B1B",border:"#FCA5A5"},Paid:{bg:"#D1FAE5",text:"#065F46",border:"#6EE7B7"},Individual:{bg:"#E0E7FF",text:"#3730A3",border:"#A5B4FC"},Combined:{bg:"#F3E8FF",text:"#6B21A8",border:"#DDD6FE"},Yes:{bg:"#DCFCE7",text:"#166534",border:"#86EFAC"},No:{bg:"#FEF3C7",text:"#92400E",border:"#FCD34D"},"Not Yet":{bg:"#F1F5F9",text:"#475569",border:"#CBD5E1"},Pending:{bg:"#FEF3C7",text:"#92400E",border:"#FCD34D"},Sent:{bg:"#D1FAE5",text:"#065F46",border:"#6EE7B7"}})[t]||{bg:"#F1F5F9",text:"#475569",border:"#CBD5E1"},vm=({status:t,small:e=!1})=>{const r=RH(t);return c.jsx("span",{style:{display:"inline-flex",alignItems:"center",padding:e?"2px 8px":"4px 12px",borderRadius:"6px",fontSize:e?"11px":"12px",fontWeight:"600",backgroundColor:r.bg,color:r.text,border:`1px solid ${r.border}`},children:t})},Ye=({icon:t,label:e,onClick:r,variant:n="default",disabled:i=!1,small:s=!1,title:a})=>{const o={default:{bg:"#F8FAFC",hoverBg:"#E2E8F0",text:"#475569",border:"#CBD5E1"},primary:{bg:"#2874A6",hoverBg:"#1a5276",text:"#FFFFFF",border:"#2874A6"},success:{bg:"#059669",hoverBg:"#047857",text:"#FFFFFF",border:"#059669"},warning:{bg:"#D97706",hoverBg:"#B45309",text:"#FFFFFF",border:"#D97706"},danger:{bg:"#DC2626",hoverBg:"#B91C1C",text:"#FFFFFF",border:"#DC2626"},brand:{bg:"#2874A6",hoverBg:"#1a5276",text:"#FFFFFF",border:"#2874A6"},purple:{bg:"#7C3AED",hoverBg:"#6D28D9",text:"#FFFFFF",border:"#7C3AED"},secondary:{bg:"#F1F5F9",hoverBg:"#E2E8F0",text:"#475569",border:"#CBD5E1"}},l=o[n]||o.default,u=f=>{f&&(f.preventDefault(),f.stopPropagation()),!i&&r&&r(f)};return c.jsxs("button",{type:"button",onClick:u,disabled:i,title:a||e,style:{display:"inline-flex",alignItems:"center",gap:"6px",padding:s?"5px 10px":"8px 14px",borderRadius:"6px",fontSize:s?"11px":"13px",fontWeight:"600",backgroundColor:i?"#F1F5F9":l.bg,color:i?"#94A3B8":l.text,border:`1px solid ${i?"#E2E8F0":l.border}`,cursor:i?"not-allowed":"pointer",transition:"all 0.15s ease",whiteSpace:"nowrap",opacity:i?.6:1},onMouseEnter:f=>!i&&(f.target.style.backgroundColor=l.hoverBg),onMouseLeave:f=>!i&&(f.target.style.backgroundColor=l.bg),children:[t&&c.jsx(t,{size:s?14:16}),e&&c.jsx("span",{children:e})]})},Hr=({label:t,type:e="text",value:r,onChange:n,placeholder:i,disabled:s,small:a})=>c.jsxs("div",{style:{marginBottom:a?"12px":"16px"},children:[t&&c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:t}),c.jsx("input",{type:e,value:r,onChange:n,placeholder:i,disabled:s,style:{width:"100%",padding:a?"8px 12px":"10px 14px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:a?"13px":"14px",backgroundColor:s?"#F9FAFB":"#FFFFFF",boxSizing:"border-box"}})]}),nh=({label:t,value:e,onChange:r,options:n,small:i})=>c.jsxs("div",{style:{marginBottom:i?"12px":"16px"},children:[t&&c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:t}),c.jsx("select",{value:e,onChange:r,style:{width:"100%",padding:i?"8px 12px":"10px 14px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:i?"13px":"14px",backgroundColor:"#FFFFFF",boxSizing:"border-box"},children:n.map(s=>c.jsx("option",{value:s.value,children:s.label},s.value))})]}),En=({title:t,children:e,actions:r,noPadding:n=!1})=>c.jsxs("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"12px",border:"1px solid #E2E8F0",boxShadow:"0 2px 8px rgba(0,0,0,0.06)",overflow:"hidden"},children:[t&&c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"14px 20px",borderBottom:"1px solid #E2E8F0",backgroundColor:"#FAFBFC"},children:[c.jsx("h3",{style:{margin:0,fontSize:"15px",fontWeight:"700",color:"#1E293B"},children:t}),r&&c.jsx("div",{style:{display:"flex",gap:"10px"},children:r})]}),c.jsx("div",{style:{padding:n?0:"20px"},children:e})]}),Un=({isOpen:t,onClose:e,title:r,children:n,width:i="500px"})=>t?c.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(15, 23, 42, 0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,backdropFilter:"blur(4px)"},onClick:e,children:c.jsxs("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"16px",width:i,maxWidth:"95vw",maxHeight:"90vh",overflow:"hidden",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)"},onClick:s=>s.stopPropagation(),children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"16px 20px",borderBottom:"1px solid #E2E8F0",backgroundColor:"#FAFBFC"},children:[c.jsx("h2",{style:{margin:0,fontSize:"16px",fontWeight:"700",color:"#1E293B"},children:r}),c.jsx("button",{onClick:e,style:{background:"none",border:"none",cursor:"pointer",padding:"4px",color:"#64748B"},children:c.jsx(Ta,{size:20})})]}),c.jsx("div",{style:{padding:"20px",maxHeight:"calc(90vh - 100px)",overflowY:"auto"},children:n})]})}):null;function DH(){const[t,e]=ye.useState(()=>{const h=localStorage.getItem("financeAppLogin");return h?JSON.parse(h).isLoggedIn:!1}),[r,n]=ye.useState(()=>{const h=localStorage.getItem("financeAppLogin");return h?JSON.parse(h).userRole:null}),[i,s]=ye.useState({username:"",password:""}),[a,o]=ye.useState(""),[l,u]=ye.useState(!1),[f,p]=ye.useState(!1),[g,m]=ye.useState(null),[y,x]=ye.useState({finance:"finance123",director:"director123"}),[S,A]=ye.useState(!1),[C,E]=ye.useState(!1),[O,Q]=ye.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[H,w]=ye.useState(""),F={finance:{role:"finance",name:"Finance Team"},director:{role:"director",name:"Director"}};ye.useEffect(()=>{(async()=>{try{const _=await vS("indreesh-media");_&&_.userPasswords&&(x(_.userPasswords),console.log("Passwords loaded from Firebase"))}catch(_){console.error("Error loading passwords:",_)}A(!0)})()},[]);const[T,N]=ye.useState({name:"Indreesh Media LLP",brand:"JAC",address:"A-1701 Sweet Home CHS LTD, SVP, Plot No: 24",addressLine2:"Andheri West, Nr Last Bus St",city:"Mumbai-400053",gstin:"27AAIFI6351A1ZM",stateCode:"27",stateName:"Maharashtra",email:"alliances@mediabrief.com",phone:"+91 7021911036",website:"www.mediabrief.com",pan:"AAIFI6351A",bank:{name:"Axis Bank",account:"921020009075531",branch:"Andheri",ifsc:"UTIB0000020",holder:"Indreesh Media LLP"},invoicePrefix:"MB/2025-26/",hsnCode:"998365",gstRate:18}),[D,P]=ye.useState("master"),[R,Xe]=ye.useState(!1),[Se,De]=ye.useState([]),[ke,Ce]=ye.useState([]),[ie,be]=ye.useState([]),[Me,Y]=ye.useState([]),[re,ne]=ye.useState([]),[X,_e]=ye.useState(null),[Te,Le]=ye.useState(null),[Ne,Ie]=ye.useState(null),[ot,ee]=ye.useState(1),[Ot,wt]=ye.useState(1),[Mt,St]=ye.useState(1),[Ke,wr]=ye.useState(1),[rn,Cn]=ye.useState(1),[Bi,ji]=ye.useState(!1),[Li,Gr]=ye.useState(!1),[Ui,gr]=ye.useState(!1),[Kr,Nr]=ye.useState(!1),[Ai,yt]=ye.useState(!1),[Rr,Lr]=ye.useState(!1),[Ur,Bn]=ye.useState(!1),[yo,_o]=ye.useState(!1),[$u,Vs]=ye.useState(!1),[Al,la]=ye.useState(!1),[ja,zs]=ye.useState(!1),[ce,ur]=ye.useState(null),[ca,La]=ye.useState("reply"),[Ua,ys]=ye.useState(""),[ua,Vr]=ye.useState(""),[kn,_s]=ye.useState({fromDate:"2020-01-01",toDate:new Date().toISOString().split("T")[0]}),[Es,Gu]=ye.useState(""),[Ci,I]=ye.useState("open"),[G,j]=ye.useState("open"),[V,q]=ye.useState(!1),[J,pe]=ye.useState(null),[ve,he]=ye.useState(new Set),[de,ge]=ye.useState({party:"",billStatus:"",invoiceStatus:""}),[we,ze]=ye.useState({party:"",invoiceNo:"",dateFrom:"",dateTo:""}),[je,Pe]=ye.useState({party:"",invoiceStatus:"",receiptStatus:"",invoiceType:"",searchText:""}),[We,ut]=ye.useState([]),[mr,sr]=ye.useState(!1),[Xt,ki]=ye.useState([]),[Va,es]=ye.useState(!1),[dr,da]=ye.useState(null),[Fr,za]=ye.useState({date:new Date().toISOString().split("T")[0],notes:"",nextFollowupDate:"",status:"Pending"}),[bt,fa]=ye.useState({enabled:!1,financePhone:"",financeApiKey:"",directorPhone:"",directorApiKey:""}),[qt,ts]=ye.useState({amount:"",tds:"",discount:"",narration:"",paymentAdvisory:null,date:new Date().toISOString().split("T")[0],mode:"Bank"}),[xn,ha]=ye.useState({amount:"",gst:"",reason:"",date:new Date().toISOString().split("T")[0]}),[Eo,Fi]=ye.useState({particularsApproved:!1,emailApproved:!1,invoiceTypeApproved:!1}),[Vi,So]=ye.useState(null),[zi,wo]=ye.useState(new Set),[It,pa]=ye.useState({}),[Kn,ga]=ye.useState(null),[To,Ws]=ye.useState(null),[Ku,Ao]=ye.useState(!1),[Yn,_c]=ye.useState({}),[jn,rs]=ye.useState({partyName:"",amount:"",type:"Dr"}),[Wi,Ec]=ye.useState({}),[un,Hs]=ye.useState({}),[fg,Sc]=ye.useState(!1),[u0,Ss]=ye.useState(new Set),[Tt,Cl]=ye.useState({party:"",billStatus:"",invoiceStatus:"",mailingStatus:"",invoiceType:"",combinationCode:"",searchText:""}),[Ar,$s]=ye.useState({amount:"",date:new Date().toISOString().split("T")[0],mode:"Bank",tds:"",discount:"",narration:""}),Yu=ye.useRef(null),Co=ye.useRef(null),ko=ye.useRef(null),wc=ye.useRef(null),Tc=ye.useRef(null),Dr=ye.useRef(null),d0=ye.useRef(null),kl=ye.useRef(null),Xu=ye.useRef(null),qu=ye.useRef(null),Fn=ye.useMemo(()=>Array.isArray(Se)?Se:[],[Se]),Yr=ye.useMemo(()=>Array.isArray(ke)?ke:[],[ke]),Xn=ye.useMemo(()=>Array.isArray(ie)?ie:[],[ie]),Xr=ye.useMemo(()=>Array.isArray(Me)?Me:[],[Me]),oi=ye.useMemo(()=>Array.isArray(re)?re:[],[re]),f0=ye.useMemo(()=>Array.isArray(We)?We:[],[We]),ma=ye.useMemo(()=>Array.isArray(Xt)?Xt:[],[Xt]),Ht=ye.useMemo(()=>un&&typeof un=="object"&&!Array.isArray(un)?un:{},[un]),xa=ye.useMemo(()=>Yn&&typeof Yn=="object"&&!Array.isArray(Yn)?Yn:{},[Yn]),$t=(h,_)=>!h||!_?!1:h.trim().toUpperCase()===_.trim().toUpperCase(),qn=ye.useCallback(h=>{if(!h)return"";const _=h.toUpperCase().trim();return _.includes("MAHARASHTRA")||_==="MH"?"MAHARASHTRA":_.includes("DELHI")||_==="DL"||_.includes("NEW DELHI")?"DELHI":_.includes("KARNATAKA")||_==="KA"||_.includes("BANGALORE")||_.includes("BENGALURU")?"KARNATAKA":_.includes("TAMIL")||_==="TN"||_.includes("CHENNAI")?"TAMIL NADU":_.includes("TELANGANA")||_==="TG"||_==="TS"||_.includes("HYDERABAD")?"TELANGANA":_.includes("UTTAR PRADESH")||_==="UP"||_.includes("NOIDA")||_.includes("LUCKNOW")?"UTTAR PRADESH":_.includes("WEST BENGAL")||_==="WB"||_.includes("KOLKATA")?"WEST BENGAL":_.includes("GUJARAT")||_==="GJ"||_.includes("AHMEDABAD")?"GUJARAT":_.includes("RAJASTHAN")||_==="RJ"||_.includes("JAIPUR")?"RAJASTHAN":_.includes("PUNJAB")||_==="PB"?"PUNJAB":_.includes("HARYANA")||_==="HR"||_.includes("GURGAON")||_.includes("GURUGRAM")?"HARYANA":_.includes("MADHYA PRADESH")||_==="MP"||_.includes("BHOPAL")?"MADHYA PRADESH":_.includes("ANDHRA")||_==="AP"?"ANDHRA PRADESH":_.includes("KERALA")||_==="KL"?"KERALA":_.includes("ODISHA")||_.includes("ORISSA")||_==="OR"||_==="OD"?"ODISHA":_.includes("BIHAR")||_==="BR"?"BIHAR":_.includes("JHARKHAND")||_==="JH"?"JHARKHAND":_.includes("ASSAM")||_==="AS"?"ASSAM":_.includes("CHHATTISGARH")||_==="CG"?"CHHATTISGARH":_.includes("GOA")||_==="GA"?"GOA":_.includes("HIMACHAL")||_==="HP"?"HIMACHAL PRADESH":_.includes("JAMMU")||_==="JK"?"JAMMU AND KASHMIR":_.includes("UTTARAKHAND")||_.includes("UTTARANCHAL")||_==="UK"?"UTTARAKHAND":_.includes("MUMBAI")?"MAHARASHTRA":_.includes("CHANDIGARH")?"CHANDIGARH":_},[]),Fo=ye.useCallback((h,_)=>{var se;if(!h)return"";const W=qn(_),Z=h.trim().toUpperCase(),L=`${Z}|${W}`;if((se=Ht[L])!=null&&se.gstin)return Ht[L].gstin;for(const M in Ht){const z=Ht[M];if((z.partyName||"").trim().toUpperCase()===Z&&z.normalizedState===W)return z.gstin||""}for(const M in Ht){const z=Ht[M];if((z.partyName||"").trim().toUpperCase()===Z&&z.gstin)return z.gstin}return""},[Ht,qn]),Qu=ye.useCallback((h,_)=>{var se;if(!h)return"";const W=qn(_),Z=h.trim().toUpperCase(),L=`${Z}|${W}`;if((se=Ht[L])!=null&&se.address)return Ht[L].address;for(const M in Ht){const z=Ht[M];if((z.partyName||"").trim().toUpperCase()===Z&&z.normalizedState===W)return z.address||""}for(const M in Ht){const z=Ht[M];if((z.partyName||"").trim().toUpperCase()===Z&&z.address)return z.address}return""},[Ht,qn]),zr=ye.useCallback((h,_,W="")=>{var M,z;if(W&&((M=Ht[W])!=null&&M.clientCode))return Ht[W].clientCode;if(!h)return"";const Z=qn(_),L=h.trim().toUpperCase(),se=`${L}|${Z}`;if((z=Ht[se])!=null&&z.clientCode)return Ht[se].clientCode;for(const b in Ht){const U=Ht[b];if((U.partyName||"").trim().toUpperCase()===L&&U.normalizedState===Z)return U.clientCode||""}for(const b in Ht){const U=Ht[b];if((U.partyName||"").trim().toUpperCase()===L&&U.clientCode)return U.clientCode}return""},[Ht,qn]);ye.useCallback(h=>{if(!h)return null;if(Ht[h])return Ht[h];for(const _ in Ht){const W=Ht[_];if(W.clientCode===h)return W}return null},[Ht]);const ws=ye.useRef(!1),va=ye.useRef(null),Ju=async()=>{u(!0);try{const h=await vS("indreesh-media");h&&(Array.isArray(h.masterData)&&De(h.masterData),Array.isArray(h.servicesData)&&Ce(h.servicesData),Array.isArray(h.ledgerEntries)&&be(h.ledgerEntries),Array.isArray(h.receipts)&&Y(h.receipts),Array.isArray(h.creditNotes)&&ne(h.creditNotes),Array.isArray(h.notifications)&&ut(h.notifications),Array.isArray(h.followups)&&ki(h.followups),h.openingBalances&&typeof h.openingBalances=="object"&&!Array.isArray(h.openingBalances)&&_c(h.openingBalances),h.mailerImages&&typeof h.mailerImages=="object"&&!Array.isArray(h.mailerImages)&&pa(h.mailerImages),h.partyMaster&&typeof h.partyMaster=="object"&&!Array.isArray(h.partyMaster)&&Hs(h.partyMaster),h.userPasswords&&typeof h.userPasswords=="object"&&!Array.isArray(h.userPasswords)&&x(h.userPasswords),h.mailerLogo&&ga(h.mailerLogo),h.companyConfig&&N(_=>({..._,...h.companyConfig,name:"Indreesh Media LLP",bank:{...h.companyConfig.bank||_.bank,holder:"Indreesh Media LLP"}})),h.nextInvoiceNo&&ee(h.nextInvoiceNo),h.nextCombineNo&&wt(h.nextCombineNo),h.nextReceiptNo&&St(h.nextReceiptNo),h.nextCreditNoteNo&&wr(h.nextCreditNoteNo),h.nextServiceInvoiceNo&&Cn(h.nextServiceInvoiceNo),h.invoiceValues&&Ec(h.invoiceValues),h.whatsappSettings&&fa(_=>({..._,...h.whatsappSettings})),console.log("Data loaded from Firebase"))}catch(h){console.error("Error loading data:",h)}u(!1)},Ac=ye.useCallback(async()=>{p(!0);try{console.log("Saving to Firebase:",{masterDataCount:Se==null?void 0:Se.length,servicesDataCount:ke==null?void 0:ke.length,servicesDataSample:ke==null?void 0:ke.slice(0,1),receiptsCount:Me==null?void 0:Me.length,creditNotesCount:re==null?void 0:re.length}),await vd("indreesh-media",{masterData:Se,servicesData:ke,ledgerEntries:ie,receipts:Me,creditNotes:re,openingBalances:Yn,mailerImages:It,mailerLogo:Kn,companyConfig:T,nextInvoiceNo:ot,nextCombineNo:Ot,nextReceiptNo:Mt,nextCreditNoteNo:Ke,nextServiceInvoiceNo:rn,invoiceValues:Wi,notifications:We,whatsappSettings:bt,partyMaster:un,followups:Xt,userPasswords:y}),m(new Date),console.log("Data saved to Firebase successfully")}catch(h){console.error("Error saving data:",h)}p(!1)},[Se,ke,ie,Me,re,Yn,It,Kn,T,ot,Ot,Mt,Ke,rn,Wi,We,bt,un,Xt,y]);ye.useEffect(()=>{if(t&&!ws.current)return kl.current&&clearTimeout(kl.current),kl.current=setTimeout(()=>{ws.current||Ac()},1e3),()=>{kl.current&&clearTimeout(kl.current)}},[Se,ke,ie,Me,re,Yn,It,Kn,T,ot,Ot,Mt,Ke,rn,Wi,We,bt,un,Xt,y,t]);const Zu=async(h,_,W)=>{if(!bt.enabled){console.log("WhatsApp notifications not enabled");return}W==="finance"&&bt.financePhone&&bt.financeApiKey?bo(bt.financePhone,bt.financeApiKey,h,_):W==="director"&&bt.directorPhone&&bt.directorApiKey?bo(bt.directorPhone,bt.directorApiKey,h,_):W==="all"&&(bt.financePhone&&bt.financeApiKey&&bo(bt.financePhone,bt.financeApiKey,h,_),bt.directorPhone&&bt.directorApiKey&&bo(bt.directorPhone,bt.directorApiKey,h,_))},bo=async(h,_,W,Z)=>{try{const se=`*${{upload:" DATA UPLOAD",invoice:" INVOICE",approval:" APPROVED",edit:" EDIT REQUIRED",receipt:" PAYMENT",info:" UPDATE"}[W]||" NOTIFICATION"}*

${Z}

_${T.name}_
_${new Date().toLocaleString("en-IN",{timeZone:"Asia/Kolkata"})}_`,M=`https://api.callmebot.com/whatsapp.php?phone=${h}&text=${encodeURIComponent(se)}&apikey=${_}`;fetch(M,{mode:"no-cors"}).then(()=>console.log("WhatsApp notification sent to:",h)).catch(z=>console.log("WhatsApp send attempted:",h))}catch(L){console.error("Failed to send WhatsApp notification:",L)}},Fl=(h,_)=>{if(!h||!_){alert("Please enter phone number and API key first");return}bo(h,_,"info","Test notification from Indreesh Media LLP. WhatsApp notifications are working!"),alert("Test message sent! Check your WhatsApp.")},ns=(h,_,W="all")=>{const Z={id:Date.now()+Math.random(),type:h,message:_,forRole:W,createdAt:new Date().toISOString(),createdBy:r,read:{finance:!1,director:!1}};ut(L=>[Z,...L].slice(0,50)),Zu(h,_,W)},h0=h=>{ut(_=>(Array.isArray(_)?_:[]).map(Z=>Z.id===h?{...Z,read:{...Z.read,[r]:!0}}:Z))},Wa=()=>{ut(h=>(Array.isArray(h)?h:[]).map(W=>({...W,read:{...W.read,[r]:!0}})))},p0=()=>{ut([])},bl=ye.useMemo(()=>f0.filter(h=>h.forRole==="all"||h.forRole===r||h.createdBy!==r).map(h=>({...h,read:h.read||{finance:!1,director:!1}})),[f0,r]),Ts=ye.useMemo(()=>r?bl.filter(h=>!(h.read&&h.read[r])).length:0,[bl,r]),ed=async()=>{const h=F[i.username.toLowerCase()],_=y[i.username.toLowerCase()];h&&_===i.password?(e(!0),n(h.role),localStorage.setItem("financeAppLogin",JSON.stringify({isLoggedIn:!0,userRole:h.role})),o(""),s({username:"",password:""}),await Ju()):o("Invalid username or password")},Io=async()=>{if(!O.currentPassword||!O.newPassword||!O.confirmPassword){w("Please fill all fields");return}const h=r==="director"?"director":"finance";if(y[h]!==O.currentPassword){w("Current password is incorrect");return}if(O.newPassword!==O.confirmPassword){w("New passwords do not match");return}if(O.newPassword.length<6){w("Password must be at least 6 characters");return}const _={...y,[h]:O.newPassword};x(_);try{await vd("indreesh-media",{masterData:Se,ledgerEntries:ie,receipts:Me,creditNotes:re,openingBalances:Yn,mailerImages:It,mailerLogo:Kn,companyConfig:T,nextInvoiceNo:ot,nextCombineNo:Ot,nextReceiptNo:Mt,nextCreditNoteNo:Ke,invoiceValues:Wi,notifications:We,whatsappSettings:bt,partyMaster:un,followups:Xt,userPasswords:_}),console.log("Password saved to Firebase")}catch(W){console.error("Error saving password:",W),w("Failed to save password. Please try again.");return}E(!1),Q({currentPassword:"",newPassword:"",confirmPassword:""}),w(""),alert(" Password changed successfully!")},bi=()=>{Ac(),e(!1),n(null),P("master"),localStorage.removeItem("financeAppLogin")};ye.useEffect(()=>{const h=localStorage.getItem("financeAppLogin");if(h){const{isLoggedIn:_}=JSON.parse(h);_&&Ju()}},[]),ye.useEffect(()=>{if(!t){va.current&&(va.current(),va.current=null);return}return va.current=bH("indreesh-media",h=>{h&&(console.log("Firebase data received:",{hasMasterData:Array.isArray(h.masterData)?h.masterData.length:"not array",hasServicesData:Array.isArray(h.servicesData)?h.servicesData.length:"not array",servicesDataRaw:h.servicesData,hasReceipts:Array.isArray(h.receipts)?h.receipts.length:"not array",hasCreditNotes:Array.isArray(h.creditNotes)?h.creditNotes.length:"not array"}),ws.current=!0,Array.isArray(h.masterData)&&De(h.masterData),Array.isArray(h.servicesData)&&Ce(h.servicesData),Array.isArray(h.ledgerEntries)&&be(h.ledgerEntries),Array.isArray(h.receipts)&&Y(h.receipts),Array.isArray(h.creditNotes)&&ne(h.creditNotes),Array.isArray(h.notifications)&&ut(h.notifications),Array.isArray(h.followups)&&ki(h.followups),h.openingBalances&&typeof h.openingBalances=="object"&&!Array.isArray(h.openingBalances)&&_c(h.openingBalances),h.mailerImages&&typeof h.mailerImages=="object"&&!Array.isArray(h.mailerImages)&&pa(h.mailerImages),h.partyMaster&&typeof h.partyMaster=="object"&&!Array.isArray(h.partyMaster)&&Hs(h.partyMaster),h.userPasswords&&typeof h.userPasswords=="object"&&!Array.isArray(h.userPasswords)&&x(h.userPasswords),h.mailerLogo&&ga(h.mailerLogo),h.companyConfig&&N(_=>({..._,...h.companyConfig,name:"Indreesh Media LLP",bank:{...h.companyConfig.bank||_.bank,holder:"Indreesh Media LLP"}})),h.nextInvoiceNo&&ee(h.nextInvoiceNo),h.nextCombineNo&&wt(h.nextCombineNo),h.nextReceiptNo&&St(h.nextReceiptNo),h.nextCreditNoteNo&&wr(h.nextCreditNoteNo),h.nextServiceInvoiceNo&&Cn(h.nextServiceInvoiceNo),h.invoiceValues&&Ec(h.invoiceValues),h.whatsappSettings&&fa(_=>({..._,...h.whatsappSettings})),setTimeout(()=>{ws.current=!1},500),console.log("Real-time sync: Data updated from Firebase"))}),()=>{va.current&&(va.current(),va.current=null)}},[t]),ye.useEffect(()=>{if(Yr.length>0){const h=new Set(Yr.map(_=>_.partyName).filter(Boolean));he(_=>_.size===0||_.size!==h.size?h:_)}},[Yr]);const Cr=r==="finance",li=r==="director",Gs=ye.useMemo(()=>{const h=new Set;return Fn.forEach(_=>{_.partyName&&h.add(_.partyName)}),Object.values(Ht).forEach(_=>{_.partyName&&h.add(_.partyName)}),Xn.forEach(_=>{_.partyName&&h.add(_.partyName)}),Object.keys(xa).forEach(_=>{_&&h.add(_)}),Array.from(h).filter(Boolean).sort()},[Fn,Ht,Xn,xa]),d=ye.useMemo(()=>{console.log("=== BUILDING PARTIES FOR LEDGER ===");const h=z=>{if(!z)return"";const b=z.toUpperCase().trim();return b.includes("MAHARASHTRA")||b==="MH"||b.includes("MUMBAI")?"MAHARASHTRA":b.includes("DELHI")||b==="DL"||b.includes("NEW DELHI")?"DELHI":b.includes("KARNATAKA")||b==="KA"||b.includes("BANGALORE")||b.includes("BENGALURU")?"KARNATAKA":b.includes("TAMIL")||b==="TN"||b.includes("CHENNAI")?"TAMIL NADU":b.includes("TELANGANA")||b==="TG"||b==="TS"||b.includes("HYDERABAD")?"TELANGANA":b.includes("UTTAR PRADESH")||b==="UP"||b.includes("NOIDA")||b.includes("LUCKNOW")?"UTTAR PRADESH":b.includes("WEST BENGAL")||b==="WB"||b.includes("KOLKATA")?"WEST BENGAL":b.includes("GUJARAT")||b==="GJ"||b.includes("AHMEDABAD")?"GUJARAT":b.includes("RAJASTHAN")||b==="RJ"||b.includes("JAIPUR")?"RAJASTHAN":b.includes("PUNJAB")||b==="PB"?"PUNJAB":b.includes("HARYANA")||b==="HR"||b.includes("GURGAON")||b.includes("GURUGRAM")?"HARYANA":b.includes("MADHYA PRADESH")||b==="MP"||b.includes("BHOPAL")?"MADHYA PRADESH":b.includes("ANDHRA")||b==="AP"?"ANDHRA PRADESH":b.includes("KERALA")||b==="KL"?"KERALA":b.includes("ODISHA")||b.includes("ORISSA")||b==="OR"||b==="OD"?"ODISHA":b.includes("BIHAR")||b==="BR"?"BIHAR":b.includes("JHARKHAND")||b==="JH"?"JHARKHAND":b.includes("ASSAM")||b==="AS"?"ASSAM":b.includes("CHHATTISGARH")||b==="CG"?"CHHATTISGARH":b.includes("GOA")||b==="GA"?"GOA":b.includes("HIMACHAL")||b==="HP"?"HIMACHAL PRADESH":b.includes("JAMMU")||b==="JK"?"JAMMU AND KASHMIR":b.includes("UTTARAKHAND")||b.includes("UTTARANCHAL")||b==="UK"?"UTTARAKHAND":b.includes("CHANDIGARH")?"CHANDIGARH":b},_=new Map,W=new Set;Object.entries(Ht).forEach(([z,b])=>{if(b.partyName&&b.clientCode){const U=b.partyName.trim().toUpperCase();W.add(U),_.has(b.clientCode)||_.set(b.clientCode,{partyName:b.partyName,partyNameUpper:U,state:b.stateName||"",normalizedState:b.normalizedState||h(b.stateName),gstin:b.gstin||"",address:b.address||"",clientCode:b.clientCode,fromPartyMaster:!0})}}),console.log("Party names with codes:",[...W]),console.log("Parties by code:",_.size);const Z=[..._.values()],L=new Set;_.forEach((z,b)=>{L.add(b),L.add(`${z.partyNameUpper}|${z.normalizedState}`)}),Object.entries(Ht).forEach(([z,b])=>{if(b.partyName&&!b.clientCode){const U=b.partyName.trim().toUpperCase(),oe=b.normalizedState||h(b.stateName),fe=`${U}|${oe}`;if(W.has(U)){console.log("Skipping (name has codes):",b.partyName);return}L.has(fe)||(L.add(fe),Z.push({partyName:b.partyName,partyNameUpper:U,state:b.stateName||"",normalizedState:oe,gstin:b.gstin||"",address:b.address||"",clientCode:"",fromPartyMaster:!0}))}});const se=(z,b)=>{if(!z)return"";const U=z.trim().toUpperCase(),oe=h(b);for(const[fe,me]of _.entries())if(me.partyNameUpper===U&&me.normalizedState===oe)return fe;for(const[fe,me]of _.entries())if(me.partyNameUpper===U)return fe;return""};Fn.forEach(z=>{if(z.partyName){const b=z.partyName.trim().toUpperCase(),U=h(z.statePartyDetails),oe=z.clientCode||se(z.partyName,z.statePartyDetails);if(oe&&L.has(oe))return;if(!oe&&W.has(b)){console.log("Skipping masterData (name has codes):",z.partyName);return}const fe=`${b}|${U}`;if(L.has(fe))return;L.add(oe||fe),oe&&L.add(fe),Z.push({partyName:z.partyName,partyNameUpper:b,state:z.statePartyDetails||"",normalizedState:U,gstin:"",address:"",clientCode:oe,fromPartyMaster:!1})}}),Xn.forEach(z=>{if(z.partyName){const b=z.partyName.trim().toUpperCase(),U=h(z.state||z.statePartyDetails||""),oe=se(z.partyName,z.state||z.statePartyDetails);if(oe&&L.has(oe))return;if(!oe&&W.has(b)){console.log("Skipping ledgerEntry (name has codes):",z.partyName);return}const fe=`${b}|${U}`;if(L.has(fe))return;L.add(oe||fe),Z.push({partyName:z.partyName,partyNameUpper:b,state:z.state||z.statePartyDetails||"",normalizedState:U,gstin:"",address:"",clientCode:oe,fromPartyMaster:!1})}}),Object.keys(xa).forEach(z=>{if(z){const b=z.trim().toUpperCase(),U=se(z,"");if(U&&L.has(U))return;if(!U&&W.has(b)){console.log("Skipping openingBalance (name has codes):",z);return}const oe=`${b}|`;if(L.has(oe))return;let fe=!1;for(const me of L)if(me.startsWith(b+"|")){fe=!0;break}if(fe)return;L.add(U||oe),Z.push({partyName:z,partyNameUpper:b,state:"",normalizedState:"",gstin:"",address:"",clientCode:U,fromPartyMaster:!1})}}),Yr.forEach(z=>{if(z.partyName){const b=z.partyName.trim().toUpperCase(),U=h(z.statePartyDetails),oe=z.clientCode||se(z.partyName,z.statePartyDetails);if(oe&&L.has(oe))return;if(!oe&&W.has(b)){console.log("Skipping servicesData (name has codes):",z.partyName);return}const fe=`${b}|${U}`;if(L.has(fe))return;L.add(oe||fe),Z.push({partyName:z.partyName,partyNameUpper:b,state:z.statePartyDetails||"",normalizedState:U,gstin:z.gstin||"",address:z.address||"",clientCode:oe,fromPartyMaster:!1})}});const M=Z.filter(z=>!z.clientCode&&W.has(z.partyNameUpper)?(console.log("FINAL CLEANUP - Removing:",z.partyName,"state:",z.state),!1):!0);return console.log("Final party list:",M.length,"parties"),M.forEach(z=>console.log("  -",z.partyName,z.clientCode||"(no code)",z.state)),M.sort((z,b)=>z.partyName.localeCompare(b.partyName))},[Fn,Yr,Ht,Xn,xa]);ye.useMemo(()=>[...new Set(Fn.filter(_=>_.combinationCode&&_.combinationCode!=="NA").map(_=>_.combinationCode))].sort((_,W)=>parseInt(_)-parseInt(W)),[Fn]);const v=ye.useMemo(()=>Fn.filter(h=>{var _,W,Z,L,se,M;if(Tt.party&&h.partyName!==Tt.party||Tt.billStatus&&h.toBeBilled!==Tt.billStatus||Tt.invoiceStatus&&(Tt.invoiceStatus==="Generated"&&!h.invoiceGenerated||Tt.invoiceStatus==="Not Generated"&&h.invoiceGenerated||Tt.invoiceStatus==="Paid"&&h.invoiceStatus!=="Paid")||Tt.mailingStatus&&h.mailingSent!==Tt.mailingStatus||Tt.invoiceType&&h.invoiceType!==Tt.invoiceType||Tt.combinationCode&&h.combinationCode!==Tt.combinationCode)return!1;if(Tt.searchText){const z=Tt.searchText.toLowerCase();if(!(((_=h.senderName)==null?void 0:_.toLowerCase().includes(z))||((W=h.subject)==null?void 0:W.toLowerCase().includes(z))||((Z=h.campaignName)==null?void 0:Z.toLowerCase().includes(z))||((L=h.invoiceNo)==null?void 0:L.toLowerCase().includes(z))||((se=h.partyName)==null?void 0:se.toLowerCase().includes(z))||((M=h.emailId)==null?void 0:M.toLowerCase().includes(z))))return!1}return!0}),[Fn,Tt]);ye.useMemo(()=>{const h={};return v.forEach(_=>{h[_.partyName]||(h[_.partyName]=[]),h[_.partyName].push(_)}),Object.keys(h).forEach(_=>{h[_].sort((W,Z)=>W.toBeBilled==="Yes"&&Z.toBeBilled!=="Yes"?-1:W.toBeBilled!=="Yes"&&Z.toBeBilled==="Yes"?1:0)}),h},[v]),ye.useMemo(()=>{if(!X)return[];const h=xa[X]||0;let _=h;const W=Xn.filter(Z=>$t(Z.partyName,X)).sort((Z,L)=>new Date(Z.date)-new Date(L.date)).map(Z=>(_=_+Z.debit-Z.credit,{...Z,balance:_}));return h!==0?[{id:"opening",date:"",particulars:"Opening Balance",debit:h>0?h:0,credit:h<0?Math.abs(h):0,balance:h,isOpening:!0},...W]:W},[X,Xn,xa]);const k=h=>Fn.filter(_=>$t(_.partyName,h)&&_.toBeBilled==="Yes"&&!_.invoiceGenerated&&_.invoiceAmount),B=h=>!h||h==="NA"?!1:Fn.some(_=>_.combinationCode===h&&_.mailingSent==="Yes"),ue=h=>h.invoiceType==="Combined"&&h.combinationCode!=="NA"?Fn.filter(_=>_.combinationCode===h.combinationCode):[h],xe=()=>{Cl({party:"",billStatus:"",invoiceStatus:"",mailingStatus:"",invoiceType:"",combinationCode:"",searchText:""})},He=Object.values(Tt).some(h=>h!==""),er=h=>{const _=[];return h.emailId&&_.push(h.emailId),h.additionalEmails&&h.additionalEmails.length>0&&_.push(...h.additionalEmails),_},bn=(h,_)=>{!_||!_.includes("@")||De(W=>W.map(Z=>{if(Z.id===h){const L=Z.additionalEmails||[];if(!L.includes(_)&&_!==Z.emailId)return{...Z,additionalEmails:[...L,_]}}return Z}))},Qt=(h,_)=>{De(W=>W.map(Z=>Z.id===h?{...Z,additionalEmails:(Z.additionalEmails||[]).filter(L=>L!==_)}:Z))},In=h=>{ur(h),Vr(h.editComments||h.approvalRemarks||""),Fi({particularsApproved:h.particularsApproved||!1,emailApproved:h.emailApproved||!1,invoiceTypeApproved:h.invoiceTypeApproved||!1}),Bn(!0)},Ln=()=>{if(!ce)return;if(!Eo.particularsApproved||!Eo.emailApproved||!Eo.invoiceTypeApproved){alert("Please confirm all approval checkboxes before approving.");return}const h={invoiceStatus:"Approved",approvalRemarks:ua.trim()||"",editComments:"",particularsApproved:!0,emailApproved:!0,invoiceTypeApproved:!0,approvedBy:r,approvedDate:new Date().toISOString()};if(ce.isService){Ce(L=>L.map(se=>se.id===ce.id?{...se,...h}:se));const W=parseFloat(ce.invoiceTotalAmount)||0,Z=`${ce.invoiceNo} - ${ce.serviceType||"Service"}`;be(L=>[...L,{id:Date.now(),partyName:ce.partyName,date:ce.invoiceDate,particulars:ce.serviceType||"Service",narration:Z,debit:W,credit:0,type:"invoice",invoiceNo:ce.invoiceNo}])}else{let W=[];ce.invoiceType==="Combined"&&ce.combinationCode!=="NA"?(W=Se.filter(M=>M.combinationCode===ce.combinationCode),De(M=>M.map(z=>z.combinationCode===ce.combinationCode?{...z,...h}:z))):(W=[ce],De(M=>M.map(z=>z.id===ce.id?{...z,...h}:z)));const Z=parseFloat(ce.invoiceTotalAmount)||0,L=W.map(M=>{var z,b;return M.senderName||((b=(z=M.campaignName)==null?void 0:z.split("--")[0])==null?void 0:b.trim())}).join(", "),se=`${ce.invoiceNo} - ${L}`;be(M=>[...M,{id:Date.now(),partyName:ce.partyName,date:ce.invoiceDate,particulars:"Promotional Trade Mailer",narration:se,debit:Z,credit:0,type:"invoice",invoiceNo:ce.invoiceNo,combinationCode:ce.combinationCode}])}const _=ua.trim()?` | Remarks: "${ua.trim()}"`:"";ns("approval",` Invoice ${ce.invoiceNo} has been APPROVED by Director${_} - ready for mailing`,"finance"),Bn(!1),ur(null),Fi({particularsApproved:!1,emailApproved:!1,invoiceTypeApproved:!1}),Vr(""),alert(` Invoice Approved!

The invoice is now ready for mailing.`)},No=()=>{if(!ce)return;const h=ua.trim();ce.isService?Ce(W=>W.map(Z=>Z.id===ce.id?{...Z,invoiceStatus:"Need Edits",editComments:h,approvalRemarks:""}:Z)):ce.invoiceType==="Combined"&&ce.combinationCode!=="NA"?De(W=>W.map(Z=>Z.combinationCode===ce.combinationCode?{...Z,invoiceStatus:"Need Edits",editComments:h,approvalRemarks:""}:Z)):De(W=>W.map(Z=>Z.id===ce.id?{...Z,invoiceStatus:"Need Edits",editComments:h,approvalRemarks:""}:Z));const _=h?`: "${h}"`:"";ns("edit",` Invoice ${ce.invoiceNo} marked as NEED EDITS by Director${_}`,"finance"),Bn(!1),ur(null),Vr("")},Hi=h=>{ur(h);const _=parseFloat(h.invoiceTotalAmount)||0;ts({amount:_.toFixed(2),tds:"",discount:"",narration:"",paymentAdvisory:null,date:new Date().toISOString().split("T")[0],mode:"Bank"}),Vs(!0)},Cc=()=>{if(!ce||!qt.amount){alert("Please enter receipt amount");return}if(ce.invoiceStatus!=="Approved"){alert("Receipt cannot be posted. Invoice must be approved first.");return}if(!ce.isHistorical&&ce.mailingSent!=="Yes"){alert("Receipt cannot be posted. Invoice must be mailed first.");return}const h=`RCP/${new Date().getFullYear()}-${String(new Date().getFullYear()+1).slice(-2)}/${Mt}`,_=parseFloat(qt.amount)||0,W=parseFloat(qt.tds)||0,Z=parseFloat(qt.discount)||0,L=_+W+Z,se=ue(ce),M=se.map(ae=>ae.subject||ae.senderName).join(", "),z=M.length>50?M.substring(0,47)+"...":M,b={id:Date.now(),receiptNo:h,invoiceNo:ce.invoiceNo,partyName:ce.partyName,date:qt.date,amount:_,tds:W,discount:Z,totalCredit:L,narration:qt.narration,paymentAdvisory:qt.paymentAdvisory,mode:qt.mode,campaigns:se.map(ae=>({senderName:ae.senderName,subject:ae.subject}))};Y(ae=>[...ae,b]);const U=qt.narration||z;_>0&&be(ae=>[...ae,{id:Date.now(),partyName:ce.partyName,date:qt.date,particulars:`Payment Received - ${U}`,narration:`${ce.invoiceNo} | ${qt.mode}`,debit:0,credit:_,type:"receipt",receiptNo:h,invoiceNo:ce.invoiceNo,paymentAdvisory:qt.paymentAdvisory}]),W>0&&be(ae=>[...ae,{id:Date.now()+1,partyName:ce.partyName,date:qt.date,particulars:"TDS Deducted",narration:`Against ${ce.invoiceNo}`,debit:0,credit:W,type:"tds",receiptNo:h,invoiceNo:ce.invoiceNo}]),Z>0&&be(ae=>[...ae,{id:Date.now()+2,partyName:ce.partyName,date:qt.date,particulars:"Discount Given",narration:`Against ${ce.invoiceNo}`,debit:0,credit:Z,type:"discount",receiptNo:h,invoiceNo:ce.invoiceNo}]);const oe=parseFloat(ce.invoiceTotalAmount)||0,fe=re.find(ae=>ae.invoiceNo===ce.invoiceNo),me=fe?Math.abs(parseFloat(fe.totalAmount)||0):0,le=oe-L-me<=0;ce.invoiceType==="Combined"&&ce.combinationCode!=="NA"?De(ae=>ae.map(te=>te.combinationCode===ce.combinationCode?{...te,receiptStatus:le?"Closed":"Received",receiptNo:h,receiptDate:qt.date}:te)):ce.isHistorical||De(ae=>ae.map(te=>te.id===ce.id?{...te,receiptStatus:le?"Closed":"Received",receiptNo:h,receiptDate:qt.date}:te)),St(ae=>ae+1),ns("receipt",` Payment received for ${ce.partyName} - Receipt ${h} - ${at(L)}`,"director"),Vs(!1),ur(null),ts({amount:"",tds:"",discount:"",narration:"",paymentAdvisory:null,date:new Date().toISOString().split("T")[0],mode:"Bank"}),alert(` Receipt Created!

Receipt No: ${h}
Amount: ${at(L)}`)},kc=h=>{ur(h),ha({amount:"",tds:"",discount:"",reason:"",date:new Date().toISOString().split("T")[0]}),la(!0)},ZF=()=>{var ae;if(!ce||!xn.amount&&!xn.gst||!xn.reason){alert("Please enter Amount and/or GST and reason");return}const h=ce.invoiceNo.match(/(\d{4}-\d{2})/),_=h?h[1]:`${new Date().getFullYear()}-${String(new Date().getFullYear()+1).slice(-2)}`,W=ce.invoiceNo.split("/").pop(),Z=`CN/${_}/${W}`,L=parseFloat(xn.amount)||0,se=parseFloat(xn.gst)||0,M=L+se,b=((ae=ce.statePartyDetails)==null?void 0:ae.toUpperCase().includes("MAHARASHTRA"))?"CGST/SGST":"IGST",U={id:Date.now(),creditNoteNo:Z,invoiceNo:ce.invoiceNo,partyName:ce.partyName,date:xn.date,amount:L,gst:se,gstType:b,totalAmount:M,reason:xn.reason};ne(te=>[...te,U]);const oe=parseFloat(ce.invoiceTotalAmount)||0,fe=Me.find(te=>te.invoiceNo===ce.invoiceNo),me=fe?parseFloat(fe.amount)+parseFloat(fe.tds||0)+parseFloat(fe.discount||0):0,qe=M>=oe-me;ce.isHistorical||De(te=>te.map(Ae=>Ae.invoiceNo===ce.invoiceNo?{...Ae,creditNoteNo:Z,receiptStatus:qe?"Cancelled":Ae.receiptStatus}:Ae)),wr(te=>te+1),la(!1),ur(null),ha({amount:"",gst:"",reason:"",date:new Date().toISOString().split("T")[0]});let le=` Credit Note Created!

Credit Note No: ${Z}`;L>0&&(le+=`
Base Amount: ${at(L)}`),se>0&&(le+=`
${b}: ${at(se)}`),le+=`
Total: ${at(M)}`,qe&&(le+=`

 Invoice fully covered by CN - marked as Cancelled`),alert(le)},e4=h=>{var Z;const _=(Z=h.target.files)==null?void 0:Z[0];if(!_)return;const W=new FileReader;W.onload=L=>{ts(se=>({...se,paymentAdvisory:L.target.result}))},W.readAsDataURL(_),h.target.value=""},hg=h=>{ur(h),_o(!0)},t4=()=>{if(!ce)return;const h=ce.invoiceNo;ce.invoiceType==="Combined"&&ce.combinationCode!=="NA"?De(Z=>Z.map(L=>L.combinationCode===ce.combinationCode?{...L,invoiceNo:"",invoiceDate:"",invoiceTotalAmount:"",invoiceGenerated:!1,invoiceStatus:"Pending",invoiceType:"Individual",combinationCode:"NA",mailingSent:"No",mailDate:"",editComments:"",receiptStatus:"",receiptNo:"",receiptDate:""}:L)):De(Z=>Z.map(L=>L.id===ce.id?{...L,invoiceNo:"",invoiceDate:"",invoiceTotalAmount:"",invoiceGenerated:!1,invoiceStatus:"Pending",invoiceType:"Individual",combinationCode:"NA",mailingSent:"No",mailDate:"",editComments:"",receiptStatus:"",receiptNo:"",receiptDate:""}:L)),be(Z=>Z.filter(L=>L.invoiceNo!==h));const _=Me.filter(Z=>Z.invoiceNo===h);_.length>0&&Y(Z=>Z.filter(L=>L.invoiceNo!==h)),_o(!1),ur(null);const W=_.length>0?`
${_.length} receipt(s) also deleted.`:"";alert(` Invoice ${h} deleted.${W}

You can now regenerate the invoice.`)},r4=h=>{confirm(`Delete Receipt ${h.receiptNo}?

This will also update the invoice status back to Pending.`)&&(Y(_=>_.filter(W=>W.id!==h.id)),De(_=>_.map(W=>W.invoiceNo===h.invoiceNo?{...W,receiptStatus:"",receiptNo:"",receiptDate:""}:W)),alert(` Receipt ${h.receiptNo} deleted.`))},n4=h=>{confirm(`Delete Credit Note ${h.creditNoteNo}?

This will remove the CN association from the invoice.`)&&(ne(_=>_.filter(W=>W.id!==h.id)),De(_=>_.map(W=>W.invoiceNo===h.invoiceNo?{...W,creditNoteNo:""}:W)),alert(` Credit Note ${h.creditNoteNo} deleted.`))},i4=h=>{confirm(`Delete historical entry?

Vch No: ${h.vchNo||"N/A"}
Amount: ${h.debit||h.credit}

This action cannot be undone.`)&&(be(_=>_.filter(W=>W.id!==h.id)),alert(" Historical entry deleted."))},s4=()=>{if(!X||!confirm(`Delete ALL historical entries for "${X}"?

This will remove all imported historical data for this party.`))return;const h=ie.filter(_=>$t(_.partyName,X)&&_.isHistorical).length;be(_=>_.filter(W=>!($t(W.partyName,X)&&W.isHistorical))),alert(` ${h} historical entries deleted for ${X}.`)},a4=h=>{da(h),za({date:new Date().toISOString().split("T")[0],notes:"",nextFollowupDate:"",status:"Pending"}),es(!0)},o4=()=>{var _,W;if(!dr)return;const h={id:Date.now(),invoiceNo:dr.invoiceNo,partyName:dr.partyName,invoiceDate:dr.invoiceDate||dr.date,invoiceAmount:dr.invoiceTotalAmount||dr.totalAmount,subject:((W=(_=dr.campaigns)==null?void 0:_[0])==null?void 0:W.subject)||dr.subject||"",followupDate:Fr.date,notes:Fr.notes,nextFollowupDate:Fr.nextFollowupDate,status:Fr.status};ki(Z=>[...Z,h]),es(!1),da(null),ns("followup",`Followup added for ${dr.invoiceNo}`,"all"),alert(` Followup recorded for ${dr.invoiceNo}`)},l4=h=>{confirm("Delete this followup entry?")&&ki(_=>_.filter(W=>W.id!==h))},c4=h=>{var z,b;const _=h.subject||((b=(z=h.campaigns)==null?void 0:z[0])==null?void 0:b.subject)||"",W=h.partyName,Z=h.invoiceNo,L=at(h.invoiceTotalAmount||h.totalAmount||0),se=At(h.invoiceDate||h.date);return`Subject: RE: ${_} - Payment Followup for Invoice ${Z}

Dear Sir/Madam,

Greetings from ${T.name}!

This is a gentle reminder regarding the outstanding payment for:

Invoice No: ${Z}
Invoice Date: ${se}
Amount: ${L}
Party: ${W}

We kindly request you to process the payment at the earliest. If the payment has already been made, please share the payment details for our records.

For any queries, please feel free to reach out.

Thanks & Regards,
Finance Team
${T.name}
Email: ${T.email}
Phone: ${T.phone}`},xy=h=>{const _=c4(h);navigator.clipboard.writeText(_),alert(" Followup email template copied to clipboard!")},vy=h=>{var Z,L;const _=h.subject||((L=(Z=h.campaigns)==null?void 0:Z[0])==null?void 0:L.subject)||"",W=encodeURIComponent(_);window.open(`https://mail.google.com/mail/u/0/#search/${W}`,"_blank")},u4=h=>{var Z;const _=(Z=h.target.files)==null?void 0:Z[0];if(!_)return;const W=new FileReader;W.onload=L=>{const se=Pl(L.target.result,{type:"binary"}),M=se.SheetNames[0],z=se.Sheets[M],b=kr.sheet_to_json(z),U={};b.forEach(oe=>{const fe=oe["Party Name"]||oe["PARTY NAME"]||oe.PartyName||"",me=parseFloat(oe.Amount||oe.AMOUNT||oe["Invoice Amount"]||0);fe&&me>0&&(U[fe.trim()]=me)}),Ec(oe=>({...oe,...U})),alert(` Loaded ${Object.keys(U).length} party invoice values!`)},W.readAsBinaryString(_),h.target.value=""},d4=()=>{const h=kr.json_to_sheet([{"Party Name":"ABC Group Private Limited",Amount:5500},{"Party Name":"XYZ Media Pvt Ltd",Amount:7500}]),_=kr.book_new();kr.book_append_sheet(_,h,"Invoice Values"),Dc(_,"Invoice_Values_Template.xlsx")},f4=h=>{var Z;const _=(Z=h.target.files)==null?void 0:Z[0];if(!_)return;const W=new FileReader;W.onload=L=>{const se=Pl(L.target.result,{type:"binary"}),M=se.SheetNames[0],z=se.Sheets[M],b=kr.sheet_to_json(z),U={...un};let oe=0;b.forEach(fe=>{const me=(fe["Name of Ledger"]||fe["Party Name"]||fe["NAME OF LEDGER"]||fe["PARTY NAME"]||"").trim(),qe=(fe["State Name"]||fe["STATE NAME"]||fe.State||fe.STATE||"").trim(),le=(fe.Address||fe.ADDRESS||fe["Party Address"]||fe["PARTY ADDRESS"]||"").trim(),ae=(fe["Client Code"]||fe["CLIENT CODE"]||fe.Code||fe.CODE||"").toString().trim();if(me){const te=qn(qe),Ae=ae||`${me.toUpperCase()}|${te}`;U[Ae]={clientCode:ae,partyName:me,partyNameUpper:me.toUpperCase(),ledgerGroup:fe["Ledger Group"]||fe["LEDGER GROUP"]||"Sundry Debtors",stateName:qe,normalizedState:te,gstRegType:fe["GST Registration Type"]||fe["GST REGISTRATION TYPE"]||"Regular",gstin:(fe["GSTIN/UIN"]||fe.GSTIN||fe.GST||"").trim(),address:le},oe++}}),Hs(U),alert(` Party Master Updated!

${oe} party-state combinations loaded.`)},W.readAsBinaryString(_),h.target.value=""},h4=()=>{const h=kr.json_to_sheet([{"Sl. No.":1,"Client Code":"1.01","Name of Ledger":"ABC PRIVATE LIMITED",Address:"123 Business Park, Andheri East","Ledger Group":"Sundry Debtors","State Name":"Maharashtra","GST Registration Type":"Regular","GSTIN/UIN":"27AAACA1234A1ZQ"},{"Sl. No.":2,"Client Code":"1.02","Name of Ledger":"ABC PRIVATE LIMITED",Address:"456 Tech Hub, Noida","Ledger Group":"Sundry Debtors","State Name":"Uttar Pradesh","GST Registration Type":"Regular","GSTIN/UIN":"09AAACA1234A1ZS"},{"Sl. No.":3,"Client Code":"2.01","Name of Ledger":"XYZ MEDIA PVT LTD",Address:"789 Media Tower, Connaught Place","Ledger Group":"Sundry Debtors","State Name":"Delhi","GST Registration Type":"Regular","GSTIN/UIN":"07AAACX5678B1ZR"}]),_=kr.book_new();kr.book_append_sheet(_,h,"Party Master"),Dc(_,"Party_Master_Template.xlsx")},p4=h=>{var Z;const _=(Z=h.target.files)==null?void 0:Z[0];if(!_)return;if(!X){alert(" Please select a party first from the list, then import their historical ledger."),h.target.value="";return}const W=new FileReader;W.onload=L=>{const se=Pl(L.target.result,{type:"binary",cellDates:!0}),M=se.SheetNames[0],z=se.Sheets[M],b=kr.sheet_to_json(z,{raw:!1}),U=[];let oe=0,fe=null;const me=le=>{if(!le)return 0;const ae=String(le).replace(/,/g,"").replace(/[^\d.-]/g,"");return parseFloat(ae)||0},qe=le=>{if(!le||typeof le!="string")return"";const ae=le.trim(),te=ae.split(/[-\/]/);if(te.length===3){const Ae={jan:"01",feb:"02",mar:"03",apr:"04",may:"05",jun:"06",jul:"07",aug:"08",sep:"09",oct:"10",nov:"11",dec:"12"},Qe=te[1].toLowerCase().substring(0,3);if(Ae[Qe]){const Je=te[0].padStart(2,"0");return`${te[2].length===2?parseInt(te[2])>50?"19"+te[2]:"20"+te[2]:te[2]}-${Ae[Qe]}-${Je}`}}return ae};b.forEach((le,ae)=>{const te=qe(le.Date||le.DATE||le.date||""),Ae=(le.Particular||le.PARTICULAR||le.Particulars||le.PARTICULARS||"").trim(),Qe=(le["Vch Type"]||le["VCH TYPE"]||le["Voucher Type"]||le["vch type"]||"").trim(),Je=(le["Vch No."]||le["VCH NO."]||le["Voucher No"]||le["Invoice No"]||le["Vch No"]||le["vch no."]||"").trim(),st=me(le.Debit||le.DEBIT||le.debit),mt=me(le.Credit||le.CREDIT||le.credit),lt=le["Date of Receipt"]||le["DATE OF RECEIPT"]||le["Receipt Date"]||"",zt=me(le["Amount Received"]||le["AMOUNT RECEIVED"]||le["amount received"]),Ue=me(le["TDS amount Received"]||le["TDS Received"]||le.TDS||le.tds),it=me(le.Balance||le.BALANCE||le.balance),Bt=(le["Payment Status"]||le["PAYMENT STATUS"]||le.Status||le.status||"").trim();if(!te&&(Ae.toUpperCase().includes("PROMOTIONAL")||Ae.toUpperCase().includes("IGST")||Ae.toUpperCase().includes("CGST")||Ae.toUpperCase().includes("SGST")||Ae.toUpperCase().includes("TRADE EMAILER"))&&fe)fe.subRows||(fe.subRows=[]),fe.subRows.push({particular:Ae,debit:st,credit:mt});else if(te&&(Je||st>0||mt>0)){fe&&(U.push(fe),oe++);let rt="invoice";Qe.toLowerCase().includes("credit note")||Je.toUpperCase().startsWith("CN")?rt="creditnote":Qe.toLowerCase().includes("receipt")?rt="receipt":(Qe.toLowerCase().includes("sale")||st>0)&&(rt="invoice"),fe={id:Date.now()+ae,partyName:X,date:te,particulars:Ae||X,narration:Je,vchType:Qe||"Sales",vchNo:Je,debit:st,credit:mt,receiptDate:lt,amountReceived:zt,tdsReceived:Ue,balance:it,paymentStatus:Bt,type:rt,isHistorical:!0,subRows:[]}}}),fe&&(U.push(fe),oe++),console.log("Parsed entries with sub-rows:",U),oe>0?(be(le=>[...le,...U]),alert(` Historical Ledger Uploaded!

${oe} entries added for "${X}".`)):alert(` No valid ledger entries found in the file.

Make sure your file has these columns:
 Date (e.g., 02-Jun-21)
 Vch Type (e.g., Sales, Credit Note)
 Vch No. (e.g., MB/2022-23/128)
 Debit or Credit amount`)},W.readAsBinaryString(_),h.target.value="",Sc(!1)},g4=()=>{const h=kr.json_to_sheet([{Date:"02-Jun-21",Particular:"ABC Corp Ltd.","Vch Type":"Sales","Vch No.":"MB/2020-21/0411",Debit:6e3,Credit:"","Date of Receipt":"","Amount Received":44371,"TDS amount Received":5880,Balance:"","Payment Status":"Received"},{Date:"",Particular:"PROMOTIONAL TRADE EMAILERS","Vch Type":"","Vch No.":"",Debit:"",Credit:22500,"Date of Receipt":"","Amount Received":"","TDS amount Received":"",Balance:"","Payment Status":""},{Date:"",Particular:"IGST","Vch Type":"","Vch No.":"",Debit:"",Credit:4050,"Date of Receipt":"","Amount Received":"","TDS amount Received":"",Balance:"","Payment Status":""},{Date:"26-Mar-25",Particular:"ABC Corp Ltd.","Vch Type":"Credit Note","Vch No.":"CN/2022-23/128",Debit:"",Credit:26550,"Date of Receipt":"","Amount Received":"","TDS amount Received":"",Balance:"","Payment Status":""}]),_=kr.book_new();kr.book_append_sheet(_,h,"Historical Ledger"),Dc(_,"Historical_Ledger_Template.xlsx")},m4=h=>{const _=Se.find(Z=>Z.invoiceNo===h);if(_){td(_);return}const W=ke.find(Z=>Z.invoiceNo===h);if(W){nd(W);return}alert("Invoice not found in system. This may be a historical entry.")},x4=h=>{Se.find(W=>W.invoiceNo===h.invoiceNo);let _=` RECEIPT DETAILS

`;_+=`Receipt No: ${h.receiptNo}
`,_+=`Date: ${At(h.date)}
`,_+=`Party: ${h.partyName}
`,_+=`Invoice: ${h.invoiceNo}

`,_+=`
`,_+=`Amount Received: ${at(h.amount||0)}
`,_+=`TDS: ${at(h.tds||0)}
`,_+=`Discount: ${at(h.discount||0)}
`,_+=`
`,_+=`Total: ${at((h.amount||0)+(h.tds||0)+(h.discount||0))}
`,h.remarks&&(_+=`
Remarks: ${h.remarks}`),alert(_)},v4=h=>{let _=` CREDIT NOTE DETAILS

`;_+=`Credit Note No: ${h.creditNoteNo}
`,_+=`Date: ${At(h.date)}
`,_+=`Party: ${h.partyName}
`,_+=`Against Invoice: ${h.invoiceNo}

`,_+=`
`,_+=`Base Amount: ${at(h.amount||0)}
`,_+=`${h.gstType||"GST"}: ${at(h.gst||0)}
`,_+=`
`,_+=`Total Credit: ${at(h.totalAmount||(h.amount||0)+(h.gst||0))}
`,h.reason&&(_+=`
Reason: ${h.reason}`),alert(_)},y4=h=>{var Z;const _=(Z=h.target.files)==null?void 0:Z[0];if(!_)return;const W=new FileReader;W.onload=L=>{const se=Pl(L.target.result,{type:"binary",cellDates:!0}),M=se.SheetNames[0],z=se.Sheets[M],b=kr.sheet_to_json(z,{raw:!1}),U=new Set(Fn.map(le=>`${le.date}|${le.time||""}|${le.campaignName||""}|${le.subject}`.toLowerCase()));let oe=0,fe=0;const me=b.map((le,ae)=>{const te=le["CAMPAIGN NAME"]||le["Campaign Name"]||"",Ae=NH(te);let Qe=le.DATE||le.Date||new Date;typeof Qe=="string"&&(Qe=new Date(Qe));const Je=(le["PARTY NAME"]||le["Party Name"]||"").trim(),st=le["SENDER NAME"]||le["Sender Name"]||"",mt=le.SUBJECT||le.Subject||"",lt=le.TIME||le.Time||"",zt=le["State/Party Details"]||le["STATE/PARTY DETAILS"]||le.STATE||le.State||"",Ue=Wi[Je]||"",it=Qe instanceof Date&&!isNaN(Qe)?Qe.toISOString().split("T")[0]:"",Gt=(le["Client Code"]||le["CLIENT CODE"]||le.Code||"").toString().trim()||zr(Je,zt),rt=le["PO?"]||le.PO||le["WITH PO"]||"",K=rt.toLowerCase().includes("with po")||rt.toLowerCase()==="yes",Ve=le["PO Number"]||le["PO NUMBER"]||le["PO No"]||le["PO NO"]||"";let Ze=le["PO Date"]||le["PO DATE"]||"";typeof Ze=="object"&&Ze instanceof Date&&(Ze=Ze.toISOString().split("T")[0]);const Ut=`${it}|${lt}|${te}|${mt}`.toLowerCase();return U.has(Ut)?(oe++,null):(U.add(Ut),fe++,{id:Date.now()+ae+Math.random(),sno:le.SNO||le["SNO."]||le.Sno||ae+1,date:it,month:le.Month||le.MONTH||"",time:lt,statePartyDetails:zt,partyName:Je,clientCode:Gt,senderName:st,campaignName:te,subject:mt,emailId:Ae,additionalEmails:[],toBeBilled:"Not Yet",invoiceAmount:Ue,cgst:"",sgst:"",igst:"",totalWithGst:"",invoiceType:"Individual",combinationCode:"NA",invoiceNo:"",invoiceDate:"",invoiceTotalAmount:"",invoiceGenerated:!1,invoiceStatus:"Pending",mailingSent:"No",mailerUploaded:!1,editComments:"",poStatus:K?"With PO":"Without PO",poNumber:K?Ve:"",poDate:K?Ze:""})}).filter(le=>le!==null);if(me.length>0){De(ae=>[...ae,...me]);const le=[...new Set(me.map(ae=>ae.partyName))];Ss(ae=>{const te=new Set(ae);return le.forEach(Ae=>te.add(Ae)),te})}let qe=` Upload Complete!

`;qe+=` ${fe} new campaigns added
`,oe>0&&(qe+=` ${oe} duplicate entries skipped`),fe>0&&ns("upload",` ${fe} new campaigns uploaded to Master Sheet`,"director"),alert(qe)},W.readAsBinaryString(_),h.target.value=""},_4=async()=>{De([]),Ce([]),be([]),Y([]),ne([]),pa({}),_c({}),ee(1),wt(1),St(1),wr(1),Cn(1),_e(null),Le(null),Ie(null),Ss(new Set),ki([]),Hs({}),ut([]);try{await vd("indreesh-media",{masterData:[],servicesData:[],ledgerEntries:[],receipts:[],creditNotes:[],openingBalances:{},mailerImages:{},mailerLogo:Kn,companyConfig:T,nextInvoiceNo:1,nextCombineNo:1,nextReceiptNo:1,nextCreditNoteNo:1,nextServiceInvoiceNo:1,invoiceValues:Wi,notifications:[],whatsappSettings:bt,partyMaster:{},followups:[],userPasswords:y}),console.log("Data cleared and saved to Firebase")}catch(h){console.error("Error clearing data:",h)}zs(!1),alert(" All master data, invoices, receipts, and ledger entries have been cleared!")},yy=h=>{var Z;const _=parseFloat(h.invoiceAmount)||0;if((Z=h.statePartyDetails)==null?void 0:Z.toUpperCase().includes("MAHARASHTRA")){const L=_*.09,se=_*.09;return{cgst:L,sgst:se,igst:0,total:_+L+se}}else{const L=_*.18;return{cgst:0,sgst:0,igst:L,total:_+L}}},E4=(h,_)=>{const W=Se.find(Z=>Z.id===h);De(Z=>Z.map(L=>{if(L.id===h){if(_==="Yes"&&L.invoiceAmount){const se=yy(L);return{...L,toBeBilled:_,cgst:se.cgst.toFixed(2),sgst:se.sgst.toFixed(2),igst:se.igst.toFixed(2),totalWithGst:se.total.toFixed(2)}}return{...L,toBeBilled:_}}return L})),_==="Yes"&&W&&ns("info",` Campaign marked for billing: ${W.partyName} - ${W.senderName}`,"finance")},g0=(h,_,W)=>{De(Z=>Z.map(L=>{if(L.id===h){const se={...L,[_]:W};if(_==="invoiceAmount"&&L.toBeBilled==="Yes"){const M=yy(se);return{...se,cgst:M.cgst.toFixed(2),sgst:M.sgst.toFixed(2),igst:M.igst.toFixed(2),totalWithGst:M.total.toFixed(2)}}return se}return L}))},S4=h=>{const _=`${T.invoicePrefix}${ot}`,W=new Date().toISOString().split("T")[0],Z=parseFloat(h.totalWithGst)||parseFloat(h.invoiceAmount)*1.18;De(L=>L.map(se=>se.id===h.id?{...se,invoiceNo:_,invoiceDate:W,invoiceTotalAmount:Z.toFixed(2),invoiceGenerated:!0,invoiceStatus:"Created",invoiceType:"Individual",combinationCode:"NA"}:se)),ee(L=>L+1),ns("invoice",` New Invoice ${_} created for ${h.partyName} - ${at(Z)}`,"director"),alert(` Invoice Generated!

Invoice No: ${_}
Amount: ${at(Z)}

Please review and Approve or mark as Need Edits.`)},w4=()=>{if(zi.size<2){alert("Please select at least 2 campaigns to combine");return}const h=`${T.invoicePrefix}${ot}`,_=new Date().toISOString().split("T")[0],W=String(Ot);let Z=0;const L=Se.filter(se=>zi.has(se.id));L.forEach(se=>{Z+=parseFloat(se.totalWithGst)||parseFloat(se.invoiceAmount)*1.18}),De(se=>se.map(M=>zi.has(M.id)?{...M,invoiceNo:h,invoiceDate:_,invoiceTotalAmount:Z.toFixed(2),invoiceGenerated:!0,invoiceStatus:"Created",invoiceType:"Combined",combinationCode:W,mailingSent:"No"}:M)),ee(se=>se+1),wt(se=>se+1),yt(!1),wo(new Set),ns("invoice",` Combined Invoice ${h} created for ${Vi} (${L.length} campaigns) - ${at(Z)}`,"director"),So(null),alert(` Combined Invoice Generated!

Invoice No: ${h}
Campaigns: ${zi.size}
Total: ${at(Z)}

Please review and Approve or mark as Need Edits.`)},T4=h=>{wo(_=>{const W=new Set(_);return W.has(h)?W.delete(h):W.add(h),W})},A4=h=>{So(h.partyName),wo(new Set([h.id])),yt(!0)},C4=h=>{var Z;const _=(Z=h.target.files)==null?void 0:Z[0];if(!_||!ce)return;const W=new FileReader;W.onload=L=>_y(L.target.result),W.readAsDataURL(_),h.target.value=""},_y=h=>{if(!ce)return;const _=ce.id;pa(Ku?W=>({...W,[_]:[h]}):W=>({...W,[_]:[...W[_]||[],h]})),De(W=>W.map(Z=>Z.id===ce.id?{...Z,mailerUploaded:!0}:Z)),Ws(null),Ao(!1),ji(!1),alert(" Mailer image saved!")},k4=h=>{var W;const _=(W=h.clipboardData)==null?void 0:W.items;if(_){for(let Z=0;Z<_.length;Z++)if(_[Z].type.indexOf("image")!==-1){const L=_[Z].getAsFile(),se=new FileReader;se.onload=M=>Ws(M.target.result),se.readAsDataURL(L),h.preventDefault();break}}},F4=h=>{const _=encodeURIComponent(h||"campaign");window.open(`https://mail.google.com/mail/u/0/#search/${_}`,"_blank")},b4=h=>{var Z;const _=(Z=h.target.files)==null?void 0:Z[0];if(!_)return;const W=new FileReader;W.onload=L=>ga(L.target.result),W.readAsDataURL(_),h.target.value=""},Ey=h=>{if(h.serviceType||h.isService)return`Invoice ${h.invoiceNo||""} - ${(h.serviceType||"SERVICE").toUpperCase()}`;const _=ue(h);if(_.length>1){const W=_.map(Z=>Z.senderName).join(", ");return`Invoice ${h.invoiceNo||""} - ${W}`}return`Invoice ${h.invoiceNo||""} - ${h.senderName} - ${h.subject}`},m0=h=>{const _=parseFloat(h.invoiceTotalAmount)||parseFloat(h.totalWithGst)||parseFloat(h.invoiceAmount)*1.18;let W="";if(h.serviceType||h.isService)W=`Type of Service: ${(h.serviceType||"SERVICE").toUpperCase()}`;else{const Z=ue(h);Z.length>1?(W=`Campaigns included in this invoice:
`,Z.forEach((L,se)=>{W+=`${se+1}. ${L.senderName} - ${L.subject}
`})):W=`Campaign: ${h.senderName}
Subject: ${h.subject}`}return`Dear Sir/Madam,

Please find attached the invoice for the following:

${W}

Invoice No: ${h.invoiceNo||"To be generated"}
Invoice Amount: ${at(_)}

Kindly process the payment at your earliest convenience.

Bank Details:
Bank: ${T.bank.name}
A/C No: ${T.bank.account}
IFSC: ${T.bank.ifsc}
Branch: ${T.bank.branch}

Thank you for your business.

Best Regards,
${T.name}
${T.email}`},[I4,Sy]=ye.useState(!1),[wy,Ty]=ye.useState(""),Ay=h=>{var ae;const _=h.serviceType||h.isService;let W=[h],Z=parseFloat(h.invoiceAmount)||0;!_&&h.invoiceType==="Combined"&&h.combinationCode!=="NA"&&(W=Se.filter(te=>te.combinationCode===h.combinationCode),Z=W.reduce((te,Ae)=>te+(parseFloat(Ae.invoiceAmount)||0),0));const L=Fo(h.partyName,h.statePartyDetails),se=Qu(h.partyName,h.statePartyDetails),M=(ae=h.statePartyDetails)==null?void 0:ae.toUpperCase().includes("MAHARASHTRA"),z=M?Z*.09:0,b=M?Z*.09:0,U=M?0:Z*.18,oe=z+b+U,fe=Z+oe;let me;_?me=`
        <tr>
          <td style="border: 1px solid #000; padding: 8px; text-align: center; font-size: 12px;">1</td>
          <td style="border: 1px solid #000; padding: 8px; font-size: 12px;">
            <div style="font-weight: 600;">${(h.serviceType||"SERVICE").toUpperCase()}</div>
            <div style="font-style: italic; color: #555; font-size: 11px; margin-top: 2px;">Date: ${At(h.date)}</div>
          </td>
          <td style="border: 1px solid #000; padding: 8px; text-align: center; font-size: 12px;">${T.hsnCode}</td>
          <td style="border: 1px solid #000; padding: 8px; text-align: right; font-size: 12px;">${tr(Z)}</td>
        </tr>
      `:me=W.map((te,Ae)=>`
        <tr>
          <td style="border: 1px solid #000; padding: 8px; text-align: center; font-size: 12px;">${Ae+1}</td>
          <td style="border: 1px solid #000; padding: 8px; font-size: 12px;">
            <div style="font-weight: 600;">PROMOTIONAL TRADE EMAILER</div>
            <div style="font-style: italic; color: #555; font-size: 11px; margin-top: 2px;">${te.senderName||""} - ${At(te.date)}</div>
            <div style="font-style: italic; color: #555; font-size: 11px;">Subject: ${te.subject||""}</div>
          </td>
          <td style="border: 1px solid #000; padding: 8px; text-align: center; font-size: 12px;">${T.hsnCode}</td>
          <td style="border: 1px solid #000; padding: 8px; text-align: right; font-size: 12px;">${tr(parseFloat(te.invoiceAmount)||0)}</td>
        </tr>
      `).join("");let qe=[];_||(h.invoiceType==="Combined"&&h.combinationCode!=="NA"?W.forEach(te=>{(It[te.id]||[]).forEach(Qe=>qe.push({img:Qe,campaign:te}))}):(It[h.id]||[]).forEach(Ae=>qe.push({img:Ae,campaign:h})));const le=qe.map(({img:te,campaign:Ae})=>`
      <div class="page-break-before" style="page-break-before: always; padding: 40px; text-align: center; background: white;">
        ${Kn?`<div style="margin-bottom: 20px;"><img src="${Kn}" alt="Logo" style="max-height: 70px;" /></div>`:`
          <div style="text-align: center; margin-bottom: 25px;">
            <span style="font-size: 22px; font-weight: bold; color: #2874A6;">${T.name}</span>
          </div>
        `}
        <h2 style="font-size: 20px; text-decoration: underline; margin: 25px 0;">MAILER SUPPORTING</h2>
        <p style="font-size: 15px; margin: 12px 0; text-align: left;"><strong>MAILER DATE:</strong> ${IH(Ae.date)}</p>
        <p style="font-size: 15px; margin: 12px 0; text-align: left;"><strong>CAMPAIGN:</strong> ${Ae.senderName}</p>
        <p style="font-size: 15px; margin: 12px 0; text-align: left;"><strong>SUBJECT:</strong> ${Ae.subject||"Campaign"}</p>
        <div style="margin-top: 25px;"><img src="${te}" alt="Mailer" style="max-width: 100%; max-height: 550px; border: 1px solid #ddd;" /></div>
      </div>
    `).join("");return`
  <div style="max-width: 900px; margin: 0 auto; padding: 15px; background: white; font-family: Arial, sans-serif; font-size: 12px; line-height: 1.4;">
    <style>
      @media print {
        @page { size: A4; margin: 8mm; }
        body { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
        .page-break-before { page-break-before: always; }
      }
    </style>
    <div style="border: 2px solid #000; background: white;">
      <div style="text-align: center; padding: 12px; font-size: 18px; font-weight: bold; border-bottom: 2px solid #000; background: #f8f8f8;">Tax Invoice</div>
      <div style="text-align: center; font-size: 11px; font-style: italic; padding: 5px; border-bottom: 1px solid #000; background: #fafafa;">(Original for Recipient)</div>
      <div style="display: flex; border-bottom: 2px solid #000;">
        <div style="flex: 1.5; padding: 12px; border-right: 2px solid #000;">
          <div style="font-size: 16px; font-weight: bold; margin-bottom: 8px; color: #1a5276;">${T.name}</div>
          <div style="font-size: 11px; line-height: 1.5; color: #333;">${T.address}<br>${T.addressLine2}<br>${T.city}<br><strong>GSTIN/UIN:</strong> ${T.gstin}<br><strong>State:</strong> ${T.stateName}, Code: ${T.stateCode}<br><strong>Contact:</strong> ${T.phone}<br><strong>E-Mail:</strong> ${T.email}</div>
        </div>
        <div style="flex: 1; font-size: 12px;">
          <div style="display: flex; border-bottom: 1px solid #000;"><div style="flex: 1; padding: 8px; border-right: 1px solid #000; font-weight: bold; background: #f5f5f5;">Invoice No.</div><div style="flex: 1; padding: 8px; font-weight: 600; color: #1a5276;">${h.invoiceNo||""}</div></div>
          <div style="display: flex;"><div style="flex: 1; padding: 8px; border-right: 1px solid #000; font-weight: bold; background: #f5f5f5;">Dated</div><div style="flex: 1; padding: 8px;">${At(h.invoiceDate||h.date)}</div></div>
        </div>
      </div>
      <div style="padding: 10px 12px; border-bottom: 2px solid #000; background: #fafafa;">
        <div style="font-size: 11px; color: #666; margin-bottom: 3px;">Buyer (Bill to)</div>
        <div style="font-size: 14px; font-weight: bold; margin-bottom: 4px; color: #1a5276;">${h.partyName}</div>
        <div style="font-size: 11px; color: #333;">${se?se+"<br>":""}${h.statePartyDetails||""}${L?"<br><strong>GSTIN/UIN:</strong> "+L:""}<br>Place of Supply: ${h.statePartyDetails||T.stateName}</div>
      </div>
      <table style="width: 100%; border-collapse: collapse;">
        <thead><tr style="background: #e8e8e8;"><th style="border: 1px solid #000; padding: 10px; width: 45px; font-size: 12px;">Sl No.</th><th style="border: 1px solid #000; padding: 10px; font-size: 12px;">Particulars</th><th style="border: 1px solid #000; padding: 10px; width: 80px; font-size: 12px;">HSN/SAC</th><th style="border: 1px solid #000; padding: 10px; width: 100px; text-align: right; font-size: 12px;">Amount</th></tr></thead>
        <tbody>
          ${me}
          ${W.length>1?'<tr style="background: #f5f5f5;"><td colspan="3" style="border: 1px solid #000; padding: 10px; text-align: right; font-weight: bold; font-size: 13px;">Sub Total</td><td style="border: 1px solid #000; padding: 10px; text-align: right; font-weight: bold; font-size: 13px;">'+tr(Z)+"</td></tr>":""}
          ${M?`<tr><td colspan="3" style="border: 1px solid #000; padding: 8px; text-align: right; font-weight: 600; font-size: 12px;">CGST @ 9%</td><td style="border: 1px solid #000; padding: 8px; text-align: right; font-size: 12px;">${tr(z)}</td></tr><tr><td colspan="3" style="border: 1px solid #000; padding: 8px; text-align: right; font-weight: 600; font-size: 12px;">SGST @ 9%</td><td style="border: 1px solid #000; padding: 8px; text-align: right; font-size: 12px;">${tr(b)}</td></tr>`:`<tr><td colspan="3" style="border: 1px solid #000; padding: 8px; text-align: right; font-weight: 600; font-size: 12px;">IGST @ 18%</td><td style="border: 1px solid #000; padding: 8px; text-align: right; font-size: 12px;">${tr(U)}</td></tr>`}
          <tr style="background: #2874A6; color: white;"><td colspan="3" style="border: 1px solid #000; padding: 12px; text-align: right; font-weight: bold; font-size: 14px;">Total</td><td style="border: 1px solid #000; padding: 12px; text-align: right; font-weight: bold; font-size: 14px;"> ${fe.toLocaleString("en-IN",{minimumFractionDigits:2})}</td></tr>
        </tbody>
      </table>
      <div style="padding: 10px 12px; border: 1px solid #000; border-top: none; background: #fafafa;"><div style="color: #666; font-size: 11px; margin-bottom: 3px;">Amount Chargeable (in words)</div><div style="font-weight: bold; font-size: 13px;">${xm(fe)}</div></div>
      <div style="display: flex; border-top: 2px solid #000;">
        <div style="flex: 1; padding: 10px 12px; border-right: 2px solid #000; font-size: 11px;"><div><strong>Company's PAN:</strong> ${T.pan}</div><div style="margin-top: 4px;"><strong>MSME Reg. No.:</strong> UDYAM-MH-19-0057219</div></div>
        <div style="flex: 1.2; padding: 10px 12px; font-size: 11px;">
          <div style="font-weight: bold; margin-bottom: 6px; color: #1a5276;">Company's Bank Details</div>
          <div style="line-height: 1.5;"><strong>A/c Holder:</strong> ${T.bank.holder}<br><strong>Bank:</strong> ${T.bank.name}<br><strong>A/c No.:</strong> ${T.bank.account}<br><strong>IFSC:</strong> ${T.bank.ifsc}</div>
          <div style="text-align: right; margin-top: 30px;"><div style="font-weight: bold;">for ${T.name}</div><div style="margin-top: 25px; border-top: 1px solid #000; display: inline-block; padding-top: 4px; font-size: 10px;">Authorised Signatory</div></div>
        </div>
      </div>
      <div style="text-align: center; padding: 8px; background: #f0f0f0; border-top: 1px solid #000; font-size: 10px; color: #666; font-style: italic;">This is a Computer Generated Invoice</div>
    </div>
  </div>
  ${le}
`},Cy=h=>{const _=Ay(h);Ty(_),ur(h),Sy(!0)},N4=h=>{const _=`<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Invoice ${h.invoiceNo||""}</title>
  <style>
    @page { size: A4; margin: 10mm; }
    @media print { body { -webkit-print-color-adjust: exact; print-color-adjust: exact; } }
    body { font-family: Arial, sans-serif; margin: 0; padding: 20px; }
  </style>
</head>
<body>
${Ay(h)}
<script>
  // Auto-open print dialog when file is opened
  window.onload = function() { 
    setTimeout(function() { window.print(); }, 500); 
  };
<\/script>
</body>
</html>`,W=new Blob([_],{type:"text/html"}),Z=URL.createObjectURL(W),L=document.createElement("a");L.href=Z,L.download=`Invoice_${(h.invoiceNo||"draft").replace(/\//g,"-")}.html`,document.body.appendChild(L),L.click(),document.body.removeChild(L),URL.revokeObjectURL(Z)},td=h=>{Cy(h)},R4=()=>{const h=parseFloat(Ar.amount)||0,_=parseFloat(Ar.tds)||0,W=parseFloat(Ar.discount)||0,Z=h+_+W;let L=parseFloat(ce.invoiceTotalAmount)||parseFloat(ce.totalWithGst)||parseFloat(ce.invoiceAmount)*1.18;const se=Z>=L?"Paid":"Partially Paid";ce.invoiceType==="Combined"&&ce.combinationCode!=="NA"?De(z=>z.map(b=>b.combinationCode===ce.combinationCode?{...b,invoiceStatus:se}:b)):De(z=>z.map(b=>b.id===ce.id?{...b,invoiceStatus:se}:b));const M=[];h>0&&M.push({id:Date.now(),partyName:ce.partyName,date:Ar.date,particulars:Ar.narration?`Payment Received - ${Ar.mode} (${Ar.narration})`:`Payment Received - ${Ar.mode}`,debit:0,credit:h,type:"payment"}),_>0&&M.push({id:Date.now()+1,partyName:ce.partyName,date:Ar.date,particulars:`TDS Deducted - Inv: ${ce.invoiceNo}`,debit:0,credit:_,type:"tds"}),W>0&&M.push({id:Date.now()+2,partyName:ce.partyName,date:Ar.date,particulars:`Discount Allowed - Inv: ${ce.invoiceNo}`,debit:0,credit:W,type:"discount"}),be(z=>[...z,...M]),gr(!1),ur(null)},ky=h=>{Ss(_=>{const W=new Set(_);return W.has(h)?W.delete(h):W.add(h),W})},D4=()=>{const W=r==="director"?[{id:"master",icon:aE,label:"Master Sheet"},{id:"services",icon:im,label:"Services Sheet"},{id:"invoices",icon:pd,label:"Invoice Register"},{id:"receipts",icon:Oo,label:"Receipt Register"},{id:"ledgers",icon:eE,label:"Party Ledgers"},{id:"followups",icon:q0,label:"Followups"},{id:"reports",icon:J_,label:"Reports"}]:[{id:"master",icon:aE,label:"Master Sheet"},{id:"services",icon:im,label:"Services Sheet"},{id:"invoices",icon:pd,label:"Invoice Register"},{id:"receipts",icon:Oo,label:"Receipt Register"},{id:"ledgers",icon:eE,label:"Party Ledgers"},{id:"followups",icon:q0,label:"Followups"},{id:"reports",icon:J_,label:"Reports"},{id:"settings",icon:WL,label:"Settings"}];return c.jsxs("div",{style:{width:R?"60px":"220px",backgroundColor:"#1E293B",color:"#FFFFFF",display:"flex",flexDirection:"column",transition:"width 0.2s ease",flexShrink:0},children:[c.jsxs("div",{style:{padding:R?"12px":"16px",borderBottom:"1px solid #334155",display:"flex",alignItems:"center",justifyContent:R?"center":"space-between"},children:[!R&&c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[c.jsx("img",{src:"/logo.png",alt:"JAC",style:{width:"32px",height:"auto",borderRadius:"4px",backgroundColor:"white",padding:"2px"}}),c.jsxs("div",{children:[c.jsx("div",{style:{fontSize:"16px",fontWeight:"700"},children:"FinMate"}),c.jsx("div",{style:{fontSize:"10px",color:"#94A3B8"},children:r==="director"?"Director View":"Finance Team"})]})]}),c.jsx("button",{onClick:()=>Xe(!R),style:{background:"none",border:"none",color:"#94A3B8",cursor:"pointer",padding:"4px"},children:R?c.jsx(K0,{size:18}):c.jsx(ML,{size:18})})]}),!R&&c.jsx("div",{style:{padding:"8px 16px",borderBottom:"1px solid #334155",fontSize:"11px"},children:f?c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",color:"#FCD34D"},children:[c.jsx(nE,{size:12,style:{animation:"spin 1s linear infinite"}}),c.jsx("span",{children:"Saving..."})]}):g?c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",color:"#86EFAC"},children:[c.jsx(rE,{size:12}),c.jsxs("span",{children:["Saved ",g.toLocaleTimeString()]})]}):c.jsx("div",{style:{color:"#94A3B8"},children:"Cloud Sync Active"})}),c.jsx("div",{style:{padding:"8px",borderBottom:"1px solid #334155"},children:c.jsxs("button",{onClick:()=>sr(!0),style:{width:"100%",display:"flex",alignItems:"center",gap:"10px",padding:R?"12px":"11px 14px",borderRadius:"8px",border:"none",backgroundColor:Ts>0?"#FEF3C7":"#334155",color:Ts>0?"#92400E":"#94A3B8",cursor:"pointer",fontSize:"14px",fontWeight:Ts>0?"700":"500",justifyContent:R?"center":"flex-start",position:"relative"},title:"Notifications",children:[Ts>0?c.jsx(PL,{size:18}):c.jsx(Z_,{size:18}),!R&&c.jsx("span",{children:"Notifications"}),Ts>0&&c.jsx("span",{style:{position:R?"absolute":"static",top:R?"4px":"auto",right:R?"4px":"auto",marginLeft:R?"0":"auto",backgroundColor:"#DC2626",color:"#FFFFFF",padding:"2px 6px",borderRadius:"10px",fontSize:"11px",fontWeight:"700",minWidth:"18px",textAlign:"center"},children:Ts})]})}),c.jsx("nav",{style:{flex:1,padding:"8px"},children:W.map(Z=>c.jsxs("button",{onClick:()=>P(Z.id),style:{width:"100%",display:"flex",alignItems:"center",gap:"10px",padding:R?"12px":"11px 14px",marginBottom:"4px",borderRadius:"8px",border:"none",backgroundColor:D===Z.id?"#2874A6":"transparent",color:D===Z.id?"#FFFFFF":"#94A3B8",cursor:"pointer",fontSize:"14px",fontWeight:D===Z.id?"600":"500",justifyContent:R?"center":"flex-start"},title:Z.label,children:[c.jsx(Z.icon,{size:18}),!R&&c.jsx("span",{children:Z.label})]},Z.id))}),c.jsxs("div",{style:{padding:"8px",borderTop:"1px solid #334155"},children:[c.jsxs("button",{onClick:()=>{E(!0),Q({currentPassword:"",newPassword:"",confirmPassword:""}),w("")},style:{width:"100%",display:"flex",alignItems:"center",gap:"10px",padding:R?"12px":"11px 14px",marginBottom:"8px",borderRadius:"8px",border:"none",backgroundColor:"#475569",color:"#FFFFFF",cursor:"pointer",fontSize:"14px",fontWeight:"500",justifyContent:R?"center":"flex-start"},title:"Change Password",children:[c.jsx(Y0,{size:18}),!R&&c.jsx("span",{children:"Change Password"})]}),c.jsxs("button",{onClick:bi,style:{width:"100%",display:"flex",alignItems:"center",gap:"10px",padding:R?"12px":"11px 14px",borderRadius:"8px",border:"none",backgroundColor:"#DC2626",color:"#FFFFFF",cursor:"pointer",fontSize:"14px",fontWeight:"600",justifyContent:R?"center":"flex-start"},title:"Logout",children:[c.jsx(Ta,{size:18}),!R&&c.jsx("span",{children:"Logout"})]}),!R&&c.jsx("div",{style:{textAlign:"center",fontSize:"10px",color:"#64748B",marginTop:"8px"},children:"v38-fix19"})]})]})},P4=()=>c.jsx("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"10px",border:"1px solid #E2E8F0",padding:"14px 18px",marginBottom:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"14px",flexWrap:"wrap"},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[c.jsx(gd,{size:18,color:"#64748B"}),c.jsx("span",{style:{fontSize:"13px",fontWeight:"700",color:"#475569"},children:"Filters:"})]}),c.jsxs("div",{style:{position:"relative"},children:[c.jsx(Q0,{size:15,style:{position:"absolute",left:"10px",top:"50%",transform:"translateY(-50%)",color:"#94A3B8"}}),c.jsx("input",{type:"text",placeholder:"Search...",value:Tt.searchText,onChange:h=>Cl(_=>({..._,searchText:h.target.value})),style:{padding:"8px 12px 8px 32px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",width:"160px"}})]}),c.jsxs("select",{value:Tt.party,onChange:h=>Cl(_=>({..._,party:h.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:Tt.party?"#EFF6FF":"#FFFFFF"},children:[c.jsx("option",{value:"",children:"All Parties"}),Gs.map(h=>c.jsx("option",{value:h,children:h},h))]}),c.jsxs("select",{value:Tt.billStatus,onChange:h=>Cl(_=>({..._,billStatus:h.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:Tt.billStatus?"#EFF6FF":"#FFFFFF"},children:[c.jsx("option",{value:"",children:"Bill Status"}),c.jsx("option",{value:"Yes",children:"Yes"}),c.jsx("option",{value:"Not Yet",children:"Not Yet"})]}),c.jsxs("select",{value:Tt.invoiceStatus,onChange:h=>Cl(_=>({..._,invoiceStatus:h.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:Tt.invoiceStatus?"#EFF6FF":"#FFFFFF"},children:[c.jsx("option",{value:"",children:"Invoice Status"}),c.jsx("option",{value:"Generated",children:"Generated"}),c.jsx("option",{value:"Not Generated",children:"Not Generated"}),c.jsx("option",{value:"Paid",children:"Paid"})]}),He&&c.jsxs(c.Fragment,{children:[c.jsxs("button",{onClick:xe,style:{padding:"8px 12px",fontSize:"13px",fontWeight:"600",border:"1.5px solid #FCA5A5",borderRadius:"8px",backgroundColor:"#FEE2E2",color:"#991B1B",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},children:[c.jsx(Ta,{size:14})," Clear"]}),c.jsxs("span",{style:{fontSize:"13px",color:"#64748B"},children:["Showing ",v.length," of ",Se.length]})]})]})}),Fy=()=>{const h=Se.filter(M=>M.toBeBilled==="Yes"&&M.invoiceGenerated&&M.mailingSent==="Yes"&&(M.receiptStatus==="Received"||M.receiptStatus==="Cancelled"||M.receiptStatus==="Closed")),_=Se.filter(M=>!(M.toBeBilled==="Yes"&&M.invoiceGenerated&&M.mailingSent==="Yes"&&(M.receiptStatus==="Received"||M.receiptStatus==="Cancelled"||M.receiptStatus==="Closed"))),W=Ci==="open"?_:h,Z=W.filter(M=>{var z,b,U,oe,fe;if(Tt.party&&M.partyName!==Tt.party||Tt.billStatus&&M.toBeBilled!==Tt.billStatus||Tt.invoiceType&&M.invoiceType!==Tt.invoiceType||Tt.mailingStatus&&(Tt.mailingStatus==="Sent"&&M.mailingSent!=="Yes"||Tt.mailingStatus==="Not Sent"&&M.mailingSent==="Yes")||Tt.invoiceStatus&&(Tt.invoiceStatus==="Generated"&&!M.invoiceGenerated||Tt.invoiceStatus==="Not Generated"&&M.invoiceGenerated||Tt.invoiceStatus==="Approved"&&M.invoiceStatus!=="Approved"||Tt.invoiceStatus==="Need Edits"&&M.invoiceStatus!=="Need Edits"||Tt.invoiceStatus==="Paid"&&M.invoiceStatus!=="Paid"))return!1;if(Tt.searchText){const me=Tt.searchText.toLowerCase();if(!((z=M.partyName)!=null&&z.toLowerCase().includes(me))&&!((b=M.senderName)!=null&&b.toLowerCase().includes(me))&&!((U=M.campaignName)!=null&&U.toLowerCase().includes(me))&&!((oe=M.subject)!=null&&oe.toLowerCase().includes(me))&&!((fe=M.invoiceNo)!=null&&fe.toLowerCase().includes(me)))return!1}return!0}),L=Z.reduce((M,z)=>{const b=z.clientCode||zr(z.partyName,z.statePartyDetails)||"",U=`${z.partyName||"Unknown"}|||${b}`;return M[U]||(M[U]={partyName:z.partyName||"Unknown",clientCode:b,rows:[]}),M[U].rows.push(z),M},{}),se=Object.values(L).sort((M,z)=>{const b=M.partyName.localeCompare(z.partyName);return b!==0?b:(M.clientCode||"").localeCompare(z.clientCode||"")});return c.jsxs("div",{children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[c.jsxs("div",{children:[c.jsx("h1",{style:{margin:0,fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:" Master Sheet"}),c.jsxs("p",{style:{margin:"4px 0 0",fontSize:"14px",color:"#64748B"},children:[Se.length," campaigns  ",Gs.length," parties  ",Se.filter(M=>M.invoiceGenerated).length," invoiced"]})]}),c.jsxs("div",{style:{display:"flex",gap:"10px"},children:[c.jsx("input",{type:"file",ref:Yu,accept:".xlsx,.xls,.csv",style:{display:"none"},onChange:y4}),c.jsx(Ye,{icon:Xs,label:"Upload Data",variant:"brand",onClick:()=>{var M;return(M=Yu.current)==null?void 0:M.click()}}),Cr&&Se.length>0&&c.jsx(Ye,{icon:as,label:"Clear All Data",variant:"danger",onClick:()=>zs(!0)})]})]}),c.jsxs("div",{style:{display:"flex",gap:"4px",marginBottom:"16px",backgroundColor:"#F1F5F9",padding:"4px",borderRadius:"10px",width:"fit-content"},children:[c.jsxs("button",{onClick:()=>I("open"),style:{padding:"10px 20px",fontSize:"14px",fontWeight:"600",border:"none",borderRadius:"8px",cursor:"pointer",backgroundColor:Ci==="open"?"#FFFFFF":"transparent",color:Ci==="open"?"#1E293B":"#64748B",boxShadow:Ci==="open"?"0 2px 4px rgba(0,0,0,0.1)":"none"},children:[" Open Invoices (",_.length,")"]}),c.jsxs("button",{onClick:()=>I("closed"),style:{padding:"10px 20px",fontSize:"14px",fontWeight:"600",border:"none",borderRadius:"8px",cursor:"pointer",backgroundColor:Ci==="closed"?"#FFFFFF":"transparent",color:Ci==="closed"?"#1E293B":"#64748B",boxShadow:Ci==="closed"?"0 2px 4px rgba(0,0,0,0.1)":"none"},children:[" Closed Invoices (",h.length,")"]})]}),Se.length>0&&P4(),se.length===0?c.jsx(En,{children:c.jsxs("div",{style:{padding:"60px",textAlign:"center",color:"#94A3B8"},children:[c.jsx(Xs,{size:48,style:{marginBottom:"16px",opacity:.5}}),c.jsx("div",{style:{fontSize:"18px",fontWeight:"600"},children:He?"No matching records":Ci==="closed"?"No closed invoices yet":"No Data Yet"}),c.jsx("div",{style:{fontSize:"14px",marginTop:"4px"},children:He?"Try adjusting your filters":Ci==="closed"?"Invoices will appear here once billed, mailed, and payment received":"Upload an Excel file to get started"})]})}):c.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:se.map((M,z)=>{const{partyName:b,clientCode:U,rows:oe}=M,fe=`${b}|||${U}`,me=u0.has(fe),qe=oe.filter(te=>te.toBeBilled==="Yes").length,le=oe.filter(te=>te.invoiceGenerated).length,ae=oe.filter(te=>te.toBeBilled==="Yes").reduce((te,Ae)=>te+(parseFloat(Ae.totalWithGst)||0),0);return c.jsxs("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"12px",border:"1px solid #E2E8F0",overflow:"hidden",boxShadow:"0 2px 8px rgba(0,0,0,0.04)"},children:[c.jsxs("div",{onClick:()=>ky(fe),style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"16px 20px",backgroundColor:Ci==="closed"?"#F0FDF4":"#F8FAFC",cursor:"pointer",borderBottom:me?"3px solid #2874A6":"none"},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[me?c.jsx(rm,{size:22,color:"#2874A6"}):c.jsx(K0,{size:22,color:"#64748B"}),c.jsxs("div",{children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[c.jsx("span",{style:{fontWeight:"700",fontSize:"16px",color:"#1E293B"},children:b}),U&&c.jsx("span",{style:{padding:"2px 8px",backgroundColor:"#F3E8FF",color:"#6B21A8",borderRadius:"6px",fontSize:"12px",fontWeight:"700"},children:U})]}),c.jsxs("div",{style:{fontSize:"13px",color:"#64748B",marginTop:"3px"},children:[oe.length," campaigns  ",qe," billed  ",le," invoiced"]})]})]}),ae>0&&c.jsxs("div",{style:{textAlign:"right"},children:[c.jsx("div",{style:{fontSize:"11px",color:"#64748B",textTransform:"uppercase"},children:"Total"}),c.jsx("div",{style:{fontSize:"18px",fontWeight:"700",color:"#059669"},children:at(ae)})]})]}),me&&c.jsx("div",{style:{overflowX:"auto"},children:c.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"13px",minWidth:"2200px"},children:[c.jsx("thead",{children:c.jsxs("tr",{style:{backgroundColor:"#F1F5F9"},children:[c.jsx("th",{style:{padding:"12px 14px",textAlign:"left",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"90px"},children:"Date"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#6B21A8",borderBottom:"2px solid #E2E8F0",backgroundColor:"#FAF5FF",width:"60px"},children:"Code"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"left",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"100px"},children:"Sender"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"left",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",minWidth:"180px"},children:"Campaign / Subject"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"left",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"160px"},children:"Email ID"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"70px"},children:"Mailer"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"70px"},children:"PO?"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"80px"},children:"Bill?"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"right",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"90px"},children:"Amount"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"90px"},children:"Type"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"90px"},children:"Generate"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"left",fontWeight:"700",color:"#1E40AF",borderBottom:"2px solid #E2E8F0",backgroundColor:"#EFF6FF",width:"110px"},children:"Invoice No."}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"left",fontWeight:"700",color:"#1E40AF",borderBottom:"2px solid #E2E8F0",backgroundColor:"#EFF6FF",width:"90px"},children:"Inv Date"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"right",fontWeight:"700",color:"#1E40AF",borderBottom:"2px solid #E2E8F0",backgroundColor:"#EFF6FF",width:"100px"},children:"Inv Amount"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#7C3AED",borderBottom:"2px solid #E2E8F0",backgroundColor:"#FAF5FF",width:"50px"},children:"C#"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"120px"},children:"Status/Approve"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"120px"},children:"Actions"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#059669",borderBottom:"2px solid #E2E8F0",backgroundColor:"#F0FDF4",width:"80px"},children:"Mailed?"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#059669",borderBottom:"2px solid #E2E8F0",backgroundColor:"#F0FDF4",width:"90px"},children:"Mail Date"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#7C3AED",borderBottom:"2px solid #E2E8F0",backgroundColor:"#FAF5FF",width:"100px"},children:"Receipt"})]})}),c.jsx("tbody",{children:oe.map(te=>{var st,mt;const Ae=te.invoiceType==="Combined"&&B(te.combinationCode)&&te.mailingSent!=="Yes";er(te);const Qe=It[te.id]&&It[te.id].length>0,Je=te.clientCode||zr(te.partyName,te.statePartyDetails);return c.jsxs("tr",{style:{backgroundColor:te.toBeBilled==="Yes"?te.invoiceGenerated?"#F0FDF4":"#FFFBEB":"#FFFFFF",borderBottom:"1px solid #F1F5F9"},children:[c.jsx("td",{style:{padding:"12px 14px",whiteSpace:"nowrap",fontSize:"13px"},children:At(te.date)}),c.jsx("td",{style:{padding:"12px 14px",textAlign:"center",backgroundColor:"#FAF5FF"},children:c.jsx("span",{style:{fontWeight:"700",color:"#6B21A8",fontSize:"12px"},children:Je||"-"})}),c.jsx("td",{style:{padding:"12px 14px",fontWeight:"600",fontSize:"13px"},children:te.senderName}),c.jsxs("td",{style:{padding:"12px 14px"},children:[c.jsx("div",{style:{fontWeight:"600",fontSize:"13px",lineHeight:"1.4",color:"#1E293B"},children:((mt=(st=te.campaignName)==null?void 0:st.split("--")[0])==null?void 0:mt.trim())||te.senderName}),te.subject&&c.jsx("div",{style:{fontSize:"12px",color:"#64748B",marginTop:"4px",lineHeight:"1.3"},children:te.subject})]}),c.jsx("td",{style:{padding:"10px 14px"},children:c.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[te.emailId&&c.jsx("div",{style:{fontSize:"11px",color:"#1E40AF",backgroundColor:"#EFF6FF",padding:"2px 6px",borderRadius:"4px",display:"inline-block"},children:te.emailId}),(te.additionalEmails||[]).map((lt,zt)=>c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[c.jsx("span",{style:{fontSize:"11px",color:"#059669",backgroundColor:"#F0FDF4",padding:"2px 6px",borderRadius:"4px"},children:lt}),c.jsx("button",{onClick:()=>Qt(te.id,lt),style:{background:"none",border:"none",cursor:"pointer",padding:"2px",color:"#DC2626"},title:"Remove",children:c.jsx(Ta,{size:12})})]},zt)),c.jsxs("button",{onClick:()=>{ur(te),ys(""),Lr(!0)},style:{display:"flex",alignItems:"center",gap:"4px",fontSize:"11px",color:"#2874A6",background:"none",border:"none",cursor:"pointer",padding:"2px 0"},children:[c.jsx(sm,{size:12})," Add"]})]})}),c.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:Qe?c.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"2px"},children:[c.jsx("span",{style:{color:"#22C55E",fontWeight:"700",fontSize:"14px"},children:""}),c.jsx("button",{onClick:()=>{ur(te),Ws(null),Ao(!0),ji(!0)},style:{fontSize:"10px",color:"#64748B",background:"none",border:"none",cursor:"pointer",textDecoration:"underline"},children:"Replace"})]}):c.jsx(Ye,{icon:tE,small:!0,variant:"default",onClick:()=>{ur(te),Ws(null),Ao(!1),ji(!0)}})}),c.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:te.poStatus==="With PO"?c.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"2px"},children:[c.jsx("span",{style:{color:"#22C55E",fontWeight:"600",fontSize:"10px"},children:" PO"}),c.jsx("span",{style:{fontSize:"9px",color:"#1E40AF",fontWeight:"600"},children:te.poNumber}),te.poDate&&c.jsx("span",{style:{fontSize:"9px",color:"#64748B"},children:At(te.poDate)})]}):c.jsx("span",{style:{color:"#CBD5E1",fontSize:"10px"},children:"No PO"})}),c.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:c.jsxs("select",{value:te.toBeBilled,onChange:lt=>E4(te.id,lt.target.value),disabled:te.invoiceGenerated||!li,style:{padding:"6px 8px",fontSize:"12px",fontWeight:"600",border:"2px solid",borderRadius:"6px",borderColor:te.toBeBilled==="Yes"?"#22C55E":"#E2E8F0",backgroundColor:te.toBeBilled==="Yes"?"#DCFCE7":"#FFFFFF",color:te.toBeBilled==="Yes"?"#166534":"#64748B",cursor:te.invoiceGenerated||!li?"not-allowed":"pointer",width:"70px",opacity:!li&&!te.invoiceGenerated?.6:1},children:[c.jsx("option",{value:"Not Yet",children:"Not Yet"}),c.jsx("option",{value:"Yes",children:"Yes"})]})}),c.jsx("td",{style:{padding:"10px 14px"},children:c.jsx("input",{type:"number",value:te.invoiceAmount||"",onChange:lt=>g0(te.id,"invoiceAmount",lt.target.value),disabled:te.invoiceGenerated,placeholder:"0",style:{width:"80px",padding:"6px 8px",fontSize:"13px",fontWeight:"600",border:"1.5px solid #D1D5DB",borderRadius:"6px",textAlign:"right",backgroundColor:te.invoiceGenerated?"#F3F4F6":"#FFFFFF"}})}),c.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:te.invoiceGenerated?c.jsx(vm,{status:te.invoiceType,small:!0}):te.toBeBilled==="Yes"?c.jsxs("select",{value:te.invoiceType||"Individual",onChange:lt=>g0(te.id,"invoiceType",lt.target.value),style:{padding:"6px 6px",fontSize:"11px",fontWeight:"600",border:"2px solid",borderRadius:"6px",borderColor:te.invoiceType==="Combined"?"#7C3AED":"#A5B4FC",backgroundColor:te.invoiceType==="Combined"?"#F3E8FF":"#E0E7FF",color:te.invoiceType==="Combined"?"#6B21A8":"#3730A3",cursor:"pointer",width:"80px"},children:[c.jsx("option",{value:"Individual",children:"Individual"}),c.jsx("option",{value:"Combined",children:"Combined"})]}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),c.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:te.toBeBilled==="Yes"&&!te.invoiceGenerated&&te.invoiceAmount&&Cr?te.invoiceType==="Individual"?c.jsx(Ye,{icon:Oo,label:"Create",small:!0,variant:"warning",onClick:()=>S4(te)}):c.jsx(Ye,{icon:LL,label:"Combine",small:!0,variant:"purple",onClick:()=>A4(te)}):te.toBeBilled==="Yes"&&!te.invoiceGenerated&&te.invoiceAmount&&li?c.jsx("span",{style:{fontSize:"10px",color:"#94A3B8"},children:"Finance to create"}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),c.jsx("td",{style:{padding:"10px 14px",backgroundColor:"#EFF6FF"},children:te.invoiceNo?c.jsx("span",{style:{fontWeight:"700",color:"#1E40AF",fontSize:"12px"},children:te.invoiceNo}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),c.jsx("td",{style:{padding:"10px 14px",backgroundColor:"#EFF6FF",fontSize:"12px"},children:te.invoiceDate?At(te.invoiceDate):"-"}),c.jsx("td",{style:{padding:"10px 14px",backgroundColor:"#EFF6FF",textAlign:"right",fontWeight:"700",color:"#1E40AF",fontSize:"13px"},children:te.invoiceTotalAmount?tr(te.invoiceTotalAmount):"-"}),c.jsx("td",{style:{padding:"10px 14px",textAlign:"center",backgroundColor:"#FAF5FF"},children:te.combinationCode&&te.combinationCode!=="NA"?c.jsx("span",{style:{fontWeight:"700",color:"#7C3AED",fontSize:"12px"},children:te.combinationCode}):"-"}),c.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:te.invoiceGenerated?li?c.jsx("button",{onClick:()=>In(te),style:{padding:"5px 10px",fontSize:"11px",fontWeight:"700",border:"1.5px solid",borderRadius:"6px",cursor:"pointer",backgroundColor:te.invoiceStatus==="Approved"?"#DCFCE7":te.invoiceStatus==="Need Edits"?"#FEE2E2":"#FEF3C7",borderColor:te.invoiceStatus==="Approved"?"#22C55E":te.invoiceStatus==="Need Edits"?"#DC2626":"#F59E0B",color:te.invoiceStatus==="Approved"?"#166534":te.invoiceStatus==="Need Edits"?"#991B1B":"#92400E"},children:te.invoiceStatus==="Approved"?" Approved":te.invoiceStatus==="Need Edits"?" Need Edits":" Review"}):c.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"4px"},children:[c.jsx("span",{style:{padding:"4px 10px",fontSize:"11px",fontWeight:"700",borderRadius:"6px",backgroundColor:te.invoiceStatus==="Approved"?"#DCFCE7":te.invoiceStatus==="Need Edits"?"#FEE2E2":"#FEF3C7",color:te.invoiceStatus==="Approved"?"#166534":te.invoiceStatus==="Need Edits"?"#991B1B":"#92400E"},children:te.invoiceStatus==="Approved"?" Approved":te.invoiceStatus==="Need Edits"?" Need Edits":" Pending"}),(te.editComments||te.approvalRemarks)&&c.jsx("button",{onClick:()=>{ur(te),Bn(!0)},style:{fontSize:"9px",color:te.invoiceStatus==="Need Edits"?"#991B1B":"#166534",background:"none",border:"none",cursor:"pointer",textDecoration:"underline"},title:te.editComments||te.approvalRemarks,children:"View Remarks"})]}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),c.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:te.invoiceGenerated&&te.invoiceStatus==="Approved"?c.jsxs("div",{style:{display:"flex",gap:"6px",justifyContent:"center"},children:[c.jsx(Ye,{icon:Pc,small:!0,onClick:()=>td(te),title:"View Invoice"}),Cr&&c.jsx(Ye,{icon:X0,small:!0,variant:"brand",onClick:()=>{ur(te),Gr(!0)},title:"Send Email"}),Cr&&c.jsx(Ye,{icon:as,small:!0,variant:"danger",onClick:()=>hg(te),title:"Delete"})]}):te.invoiceGenerated?c.jsxs("div",{style:{display:"flex",gap:"6px",justifyContent:"center"},children:[c.jsx(Ye,{icon:Pc,small:!0,onClick:()=>td(te),title:"View Invoice"}),Cr&&c.jsx(Ye,{icon:as,small:!0,variant:"danger",onClick:()=>hg(te),title:"Delete"})]}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),c.jsx("td",{style:{padding:"10px 14px",textAlign:"center",backgroundColor:"#F0FDF4"},children:te.invoiceGenerated&&te.invoiceStatus==="Approved"&&Cr?Ae?c.jsx("span",{style:{fontSize:"10px",color:"#94A3B8"},children:"Combined sent"}):c.jsxs("select",{value:te.mailingSent||"No",onChange:lt=>g0(te.id,"mailingSent",lt.target.value),style:{padding:"5px 8px",fontSize:"11px",fontWeight:"700",border:"2px solid",borderRadius:"6px",borderColor:te.mailingSent==="Yes"?"#22C55E":"#E2E8F0",backgroundColor:te.mailingSent==="Yes"?"#DCFCE7":"#FFFFFF",color:te.mailingSent==="Yes"?"#166534":"#64748B",cursor:"pointer",width:"60px"},children:[c.jsx("option",{value:"No",children:"No"}),c.jsx("option",{value:"Yes",children:"Yes"})]}):te.invoiceGenerated&&te.invoiceStatus==="Approved"&&li?c.jsx("span",{style:{padding:"4px 8px",borderRadius:"6px",fontSize:"11px",fontWeight:"600",backgroundColor:te.mailingSent==="Yes"?"#DCFCE7":"#FEF3C7",color:te.mailingSent==="Yes"?"#166534":"#92400E"},children:te.mailingSent==="Yes"?" Yes":" No"}):te.invoiceGenerated&&te.invoiceStatus!=="Approved"?c.jsx("span",{style:{fontSize:"10px",color:"#94A3B8"},children:"Approve first"}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),c.jsx("td",{style:{padding:"10px 14px",textAlign:"center",backgroundColor:"#F0FDF4"},children:te.mailingSent==="Yes"?Cr?c.jsx("input",{type:"date",value:te.mailDate||te.invoiceDate||"",onChange:lt=>g0(te.id,"mailDate",lt.target.value),style:{padding:"4px 6px",fontSize:"11px",border:"1.5px solid #D1D5DB",borderRadius:"6px",width:"100%"}}):c.jsx("span",{style:{fontSize:"11px"},children:At(te.mailDate||te.invoiceDate)}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),c.jsx("td",{style:{padding:"10px 14px",textAlign:"center",backgroundColor:"#FAF5FF"},children:te.receiptStatus==="Received"||te.receiptStatus==="Closed"?c.jsxs("span",{style:{padding:"4px 8px",borderRadius:"6px",fontSize:"10px",fontWeight:"700",backgroundColor:"#DCFCE7",color:"#166534"},children:[" ",te.receiptNo||"Received"]}):te.receiptStatus==="Cancelled"?c.jsx("span",{style:{padding:"4px 8px",borderRadius:"6px",fontSize:"10px",fontWeight:"700",backgroundColor:"#FEE2E2",color:"#991B1B"},children:" Cancelled"}):te.invoiceGenerated&&te.invoiceStatus==="Approved"?c.jsx("span",{style:{padding:"4px 8px",borderRadius:"6px",fontSize:"10px",fontWeight:"600",backgroundColor:"#FEF3C7",color:"#92400E"},children:" Pending"}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})})]},te.id)})})]})})]},fe)})}),W.length>0&&c.jsxs("div",{style:{marginTop:"16px",padding:"16px 20px",backgroundColor:"#FFFFFF",borderRadius:"12px",border:"1px solid #E2E8F0",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[c.jsxs("div",{style:{display:"flex",gap:"24px",fontSize:"14px",color:"#475569"},children:[c.jsxs("span",{children:[" Total: ",c.jsx("strong",{children:Z.length})]}),c.jsxs("span",{children:[" To Bill: ",c.jsx("strong",{children:Z.filter(M=>M.toBeBilled==="Yes").length})]}),c.jsxs("span",{children:[" Invoiced: ",c.jsx("strong",{children:Z.filter(M=>M.invoiceGenerated).length})]}),c.jsxs("span",{children:[" Approved: ",c.jsx("strong",{children:Z.filter(M=>M.invoiceStatus==="Approved").length})]}),Ci==="closed"&&c.jsxs("span",{children:[" Closed: ",c.jsx("strong",{children:Z.filter(M=>M.receiptStatus==="Received"||M.receiptStatus==="Cancelled"||M.receiptStatus==="Closed").length})]})]}),c.jsxs("div",{style:{fontSize:"18px",fontWeight:"700",color:"#059669"},children:["Total: ",at(Z.filter(M=>M.toBeBilled==="Yes").reduce((M,z)=>M+(parseFloat(z.totalWithGst)||0),0))]})]})]})},O4=h=>{var Z;const _=(Z=h.target.files)==null?void 0:Z[0];if(!_)return;const W=new FileReader;W.onload=L=>{const se=Pl(L.target.result,{type:"binary",cellDates:!0}),M=se.SheetNames[0],z=se.Sheets[M],b=kr.sheet_to_json(z,{raw:!1}),U=new Set(Yr.map(le=>`${le.date}|${le.partyName}|${le.serviceType||le.campaignName}`.toLowerCase()));let oe=0,fe=0;const me=b.map((le,ae)=>{const te=(le["TYPE OF SERVICE"]||le["Type of Service"]||le["SERVICE TYPE"]||le["Service Type"]||le["CAMPAIGN NAME"]||le["Campaign Name"]||"").trim().toUpperCase();let Ae=le.DATE||le.Date||new Date;typeof Ae=="string"&&(Ae=new Date(Ae));const Qe=(le["PARTY NAME"]||le["Party Name"]||"").trim(),Je=le.EMAIL||le.Email||"",st=le.STATE||le.State||le["State/Party Details"]||le["STATE/PARTY DETAILS"]||"",mt=le.AMOUNT||le.Amount||Wi[Qe]||"",lt=Ae instanceof Date&&!isNaN(Ae)?Ae.toISOString().split("T")[0]:"",Ue=(le["Client Code"]||le["CLIENT CODE"]||le.Code||"").toString().trim()||zr(Qe,st),it=le["PO?"]||le.PO||le["WITH PO"]||"",Bt=it.toLowerCase().includes("with po")||it.toLowerCase()==="yes",Gt=le["PO Number"]||le["PO NUMBER"]||le["PO No"]||le["PO NO"]||"";let rt=le["PO Date"]||le["PO DATE"]||"";typeof rt=="object"&&rt instanceof Date&&(rt=rt.toISOString().split("T")[0]);const K=`${lt}|${Qe}|${te}`.toLowerCase();return U.has(K)?(oe++,null):(U.add(K),fe++,{id:Date.now()+ae+Math.random(),sno:le.SNO||le["SNO."]||le.Sno||ae+1,date:lt,statePartyDetails:st,partyName:Qe,clientCode:Ue,serviceType:te,emailId:Je,additionalEmails:[],toBeBilled:"Not Yet",invoiceAmount:mt,cgst:"",sgst:"",igst:"",totalWithGst:"",invoiceType:"Individual",invoiceNo:"",invoiceDate:"",invoiceTotalAmount:"",invoiceGenerated:!1,invoiceStatus:"Pending",mailingSent:"No",mailDate:"",mailerUploaded:!1,editComments:"",approvalRemarks:"",isService:!0,poStatus:Bt?"With PO":"Without PO",poNumber:Bt?Gt:"",poDate:Bt?rt:""})}).filter(le=>le!==null);if(me.length>0){const le=[...Yr,...me];console.log("Setting services data:",le.length,"entries"),Ce(le);const ae=[...new Set(me.map(te=>te.partyName))];he(te=>{const Ae=new Set(te);return ae.forEach(Qe=>Ae.add(Qe)),Ae}),setTimeout(async()=>{console.log("Triggering immediate save for services data..."),ws.current=!1;try{await vd("indreesh-media",{masterData:Se,servicesData:le,ledgerEntries:ie,receipts:Me,creditNotes:re,openingBalances:Yn,mailerImages:It,mailerLogo:Kn,companyConfig:T,nextInvoiceNo:ot,nextCombineNo:Ot,nextReceiptNo:Mt,nextCreditNoteNo:Ke,nextServiceInvoiceNo:rn,invoiceValues:Wi,notifications:We,whatsappSettings:bt,partyMaster:un,followups:Xt,userPasswords:y}),console.log("Services data saved successfully!"),m(new Date)}catch(te){console.error("Error saving services data:",te)}},100)}let qe=` Services Upload Complete!

`;qe+=` ${fe} new entries added
`,oe>0&&(qe+=` ${oe} duplicate entries skipped`),fe>0&&ns("upload",` ${fe} new services uploaded`,"director"),alert(qe)},W.readAsBinaryString(_),h.target.value=""},rd=(h,_,W)=>{Ce(Z=>Z.map(L=>L.id===h?{...L,[_]:W}:L))},M4=h=>{he(_=>{const W=new Set(_);return W.has(h)?W.delete(h):W.add(h),W})},pg=h=>{const _=ke.find(W=>W.id===h);if(_!=null&&_.invoiceGenerated&&(_==null?void 0:_.invoiceStatus)==="Approved"){alert("Cannot delete approved invoices. Delete from Invoice Register instead.");return}window.confirm("Delete this service entry?")&&Ce(W=>W.filter(Z=>Z.id!==h))},B4=h=>{var oe;const _=ke.find(fe=>fe.id===h);if(!_)return;if(!_.invoiceAmount||parseFloat(_.invoiceAmount)<=0){alert("Please enter a valid invoice amount");return}const W=`${T.invoicePrefix}${rn}`,Z=new Date().toISOString().split("T")[0],L=(oe=_.statePartyDetails)==null?void 0:oe.toUpperCase().includes("MAHARASHTRA"),se=parseFloat(_.invoiceAmount),M=L?se*.09:0,z=L?se*.09:0,b=L?0:se*.18,U=se+M+z+b;Ce(fe=>fe.map(me=>me.id===h?{...me,invoiceNo:W,invoiceDate:Z,invoiceTotalAmount:U.toFixed(2),cgst:M.toFixed(2),sgst:z.toFixed(2),igst:b.toFixed(2),totalWithGst:U.toFixed(2),invoiceGenerated:!0,invoiceStatus:"Created",isService:!0}:me)),Cn(fe=>fe+1),ns("invoice_created",`Service Invoice ${W} created for ${_.partyName}`,"director")},nd=h=>{if(console.log("generateServiceInvoicePDF called with:",h),!h){console.error("No row data provided"),alert("Invoice data not found - no row");return}if(!h.invoiceNo){console.error("No invoice number in row:",h),alert("Invoice not yet generated for this entry");return}const _={...h,isService:!0};Cy(_)},j4=ye.useMemo(()=>[...new Set(Yr.map(h=>h.partyName).filter(Boolean))].sort(),[Yr]),gg=ye.useMemo(()=>Yr.filter(h=>!(de.party&&h.partyName!==de.party||de.billStatus&&h.toBeBilled!==de.billStatus||de.invoiceStatus&&(de.invoiceStatus==="Pending"&&h.invoiceGenerated||de.invoiceStatus==="Created"&&h.invoiceStatus!=="Created"||de.invoiceStatus==="Approved"&&h.invoiceStatus!=="Approved"||de.invoiceStatus==="Need Edits"&&h.invoiceStatus!=="Need Edits"))),[Yr,de]),L4=()=>{const h=r==="director",_=r==="finance";console.log("Services Render Debug:",{servicesDataType:typeof ke,servicesDataIsArray:Array.isArray(ke),servicesDataLength:ke==null?void 0:ke.length,safeServicesDataLength:Yr.length,filteredServicesDataLength:gg.length,role:r,serviceFilters:de,servicesSheetTab:G,rawServicesData:ke});const W=gg.filter(z=>!(z.toBeBilled==="Yes"&&z.invoiceGenerated&&z.mailingSent==="Yes"&&(z.receiptStatus==="Received"||z.receiptStatus==="Cancelled"||z.receiptStatus==="Closed"))),Z=gg.filter(z=>z.toBeBilled==="Yes"&&z.invoiceGenerated&&z.mailingSent==="Yes"&&(z.receiptStatus==="Received"||z.receiptStatus==="Cancelled"||z.receiptStatus==="Closed")),L=G==="open"?W:Z;console.log("Services Tab Data:",{openCount:W.length,closedCount:Z.length,currentTab:G});const se={};L.forEach(z=>{const b=z.clientCode||zr(z.partyName,z.statePartyDetails)||"",U=`${z.partyName||"Unknown"}|||${b}`;se[U]||(se[U]={partyName:z.partyName||"Unknown",clientCode:b,rows:[]}),se[U].rows.push(z)});const M=Object.values(se).sort((z,b)=>{const U=z.partyName.localeCompare(b.partyName);return U!==0?U:(z.clientCode||"").localeCompare(b.clientCode||"")});if(h&&M.length>0&&ve.size===0){const z=new Set(M.map(b=>`${b.partyName}|||${b.clientCode}`));he(z)}return c.jsxs("div",{style:{padding:"20px"},children:[c.jsx("input",{type:"file",ref:Co,onChange:O4,accept:".xlsx,.xls,.csv",style:{display:"none"}}),c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[c.jsxs("div",{children:[c.jsx("h1",{style:{fontSize:"22px",fontWeight:"700",color:"#1E293B",marginBottom:"4px"},children:" Services Sheet"}),c.jsxs("p",{style:{fontSize:"13px",color:"#64748B"},children:["Non-campaign invoices  Total: ",Yr.length," entries"]})]}),c.jsx("div",{style:{display:"flex",gap:"10px"},children:_&&c.jsxs(c.Fragment,{children:[c.jsx(Ye,{icon:Xs,label:"Upload Excel",onClick:()=>{var z;return(z=Co.current)==null?void 0:z.click()}}),c.jsx(Ye,{icon:zL,label:"Force Save",variant:"secondary",onClick:async()=>{try{ws.current=!1,await vd("indreesh-media",{masterData:Se,servicesData:ke,ledgerEntries:ie,receipts:Me,creditNotes:re,openingBalances:Yn,mailerImages:It,mailerLogo:Kn,companyConfig:T,nextInvoiceNo:ot,nextCombineNo:Ot,nextReceiptNo:Mt,nextCreditNoteNo:Ke,nextServiceInvoiceNo:rn,invoiceValues:Wi,notifications:We,whatsappSettings:bt,partyMaster:un,followups:Xt,userPasswords:y}),m(new Date),alert("Data saved successfully!")}catch(z){console.error("Save error:",z),alert("Error saving: "+z.message)}}}),c.jsx(Ye,{icon:md,label:"Add Entry",variant:"primary",onClick:()=>q(!0)})]})})]}),c.jsx("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"10px",border:"1px solid #E2E8F0",padding:"14px 18px",marginBottom:"16px"},children:c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"14px",flexWrap:"wrap"},children:[c.jsx(gd,{size:18,color:"#64748B"}),c.jsx("span",{style:{fontSize:"13px",fontWeight:"700",color:"#475569"},children:"Filters:"}),c.jsxs("select",{value:de.party,onChange:z=>ge(b=>({...b,party:z.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px"},children:[c.jsx("option",{value:"",children:"All Parties"}),j4.map(z=>c.jsx("option",{value:z,children:z},z))]}),c.jsxs("select",{value:de.billStatus,onChange:z=>ge(b=>({...b,billStatus:z.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px"},children:[c.jsx("option",{value:"",children:"All Bill Status"}),c.jsx("option",{value:"Yes",children:"To Be Billed"}),c.jsx("option",{value:"No",children:"Not Billing"}),c.jsx("option",{value:"Not Yet",children:"Not Yet"})]}),c.jsxs("select",{value:de.invoiceStatus,onChange:z=>ge(b=>({...b,invoiceStatus:z.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px"},children:[c.jsx("option",{value:"",children:"All Invoice Status"}),c.jsx("option",{value:"Pending",children:"Pending"}),c.jsx("option",{value:"Created",children:"Created"}),c.jsx("option",{value:"Approved",children:"Approved"}),c.jsx("option",{value:"Need Edits",children:"Need Edits"})]}),(de.party||de.billStatus||de.invoiceStatus)&&c.jsxs("button",{onClick:()=>ge({party:"",billStatus:"",invoiceStatus:""}),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #FCA5A5",borderRadius:"8px",backgroundColor:"#FEE2E2",color:"#991B1B",cursor:"pointer"},children:[c.jsx(Ta,{size:14})," Clear"]})]})}),c.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"20px",justifyContent:"space-between",alignItems:"center"},children:[c.jsxs("div",{style:{display:"flex",gap:"8px"},children:[c.jsxs("button",{onClick:()=>j("open"),style:{padding:"10px 20px",fontSize:"13px",fontWeight:"600",border:"none",borderRadius:"8px",cursor:"pointer",backgroundColor:G==="open"?"#2874A6":"#E2E8F0",color:G==="open"?"#FFFFFF":"#64748B"},children:["Open (",W.length,")"]}),c.jsxs("button",{onClick:()=>j("closed"),style:{padding:"10px 20px",fontSize:"13px",fontWeight:"600",border:"none",borderRadius:"8px",cursor:"pointer",backgroundColor:G==="closed"?"#22C55E":"#E2E8F0",color:G==="closed"?"#FFFFFF":"#64748B"},children:["Closed (",Z.length,")"]})]}),c.jsx("button",{onClick:()=>{ve.size===M.length?he(new Set):he(new Set(M.map(z=>`${z.partyName}|||${z.clientCode}`)))},style:{padding:"8px 16px",fontSize:"12px",fontWeight:"600",border:"1px solid #CBD5E1",borderRadius:"6px",cursor:"pointer",backgroundColor:"#F8FAFC",color:"#475569"},children:ve.size===M.length?"Collapse All":"Expand All"})]}),c.jsx(En,{title:`Services - ${G==="open"?"Open":"Closed"}`,noPadding:!0,children:M.length===0?c.jsxs("div",{style:{padding:"40px",textAlign:"center",color:"#94A3B8"},children:[c.jsx(im,{size:40,style:{marginBottom:"10px",opacity:.5}}),c.jsx("p",{children:"No services in this tab"}),_&&c.jsx("p",{style:{marginTop:"10px",fontSize:"13px"},children:"Upload Excel or Add Entry to get started"})]}):M.map((z,b)=>{const{partyName:U,clientCode:oe,rows:fe}=z,me=`${U}|||${oe}`,qe=ve.has(me),le=fe.filter(ae=>ae.toBeBilled==="Yes").reduce((ae,te)=>ae+(parseFloat(te.totalWithGst)||parseFloat(te.invoiceAmount)||0),0);return c.jsxs("div",{style:{borderBottom:"2px solid #E2E8F0"},children:[c.jsxs("div",{onClick:()=>M4(me),style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"16px 20px",backgroundColor:G==="closed"?"#F0FDF4":"#F8FAFC",cursor:"pointer",borderBottom:qe?"3px solid #2874A6":"none"},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[qe?c.jsx(rm,{size:20,color:"#2874A6"}):c.jsx(K0,{size:20,color:"#64748B"}),c.jsx("span",{style:{fontWeight:"700",fontSize:"15px",color:"#1E293B"},children:U}),oe&&c.jsx("span",{style:{padding:"2px 8px",backgroundColor:"#F3E8FF",color:"#6B21A8",borderRadius:"6px",fontSize:"12px",fontWeight:"700"},children:oe}),c.jsxs("span",{style:{padding:"4px 10px",backgroundColor:"#E0E7FF",color:"#3730A3",borderRadius:"9999px",fontSize:"12px",fontWeight:"600"},children:[fe.length," items"]})]}),c.jsx("div",{style:{fontWeight:"700",color:"#059669"},children:at(le)})]}),qe&&c.jsx("div",{style:{overflowX:"auto"},children:c.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"12px"},children:[c.jsx("thead",{children:c.jsxs("tr",{style:{backgroundColor:"#F1F5F9"},children:[c.jsx("th",{style:{padding:"10px 8px",textAlign:"left",fontWeight:"600",color:"#475569"},children:"Date"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"600",color:"#6B21A8",backgroundColor:"#FAF5FF"},children:"Code"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"left",fontWeight:"600",color:"#475569"},children:"State"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"left",fontWeight:"600",color:"#475569"},children:"Type of Service"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"left",fontWeight:"600",color:"#475569"},children:"Emails"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"600",color:"#475569"},children:"Mailer"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"600",color:"#475569"},children:"PO?"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"600",color:"#475569"},children:"To Bill"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"600",color:"#475569"},children:"Amount"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"600",color:"#475569"},children:"Create"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"left",fontWeight:"600",color:"#475569",backgroundColor:"#EFF6FF"},children:"Invoice No"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"left",fontWeight:"600",color:"#475569",backgroundColor:"#EFF6FF"},children:"Inv Date"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"600",color:"#475569",backgroundColor:"#EFF6FF"},children:"Inv Amt"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"600",color:"#475569"},children:"Approval"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"600",color:"#475569"},children:"Actions"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"600",color:"#475569",backgroundColor:"#F0FDF4"},children:"Mailed"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"600",color:"#475569",backgroundColor:"#F0FDF4"},children:"Mail Date"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"600",color:"#475569",backgroundColor:"#FEF3C7"},children:"Status"})]})}),c.jsx("tbody",{children:fe.map(ae=>{const te=It[ae.id]&&It[ae.id].length>0;[ae.emailId,...ae.additionalEmails||[]].filter(Boolean);const Ae=ae.clientCode||zr(ae.partyName,ae.statePartyDetails),Qe=Xr.filter(rt=>rt.invoiceNo===ae.invoiceNo),Je=oi.filter(rt=>rt.invoiceNo===ae.invoiceNo),st=Qe.reduce((rt,K)=>rt+(parseFloat(K.amount)||0),0),mt=Qe.reduce((rt,K)=>rt+(parseFloat(K.tds)||parseFloat(K.tdsAmount)||0),0),lt=Je.reduce((rt,K)=>rt+Math.abs(parseFloat(K.totalAmount)||0),0),zt=parseFloat(ae.invoiceTotalAmount)||0,Ue=zt-st-mt-lt;let it="Pending",Bt="#FEF3C7",Gt="#92400E";return lt>=zt?(it="Cancelled",Bt="#FEE2E2",Gt="#B91C1C"):Ue<=0?(it="Paid",Bt="#D1FAE5",Gt="#065F46"):(st>0||mt>0||lt>0)&&(it="Partial",Bt="#FEF3C7",Gt="#92400E"),c.jsxs("tr",{style:{backgroundColor:ae.toBeBilled==="Yes"?ae.invoiceGenerated?"#F0FDF4":"#FFFBEB":"#FFFFFF",borderBottom:"1px solid #F1F5F9"},children:[c.jsx("td",{style:{padding:"10px 8px",whiteSpace:"nowrap"},children:At(ae.date)}),c.jsx("td",{style:{padding:"10px 8px",textAlign:"center",backgroundColor:"#FAF5FF"},children:c.jsx("span",{style:{fontWeight:"700",color:"#6B21A8",fontSize:"11px"},children:Ae||"-"})}),c.jsx("td",{style:{padding:"10px 8px",fontSize:"11px",color:"#64748B"},children:ae.statePartyDetails||"-"}),c.jsx("td",{style:{padding:"10px 8px",fontWeight:"600",maxWidth:"180px"},children:c.jsx("div",{style:{color:"#1E293B"},children:ae.serviceType||ae.campaignName||"-"})}),c.jsx("td",{style:{padding:"10px 8px"},children:c.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[ae.emailId&&c.jsx("div",{style:{fontSize:"11px",color:"#1E40AF",backgroundColor:"#EFF6FF",padding:"2px 6px",borderRadius:"4px",display:"inline-block"},children:ae.emailId}),(ae.additionalEmails||[]).map((rt,K)=>c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[c.jsx("span",{style:{fontSize:"11px",color:"#059669",backgroundColor:"#F0FDF4",padding:"2px 6px",borderRadius:"4px"},children:rt}),_&&c.jsx("button",{onClick:()=>rd(ae.id,"additionalEmails",(ae.additionalEmails||[]).filter(Ve=>Ve!==rt)),style:{background:"none",border:"none",cursor:"pointer",padding:"2px",color:"#DC2626"},title:"Remove",children:c.jsx(Ta,{size:12})})]},K)),_&&c.jsxs("button",{onClick:()=>{ur(ae),ys(""),Lr(!0)},style:{display:"flex",alignItems:"center",gap:"4px",fontSize:"11px",color:"#2874A6",background:"none",border:"none",cursor:"pointer",padding:"2px 0"},children:[c.jsx(sm,{size:12})," Add"]})]})}),c.jsx("td",{style:{padding:"10px 8px",textAlign:"center"},children:te?c.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"2px"},children:[c.jsx("span",{style:{color:"#22C55E",fontWeight:"700",fontSize:"14px"},children:""}),_&&c.jsx("button",{onClick:()=>{ur(ae),Ws(null),Ao(!0),ji(!0)},style:{fontSize:"10px",color:"#64748B",background:"none",border:"none",cursor:"pointer",textDecoration:"underline"},children:"Replace"})]}):_&&c.jsx(Ye,{icon:tE,small:!0,variant:"default",onClick:()=>{ur(ae),Ws(null),Ao(!1),ji(!0)}})}),c.jsx("td",{style:{padding:"10px 8px",textAlign:"center"},children:ae.poStatus==="With PO"?c.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"2px"},children:[c.jsx("span",{style:{color:"#22C55E",fontWeight:"600",fontSize:"10px"},children:" PO"}),c.jsx("span",{style:{fontSize:"9px",color:"#1E40AF",fontWeight:"600"},children:ae.poNumber}),ae.poDate&&c.jsx("span",{style:{fontSize:"9px",color:"#64748B"},children:At(ae.poDate)})]}):c.jsx("span",{style:{color:"#CBD5E1",fontSize:"10px"},children:"No PO"})}),c.jsx("td",{style:{padding:"10px 8px",textAlign:"center"},children:c.jsxs("select",{value:ae.toBeBilled,onChange:rt=>rd(ae.id,"toBeBilled",rt.target.value),disabled:ae.invoiceGenerated||!h,style:{padding:"6px 8px",fontSize:"12px",fontWeight:"600",border:"2px solid",borderRadius:"6px",borderColor:ae.toBeBilled==="Yes"?"#22C55E":"#E2E8F0",backgroundColor:ae.toBeBilled==="Yes"?"#DCFCE7":"#FFFFFF",color:ae.toBeBilled==="Yes"?"#166534":"#64748B",cursor:ae.invoiceGenerated||!h?"not-allowed":"pointer",width:"70px",opacity:!h&&!ae.invoiceGenerated?.6:1},children:[c.jsx("option",{value:"Not Yet",children:"Not Yet"}),c.jsx("option",{value:"Yes",children:"Yes"})]})}),c.jsx("td",{style:{padding:"10px 8px"},children:c.jsx("input",{type:"number",value:ae.invoiceAmount||"",onChange:rt=>rd(ae.id,"invoiceAmount",rt.target.value),disabled:ae.invoiceGenerated,placeholder:"0",style:{width:"80px",padding:"6px 8px",fontSize:"13px",fontWeight:"600",border:"1.5px solid #D1D5DB",borderRadius:"6px",textAlign:"right",backgroundColor:ae.invoiceGenerated?"#F3F4F6":"#FFFFFF"}})}),c.jsx("td",{style:{padding:"10px 8px",textAlign:"center"},children:ae.toBeBilled==="Yes"&&!ae.invoiceGenerated&&ae.invoiceAmount&&_?c.jsx(Ye,{icon:Oo,label:"Create",small:!0,variant:"warning",onClick:()=>B4(ae.id)}):ae.toBeBilled==="Yes"&&!ae.invoiceGenerated&&ae.invoiceAmount&&h?c.jsx("span",{style:{fontSize:"10px",color:"#94A3B8"},children:"Finance to create"}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),c.jsx("td",{style:{padding:"10px 8px",backgroundColor:"#EFF6FF"},children:ae.invoiceNo?c.jsx("span",{style:{fontWeight:"700",color:"#1E40AF",fontSize:"12px"},children:ae.invoiceNo}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),c.jsx("td",{style:{padding:"10px 8px",backgroundColor:"#EFF6FF",fontSize:"12px"},children:ae.invoiceDate?At(ae.invoiceDate):"-"}),c.jsx("td",{style:{padding:"10px 8px",backgroundColor:"#EFF6FF",textAlign:"right",fontWeight:"700",color:"#1E40AF",fontSize:"13px"},children:ae.invoiceTotalAmount?tr(ae.invoiceTotalAmount):"-"}),c.jsx("td",{style:{padding:"10px 8px",textAlign:"center"},children:ae.invoiceGenerated?h?c.jsx("button",{onClick:()=>In(ae),style:{padding:"5px 10px",fontSize:"11px",fontWeight:"700",border:"1.5px solid",borderRadius:"6px",cursor:"pointer",backgroundColor:ae.invoiceStatus==="Approved"?"#DCFCE7":ae.invoiceStatus==="Need Edits"?"#FEE2E2":"#FEF3C7",borderColor:ae.invoiceStatus==="Approved"?"#22C55E":ae.invoiceStatus==="Need Edits"?"#DC2626":"#F59E0B",color:ae.invoiceStatus==="Approved"?"#166534":ae.invoiceStatus==="Need Edits"?"#991B1B":"#92400E"},children:ae.invoiceStatus==="Approved"?" Approved":ae.invoiceStatus==="Need Edits"?" Need Edits":" Review"}):c.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"4px"},children:[c.jsx("span",{style:{padding:"4px 10px",fontSize:"11px",fontWeight:"700",borderRadius:"6px",backgroundColor:ae.invoiceStatus==="Approved"?"#DCFCE7":ae.invoiceStatus==="Need Edits"?"#FEE2E2":"#FEF3C7",color:ae.invoiceStatus==="Approved"?"#166534":ae.invoiceStatus==="Need Edits"?"#991B1B":"#92400E"},children:ae.invoiceStatus==="Approved"?" Approved":ae.invoiceStatus==="Need Edits"?" Need Edits":" Pending"}),(ae.editComments||ae.approvalRemarks)&&c.jsx("button",{onClick:()=>{ur(ae),Bn(!0)},style:{fontSize:"9px",color:ae.invoiceStatus==="Need Edits"?"#991B1B":"#166534",background:"none",border:"none",cursor:"pointer",textDecoration:"underline"},title:ae.editComments||ae.approvalRemarks,children:"View Remarks"})]}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),c.jsx("td",{style:{padding:"10px 8px",textAlign:"center"},children:ae.invoiceGenerated&&ae.invoiceStatus==="Approved"?c.jsxs("div",{style:{display:"flex",gap:"6px",justifyContent:"center"},children:[c.jsx(Ye,{icon:Pc,small:!0,onClick:()=>nd(ae),title:"View Invoice"}),_&&c.jsx(Ye,{icon:X0,small:!0,variant:"brand",onClick:()=>{ur(ae),Gr(!0)},title:"Send Email"}),_&&c.jsx(Ye,{icon:as,small:!0,variant:"danger",onClick:()=>pg(ae.id),title:"Delete"})]}):ae.invoiceGenerated?c.jsxs("div",{style:{display:"flex",gap:"6px",justifyContent:"center"},children:[c.jsx(Ye,{icon:Pc,small:!0,onClick:()=>nd(ae),title:"View Invoice"}),_&&c.jsx(Ye,{icon:as,small:!0,variant:"danger",onClick:()=>pg(ae.id),title:"Delete"})]}):_?c.jsx(Ye,{icon:as,small:!0,variant:"danger",onClick:()=>pg(ae.id),title:"Delete"}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),c.jsx("td",{style:{padding:"10px 8px",textAlign:"center",backgroundColor:"#F0FDF4"},children:ae.invoiceGenerated&&ae.invoiceStatus==="Approved"&&_?c.jsxs("select",{value:ae.mailingSent||"No",onChange:rt=>rd(ae.id,"mailingSent",rt.target.value),style:{padding:"5px 8px",fontSize:"11px",fontWeight:"700",border:"2px solid",borderRadius:"6px",borderColor:ae.mailingSent==="Yes"?"#22C55E":"#E2E8F0",backgroundColor:ae.mailingSent==="Yes"?"#DCFCE7":"#FFFFFF",color:ae.mailingSent==="Yes"?"#166534":"#64748B",cursor:"pointer",width:"60px"},children:[c.jsx("option",{value:"No",children:"No"}),c.jsx("option",{value:"Yes",children:"Yes"})]}):ae.invoiceGenerated&&ae.invoiceStatus==="Approved"&&h?c.jsx("span",{style:{padding:"4px 8px",borderRadius:"6px",fontSize:"11px",fontWeight:"600",backgroundColor:ae.mailingSent==="Yes"?"#DCFCE7":"#FEF3C7",color:ae.mailingSent==="Yes"?"#166534":"#92400E"},children:ae.mailingSent==="Yes"?" Yes":" No"}):ae.invoiceGenerated&&ae.invoiceStatus!=="Approved"?c.jsx("span",{style:{fontSize:"10px",color:"#94A3B8"},children:"Approve first"}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),c.jsx("td",{style:{padding:"10px 8px",textAlign:"center",backgroundColor:"#F0FDF4"},children:ae.mailingSent==="Yes"?_?c.jsx("input",{type:"date",value:ae.mailDate||"",onChange:rt=>rd(ae.id,"mailDate",rt.target.value),style:{padding:"4px 6px",fontSize:"11px",border:"1px solid #D1D5DB",borderRadius:"4px",width:"110px"}}):c.jsx("span",{style:{fontSize:"11px"},children:ae.mailDate?At(ae.mailDate):"-"}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),c.jsx("td",{style:{padding:"10px 8px",textAlign:"center",backgroundColor:"#FEF3C7"},children:ae.invoiceGenerated&&ae.invoiceStatus==="Approved"?c.jsx("span",{style:{padding:"4px 10px",backgroundColor:Bt,color:Gt,borderRadius:"9999px",fontSize:"11px",fontWeight:"600"},children:it}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})})]},ae.id)})})]})})]},me)})}),L.length>0&&c.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"16px"},children:c.jsxs("div",{style:{backgroundColor:"#F0FDF4",padding:"16px 24px",borderRadius:"10px",border:"2px solid #86EFAC"},children:[c.jsx("div",{style:{fontSize:"12px",color:"#166534",fontWeight:"600",marginBottom:"4px"},children:"To Be Billed Total"}),c.jsx("div",{style:{fontSize:"18px",fontWeight:"700",color:"#059669"},children:at(L.filter(z=>z.toBeBilled==="Yes").reduce((z,b)=>z+(parseFloat(b.totalWithGst)||parseFloat(b.invoiceAmount)||0),0))})]})}),c.jsx(Un,{isOpen:V,onClose:()=>q(!1),title:" Add Service Entry",width:"600px",children:c.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[c.jsxs("div",{children:[c.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:"600",marginBottom:"4px"},children:"Date *"}),c.jsx("input",{type:"date",id:"svcDate",defaultValue:new Date().toISOString().split("T")[0],style:{width:"100%",padding:"8px",border:"1.5px solid #E2E8F0",borderRadius:"6px"}})]}),c.jsxs("div",{children:[c.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:"600",marginBottom:"4px"},children:"State *"}),c.jsx("input",{type:"text",id:"svcState",placeholder:"Maharashtra",style:{width:"100%",padding:"8px",border:"1.5px solid #E2E8F0",borderRadius:"6px"}})]})]}),c.jsxs("div",{children:[c.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:"600",marginBottom:"4px"},children:"Party Name *"}),c.jsx("input",{list:"svcPartyList",id:"svcParty",placeholder:"Party name",style:{width:"100%",padding:"8px",border:"1.5px solid #E2E8F0",borderRadius:"6px"}}),c.jsx("datalist",{id:"svcPartyList",children:Object.values(un).map((z,b)=>c.jsx("option",{value:z.partyName},b))})]}),c.jsxs("div",{children:[c.jsxs("label",{style:{display:"block",fontSize:"12px",fontWeight:"600",marginBottom:"4px"},children:["Type of Service * ",c.jsx("span",{style:{color:"#64748B",fontWeight:"400"},children:"(This will appear as narration in invoice)"})]}),c.jsx("input",{type:"text",id:"svcType",placeholder:"e.g. PODCAST PRODUCTION, VIDEO EDITING, SOCIAL MEDIA MANAGEMENT",style:{width:"100%",padding:"8px",border:"1.5px solid #E2E8F0",borderRadius:"6px",textTransform:"uppercase"}})]}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[c.jsxs("div",{children:[c.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:"600",marginBottom:"4px"},children:"Email"}),c.jsx("input",{type:"email",id:"svcEmail",placeholder:"email@example.com",style:{width:"100%",padding:"8px",border:"1.5px solid #E2E8F0",borderRadius:"6px"}})]}),c.jsxs("div",{children:[c.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:"600",marginBottom:"4px"},children:"Amount (without GST)"}),c.jsx("input",{type:"number",id:"svcAmount",placeholder:"0",style:{width:"100%",padding:"8px",border:"1.5px solid #E2E8F0",borderRadius:"6px"}})]})]}),c.jsxs("div",{style:{display:"flex",gap:"12px",marginTop:"8px"},children:[c.jsx(Ye,{label:"Cancel",variant:"secondary",onClick:()=>q(!1)}),c.jsx(Ye,{label:"Add Entry",icon:md,onClick:()=>{var oe,fe,me,qe,le,ae,te,Ae,Qe;const z=(fe=(oe=document.getElementById("svcParty"))==null?void 0:oe.value)==null?void 0:fe.trim(),b=(le=(qe=(me=document.getElementById("svcType"))==null?void 0:me.value)==null?void 0:qe.trim())==null?void 0:le.toUpperCase();if(!z||!b){alert("Fill required fields (Party Name and Type of Service)");return}const U={id:Date.now().toString(),sno:Yr.length+1,date:((ae=document.getElementById("svcDate"))==null?void 0:ae.value)||new Date().toISOString().split("T")[0],statePartyDetails:((te=document.getElementById("svcState"))==null?void 0:te.value)||"",partyName:z,serviceType:b,emailId:((Ae=document.getElementById("svcEmail"))==null?void 0:Ae.value)||"",additionalEmails:[],toBeBilled:"Not Yet",invoiceAmount:((Qe=document.getElementById("svcAmount"))==null?void 0:Qe.value)||"",cgst:"",sgst:"",igst:"",totalWithGst:"",invoiceType:"Individual",invoiceNo:"",invoiceDate:"",invoiceTotalAmount:"",invoiceGenerated:!1,invoiceStatus:"Pending",mailingSent:"No",mailDate:"",mailerUploaded:!1,editComments:"",approvalRemarks:"",isService:!0};Ce(Je=>[...Je,U]),he(Je=>new Set([...Je,z])),q(!1)}})]})]})})]})},U4=h=>{const _=[],W=b=>{if(!b)return"";const U=b.split("/");return U.length>=3?U.slice(1).join("/"):U.length===2?U.join("/"):U[U.length-1]},Z=Xn.filter(b=>{var U;return b.isHistorical&&(b.type==="creditnote"||((U=b.vchNo)==null?void 0:U.toUpperCase().startsWith("CN")))}),L=new Map;oi.forEach(b=>{const U=W(b.invoiceNo);U&&L.set(U,{...b,isSystemCN:!0})}),Z.forEach(b=>{const U=W(b.vchNo);U&&!L.has(U)&&L.set(U,{...b,isHistoricalCN:!0})});const se={};h.forEach(b=>{const U=b.partyName||"Unknown";se[U]||(se[U]=[]),se[U].push(b)}),Object.keys(se).sort().forEach(b=>{se[b].forEach(oe=>{const fe=W(oe.invoiceNo),me=L.get(fe),qe=me?Math.abs(parseFloat(me.totalAmount||me.credit||me.debit)||0):0,le=Xr.filter(st=>st.invoiceNo===oe.invoiceNo),ae=le.reduce((st,mt)=>st+(parseFloat(mt.amount)||0),0),te=le.reduce((st,mt)=>st+(parseFloat(mt.tds||mt.tdsAmount)||0),0),Ae=oe.totalAmount-ae-te-qe;let Qe="Pending";qe>=oe.totalAmount?Qe="Cancelled":Ae<=0?Qe="Paid":(ae>0||te>0||qe>0)&&(Qe="Partial");let Je=oe.poStatus==="With PO"?`${oe.poNumber||""}${oe.poDate?`
`+At(oe.poDate):""}`:"Without PO";_.push({"Client Code":oe.clientCode||"","Party Name":b,"Invoice No":oe.invoiceNo,Date:At(oe.date),Type:oe.isService?"Service":oe.invoiceType||"Individual","PO?":Je,Amount:oe.totalAmount,Received:ae||"",TDS:te||"","CN Amount":qe||"",Balance:Ae>0?Ae:0,"Invoice Status":oe.invoiceStatus,"Receipt Status":Qe,"Receipt No":le.map(st=>st.receiptNo).join(", "),"CN No":me?me.isSystemCN?me.creditNoteNo:me.vchNo:""})})});const M=kr.json_to_sheet(_),z=kr.book_new();kr.book_append_sheet(z,M,"Invoice Register"),Dc(z,`Invoice_Register_${new Date().toISOString().split("T")[0]}.xlsx`)},V4=()=>{const h=kr.book_new();let _=0;const W=new Set;d.forEach(se=>{se.clientCode&&W.add(se.partyNameUpper)});const Z=d.filter(se=>!se.clientCode&&W.has(se.partyNameUpper)?(console.log("Export: Skipping party without code:",se.partyName),!1):!0);console.log("Export: Processing",Z.length,"parties");const L=se=>{if(!se)return"";const M=se.split("/");return M.length>=3?M.slice(1).join("/"):M.length===2?M.join("/"):M[M.length-1]};if(Z.forEach(se=>{const M=se.partyName,z=se.normalizedState,b=se.clientCode||"",U=Yn[M]||0,oe=Ze=>b?(Ze.clientCode||zr(Ze.partyName,Ze.statePartyDetails))===b:!0,fe=[...Fn,...Yr].filter(Ze=>$t(Ze.partyName,M)&&Ze.invoiceGenerated&&Ze.invoiceStatus==="Approved"&&oe(Ze)&&(!z||qn(Ze.statePartyDetails)===z)),me=new Map;fe.forEach(Ze=>{me.has(Ze.invoiceNo)?me.get(Ze.invoiceNo).campaigns.push(Ze):me.set(Ze.invoiceNo,{invoiceNo:Ze.invoiceNo,invoiceDate:Ze.invoiceDate,campaigns:[Ze],statePartyDetails:Ze.statePartyDetails})});const qe=new Set(Array.from(me.keys())),le=Xr.filter(Ze=>$t(Ze.partyName,M)&&(!z||qe.has(Ze.invoiceNo))),ae=oi.filter(Ze=>$t(Ze.partyName,M)&&(!z||qe.has(Ze.invoiceNo))),te=z?[]:Xn.filter(Ze=>{var Ut;return $t(Ze.partyName,M)&&Ze.isHistorical&&!((Ut=Ze.vchNo)!=null&&Ut.toUpperCase().startsWith("CN"))}),Ae=z?[]:Xn.filter(Ze=>{var Ut;return $t(Ze.partyName,M)&&Ze.isHistorical&&((Ut=Ze.vchNo)==null?void 0:Ut.toUpperCase().startsWith("CN"))}),Qe=new Map;ae.forEach(Ze=>{const Ut=L(Ze.invoiceNo);Ut&&Qe.set(Ut,{...Ze,isSystemCN:!0})}),Ae.forEach(Ze=>{const Ut=L(Ze.vchNo);Ut&&!Qe.has(Ut)&&Qe.set(Ut,Ze)});const Je=[];let st=U,mt=0,lt=0,zt=0,Ue=0;const it=new Set;Je.push([b?`[${b}] ${M}`:M]),Je.push(["Ledger Account"]),se.address&&Je.push([se.address]),se.state&&Je.push([se.state]),se.gstin&&Je.push(["GSTIN: "+se.gstin]),Je.push([]),Je.push(["Date","Particular","Vch Type","Vch No.","Debit","Credit","Date of Receipt","Amount Received","TDS Received","Balance","Payment Status"]),U!==0&&(Je.push(["","Opening Balance","","",U>0?U:"",U<0?Math.abs(U):"","","","",U,""]),U>0?mt+=U:lt+=Math.abs(U));const Bt=[];if(Array.from(me.values()).forEach(Ze=>{Bt.push({...Ze,entryType:"invoice",sortDate:Ze.invoiceDate})}),te.forEach(Ze=>{Bt.push({...Ze,entryType:"historical",sortDate:Ze.date})}),Bt.sort((Ze,Ut)=>new Date(Ze.sortDate)-new Date(Ut.sortDate)),Bt.forEach(Ze=>{var Ut;if(Ze.entryType==="invoice"){const et=Ze,jt=et.campaigns.reduce((or,dn)=>or+(parseFloat(dn.invoiceAmount)||0),0),Ft=(Ut=et.statePartyDetails)==null?void 0:Ut.toUpperCase().includes("MAHARASHTRA"),vt=Ft?jt*.09:0,Jt=Ft?jt*.09:0,fr=Ft?0:jt*.18,hr=jt+vt+Jt+fr,nn=le.filter(or=>or.invoiceNo===et.invoiceNo),ft=nn.reduce((or,dn)=>or+(parseFloat(dn.amount)||0),0),ar=nn.reduce((or,dn)=>or+(parseFloat(dn.tds||dn.tdsAmount)||0),0),Dt=nn.length>0?At(nn[0].date):"",Wr=L(et.invoiceNo),xr=Qe.get(Wr),br=xr?Math.abs(parseFloat(xr.totalAmount||xr.credit)||0):0,vn=!!xr;let pr="Pending",yn=hr-ft-ar;if(vn&&br>=hr?(pr="CN Closed",yn=0):(ft>0||ar>0)&&(pr="Received"),st+=hr,mt+=hr,Je.push([At(et.invoiceDate),M,"Sales",et.invoiceNo,hr,"",Dt,ft||"",ar||"",vn?"-":yn,pr]),Je.push(["","    PROMOTIONAL TRADE EMAILER"+(et.campaigns.length>1?"S":""),"","","",jt,"","","","",""]),Ft?(Je.push(["","    CGST","","","",vt,"","","","",""]),Je.push(["","    SGST","","","",Jt,"","","","",""])):Je.push(["","    IGST","","","",fr,"","","","",""]),(ft>0||ar>0)&&(st-=ft+ar,zt+=ft,Ue+=ar),xr&&!it.has(Wr)){it.add(Wr),st-=br,lt+=br,Je.push([At(xr.date),M,"Credit Note",xr.creditNoteNo||xr.vchNo,"",br,"","","","-",""]);const or=br/1.18,dn=br-or;Je.push(["","    PROMOTIONAL TRADE EMAILER","","","",or,"","","","",""]),Ft?Je.push(["","    CGST/SGST","","","",dn,"","","","",""]):Je.push(["","    IGST","","","",dn,"","","","",""])}}else if(Ze.entryType==="historical"){const et=Ze,jt=parseFloat(et.debit)||0,Ft=L(et.vchNo),vt=Qe.get(Ft),Jt=!!vt;if(st+=jt,mt+=jt,Je.push([At(et.date),et.particular||M,et.vchType||"Sales",et.vchNo||"",jt,"",et.receiptDate?At(et.receiptDate):"",et.amountReceived||"",et.tdsReceived||"",Jt?"-":st,Jt?"CN Closed":et.paymentStatus||""]),vt&&!it.has(Ft)){it.add(Ft);const fr=Math.abs(parseFloat(vt.totalAmount||vt.credit||vt.debit)||0);st-=fr,lt+=fr,Je.push([At(vt.date),M,"Credit Note",vt.creditNoteNo||vt.vchNo,"",fr,"","","","-",""])}}}),Je.length<=7)return;Je.push([]),Je.push(["","TOTAL","","",mt,lt,"",zt,Ue,"",""]),Je.push(["","Closing Balance","","",st>0?st:"",st<0?Math.abs(st):"","","","",st,""]);let Gt=M.substring(0,25).replace(/[\\\/\*\?\[\]:]/g,"");z&&(Gt+="-"+z.substring(0,4));let rt=Gt,K=1;for(;h.SheetNames.includes(rt);)rt=Gt.substring(0,27)+K++;const Ve=kr.aoa_to_sheet(Je);kr.book_append_sheet(h,Ve,rt),_++}),_===0){alert("No ledger data to export");return}Dc(h,`All_Ledgers_${new Date().toISOString().split("T")[0]}.xlsx`)},z4=()=>{const h=M=>{const z=parseFloat(M.totalAmount)||0;let b=parseFloat(M.baseAmount)||parseFloat(M.amount)||0,U=parseFloat(M.gst)||(parseFloat(M.cgstAmount)||0)+(parseFloat(M.sgstAmount)||0)+(parseFloat(M.igstAmount)||0);return b===0&&z>0&&(b=z/1.18,U=z-b),{base:b,gst:U,total:z}},_=Xr.map(M=>{const z=parseFloat(M.amount)||0,b=parseFloat(M.tds)||parseFloat(M.tdsAmount)||0;return{Type:"Receipt","Client Code":M.clientCode||zr(M.partyName,M.statePartyDetails||""),"Voucher No":M.receiptNo,Date:At(M.date),"Party Name":M.partyName,"Against Invoice":M.invoiceNo,Amount:z,TDS:b,Total:z+b,"Payment Mode":M.paymentMode||M.mode||"Bank Transfer",Narration:M.narration||""}}),W=oi.map(M=>{const z=h(M);return{Type:"Credit Note","Client Code":M.clientCode||zr(M.partyName,M.statePartyDetails||""),"Voucher No":M.creditNoteNo,Date:At(M.date),"Party Name":M.partyName,"Against Invoice":M.invoiceNo,"Base Amount":z.base,GST:z.gst,Total:z.total,Reason:M.reason||""}}),Z=kr.book_new();if(_.length>0){const M=kr.json_to_sheet(_);kr.book_append_sheet(Z,M,"Receipts")}if(W.length>0){const M=kr.json_to_sheet(W);kr.book_append_sheet(Z,M,"Credit Notes")}const L=[..._.map(M=>({...M,"Base Amount":"",GST:"",Reason:""})),...W.map(M=>({Type:M.Type,"Client Code":M["Client Code"],"Voucher No":M["Voucher No"],Date:M.Date,"Party Name":M["Party Name"],"Against Invoice":M["Against Invoice"],Amount:M["Base Amount"],TDS:M.GST,Total:M.Total,"Payment Mode":"",Narration:M.Reason}))],se=kr.json_to_sheet(L);kr.book_append_sheet(Z,se,"Combined"),Dc(Z,`Receipt_CN_Register_${new Date().toISOString().split("T")[0]}.xlsx`)},W4=h=>{const _=parseFloat(h.amount)||0,W=parseFloat(h.tds)||parseFloat(h.tdsAmount)||0,Z=_+W,L=h.clientCode||zr(h.partyName,h.statePartyDetails||""),se=`<!DOCTYPE html><html><head><title>Receipt - ${h.receiptNo}</title><style>@media print{@page{size:A5;margin:10mm}}*{margin:0;padding:0;box-sizing:border-box}body{font-family:Arial,sans-serif;font-size:12px;padding:20px}.voucher{max-width:600px;margin:0 auto;border:2px solid #000}.header{text-align:center;padding:15px;border-bottom:2px solid #000;background:#f5f5f5}.title{font-size:18px;font-weight:bold;color:#1a5276}.company{font-size:14px;font-weight:bold;margin-top:5px}.details{padding:15px}.row{display:flex;margin-bottom:10px}.label{width:140px;font-weight:bold}.value{flex:1}.amount-box{background:#e8f4fd;padding:15px;margin:15px 0;border-radius:8px;text-align:center}.amount{font-size:24px;font-weight:bold;color:#1a5276}.footer{padding:15px;border-top:1px solid #ddd;display:flex;justify-content:space-between}.signature{text-align:center;margin-top:40px}.signature-line{border-top:1px solid #000;width:150px;margin:0 auto;padding-top:5px}.client-code{background:#f3e8ff;color:#6b21a8;padding:3px 8px;border-radius:4px;font-weight:bold;font-size:11px}</style></head><body><div class="voucher"><div class="header"><div class="title">RECEIPT VOUCHER</div><div class="company">${T.name}</div><div style="font-size:10px;color:#666;margin-top:3px">${T.address}, ${T.city}</div></div><div class="details"><div class="row"><div class="label">Receipt No:</div><div class="value" style="font-weight:bold;color:#1a5276">${h.receiptNo}</div></div><div class="row"><div class="label">Date:</div><div class="value">${At(h.date)}</div></div>${L?`<div class="row"><div class="label">Client Code:</div><div class="value"><span class="client-code">${L}</span></div></div>`:""}<div class="row"><div class="label">Received From:</div><div class="value" style="font-weight:bold">${h.partyName}</div></div><div class="row"><div class="label">Against Invoice:</div><div class="value">${h.invoiceNo}</div></div><div class="row"><div class="label">Payment Mode:</div><div class="value">${h.paymentMode||h.mode||"Bank Transfer"}</div></div>${h.narration?`<div class="row"><div class="label">Narration:</div><div class="value">${h.narration}</div></div>`:""}<div class="amount-box"><div style="font-size:12px;color:#666">Amount Received</div><div class="amount">${_.toLocaleString("en-IN",{minimumFractionDigits:2})}</div>${W>0?`<div style="font-size:11px;color:#666;margin-top:5px">TDS: ${W.toLocaleString("en-IN",{minimumFractionDigits:2})}</div>`:""}<div style="font-size:11px;margin-top:8px"><strong>Total:</strong> ${Z.toLocaleString("en-IN",{minimumFractionDigits:2})}</div></div><div style="font-size:11px;color:#666;margin-top:10px"><strong>Amount in words:</strong> ${xm(Z)}</div></div><div class="footer"><div class="signature"><div class="signature-line">Receiver's Signature</div></div><div class="signature"><div class="signature-line">Authorised Signatory</div></div></div></div></body></html>`,M=window.open("","_blank");M.document.write(se),M.document.close(),M.print()},H4=h=>{const _=parseFloat(h.totalAmount)||0;let W=parseFloat(h.baseAmount)||parseFloat(h.amount)||0,Z=parseFloat(h.gst)||(parseFloat(h.cgstAmount)||0)+(parseFloat(h.sgstAmount)||0)+(parseFloat(h.igstAmount)||0);W===0&&_>0&&(W=_/1.18,Z=_-W);const L=h.clientCode||zr(h.partyName,h.statePartyDetails||""),se=`<!DOCTYPE html><html><head><title>CN - ${h.creditNoteNo}</title><style>@media print{@page{size:A5;margin:10mm}}*{margin:0;padding:0;box-sizing:border-box}body{font-family:Arial,sans-serif;font-size:12px;padding:20px}.voucher{max-width:600px;margin:0 auto;border:2px solid #000}.header{text-align:center;padding:15px;border-bottom:2px solid #000;background:#fef3c7}.title{font-size:18px;font-weight:bold;color:#92400e}.company{font-size:14px;font-weight:bold;margin-top:5px}.details{padding:15px}.row{display:flex;margin-bottom:10px}.label{width:140px;font-weight:bold}.value{flex:1}.amount-box{background:#fef3c7;padding:15px;margin:15px 0;border-radius:8px;text-align:center}.amount{font-size:24px;font-weight:bold;color:#92400e}.footer{padding:15px;border-top:1px solid #ddd;display:flex;justify-content:space-between}.signature{text-align:center;margin-top:40px}.signature-line{border-top:1px solid #000;width:150px;margin:0 auto;padding-top:5px}.client-code{background:#f3e8ff;color:#6b21a8;padding:3px 8px;border-radius:4px;font-weight:bold;font-size:11px}</style></head><body><div class="voucher"><div class="header"><div class="title">CREDIT NOTE</div><div class="company">${T.name}</div><div style="font-size:10px;color:#666;margin-top:3px">${T.address}, ${T.city}</div></div><div class="details"><div class="row"><div class="label">Credit Note No:</div><div class="value" style="font-weight:bold;color:#92400e">${h.creditNoteNo}</div></div><div class="row"><div class="label">Date:</div><div class="value">${At(h.date)}</div></div>${L?`<div class="row"><div class="label">Client Code:</div><div class="value"><span class="client-code">${L}</span></div></div>`:""}<div class="row"><div class="label">Party Name:</div><div class="value" style="font-weight:bold">${h.partyName}</div></div><div class="row"><div class="label">Against Invoice:</div><div class="value">${h.invoiceNo}</div></div><div class="row"><div class="label">Reason:</div><div class="value">${h.reason||"Adjustment"}</div></div><div class="amount-box"><div style="font-size:12px;color:#666">Credit Amount</div><div class="amount">${_.toLocaleString("en-IN",{minimumFractionDigits:2})}</div><div style="font-size:10px;color:#666;margin-top:5px">Base: ${W.toLocaleString("en-IN",{minimumFractionDigits:2})} | GST: ${Z.toLocaleString("en-IN",{minimumFractionDigits:2})}</div></div><div style="font-size:11px;color:#666;margin-top:10px"><strong>Amount in words:</strong> ${xm(_)}</div></div><div class="footer"><div class="signature"><div class="signature-line">Party Signature</div></div><div class="signature"><div class="signature-line">Authorised Signatory</div></div></div></div></body></html>`,M=window.open("","_blank");M.document.write(se),M.document.close(),M.print()},$4=()=>{const h=new Map;Fn.filter(U=>U.invoiceGenerated).forEach(U=>{if(h.has(U.invoiceNo))h.get(U.invoiceNo).campaigns.push(U);else{const oe=U.clientCode||zr(U.partyName,U.statePartyDetails);h.set(U.invoiceNo,{invoiceNo:U.invoiceNo,partyName:U.partyName,clientCode:oe,statePartyDetails:U.statePartyDetails,date:U.invoiceDate,invoiceType:U.invoiceType,combinationCode:U.combinationCode,invoiceStatus:U.invoiceStatus,mailingSent:U.mailingSent,receiptStatus:U.receiptStatus||"Pending",receiptNo:U.receiptNo,campaigns:[U],totalAmount:parseFloat(U.invoiceTotalAmount)||0,isFromMaster:!0,source:"Campaign",poStatus:U.poStatus,poNumber:U.poNumber,poDate:U.poDate})}}),Yr.filter(U=>U.invoiceGenerated).forEach(U=>{if(!h.has(U.invoiceNo)){const oe=U.clientCode||zr(U.partyName,U.statePartyDetails);h.set(U.invoiceNo,{invoiceNo:U.invoiceNo,partyName:U.partyName,clientCode:oe,statePartyDetails:U.statePartyDetails,date:U.invoiceDate,invoiceType:"Service",combinationCode:"NA",invoiceStatus:U.invoiceStatus,mailingSent:U.mailingSent,receiptStatus:U.receiptStatus||"Pending",receiptNo:U.receiptNo,campaigns:[U],totalAmount:parseFloat(U.invoiceTotalAmount)||0,isFromMaster:!1,isService:!0,source:"Service",serviceType:U.serviceType,poStatus:U.poStatus,poNumber:U.poNumber,poDate:U.poDate})}});const _=U=>{if(!U)return"";const oe=U.split("/");return oe.length>=3?oe.slice(1).join("/"):oe.length===2?oe.join("/"):oe[oe.length-1]},W=Xn.filter(U=>{var oe;return U.isHistorical&&(U.type==="creditnote"||((oe=U.vchNo)==null?void 0:oe.toUpperCase().startsWith("CN")))}),Z=new Map;oi.forEach(U=>{const oe=_(U.invoiceNo);oe&&Z.set(oe,U)}),W.forEach(U=>{const oe=_(U.vchNo);oe&&!Z.has(oe)&&Z.set(oe,U)}),Xn.filter(U=>{var oe;return U.isHistorical&&U.type!=="creditnote"&&!((oe=U.vchNo)!=null&&oe.toUpperCase().startsWith("CN"))&&U.debit>0}).forEach(U=>{if(!h.has(U.vchNo)){const oe=Xr.find(Qe=>Qe.invoiceNo===U.vchNo),fe=_(U.vchNo),me=Z.get(fe),qe=me?Math.abs(parseFloat(me.totalAmount)||parseFloat(me.credit)||parseFloat(me.debit)||0):0,le=parseFloat(U.debit)||0;if(me&&qe>=le)return;const te=!oe&&!(U.amountReceived>0),Ae=me&&qe>0&&qe<le;if(te||Ae){const Qe=Ae?le-qe:le;h.set(U.vchNo,{invoiceNo:U.vchNo,partyName:U.partyName,date:U.date,invoiceType:"Historical",combinationCode:"",invoiceStatus:"Approved",mailingSent:"Yes",receiptStatus:Ae?"Partial CN":"Pending",receiptNo:"",campaigns:[],totalAmount:le,pendingAmount:Qe,hasPartialCN:Ae,cnAmount:qe,isHistorical:!0,historicalEntry:U})}}});let L=Array.from(h.values());if(je.party&&(L=L.filter(U=>$t(U.partyName,je.party))),je.invoiceStatus&&(L=L.filter(U=>U.invoiceStatus===je.invoiceStatus)),je.receiptStatus&&(je.receiptStatus==="Received"?L=L.filter(U=>U.receiptStatus==="Received"):je.receiptStatus==="Pending"&&(L=L.filter(U=>U.receiptStatus!=="Received"))),je.invoiceType&&(L=L.filter(U=>U.invoiceType===je.invoiceType)),je.searchText){const U=je.searchText.toLowerCase();L=L.filter(oe=>{var fe,me;return((fe=oe.invoiceNo)==null?void 0:fe.toLowerCase().includes(U))||((me=oe.partyName)==null?void 0:me.toLowerCase().includes(U))})}const se={};L.forEach(U=>{const oe=U.clientCode||"",fe=`${U.partyName}|||${oe}`;se[fe]||(se[fe]={partyName:U.partyName,clientCode:oe,invoices:[]}),se[fe].invoices.push(U)});const M=Object.values(se).sort((U,oe)=>{const fe=U.partyName.localeCompare(oe.partyName);return fe!==0?fe:(U.clientCode||"").localeCompare(oe.clientCode||"")}),z=je.party||je.invoiceStatus||je.receiptStatus||je.invoiceType||je.searchText,b=Array.from(h.values());return c.jsxs("div",{children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[c.jsx("h1",{style:{margin:0,fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:" Invoice & Receipt Register"}),c.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[c.jsx(Ye,{icon:Po,label:"Export Excel",variant:"secondary",onClick:()=>U4(L)}),li&&c.jsx("span",{style:{padding:"8px 16px",backgroundColor:"#FEF3C7",borderRadius:"8px",fontSize:"13px",color:"#92400E",fontWeight:"600"},children:" View Only"})]})]}),c.jsx("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"10px",border:"1px solid #E2E8F0",padding:"14px 18px",marginBottom:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"14px",flexWrap:"wrap"},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[c.jsx(gd,{size:18,color:"#64748B"}),c.jsx("span",{style:{fontSize:"13px",fontWeight:"700",color:"#475569"},children:"Filters:"})]}),c.jsxs("div",{style:{position:"relative"},children:[c.jsx(Q0,{size:14,style:{position:"absolute",left:"10px",top:"50%",transform:"translateY(-50%)",color:"#94A3B8"}}),c.jsx("input",{type:"text",placeholder:"Search invoice...",value:je.searchText,onChange:U=>Pe(oe=>({...oe,searchText:U.target.value})),style:{padding:"8px 12px 8px 32px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",width:"160px"}})]}),c.jsxs("select",{value:je.party,onChange:U=>Pe(oe=>({...oe,party:U.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:"#FFFFFF"},children:[c.jsx("option",{value:"",children:"All Parties"}),Gs.map(U=>c.jsx("option",{value:U,children:U},U))]}),c.jsxs("select",{value:je.invoiceStatus,onChange:U=>Pe(oe=>({...oe,invoiceStatus:U.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:"#FFFFFF"},children:[c.jsx("option",{value:"",children:"All Status"}),c.jsx("option",{value:"Created",children:"Created"}),c.jsx("option",{value:"Approved",children:"Approved"}),c.jsx("option",{value:"Need Edits",children:"Need Edits"})]}),c.jsxs("select",{value:je.receiptStatus,onChange:U=>Pe(oe=>({...oe,receiptStatus:U.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:"#FFFFFF"},children:[c.jsx("option",{value:"",children:"All Receipts"}),c.jsx("option",{value:"Received",children:"Received"}),c.jsx("option",{value:"Pending",children:"Pending"})]}),c.jsxs("select",{value:je.invoiceType,onChange:U=>Pe(oe=>({...oe,invoiceType:U.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:"#FFFFFF"},children:[c.jsx("option",{value:"",children:"All Types"}),c.jsx("option",{value:"Individual",children:"Individual"}),c.jsx("option",{value:"Combined",children:"Combined"})]}),z&&c.jsxs(c.Fragment,{children:[c.jsxs("button",{onClick:()=>Pe({party:"",invoiceStatus:"",receiptStatus:"",invoiceType:"",searchText:""}),style:{padding:"8px 12px",fontSize:"13px",fontWeight:"600",border:"1.5px solid #FCA5A5",borderRadius:"8px",backgroundColor:"#FEE2E2",color:"#991B1B",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},children:[c.jsx(Ta,{size:14})," Clear"]}),c.jsxs("span",{style:{fontSize:"13px",color:"#64748B"},children:["Showing ",L.length," of ",b.length]})]})]})}),c.jsx(En,{noPadding:!0,children:c.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"12px"},children:[c.jsx("thead",{children:c.jsxs("tr",{style:{backgroundColor:"#F8FAFC",borderBottom:"2px solid #E2E8F0"},children:[c.jsx("th",{style:{padding:"10px 12px",textAlign:"left",fontWeight:"700"},children:"Invoice No"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700",color:"#6B21A8",backgroundColor:"#FAF5FF"},children:"Code"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"left",fontWeight:"700"},children:"Date"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Type"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700"},children:"Amount"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700",backgroundColor:"#F0FDF4",color:"#166534"},children:"Received"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700",backgroundColor:"#FEF3C7",color:"#92400E"},children:"TDS"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700",backgroundColor:"#FEE2E2",color:"#991B1B"},children:"CN Amt"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700",backgroundColor:"#EFF6FF",color:"#1E40AF"},children:"Balance"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Inv. Status"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Receipt No."}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"CN No."}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Actions"})]})}),c.jsx("tbody",{children:M.length===0?c.jsx("tr",{children:c.jsx("td",{colSpan:"13",style:{padding:"50px",textAlign:"center",color:"#94A3B8"},children:z?"No matching invoices":"No invoices generated yet"})}):M.map((U,oe)=>{const{partyName:fe,clientCode:me,invoices:qe}=U,le=`${fe}|||${me}`,ae=u0.has(le);let te=0;return qe.forEach(Ae=>{const Qe=Me.find(rt=>rt.invoiceNo===Ae.invoiceNo),Je=re.find(rt=>rt.invoiceNo===Ae.invoiceNo),st=ie.find(rt=>rt.invoiceNo===Ae.invoiceNo&&rt.type==="tds"),mt=ie.find(rt=>rt.invoiceNo===Ae.invoiceNo&&rt.type==="discount"),lt=Ae.totalAmount||0,zt=Qe&&parseFloat(Qe.amount)||0,Ue=st?parseFloat(st.credit)||0:Qe&&parseFloat(Qe.tds)||0,it=Je?Math.abs(parseFloat(Je.totalAmount)||0):0,Bt=mt&&parseFloat(mt.credit)||0,Gt=Math.max(0,lt-zt-Ue-it-Bt);te+=Gt}),c.jsxs(ah.Fragment,{children:[c.jsxs("tr",{onClick:()=>ky(le),style:{backgroundColor:"#1E3A5F",color:"white",cursor:"pointer",borderBottom:"1px solid #0F2744"},children:[c.jsx("td",{colSpan:"4",style:{padding:"10px 12px",fontWeight:"700",fontSize:"13px"},children:c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[ae?c.jsx(rm,{size:18}):c.jsx(K0,{size:18}),c.jsx(oE,{size:16}),fe,me&&c.jsx("span",{style:{backgroundColor:"#9333EA",padding:"2px 8px",borderRadius:"6px",fontSize:"11px"},children:me}),c.jsxs("span",{style:{backgroundColor:"#2874A6",padding:"2px 10px",borderRadius:"12px",fontSize:"11px",fontWeight:"600"},children:[qe.length," inv"]})]})}),c.jsx("td",{colSpan:"4",style:{padding:"10px 12px"}}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700",fontSize:"13px",backgroundColor:te===0?"#22C55E":"#3B82F6"},children:te===0?" Nil":`Bal: ${at(te)}`}),c.jsx("td",{colSpan:"4",style:{padding:"10px 12px"}})]}),ae&&qe.map(Ae=>{const Qe=Me.find(K=>K.invoiceNo===Ae.invoiceNo),Je=re.find(K=>K.invoiceNo===Ae.invoiceNo),st=ie.find(K=>K.invoiceNo===Ae.invoiceNo&&K.type==="tds"),mt=ie.find(K=>K.invoiceNo===Ae.invoiceNo&&K.type==="discount"),lt=Ae.totalAmount||0,zt=Qe&&parseFloat(Qe.amount)||0,Ue=st?parseFloat(st.credit)||0:Qe&&parseFloat(Qe.tds)||0,it=Je?Math.abs(parseFloat(Je.totalAmount)||0):0,Bt=mt&&parseFloat(mt.credit)||0,Gt=Math.max(0,lt-zt-Ue-it-Bt),rt=it>=lt&&!Qe;return c.jsxs("tr",{style:{borderBottom:"1px solid #F1F5F9",backgroundColor:Ae.invoiceType==="Combined"?"#FAF5FF":Gt===0?"#F0FDF4":"transparent"},children:[c.jsx("td",{style:{padding:"10px 12px 10px 36px",fontWeight:"700",color:Ae.invoiceType==="Combined"?"#7C3AED":"#2874A6"},children:Ae.invoiceNo}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"center",backgroundColor:"#FAF5FF"},children:c.jsx("span",{style:{fontWeight:"700",color:"#6B21A8",fontSize:"11px"},children:Ae.clientCode||"-"})}),c.jsx("td",{style:{padding:"10px 12px"},children:At(Ae.date)}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:c.jsx(vm,{status:Ae.invoiceType,small:!0})}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700"},children:at(lt)}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"600",backgroundColor:"#F0FDF4",color:zt>0?"#166534":"#94A3B8"},children:zt>0?at(zt):"-"}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"600",backgroundColor:"#FEF3C7",color:Ue>0?"#92400E":"#94A3B8"},children:Ue>0?at(Ue):"-"}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"600",backgroundColor:"#FEE2E2",color:it>0?"#991B1B":"#94A3B8"},children:it>0?at(it):"-"}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700",backgroundColor:"#EFF6FF",color:Gt>0?"#1E40AF":"#166534"},children:Gt===0?" Nil":at(Gt)}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:c.jsx(vm,{status:Ae.invoiceStatus,small:!0})}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:rt?c.jsx("span",{style:{padding:"4px 10px",borderRadius:"12px",fontSize:"11px",fontWeight:"700",backgroundColor:"#FEE2E2",color:"#991B1B"},children:" Cancelled"}):Qe?c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px",justifyContent:"center"},children:[c.jsxs("button",{onClick:()=>x4(Qe),style:{padding:"4px 8px",borderRadius:"12px",fontSize:"10px",fontWeight:"700",backgroundColor:"#DCFCE7",color:"#166534",border:"none",cursor:"pointer",textDecoration:"underline"},title:"Click to view receipt",children:[" ",Qe.receiptNo]}),Cr&&c.jsx("button",{onClick:()=>r4(Qe),style:{padding:"2px 4px",borderRadius:"4px",fontSize:"10px",backgroundColor:"#FEE2E2",color:"#991B1B",border:"none",cursor:"pointer"},title:"Delete Receipt",children:""})]}):c.jsx("span",{style:{padding:"4px 10px",borderRadius:"12px",fontSize:"11px",fontWeight:"600",backgroundColor:"#FEF3C7",color:"#92400E"},children:" Pending"})}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:Je?c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px",justifyContent:"center"},children:[c.jsx("button",{onClick:()=>v4(Je),style:{padding:"4px 8px",borderRadius:"12px",fontSize:"10px",fontWeight:"700",backgroundColor:"#FEE2E2",color:"#991B1B",border:"none",cursor:"pointer",textDecoration:"underline"},title:"Click to view credit note",children:Je.creditNoteNo}),Cr&&c.jsx("button",{onClick:()=>n4(Je),style:{padding:"2px 4px",borderRadius:"4px",fontSize:"10px",backgroundColor:"#FEE2E2",color:"#991B1B",border:"none",cursor:"pointer"},title:"Delete Credit Note",children:""})]}):c.jsx("span",{style:{color:"#94A3B8",fontSize:"11px"},children:"-"})}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:c.jsx("div",{style:{display:"flex",gap:"4px",justifyContent:"center",flexWrap:"wrap"},children:Ae.isHistorical?c.jsxs(c.Fragment,{children:[Cr&&!Qe&&c.jsx(Ye,{icon:Oo,small:!0,variant:"success",onClick:()=>{const K={invoiceNo:Ae.invoiceNo,partyName:Ae.partyName,invoiceDate:Ae.date,invoiceTotalAmount:Ae.totalAmount,invoiceStatus:"Approved",mailingSent:"Yes",invoiceType:"Historical",isHistorical:!0};Hi(K)},title:"Create Receipt"}),Cr&&!Je&&c.jsx(Ye,{icon:pd,small:!0,variant:"primary",onClick:()=>{const K={invoiceNo:Ae.invoiceNo,partyName:Ae.partyName,invoiceDate:Ae.date,invoiceTotalAmount:Ae.totalAmount,invoiceStatus:"Approved",isHistorical:!0};kc(K)},title:"Credit Note"})]}):c.jsxs(c.Fragment,{children:[c.jsx(Ye,{icon:Pc,small:!0,variant:"brand",onClick:()=>{Ae.isService||Ae.invoiceType==="Service"?nd(Ae.campaigns[0]):td(Ae.campaigns[0])},title:"View Invoice"}),Cr&&Ae.invoiceStatus==="Approved"&&Ae.mailingSent==="Yes"&&!Qe&&c.jsx(Ye,{icon:Oo,small:!0,variant:"success",onClick:()=>Hi(Ae.campaigns[0]),title:"Create Receipt"}),Cr&&Ae.invoiceStatus==="Approved"&&!Je&&c.jsx(Ye,{icon:pd,small:!0,variant:"primary",onClick:()=>kc(Ae.campaigns[0]),title:"Credit Note"}),Cr&&c.jsx(Ye,{icon:as,small:!0,variant:"danger",onClick:()=>hg(Ae.campaigns[0]),title:"Delete Invoice"})]})})})]},Ae.invoiceNo)})]},le)})})]})})]})},G4=()=>{if(!X){alert("Please select a party first");return}const h=Yn[X]||0,_=K=>Ne?(K.clientCode||zr(K.partyName,K.statePartyDetails))===Ne:!0,W=Se.filter(K=>$t(K.partyName,X)&&K.invoiceGenerated&&K.invoiceStatus==="Approved"&&_(K)&&(!Te||qn(K.statePartyDetails)===Te)),Z=ke.filter(K=>$t(K.partyName,X)&&K.invoiceGenerated&&K.invoiceStatus==="Approved"&&_(K)&&(!Te||qn(K.statePartyDetails)===Te)),L=new Map;W.forEach(K=>{L.has(K.invoiceNo)?L.get(K.invoiceNo).campaigns.push(K):L.set(K.invoiceNo,{invoiceNo:K.invoiceNo,invoiceDate:K.invoiceDate,campaigns:[K],isFromMaster:!0})}),Z.forEach(K=>{L.has(K.invoiceNo)||L.set(K.invoiceNo,{invoiceNo:K.invoiceNo,invoiceDate:K.invoiceDate,campaigns:[K],isFromMaster:!1,isService:!0,serviceType:K.serviceType})});const se=new Set(Array.from(L.keys())),M=Te?[]:ie.filter(K=>{var Ve;return $t(K.partyName,X)&&K.isHistorical&&K.type!=="creditnote"&&!((Ve=K.vchNo)!=null&&Ve.toUpperCase().startsWith("CN"))}),z=Te?[]:ie.filter(K=>{var Ve;return $t(K.partyName,X)&&K.isHistorical&&(K.type==="creditnote"||((Ve=K.vchNo)==null?void 0:Ve.toUpperCase().startsWith("CN")))}),b=Me.filter(K=>$t(K.partyName,X)&&(!Te||se.has(K.invoiceNo))),U=re.filter(K=>$t(K.partyName,X)&&(!Te||se.has(K.invoiceNo))),oe=K=>{if(!K)return"";const Ve=K.split("/");return Ve.length>=3?Ve.slice(1).join("/"):Ve.length===2?Ve.join("/"):Ve[Ve.length-1]},fe=new Map;U.forEach(K=>{const Ve=oe(K.invoiceNo);Ve&&!fe.has(Ve)&&fe.set(Ve,{...K,isSystemCN:!0})}),z.forEach(K=>{const Ve=oe(K.vchNo);Ve&&!fe.has(Ve)&&fe.set(Ve,{...K,isHistoricalCN:!0})});let me=[],qe=0,le=0,ae=0,te=0,Ae=h;const Qe=new Set;h!==0&&(qe+=h>0?h:0,le+=h<0?Math.abs(h):0,me.push({date:"",particular:"Opening Balance",vchType:"",vchNo:"",debit:h>0?h:0,credit:h<0?Math.abs(h):0,receiptDate:"",amountReceived:0,tds:0,balance:h,status:"",isMain:!0,isOpening:!0}));const Je=[];Array.from(L.values()).filter(K=>{const Ve=new Date(K.invoiceDate);return Ve>=new Date(kn.fromDate)&&Ve<=new Date(kn.toDate)}).forEach(K=>{Je.push({...K,entryType:"invoice",sortDate:K.invoiceDate})}),M.filter(K=>{if(!K.date)return!1;const Ve=new Date(K.date);return Ve>=new Date(kn.fromDate)&&Ve<=new Date(kn.toDate)}).forEach(K=>{Je.push({...K,entryType:"invoice",sortDate:K.date})}),Je.sort((K,Ve)=>new Date(K.sortDate)-new Date(Ve.sortDate)),Je.forEach(K=>{var Ve,Ze,Ut;if(K.isFromMaster){const et=K;let jt=0;et.campaigns.forEach(pr=>jt+=parseFloat(pr.invoiceAmount)||0);const Ft=(Ze=(Ve=et.campaigns[0])==null?void 0:Ve.statePartyDetails)==null?void 0:Ze.toUpperCase().includes("MAHARASHTRA"),vt=Ft?jt*.09:0,Jt=Ft?jt*.09:0,fr=Ft?0:jt*.18,hr=jt+vt+Jt+fr,nn=oe(et.invoiceNo),ft=fe.get(nn),ar=!!ft,Dt=b.find(pr=>pr.invoiceNo===et.invoiceNo);Ae+=hr,qe+=hr;let Wr=0,xr=0,br="",vn=ar?"":"Pending";if(Dt&&(vn="Received",Wr=Dt.amount||0,xr=Dt.tds||0,br=Dt.date,ae+=Wr,te+=xr,Ae-=Wr+xr+(Dt.discount||0)),me.push({date:et.invoiceDate,particular:X,vchType:"Sales",vchNo:et.invoiceNo,debit:hr,credit:0,receiptDate:br,amountReceived:Wr,tds:xr,balance:ar?"-":vn==="Received"?0:hr-Wr-xr,status:vn,isMain:!0,hasCN:ar}),me.push({particular:"PROMOTIONAL TRADE EMAILER"+(et.campaigns.length>1?"S":""),credit:jt,isMain:!1,hasCN:ar}),Ft?(me.push({particular:"CGST",credit:vt,isMain:!1,hasCN:ar}),me.push({particular:"SGST",credit:Jt,isMain:!1,hasCN:ar})):me.push({particular:"IGST",credit:fr,isMain:!1,hasCN:ar}),ft&&!Qe.has(nn)){Qe.add(nn);const pr=Math.abs(ft.totalAmount||ft.credit||0);Ae-=pr,le+=pr,me.push({date:ft.date,particular:X,vchType:"Credit Note",vchNo:ft.creditNoteNo||ft.vchNo,debit:0,credit:pr,receiptDate:"",amountReceived:0,tds:0,balance:"-",status:"",isMain:!0,isCreditNote:!0,hasCN:!0});const yn=Math.abs(ft.amount)||pr/1.18,or=Math.abs(ft.gst)||pr-yn;me.push({particular:"PROMOTIONAL TRADE EMAILER",credit:yn,isMain:!1,isCreditNote:!0,hasCN:!0}),me.push({particular:ft.gstType||(Ft?"CGST + SGST":"IGST"),credit:or,isMain:!1,isCreditNote:!0,hasCN:!0})}}else if(K.isService){const et=K,jt=et.campaigns[0]||{},Ft=parseFloat(jt.invoiceAmount)||0,vt=et.serviceType||jt.serviceType||"SERVICE",Jt=(Ut=jt.statePartyDetails)==null?void 0:Ut.toUpperCase().includes("MAHARASHTRA"),fr=Jt?Ft*.09:0,hr=Jt?Ft*.09:0,nn=Jt?0:Ft*.18,ft=Ft+fr+hr+nn,ar=oe(et.invoiceNo),Dt=fe.get(ar),Wr=!!Dt,xr=b.find(or=>or.invoiceNo===et.invoiceNo);Ae+=ft,qe+=ft;let br=0,vn=0,pr="",yn=Wr?"":"Pending";if(xr&&(yn="Received",br=xr.amount||0,vn=xr.tds||xr.tdsAmount||0,pr=xr.date,ae+=br,te+=vn,Ae-=br+vn+(xr.discount||0)),me.push({date:et.invoiceDate,particular:X,vchType:"Sales",vchNo:et.invoiceNo,debit:ft,credit:0,receiptDate:pr,amountReceived:br,tds:vn,balance:Wr?"-":yn==="Received"?0:ft-br-vn,status:yn,isMain:!0,hasCN:Wr,isService:!0}),me.push({particular:vt.toUpperCase(),credit:Ft,isMain:!1,hasCN:Wr}),Jt?(me.push({particular:"CGST",credit:fr,isMain:!1,hasCN:Wr}),me.push({particular:"SGST",credit:hr,isMain:!1,hasCN:Wr})):me.push({particular:"IGST",credit:nn,isMain:!1,hasCN:Wr}),Dt&&!Qe.has(ar)){Qe.add(ar);const or=Math.abs(Dt.totalAmount||Dt.credit||0);Ae-=or,le+=or,me.push({date:Dt.date,particular:X,vchType:"Credit Note",vchNo:Dt.creditNoteNo||Dt.vchNo,debit:0,credit:or,receiptDate:"",amountReceived:0,tds:0,balance:"-",status:"",isMain:!0,isCreditNote:!0,hasCN:!0});const dn=Math.abs(Dt.amount)||or/1.18,$i=Math.abs(Dt.gst)||or-dn;me.push({particular:vt.toUpperCase(),credit:dn,isMain:!1,isCreditNote:!0,hasCN:!0}),me.push({particular:Dt.gstType||(Jt?"CGST + SGST":"IGST"),credit:$i,isMain:!1,isCreditNote:!0,hasCN:!0})}}else if(K.isHistorical){const et=K.debit||0,jt=K.credit||0,Ft=oe(K.vchNo),vt=fe.get(Ft),Jt=!!vt;if(Ae+=et-jt,qe+=et,le+=jt,me.push({date:K.date,particular:K.particulars||X,vchType:K.vchType||"Sales",vchNo:K.vchNo,debit:et,credit:jt,receiptDate:K.receiptDate||"",amountReceived:K.amountReceived||0,tds:K.tdsReceived||0,balance:Jt?"-":et-(K.amountReceived||0)-(K.tdsReceived||0),status:Jt?"":K.paymentStatus||"",isMain:!0,isHistorical:!0,hasCN:Jt}),K.subRows&&K.subRows.length>0&&K.subRows.forEach(fr=>{me.push({particular:fr.particular,debit:fr.debit,credit:fr.credit,isMain:!1,hasCN:Jt})}),vt&&!Qe.has(Ft)){Qe.add(Ft);const fr=Math.abs(vt.totalAmount||vt.credit||0);Ae-=fr,le+=fr,me.push({date:vt.date,particular:X,vchType:"Credit Note",vchNo:vt.creditNoteNo||vt.vchNo,debit:0,credit:fr,receiptDate:"",amountReceived:0,tds:0,balance:"-",status:"",isMain:!0,isCreditNote:!0,hasCN:!0}),vt.subRows&&vt.subRows.length>0&&vt.subRows.forEach(hr=>{me.push({particular:hr.particular,credit:Math.abs(hr.credit||0),isMain:!1,isCreditNote:!0,hasCN:!0})})}}});const st=me.reduce((K,Ve)=>Ve.isMain&&typeof Ve.balance=="number"&&Ve.balance>0?K+Ve.balance:K,0),mt=(X||"").trim().toUpperCase();let lt={};Te&&(lt=d.find(K=>K.partyNameUpper===mt&&K.normalizedState===Te)||{}),lt.state||(lt=d.find(K=>K.partyNameUpper===mt)||{});const zt=Se.find(K=>{var Ve;return((Ve=K.partyName)==null?void 0:Ve.trim().toUpperCase())===mt}),Ue=lt.state||(zt==null?void 0:zt.statePartyDetails)||"",it=lt.address||Qu(X,Ue)||"",Bt=lt.gstin||Fo(X,Ue),Gt=`
<!DOCTYPE html>
<html>
<head>
  <title>Ledger Account - ${X}</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: Arial, sans-serif; font-size: 11px; padding: 20px; }
    .header { text-align: center; margin-bottom: 15px; }
    .firm-name { font-size: 18px; font-weight: bold; color: #1E293B; }
    .firm-address { font-size: 10px; color: #666; margin-top: 2px; }
    .party-section { text-align: center; margin: 15px 0; padding: 10px; border: 1px solid #ddd; background: #f9f9f9; }
    .party-name { font-size: 14px; font-weight: bold; }
    .ledger-title { font-size: 11px; color: #666; }
    .party-address { font-size: 10px; color: #666; margin-top: 5px; }
    .party-gstin { font-size: 10px; color: #1a5276; margin-top: 3px; font-weight: 600; }
    .period { text-align: center; font-size: 11px; margin: 10px 0; font-weight: bold; }
    .totals { display: flex; justify-content: space-around; background: #e8f4fd; padding: 8px; margin-bottom: 10px; font-size: 10px; border: 1px solid #ccc; }
    .totals div { text-align: center; }
    .totals .label { color: #666; }
    .totals .value { font-weight: bold; font-size: 11px; }
    .closing-balance { text-align: center; background: #1E293B; color: white; padding: 10px; margin-bottom: 10px; font-size: 14px; font-weight: bold; }
    table { width: 100%; border-collapse: collapse; font-size: 10px; }
    th { background: #f0f0f0; border: 1px solid #ccc; padding: 6px 4px; text-align: left; font-weight: bold; }
    td { border: 1px solid #ddd; padding: 5px 4px; }
    .text-right { text-align: right; }
    .text-center { text-align: center; }
    .main-row { background: #fff; }
    .main-row-cn { background: #fffbeb; }
    .sub-row { background: #fafafa; }
    .sub-row-cn { background: #fffbeb; }
    .sub-row td { padding-left: 20px; color: #666; font-size: 9px; }
    .opening-row { background: #fef3c7; font-weight: bold; }
    .credit-note-row { background: #fffbeb; }
    .status-received { background: #dcfce7; color: #166534; padding: 2px 6px; border-radius: 3px; font-size: 9px; }
    .status-pending { background: #fef3c7; color: #92400e; padding: 2px 6px; border-radius: 3px; font-size: 9px; }
    .debit { color: #dc2626; }
    .credit { color: #059669; }
    @media print { 
      body { padding: 10px; } 
      @page { size: landscape; margin: 10mm; }
    }
  </style>
</head>
<body>
  <div class="header">
    <div class="firm-name">${T.name}</div>
    <div class="firm-address">${T.address}</div>
    <div class="firm-address">${T.addressLine2}, ${T.city}</div>
    <div class="firm-address">E-Mail: ${T.email}</div>
  </div>
  
  <div class="party-section">
    <div class="party-name">${X}</div>
    <div class="ledger-title">Ledger Account</div>
    ${it?`<div class="party-address">${it}</div>`:""}
    ${Ue?`<div class="party-address"> ${Ue}</div>`:""}
    ${Bt?`<div class="party-gstin">GSTIN: ${Bt}</div>`:""}
  </div>
  
  <div class="period">${At(kn.fromDate)} to ${At(kn.toDate)}</div>
  
  <div class="closing-balance">
    Closing Balance: ${tr(Math.abs(st))} ${st>0?"(Dr)":st<0?"(Cr)":""}
  </div>
  
  <div class="totals">
    <div><div class="label">Debit</div><div class="value">${tr(qe)}</div></div>
    <div><div class="label">Credit</div><div class="value">${tr(le)}</div></div>
    <div><div class="label">Amount Received</div><div class="value credit">${tr(ae)}</div></div>
    <div><div class="label">TDS Received</div><div class="value">${tr(te)}</div></div>
  </div>
  
  <table>
    <thead>
      <tr>
        <th style="width:65px">Date</th>
        <th>Particular</th>
        <th style="width:70px" class="text-center">Vch Type</th>
        <th style="width:100px">Vch No.</th>
        <th style="width:80px" class="text-right">Debit</th>
        <th style="width:80px" class="text-right">Credit</th>
        <th style="width:70px" class="text-center">Date of Receipt</th>
        <th style="width:85px" class="text-right">Amount Received</th>
        <th style="width:70px" class="text-right">TDS Received</th>
        <th style="width:75px" class="text-right">Balance</th>
        <th style="width:70px" class="text-center">Payment Status</th>
      </tr>
    </thead>
    <tbody>
      ${me.map(K=>K.isMain?`
        <tr class="${K.isOpening?"opening-row":K.hasCN||K.isCreditNote?"main-row-cn":"main-row"}">
          <td>${K.date?At(K.date):""}</td>
          <td style="font-weight:600">${K.particular}</td>
          <td class="text-center">${K.vchType||""}</td>
          <td style="color:#2874A6;font-weight:600">${K.vchNo||""}</td>
          <td class="text-right">${K.debit>0?tr(K.debit):""}</td>
          <td class="text-right" style="color:#DC2626">${K.credit>0?tr(K.credit):""}</td>
          <td class="text-center">${K.receiptDate?At(K.receiptDate):""}</td>
          <td class="text-right credit">${K.amountReceived>0?tr(K.amountReceived):""}</td>
          <td class="text-right">${K.tds>0?tr(K.tds):""}</td>
          <td class="text-right">${K.balance==="-"?"-":K.balance>0?tr(K.balance):""}</td>
          <td class="text-center">${K.status?`<span class="${K.status==="Received"?"status-received":"status-pending"}">${K.status}</span>`:""}</td>
        </tr>
      `:`
        <tr class="${K.hasCN||K.isCreditNote?"sub-row-cn":"sub-row"}">
          <td></td>
          <td style="padding-left:20px;color:#666">${K.particular}</td>
          <td></td>
          <td></td>
          <td class="text-right">${K.debit?tr(K.debit):""}</td>
          <td class="text-right">${K.credit?tr(K.credit):""}</td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
        </tr>
      `).join("")}
    </tbody>
  </table>
  
  <script>window.onload = function() { window.print(); }<\/script>
</body>
</html>`,rt=window.open("","_blank");rt.document.write(Gt),rt.document.close()},K4=ye.useMemo(()=>{const h=new Set;return Xr.forEach(_=>h.add(_.partyName)),oi.forEach(_=>h.add(_.partyName)),[...h].filter(Boolean).sort()},[Xr,oi]),Y4=ye.useMemo(()=>Xr.filter(h=>{var _;return!(we.party&&h.partyName!==we.party||we.invoiceNo&&!((_=h.invoiceNo)!=null&&_.toLowerCase().includes(we.invoiceNo.toLowerCase()))||we.dateFrom&&h.date<we.dateFrom||we.dateTo&&h.date>we.dateTo)}),[Xr,we]),X4=ye.useMemo(()=>oi.filter(h=>{var _;return!(we.party&&h.partyName!==we.party||we.invoiceNo&&!((_=h.invoiceNo)!=null&&_.toLowerCase().includes(we.invoiceNo.toLowerCase()))||we.dateFrom&&h.date<we.dateFrom||we.dateTo&&h.date>we.dateTo)}),[oi,we]),q4=()=>{const h=[...Y4].sort((M,z)=>new Date(z.date)-new Date(M.date)),_=[...X4].sort((M,z)=>new Date(z.date)-new Date(M.date)),W=h.reduce((M,z)=>M+(parseFloat(z.amount)||0),0),Z=h.reduce((M,z)=>M+(parseFloat(z.tds)||parseFloat(z.tds||z.tdsAmount)||0),0),L=_.reduce((M,z)=>M+(parseFloat(z.totalAmount)||0),0),se=M=>{const z=parseFloat(M.totalAmount)||0;let b=parseFloat(M.baseAmount)||parseFloat(M.amount)||0,U=parseFloat(M.gst)||(parseFloat(M.cgstAmount)||0)+(parseFloat(M.sgstAmount)||0)+(parseFloat(M.igstAmount)||0);return b===0&&z>0&&(b=z/1.18,U=z-b),{base:b,gst:U,total:z}};return c.jsxs("div",{style:{padding:"20px"},children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[c.jsxs("div",{children:[c.jsx("h1",{style:{fontSize:"22px",fontWeight:"700",color:"#1E293B",marginBottom:"4px"},children:" Receipt Register"}),c.jsx("p",{style:{fontSize:"13px",color:"#64748B"},children:"All receipts, TDS, and credit notes"})]}),c.jsx(Ye,{icon:Po,label:"Export Excel",variant:"secondary",onClick:z4})]}),c.jsx("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"10px",border:"1px solid #E2E8F0",padding:"14px 18px",marginBottom:"16px"},children:c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"14px",flexWrap:"wrap"},children:[c.jsx(gd,{size:18,color:"#64748B"}),c.jsx("span",{style:{fontSize:"13px",fontWeight:"700",color:"#475569"},children:"Filters:"}),c.jsxs("select",{value:we.party,onChange:M=>ze(z=>({...z,party:M.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px"},children:[c.jsx("option",{value:"",children:"All Parties"}),K4.map(M=>c.jsx("option",{value:M,children:M},M))]}),c.jsx("input",{type:"text",placeholder:"Invoice No",value:we.invoiceNo,onChange:M=>ze(z=>({...z,invoiceNo:M.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",width:"140px"}}),c.jsx("input",{type:"date",value:we.dateFrom,onChange:M=>ze(z=>({...z,dateFrom:M.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px"}}),c.jsx("span",{style:{color:"#64748B"},children:"to"}),c.jsx("input",{type:"date",value:we.dateTo,onChange:M=>ze(z=>({...z,dateTo:M.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px"}}),(we.party||we.invoiceNo||we.dateFrom||we.dateTo)&&c.jsxs("button",{onClick:()=>ze({party:"",invoiceNo:"",dateFrom:"",dateTo:""}),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #FCA5A5",borderRadius:"8px",backgroundColor:"#FEE2E2",color:"#991B1B",cursor:"pointer"},children:[c.jsx(Ta,{size:14})," Clear"]})]})}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"16px",marginBottom:"20px"},children:[c.jsxs("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"12px",padding:"20px",border:"1px solid #E2E8F0"},children:[c.jsx("div",{style:{fontSize:"12px",fontWeight:"600",color:"#64748B",marginBottom:"8px"},children:"Receipts"}),c.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:h.length})]}),c.jsxs("div",{style:{backgroundColor:"#F0FDF4",borderRadius:"12px",padding:"20px",border:"1px solid #BBF7D0"},children:[c.jsx("div",{style:{fontSize:"12px",fontWeight:"600",color:"#166534",marginBottom:"8px"},children:"Amount Received"}),c.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#166534"},children:at(W)})]}),c.jsxs("div",{style:{backgroundColor:"#FEF3C7",borderRadius:"12px",padding:"20px",border:"1px solid #FDE68A"},children:[c.jsx("div",{style:{fontSize:"12px",fontWeight:"600",color:"#92400E",marginBottom:"8px"},children:"TDS Received"}),c.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#92400E"},children:at(Z)})]}),c.jsxs("div",{style:{backgroundColor:"#FEE2E2",borderRadius:"12px",padding:"20px",border:"1px solid #FCA5A5"},children:[c.jsx("div",{style:{fontSize:"12px",fontWeight:"600",color:"#991B1B",marginBottom:"8px"},children:"Credit Notes"}),c.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#991B1B"},children:at(L)})]})]}),c.jsx(En,{title:`Receipts (${h.length})`,noPadding:!0,children:c.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"12px"},children:[c.jsx("thead",{children:c.jsxs("tr",{style:{backgroundColor:"#F8FAFC",borderBottom:"2px solid #E2E8F0"},children:[c.jsx("th",{style:{padding:"12px",textAlign:"left",fontWeight:"700"},children:"Receipt No"}),c.jsx("th",{style:{padding:"12px",textAlign:"center",fontWeight:"700",color:"#6B21A8",backgroundColor:"#FAF5FF"},children:"Code"}),c.jsx("th",{style:{padding:"12px",textAlign:"left",fontWeight:"700"},children:"Date"}),c.jsx("th",{style:{padding:"12px",textAlign:"left",fontWeight:"700"},children:"Party Name"}),c.jsx("th",{style:{padding:"12px",textAlign:"left",fontWeight:"700"},children:"Invoice No"}),c.jsx("th",{style:{padding:"12px",textAlign:"right",fontWeight:"700",backgroundColor:"#F0FDF4",color:"#166534"},children:"Amount"}),c.jsx("th",{style:{padding:"12px",textAlign:"right",fontWeight:"700",backgroundColor:"#FEF3C7",color:"#92400E"},children:"TDS"}),c.jsx("th",{style:{padding:"12px",textAlign:"right",fontWeight:"700"},children:"Total"}),c.jsx("th",{style:{padding:"12px",textAlign:"center",fontWeight:"700"},children:"Payment Mode"}),c.jsx("th",{style:{padding:"12px",textAlign:"center",fontWeight:"700"},children:"Actions"})]})}),c.jsx("tbody",{children:h.length===0?c.jsx("tr",{children:c.jsx("td",{colSpan:"10",style:{padding:"50px",textAlign:"center",color:"#94A3B8"},children:"No receipts found"})}):h.map(M=>{const z=parseFloat(M.amount)||0,b=parseFloat(M.tds)||parseFloat(M.tdsAmount)||0,U=M.clientCode||zr(M.partyName,M.statePartyDetails||"");return c.jsxs("tr",{style:{borderBottom:"1px solid #F1F5F9"},children:[c.jsx("td",{style:{padding:"12px",fontWeight:"600",color:"#2874A6"},children:M.receiptNo}),c.jsx("td",{style:{padding:"12px",textAlign:"center",backgroundColor:"#FAF5FF"},children:c.jsx("span",{style:{fontWeight:"700",color:"#6B21A8",fontSize:"11px"},children:U||"-"})}),c.jsx("td",{style:{padding:"12px"},children:At(M.date)}),c.jsx("td",{style:{padding:"12px",fontWeight:"500"},children:M.partyName}),c.jsx("td",{style:{padding:"12px",color:"#64748B"},children:M.invoiceNo}),c.jsx("td",{style:{padding:"12px",textAlign:"right",fontWeight:"600",color:"#166534",backgroundColor:"#F0FDF4"},children:at(z)}),c.jsx("td",{style:{padding:"12px",textAlign:"right",fontWeight:"600",color:"#92400E",backgroundColor:"#FEF3C7"},children:at(b)}),c.jsx("td",{style:{padding:"12px",textAlign:"right",fontWeight:"700"},children:at(z+b)}),c.jsx("td",{style:{padding:"12px",textAlign:"center"},children:c.jsx("span",{style:{padding:"4px 8px",fontSize:"10px",fontWeight:"600",borderRadius:"9999px",backgroundColor:"#E0E7FF",color:"#3730A3"},children:M.paymentMode||M.mode||"Bank Transfer"})}),c.jsx("td",{style:{padding:"12px",textAlign:"center"},children:c.jsxs("button",{onClick:()=>W4(M),style:{padding:"6px 10px",fontSize:"11px",backgroundColor:"#2874A6",color:"white",border:"none",borderRadius:"6px",cursor:"pointer"},children:[c.jsx(iE,{size:12})," Print"]})})]},M.id||M.receiptNo)})})]})}),c.jsx("div",{style:{marginTop:"30px"},children:c.jsx(En,{title:`Credit Notes (${_.length})`,noPadding:!0,children:c.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"12px"},children:[c.jsx("thead",{children:c.jsxs("tr",{style:{backgroundColor:"#FEF3C7",borderBottom:"2px solid #FDE68A"},children:[c.jsx("th",{style:{padding:"12px",textAlign:"left",fontWeight:"700"},children:"CN No"}),c.jsx("th",{style:{padding:"12px",textAlign:"center",fontWeight:"700",color:"#6B21A8",backgroundColor:"#FAF5FF"},children:"Code"}),c.jsx("th",{style:{padding:"12px",textAlign:"left",fontWeight:"700"},children:"Date"}),c.jsx("th",{style:{padding:"12px",textAlign:"left",fontWeight:"700"},children:"Party Name"}),c.jsx("th",{style:{padding:"12px",textAlign:"left",fontWeight:"700"},children:"Against Invoice"}),c.jsx("th",{style:{padding:"12px",textAlign:"right",fontWeight:"700"},children:"Base Amount"}),c.jsx("th",{style:{padding:"12px",textAlign:"right",fontWeight:"700"},children:"GST"}),c.jsx("th",{style:{padding:"12px",textAlign:"right",fontWeight:"700"},children:"Total"}),c.jsx("th",{style:{padding:"12px",textAlign:"left",fontWeight:"700"},children:"Reason"}),c.jsx("th",{style:{padding:"12px",textAlign:"center",fontWeight:"700"},children:"Actions"})]})}),c.jsx("tbody",{children:_.length===0?c.jsx("tr",{children:c.jsx("td",{colSpan:"10",style:{padding:"50px",textAlign:"center",color:"#94A3B8"},children:"No credit notes found"})}):_.map(M=>{const z=se(M),b=M.clientCode||zr(M.partyName,M.statePartyDetails||"");return c.jsxs("tr",{style:{borderBottom:"1px solid #F1F5F9",backgroundColor:"#FFFBEB"},children:[c.jsx("td",{style:{padding:"12px",fontWeight:"600",color:"#92400E"},children:M.creditNoteNo}),c.jsx("td",{style:{padding:"12px",textAlign:"center",backgroundColor:"#FAF5FF"},children:c.jsx("span",{style:{fontWeight:"700",color:"#6B21A8",fontSize:"11px"},children:b||"-"})}),c.jsx("td",{style:{padding:"12px"},children:At(M.date)}),c.jsx("td",{style:{padding:"12px",fontWeight:"500"},children:M.partyName}),c.jsx("td",{style:{padding:"12px",color:"#64748B"},children:M.invoiceNo}),c.jsx("td",{style:{padding:"12px",textAlign:"right"},children:at(z.base)}),c.jsx("td",{style:{padding:"12px",textAlign:"right"},children:at(z.gst)}),c.jsx("td",{style:{padding:"12px",textAlign:"right",fontWeight:"700",color:"#92400E"},children:at(z.total)}),c.jsx("td",{style:{padding:"12px",fontSize:"11px",color:"#64748B"},children:M.reason||"-"}),c.jsx("td",{style:{padding:"12px",textAlign:"center"},children:c.jsxs("button",{onClick:()=>H4(M),style:{padding:"6px 10px",fontSize:"11px",backgroundColor:"#92400E",color:"white",border:"none",borderRadius:"6px",cursor:"pointer"},children:[c.jsx(iE,{size:12})," Print"]})})]},M.id||M.creditNoteNo)})})]})})})]})},Q4=()=>{const h=(b,U,oe)=>{const fe=Yn[b]||0,me=Ue=>oe?(Ue.clientCode||zr(Ue.partyName,Ue.statePartyDetails))===oe:!0,qe=Se.filter(Ue=>$t(Ue.partyName,b)&&Ue.invoiceGenerated&&Ue.invoiceStatus==="Approved"&&me(Ue)&&(!U||qn(Ue.statePartyDetails)===U)),le=ke.filter(Ue=>$t(Ue.partyName,b)&&Ue.invoiceGenerated&&Ue.invoiceStatus==="Approved"&&me(Ue)&&(!U||qn(Ue.statePartyDetails)===U)),ae=new Map;qe.forEach(Ue=>{ae.has(Ue.invoiceNo)?ae.get(Ue.invoiceNo).campaigns.push(Ue):ae.set(Ue.invoiceNo,{invoiceNo:Ue.invoiceNo,campaigns:[Ue],totalAmount:parseFloat(Ue.invoiceTotalAmount)||0})}),le.forEach(Ue=>{ae.has(Ue.invoiceNo)||ae.set(Ue.invoiceNo,{invoiceNo:Ue.invoiceNo,totalAmount:parseFloat(Ue.invoiceTotalAmount)||0,isService:!0})});const te=new Set(Array.from(ae.keys())),Ae=Me.filter(Ue=>$t(Ue.partyName,b)&&(!U||te.has(Ue.invoiceNo))),Qe=re.filter(Ue=>$t(Ue.partyName,b)&&(!U||te.has(Ue.invoiceNo))),Je=U?[]:ie.filter(Ue=>{var it;return $t(Ue.partyName,b)&&Ue.isHistorical&&Ue.type!=="creditnote"&&!((it=Ue.vchNo)!=null&&it.toUpperCase().startsWith("CN"))}),st=U?[]:ie.filter(Ue=>{var it;return $t(Ue.partyName,b)&&Ue.isHistorical&&(Ue.type==="creditnote"||((it=Ue.vchNo)==null?void 0:it.toUpperCase().startsWith("CN")))}),mt=Ue=>{if(!Ue)return"";const it=Ue.split("/");return it.length>=3?it.slice(1).join("/"):it.length===2?it.join("/"):it[it.length-1]},lt=new Map;Qe.forEach(Ue=>{const it=mt(Ue.invoiceNo);it&&!lt.has(it)&&lt.set(it,Ue)}),st.forEach(Ue=>{const it=mt(Ue.vchNo);it&&!lt.has(it)&&lt.set(it,Ue)});let zt=0;return fe>0&&(zt+=fe),Array.from(ae.values()).forEach(Ue=>{const it=Ue.totalAmount,Bt=mt(Ue.invoiceNo),Gt=lt.get(Bt),rt=Gt?Math.abs(parseFloat(Gt.totalAmount)||parseFloat(Gt.credit)||0):0;if(!(Gt&&rt>=it)){let Ve=Gt?it-rt:it;const Ze=Ae.find(Ut=>Ut.invoiceNo===Ue.invoiceNo);if(Ze){const Ut=Ve-(parseFloat(Ze.amount)||0)-(parseFloat(Ze.tds)||0)-(parseFloat(Ze.discount)||0);Ut>0&&(zt+=Ut)}else Ve>0&&(zt+=Ve)}}),Je.forEach(Ue=>{const it=mt(Ue.vchNo),Bt=lt.get(it),Gt=Bt?Math.abs(parseFloat(Bt.totalAmount)||parseFloat(Bt.credit)||parseFloat(Bt.debit)||0):0,rt=parseFloat(Ue.debit)||0;if(!(Bt&&Gt>=rt)){let Ve=Bt?rt-Gt:rt;const Ze=parseFloat(Ue.amountReceived)||0,Ut=parseFloat(Ue.tdsReceived)||0,et=Ve-Ze-Ut;et>0&&(zt+=et)}}),zt},_=new Set;d.forEach(b=>{b.clientCode&&_.add(b.partyNameUpper)});const W=d.filter(b=>!b.clientCode&&_.has(b.partyNameUpper)?(console.log("RENDER FILTER - Removing party without code:",b.partyName),!1):b.partyName.toLowerCase().includes(Es.toLowerCase())||b.state&&b.state.toLowerCase().includes(Es.toLowerCase()));console.log("filteredParties after render filter:",W.length,W.map(b=>({name:b.partyName,code:b.clientCode})));const Z=b=>{if(Te){const me=d.find(qe=>qe.partyNameUpper===(b||"").trim().toUpperCase()&&qe.normalizedState===Te);if(me!=null&&me.state)return me.state}const U=(b||"").trim().toUpperCase(),oe=Se.find(me=>{var qe;return((qe=me.partyName)==null?void 0:qe.trim().toUpperCase())===U});if(oe!=null&&oe.statePartyDetails)return oe.statePartyDetails;const fe=d.find(me=>me.partyNameUpper===U);return(fe==null?void 0:fe.state)||""},L=b=>{const U=(b||"").trim().toUpperCase();if(Te){const fe=d.find(me=>me.partyNameUpper===U&&me.normalizedState===Te);if(fe!=null&&fe.address)return fe.address}const oe=d.find(fe=>fe.partyNameUpper===U);return oe!=null&&oe.address?oe.address:Qu(b,Z(b))},se=b=>{const U=(b||"").trim().toUpperCase();if(Te){const me=d.find(qe=>qe.partyNameUpper===U&&qe.normalizedState===Te);if(me!=null&&me.gstin)return me.gstin}const oe=d.find(me=>me.partyNameUpper===U);if(oe!=null&&oe.gstin)return oe.gstin;const fe=Se.find(me=>{var qe;return((qe=me.partyName)==null?void 0:qe.trim().toUpperCase())===U});return fe?Fo(b,fe.statePartyDetails):""},z=(()=>{if(!X)return{entries:[],totals:{debit:0,credit:0,received:0,tds:0,balance:0}};const b=Yn[X]||0,U=K=>{if(!K)return"";const Ve=K.split("/");return Ve.length>=3?Ve.slice(1).join("/"):Ve.length===2?Ve.join("/"):Ve[Ve.length-1]},oe=K=>Ne?(K.clientCode||zr(K.partyName,K.statePartyDetails))===Ne:!0,fe=Se.filter(K=>$t(K.partyName,X)&&K.invoiceGenerated&&K.invoiceStatus==="Approved"&&oe(K)&&(!Te||qn(K.statePartyDetails)===Te)),me=ke.filter(K=>$t(K.partyName,X)&&K.invoiceGenerated&&K.invoiceStatus==="Approved"&&oe(K)&&(!Te||qn(K.statePartyDetails)===Te)),qe=new Map;fe.forEach(K=>{qe.has(K.invoiceNo)?qe.get(K.invoiceNo).campaigns.push(K):qe.set(K.invoiceNo,{invoiceNo:K.invoiceNo,invoiceDate:K.invoiceDate,invoiceType:K.invoiceType,combinationCode:K.combinationCode,receiptStatus:K.receiptStatus,receiptNo:K.receiptNo,receiptDate:K.receiptDate,creditNoteNo:K.creditNoteNo,campaigns:[K],isFromMaster:!0})}),me.forEach(K=>{qe.has(K.invoiceNo)||qe.set(K.invoiceNo,{invoiceNo:K.invoiceNo,invoiceDate:K.invoiceDate,invoiceType:"Service",combinationCode:"NA",receiptStatus:K.receiptStatus,receiptNo:K.receiptNo,receiptDate:K.receiptDate,creditNoteNo:K.creditNoteNo,campaigns:[K],isFromMaster:!1,isService:!0,serviceType:K.serviceType})});const le=new Set(Array.from(qe.keys())),ae=Te?[]:ie.filter(K=>{var Ve;return $t(K.partyName,X)&&K.isHistorical&&K.type!=="creditnote"&&!((Ve=K.vchNo)!=null&&Ve.toUpperCase().startsWith("CN"))}),te=Te?[]:ie.filter(K=>{var Ve;return $t(K.partyName,X)&&K.isHistorical&&(K.type==="creditnote"||((Ve=K.vchNo)==null?void 0:Ve.toUpperCase().startsWith("CN")))}),Ae=Me.filter(K=>$t(K.partyName,X)&&(!Te||le.has(K.invoiceNo))),Qe=re.filter(K=>$t(K.partyName,X)&&(!Te||le.has(K.invoiceNo))),Je=new Map;Qe.forEach(K=>{const Ve=U(K.invoiceNo);Ve&&!Je.has(Ve)&&Je.set(Ve,{...K,isSystemCN:!0})}),te.forEach(K=>{const Ve=U(K.vchNo);Ve&&!Je.has(Ve)&&Je.set(Ve,{...K,isHistoricalCN:!0})});const st=[];let mt=b,lt=0,zt=0,Ue=0,it=0;const Bt=new Set;b!==0&&(st.push({id:"opening",date:"",particular:"Opening Balance",vchType:"",vchNo:"",debit:b>0?b:0,credit:b<0?Math.abs(b):0,receiptDate:"",amountReceived:0,tdsReceived:0,balance:b,paymentStatus:"",isOpening:!0,subRows:[]}),lt+=b>0?b:0,zt+=b<0?Math.abs(b):0);const Gt=[];Array.from(qe.values()).filter(K=>{const Ve=new Date(K.invoiceDate),Ze=new Date(kn.fromDate),Ut=new Date(kn.toDate);return Ve>=Ze&&Ve<=Ut}).forEach(K=>{Gt.push({...K,entryType:"invoice",sortDate:K.invoiceDate})}),ae.filter(K=>{if(!K.date)return!1;const Ve=new Date(K.date),Ze=new Date(kn.fromDate),Ut=new Date(kn.toDate);return Ve>=Ze&&Ve<=Ut}).forEach(K=>{Gt.push({...K,entryType:K.type||"invoice",sortDate:K.date})}),Gt.sort((K,Ve)=>new Date(K.sortDate)-new Date(Ve.sortDate)),Gt.forEach(K=>{var Ve,Ze,Ut;if(K.isFromMaster){const et=K;let jt=0;et.campaigns.forEach(is=>{jt+=parseFloat(is.invoiceAmount)||0});const Ft=(Ze=(Ve=et.campaigns[0])==null?void 0:Ve.statePartyDetails)==null?void 0:Ze.toUpperCase().includes("MAHARASHTRA"),vt=Ft?jt*.09:0,Jt=Ft?jt*.09:0,fr=Ft?0:jt*.18,hr=jt+vt+Jt+fr,nn=U(et.invoiceNo),ft=Je.get(nn),ar=ft?Math.abs(ft.totalAmount||ft.credit||0):0,Dt=!!ft,Wr=Dt&&ar>=hr,xr=Dt&&!Wr?hr-ar:0,br=Ae.find(is=>is.invoiceNo===et.invoiceNo);mt+=hr,lt+=hr;const vn=[{particular:"PROMOTIONAL TRADE EMAILER"+(et.campaigns.length>1?"S":""),credit:jt}];Ft?(vn.push({particular:"CGST",credit:vt}),vn.push({particular:"SGST",credit:Jt})):vn.push({particular:"IGST",credit:fr});let pr="",yn=0,or=0,dn="",$i=hr;if(br?(pr="Received",yn=br.amount||0,or=br.tds||0,dn=br.date,Ue+=yn,it+=or,$i=hr-yn-or-(br.discount||0),mt-=yn+or+(br.discount||0)):et.receiptStatus==="Received"?(pr="Received",$i=0):Wr?(pr="CN Closed",$i=0):Dt&&xr>0?(pr="Partial CN",$i=xr):pr="Pending",st.push({id:et.invoiceNo,date:et.invoiceDate,particular:X,vchType:"Sales",vchNo:et.invoiceNo,debit:hr,credit:0,receiptDate:dn,amountReceived:yn,tdsReceived:or,balance:Wr?"-":$i>0?$i:0,paymentStatus:pr,isInvoice:!0,hasCN:Dt,subRows:vn}),ft&&!Bt.has(nn)){Bt.add(nn);const is=Math.abs(ft.totalAmount||ft.credit||0);mt-=is,zt+=is;const ss=[];if(ft.amount&&ss.push({particular:"PROMOTIONAL TRADE EMAILER",credit:Math.abs(ft.amount)}),ft.gst&&ss.push({particular:ft.gstType||(Ft?"CGST + SGST":"IGST"),credit:Math.abs(ft.gst)}),ss.length===0&&is>0){const ya=is/1.18,id=is-ya;ss.push({particular:"PROMOTIONAL TRADE EMAILER",credit:ya}),ss.push({particular:Ft?"CGST + SGST":"IGST",credit:id})}st.push({id:ft.id||ft.creditNoteNo||`cn-${nn}`,date:ft.date,particular:X,vchType:"Credit Note",vchNo:ft.creditNoteNo||ft.vchNo,debit:0,credit:is,receiptDate:"",amountReceived:0,tdsReceived:0,balance:"-",paymentStatus:"",isCreditNote:!0,hasCN:!0,subRows:ft.isHistoricalCN&&ft.subRows||ss})}}else if(K.isService){const et=K,jt=et.campaigns[0]||{},Ft=parseFloat(jt.invoiceAmount)||0,vt=et.serviceType||jt.serviceType||"SERVICE",Jt=(Ut=jt.statePartyDetails)==null?void 0:Ut.toUpperCase().includes("MAHARASHTRA"),fr=Jt?Ft*.09:0,hr=Jt?Ft*.09:0,nn=Jt?0:Ft*.18,ft=Ft+fr+hr+nn,ar=U(et.invoiceNo),Dt=Je.get(ar),Wr=Dt?Math.abs(Dt.totalAmount||Dt.credit||0):0,xr=!!Dt,br=xr&&Wr>=ft,vn=xr&&!br?ft-Wr:0,pr=Ae.find(ya=>ya.invoiceNo===et.invoiceNo);mt+=ft,lt+=ft;const yn=[{particular:vt.toUpperCase(),credit:Ft}];Jt?(yn.push({particular:"CGST",credit:fr}),yn.push({particular:"SGST",credit:hr})):yn.push({particular:"IGST",credit:nn});let or="",dn=0,$i=0,is="",ss=ft;if(pr?(or="Received",dn=pr.amount||0,$i=pr.tds||pr.tdsAmount||0,is=pr.date,Ue+=dn,it+=$i,ss=ft-dn-$i-(pr.discount||0),mt-=dn+$i+(pr.discount||0)):br?(or="CN Closed",ss=0):xr&&vn>0?(or="Partial CN",ss=vn):or="Pending",st.push({id:et.invoiceNo,date:et.invoiceDate,particular:X,vchType:"Sales",vchNo:et.invoiceNo,debit:ft,credit:0,receiptDate:is,amountReceived:dn,tdsReceived:$i,balance:br?"-":ss>0?ss:0,paymentStatus:or,isInvoice:!0,isService:!0,hasCN:xr,subRows:yn}),Dt&&!Bt.has(ar)){Bt.add(ar);const ya=Math.abs(Dt.totalAmount||Dt.credit||0);mt-=ya,zt+=ya;const id=[],Ry=ya/1.18,ib=ya-Ry;id.push({particular:vt.toUpperCase(),credit:Ry}),id.push({particular:Jt?"CGST + SGST":"IGST",credit:ib}),st.push({id:Dt.id||Dt.creditNoteNo||`cn-${ar}`,date:Dt.date,particular:X,vchType:"Credit Note",vchNo:Dt.creditNoteNo||Dt.vchNo,debit:0,credit:ya,receiptDate:"",amountReceived:0,tdsReceived:0,balance:"-",paymentStatus:"",isCreditNote:!0,hasCN:!0,subRows:id})}}else if(K.isHistorical){const et=K.debit||0,jt=K.credit||0,Ft=U(K.vchNo),vt=Je.get(Ft),Jt=vt?Math.abs(vt.totalAmount||vt.credit||0):0,fr=!!vt,hr=fr&&Jt>=et,nn=fr&&!hr?et-Jt:0;mt+=et-jt,lt+=et,zt+=jt,K.amountReceived&&(Ue+=K.amountReceived),K.tdsReceived&&(it+=K.tdsReceived);const ft=K.subRows||[];let ar=et-(K.amountReceived||0)-(K.tdsReceived||0),Dt=K.paymentStatus||"";hr?(ar=0,Dt="CN Closed"):fr&&nn>0&&(ar=nn-(K.amountReceived||0)-(K.tdsReceived||0),ar>0&&(Dt="Partial CN")),st.push({id:K.id,date:K.date,particular:K.particulars||X,vchType:K.vchType||"Sales",vchNo:K.vchNo,debit:et,credit:jt,receiptDate:K.receiptDate||"",amountReceived:K.amountReceived||0,tdsReceived:K.tdsReceived||0,balance:hr?"-":ar>0?ar:0,paymentStatus:Dt,isInvoice:!0,isHistorical:!0,hasCN:fr,subRows:ft}),vt&&!Bt.has(Ft)&&(Bt.add(Ft),mt-=Jt,zt+=Jt,st.push({id:vt.id||vt.creditNoteNo||vt.vchNo||`cn-${Ft}`,date:vt.date,particular:X,vchType:"Credit Note",vchNo:vt.creditNoteNo||vt.vchNo,debit:0,credit:Jt,receiptDate:"",amountReceived:0,tdsReceived:0,balance:"-",paymentStatus:"",isCreditNote:!0,hasCN:!0,subRows:vt.subRows||[]}))}});const rt=st.reduce((K,Ve)=>typeof Ve.balance=="number"&&Ve.balance>0?K+Ve.balance:K,0);return{entries:st,totals:{debit:lt,credit:zt,received:Ue,tds:it,balance:rt}}})();return c.jsxs("div",{children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[c.jsx("h1",{style:{margin:0,fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:" Party Ledgers"}),c.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[c.jsx(Ye,{icon:Po,label:"Export All",variant:"secondary",onClick:V4}),li&&c.jsx("span",{style:{padding:"8px 16px",backgroundColor:"#FEF3C7",borderRadius:"8px",fontSize:"13px",color:"#92400E",fontWeight:"600"},children:" View Only"}),Cr&&c.jsx(Ye,{icon:Xs,label:"Import Historical",variant:"brand",onClick:()=>Sc(!0)}),Cr&&X&&ie.some(b=>$t(b.partyName,X)&&b.isHistorical)&&c.jsx(Ye,{icon:as,label:"Clear Historical",variant:"danger",onClick:s4}),Cr&&c.jsx(Ye,{icon:md,label:"Opening Balance",variant:"primary",onClick:()=>Nr(!0)})]})]}),c.jsx("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"10px",border:"1px solid #E2E8F0",padding:"14px 18px",marginBottom:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"14px",flexWrap:"wrap"},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[c.jsx(OL,{size:18,color:"#64748B"}),c.jsx("span",{style:{fontSize:"13px",fontWeight:"700",color:"#475569"},children:"Period:"})]}),c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[c.jsx("input",{type:"date",value:kn.fromDate,onChange:b=>_s(U=>({...U,fromDate:b.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px"}}),c.jsx("span",{style:{color:"#64748B"},children:"to"}),c.jsx("input",{type:"date",value:kn.toDate,onChange:b=>_s(U=>({...U,toDate:b.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px"}})]}),c.jsx("div",{style:{marginLeft:"auto",display:"flex",gap:"10px"},children:X&&c.jsx(Ye,{icon:Po,label:"Download PDF",variant:"brand",onClick:G4})})]})}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"280px 1fr",gap:"16px"},children:[c.jsxs(En,{title:"Parties",noPadding:!0,children:[c.jsx("div",{style:{padding:"12px",borderBottom:"1px solid #E2E8F0"},children:c.jsxs("div",{style:{position:"relative"},children:[c.jsx(Q0,{size:14,style:{position:"absolute",left:"10px",top:"50%",transform:"translateY(-50%)",color:"#94A3B8"}}),c.jsx("input",{type:"text",placeholder:"Search party...",value:Es,onChange:b=>Gu(b.target.value),style:{width:"100%",padding:"8px 12px 8px 32px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",boxSizing:"border-box"}})]})}),c.jsx("div",{style:{maxHeight:"450px",overflowY:"auto"},children:W.length===0?c.jsx("div",{style:{padding:"30px",textAlign:"center",color:"#94A3B8",fontSize:"14px"},children:Es?"No matching parties":"No parties yet"}):W.map((b,U)=>{const oe=h(b.partyName,b.normalizedState,b.clientCode),fe=$t(X,b.partyName)&&Te===b.normalizedState&&Ne===b.clientCode;return c.jsxs("div",{onClick:()=>{_e(b.partyName),Le(b.normalizedState||null),Ie(b.clientCode||null)},style:{padding:"14px 18px",borderBottom:"1px solid #F1F5F9",cursor:"pointer",backgroundColor:fe?"#EFF6FF":"transparent",borderLeft:fe?"4px solid #2874A6":"4px solid transparent"},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[b.clientCode&&c.jsx("span",{style:{padding:"2px 6px",backgroundColor:"#F3E8FF",color:"#6B21A8",borderRadius:"4px",fontSize:"10px",fontWeight:"700"},children:b.clientCode}),c.jsx("span",{style:{fontWeight:"600",fontSize:"14px",color:"#1E293B"},children:b.partyName})]}),b.state&&c.jsxs("div",{style:{fontSize:"11px",color:"#64748B",marginTop:"2px"},children:[" ",b.state]}),b.gstin&&c.jsxs("div",{style:{fontSize:"10px",color:"#2874A6",marginTop:"1px"},children:["GST: ",b.gstin]}),c.jsxs("div",{style:{fontSize:"14px",color:oe>0?"#DC2626":"#059669",fontWeight:"700",marginTop:"4px"},children:[oe>0?"Dr. ":"Cr. ",at(Math.abs(oe))]})]},`${b.partyName}-${b.state}-${b.clientCode}-${U}`)})})]}),c.jsx(En,{title:X?"Ledger Account":"Select a Party",noPadding:!0,children:X?c.jsxs("div",{style:{fontSize:"12px"},children:[c.jsxs("div",{style:{textAlign:"center",padding:"16px",borderBottom:"2px solid #1E3A5F",backgroundColor:"#F8FAFC"},children:[c.jsx("div",{style:{fontSize:"16px",fontWeight:"700",color:"#1E3A5F"},children:T.name}),c.jsx("div",{style:{fontSize:"11px",color:"#64748B",marginTop:"4px"},children:T.address}),c.jsxs("div",{style:{fontSize:"11px",color:"#64748B"},children:[T.addressLine2,", ",T.city]}),c.jsxs("div",{style:{fontSize:"11px",color:"#64748B"},children:["E-Mail: ",T.email]})]}),c.jsxs("div",{style:{textAlign:"center",padding:"12px",borderBottom:"1px solid #E2E8F0",backgroundColor:"#FFFFFF"},children:[c.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",gap:"8px"},children:[(()=>{const b=W.find(U=>$t(U.partyName,X)&&U.normalizedState===Te);return b!=null&&b.clientCode?c.jsx("span",{style:{padding:"3px 8px",backgroundColor:"#F3E8FF",color:"#6B21A8",borderRadius:"6px",fontSize:"12px",fontWeight:"700"},children:b.clientCode}):null})(),c.jsx("span",{style:{fontSize:"14px",fontWeight:"700",color:"#1E293B"},children:X})]}),c.jsx("div",{style:{fontSize:"11px",fontWeight:"600",color:"#64748B"},children:"Ledger Account"}),L(X)&&c.jsx("div",{style:{fontSize:"11px",color:"#475569",marginTop:"4px"},children:L(X)}),Z(X)&&c.jsxs("div",{style:{fontSize:"11px",color:"#64748B",marginTop:"2px"},children:[" ",Z(X)]}),se(X)&&c.jsxs("div",{style:{fontSize:"11px",color:"#2874A6",marginTop:"3px",fontWeight:"600"},children:["GSTIN: ",se(X)]})]}),c.jsx("div",{style:{textAlign:"center",padding:"8px",backgroundColor:"#F1F5F9",borderBottom:"1px solid #E2E8F0"},children:c.jsxs("span",{style:{fontSize:"11px",fontWeight:"600",color:"#475569"},children:[At(kn.fromDate)," to ",At(kn.toDate)]})}),c.jsxs("div",{style:{backgroundColor:"#1E293B",color:"white",padding:"12px 16px",display:"flex",justifyContent:"center",alignItems:"center",gap:"12px",borderBottom:"3px solid #F59E0B"},children:[c.jsx("span",{style:{fontSize:"14px",fontWeight:"600"},children:"Closing Balance:"}),c.jsxs("span",{style:{fontSize:"18px",fontWeight:"700",color:z.totals.balance>0?"#FCA5A5":"#86EFAC"},children:[tr(Math.abs(z.totals.balance))," ",z.totals.balance>0?"(Dr)":z.totals.balance<0?"(Cr)":""]})]}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",backgroundColor:"#EFF6FF",borderBottom:"2px solid #2874A6",fontSize:"11px"},children:[c.jsxs("div",{style:{padding:"8px",textAlign:"center",borderRight:"1px solid #BFDBFE"},children:[c.jsx("div",{style:{color:"#64748B"},children:"Debit"}),c.jsx("div",{style:{fontWeight:"700",color:"#1E293B"},children:tr(z.totals.debit)})]}),c.jsxs("div",{style:{padding:"8px",textAlign:"center",borderRight:"1px solid #BFDBFE"},children:[c.jsx("div",{style:{color:"#64748B"},children:"Credit"}),c.jsx("div",{style:{fontWeight:"700",color:"#DC2626"},children:tr(z.totals.credit)})]}),c.jsxs("div",{style:{padding:"8px",textAlign:"center",borderRight:"1px solid #BFDBFE"},children:[c.jsx("div",{style:{color:"#64748B"},children:"Amount Received"}),c.jsx("div",{style:{fontWeight:"700",color:"#059669"},children:tr(z.totals.received)})]}),c.jsxs("div",{style:{padding:"8px",textAlign:"center"},children:[c.jsx("div",{style:{color:"#64748B"},children:"TDS Received"}),c.jsx("div",{style:{fontWeight:"700",color:"#1E293B"},children:tr(z.totals.tds)})]})]}),c.jsx("div",{style:{overflowX:"auto"},children:c.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"11px",minWidth:"1000px"},children:[c.jsx("thead",{children:c.jsxs("tr",{style:{backgroundColor:"#F8FAFC",borderBottom:"2px solid #E2E8F0"},children:[c.jsx("th",{style:{padding:"10px 8px",textAlign:"left",fontWeight:"700",width:"75px",borderRight:"1px solid #E2E8F0"},children:"Date"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"left",fontWeight:"700",minWidth:"150px",borderRight:"1px solid #E2E8F0"},children:"Particular"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"700",width:"80px",borderRight:"1px solid #E2E8F0"},children:"Vch Type"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"left",fontWeight:"700",width:"110px",borderRight:"1px solid #E2E8F0"},children:"Vch No."}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"700",width:"90px",borderRight:"1px solid #E2E8F0"},children:"Debit"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"700",width:"90px",borderRight:"1px solid #E2E8F0"},children:"Credit"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"700",width:"85px",borderRight:"1px solid #E2E8F0"},children:"Date of Receipt"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"700",width:"90px",borderRight:"1px solid #E2E8F0"},children:"Amount Received"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"700",width:"80px",borderRight:"1px solid #E2E8F0"},children:"TDS Received"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"700",width:"85px",borderRight:"1px solid #E2E8F0"},children:"Balance"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"700",width:"75px",borderRight:"1px solid #E2E8F0"},children:"Payment Status"}),Cr&&c.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"700",width:"50px"},children:"Action"})]})}),c.jsx("tbody",{children:z.entries.length===0?c.jsx("tr",{children:c.jsx("td",{colSpan:Cr?"12":"11",style:{padding:"40px",textAlign:"center",color:"#94A3B8"},children:"No entries in selected period"})}):z.entries.map(b=>c.jsxs(ah.Fragment,{children:[c.jsxs("tr",{style:{backgroundColor:b.isOpening?"#FEF3C7":b.hasCN||b.isCreditNote?"#FFFBEB":"#FFFFFF",borderBottom:"1px solid #E2E8F0",borderLeft:b.hasCN||b.isCreditNote?"4px solid #F59E0B":"none"},children:[c.jsx("td",{style:{padding:"8px",borderRight:"1px solid #E2E8F0"},children:b.date?At(b.date):""}),c.jsx("td",{style:{padding:"8px",fontWeight:"600",color:b.isCreditNote?"#DC2626":"#1E293B",borderRight:"1px solid #E2E8F0"},children:b.particular}),c.jsx("td",{style:{padding:"8px",textAlign:"center",borderRight:"1px solid #E2E8F0"},children:b.vchType&&c.jsx("span",{style:{padding:"2px 6px",borderRadius:"4px",fontSize:"10px",fontWeight:"600",backgroundColor:b.vchType==="Sales"?"#DCFCE7":"#FEE2E2",color:b.vchType==="Sales"?"#166534":"#991B1B"},children:b.vchType})}),c.jsx("td",{style:{padding:"8px",borderRight:"1px solid #E2E8F0"},children:b.vchNo&&b.isInvoice&&!b.isHistorical?c.jsx("button",{onClick:()=>m4(b.vchNo),style:{background:"none",border:"none",padding:0,fontWeight:"600",color:"#2874A6",cursor:"pointer",textDecoration:"underline",fontSize:"11px"},title:"Click to view invoice",children:b.vchNo}):c.jsx("span",{style:{fontWeight:"600",color:b.isCreditNote?"#DC2626":"#2874A6"},children:b.vchNo})}),c.jsx("td",{style:{padding:"8px",textAlign:"right",fontWeight:"600",borderRight:"1px solid #E2E8F0"},children:b.debit>0?tr(b.debit):""}),c.jsx("td",{style:{padding:"8px",textAlign:"right",color:"#DC2626",borderRight:"1px solid #E2E8F0"},children:b.credit>0?tr(b.credit):""}),c.jsx("td",{style:{padding:"8px",textAlign:"center",borderRight:"1px solid #E2E8F0"},children:b.receiptDate?At(b.receiptDate):""}),c.jsx("td",{style:{padding:"8px",textAlign:"right",color:"#059669",fontWeight:b.amountReceived>0?"600":"400",borderRight:"1px solid #E2E8F0"},children:b.amountReceived>0?tr(b.amountReceived):""}),c.jsx("td",{style:{padding:"8px",textAlign:"right",borderRight:"1px solid #E2E8F0"},children:b.tdsReceived>0?tr(b.tdsReceived):""}),c.jsx("td",{style:{padding:"8px",textAlign:"right",fontWeight:"600",color:typeof b.balance=="number"&&b.balance>0?"#DC2626":"",borderRight:"1px solid #E2E8F0"},children:b.isOpening?b.balance>0?tr(b.balance):"":b.balance==="-"?"-":typeof b.balance=="number"&&b.balance>0?tr(b.balance):"-"}),c.jsx("td",{style:{padding:"8px",textAlign:"center"},children:b.paymentStatus&&c.jsx("span",{style:{padding:"2px 8px",borderRadius:"4px",fontSize:"10px",fontWeight:"600",backgroundColor:b.paymentStatus==="Received"?"#DCFCE7":"#FEF3C7",color:b.paymentStatus==="Received"?"#166534":"#92400E"},children:b.paymentStatus})}),Cr&&c.jsx("td",{style:{padding:"8px",textAlign:"center"},children:b.isHistorical&&!b.isOpening&&c.jsx("button",{onClick:()=>i4(ie.find(U=>U.id===b.id)),style:{padding:"2px 6px",borderRadius:"4px",fontSize:"10px",fontWeight:"600",backgroundColor:"#FEE2E2",color:"#991B1B",border:"none",cursor:"pointer"},title:"Delete historical entry",children:""})})]}),b.subRows&&b.subRows.length>0&&b.subRows.map((U,oe)=>c.jsxs("tr",{style:{backgroundColor:b.isOpening?"#FEF3C7":b.hasCN||b.isCreditNote?"#FFFBEB":"#FFFFFF",borderBottom:oe===b.subRows.length-1?"2px solid #CBD5E1":"1px solid #E2E8F0",borderLeft:b.hasCN||b.isCreditNote?"4px solid #F59E0B":"none"},children:[c.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),c.jsx("td",{style:{padding:"6px 8px 6px 30px",color:"#475569",fontSize:"12px",borderRight:"1px solid #E2E8F0"},children:U.particular}),c.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),c.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),c.jsx("td",{style:{padding:"6px 8px",textAlign:"right",fontSize:"12px",borderRight:"1px solid #E2E8F0"},children:U.debit?tr(U.debit):""}),c.jsx("td",{style:{padding:"6px 8px",textAlign:"right",fontSize:"12px",borderRight:"1px solid #E2E8F0"},children:U.credit?tr(U.credit):""}),c.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),c.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),c.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),c.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),c.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),Cr&&c.jsx("td",{style:{padding:"6px 8px"}})]},`${b.id}-sub-${oe}`))]},b.id))})]})})]}):c.jsx("div",{style:{padding:"60px",textAlign:"center",color:"#94A3B8"},children:"Select a party to view ledger"})})]})]})},[Fc,by]=ye.useState(""),x0=ye.useMemo(()=>{const h=new Map,_=L=>{if(!L)return"";const se=L.split("/");return se.length>=3?se.slice(1).join("/"):se.length===2?se.join("/"):se[se.length-1]},W=Xn.filter(L=>{var se;return L.isHistorical&&(L.type==="creditnote"||((se=L.vchNo)==null?void 0:se.toUpperCase().startsWith("CN")))}),Z=new Map;return oi.forEach(L=>{const se=_(L.invoiceNo);se&&Z.set(se,L)}),W.forEach(L=>{const se=_(L.vchNo);se&&!Z.has(se)&&Z.set(se,L)}),Fn.filter(L=>L.invoiceGenerated&&L.invoiceStatus==="Approved").forEach(L=>{if(h.has(L.invoiceNo))h.has(L.invoiceNo)&&h.get(L.invoiceNo).campaigns.push(L);else{const se=Xr.find(fe=>fe.invoiceNo===L.invoiceNo),M=oi.find(fe=>fe.invoiceNo===L.invoiceNo),z=parseFloat(L.invoiceTotalAmount)||0,b=M?Math.abs(parseFloat(M.totalAmount)||parseFloat(M.credit)||0):0,U=M&&b>=z,oe=L.clientCode||zr(L.partyName,L.statePartyDetails);if(!se&&!U){const fe=M?z-b:z;h.set(L.invoiceNo,{invoiceNo:L.invoiceNo,partyName:L.partyName,clientCode:oe,invoiceDate:L.invoiceDate,invoiceTotalAmount:L.invoiceTotalAmount,pendingAmount:fe,hasPartialCN:!!M&&!U&&b>0,cnAmount:b,subject:L.subject,campaigns:[L],isHistorical:!1,invoiceType:L.invoiceType||"Individual",source:"Campaign"})}}}),Yr.filter(L=>L.invoiceGenerated&&L.invoiceStatus==="Approved").forEach(L=>{if(!h.has(L.invoiceNo)){const se=Xr.find(fe=>fe.invoiceNo===L.invoiceNo),M=oi.find(fe=>fe.invoiceNo===L.invoiceNo),z=parseFloat(L.invoiceTotalAmount)||0,b=M?Math.abs(parseFloat(M.totalAmount)||parseFloat(M.credit)||0):0,U=M&&b>=z,oe=L.clientCode||zr(L.partyName,L.statePartyDetails);if(!se&&!U){const fe=M?z-b:z;h.set(L.invoiceNo,{invoiceNo:L.invoiceNo,partyName:L.partyName,clientCode:oe,invoiceDate:L.invoiceDate,invoiceTotalAmount:L.invoiceTotalAmount,pendingAmount:fe,hasPartialCN:!!M&&!U&&b>0,cnAmount:b,subject:L.serviceType||"",campaigns:[],isHistorical:!1,invoiceType:"Service",isService:!0,source:"Service"})}}}),Xn.filter(L=>{var se;return L.isHistorical&&L.type!=="creditnote"&&!((se=L.vchNo)!=null&&se.toUpperCase().startsWith("CN"))&&L.debit>0}).forEach(L=>{if(!h.has(L.vchNo)){const se=Xr.find(qe=>qe.invoiceNo===L.vchNo),M=_(L.vchNo),z=Z.get(M),b=z?Math.abs(parseFloat(z.totalAmount)||parseFloat(z.credit)||parseFloat(z.debit)||0):0,U=parseFloat(L.debit)||0,oe=z&&b>=U;if(se||oe)return;const fe=!(L.amountReceived>0),me=z&&b>0&&b<U;if(fe||me){const qe=me?U-b:U;h.set(L.vchNo,{invoiceNo:L.vchNo,partyName:L.partyName,invoiceDate:L.date,invoiceTotalAmount:U,pendingAmount:qe,hasPartialCN:me,cnAmount:b,subject:L.particulars||L.narration,campaigns:[],isHistorical:!0,invoiceType:"Historical",source:"Historical"})}}}),Array.from(h.values()).sort((L,se)=>L.partyName.localeCompare(se.partyName))},[Fn,Yr,Xr,oi,Xn]),J4=ye.useMemo(()=>{const h={};return ma.forEach(_=>{h[_.invoiceNo]||(h[_.invoiceNo]=[]),h[_.invoiceNo].push(_)}),Object.keys(h).forEach(_=>{h[_].sort((W,Z)=>new Date(Z.followupDate)-new Date(W.followupDate))}),h},[ma]),Iy=ye.useMemo(()=>{const h=new Date().toISOString().split("T")[0];return ma.filter(_=>_.nextFollowupDate&&_.nextFollowupDate>=h).sort((_,W)=>new Date(_.nextFollowupDate)-new Date(W.nextFollowupDate))},[ma]),v0=ye.useMemo(()=>{let h=x0;if(Fc){const W=Fc.toLowerCase();h=x0.filter(Z=>{var L,se,M;return((L=Z.invoiceNo)==null?void 0:L.toLowerCase().includes(W))||((se=Z.partyName)==null?void 0:se.toLowerCase().includes(W))||((M=Z.subject)==null?void 0:M.toLowerCase().includes(W))})}const _={};return h.forEach(W=>{const Z=W.clientCode||"",L=`${W.partyName}|||${Z}`;_[L]||(_[L]={partyName:W.partyName,clientCode:Z,invoices:[],totalAmount:0}),_[L].invoices.push(W),_[L].totalAmount+=parseFloat(W.pendingAmount||W.invoiceTotalAmount)||0}),Object.values(_).sort((W,Z)=>{const L=W.partyName.localeCompare(Z.partyName);return L!==0?L:(W.clientCode||"").localeCompare(Z.clientCode||"")})},[x0,Fc]),Z4=()=>{const h=v0.reduce((_,W)=>_+W.invoices.length,0);return c.jsxs("div",{children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[c.jsx("h1",{style:{margin:0,fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:" Followups"}),c.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[c.jsxs("span",{style:{padding:"6px 12px",backgroundColor:"#EFF6FF",borderRadius:"6px",fontSize:"12px",color:"#1E40AF",fontWeight:"600"},children:[v0.length," Parties | ",h," Invoices"]}),li&&c.jsx("span",{style:{padding:"8px 16px",backgroundColor:"#FEF3C7",borderRadius:"8px",fontSize:"13px",color:"#92400E",fontWeight:"600"},children:" View Only"})]})]}),c.jsx("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"10px",border:"1px solid #E2E8F0",padding:"14px 18px",marginBottom:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"14px",flexWrap:"wrap"},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[c.jsx(gd,{size:18,color:"#64748B"}),c.jsx("span",{style:{fontSize:"13px",fontWeight:"700",color:"#475569"},children:"Search:"})]}),c.jsxs("div",{style:{position:"relative",flex:1,maxWidth:"300px"},children:[c.jsx(Q0,{size:14,style:{position:"absolute",left:"10px",top:"50%",transform:"translateY(-50%)",color:"#94A3B8"}}),c.jsx("input",{type:"text",placeholder:"Search party, invoice, subject...",value:Fc,onChange:_=>by(_.target.value),style:{padding:"8px 12px 8px 32px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",width:"100%"}})]}),Fc&&c.jsxs("button",{onClick:()=>by(""),style:{padding:"8px 12px",fontSize:"13px",fontWeight:"600",border:"1.5px solid #FCA5A5",borderRadius:"8px",backgroundColor:"#FEE2E2",color:"#991B1B",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},children:[c.jsx(Ta,{size:14})," Clear"]}),Fc&&c.jsxs("span",{style:{fontSize:"13px",color:"#64748B"},children:["Showing ",h," of ",x0.length]})]})}),Iy.length>0&&c.jsx(En,{title:" Upcoming Followups",style:{marginBottom:"16px"},children:c.jsx("div",{style:{display:"flex",gap:"12px",flexWrap:"wrap"},children:Iy.slice(0,5).map(_=>c.jsxs("div",{style:{padding:"10px 14px",backgroundColor:new Date(_.nextFollowupDate).toISOString().split("T")[0]===new Date().toISOString().split("T")[0]?"#FEE2E2":"#FEF3C7",borderRadius:"8px",border:"1px solid #FCD34D"},children:[c.jsx("div",{style:{fontWeight:"600",fontSize:"13px",color:"#92400E"},children:_.invoiceNo}),c.jsx("div",{style:{fontSize:"11px",color:"#78716C"},children:_.partyName}),c.jsxs("div",{style:{fontSize:"12px",fontWeight:"600",color:"#DC2626",marginTop:"4px"},children:[" ",At(_.nextFollowupDate)]})]},_.id))})}),v0.length===0?c.jsx(En,{children:c.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#94A3B8"},children:" No pending invoices! All payments received."})}):v0.map(_=>c.jsxs(En,{style:{marginBottom:"16px"},noPadding:!0,children:[c.jsxs("div",{style:{padding:"12px 16px",backgroundColor:"#1E293B",color:"white",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[c.jsxs("span",{style:{fontSize:"15px",fontWeight:"700"},children:[" ",_.partyName]}),_.clientCode&&c.jsx("span",{style:{padding:"2px 8px",backgroundColor:"#9333EA",borderRadius:"6px",fontSize:"11px",fontWeight:"700"},children:_.clientCode}),c.jsxs("span",{style:{padding:"3px 10px",backgroundColor:"#3B82F6",borderRadius:"12px",fontSize:"11px",fontWeight:"600"},children:[_.invoices.length," Invoice",_.invoices.length>1?"s":""]})]}),c.jsxs("div",{style:{fontSize:"14px",fontWeight:"700",color:"#FCD34D"},children:["Total: ",at(_.totalAmount)]})]}),c.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"12px"},children:[c.jsx("thead",{children:c.jsxs("tr",{style:{backgroundColor:"#F8FAFC",borderBottom:"2px solid #E2E8F0"},children:[c.jsx("th",{style:{padding:"10px 12px",textAlign:"left",fontWeight:"700"},children:"Invoice No"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700",color:"#6B21A8",backgroundColor:"#FAF5FF"},children:"Code"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Type"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Invoice Date"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700"},children:"Amount"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Days Pending"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Last Followup"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Actions"})]})}),c.jsx("tbody",{children:_.invoices.map(W=>{var b,U,oe;const Z=J4[W.invoiceNo]||[],L=Z[0],se=Math.floor((new Date-new Date(W.invoiceDate))/(1e3*60*60*24)),M=W.isHistorical?"Historical":W.isService?"Service":W.invoiceType||(((b=W.campaigns)==null?void 0:b.length)>1?"Combined":"Individual"),z=W.clientCode||(W.campaigns&&W.campaigns[0]?zr(W.campaigns[0].partyName,W.campaigns[0].statePartyDetails):"");return c.jsxs(ah.Fragment,{children:[c.jsxs("tr",{style:{borderBottom:"1px solid #E2E8F0",backgroundColor:se>30?"#FEF2F2":se>15?"#FFFBEB":"#FFFFFF"},children:[c.jsxs("td",{style:{padding:"10px 12px",fontWeight:"600",color:"#2874A6"},children:[W.invoiceNo,W.hasPartialCN&&c.jsx("span",{style:{marginLeft:"6px",padding:"2px 6px",backgroundColor:"#FEF3C7",color:"#92400E",borderRadius:"4px",fontSize:"9px",fontWeight:"700"},children:"Partial CN"})]}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"center",backgroundColor:"#FAF5FF"},children:c.jsx("span",{style:{fontWeight:"700",color:"#6B21A8",fontSize:"11px"},children:z||"-"})}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:c.jsx("span",{style:{padding:"3px 8px",borderRadius:"6px",fontSize:"10px",fontWeight:"600",backgroundColor:M==="Historical"?"#E0E7FF":M==="Service"?"#FEF3C7":M==="Combined"?"#F3E8FF":"#DCFCE7",color:M==="Historical"?"#3730A3":M==="Service"?"#92400E":M==="Combined"?"#7C3AED":"#166534"},children:M})}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:At(W.invoiceDate)}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"600"},children:W.hasPartialCN?c.jsxs("div",{children:[c.jsx("div",{style:{color:"#DC2626"},children:at(W.pendingAmount)}),c.jsx("div",{style:{fontSize:"9px",color:"#64748B",textDecoration:"line-through"},children:at(W.invoiceTotalAmount)})]}):at(W.invoiceTotalAmount)}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:c.jsxs("span",{style:{padding:"3px 10px",borderRadius:"12px",fontSize:"11px",fontWeight:"700",backgroundColor:se>30?"#FEE2E2":se>15?"#FEF3C7":"#DCFCE7",color:se>30?"#991B1B":se>15?"#92400E":"#166534"},children:[se," days"]})}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"center",fontSize:"11px"},children:L?c.jsxs("div",{children:[c.jsx("div",{style:{fontWeight:"600"},children:At(L.followupDate)}),c.jsxs("div",{style:{color:"#64748B",fontSize:"10px"},children:[(U=L.notes)==null?void 0:U.substring(0,30),((oe=L.notes)==null?void 0:oe.length)>30?"...":""]})]}):c.jsx("span",{style:{color:"#DC2626",fontWeight:"600"},children:"No followup yet"})}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:c.jsxs("div",{style:{display:"flex",gap:"4px",justifyContent:"center"},children:[Cr&&c.jsx(Ye,{icon:md,small:!0,variant:"primary",onClick:()=>a4(W),title:"Add Followup"}),c.jsx(Ye,{icon:nm,small:!0,variant:"brand",onClick:()=>xy(W),title:"Copy Email Template"}),c.jsx(Ye,{icon:X0,small:!0,variant:"success",onClick:()=>vy(W),title:"Search in Gmail"})]})})]}),Z.length>0&&c.jsx("tr",{children:c.jsxs("td",{colSpan:"8",style:{padding:"8px 12px 12px 40px",backgroundColor:"#F8FAFC"},children:[c.jsx("div",{style:{fontSize:"11px",fontWeight:"600",color:"#64748B",marginBottom:"6px"},children:"Followup History:"}),c.jsx("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:Z.map(fe=>c.jsxs("div",{style:{padding:"6px 10px",backgroundColor:"#FFFFFF",borderRadius:"6px",border:"1px solid #E2E8F0",fontSize:"11px"},children:[c.jsx("div",{style:{fontWeight:"600",color:"#2874A6"},children:At(fe.followupDate)}),c.jsx("div",{style:{color:"#475569",marginTop:"2px"},children:fe.notes}),fe.nextFollowupDate&&c.jsxs("div",{style:{color:"#DC2626",marginTop:"2px",fontSize:"10px"},children:["Next: ",At(fe.nextFollowupDate)]}),Cr&&c.jsx("button",{onClick:()=>l4(fe.id),style:{background:"none",border:"none",color:"#DC2626",cursor:"pointer",fontSize:"10px",padding:"2px 0",marginTop:"4px"},children:" Delete"})]},fe.id))})]})})]},W.invoiceNo)})})]})]},`${_.partyName}|||${_.clientCode}`))]})},Ny=()=>{const h=Se.filter(L=>L.invoiceGenerated).reduce((L,se)=>L+(parseFloat(se.invoiceTotalAmount)||0),0),_=Se.filter(L=>L.invoiceStatus==="Paid").reduce((L,se)=>L+(parseFloat(se.invoiceTotalAmount)||0),0),W=Se.filter(L=>L.invoiceStatus==="Approved").reduce((L,se)=>L+(parseFloat(se.invoiceTotalAmount)||0),0),Z=Se.filter(L=>L.invoiceStatus==="Need Edits").length;return c.jsxs("div",{children:[c.jsx("h1",{style:{margin:"0 0 16px",fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:" Reports"}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"16px"},children:[c.jsxs(En,{children:[c.jsx("div",{style:{fontSize:"14px",color:"#64748B",marginBottom:"8px"},children:"Total Invoiced"}),c.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:at(h)})]}),c.jsxs(En,{children:[c.jsx("div",{style:{fontSize:"14px",color:"#64748B",marginBottom:"8px"},children:"Approved"}),c.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#059669"},children:at(W)})]}),c.jsxs(En,{children:[c.jsx("div",{style:{fontSize:"14px",color:"#64748B",marginBottom:"8px"},children:"Need Edits"}),c.jsxs("div",{style:{fontSize:"24px",fontWeight:"700",color:"#DC2626"},children:[Z," invoices"]})]}),c.jsxs(En,{children:[c.jsx("div",{style:{fontSize:"14px",color:"#64748B",marginBottom:"8px"},children:"Paid"}),c.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#059669"},children:at(_)})]})]})]})},eb=()=>c.jsxs("div",{children:[c.jsx("h1",{style:{margin:"0 0 16px",fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:" Settings"}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px"},children:[c.jsxs(En,{title:" Invoice Series",children:[c.jsx(Hr,{label:"Invoice Prefix",value:T.invoicePrefix,onChange:h=>N(_=>({..._,invoicePrefix:h.target.value})),small:!0}),c.jsx(Hr,{label:"Next Invoice Number",type:"number",value:ot,onChange:h=>ee(parseInt(h.target.value)||1),small:!0}),c.jsx(Hr,{label:"Next Combine Code",type:"number",value:Ot,onChange:h=>wt(parseInt(h.target.value)||1),small:!0}),c.jsxs("div",{style:{padding:"10px",backgroundColor:"#EFF6FF",borderRadius:"8px",fontSize:"14px"},children:[c.jsx("strong",{children:"Preview:"})," ",T.invoicePrefix,ot]})]}),c.jsxs(En,{title:" Mailer Logo",children:[c.jsx("input",{type:"file",ref:wc,accept:"image/*",style:{display:"none"},onChange:b4}),Kn?c.jsxs("div",{style:{textAlign:"center"},children:[c.jsx("img",{src:Kn,alt:"Logo",style:{maxWidth:"250px",maxHeight:"60px",marginBottom:"12px",border:"1px solid #E2E8F0",padding:"8px",borderRadius:"8px"}}),c.jsxs("div",{style:{display:"flex",gap:"8px",justifyContent:"center"},children:[c.jsx(Ye,{icon:VL,label:"Change",small:!0,onClick:()=>{var h;return(h=wc.current)==null?void 0:h.click()}}),c.jsx(Ye,{icon:as,label:"Remove",variant:"danger",small:!0,onClick:()=>ga(null)})]})]}):c.jsxs("div",{onClick:()=>{var h;return(h=wc.current)==null?void 0:h.click()},style:{border:"2px dashed #CBD5E1",borderRadius:"10px",padding:"30px",textAlign:"center",cursor:"pointer"},children:[c.jsx(Xs,{size:32,color:"#94A3B8",style:{marginBottom:"8px"}}),c.jsx("p",{style:{margin:0,color:"#64748B",fontSize:"14px"},children:"Click to upload"})]})]}),c.jsxs(En,{title:" WhatsApp Notifications",children:[c.jsx("div",{style:{marginBottom:"16px"},children:c.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"10px",cursor:"pointer"},children:[c.jsx("input",{type:"checkbox",checked:bt.enabled,onChange:h=>fa(_=>({..._,enabled:h.target.checked})),style:{width:"18px",height:"18px",cursor:"pointer"}}),c.jsx("span",{style:{fontSize:"14px",fontWeight:"600",color:"#1E293B"},children:"Enable WhatsApp Notifications"})]})}),bt.enabled&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{style:{padding:"12px",backgroundColor:"#DCFCE7",borderRadius:"8px",marginBottom:"16px",fontSize:"12px",color:"#166534",border:"1px solid #86EFAC"},children:[c.jsx("strong",{children:" FREE Setup using CallMeBot:"}),c.jsx("br",{}),"1. Save this number in contacts: ",c.jsx("strong",{children:"+34 644 71 81 99"}),c.jsx("br",{}),"2. Send this message to the number on WhatsApp: ",c.jsx("strong",{children:'"I allow callmebot to send me messages"'}),c.jsx("br",{}),"3. You'll receive an API key - enter it below",c.jsx("br",{}),"4. Repeat for each phone number you want to receive notifications"]}),c.jsxs("div",{style:{padding:"14px",backgroundColor:"#F8FAFC",borderRadius:"8px",marginBottom:"12px",border:"1px solid #E2E8F0"},children:[c.jsxs("div",{style:{fontSize:"13px",fontWeight:"700",color:"#1E293B",marginBottom:"10px",display:"flex",alignItems:"center",gap:"6px"},children:[c.jsx(q0,{size:16})," Finance Team"]}),c.jsx(Hr,{label:"Phone (with country code)",value:bt.financePhone,onChange:h=>fa(_=>({..._,financePhone:h.target.value})),placeholder:"919876543210",small:!0}),c.jsx(Hr,{label:"API Key (from CallMeBot)",value:bt.financeApiKey,onChange:h=>fa(_=>({..._,financeApiKey:h.target.value})),placeholder:"123456",small:!0}),bt.financePhone&&bt.financeApiKey&&c.jsx(Ye,{icon:sE,label:"Test Finance",variant:"success",small:!0,onClick:()=>Fl(bt.financePhone,bt.financeApiKey)})]}),c.jsxs("div",{style:{padding:"14px",backgroundColor:"#F8FAFC",borderRadius:"8px",border:"1px solid #E2E8F0"},children:[c.jsxs("div",{style:{fontSize:"13px",fontWeight:"700",color:"#1E293B",marginBottom:"10px",display:"flex",alignItems:"center",gap:"6px"},children:[c.jsx(q0,{size:16})," Director"]}),c.jsx(Hr,{label:"Phone (with country code)",value:bt.directorPhone,onChange:h=>fa(_=>({..._,directorPhone:h.target.value})),placeholder:"919876543210",small:!0}),c.jsx(Hr,{label:"API Key (from CallMeBot)",value:bt.directorApiKey,onChange:h=>fa(_=>({..._,directorApiKey:h.target.value})),placeholder:"123456",small:!0}),bt.directorPhone&&bt.directorApiKey&&c.jsx(Ye,{icon:sE,label:"Test Director",variant:"success",small:!0,onClick:()=>Fl(bt.directorPhone,bt.directorApiKey)})]})]}),!bt.enabled&&c.jsx("div",{style:{padding:"20px",backgroundColor:"#F8FAFC",borderRadius:"8px",textAlign:"center",color:"#64748B",fontSize:"13px"},children:"WhatsApp notifications are disabled. Enable to receive FREE alerts for invoices, approvals, and payments."})]}),c.jsxs(En,{title:" Default Invoice Values",children:[c.jsx("input",{type:"file",ref:Tc,accept:".xlsx,.xls,.csv",style:{display:"none"},onChange:u4}),c.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"12px"},children:[c.jsx(Ye,{icon:Xs,label:"Upload",variant:"brand",small:!0,onClick:()=>{var h;return(h=Tc.current)==null?void 0:h.click()}}),c.jsx(Ye,{icon:Po,label:"Template",small:!0,onClick:d4})]}),Object.keys(Wi).length>0&&c.jsx("div",{style:{maxHeight:"180px",overflowY:"auto",border:"1px solid #E2E8F0",borderRadius:"8px"},children:Object.entries(Wi).map(([h,_])=>c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"10px 14px",borderBottom:"1px solid #F1F5F9",fontSize:"13px"},children:[c.jsx("span",{children:h}),c.jsx("span",{style:{fontWeight:"700"},children:at(_)})]},h))})]}),c.jsxs(En,{title:" Party Master",children:[c.jsx("input",{type:"file",ref:Xu,accept:".xlsx,.xls,.csv",style:{display:"none"},onChange:f4}),c.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"12px"},children:[c.jsx(Ye,{icon:Xs,label:"Upload Parties",variant:"brand",small:!0,onClick:()=>{var h;return(h=Xu.current)==null?void 0:h.click()}}),c.jsx(Ye,{icon:Po,label:"Template",small:!0,onClick:h4})]}),c.jsxs("div",{style:{padding:"10px",backgroundColor:"#EFF6FF",borderRadius:"8px",fontSize:"12px",color:"#1E40AF",marginBottom:"12px"},children:[c.jsx("strong",{children:"Upload Format:"})," Name of Ledger, Ledger Group, State Name, GST Registration Type, GSTIN/UIN"]}),Object.keys(un).length>0&&c.jsxs("div",{style:{maxHeight:"150px",overflowY:"auto",border:"1px solid #E2E8F0",borderRadius:"8px"},children:[Object.entries(un).slice(0,20).map(([h,_])=>c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px 12px",borderBottom:"1px solid #F1F5F9",fontSize:"11px"},children:[c.jsx("span",{style:{fontWeight:"600"},children:h.length>30?h.substring(0,30)+"...":h}),c.jsxs("span",{style:{color:"#64748B"},children:[_.stateName||"-"," | ",_.gstin?_.gstin.substring(0,10)+"...":"-"]})]},h)),Object.keys(un).length>20&&c.jsxs("div",{style:{padding:"8px 12px",textAlign:"center",color:"#64748B",fontSize:"11px"},children:["... and ",Object.keys(un).length-20," more parties"]})]}),Object.keys(un).length===0&&c.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#94A3B8",fontSize:"13px"},children:"No party master uploaded yet"})]}),c.jsxs(En,{title:" Data Management",children:[c.jsxs("div",{style:{padding:"16px",backgroundColor:"#FEF2F2",borderRadius:"10px",border:"1px solid #FCA5A5",marginBottom:"16px"},children:[c.jsx("div",{style:{fontWeight:"700",color:"#991B1B",fontSize:"14px",marginBottom:"8px"},children:" Danger Zone"}),c.jsxs("div",{style:{fontSize:"13px",color:"#7F1D1D",marginBottom:"16px"},children:["This will permanently delete all data including:",c.jsxs("ul",{style:{margin:"8px 0 0 16px",padding:0},children:[c.jsx("li",{children:"All campaigns and master data"}),c.jsx("li",{children:"All invoices and receipts"}),c.jsx("li",{children:"All ledger entries"}),c.jsx("li",{children:"All mailer images"}),c.jsx("li",{children:"Opening balances and settings"})]})]}),c.jsx(Ye,{icon:as,label:"Clear All Data",variant:"danger",onClick:()=>zs(!0)})]}),c.jsxs("div",{style:{fontSize:"12px",color:"#64748B"},children:[c.jsx("strong",{children:"Current Data:"}),c.jsx("br",{})," ",Se.length," campaigns",c.jsx("br",{})," ",ie.length," ledger entries",c.jsx("br",{})," ",Me.length," receipts",c.jsx("br",{})," ",Object.keys(It).length," mailer images"]})]})]})]}),tb=()=>c.jsxs(c.Fragment,{children:[c.jsx(Un,{isOpen:I4,onClose:()=>{Sy(!1),Ty("")},title:" Invoice Preview",width:"950px",children:ce&&wy&&c.jsxs("div",{children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px",padding:"14px 18px",backgroundColor:"#DCFCE7",borderRadius:"10px",border:"2px solid #22C55E"},children:[c.jsxs("div",{children:[c.jsxs("span",{style:{fontWeight:"700",fontSize:"16px",color:"#166534"},children:["Invoice: ",ce.invoiceNo]}),ce.invoiceType==="Combined"&&c.jsxs("span",{style:{marginLeft:"12px",padding:"4px 10px",backgroundColor:"#7C3AED",color:"white",borderRadius:"6px",fontSize:"12px",fontWeight:"600"},children:["Combined - C",ce.combinationCode]})]}),c.jsxs("button",{onClick:()=>N4(ce),style:{padding:"14px 28px",fontSize:"16px",fontWeight:"bold",border:"none",borderRadius:"10px",cursor:"pointer",backgroundColor:"#22C55E",color:"white",display:"flex",alignItems:"center",gap:"10px",boxShadow:"0 2px 8px rgba(34, 197, 94, 0.4)"},children:[c.jsx(Po,{size:20}),"Download Invoice"]})]}),c.jsx("div",{style:{border:"2px solid #E2E8F0",borderRadius:"10px",overflow:"hidden",backgroundColor:"#f5f5f5"},children:c.jsx("iframe",{id:"invoice-viewer-iframe",srcDoc:wy,style:{width:"100%",height:"480px",border:"none",backgroundColor:"white"},title:"Invoice Preview"})}),c.jsxs("div",{style:{marginTop:"12px",padding:"14px 18px",backgroundColor:"#FEF3C7",borderRadius:"10px",border:"1px solid #FCD34D"},children:[c.jsx("div",{style:{fontSize:"14px",color:"#92400E",fontWeight:"600",marginBottom:"6px"},children:" How to Save as PDF:"}),c.jsxs("ol",{style:{fontSize:"13px",color:"#92400E",margin:"0",paddingLeft:"20px",lineHeight:"1.8"},children:[c.jsxs("li",{children:["Click ",c.jsx("strong",{children:'"Download Invoice"'})," button above"]}),c.jsxs("li",{children:["Open the downloaded ",c.jsx("strong",{children:".html file"})," in Chrome/Edge browser"]}),c.jsxs("li",{children:["Print dialog will open automatically - select ",c.jsx("strong",{children:'"Save as PDF"'})]}),c.jsxs("li",{children:["Click ",c.jsx("strong",{children:"Save"})," to get your PDF!"]})]})]})]})}),c.jsx(Un,{isOpen:Ur,onClose:()=>{Bn(!1),Vr(""),Fi({particularsApproved:!1,emailApproved:!1,invoiceTypeApproved:!1})},title:li?" Review & Approve Invoice":" Invoice Details",width:"550px",children:ce&&c.jsxs("div",{children:[c.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px",borderRadius:"10px",marginBottom:"16px"},children:[c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Invoice:"})," ",ce.invoiceNo]}),c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Party:"})," ",ce.partyName]}),c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Amount:"})," ",at(ce.invoiceTotalAmount)]}),c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Email:"})," ",ce.emailId||"Not set"]}),c.jsxs("div",{style:{fontSize:"14px"},children:[c.jsx("strong",{children:"Invoice Type:"})," ",c.jsx("span",{style:{color:ce.invoiceType==="Combined"?"#7C3AED":"#2874A6",fontWeight:"600"},children:ce.invoiceType||"Individual"})]}),ce.invoiceType==="Combined"&&c.jsxs("div",{style:{marginTop:"8px",fontSize:"13px",color:"#7C3AED"},children:[c.jsx("strong",{children:"Combined Campaigns:"})," ",ue(ce).map(h=>h.senderName).join(", ")]})]}),ce.editComments&&c.jsxs("div",{style:{backgroundColor:"#FEE2E2",padding:"12px",borderRadius:"8px",marginBottom:"16px",border:"1px solid #FCA5A5"},children:[c.jsx("div",{style:{fontWeight:"600",color:"#991B1B",fontSize:"13px",marginBottom:"4px"},children:" Need Edits - Director Remarks:"}),c.jsx("div",{style:{fontSize:"13px",color:"#7F1D1D"},children:ce.editComments})]}),ce.approvalRemarks&&ce.invoiceStatus==="Approved"&&c.jsxs("div",{style:{backgroundColor:"#DCFCE7",padding:"12px",borderRadius:"8px",marginBottom:"16px",border:"1px solid #86EFAC"},children:[c.jsx("div",{style:{fontWeight:"600",color:"#166534",fontSize:"13px",marginBottom:"4px"},children:" Approved - Director Remarks:"}),c.jsx("div",{style:{fontSize:"13px",color:"#15803D"},children:ce.approvalRemarks})]}),li?c.jsxs("div",{style:{backgroundColor:"#F0FDF4",padding:"16px",borderRadius:"10px",marginBottom:"16px",border:"1px solid #86EFAC"},children:[c.jsx("div",{style:{fontWeight:"700",color:"#166534",fontSize:"14px",marginBottom:"12px"},children:" Approval Confirmations"}),c.jsxs("label",{style:{display:"flex",alignItems:"flex-start",gap:"10px",marginBottom:"12px",cursor:"pointer"},children:[c.jsx("input",{type:"checkbox",checked:Eo.particularsApproved,onChange:h=>Fi(_=>({..._,particularsApproved:h.target.checked})),style:{marginTop:"2px",width:"18px",height:"18px",accentColor:"#059669"}}),c.jsxs("div",{children:[c.jsx("div",{style:{fontWeight:"600",fontSize:"13px",color:"#166534"},children:"1. Particulars & Amount Approved"}),c.jsxs("div",{style:{fontSize:"12px",color:"#15803D"},children:["I confirm that the invoice particulars and amount (",at(ce.invoiceTotalAmount),") are correct."]})]})]}),c.jsxs("label",{style:{display:"flex",alignItems:"flex-start",gap:"10px",marginBottom:"12px",cursor:"pointer"},children:[c.jsx("input",{type:"checkbox",checked:Eo.emailApproved,onChange:h=>Fi(_=>({..._,emailApproved:h.target.checked})),style:{marginTop:"2px",width:"18px",height:"18px",accentColor:"#059669"}}),c.jsxs("div",{children:[c.jsx("div",{style:{fontWeight:"600",fontSize:"13px",color:"#166534"},children:"2. Email ID Approved for Mailing"}),c.jsxs("div",{style:{fontSize:"12px",color:"#15803D"},children:["I confirm that ",c.jsx("strong",{children:ce.emailId||"the specified email"})," should be used for mailing."]})]})]}),c.jsxs("label",{style:{display:"flex",alignItems:"flex-start",gap:"10px",cursor:"pointer"},children:[c.jsx("input",{type:"checkbox",checked:Eo.invoiceTypeApproved,onChange:h=>Fi(_=>({..._,invoiceTypeApproved:h.target.checked})),style:{marginTop:"2px",width:"18px",height:"18px",accentColor:"#059669"}}),c.jsxs("div",{children:[c.jsx("div",{style:{fontWeight:"600",fontSize:"13px",color:"#166534"},children:"3. Invoice Type Confirmed"}),c.jsx("div",{style:{fontSize:"12px",color:"#15803D"},children:ce.invoiceType==="Combined"?`I confirm that a Combined Invoice is required for these ${ue(ce).length} campaigns.`:"I confirm that an Individual Invoice is required (not combined with others)."})]})]})]}):c.jsxs("div",{style:{backgroundColor:ce.invoiceStatus==="Approved"?"#DCFCE7":ce.invoiceStatus==="Need Edits"?"#FEF3C7":"#F8FAFC",padding:"16px",borderRadius:"10px",marginBottom:"16px",border:"1px solid "+(ce.invoiceStatus==="Approved"?"#86EFAC":ce.invoiceStatus==="Need Edits"?"#FCD34D":"#E2E8F0")},children:[c.jsx("div",{style:{fontWeight:"600",color:ce.invoiceStatus==="Approved"?"#166534":ce.invoiceStatus==="Need Edits"?"#92400E":"#64748B",fontSize:"14px"},children:ce.invoiceStatus==="Approved"?" Approved by Director":ce.invoiceStatus==="Need Edits"?" Edits Required by Director":" Pending Director Approval"}),c.jsx("div",{style:{fontSize:"13px",color:ce.invoiceStatus==="Approved"?"#15803D":ce.invoiceStatus==="Need Edits"?"#A16207":"#64748B",marginTop:"6px"},children:ce.invoiceStatus==="Approved"?"This invoice has been approved and is ready for mailing.":ce.invoiceStatus==="Need Edits"?"Please make the required changes and resubmit for approval.":"This invoice is awaiting Director approval."})]}),li&&c.jsxs("div",{style:{marginBottom:"16px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:" Remarks (optional for Approve, visible to Finance)"}),c.jsx("textarea",{value:ua,onChange:h=>Vr(h.target.value),placeholder:"Enter remarks or comments...",style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"13px",minHeight:"80px",resize:"vertical",boxSizing:"border-box"}})]}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[c.jsx(Ye,{label:"Close",onClick:()=>{Bn(!1),Vr(""),Fi({particularsApproved:!1,emailApproved:!1,invoiceTypeApproved:!1})}}),li&&c.jsxs(c.Fragment,{children:[c.jsx(Ye,{label:"Need Edits",variant:"danger",icon:UL,onClick:No}),c.jsx(Ye,{label:"Approve",variant:"success",icon:HL,onClick:Ln})]})]})]})}),c.jsx(Un,{isOpen:yo,onClose:()=>_o(!1),title:" Delete Invoice",width:"450px",children:ce&&c.jsxs("div",{children:[c.jsxs("div",{style:{backgroundColor:"#FEE2E2",padding:"16px",borderRadius:"10px",marginBottom:"16px",border:"1px solid #FCA5A5"},children:[c.jsx("div",{style:{fontWeight:"700",color:"#991B1B",fontSize:"15px",marginBottom:"8px"},children:" Are you sure?"}),c.jsxs("div",{style:{fontSize:"14px",color:"#7F1D1D",lineHeight:"1.5"},children:["This will delete invoice ",c.jsx("strong",{children:ce.invoiceNo})," and reset the campaign(s) to allow re-generation.",ce.invoiceType==="Combined"&&c.jsxs("div",{style:{marginTop:"8px"},children:[c.jsxs("strong",{children:["All ",ue(ce).length," combined campaigns"]})," will be reset to Individual type for re-selection."]})]})]}),c.jsxs("div",{style:{backgroundColor:"#F8FAFC",padding:"12px",borderRadius:"8px",marginBottom:"16px"},children:[c.jsxs("div",{style:{fontSize:"13px"},children:[c.jsx("strong",{children:"Invoice:"})," ",ce.invoiceNo]}),c.jsxs("div",{style:{fontSize:"13px"},children:[c.jsx("strong",{children:"Party:"})," ",ce.partyName]}),c.jsxs("div",{style:{fontSize:"13px"},children:[c.jsx("strong",{children:"Amount:"})," ",at(ce.invoiceTotalAmount)]})]}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[c.jsx(Ye,{label:"Cancel",onClick:()=>_o(!1)}),c.jsx(Ye,{label:"Delete Invoice",variant:"danger",icon:as,onClick:t4})]})]})}),c.jsx(Un,{isOpen:Rr,onClose:()=>Lr(!1),title:" Add Email Address",width:"400px",children:ce&&c.jsxs("div",{children:[c.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"12px",borderRadius:"8px",marginBottom:"16px"},children:[c.jsxs("div",{style:{fontSize:"13px"},children:[c.jsx("strong",{children:"Campaign:"})," ",ce.senderName]}),c.jsxs("div",{style:{fontSize:"13px",marginTop:"4px"},children:[c.jsx("strong",{children:"Current:"})," ",ce.emailId||"None"]})]}),c.jsx(Hr,{label:"Additional Email Address",type:"email",value:Ua,onChange:h=>ys(h.target.value),placeholder:"email@example.com",small:!0}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"16px"},children:[c.jsx(Ye,{label:"Cancel",onClick:()=>Lr(!1)}),c.jsx(Ye,{label:"Add Email",variant:"brand",icon:sm,onClick:()=>{Ua&&Ua.includes("@")?(bn(ce.id,Ua),Lr(!1),ys("")):alert("Please enter a valid email address")}})]})]})}),c.jsx(Un,{isOpen:C,onClose:()=>{E(!1),Q({currentPassword:"",newPassword:"",confirmPassword:""}),w("")},title:" Change Password",width:"400px",children:c.jsxs("div",{children:[c.jsx("div",{style:{backgroundColor:"#EFF6FF",padding:"12px",borderRadius:"8px",marginBottom:"16px"},children:c.jsxs("div",{style:{fontSize:"13px"},children:[c.jsx("strong",{children:"User:"})," ",r==="director"?"Director":"Finance Team"]})}),c.jsxs("div",{style:{marginBottom:"16px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Current Password"}),c.jsx("input",{type:"password",value:O.currentPassword,onChange:h=>Q(_=>({..._,currentPassword:h.target.value})),placeholder:"Enter current password",style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"14px",boxSizing:"border-box"}})]}),c.jsxs("div",{style:{marginBottom:"16px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"New Password"}),c.jsx("input",{type:"password",value:O.newPassword,onChange:h=>Q(_=>({..._,newPassword:h.target.value})),placeholder:"Enter new password (min 6 characters)",style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"14px",boxSizing:"border-box"}})]}),c.jsxs("div",{style:{marginBottom:"16px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Confirm New Password"}),c.jsx("input",{type:"password",value:O.confirmPassword,onChange:h=>Q(_=>({..._,confirmPassword:h.target.value})),placeholder:"Confirm new password",onKeyPress:h=>h.key==="Enter"&&Io(),style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"14px",boxSizing:"border-box"}})]}),H&&c.jsx("div",{style:{marginBottom:"16px",padding:"10px",backgroundColor:"#FEE2E2",borderRadius:"8px",color:"#991B1B",fontSize:"13px"},children:H}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:[c.jsx(Ye,{label:"Cancel",onClick:()=>{E(!1),Q({currentPassword:"",newPassword:"",confirmPassword:""}),w("")}}),c.jsx(Ye,{label:"Change Password",variant:"brand",icon:Y0,onClick:Io})]})]})}),c.jsx(Un,{isOpen:C,onClose:()=>{E(!1),w(""),Q({currentPassword:"",newPassword:"",confirmPassword:""})},title:" Change Password",width:"400px",children:c.jsxs("div",{children:[c.jsx("div",{style:{backgroundColor:"#EFF6FF",padding:"12px",borderRadius:"8px",marginBottom:"16px"},children:c.jsxs("div",{style:{fontSize:"13px",color:"#1E40AF"},children:["Changing password for: ",c.jsx("strong",{children:r==="director"?"Director":"Finance Team"})]})}),c.jsxs("div",{style:{marginBottom:"16px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Current Password"}),c.jsx("input",{type:"password",value:O.currentPassword,onChange:h=>Q(_=>({..._,currentPassword:h.target.value})),placeholder:"Enter current password",style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"14px",boxSizing:"border-box"}})]}),c.jsxs("div",{style:{marginBottom:"16px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"New Password"}),c.jsx("input",{type:"password",value:O.newPassword,onChange:h=>Q(_=>({..._,newPassword:h.target.value})),placeholder:"Enter new password (min 6 chars)",style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"14px",boxSizing:"border-box"}})]}),c.jsxs("div",{style:{marginBottom:"16px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Confirm New Password"}),c.jsx("input",{type:"password",value:O.confirmPassword,onChange:h=>Q(_=>({..._,confirmPassword:h.target.value})),placeholder:"Re-enter new password",style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"14px",boxSizing:"border-box"}})]}),H&&c.jsx("div",{style:{marginBottom:"16px",padding:"10px",backgroundColor:"#FEE2E2",borderRadius:"8px",color:"#991B1B",fontSize:"13px"},children:H}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:[c.jsx(Ye,{label:"Cancel",onClick:()=>{E(!1),w(""),Q({currentPassword:"",newPassword:"",confirmPassword:""})}}),c.jsx(Ye,{label:"Change Password",variant:"brand",icon:Y0,onClick:Io})]})]})}),c.jsx(Un,{isOpen:Ai,onClose:()=>{yt(!1),wo(new Set),So(null)},title:" Combine Invoices",width:"700px",children:Vi&&c.jsxs("div",{children:[c.jsxs("div",{style:{backgroundColor:"#F3E8FF",padding:"14px 18px",borderRadius:"10px",marginBottom:"16px"},children:[c.jsxs("div",{style:{fontSize:"15px",fontWeight:"700",color:"#6B21A8"},children:["Party: ",Vi]}),c.jsx("div",{style:{fontSize:"13px",color:"#7C3AED",marginTop:"4px"},children:"Select 2+ campaigns to combine into a single invoice"})]}),c.jsx("div",{style:{maxHeight:"350px",overflowY:"auto",border:"1px solid #E2E8F0",borderRadius:"10px"},children:c.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"13px"},children:[c.jsx("thead",{children:c.jsxs("tr",{style:{backgroundColor:"#F8FAFC",position:"sticky",top:0},children:[c.jsx("th",{style:{padding:"12px",textAlign:"center",width:"50px"},children:""}),c.jsx("th",{style:{padding:"12px",textAlign:"left"},children:"Sender"}),c.jsx("th",{style:{padding:"12px",textAlign:"left"},children:"Subject"}),c.jsx("th",{style:{padding:"12px",textAlign:"left"},children:"Date"}),c.jsx("th",{style:{padding:"12px",textAlign:"right"},children:"Amount"})]})}),c.jsx("tbody",{children:k(Vi).map(h=>{var _;return c.jsxs("tr",{style:{borderBottom:"1px solid #F1F5F9",backgroundColor:zi.has(h.id)?"#F3E8FF":"transparent",cursor:"pointer"},onClick:()=>T4(h.id),children:[c.jsx("td",{style:{padding:"12px",textAlign:"center"},children:c.jsx("input",{type:"checkbox",checked:zi.has(h.id),onChange:()=>{},style:{width:"18px",height:"18px",cursor:"pointer"}})}),c.jsx("td",{style:{padding:"12px",fontWeight:"600"},children:h.senderName}),c.jsxs("td",{style:{padding:"12px",color:"#64748B"},children:[(_=h.subject)==null?void 0:_.substring(0,35),"..."]}),c.jsx("td",{style:{padding:"12px"},children:At(h.date)}),c.jsx("td",{style:{padding:"12px",textAlign:"right",fontWeight:"700"},children:at(h.totalWithGst)})]},h.id)})})]})}),c.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px 18px",borderRadius:"10px",marginTop:"16px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[c.jsxs("div",{style:{fontSize:"14px",color:"#64748B"},children:["Selected: ",c.jsx("strong",{children:zi.size})," | Combine Code: ",c.jsxs("strong",{children:["C",Ot]})]}),c.jsxs("div",{style:{fontSize:"18px",fontWeight:"700",color:"#2874A6"},children:["Total: ",at(Se.filter(h=>zi.has(h.id)).reduce((h,_)=>h+(parseFloat(_.totalWithGst)||0),0))]})]}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"16px"},children:[c.jsx(Ye,{label:"Cancel",onClick:()=>{yt(!1),wo(new Set)}}),c.jsx(Ye,{label:"Create Combined Invoice",variant:"purple",icon:Oo,disabled:zi.size<2,onClick:w4})]})]})}),c.jsxs(Un,{isOpen:Bi,onClose:()=>{ji(!1),Ws(null),Ao(!1)},title:Ku?" Replace Mailer":" Upload Mailer",width:"550px",children:[c.jsx("input",{type:"file",ref:ko,accept:"image/*",style:{display:"none"},onChange:C4}),ce&&c.jsxs("div",{children:[c.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px",borderRadius:"10px",marginBottom:"14px"},children:[c.jsxs("div",{style:{fontSize:"14px"},children:[c.jsx("strong",{children:"Sender:"})," ",ce.senderName]}),c.jsxs("div",{style:{fontSize:"14px",marginTop:"4px"},children:[c.jsx("strong",{children:"Subject:"})," ",ce.subject]})]}),Ku&&It[ce.id]&&c.jsx("div",{style:{backgroundColor:"#FEF3C7",padding:"12px",borderRadius:"10px",marginBottom:"14px",border:"1px solid #FCD34D"},children:c.jsxs("div",{style:{fontWeight:"600",color:"#92400E",fontSize:"13px"},children:[" This will replace ",It[ce.id].length," existing image(s)"]})}),c.jsxs("div",{style:{backgroundColor:"#FEF3C7",padding:"14px",borderRadius:"10px",marginBottom:"14px",border:"1px solid #FCD34D"},children:[c.jsx("div",{style:{fontWeight:"700",color:"#92400E",marginBottom:"8px",fontSize:"14px"},children:"Step 1: Find Mailer in Gmail"}),c.jsxs("button",{onClick:()=>F4(ce.subject),style:{display:"flex",alignItems:"center",gap:"8px",padding:"10px 18px",backgroundColor:"#EA4335",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"14px",fontWeight:"600"},children:[c.jsx(jL,{size:16})," Search in Gmail"]})]}),c.jsxs("div",{style:{backgroundColor:"#F0FDF4",padding:"14px",borderRadius:"10px",border:"1px solid #86EFAC"},children:[c.jsx("div",{style:{fontWeight:"700",color:"#166534",marginBottom:"8px",fontSize:"14px"},children:"Step 2: Paste Screenshot"}),c.jsx("div",{ref:Dr,tabIndex:0,onPaste:k4,onClick:()=>{var h;return(h=Dr.current)==null?void 0:h.focus()},style:{border:To?"3px solid #22C55E":"3px dashed #22C55E",borderRadius:"10px",padding:To?"8px":"30px",textAlign:"center",cursor:"pointer",backgroundColor:To?"#FFFFFF":"#ECFDF5",minHeight:"100px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",outline:"none"},children:To?c.jsxs(c.Fragment,{children:[c.jsx("img",{src:To,alt:"Pasted",style:{maxWidth:"100%",maxHeight:"200px",borderRadius:"8px",marginBottom:"10px"}}),c.jsxs("div",{style:{display:"flex",gap:"8px"},children:[c.jsx(Ye,{icon:rE,label:"Save",variant:"success",onClick:()=>_y(To)}),c.jsx(Ye,{icon:as,label:"Clear",variant:"danger",onClick:()=>Ws(null)})]})]}):c.jsxs(c.Fragment,{children:[c.jsx(nm,{size:36,color:"#22C55E",style:{marginBottom:"8px"}}),c.jsx("div",{style:{fontWeight:"700",fontSize:"14px",color:"#166534"},children:"Click here & Press Ctrl+V"})]})}),c.jsxs("div",{style:{textAlign:"center",marginTop:"12px"},children:[c.jsx("span",{style:{color:"#64748B",fontSize:"13px"},children:" OR "}),c.jsx("div",{style:{marginTop:"8px"},children:c.jsx(Ye,{icon:Xs,label:"Browse Files",onClick:()=>{var h;return(h=ko.current)==null?void 0:h.click()}})})]})]})]})]}),c.jsx(Un,{isOpen:Li,onClose:()=>Gr(!1),title:" Send Invoice Email",width:"600px",children:ce&&c.jsxs("div",{children:[c.jsxs("div",{style:{display:"flex",gap:"0",marginBottom:"16px",border:"2px solid #E2E8F0",borderRadius:"8px",overflow:"hidden"},children:[c.jsx("button",{onClick:()=>La("reply"),style:{flex:1,padding:"12px",backgroundColor:ca==="reply"?"#2874A6":"#F8FAFC",color:ca==="reply"?"white":"#64748B",border:"none",cursor:"pointer",fontWeight:"700",fontSize:"14px"},children:" Reply to Thread"}),c.jsx("button",{onClick:()=>La("new"),style:{flex:1,padding:"12px",backgroundColor:ca==="new"?"#2874A6":"#F8FAFC",color:ca==="new"?"white":"#64748B",border:"none",cursor:"pointer",fontWeight:"700",fontSize:"14px"},children:" New Email"})]}),c.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px",borderRadius:"10px",marginBottom:"16px"},children:[c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Invoice:"})," ",ce.invoiceNo]}),c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Amount:"})," ",at(ce.invoiceTotalAmount||ce.totalWithGst)]}),ce.serviceType||ce.isService?c.jsxs("div",{style:{fontSize:"13px",marginTop:"8px",color:"#92400E",backgroundColor:"#FEF3C7",padding:"6px 10px",borderRadius:"6px"},children:[c.jsx("strong",{children:"Type of Service:"})," ",(ce.serviceType||"SERVICE").toUpperCase()]}):ce.invoiceType==="Combined"&&c.jsxs("div",{style:{fontSize:"13px",marginTop:"8px",color:"#7C3AED"},children:[c.jsx("strong",{children:"Campaigns:"})," ",ue(ce).map(h=>h.senderName).join(", ")]}),c.jsx("div",{style:{fontSize:"14px",marginTop:"8px"},children:c.jsx("strong",{children:"Recipients:"})}),c.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"6px",marginTop:"6px"},children:[er(ce).map((h,_)=>c.jsx("span",{style:{padding:"4px 10px",backgroundColor:"#DBEAFE",borderRadius:"6px",fontSize:"13px",color:"#1E40AF"},children:h},_)),er(ce).length===0&&c.jsx("span",{style:{color:"#94A3B8"},children:"No email addresses"})]})]}),ca==="reply"?c.jsxs("div",{children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"8px"},children:[c.jsx("span",{style:{fontWeight:"700",fontSize:"14px"},children:"Email Body:"}),c.jsx("button",{onClick:()=>{navigator.clipboard.writeText(m0(ce)),alert(" Copied!")},style:{padding:"6px 14px",backgroundColor:"#22C55E",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"13px",fontWeight:"600"},children:" Copy"})]}),c.jsx("div",{style:{fontSize:"13px",backgroundColor:"#F8FAFC",padding:"14px",borderRadius:"10px",whiteSpace:"pre-wrap",maxHeight:"200px",overflowY:"auto",fontFamily:"monospace",border:"1px solid #E2E8F0",lineHeight:"1.5"},children:m0(ce)})]}):c.jsxs("div",{style:{display:"flex",gap:"10px"},children:[c.jsx("button",{onClick:()=>{const h=er(ce),_=encodeURIComponent(h.join(",")),W=encodeURIComponent(Ey(ce)),Z=encodeURIComponent(m0(ce));window.open(`https://mail.google.com/mail/?view=cm&to=${_}&su=${W}&body=${Z}`,"_blank")},style:{padding:"12px 20px",backgroundColor:"#EA4335",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"14px",fontWeight:"700"},children:" Open Gmail"}),c.jsx("button",{onClick:()=>{const h=er(ce),_=encodeURIComponent(h.join(";")),W=encodeURIComponent(Ey(ce)),Z=encodeURIComponent(m0(ce));window.open(`https://outlook.live.com/mail/0/deeplink/compose?to=${_}&subject=${W}&body=${Z}`,"_blank")},style:{padding:"12px 20px",backgroundColor:"#0078D4",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"14px",fontWeight:"700"},children:" Open Outlook"})]}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"16px"},children:[c.jsx(Ye,{label:"View Invoice",icon:Pc,onClick:()=>{Gr(!1),ce.serviceType||ce.isService?nd(ce):td(ce)}}),c.jsx(Ye,{label:"Close",onClick:()=>Gr(!1)})]})]})}),c.jsx(Un,{isOpen:Ui,onClose:()=>gr(!1),title:" Record Payment",width:"500px",children:ce&&c.jsxs("div",{children:[c.jsxs("div",{style:{backgroundColor:"#F0FDF4",padding:"14px",borderRadius:"10px",marginBottom:"16px"},children:[c.jsxs("div",{style:{fontSize:"14px"},children:[c.jsx("strong",{children:"Invoice:"})," ",ce.invoiceNo]}),c.jsxs("div",{style:{fontSize:"14px",marginTop:"4px"},children:[c.jsx("strong",{children:"Party:"})," ",ce.partyName]})]}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[c.jsx(Hr,{label:"Payment Amount",type:"number",value:Ar.amount,onChange:h=>$s({...Ar,amount:h.target.value}),small:!0}),c.jsx(Hr,{label:"Date",type:"date",value:Ar.date,onChange:h=>$s({...Ar,date:h.target.value}),small:!0})]}),c.jsx(nh,{label:"Payment Mode",value:Ar.mode,onChange:h=>$s({...Ar,mode:h.target.value}),options:[{value:"Bank",label:"Bank Transfer"},{value:"UPI",label:"UPI"},{value:"Cheque",label:"Cheque"},{value:"Cash",label:"Cash"}],small:!0}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[c.jsx(Hr,{label:"TDS Deducted",type:"number",value:Ar.tds,onChange:h=>$s({...Ar,tds:h.target.value}),placeholder:"0",small:!0}),c.jsx(Hr,{label:"Discount",type:"number",value:Ar.discount,onChange:h=>$s({...Ar,discount:h.target.value}),placeholder:"0",small:!0})]}),c.jsx(Hr,{label:"Narration",value:Ar.narration,onChange:h=>$s({...Ar,narration:h.target.value}),placeholder:"Reference",small:!0}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"16px"},children:[c.jsx(Ye,{label:"Cancel",onClick:()=>gr(!1)}),c.jsx(Ye,{label:"Record Payment",variant:"success",icon:BL,onClick:R4})]})]})}),c.jsxs(Un,{isOpen:Kr,onClose:()=>Nr(!1),title:" Set Opening Balance",width:"450px",children:[c.jsx(nh,{label:"Select Party",value:jn.partyName,onChange:h=>rs({...jn,partyName:h.target.value}),options:[{value:"",label:"Choose a party..."},...Gs.map(h=>({value:h,label:h}))],small:!0}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr",gap:"12px"},children:[c.jsx(Hr,{label:"Amount",type:"number",value:jn.amount,onChange:h=>rs({...jn,amount:h.target.value}),small:!0}),c.jsx(nh,{label:"Type",value:jn.type,onChange:h=>rs({...jn,type:h.target.value}),options:[{value:"Dr",label:"Debit"},{value:"Cr",label:"Credit"}],small:!0})]}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"16px"},children:[c.jsx(Ye,{label:"Cancel",onClick:()=>Nr(!1)}),c.jsx(Ye,{label:"Save",variant:"brand",onClick:()=>{jn.partyName&&jn.amount&&(_c(h=>({...h,[jn.partyName]:jn.type==="Dr"?parseFloat(jn.amount):-parseFloat(jn.amount)})),Nr(!1),rs({partyName:"",amount:"",type:"Dr"}))}})]})]}),c.jsxs(Un,{isOpen:fg,onClose:()=>Sc(!1),title:" Import Historical Ledger",width:"600px",children:[c.jsx("input",{type:"file",ref:qu,accept:".xlsx,.xls,.csv",style:{display:"none"},onChange:p4}),c.jsxs("div",{style:{padding:"16px",backgroundColor:"#EFF6FF",borderRadius:"10px",marginBottom:"16px",border:"1px solid #BFDBFE"},children:[c.jsx("div",{style:{fontWeight:"700",color:"#1E40AF",marginBottom:"8px",fontSize:"14px"},children:" How to Import Historical Ledger"}),c.jsxs("div",{style:{fontSize:"12px",color:"#1E3A8A",lineHeight:"1.6"},children:[c.jsx("p",{style:{margin:"0 0 8px 0"},children:"Upload your existing ledger data in the format shown in the template. This will import all historical transactions."}),c.jsxs("p",{style:{margin:0},children:[c.jsx("strong",{children:"Supported columns:"})," Date, Particular, Vch Type, Vch No., Debit, Credit, Date of Receipt, Amount Received, TDS Received, Balance, Payment Status"]})]})]}),X&&c.jsxs("div",{style:{padding:"12px",backgroundColor:"#DCFCE7",borderRadius:"8px",marginBottom:"16px",border:"1px solid #86EFAC"},children:[c.jsxs("div",{style:{fontSize:"13px",color:"#166534"},children:[c.jsx("strong",{children:" Selected Party:"})," ",X]}),c.jsx("div",{style:{fontSize:"11px",color:"#15803D",marginTop:"4px"},children:"All entries from the uploaded file will be imported for this party"})]}),!X&&c.jsxs("div",{style:{padding:"12px",backgroundColor:"#FEE2E2",borderRadius:"8px",marginBottom:"16px",border:"1px solid #FCA5A5"},children:[c.jsx("div",{style:{fontSize:"13px",color:"#991B1B"},children:c.jsx("strong",{children:" No Party Selected"})}),c.jsx("div",{style:{fontSize:"12px",color:"#B91C1C",marginTop:"4px"},children:'Please close this modal and select a party from the Parties list on the left, then click "Import Historical" again.'})]}),c.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center",marginBottom:"16px"},children:[c.jsx(Ye,{icon:Po,label:"Download Template",variant:"brand",onClick:g4}),X?c.jsx(Ye,{icon:Xs,label:"Upload Ledger",variant:"success",onClick:()=>{var h;return(h=qu.current)==null?void 0:h.click()}}):c.jsxs("button",{disabled:!0,style:{padding:"8px 16px",fontSize:"13px",fontWeight:"600",border:"none",borderRadius:"8px",backgroundColor:"#E2E8F0",color:"#94A3B8",cursor:"not-allowed",display:"flex",alignItems:"center",gap:"6px"},children:[c.jsx(Xs,{size:16})," Upload Ledger"]})]}),c.jsxs("div",{style:{padding:"14px",backgroundColor:"#F8FAFC",borderRadius:"8px",border:"1px solid #E2E8F0"},children:[c.jsx("div",{style:{fontWeight:"600",color:"#475569",marginBottom:"8px",fontSize:"13px"},children:" Expected Format (matches your ledger export):"}),c.jsx("div",{style:{overflowX:"auto"},children:c.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"10px"},children:[c.jsx("thead",{children:c.jsxs("tr",{style:{backgroundColor:"#E2E8F0"},children:[c.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"left"},children:"Date"}),c.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"left"},children:"Particular"}),c.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"left"},children:"Vch Type"}),c.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"left"},children:"Vch No."}),c.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"right"},children:"Debit"}),c.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"right"},children:"Credit"}),c.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"right"},children:"Amt Recd"}),c.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"left"},children:"Status"})]})}),c.jsx("tbody",{children:c.jsxs("tr",{children:[c.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0"},children:"02-Jun-21"}),c.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0"},children:"DB Corp Ltd"}),c.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0"},children:"Sales"}),c.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0"},children:"MB/2020-21/0411"}),c.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0",textAlign:"right"},children:"6,000"}),c.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0"}}),c.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0",textAlign:"right"},children:"44,371"}),c.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0"},children:"Received"})]})})]})})]}),c.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"16px"},children:c.jsx(Ye,{label:"Close",onClick:()=>Sc(!1)})})]}),c.jsx(Un,{isOpen:$u,onClose:()=>{Vs(!1),ts({amount:"",tds:"",discount:"",narration:"",paymentAdvisory:null,date:new Date().toISOString().split("T")[0],mode:"Bank"})},title:" Create Receipt",width:"550px",children:ce&&c.jsxs("div",{children:[c.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px",borderRadius:"10px",marginBottom:"16px"},children:[c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Invoice:"})," ",ce.invoiceNo]}),c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Party:"})," ",ce.partyName]}),c.jsxs("div",{style:{fontSize:"14px"},children:[c.jsx("strong",{children:"Invoice Amount:"})," ",at(ce.invoiceTotalAmount)]})]}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",marginBottom:"12px"},children:[c.jsx(Hr,{label:"Receipt Date",type:"date",value:qt.date,onChange:h=>ts({...qt,date:h.target.value}),small:!0}),c.jsx(nh,{label:"Payment Mode",value:qt.mode,onChange:h=>ts({...qt,mode:h.target.value}),options:[{value:"Bank",label:"Bank Transfer"},{value:"Cash",label:"Cash"},{value:"Cheque",label:"Cheque"},{value:"UPI",label:"UPI"}],small:!0})]}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"12px",marginBottom:"12px"},children:[c.jsx(Hr,{label:"Amount Received",type:"number",value:qt.amount,onChange:h=>ts({...qt,amount:h.target.value}),placeholder:"0.00",small:!0}),c.jsx(Hr,{label:"TDS Deducted",type:"number",value:qt.tds,onChange:h=>ts({...qt,tds:h.target.value}),placeholder:"0.00",small:!0}),c.jsx(Hr,{label:"Discount",type:"number",value:qt.discount,onChange:h=>ts({...qt,discount:h.target.value}),placeholder:"0.00",small:!0})]}),c.jsx("div",{style:{backgroundColor:"#F0FDF4",padding:"12px",borderRadius:"8px",marginBottom:"16px"},children:c.jsxs("div",{style:{fontSize:"14px",fontWeight:"700",color:"#166534"},children:["Total Credit: ",at((parseFloat(qt.amount)||0)+(parseFloat(qt.tds)||0)+(parseFloat(qt.discount)||0))]})}),c.jsx(Hr,{label:"Narration",value:qt.narration,onChange:h=>ts({...qt,narration:h.target.value}),placeholder:"Payment reference, remarks...",small:!0}),c.jsxs("div",{style:{marginBottom:"16px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Payment Advisory (Optional)"}),c.jsx("input",{type:"file",ref:d0,accept:"image/*,.pdf",onChange:e4,style:{display:"none"}}),qt.paymentAdvisory?c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[c.jsx("div",{style:{flex:1,padding:"10px",backgroundColor:"#F0FDF4",borderRadius:"8px",fontSize:"13px",color:"#166534"},children:" Payment advisory attached"}),c.jsx("button",{onClick:()=>ts(h=>({...h,paymentAdvisory:null})),style:{padding:"8px",border:"none",backgroundColor:"#FEE2E2",borderRadius:"6px",cursor:"pointer",color:"#991B1B"},children:c.jsx(Ta,{size:16})})]}):c.jsxs("button",{onClick:()=>{var h;return(h=d0.current)==null?void 0:h.click()},style:{padding:"10px 16px",border:"1.5px dashed #D1D5DB",borderRadius:"8px",backgroundColor:"#F9FAFB",cursor:"pointer",fontSize:"13px",color:"#6B7280",display:"flex",alignItems:"center",gap:"8px"},children:[c.jsx(Xs,{size:16})," Attach Payment Advisory"]})]}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[c.jsx(Ye,{label:"Cancel",onClick:()=>Vs(!1)}),c.jsx(Ye,{label:"Create Receipt",variant:"success",icon:Oo,onClick:Cc})]})]})}),c.jsx(Un,{isOpen:Al,onClose:()=>{la(!1),ha({amount:"",gst:"",reason:"",date:new Date().toISOString().split("T")[0]})},title:" Create Credit Note",width:"500px",children:ce&&(()=>{var se;const h=(se=ce.statePartyDetails)==null?void 0:se.toUpperCase().includes("MAHARASHTRA"),_=h?"CGST + SGST (9% + 9%)":"IGST (18%)",W=parseFloat(xn.amount)||0,Z=parseFloat(xn.gst)||0,L=W+Z;return c.jsxs("div",{children:[c.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px",borderRadius:"10px",marginBottom:"16px"},children:[c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Invoice:"})," ",ce.invoiceNo]}),c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Party:"})," ",ce.partyName]}),c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Invoice Amount:"})," ",at(ce.invoiceTotalAmount)]}),c.jsxs("div",{style:{fontSize:"12px",color:"#2563EB"},children:[c.jsx("strong",{children:"GST Type:"})," ",h?"CGST + SGST (Intra-state)":"IGST (Inter-state)"]})]}),c.jsx("div",{style:{marginBottom:"12px"},children:c.jsx(Hr,{label:"Credit Note Date",type:"date",value:xn.date,onChange:M=>ha({...xn,date:M.target.value}),small:!0})}),c.jsxs("div",{style:{backgroundColor:"#FEF2F2",padding:"14px",borderRadius:"10px",marginBottom:"12px",border:"1px solid #FECACA"},children:[c.jsx("div",{style:{fontWeight:"700",color:"#991B1B",marginBottom:"10px",fontSize:"13px"},children:" Credit Note Breakdown"}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[c.jsx(Hr,{label:"Base Amount",type:"number",value:xn.amount,onChange:M=>ha({...xn,amount:M.target.value}),placeholder:"0.00",small:!0}),c.jsx(Hr,{label:_,type:"number",value:xn.gst,onChange:M=>ha({...xn,gst:M.target.value}),placeholder:"0.00",small:!0})]}),c.jsxs("div",{style:{marginTop:"10px",padding:"8px",backgroundColor:"#FEE2E2",borderRadius:"6px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[c.jsx("span",{style:{fontSize:"13px",fontWeight:"600",color:"#991B1B"},children:"Total Credit:"}),c.jsx("span",{style:{fontSize:"15px",fontWeight:"700",color:"#991B1B"},children:at(L)})]})]}),c.jsxs("div",{style:{marginBottom:"16px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Reason for Credit Note *"}),c.jsx("textarea",{value:xn.reason,onChange:M=>ha({...xn,reason:M.target.value}),placeholder:"Enter reason for issuing credit note...",style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"13px",minHeight:"80px",resize:"vertical",boxSizing:"border-box"}})]}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[c.jsx(Ye,{label:"Cancel",onClick:()=>la(!1)}),c.jsx(Ye,{label:"Create Credit Note",variant:"danger",icon:pd,onClick:ZF})]})]})})()}),c.jsx(Un,{isOpen:Va,onClose:()=>{es(!1),da(null)},title:" Add Followup",width:"500px",children:dr&&c.jsxs("div",{children:[c.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px",borderRadius:"10px",marginBottom:"16px"},children:[c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Invoice:"})," ",dr.invoiceNo]}),c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Party:"})," ",dr.partyName]}),c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Amount:"})," ",at(dr.invoiceTotalAmount||dr.totalAmount)]}),c.jsxs("div",{style:{fontSize:"14px"},children:[c.jsx("strong",{children:"Invoice Date:"})," ",At(dr.invoiceDate||dr.date)]})]}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",marginBottom:"12px"},children:[c.jsx(Hr,{label:"Followup Date",type:"date",value:Fr.date,onChange:h=>za({...Fr,date:h.target.value}),small:!0}),c.jsx(Hr,{label:"Next Followup Date",type:"date",value:Fr.nextFollowupDate,onChange:h=>za({...Fr,nextFollowupDate:h.target.value}),small:!0})]}),c.jsxs("div",{style:{marginBottom:"16px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Followup Notes *"}),c.jsx("textarea",{value:Fr.notes,onChange:h=>za({...Fr,notes:h.target.value}),placeholder:"Enter followup notes (e.g., Spoke with accounts team, payment promised by next week)",style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"13px",minHeight:"80px",resize:"vertical",boxSizing:"border-box"}})]}),c.jsxs("div",{style:{marginBottom:"16px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Status"}),c.jsxs("select",{value:Fr.status,onChange:h=>za({...Fr,status:h.target.value}),style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"13px"},children:[c.jsx("option",{value:"Pending",children:"Pending"}),c.jsx("option",{value:"Promised",children:"Promised - Payment Expected"}),c.jsx("option",{value:"Disputed",children:"Disputed"}),c.jsx("option",{value:"No Response",children:"No Response"})]})]}),c.jsxs("div",{style:{backgroundColor:"#F0FDF4",padding:"12px",borderRadius:"8px",marginBottom:"16px",border:"1px solid #86EFAC"},children:[c.jsx("div",{style:{fontSize:"12px",fontWeight:"600",color:"#166534",marginBottom:"8px"},children:" Quick Actions"}),c.jsxs("div",{style:{display:"flex",gap:"8px"},children:[c.jsx(Ye,{icon:nm,label:"Copy Email Template",small:!0,variant:"brand",onClick:()=>xy(dr)}),c.jsx(Ye,{icon:X0,label:"Search in Gmail",small:!0,variant:"success",onClick:()=>vy(dr)})]})]}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[c.jsx(Ye,{label:"Cancel",onClick:()=>es(!1)}),c.jsx(Ye,{label:"Save Followup",variant:"primary",icon:md,onClick:o4})]})]})}),c.jsx(Un,{isOpen:ja,onClose:()=>zs(!1),title:" Clear All Data",width:"500px",children:c.jsxs("div",{children:[c.jsxs("div",{style:{backgroundColor:"#FEE2E2",padding:"20px",borderRadius:"12px",marginBottom:"20px",border:"2px solid #FCA5A5"},children:[c.jsxs("div",{style:{fontWeight:"700",color:"#991B1B",fontSize:"18px",marginBottom:"12px",display:"flex",alignItems:"center",gap:"8px"},children:[c.jsx(Q_,{size:24})," Warning: This action cannot be undone!"]}),c.jsxs("div",{style:{fontSize:"14px",color:"#7F1D1D",lineHeight:"1.6"},children:["This will permanently delete:",c.jsxs("ul",{style:{margin:"12px 0 0 20px",padding:0},children:[c.jsxs("li",{children:[c.jsx("strong",{children:Se.length})," campaigns from Master Sheet"]}),c.jsxs("li",{children:[c.jsx("strong",{children:Se.filter(h=>h.invoiceGenerated).length})," generated invoices"]}),c.jsxs("li",{children:[c.jsx("strong",{children:Me.length})," receipts"]}),c.jsxs("li",{children:[c.jsx("strong",{children:re.length})," credit notes"]}),c.jsxs("li",{children:[c.jsx("strong",{children:ie.length})," ledger entries"]}),c.jsxs("li",{children:[c.jsx("strong",{children:Object.keys(It).length})," mailer images"]}),c.jsx("li",{children:"All opening balances"})]})]})]}),c.jsx("div",{style:{backgroundColor:"#FEF3C7",padding:"14px",borderRadius:"8px",marginBottom:"20px",border:"1px solid #FCD34D"},children:c.jsxs("div",{style:{fontSize:"13px",color:"#92400E"},children:[c.jsx("strong",{children:"Note:"})," Invoice series numbers will be reset to 1. Your company settings and mailer logo will be preserved."]})}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:[c.jsx(Ye,{label:"Cancel",onClick:()=>zs(!1)}),c.jsx(Ye,{label:"Yes, Clear All Data",variant:"danger",icon:as,onClick:_4})]})]})}),c.jsx(Un,{isOpen:mr,onClose:()=>sr(!1),title:" Notifications",width:"550px",children:c.jsxs("div",{children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[c.jsx("div",{style:{fontSize:"14px",color:"#64748B"},children:Ts>0?`${Ts} unread`:"No unread notifications"}),c.jsxs("div",{style:{display:"flex",gap:"8px"},children:[Ts>0&&c.jsx("button",{onClick:Wa,style:{padding:"6px 12px",fontSize:"12px",fontWeight:"600",border:"1px solid #E2E8F0",borderRadius:"6px",backgroundColor:"#F8FAFC",color:"#475569",cursor:"pointer"},children:"Mark all as read"}),We.length>0&&Cr&&c.jsx("button",{onClick:p0,style:{padding:"6px 12px",fontSize:"12px",fontWeight:"600",border:"1px solid #FCA5A5",borderRadius:"6px",backgroundColor:"#FEE2E2",color:"#991B1B",cursor:"pointer"},children:"Clear all"})]})]}),c.jsx("div",{style:{maxHeight:"400px",overflowY:"auto"},children:bl.length===0?c.jsxs("div",{style:{padding:"40px",textAlign:"center",color:"#94A3B8"},children:[c.jsx(Z_,{size:40,style:{marginBottom:"12px",opacity:.5}}),c.jsx("div",{style:{fontSize:"16px",fontWeight:"600"},children:"No notifications"}),c.jsx("div",{style:{fontSize:"13px",marginTop:"4px"},children:"You're all caught up!"})]}):bl.map(h=>{const _=!(h.read&&h.read[r]),W=L=>{switch(L){case"upload":return"";case"invoice":return"";case"approval":return"";case"edit":return"";case"receipt":return"";default:return""}},Z=L=>{switch(L){case"upload":return"#EFF6FF";case"invoice":return"#FEF3C7";case"approval":return"#DCFCE7";case"edit":return"#FEE2E2";case"receipt":return"#F0FDF4";default:return"#F8FAFC"}};return c.jsx("div",{onClick:()=>h0(h.id),style:{padding:"14px",borderRadius:"10px",marginBottom:"8px",backgroundColor:_?Z(h.type):"#F8FAFC",border:_?"2px solid #2874A6":"1px solid #E2E8F0",cursor:"pointer",transition:"all 0.2s ease"},children:c.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"12px"},children:[c.jsx("div",{style:{fontSize:"20px"},children:W(h.type)}),c.jsxs("div",{style:{flex:1},children:[c.jsx("div",{style:{fontSize:"14px",fontWeight:_?"600":"500",color:"#1E293B",lineHeight:"1.4"},children:h.message}),c.jsxs("div",{style:{display:"flex",gap:"12px",marginTop:"8px",fontSize:"11px",color:"#64748B"},children:[c.jsxs("span",{children:["By: ",h.createdBy==="finance"?"Finance Team":"Director"]}),c.jsx("span",{children:""}),c.jsx("span",{children:new Date(h.createdAt).toLocaleString()})]})]}),_&&c.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:"#DC2626",flexShrink:0}})]})},h.id)})})]})})]}),rb=()=>{switch(D){case"master":return Fy();case"services":return L4();case"invoices":return $4();case"receipts":return q4();case"ledgers":return Q4();case"followups":return Z4();case"reports":return Ny();case"settings":return r==="finance"?eb():Ny();default:return Fy()}},nb=()=>c.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, #1E3A5F 0%, #2874A6 50%, #1E3A5F 100%)",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',padding:"20px"},children:c.jsxs("div",{style:{backgroundColor:"#FFFFFF",padding:"0",borderRadius:"24px",boxShadow:"0 25px 50px -12px rgba(0,0,0,0.25)",width:"420px",maxWidth:"95vw",overflow:"hidden"},children:[c.jsxs("div",{style:{background:"linear-gradient(135deg, #1E3A5F 0%, #2874A6 100%)",padding:"32px 40px",textAlign:"center"},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"12px",marginBottom:"8px"},children:[c.jsx("img",{src:"/logo.png",alt:"JAC",style:{width:"60px",height:"auto",borderRadius:"8px",backgroundColor:"white",padding:"4px"}}),c.jsx("span",{style:{fontSize:"36px",fontWeight:"800",color:"#FFFFFF",letterSpacing:"-1px"},children:"FinMate"})]}),c.jsx("p",{style:{margin:0,color:"rgba(255,255,255,0.8)",fontSize:"14px",fontWeight:"500"},children:"Finance Management System"})]}),c.jsxs("div",{style:{padding:"32px 40px"},children:[c.jsxs("div",{style:{marginBottom:"24px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#1E3A5F",marginBottom:"8px",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Username"}),c.jsxs("div",{style:{position:"relative"},children:[c.jsx(oE,{size:18,style:{position:"absolute",left:"14px",top:"50%",transform:"translateY(-50%)",color:"#94A3B8"}}),c.jsx("input",{type:"text",value:i.username,onChange:h=>s(_=>({..._,username:h.target.value})),placeholder:"Enter username",style:{width:"100%",padding:"14px 14px 14px 44px",borderRadius:"12px",border:"2px solid #E2E8F0",fontSize:"15px",boxSizing:"border-box",transition:"border-color 0.2s, box-shadow 0.2s",outline:"none"},onFocus:h=>{h.target.style.borderColor="#2874A6",h.target.style.boxShadow="0 0 0 3px rgba(40,116,166,0.1)"},onBlur:h=>{h.target.style.borderColor="#E2E8F0",h.target.style.boxShadow="none"}})]})]}),c.jsxs("div",{style:{marginBottom:"28px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#1E3A5F",marginBottom:"8px",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Password"}),c.jsxs("div",{style:{position:"relative"},children:[c.jsx(Y0,{size:18,style:{position:"absolute",left:"14px",top:"50%",transform:"translateY(-50%)",color:"#94A3B8"}}),c.jsx("input",{type:"password",value:i.password,onChange:h=>s(_=>({..._,password:h.target.value})),placeholder:"Enter password",onKeyPress:h=>h.key==="Enter"&&ed(),style:{width:"100%",padding:"14px 14px 14px 44px",borderRadius:"12px",border:"2px solid #E2E8F0",fontSize:"15px",boxSizing:"border-box",transition:"border-color 0.2s, box-shadow 0.2s",outline:"none"},onFocus:h=>{h.target.style.borderColor="#2874A6",h.target.style.boxShadow="0 0 0 3px rgba(40,116,166,0.1)"},onBlur:h=>{h.target.style.borderColor="#E2E8F0",h.target.style.boxShadow="none"}})]})]}),a&&c.jsxs("div",{style:{marginBottom:"20px",padding:"14px",backgroundColor:"#FEF2F2",borderRadius:"12px",color:"#DC2626",fontSize:"14px",textAlign:"center",border:"1px solid #FECACA",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[c.jsx(Q_,{size:18}),a]}),c.jsx("button",{onClick:ed,style:{width:"100%",padding:"16px",fontSize:"16px",fontWeight:"700",border:"none",borderRadius:"12px",cursor:S?"pointer":"wait",background:S?"linear-gradient(135deg, #1E3A5F 0%, #2874A6 100%)":"#94A3B8",color:"white",transition:"transform 0.2s, box-shadow 0.2s",boxShadow:S?"0 4px 14px rgba(40,116,166,0.4)":"none",opacity:S?1:.7},disabled:!S,onMouseOver:h=>{S&&(h.target.style.transform="translateY(-2px)",h.target.style.boxShadow="0 6px 20px rgba(40,116,166,0.5)")},onMouseOut:h=>{S&&(h.target.style.transform="translateY(0)",h.target.style.boxShadow="0 4px 14px rgba(40,116,166,0.4)")},children:S?"Sign In":"Loading..."}),c.jsxs("div",{style:{marginTop:"24px",textAlign:"center",color:"#94A3B8",fontSize:"12px"},children:[c.jsx("span",{children:"Powered by "}),c.jsx("span",{style:{fontWeight:"600",color:"#1E3A5F"},children:"JAC"}),c.jsx("span",{children:"  Strategy | Talent | Results"})]})]})]})});return t?l?c.jsxs("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, #1E3A5F 0%, #2874A6 50%, #1E3A5F 100%)",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:[c.jsxs("div",{style:{textAlign:"center"},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"12px",marginBottom:"24px"},children:[c.jsx("img",{src:"/logo.png",alt:"JAC",style:{width:"50px",height:"auto",borderRadius:"8px",backgroundColor:"white",padding:"4px"}}),c.jsx("span",{style:{fontSize:"32px",fontWeight:"800",color:"#FFFFFF",letterSpacing:"-1px"},children:"FinMate"})]}),c.jsx(nE,{size:48,style:{animation:"spin 1s linear infinite",color:"#FFFFFF",marginBottom:"16px"}}),c.jsx("div",{style:{fontSize:"18px",fontWeight:"600",color:"#FFFFFF"},children:"Loading your data..."}),c.jsx("div",{style:{fontSize:"14px",color:"rgba(255,255,255,0.7)",marginTop:"8px"},children:"Please wait while we sync with the cloud"})]}),c.jsx("style",{children:"@keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }"})]}):c.jsxs("div",{style:{display:"flex",height:"100vh",backgroundColor:"#F1F5F9",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:[D4(),c.jsx("main",{style:{flex:1,overflow:"auto",padding:"20px"},children:rb()}),tb(),c.jsx("style",{children:"@keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }"})]}):nb()}ym.createRoot(document.getElementById("root")).render(c.jsx(ah.StrictMode,{children:c.jsx(DH,{})}));
