(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();function zF(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var fw={exports:{}},xp={},dw={exports:{}},Ct={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kd=Symbol.for("react.element"),WF=Symbol.for("react.portal"),HF=Symbol.for("react.fragment"),$F=Symbol.for("react.strict_mode"),GF=Symbol.for("react.profiler"),KF=Symbol.for("react.provider"),XF=Symbol.for("react.context"),YF=Symbol.for("react.forward_ref"),qF=Symbol.for("react.suspense"),QF=Symbol.for("react.memo"),JF=Symbol.for("react.lazy"),ky=Symbol.iterator;function ZF(t){return t===null||typeof t!="object"?null:(t=ky&&t[ky]||t["@@iterator"],typeof t=="function"?t:null)}var hw={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},pw=Object.assign,gw={};function Tu(t,e,r){this.props=t,this.context=e,this.refs=gw,this.updater=r||hw}Tu.prototype.isReactComponent={};Tu.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Tu.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function mw(){}mw.prototype=Tu.prototype;function Mx(t,e,r){this.props=t,this.context=e,this.refs=gw,this.updater=r||hw}var Lx=Mx.prototype=new mw;Lx.constructor=Mx;pw(Lx,Tu.prototype);Lx.isPureReactComponent=!0;var Cy=Array.isArray,xw=Object.prototype.hasOwnProperty,Bx={current:null},vw={key:!0,ref:!0,__self:!0,__source:!0};function yw(t,e,r){var n,i={},s=null,a=null;if(e!=null)for(n in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(s=""+e.key),e)xw.call(e,n)&&!vw.hasOwnProperty(n)&&(i[n]=e[n]);var o=arguments.length-2;if(o===1)i.children=r;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];i.children=l}if(t&&t.defaultProps)for(n in o=t.defaultProps,o)i[n]===void 0&&(i[n]=o[n]);return{$$typeof:kd,type:t,key:s,ref:a,props:i,_owner:Bx.current}}function eI(t,e){return{$$typeof:kd,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function jx(t){return typeof t=="object"&&t!==null&&t.$$typeof===kd}function tI(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var Fy=/\/+/g;function ng(t,e){return typeof t=="object"&&t!==null&&t.key!=null?tI(""+t.key):e.toString(36)}function Y0(t,e,r,n,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case kd:case WF:a=!0}}if(a)return a=t,i=i(a),t=n===""?"."+ng(a,0):n,Cy(i)?(r="",t!=null&&(r=t.replace(Fy,"$&/")+"/"),Y0(i,e,r,"",function(c){return c})):i!=null&&(jx(i)&&(i=eI(i,r+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(Fy,"$&/")+"/")+t)),e.push(i)),1;if(a=0,n=n===""?".":n+":",Cy(t))for(var o=0;o<t.length;o++){s=t[o];var l=n+ng(s,o);a+=Y0(s,e,r,l,i)}else if(l=ZF(t),typeof l=="function")for(t=l.call(t),o=0;!(s=t.next()).done;)s=s.value,l=n+ng(s,o++),a+=Y0(s,e,r,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function u0(t,e,r){if(t==null)return t;var n=[],i=0;return Y0(t,n,"","",function(s){return e.call(r,s,i++)}),n}function rI(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var gi={current:null},q0={transition:null},nI={ReactCurrentDispatcher:gi,ReactCurrentBatchConfig:q0,ReactCurrentOwner:Bx};function _w(){throw Error("act(...) is not supported in production builds of React.")}Ct.Children={map:u0,forEach:function(t,e,r){u0(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return u0(t,function(){e++}),e},toArray:function(t){return u0(t,function(e){return e})||[]},only:function(t){if(!jx(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Ct.Component=Tu;Ct.Fragment=HF;Ct.Profiler=GF;Ct.PureComponent=Mx;Ct.StrictMode=$F;Ct.Suspense=qF;Ct.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=nI;Ct.act=_w;Ct.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=pw({},t.props),i=t.key,s=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,a=Bx.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var o=t.type.defaultProps;for(l in e)xw.call(e,l)&&!vw.hasOwnProperty(l)&&(n[l]=e[l]===void 0&&o!==void 0?o[l]:e[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var c=0;c<l;c++)o[c]=arguments[c+2];n.children=o}return{$$typeof:kd,type:t.type,key:i,ref:s,props:n,_owner:a}};Ct.createContext=function(t){return t={$$typeof:XF,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:KF,_context:t},t.Consumer=t};Ct.createElement=yw;Ct.createFactory=function(t){var e=yw.bind(null,t);return e.type=t,e};Ct.createRef=function(){return{current:null}};Ct.forwardRef=function(t){return{$$typeof:YF,render:t}};Ct.isValidElement=jx;Ct.lazy=function(t){return{$$typeof:JF,_payload:{_status:-1,_result:t},_init:rI}};Ct.memo=function(t,e){return{$$typeof:QF,type:t,compare:e===void 0?null:e}};Ct.startTransition=function(t){var e=q0.transition;q0.transition={};try{t()}finally{q0.transition=e}};Ct.unstable_act=_w;Ct.useCallback=function(t,e){return gi.current.useCallback(t,e)};Ct.useContext=function(t){return gi.current.useContext(t)};Ct.useDebugValue=function(){};Ct.useDeferredValue=function(t){return gi.current.useDeferredValue(t)};Ct.useEffect=function(t,e){return gi.current.useEffect(t,e)};Ct.useId=function(){return gi.current.useId()};Ct.useImperativeHandle=function(t,e,r){return gi.current.useImperativeHandle(t,e,r)};Ct.useInsertionEffect=function(t,e){return gi.current.useInsertionEffect(t,e)};Ct.useLayoutEffect=function(t,e){return gi.current.useLayoutEffect(t,e)};Ct.useMemo=function(t,e){return gi.current.useMemo(t,e)};Ct.useReducer=function(t,e,r){return gi.current.useReducer(t,e,r)};Ct.useRef=function(t){return gi.current.useRef(t)};Ct.useState=function(t){return gi.current.useState(t)};Ct.useSyncExternalStore=function(t,e,r){return gi.current.useSyncExternalStore(t,e,r)};Ct.useTransition=function(){return gi.current.useTransition()};Ct.version="18.3.1";dw.exports=Ct;var ye=dw.exports;const Q0=zF(ye);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var iI=ye,sI=Symbol.for("react.element"),aI=Symbol.for("react.fragment"),oI=Object.prototype.hasOwnProperty,lI=iI.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,cI={key:!0,ref:!0,__self:!0,__source:!0};function Ew(t,e,r){var n,i={},s=null,a=null;r!==void 0&&(s=""+r),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(a=e.ref);for(n in e)oI.call(e,n)&&!cI.hasOwnProperty(n)&&(i[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)i[n]===void 0&&(i[n]=e[n]);return{$$typeof:sI,type:t,key:s,ref:a,props:i,_owner:lI.current}}xp.Fragment=aI;xp.jsx=Ew;xp.jsxs=Ew;fw.exports=xp;var u=fw.exports,cm={},ww={exports:{}},Xi={},Sw={exports:{}},Tw={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(we,re){var Ae=we.length;we.push(re);e:for(;0<Ae;){var Oe=Ae-1>>>1,z=we[Oe];if(0<i(z,re))we[Oe]=re,we[Ae]=z,Ae=Oe;else break e}}function r(we){return we.length===0?null:we[0]}function n(we){if(we.length===0)return null;var re=we[0],Ae=we.pop();if(Ae!==re){we[0]=Ae;e:for(var Oe=0,z=we.length,ne=z>>>1;Oe<ne;){var te=2*(Oe+1)-1,Y=we[te],ge=te+1,Ee=we[ge];if(0>i(Y,Ae))ge<z&&0>i(Ee,Y)?(we[Oe]=Ee,we[ge]=Ae,Oe=ge):(we[Oe]=Y,we[te]=Ae,Oe=te);else if(ge<z&&0>i(Ee,Ae))we[Oe]=Ee,we[ge]=Ae,Oe=ge;else break e}}return re}function i(we,re){var Ae=we.sortIndex-re.sortIndex;return Ae!==0?Ae:we.id-re.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();t.unstable_now=function(){return a.now()-o}}var l=[],c=[],d=1,h=null,g=3,m=!1,y=!1,x=!1,E=typeof setTimeout=="function"?setTimeout:null,A=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function _(we){for(var re=r(c);re!==null;){if(re.callback===null)n(c);else if(re.startTime<=we)n(c),re.sortIndex=re.expirationTime,e(l,re);else break;re=r(c)}}function P(we){if(x=!1,_(we),!y)if(r(l)!==null)y=!0,Ie(K);else{var re=r(c);re!==null&&De(P,re.startTime-we)}}function K(we,re){y=!1,x&&(x=!1,A(F),F=-1),m=!0;var Ae=g;try{for(_(re),h=r(l);h!==null&&(!(h.expirationTime>re)||we&&!N());){var Oe=h.callback;if(typeof Oe=="function"){h.callback=null,g=h.priorityLevel;var z=Oe(h.expirationTime<=re);re=t.unstable_now(),typeof z=="function"?h.callback=z:h===r(l)&&n(l),_(re)}else n(l);h=r(l)}if(h!==null)var ne=!0;else{var te=r(c);te!==null&&De(P,te.startTime-re),ne=!1}return ne}finally{h=null,g=Ae,m=!1}}var V=!1,S=null,F=-1,w=5,b=-1;function N(){return!(t.unstable_now()-b<w)}function D(){if(S!==null){var we=t.unstable_now();b=we;var re=!0;try{re=S(!0,we)}finally{re?R():(V=!1,S=null)}}else V=!1}var R;if(typeof k=="function")R=function(){k(D)};else if(typeof MessageChannel<"u"){var ze=new MessageChannel,_e=ze.port2;ze.port1.onmessage=D,R=function(){_e.postMessage(null)}}else R=function(){E(D,0)};function Ie(we){S=we,V||(V=!0,R())}function De(we,re){F=E(function(){we(t.unstable_now())},re)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(we){we.callback=null},t.unstable_continueExecution=function(){y||m||(y=!0,Ie(K))},t.unstable_forceFrameRate=function(we){0>we||125<we?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):w=0<we?Math.floor(1e3/we):5},t.unstable_getCurrentPriorityLevel=function(){return g},t.unstable_getFirstCallbackNode=function(){return r(l)},t.unstable_next=function(we){switch(g){case 1:case 2:case 3:var re=3;break;default:re=g}var Ae=g;g=re;try{return we()}finally{g=Ae}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(we,re){switch(we){case 1:case 2:case 3:case 4:case 5:break;default:we=3}var Ae=g;g=we;try{return re()}finally{g=Ae}},t.unstable_scheduleCallback=function(we,re,Ae){var Oe=t.unstable_now();switch(typeof Ae=="object"&&Ae!==null?(Ae=Ae.delay,Ae=typeof Ae=="number"&&0<Ae?Oe+Ae:Oe):Ae=Oe,we){case 1:var z=-1;break;case 2:z=250;break;case 5:z=1073741823;break;case 4:z=1e4;break;default:z=5e3}return z=Ae+z,we={id:d++,callback:re,priorityLevel:we,startTime:Ae,expirationTime:z,sortIndex:-1},Ae>Oe?(we.sortIndex=Ae,e(c,we),r(l)===null&&we===r(c)&&(x?(A(F),F=-1):x=!0,De(P,Ae-Oe))):(we.sortIndex=z,e(l,we),y||m||(y=!0,Ie(K))),we},t.unstable_shouldYield=N,t.unstable_wrapCallback=function(we){var re=g;return function(){var Ae=g;g=re;try{return we.apply(this,arguments)}finally{g=Ae}}}})(Tw);Sw.exports=Tw;var uI=Sw.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fI=ye,Gi=uI;function Ne(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Aw=new Set,jf={};function Zl(t,e){su(t,e),su(t+"Capture",e)}function su(t,e){for(jf[t]=e,t=0;t<e.length;t++)Aw.add(e[t])}var La=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),um=Object.prototype.hasOwnProperty,dI=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Iy={},by={};function hI(t){return um.call(by,t)?!0:um.call(Iy,t)?!1:dI.test(t)?by[t]=!0:(Iy[t]=!0,!1)}function pI(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function gI(t,e,r,n){if(e===null||typeof e>"u"||pI(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function mi(t,e,r,n,i,s,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=a}var Bn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Bn[t]=new mi(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Bn[e]=new mi(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Bn[t]=new mi(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Bn[t]=new mi(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Bn[t]=new mi(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Bn[t]=new mi(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Bn[t]=new mi(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Bn[t]=new mi(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Bn[t]=new mi(t,5,!1,t.toLowerCase(),null,!1,!1)});var Vx=/[\-:]([a-z])/g;function Ux(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Vx,Ux);Bn[e]=new mi(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Vx,Ux);Bn[e]=new mi(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Vx,Ux);Bn[e]=new mi(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Bn[t]=new mi(t,1,!1,t.toLowerCase(),null,!1,!1)});Bn.xlinkHref=new mi("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Bn[t]=new mi(t,1,!1,t.toLowerCase(),null,!0,!0)});function zx(t,e,r,n){var i=Bn.hasOwnProperty(e)?Bn[e]:null;(i!==null?i.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(gI(e,r,i,n)&&(r=null),n||i===null?hI(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):i.mustUseProperty?t[i.propertyName]=r===null?i.type===3?!1:"":r:(e=i.attributeName,n=i.attributeNamespace,r===null?t.removeAttribute(e):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var Ka=fI.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,f0=Symbol.for("react.element"),bc=Symbol.for("react.portal"),Rc=Symbol.for("react.fragment"),Wx=Symbol.for("react.strict_mode"),fm=Symbol.for("react.profiler"),kw=Symbol.for("react.provider"),Cw=Symbol.for("react.context"),Hx=Symbol.for("react.forward_ref"),dm=Symbol.for("react.suspense"),hm=Symbol.for("react.suspense_list"),$x=Symbol.for("react.memo"),yo=Symbol.for("react.lazy"),Fw=Symbol.for("react.offscreen"),Ry=Symbol.iterator;function Ku(t){return t===null||typeof t!="object"?null:(t=Ry&&t[Ry]||t["@@iterator"],typeof t=="function"?t:null)}var Fr=Object.assign,ig;function af(t){if(ig===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);ig=e&&e[1]||""}return`
`+ig+t}var sg=!1;function ag(t,e){if(!t||sg)return"";sg=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var n=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){n=c}t.call(e.prototype)}else{try{throw Error()}catch(c){n=c}t()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),s=n.stack.split(`
`),a=i.length-1,o=s.length-1;1<=a&&0<=o&&i[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(i[a]!==s[o]){if(a!==1||o!==1)do if(a--,o--,0>o||i[a]!==s[o]){var l=`
`+i[a].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=a&&0<=o);break}}}finally{sg=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?af(t):""}function mI(t){switch(t.tag){case 5:return af(t.type);case 16:return af("Lazy");case 13:return af("Suspense");case 19:return af("SuspenseList");case 0:case 2:case 15:return t=ag(t.type,!1),t;case 11:return t=ag(t.type.render,!1),t;case 1:return t=ag(t.type,!0),t;default:return""}}function pm(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Rc:return"Fragment";case bc:return"Portal";case fm:return"Profiler";case Wx:return"StrictMode";case dm:return"Suspense";case hm:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Cw:return(t.displayName||"Context")+".Consumer";case kw:return(t._context.displayName||"Context")+".Provider";case Hx:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case $x:return e=t.displayName||null,e!==null?e:pm(t.type)||"Memo";case yo:e=t._payload,t=t._init;try{return pm(t(e))}catch{}}return null}function xI(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return pm(e);case 8:return e===Wx?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Go(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Iw(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function vI(t){var e=Iw(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,s=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(a){n=""+a,s.call(this,a)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(a){n=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function d0(t){t._valueTracker||(t._valueTracker=vI(t))}function bw(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=Iw(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function xh(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function gm(t,e){var r=e.checked;return Fr({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function Ny(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=Go(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Rw(t,e){e=e.checked,e!=null&&zx(t,"checked",e,!1)}function mm(t,e){Rw(t,e);var r=Go(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?xm(t,e.type,r):e.hasOwnProperty("defaultValue")&&xm(t,e.type,Go(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Dy(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function xm(t,e,r){(e!=="number"||xh(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var of=Array.isArray;function $c(t,e,r,n){if(t=t.options,e){e={};for(var i=0;i<r.length;i++)e["$"+r[i]]=!0;for(r=0;r<t.length;r++)i=e.hasOwnProperty("$"+t[r].value),t[r].selected!==i&&(t[r].selected=i),i&&n&&(t[r].defaultSelected=!0)}else{for(r=""+Go(r),e=null,i=0;i<t.length;i++){if(t[i].value===r){t[i].selected=!0,n&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function vm(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Ne(91));return Fr({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Py(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(Ne(92));if(of(r)){if(1<r.length)throw Error(Ne(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:Go(r)}}function Nw(t,e){var r=Go(e.value),n=Go(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function Oy(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Dw(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ym(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Dw(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var h0,Pw=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,i){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(h0=h0||document.createElement("div"),h0.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=h0.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Vf(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var xf={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},yI=["Webkit","ms","Moz","O"];Object.keys(xf).forEach(function(t){yI.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),xf[e]=xf[t]})});function Ow(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||xf.hasOwnProperty(t)&&xf[t]?(""+e).trim():e+"px"}function Mw(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=Ow(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,i):t[r]=i}}var _I=Fr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function _m(t,e){if(e){if(_I[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Ne(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Ne(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Ne(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Ne(62))}}function Em(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wm=null;function Gx(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Sm=null,Gc=null,Kc=null;function My(t){if(t=Id(t)){if(typeof Sm!="function")throw Error(Ne(280));var e=t.stateNode;e&&(e=wp(e),Sm(t.stateNode,t.type,e))}}function Lw(t){Gc?Kc?Kc.push(t):Kc=[t]:Gc=t}function Bw(){if(Gc){var t=Gc,e=Kc;if(Kc=Gc=null,My(t),e)for(t=0;t<e.length;t++)My(e[t])}}function jw(t,e){return t(e)}function Vw(){}var og=!1;function Uw(t,e,r){if(og)return t(e,r);og=!0;try{return jw(t,e,r)}finally{og=!1,(Gc!==null||Kc!==null)&&(Vw(),Bw())}}function Uf(t,e){var r=t.stateNode;if(r===null)return null;var n=wp(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(Ne(231,e,typeof r));return r}var Tm=!1;if(La)try{var Xu={};Object.defineProperty(Xu,"passive",{get:function(){Tm=!0}}),window.addEventListener("test",Xu,Xu),window.removeEventListener("test",Xu,Xu)}catch{Tm=!1}function EI(t,e,r,n,i,s,a,o,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(r,c)}catch(d){this.onError(d)}}var vf=!1,vh=null,yh=!1,Am=null,wI={onError:function(t){vf=!0,vh=t}};function SI(t,e,r,n,i,s,a,o,l){vf=!1,vh=null,EI.apply(wI,arguments)}function TI(t,e,r,n,i,s,a,o,l){if(SI.apply(this,arguments),vf){if(vf){var c=vh;vf=!1,vh=null}else throw Error(Ne(198));yh||(yh=!0,Am=c)}}function ec(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function zw(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Ly(t){if(ec(t)!==t)throw Error(Ne(188))}function AI(t){var e=t.alternate;if(!e){if(e=ec(t),e===null)throw Error(Ne(188));return e!==t?null:t}for(var r=t,n=e;;){var i=r.return;if(i===null)break;var s=i.alternate;if(s===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return Ly(i),t;if(s===n)return Ly(i),e;s=s.sibling}throw Error(Ne(188))}if(r.return!==n.return)r=i,n=s;else{for(var a=!1,o=i.child;o;){if(o===r){a=!0,r=i,n=s;break}if(o===n){a=!0,n=i,r=s;break}o=o.sibling}if(!a){for(o=s.child;o;){if(o===r){a=!0,r=s,n=i;break}if(o===n){a=!0,n=s,r=i;break}o=o.sibling}if(!a)throw Error(Ne(189))}}if(r.alternate!==n)throw Error(Ne(190))}if(r.tag!==3)throw Error(Ne(188));return r.stateNode.current===r?t:e}function Ww(t){return t=AI(t),t!==null?Hw(t):null}function Hw(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Hw(t);if(e!==null)return e;t=t.sibling}return null}var $w=Gi.unstable_scheduleCallback,By=Gi.unstable_cancelCallback,kI=Gi.unstable_shouldYield,CI=Gi.unstable_requestPaint,Gr=Gi.unstable_now,FI=Gi.unstable_getCurrentPriorityLevel,Kx=Gi.unstable_ImmediatePriority,Gw=Gi.unstable_UserBlockingPriority,_h=Gi.unstable_NormalPriority,II=Gi.unstable_LowPriority,Kw=Gi.unstable_IdlePriority,vp=null,aa=null;function bI(t){if(aa&&typeof aa.onCommitFiberRoot=="function")try{aa.onCommitFiberRoot(vp,t,void 0,(t.current.flags&128)===128)}catch{}}var Os=Math.clz32?Math.clz32:DI,RI=Math.log,NI=Math.LN2;function DI(t){return t>>>=0,t===0?32:31-(RI(t)/NI|0)|0}var p0=64,g0=4194304;function lf(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Eh(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,i=t.suspendedLanes,s=t.pingedLanes,a=r&268435455;if(a!==0){var o=a&~i;o!==0?n=lf(o):(s&=a,s!==0&&(n=lf(s)))}else a=r&~i,a!==0?n=lf(a):s!==0&&(n=lf(s));if(n===0)return 0;if(e!==0&&e!==n&&!(e&i)&&(i=n&-n,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-Os(e),i=1<<r,n|=t[r],e&=~i;return n}function PI(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function OI(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var a=31-Os(s),o=1<<a,l=i[a];l===-1?(!(o&r)||o&n)&&(i[a]=PI(o,e)):l<=e&&(t.expiredLanes|=o),s&=~o}}function km(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Xw(){var t=p0;return p0<<=1,!(p0&4194240)&&(p0=64),t}function lg(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function Cd(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Os(e),t[e]=r}function MI(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var i=31-Os(r),s=1<<i;e[i]=0,n[i]=-1,t[i]=-1,r&=~s}}function Xx(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-Os(r),i=1<<n;i&e|t[n]&e&&(t[n]|=e),r&=~i}}var ir=0;function Yw(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var qw,Yx,Qw,Jw,Zw,Cm=!1,m0=[],Do=null,Po=null,Oo=null,zf=new Map,Wf=new Map,Eo=[],LI="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function jy(t,e){switch(t){case"focusin":case"focusout":Do=null;break;case"dragenter":case"dragleave":Po=null;break;case"mouseover":case"mouseout":Oo=null;break;case"pointerover":case"pointerout":zf.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Wf.delete(e.pointerId)}}function Yu(t,e,r,n,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},e!==null&&(e=Id(e),e!==null&&Yx(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function BI(t,e,r,n,i){switch(e){case"focusin":return Do=Yu(Do,t,e,r,n,i),!0;case"dragenter":return Po=Yu(Po,t,e,r,n,i),!0;case"mouseover":return Oo=Yu(Oo,t,e,r,n,i),!0;case"pointerover":var s=i.pointerId;return zf.set(s,Yu(zf.get(s)||null,t,e,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,Wf.set(s,Yu(Wf.get(s)||null,t,e,r,n,i)),!0}return!1}function eS(t){var e=Tl(t.target);if(e!==null){var r=ec(e);if(r!==null){if(e=r.tag,e===13){if(e=zw(r),e!==null){t.blockedOn=e,Zw(t.priority,function(){Qw(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function J0(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=Fm(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);wm=n,r.target.dispatchEvent(n),wm=null}else return e=Id(r),e!==null&&Yx(e),t.blockedOn=r,!1;e.shift()}return!0}function Vy(t,e,r){J0(t)&&r.delete(e)}function jI(){Cm=!1,Do!==null&&J0(Do)&&(Do=null),Po!==null&&J0(Po)&&(Po=null),Oo!==null&&J0(Oo)&&(Oo=null),zf.forEach(Vy),Wf.forEach(Vy)}function qu(t,e){t.blockedOn===e&&(t.blockedOn=null,Cm||(Cm=!0,Gi.unstable_scheduleCallback(Gi.unstable_NormalPriority,jI)))}function Hf(t){function e(i){return qu(i,t)}if(0<m0.length){qu(m0[0],t);for(var r=1;r<m0.length;r++){var n=m0[r];n.blockedOn===t&&(n.blockedOn=null)}}for(Do!==null&&qu(Do,t),Po!==null&&qu(Po,t),Oo!==null&&qu(Oo,t),zf.forEach(e),Wf.forEach(e),r=0;r<Eo.length;r++)n=Eo[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<Eo.length&&(r=Eo[0],r.blockedOn===null);)eS(r),r.blockedOn===null&&Eo.shift()}var Xc=Ka.ReactCurrentBatchConfig,wh=!0;function VI(t,e,r,n){var i=ir,s=Xc.transition;Xc.transition=null;try{ir=1,qx(t,e,r,n)}finally{ir=i,Xc.transition=s}}function UI(t,e,r,n){var i=ir,s=Xc.transition;Xc.transition=null;try{ir=4,qx(t,e,r,n)}finally{ir=i,Xc.transition=s}}function qx(t,e,r,n){if(wh){var i=Fm(t,e,r,n);if(i===null)vg(t,e,n,Sh,r),jy(t,n);else if(BI(i,t,e,r,n))n.stopPropagation();else if(jy(t,n),e&4&&-1<LI.indexOf(t)){for(;i!==null;){var s=Id(i);if(s!==null&&qw(s),s=Fm(t,e,r,n),s===null&&vg(t,e,n,Sh,r),s===i)break;i=s}i!==null&&n.stopPropagation()}else vg(t,e,n,null,r)}}var Sh=null;function Fm(t,e,r,n){if(Sh=null,t=Gx(n),t=Tl(t),t!==null)if(e=ec(t),e===null)t=null;else if(r=e.tag,r===13){if(t=zw(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Sh=t,null}function tS(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(FI()){case Kx:return 1;case Gw:return 4;case _h:case II:return 16;case Kw:return 536870912;default:return 16}default:return 16}}var Co=null,Qx=null,Z0=null;function rS(){if(Z0)return Z0;var t,e=Qx,r=e.length,n,i="value"in Co?Co.value:Co.textContent,s=i.length;for(t=0;t<r&&e[t]===i[t];t++);var a=r-t;for(n=1;n<=a&&e[r-n]===i[s-n];n++);return Z0=i.slice(t,1<n?1-n:void 0)}function eh(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function x0(){return!0}function Uy(){return!1}function Yi(t){function e(r,n,i,s,a){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(r=t[o],this[o]=r?r(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?x0:Uy,this.isPropagationStopped=Uy,this}return Fr(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=x0)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=x0)},persist:function(){},isPersistent:x0}),e}var Au={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Jx=Yi(Au),Fd=Fr({},Au,{view:0,detail:0}),zI=Yi(Fd),cg,ug,Qu,yp=Fr({},Fd,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Zx,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Qu&&(Qu&&t.type==="mousemove"?(cg=t.screenX-Qu.screenX,ug=t.screenY-Qu.screenY):ug=cg=0,Qu=t),cg)},movementY:function(t){return"movementY"in t?t.movementY:ug}}),zy=Yi(yp),WI=Fr({},yp,{dataTransfer:0}),HI=Yi(WI),$I=Fr({},Fd,{relatedTarget:0}),fg=Yi($I),GI=Fr({},Au,{animationName:0,elapsedTime:0,pseudoElement:0}),KI=Yi(GI),XI=Fr({},Au,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),YI=Yi(XI),qI=Fr({},Au,{data:0}),Wy=Yi(qI),QI={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},JI={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ZI={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function eb(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=ZI[t])?!!e[t]:!1}function Zx(){return eb}var tb=Fr({},Fd,{key:function(t){if(t.key){var e=QI[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=eh(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?JI[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Zx,charCode:function(t){return t.type==="keypress"?eh(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?eh(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),rb=Yi(tb),nb=Fr({},yp,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Hy=Yi(nb),ib=Fr({},Fd,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Zx}),sb=Yi(ib),ab=Fr({},Au,{propertyName:0,elapsedTime:0,pseudoElement:0}),ob=Yi(ab),lb=Fr({},yp,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),cb=Yi(lb),ub=[9,13,27,32],e1=La&&"CompositionEvent"in window,yf=null;La&&"documentMode"in document&&(yf=document.documentMode);var fb=La&&"TextEvent"in window&&!yf,nS=La&&(!e1||yf&&8<yf&&11>=yf),$y=" ",Gy=!1;function iS(t,e){switch(t){case"keyup":return ub.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function sS(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Nc=!1;function db(t,e){switch(t){case"compositionend":return sS(e);case"keypress":return e.which!==32?null:(Gy=!0,$y);case"textInput":return t=e.data,t===$y&&Gy?null:t;default:return null}}function hb(t,e){if(Nc)return t==="compositionend"||!e1&&iS(t,e)?(t=rS(),Z0=Qx=Co=null,Nc=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return nS&&e.locale!=="ko"?null:e.data;default:return null}}var pb={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ky(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!pb[t.type]:e==="textarea"}function aS(t,e,r,n){Lw(n),e=Th(e,"onChange"),0<e.length&&(r=new Jx("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var _f=null,$f=null;function gb(t){xS(t,0)}function _p(t){var e=Oc(t);if(bw(e))return t}function mb(t,e){if(t==="change")return e}var oS=!1;if(La){var dg;if(La){var hg="oninput"in document;if(!hg){var Xy=document.createElement("div");Xy.setAttribute("oninput","return;"),hg=typeof Xy.oninput=="function"}dg=hg}else dg=!1;oS=dg&&(!document.documentMode||9<document.documentMode)}function Yy(){_f&&(_f.detachEvent("onpropertychange",lS),$f=_f=null)}function lS(t){if(t.propertyName==="value"&&_p($f)){var e=[];aS(e,$f,t,Gx(t)),Uw(gb,e)}}function xb(t,e,r){t==="focusin"?(Yy(),_f=e,$f=r,_f.attachEvent("onpropertychange",lS)):t==="focusout"&&Yy()}function vb(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return _p($f)}function yb(t,e){if(t==="click")return _p(e)}function _b(t,e){if(t==="input"||t==="change")return _p(e)}function Eb(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var js=typeof Object.is=="function"?Object.is:Eb;function Gf(t,e){if(js(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!um.call(e,i)||!js(t[i],e[i]))return!1}return!0}function qy(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Qy(t,e){var r=qy(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=qy(r)}}function cS(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?cS(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function uS(){for(var t=window,e=xh();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=xh(t.document)}return e}function t1(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function wb(t){var e=uS(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&cS(r.ownerDocument.documentElement,r)){if(n!==null&&t1(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=r.textContent.length,s=Math.min(n.start,i);n=n.end===void 0?s:Math.min(n.end,i),!t.extend&&s>n&&(i=n,n=s,s=i),i=Qy(r,s);var a=Qy(r,n);i&&a&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>n?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var Sb=La&&"documentMode"in document&&11>=document.documentMode,Dc=null,Im=null,Ef=null,bm=!1;function Jy(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;bm||Dc==null||Dc!==xh(n)||(n=Dc,"selectionStart"in n&&t1(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Ef&&Gf(Ef,n)||(Ef=n,n=Th(Im,"onSelect"),0<n.length&&(e=new Jx("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=Dc)))}function v0(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var Pc={animationend:v0("Animation","AnimationEnd"),animationiteration:v0("Animation","AnimationIteration"),animationstart:v0("Animation","AnimationStart"),transitionend:v0("Transition","TransitionEnd")},pg={},fS={};La&&(fS=document.createElement("div").style,"AnimationEvent"in window||(delete Pc.animationend.animation,delete Pc.animationiteration.animation,delete Pc.animationstart.animation),"TransitionEvent"in window||delete Pc.transitionend.transition);function Ep(t){if(pg[t])return pg[t];if(!Pc[t])return t;var e=Pc[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in fS)return pg[t]=e[r];return t}var dS=Ep("animationend"),hS=Ep("animationiteration"),pS=Ep("animationstart"),gS=Ep("transitionend"),mS=new Map,Zy="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function tl(t,e){mS.set(t,e),Zl(e,[t])}for(var gg=0;gg<Zy.length;gg++){var mg=Zy[gg],Tb=mg.toLowerCase(),Ab=mg[0].toUpperCase()+mg.slice(1);tl(Tb,"on"+Ab)}tl(dS,"onAnimationEnd");tl(hS,"onAnimationIteration");tl(pS,"onAnimationStart");tl("dblclick","onDoubleClick");tl("focusin","onFocus");tl("focusout","onBlur");tl(gS,"onTransitionEnd");su("onMouseEnter",["mouseout","mouseover"]);su("onMouseLeave",["mouseout","mouseover"]);su("onPointerEnter",["pointerout","pointerover"]);su("onPointerLeave",["pointerout","pointerover"]);Zl("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Zl("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Zl("onBeforeInput",["compositionend","keypress","textInput","paste"]);Zl("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Zl("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Zl("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var cf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),kb=new Set("cancel close invalid load scroll toggle".split(" ").concat(cf));function e_(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,TI(n,e,void 0,t),t.currentTarget=null}function xS(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],i=n.event;n=n.listeners;e:{var s=void 0;if(e)for(var a=n.length-1;0<=a;a--){var o=n[a],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==s&&i.isPropagationStopped())break e;e_(i,o,c),s=l}else for(a=0;a<n.length;a++){if(o=n[a],l=o.instance,c=o.currentTarget,o=o.listener,l!==s&&i.isPropagationStopped())break e;e_(i,o,c),s=l}}}if(yh)throw t=Am,yh=!1,Am=null,t}function pr(t,e){var r=e[Om];r===void 0&&(r=e[Om]=new Set);var n=t+"__bubble";r.has(n)||(vS(e,t,2,!1),r.add(n))}function xg(t,e,r){var n=0;e&&(n|=4),vS(r,t,n,e)}var y0="_reactListening"+Math.random().toString(36).slice(2);function Kf(t){if(!t[y0]){t[y0]=!0,Aw.forEach(function(r){r!=="selectionchange"&&(kb.has(r)||xg(r,!1,t),xg(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[y0]||(e[y0]=!0,xg("selectionchange",!1,e))}}function vS(t,e,r,n){switch(tS(e)){case 1:var i=VI;break;case 4:i=UI;break;default:i=qx}r=i.bind(null,e,r,t),i=void 0,!Tm||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),n?i!==void 0?t.addEventListener(e,r,{capture:!0,passive:i}):t.addEventListener(e,r,!0):i!==void 0?t.addEventListener(e,r,{passive:i}):t.addEventListener(e,r,!1)}function vg(t,e,r,n,i){var s=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var a=n.tag;if(a===3||a===4){var o=n.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(a===4)for(a=n.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;a=a.return}for(;o!==null;){if(a=Tl(o),a===null)return;if(l=a.tag,l===5||l===6){n=s=a;continue e}o=o.parentNode}}n=n.return}Uw(function(){var c=s,d=Gx(r),h=[];e:{var g=mS.get(t);if(g!==void 0){var m=Jx,y=t;switch(t){case"keypress":if(eh(r)===0)break e;case"keydown":case"keyup":m=rb;break;case"focusin":y="focus",m=fg;break;case"focusout":y="blur",m=fg;break;case"beforeblur":case"afterblur":m=fg;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=zy;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=HI;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=sb;break;case dS:case hS:case pS:m=KI;break;case gS:m=ob;break;case"scroll":m=zI;break;case"wheel":m=cb;break;case"copy":case"cut":case"paste":m=YI;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=Hy}var x=(e&4)!==0,E=!x&&t==="scroll",A=x?g!==null?g+"Capture":null:g;x=[];for(var k=c,_;k!==null;){_=k;var P=_.stateNode;if(_.tag===5&&P!==null&&(_=P,A!==null&&(P=Uf(k,A),P!=null&&x.push(Xf(k,P,_)))),E)break;k=k.return}0<x.length&&(g=new m(g,y,null,r,d),h.push({event:g,listeners:x}))}}if(!(e&7)){e:{if(g=t==="mouseover"||t==="pointerover",m=t==="mouseout"||t==="pointerout",g&&r!==wm&&(y=r.relatedTarget||r.fromElement)&&(Tl(y)||y[Ba]))break e;if((m||g)&&(g=d.window===d?d:(g=d.ownerDocument)?g.defaultView||g.parentWindow:window,m?(y=r.relatedTarget||r.toElement,m=c,y=y?Tl(y):null,y!==null&&(E=ec(y),y!==E||y.tag!==5&&y.tag!==6)&&(y=null)):(m=null,y=c),m!==y)){if(x=zy,P="onMouseLeave",A="onMouseEnter",k="mouse",(t==="pointerout"||t==="pointerover")&&(x=Hy,P="onPointerLeave",A="onPointerEnter",k="pointer"),E=m==null?g:Oc(m),_=y==null?g:Oc(y),g=new x(P,k+"leave",m,r,d),g.target=E,g.relatedTarget=_,P=null,Tl(d)===c&&(x=new x(A,k+"enter",y,r,d),x.target=_,x.relatedTarget=E,P=x),E=P,m&&y)t:{for(x=m,A=y,k=0,_=x;_;_=Ec(_))k++;for(_=0,P=A;P;P=Ec(P))_++;for(;0<k-_;)x=Ec(x),k--;for(;0<_-k;)A=Ec(A),_--;for(;k--;){if(x===A||A!==null&&x===A.alternate)break t;x=Ec(x),A=Ec(A)}x=null}else x=null;m!==null&&t_(h,g,m,x,!1),y!==null&&E!==null&&t_(h,E,y,x,!0)}}e:{if(g=c?Oc(c):window,m=g.nodeName&&g.nodeName.toLowerCase(),m==="select"||m==="input"&&g.type==="file")var K=mb;else if(Ky(g))if(oS)K=_b;else{K=vb;var V=xb}else(m=g.nodeName)&&m.toLowerCase()==="input"&&(g.type==="checkbox"||g.type==="radio")&&(K=yb);if(K&&(K=K(t,c))){aS(h,K,r,d);break e}V&&V(t,g,c),t==="focusout"&&(V=g._wrapperState)&&V.controlled&&g.type==="number"&&xm(g,"number",g.value)}switch(V=c?Oc(c):window,t){case"focusin":(Ky(V)||V.contentEditable==="true")&&(Dc=V,Im=c,Ef=null);break;case"focusout":Ef=Im=Dc=null;break;case"mousedown":bm=!0;break;case"contextmenu":case"mouseup":case"dragend":bm=!1,Jy(h,r,d);break;case"selectionchange":if(Sb)break;case"keydown":case"keyup":Jy(h,r,d)}var S;if(e1)e:{switch(t){case"compositionstart":var F="onCompositionStart";break e;case"compositionend":F="onCompositionEnd";break e;case"compositionupdate":F="onCompositionUpdate";break e}F=void 0}else Nc?iS(t,r)&&(F="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(F="onCompositionStart");F&&(nS&&r.locale!=="ko"&&(Nc||F!=="onCompositionStart"?F==="onCompositionEnd"&&Nc&&(S=rS()):(Co=d,Qx="value"in Co?Co.value:Co.textContent,Nc=!0)),V=Th(c,F),0<V.length&&(F=new Wy(F,t,null,r,d),h.push({event:F,listeners:V}),S?F.data=S:(S=sS(r),S!==null&&(F.data=S)))),(S=fb?db(t,r):hb(t,r))&&(c=Th(c,"onBeforeInput"),0<c.length&&(d=new Wy("onBeforeInput","beforeinput",null,r,d),h.push({event:d,listeners:c}),d.data=S))}xS(h,e)})}function Xf(t,e,r){return{instance:t,listener:e,currentTarget:r}}function Th(t,e){for(var r=e+"Capture",n=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Uf(t,r),s!=null&&n.unshift(Xf(t,s,i)),s=Uf(t,e),s!=null&&n.push(Xf(t,s,i))),t=t.return}return n}function Ec(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function t_(t,e,r,n,i){for(var s=e._reactName,a=[];r!==null&&r!==n;){var o=r,l=o.alternate,c=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&c!==null&&(o=c,i?(l=Uf(r,s),l!=null&&a.unshift(Xf(r,l,o))):i||(l=Uf(r,s),l!=null&&a.push(Xf(r,l,o)))),r=r.return}a.length!==0&&t.push({event:e,listeners:a})}var Cb=/\r\n?/g,Fb=/\u0000|\uFFFD/g;function r_(t){return(typeof t=="string"?t:""+t).replace(Cb,`
`).replace(Fb,"")}function _0(t,e,r){if(e=r_(e),r_(t)!==e&&r)throw Error(Ne(425))}function Ah(){}var Rm=null,Nm=null;function Dm(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Pm=typeof setTimeout=="function"?setTimeout:void 0,Ib=typeof clearTimeout=="function"?clearTimeout:void 0,n_=typeof Promise=="function"?Promise:void 0,bb=typeof queueMicrotask=="function"?queueMicrotask:typeof n_<"u"?function(t){return n_.resolve(null).then(t).catch(Rb)}:Pm;function Rb(t){setTimeout(function(){throw t})}function yg(t,e){var r=e,n=0;do{var i=r.nextSibling;if(t.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){t.removeChild(i),Hf(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);Hf(e)}function Mo(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function i_(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var ku=Math.random().toString(36).slice(2),ia="__reactFiber$"+ku,Yf="__reactProps$"+ku,Ba="__reactContainer$"+ku,Om="__reactEvents$"+ku,Nb="__reactListeners$"+ku,Db="__reactHandles$"+ku;function Tl(t){var e=t[ia];if(e)return e;for(var r=t.parentNode;r;){if(e=r[Ba]||r[ia]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=i_(t);t!==null;){if(r=t[ia])return r;t=i_(t)}return e}t=r,r=t.parentNode}return null}function Id(t){return t=t[ia]||t[Ba],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Oc(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Ne(33))}function wp(t){return t[Yf]||null}var Mm=[],Mc=-1;function rl(t){return{current:t}}function mr(t){0>Mc||(t.current=Mm[Mc],Mm[Mc]=null,Mc--)}function ur(t,e){Mc++,Mm[Mc]=t.current,t.current=e}var Ko={},ni=rl(Ko),Fi=rl(!1),Ll=Ko;function au(t,e){var r=t.type.contextTypes;if(!r)return Ko;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in r)i[s]=e[s];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function Ii(t){return t=t.childContextTypes,t!=null}function kh(){mr(Fi),mr(ni)}function s_(t,e,r){if(ni.current!==Ko)throw Error(Ne(168));ur(ni,e),ur(Fi,r)}function yS(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in e))throw Error(Ne(108,xI(t)||"Unknown",i));return Fr({},r,n)}function Ch(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ko,Ll=ni.current,ur(ni,t),ur(Fi,Fi.current),!0}function a_(t,e,r){var n=t.stateNode;if(!n)throw Error(Ne(169));r?(t=yS(t,e,Ll),n.__reactInternalMemoizedMergedChildContext=t,mr(Fi),mr(ni),ur(ni,t)):mr(Fi),ur(Fi,r)}var Aa=null,Sp=!1,_g=!1;function _S(t){Aa===null?Aa=[t]:Aa.push(t)}function Pb(t){Sp=!0,_S(t)}function nl(){if(!_g&&Aa!==null){_g=!0;var t=0,e=ir;try{var r=Aa;for(ir=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}Aa=null,Sp=!1}catch(i){throw Aa!==null&&(Aa=Aa.slice(t+1)),$w(Kx,nl),i}finally{ir=e,_g=!1}}return null}var Lc=[],Bc=0,Fh=null,Ih=0,os=[],ls=0,Bl=null,ka=1,Ca="";function yl(t,e){Lc[Bc++]=Ih,Lc[Bc++]=Fh,Fh=t,Ih=e}function ES(t,e,r){os[ls++]=ka,os[ls++]=Ca,os[ls++]=Bl,Bl=t;var n=ka;t=Ca;var i=32-Os(n)-1;n&=~(1<<i),r+=1;var s=32-Os(e)+i;if(30<s){var a=i-i%5;s=(n&(1<<a)-1).toString(32),n>>=a,i-=a,ka=1<<32-Os(e)+i|r<<i|n,Ca=s+t}else ka=1<<s|r<<i|n,Ca=t}function r1(t){t.return!==null&&(yl(t,1),ES(t,1,0))}function n1(t){for(;t===Fh;)Fh=Lc[--Bc],Lc[Bc]=null,Ih=Lc[--Bc],Lc[Bc]=null;for(;t===Bl;)Bl=os[--ls],os[ls]=null,Ca=os[--ls],os[ls]=null,ka=os[--ls],os[ls]=null}var Hi=null,Wi=null,wr=!1,Rs=null;function wS(t,e){var r=us(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function o_(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Hi=t,Wi=Mo(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Hi=t,Wi=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=Bl!==null?{id:ka,overflow:Ca}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=us(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,Hi=t,Wi=null,!0):!1;default:return!1}}function Lm(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Bm(t){if(wr){var e=Wi;if(e){var r=e;if(!o_(t,e)){if(Lm(t))throw Error(Ne(418));e=Mo(r.nextSibling);var n=Hi;e&&o_(t,e)?wS(n,r):(t.flags=t.flags&-4097|2,wr=!1,Hi=t)}}else{if(Lm(t))throw Error(Ne(418));t.flags=t.flags&-4097|2,wr=!1,Hi=t}}}function l_(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Hi=t}function E0(t){if(t!==Hi)return!1;if(!wr)return l_(t),wr=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Dm(t.type,t.memoizedProps)),e&&(e=Wi)){if(Lm(t))throw SS(),Error(Ne(418));for(;e;)wS(t,e),e=Mo(e.nextSibling)}if(l_(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Ne(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){Wi=Mo(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}Wi=null}}else Wi=Hi?Mo(t.stateNode.nextSibling):null;return!0}function SS(){for(var t=Wi;t;)t=Mo(t.nextSibling)}function ou(){Wi=Hi=null,wr=!1}function i1(t){Rs===null?Rs=[t]:Rs.push(t)}var Ob=Ka.ReactCurrentBatchConfig;function Ju(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Ne(309));var n=r.stateNode}if(!n)throw Error(Ne(147,t));var i=n,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(a){var o=i.refs;a===null?delete o[s]:o[s]=a},e._stringRef=s,e)}if(typeof t!="string")throw Error(Ne(284));if(!r._owner)throw Error(Ne(290,t))}return t}function w0(t,e){throw t=Object.prototype.toString.call(e),Error(Ne(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function c_(t){var e=t._init;return e(t._payload)}function TS(t){function e(A,k){if(t){var _=A.deletions;_===null?(A.deletions=[k],A.flags|=16):_.push(k)}}function r(A,k){if(!t)return null;for(;k!==null;)e(A,k),k=k.sibling;return null}function n(A,k){for(A=new Map;k!==null;)k.key!==null?A.set(k.key,k):A.set(k.index,k),k=k.sibling;return A}function i(A,k){return A=Vo(A,k),A.index=0,A.sibling=null,A}function s(A,k,_){return A.index=_,t?(_=A.alternate,_!==null?(_=_.index,_<k?(A.flags|=2,k):_):(A.flags|=2,k)):(A.flags|=1048576,k)}function a(A){return t&&A.alternate===null&&(A.flags|=2),A}function o(A,k,_,P){return k===null||k.tag!==6?(k=Cg(_,A.mode,P),k.return=A,k):(k=i(k,_),k.return=A,k)}function l(A,k,_,P){var K=_.type;return K===Rc?d(A,k,_.props.children,P,_.key):k!==null&&(k.elementType===K||typeof K=="object"&&K!==null&&K.$$typeof===yo&&c_(K)===k.type)?(P=i(k,_.props),P.ref=Ju(A,k,_),P.return=A,P):(P=oh(_.type,_.key,_.props,null,A.mode,P),P.ref=Ju(A,k,_),P.return=A,P)}function c(A,k,_,P){return k===null||k.tag!==4||k.stateNode.containerInfo!==_.containerInfo||k.stateNode.implementation!==_.implementation?(k=Fg(_,A.mode,P),k.return=A,k):(k=i(k,_.children||[]),k.return=A,k)}function d(A,k,_,P,K){return k===null||k.tag!==7?(k=bl(_,A.mode,P,K),k.return=A,k):(k=i(k,_),k.return=A,k)}function h(A,k,_){if(typeof k=="string"&&k!==""||typeof k=="number")return k=Cg(""+k,A.mode,_),k.return=A,k;if(typeof k=="object"&&k!==null){switch(k.$$typeof){case f0:return _=oh(k.type,k.key,k.props,null,A.mode,_),_.ref=Ju(A,null,k),_.return=A,_;case bc:return k=Fg(k,A.mode,_),k.return=A,k;case yo:var P=k._init;return h(A,P(k._payload),_)}if(of(k)||Ku(k))return k=bl(k,A.mode,_,null),k.return=A,k;w0(A,k)}return null}function g(A,k,_,P){var K=k!==null?k.key:null;if(typeof _=="string"&&_!==""||typeof _=="number")return K!==null?null:o(A,k,""+_,P);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case f0:return _.key===K?l(A,k,_,P):null;case bc:return _.key===K?c(A,k,_,P):null;case yo:return K=_._init,g(A,k,K(_._payload),P)}if(of(_)||Ku(_))return K!==null?null:d(A,k,_,P,null);w0(A,_)}return null}function m(A,k,_,P,K){if(typeof P=="string"&&P!==""||typeof P=="number")return A=A.get(_)||null,o(k,A,""+P,K);if(typeof P=="object"&&P!==null){switch(P.$$typeof){case f0:return A=A.get(P.key===null?_:P.key)||null,l(k,A,P,K);case bc:return A=A.get(P.key===null?_:P.key)||null,c(k,A,P,K);case yo:var V=P._init;return m(A,k,_,V(P._payload),K)}if(of(P)||Ku(P))return A=A.get(_)||null,d(k,A,P,K,null);w0(k,P)}return null}function y(A,k,_,P){for(var K=null,V=null,S=k,F=k=0,w=null;S!==null&&F<_.length;F++){S.index>F?(w=S,S=null):w=S.sibling;var b=g(A,S,_[F],P);if(b===null){S===null&&(S=w);break}t&&S&&b.alternate===null&&e(A,S),k=s(b,k,F),V===null?K=b:V.sibling=b,V=b,S=w}if(F===_.length)return r(A,S),wr&&yl(A,F),K;if(S===null){for(;F<_.length;F++)S=h(A,_[F],P),S!==null&&(k=s(S,k,F),V===null?K=S:V.sibling=S,V=S);return wr&&yl(A,F),K}for(S=n(A,S);F<_.length;F++)w=m(S,A,F,_[F],P),w!==null&&(t&&w.alternate!==null&&S.delete(w.key===null?F:w.key),k=s(w,k,F),V===null?K=w:V.sibling=w,V=w);return t&&S.forEach(function(N){return e(A,N)}),wr&&yl(A,F),K}function x(A,k,_,P){var K=Ku(_);if(typeof K!="function")throw Error(Ne(150));if(_=K.call(_),_==null)throw Error(Ne(151));for(var V=K=null,S=k,F=k=0,w=null,b=_.next();S!==null&&!b.done;F++,b=_.next()){S.index>F?(w=S,S=null):w=S.sibling;var N=g(A,S,b.value,P);if(N===null){S===null&&(S=w);break}t&&S&&N.alternate===null&&e(A,S),k=s(N,k,F),V===null?K=N:V.sibling=N,V=N,S=w}if(b.done)return r(A,S),wr&&yl(A,F),K;if(S===null){for(;!b.done;F++,b=_.next())b=h(A,b.value,P),b!==null&&(k=s(b,k,F),V===null?K=b:V.sibling=b,V=b);return wr&&yl(A,F),K}for(S=n(A,S);!b.done;F++,b=_.next())b=m(S,A,F,b.value,P),b!==null&&(t&&b.alternate!==null&&S.delete(b.key===null?F:b.key),k=s(b,k,F),V===null?K=b:V.sibling=b,V=b);return t&&S.forEach(function(D){return e(A,D)}),wr&&yl(A,F),K}function E(A,k,_,P){if(typeof _=="object"&&_!==null&&_.type===Rc&&_.key===null&&(_=_.props.children),typeof _=="object"&&_!==null){switch(_.$$typeof){case f0:e:{for(var K=_.key,V=k;V!==null;){if(V.key===K){if(K=_.type,K===Rc){if(V.tag===7){r(A,V.sibling),k=i(V,_.props.children),k.return=A,A=k;break e}}else if(V.elementType===K||typeof K=="object"&&K!==null&&K.$$typeof===yo&&c_(K)===V.type){r(A,V.sibling),k=i(V,_.props),k.ref=Ju(A,V,_),k.return=A,A=k;break e}r(A,V);break}else e(A,V);V=V.sibling}_.type===Rc?(k=bl(_.props.children,A.mode,P,_.key),k.return=A,A=k):(P=oh(_.type,_.key,_.props,null,A.mode,P),P.ref=Ju(A,k,_),P.return=A,A=P)}return a(A);case bc:e:{for(V=_.key;k!==null;){if(k.key===V)if(k.tag===4&&k.stateNode.containerInfo===_.containerInfo&&k.stateNode.implementation===_.implementation){r(A,k.sibling),k=i(k,_.children||[]),k.return=A,A=k;break e}else{r(A,k);break}else e(A,k);k=k.sibling}k=Fg(_,A.mode,P),k.return=A,A=k}return a(A);case yo:return V=_._init,E(A,k,V(_._payload),P)}if(of(_))return y(A,k,_,P);if(Ku(_))return x(A,k,_,P);w0(A,_)}return typeof _=="string"&&_!==""||typeof _=="number"?(_=""+_,k!==null&&k.tag===6?(r(A,k.sibling),k=i(k,_),k.return=A,A=k):(r(A,k),k=Cg(_,A.mode,P),k.return=A,A=k),a(A)):r(A,k)}return E}var lu=TS(!0),AS=TS(!1),bh=rl(null),Rh=null,jc=null,s1=null;function a1(){s1=jc=Rh=null}function o1(t){var e=bh.current;mr(bh),t._currentValue=e}function jm(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function Yc(t,e){Rh=t,s1=jc=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Ci=!0),t.firstContext=null)}function hs(t){var e=t._currentValue;if(s1!==t)if(t={context:t,memoizedValue:e,next:null},jc===null){if(Rh===null)throw Error(Ne(308));jc=t,Rh.dependencies={lanes:0,firstContext:t}}else jc=jc.next=t;return e}var Al=null;function l1(t){Al===null?Al=[t]:Al.push(t)}function kS(t,e,r,n){var i=e.interleaved;return i===null?(r.next=r,l1(e)):(r.next=i.next,i.next=r),e.interleaved=r,ja(t,n)}function ja(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var _o=!1;function c1(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function CS(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Na(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Lo(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,Ut&2){var i=n.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),n.pending=e,ja(t,r)}return i=n.interleaved,i===null?(e.next=e,l1(n)):(e.next=i.next,i.next=e),n.interleaved=e,ja(t,r)}function th(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,Xx(t,r)}}function u_(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?i=s=a:s=s.next=a,r=r.next}while(r!==null);s===null?i=s=e:s=s.next=e}else i=s=e;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function Nh(t,e,r,n){var i=t.updateQueue;_o=!1;var s=i.firstBaseUpdate,a=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var l=o,c=l.next;l.next=null,a===null?s=c:a.next=c,a=l;var d=t.alternate;d!==null&&(d=d.updateQueue,o=d.lastBaseUpdate,o!==a&&(o===null?d.firstBaseUpdate=c:o.next=c,d.lastBaseUpdate=l))}if(s!==null){var h=i.baseState;a=0,d=c=l=null,o=s;do{var g=o.lane,m=o.eventTime;if((n&g)===g){d!==null&&(d=d.next={eventTime:m,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var y=t,x=o;switch(g=e,m=r,x.tag){case 1:if(y=x.payload,typeof y=="function"){h=y.call(m,h,g);break e}h=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=x.payload,g=typeof y=="function"?y.call(m,h,g):y,g==null)break e;h=Fr({},h,g);break e;case 2:_o=!0}}o.callback!==null&&o.lane!==0&&(t.flags|=64,g=i.effects,g===null?i.effects=[o]:g.push(o))}else m={eventTime:m,lane:g,tag:o.tag,payload:o.payload,callback:o.callback,next:null},d===null?(c=d=m,l=h):d=d.next=m,a|=g;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;g=o,o=g.next,g.next=null,i.lastBaseUpdate=g,i.shared.pending=null}}while(!0);if(d===null&&(l=h),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=d,e=i.shared.interleaved,e!==null){i=e;do a|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);Vl|=a,t.lanes=a,t.memoizedState=h}}function f_(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(Ne(191,i));i.call(n)}}}var bd={},oa=rl(bd),qf=rl(bd),Qf=rl(bd);function kl(t){if(t===bd)throw Error(Ne(174));return t}function u1(t,e){switch(ur(Qf,e),ur(qf,t),ur(oa,bd),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:ym(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=ym(e,t)}mr(oa),ur(oa,e)}function cu(){mr(oa),mr(qf),mr(Qf)}function FS(t){kl(Qf.current);var e=kl(oa.current),r=ym(e,t.type);e!==r&&(ur(qf,t),ur(oa,r))}function f1(t){qf.current===t&&(mr(oa),mr(qf))}var Tr=rl(0);function Dh(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Eg=[];function d1(){for(var t=0;t<Eg.length;t++)Eg[t]._workInProgressVersionPrimary=null;Eg.length=0}var rh=Ka.ReactCurrentDispatcher,wg=Ka.ReactCurrentBatchConfig,jl=0,Cr=null,hn=null,An=null,Ph=!1,wf=!1,Jf=0,Mb=0;function $n(){throw Error(Ne(321))}function h1(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!js(t[r],e[r]))return!1;return!0}function p1(t,e,r,n,i,s){if(jl=s,Cr=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,rh.current=t===null||t.memoizedState===null?Vb:Ub,t=r(n,i),wf){s=0;do{if(wf=!1,Jf=0,25<=s)throw Error(Ne(301));s+=1,An=hn=null,e.updateQueue=null,rh.current=zb,t=r(n,i)}while(wf)}if(rh.current=Oh,e=hn!==null&&hn.next!==null,jl=0,An=hn=Cr=null,Ph=!1,e)throw Error(Ne(300));return t}function g1(){var t=Jf!==0;return Jf=0,t}function na(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return An===null?Cr.memoizedState=An=t:An=An.next=t,An}function ps(){if(hn===null){var t=Cr.alternate;t=t!==null?t.memoizedState:null}else t=hn.next;var e=An===null?Cr.memoizedState:An.next;if(e!==null)An=e,hn=t;else{if(t===null)throw Error(Ne(310));hn=t,t={memoizedState:hn.memoizedState,baseState:hn.baseState,baseQueue:hn.baseQueue,queue:hn.queue,next:null},An===null?Cr.memoizedState=An=t:An=An.next=t}return An}function Zf(t,e){return typeof e=="function"?e(t):e}function Sg(t){var e=ps(),r=e.queue;if(r===null)throw Error(Ne(311));r.lastRenderedReducer=t;var n=hn,i=n.baseQueue,s=r.pending;if(s!==null){if(i!==null){var a=i.next;i.next=s.next,s.next=a}n.baseQueue=i=s,r.pending=null}if(i!==null){s=i.next,n=n.baseState;var o=a=null,l=null,c=s;do{var d=c.lane;if((jl&d)===d)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:t(n,c.action);else{var h={lane:d,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(o=l=h,a=n):l=l.next=h,Cr.lanes|=d,Vl|=d}c=c.next}while(c!==null&&c!==s);l===null?a=n:l.next=o,js(n,e.memoizedState)||(Ci=!0),e.memoizedState=n,e.baseState=a,e.baseQueue=l,r.lastRenderedState=n}if(t=r.interleaved,t!==null){i=t;do s=i.lane,Cr.lanes|=s,Vl|=s,i=i.next;while(i!==t)}else i===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function Tg(t){var e=ps(),r=e.queue;if(r===null)throw Error(Ne(311));r.lastRenderedReducer=t;var n=r.dispatch,i=r.pending,s=e.memoizedState;if(i!==null){r.pending=null;var a=i=i.next;do s=t(s,a.action),a=a.next;while(a!==i);js(s,e.memoizedState)||(Ci=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),r.lastRenderedState=s}return[s,n]}function IS(){}function bS(t,e){var r=Cr,n=ps(),i=e(),s=!js(n.memoizedState,i);if(s&&(n.memoizedState=i,Ci=!0),n=n.queue,m1(DS.bind(null,r,n,t),[t]),n.getSnapshot!==e||s||An!==null&&An.memoizedState.tag&1){if(r.flags|=2048,ed(9,NS.bind(null,r,n,i,e),void 0,null),Fn===null)throw Error(Ne(349));jl&30||RS(r,e,i)}return i}function RS(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=Cr.updateQueue,e===null?(e={lastEffect:null,stores:null},Cr.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function NS(t,e,r,n){e.value=r,e.getSnapshot=n,PS(e)&&OS(t)}function DS(t,e,r){return r(function(){PS(e)&&OS(t)})}function PS(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!js(t,r)}catch{return!0}}function OS(t){var e=ja(t,1);e!==null&&Ms(e,t,1,-1)}function d_(t){var e=na();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Zf,lastRenderedState:t},e.queue=t,t=t.dispatch=jb.bind(null,Cr,t),[e.memoizedState,t]}function ed(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=Cr.updateQueue,e===null?(e={lastEffect:null,stores:null},Cr.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function MS(){return ps().memoizedState}function nh(t,e,r,n){var i=na();Cr.flags|=t,i.memoizedState=ed(1|e,r,void 0,n===void 0?null:n)}function Tp(t,e,r,n){var i=ps();n=n===void 0?null:n;var s=void 0;if(hn!==null){var a=hn.memoizedState;if(s=a.destroy,n!==null&&h1(n,a.deps)){i.memoizedState=ed(e,r,s,n);return}}Cr.flags|=t,i.memoizedState=ed(1|e,r,s,n)}function h_(t,e){return nh(8390656,8,t,e)}function m1(t,e){return Tp(2048,8,t,e)}function LS(t,e){return Tp(4,2,t,e)}function BS(t,e){return Tp(4,4,t,e)}function jS(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function VS(t,e,r){return r=r!=null?r.concat([t]):null,Tp(4,4,jS.bind(null,e,t),r)}function x1(){}function US(t,e){var r=ps();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&h1(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function zS(t,e){var r=ps();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&h1(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function WS(t,e,r){return jl&21?(js(r,e)||(r=Xw(),Cr.lanes|=r,Vl|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Ci=!0),t.memoizedState=r)}function Lb(t,e){var r=ir;ir=r!==0&&4>r?r:4,t(!0);var n=wg.transition;wg.transition={};try{t(!1),e()}finally{ir=r,wg.transition=n}}function HS(){return ps().memoizedState}function Bb(t,e,r){var n=jo(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},$S(t))GS(e,r);else if(r=kS(t,e,r,n),r!==null){var i=hi();Ms(r,t,n,i),KS(r,e,n)}}function jb(t,e,r){var n=jo(t),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if($S(t))GS(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var a=e.lastRenderedState,o=s(a,r);if(i.hasEagerState=!0,i.eagerState=o,js(o,a)){var l=e.interleaved;l===null?(i.next=i,l1(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}r=kS(t,e,i,n),r!==null&&(i=hi(),Ms(r,t,n,i),KS(r,e,n))}}function $S(t){var e=t.alternate;return t===Cr||e!==null&&e===Cr}function GS(t,e){wf=Ph=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function KS(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,Xx(t,r)}}var Oh={readContext:hs,useCallback:$n,useContext:$n,useEffect:$n,useImperativeHandle:$n,useInsertionEffect:$n,useLayoutEffect:$n,useMemo:$n,useReducer:$n,useRef:$n,useState:$n,useDebugValue:$n,useDeferredValue:$n,useTransition:$n,useMutableSource:$n,useSyncExternalStore:$n,useId:$n,unstable_isNewReconciler:!1},Vb={readContext:hs,useCallback:function(t,e){return na().memoizedState=[t,e===void 0?null:e],t},useContext:hs,useEffect:h_,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,nh(4194308,4,jS.bind(null,e,t),r)},useLayoutEffect:function(t,e){return nh(4194308,4,t,e)},useInsertionEffect:function(t,e){return nh(4,2,t,e)},useMemo:function(t,e){var r=na();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=na();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=Bb.bind(null,Cr,t),[n.memoizedState,t]},useRef:function(t){var e=na();return t={current:t},e.memoizedState=t},useState:d_,useDebugValue:x1,useDeferredValue:function(t){return na().memoizedState=t},useTransition:function(){var t=d_(!1),e=t[0];return t=Lb.bind(null,t[1]),na().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=Cr,i=na();if(wr){if(r===void 0)throw Error(Ne(407));r=r()}else{if(r=e(),Fn===null)throw Error(Ne(349));jl&30||RS(n,e,r)}i.memoizedState=r;var s={value:r,getSnapshot:e};return i.queue=s,h_(DS.bind(null,n,s,t),[t]),n.flags|=2048,ed(9,NS.bind(null,n,s,r,e),void 0,null),r},useId:function(){var t=na(),e=Fn.identifierPrefix;if(wr){var r=Ca,n=ka;r=(n&~(1<<32-Os(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=Jf++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=Mb++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},Ub={readContext:hs,useCallback:US,useContext:hs,useEffect:m1,useImperativeHandle:VS,useInsertionEffect:LS,useLayoutEffect:BS,useMemo:zS,useReducer:Sg,useRef:MS,useState:function(){return Sg(Zf)},useDebugValue:x1,useDeferredValue:function(t){var e=ps();return WS(e,hn.memoizedState,t)},useTransition:function(){var t=Sg(Zf)[0],e=ps().memoizedState;return[t,e]},useMutableSource:IS,useSyncExternalStore:bS,useId:HS,unstable_isNewReconciler:!1},zb={readContext:hs,useCallback:US,useContext:hs,useEffect:m1,useImperativeHandle:VS,useInsertionEffect:LS,useLayoutEffect:BS,useMemo:zS,useReducer:Tg,useRef:MS,useState:function(){return Tg(Zf)},useDebugValue:x1,useDeferredValue:function(t){var e=ps();return hn===null?e.memoizedState=t:WS(e,hn.memoizedState,t)},useTransition:function(){var t=Tg(Zf)[0],e=ps().memoizedState;return[t,e]},useMutableSource:IS,useSyncExternalStore:bS,useId:HS,unstable_isNewReconciler:!1};function Is(t,e){if(t&&t.defaultProps){e=Fr({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function Vm(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:Fr({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var Ap={isMounted:function(t){return(t=t._reactInternals)?ec(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=hi(),i=jo(t),s=Na(n,i);s.payload=e,r!=null&&(s.callback=r),e=Lo(t,s,i),e!==null&&(Ms(e,t,i,n),th(e,t,i))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=hi(),i=jo(t),s=Na(n,i);s.tag=1,s.payload=e,r!=null&&(s.callback=r),e=Lo(t,s,i),e!==null&&(Ms(e,t,i,n),th(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=hi(),n=jo(t),i=Na(r,n);i.tag=2,e!=null&&(i.callback=e),e=Lo(t,i,n),e!==null&&(Ms(e,t,n,r),th(e,t,n))}};function p_(t,e,r,n,i,s,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,s,a):e.prototype&&e.prototype.isPureReactComponent?!Gf(r,n)||!Gf(i,s):!0}function XS(t,e,r){var n=!1,i=Ko,s=e.contextType;return typeof s=="object"&&s!==null?s=hs(s):(i=Ii(e)?Ll:ni.current,n=e.contextTypes,s=(n=n!=null)?au(t,i):Ko),e=new e(r,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Ap,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function g_(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&Ap.enqueueReplaceState(e,e.state,null)}function Um(t,e,r,n){var i=t.stateNode;i.props=r,i.state=t.memoizedState,i.refs={},c1(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=hs(s):(s=Ii(e)?Ll:ni.current,i.context=au(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(Vm(t,e,s,r),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Ap.enqueueReplaceState(i,i.state,null),Nh(t,r,i,n),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function uu(t,e){try{var r="",n=e;do r+=mI(n),n=n.return;while(n);var i=r}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function Ag(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function zm(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var Wb=typeof WeakMap=="function"?WeakMap:Map;function YS(t,e,r){r=Na(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){Lh||(Lh=!0,Jm=n),zm(t,e)},r}function qS(t,e,r){r=Na(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var i=e.value;r.payload=function(){return n(i)},r.callback=function(){zm(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){zm(t,e),typeof n!="function"&&(Bo===null?Bo=new Set([this]):Bo.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),r}function m_(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new Wb;var i=new Set;n.set(e,i)}else i=n.get(e),i===void 0&&(i=new Set,n.set(e,i));i.has(r)||(i.add(r),t=nR.bind(null,t,e,r),e.then(t,t))}function x_(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function v_(t,e,r,n,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=Na(-1,1),e.tag=2,Lo(r,e,1))),r.lanes|=1),t)}var Hb=Ka.ReactCurrentOwner,Ci=!1;function ui(t,e,r,n){e.child=t===null?AS(e,null,r,n):lu(e,t.child,r,n)}function y_(t,e,r,n,i){r=r.render;var s=e.ref;return Yc(e,i),n=p1(t,e,r,n,s,i),r=g1(),t!==null&&!Ci?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Va(t,e,i)):(wr&&r&&r1(e),e.flags|=1,ui(t,e,n,i),e.child)}function __(t,e,r,n,i){if(t===null){var s=r.type;return typeof s=="function"&&!A1(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=s,QS(t,e,s,n,i)):(t=oh(r.type,null,n,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var a=s.memoizedProps;if(r=r.compare,r=r!==null?r:Gf,r(a,n)&&t.ref===e.ref)return Va(t,e,i)}return e.flags|=1,t=Vo(s,n),t.ref=e.ref,t.return=e,e.child=t}function QS(t,e,r,n,i){if(t!==null){var s=t.memoizedProps;if(Gf(s,n)&&t.ref===e.ref)if(Ci=!1,e.pendingProps=n=s,(t.lanes&i)!==0)t.flags&131072&&(Ci=!0);else return e.lanes=t.lanes,Va(t,e,i)}return Wm(t,e,r,n,i)}function JS(t,e,r){var n=e.pendingProps,i=n.children,s=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ur(Uc,Bi),Bi|=r;else{if(!(r&1073741824))return t=s!==null?s.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,ur(Uc,Bi),Bi|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,ur(Uc,Bi),Bi|=n}else s!==null?(n=s.baseLanes|r,e.memoizedState=null):n=r,ur(Uc,Bi),Bi|=n;return ui(t,e,i,r),e.child}function ZS(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function Wm(t,e,r,n,i){var s=Ii(r)?Ll:ni.current;return s=au(e,s),Yc(e,i),r=p1(t,e,r,n,s,i),n=g1(),t!==null&&!Ci?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Va(t,e,i)):(wr&&n&&r1(e),e.flags|=1,ui(t,e,r,i),e.child)}function E_(t,e,r,n,i){if(Ii(r)){var s=!0;Ch(e)}else s=!1;if(Yc(e,i),e.stateNode===null)ih(t,e),XS(e,r,n),Um(e,r,n,i),n=!0;else if(t===null){var a=e.stateNode,o=e.memoizedProps;a.props=o;var l=a.context,c=r.contextType;typeof c=="object"&&c!==null?c=hs(c):(c=Ii(r)?Ll:ni.current,c=au(e,c));var d=r.getDerivedStateFromProps,h=typeof d=="function"||typeof a.getSnapshotBeforeUpdate=="function";h||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==n||l!==c)&&g_(e,a,n,c),_o=!1;var g=e.memoizedState;a.state=g,Nh(e,n,a,i),l=e.memoizedState,o!==n||g!==l||Fi.current||_o?(typeof d=="function"&&(Vm(e,r,d,n),l=e.memoizedState),(o=_o||p_(e,r,o,n,g,l,c))?(h||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=l),a.props=n,a.state=l,a.context=c,n=o):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{a=e.stateNode,CS(t,e),o=e.memoizedProps,c=e.type===e.elementType?o:Is(e.type,o),a.props=c,h=e.pendingProps,g=a.context,l=r.contextType,typeof l=="object"&&l!==null?l=hs(l):(l=Ii(r)?Ll:ni.current,l=au(e,l));var m=r.getDerivedStateFromProps;(d=typeof m=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==h||g!==l)&&g_(e,a,n,l),_o=!1,g=e.memoizedState,a.state=g,Nh(e,n,a,i);var y=e.memoizedState;o!==h||g!==y||Fi.current||_o?(typeof m=="function"&&(Vm(e,r,m,n),y=e.memoizedState),(c=_o||p_(e,r,c,n,g,y,l)||!1)?(d||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(n,y,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(n,y,l)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=y),a.props=n,a.state=y,a.context=l,n=c):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),n=!1)}return Hm(t,e,r,n,s,i)}function Hm(t,e,r,n,i,s){ZS(t,e);var a=(e.flags&128)!==0;if(!n&&!a)return i&&a_(e,r,!1),Va(t,e,s);n=e.stateNode,Hb.current=e;var o=a&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&a?(e.child=lu(e,t.child,null,s),e.child=lu(e,null,o,s)):ui(t,e,o,s),e.memoizedState=n.state,i&&a_(e,r,!0),e.child}function eT(t){var e=t.stateNode;e.pendingContext?s_(t,e.pendingContext,e.pendingContext!==e.context):e.context&&s_(t,e.context,!1),u1(t,e.containerInfo)}function w_(t,e,r,n,i){return ou(),i1(i),e.flags|=256,ui(t,e,r,n),e.child}var $m={dehydrated:null,treeContext:null,retryLane:0};function Gm(t){return{baseLanes:t,cachePool:null,transitions:null}}function tT(t,e,r){var n=e.pendingProps,i=Tr.current,s=!1,a=(e.flags&128)!==0,o;if((o=a)||(o=t!==null&&t.memoizedState===null?!1:(i&2)!==0),o?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),ur(Tr,i&1),t===null)return Bm(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=n.children,t=n.fallback,s?(n=e.mode,s=e.child,a={mode:"hidden",children:a},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=Fp(a,n,0,null),t=bl(t,n,r,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=Gm(r),e.memoizedState=$m,t):v1(e,a));if(i=t.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return $b(t,e,a,n,o,i,r);if(s){s=n.fallback,a=e.mode,i=t.child,o=i.sibling;var l={mode:"hidden",children:n.children};return!(a&1)&&e.child!==i?(n=e.child,n.childLanes=0,n.pendingProps=l,e.deletions=null):(n=Vo(i,l),n.subtreeFlags=i.subtreeFlags&14680064),o!==null?s=Vo(o,s):(s=bl(s,a,r,null),s.flags|=2),s.return=e,n.return=e,n.sibling=s,e.child=n,n=s,s=e.child,a=t.child.memoizedState,a=a===null?Gm(r):{baseLanes:a.baseLanes|r,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=t.childLanes&~r,e.memoizedState=$m,n}return s=t.child,t=s.sibling,n=Vo(s,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function v1(t,e){return e=Fp({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function S0(t,e,r,n){return n!==null&&i1(n),lu(e,t.child,null,r),t=v1(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function $b(t,e,r,n,i,s,a){if(r)return e.flags&256?(e.flags&=-257,n=Ag(Error(Ne(422))),S0(t,e,a,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=n.fallback,i=e.mode,n=Fp({mode:"visible",children:n.children},i,0,null),s=bl(s,i,a,null),s.flags|=2,n.return=e,s.return=e,n.sibling=s,e.child=n,e.mode&1&&lu(e,t.child,null,a),e.child.memoizedState=Gm(a),e.memoizedState=$m,s);if(!(e.mode&1))return S0(t,e,a,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var o=n.dgst;return n=o,s=Error(Ne(419)),n=Ag(s,n,void 0),S0(t,e,a,n)}if(o=(a&t.childLanes)!==0,Ci||o){if(n=Fn,n!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|a)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,ja(t,i),Ms(n,t,i,-1))}return T1(),n=Ag(Error(Ne(421))),S0(t,e,a,n)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=iR.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,Wi=Mo(i.nextSibling),Hi=e,wr=!0,Rs=null,t!==null&&(os[ls++]=ka,os[ls++]=Ca,os[ls++]=Bl,ka=t.id,Ca=t.overflow,Bl=e),e=v1(e,n.children),e.flags|=4096,e)}function S_(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),jm(t.return,e,r)}function kg(t,e,r,n,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function rT(t,e,r){var n=e.pendingProps,i=n.revealOrder,s=n.tail;if(ui(t,e,n.children,r),n=Tr.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&S_(t,r,e);else if(t.tag===19)S_(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(ur(Tr,n),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(r=e.child,i=null;r!==null;)t=r.alternate,t!==null&&Dh(t)===null&&(i=r),r=r.sibling;r=i,r===null?(i=e.child,e.child=null):(i=r.sibling,r.sibling=null),kg(e,!1,i,r,s);break;case"backwards":for(r=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Dh(t)===null){e.child=i;break}t=i.sibling,i.sibling=r,r=i,i=t}kg(e,!0,r,null,s);break;case"together":kg(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function ih(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Va(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),Vl|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Ne(153));if(e.child!==null){for(t=e.child,r=Vo(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=Vo(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function Gb(t,e,r){switch(e.tag){case 3:eT(e),ou();break;case 5:FS(e);break;case 1:Ii(e.type)&&Ch(e);break;case 4:u1(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,i=e.memoizedProps.value;ur(bh,n._currentValue),n._currentValue=i;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(ur(Tr,Tr.current&1),e.flags|=128,null):r&e.child.childLanes?tT(t,e,r):(ur(Tr,Tr.current&1),t=Va(t,e,r),t!==null?t.sibling:null);ur(Tr,Tr.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return rT(t,e,r);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),ur(Tr,Tr.current),n)break;return null;case 22:case 23:return e.lanes=0,JS(t,e,r)}return Va(t,e,r)}var nT,Km,iT,sT;nT=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Km=function(){};iT=function(t,e,r,n){var i=t.memoizedProps;if(i!==n){t=e.stateNode,kl(oa.current);var s=null;switch(r){case"input":i=gm(t,i),n=gm(t,n),s=[];break;case"select":i=Fr({},i,{value:void 0}),n=Fr({},n,{value:void 0}),s=[];break;case"textarea":i=vm(t,i),n=vm(t,n),s=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=Ah)}_m(r,n);var a;r=null;for(c in i)if(!n.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var o=i[c];for(a in o)o.hasOwnProperty(a)&&(r||(r={}),r[a]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(jf.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in n){var l=n[c];if(o=i!=null?i[c]:void 0,n.hasOwnProperty(c)&&l!==o&&(l!=null||o!=null))if(c==="style")if(o){for(a in o)!o.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(r||(r={}),r[a]="");for(a in l)l.hasOwnProperty(a)&&o[a]!==l[a]&&(r||(r={}),r[a]=l[a])}else r||(s||(s=[]),s.push(c,r)),r=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(jf.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&pr("scroll",t),s||o===l||(s=[])):(s=s||[]).push(c,l))}r&&(s=s||[]).push("style",r);var c=s;(e.updateQueue=c)&&(e.flags|=4)}};sT=function(t,e,r,n){r!==n&&(e.flags|=4)};function Zu(t,e){if(!wr)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function Gn(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function Kb(t,e,r){var n=e.pendingProps;switch(n1(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Gn(e),null;case 1:return Ii(e.type)&&kh(),Gn(e),null;case 3:return n=e.stateNode,cu(),mr(Fi),mr(ni),d1(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(E0(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Rs!==null&&(tx(Rs),Rs=null))),Km(t,e),Gn(e),null;case 5:f1(e);var i=kl(Qf.current);if(r=e.type,t!==null&&e.stateNode!=null)iT(t,e,r,n,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(Ne(166));return Gn(e),null}if(t=kl(oa.current),E0(e)){n=e.stateNode,r=e.type;var s=e.memoizedProps;switch(n[ia]=e,n[Yf]=s,t=(e.mode&1)!==0,r){case"dialog":pr("cancel",n),pr("close",n);break;case"iframe":case"object":case"embed":pr("load",n);break;case"video":case"audio":for(i=0;i<cf.length;i++)pr(cf[i],n);break;case"source":pr("error",n);break;case"img":case"image":case"link":pr("error",n),pr("load",n);break;case"details":pr("toggle",n);break;case"input":Ny(n,s),pr("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},pr("invalid",n);break;case"textarea":Py(n,s),pr("invalid",n)}_m(r,s),i=null;for(var a in s)if(s.hasOwnProperty(a)){var o=s[a];a==="children"?typeof o=="string"?n.textContent!==o&&(s.suppressHydrationWarning!==!0&&_0(n.textContent,o,t),i=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&_0(n.textContent,o,t),i=["children",""+o]):jf.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&pr("scroll",n)}switch(r){case"input":d0(n),Dy(n,s,!0);break;case"textarea":d0(n),Oy(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=Ah)}n=i,e.updateQueue=n,n!==null&&(e.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Dw(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=a.createElement(r,{is:n.is}):(t=a.createElement(r),r==="select"&&(a=t,n.multiple?a.multiple=!0:n.size&&(a.size=n.size))):t=a.createElementNS(t,r),t[ia]=e,t[Yf]=n,nT(t,e,!1,!1),e.stateNode=t;e:{switch(a=Em(r,n),r){case"dialog":pr("cancel",t),pr("close",t),i=n;break;case"iframe":case"object":case"embed":pr("load",t),i=n;break;case"video":case"audio":for(i=0;i<cf.length;i++)pr(cf[i],t);i=n;break;case"source":pr("error",t),i=n;break;case"img":case"image":case"link":pr("error",t),pr("load",t),i=n;break;case"details":pr("toggle",t),i=n;break;case"input":Ny(t,n),i=gm(t,n),pr("invalid",t);break;case"option":i=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},i=Fr({},n,{value:void 0}),pr("invalid",t);break;case"textarea":Py(t,n),i=vm(t,n),pr("invalid",t);break;default:i=n}_m(r,i),o=i;for(s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="style"?Mw(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&Pw(t,l)):s==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&Vf(t,l):typeof l=="number"&&Vf(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(jf.hasOwnProperty(s)?l!=null&&s==="onScroll"&&pr("scroll",t):l!=null&&zx(t,s,l,a))}switch(r){case"input":d0(t),Dy(t,n,!1);break;case"textarea":d0(t),Oy(t);break;case"option":n.value!=null&&t.setAttribute("value",""+Go(n.value));break;case"select":t.multiple=!!n.multiple,s=n.value,s!=null?$c(t,!!n.multiple,s,!1):n.defaultValue!=null&&$c(t,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=Ah)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Gn(e),null;case 6:if(t&&e.stateNode!=null)sT(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(Ne(166));if(r=kl(Qf.current),kl(oa.current),E0(e)){if(n=e.stateNode,r=e.memoizedProps,n[ia]=e,(s=n.nodeValue!==r)&&(t=Hi,t!==null))switch(t.tag){case 3:_0(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&_0(n.nodeValue,r,(t.mode&1)!==0)}s&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[ia]=e,e.stateNode=n}return Gn(e),null;case 13:if(mr(Tr),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(wr&&Wi!==null&&e.mode&1&&!(e.flags&128))SS(),ou(),e.flags|=98560,s=!1;else if(s=E0(e),n!==null&&n.dehydrated!==null){if(t===null){if(!s)throw Error(Ne(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Ne(317));s[ia]=e}else ou(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Gn(e),s=!1}else Rs!==null&&(tx(Rs),Rs=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||Tr.current&1?mn===0&&(mn=3):T1())),e.updateQueue!==null&&(e.flags|=4),Gn(e),null);case 4:return cu(),Km(t,e),t===null&&Kf(e.stateNode.containerInfo),Gn(e),null;case 10:return o1(e.type._context),Gn(e),null;case 17:return Ii(e.type)&&kh(),Gn(e),null;case 19:if(mr(Tr),s=e.memoizedState,s===null)return Gn(e),null;if(n=(e.flags&128)!==0,a=s.rendering,a===null)if(n)Zu(s,!1);else{if(mn!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=Dh(t),a!==null){for(e.flags|=128,Zu(s,!1),n=a.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)s=r,t=n,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,t=a.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return ur(Tr,Tr.current&1|2),e.child}t=t.sibling}s.tail!==null&&Gr()>fu&&(e.flags|=128,n=!0,Zu(s,!1),e.lanes=4194304)}else{if(!n)if(t=Dh(a),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),Zu(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!wr)return Gn(e),null}else 2*Gr()-s.renderingStartTime>fu&&r!==1073741824&&(e.flags|=128,n=!0,Zu(s,!1),e.lanes=4194304);s.isBackwards?(a.sibling=e.child,e.child=a):(r=s.last,r!==null?r.sibling=a:e.child=a,s.last=a)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Gr(),e.sibling=null,r=Tr.current,ur(Tr,n?r&1|2:r&1),e):(Gn(e),null);case 22:case 23:return S1(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?Bi&1073741824&&(Gn(e),e.subtreeFlags&6&&(e.flags|=8192)):Gn(e),null;case 24:return null;case 25:return null}throw Error(Ne(156,e.tag))}function Xb(t,e){switch(n1(e),e.tag){case 1:return Ii(e.type)&&kh(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return cu(),mr(Fi),mr(ni),d1(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return f1(e),null;case 13:if(mr(Tr),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Ne(340));ou()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return mr(Tr),null;case 4:return cu(),null;case 10:return o1(e.type._context),null;case 22:case 23:return S1(),null;case 24:return null;default:return null}}var T0=!1,Jn=!1,Yb=typeof WeakSet=="function"?WeakSet:Set,qe=null;function Vc(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Nr(t,e,n)}else r.current=null}function Xm(t,e,r){try{r()}catch(n){Nr(t,e,n)}}var T_=!1;function qb(t,e){if(Rm=wh,t=uS(),t1(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var a=0,o=-1,l=-1,c=0,d=0,h=t,g=null;t:for(;;){for(var m;h!==r||i!==0&&h.nodeType!==3||(o=a+i),h!==s||n!==0&&h.nodeType!==3||(l=a+n),h.nodeType===3&&(a+=h.nodeValue.length),(m=h.firstChild)!==null;)g=h,h=m;for(;;){if(h===t)break t;if(g===r&&++c===i&&(o=a),g===s&&++d===n&&(l=a),(m=h.nextSibling)!==null)break;h=g,g=h.parentNode}h=m}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(Nm={focusedElem:t,selectionRange:r},wh=!1,qe=e;qe!==null;)if(e=qe,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,qe=t;else for(;qe!==null;){e=qe;try{var y=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var x=y.memoizedProps,E=y.memoizedState,A=e.stateNode,k=A.getSnapshotBeforeUpdate(e.elementType===e.type?x:Is(e.type,x),E);A.__reactInternalSnapshotBeforeUpdate=k}break;case 3:var _=e.stateNode.containerInfo;_.nodeType===1?_.textContent="":_.nodeType===9&&_.documentElement&&_.removeChild(_.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Ne(163))}}catch(P){Nr(e,e.return,P)}if(t=e.sibling,t!==null){t.return=e.return,qe=t;break}qe=e.return}return y=T_,T_=!1,y}function Sf(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&Xm(e,r,s)}i=i.next}while(i!==n)}}function kp(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function Ym(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function aT(t){var e=t.alternate;e!==null&&(t.alternate=null,aT(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[ia],delete e[Yf],delete e[Om],delete e[Nb],delete e[Db])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function oT(t){return t.tag===5||t.tag===3||t.tag===4}function A_(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||oT(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function qm(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=Ah));else if(n!==4&&(t=t.child,t!==null))for(qm(t,e,r),t=t.sibling;t!==null;)qm(t,e,r),t=t.sibling}function Qm(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(Qm(t,e,r),t=t.sibling;t!==null;)Qm(t,e,r),t=t.sibling}var Rn=null,bs=!1;function go(t,e,r){for(r=r.child;r!==null;)lT(t,e,r),r=r.sibling}function lT(t,e,r){if(aa&&typeof aa.onCommitFiberUnmount=="function")try{aa.onCommitFiberUnmount(vp,r)}catch{}switch(r.tag){case 5:Jn||Vc(r,e);case 6:var n=Rn,i=bs;Rn=null,go(t,e,r),Rn=n,bs=i,Rn!==null&&(bs?(t=Rn,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):Rn.removeChild(r.stateNode));break;case 18:Rn!==null&&(bs?(t=Rn,r=r.stateNode,t.nodeType===8?yg(t.parentNode,r):t.nodeType===1&&yg(t,r),Hf(t)):yg(Rn,r.stateNode));break;case 4:n=Rn,i=bs,Rn=r.stateNode.containerInfo,bs=!0,go(t,e,r),Rn=n,bs=i;break;case 0:case 11:case 14:case 15:if(!Jn&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var s=i,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&Xm(r,e,a),i=i.next}while(i!==n)}go(t,e,r);break;case 1:if(!Jn&&(Vc(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){Nr(r,e,o)}go(t,e,r);break;case 21:go(t,e,r);break;case 22:r.mode&1?(Jn=(n=Jn)||r.memoizedState!==null,go(t,e,r),Jn=n):go(t,e,r);break;default:go(t,e,r)}}function k_(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new Yb),e.forEach(function(n){var i=sR.bind(null,t,n);r.has(n)||(r.add(n),n.then(i,i))})}}function ks(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var s=t,a=e,o=a;e:for(;o!==null;){switch(o.tag){case 5:Rn=o.stateNode,bs=!1;break e;case 3:Rn=o.stateNode.containerInfo,bs=!0;break e;case 4:Rn=o.stateNode.containerInfo,bs=!0;break e}o=o.return}if(Rn===null)throw Error(Ne(160));lT(s,a,i),Rn=null,bs=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(c){Nr(i,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)cT(e,t),e=e.sibling}function cT(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(ks(e,t),Js(t),n&4){try{Sf(3,t,t.return),kp(3,t)}catch(x){Nr(t,t.return,x)}try{Sf(5,t,t.return)}catch(x){Nr(t,t.return,x)}}break;case 1:ks(e,t),Js(t),n&512&&r!==null&&Vc(r,r.return);break;case 5:if(ks(e,t),Js(t),n&512&&r!==null&&Vc(r,r.return),t.flags&32){var i=t.stateNode;try{Vf(i,"")}catch(x){Nr(t,t.return,x)}}if(n&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,a=r!==null?r.memoizedProps:s,o=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&Rw(i,s),Em(o,a);var c=Em(o,s);for(a=0;a<l.length;a+=2){var d=l[a],h=l[a+1];d==="style"?Mw(i,h):d==="dangerouslySetInnerHTML"?Pw(i,h):d==="children"?Vf(i,h):zx(i,d,h,c)}switch(o){case"input":mm(i,s);break;case"textarea":Nw(i,s);break;case"select":var g=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var m=s.value;m!=null?$c(i,!!s.multiple,m,!1):g!==!!s.multiple&&(s.defaultValue!=null?$c(i,!!s.multiple,s.defaultValue,!0):$c(i,!!s.multiple,s.multiple?[]:"",!1))}i[Yf]=s}catch(x){Nr(t,t.return,x)}}break;case 6:if(ks(e,t),Js(t),n&4){if(t.stateNode===null)throw Error(Ne(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(x){Nr(t,t.return,x)}}break;case 3:if(ks(e,t),Js(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Hf(e.containerInfo)}catch(x){Nr(t,t.return,x)}break;case 4:ks(e,t),Js(t);break;case 13:ks(e,t),Js(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(E1=Gr())),n&4&&k_(t);break;case 22:if(d=r!==null&&r.memoizedState!==null,t.mode&1?(Jn=(c=Jn)||d,ks(e,t),Jn=c):ks(e,t),Js(t),n&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!d&&t.mode&1)for(qe=t,d=t.child;d!==null;){for(h=qe=d;qe!==null;){switch(g=qe,m=g.child,g.tag){case 0:case 11:case 14:case 15:Sf(4,g,g.return);break;case 1:Vc(g,g.return);var y=g.stateNode;if(typeof y.componentWillUnmount=="function"){n=g,r=g.return;try{e=n,y.props=e.memoizedProps,y.state=e.memoizedState,y.componentWillUnmount()}catch(x){Nr(n,r,x)}}break;case 5:Vc(g,g.return);break;case 22:if(g.memoizedState!==null){F_(h);continue}}m!==null?(m.return=g,qe=m):F_(h)}d=d.sibling}e:for(d=null,h=t;;){if(h.tag===5){if(d===null){d=h;try{i=h.stateNode,c?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=h.stateNode,l=h.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=Ow("display",a))}catch(x){Nr(t,t.return,x)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(x){Nr(t,t.return,x)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:ks(e,t),Js(t),n&4&&k_(t);break;case 21:break;default:ks(e,t),Js(t)}}function Js(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(oT(r)){var n=r;break e}r=r.return}throw Error(Ne(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(Vf(i,""),n.flags&=-33);var s=A_(t);Qm(t,s,i);break;case 3:case 4:var a=n.stateNode.containerInfo,o=A_(t);qm(t,o,a);break;default:throw Error(Ne(161))}}catch(l){Nr(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function Qb(t,e,r){qe=t,uT(t)}function uT(t,e,r){for(var n=(t.mode&1)!==0;qe!==null;){var i=qe,s=i.child;if(i.tag===22&&n){var a=i.memoizedState!==null||T0;if(!a){var o=i.alternate,l=o!==null&&o.memoizedState!==null||Jn;o=T0;var c=Jn;if(T0=a,(Jn=l)&&!c)for(qe=i;qe!==null;)a=qe,l=a.child,a.tag===22&&a.memoizedState!==null?I_(i):l!==null?(l.return=a,qe=l):I_(i);for(;s!==null;)qe=s,uT(s),s=s.sibling;qe=i,T0=o,Jn=c}C_(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,qe=s):C_(t)}}function C_(t){for(;qe!==null;){var e=qe;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Jn||kp(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!Jn)if(r===null)n.componentDidMount();else{var i=e.elementType===e.type?r.memoizedProps:Is(e.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&f_(e,s,n);break;case 3:var a=e.updateQueue;if(a!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}f_(e,a,r)}break;case 5:var o=e.stateNode;if(r===null&&e.flags&4){r=o;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var d=c.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&Hf(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Ne(163))}Jn||e.flags&512&&Ym(e)}catch(g){Nr(e,e.return,g)}}if(e===t){qe=null;break}if(r=e.sibling,r!==null){r.return=e.return,qe=r;break}qe=e.return}}function F_(t){for(;qe!==null;){var e=qe;if(e===t){qe=null;break}var r=e.sibling;if(r!==null){r.return=e.return,qe=r;break}qe=e.return}}function I_(t){for(;qe!==null;){var e=qe;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{kp(4,e)}catch(l){Nr(e,r,l)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var i=e.return;try{n.componentDidMount()}catch(l){Nr(e,i,l)}}var s=e.return;try{Ym(e)}catch(l){Nr(e,s,l)}break;case 5:var a=e.return;try{Ym(e)}catch(l){Nr(e,a,l)}}}catch(l){Nr(e,e.return,l)}if(e===t){qe=null;break}var o=e.sibling;if(o!==null){o.return=e.return,qe=o;break}qe=e.return}}var Jb=Math.ceil,Mh=Ka.ReactCurrentDispatcher,y1=Ka.ReactCurrentOwner,fs=Ka.ReactCurrentBatchConfig,Ut=0,Fn=null,nn=null,Mn=0,Bi=0,Uc=rl(0),mn=0,td=null,Vl=0,Cp=0,_1=0,Tf=null,ki=null,E1=0,fu=1/0,Ta=null,Lh=!1,Jm=null,Bo=null,A0=!1,Fo=null,Bh=0,Af=0,Zm=null,sh=-1,ah=0;function hi(){return Ut&6?Gr():sh!==-1?sh:sh=Gr()}function jo(t){return t.mode&1?Ut&2&&Mn!==0?Mn&-Mn:Ob.transition!==null?(ah===0&&(ah=Xw()),ah):(t=ir,t!==0||(t=window.event,t=t===void 0?16:tS(t.type)),t):1}function Ms(t,e,r,n){if(50<Af)throw Af=0,Zm=null,Error(Ne(185));Cd(t,r,n),(!(Ut&2)||t!==Fn)&&(t===Fn&&(!(Ut&2)&&(Cp|=r),mn===4&&wo(t,Mn)),bi(t,n),r===1&&Ut===0&&!(e.mode&1)&&(fu=Gr()+500,Sp&&nl()))}function bi(t,e){var r=t.callbackNode;OI(t,e);var n=Eh(t,t===Fn?Mn:0);if(n===0)r!==null&&By(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&By(r),e===1)t.tag===0?Pb(b_.bind(null,t)):_S(b_.bind(null,t)),bb(function(){!(Ut&6)&&nl()}),r=null;else{switch(Yw(n)){case 1:r=Kx;break;case 4:r=Gw;break;case 16:r=_h;break;case 536870912:r=Kw;break;default:r=_h}r=vT(r,fT.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function fT(t,e){if(sh=-1,ah=0,Ut&6)throw Error(Ne(327));var r=t.callbackNode;if(qc()&&t.callbackNode!==r)return null;var n=Eh(t,t===Fn?Mn:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=jh(t,n);else{e=n;var i=Ut;Ut|=2;var s=hT();(Fn!==t||Mn!==e)&&(Ta=null,fu=Gr()+500,Il(t,e));do try{tR();break}catch(o){dT(t,o)}while(!0);a1(),Mh.current=s,Ut=i,nn!==null?e=0:(Fn=null,Mn=0,e=mn)}if(e!==0){if(e===2&&(i=km(t),i!==0&&(n=i,e=ex(t,i))),e===1)throw r=td,Il(t,0),wo(t,n),bi(t,Gr()),r;if(e===6)wo(t,n);else{if(i=t.current.alternate,!(n&30)&&!Zb(i)&&(e=jh(t,n),e===2&&(s=km(t),s!==0&&(n=s,e=ex(t,s))),e===1))throw r=td,Il(t,0),wo(t,n),bi(t,Gr()),r;switch(t.finishedWork=i,t.finishedLanes=n,e){case 0:case 1:throw Error(Ne(345));case 2:_l(t,ki,Ta);break;case 3:if(wo(t,n),(n&130023424)===n&&(e=E1+500-Gr(),10<e)){if(Eh(t,0)!==0)break;if(i=t.suspendedLanes,(i&n)!==n){hi(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Pm(_l.bind(null,t,ki,Ta),e);break}_l(t,ki,Ta);break;case 4:if(wo(t,n),(n&4194240)===n)break;for(e=t.eventTimes,i=-1;0<n;){var a=31-Os(n);s=1<<a,a=e[a],a>i&&(i=a),n&=~s}if(n=i,n=Gr()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Jb(n/1960))-n,10<n){t.timeoutHandle=Pm(_l.bind(null,t,ki,Ta),n);break}_l(t,ki,Ta);break;case 5:_l(t,ki,Ta);break;default:throw Error(Ne(329))}}}return bi(t,Gr()),t.callbackNode===r?fT.bind(null,t):null}function ex(t,e){var r=Tf;return t.current.memoizedState.isDehydrated&&(Il(t,e).flags|=256),t=jh(t,e),t!==2&&(e=ki,ki=r,e!==null&&tx(e)),t}function tx(t){ki===null?ki=t:ki.push.apply(ki,t)}function Zb(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!js(s(),i))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function wo(t,e){for(e&=~_1,e&=~Cp,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-Os(e),n=1<<r;t[r]=-1,e&=~n}}function b_(t){if(Ut&6)throw Error(Ne(327));qc();var e=Eh(t,0);if(!(e&1))return bi(t,Gr()),null;var r=jh(t,e);if(t.tag!==0&&r===2){var n=km(t);n!==0&&(e=n,r=ex(t,n))}if(r===1)throw r=td,Il(t,0),wo(t,e),bi(t,Gr()),r;if(r===6)throw Error(Ne(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,_l(t,ki,Ta),bi(t,Gr()),null}function w1(t,e){var r=Ut;Ut|=1;try{return t(e)}finally{Ut=r,Ut===0&&(fu=Gr()+500,Sp&&nl())}}function Ul(t){Fo!==null&&Fo.tag===0&&!(Ut&6)&&qc();var e=Ut;Ut|=1;var r=fs.transition,n=ir;try{if(fs.transition=null,ir=1,t)return t()}finally{ir=n,fs.transition=r,Ut=e,!(Ut&6)&&nl()}}function S1(){Bi=Uc.current,mr(Uc)}function Il(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,Ib(r)),nn!==null)for(r=nn.return;r!==null;){var n=r;switch(n1(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&kh();break;case 3:cu(),mr(Fi),mr(ni),d1();break;case 5:f1(n);break;case 4:cu();break;case 13:mr(Tr);break;case 19:mr(Tr);break;case 10:o1(n.type._context);break;case 22:case 23:S1()}r=r.return}if(Fn=t,nn=t=Vo(t.current,null),Mn=Bi=e,mn=0,td=null,_1=Cp=Vl=0,ki=Tf=null,Al!==null){for(e=0;e<Al.length;e++)if(r=Al[e],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,s=r.pending;if(s!==null){var a=s.next;s.next=i,n.next=a}r.pending=n}Al=null}return t}function dT(t,e){do{var r=nn;try{if(a1(),rh.current=Oh,Ph){for(var n=Cr.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}Ph=!1}if(jl=0,An=hn=Cr=null,wf=!1,Jf=0,y1.current=null,r===null||r.return===null){mn=1,td=e,nn=null;break}e:{var s=t,a=r.return,o=r,l=e;if(e=Mn,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,d=o,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var g=d.alternate;g?(d.updateQueue=g.updateQueue,d.memoizedState=g.memoizedState,d.lanes=g.lanes):(d.updateQueue=null,d.memoizedState=null)}var m=x_(a);if(m!==null){m.flags&=-257,v_(m,a,o,s,e),m.mode&1&&m_(s,c,e),e=m,l=c;var y=e.updateQueue;if(y===null){var x=new Set;x.add(l),e.updateQueue=x}else y.add(l);break e}else{if(!(e&1)){m_(s,c,e),T1();break e}l=Error(Ne(426))}}else if(wr&&o.mode&1){var E=x_(a);if(E!==null){!(E.flags&65536)&&(E.flags|=256),v_(E,a,o,s,e),i1(uu(l,o));break e}}s=l=uu(l,o),mn!==4&&(mn=2),Tf===null?Tf=[s]:Tf.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var A=YS(s,l,e);u_(s,A);break e;case 1:o=l;var k=s.type,_=s.stateNode;if(!(s.flags&128)&&(typeof k.getDerivedStateFromError=="function"||_!==null&&typeof _.componentDidCatch=="function"&&(Bo===null||!Bo.has(_)))){s.flags|=65536,e&=-e,s.lanes|=e;var P=qS(s,o,e);u_(s,P);break e}}s=s.return}while(s!==null)}gT(r)}catch(K){e=K,nn===r&&r!==null&&(nn=r=r.return);continue}break}while(!0)}function hT(){var t=Mh.current;return Mh.current=Oh,t===null?Oh:t}function T1(){(mn===0||mn===3||mn===2)&&(mn=4),Fn===null||!(Vl&268435455)&&!(Cp&268435455)||wo(Fn,Mn)}function jh(t,e){var r=Ut;Ut|=2;var n=hT();(Fn!==t||Mn!==e)&&(Ta=null,Il(t,e));do try{eR();break}catch(i){dT(t,i)}while(!0);if(a1(),Ut=r,Mh.current=n,nn!==null)throw Error(Ne(261));return Fn=null,Mn=0,mn}function eR(){for(;nn!==null;)pT(nn)}function tR(){for(;nn!==null&&!kI();)pT(nn)}function pT(t){var e=xT(t.alternate,t,Bi);t.memoizedProps=t.pendingProps,e===null?gT(t):nn=e,y1.current=null}function gT(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=Xb(r,e),r!==null){r.flags&=32767,nn=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{mn=6,nn=null;return}}else if(r=Kb(r,e,Bi),r!==null){nn=r;return}if(e=e.sibling,e!==null){nn=e;return}nn=e=t}while(e!==null);mn===0&&(mn=5)}function _l(t,e,r){var n=ir,i=fs.transition;try{fs.transition=null,ir=1,rR(t,e,r,n)}finally{fs.transition=i,ir=n}return null}function rR(t,e,r,n){do qc();while(Fo!==null);if(Ut&6)throw Error(Ne(327));r=t.finishedWork;var i=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(Ne(177));t.callbackNode=null,t.callbackPriority=0;var s=r.lanes|r.childLanes;if(MI(t,s),t===Fn&&(nn=Fn=null,Mn=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||A0||(A0=!0,vT(_h,function(){return qc(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=fs.transition,fs.transition=null;var a=ir;ir=1;var o=Ut;Ut|=4,y1.current=null,qb(t,r),cT(r,t),wb(Nm),wh=!!Rm,Nm=Rm=null,t.current=r,Qb(r),CI(),Ut=o,ir=a,fs.transition=s}else t.current=r;if(A0&&(A0=!1,Fo=t,Bh=i),s=t.pendingLanes,s===0&&(Bo=null),bI(r.stateNode),bi(t,Gr()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)i=e[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(Lh)throw Lh=!1,t=Jm,Jm=null,t;return Bh&1&&t.tag!==0&&qc(),s=t.pendingLanes,s&1?t===Zm?Af++:(Af=0,Zm=t):Af=0,nl(),null}function qc(){if(Fo!==null){var t=Yw(Bh),e=fs.transition,r=ir;try{if(fs.transition=null,ir=16>t?16:t,Fo===null)var n=!1;else{if(t=Fo,Fo=null,Bh=0,Ut&6)throw Error(Ne(331));var i=Ut;for(Ut|=4,qe=t.current;qe!==null;){var s=qe,a=s.child;if(qe.flags&16){var o=s.deletions;if(o!==null){for(var l=0;l<o.length;l++){var c=o[l];for(qe=c;qe!==null;){var d=qe;switch(d.tag){case 0:case 11:case 15:Sf(8,d,s)}var h=d.child;if(h!==null)h.return=d,qe=h;else for(;qe!==null;){d=qe;var g=d.sibling,m=d.return;if(aT(d),d===c){qe=null;break}if(g!==null){g.return=m,qe=g;break}qe=m}}}var y=s.alternate;if(y!==null){var x=y.child;if(x!==null){y.child=null;do{var E=x.sibling;x.sibling=null,x=E}while(x!==null)}}qe=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,qe=a;else e:for(;qe!==null;){if(s=qe,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Sf(9,s,s.return)}var A=s.sibling;if(A!==null){A.return=s.return,qe=A;break e}qe=s.return}}var k=t.current;for(qe=k;qe!==null;){a=qe;var _=a.child;if(a.subtreeFlags&2064&&_!==null)_.return=a,qe=_;else e:for(a=k;qe!==null;){if(o=qe,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:kp(9,o)}}catch(K){Nr(o,o.return,K)}if(o===a){qe=null;break e}var P=o.sibling;if(P!==null){P.return=o.return,qe=P;break e}qe=o.return}}if(Ut=i,nl(),aa&&typeof aa.onPostCommitFiberRoot=="function")try{aa.onPostCommitFiberRoot(vp,t)}catch{}n=!0}return n}finally{ir=r,fs.transition=e}}return!1}function R_(t,e,r){e=uu(r,e),e=YS(t,e,1),t=Lo(t,e,1),e=hi(),t!==null&&(Cd(t,1,e),bi(t,e))}function Nr(t,e,r){if(t.tag===3)R_(t,t,r);else for(;e!==null;){if(e.tag===3){R_(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Bo===null||!Bo.has(n))){t=uu(r,t),t=qS(e,t,1),e=Lo(e,t,1),t=hi(),e!==null&&(Cd(e,1,t),bi(e,t));break}}e=e.return}}function nR(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=hi(),t.pingedLanes|=t.suspendedLanes&r,Fn===t&&(Mn&r)===r&&(mn===4||mn===3&&(Mn&130023424)===Mn&&500>Gr()-E1?Il(t,0):_1|=r),bi(t,e)}function mT(t,e){e===0&&(t.mode&1?(e=g0,g0<<=1,!(g0&130023424)&&(g0=4194304)):e=1);var r=hi();t=ja(t,e),t!==null&&(Cd(t,e,r),bi(t,r))}function iR(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),mT(t,r)}function sR(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,i=t.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(Ne(314))}n!==null&&n.delete(e),mT(t,r)}var xT;xT=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||Fi.current)Ci=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return Ci=!1,Gb(t,e,r);Ci=!!(t.flags&131072)}else Ci=!1,wr&&e.flags&1048576&&ES(e,Ih,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;ih(t,e),t=e.pendingProps;var i=au(e,ni.current);Yc(e,r),i=p1(null,e,n,t,i,r);var s=g1();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Ii(n)?(s=!0,Ch(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,c1(e),i.updater=Ap,e.stateNode=i,i._reactInternals=e,Um(e,n,t,r),e=Hm(null,e,n,!0,s,r)):(e.tag=0,wr&&s&&r1(e),ui(null,e,i,r),e=e.child),e;case 16:n=e.elementType;e:{switch(ih(t,e),t=e.pendingProps,i=n._init,n=i(n._payload),e.type=n,i=e.tag=oR(n),t=Is(n,t),i){case 0:e=Wm(null,e,n,t,r);break e;case 1:e=E_(null,e,n,t,r);break e;case 11:e=y_(null,e,n,t,r);break e;case 14:e=__(null,e,n,Is(n.type,t),r);break e}throw Error(Ne(306,n,""))}return e;case 0:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Is(n,i),Wm(t,e,n,i,r);case 1:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Is(n,i),E_(t,e,n,i,r);case 3:e:{if(eT(e),t===null)throw Error(Ne(387));n=e.pendingProps,s=e.memoizedState,i=s.element,CS(t,e),Nh(e,n,null,r);var a=e.memoizedState;if(n=a.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=uu(Error(Ne(423)),e),e=w_(t,e,n,r,i);break e}else if(n!==i){i=uu(Error(Ne(424)),e),e=w_(t,e,n,r,i);break e}else for(Wi=Mo(e.stateNode.containerInfo.firstChild),Hi=e,wr=!0,Rs=null,r=AS(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(ou(),n===i){e=Va(t,e,r);break e}ui(t,e,n,r)}e=e.child}return e;case 5:return FS(e),t===null&&Bm(e),n=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,a=i.children,Dm(n,i)?a=null:s!==null&&Dm(n,s)&&(e.flags|=32),ZS(t,e),ui(t,e,a,r),e.child;case 6:return t===null&&Bm(e),null;case 13:return tT(t,e,r);case 4:return u1(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=lu(e,null,n,r):ui(t,e,n,r),e.child;case 11:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Is(n,i),y_(t,e,n,i,r);case 7:return ui(t,e,e.pendingProps,r),e.child;case 8:return ui(t,e,e.pendingProps.children,r),e.child;case 12:return ui(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,i=e.pendingProps,s=e.memoizedProps,a=i.value,ur(bh,n._currentValue),n._currentValue=a,s!==null)if(js(s.value,a)){if(s.children===i.children&&!Fi.current){e=Va(t,e,r);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var o=s.dependencies;if(o!==null){a=s.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(s.tag===1){l=Na(-1,r&-r),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var d=c.pending;d===null?l.next=l:(l.next=d.next,d.next=l),c.pending=l}}s.lanes|=r,l=s.alternate,l!==null&&(l.lanes|=r),jm(s.return,r,e),o.lanes|=r;break}l=l.next}}else if(s.tag===10)a=s.type===e.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(Ne(341));a.lanes|=r,o=a.alternate,o!==null&&(o.lanes|=r),jm(a,r,e),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===e){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}ui(t,e,i.children,r),e=e.child}return e;case 9:return i=e.type,n=e.pendingProps.children,Yc(e,r),i=hs(i),n=n(i),e.flags|=1,ui(t,e,n,r),e.child;case 14:return n=e.type,i=Is(n,e.pendingProps),i=Is(n.type,i),__(t,e,n,i,r);case 15:return QS(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Is(n,i),ih(t,e),e.tag=1,Ii(n)?(t=!0,Ch(e)):t=!1,Yc(e,r),XS(e,n,i),Um(e,n,i,r),Hm(null,e,n,!0,t,r);case 19:return rT(t,e,r);case 22:return JS(t,e,r)}throw Error(Ne(156,e.tag))};function vT(t,e){return $w(t,e)}function aR(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function us(t,e,r,n){return new aR(t,e,r,n)}function A1(t){return t=t.prototype,!(!t||!t.isReactComponent)}function oR(t){if(typeof t=="function")return A1(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Hx)return 11;if(t===$x)return 14}return 2}function Vo(t,e){var r=t.alternate;return r===null?(r=us(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function oh(t,e,r,n,i,s){var a=2;if(n=t,typeof t=="function")A1(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case Rc:return bl(r.children,i,s,e);case Wx:a=8,i|=8;break;case fm:return t=us(12,r,e,i|2),t.elementType=fm,t.lanes=s,t;case dm:return t=us(13,r,e,i),t.elementType=dm,t.lanes=s,t;case hm:return t=us(19,r,e,i),t.elementType=hm,t.lanes=s,t;case Fw:return Fp(r,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case kw:a=10;break e;case Cw:a=9;break e;case Hx:a=11;break e;case $x:a=14;break e;case yo:a=16,n=null;break e}throw Error(Ne(130,t==null?t:typeof t,""))}return e=us(a,r,e,i),e.elementType=t,e.type=n,e.lanes=s,e}function bl(t,e,r,n){return t=us(7,t,n,e),t.lanes=r,t}function Fp(t,e,r,n){return t=us(22,t,n,e),t.elementType=Fw,t.lanes=r,t.stateNode={isHidden:!1},t}function Cg(t,e,r){return t=us(6,t,null,e),t.lanes=r,t}function Fg(t,e,r){return e=us(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function lR(t,e,r,n,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=lg(0),this.expirationTimes=lg(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=lg(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function k1(t,e,r,n,i,s,a,o,l){return t=new lR(t,e,r,o,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=us(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},c1(s),t}function cR(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:bc,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function yT(t){if(!t)return Ko;t=t._reactInternals;e:{if(ec(t)!==t||t.tag!==1)throw Error(Ne(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Ii(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Ne(171))}if(t.tag===1){var r=t.type;if(Ii(r))return yS(t,r,e)}return e}function _T(t,e,r,n,i,s,a,o,l){return t=k1(r,n,!0,t,i,s,a,o,l),t.context=yT(null),r=t.current,n=hi(),i=jo(r),s=Na(n,i),s.callback=e??null,Lo(r,s,i),t.current.lanes=i,Cd(t,i,n),bi(t,n),t}function Ip(t,e,r,n){var i=e.current,s=hi(),a=jo(i);return r=yT(r),e.context===null?e.context=r:e.pendingContext=r,e=Na(s,a),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=Lo(i,e,a),t!==null&&(Ms(t,i,a,s),th(t,i,a)),a}function Vh(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function N_(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function C1(t,e){N_(t,e),(t=t.alternate)&&N_(t,e)}function uR(){return null}var ET=typeof reportError=="function"?reportError:function(t){console.error(t)};function F1(t){this._internalRoot=t}bp.prototype.render=F1.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Ne(409));Ip(t,e,null,null)};bp.prototype.unmount=F1.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Ul(function(){Ip(null,t,null,null)}),e[Ba]=null}};function bp(t){this._internalRoot=t}bp.prototype.unstable_scheduleHydration=function(t){if(t){var e=Jw();t={blockedOn:null,target:t,priority:e};for(var r=0;r<Eo.length&&e!==0&&e<Eo[r].priority;r++);Eo.splice(r,0,t),r===0&&eS(t)}};function I1(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Rp(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function D_(){}function fR(t,e,r,n,i){if(i){if(typeof n=="function"){var s=n;n=function(){var c=Vh(a);s.call(c)}}var a=_T(e,n,t,0,null,!1,!1,"",D_);return t._reactRootContainer=a,t[Ba]=a.current,Kf(t.nodeType===8?t.parentNode:t),Ul(),a}for(;i=t.lastChild;)t.removeChild(i);if(typeof n=="function"){var o=n;n=function(){var c=Vh(l);o.call(c)}}var l=k1(t,0,!1,null,null,!1,!1,"",D_);return t._reactRootContainer=l,t[Ba]=l.current,Kf(t.nodeType===8?t.parentNode:t),Ul(function(){Ip(e,l,r,n)}),l}function Np(t,e,r,n,i){var s=r._reactRootContainer;if(s){var a=s;if(typeof i=="function"){var o=i;i=function(){var l=Vh(a);o.call(l)}}Ip(e,a,t,i)}else a=fR(r,e,t,i,n);return Vh(a)}qw=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=lf(e.pendingLanes);r!==0&&(Xx(e,r|1),bi(e,Gr()),!(Ut&6)&&(fu=Gr()+500,nl()))}break;case 13:Ul(function(){var n=ja(t,1);if(n!==null){var i=hi();Ms(n,t,1,i)}}),C1(t,1)}};Yx=function(t){if(t.tag===13){var e=ja(t,134217728);if(e!==null){var r=hi();Ms(e,t,134217728,r)}C1(t,134217728)}};Qw=function(t){if(t.tag===13){var e=jo(t),r=ja(t,e);if(r!==null){var n=hi();Ms(r,t,e,n)}C1(t,e)}};Jw=function(){return ir};Zw=function(t,e){var r=ir;try{return ir=t,e()}finally{ir=r}};Sm=function(t,e,r){switch(e){case"input":if(mm(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var i=wp(n);if(!i)throw Error(Ne(90));bw(n),mm(n,i)}}}break;case"textarea":Nw(t,r);break;case"select":e=r.value,e!=null&&$c(t,!!r.multiple,e,!1)}};jw=w1;Vw=Ul;var dR={usingClientEntryPoint:!1,Events:[Id,Oc,wp,Lw,Bw,w1]},ef={findFiberByHostInstance:Tl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},hR={bundleType:ef.bundleType,version:ef.version,rendererPackageName:ef.rendererPackageName,rendererConfig:ef.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ka.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Ww(t),t===null?null:t.stateNode},findFiberByHostInstance:ef.findFiberByHostInstance||uR,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var k0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!k0.isDisabled&&k0.supportsFiber)try{vp=k0.inject(hR),aa=k0}catch{}}Xi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=dR;Xi.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!I1(e))throw Error(Ne(200));return cR(t,e,null,r)};Xi.createRoot=function(t,e){if(!I1(t))throw Error(Ne(299));var r=!1,n="",i=ET;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=k1(t,1,!1,null,null,r,!1,n,i),t[Ba]=e.current,Kf(t.nodeType===8?t.parentNode:t),new F1(e)};Xi.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Ne(188)):(t=Object.keys(t).join(","),Error(Ne(268,t)));return t=Ww(e),t=t===null?null:t.stateNode,t};Xi.flushSync=function(t){return Ul(t)};Xi.hydrate=function(t,e,r){if(!Rp(e))throw Error(Ne(200));return Np(null,t,e,!0,r)};Xi.hydrateRoot=function(t,e,r){if(!I1(t))throw Error(Ne(405));var n=r!=null&&r.hydratedSources||null,i=!1,s="",a=ET;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(a=r.onRecoverableError)),e=_T(e,null,t,1,r??null,i,!1,s,a),t[Ba]=e.current,Kf(t),n)for(t=0;t<n.length;t++)r=n[t],i=r._getVersion,i=i(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,i]:e.mutableSourceEagerHydrationData.push(r,i);return new bp(e)};Xi.render=function(t,e,r){if(!Rp(e))throw Error(Ne(200));return Np(null,t,e,!1,r)};Xi.unmountComponentAtNode=function(t){if(!Rp(t))throw Error(Ne(40));return t._reactRootContainer?(Ul(function(){Np(null,null,t,!1,function(){t._reactRootContainer=null,t[Ba]=null})}),!0):!1};Xi.unstable_batchedUpdates=w1;Xi.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!Rp(r))throw Error(Ne(200));if(t==null||t._reactInternals===void 0)throw Error(Ne(38));return Np(t,e,r,!1,n)};Xi.version="18.3.1-next-f1338f8080-20240426";function wT(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(wT)}catch(t){console.error(t)}}wT(),ww.exports=Xi;var pR=ww.exports,P_=pR;cm.createRoot=P_.createRoot,cm.hydrateRoot=P_.hydrateRoot;/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Uh={};Uh.version="0.18.5";var ST=1252,gR=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],b1={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},R1=function(t){gR.indexOf(t)!=-1&&(ST=b1[0]=t)};function mR(){R1(1252)}var Ns=function(t){R1(t)};function N1(){Ns(1200),mR()}function O_(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function xR(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function TT(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var uf=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?xR(t.slice(2)):e==254&&r==255?TT(t.slice(2)):e==65279?t.slice(1):t},C0=function(e){return String.fromCharCode(e)},M_=function(e){return String.fromCharCode(e)},rd,Io="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function nd(t){for(var e="",r=0,n=0,i=0,s=0,a=0,o=0,l=0,c=0;c<t.length;)r=t.charCodeAt(c++),s=r>>2,n=t.charCodeAt(c++),a=(r&3)<<4|n>>4,i=t.charCodeAt(c++),o=(n&15)<<2|i>>6,l=i&63,isNaN(n)?o=l=64:isNaN(i)&&(l=64),e+=Io.charAt(s)+Io.charAt(a)+Io.charAt(o)+Io.charAt(l);return e}function Ki(t){var e="",r=0,n=0,i=0,s=0,a=0,o=0,l=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<t.length;)s=Io.indexOf(t.charAt(c++)),a=Io.indexOf(t.charAt(c++)),r=s<<2|a>>4,e+=String.fromCharCode(r),o=Io.indexOf(t.charAt(c++)),n=(a&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(n)),l=Io.indexOf(t.charAt(c++)),i=(o&3)<<6|l,l!==64&&(e+=String.fromCharCode(i));return e}var Tt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Xa=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function Xo(t){return Tt?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function L_(t){return Tt?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var Ui=function(e){return Tt?Xa(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function Dp(t){if(typeof ArrayBuffer>"u")return Ui(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n!=t.length;++n)r[n]=t.charCodeAt(n)&255;return e}function il(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function vR(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}function D1(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return D1(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var kn=Tt?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:Xa(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),i=0;for(e=0,r=0;e<t.length;r+=i,++e)if(i=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function yR(t){for(var e=[],r=0,n=t.length+250,i=Xo(t.length+255),s=0;s<t.length;++s){var a=t.charCodeAt(s);if(a<128)i[r++]=a;else if(a<2048)i[r++]=192|a>>6&31,i[r++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=t.charCodeAt(++s)&1023;i[r++]=240|a>>8&7,i[r++]=128|a>>2&63,i[r++]=128|o>>6&15|(a&3)<<4,i[r++]=128|o&63}else i[r++]=224|a>>12&15,i[r++]=128|a>>6&63,i[r++]=128|a&63;r>n&&(e.push(i.slice(0,r)),r=0,i=Xo(65535),n=65530)}return e.push(i.slice(0,r)),kn(e)}var pi=/\u0000/g,ff=/[\u0001-\u0006]/g;function Qc(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function Ds(t,e){var r=""+t;return r.length>=e?r:Dr("0",e-r.length)+r}function P1(t,e){var r=""+t;return r.length>=e?r:Dr(" ",e-r.length)+r}function zh(t,e){var r=""+t;return r.length>=e?r:r+Dr(" ",e-r.length)}function _R(t,e){var r=""+Math.round(t);return r.length>=e?r:Dr("0",e-r.length)+r}function ER(t,e){var r=""+t;return r.length>=e?r:Dr("0",e-r.length)+r}var B_=Math.pow(2,32);function wc(t,e){if(t>B_||t<-B_)return _R(t,e);var r=Math.round(t);return ER(r,e)}function Wh(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var j_=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Ig=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function wR(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var st={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},V_={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},SR={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Hh(t,e,r){for(var n=t<0?-1:1,i=t*n,s=0,a=1,o=0,l=1,c=0,d=0,h=Math.floor(i);c<e&&(h=Math.floor(i),o=h*a+s,d=h*c+l,!(i-h<5e-8));)i=1/(i-h),s=a,a=o,l=c,c=d;if(d>e&&(c>e?(d=l,o=s):(d=c,o=a)),!r)return[0,n*o,d];var g=Math.floor(n*o/d);return[g,n*o-g*d,d]}function Cl(t,e,r){if(t>2958465||t<0)return null;var n=t|0,i=Math.floor(86400*(t-n)),s=0,a=[],o={D:n,T:i,u:86400*(t-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++n,++o.D)),n===60)a=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)a=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),a=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),n<60&&(s=(s+6)%7),r&&(s=IR(l,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=s,o}var AT=new Date(1899,11,31,0,0,0),TR=AT.getTime(),AR=new Date(1900,2,1,0,0,0);function kT(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=AR&&(r+=24*60*60*1e3),(r-(TR+(t.getTimezoneOffset()-AT.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function O1(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function kR(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function CR(t){var e=t<0?12:11,r=O1(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function FR(t){var e=O1(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function id(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=CR(t):e===10?r=t.toFixed(10).substr(0,12):r=FR(t),O1(kR(r.toUpperCase()))}function zl(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):id(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return gs(14,kT(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function IR(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function bR(t,e,r,n){var i="",s=0,a=0,o=r.y,l,c=0;switch(t){case 98:o=r.y+543;case 121:switch(e.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(e.length){case 1:case 2:l=r.m,c=e.length;break;case 3:return Ig[r.m-1][1];case 5:return Ig[r.m-1][0];default:return Ig[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:l=r.d,c=e.length;break;case 3:return j_[r.q][0];default:return j_[r.q][1]}break;case 104:switch(e.length){case 1:case 2:l=1+(r.H+11)%12,c=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:l=r.H,c=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:l=r.M,c=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?Ds(r.S,e.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,s=Math.round(a*(r.S+r.u)),s>=60*a&&(s=0),e==="s"?s===0?"0":""+s/a:(i=Ds(s,2+n),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}c=e.length===3?1:2;break;case 101:l=o,c=1;break}var d=c>0?Ds(l,c):"";return d}function bo(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var CT=/%/g;function RR(t,e,r){var n=e.replace(CT,""),i=e.length-n.length;return Da(t,n,r*Math.pow(10,2*i))+Dr("%",i)}function NR(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Da(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function FT(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+FT(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),r.indexOf("e")===-1){var a=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,d){return l+c+d.substr(0,(i+s)%i)+"."+d.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var IT=/# (\?+)( ?)\/( ?)(\d+)/;function DR(t,e,r){var n=parseInt(t[4],10),i=Math.round(e*n),s=Math.floor(i/n),a=i-s*n,o=n;return r+(s===0?"":""+s)+" "+(a===0?Dr(" ",t[1].length+1+t[4].length):P1(a,t[1].length)+t[2]+"/"+t[3]+Ds(o,t[4].length))}function PR(t,e,r){return r+(e===0?"":""+e)+Dr(" ",t[1].length+2+t[4].length)}var bT=/^#*0*\.([0#]+)/,RT=/\).*[0#]/,NT=/\(###\) ###\\?-####/;function fi(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function U_(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function z_(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function OR(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function MR(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function rs(t,e,r){if(t.charCodeAt(0)===40&&!e.match(RT)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?rs("n",n,r):"("+rs("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return NR(t,e,r);if(e.indexOf("%")!==-1)return RR(t,e,r);if(e.indexOf("E")!==-1)return FT(e,r);if(e.charCodeAt(0)===36)return"$"+rs(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),c=r<0?"-":"";if(e.match(/^00+$/))return c+wc(l,e.length);if(e.match(/^[#?]+$/))return i=wc(r,0),i==="0"&&(i=""),i.length>e.length?i:fi(e.substr(0,e.length-i.length))+i;if(s=e.match(IT))return DR(s,l,c);if(e.match(/^#+0+$/))return c+wc(l,e.length-e.indexOf("0"));if(s=e.match(bT))return i=U_(r,s[1].length).replace(/^([^\.]+)$/,"$1."+fi(s[1])).replace(/\.$/,"."+fi(s[1])).replace(/\.(\d*)$/,function(y,x){return"."+x+Dr("0",fi(s[1]).length-x.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return c+U_(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return c+bo(wc(l,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+rs(t,e,-r):bo(""+(Math.floor(r)+OR(r,s[1].length)))+"."+Ds(z_(r,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return rs(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Qc(rs(t,e.replace(/[\\-]/g,""),r)),a=0,Qc(Qc(e.replace(/\\/g,"")).replace(/[0#]/g,function(y){return a<i.length?i.charAt(a++):y==="0"?"0":""}));if(e.match(NT))return i=rs(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=Hh(l,Math.pow(10,a)-1,!1),i=""+c,d=Da("n",s[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),i+=d+s[2]+"/"+s[3],d=zh(o[2],a),d.length<s[4].length&&(d=fi(s[4].substr(s[4].length-d.length))+d),i+=d,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=Hh(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?P1(o[1],a)+s[2]+"/"+s[3]+zh(o[2],a):Dr(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=wc(r,0),e.length<=i.length?i:fi(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var h=e.indexOf(".")-a,g=e.length-i.length-h;return fi(e.substr(0,h)+i+e.substr(e.length-g))}if(s=e.match(/^00,000\.([#0]*0)$/))return a=z_(r,s[1].length),r<0?"-"+rs(t,e,-r):bo(MR(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?Ds(0,3-y.length):"")+y})+"."+Ds(a,s[1].length);switch(e){case"###,##0.00":return rs(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var m=bo(wc(l,0));return m!=="0"?c+m:"";case"###,###.00":return rs(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return rs(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function LR(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Da(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function BR(t,e,r){var n=e.replace(CT,""),i=e.length-n.length;return Da(t,n,r*Math.pow(10,2*i))+Dr("%",i)}function DT(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+DT(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!r.match(/[Ee]/)){var a=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,d){return l+c+d.substr(0,(i+s)%i)+"."+d.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function ta(t,e,r){if(t.charCodeAt(0)===40&&!e.match(RT)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ta("n",n,r):"("+ta("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return LR(t,e,r);if(e.indexOf("%")!==-1)return BR(t,e,r);if(e.indexOf("E")!==-1)return DT(e,r);if(e.charCodeAt(0)===36)return"$"+ta(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),c=r<0?"-":"";if(e.match(/^00+$/))return c+Ds(l,e.length);if(e.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>e.length?i:fi(e.substr(0,e.length-i.length))+i;if(s=e.match(IT))return PR(s,l,c);if(e.match(/^#+0+$/))return c+Ds(l,e.length-e.indexOf("0"));if(s=e.match(bT))return i=(""+r).replace(/^([^\.]+)$/,"$1."+fi(s[1])).replace(/\.$/,"."+fi(s[1])),i=i.replace(/\.(\d*)$/,function(y,x){return"."+x+Dr("0",fi(s[1]).length-x.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return c+bo(""+l);if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ta(t,e,-r):bo(""+r)+"."+Dr("0",s[1].length);if(s=e.match(/^#,#*,#0/))return ta(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Qc(ta(t,e.replace(/[\\-]/g,""),r)),a=0,Qc(Qc(e.replace(/\\/g,"")).replace(/[0#]/g,function(y){return a<i.length?i.charAt(a++):y==="0"?"0":""}));if(e.match(NT))return i=ta(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=Hh(l,Math.pow(10,a)-1,!1),i=""+c,d=Da("n",s[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),i+=d+s[2]+"/"+s[3],d=zh(o[2],a),d.length<s[4].length&&(d=fi(s[4].substr(s[4].length-d.length))+d),i+=d,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=Hh(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?P1(o[1],a)+s[2]+"/"+s[3]+zh(o[2],a):Dr(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=""+r,e.length<=i.length?i:fi(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var h=e.indexOf(".")-a,g=e.length-i.length-h;return fi(e.substr(0,h)+i+e.substr(e.length-g))}if(s=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+ta(t,e,-r):bo(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?Ds(0,3-y.length):"")+y})+"."+Ds(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var m=bo(""+l);return m!=="0"?c+m:"";default:if(e.match(/\.[0#?]*$/))return ta(t,e.slice(0,e.lastIndexOf(".")),r)+fi(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Da(t,e,r){return(r|0)===r?ta(t,e,r):rs(t,e,r)}function jR(t){for(var e=[],r=!1,n=0,i=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(i,n-i),i=n+1}if(e[e.length]=t.substr(i),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var PT=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Cu(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":Wh(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(PT))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function VR(t,e,r,n){for(var i=[],s="",a=0,o="",l="t",c,d,h,g="H";a<t.length;)switch(o=t.charAt(a)){case"G":if(!Wh(t,a))throw new Error("unrecognized character "+o+" in "+t);i[i.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(h=t.charCodeAt(++a))!==34&&a<t.length;)s+=String.fromCharCode(h);i[i.length]={t:"t",v:s},++a;break;case"\\":var m=t.charAt(++a),y=m==="("||m===")"?m:"t";i[i.length]={t:y,v:m},++a;break;case"_":i[i.length]={t:"t",v:" "},a+=2;break;case"@":i[i.length]={t:"T",v:e},++a;break;case"B":case"b":if(t.charAt(a+1)==="1"||t.charAt(a+1)==="2"){if(c==null&&(c=Cl(e,r,t.charAt(a+1)==="2"),c==null))return"";i[i.length]={t:"X",v:t.substr(a,2)},l=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||c==null&&(c=Cl(e,r),c==null))return"";for(s=o;++a<t.length&&t.charAt(a).toLowerCase()===o;)s+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=g),i[i.length]={t:o,v:s},l=o;break;case"A":case"a":case"":var x={t:o,v:o};if(c==null&&(c=Cl(e,r)),t.substr(a,3).toUpperCase()==="A/P"?(c!=null&&(x.v=c.H>=12?"P":"A"),x.t="T",g="h",a+=3):t.substr(a,5).toUpperCase()==="AM/PM"?(c!=null&&(x.v=c.H>=12?"PM":"AM"),x.t="T",a+=5,g="h"):t.substr(a,5).toUpperCase()==="/"?(c!=null&&(x.v=c.H>=12?"":""),x.t="T",a+=5,g="h"):(x.t="t",++a),c==null&&x.t==="T")return"";i[i.length]=x,l=o;break;case"[":for(s=o;t.charAt(a++)!=="]"&&a<t.length;)s+=t.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(PT)){if(c==null&&(c=Cl(e,r),c==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",Cu(t)||(i[i.length]={t:"t",v:s}));break;case".":if(c!=null){for(s=o;++a<t.length&&(o=t.charAt(a))==="0";)s+=o;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++a<t.length&&"0#?.,E+-%".indexOf(o=t.charAt(a))>-1;)s+=o;i[i.length]={t:"n",v:s};break;case"?":for(s=o;t.charAt(++a)===o;)s+=o;i[i.length]={t:o,v:s},l=o;break;case"*":++a,(t.charAt(a)==" "||t.charAt(a)=="*")&&++a;break;case"(":case")":i[i.length]={t:n===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;a<t.length&&"0123456789".indexOf(t.charAt(++a))>-1;)s+=t.charAt(a);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:o,v:o},++a;break;case"$":i[i.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+t);i[i.length]={t:"t",v:o},++a;break}var E=0,A=0,k;for(a=i.length-1,l="t";a>=0;--a)switch(i[a].t){case"h":case"H":i[a].t=g,l="h",E<1&&(E=1);break;case"s":(k=i[a].v.match(/\.0+$/))&&(A=Math.max(A,k[0].length-1)),E<3&&(E=3);case"d":case"y":case"M":case"e":l=i[a].t;break;case"m":l==="s"&&(i[a].t="M",E<2&&(E=2));break;case"X":break;case"Z":E<1&&i[a].v.match(/[Hh]/)&&(E=1),E<2&&i[a].v.match(/[Mm]/)&&(E=2),E<3&&i[a].v.match(/[Ss]/)&&(E=3)}switch(E){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var _="",P;for(a=0;a<i.length;++a)switch(i[a].t){case"t":case"T":case" ":case"D":break;case"X":i[a].v="",i[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[a].v=bR(i[a].t.charCodeAt(0),i[a].v,c,A),i[a].t="t";break;case"n":case"?":for(P=a+1;i[P]!=null&&((o=i[P].t)==="?"||o==="D"||(o===" "||o==="t")&&i[P+1]!=null&&(i[P+1].t==="?"||i[P+1].t==="t"&&i[P+1].v==="/")||i[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[P].v==="/"||i[P].v===" "&&i[P+1]!=null&&i[P+1].t=="?"));)i[a].v+=i[P].v,i[P]={v:"",t:";"},++P;_+=i[a].v,a=P-1;break;case"G":i[a].t="t",i[a].v=zl(e,r);break}var K="",V,S;if(_.length>0){_.charCodeAt(0)==40?(V=e<0&&_.charCodeAt(0)===45?-e:e,S=Da("n",_,V)):(V=e<0&&n>1?-e:e,S=Da("n",_,V),V<0&&i[0]&&i[0].t=="t"&&(S=S.substr(1),i[0].v="-"+i[0].v)),P=S.length-1;var F=i.length;for(a=0;a<i.length;++a)if(i[a]!=null&&i[a].t!="t"&&i[a].v.indexOf(".")>-1){F=a;break}var w=i.length;if(F===i.length&&S.indexOf("E")===-1){for(a=i.length-1;a>=0;--a)i[a]==null||"n?".indexOf(i[a].t)===-1||(P>=i[a].v.length-1?(P-=i[a].v.length,i[a].v=S.substr(P+1,i[a].v.length)):P<0?i[a].v="":(i[a].v=S.substr(0,P+1),P=-1),i[a].t="t",w=a);P>=0&&w<i.length&&(i[w].v=S.substr(0,P+1)+i[w].v)}else if(F!==i.length&&S.indexOf("E")===-1){for(P=S.indexOf(".")-1,a=F;a>=0;--a)if(!(i[a]==null||"n?".indexOf(i[a].t)===-1)){for(d=i[a].v.indexOf(".")>-1&&a===F?i[a].v.indexOf(".")-1:i[a].v.length-1,K=i[a].v.substr(d+1);d>=0;--d)P>=0&&(i[a].v.charAt(d)==="0"||i[a].v.charAt(d)==="#")&&(K=S.charAt(P--)+K);i[a].v=K,i[a].t="t",w=a}for(P>=0&&w<i.length&&(i[w].v=S.substr(0,P+1)+i[w].v),P=S.indexOf(".")+1,a=F;a<i.length;++a)if(!(i[a]==null||"n?(".indexOf(i[a].t)===-1&&a!==F)){for(d=i[a].v.indexOf(".")>-1&&a===F?i[a].v.indexOf(".")+1:0,K=i[a].v.substr(0,d);d<i[a].v.length;++d)P<S.length&&(K+=S.charAt(P++));i[a].v=K,i[a].t="t",w=a}}}for(a=0;a<i.length;++a)i[a]!=null&&"n?".indexOf(i[a].t)>-1&&(V=n>1&&e<0&&a>0&&i[a-1].v==="-"?-e:e,i[a].v=Da(i[a].t,i[a].v,V),i[a].t="t");var b="";for(a=0;a!==i.length;++a)i[a]!=null&&(b+=i[a].v);return b}var W_=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function H_(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function UR(t,e){var r=jR(t),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var a=r[0].match(W_),o=r[1].match(W_);return H_(e,a)?[n,r[0]]:H_(e,o)?[n,r[1]]:[n,r[a!=null&&o!=null?2:1]]}return[n,s]}function gs(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:st)[t],n==null&&(n=r.table&&r.table[V_[t]]||st[V_[t]]),n==null&&(n=SR[t]||"General");break}if(Wh(n,0))return zl(e,r);e instanceof Date&&(e=kT(e,r.date1904));var i=UR(n,e);if(Wh(i[1]))return zl(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return VR(i[1],e,r,i[0])}function Pa(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(st[r]==null){e<0&&(e=r);continue}if(st[r]==t){e=r;break}}e<0&&(e=391)}return st[e]=t,e}function Pp(t){for(var e=0;e!=392;++e)t[e]!==void 0&&Pa(t[e],e)}function Fu(){st=wR()}var zR={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},OT=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function WR(t){var e=typeof t=="number"?st[t]:t;return e=e.replace(OT,"(\\d+)"),new RegExp("^"+e+"$")}function HR(t,e,r){var n=-1,i=-1,s=-1,a=-1,o=-1,l=-1;(e.match(OT)||[]).forEach(function(h,g){var m=parseInt(r[g+1],10);switch(h.toLowerCase().charAt(0)){case"y":n=m;break;case"d":s=m;break;case"h":a=m;break;case"s":l=m;break;case"m":a>=0?o=m:i=m;break}}),l>=0&&o==-1&&i>=0&&(o=i,i=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var d=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return a==-1&&o==-1&&l==-1?c:n==-1&&i==-1&&s==-1?d:c+"T"+d}var $R=function(){var t={};t.version="1.2.0";function e(){for(var S=0,F=new Array(256),w=0;w!=256;++w)S=w,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,F[w]=S;return typeof Int32Array<"u"?new Int32Array(F):F}var r=e();function n(S){var F=0,w=0,b=0,N=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(b=0;b!=256;++b)N[b]=S[b];for(b=0;b!=256;++b)for(w=S[b],F=256+b;F<4096;F+=256)w=N[F]=w>>>8^S[w&255];var D=[];for(b=1;b!=16;++b)D[b-1]=typeof Int32Array<"u"?N.subarray(b*256,b*256+256):N.slice(b*256,b*256+256);return D}var i=n(r),s=i[0],a=i[1],o=i[2],l=i[3],c=i[4],d=i[5],h=i[6],g=i[7],m=i[8],y=i[9],x=i[10],E=i[11],A=i[12],k=i[13],_=i[14];function P(S,F){for(var w=F^-1,b=0,N=S.length;b<N;)w=w>>>8^r[(w^S.charCodeAt(b++))&255];return~w}function K(S,F){for(var w=F^-1,b=S.length-15,N=0;N<b;)w=_[S[N++]^w&255]^k[S[N++]^w>>8&255]^A[S[N++]^w>>16&255]^E[S[N++]^w>>>24]^x[S[N++]]^y[S[N++]]^m[S[N++]]^g[S[N++]]^h[S[N++]]^d[S[N++]]^c[S[N++]]^l[S[N++]]^o[S[N++]]^a[S[N++]]^s[S[N++]]^r[S[N++]];for(b+=15;N<b;)w=w>>>8^r[(w^S[N++])&255];return~w}function V(S,F){for(var w=F^-1,b=0,N=S.length,D=0,R=0;b<N;)D=S.charCodeAt(b++),D<128?w=w>>>8^r[(w^D)&255]:D<2048?(w=w>>>8^r[(w^(192|D>>6&31))&255],w=w>>>8^r[(w^(128|D&63))&255]):D>=55296&&D<57344?(D=(D&1023)+64,R=S.charCodeAt(b++)&1023,w=w>>>8^r[(w^(240|D>>8&7))&255],w=w>>>8^r[(w^(128|D>>2&63))&255],w=w>>>8^r[(w^(128|R>>6&15|(D&3)<<4))&255],w=w>>>8^r[(w^(128|R&63))&255]):(w=w>>>8^r[(w^(224|D>>12&15))&255],w=w>>>8^r[(w^(128|D>>6&63))&255],w=w>>>8^r[(w^(128|D&63))&255]);return~w}return t.table=r,t.bstr=P,t.buf=K,t.str=V,t}(),Ze=function(){var e={};e.version="1.2.1";function r(I,G){for(var M=I.split("/"),B=G.split("/"),X=0,U=0,oe=Math.min(M.length,B.length);X<oe;++X){if(U=M[X].length-B[X].length)return U;if(M[X]!=B[X])return M[X]<B[X]?-1:1}return M.length-B.length}function n(I){if(I.charAt(I.length-1)=="/")return I.slice(0,-1).indexOf("/")===-1?I:n(I.slice(0,-1));var G=I.lastIndexOf("/");return G===-1?I:I.slice(0,G+1)}function i(I){if(I.charAt(I.length-1)=="/")return i(I.slice(0,-1));var G=I.lastIndexOf("/");return G===-1?I:I.slice(G+1)}function s(I,G){typeof G=="string"&&(G=new Date(G));var M=G.getHours();M=M<<6|G.getMinutes(),M=M<<5|G.getSeconds()>>>1,I.write_shift(2,M);var B=G.getFullYear()-1980;B=B<<4|G.getMonth()+1,B=B<<5|G.getDate(),I.write_shift(2,B)}function a(I){var G=I.read_shift(2)&65535,M=I.read_shift(2)&65535,B=new Date,X=M&31;M>>>=5;var U=M&15;M>>>=4,B.setMilliseconds(0),B.setFullYear(M+1980),B.setMonth(U-1),B.setDate(X);var oe=G&31;G>>>=5;var fe=G&63;return G>>>=6,B.setHours(G),B.setMinutes(fe),B.setSeconds(oe<<1),B}function o(I){Dn(I,0);for(var G={},M=0;I.l<=I.length-4;){var B=I.read_shift(2),X=I.read_shift(2),U=I.l+X,oe={};switch(B){case 21589:M=I.read_shift(1),M&1&&(oe.mtime=I.read_shift(4)),X>5&&(M&2&&(oe.atime=I.read_shift(4)),M&4&&(oe.ctime=I.read_shift(4))),oe.mtime&&(oe.mt=new Date(oe.mtime*1e3));break}I.l=U,G[B]=oe}return G}var l;function c(){return l||(l={})}function d(I,G){if(I[0]==80&&I[1]==75)return vs(I,G);if((I[0]|32)==109&&(I[1]|32)==105)return an(I,G);if(I.length<512)throw new Error("CFB file size "+I.length+" < 512");var M=3,B=512,X=0,U=0,oe=0,fe=0,le=0,ce=[],ue=I.slice(0,512);Dn(ue,0);var Ce=h(ue);switch(M=Ce[0],M){case 3:B=512;break;case 4:B=4096;break;case 0:if(Ce[1]==0)return vs(I,G);default:throw new Error("Major Version: Expected 3 or 4 saw "+M)}B!==512&&(ue=I.slice(0,B),Dn(ue,28));var je=I.slice(0,B);g(ue,M);var $e=ue.read_shift(4,"i");if(M===3&&$e!==0)throw new Error("# Directory Sectors: Expected 0 saw "+$e);ue.l+=4,oe=ue.read_shift(4,"i"),ue.l+=4,ue.chk("00100000","Mini Stream Cutoff Size: "),fe=ue.read_shift(4,"i"),X=ue.read_shift(4,"i"),le=ue.read_shift(4,"i"),U=ue.read_shift(4,"i");for(var Re=-1,Ge=0;Ge<109&&(Re=ue.read_shift(4,"i"),!(Re<0));++Ge)ce[Ge]=Re;var nt=m(I,B);E(le,U,nt,B,ce);var ot=k(nt,oe,ce,B);ot[oe].name="!Directory",X>0&&fe!==R&&(ot[fe].name="!MiniFAT"),ot[ce[0]].name="!FAT",ot.fat_addrs=ce,ot.ssz=B;var Lt={},kt=[],ci=[],ht=[];_(oe,ot,nt,kt,X,Lt,ci,fe),y(ci,ht,kt),kt.shift();var Vn={FileIndex:ci,FullPaths:ht};return G&&G.raw&&(Vn.raw={header:je,sectors:nt}),Vn}function h(I){if(I[I.l]==80&&I[I.l+1]==75)return[0,0];I.chk(ze,"Header Signature: "),I.l+=16;var G=I.read_shift(2,"u");return[I.read_shift(2,"u"),G]}function g(I,G){var M=9;switch(I.l+=2,M=I.read_shift(2)){case 9:if(G!=3)throw new Error("Sector Shift: Expected 9 saw "+M);break;case 12:if(G!=4)throw new Error("Sector Shift: Expected 12 saw "+M);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+M)}I.chk("0600","Mini Sector Shift: "),I.chk("000000000000","Reserved: ")}function m(I,G){for(var M=Math.ceil(I.length/G)-1,B=[],X=1;X<M;++X)B[X-1]=I.slice(X*G,(X+1)*G);return B[M-1]=I.slice(M*G),B}function y(I,G,M){for(var B=0,X=0,U=0,oe=0,fe=0,le=M.length,ce=[],ue=[];B<le;++B)ce[B]=ue[B]=B,G[B]=M[B];for(;fe<ue.length;++fe)B=ue[fe],X=I[B].L,U=I[B].R,oe=I[B].C,ce[B]===B&&(X!==-1&&ce[X]!==X&&(ce[B]=ce[X]),U!==-1&&ce[U]!==U&&(ce[B]=ce[U])),oe!==-1&&(ce[oe]=B),X!==-1&&B!=ce[B]&&(ce[X]=ce[B],ue.lastIndexOf(X)<fe&&ue.push(X)),U!==-1&&B!=ce[B]&&(ce[U]=ce[B],ue.lastIndexOf(U)<fe&&ue.push(U));for(B=1;B<le;++B)ce[B]===B&&(U!==-1&&ce[U]!==U?ce[B]=ce[U]:X!==-1&&ce[X]!==X&&(ce[B]=ce[X]));for(B=1;B<le;++B)if(I[B].type!==0){if(fe=B,fe!=ce[fe])do fe=ce[fe],G[B]=G[fe]+"/"+G[B];while(fe!==0&&ce[fe]!==-1&&fe!=ce[fe]);ce[B]=-1}for(G[0]+="/",B=1;B<le;++B)I[B].type!==2&&(G[B]+="/")}function x(I,G,M){for(var B=I.start,X=I.size,U=[],oe=B;M&&X>0&&oe>=0;)U.push(G.slice(oe*D,oe*D+D)),X-=D,oe=Sl(M,oe*4);return U.length===0?ve(0):kn(U).slice(0,I.size)}function E(I,G,M,B,X){var U=R;if(I===R){if(G!==0)throw new Error("DIFAT chain shorter than expected")}else if(I!==-1){var oe=M[I],fe=(B>>>2)-1;if(!oe)return;for(var le=0;le<fe&&(U=Sl(oe,le*4))!==R;++le)X.push(U);E(Sl(oe,B-4),G-1,M,B,X)}}function A(I,G,M,B,X){var U=[],oe=[];X||(X=[]);var fe=B-1,le=0,ce=0;for(le=G;le>=0;){X[le]=!0,U[U.length]=le,oe.push(I[le]);var ue=M[Math.floor(le*4/B)];if(ce=le*4&fe,B<4+ce)throw new Error("FAT boundary crossed: "+le+" 4 "+B);if(!I[ue])break;le=Sl(I[ue],ce)}return{nodes:U,data:r2([oe])}}function k(I,G,M,B){var X=I.length,U=[],oe=[],fe=[],le=[],ce=B-1,ue=0,Ce=0,je=0,$e=0;for(ue=0;ue<X;++ue)if(fe=[],je=ue+G,je>=X&&(je-=X),!oe[je]){le=[];var Re=[];for(Ce=je;Ce>=0;){Re[Ce]=!0,oe[Ce]=!0,fe[fe.length]=Ce,le.push(I[Ce]);var Ge=M[Math.floor(Ce*4/B)];if($e=Ce*4&ce,B<4+$e)throw new Error("FAT boundary crossed: "+Ce+" 4 "+B);if(!I[Ge]||(Ce=Sl(I[Ge],$e),Re[Ce]))break}U[je]={nodes:fe,data:r2([le])}}return U}function _(I,G,M,B,X,U,oe,fe){for(var le=0,ce=B.length?2:0,ue=G[I].data,Ce=0,je=0,$e;Ce<ue.length;Ce+=128){var Re=ue.slice(Ce,Ce+128);Dn(Re,64),je=Re.read_shift(2),$e=z1(Re,0,je-ce),B.push($e);var Ge={name:$e,type:Re.read_shift(1),color:Re.read_shift(1),L:Re.read_shift(4,"i"),R:Re.read_shift(4,"i"),C:Re.read_shift(4,"i"),clsid:Re.read_shift(16),state:Re.read_shift(4,"i"),start:0,size:0},nt=Re.read_shift(2)+Re.read_shift(2)+Re.read_shift(2)+Re.read_shift(2);nt!==0&&(Ge.ct=P(Re,Re.l-8));var ot=Re.read_shift(2)+Re.read_shift(2)+Re.read_shift(2)+Re.read_shift(2);ot!==0&&(Ge.mt=P(Re,Re.l-8)),Ge.start=Re.read_shift(4,"i"),Ge.size=Re.read_shift(4,"i"),Ge.size<0&&Ge.start<0&&(Ge.size=Ge.type=0,Ge.start=R,Ge.name=""),Ge.type===5?(le=Ge.start,X>0&&le!==R&&(G[le].name="!StreamData")):Ge.size>=4096?(Ge.storage="fat",G[Ge.start]===void 0&&(G[Ge.start]=A(M,Ge.start,G.fat_addrs,G.ssz)),G[Ge.start].name=Ge.name,Ge.content=G[Ge.start].data.slice(0,Ge.size)):(Ge.storage="minifat",Ge.size<0?Ge.size=0:le!==R&&Ge.start!==R&&G[le]&&(Ge.content=x(Ge,G[le].data,(G[fe]||{}).data))),Ge.content&&Dn(Ge.content,0),U[$e]=Ge,oe.push(Ge)}}function P(I,G){return new Date((Vi(I,G+4)/1e7*Math.pow(2,32)+Vi(I,G)/1e7-11644473600)*1e3)}function K(I,G){return c(),d(l.readFileSync(I),G)}function V(I,G){var M=G&&G.type;switch(M||Tt&&Buffer.isBuffer(I)&&(M="buffer"),M||"base64"){case"file":return K(I,G);case"base64":return d(Ui(Ki(I)),G);case"binary":return d(Ui(I),G)}return d(I,G)}function S(I,G){var M=G||{},B=M.root||"Root Entry";if(I.FullPaths||(I.FullPaths=[]),I.FileIndex||(I.FileIndex=[]),I.FullPaths.length!==I.FileIndex.length)throw new Error("inconsistent CFB structure");I.FullPaths.length===0&&(I.FullPaths[0]=B+"/",I.FileIndex[0]={name:B,type:5}),M.CLSID&&(I.FileIndex[0].clsid=M.CLSID),F(I)}function F(I){var G="Sh33tJ5";if(!Ze.find(I,"/"+G)){var M=ve(4);M[0]=55,M[1]=M[3]=50,M[2]=54,I.FileIndex.push({name:G,type:2,content:M,size:4,L:69,R:69,C:69}),I.FullPaths.push(I.FullPaths[0]+G),w(I)}}function w(I,G){S(I);for(var M=!1,B=!1,X=I.FullPaths.length-1;X>=0;--X){var U=I.FileIndex[X];switch(U.type){case 0:B?M=!0:(I.FileIndex.pop(),I.FullPaths.pop());break;case 1:case 2:case 5:B=!0,isNaN(U.R*U.L*U.C)&&(M=!0),U.R>-1&&U.L>-1&&U.R==U.L&&(M=!0);break;default:M=!0;break}}if(!(!M&&!G)){var oe=new Date(1987,1,19),fe=0,le=Object.create?Object.create(null):{},ce=[];for(X=0;X<I.FullPaths.length;++X)le[I.FullPaths[X]]=!0,I.FileIndex[X].type!==0&&ce.push([I.FullPaths[X],I.FileIndex[X]]);for(X=0;X<ce.length;++X){var ue=n(ce[X][0]);B=le[ue],B||(ce.push([ue,{name:i(ue).replace("/",""),type:1,clsid:Ie,ct:oe,mt:oe,content:null}]),le[ue]=!0)}for(ce.sort(function($e,Re){return r($e[0],Re[0])}),I.FullPaths=[],I.FileIndex=[],X=0;X<ce.length;++X)I.FullPaths[X]=ce[X][0],I.FileIndex[X]=ce[X][1];for(X=0;X<ce.length;++X){var Ce=I.FileIndex[X],je=I.FullPaths[X];if(Ce.name=i(je).replace("/",""),Ce.L=Ce.R=Ce.C=-(Ce.color=1),Ce.size=Ce.content?Ce.content.length:0,Ce.start=0,Ce.clsid=Ce.clsid||Ie,X===0)Ce.C=ce.length>1?1:-1,Ce.size=0,Ce.type=5;else if(je.slice(-1)=="/"){for(fe=X+1;fe<ce.length&&n(I.FullPaths[fe])!=je;++fe);for(Ce.C=fe>=ce.length?-1:fe,fe=X+1;fe<ce.length&&n(I.FullPaths[fe])!=n(je);++fe);Ce.R=fe>=ce.length?-1:fe,Ce.type=1}else n(I.FullPaths[X+1]||"")==n(je)&&(Ce.R=X+1),Ce.type=2}}}function b(I,G){var M=G||{};if(M.fileType=="mad")return Yr(I,M);switch(w(I),M.fileType){case"zip":return br(I,M)}var B=function($e){for(var Re=0,Ge=0,nt=0;nt<$e.FileIndex.length;++nt){var ot=$e.FileIndex[nt];if(ot.content){var Lt=ot.content.length;Lt>0&&(Lt<4096?Re+=Lt+63>>6:Ge+=Lt+511>>9)}}for(var kt=$e.FullPaths.length+3>>2,ci=Re+7>>3,ht=Re+127>>7,Vn=ci+Ge+kt+ht,vt=Vn+127>>7,yn=vt<=109?0:Math.ceil((vt-109)/127);Vn+vt+yn+127>>7>vt;)yn=++vt<=109?0:Math.ceil((vt-109)/127);var Yt=[1,yn,vt,ht,kt,Ge,Re,0];return $e.FileIndex[0].size=Re<<6,Yt[7]=($e.FileIndex[0].start=Yt[0]+Yt[1]+Yt[2]+Yt[3]+Yt[4]+Yt[5])+(Yt[6]+7>>3),Yt}(I),X=ve(B[7]<<9),U=0,oe=0;{for(U=0;U<8;++U)X.write_shift(1,_e[U]);for(U=0;U<8;++U)X.write_shift(2,0);for(X.write_shift(2,62),X.write_shift(2,3),X.write_shift(2,65534),X.write_shift(2,9),X.write_shift(2,6),U=0;U<3;++U)X.write_shift(2,0);for(X.write_shift(4,0),X.write_shift(4,B[2]),X.write_shift(4,B[0]+B[1]+B[2]+B[3]-1),X.write_shift(4,0),X.write_shift(4,4096),X.write_shift(4,B[3]?B[0]+B[1]+B[2]-1:R),X.write_shift(4,B[3]),X.write_shift(-4,B[1]?B[0]-1:R),X.write_shift(4,B[1]),U=0;U<109;++U)X.write_shift(-4,U<B[2]?B[1]+U:-1)}if(B[1])for(oe=0;oe<B[1];++oe){for(;U<236+oe*127;++U)X.write_shift(-4,U<B[2]?B[1]+U:-1);X.write_shift(-4,oe===B[1]-1?R:oe+1)}var fe=function($e){for(oe+=$e;U<oe-1;++U)X.write_shift(-4,U+1);$e&&(++U,X.write_shift(-4,R))};for(oe=U=0,oe+=B[1];U<oe;++U)X.write_shift(-4,De.DIFSECT);for(oe+=B[2];U<oe;++U)X.write_shift(-4,De.FATSECT);fe(B[3]),fe(B[4]);for(var le=0,ce=0,ue=I.FileIndex[0];le<I.FileIndex.length;++le)ue=I.FileIndex[le],ue.content&&(ce=ue.content.length,!(ce<4096)&&(ue.start=oe,fe(ce+511>>9)));for(fe(B[6]+7>>3);X.l&511;)X.write_shift(-4,De.ENDOFCHAIN);for(oe=U=0,le=0;le<I.FileIndex.length;++le)ue=I.FileIndex[le],ue.content&&(ce=ue.content.length,!(!ce||ce>=4096)&&(ue.start=oe,fe(ce+63>>6)));for(;X.l&511;)X.write_shift(-4,De.ENDOFCHAIN);for(U=0;U<B[4]<<2;++U){var Ce=I.FullPaths[U];if(!Ce||Ce.length===0){for(le=0;le<17;++le)X.write_shift(4,0);for(le=0;le<3;++le)X.write_shift(4,-1);for(le=0;le<12;++le)X.write_shift(4,0);continue}ue=I.FileIndex[U],U===0&&(ue.start=ue.size?ue.start-1:R);var je=U===0&&M.root||ue.name;if(ce=2*(je.length+1),X.write_shift(64,je,"utf16le"),X.write_shift(2,ce),X.write_shift(1,ue.type),X.write_shift(1,ue.color),X.write_shift(-4,ue.L),X.write_shift(-4,ue.R),X.write_shift(-4,ue.C),ue.clsid)X.write_shift(16,ue.clsid,"hex");else for(le=0;le<4;++le)X.write_shift(4,0);X.write_shift(4,ue.state||0),X.write_shift(4,0),X.write_shift(4,0),X.write_shift(4,0),X.write_shift(4,0),X.write_shift(4,ue.start),X.write_shift(4,ue.size),X.write_shift(4,0)}for(U=1;U<I.FileIndex.length;++U)if(ue=I.FileIndex[U],ue.size>=4096)if(X.l=ue.start+1<<9,Tt&&Buffer.isBuffer(ue.content))ue.content.copy(X,X.l,0,ue.size),X.l+=ue.size+511&-512;else{for(le=0;le<ue.size;++le)X.write_shift(1,ue.content[le]);for(;le&511;++le)X.write_shift(1,0)}for(U=1;U<I.FileIndex.length;++U)if(ue=I.FileIndex[U],ue.size>0&&ue.size<4096)if(Tt&&Buffer.isBuffer(ue.content))ue.content.copy(X,X.l,0,ue.size),X.l+=ue.size+63&-64;else{for(le=0;le<ue.size;++le)X.write_shift(1,ue.content[le]);for(;le&63;++le)X.write_shift(1,0)}if(Tt)X.l=X.length;else for(;X.l<X.length;)X.write_shift(1,0);return X}function N(I,G){var M=I.FullPaths.map(function(le){return le.toUpperCase()}),B=M.map(function(le){var ce=le.split("/");return ce[ce.length-(le.slice(-1)=="/"?2:1)]}),X=!1;G.charCodeAt(0)===47?(X=!0,G=M[0].slice(0,-1)+G):X=G.indexOf("/")!==-1;var U=G.toUpperCase(),oe=X===!0?M.indexOf(U):B.indexOf(U);if(oe!==-1)return I.FileIndex[oe];var fe=!U.match(ff);for(U=U.replace(pi,""),fe&&(U=U.replace(ff,"!")),oe=0;oe<M.length;++oe)if((fe?M[oe].replace(ff,"!"):M[oe]).replace(pi,"")==U||(fe?B[oe].replace(ff,"!"):B[oe]).replace(pi,"")==U)return I.FileIndex[oe];return null}var D=64,R=-2,ze="d0cf11e0a1b11ae1",_e=[208,207,17,224,161,177,26,225],Ie="00000000000000000000000000000000",De={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:R,FREESECT:-1,HEADER_SIGNATURE:ze,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Ie,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function we(I,G,M){c();var B=b(I,M);l.writeFileSync(G,B)}function re(I){for(var G=new Array(I.length),M=0;M<I.length;++M)G[M]=String.fromCharCode(I[M]);return G.join("")}function Ae(I,G){var M=b(I,G);switch(G&&G.type||"buffer"){case"file":return c(),l.writeFileSync(G.filename,M),M;case"binary":return typeof M=="string"?M:re(M);case"base64":return nd(typeof M=="string"?M:re(M));case"buffer":if(Tt)return Buffer.isBuffer(M)?M:Xa(M);case"array":return typeof M=="string"?Ui(M):M}return M}var Oe;function z(I){try{var G=I.InflateRaw,M=new G;if(M._processChunk(new Uint8Array([3,0]),M._finishFlushFlag),M.bytesRead)Oe=I;else throw new Error("zlib does not expose bytesRead")}catch(B){console.error("cannot use native zlib: "+(B.message||B))}}function ne(I,G){if(!Oe)return xs(I,G);var M=Oe.InflateRaw,B=new M,X=B._processChunk(I.slice(I.l),B._finishFlushFlag);return I.l+=B.bytesRead,X}function te(I){return Oe?Oe.deflateRawSync(I):ct(I)}var Y=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ge=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Ee=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Pe(I){var G=(I<<1|I<<11)&139536|(I<<5|I<<15)&558144;return(G>>16|G>>8|G)&255}for(var ke=typeof Uint8Array<"u",Se=ke?new Uint8Array(256):[],tt=0;tt<256;++tt)Se[tt]=Pe(tt);function Q(I,G){var M=Se[I&255];return G<=8?M>>>8-G:(M=M<<8|Se[I>>8&255],G<=16?M>>>16-G:(M=M<<8|Se[I>>16&255],M>>>24-G))}function Rt(I,G){var M=G&7,B=G>>>3;return(I[B]|(M<=6?0:I[B+1]<<8))>>>M&3}function xt(I,G){var M=G&7,B=G>>>3;return(I[B]|(M<=5?0:I[B+1]<<8))>>>M&7}function Ft(I,G){var M=G&7,B=G>>>3;return(I[B]|(M<=4?0:I[B+1]<<8))>>>M&15}function dt(I,G){var M=G&7,B=G>>>3;return(I[B]|(M<=3?0:I[B+1]<<8))>>>M&31}function We(I,G){var M=G&7,B=G>>>3;return(I[B]|(M<=1?0:I[B+1]<<8))>>>M&127}function ar(I,G,M){var B=G&7,X=G>>>3,U=(1<<M)-1,oe=I[X]>>>B;return M<8-B||(oe|=I[X+1]<<8-B,M<16-B)||(oe|=I[X+2]<<16-B,M<24-B)||(oe|=I[X+3]<<24-B),oe&U}function In(I,G,M){var B=G&7,X=G>>>3;return B<=5?I[X]|=(M&7)<<B:(I[X]|=M<<B&255,I[X+1]=(M&7)>>8-B),G+3}function sn(I,G,M){var B=G&7,X=G>>>3;return M=(M&1)<<B,I[X]|=M,G+1}function xi(I,G,M){var B=G&7,X=G>>>3;return M<<=B,I[X]|=M&255,M>>>=8,I[X+1]=M,G+8}function qi(I,G,M){var B=G&7,X=G>>>3;return M<<=B,I[X]|=M&255,M>>>=8,I[X+1]=M&255,I[X+2]=M>>>8,G+16}function vi(I,G){var M=I.length,B=2*M>G?2*M:G+5,X=0;if(M>=G)return I;if(Tt){var U=L_(B);if(I.copy)I.copy(U);else for(;X<I.length;++X)U[X]=I[X];return U}else if(ke){var oe=new Uint8Array(B);if(oe.set)oe.set(I);else for(;X<M;++X)oe[X]=I[X];return oe}return I.length=B,I}function Lr(I){for(var G=new Array(I),M=0;M<I;++M)G[M]=0;return G}function yi(I,G,M){var B=1,X=0,U=0,oe=0,fe=0,le=I.length,ce=ke?new Uint16Array(32):Lr(32);for(U=0;U<32;++U)ce[U]=0;for(U=le;U<M;++U)I[U]=0;le=I.length;var ue=ke?new Uint16Array(le):Lr(le);for(U=0;U<le;++U)ce[X=I[U]]++,B<X&&(B=X),ue[U]=0;for(ce[0]=0,U=1;U<=B;++U)ce[U+16]=fe=fe+ce[U-1]<<1;for(U=0;U<le;++U)fe=I[U],fe!=0&&(ue[U]=ce[fe+16]++);var Ce=0;for(U=0;U<le;++U)if(Ce=I[U],Ce!=0)for(fe=Q(ue[U],B)>>B-Ce,oe=(1<<B+4-Ce)-1;oe>=0;--oe)G[fe|oe<<Ce]=Ce&15|U<<4;return B}var Qt=ke?new Uint16Array(512):Lr(512),Sr=ke?new Uint16Array(32):Lr(32);if(!ke){for(var fr=0;fr<512;++fr)Qt[fr]=0;for(fr=0;fr<32;++fr)Sr[fr]=0}(function(){for(var I=[],G=0;G<32;G++)I.push(5);yi(I,Sr,32);var M=[];for(G=0;G<=143;G++)M.push(8);for(;G<=255;G++)M.push(9);for(;G<=279;G++)M.push(7);for(;G<=287;G++)M.push(8);yi(M,Qt,288)})();var oi=function(){for(var G=ke?new Uint8Array(32768):[],M=0,B=0;M<Ee.length-1;++M)for(;B<Ee[M+1];++B)G[B]=M;for(;B<32768;++B)G[B]=29;var X=ke?new Uint8Array(259):[];for(M=0,B=0;M<ge.length-1;++M)for(;B<ge[M+1];++B)X[B]=M;function U(fe,le){for(var ce=0;ce<fe.length;){var ue=Math.min(65535,fe.length-ce),Ce=ce+ue==fe.length;for(le.write_shift(1,+Ce),le.write_shift(2,ue),le.write_shift(2,~ue&65535);ue-- >0;)le[le.l++]=fe[ce++]}return le.l}function oe(fe,le){for(var ce=0,ue=0,Ce=ke?new Uint16Array(32768):[];ue<fe.length;){var je=Math.min(65535,fe.length-ue);if(je<10){for(ce=In(le,ce,+(ue+je==fe.length)),ce&7&&(ce+=8-(ce&7)),le.l=ce/8|0,le.write_shift(2,je),le.write_shift(2,~je&65535);je-- >0;)le[le.l++]=fe[ue++];ce=le.l*8;continue}ce=In(le,ce,+(ue+je==fe.length)+2);for(var $e=0;je-- >0;){var Re=fe[ue];$e=($e<<5^Re)&32767;var Ge=-1,nt=0;if((Ge=Ce[$e])&&(Ge|=ue&-32768,Ge>ue&&(Ge-=32768),Ge<ue))for(;fe[Ge+nt]==fe[ue+nt]&&nt<250;)++nt;if(nt>2){Re=X[nt],Re<=22?ce=xi(le,ce,Se[Re+1]>>1)-1:(xi(le,ce,3),ce+=5,xi(le,ce,Se[Re-23]>>5),ce+=3);var ot=Re<8?0:Re-4>>2;ot>0&&(qi(le,ce,nt-ge[Re]),ce+=ot),Re=G[ue-Ge],ce=xi(le,ce,Se[Re]>>3),ce-=3;var Lt=Re<4?0:Re-2>>1;Lt>0&&(qi(le,ce,ue-Ge-Ee[Re]),ce+=Lt);for(var kt=0;kt<nt;++kt)Ce[$e]=ue&32767,$e=($e<<5^fe[ue])&32767,++ue;je-=nt-1}else Re<=143?Re=Re+48:ce=sn(le,ce,1),ce=xi(le,ce,Se[Re]),Ce[$e]=ue&32767,++ue}ce=xi(le,ce,0)-1}return le.l=(ce+7)/8|0,le.l}return function(le,ce){return le.length<8?U(le,ce):oe(le,ce)}}();function ct(I){var G=ve(50+Math.floor(I.length*1.1)),M=oi(I,G);return G.slice(0,M)}var dr=ke?new Uint16Array(32768):Lr(32768),hr=ke?new Uint16Array(32768):Lr(32768),yr=ke?new Uint16Array(128):Lr(128),li=1,Ja=1;function Za(I,G){var M=dt(I,G)+257;G+=5;var B=dt(I,G)+1;G+=5;var X=Ft(I,G)+4;G+=4;for(var U=0,oe=ke?new Uint8Array(19):Lr(19),fe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],le=1,ce=ke?new Uint8Array(8):Lr(8),ue=ke?new Uint8Array(8):Lr(8),Ce=oe.length,je=0;je<X;++je)oe[Y[je]]=U=xt(I,G),le<U&&(le=U),ce[U]++,G+=3;var $e=0;for(ce[0]=0,je=1;je<=le;++je)ue[je]=$e=$e+ce[je-1]<<1;for(je=0;je<Ce;++je)($e=oe[je])!=0&&(fe[je]=ue[$e]++);var Re=0;for(je=0;je<Ce;++je)if(Re=oe[je],Re!=0){$e=Se[fe[je]]>>8-Re;for(var Ge=(1<<7-Re)-1;Ge>=0;--Ge)yr[$e|Ge<<Re]=Re&7|je<<3}var nt=[];for(le=1;nt.length<M+B;)switch($e=yr[We(I,G)],G+=$e&7,$e>>>=3){case 16:for(U=3+Rt(I,G),G+=2,$e=nt[nt.length-1];U-- >0;)nt.push($e);break;case 17:for(U=3+xt(I,G),G+=3;U-- >0;)nt.push(0);break;case 18:for(U=11+We(I,G),G+=7;U-- >0;)nt.push(0);break;default:nt.push($e),le<$e&&(le=$e);break}var ot=nt.slice(0,M),Lt=nt.slice(M);for(je=M;je<286;++je)ot[je]=0;for(je=B;je<30;++je)Lt[je]=0;return li=yi(ot,dr,286),Ja=yi(Lt,hr,30),G}function Lu(I,G){if(I[0]==3&&!(I[1]&3))return[Xo(G),2];for(var M=0,B=0,X=L_(G||1<<18),U=0,oe=X.length>>>0,fe=0,le=0;!(B&1);){if(B=xt(I,M),M+=3,B>>>1)B>>1==1?(fe=9,le=5):(M=Za(I,M),fe=li,le=Ja);else{M&7&&(M+=8-(M&7));var ce=I[M>>>3]|I[(M>>>3)+1]<<8;if(M+=32,ce>0)for(!G&&oe<U+ce&&(X=vi(X,U+ce),oe=X.length);ce-- >0;)X[U++]=I[M>>>3],M+=8;continue}for(;;){!G&&oe<U+32767&&(X=vi(X,U+32767),oe=X.length);var ue=ar(I,M,fe),Ce=B>>>1==1?Qt[ue]:dr[ue];if(M+=Ce&15,Ce>>>=4,!(Ce>>>8&255))X[U++]=Ce;else{if(Ce==256)break;Ce-=257;var je=Ce<8?0:Ce-4>>2;je>5&&(je=0);var $e=U+ge[Ce];je>0&&($e+=ar(I,M,je),M+=je),ue=ar(I,M,le),Ce=B>>>1==1?Sr[ue]:hr[ue],M+=Ce&15,Ce>>>=4;var Re=Ce<4?0:Ce-2>>1,Ge=Ee[Ce];for(Re>0&&(Ge+=ar(I,M,Re),M+=Re),!G&&oe<$e&&(X=vi(X,$e+100),oe=X.length);U<$e;)X[U]=X[U-Ge],++U}}}return G?[X,M+7>>>3]:[X.slice(0,U),M+7>>>3]}function xs(I,G){var M=I.slice(I.l||0),B=Lu(M,G);return I.l+=B[1],B[0]}function ol(I,G){if(I)typeof console<"u"&&console.error(G);else throw new Error(G)}function vs(I,G){var M=I;Dn(M,0);var B=[],X=[],U={FileIndex:B,FullPaths:X};S(U,{root:G.root});for(var oe=M.length-4;(M[oe]!=80||M[oe+1]!=75||M[oe+2]!=5||M[oe+3]!=6)&&oe>=0;)--oe;M.l=oe+4,M.l+=4;var fe=M.read_shift(2);M.l+=6;var le=M.read_shift(4);for(M.l=le,oe=0;oe<fe;++oe){M.l+=20;var ce=M.read_shift(4),ue=M.read_shift(4),Ce=M.read_shift(2),je=M.read_shift(2),$e=M.read_shift(2);M.l+=8;var Re=M.read_shift(4),Ge=o(M.slice(M.l+Ce,M.l+Ce+je));M.l+=Ce+je+$e;var nt=M.l;M.l=Re+4,ae(M,ce,ue,U,Ge),M.l=nt}return U}function ae(I,G,M,B,X){I.l+=2;var U=I.read_shift(2),oe=I.read_shift(2),fe=a(I);if(U&8257)throw new Error("Unsupported ZIP encryption");for(var le=I.read_shift(4),ce=I.read_shift(4),ue=I.read_shift(4),Ce=I.read_shift(2),je=I.read_shift(2),$e="",Re=0;Re<Ce;++Re)$e+=String.fromCharCode(I[I.l++]);if(je){var Ge=o(I.slice(I.l,I.l+je));(Ge[21589]||{}).mt&&(fe=Ge[21589].mt),((X||{})[21589]||{}).mt&&(fe=X[21589].mt)}I.l+=je;var nt=I.slice(I.l,I.l+ce);switch(oe){case 8:nt=ne(I,ue);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+oe)}var ot=!1;U&8&&(le=I.read_shift(4),le==134695760&&(le=I.read_shift(4),ot=!0),ce=I.read_shift(4),ue=I.read_shift(4)),ce!=G&&ol(ot,"Bad compressed size: "+G+" != "+ce),ue!=M&&ol(ot,"Bad uncompressed size: "+M+" != "+ue),ys(B,$e,nt,{unsafe:!0,mt:fe})}function br(I,G){var M=G||{},B=[],X=[],U=ve(1),oe=M.compression?8:0,fe=0,le=0,ce=0,ue=0,Ce=0,je=I.FullPaths[0],$e=je,Re=I.FileIndex[0],Ge=[],nt=0;for(le=1;le<I.FullPaths.length;++le)if($e=I.FullPaths[le].slice(je.length),Re=I.FileIndex[le],!(!Re.size||!Re.content||$e=="Sh33tJ5")){var ot=ue,Lt=ve($e.length);for(ce=0;ce<$e.length;++ce)Lt.write_shift(1,$e.charCodeAt(ce)&127);Lt=Lt.slice(0,Lt.l),Ge[Ce]=$R.buf(Re.content,0);var kt=Re.content;oe==8&&(kt=te(kt)),U=ve(30),U.write_shift(4,67324752),U.write_shift(2,20),U.write_shift(2,fe),U.write_shift(2,oe),Re.mt?s(U,Re.mt):U.write_shift(4,0),U.write_shift(-4,Ge[Ce]),U.write_shift(4,kt.length),U.write_shift(4,Re.content.length),U.write_shift(2,Lt.length),U.write_shift(2,0),ue+=U.length,B.push(U),ue+=Lt.length,B.push(Lt),ue+=kt.length,B.push(kt),U=ve(46),U.write_shift(4,33639248),U.write_shift(2,0),U.write_shift(2,20),U.write_shift(2,fe),U.write_shift(2,oe),U.write_shift(4,0),U.write_shift(-4,Ge[Ce]),U.write_shift(4,kt.length),U.write_shift(4,Re.content.length),U.write_shift(2,Lt.length),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(4,0),U.write_shift(4,ot),nt+=U.l,X.push(U),nt+=Lt.length,X.push(Lt),++Ce}return U=ve(22),U.write_shift(4,101010256),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(2,Ce),U.write_shift(2,Ce),U.write_shift(4,nt),U.write_shift(4,ue),U.write_shift(2,0),kn([kn(B),kn(X),U])}var _i={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Qi(I,G){if(I.ctype)return I.ctype;var M=I.name||"",B=M.match(/\.([^\.]+)$/);return B&&_i[B[1]]||G&&(B=(M=G).match(/[\.\\]([^\.\\])+$/),B&&_i[B[1]])?_i[B[1]]:"application/octet-stream"}function ma(I){for(var G=nd(I),M=[],B=0;B<G.length;B+=76)M.push(G.slice(B,B+76));return M.join(`\r
`)+`\r
`}function Us(I){var G=I.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ce){var ue=ce.charCodeAt(0).toString(16).toUpperCase();return"="+(ue.length==1?"0"+ue:ue)});G=G.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),G.charAt(0)==`
`&&(G="=0D"+G.slice(1)),G=G.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var M=[],B=G.split(`\r
`),X=0;X<B.length;++X){var U=B[X];if(U.length==0){M.push("");continue}for(var oe=0;oe<U.length;){var fe=76,le=U.slice(oe,oe+fe);le.charAt(fe-1)=="="?fe--:le.charAt(fe-2)=="="?fe-=2:le.charAt(fe-3)=="="&&(fe-=3),le=U.slice(oe,oe+fe),oe+=fe,oe<U.length&&(le+="="),M.push(le)}}return M.join(`\r
`)}function zs(I){for(var G=[],M=0;M<I.length;++M){for(var B=I[M];M<=I.length&&B.charAt(B.length-1)=="=";)B=B.slice(0,B.length-1)+I[++M];G.push(B)}for(var X=0;X<G.length;++X)G[X]=G[X].replace(/[=][0-9A-Fa-f]{2}/g,function(U){return String.fromCharCode(parseInt(U.slice(1),16))});return Ui(G.join(`\r
`))}function Ei(I,G,M){for(var B="",X="",U="",oe,fe=0;fe<10;++fe){var le=G[fe];if(!le||le.match(/^\s*$/))break;var ce=le.match(/^(.*?):\s*([^\s].*)$/);if(ce)switch(ce[1].toLowerCase()){case"content-location":B=ce[2].trim();break;case"content-type":U=ce[2].trim();break;case"content-transfer-encoding":X=ce[2].trim();break}}switch(++fe,X.toLowerCase()){case"base64":oe=Ui(Ki(G.slice(fe).join("")));break;case"quoted-printable":oe=zs(G.slice(fe));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+X)}var ue=ys(I,B.slice(M.length),oe,{unsafe:!0});U&&(ue.ctype=U)}function an(I,G){if(re(I.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var M=G&&G.root||"",B=(Tt&&Buffer.isBuffer(I)?I.toString("binary"):re(I)).split(`\r
`),X=0,U="";for(X=0;X<B.length;++X)if(U=B[X],!!/^Content-Location:/i.test(U)&&(U=U.slice(U.indexOf("file")),M||(M=U.slice(0,U.lastIndexOf("/")+1)),U.slice(0,M.length)!=M))for(;M.length>0&&(M=M.slice(0,M.length-1),M=M.slice(0,M.lastIndexOf("/")+1),U.slice(0,M.length)!=M););var oe=(B[1]||"").match(/boundary="(.*?)"/);if(!oe)throw new Error("MAD cannot find boundary");var fe="--"+(oe[1]||""),le=[],ce=[],ue={FileIndex:le,FullPaths:ce};S(ue);var Ce,je=0;for(X=0;X<B.length;++X){var $e=B[X];$e!==fe&&$e!==fe+"--"||(je++&&Ei(ue,B.slice(Ce,X),M),Ce=X)}return ue}function Yr(I,G){var M=G||{},B=M.boundary||"SheetJS";B="------="+B;for(var X=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+B.slice(2)+'"',"","",""],U=I.FullPaths[0],oe=U,fe=I.FileIndex[0],le=1;le<I.FullPaths.length;++le)if(oe=I.FullPaths[le].slice(U.length),fe=I.FileIndex[le],!(!fe.size||!fe.content||oe=="Sh33tJ5")){oe=oe.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(nt){return"_x"+nt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(nt){return"_u"+nt.charCodeAt(0).toString(16)+"_"});for(var ce=fe.content,ue=Tt&&Buffer.isBuffer(ce)?ce.toString("binary"):re(ce),Ce=0,je=Math.min(1024,ue.length),$e=0,Re=0;Re<=je;++Re)($e=ue.charCodeAt(Re))>=32&&$e<128&&++Ce;var Ge=Ce>=je*4/5;X.push(B),X.push("Content-Location: "+(M.root||"file:///C:/SheetJS/")+oe),X.push("Content-Transfer-Encoding: "+(Ge?"quoted-printable":"base64")),X.push("Content-Type: "+Qi(fe,oe)),X.push(""),X.push(Ge?Us(ue):ma(ue))}return X.push(B+`--\r
`),X.join(`\r
`)}function xa(I){var G={};return S(G,I),G}function ys(I,G,M,B){var X=B&&B.unsafe;X||S(I);var U=!X&&Ze.find(I,G);if(!U){var oe=I.FullPaths[0];G.slice(0,oe.length)==oe?oe=G:(oe.slice(-1)!="/"&&(oe+="/"),oe=(oe+G).replace("//","/")),U={name:i(G),type:2},I.FileIndex.push(U),I.FullPaths.push(oe),X||Ze.utils.cfb_gc(I)}return U.content=M,U.size=M?M.length:0,B&&(B.CLSID&&(U.clsid=B.CLSID),B.mt&&(U.mt=B.mt),B.ct&&(U.ct=B.ct)),U}function on(I,G){S(I);var M=Ze.find(I,G);if(M){for(var B=0;B<I.FileIndex.length;++B)if(I.FileIndex[B]==M)return I.FileIndex.splice(B,1),I.FullPaths.splice(B,1),!0}return!1}function cc(I,G,M){S(I);var B=Ze.find(I,G);if(B){for(var X=0;X<I.FileIndex.length;++X)if(I.FileIndex[X]==B)return I.FileIndex[X].name=i(M),I.FullPaths[X]=M,!0}return!1}function Ws(I){w(I,!0)}return e.find=N,e.read=V,e.parse=d,e.write=Ae,e.writeFile=we,e.utils={cfb_new:xa,cfb_add:ys,cfb_del:on,cfb_mov:cc,cfb_gc:Ws,ReadShift:kf,CheckField:nA,prep_blob:Dn,bconcat:kn,use_zlib:z,_deflateRaw:ct,_inflateRaw:xs,consts:De},e}();function GR(t){return typeof t=="string"?Dp(t):Array.isArray(t)?vR(t):t}function Rd(t,e,r){if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=Dp(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var n=r=="utf8"?sa(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var i=new Blob([GR(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,t);if(typeof saveAs<"u")return saveAs(i,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:t,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=t,a.href=s,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(t);return o.open("w"),o.encoding="binary",Array.isArray(e)&&(e=il(e)),o.write(e),o.close(),e}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+t)}function KR(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function Mr(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function $_(t,e){for(var r=[],n=Mr(t),i=0;i!==n.length;++i)r[t[n[i]][e]]==null&&(r[t[n[i]][e]]=n[i]);return r}function Op(t){for(var e=[],r=Mr(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}function Mp(t){for(var e=[],r=Mr(t),n=0;n!==r.length;++n)e[t[r[n]]]=parseInt(r[n],10);return e}function XR(t){for(var e=[],r=Mr(t),n=0;n!==r.length;++n)e[t[r[n]]]==null&&(e[t[r[n]]]=[]),e[t[r[n]]].push(r[n]);return e}var $h=new Date(1899,11,30,0,0,0);function vn(t,e){var r=t.getTime(),n=$h.getTime()+(t.getTimezoneOffset()-$h.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var MT=new Date,YR=$h.getTime()+(MT.getTimezoneOffset()-$h.getTimezoneOffset())*6e4,G_=MT.getTimezoneOffset();function Lp(t){var e=new Date;return e.setTime(t*24*60*60*1e3+YR),e.getTimezoneOffset()!==G_&&e.setTime(e.getTime()+(e.getTimezoneOffset()-G_)*6e4),e}function qR(t){var e=0,r=0,n=!1,i=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var s=1;s!=i.length;++s)if(i[s]){switch(r=1,s>3&&(n=!0),i[s].slice(i[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[s].slice(i[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(i[s],10)}return e}var K_=new Date("2017-02-19T19:06:09.000Z"),LT=isNaN(K_.getFullYear())?new Date("2/19/17"):K_,QR=LT.getFullYear()==2017;function xr(t,e){var r=new Date(t);if(QR)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(LT.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=t.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return t.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function Wl(t,e){if(Tt&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return sa(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return sa(TT(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return sa(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return sa(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],i=0;i!=t.length;++i)n.push(String.fromCharCode(t[i]));return n.join("")}function vr(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=vr(t[r]));return e}function Dr(t,e){for(var r="";r.length<e;)r+=t;return r}function Ls(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return r=-r,s}),!isNaN(e=Number(n)))?e/r:e}var JR=["january","february","march","april","may","june","july","august","september","october","november","december"];function du(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),i=e.getMonth(),s=e.getDate();if(isNaN(s))return r;var a=t.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&JR.indexOf(a)==-1)return r}else if(a.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||s>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var ZR=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(t||typeof n=="string")return r.split(n);for(var s=r.split(n),a=[s[0]],o=1;o<s.length;++o)a.push(i),a.push(s[o]);return a}}();function BT(t){return t?t.content&&t.type?Wl(t.content,!0):t.data?uf(t.data):t.asNodeBuffer&&Tt?uf(t.asNodeBuffer().toString("binary")):t.asBinary?uf(t.asBinary()):t._data&&t._data.getContent?uf(Wl(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function jT(t){if(!t)return null;if(t.data)return O_(t.data);if(t.asNodeBuffer&&Tt)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?O_(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function eN(t){return t&&t.name.slice(-4)===".bin"?jT(t):BT(t)}function ss(t,e){for(var r=t.FullPaths||Mr(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var a=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==a||i==a)return t.files?t.files[r[s]]:t.FileIndex[s]}return null}function M1(t,e){var r=ss(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function tn(t,e,r){if(!r)return eN(M1(t,e));if(!e)return null;try{return tn(t,e)}catch{return null}}function zi(t,e,r){if(!r)return BT(M1(t,e));if(!e)return null;try{return zi(t,e)}catch{return null}}function tN(t,e,r){return jT(M1(t,e))}function X_(t){for(var e=t.FullPaths||Mr(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function wt(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return Tt?n=Xa(r):n=yR(r),Ze.utils.cfb_add(t,e,n)}Ze.utils.cfb_add(t,e,r)}else t.file(e,r)}function L1(){return Ze.utils.cfb_new()}function VT(t,e){switch(e.type){case"base64":return Ze.read(t,{type:"base64"});case"binary":return Ze.read(t,{type:"binary"});case"buffer":case"array":return Ze.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function df(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var Xr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,rN=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Y_=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,nN=/<[^>]*>/g,ai=Xr.match(Y_)?Y_:nN,iN=/<\w*:/,sN=/<(\/?)\w+:/;function lt(t,e,r){for(var n={},i=0,s=0;i!==t.length&&!((s=t.charCodeAt(i))===32||s===10||s===13);++i);if(e||(n[0]=t.slice(0,i)),i===t.length)return n;var a=t.match(rN),o=0,l="",c=0,d="",h="",g=1;if(a)for(c=0;c!=a.length;++c){for(h=a[c],s=0;s!=h.length&&h.charCodeAt(s)!==61;++s);for(d=h.slice(0,s).trim();h.charCodeAt(s+1)==32;)++s;for(g=(i=h.charCodeAt(s+1))==34||i==39?1:0,l=h.slice(s+1+g,h.length-g),o=0;o!=d.length&&d.charCodeAt(o)!==58;++o);if(o===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),n[d]=l,n[d.toLowerCase()]=l;else{var m=(o===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(o+1);if(n[m]&&d.slice(o-3,o)=="ext")continue;n[m]=l,n[m.toLowerCase()]=l}}return n}function pa(t){return t.replace(sN,"<$1")}var UT={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},B1=Op(UT),zt=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",s=i.indexOf("<![CDATA[");if(s==-1)return i.replace(t,function(o,l){return UT[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(e,function(o,l){return String.fromCharCode(parseInt(l,16))});var a=i.indexOf("]]>");return r(i.slice(0,s))+i.slice(s+9,a)+r(i.slice(a+3))}}(),j1=/[&<>'"]/g,aN=/[\u0000-\u0008\u000b-\u001f]/g;function nr(t){var e=t+"";return e.replace(j1,function(r){return B1[r]}).replace(aN,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function q_(t){return nr(t).replace(/ /g,"_x0020_")}var zT=/[\u0000-\u001f]/g;function V1(t){var e=t+"";return e.replace(j1,function(r){return B1[r]}).replace(/\n/g,"<br/>").replace(zT,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function oN(t){var e=t+"";return e.replace(j1,function(r){return B1[r]}).replace(zT,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var Q_=function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}}();function lN(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function gr(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function bg(t){for(var e="",r=0,n=0,i=0,s=0,a=0,o=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(i=t.charCodeAt(r++),n>191&&n<224){a=(n&31)<<6,a|=i&63,e+=String.fromCharCode(a);continue}if(s=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}a=t.charCodeAt(r++),o=((n&7)<<18|(i&63)<<12|(s&63)<<6|a&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function J_(t){var e=Xo(2*t.length),r,n,i=1,s=0,a=0,o;for(n=0;n<t.length;n+=i)i=1,(o=t.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(t.charCodeAt(n+1)&63),i=2):o<240?(r=(o&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),i=3):(i=4,r=(o&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,a=55296+(r>>>10&1023),r=56320+(r&1023)),a!==0&&(e[s++]=a&255,e[s++]=a>>>8,a=0),e[s++]=r%256,e[s++]=r>>>8;return e.slice(0,s).toString("ucs2")}function Z_(t){return Xa(t,"binary").toString("utf8")}var F0="foo bar baz",or=Tt&&(Z_(F0)==bg(F0)&&Z_||J_(F0)==bg(F0)&&J_)||bg,sa=Tt?function(t){return Xa(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,i=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},sd=function(){var t={};return function(r,n){var i=r+"|"+(n||"");return t[i]?t[i]:t[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),WT=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<t.length;++i)n=n.replace(t[i][0],t[i][1]);return n}}(),cN=function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),uN=/<\/?(?:vt:)?variant>/g,fN=/<(?:vt:)([^>]*)>([\s\S]*)</;function e2(t,e){var r=lt(t),n=t.match(cN(r.baseType))||[],i=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(s){var a=s.replace(uN,"").match(fN);a&&i.push({v:or(a[2]),t:a[1]})}),i}var HT=/(^\s|\s$|\n)/;function Pn(t,e){return"<"+t+(e.match(HT)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function ad(t){return Mr(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function Be(t,e,r){return"<"+t+(r!=null?ad(r):"")+(e!=null?(e.match(HT)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function rx(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function dN(t,e){switch(typeof t){case"string":var r=Be("vt:lpwstr",nr(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Be((t|0)==t?"vt:i4":"vt:r8",nr(String(t)));case"boolean":return Be("vt:bool",t?"true":"false")}if(t instanceof Date)return Be("vt:filetime",rx(t));throw new Error("Unable to serialize "+t)}function U1(t){if(Tt&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return or(il(D1(t)));throw new Error("Bad input format: expected Buffer or string")}var od=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,pn={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},tc=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],ji={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function hN(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),i=t[e+6]&15,s=5;s>=0;--s)i=i*256+t[e+s];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function pN(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,i=0,s=0,a=n?-e:e;isFinite(a)?a==0?i=s=0:(i=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(e)?26985:0);for(var o=0;o<=5;++o,s/=256)t[r+o]=s&255;t[r+6]=(i&15)<<4|s&15,t[r+7]=i>>4|n}var t2=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var i=0,s=t[0][n].length;i<s;i+=r)e.push.apply(e,t[0][n].slice(i,i+r));return e},r2=Tt?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:Xa(e)})):t2(t)}:t2,n2=function(t,e,r){for(var n=[],i=e;i<r;i+=2)n.push(String.fromCharCode(Fa(t,i)));return n.join("").replace(pi,"")},z1=Tt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(pi,""):n2(t,e,r)}:n2,i2=function(t,e,r){for(var n=[],i=e;i<e+r;++i)n.push(("0"+t[i].toString(16)).slice(-2));return n.join("")},$T=Tt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):i2(t,e,r)}:i2,s2=function(t,e,r){for(var n=[],i=e;i<r;i++)n.push(String.fromCharCode(kc(t,i)));return n.join("")},Nd=Tt?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):s2(e,r,n)}:s2,GT=function(t,e){var r=Vi(t,e);return r>0?Nd(t,e+4,e+4+r-1):""},KT=GT,XT=function(t,e){var r=Vi(t,e);return r>0?Nd(t,e+4,e+4+r-1):""},YT=XT,qT=function(t,e){var r=2*Vi(t,e);return r>0?Nd(t,e+4,e+4+r-1):""},QT=qT,JT=function(e,r){var n=Vi(e,r);return n>0?z1(e,r+4,r+4+n):""},ZT=JT,eA=function(t,e){var r=Vi(t,e);return r>0?Nd(t,e+4,e+4+r):""},tA=eA,rA=function(t,e){return hN(t,e)},Gh=rA,W1=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Tt&&(KT=function(e,r){if(!Buffer.isBuffer(e))return GT(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},YT=function(e,r){if(!Buffer.isBuffer(e))return XT(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},QT=function(e,r){if(!Buffer.isBuffer(e))return qT(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},ZT=function(e,r){if(!Buffer.isBuffer(e))return JT(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},tA=function(e,r){if(!Buffer.isBuffer(e))return eA(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},Gh=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):rA(e,r)},W1=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var kc=function(t,e){return t[e]},Fa=function(t,e){return t[e+1]*256+t[e]},gN=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},Vi=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},Sl=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},mN=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function kf(t,e){var r="",n,i,s=[],a,o,l,c;switch(e){case"dbcs":if(c=this.l,Tt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(l=0;l<t;++l)r+=String.fromCharCode(Fa(this,c)),c+=2;t*=2;break;case"utf8":r=Nd(this,this.l,this.l+t);break;case"utf16le":t*=2,r=z1(this,this.l,this.l+t);break;case"wstr":return kf.call(this,t,"dbcs");case"lpstr-ansi":r=KT(this,this.l),t=4+Vi(this,this.l);break;case"lpstr-cp":r=YT(this,this.l),t=4+Vi(this,this.l);break;case"lpwstr":r=QT(this,this.l),t=4+2*Vi(this,this.l);break;case"lpp4":t=4+Vi(this,this.l),r=ZT(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+Vi(this,this.l),r=tA(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(a=kc(this,this.l+t++))!==0;)s.push(C0(a));r=s.join("");break;case"_wstr":for(t=0,r="";(a=Fa(this,this.l+t))!==0;)s.push(C0(a)),t+=2;t+=2,r=s.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=kc(this,c),this.l=c+1,o=kf.call(this,t-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(C0(Fa(this,c))),c+=2}r=s.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,l=0;l!=t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=kc(this,c),this.l=c+1,o=kf.call(this,t-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(C0(kc(this,c))),c+=1}r=s.join("");break;default:switch(t){case 1:return n=kc(this,this.l),this.l++,n;case 2:return n=(e==="i"?gN:Fa)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(t>0?Sl:mN)(this,this.l),this.l+=4,n):(i=Vi(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return t==8?i=Gh(this,this.l):i=Gh([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;t=8;case 16:r=$T(this,this.l,t);break}}return this.l+=t,r}var xN=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},vN=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},yN=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function _N(t,e,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=e.length;++i)yN(this,e.charCodeAt(i),this.l+2*i);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;n=e.length}else if(r==="hex"){for(;i<t;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+t,this.length);for(i=0;i<Math.min(e.length,t);++i){var a=e.charCodeAt(i);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,xN(this,e,this.l);break;case 8:if(n=8,r==="f"){pN(this,e,this.l);break}case 16:break;case-4:n=4,vN(this,e,this.l);break}return this.l+=n,this}function nA(t,e){var r=$T(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function Dn(t,e){t.l=e,t.read_shift=kf,t.chk=nA,t.write_shift=_N}function ii(t,e){t.l+=e}function ve(t){var e=Xo(t);return Dn(e,0),e}function Ya(t,e,r){if(t){var n,i,s;Dn(t,t.l||0);for(var a=t.length,o=0,l=0;t.l<a;){o=t.read_shift(1),o&128&&(o=(o&127)+((t.read_shift(1)&127)<<7));var c=hd[o]||hd[65535];for(n=t.read_shift(1),s=n&127,i=1;i<4&&n&128;++i)s+=((n=t.read_shift(1))&127)<<7*i;l=t.l+s;var d=c.f&&c.f(t,s,r);if(t.l=l,e(d,c,o))return}}}function Ri(){var t=[],e=Tt?256:2048,r=function(c){var d=ve(c);return Dn(d,0),d},n=r(e),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},s=function(c){return n&&c<n.length-n.l?n:(i(),n=r(Math.max(c+1,e)))},a=function(){return i(),kn(t)},o=function(c){i(),n=c,n.l==null&&(n.l=n.length),s(e)};return{next:s,push:o,end:a,_bufs:t}}function Te(t,e,r,n){var i=+e,s;if(!isNaN(i)){n||(n=hd[i].p||(r||[]).length||0),s=1+(i>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var a=t.next(s);i<=127?a.write_shift(1,i):(a.write_shift(1,(i&127)+128),a.write_shift(1,i>>7));for(var o=0;o!=4;++o)if(n>=128)a.write_shift(1,(n&127)+128),n>>=7;else{a.write_shift(1,n);break}n>0&&W1(r)&&t.push(r)}}function Cf(t,e,r){var n=vr(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function a2(t,e,r){var n=vr(t);return n.s=Cf(n.s,e.s,r),n.e=Cf(n.e,e.s,r),n}function Ff(t,e){if(t.cRel&&t.c<0)for(t=vr(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=vr(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=at(t);return!t.cRel&&t.cRel!=null&&(r=SN(r)),!t.rRel&&t.rRel!=null&&(r=EN(r)),r}function Rg(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+Ar(t.s.c)+":"+(t.e.cRel?"":"$")+Ar(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+Kr(t.s.r)+":"+(t.e.rRel?"":"$")+Kr(t.e.r):Ff(t.s,e.biff)+":"+Ff(t.e,e.biff)}function H1(t){return parseInt(wN(t),10)-1}function Kr(t){return""+(t+1)}function EN(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function wN(t){return t.replace(/\$(\d+)$/,"$1")}function $1(t){for(var e=TN(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function Ar(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function SN(t){return t.replace(/^([A-Z])/,"$$$1")}function TN(t){return t.replace(/^\$([A-Z])/,"$1")}function AN(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function kr(t){for(var e=0,r=0,n=0;n<t.length;++n){var i=t.charCodeAt(n);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:e-1}}function at(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function Ni(t){var e=t.indexOf(":");return e==-1?{s:kr(t),e:kr(t)}:{s:kr(t.slice(0,e)),e:kr(t.slice(e+1))}}function Et(t,e){return typeof e>"u"||typeof e=="number"?Et(t.s,t.e):(typeof t!="string"&&(t=at(t)),typeof e!="string"&&(e=at(e)),t==e?t:t+":"+e)}function Wt(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,s=t.length;for(r=0;n<s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.s.c=--r,r=0;n<s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(e.s.r=--r,n===s||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.e.c=--r,r=0;n!=s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return e.e.r=--r,e}function o2(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=gs(t.z,r?vn(e):e)}catch{}try{return t.w=gs((t.XF||{}).numFmtId||(r?14:0),r?vn(e):e)}catch{return""+e}}function Ua(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?qa[t.v]||t.v:e==null?o2(t,t.v):o2(t,e))}function sl(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function iA(t,e,r){var n=r||{},i=t?Array.isArray(t):n.dense,s=t||(i?[]:{}),a=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?kr(n.origin):n.origin;a=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var d=Wt(s["!ref"]);c.s.c=d.s.c,c.s.r=d.s.r,c.e.c=Math.max(c.e.c,d.e.c),c.e.r=Math.max(c.e.r,d.e.r),a==-1&&(c.e.r=a=d.e.r+1)}for(var h=0;h!=e.length;++h)if(e[h]){if(!Array.isArray(e[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var g=0;g!=e[h].length;++g)if(!(typeof e[h][g]>"u")){var m={v:e[h][g]},y=a+h,x=o+g;if(c.s.r>y&&(c.s.r=y),c.s.c>x&&(c.s.c=x),c.e.r<y&&(c.e.r=y),c.e.c<x&&(c.e.c=x),e[h][g]&&typeof e[h][g]=="object"&&!Array.isArray(e[h][g])&&!(e[h][g]instanceof Date))m=e[h][g];else if(Array.isArray(m.v)&&(m.f=e[h][g][1],m.v=m.v[0]),m.v===null)if(m.f)m.t="n";else if(n.nullError)m.t="e",m.v=0;else if(n.sheetStubs)m.t="z";else continue;else typeof m.v=="number"?m.t="n":typeof m.v=="boolean"?m.t="b":m.v instanceof Date?(m.z=n.dateNF||st[14],n.cellDates?(m.t="d",m.w=gs(m.z,vn(m.v))):(m.t="n",m.v=vn(m.v),m.w=gs(m.z,m.v))):m.t="s";if(i)s[y]||(s[y]=[]),s[y][x]&&s[y][x].z&&(m.z=s[y][x].z),s[y][x]=m;else{var E=at({c:x,r:y});s[E]&&s[E].z&&(m.z=s[E].z),s[E]=m}}}return c.s.c<1e7&&(s["!ref"]=Et(c)),s}function Iu(t,e){return iA(null,t,e)}function kN(t){return t.read_shift(4,"i")}function Bs(t,e){return e||(e=ve(4)),e.write_shift(4,t),e}function ri(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function Cn(t,e){var r=!1;return e==null&&(r=!0,e=ve(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function CN(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function FN(t,e){return e||(e=ve(4)),e.write_shift(2,0),e.write_shift(2,0),e}function G1(t,e){var r=t.l,n=t.read_shift(1),i=ri(t),s=[],a={t:i,h:i};if(n&1){for(var o=t.read_shift(4),l=0;l!=o;++l)s.push(CN(t));a.r=s}else a.r=[{ich:0,ifnt:0}];return t.l=r+e,a}function IN(t,e){var r=!1;return e==null&&(r=!0,e=ve(15+4*t.t.length)),e.write_shift(1,0),Cn(t.t,e),r?e.slice(0,e.l):e}var bN=G1;function RN(t,e){var r=!1;return e==null&&(r=!0,e=ve(23+4*t.t.length)),e.write_shift(1,1),Cn(t.t,e),e.write_shift(4,1),FN({},e),r?e.slice(0,e.l):e}function ms(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function rc(t,e){return e==null&&(e=ve(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function nc(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function ic(t,e){return e==null&&(e=ve(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var NN=ri,sA=Cn;function K1(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function Kh(t,e){var r=!1;return e==null&&(r=!0,e=ve(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var DN=ri,nx=K1,X1=Kh;function Y1(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var i=n===0?Gh([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):Sl(e,0)>>2;return r?i/100:i}function aA(t,e){e==null&&(e=ve(4));var r=0,n=0,i=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?n=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(n=1,r=1),n)e.write_shift(-4,((r?i:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function oA(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function PN(t,e){return e||(e=ve(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var sc=oA,bu=PN;function ti(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function Hl(t,e){return(e||ve(8)).write_shift(8,t,"f")}function ON(t){var e={},r=t.read_shift(1),n=r>>>1,i=t.read_shift(1),s=t.read_shift(2,"i"),a=t.read_shift(1),o=t.read_shift(1),l=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=i;var c=Rl[i];c&&(e.rgb=cd(c));break;case 2:e.rgb=cd([a,o,l]);break;case 3:e.theme=i;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function Xh(t,e){if(e||(e=ve(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function MN(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function LN(t,e){e||(e=ve(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}function lA(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function BN(t){return lA(t,1)}function jN(t){return lA(t,2)}var q1=2,Ai=3,I0=11,l2=12,Yh=19,b0=64,VN=65,UN=71,zN=4108,WN=4126,Sn=80,cA=81,HN=[Sn,cA],ix={1:{n:"CodePage",t:q1},2:{n:"Category",t:Sn},3:{n:"PresentationFormat",t:Sn},4:{n:"ByteCount",t:Ai},5:{n:"LineCount",t:Ai},6:{n:"ParagraphCount",t:Ai},7:{n:"SlideCount",t:Ai},8:{n:"NoteCount",t:Ai},9:{n:"HiddenCount",t:Ai},10:{n:"MultimediaClipCount",t:Ai},11:{n:"ScaleCrop",t:I0},12:{n:"HeadingPairs",t:zN},13:{n:"TitlesOfParts",t:WN},14:{n:"Manager",t:Sn},15:{n:"Company",t:Sn},16:{n:"LinksUpToDate",t:I0},17:{n:"CharacterCount",t:Ai},19:{n:"SharedDoc",t:I0},22:{n:"HyperlinksChanged",t:I0},23:{n:"AppVersion",t:Ai,p:"version"},24:{n:"DigSig",t:VN},26:{n:"ContentType",t:Sn},27:{n:"ContentStatus",t:Sn},28:{n:"Language",t:Sn},29:{n:"Version",t:Sn},255:{},2147483648:{n:"Locale",t:Yh},2147483651:{n:"Behavior",t:Yh},1919054434:{}},sx={1:{n:"CodePage",t:q1},2:{n:"Title",t:Sn},3:{n:"Subject",t:Sn},4:{n:"Author",t:Sn},5:{n:"Keywords",t:Sn},6:{n:"Comments",t:Sn},7:{n:"Template",t:Sn},8:{n:"LastAuthor",t:Sn},9:{n:"RevNumber",t:Sn},10:{n:"EditTime",t:b0},11:{n:"LastPrinted",t:b0},12:{n:"CreatedDate",t:b0},13:{n:"ModifiedDate",t:b0},14:{n:"PageCount",t:Ai},15:{n:"WordCount",t:Ai},16:{n:"CharCount",t:Ai},17:{n:"Thumbnail",t:UN},18:{n:"Application",t:Sn},19:{n:"DocSecurity",t:Ai},255:{},2147483648:{n:"Locale",t:Yh},2147483651:{n:"Behavior",t:Yh},1919054434:{}},c2={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},$N=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function GN(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var KN=GN([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Rl=vr(KN),qa={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},uA={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},ax={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},R0={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Q1(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function XN(t){var e=Q1();if(!t||!t.match)return e;var r={};if((t.match(ai)||[]).forEach(function(n){var i=lt(n);switch(i[0].replace(iN,"<")){case"<?xml":break;case"<Types":e.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":e[ax[i.ContentType]]!==void 0&&e[ax[i.ContentType]].push(i.PartName);break}}),e.xmlns!==pn.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}function fA(t,e){var r=XR(ax),n=[],i;n[n.length]=Xr,n[n.length]=Be("Types",null,{xmlns:pn.CT,"xmlns:xsd":pn.xsd,"xmlns:xsi":pn.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return Be("Default",null,{Extension:l[0],ContentType:l[1]})}));var s=function(l){t[l]&&t[l].length>0&&(i=t[l][0],n[n.length]=Be("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:R0[l][e.bookType]||R0[l].xlsx}))},a=function(l){(t[l]||[]).forEach(function(c){n[n.length]=Be("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:R0[l][e.bookType]||R0[l].xlsx})})},o=function(l){(t[l]||[]).forEach(function(c){n[n.length]=Be("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:r[l][0]})})};return s("workbooks"),a("sheets"),a("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),a("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var At={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function ld(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function If(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(ai)||[]).forEach(function(i){var s=lt(i);if(s[0]==="<Relationship"){var a={};a.Type=s.Type,a.Target=s.Target,a.Id=s.Id,s.TargetMode&&(a.TargetMode=s.TargetMode);var o=s.TargetMode==="External"?s.Target:df(s.Target,e);r[o]=a,n[s.Id]=a}}),r["!id"]=n,r}function Jc(t){var e=[Xr,Be("Relationships",null,{xmlns:pn.RELS})];return Mr(t["!id"]).forEach(function(r){e[e.length]=Be("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function rr(t,e,r,n,i,s){if(i||(i={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,i.Id="rId"+e,i.Type=n,i.Target=r,[At.HLINK,At.XPATH,At.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),t["!id"][i.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][i.Id]=i,t[("/"+i.Target).replace("//","/")]=i,e}var YN="application/vnd.oasis.opendocument.spreadsheet";function qN(t,e){for(var r=U1(t),n,i;n=od.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=lt(n[0],!1),i.path=="/"&&i.type!==YN)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}function QN(t){var e=[Xr];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function u2(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function JN(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function ZN(t){var e=[Xr];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(u2(t[r][0],t[r][1])),e.push(JN("",t[r][0]));return e.push(u2("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function dA(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Uh.version+"</meta:generator></office:meta></office:document-meta>"}var ds=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],e3=function(){for(var t=new Array(ds.length),e=0;e<ds.length;++e){var r=ds[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function hA(t){var e={};t=or(t);for(var r=0;r<ds.length;++r){var n=ds[r],i=t.match(e3[r]);i!=null&&i.length>0&&(e[n[1]]=zt(i[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=xr(e[n[1]]))}return e}function Ng(t,e,r,n,i){i[t]!=null||e==null||e===""||(i[t]=e,e=nr(e),n[n.length]=r?Be(t,e,r):Pn(t,e))}function pA(t,e){var r=e||{},n=[Xr,Be("cp:coreProperties",null,{"xmlns:cp":pn.CORE_PROPS,"xmlns:dc":pn.dc,"xmlns:dcterms":pn.dcterms,"xmlns:dcmitype":pn.dcmitype,"xmlns:xsi":pn.xsi})],i={};if(!t&&!r.Props)return n.join("");t&&(t.CreatedDate!=null&&Ng("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:rx(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),t.ModifiedDate!=null&&Ng("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:rx(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var s=0;s!=ds.length;++s){var a=ds[s],o=r.Props&&r.Props[a[1]]!=null?r.Props[a[1]]:t?t[a[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&Ng(a[0],o,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Nl=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],gA=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function mA(t,e,r,n){var i=[];if(typeof t=="string")i=e2(t,n);else for(var s=0;s<t.length;++s)i=i.concat(t[s].map(function(d){return{v:d}}));var a=typeof e=="string"?e2(e,n).map(function(d){return d.v}):e,o=0,l=0;if(a.length>0)for(var c=0;c!==i.length;c+=2){switch(l=+i[c+1].v,i[c].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=a.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=l,r.DefinedNames=a.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=a.slice(o,o+l);break}o+=l}}function t3(t,e,r){var n={};return e||(e={}),t=or(t),Nl.forEach(function(i){var s=(t.match(sd(i[0]))||[])[1];switch(i[2]){case"string":s&&(e[i[1]]=zt(s));break;case"bool":e[i[1]]=s==="true";break;case"raw":var a=t.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));a&&a.length>0&&(n[i[1]]=a[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&mA(n.HeadingPairs,n.TitlesOfParts,e,r),e}function xA(t){var e=[],r=Be;return t||(t={}),t.Application="SheetJS",e[e.length]=Xr,e[e.length]=Be("Properties",null,{xmlns:pn.EXT_PROPS,"xmlns:vt":pn.vt}),Nl.forEach(function(n){if(t[n[1]]!==void 0){var i;switch(n[2]){case"string":i=nr(String(t[n[1]]));break;case"bool":i=t[n[1]]?"true":"false";break}i!==void 0&&(e[e.length]=r(n[0],i))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+nr(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var r3=/<[^>]+>[^<]*/g;function n3(t,e){var r={},n="",i=t.match(r3);if(i)for(var s=0;s!=i.length;++s){var a=i[s],o=lt(a);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=zt(o.name);break;case"</property>":n=null;break;default:if(a.indexOf("<vt:")===0){var l=a.split(">"),c=l[0].slice(4),d=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":r[n]=zt(d);break;case"bool":r[n]=gr(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(d);break;case"filetime":case"date":r[n]=xr(d);break;case"cy":case"error":r[n]=zt(d);break;default:if(c.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",a,c,l)}}else if(a.slice(0,2)!=="</"){if(e.WTF)throw new Error(a)}}}return r}function vA(t){var e=[Xr,Be("Properties",null,{xmlns:pn.CUST_PROPS,"xmlns:vt":pn.vt})];if(!t)return e.join("");var r=1;return Mr(t).forEach(function(i){++r,e[e.length]=Be("property",dN(t[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:nr(i)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var ox={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Dg;function i3(t,e,r){Dg||(Dg=Op(ox)),e=Dg[e]||e,t[e]=r}function s3(t,e){var r=[];return Mr(ox).map(function(n){for(var i=0;i<ds.length;++i)if(ds[i][1]==n)return ds[i];for(i=0;i<Nl.length;++i)if(Nl[i][1]==n)return Nl[i];throw n}).forEach(function(n){if(t[n[1]]!=null){var i=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:t[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(Pn(ox[n[1]]||n[1],i))}}),Be("DocumentProperties",r.join(""),{xmlns:ji.o})}function a3(t,e){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return t&&Mr(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)){for(var a=0;a<ds.length;++a)if(s==ds[a][1])return;for(a=0;a<Nl.length;++a)if(s==Nl[a][1])return;for(a=0;a<r.length;++a)if(s==r[a])return;var o=t[s],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),i.push(Be(q_(s),o,{"dt:dt":l}))}}),e&&Mr(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)&&!(t&&Object.prototype.hasOwnProperty.call(t,s))){var a=e[s],o="string";typeof a=="number"?(o="float",a=String(a)):a===!0||a===!1?(o="boolean",a=a?"1":"0"):a instanceof Date?(o="dateTime.tz",a=a.toISOString()):a=String(a),i.push(Be(q_(s),a,{"dt:dt":o}))}}),"<"+n+' xmlns="'+ji.o+'">'+i.join("")+"</"+n+">"}function J1(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function o3(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,n=r%Math.pow(2,32),i=(r-n)/Math.pow(2,32);n*=1e7,i*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),i+=s);var a=ve(8);return a.write_shift(4,n),a.write_shift(4,i),a}function yA(t,e,r){var n=t.l,i=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return i}function _A(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function EA(t,e,r){return e===31?_A(t):yA(t,e,r)}function lx(t,e,r){return EA(t,e,r===!1?0:4)}function l3(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return EA(t,e,0)}function c3(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var i=t.l;r[n]=t.read_shift(0,"lpwstr").replace(pi,""),t.l-i&2&&(t.l+=2)}return r}function u3(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(pi,"");return r}function f3(t){var e=t.l,r=qh(t,cA);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=qh(t,Ai);return[r,n]}function d3(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(f3(t));return r}function f2(t,e){for(var r=t.read_shift(4),n={},i=0;i!=r;++i){var s=t.read_shift(4),a=t.read_shift(4);n[s]=t.read_shift(a,e===1200?"utf16le":"utf8").replace(pi,"").replace(ff,"!"),e===1200&&a%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function wA(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function h3(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function qh(t,e,r){var n=t.read_shift(2),i,s=r||{};if(t.l+=2,e!==l2&&n!==e&&HN.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===l2?n:e){case 2:return i=t.read_shift(2,"i"),s.raw||(t.l+=2),i;case 3:return i=t.read_shift(4,"i"),i;case 11:return t.read_shift(4)!==0;case 19:return i=t.read_shift(4),i;case 30:return yA(t,n,4).replace(pi,"");case 31:return _A(t);case 64:return J1(t);case 65:return wA(t);case 71:return h3(t);case 80:return lx(t,n,!s.raw).replace(pi,"");case 81:return l3(t,n).replace(pi,"");case 4108:return d3(t);case 4126:case 4127:return n==4127?c3(t):u3(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function d2(t,e){var r=ve(4),n=ve(4);switch(r.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,e);break;case 5:n=ve(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=o3(e);break;case 31:case 80:for(n=ve(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return kn([r,n])}function h2(t,e){var r=t.l,n=t.read_shift(4),i=t.read_shift(4),s=[],a=0,o=0,l=-1,c={};for(a=0;a!=i;++a){var d=t.read_shift(4),h=t.read_shift(4);s[a]=[d,h+r]}s.sort(function(k,_){return k[1]-_[1]});var g={};for(a=0;a!=i;++a){if(t.l!==s[a][1]){var m=!0;if(a>0&&e)switch(e[s[a-1][0]].t){case 2:t.l+2===s[a][1]&&(t.l+=2,m=!1);break;case 80:t.l<=s[a][1]&&(t.l=s[a][1],m=!1);break;case 4108:t.l<=s[a][1]&&(t.l=s[a][1],m=!1);break}if((!e||a==0)&&t.l<=s[a][1]&&(m=!1,t.l=s[a][1]),m)throw new Error("Read Error: Expected address "+s[a][1]+" at "+t.l+" :"+a)}if(e){var y=e[s[a][0]];if(g[y.n]=qh(t,y.t,{raw:!0}),y.p==="version"&&(g[y.n]=String(g[y.n]>>16)+"."+("0000"+String(g[y.n]&65535)).slice(-4)),y.n=="CodePage")switch(g[y.n]){case 0:g[y.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Ns(o=g[y.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+g[y.n])}}else if(s[a][0]===1){if(o=g.CodePage=qh(t,q1),Ns(o),l!==-1){var x=t.l;t.l=s[l][1],c=f2(t,o),t.l=x}}else if(s[a][0]===0){if(o===0){l=a,t.l=s[a+1][1];continue}c=f2(t,o)}else{var E=c[s[a][0]],A;switch(t[t.l]){case 65:t.l+=4,A=wA(t);break;case 30:t.l+=4,A=lx(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,A=lx(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,A=t.read_shift(4,"i");break;case 19:t.l+=4,A=t.read_shift(4);break;case 5:t.l+=4,A=t.read_shift(8,"f");break;case 11:t.l+=4,A=Hr(t,4);break;case 64:t.l+=4,A=xr(J1(t));break;default:throw new Error("unparsed value: "+t[t.l])}g[E]=A}}return t.l=r+n,g}var SA=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function p3(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function p2(t,e,r){var n=ve(8),i=[],s=[],a=8,o=0,l=ve(8),c=ve(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),s.push(l),i.push(c),a+=8+l.length,!e){c=ve(8),c.write_shift(4,0),i.unshift(c);var d=[ve(4)];for(d[0].write_shift(4,t.length),o=0;o<t.length;++o){var h=t[o][0];for(l=ve(8+2*(h.length+1)+(h.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,h.length+1),l.write_shift(0,h,"dbcs");l.l!=l.length;)l.write_shift(1,0);d.push(l)}l=kn(d),s.unshift(l),a+=8+l.length}for(o=0;o<t.length;++o)if(!(e&&!e[t[o][0]])&&!(SA.indexOf(t[o][0])>-1||gA.indexOf(t[o][0])>-1)&&t[o][1]!=null){var g=t[o][1],m=0;if(e){m=+e[t[o][0]];var y=r[m];if(y.p=="version"&&typeof g=="string"){var x=g.split(".");g=(+x[0]<<16)+(+x[1]||0)}l=d2(y.t,g)}else{var E=p3(g);E==-1&&(E=31,g=String(g)),l=d2(E,g)}s.push(l),c=ve(8),c.write_shift(4,e?m:2+o),i.push(c),a+=8+l.length}var A=8*(s.length+1);for(o=0;o<s.length;++o)i[o].write_shift(4,A),A+=s[o].length;return n.write_shift(4,a),n.write_shift(4,s.length),kn([n].concat(i).concat(s))}function g2(t,e,r){var n=t.content;if(!n)return{};Dn(n,0);var i,s,a,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),d=n.read_shift(16);if(d!==Ze.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(s=n.read_shift(16),o=n.read_shift(4),i===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);i===2&&(a=n.read_shift(16),l=n.read_shift(4));var h=h2(n,e),g={SystemIdentifier:c};for(var m in h)g[m]=h[m];if(g.FMTID=s,i===1)return g;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var y;try{y=h2(n,null)}catch{}for(m in y)g[m]=y[m];return g.FMTID=[s,a],g}function m2(t,e,r,n,i,s){var a=ve(i?68:48),o=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,Ze.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,i?2:1),a.write_shift(16,e,"hex"),a.write_shift(4,i?68:48);var l=p2(t,r,n);if(o.push(l),i){var c=p2(i,null,null);a.write_shift(16,s,"hex"),a.write_shift(4,68+l.length),o.push(c)}return kn(o)}function mo(t,e){return t.read_shift(e),null}function g3(t,e){e||(e=ve(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function m3(t,e,r){for(var n=[],i=t.l+e;t.l<i;)n.push(r(t,i-t.l));if(i!==t.l)throw new Error("Slurp error");return n}function Hr(t,e){return t.read_shift(e)===1}function di(t,e){return e||(e=ve(2)),e.write_shift(2,+!!t),e}function rn(t){return t.read_shift(2,"u")}function as(t,e){return e||(e=ve(2)),e.write_shift(2,t),e}function TA(t,e){return m3(t,e,rn)}function x3(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function AA(t,e,r){return r||(r=ve(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function Dd(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=t.read_shift(1);s&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var a=n?t.read_shift(n,i):"";return a}function v3(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,i=r&8,s=1+(r&1),a=0,o,l={};i&&(a=t.read_shift(2)),n&&(o=t.read_shift(4));var c=s==2?"dbcs-cont":"sbcs-cont",d=e===0?"":t.read_shift(e,c);return i&&(t.l+=4*a),n&&(t.l+=o),l.t=d,i||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function y3(t){var e=t.t||"",r=ve(3);r.write_shift(2,e.length),r.write_shift(1,1);var n=ve(2*e.length);n.write_shift(2*e.length,e,"utf16le");var i=[r,n];return kn(i)}function $l(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var i=t.read_shift(1);return i===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function Pd(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):$l(t,n,r)}function ac(t,e,r){if(r.biff>5)return Pd(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function kA(t,e,r){return r||(r=ve(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function _3(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function E3(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var i=t.read_shift((n?e-24:e)>>1,"utf16le").replace(pi,"");return n&&(t.l+=24),i}function w3(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=t.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var s=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var a=t.read_shift(s>>1,"utf16le").replace(pi,"");return r+a}function S3(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return E3(t);case"0303000000000000c000000000000046":return w3(t);default:throw new Error("Unsupported Moniker "+r)}}function N0(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(pi,""):"";return r}function x2(t,e){e||(e=ve(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function T3(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=t.read_shift(2);t.l+=2;var s,a,o,l,c="",d,h;i&16&&(s=N0(t,r-t.l)),i&128&&(a=N0(t,r-t.l)),(i&257)===257&&(o=N0(t,r-t.l)),(i&257)===1&&(l=S3(t,r-t.l)),i&8&&(c=N0(t,r-t.l)),i&32&&(d=t.read_shift(16)),i&64&&(h=J1(t)),t.l=r;var g=a||o||l||"";g&&c&&(g+="#"+c),g||(g="#"+c),i&2&&g.charAt(0)=="/"&&g.charAt(1)!="/"&&(g="file://"+g);var m={Target:g};return d&&(m.guid=d),h&&(m.time=h),s&&(m.Tooltip=s),m}function A3(t){var e=ve(512),r=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),s=i>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}e.write_shift(4,2),e.write_shift(4,s);var a=[8,6815827,6619237,4849780,83];for(r=0;r<a.length;++r)e.write_shift(4,a[r]);if(s==28)n=n.slice(1),x2(n,e);else if(s&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<a.length;++r)e.write_shift(1,parseInt(a[r],16));var o=i>-1?n.slice(0,i):n;for(e.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)e.write_shift(2,o.charCodeAt(r));e.write_shift(2,0),s&8&&x2(i>-1?n.slice(i+1):"",e)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<a.length;++r)e.write_shift(1,parseInt(a[r],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(e.write_shift(2,l),e.write_shift(4,n.length-3*l+1),r=0;r<n.length-3*l;++r)e.write_shift(1,n.charCodeAt(r+3*l)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function CA(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),i=t.read_shift(1);return[e,r,n,i]}function FA(t,e){var r=CA(t);return r[3]=0,r}function ga(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function Gl(t,e,r,n){return n||(n=ve(6)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r||0),n}function k3(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function C3(t,e,r){return e===0?"":ac(t,e,r)}function F3(t,e,r){var n=r.biff>8?4:2,i=t.read_shift(n),s=t.read_shift(n,"i"),a=t.read_shift(n,"i");return[i,s,a]}function IA(t){var e=t.read_shift(2),r=Y1(t);return[e,r]}function I3(t,e,r){t.l+=4,e-=4;var n=t.l+e,i=Dd(t,e,r),s=t.read_shift(2);if(n-=t.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return t.l+=s,i}function Bp(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2);return{s:{c:n,r:e},e:{c:i,r}}}function bA(t,e){return e||(e=ve(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function RA(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),i=t.read_shift(1);return{s:{c:n,r:e},e:{c:i,r}}}var b3=RA;function NA(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function R3(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function N3(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function Kn(t){t.l+=2,t.l+=t.read_shift(2)}var D3={0:Kn,4:Kn,5:Kn,6:Kn,7:N3,8:Kn,9:Kn,10:Kn,11:Kn,12:Kn,13:R3,14:Kn,15:Kn,16:Kn,17:Kn,18:Kn,19:Kn,20:Kn,21:NA};function P3(t,e){for(var r=t.l+e,n=[];t.l<r;){var i=t.read_shift(2);t.l-=2;try{n.push(D3[i](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function D0(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function Z1(t,e,r){var n=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=ve(i);return s.write_shift(2,n),s.write_shift(2,e),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function O3(t,e){return e===0||t.read_shift(2),1200}function M3(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,i=ac(t,0,r);return t.read_shift(e+n-t.l),i}function L3(t,e){var r=!e||e.biff==8,n=ve(r?112:54);for(n.write_shift(e.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function B3(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function j3(t,e,r){var n=t.read_shift(4),i=t.read_shift(1)&3,s=t.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var a=Dd(t,0,r);return a.length===0&&(a="Sheet1"),{pos:n,hs:i,dt:s,name:a}}function V3(t,e){var r=!e||e.biff>=8?2:1,n=ve(8+r*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function U3(t,e){for(var r=t.l+e,n=t.read_shift(4),i=t.read_shift(4),s=[],a=0;a!=i&&t.l<r;++a)s.push(v3(t));return s.Count=n,s.Unique=i,s}function z3(t,e){var r=ve(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var n=[],i=0;i<t.length;++i)n[i]=y3(t[i]);var s=kn([r].concat(n));return s.parts=[r.length].concat(n.map(function(a){return a.length})),s}function W3(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function H3(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function $3(t){var e=k3(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function G3(t){return t.read_shift(2),t.read_shift(4)}function v2(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var i=t.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,i]}function K3(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2),l=t.read_shift(2),c=t.read_shift(2);return{Pos:[e,r],Dim:[n,i],Flags:s,CurTab:a,FirstTab:o,Selected:l,TabRatio:c}}function X3(){var t=ve(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function Y3(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function q3(t){var e=ve(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function Q3(){}function J3(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=Dd(t,0,r),n}function Z3(t,e){var r=t.name||"Arial",n=e&&e.biff==5,i=n?15+r.length:16+2*r.length,s=ve(i);return s.write_shift(2,t.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function eD(t){var e=ga(t);return e.isst=t.read_shift(4),e}function tD(t,e,r,n){var i=ve(10);return Gl(t,e,n,i),i.write_shift(4,r),i}function rD(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,i=ga(t);r.biff==2&&t.l++;var s=Pd(t,n-t.l,r);return i.val=s,i}function nD(t,e,r,n,i){var s=!i||i.biff==8,a=ve(8+ +s+(1+s)*r.length);return Gl(t,e,n,a),a.write_shift(2,r.length),s&&a.write_shift(1,1),a.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),a}function iD(t,e,r){var n=t.read_shift(2),i=ac(t,0,r);return[n,i]}function sD(t,e,r,n){var i=r&&r.biff==5;n||(n=ve(i?3+e.length:5+2*e.length)),n.write_shift(2,t),n.write_shift(i?1:2,e.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}var aD=ac;function y2(t,e,r){var n=t.l+e,i=r.biff==8||!r.biff?4:2,s=t.read_shift(i),a=t.read_shift(i),o=t.read_shift(2),l=t.read_shift(2);return t.l=n,{s:{r:s,c:o},e:{r:a,c:l}}}function oD(t,e){var r=e.biff==8||!e.biff?4:2,n=ve(2*r+6);return n.write_shift(r,t.s.r),n.write_shift(r,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function lD(t){var e=t.read_shift(2),r=t.read_shift(2),n=IA(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function cD(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),s=[];t.l<r;)s.push(IA(t));if(t.l!==r)throw new Error("MulRK read error");var a=t.read_shift(2);if(s.length!=a-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:a,rkrec:s}}function uD(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),s=[];t.l<r;)s.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var a=t.read_shift(2);if(s.length!=a-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:a,ixfe:s}}function fD(t,e,r,n){var i={},s=t.read_shift(4),a=t.read_shift(4),o=t.read_shift(4),l=t.read_shift(2);return i.patternType=$N[o>>26],n.cellStyles&&(i.alc=s&7,i.fWrap=s>>3&1,i.alcV=s>>4&7,i.fJustLast=s>>7&1,i.trot=s>>8&255,i.cIndent=s>>16&15,i.fShrinkToFit=s>>20&1,i.iReadOrder=s>>22&2,i.fAtrNum=s>>26&1,i.fAtrFnt=s>>27&1,i.fAtrAlc=s>>28&1,i.fAtrBdr=s>>29&1,i.fAtrPat=s>>30&1,i.fAtrProt=s>>31&1,i.dgLeft=a&15,i.dgRight=a>>4&15,i.dgTop=a>>8&15,i.dgBottom=a>>12&15,i.icvLeft=a>>16&127,i.icvRight=a>>23&127,i.grbitDiag=a>>30&3,i.icvTop=o&127,i.icvBottom=o>>7&127,i.icvDiag=o>>14&127,i.dgDiag=o>>21&15,i.icvFore=l&127,i.icvBack=l>>7&127,i.fsxButton=l>>14&1),i}function dD(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=fD(t,e,n.fStyle,r),n}function _2(t,e,r,n){var i=r&&r.biff==5;n||(n=ve(i?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,e<<4));var s=0;return t.numFmtId>0&&i&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function hD(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function pD(t){var e=ve(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function E2(t,e,r){var n=ga(t);(r.biff==2||e==9)&&++t.l;var i=x3(t);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function gD(t,e,r,n,i,s){var a=ve(8);return Gl(t,e,n,a),AA(r,s,a),a}function mD(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=ga(t),i=ti(t);return n.val=i,n}function xD(t,e,r,n){var i=ve(14);return Gl(t,e,n,i),Hl(r,i),i}var w2=C3;function vD(t,e,r){var n=t.l+e,i=t.read_shift(2),s=t.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,i];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var a=$l(t,s),o=[];n>t.l;)o.push(Pd(t));return[s,i,a,o]}function S2(t,e,r){var n=t.read_shift(2),i,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=I3(t,e-2,r)),s.body=i||t.read_shift(e-2),typeof i=="string"&&(s.Name=i),s}var yD=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function T2(t,e,r){var n=t.l+e,i=t.read_shift(2),s=t.read_shift(1),a=t.read_shift(1),o=t.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),l=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var c=$l(t,a,r);i&32&&(c=yD[c.charCodeAt(0)]);var d=n-t.l;r&&r.biff==2&&--d;var h=n==t.l||o===0||!(d>0)?[]:P5(t,d,r,o);return{chKey:s,Name:c,itab:l,rgce:h}}function DA(t,e,r){if(r.biff<8)return _D(t,e,r);for(var n=[],i=t.l+e,s=t.read_shift(r.biff>8?4:2);s--!==0;)n.push(F3(t,r.biff>8?12:6,r));if(t.l!=i)throw new Error("Bad ExternSheet: "+t.l+" != "+i);return n}function _D(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=Dd(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function ED(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),i=t.read_shift(2),s=$l(t,n,r),a=$l(t,i,r);return[s,a]}function wD(t,e,r){var n=RA(t);t.l++;var i=t.read_shift(1);return e-=8,[O5(t,e,r),i,n]}function A2(t,e,r){var n=b3(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,N5(t,e,r)]}function SD(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function TD(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),o=ac(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:i},o,a,s]}}function AD(t,e,r){return TD(t,e,r)}function kD(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(Bp(t));return r}function CD(t){var e=ve(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)bA(t[r],e);return e}function FD(t,e,r){if(r&&r.biff<8)return bD(t,e,r);var n=NA(t),i=P3(t,e-22,n[1]);return{cmo:n,ft:i}}var ID={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var i=t.read_shift(1);return t.l+=i,t.l=r,{fmt:n}}};function bD(t,e,r){t.l+=4;var n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var a=[];return a.push((ID[n]||ii)(t,e,r)),{cmo:[i,n,s],ft:a}}function RD(t,e,r){var n=t.l,i="";try{t.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],a;[0,5,7,11,12,14].indexOf(s)==-1?t.l+=6:a=_3(t,6,r);var o=t.read_shift(2);t.read_shift(2),rn(t,2);var l=t.read_shift(2);t.l+=l;for(var c=1;c<t.lens.length-1;++c){if(t.l-n!=t.lens[c])throw new Error("TxO: bad continue record");var d=t[t.l],h=$l(t,t.lens[c+1]-t.lens[c]-1);if(i+=h,i.length>=(d?o:2*o))break}if(i.length!==o&&i.length!==o*2)throw new Error("cchText: "+o+" != "+i.length);return t.l=n+e,{t:i}}catch{return t.l=n+e,{t:i}}}function ND(t,e){var r=Bp(t);t.l+=16;var n=T3(t,e-24);return[r,n]}function DD(t){var e=ve(24),r=kr(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)e.write_shift(1,parseInt(n[i],16));return kn([e,A3(t[1])])}function PD(t,e){t.read_shift(2);var r=Bp(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(pi,""),[r,n]}function OD(t){var e=t[1].Tooltip,r=ve(10+2*(e.length+1));r.write_shift(2,2048);var n=kr(t[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<e.length;++i)r.write_shift(2,e.charCodeAt(i));return r.write_shift(2,0),r}function MD(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=c2[r]||r,r=t.read_shift(2),e[1]=c2[r]||r,e}function LD(t){return t||(t=ve(4)),t.write_shift(2,1),t.write_shift(2,1),t}function BD(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(FA(t));return r}function jD(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(FA(t));return r}function VD(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function PA(t,e,r){if(!r.cellStyles)return ii(t,e);var n=r&&r.biff>=12?4:2,i=t.read_shift(n),s=t.read_shift(n),a=t.read_shift(n),o=t.read_shift(n),l=t.read_shift(2);n==2&&(t.l+=2);var c={s:i,e:s,w:a,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function UD(t,e){var r=ve(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var n=0;return t.hidden&&(n|=1),r.write_shift(1,n),n=t.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function zD(t,e){var r={};return e<32||(t.l+=16,r.header=ti(t),r.footer=ti(t),t.l+=2),r}function WD(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var i=t.read_shift(1);return t.l+=3,i&16&&(n.area=!0),n}function HD(t){for(var e=ve(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}var $D=ga,GD=TA,KD=Pd;function XD(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,i}function YD(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=ga(t);++t.l;var i=ac(t,e-7,r);return n.t="str",n.val=i,n}function qD(t){var e=ga(t);++t.l;var r=ti(t);return e.t="n",e.val=r,e}function QD(t,e,r){var n=ve(15);return Bd(n,t,e),n.write_shift(8,r,"f"),n}function JD(t){var e=ga(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function ZD(t,e,r){var n=ve(9);return Bd(n,t,e),n.write_shift(2,r),n}function e6(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function t6(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function r6(t,e,r){var n=t.l+e,i=ga(t),s=t.read_shift(2),a=$l(t,s,r);return t.l=n,i.t="str",i.val=a,i}var n6=[2,3,48,49,131,139,140,245],cx=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=Op({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var c=[],d=Xo(1);switch(l.type){case"base64":d=Ui(Ki(o));break;case"binary":d=Ui(o);break;case"buffer":case"array":d=o;break}Dn(d,0);var h=d.read_shift(1),g=!!(h&136),m=!1,y=!1;switch(h){case 2:break;case 3:break;case 48:m=!0,g=!0;break;case 49:m=!0,g=!0;break;case 131:break;case 139:break;case 140:y=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var x=0,E=521;h==2&&(x=d.read_shift(2)),d.l+=3,h!=2&&(x=d.read_shift(4)),x>1048576&&(x=1e6),h!=2&&(E=d.read_shift(2));var A=d.read_shift(2),k=l.codepage||1252;h!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(k=t[d[d.l]]),d.l+=1,d.l+=2),y&&(d.l+=36);for(var _=[],P={},K=Math.min(d.length,h==2?521:E-10-(m?264:0)),V=y?32:11;d.l<K&&d[d.l]!=13;)switch(P={},P.name=rd.utils.decode(k,d.slice(d.l,d.l+V)).replace(/[\u0000\r\n].*$/g,""),d.l+=V,P.type=String.fromCharCode(d.read_shift(1)),h!=2&&!y&&(P.offset=d.read_shift(4)),P.len=d.read_shift(1),h==2&&(P.offset=d.read_shift(2)),P.dec=d.read_shift(1),P.name.length&&_.push(P),h!=2&&(d.l+=y?13:14),P.type){case"B":(!m||P.len!=8)&&l.WTF&&console.log("Skipping "+P.name+":"+P.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+P.name+":"+P.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+P.type)}if(d[d.l]!==13&&(d.l=E-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=E;var S=0,F=0;for(c[0]=[],F=0;F!=_.length;++F)c[0][F]=_[F].name;for(;x-- >0;){if(d[d.l]===42){d.l+=A;continue}for(++d.l,c[++S]=[],F=0,F=0;F!=_.length;++F){var w=d.slice(d.l,d.l+_[F].len);d.l+=_[F].len,Dn(w,0);var b=rd.utils.decode(k,w);switch(_[F].type){case"C":b.trim().length&&(c[S][F]=b.replace(/\s+$/,""));break;case"D":b.length===8?c[S][F]=new Date(+b.slice(0,4),+b.slice(4,6)-1,+b.slice(6,8)):c[S][F]=b;break;case"F":c[S][F]=parseFloat(b.trim());break;case"+":case"I":c[S][F]=y?w.read_shift(-4,"i")^2147483648:w.read_shift(4,"i");break;case"L":switch(b.trim().toUpperCase()){case"Y":case"T":c[S][F]=!0;break;case"N":case"F":c[S][F]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+b+"|")}break;case"M":if(!g)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));c[S][F]="##MEMO##"+(y?parseInt(b.trim(),10):w.read_shift(4));break;case"N":b=b.replace(/\u0000/g,"").trim(),b&&b!="."&&(c[S][F]=+b||0);break;case"@":c[S][F]=new Date(w.read_shift(-8,"f")-621356832e5);break;case"T":c[S][F]=new Date((w.read_shift(4)-2440588)*864e5+w.read_shift(4));break;case"Y":c[S][F]=w.read_shift(4,"i")/1e4+w.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[S][F]=-w.read_shift(-8,"f");break;case"B":if(m&&_[F].len==8){c[S][F]=w.read_shift(8,"f");break}case"G":case"P":w.l+=_[F].len;break;case"0":if(_[F].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+_[F].type)}}}if(h!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=_,c}function n(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var d=Iu(r(o,c),c);return d["!cols"]=c.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete c.DBF,d}function i(o,l){try{return sl(n(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,l){var c=l||{};if(+c.codepage>=0&&Ns(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var d=Ri(),h=Zh(o,{header:1,raw:!0,cellDates:!0}),g=h[0],m=h.slice(1),y=o["!cols"]||[],x=0,E=0,A=0,k=1;for(x=0;x<g.length;++x){if(((y[x]||{}).DBF||{}).name){g[x]=y[x].DBF.name,++A;continue}if(g[x]!=null){if(++A,typeof g[x]=="number"&&(g[x]=g[x].toString(10)),typeof g[x]!="string")throw new Error("DBF Invalid column name "+g[x]+" |"+typeof g[x]+"|");if(g.indexOf(g[x])!==x){for(E=0;E<1024;++E)if(g.indexOf(g[x]+"_"+E)==-1){g[x]+="_"+E;break}}}}var _=Wt(o["!ref"]),P=[],K=[],V=[];for(x=0;x<=_.e.c-_.s.c;++x){var S="",F="",w=0,b=[];for(E=0;E<m.length;++E)m[E][x]!=null&&b.push(m[E][x]);if(b.length==0||g[x]==null){P[x]="?";continue}for(E=0;E<b.length;++E){switch(typeof b[E]){case"number":F="B";break;case"string":F="C";break;case"boolean":F="L";break;case"object":F=b[E]instanceof Date?"D":"C";break;default:F="C"}w=Math.max(w,String(b[E]).length),S=S&&S!=F?"C":F}w>250&&(w=250),F=((y[x]||{}).DBF||{}).type,F=="C"&&y[x].DBF.len>w&&(w=y[x].DBF.len),S=="B"&&F=="N"&&(S="N",V[x]=y[x].DBF.dec,w=y[x].DBF.len),K[x]=S=="C"||F=="N"?w:s[S]||0,k+=K[x],P[x]=S}var N=d.next(32);for(N.write_shift(4,318902576),N.write_shift(4,m.length),N.write_shift(2,296+32*A),N.write_shift(2,k),x=0;x<4;++x)N.write_shift(4,0);for(N.write_shift(4,0|(+e[ST]||3)<<8),x=0,E=0;x<g.length;++x)if(g[x]!=null){var D=d.next(32),R=(g[x].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);D.write_shift(1,R,"sbcs"),D.write_shift(1,P[x]=="?"?"C":P[x],"sbcs"),D.write_shift(4,E),D.write_shift(1,K[x]||s[P[x]]||0),D.write_shift(1,V[x]||0),D.write_shift(1,2),D.write_shift(4,0),D.write_shift(1,0),D.write_shift(4,0),D.write_shift(4,0),E+=K[x]||s[P[x]]||0}var ze=d.next(264);for(ze.write_shift(4,13),x=0;x<65;++x)ze.write_shift(4,0);for(x=0;x<m.length;++x){var _e=d.next(k);for(_e.write_shift(1,0),E=0;E<g.length;++E)if(g[E]!=null)switch(P[E]){case"L":_e.write_shift(1,m[x][E]==null?63:m[x][E]?84:70);break;case"B":_e.write_shift(8,m[x][E]||0,"f");break;case"N":var Ie="0";for(typeof m[x][E]=="number"&&(Ie=m[x][E].toFixed(V[E]||0)),A=0;A<K[E]-Ie.length;++A)_e.write_shift(1,32);_e.write_shift(1,Ie,"sbcs");break;case"D":m[x][E]?(_e.write_shift(4,("0000"+m[x][E].getFullYear()).slice(-4),"sbcs"),_e.write_shift(2,("00"+(m[x][E].getMonth()+1)).slice(-2),"sbcs"),_e.write_shift(2,("00"+m[x][E].getDate()).slice(-2),"sbcs")):_e.write_shift(8,"00000000","sbcs");break;case"C":var De=String(m[x][E]!=null?m[x][E]:"").slice(0,K[E]);for(_e.write_shift(1,De,"sbcs"),A=0;A<K[E]-De.length;++A)_e.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:i,to_sheet:n,from_sheet:a}}(),OA=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Mr(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(g,m){var y=t[m];return typeof y=="number"?M_(y):y},n=function(g,m,y){var x=m.charCodeAt(0)-32<<4|y.charCodeAt(0)-48;return x==59?g:M_(x)};t["|"]=254;function i(g,m){switch(m.type){case"base64":return s(Ki(g),m);case"binary":return s(g,m);case"buffer":return s(Tt&&Buffer.isBuffer(g)?g.toString("binary"):il(g),m);case"array":return s(Wl(g),m)}throw new Error("Unrecognized type "+m.type)}function s(g,m){var y=g.split(/[\n\r]+/),x=-1,E=-1,A=0,k=0,_=[],P=[],K=null,V={},S=[],F=[],w=[],b=0,N;for(+m.codepage>=0&&Ns(+m.codepage);A!==y.length;++A){b=0;var D=y[A].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),R=D.replace(/;;/g,"\0").split(";").map(function(Y){return Y.replace(/\u0000/g,";")}),ze=R[0],_e;if(D.length>0)switch(ze){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":R[1].charAt(0)=="P"&&P.push(D.slice(3).replace(/;;/g,";"));break;case"C":var Ie=!1,De=!1,we=!1,re=!1,Ae=-1,Oe=-1;for(k=1;k<R.length;++k)switch(R[k].charAt(0)){case"A":break;case"X":E=parseInt(R[k].slice(1))-1,De=!0;break;case"Y":for(x=parseInt(R[k].slice(1))-1,De||(E=0),N=_.length;N<=x;++N)_[N]=[];break;case"K":_e=R[k].slice(1),_e.charAt(0)==='"'?_e=_e.slice(1,_e.length-1):_e==="TRUE"?_e=!0:_e==="FALSE"?_e=!1:isNaN(Ls(_e))?isNaN(du(_e).getDate())||(_e=xr(_e)):(_e=Ls(_e),K!==null&&Cu(K)&&(_e=Lp(_e))),Ie=!0;break;case"E":re=!0;var z=Zc(R[k].slice(1),{r:x,c:E});_[x][E]=[_[x][E],z];break;case"S":we=!0,_[x][E]=[_[x][E],"S5S"];break;case"G":break;case"R":Ae=parseInt(R[k].slice(1))-1;break;case"C":Oe=parseInt(R[k].slice(1))-1;break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+D)}if(Ie&&(_[x][E]&&_[x][E].length==2?_[x][E][0]=_e:_[x][E]=_e,K=null),we){if(re)throw new Error("SYLK shared formula cannot have own formula");var ne=Ae>-1&&_[Ae][Oe];if(!ne||!ne[1])throw new Error("SYLK shared formula cannot find base");_[x][E][1]=ZA(ne[1],{r:x-Ae,c:E-Oe})}break;case"F":var te=0;for(k=1;k<R.length;++k)switch(R[k].charAt(0)){case"X":E=parseInt(R[k].slice(1))-1,++te;break;case"Y":for(x=parseInt(R[k].slice(1))-1,N=_.length;N<=x;++N)_[N]=[];break;case"M":b=parseInt(R[k].slice(1))/20;break;case"F":break;case"G":break;case"P":K=P[parseInt(R[k].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(w=R[k].slice(1).split(" "),N=parseInt(w[0],10);N<=parseInt(w[1],10);++N)b=parseInt(w[2],10),F[N-1]=b===0?{hidden:!0}:{wch:b},Yo(F[N-1]);break;case"C":E=parseInt(R[k].slice(1))-1,F[E]||(F[E]={});break;case"R":x=parseInt(R[k].slice(1))-1,S[x]||(S[x]={}),b>0?(S[x].hpt=b,S[x].hpx=pu(b)):b===0&&(S[x].hidden=!0);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+D)}te<1&&(K=null);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+D)}}return S.length>0&&(V["!rows"]=S),F.length>0&&(V["!cols"]=F),m&&m.sheetRows&&(_=_.slice(0,m.sheetRows)),[_,V]}function a(g,m){var y=i(g,m),x=y[0],E=y[1],A=Iu(x,m);return Mr(E).forEach(function(k){A[k]=E[k]}),A}function o(g,m){return sl(a(g,m),m)}function l(g,m,y,x){var E="C;Y"+(y+1)+";X"+(x+1)+";K";switch(g.t){case"n":E+=g.v||0,g.f&&!g.F&&(E+=";E"+sv(g.f,{r:y,c:x}));break;case"b":E+=g.v?"TRUE":"FALSE";break;case"e":E+=g.w||g.v;break;case"d":E+='"'+(g.w||g.v)+'"';break;case"s":E+='"'+g.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return E}function c(g,m){m.forEach(function(y,x){var E="F;W"+(x+1)+" "+(x+1)+" ";y.hidden?E+="0":(typeof y.width=="number"&&!y.wpx&&(y.wpx=ud(y.width)),typeof y.wpx=="number"&&!y.wch&&(y.wch=fd(y.wpx)),typeof y.wch=="number"&&(E+=Math.round(y.wch))),E.charAt(E.length-1)!=" "&&g.push(E)})}function d(g,m){m.forEach(function(y,x){var E="F;";y.hidden?E+="M0;":y.hpt?E+="M"+20*y.hpt+";":y.hpx&&(E+="M"+20*dd(y.hpx)+";"),E.length>2&&g.push(E+"R"+(x+1))})}function h(g,m){var y=["ID;PWXL;N;E"],x=[],E=Wt(g["!ref"]),A,k=Array.isArray(g),_=`\r
`;y.push("P;PGeneral"),y.push("F;P0;DG0G8;M255"),g["!cols"]&&c(y,g["!cols"]),g["!rows"]&&d(y,g["!rows"]),y.push("B;Y"+(E.e.r-E.s.r+1)+";X"+(E.e.c-E.s.c+1)+";D"+[E.s.c,E.s.r,E.e.c,E.e.r].join(" "));for(var P=E.s.r;P<=E.e.r;++P)for(var K=E.s.c;K<=E.e.c;++K){var V=at({r:P,c:K});A=k?(g[P]||[])[K]:g[V],!(!A||A.v==null&&(!A.f||A.F))&&x.push(l(A,g,P,K))}return y.join(_)+_+x.join(_)+_+"E"+_}return{to_workbook:o,to_sheet:a,from_sheet:h}}(),MA=function(){function t(s,a){switch(a.type){case"base64":return e(Ki(s),a);case"binary":return e(s,a);case"buffer":return e(Tt&&Buffer.isBuffer(s)?s.toString("binary"):il(s),a);case"array":return e(Wl(s),a)}throw new Error("Unrecognized type "+a.type)}function e(s,a){for(var o=s.split(`
`),l=-1,c=-1,d=0,h=[];d!==o.length;++d){if(o[d].trim()==="BOT"){h[++l]=[],c=0;continue}if(!(l<0)){var g=o[d].trim().split(","),m=g[0],y=g[1];++d;for(var x=o[d]||"";(x.match(/["]/g)||[]).length&1&&d<o.length-1;)x+=`
`+o[++d];switch(x=x.trim(),+m){case-1:if(x==="BOT"){h[++l]=[],c=0;continue}else if(x!=="EOD")throw new Error("Unrecognized DIF special command "+x);break;case 0:x==="TRUE"?h[l][c]=!0:x==="FALSE"?h[l][c]=!1:isNaN(Ls(y))?isNaN(du(y).getDate())?h[l][c]=y:h[l][c]=xr(y):h[l][c]=Ls(y),++c;break;case 1:x=x.slice(1,x.length-1),x=x.replace(/""/g,'"'),x&&x.match(/^=".*"$/)&&(x=x.slice(2,-1)),h[l][c++]=x!==""?x:null;break}if(x==="EOD")break}}return a&&a.sheetRows&&(h=h.slice(0,a.sheetRows)),h}function r(s,a){return Iu(t(s,a),a)}function n(s,a){return sl(r(s,a),a)}var i=function(){var s=function(l,c,d,h,g){l.push(c),l.push(d+","+h),l.push('"'+g.replace(/"/g,'""')+'"')},a=function(l,c,d,h){l.push(c+","+d),l.push(c==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(l){var c=[],d=Wt(l["!ref"]),h,g=Array.isArray(l);s(c,"TABLE",0,1,"sheetjs"),s(c,"VECTORS",0,d.e.r-d.s.r+1,""),s(c,"TUPLES",0,d.e.c-d.s.c+1,""),s(c,"DATA",0,0,"");for(var m=d.s.r;m<=d.e.r;++m){a(c,-1,0,"BOT");for(var y=d.s.c;y<=d.e.c;++y){var x=at({r:m,c:y});if(h=g?(l[m]||[])[y]:l[x],!h){a(c,1,0,"");continue}switch(h.t){case"n":var E=h.w;!E&&h.v!=null&&(E=h.v),E==null?h.f&&!h.F?a(c,1,0,"="+h.f):a(c,1,0,""):a(c,0,E,"V");break;case"b":a(c,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":a(c,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=gs(h.z||st[14],vn(xr(h.v)))),a(c,0,h.w,"V");break;default:a(c,1,0,"")}}}a(c,-1,0,"EOD");var A=`\r
`,k=c.join(A);return k}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),LA=function(){function t(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(h,g){for(var m=h.split(`
`),y=-1,x=-1,E=0,A=[];E!==m.length;++E){var k=m[E].trim().split(":");if(k[0]==="cell"){var _=kr(k[1]);if(A.length<=_.r)for(y=A.length;y<=_.r;++y)A[y]||(A[y]=[]);switch(y=_.r,x=_.c,k[2]){case"t":A[y][x]=t(k[3]);break;case"v":A[y][x]=+k[3];break;case"vtf":var P=k[k.length-1];case"vtc":switch(k[3]){case"nl":A[y][x]=!!+k[4];break;default:A[y][x]=+k[4];break}k[2]=="vtf"&&(A[y][x]=[A[y][x],P])}}}return g&&g.sheetRows&&(A=A.slice(0,g.sheetRows)),A}function n(h,g){return Iu(r(h,g),g)}function i(h,g){return sl(n(h,g),g)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(h){if(!h||!h["!ref"])return"";for(var g=[],m=[],y,x="",E=Ni(h["!ref"]),A=Array.isArray(h),k=E.s.r;k<=E.e.r;++k)for(var _=E.s.c;_<=E.e.c;++_)if(x=at({r:k,c:_}),y=A?(h[k]||[])[_]:h[x],!(!y||y.v==null||y.t==="z")){switch(m=["cell",x,"t"],y.t){case"s":case"str":m.push(e(y.v));break;case"n":y.f?(m[2]="vtf",m[3]="n",m[4]=y.v,m[5]=e(y.f)):(m[2]="v",m[3]=y.v);break;case"b":m[2]="vt"+(y.f?"f":"c"),m[3]="nl",m[4]=y.v?"1":"0",m[5]=e(y.f||(y.v?"TRUE":"FALSE"));break;case"d":var P=vn(xr(y.v));m[2]="vtc",m[3]="nd",m[4]=""+P,m[5]=y.w||gs(y.z||st[14],P);break;case"e":continue}g.push(m.join(":"))}return g.push("sheet:c:"+(E.e.c-E.s.c+1)+":r:"+(E.e.r-E.s.r+1)+":tvf:1"),g.push("valueformat:1:text-wiki"),g.join(`
`)}function d(h){return[s,a,o,a,c(h),l].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:d}}(),hu=function(){function t(d,h,g,m,y){y.raw?h[g][m]=d:d===""||(d==="TRUE"?h[g][m]=!0:d==="FALSE"?h[g][m]=!1:isNaN(Ls(d))?isNaN(du(d).getDate())?h[g][m]=d:h[g][m]=xr(d):h[g][m]=Ls(d))}function e(d,h){var g=h||{},m=[];if(!d||d.length===0)return m;for(var y=d.split(/[\r\n]/),x=y.length-1;x>=0&&y[x].length===0;)--x;for(var E=10,A=0,k=0;k<=x;++k)A=y[k].indexOf(" "),A==-1?A=y[k].length:A++,E=Math.max(E,A);for(k=0;k<=x;++k){m[k]=[];var _=0;for(t(y[k].slice(0,E).trim(),m,k,_,g),_=1;_<=(y[k].length-E)/10+1;++_)t(y[k].slice(E+(_-1)*10,E+_*10).trim(),m,k,_,g)}return g.sheetRows&&(m=m.slice(0,g.sheetRows)),m}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(d){for(var h={},g=!1,m=0,y=0;m<d.length;++m)(y=d.charCodeAt(m))==34?g=!g:!g&&y in r&&(h[y]=(h[y]||0)+1);y=[];for(m in h)Object.prototype.hasOwnProperty.call(h,m)&&y.push([h[m],m]);if(!y.length){h=n;for(m in h)Object.prototype.hasOwnProperty.call(h,m)&&y.push([h[m],m])}return y.sort(function(x,E){return x[0]-E[0]||n[x[1]]-n[E[1]]}),r[y.pop()[1]]||44}function s(d,h){var g=h||{},m="",y=g.dense?[]:{},x={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(m=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(m=d.charAt(4),d=d.slice(6)):m=i(d.slice(0,1024)):g&&g.FS?m=g.FS:m=i(d.slice(0,1024));var E=0,A=0,k=0,_=0,P=0,K=m.charCodeAt(0),V=!1,S=0,F=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var w=g.dateNF!=null?WR(g.dateNF):null;function b(){var N=d.slice(_,P),D={};if(N.charAt(0)=='"'&&N.charAt(N.length-1)=='"'&&(N=N.slice(1,-1).replace(/""/g,'"')),N.length===0)D.t="z";else if(g.raw)D.t="s",D.v=N;else if(N.trim().length===0)D.t="s",D.v=N;else if(N.charCodeAt(0)==61)N.charCodeAt(1)==34&&N.charCodeAt(N.length-1)==34?(D.t="s",D.v=N.slice(2,-1).replace(/""/g,'"')):v8(N)?(D.t="n",D.f=N.slice(1)):(D.t="s",D.v=N);else if(N=="TRUE")D.t="b",D.v=!0;else if(N=="FALSE")D.t="b",D.v=!1;else if(!isNaN(k=Ls(N)))D.t="n",g.cellText!==!1&&(D.w=N),D.v=k;else if(!isNaN(du(N).getDate())||w&&N.match(w)){D.z=g.dateNF||st[14];var R=0;w&&N.match(w)&&(N=HR(N,g.dateNF,N.match(w)||[]),R=1),g.cellDates?(D.t="d",D.v=xr(N,R)):(D.t="n",D.v=vn(xr(N,R))),g.cellText!==!1&&(D.w=gs(D.z,D.v instanceof Date?vn(D.v):D.v)),g.cellNF||delete D.z}else D.t="s",D.v=N;if(D.t=="z"||(g.dense?(y[E]||(y[E]=[]),y[E][A]=D):y[at({c:A,r:E})]=D),_=P+1,F=d.charCodeAt(_),x.e.c<A&&(x.e.c=A),x.e.r<E&&(x.e.r=E),S==K)++A;else if(A=0,++E,g.sheetRows&&g.sheetRows<=E)return!0}e:for(;P<d.length;++P)switch(S=d.charCodeAt(P)){case 34:F===34&&(V=!V);break;case K:case 10:case 13:if(!V&&b())break e;break}return P-_>0&&b(),y["!ref"]=Et(x),y}function a(d,h){return!(h&&h.PRN)||h.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?s(d,h):Iu(e(d,h),h)}function o(d,h){var g="",m=h.type=="string"?[0,0,0,0]:hv(d,h);switch(h.type){case"base64":g=Ki(d);break;case"binary":g=d;break;case"buffer":h.codepage==65001?g=d.toString("utf8"):h.codepage&&typeof rd<"u"||(g=Tt&&Buffer.isBuffer(d)?d.toString("binary"):il(d));break;case"array":g=Wl(d);break;case"string":g=d;break;default:throw new Error("Unrecognized type "+h.type)}return m[0]==239&&m[1]==187&&m[2]==191?g=or(g.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?g=or(g):h.type=="binary"&&typeof rd<"u",g.slice(0,19)=="socialcalc:version:"?LA.to_sheet(h.type=="string"?g:or(g),h):a(g,h)}function l(d,h){return sl(o(d,h),h)}function c(d){for(var h=[],g=Wt(d["!ref"]),m,y=Array.isArray(d),x=g.s.r;x<=g.e.r;++x){for(var E=[],A=g.s.c;A<=g.e.c;++A){var k=at({r:x,c:A});if(m=y?(d[x]||[])[A]:d[k],!m||m.v==null){E.push("          ");continue}for(var _=(m.w||(Ua(m),m.w)||"").slice(0,10);_.length<10;)_+=" ";E.push(_+(A===0?" ":""))}h.push(E.join(""))}return h.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}}();function i6(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var i=OA.to_workbook(t,r);return r.WTF=n,i}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return hu.to_workbook(t,e)}}var Dl=function(){function t(z,ne,te){if(z){Dn(z,z.l||0);for(var Y=te.Enum||Ae;z.l<z.length;){var ge=z.read_shift(2),Ee=Y[ge]||Y[65535],Pe=z.read_shift(2),ke=z.l+Pe,Se=Ee.f&&Ee.f(z,Pe,te);if(z.l=ke,ne(Se,Ee,ge))return}}}function e(z,ne){switch(ne.type){case"base64":return r(Ui(Ki(z)),ne);case"binary":return r(Ui(z),ne);case"buffer":case"array":return r(z,ne)}throw"Unsupported type "+ne.type}function r(z,ne){if(!z)return z;var te=ne||{},Y=te.dense?[]:{},ge="Sheet1",Ee="",Pe=0,ke={},Se=[],tt=[],Q={s:{r:0,c:0},e:{r:0,c:0}},Rt=te.sheetRows||0;if(z[2]==0&&(z[3]==8||z[3]==9)&&z.length>=16&&z[14]==5&&z[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(z[2]==2)te.Enum=Ae,t(z,function(We,ar,In){switch(In){case 0:te.vers=We,We>=4096&&(te.qpro=!0);break;case 6:Q=We;break;case 204:We&&(Ee=We);break;case 222:Ee=We;break;case 15:case 51:te.qpro||(We[1].v=We[1].v.slice(1));case 13:case 14:case 16:In==14&&(We[2]&112)==112&&(We[2]&15)>1&&(We[2]&15)<15&&(We[1].z=te.dateNF||st[14],te.cellDates&&(We[1].t="d",We[1].v=Lp(We[1].v))),te.qpro&&We[3]>Pe&&(Y["!ref"]=Et(Q),ke[ge]=Y,Se.push(ge),Y=te.dense?[]:{},Q={s:{r:0,c:0},e:{r:0,c:0}},Pe=We[3],ge=Ee||"Sheet"+(Pe+1),Ee="");var sn=te.dense?(Y[We[0].r]||[])[We[0].c]:Y[at(We[0])];if(sn){sn.t=We[1].t,sn.v=We[1].v,We[1].z!=null&&(sn.z=We[1].z),We[1].f!=null&&(sn.f=We[1].f);break}te.dense?(Y[We[0].r]||(Y[We[0].r]=[]),Y[We[0].r][We[0].c]=We[1]):Y[at(We[0])]=We[1];break}},te);else if(z[2]==26||z[2]==14)te.Enum=Oe,z[2]==14&&(te.qpro=!0,z.l=0),t(z,function(We,ar,In){switch(In){case 204:ge=We;break;case 22:We[1].v=We[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(We[3]>Pe&&(Y["!ref"]=Et(Q),ke[ge]=Y,Se.push(ge),Y=te.dense?[]:{},Q={s:{r:0,c:0},e:{r:0,c:0}},Pe=We[3],ge="Sheet"+(Pe+1)),Rt>0&&We[0].r>=Rt)break;te.dense?(Y[We[0].r]||(Y[We[0].r]=[]),Y[We[0].r][We[0].c]=We[1]):Y[at(We[0])]=We[1],Q.e.c<We[0].c&&(Q.e.c=We[0].c),Q.e.r<We[0].r&&(Q.e.r=We[0].r);break;case 27:We[14e3]&&(tt[We[14e3][0]]=We[14e3][1]);break;case 1537:tt[We[0]]=We[1],We[0]==Pe&&(ge=We[1]);break}},te);else throw new Error("Unrecognized LOTUS BOF "+z[2]);if(Y["!ref"]=Et(Q),ke[Ee||ge]=Y,Se.push(Ee||ge),!tt.length)return{SheetNames:Se,Sheets:ke};for(var xt={},Ft=[],dt=0;dt<tt.length;++dt)ke[Se[dt]]?(Ft.push(tt[dt]||Se[dt]),xt[tt[dt]]=ke[tt[dt]]||ke[Se[dt]]):(Ft.push(tt[dt]),xt[tt[dt]]={"!ref":"A1"});return{SheetNames:Ft,Sheets:xt}}function n(z,ne){var te=ne||{};if(+te.codepage>=0&&Ns(+te.codepage),te.type=="string")throw new Error("Cannot write WK1 to JS string");var Y=Ri(),ge=Wt(z["!ref"]),Ee=Array.isArray(z),Pe=[];Ve(Y,0,s(1030)),Ve(Y,6,l(ge));for(var ke=Math.min(ge.e.r,8191),Se=ge.s.r;Se<=ke;++Se)for(var tt=Kr(Se),Q=ge.s.c;Q<=ge.e.c;++Q){Se===ge.s.r&&(Pe[Q]=Ar(Q));var Rt=Pe[Q]+tt,xt=Ee?(z[Se]||[])[Q]:z[Rt];if(!(!xt||xt.t=="z"))if(xt.t=="n")(xt.v|0)==xt.v&&xt.v>=-32768&&xt.v<=32767?Ve(Y,13,m(Se,Q,xt.v)):Ve(Y,14,x(Se,Q,xt.v));else{var Ft=Ua(xt);Ve(Y,15,h(Se,Q,Ft.slice(0,239)))}}return Ve(Y,1),Y.end()}function i(z,ne){var te=ne||{};if(+te.codepage>=0&&Ns(+te.codepage),te.type=="string")throw new Error("Cannot write WK3 to JS string");var Y=Ri();Ve(Y,0,a(z));for(var ge=0,Ee=0;ge<z.SheetNames.length;++ge)(z.Sheets[z.SheetNames[ge]]||{})["!ref"]&&Ve(Y,27,re(z.SheetNames[ge],Ee++));var Pe=0;for(ge=0;ge<z.SheetNames.length;++ge){var ke=z.Sheets[z.SheetNames[ge]];if(!(!ke||!ke["!ref"])){for(var Se=Wt(ke["!ref"]),tt=Array.isArray(ke),Q=[],Rt=Math.min(Se.e.r,8191),xt=Se.s.r;xt<=Rt;++xt)for(var Ft=Kr(xt),dt=Se.s.c;dt<=Se.e.c;++dt){xt===Se.s.r&&(Q[dt]=Ar(dt));var We=Q[dt]+Ft,ar=tt?(ke[xt]||[])[dt]:ke[We];if(!(!ar||ar.t=="z"))if(ar.t=="n")Ve(Y,23,b(xt,dt,Pe,ar.v));else{var In=Ua(ar);Ve(Y,22,S(xt,dt,Pe,In.slice(0,239)))}}++Pe}}return Ve(Y,1),Y.end()}function s(z){var ne=ve(2);return ne.write_shift(2,z),ne}function a(z){var ne=ve(26);ne.write_shift(2,4096),ne.write_shift(2,4),ne.write_shift(4,0);for(var te=0,Y=0,ge=0,Ee=0;Ee<z.SheetNames.length;++Ee){var Pe=z.SheetNames[Ee],ke=z.Sheets[Pe];if(!(!ke||!ke["!ref"])){++ge;var Se=Ni(ke["!ref"]);te<Se.e.r&&(te=Se.e.r),Y<Se.e.c&&(Y=Se.e.c)}}return te>8191&&(te=8191),ne.write_shift(2,te),ne.write_shift(1,ge),ne.write_shift(1,Y),ne.write_shift(2,0),ne.write_shift(2,0),ne.write_shift(1,1),ne.write_shift(1,2),ne.write_shift(4,0),ne.write_shift(4,0),ne}function o(z,ne,te){var Y={s:{c:0,r:0},e:{c:0,r:0}};return ne==8&&te.qpro?(Y.s.c=z.read_shift(1),z.l++,Y.s.r=z.read_shift(2),Y.e.c=z.read_shift(1),z.l++,Y.e.r=z.read_shift(2),Y):(Y.s.c=z.read_shift(2),Y.s.r=z.read_shift(2),ne==12&&te.qpro&&(z.l+=2),Y.e.c=z.read_shift(2),Y.e.r=z.read_shift(2),ne==12&&te.qpro&&(z.l+=2),Y.s.c==65535&&(Y.s.c=Y.e.c=Y.s.r=Y.e.r=0),Y)}function l(z){var ne=ve(8);return ne.write_shift(2,z.s.c),ne.write_shift(2,z.s.r),ne.write_shift(2,z.e.c),ne.write_shift(2,z.e.r),ne}function c(z,ne,te){var Y=[{c:0,r:0},{t:"n",v:0},0,0];return te.qpro&&te.vers!=20768?(Y[0].c=z.read_shift(1),Y[3]=z.read_shift(1),Y[0].r=z.read_shift(2),z.l+=2):(Y[2]=z.read_shift(1),Y[0].c=z.read_shift(2),Y[0].r=z.read_shift(2)),Y}function d(z,ne,te){var Y=z.l+ne,ge=c(z,ne,te);if(ge[1].t="s",te.vers==20768){z.l++;var Ee=z.read_shift(1);return ge[1].v=z.read_shift(Ee,"utf8"),ge}return te.qpro&&z.l++,ge[1].v=z.read_shift(Y-z.l,"cstr"),ge}function h(z,ne,te){var Y=ve(7+te.length);Y.write_shift(1,255),Y.write_shift(2,ne),Y.write_shift(2,z),Y.write_shift(1,39);for(var ge=0;ge<Y.length;++ge){var Ee=te.charCodeAt(ge);Y.write_shift(1,Ee>=128?95:Ee)}return Y.write_shift(1,0),Y}function g(z,ne,te){var Y=c(z,ne,te);return Y[1].v=z.read_shift(2,"i"),Y}function m(z,ne,te){var Y=ve(7);return Y.write_shift(1,255),Y.write_shift(2,ne),Y.write_shift(2,z),Y.write_shift(2,te,"i"),Y}function y(z,ne,te){var Y=c(z,ne,te);return Y[1].v=z.read_shift(8,"f"),Y}function x(z,ne,te){var Y=ve(13);return Y.write_shift(1,255),Y.write_shift(2,ne),Y.write_shift(2,z),Y.write_shift(8,te,"f"),Y}function E(z,ne,te){var Y=z.l+ne,ge=c(z,ne,te);if(ge[1].v=z.read_shift(8,"f"),te.qpro)z.l=Y;else{var Ee=z.read_shift(2);P(z.slice(z.l,z.l+Ee),ge),z.l+=Ee}return ge}function A(z,ne,te){var Y=ne&32768;return ne&=-32769,ne=(Y?z:0)+(ne>=8192?ne-16384:ne),(Y?"":"$")+(te?Ar(ne):Kr(ne))}var k={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},_=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function P(z,ne){Dn(z,0);for(var te=[],Y=0,ge="",Ee="",Pe="",ke="";z.l<z.length;){var Se=z[z.l++];switch(Se){case 0:te.push(z.read_shift(8,"f"));break;case 1:Ee=A(ne[0].c,z.read_shift(2),!0),ge=A(ne[0].r,z.read_shift(2),!1),te.push(Ee+ge);break;case 2:{var tt=A(ne[0].c,z.read_shift(2),!0),Q=A(ne[0].r,z.read_shift(2),!1);Ee=A(ne[0].c,z.read_shift(2),!0),ge=A(ne[0].r,z.read_shift(2),!1),te.push(tt+Q+":"+Ee+ge)}break;case 3:if(z.l<z.length){console.error("WK1 premature formula end");return}break;case 4:te.push("("+te.pop()+")");break;case 5:te.push(z.read_shift(2));break;case 6:{for(var Rt="";Se=z[z.l++];)Rt+=String.fromCharCode(Se);te.push('"'+Rt.replace(/"/g,'""')+'"')}break;case 8:te.push("-"+te.pop());break;case 23:te.push("+"+te.pop());break;case 22:te.push("NOT("+te.pop()+")");break;case 20:case 21:ke=te.pop(),Pe=te.pop(),te.push(["AND","OR"][Se-20]+"("+Pe+","+ke+")");break;default:if(Se<32&&_[Se])ke=te.pop(),Pe=te.pop(),te.push(Pe+_[Se]+ke);else if(k[Se]){if(Y=k[Se][1],Y==69&&(Y=z[z.l++]),Y>te.length){console.error("WK1 bad formula parse 0x"+Se.toString(16)+":|"+te.join("|")+"|");return}var xt=te.slice(-Y);te.length-=Y,te.push(k[Se][0]+"("+xt.join(",")+")")}else return Se<=7?console.error("WK1 invalid opcode "+Se.toString(16)):Se<=24?console.error("WK1 unsupported op "+Se.toString(16)):Se<=30?console.error("WK1 invalid opcode "+Se.toString(16)):Se<=115?console.error("WK1 unsupported function opcode "+Se.toString(16)):console.error("WK1 unrecognized opcode "+Se.toString(16))}}te.length==1?ne[1].f=""+te[0]:console.error("WK1 bad formula parse |"+te.join("|")+"|")}function K(z){var ne=[{c:0,r:0},{t:"n",v:0},0];return ne[0].r=z.read_shift(2),ne[3]=z[z.l++],ne[0].c=z[z.l++],ne}function V(z,ne){var te=K(z);return te[1].t="s",te[1].v=z.read_shift(ne-4,"cstr"),te}function S(z,ne,te,Y){var ge=ve(6+Y.length);ge.write_shift(2,z),ge.write_shift(1,te),ge.write_shift(1,ne),ge.write_shift(1,39);for(var Ee=0;Ee<Y.length;++Ee){var Pe=Y.charCodeAt(Ee);ge.write_shift(1,Pe>=128?95:Pe)}return ge.write_shift(1,0),ge}function F(z,ne){var te=K(z);te[1].v=z.read_shift(2);var Y=te[1].v>>1;if(te[1].v&1)switch(Y&7){case 0:Y=(Y>>3)*5e3;break;case 1:Y=(Y>>3)*500;break;case 2:Y=(Y>>3)/20;break;case 3:Y=(Y>>3)/200;break;case 4:Y=(Y>>3)/2e3;break;case 5:Y=(Y>>3)/2e4;break;case 6:Y=(Y>>3)/16;break;case 7:Y=(Y>>3)/64;break}return te[1].v=Y,te}function w(z,ne){var te=K(z),Y=z.read_shift(4),ge=z.read_shift(4),Ee=z.read_shift(2);if(Ee==65535)return Y===0&&ge===3221225472?(te[1].t="e",te[1].v=15):Y===0&&ge===3489660928?(te[1].t="e",te[1].v=42):te[1].v=0,te;var Pe=Ee&32768;return Ee=(Ee&32767)-16446,te[1].v=(1-Pe*2)*(ge*Math.pow(2,Ee+32)+Y*Math.pow(2,Ee)),te}function b(z,ne,te,Y){var ge=ve(14);if(ge.write_shift(2,z),ge.write_shift(1,te),ge.write_shift(1,ne),Y==0)return ge.write_shift(4,0),ge.write_shift(4,0),ge.write_shift(2,65535),ge;var Ee=0,Pe=0,ke=0,Se=0;return Y<0&&(Ee=1,Y=-Y),Pe=Math.log2(Y)|0,Y/=Math.pow(2,Pe-31),Se=Y>>>0,Se&2147483648||(Y/=2,++Pe,Se=Y>>>0),Y-=Se,Se|=2147483648,Se>>>=0,Y*=Math.pow(2,32),ke=Y>>>0,ge.write_shift(4,ke),ge.write_shift(4,Se),Pe+=16383+(Ee?32768:0),ge.write_shift(2,Pe),ge}function N(z,ne){var te=w(z);return z.l+=ne-14,te}function D(z,ne){var te=K(z),Y=z.read_shift(4);return te[1].v=Y>>6,te}function R(z,ne){var te=K(z),Y=z.read_shift(8,"f");return te[1].v=Y,te}function ze(z,ne){var te=R(z);return z.l+=ne-10,te}function _e(z,ne){return z[z.l+ne-1]==0?z.read_shift(ne,"cstr"):""}function Ie(z,ne){var te=z[z.l++];te>ne-1&&(te=ne-1);for(var Y="";Y.length<te;)Y+=String.fromCharCode(z[z.l++]);return Y}function De(z,ne,te){if(!(!te.qpro||ne<21)){var Y=z.read_shift(1);z.l+=17,z.l+=1,z.l+=2;var ge=z.read_shift(ne-21,"cstr");return[Y,ge]}}function we(z,ne){for(var te={},Y=z.l+ne;z.l<Y;){var ge=z.read_shift(2);if(ge==14e3){for(te[ge]=[0,""],te[ge][0]=z.read_shift(2);z[z.l];)te[ge][1]+=String.fromCharCode(z[z.l]),z.l++;z.l++}}return te}function re(z,ne){var te=ve(5+z.length);te.write_shift(2,14e3),te.write_shift(2,ne);for(var Y=0;Y<z.length;++Y){var ge=z.charCodeAt(Y);te[te.l++]=ge>127?95:ge}return te[te.l++]=0,te}var Ae={0:{n:"BOF",f:rn},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:g},14:{n:"NUMBER",f:y},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:E},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:_e},222:{n:"SHEETNAMELP",f:Ie},65535:{n:""}},Oe={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:V},23:{n:"NUMBER17",f:w},24:{n:"NUMBER18",f:F},25:{n:"FORMULA19",f:N},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:we},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:D},38:{n:"??"},39:{n:"NUMBER27",f:R},40:{n:"FORMULA28",f:ze},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:_e},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:De},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:e}}();function s6(t){var e={},r=t.match(ai),n=0,i=!1;if(r)for(;n!=r.length;++n){var s=lt(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;e.cp=b1[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=s.val;break;case"<sz":e.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":s.rgb&&(e.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+s[0])}}return e}var a6=function(){var t=sd("t"),e=sd("rPr");function r(s){var a=s.match(t);if(!a)return{t:"s",v:""};var o={t:"s",v:zt(a[1])},l=s.match(e);return l&&(o.s=s6(l[1])),o}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(a){return a.replace(n,"").split(i).map(r).filter(function(o){return o.v})}}(),o6=function(){var e=/(\r\n|\n)/g;function r(i,s,a){var o=[];i.u&&o.push("text-decoration: underline;"),i.uval&&o.push("text-underline-style:"+i.uval+";"),i.sz&&o.push("font-size:"+i.sz+"pt;"),i.outline&&o.push("text-effect: outline;"),i.shadow&&o.push("text-shadow: auto;"),s.push('<span style="'+o.join("")+'">'),i.b&&(s.push("<b>"),a.push("</b>")),i.i&&(s.push("<i>"),a.push("</i>")),i.strike&&(s.push("<s>"),a.push("</s>"));var l=i.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(s.push("<"+l+">"),a.push("</"+l+">")),a.push("</span>"),i}function n(i){var s=[[],i.v,[]];return i.v?(i.s&&r(i.s,s[0],s[2]),s[0].join("")+s[1].replace(e,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),l6=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,c6=/<(?:\w+:)?r>/,u6=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function ev(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=zt(or(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=or(t),r&&(n.h=V1(n.t))):t.match(c6)&&(n.r=or(t),n.t=zt(or((t.replace(u6,"").match(l6)||[]).join("").replace(ai,""))),r&&(n.h=o6(a6(n.r)))),n):{t:""}}var f6=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,d6=/<(?:\w+:)?(?:si|sstItem)>/g,h6=/<\/(?:\w+:)?(?:si|sstItem)>/;function p6(t,e){var r=[],n="";if(!t)return r;var i=t.match(f6);if(i){n=i[2].replace(d6,"").split(h6);for(var s=0;s!=n.length;++s){var a=ev(n[s].trim(),e);a!=null&&(r[r.length]=a)}i=lt(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}var g6=/^\s|\s$|[\t\n\r]/;function BA(t,e){if(!e.bookSST)return"";var r=[Xr];r[r.length]=Be("sst",null,{xmlns:tc[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var i=t[n],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(g6)&&(s+=' xml:space="preserve"'),s+=">"+nr(i.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function m6(t){return[t.read_shift(4),t.read_shift(4)]}function x6(t,e){var r=[],n=!1;return Ya(t,function(s,a,o){switch(o){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(a.T,!n||e.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function v6(t,e){return e||(e=ve(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var y6=IN;function _6(t){var e=Ri();Te(e,159,v6(t));for(var r=0;r<t.length;++r)Te(e,19,y6(t[r]));return Te(e,160),e.end()}function jA(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function Oa(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function E6(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=Oa(t,4),e.U=Oa(t,4),e.W=Oa(t,4),e}function w6(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},i=t.read_shift(4),s=[];i-- >0;)s.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=s,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function S6(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(w6(t));return e}function T6(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function A6(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=Oa(t,4),e.U=Oa(t,4),e.W=Oa(t,4),e}function k6(t){var e=A6(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function VA(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function UA(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function C6(t){var e=Oa(t);switch(e.Minor){case 2:return[e.Minor,F6(t)];case 3:return[e.Minor,I6()];case 4:return[e.Minor,b6(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function F6(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=VA(t,r),i=UA(t,t.length-t.l);return{t:"Std",h:n,v:i}}function I6(){throw new Error("File is password-protected: ECMA-376 Extensible")}function b6(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(ai,function(s){var a=lt(s);switch(pa(a[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(o){n[o]=a[o]});break;case"<dataIntegrity":n.encryptedHmacKey=a.encryptedHmacKey,n.encryptedHmacValue=a.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=a.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(a);break;default:throw a[0]}}),n}function R6(t,e){var r={},n=r.EncryptionVersionInfo=Oa(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var i=t.read_shift(4);return e-=4,r.EncryptionHeader=VA(t,i),e-=i,r.EncryptionVerifier=UA(t,e),r}function N6(t){var e={},r=e.EncryptionVersionInfo=Oa(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function tv(t){var e=0,r,n=jA(t),i=n.length+1,s,a,o,l,c;for(r=Xo(i),r[0]=n.length,s=1;s!=i;++s)r[s]=n[s-1];for(s=i-1;s>=0;--s)a=r[s],o=e&16384?1:0,l=e<<1&32767,c=o|l,e=c^a;return e^52811}var zA=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(a){return(a/2|a*128)&255},i=function(a,o){return n(a^o)},s=function(a){for(var o=e[a.length-1],l=104,c=a.length-1;c>=0;--c)for(var d=a[c],h=0;h!=7;++h)d&64&&(o^=r[l]),d*=2,--l;return o};return function(a){for(var o=jA(a),l=s(o),c=o.length,d=Xo(16),h=0;h!=16;++h)d[h]=0;var g,m,y;for((c&1)===1&&(g=l>>8,d[c]=i(t[0],g),--c,g=l&255,m=o[o.length-1],d[c]=i(m,g));c>0;)--c,g=l>>8,d[c]=i(o[c],g),--c,g=l&255,d[c]=i(o[c],g);for(c=15,y=15-o.length;y>0;)g=l>>8,d[c]=i(t[y],g),--c,--y,g=l&255,d[c]=i(o[c],g),--c,--y;return d}}(),D6=function(t,e,r,n,i){i||(i=e),n||(n=zA(t));var s,a;for(s=0;s!=e.length;++s)a=e[s],a^=n[r],a=(a>>5|a<<3)&255,i[s]=a,++r;return[i,r,n]},P6=function(t){var e=0,r=zA(t);return function(n){var i=D6("",n,e,r);return e=i[1],i[0]}};function O6(t,e,r,n){var i={key:rn(t),verificationBytes:rn(t)};return r.password&&(i.verifier=tv(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=P6(r.password)),i}function M6(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=N6(t):n.Data=R6(t,e),n}function L6(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?M6(t,e-2,n):O6(t,r.biff>=8?e:e-2,r,n),n}var WA=function(){function t(i,s){switch(s.type){case"base64":return e(Ki(i),s);case"binary":return e(i,s);case"buffer":return e(Tt&&Buffer.isBuffer(i)?i.toString("binary"):il(i),s);case"array":return e(Wl(i),s)}throw new Error("Unrecognized type "+s.type)}function e(i,s){var a=s||{},o=a.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(d,h){Array.isArray(o)&&(o[h]=[]);for(var g=/\\\w+\b/g,m=0,y,x=-1;y=g.exec(d);){switch(y[0]){case"\\cell":var E=d.slice(m,g.lastIndex-y[0].length);if(E[0]==" "&&(E=E.slice(1)),++x,E.length){var A={v:E,t:"s"};Array.isArray(o)?o[h][x]=A:o[at({r:h,c:x})]=A}break}m=g.lastIndex}x>c.e.c&&(c.e.c=x)}),o["!ref"]=Et(c),o}function r(i,s){return sl(t(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],a=Wt(i["!ref"]),o,l=Array.isArray(i),c=a.s.r;c<=a.e.r;++c){s.push("\\trowd\\trautofit1");for(var d=a.s.c;d<=a.e.c;++d)s.push("\\cellx"+(d+1));for(s.push("\\pard\\intbl"),d=a.s.c;d<=a.e.c;++d){var h=at({r:c,c:d});o=l?(i[c]||[])[d]:i[h],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(Ua(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function B6(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function cd(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function j6(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,i=Math.max(e,r,n),s=Math.min(e,r,n),a=i-s;if(a===0)return[0,0,e];var o=0,l=0,c=i+s;switch(l=a/(c>1?2-c:c),i){case e:o=((r-n)/a+6)%6;break;case r:o=(n-e)/a+2;break;case n:o=(e-r)/a+4;break}return[o/6,l,c/2]}function V6(t){var e=t[0],r=t[1],n=t[2],i=r*2*(n<.5?n:1-n),s=n-i/2,a=[s,s,s],o=6*e,l;if(r!==0)switch(o|0){case 0:case 6:l=i*o,a[0]+=i,a[1]+=l;break;case 1:l=i*(2-o),a[0]+=l,a[1]+=i;break;case 2:l=i*(o-2),a[1]+=i,a[2]+=l;break;case 3:l=i*(4-o),a[1]+=l,a[2]+=i;break;case 4:l=i*(o-4),a[2]+=i,a[0]+=l;break;case 5:l=i*(6-o),a[2]+=l,a[0]+=i;break}for(var c=0;c!=3;++c)a[c]=Math.round(a[c]*255);return a}function Qh(t,e){if(e===0)return t;var r=j6(B6(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),cd(V6(r))}var HA=6,U6=15,z6=1,Zn=HA;function ud(t){return Math.floor((t+Math.round(128/Zn)/256)*Zn)}function fd(t){return Math.floor((t-5)/Zn*100+.5)/100}function Jh(t){return Math.round((t*Zn+5)/Zn*256)/256}function Pg(t){return Jh(fd(ud(t)))}function rv(t){var e=Math.abs(t-Pg(t)),r=Zn;if(e>.005)for(Zn=z6;Zn<U6;++Zn)Math.abs(t-Pg(t))<=e&&(e=Math.abs(t-Pg(t)),r=Zn);Zn=r}function Yo(t){t.width?(t.wpx=ud(t.width),t.wch=fd(t.wpx),t.MDW=Zn):t.wpx?(t.wch=fd(t.wpx),t.width=Jh(t.wch),t.MDW=Zn):typeof t.wch=="number"&&(t.width=Jh(t.wch),t.wpx=ud(t.width),t.MDW=Zn),t.customWidth&&delete t.customWidth}var W6=96,$A=W6;function dd(t){return t*96/$A}function pu(t){return t*$A/96}var H6={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function $6(t,e,r,n){e.Borders=[];var i={},s=!1;(t[0].match(ai)||[]).forEach(function(a){var o=lt(a);switch(pa(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},o.diagonalUp&&(i.diagonalUp=gr(o.diagonalUp)),o.diagonalDown&&(i.diagonalDown=gr(o.diagonalDown)),e.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in borders")}})}function G6(t,e,r,n){e.Fills=[];var i={},s=!1;(t[0].match(ai)||[]).forEach(function(a){var o=lt(a);switch(pa(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},e.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":o.patternType&&(i.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),o.indexed&&(i.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(i.bgColor.theme=parseInt(o.theme,10)),o.tint&&(i.bgColor.tint=parseFloat(o.tint)),o.rgb&&(i.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),o.theme&&(i.fgColor.theme=parseInt(o.theme,10)),o.tint&&(i.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(i.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fills")}})}function K6(t,e,r,n){e.Fonts=[];var i={},s=!1;(t[0].match(ai)||[]).forEach(function(a){var o=lt(a);switch(pa(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(i),i={};break;case"<name":o.val&&(i.name=or(o.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=o.val?gr(o.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=o.val?gr(o.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(o.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=o.val?gr(o.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=o.val?gr(o.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=o.val?gr(o.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=o.val?gr(o.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=o.val?gr(o.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":o.val&&(i.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(i.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(i.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(i.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=b1[parseInt(o.val,10)];break;case"<color":if(i.color||(i.color={}),o.auto&&(i.color.auto=gr(o.auto)),o.rgb)i.color.rgb=o.rgb.slice(-6);else if(o.indexed){i.color.index=parseInt(o.indexed,10);var l=Rl[i.color.index];i.color.index==81&&(l=Rl[1]),l||(l=Rl[1]),i.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(i.color.theme=parseInt(o.theme,10),o.tint&&(i.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=Qh(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fonts")}})}function X6(t,e,r){e.NumberFmt=[];for(var n=Mr(st),i=0;i<n.length;++i)e.NumberFmt[n[i]]=st[n[i]];var s=t[0].match(ai);if(s)for(i=0;i<s.length;++i){var a=lt(s[i]);switch(pa(a[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=zt(or(a.formatCode)),l=parseInt(a.numFmtId,10);if(e.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&e.NumberFmt[l]!=null;--l);e.NumberFmt[l]=o}Pa(o,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+a[0]+" in numFmts")}}}function Y6(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)t[n]!=null&&(e[e.length]=Be("numFmt",null,{numFmtId:n,formatCode:nr(t[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=Be("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var P0=["numFmtId","fillId","fontId","borderId","xfId"],O0=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function q6(t,e,r){e.CellXf=[];var n,i=!1;(t[0].match(ai)||[]).forEach(function(s){var a=lt(s),o=0;switch(pa(a[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=a,delete n[0],o=0;o<P0.length;++o)n[P0[o]]&&(n[P0[o]]=parseInt(n[P0[o]],10));for(o=0;o<O0.length;++o)n[O0[o]]&&(n[O0[o]]=gr(n[O0[o]]));if(e.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[o]){n.numFmtId=o;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};a.vertical&&(l.vertical=a.vertical),a.horizontal&&(l.horizontal=a.horizontal),a.textRotation!=null&&(l.textRotation=a.textRotation),a.indent&&(l.indent=a.indent),a.wrapText&&(l.wrapText=gr(a.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+a[0]+" in cellXfs")}})}function Q6(t){var e=[];return e[e.length]=Be("cellXfs",null),t.forEach(function(r){e[e.length]=Be("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=Be("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var J6=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,c){var d={};if(!o)return d;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var h;return(h=o.match(e))&&X6(h,d,c),(h=o.match(i))&&K6(h,d,l,c),(h=o.match(n))&&G6(h,d,l,c),(h=o.match(s))&&$6(h,d,l,c),(h=o.match(r))&&q6(h,d,c),d}}();function GA(t,e){var r=[Xr,Be("styleSheet",null,{xmlns:tc[0],"xmlns:vt":pn.vt})],n;return t.SSF&&(n=Y6(t.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=Q6(e.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function Z6(t,e){var r=t.read_shift(2),n=ri(t);return[r,n]}function eP(t,e,r){r||(r=ve(6+4*e.length)),r.write_shift(2,t),Cn(e,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function tP(t,e,r){var n={};n.sz=t.read_shift(2)/20;var i=MN(t);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=t.read_shift(2);switch(s===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=t.read_shift(1);a!=0&&(n.underline=a);var o=t.read_shift(1);o>0&&(n.family=o);var l=t.read_shift(1);switch(l>0&&(n.charset=l),t.l++,n.color=ON(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=ri(t),n}function rP(t,e){e||(e=ve(25+4*32)),e.write_shift(2,t.sz*20),LN(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),Xh(t.color,e);var n=0;return n=2,e.write_shift(1,n),Cn(t.name,e),e.length>e.l?e.slice(0,e.l):e}var nP=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Og,iP=ii;function k2(t,e){e||(e=ve(4*3+8*7+16*1)),Og||(Og=Op(nP));var r=Og[t.patternType];r==null&&(r=40),e.write_shift(4,r);var n=0;if(r!=40)for(Xh({auto:1},e),Xh({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function sP(t,e){var r=t.l+e,n=t.read_shift(2),i=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:i}}function KA(t,e,r){r||(r=ve(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function tf(t,e){return e||(e=ve(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var aP=ii;function oP(t,e){return e||(e=ve(51)),e.write_shift(1,0),tf(null,e),tf(null,e),tf(null,e),tf(null,e),tf(null,e),e.length>e.l?e.slice(0,e.l):e}function lP(t,e){return e||(e=ve(12+4*10)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),Kh(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function cP(t,e,r){var n=ve(2052);return n.write_shift(4,t),Kh(e,n),Kh(r,n),n.length>n.l?n.slice(0,n.l):n}function uP(t,e,r){var n={};n.NumberFmt=[];for(var i in st)n.NumberFmt[i]=st[i];n.CellXf=[],n.Fonts=[];var s=[],a=!1;return Ya(t,function(l,c,d){switch(d){case 44:n.NumberFmt[l[0]]=l[1],Pa(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(l.color.rgb=Qh(e.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:s.push(d),a=!0;break;case 38:s.pop(),a=!1;break;default:if(c.T>0)s.push(d);else if(c.T<0)s.pop();else if(!a||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),n}function fP(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&++r}),r!=0&&(Te(t,615,Bs(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&Te(t,44,eP(i,e[i]))}),Te(t,616))}}function dP(t){var e=1;Te(t,611,Bs(e)),Te(t,43,rP({sz:12,color:{theme:1},name:"Calibri",family:2})),Te(t,612)}function hP(t){var e=2;Te(t,603,Bs(e)),Te(t,45,k2({patternType:"none"})),Te(t,45,k2({patternType:"gray125"})),Te(t,604)}function pP(t){var e=1;Te(t,613,Bs(e)),Te(t,46,oP()),Te(t,614)}function gP(t){var e=1;Te(t,626,Bs(e)),Te(t,47,KA({numFmtId:0},65535)),Te(t,627)}function mP(t,e){Te(t,617,Bs(e.length)),e.forEach(function(r){Te(t,47,KA(r,0))}),Te(t,618)}function xP(t){var e=1;Te(t,619,Bs(e)),Te(t,48,lP({xfId:0,name:"Normal"})),Te(t,620)}function vP(t){var e=0;Te(t,505,Bs(e)),Te(t,506)}function yP(t){var e=0;Te(t,508,cP(e,"TableStyleMedium9","PivotStyleMedium4")),Te(t,509)}function _P(t,e){var r=Ri();return Te(r,278),fP(r,t.SSF),dP(r),hP(r),pP(r),gP(r),mP(r,e.cellXfs),xP(r),vP(r),yP(r),Te(r,279),r.end()}var EP=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function wP(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(ai)||[]).forEach(function(i){var s=lt(i);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(e.themeElements.clrScheme[EP.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function SP(){}function TP(){}var AP=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,kP=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,CP=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function FP(t,e,r){e.themeElements={};var n;[["clrScheme",AP,wP],["fontScheme",kP,SP],["fmtScheme",CP,TP]].forEach(function(i){if(!(n=t.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,e,r)})}var IP=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function XA(t,e){(!t||t.length===0)&&(t=nv());var r,n={};if(!(r=t.match(IP)))throw new Error("themeElements not found in theme");return FP(r[0],n,e),n.raw=t,n}function nv(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[Xr];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function bP(t,e,r){var n=t.l+e,i=t.read_shift(4);if(i!==124226){if(!r.cellStyles){t.l=n;return}var s=t.slice(t.l);t.l=n;var a;try{a=VT(s,{type:"array"})}catch{return}var o=zi(a,"theme/theme/theme1.xml",!0);if(o)return XA(o,r)}}function RP(t){return t.read_shift(4)}function NP(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=DP(t,4);break;case 2:e.xclrValue=CA(t);break;case 3:e.xclrValue=RP(t);break;case 4:t.l+=4;break}return t.l+=8,e}function DP(t,e){return ii(t,e)}function PP(t,e){return ii(t,e)}function OP(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=NP(t);break;case 6:n[1]=PP(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function MP(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var i=t.read_shift(2),s=[];i-- >0;)s.push(OP(t,r-t.l));return{ixfe:n,ext:s}}function LP(t,e){e.forEach(function(r){switch(r[0]){}})}function BP(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:ri(t)}}function jP(t){var e=ve(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),Cn(t.name,e),e.slice(0,e.l)}function VP(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function UP(t){var e=ve(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function zP(t,e){var r=ve(8+2*e.length);return r.write_shift(4,t),Cn(e,r),r.slice(0,r.l)}function WP(t){return t.l+=4,t.read_shift(4)!=0}function HP(t,e){var r=ve(8);return r.write_shift(4,t),r.write_shift(4,1),r}function $P(t,e,r){var n={Types:[],Cell:[],Value:[]},i=r||{},s=[],a=!1,o=2;return Ya(t,function(l,c,d){switch(d){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(h){o==1?n.Cell.push({type:n.Types[h[0]-1].name,index:h[1]}):o==0&&n.Value.push({type:n.Types[h[0]-1].name,index:h[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:s.push(d),a=!0;break;case 36:s.pop(),a=!1;break;default:if(!c.T){if(!a||i.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),n}function GP(){var t=Ri();return Te(t,332),Te(t,334,Bs(1)),Te(t,335,jP({name:"XLDAPR",version:12e4,flags:3496657072})),Te(t,336),Te(t,339,zP(1,"XLDAPR")),Te(t,52),Te(t,35,Bs(514)),Te(t,4096,Bs(0)),Te(t,4097,as(1)),Te(t,36),Te(t,53),Te(t,340),Te(t,337,HP(1)),Te(t,51,UP([[1,0]])),Te(t,338),Te(t,333),t.end()}function KP(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var i=!1,s=2,a;return t.replace(ai,function(o){var l=lt(o);switch(pa(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<n.Types.length;++c)n.Types[c].name==l.name&&(a=n.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):s==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!a)break;a.offsets||(a.offsets=[]),a.offsets.push(+l.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function YA(){var t=[Xr];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function XP(t){var e=[];if(!t)return e;var r=1;return(t.match(ai)||[]).forEach(function(n){var i=lt(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,e.push(i);break}}),e}function YP(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=at(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function qP(t,e,r){var n=[];return Ya(t,function(s,a,o){switch(o){case 63:n.push(s);break;default:if(!a.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function QP(t,e,r,n){if(!t)return t;var i=n||{},s=!1;Ya(t,function(o,l,c){switch(c){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!l.T){if(!s||i.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}},i)}function JP(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}var zc=1024;function qA(t,e){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[Be("xml",null,{"xmlns:v":ji.v,"xmlns:o":ji.o,"xmlns:x":ji.x,"xmlns:mv":ji.mv}).replace(/\/>/,">"),Be("o:shapelayout",Be("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),Be("v:shapetype",[Be("v:stroke",null,{joinstyle:"miter"}),Be("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];zc<t*1e3;)zc+=1e3;return e.forEach(function(s){var a=kr(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?Be("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=Be("v:fill",l,o),d={on:"t",obscured:"t"};++zc,i=i.concat(["<v:shape"+ad({id:"_x0000_s"+zc,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,Be("v:shadow",null,d),Be("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Pn("x:Anchor",[a.c+1,0,a.r+1,0,a.c+3,20,a.r+5,20].join(",")),Pn("x:AutoFill","False"),Pn("x:Row",String(a.r)),Pn("x:Column",String(a.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function C2(t,e,r,n){var i=Array.isArray(t),s;e.forEach(function(a){var o=kr(a.ref);if(i?(t[o.r]||(t[o.r]=[]),s=t[o.r][o.c]):s=t[a.ref],!s){s={t:"z"},i?t[o.r][o.c]=s:t[a.ref]=s;var l=Wt(t["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var c=Et(l);c!==t["!ref"]&&(t["!ref"]=c)}s.c||(s.c=[]);var d={a:a.author,t:a.t,r:a.r,T:r};a.h&&(d.h=a.h);for(var h=s.c.length-1;h>=0;--h){if(!r&&s.c[h].T)return;r&&!s.c[h].T&&s.c.splice(h,1)}if(r&&n){for(h=0;h<n.length;++h)if(d.a==n[h].id){d.a=n[h].name||d.a;break}}s.c.push(d)})}function ZP(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var s=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=lt(o[0]),c={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},d=kr(l.ref);if(!(e.sheetRows&&e.sheetRows<=d.r)){var h=a.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),g=!!h&&!!h[1]&&ev(h[1])||{r:"",t:"",h:""};c.r=g.r,g.r=="<t></t>"&&(g.t=g.h=""),c.t=(g.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(c.h=g.h),n.push(c)}}}}),n}function QA(t){var e=[Xr,Be("comments",null,{xmlns:tc[0]})],r=[];return e.push("<authors>"),t.forEach(function(n){n[1].forEach(function(i){var s=nr(i.a);r.indexOf(s)==-1&&(r.push(s),e.push("<author>"+s+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),e.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(n){var i=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(l){l.a&&(i=r.indexOf(nr(l.a))),s.push(l.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),s.length<=1)e.push(Pn("t",nr(s[0]||"")));else{for(var a=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)a+=`Reply:
    `+s[o]+`
`;e.push(Pn("t",nr(a)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function e8(t,e){var r=[],n=!1,i={},s=0;return t.replace(ai,function(o,l){var c=lt(o);switch(pa(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":s=l+o.length;break;case"</text>":i.t=t.slice(s,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),r}function t8(t,e,r){var n=[Xr,Be("ThreadedComments",null,{xmlns:pn.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(i){var s="";(i[1]||[]).forEach(function(a,o){if(!a.T){delete a.ID;return}a.a&&e.indexOf(a.a)==-1&&e.push(a.a);var l={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?s=l.id:l.parentId=s,a.ID=l.id,a.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(a.a)).slice(-12)+"}"),n.push(Be("threadedComment",Pn("text",a.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function r8(t,e){var r=[],n=!1;return t.replace(ai,function(s){var a=lt(s);switch(pa(a[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:a.displayname,id:a.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+a[0]+" in threaded comments")}return s}),r}function n8(t){var e=[Xr,Be("personList",null,{xmlns:pn.TCMNT,"xmlns:x":tc[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,n){e.push(Be("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function i8(t){var e={};e.iauthor=t.read_shift(4);var r=sc(t);return e.rfx=r.s,e.ref=at(r.s),t.l+=16,e}function s8(t,e){return e==null&&(e=ve(36)),e.write_shift(4,t[1].iauthor),bu(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var a8=ri;function o8(t){return Cn(t.slice(0,54))}function l8(t,e){var r=[],n=[],i={},s=!1;return Ya(t,function(o,l,c){switch(c){case 632:n.push(o);break;case 635:i=o;break;case 637:i.t=o.t,i.h=o.h,i.r=o.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,e.sheetRows&&i.rfx&&e.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!s||e.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),r}function c8(t){var e=Ri(),r=[];return Te(e,628),Te(e,630),t.forEach(function(n){n[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),Te(e,632,o8(i.a)))})}),Te(e,631),Te(e,633),t.forEach(function(n){n[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var s={s:kr(n[0]),e:kr(n[0])};Te(e,635,s8([s,i])),i.t&&i.t.length>0&&Te(e,637,RN(i)),Te(e,636),delete i.iauthor})}),Te(e,634),Te(e,629),e.end()}var u8="application/vnd.ms-office.vbaProject";function f8(t){var e=Ze.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Ze.utils.cfb_add(e,i,t.FileIndex[n].content)}}),Ze.write(e)}function d8(t,e){e.FullPaths.forEach(function(r,n){if(n!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&Ze.utils.cfb_add(t,i,e.FileIndex[n].content)}})}var JA=["xlsb","xlsm","xlam","biff8","xla"];function h8(){return{"!type":"dialog"}}function p8(){return{"!type":"dialog"}}function g8(){return{"!type":"macro"}}function m8(){return{"!type":"macro"}}var Zc=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,i,s,a){var o=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var c=s.length>0?parseInt(s,10)|0:0,d=a.length>0?parseInt(a,10)|0:0;return o?d+=e.c:--d,l?c+=e.r:--c,i+(o?"":"$")+Ar(d)+(l?"":"$")+Kr(c)}return function(i,s){return e=s,i.replace(t,r)}}(),iv=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,sv=function(){return function(e,r){return e.replace(iv,function(n,i,s,a,o,l){var c=$1(a)-(s?0:r.c),d=H1(l)-(o?0:r.r),h=d==0?"":o?d+1:"["+d+"]",g=c==0?"":s?c+1:"["+c+"]";return i+"R"+h+"C"+g})}}();function ZA(t,e){return t.replace(iv,function(r,n,i,s,a,o){return n+(i=="$"?i+s:Ar($1(s)+e.c))+(a=="$"?a+o:Kr(H1(o)+e.r))})}function x8(t,e,r){var n=Ni(e),i=n.s,s=kr(r),a={r:s.r-i.r,c:s.c-i.c};return ZA(t,a)}function v8(t){return t.length!=1}function F2(t){return t.replace(/_xlfn\./g,"")}function Jr(t){t.l+=1}function qo(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function ek(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return tk(t);r.biff==12&&(n=4)}var i=t.read_shift(n),s=t.read_shift(n),a=qo(t),o=qo(t);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function tk(t){var e=qo(t),r=qo(t),n=t.read_shift(1),i=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function y8(t,e,r){if(r.biff<8)return tk(t);var n=t.read_shift(r.biff==12?4:2),i=t.read_shift(r.biff==12?4:2),s=qo(t),a=qo(t);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}function rk(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return _8(t);var n=t.read_shift(r&&r.biff==12?4:2),i=qo(t);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function _8(t){var e=qo(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function E8(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function w8(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return S8(t);var i=t.read_shift(n>=12?4:2),s=t.read_shift(2),a=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;i>524287;)i-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:a,rRel:o}}function S8(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),i==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:i,rRel:n}}function T8(t,e,r){var n=(t[t.l++]&96)>>5,i=ek(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function A8(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}var a=ek(t,s,r);return[n,i,a]}function k8(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function C8(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}return t.l+=s,[n,i]}function F8(t,e,r){var n=(t[t.l++]&96)>>5,i=y8(t,e-1,r);return[n,i]}function I8(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function I2(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function b8(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(t.read_shift(r&&r.biff==2?1:2));return i}function R8(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function N8(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function D8(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function P8(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function nk(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function O8(t){return t.read_shift(2),nk(t)}function M8(t){return t.read_shift(2),nk(t)}function L8(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=rk(t,0,r);return[n,i]}function B8(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=w8(t,0,r);return[n,i]}function j8(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var s=rk(t,0,r);return[n,i,s]}function V8(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(r&&r.biff<=3?1:2);return[W5[i],ak[i],n]}function U8(t,e,r){var n=t[t.l++],i=t.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:z8(t);return[i,(s[0]===0?ak:z5)[s[1]]]}function z8(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function W8(t,e,r){t.l+=r&&r.biff==2?3:4}function H8(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function $8(t){return t.l++,qa[t.read_shift(1)]}function G8(t){return t.l++,t.read_shift(2)}function K8(t){return t.l++,t.read_shift(1)!==0}function X8(t){return t.l++,ti(t)}function Y8(t,e,r){return t.l++,Dd(t,e-1,r)}function q8(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Hr(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=qa[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=ti(t);break;case 2:r[1]=ac(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function Q8(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((r.biff==12?sc:Bp)(t));return i}function J8(t,e,r){var n=0,i=0;r.biff==12?(n=t.read_shift(4),i=t.read_shift(4)):(i=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var s=0,a=[];s!=n&&(a[s]=[]);++s)for(var o=0;o!=i;++o)a[s][o]=q8(t,r.biff);return a}function Z8(t,e,r){var n=t.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,s=t.read_shift(i);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,s]}function e5(t,e,r){if(r.biff==5)return t5(t);var n=t.read_shift(1)>>>5&3,i=t.read_shift(2),s=t.read_shift(4);return[n,i,s]}function t5(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function r5(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function n5(t,e,r){var n=t.read_shift(1)>>>5&3,i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function i5(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function s5(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return t.l+=s,[n,i]}var a5=ii,o5=ii,l5=ii;function Od(t,e,r){return t.l+=2,[E8(t)]}function av(t){return t.l+=6,[]}var c5=Od,u5=av,f5=av,d5=Od;function ik(t){return t.l+=2,[rn(t),t.read_shift(2)&1]}var h5=Od,p5=ik,g5=av,m5=Od,x5=Od,v5=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function y5(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i=t.read_shift(2),s=t.read_shift(2),a=v5[r>>2&31];return{ixti:e,coltype:r&3,rt:a,idx:n,c:i,C:s}}function _5(t){return t.l+=2,[t.read_shift(4)]}function E5(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function w5(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function S5(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function T5(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function A5(t){return t.l+=4,[0,0]}var b2={1:{n:"PtgExp",f:H8},2:{n:"PtgTbl",f:l5},3:{n:"PtgAdd",f:Jr},4:{n:"PtgSub",f:Jr},5:{n:"PtgMul",f:Jr},6:{n:"PtgDiv",f:Jr},7:{n:"PtgPower",f:Jr},8:{n:"PtgConcat",f:Jr},9:{n:"PtgLt",f:Jr},10:{n:"PtgLe",f:Jr},11:{n:"PtgEq",f:Jr},12:{n:"PtgGe",f:Jr},13:{n:"PtgGt",f:Jr},14:{n:"PtgNe",f:Jr},15:{n:"PtgIsect",f:Jr},16:{n:"PtgUnion",f:Jr},17:{n:"PtgRange",f:Jr},18:{n:"PtgUplus",f:Jr},19:{n:"PtgUminus",f:Jr},20:{n:"PtgPercent",f:Jr},21:{n:"PtgParen",f:Jr},22:{n:"PtgMissArg",f:Jr},23:{n:"PtgStr",f:Y8},26:{n:"PtgSheet",f:E5},27:{n:"PtgEndSheet",f:w5},28:{n:"PtgErr",f:$8},29:{n:"PtgBool",f:K8},30:{n:"PtgInt",f:G8},31:{n:"PtgNum",f:X8},32:{n:"PtgArray",f:I8},33:{n:"PtgFunc",f:V8},34:{n:"PtgFuncVar",f:U8},35:{n:"PtgName",f:Z8},36:{n:"PtgRef",f:L8},37:{n:"PtgArea",f:T8},38:{n:"PtgMemArea",f:r5},39:{n:"PtgMemErr",f:a5},40:{n:"PtgMemNoMem",f:o5},41:{n:"PtgMemFunc",f:n5},42:{n:"PtgRefErr",f:i5},43:{n:"PtgAreaErr",f:k8},44:{n:"PtgRefN",f:B8},45:{n:"PtgAreaN",f:F8},46:{n:"PtgMemAreaN",f:S5},47:{n:"PtgMemNoMemN",f:T5},57:{n:"PtgNameX",f:e5},58:{n:"PtgRef3d",f:j8},59:{n:"PtgArea3d",f:A8},60:{n:"PtgRefErr3d",f:s5},61:{n:"PtgAreaErr3d",f:C8},255:{}},k5={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},C5={1:{n:"PtgElfLel",f:ik},2:{n:"PtgElfRw",f:m5},3:{n:"PtgElfCol",f:c5},6:{n:"PtgElfRwV",f:x5},7:{n:"PtgElfColV",f:d5},10:{n:"PtgElfRadical",f:h5},11:{n:"PtgElfRadicalS",f:g5},13:{n:"PtgElfColS",f:u5},15:{n:"PtgElfColSV",f:f5},16:{n:"PtgElfRadicalLel",f:p5},25:{n:"PtgList",f:y5},29:{n:"PtgSxName",f:_5},255:{}},F5={0:{n:"PtgAttrNoop",f:A5},1:{n:"PtgAttrSemi",f:P8},2:{n:"PtgAttrIf",f:N8},4:{n:"PtgAttrChoose",f:b8},8:{n:"PtgAttrGoto",f:R8},16:{n:"PtgAttrSum",f:W8},32:{n:"PtgAttrBaxcel",f:I2},33:{n:"PtgAttrBaxcel",f:I2},64:{n:"PtgAttrSpace",f:O8},65:{n:"PtgAttrSpaceSemi",f:M8},128:{n:"PtgAttrIfError",f:D8},255:{}};function Md(t,e,r,n){if(n.biff<8)return ii(t,e);for(var i=t.l+e,s=[],a=0;a!==r.length;++a)switch(r[a][0]){case"PtgArray":r[a][1]=J8(t,0,n),s.push(r[a][1]);break;case"PtgMemArea":r[a][2]=Q8(t,r[a][1],n),s.push(r[a][2]);break;case"PtgExp":n&&n.biff==12&&(r[a][1][1]=t.read_shift(4),s.push(r[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[a][0]}return e=i-t.l,e!==0&&s.push(ii(t,e)),s}function Ld(t,e,r){for(var n=t.l+e,i,s,a=[];n!=t.l;)e=n-t.l,s=t[t.l],i=b2[s]||b2[k5[s]],(s===24||s===25)&&(i=(s===24?C5:F5)[t[t.l+1]]),!i||!i.f?ii(t,e):a.push([i.n,i.f(t,e,r)]);return a}function I5(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],i=[],s=0;s<n.length;++s){var a=n[s];if(a)switch(a[0]){case 2:i.push('"'+a[1].replace(/"/g,'""')+'"');break;default:i.push(a[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var b5={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function R5(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function sk(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(t[n[0]][0]){case 357:return i=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return t[n[0]][0][3]?(i=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function R2(t,e,r){var n=sk(t,e,r);return n=="#REF"?n:R5(n,r)}function Qn(t,e,r,n,i){var s=i&&i.biff||8,a={s:{c:0,r:0}},o=[],l,c,d,h=0,g=0,m,y="";if(!t[0]||!t[0][0])return"";for(var x=-1,E="",A=0,k=t[0].length;A<k;++A){var _=t[0][A];switch(_[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),x>=0){switch(t[0][x][1][0]){case 0:E=Dr(" ",t[0][x][1][1]);break;case 1:E=Dr("\r",t[0][x][1][1]);break;default:if(E="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][x][1][0])}c=c+E,x=-1}o.push(c+b5[_[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=Cf(_[1][1],a,i),o.push(Ff(d,s));break;case"PtgRefN":d=r?Cf(_[1][1],r,i):_[1][1],o.push(Ff(d,s));break;case"PtgRef3d":h=_[1][1],d=Cf(_[1][2],a,i),y=R2(n,h,i),o.push(y+"!"+Ff(d,s));break;case"PtgFunc":case"PtgFuncVar":var P=_[1][0],K=_[1][1];P||(P=0),P&=127;var V=P==0?[]:o.slice(-P);o.length-=P,K==="User"&&(K=V.shift()),o.push(K+"("+V.join(",")+")");break;case"PtgBool":o.push(_[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(_[1]);break;case"PtgNum":o.push(String(_[1]));break;case"PtgStr":o.push('"'+_[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(_[1]);break;case"PtgAreaN":m=a2(_[1][1],r?{s:r}:a,i),o.push(Rg(m,i));break;case"PtgArea":m=a2(_[1][1],a,i),o.push(Rg(m,i));break;case"PtgArea3d":h=_[1][1],m=_[1][2],y=R2(n,h,i),o.push(y+"!"+Rg(m,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":g=_[1][2];var S=(n.names||[])[g-1]||(n[0]||[])[g],F=S?S.Name:"SH33TJSNAME"+String(g);F&&F.slice(0,6)=="_xlfn."&&!i.xlfn&&(F=F.slice(6)),o.push(F);break;case"PtgNameX":var w=_[1][1];g=_[1][2];var b;if(i.biff<=5)w<0&&(w=-w),n[w]&&(b=n[w][g]);else{var N="";if(((n[w]||[])[0]||[])[0]==14849||(((n[w]||[])[0]||[])[0]==1025?n[w][g]&&n[w][g].itab>0&&(N=n.SheetNames[n[w][g].itab-1]+"!"):N=n.SheetNames[g-1]+"!"),n[w]&&n[w][g])N+=n[w][g].Name;else if(n[0]&&n[0][g])N+=n[0][g].Name;else{var D=(sk(n,w,i)||"").split(";;");D[g-1]?N=D[g-1]:N+="SH33TJSERRX"}o.push(N);break}b||(b={Name:"SH33TJSERRY"}),o.push(b.Name);break;case"PtgParen":var R="(",ze=")";if(x>=0){switch(E="",t[0][x][1][0]){case 2:R=Dr(" ",t[0][x][1][1])+R;break;case 3:R=Dr("\r",t[0][x][1][1])+R;break;case 4:ze=Dr(" ",t[0][x][1][1])+ze;break;case 5:ze=Dr("\r",t[0][x][1][1])+ze;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][x][1][0])}x=-1}o.push(R+o.pop()+ze);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":d={c:_[1][1],r:_[1][0]};var _e={c:r.c,r:r.r};if(n.sharedf[at(d)]){var Ie=n.sharedf[at(d)];o.push(Qn(Ie,a,_e,n,i))}else{var De=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(d.c<c[0].s.c||d.c>c[0].e.c)&&!(d.r<c[0].s.r||d.r>c[0].e.r)){o.push(Qn(c[1],a,_e,n,i)),De=!0;break}De||o.push(_[1])}break;case"PtgArray":o.push("{"+I5(_[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":x=A;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+_[1].idx+"[#"+_[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(_));default:throw new Error("Unrecognized Formula Token: "+String(_))}var we=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&x>=0&&we.indexOf(t[0][A][0])==-1){_=t[0][x];var re=!0;switch(_[1][0]){case 4:re=!1;case 0:E=Dr(" ",_[1][1]);break;case 5:re=!1;case 1:E=Dr("\r",_[1][1]);break;default:if(E="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+_[1][0])}o.push((re?E:"")+o.pop()+(re?"":E)),x=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function N5(t,e,r){var n=t.l+e,i=r.biff==2?1:2,s,a=t.read_shift(i);if(a==65535)return[[],ii(t,e-2)];var o=Ld(t,a,r);return e!==a+i&&(s=Md(t,e-a-i,o,r)),t.l=n,[o,s]}function D5(t,e,r){var n=t.l+e,i=r.biff==2?1:2,s,a=t.read_shift(i);if(a==65535)return[[],ii(t,e-2)];var o=Ld(t,a,r);return e!==a+i&&(s=Md(t,e-a-i,o,r)),t.l=n,[o,s]}function P5(t,e,r,n){var i=t.l+e,s=Ld(t,n,r),a;return i!==t.l&&(a=Md(t,i-t.l,s,r)),[s,a]}function O5(t,e,r){var n=t.l+e,i,s=t.read_shift(2),a=Ld(t,s,r);return s==65535?[[],ii(t,e-2)]:(e!==s+2&&(i=Md(t,n-s-2,a,r)),[a,i])}function M5(t){var e;if(Fa(t,t.l+6)!==65535)return[ti(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function L5(t){if(t==null){var e=ve(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return Hl(t);return Hl(0)}function Mg(t,e,r){var n=t.l+e,i=ga(t);r.biff==2&&++t.l;var s=M5(t),a=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var o=D5(t,n-t.l,r);return{cell:i,val:s[0],formula:o,shared:a>>3&1,tt:s[1]}}function B5(t,e,r,n,i){var s=Gl(e,r,i),a=L5(t.v),o=ve(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var c=ve(t.bf.length),d=0;d<t.bf.length;++d)c[d]=t.bf[d];var h=kn([s,a,o,c]);return h}function jp(t,e,r){var n=t.read_shift(4),i=Ld(t,n,r),s=t.read_shift(4),a=s>0?Md(t,s,i,r):null;return[i,a]}var j5=jp,Vp=jp,V5=jp,U5=jp,z5={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},ak={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},W5={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function N2(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function H5(t){var e="of:="+t.replace(iv,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function Lg(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function $5(t){return t.replace(/\./,"!")}var bf={},eu={},Rf=typeof Map<"u";function ov(t,e,r){var n=0,i=t.length;if(r){if(Rf?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var s=Rf?r.get(e):r[e];n<s.length;++n)if(t[s[n]].t===e)return t.Count++,s[n]}}else for(;n<i;++n)if(t[n].t===e)return t.Count++,n;return t[i]={t:e},t.Count++,t.Unique++,r&&(Rf?(r.has(e)||r.set(e,[]),r.get(e).push(i)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(i))),i}function Up(t,e){var r={min:t+1,max:t+1},n=-1;return e.MDW&&(Zn=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?n=fd(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(r.width=Jh(n),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function Pl(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function al(t,e,r){var n=r.revssf[e.z!=null?e.z:"General"],i=60,s=t.length;if(n==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){Pa(e.z,i),r.ssf[i]=e.z,r.revssf[e.z]=n=i;break}}for(i=0;i!=s;++i)if(t[i].numFmtId===n)return i;return t[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function ok(t,e,r,n,i,s){try{n.cellNF&&(t.z=st[e])}catch(o){if(n.WTF)throw o}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=xr(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(st[e]==null&&Pa(zR[e]||"General",e),t.t==="e")t.w=t.w||qa[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=id(t.v);else if(t.t==="d"){var a=vn(t.v);(a|0)===a?t.w=a.toString(10):t.w=id(a)}else{if(t.v===void 0)return"";t.w=zl(t.v,eu)}else t.t==="d"?t.w=gs(e,vn(t.v),eu):t.w=gs(e,t.v,eu)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{t.s=s.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=Qh(i.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=i.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=Qh(i.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=i.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&s.Fills)throw o}}}function G5(t,e,r){if(t&&t["!ref"]){var n=Wt(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function K5(t,e){var r=Wt(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=Et(r))}var X5=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,Y5=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,q5=/<(?:\w:)?hyperlink [^>]*>/mg,Q5=/"(\w*:\w*)"/,J5=/<(?:\w:)?col\b[^>]*[\/]?>/g,Z5=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,eO=/<(?:\w:)?pageMargins[^>]*\/>/g,lk=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,tO=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,rO=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function nO(t,e,r,n,i,s,a){if(!t)return t;n||(n={"!id":{}});var o=e.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",d="",h=t.match(Y5);h?(c=t.slice(0,h.index),d=t.slice(h.index+h[0].length)):c=d=t;var g=c.match(lk);g?lv(g[0],o,i,r):(g=c.match(tO))&&sO(g[0],g[1]||"",o,i,r);var m=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(m>0){var y=c.slice(m,m+50).match(Q5);y&&K5(o,y[1])}var x=c.match(rO);x&&x[1]&&vO(x[1],i);var E=[];if(e.cellStyles){var A=c.match(J5);A&&hO(E,A)}h&&EO(h[1],o,e,l,s,a);var k=d.match(Z5);k&&(o["!autofilter"]=gO(k[0]));var _=[],P=d.match(X5);if(P)for(m=0;m!=P.length;++m)_[m]=Wt(P[m].slice(P[m].indexOf('"')+1));var K=d.match(q5);K&&uO(o,K,n);var V=d.match(eO);if(V&&(o["!margins"]=fO(lt(V[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=Et(l)),e.sheetRows>0&&o["!ref"]){var S=Wt(o["!ref"]);e.sheetRows<=+S.e.r&&(S.e.r=e.sheetRows-1,S.e.r>l.e.r&&(S.e.r=l.e.r),S.e.r<S.s.r&&(S.s.r=S.e.r),S.e.c>l.e.c&&(S.e.c=l.e.c),S.e.c<S.s.c&&(S.s.c=S.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Et(S))}return E.length>0&&(o["!cols"]=E),_.length>0&&(o["!merges"]=_),o}function iO(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+Et(t[r])+'"/>';return e+"</mergeCells>"}function lv(t,e,r,n){var i=lt(t);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=zt(or(i.codeName)))}function sO(t,e,r,n,i){lv(t.slice(0,t.indexOf(">")),r,n,i)}function aO(t,e,r,n,i){var s=!1,a={},o=null;if(n.bookType!=="xlsx"&&e.vbaraw){var l=e.SheetNames[r];try{e.Workbook&&(l=e.Workbook.Sheets[r].CodeName||l)}catch{}s=!0,a.codeName=sa(nr(l))}if(t&&t["!outline"]){var c={summaryBelow:1,summaryRight:1};t["!outline"].above&&(c.summaryBelow=0),t["!outline"].left&&(c.summaryRight=0),o=(o||"")+Be("outlinePr",null,c)}!s&&!o||(i[i.length]=Be("sheetPr",o,a))}var oO=["objects","scenarios","selectLockedCells","selectUnlockedCells"],lO=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function cO(t){var e={sheet:1};return oO.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),lO.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=tv(t.password).toString(16).toUpperCase()),Be("sheetProtection",null,e)}function uO(t,e,r){for(var n=Array.isArray(t),i=0;i!=e.length;++i){var s=lt(or(e[i]),!0);if(!s.ref)return;var a=((r||{})["!id"]||[])[s.id];a?(s.Target=a.Target,s.location&&(s.Target+="#"+zt(s.location))):(s.Target="#"+zt(s.location),a={Target:s.Target,TargetMode:"Internal"}),s.Rel=a,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=Wt(s.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var d=at({c,r:l});n?(t[l]||(t[l]=[]),t[l][c]||(t[l][c]={t:"z",v:void 0}),t[l][c].l=s):(t[d]||(t[d]={t:"z",v:void 0}),t[d].l=s)}}}function fO(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function dO(t){return Pl(t),Be("pageMargins",null,t)}function hO(t,e){for(var r=!1,n=0;n!=e.length;++n){var i=lt(e[n],!0);i.hidden&&(i.hidden=gr(i.hidden));var s=parseInt(i.min,10)-1,a=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,rv(i.width)),Yo(i);s<=a;)t[s++]=vr(i)}}function pO(t,e){for(var r=["<cols>"],n,i=0;i!=e.length;++i)(n=e[i])&&(r[r.length]=Be("col",null,Up(i,n)));return r[r.length]="</cols>",r.join("")}function gO(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}function mO(t,e,r,n){var i=typeof t.ref=="string"?t.ref:Et(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,a=Ni(i);a.s.r==a.e.r&&(a.e.r=Ni(e["!ref"]).e.r,i=Et(a));for(var o=0;o<s.length;++o){var l=s[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+i;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),Be("autoFilter",null,{ref:i})}var xO=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function vO(t,e){e.Views||(e.Views=[{}]),(t.match(xO)||[]).forEach(function(r,n){var i=lt(r);e.Views[n]||(e.Views[n]={}),+i.zoomScale&&(e.Views[n].zoom=+i.zoomScale),gr(i.rightToLeft)&&(e.Views[n].RTL=!0)})}function yO(t,e,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Be("sheetViews",Be("sheetView",null,i),{})}function _O(t,e,r,n){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var i="",s=t.t,a=t.v;if(t.t!=="z")switch(t.t){case"b":i=t.v?"1":"0";break;case"n":i=""+t.v;break;case"e":i=qa[t.v];break;case"d":n&&n.cellDates?i=xr(t.v,-1).toISOString():(t=vr(t),t.t="n",i=""+(t.v=vn(xr(t.v)))),typeof t.z>"u"&&(t.z=st[14]);break;default:i=t.v;break}var o=Pn("v",nr(i)),l={r:e},c=al(n.cellXfs,t,n);switch(c!==0&&(l.s=c),t.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=Pn("v",""+ov(n.Strings,t.v,n.revStrings)),l.t="s";break}l.t="str";break}if(t.t!=s&&(t.t=s,t.v=a),typeof t.f=="string"&&t.f){var d=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;o=Be("f",nr(t.f),d)+(t.v!=null?o:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(l.cm=1),Be("c",o,l)}var EO=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,s=sd("v"),a=sd("f");return function(l,c,d,h,g,m){for(var y=0,x="",E=[],A=[],k=0,_=0,P=0,K="",V,S,F=0,w=0,b,N,D=0,R=0,ze=Array.isArray(m.CellXf),_e,Ie=[],De=[],we=Array.isArray(c),re=[],Ae={},Oe=!1,z=!!d.sheetStubs,ne=l.split(e),te=0,Y=ne.length;te!=Y;++te){x=ne[te].trim();var ge=x.length;if(ge!==0){var Ee=0;e:for(y=0;y<ge;++y)switch(x[y]){case">":if(x[y-1]!="/"){++y;break e}if(d&&d.cellStyles){if(S=lt(x.slice(Ee,y),!0),F=S.r!=null?parseInt(S.r,10):F+1,w=-1,d.sheetRows&&d.sheetRows<F)continue;Ae={},Oe=!1,S.ht&&(Oe=!0,Ae.hpt=parseFloat(S.ht),Ae.hpx=pu(Ae.hpt)),S.hidden=="1"&&(Oe=!0,Ae.hidden=!0),S.outlineLevel!=null&&(Oe=!0,Ae.level=+S.outlineLevel),Oe&&(re[F-1]=Ae)}break;case"<":Ee=y;break}if(Ee>=y)break;if(S=lt(x.slice(Ee,y),!0),F=S.r!=null?parseInt(S.r,10):F+1,w=-1,!(d.sheetRows&&d.sheetRows<F)){h.s.r>F-1&&(h.s.r=F-1),h.e.r<F-1&&(h.e.r=F-1),d&&d.cellStyles&&(Ae={},Oe=!1,S.ht&&(Oe=!0,Ae.hpt=parseFloat(S.ht),Ae.hpx=pu(Ae.hpt)),S.hidden=="1"&&(Oe=!0,Ae.hidden=!0),S.outlineLevel!=null&&(Oe=!0,Ae.level=+S.outlineLevel),Oe&&(re[F-1]=Ae)),E=x.slice(y).split(t);for(var Pe=0;Pe!=E.length&&E[Pe].trim().charAt(0)=="<";++Pe);for(E=E.slice(Pe),y=0;y!=E.length;++y)if(x=E[y].trim(),x.length!==0){if(A=x.match(r),k=y,_=0,P=0,x="<c "+(x.slice(0,1)=="<"?">":"")+x,A!=null&&A.length===2){for(k=0,K=A[1],_=0;_!=K.length&&!((P=K.charCodeAt(_)-64)<1||P>26);++_)k=26*k+P;--k,w=k}else++w;for(_=0;_!=x.length&&x.charCodeAt(_)!==62;++_);if(++_,S=lt(x.slice(0,_),!0),S.r||(S.r=at({r:F-1,c:w})),K=x.slice(_),V={t:""},(A=K.match(s))!=null&&A[1]!==""&&(V.v=zt(A[1])),d.cellFormula){if((A=K.match(a))!=null&&A[1]!==""){if(V.f=zt(or(A[1])).replace(/\r\n/g,`
`),d.xlfn||(V.f=F2(V.f)),A[0].indexOf('t="array"')>-1)V.F=(K.match(i)||[])[1],V.F.indexOf(":")>-1&&Ie.push([Wt(V.F),V.F]);else if(A[0].indexOf('t="shared"')>-1){N=lt(A[0]);var ke=zt(or(A[1]));d.xlfn||(ke=F2(ke)),De[parseInt(N.si,10)]=[N,ke,S.r]}}else(A=K.match(/<f[^>]*\/>/))&&(N=lt(A[0]),De[N.si]&&(V.f=x8(De[N.si][1],De[N.si][2],S.r)));var Se=kr(S.r);for(_=0;_<Ie.length;++_)Se.r>=Ie[_][0].s.r&&Se.r<=Ie[_][0].e.r&&Se.c>=Ie[_][0].s.c&&Se.c<=Ie[_][0].e.c&&(V.F=Ie[_][1])}if(S.t==null&&V.v===void 0)if(V.f||V.F)V.v=0,V.t="n";else if(z)V.t="z";else continue;else V.t=S.t||"n";switch(h.s.c>w&&(h.s.c=w),h.e.c<w&&(h.e.c=w),V.t){case"n":if(V.v==""||V.v==null){if(!z)continue;V.t="z"}else V.v=parseFloat(V.v);break;case"s":if(typeof V.v>"u"){if(!z)continue;V.t="z"}else b=bf[parseInt(V.v,10)],V.v=b.t,V.r=b.r,d.cellHTML&&(V.h=b.h);break;case"str":V.t="s",V.v=V.v!=null?or(V.v):"",d.cellHTML&&(V.h=V1(V.v));break;case"inlineStr":A=K.match(n),V.t="s",A!=null&&(b=ev(A[1]))?(V.v=b.t,d.cellHTML&&(V.h=b.h)):V.v="";break;case"b":V.v=gr(V.v);break;case"d":d.cellDates?V.v=xr(V.v,1):(V.v=vn(xr(V.v,1)),V.t="n");break;case"e":(!d||d.cellText!==!1)&&(V.w=V.v),V.v=uA[V.v];break}if(D=R=0,_e=null,ze&&S.s!==void 0&&(_e=m.CellXf[S.s],_e!=null&&(_e.numFmtId!=null&&(D=_e.numFmtId),d.cellStyles&&_e.fillId!=null&&(R=_e.fillId))),ok(V,D,R,d,g,m),d.cellDates&&ze&&V.t=="n"&&Cu(st[D])&&(V.t="d",V.v=Lp(V.v)),S.cm&&d.xlmeta){var tt=(d.xlmeta.Cell||[])[+S.cm-1];tt&&tt.type=="XLDAPR"&&(V.D=!0)}if(we){var Q=kr(S.r);c[Q.r]||(c[Q.r]=[]),c[Q.r][Q.c]=V}else c[S.r]=V}}}}re.length>0&&(c["!rows"]=re)}}();function wO(t,e,r,n){var i=[],s=[],a=Wt(t["!ref"]),o="",l,c="",d=[],h=0,g=0,m=t["!rows"],y=Array.isArray(t),x={r:c},E,A=-1;for(g=a.s.c;g<=a.e.c;++g)d[g]=Ar(g);for(h=a.s.r;h<=a.e.r;++h){for(s=[],c=Kr(h),g=a.s.c;g<=a.e.c;++g){l=d[g]+c;var k=y?(t[h]||[])[g]:t[l];k!==void 0&&(o=_O(k,l,t,e))!=null&&s.push(o)}(s.length>0||m&&m[h])&&(x={r:c},m&&m[h]&&(E=m[h],E.hidden&&(x.hidden=1),A=-1,E.hpx?A=dd(E.hpx):E.hpt&&(A=E.hpt),A>-1&&(x.ht=A,x.customHeight=1),E.level&&(x.outlineLevel=E.level)),i[i.length]=Be("row",s.join(""),x))}if(m)for(;h<m.length;++h)m&&m[h]&&(x={r:h+1},E=m[h],E.hidden&&(x.hidden=1),A=-1,E.hpx?A=dd(E.hpx):E.hpt&&(A=E.hpt),A>-1&&(x.ht=A,x.customHeight=1),E.level&&(x.outlineLevel=E.level),i[i.length]=Be("row","",x));return i.join("")}function ck(t,e,r,n){var i=[Xr,Be("worksheet",null,{xmlns:tc[0],"xmlns:r":pn.r})],s=r.SheetNames[t],a=0,o="",l=r.Sheets[s];l==null&&(l={});var c=l["!ref"]||"A1",d=Wt(c);if(d.e.c>16383||d.e.r>1048575){if(e.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),c=Et(d)}n||(n={}),l["!comments"]=[];var h=[];aO(l,r,t,e,i),i[i.length]=Be("dimension",null,{ref:c}),i[i.length]=yO(l,e,t,r),e.sheetFormat&&(i[i.length]=Be("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(i[i.length]=pO(l,l["!cols"])),i[a=i.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=wO(l,e),o.length>0&&(i[i.length]=o)),i.length>a+1&&(i[i.length]="</sheetData>",i[a]=i[a].replace("/>",">")),l["!protect"]&&(i[i.length]=cO(l["!protect"])),l["!autofilter"]!=null&&(i[i.length]=mO(l["!autofilter"],l,r,t)),l["!merges"]!=null&&l["!merges"].length>0&&(i[i.length]=iO(l["!merges"]));var g=-1,m,y=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(x){x[1].Target&&(m={ref:x[0]},x[1].Target.charAt(0)!="#"&&(y=rr(n,-1,nr(x[1].Target).replace(/#.*$/,""),At.HLINK),m["r:id"]="rId"+y),(g=x[1].Target.indexOf("#"))>-1&&(m.location=nr(x[1].Target.slice(g+1))),x[1].Tooltip&&(m.tooltip=nr(x[1].Tooltip)),i[i.length]=Be("hyperlink",null,m))}),i[i.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(i[i.length]=dO(l["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(i[i.length]=Pn("ignoredErrors",Be("ignoredError",null,{numberStoredAsText:1,sqref:c}))),h.length>0&&(y=rr(n,-1,"../drawings/drawing"+(t+1)+".xml",At.DRAW),i[i.length]=Be("drawing",null,{"r:id":"rId"+y}),l["!drawing"]=h),l["!comments"].length>0&&(y=rr(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",At.VML),i[i.length]=Be("legacyDrawing",null,{"r:id":"rId"+y}),l["!legacy"]=y),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function SO(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var i=t.read_shift(2);t.l+=1;var s=t.read_shift(1);return t.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=i/20),r}function TO(t,e,r){var n=ve(145),i=(r["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var s=320;i.hpx?s=dd(i.hpx)*20:i.hpt&&(s=i.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var a=0;i.level&&(a|=i.level),i.hidden&&(a|=16),(i.hpx||i.hpt)&&(a|=32),n.write_shift(1,a),n.write_shift(1,0);var o=0,l=n.l;n.l+=4;for(var c={r:t,c:0},d=0;d<16;++d)if(!(e.s.c>d+1<<10||e.e.c<d<<10)){for(var h=-1,g=-1,m=d<<10;m<d+1<<10;++m){c.c=m;var y=Array.isArray(r)?(r[c.r]||[])[c.c]:r[at(c)];y&&(h<0&&(h=m),g=m)}h<0||(++o,n.write_shift(4,h),n.write_shift(4,g))}var x=n.l;return n.l=l,n.write_shift(4,o),n.l=x,n.length>n.l?n.slice(0,n.l):n}function AO(t,e,r,n){var i=TO(n,r,e);(i.length>17||(e["!rows"]||[])[n])&&Te(t,0,i)}var kO=sc,CO=bu;function FO(){}function IO(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=NN(t),r}function bO(t,e,r){r==null&&(r=ve(84+4*t.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),r.write_shift(1,n);for(var i=1;i<3;++i)r.write_shift(1,0);return Xh({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),sA(t,r),r.slice(0,r.l)}function RO(t){var e=ms(t);return[e]}function NO(t,e,r){return r==null&&(r=ve(8)),rc(e,r)}function DO(t){var e=nc(t);return[e]}function PO(t,e,r){return r==null&&(r=ve(4)),ic(e,r)}function OO(t){var e=ms(t),r=t.read_shift(1);return[e,r,"b"]}function MO(t,e,r){return r==null&&(r=ve(9)),rc(e,r),r.write_shift(1,t.v?1:0),r}function LO(t){var e=nc(t),r=t.read_shift(1);return[e,r,"b"]}function BO(t,e,r){return r==null&&(r=ve(5)),ic(e,r),r.write_shift(1,t.v?1:0),r}function jO(t){var e=ms(t),r=t.read_shift(1);return[e,r,"e"]}function VO(t,e,r){return r==null&&(r=ve(9)),rc(e,r),r.write_shift(1,t.v),r}function UO(t){var e=nc(t),r=t.read_shift(1);return[e,r,"e"]}function zO(t,e,r){return r==null&&(r=ve(8)),ic(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function WO(t){var e=ms(t),r=t.read_shift(4);return[e,r,"s"]}function HO(t,e,r){return r==null&&(r=ve(12)),rc(e,r),r.write_shift(4,e.v),r}function $O(t){var e=nc(t),r=t.read_shift(4);return[e,r,"s"]}function GO(t,e,r){return r==null&&(r=ve(8)),ic(e,r),r.write_shift(4,e.v),r}function KO(t){var e=ms(t),r=ti(t);return[e,r,"n"]}function XO(t,e,r){return r==null&&(r=ve(16)),rc(e,r),Hl(t.v,r),r}function uk(t){var e=nc(t),r=ti(t);return[e,r,"n"]}function YO(t,e,r){return r==null&&(r=ve(12)),ic(e,r),Hl(t.v,r),r}function qO(t){var e=ms(t),r=Y1(t);return[e,r,"n"]}function QO(t,e,r){return r==null&&(r=ve(12)),rc(e,r),aA(t.v,r),r}function JO(t){var e=nc(t),r=Y1(t);return[e,r,"n"]}function ZO(t,e,r){return r==null&&(r=ve(8)),ic(e,r),aA(t.v,r),r}function eM(t){var e=ms(t),r=G1(t);return[e,r,"is"]}function tM(t){var e=ms(t),r=ri(t);return[e,r,"str"]}function rM(t,e,r){return r==null&&(r=ve(12+4*t.v.length)),rc(e,r),Cn(t.v,r),r.length>r.l?r.slice(0,r.l):r}function nM(t){var e=nc(t),r=ri(t);return[e,r,"str"]}function iM(t,e,r){return r==null&&(r=ve(8+4*t.v.length)),ic(e,r),Cn(t.v,r),r.length>r.l?r.slice(0,r.l):r}function sM(t,e,r){var n=t.l+e,i=ms(t);i.r=r["!row"];var s=t.read_shift(1),a=[i,s,"b"];if(r.cellFormula){t.l+=2;var o=Vp(t,n-t.l,r);a[3]=Qn(o,null,i,r.supbooks,r)}else t.l=n;return a}function aM(t,e,r){var n=t.l+e,i=ms(t);i.r=r["!row"];var s=t.read_shift(1),a=[i,s,"e"];if(r.cellFormula){t.l+=2;var o=Vp(t,n-t.l,r);a[3]=Qn(o,null,i,r.supbooks,r)}else t.l=n;return a}function oM(t,e,r){var n=t.l+e,i=ms(t);i.r=r["!row"];var s=ti(t),a=[i,s,"n"];if(r.cellFormula){t.l+=2;var o=Vp(t,n-t.l,r);a[3]=Qn(o,null,i,r.supbooks,r)}else t.l=n;return a}function lM(t,e,r){var n=t.l+e,i=ms(t);i.r=r["!row"];var s=ri(t),a=[i,s,"str"];if(r.cellFormula){t.l+=2;var o=Vp(t,n-t.l,r);a[3]=Qn(o,null,i,r.supbooks,r)}else t.l=n;return a}var cM=sc,uM=bu;function fM(t,e){return e==null&&(e=ve(4)),e.write_shift(4,t),e}function dM(t,e){var r=t.l+e,n=sc(t),i=K1(t),s=ri(t),a=ri(t),o=ri(t);t.l=r;var l={rfx:n,relId:i,loc:s,display:o};return a&&(l.Tooltip=a),l}function hM(t,e){var r=ve(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));bu({s:kr(t[0]),e:kr(t[0])},r),X1("rId"+e,r);var n=t[1].Target.indexOf("#"),i=n==-1?"":t[1].Target.slice(n+1);return Cn(i||"",r),Cn(t[1].Tooltip||"",r),Cn("",r),r.slice(0,r.l)}function pM(){}function gM(t,e,r){var n=t.l+e,i=oA(t),s=t.read_shift(1),a=[i];if(a[2]=s,r.cellFormula){var o=j5(t,n-t.l,r);a[1]=o}else t.l=n;return a}function mM(t,e,r){var n=t.l+e,i=sc(t),s=[i];if(r.cellFormula){var a=U5(t,n-t.l,r);s[1]=a,t.l=n}else t.l=n;return s}function xM(t,e,r){r==null&&(r=ve(18));var n=Up(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var i=0;return e.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),e.level&&(i|=e.level<<8),r.write_shift(2,i),r}var fk=["left","right","top","bottom","header","footer"];function vM(t){var e={};return fk.forEach(function(r){e[r]=ti(t)}),e}function yM(t,e){return e==null&&(e=ve(6*8)),Pl(t),fk.forEach(function(r){Hl(t[r],e)}),e}function _M(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function EM(t,e,r){r==null&&(r=ve(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function wM(t){var e=ve(24);return e.write_shift(4,4),e.write_shift(4,1),bu(t,e),e}function SM(t,e){return e==null&&(e=ve(16*4+2)),e.write_shift(2,t.password?tv(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function TM(){}function AM(){}function kM(t,e,r,n,i,s,a){if(!t)return t;var o=e||{};n||(n={"!id":{}});var l=o.dense?[]:{},c,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},h=!1,g=!1,m,y,x,E,A,k,_,P,K,V=[];o.biff=12,o["!row"]=0;var S=0,F=!1,w=[],b={},N=o.supbooks||i.supbooks||[[]];if(N.sharedf=b,N.arrayf=w,N.SheetNames=i.SheetNames||i.Sheets.map(function(we){return we.name}),!o.supbooks&&(o.supbooks=N,i.Names))for(var D=0;D<i.Names.length;++D)N[0][D+1]=i.Names[D];var R=[],ze=[],_e=!1;hd[16]={n:"BrtShortReal",f:uk};var Ie;if(Ya(t,function(re,Ae,Oe){if(!g)switch(Oe){case 148:c=re;break;case 0:m=re,o.sheetRows&&o.sheetRows<=m.r&&(g=!0),P=Kr(E=m.r),o["!row"]=m.r,(re.hidden||re.hpt||re.level!=null)&&(re.hpt&&(re.hpx=pu(re.hpt)),ze[re.r]=re);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(y={t:re[2]},re[2]){case"n":y.v=re[1];break;case"s":_=bf[re[1]],y.v=_.t,y.r=_.r;break;case"b":y.v=!!re[1];break;case"e":y.v=re[1],o.cellText!==!1&&(y.w=qa[y.v]);break;case"str":y.t="s",y.v=re[1];break;case"is":y.t="s",y.v=re[1].t;break}if((x=a.CellXf[re[0].iStyleRef])&&ok(y,x.numFmtId,null,o,s,a),A=re[0].c==-1?A+1:re[0].c,o.dense?(l[E]||(l[E]=[]),l[E][A]=y):l[Ar(A)+P]=y,o.cellFormula){for(F=!1,S=0;S<w.length;++S){var z=w[S];m.r>=z[0].s.r&&m.r<=z[0].e.r&&A>=z[0].s.c&&A<=z[0].e.c&&(y.F=Et(z[0]),F=!0)}!F&&re.length>3&&(y.f=re[3])}if(d.s.r>m.r&&(d.s.r=m.r),d.s.c>A&&(d.s.c=A),d.e.r<m.r&&(d.e.r=m.r),d.e.c<A&&(d.e.c=A),o.cellDates&&x&&y.t=="n"&&Cu(st[x.numFmtId])){var ne=Cl(y.v);ne&&(y.t="d",y.v=new Date(ne.y,ne.m-1,ne.d,ne.H,ne.M,ne.S,ne.u))}Ie&&(Ie.type=="XLDAPR"&&(y.D=!0),Ie=void 0);break;case 1:case 12:if(!o.sheetStubs||h)break;y={t:"z",v:void 0},A=re[0].c==-1?A+1:re[0].c,o.dense?(l[E]||(l[E]=[]),l[E][A]=y):l[Ar(A)+P]=y,d.s.r>m.r&&(d.s.r=m.r),d.s.c>A&&(d.s.c=A),d.e.r<m.r&&(d.e.r=m.r),d.e.c<A&&(d.e.c=A),Ie&&(Ie.type=="XLDAPR"&&(y.D=!0),Ie=void 0);break;case 176:V.push(re);break;case 49:Ie=((o.xlmeta||{}).Cell||[])[re-1];break;case 494:var te=n["!id"][re.relId];for(te?(re.Target=te.Target,re.loc&&(re.Target+="#"+re.loc),re.Rel=te):re.relId==""&&(re.Target="#"+re.loc),E=re.rfx.s.r;E<=re.rfx.e.r;++E)for(A=re.rfx.s.c;A<=re.rfx.e.c;++A)o.dense?(l[E]||(l[E]=[]),l[E][A]||(l[E][A]={t:"z",v:void 0}),l[E][A].l=re):(k=at({c:A,r:E}),l[k]||(l[k]={t:"z",v:void 0}),l[k].l=re);break;case 426:if(!o.cellFormula)break;w.push(re),K=o.dense?l[E][A]:l[Ar(A)+P],K.f=Qn(re[1],d,{r:m.r,c:A},N,o),K.F=Et(re[0]);break;case 427:if(!o.cellFormula)break;b[at(re[0].s)]=re[1],K=o.dense?l[E][A]:l[Ar(A)+P],K.f=Qn(re[1],d,{r:m.r,c:A},N,o);break;case 60:if(!o.cellStyles)break;for(;re.e>=re.s;)R[re.e--]={width:re.w/256,hidden:!!(re.flags&1),level:re.level},_e||(_e=!0,rv(re.w/256)),Yo(R[re.e+1]);break;case 161:l["!autofilter"]={ref:Et(re)};break;case 476:l["!margins"]=re;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),re.name&&(i.Sheets[r].CodeName=re.name),(re.above||re.left)&&(l["!outline"]={above:re.above,left:re.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),re.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:h=!0;break;case 36:h=!1;break;case 37:h=!0;break;case 38:h=!1;break;default:if(!Ae.T){if(!h||o.WTF)throw new Error("Unexpected record 0x"+Oe.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(d.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(l["!ref"]=Et(c||d)),o.sheetRows&&l["!ref"]){var De=Wt(l["!ref"]);o.sheetRows<=+De.e.r&&(De.e.r=o.sheetRows-1,De.e.r>d.e.r&&(De.e.r=d.e.r),De.e.r<De.s.r&&(De.s.r=De.e.r),De.e.c>d.e.c&&(De.e.c=d.e.c),De.e.c<De.s.c&&(De.s.c=De.e.c),l["!fullref"]=l["!ref"],l["!ref"]=Et(De))}return V.length>0&&(l["!merges"]=V),R.length>0&&(l["!cols"]=R),ze.length>0&&(l["!rows"]=ze),l}function CM(t,e,r,n,i,s,a){if(e.v===void 0)return!1;var o="";switch(e.t){case"b":o=e.v?"1":"0";break;case"d":e=vr(e),e.z=e.z||st[14],e.v=vn(xr(e.v)),e.t="n";break;case"n":case"e":o=""+e.v;break;default:o=e.v;break}var l={r,c:n};switch(l.s=al(i.cellXfs,e,i),e.l&&s["!links"].push([at(l),e.l]),e.c&&s["!comments"].push([at(l),e.c]),e.t){case"s":case"str":return i.bookSST?(o=ov(i.Strings,e.v,i.revStrings),l.t="s",l.v=o,a?Te(t,18,GO(e,l)):Te(t,7,HO(e,l))):(l.t="str",a?Te(t,17,iM(e,l)):Te(t,6,rM(e,l))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?a?Te(t,13,ZO(e,l)):Te(t,2,QO(e,l)):a?Te(t,16,YO(e,l)):Te(t,5,XO(e,l)),!0;case"b":return l.t="b",a?Te(t,15,BO(e,l)):Te(t,4,MO(e,l)),!0;case"e":return l.t="e",a?Te(t,14,zO(e,l)):Te(t,3,VO(e,l)),!0}return a?Te(t,12,PO(e,l)):Te(t,1,NO(e,l)),!0}function FM(t,e,r,n){var i=Wt(e["!ref"]||"A1"),s,a="",o=[];Te(t,145);var l=Array.isArray(e),c=i.e.r;e["!rows"]&&(c=Math.max(i.e.r,e["!rows"].length-1));for(var d=i.s.r;d<=c;++d){a=Kr(d),AO(t,e,i,d);var h=!1;if(d<=i.e.r)for(var g=i.s.c;g<=i.e.c;++g){d===i.s.r&&(o[g]=Ar(g)),s=o[g]+a;var m=l?(e[d]||[])[g]:e[s];if(!m){h=!1;continue}h=CM(t,m,d,g,n,e,h)}}Te(t,146)}function IM(t,e){!e||!e["!merges"]||(Te(t,177,fM(e["!merges"].length)),e["!merges"].forEach(function(r){Te(t,176,uM(r))}),Te(t,178))}function bM(t,e){!e||!e["!cols"]||(Te(t,390),e["!cols"].forEach(function(r,n){r&&Te(t,60,xM(n,r))}),Te(t,391))}function RM(t,e){!e||!e["!ref"]||(Te(t,648),Te(t,649,wM(Wt(e["!ref"]))),Te(t,650))}function NM(t,e,r){e["!links"].forEach(function(n){if(n[1].Target){var i=rr(r,-1,n[1].Target.replace(/#.*$/,""),At.HLINK);Te(t,494,hM(n,i))}}),delete e["!links"]}function DM(t,e,r,n){if(e["!comments"].length>0){var i=rr(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",At.VML);Te(t,551,X1("rId"+i)),e["!legacy"]=i}}function PM(t,e,r,n){if(e["!autofilter"]){var i=e["!autofilter"],s=typeof i.ref=="string"?i.ref:Et(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,o=Ni(s);o.s.r==o.e.r&&(o.e.r=Ni(e["!ref"]).e.r,s=Et(o));for(var l=0;l<a.length;++l){var c=a[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+s;break}}l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),Te(t,161,bu(Wt(s))),Te(t,162)}}function OM(t,e,r){Te(t,133),Te(t,137,EM(e,r)),Te(t,138),Te(t,134)}function MM(t,e){e["!protect"]&&Te(t,535,SM(e["!protect"]))}function LM(t,e,r,n){var i=Ri(),s=r.SheetNames[t],a=r.Sheets[s]||{},o=s;try{r&&r.Workbook&&(o=r.Workbook.Sheets[t].CodeName||o)}catch{}var l=Wt(a["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(e.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],Te(i,129),(r.vbaraw||a["!outline"])&&Te(i,147,bO(o,a["!outline"])),Te(i,148,CO(l)),OM(i,a,r.Workbook),bM(i,a),FM(i,a,t,e),MM(i,a),PM(i,a,r,t),IM(i,a),NM(i,a,n),a["!margins"]&&Te(i,476,yM(a["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&RM(i,a),DM(i,a,t,n),Te(i,130),i.end()}function BM(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var a=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);a&&(e[+a[1]]=r?+a[2]:a[2])});var i=zt((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[e,i,n]}function jM(t,e,r,n,i,s){var a=s||{"!type":"chart"};if(!t)return s;var o=0,l=0,c="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(h){var g=BM(h);d.s.r=d.s.c=0,d.e.c=o,c=Ar(o),g[0].forEach(function(m,y){a[c+Kr(y)]={t:"n",v:m,z:g[1]},l=y}),d.e.r<l&&(d.e.r=l),++o}),o>0&&(a["!ref"]=Et(d)),a}function VM(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a,o=t.match(lk);return o&&lv(o[0],s,i,r),(a=t.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=a[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function UM(t,e){t.l+=10;var r=ri(t);return{name:r}}function zM(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a=!1;return Ya(t,function(l,c,d){switch(d){case 550:s["!rel"]=l;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),l.name&&(i.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!(c.T>0)){if(!(c.T<0)){if(!a||e.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},e),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var cv=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],WM=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],HM=[],$M=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function D2(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],i=0;i!=e.length;++i){var s=e[i];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=gr(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function P2(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=gr(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function dk(t){P2(t.WBProps,cv),P2(t.CalcPr,$M),D2(t.WBView,WM),D2(t.Sheets,HM),eu.date1904=gr(t.WBProps.date1904)}function GM(t){return!t.Workbook||!t.Workbook.WBProps?"false":gr(t.Workbook.WBProps.date1904)?"true":"false"}var KM="][*?/\\".split("");function hk(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return KM.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function XM(t,e,r){t.forEach(function(n,i){hk(n);for(var s=0;s<i;++s)if(n==t[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var a=e&&e[i]&&e[i].CodeName||n;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function YM(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];XM(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)G5(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}var qM=/<\w+:workbook/;function QM(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",s={},a=0;if(t.replace(ai,function(l,c){var d=lt(l);switch(pa(d[0])){case"<?xml":break;case"<workbook":l.match(qM)&&(i="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=d[i];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":cv.forEach(function(h){if(d[h[0]]!=null)switch(h[2]){case"bool":r.WBProps[h[0]]=gr(d[h[0]]);break;case"int":r.WBProps[h[0]]=parseInt(d[h[0]],10);break;default:r.WBProps[h[0]]=d[h[0]]}}),d.codeName&&(r.WBProps.CodeName=or(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=zt(or(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=or(d.name),d.comment&&(s.Comment=d.comment),d.localSheetId&&(s.Sheet=+d.localSheetId),gr(d.hidden||"0")&&(s.Hidden=!0),a=c+l.length;break;case"</definedName>":s.Ref=zt(or(t.slice(a,c))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return l}),tc.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return dk(r),r}function pk(t){var e=[Xr];e[e.length]=Be("workbook",null,{xmlns:tc[0],"xmlns:r":pn.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(cv.forEach(function(o){t.Workbook.WBProps[o[0]]!=null&&t.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=t.Workbook.WBProps[o[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=Be("workbookPr",null,n);var i=t.Workbook&&t.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(e[e.length]="<bookViews>",s=0;s!=t.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==t.SheetNames.length&&(s=0),e[e.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",s=0;s!=t.SheetNames.length;++s){var a={name:nr(t.SheetNames[s].slice(0,31))};if(a.sheetId=""+(s+1),a["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}e[e.length]=Be("sheet",null,a)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(e[e.length]=Be("definedName",nr(o.Ref),l))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function JM(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=nx(t),r.name=ri(t),r}function ZM(t,e){return e||(e=ve(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),X1(t.strRelID,e),Cn(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function eL(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var i=e>8?ri(t):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function tL(t,e){e||(e=ve(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),sA(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function rL(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function nL(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var i=t.read_shift(4),s=DN(t),a=V5(t,0,r),o=K1(t);t.l=n;var l={Name:s,Ptg:a};return i<268435455&&(l.Sheet=i),o&&(l.Comment=o),l}function iL(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;e||(e={}),e.biff=12;var s=[],a=[[]];return a.SheetNames=[],a.XTI=[],hd[16]={n:"BrtFRTArchID$",f:rL},Ya(t,function(l,c,d){switch(d){case 156:a.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(e.SID=l.Sheet),l.Ref=Qn(l.Ptg,null,null,a,e),delete e.SID,delete l.Ptg,s.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:a[0].length?a.push([d,l]):a[0]=[d,l],a[a.length-1].XTI=[];break;case 362:a.length===0&&(a[0]=[],a[0].XTI=[]),a[a.length-1].XTI=a[a.length-1].XTI.concat(l),a.XTI=a.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(d),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(d),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!c.T){if(!i||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},e),dk(r),r.Names=s,r.supbooks=a,r}function sL(t,e){Te(t,143);for(var r=0;r!=e.SheetNames.length;++r){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,i={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};Te(t,156,ZM(i))}Te(t,144)}function aL(t,e){e||(e=ve(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return Cn("SheetJS",e),Cn(Uh.version,e),Cn(Uh.version,e),Cn("7262",e),e.length>e.l?e.slice(0,e.l):e}function oL(t,e){e||(e=ve(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function lL(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,n=0,i=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&i==-1?i=n:r[n].Hidden==1&&s==-1&&(s=n);s>i||(Te(t,135),Te(t,158,oL(i)),Te(t,136))}}function cL(t,e){var r=Ri();return Te(r,131),Te(r,128,aL()),Te(r,153,tL(t.Workbook&&t.Workbook.WBProps||null)),lL(r,t),sL(r,t),Te(r,132),r.end()}function uL(t,e,r){return e.slice(-4)===".bin"?iL(t,r):QM(t,r)}function fL(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?kM(t,n,r,i,s,a,o):nO(t,n,r,i,s,a,o)}function dL(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?zM(t,n,r,i,s):VM(t,n,r,i,s)}function hL(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?g8():m8()}function pL(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?h8():p8()}function gL(t,e,r,n){return e.slice(-4)===".bin"?uP(t,r,n):J6(t,r,n)}function mL(t,e,r){return XA(t,r)}function xL(t,e,r){return e.slice(-4)===".bin"?x6(t,r):p6(t,r)}function vL(t,e,r){return e.slice(-4)===".bin"?l8(t,r):ZP(t,r)}function yL(t,e,r){return e.slice(-4)===".bin"?qP(t):XP(t)}function _L(t,e,r,n){return r.slice(-4)===".bin"?QP(t,e,r,n):void 0}function EL(t,e,r){return e.slice(-4)===".bin"?$P(t,e,r):KP(t,e,r)}function wL(t,e,r){return(e.slice(-4)===".bin"?cL:pk)(t)}function SL(t,e,r,n,i){return(e.slice(-4)===".bin"?LM:ck)(t,r,n,i)}function TL(t,e,r){return(e.slice(-4)===".bin"?_P:GA)(t,r)}function AL(t,e,r){return(e.slice(-4)===".bin"?_6:BA)(t,r)}function kL(t,e,r){return(e.slice(-4)===".bin"?c8:QA)(t)}function CL(t){return(t.slice(-4)===".bin"?GP:YA)()}var gk=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,mk=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Cs(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var i=t.match(gk),s,a,o,l;if(i)for(l=0;l!=i.length;++l)s=i[l].match(mk),(a=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(a+1),n[o]=s[2].slice(1,s[2].length-1));return n}function FL(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(gk),i,s,a,o;if(n)for(o=0;o!=n.length;++o)i=n[o].match(mk),(s=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?a="xmlns"+i[1].slice(6):a=i[1].slice(s+1),r[a]=i[2].slice(1,i[2].length-1));return r}var Nf;function IL(t,e){var r=Nf[t]||zt(t);return r==="General"?zl(e):gs(r,e)}function bL(t,e,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=gr(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=xr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[zt(e)]=i}function RL(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||qa[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=id(t.v):t.w=zl(t.v):t.w=IL(e||"General",t.v)}catch(s){if(r.WTF)throw s}try{var n=Nf[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&Cu(n)){var i=Cl(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(s){if(r.WTF)throw s}}}function NL(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=H6[n.Pattern]||n.Pattern)}t[e.ID]=e}function DL(t,e,r,n,i,s,a,o,l,c){var d="General",h=n.StyleID,g={};c=c||{};var m=[],y=0;for(h===void 0&&o&&(h=o.StyleID),h===void 0&&a&&(h=a.StyleID);s[h]!==void 0&&(s[h].nf&&(d=s[h].nf),s[h].Interior&&m.push(s[h].Interior),!!s[h].Parent);)h=s[h].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=gr(t);break;case"String":n.t="s",n.r=Q_(zt(t)),n.v=t.indexOf("<")>-1?zt(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(xr(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=zt(t):n.v<60&&(n.v=n.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=uA[t],c.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=Q_(e||t));break}if(RL(n,d,c),c.cellFormula!==!1)if(n.Formula){var x=zt(n.Formula);x.charCodeAt(0)==61&&(x=x.slice(1)),n.f=Zc(x,i),delete n.Formula,n.ArrayRange=="RC"?n.F=Zc("RC:RC",i):n.ArrayRange&&(n.F=Zc(n.ArrayRange,i),l.push([Wt(n.F),n.F]))}else for(y=0;y<l.length;++y)i.r>=l[y][0].s.r&&i.r<=l[y][0].e.r&&i.c>=l[y][0].s.c&&i.c<=l[y][0].e.c&&(n.F=l[y][1]);c.cellStyles&&(m.forEach(function(E){!g.patternType&&E.patternType&&(g.patternType=E.patternType)}),n.s=g),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function PL(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function Bg(t,e){var r=e||{};Fu();var n=uf(U1(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=or(n));var i=n.slice(0,1024).toLowerCase(),s=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var a=vr(r);return a.type="string",hu.to_workbook(n,a)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(ar){i.indexOf("<"+ar)>=0&&(s=!0)}),s)return yB(n,r);Nf={"General Number":"General","General Date":st[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":st[15],"Short Date":st[14],"Long Time":st[19],"Medium Time":st[18],"Short Time":st[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:st[2],Standard:st[4],Percent:st[10],Scientific:st[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],c,d={},h=[],g=r.dense?[]:{},m="",y={},x={},E=Cs('<Data ss:Type="String">'),A=0,k=0,_=0,P={s:{r:2e6,c:2e6},e:{r:0,c:0}},K={},V={},S="",F=0,w=[],b={},N={},D=0,R=[],ze=[],_e={},Ie=[],De,we=!1,re=[],Ae=[],Oe={},z=0,ne=0,te={Sheets:[],WBProps:{date1904:!1}},Y={};od.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var ge="";o=od.exec(n);)switch(o[3]=(ge=o[3]).toLowerCase()){case"data":if(ge=="data"){if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?DL(n.slice(A,o.index),S,E,l[l.length-1][0]=="comment"?_e:y,{c:k,r:_},K,Ie[k],x,re,r):(S="",E=Cs(o[0]),A=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(ze.length>0&&(y.c=ze),(!r.sheetRows||r.sheetRows>_)&&y.v!==void 0&&(r.dense?(g[_]||(g[_]=[]),g[_][k]=y):g[Ar(k)+Kr(_)]=y),y.HRef&&(y.l={Target:zt(y.HRef)},y.HRefScreenTip&&(y.l.Tooltip=y.HRefScreenTip),delete y.HRef,delete y.HRefScreenTip),(y.MergeAcross||y.MergeDown)&&(z=k+(parseInt(y.MergeAcross,10)|0),ne=_+(parseInt(y.MergeDown,10)|0),w.push({s:{c:k,r:_},e:{c:z,r:ne}})),!r.sheetStubs)y.MergeAcross?k=z+1:++k;else if(y.MergeAcross||y.MergeDown){for(var Ee=k;Ee<=z;++Ee)for(var Pe=_;Pe<=ne;++Pe)(Ee>k||Pe>_)&&(r.dense?(g[Pe]||(g[Pe]=[]),g[Pe][Ee]={t:"z"}):g[Ar(Ee)+Kr(Pe)]={t:"z"});k=z+1}else++k;else y=FL(o[0]),y.Index&&(k=+y.Index-1),k<P.s.c&&(P.s.c=k),k>P.e.c&&(P.e.c=k),o[0].slice(-2)==="/>"&&++k,ze=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(_<P.s.r&&(P.s.r=_),_>P.e.r&&(P.e.r=_),o[0].slice(-2)==="/>"&&(x=Cs(o[0]),x.Index&&(_=+x.Index-1)),k=0,++_):(x=Cs(o[0]),x.Index&&(_=+x.Index-1),Oe={},(x.AutoFitHeight=="0"||x.Height)&&(Oe.hpx=parseInt(x.Height,10),Oe.hpt=dd(Oe.hpx),Ae[_]=Oe),x.Hidden=="1"&&(Oe.hidden=!0,Ae[_]=Oe));break;case"worksheet":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));h.push(m),P.s.r<=P.e.r&&P.s.c<=P.e.c&&(g["!ref"]=Et(P),r.sheetRows&&r.sheetRows<=P.e.r&&(g["!fullref"]=g["!ref"],P.e.r=r.sheetRows-1,g["!ref"]=Et(P))),w.length&&(g["!merges"]=w),Ie.length>0&&(g["!cols"]=Ie),Ae.length>0&&(g["!rows"]=Ae),d[m]=g}else P={s:{r:2e6,c:2e6},e:{r:0,c:0}},_=k=0,l.push([o[3],!1]),c=Cs(o[0]),m=zt(c.Name),g=r.dense?[]:{},w=[],re=[],Ae=[],Y={name:m,Hidden:0},te.Sheets.push(Y);break;case"table":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),Ie=[],we=!1}break;case"style":o[1]==="/"?NL(K,V,r):V=Cs(o[0]);break;case"numberformat":V.nf=zt(Cs(o[0]).Format||"General"),Nf[V.nf]&&(V.nf=Nf[V.nf]);for(var ke=0;ke!=392&&st[ke]!=V.nf;++ke);if(ke==392){for(ke=57;ke!=392;++ke)if(st[ke]==null){Pa(V.nf,ke);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(De=Cs(o[0]),De.Hidden&&(De.hidden=!0,delete De.Hidden),De.Width&&(De.wpx=parseInt(De.Width,10)),!we&&De.wpx>10){we=!0,Zn=HA;for(var Se=0;Se<Ie.length;++Se)Ie[Se]&&Yo(Ie[Se])}we&&Yo(De),Ie[De.Index-1||Ie.length]=De;for(var tt=0;tt<+De.Span;++tt)Ie[Ie.length]=vr(De);break;case"namedrange":if(o[1]==="/")break;te.Names||(te.Names=[]);var Q=lt(o[0]),Rt={Name:Q.Name,Ref:Zc(Q.RefersTo.slice(1),{r:0,c:0})};te.Sheets.length>0&&(Rt.Sheet=te.Sheets.length-1),te.Names.push(Rt);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?S+=n.slice(F,o.index):F=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;V.Interior=Cs(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?i3(b,ge,n.slice(D,o.index)):D=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));PL(_e),ze.push(_e)}else l.push([o[3],!1]),c=Cs(o[0]),_e={a:c.Author};break;case"autofilter":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var xt=Cs(o[0]);g["!autofilter"]={ref:Zc(xt.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return j2(n,r);var Ft=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Ft=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Ft=!1}break;case"excelworkbook":switch(o[3]){case"date1904":te.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Ft=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:Ft=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(D,o.index)){case"SheetHidden":Y.Hidden=1;break;case"SheetVeryHidden":Y.Hidden=2;break}else D=o.index+o[0].length;break;case"header":g["!margins"]||Pl(g["!margins"]={},"xlml"),isNaN(+lt(o[0]).Margin)||(g["!margins"].header=+lt(o[0]).Margin);break;case"footer":g["!margins"]||Pl(g["!margins"]={},"xlml"),isNaN(+lt(o[0]).Margin)||(g["!margins"].footer=+lt(o[0]).Margin);break;case"pagemargins":var dt=lt(o[0]);g["!margins"]||Pl(g["!margins"]={},"xlml"),isNaN(+dt.Top)||(g["!margins"].top=+dt.Top),isNaN(+dt.Left)||(g["!margins"].left=+dt.Left),isNaN(+dt.Right)||(g["!margins"].right=+dt.Right),isNaN(+dt.Bottom)||(g["!margins"].bottom=+dt.Bottom);break;case"displayrighttoleft":te.Views||(te.Views=[]),te.Views[0]||(te.Views[0]={}),te.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Ft=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Ft=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Ft=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Ft=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Ft=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Ft=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Ft=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Ft=!1}break;case"smarttags":break;default:Ft=!1;break}if(Ft||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?bL(N,ge,R,n.slice(D,o.index)):(R=o,D=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var We={};return!r.bookSheets&&!r.bookProps&&(We.Sheets=d),We.SheetNames=h,We.Workbook=te,We.SSF=vr(st),We.Props=b,We.Custprops=N,We}function ux(t,e){switch(fv(e=e||{}),e.type||"base64"){case"base64":return Bg(Ki(t),e);case"binary":case"buffer":case"file":return Bg(t,e);case"array":return Bg(il(t),e)}}function OL(t,e){var r=[];return t.Props&&r.push(s3(t.Props,e)),t.Custprops&&r.push(a3(t.Props,t.Custprops)),r.join("")}function ML(){return""}function LL(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,i){var s=[];s.push(Be("NumberFormat",null,{"ss:Format":nr(st[n.numFmtId])}));var a={"ss:ID":"s"+(21+i)};r.push(Be("Style",s.join(""),a))}),Be("Styles",r.join(""))}function xk(t){return Be("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+sv(t.Ref,{r:0,c:0})})}function BL(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],n=0;n<e.length;++n){var i=e[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(xk(i)))}return Be("Names",r.join(""))}function jL(t,e,r,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,s=[],a=0;a<i.length;++a){var o=i[a];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||s.push(xk(o)))}return s.join("")}function VL(t,e,r,n){if(!t)return"";var i=[];if(t["!margins"]&&(i.push("<PageSetup>"),t["!margins"].header&&i.push(Be("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&i.push(Be("Footer",null,{"x:Margin":t["!margins"].footer})),i.push(Be("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push(Be("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),t["!protect"]&&(i.push(Pn("ProtectContents","True")),t["!protect"].objects&&i.push(Pn("ProtectObjects","True")),t["!protect"].scenarios&&i.push(Pn("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?i.push(Pn("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&i.push(Pn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){t["!protect"][a[0]]&&i.push("<"+a[1]+"/>")})),i.length==0?"":Be("WorksheetOptions",i.join(""),{xmlns:ji.x})}function UL(t){return t.map(function(e){var r=lN(e.t||""),n=Be("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Be("Comment",n,{"ss:Author":e.a})}).join("")}function zL(t,e,r,n,i,s,a){if(!t||t.v==null&&t.f==null)return"";var o={};if(t.f&&(o["ss:Formula"]="="+nr(sv(t.f,a))),t.F&&t.F.slice(0,e.length)==e){var l=kr(t.F.slice(e.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==a.r?"":"["+(l.r-a.r)+"]")+"C"+(l.c==a.c?"":"["+(l.c-a.c)+"]")}if(t.l&&t.l.Target&&(o["ss:HRef"]=nr(t.l.Target),t.l.Tooltip&&(o["x:HRefScreenTip"]=nr(t.l.Tooltip))),r["!merges"])for(var c=r["!merges"],d=0;d!=c.length;++d)c[d].s.c!=a.c||c[d].s.r!=a.r||(c[d].e.c>c[d].s.c&&(o["ss:MergeAcross"]=c[d].e.c-c[d].s.c),c[d].e.r>c[d].s.r&&(o["ss:MergeDown"]=c[d].e.r-c[d].s.r));var h="",g="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":h="Number",g=String(t.v);break;case"b":h="Boolean",g=t.v?"1":"0";break;case"e":h="Error",g=qa[t.v];break;case"d":h="DateTime",g=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||st[14]);break;case"s":h="String",g=oN(t.v||"");break}var m=al(n.cellXfs,t,n);o["ss:StyleID"]="s"+(21+m),o["ss:Index"]=a.c+1;var y=t.v!=null?g:"",x=t.t=="z"?"":'<Data ss:Type="'+h+'">'+y+"</Data>";return(t.c||[]).length>0&&(x+=UL(t.c)),Be("Cell",x,o)}function WL(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=pu(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function HL(t,e,r,n){if(!t["!ref"])return"";var i=Wt(t["!ref"]),s=t["!merges"]||[],a=0,o=[];t["!cols"]&&t["!cols"].forEach(function(E,A){Yo(E);var k=!!E.width,_=Up(A,E),P={"ss:Index":A+1};k&&(P["ss:Width"]=ud(_.width)),E.hidden&&(P["ss:Hidden"]="1"),o.push(Be("Column",null,P))});for(var l=Array.isArray(t),c=i.s.r;c<=i.e.r;++c){for(var d=[WL(c,(t["!rows"]||[])[c])],h=i.s.c;h<=i.e.c;++h){var g=!1;for(a=0;a!=s.length;++a)if(!(s[a].s.c>h)&&!(s[a].s.r>c)&&!(s[a].e.c<h)&&!(s[a].e.r<c)){(s[a].s.c!=h||s[a].s.r!=c)&&(g=!0);break}if(!g){var m={r:c,c:h},y=at(m),x=l?(t[c]||[])[h]:t[y];d.push(zL(x,y,t,e,r,n,m))}}d.push("</Row>"),d.length>2&&o.push(d.join(""))}return o.join("")}function $L(t,e,r){var n=[],i=r.SheetNames[t],s=r.Sheets[i],a=s?jL(s,e,t,r):"";return a.length>0&&n.push("<Names>"+a+"</Names>"),a=s?HL(s,e,t,r):"",a.length>0&&n.push("<Table>"+a+"</Table>"),n.push(VL(s,e,t,r)),n.join("")}function GL(t,e){e||(e={}),t.SSF||(t.SSF=vr(st)),t.SSF&&(Fu(),Pp(t.SSF),e.revssf=Mp(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],al(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(OL(t,e)),r.push(ML()),r.push(""),r.push("");for(var n=0;n<t.SheetNames.length;++n)r.push(Be("Worksheet",$L(n,e,t),{"ss:Name":nr(t.SheetNames[n])}));return r[2]=LL(t,e),r[3]=BL(t),Xr+Be("Workbook",r.join(""),{xmlns:ji.ss,"xmlns:o":ji.o,"xmlns:x":ji.x,"xmlns:ss":ji.ss,"xmlns:dt":ji.dt,"xmlns:html":ji.html})}function KL(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=BN(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=jN(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var XL=[60,1084,2066,2165,2175];function YL(t,e,r,n,i){var s=n,a=[],o=r.slice(r.l,r.l+s);if(i&&i.enc&&i.enc.insitu&&o.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(o)}a.push(o),r.l+=s;for(var l=Fa(r,r.l),c=fx[l],d=0;c!=null&&XL.indexOf(l)>-1;)s=Fa(r,r.l+2),d=r.l+4,l==2066?d+=4:(l==2165||l==2175)&&(d+=12),o=r.slice(d,r.l+4+s),a.push(o),r.l+=4+s,c=fx[l=Fa(r,r.l)];var h=kn(a);Dn(h,0);var g=0;h.lens=[];for(var m=0;m<a.length;++m)h.lens.push(g),g+=a[m].length;if(h.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+h.length+" < "+n;return e.f(h,h.length,i)}function Zs(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=st[n])}catch(s){if(e.WTF)throw s}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||qa[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=id(t.v):t.w=zl(t.v):t.w=gs(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(s){if(e.WTF)throw s}if(e.cellDates&&n&&t.t=="n"&&Cu(st[n]||String(n))){var i=Cl(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function M0(t,e,r){return{v:t,ixfe:e,t:r}}function qL(t,e){var r={opts:{}},n={},i=e.dense?[]:{},s={},a={},o=null,l=[],c="",d={},h,g="",m,y,x,E,A={},k=[],_,P,K=[],V=[],S={Sheets:[],WBProps:{date1904:!1},Views:[{}]},F={},w=function(ct){return ct<8?Rl[ct]:ct<64&&V[ct-8]||Rl[ct]},b=function(ct,dr,hr){var yr=dr.XF.data;if(!(!yr||!yr.patternType||!hr||!hr.cellStyles)){dr.s={},dr.s.patternType=yr.patternType;var li;(li=cd(w(yr.icvFore)))&&(dr.s.fgColor={rgb:li}),(li=cd(w(yr.icvBack)))&&(dr.s.bgColor={rgb:li})}},N=function(ct,dr,hr){if(!(Oe>1)&&!(hr.sheetRows&&ct.r>=hr.sheetRows)){if(hr.cellStyles&&dr.XF&&dr.XF.data&&b(ct,dr,hr),delete dr.ixfe,delete dr.XF,h=ct,g=at(ct),(!a||!a.s||!a.e)&&(a={s:{r:0,c:0},e:{r:0,c:0}}),ct.r<a.s.r&&(a.s.r=ct.r),ct.c<a.s.c&&(a.s.c=ct.c),ct.r+1>a.e.r&&(a.e.r=ct.r+1),ct.c+1>a.e.c&&(a.e.c=ct.c+1),hr.cellFormula&&dr.f){for(var yr=0;yr<k.length;++yr)if(!(k[yr][0].s.c>ct.c||k[yr][0].s.r>ct.r)&&!(k[yr][0].e.c<ct.c||k[yr][0].e.r<ct.r)){dr.F=Et(k[yr][0]),(k[yr][0].s.c!=ct.c||k[yr][0].s.r!=ct.r)&&delete dr.f,dr.f&&(dr.f=""+Qn(k[yr][1],a,ct,re,D));break}}hr.dense?(i[ct.r]||(i[ct.r]=[]),i[ct.r][ct.c]=dr):i[g]=dr}},D={enc:!1,sbcch:0,snames:[],sharedf:A,arrayf:k,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(D.password=e.password);var R,ze=[],_e=[],Ie=[],De=[],we=!1,re=[];re.SheetNames=D.snames,re.sharedf=D.sharedf,re.arrayf=D.arrayf,re.names=[],re.XTI=[];var Ae=0,Oe=0,z=0,ne=[],te=[],Y;D.codepage=1200,Ns(1200);for(var ge=!1;t.l<t.length-1;){var Ee=t.l,Pe=t.read_shift(2);if(Pe===0&&Ae===10)break;var ke=t.l===t.length?0:t.read_shift(2),Se=fx[Pe];if(Se&&Se.f){if(e.bookSheets&&Ae===133&&Pe!==133)break;if(Ae=Pe,Se.r===2||Se.r==12){var tt=t.read_shift(2);if(ke-=2,!D.enc&&tt!==Pe&&((tt&255)<<8|tt>>8)!==Pe)throw new Error("rt mismatch: "+tt+"!="+Pe);Se.r==12&&(t.l+=10,ke-=10)}var Q={};if(Pe===10?Q=Se.f(t,ke,D):Q=YL(Pe,Se,t,ke,D),Oe==0&&[9,521,1033,2057].indexOf(Ae)===-1)continue;switch(Pe){case 34:r.opts.Date1904=S.WBProps.date1904=Q;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(D.enc||(t.l=0),D.enc=Q,!e.password)throw new Error("File is password-protected");if(Q.valid==null)throw new Error("Encryption scheme unsupported");if(!Q.valid)throw new Error("Password is incorrect");break;case 92:D.lastuser=Q;break;case 66:var Rt=Number(Q);switch(Rt){case 21010:Rt=1200;break;case 32768:Rt=1e4;break;case 32769:Rt=1252;break}Ns(D.codepage=Rt),ge=!0;break;case 317:D.rrtabid=Q;break;case 25:D.winlocked=Q;break;case 439:r.opts.RefreshAll=Q;break;case 12:r.opts.CalcCount=Q;break;case 16:r.opts.CalcDelta=Q;break;case 17:r.opts.CalcIter=Q;break;case 13:r.opts.CalcMode=Q;break;case 14:r.opts.CalcPrecision=Q;break;case 95:r.opts.CalcSaveRecalc=Q;break;case 15:D.CalcRefMode=Q;break;case 2211:r.opts.FullCalc=Q;break;case 129:Q.fDialog&&(i["!type"]="dialog"),Q.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),Q.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:K.push(Q);break;case 430:re.push([Q]),re[re.length-1].XTI=[];break;case 35:case 547:re[re.length-1].push(Q);break;case 24:case 536:Y={Name:Q.Name,Ref:Qn(Q.rgce,a,null,re,D)},Q.itab>0&&(Y.Sheet=Q.itab-1),re.names.push(Y),re[0]||(re[0]=[],re[0].XTI=[]),re[re.length-1].push(Q),Q.Name=="_xlnm._FilterDatabase"&&Q.itab>0&&Q.rgce&&Q.rgce[0]&&Q.rgce[0][0]&&Q.rgce[0][0][0]=="PtgArea3d"&&(te[Q.itab-1]={ref:Et(Q.rgce[0][0][1][2])});break;case 22:D.ExternCount=Q;break;case 23:re.length==0&&(re[0]=[],re[0].XTI=[]),re[re.length-1].XTI=re[re.length-1].XTI.concat(Q),re.XTI=re.XTI.concat(Q);break;case 2196:if(D.biff<8)break;Y!=null&&(Y.Comment=Q[1]);break;case 18:i["!protect"]=Q;break;case 19:Q!==0&&D.WTF&&console.error("Password verifier: "+Q);break;case 133:s[Q.pos]=Q,D.snames.push(Q.name);break;case 10:{if(--Oe)break;if(a.e){if(a.e.r>0&&a.e.c>0){if(a.e.r--,a.e.c--,i["!ref"]=Et(a),e.sheetRows&&e.sheetRows<=a.e.r){var xt=a.e.r;a.e.r=e.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=Et(a),a.e.r=xt}a.e.r++,a.e.c++}ze.length>0&&(i["!merges"]=ze),_e.length>0&&(i["!objects"]=_e),Ie.length>0&&(i["!cols"]=Ie),De.length>0&&(i["!rows"]=De),S.Sheets.push(F)}c===""?d=i:n[c]=i,i=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(D.biff===8&&(D.biff={9:2,521:3,1033:4}[Pe]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[Q.BIFFVer]||8),D.biffguess=Q.BIFFVer==0,Q.BIFFVer==0&&Q.dt==4096&&(D.biff=5,ge=!0,Ns(D.codepage=28591)),D.biff==8&&Q.BIFFVer==0&&Q.dt==16&&(D.biff=2),Oe++)break;if(i=e.dense?[]:{},D.biff<8&&!ge&&(ge=!0,Ns(D.codepage=e.codepage||1252)),D.biff<5||Q.BIFFVer==0&&Q.dt==4096){c===""&&(c="Sheet1"),a={s:{r:0,c:0},e:{r:0,c:0}};var Ft={pos:t.l-ke,name:c};s[Ft.pos]=Ft,D.snames.push(c)}else c=(s[Ee]||{name:""}).name;Q.dt==32&&(i["!type"]="chart"),Q.dt==64&&(i["!type"]="macro"),ze=[],_e=[],D.arrayf=k=[],Ie=[],De=[],we=!1,F={Hidden:(s[Ee]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(e.dense?(i[Q.r]||[])[Q.c]:i[at({c:Q.c,r:Q.r})])&&++Q.c,_={ixfe:Q.ixfe,XF:K[Q.ixfe]||{},v:Q.val,t:"n"},z>0&&(_.z=ne[_.ixfe>>8&63]),Zs(_,e,r.opts.Date1904),N({c:Q.c,r:Q.r},_,e);break;case 5:case 517:_={ixfe:Q.ixfe,XF:K[Q.ixfe],v:Q.val,t:Q.t},z>0&&(_.z=ne[_.ixfe>>8&63]),Zs(_,e,r.opts.Date1904),N({c:Q.c,r:Q.r},_,e);break;case 638:_={ixfe:Q.ixfe,XF:K[Q.ixfe],v:Q.rknum,t:"n"},z>0&&(_.z=ne[_.ixfe>>8&63]),Zs(_,e,r.opts.Date1904),N({c:Q.c,r:Q.r},_,e);break;case 189:for(var dt=Q.c;dt<=Q.C;++dt){var We=Q.rkrec[dt-Q.c][0];_={ixfe:We,XF:K[We],v:Q.rkrec[dt-Q.c][1],t:"n"},z>0&&(_.z=ne[_.ixfe>>8&63]),Zs(_,e,r.opts.Date1904),N({c:dt,r:Q.r},_,e)}break;case 6:case 518:case 1030:{if(Q.val=="String"){o=Q;break}if(_=M0(Q.val,Q.cell.ixfe,Q.tt),_.XF=K[_.ixfe],e.cellFormula){var ar=Q.formula;if(ar&&ar[0]&&ar[0][0]&&ar[0][0][0]=="PtgExp"){var In=ar[0][0][1][0],sn=ar[0][0][1][1],xi=at({r:In,c:sn});A[xi]?_.f=""+Qn(Q.formula,a,Q.cell,re,D):_.F=((e.dense?(i[In]||[])[sn]:i[xi])||{}).F}else _.f=""+Qn(Q.formula,a,Q.cell,re,D)}z>0&&(_.z=ne[_.ixfe>>8&63]),Zs(_,e,r.opts.Date1904),N(Q.cell,_,e),o=Q}break;case 7:case 519:if(o)o.val=Q,_=M0(Q,o.cell.ixfe,"s"),_.XF=K[_.ixfe],e.cellFormula&&(_.f=""+Qn(o.formula,a,o.cell,re,D)),z>0&&(_.z=ne[_.ixfe>>8&63]),Zs(_,e,r.opts.Date1904),N(o.cell,_,e),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{k.push(Q);var qi=at(Q[0].s);if(m=e.dense?(i[Q[0].s.r]||[])[Q[0].s.c]:i[qi],e.cellFormula&&m){if(!o||!qi||!m)break;m.f=""+Qn(Q[1],a,Q[0],re,D),m.F=Et(Q[0])}}break;case 1212:{if(!e.cellFormula)break;if(g){if(!o)break;A[at(o.cell)]=Q[0],m=e.dense?(i[o.cell.r]||[])[o.cell.c]:i[at(o.cell)],(m||{}).f=""+Qn(Q[0],a,h,re,D)}}break;case 253:_=M0(l[Q.isst].t,Q.ixfe,"s"),l[Q.isst].h&&(_.h=l[Q.isst].h),_.XF=K[_.ixfe],z>0&&(_.z=ne[_.ixfe>>8&63]),Zs(_,e,r.opts.Date1904),N({c:Q.c,r:Q.r},_,e);break;case 513:e.sheetStubs&&(_={ixfe:Q.ixfe,XF:K[Q.ixfe],t:"z"},z>0&&(_.z=ne[_.ixfe>>8&63]),Zs(_,e,r.opts.Date1904),N({c:Q.c,r:Q.r},_,e));break;case 190:if(e.sheetStubs)for(var vi=Q.c;vi<=Q.C;++vi){var Lr=Q.ixfe[vi-Q.c];_={ixfe:Lr,XF:K[Lr],t:"z"},z>0&&(_.z=ne[_.ixfe>>8&63]),Zs(_,e,r.opts.Date1904),N({c:vi,r:Q.r},_,e)}break;case 214:case 516:case 4:_=M0(Q.val,Q.ixfe,"s"),_.XF=K[_.ixfe],z>0&&(_.z=ne[_.ixfe>>8&63]),Zs(_,e,r.opts.Date1904),N({c:Q.c,r:Q.r},_,e);break;case 0:case 512:Oe===1&&(a=Q);break;case 252:l=Q;break;case 1054:if(D.biff==4){ne[z++]=Q[1];for(var yi=0;yi<z+163&&st[yi]!=Q[1];++yi);yi>=163&&Pa(Q[1],z+163)}else Pa(Q[1],Q[0]);break;case 30:{ne[z++]=Q;for(var Qt=0;Qt<z+163&&st[Qt]!=Q;++Qt);Qt>=163&&Pa(Q,z+163)}break;case 229:ze=ze.concat(Q);break;case 93:_e[Q.cmo[0]]=D.lastobj=Q;break;case 438:D.lastobj.TxO=Q;break;case 127:D.lastobj.ImData=Q;break;case 440:for(E=Q[0].s.r;E<=Q[0].e.r;++E)for(x=Q[0].s.c;x<=Q[0].e.c;++x)m=e.dense?(i[E]||[])[x]:i[at({c:x,r:E})],m&&(m.l=Q[1]);break;case 2048:for(E=Q[0].s.r;E<=Q[0].e.r;++E)for(x=Q[0].s.c;x<=Q[0].e.c;++x)m=e.dense?(i[E]||[])[x]:i[at({c:x,r:E})],m&&m.l&&(m.l.Tooltip=Q[1]);break;case 28:{if(D.biff<=5&&D.biff>=2)break;m=e.dense?(i[Q[0].r]||[])[Q[0].c]:i[at(Q[0])];var Sr=_e[Q[2]];m||(e.dense?(i[Q[0].r]||(i[Q[0].r]=[]),m=i[Q[0].r][Q[0].c]={t:"z"}):m=i[at(Q[0])]={t:"z"},a.e.r=Math.max(a.e.r,Q[0].r),a.s.r=Math.min(a.s.r,Q[0].r),a.e.c=Math.max(a.e.c,Q[0].c),a.s.c=Math.min(a.s.c,Q[0].c)),m.c||(m.c=[]),y={a:Q[1],t:Sr.TxO.t},m.c.push(y)}break;case 2173:LP(K[Q.ixfe],Q.ext);break;case 125:{if(!D.cellStyles)break;for(;Q.e>=Q.s;)Ie[Q.e--]={width:Q.w/256,level:Q.level||0,hidden:!!(Q.flags&1)},we||(we=!0,rv(Q.w/256)),Yo(Ie[Q.e+1])}break;case 520:{var fr={};Q.level!=null&&(De[Q.r]=fr,fr.level=Q.level),Q.hidden&&(De[Q.r]=fr,fr.hidden=!0),Q.hpt&&(De[Q.r]=fr,fr.hpt=Q.hpt,fr.hpx=pu(Q.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||Pl(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Pe]]=Q;break;case 161:i["!margins"]||Pl(i["!margins"]={}),i["!margins"].header=Q.header,i["!margins"].footer=Q.footer;break;case 574:Q.RTL&&(S.Views[0].RTL=!0);break;case 146:V=Q;break;case 2198:R=Q;break;case 140:P=Q;break;case 442:c?F.CodeName=Q||F.name:S.WBProps.CodeName=Q||"ThisWorkbook";break}}else Se||console.error("Missing Info for XLS Record 0x"+Pe.toString(16)),t.l+=ke}return r.SheetNames=Mr(s).sort(function(oi,ct){return Number(oi)-Number(ct)}).map(function(oi){return s[oi].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&te.forEach(function(oi,ct){r.Sheets[r.SheetNames[ct]]["!autofilter"]=oi}),r.Strings=l,r.SSF=vr(st),D.enc&&(r.Encryption=D.enc),R&&(r.Themes=R),r.Metadata={},P!==void 0&&(r.Metadata.Country=P),re.names.length>0&&(S.Names=re.names),r.Workbook=S,r}var Df={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function QL(t,e,r){var n=Ze.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=g2(n,ix,Df.DSI);for(var s in i)e[s]=i[s]}catch(c){if(r.WTF)throw c}var a=Ze.find(t,"/!SummaryInformation");if(a&&a.size>0)try{var o=g2(a,sx,Df.SI);for(var l in o)e[l]==null&&(e[l]=o[l])}catch(c){if(r.WTF)throw c}e.HeadingPairs&&e.TitlesOfParts&&(mA(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function JL(t,e){var r=[],n=[],i=[],s=0,a,o=$_(ix,"n"),l=$_(sx,"n");if(t.Props)for(a=Mr(t.Props),s=0;s<a.length;++s)(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(l,a[s])?n:i).push([a[s],t.Props[a[s]]]);if(t.Custprops)for(a=Mr(t.Custprops),s=0;s<a.length;++s)Object.prototype.hasOwnProperty.call(t.Props||{},a[s])||(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(l,a[s])?n:i).push([a[s],t.Custprops[a[s]]]);var c=[];for(s=0;s<i.length;++s)SA.indexOf(i[s][0])>-1||gA.indexOf(i[s][0])>-1||i[s][1]!=null&&c.push(i[s]);n.length&&Ze.utils.cfb_add(e,"/SummaryInformation",m2(n,Df.SI,l,sx)),(r.length||c.length)&&Ze.utils.cfb_add(e,"/DocumentSummaryInformation",m2(r,Df.DSI,o,ix,c.length?c:null,Df.UDI))}function vk(t,e){e||(e={}),fv(e),N1(),e.codepage&&R1(e.codepage);var r,n;if(t.FullPaths){if(Ze.find(t,"/encryption"))throw new Error("File is password-protected");r=Ze.find(t,"!CompObj"),n=Ze.find(t,"/Workbook")||Ze.find(t,"/Book")}else{switch(e.type){case"base64":t=Ui(Ki(t));break;case"binary":t=Ui(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}Dn(t,0),n={content:t}}var i,s;if(r&&KL(r),e.bookProps&&!e.bookSheets)i={};else{var a=Tt?"buffer":"array";if(n&&n.content)i=qL(n.content,e);else if((s=Ze.find(t,"PerfectOffice_MAIN"))&&s.content)i=Dl.to_workbook(s.content,(e.type=a,e));else if((s=Ze.find(t,"NativeContent_MAIN"))&&s.content)i=Dl.to_workbook(s.content,(e.type=a,e));else throw(s=Ze.find(t,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&Ze.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=f8(t))}var o={};return t.FullPaths&&QL(t,o,e),i.Props=i.Custprops=o,e.bookFiles&&(i.cfb=t),i}function ZL(t,e){var r=e||{},n=Ze.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Ze.utils.cfb_add(n,i,yk(t,r)),r.biff==8&&(t.Props||t.Custprops)&&JL(t,n),r.biff==8&&t.vbaraw&&d8(n,Ze.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var hd={0:{f:SO},1:{f:RO},2:{f:qO},3:{f:jO},4:{f:OO},5:{f:KO},6:{f:tM},7:{f:WO},8:{f:lM},9:{f:oM},10:{f:sM},11:{f:aM},12:{f:DO},13:{f:JO},14:{f:UO},15:{f:LO},16:{f:uk},17:{f:nM},18:{f:$O},19:{f:G1},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:nL},40:{},42:{},43:{f:tP},44:{f:Z6},45:{f:iP},46:{f:aP},47:{f:sP},48:{},49:{f:kN},50:{},51:{f:VP},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:PA},62:{f:eM},63:{f:YP},64:{f:TM},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:ii,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:_M},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:IO},148:{f:kO,p:16},151:{f:pM},152:{},153:{f:eL},154:{},155:{},156:{f:JM},157:{},158:{},159:{T:1,f:m6},160:{T:-1},161:{T:1,f:sc},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:cM},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:BP},336:{T:-1},337:{f:WP,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:nx},357:{},358:{},359:{},360:{T:1},361:{},362:{f:DA},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:gM},427:{f:mM},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:vM},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:FO},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:dM},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:nx},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:a8},633:{T:1},634:{T:-1},635:{T:1,f:i8},636:{T:-1},637:{f:bN},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:UM},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:AM},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},fx={6:{f:Mg},10:{f:mo},12:{f:rn},13:{f:rn},14:{f:Hr},15:{f:Hr},16:{f:ti},17:{f:Hr},18:{f:Hr},19:{f:rn},20:{f:w2},21:{f:w2},23:{f:DA},24:{f:T2},25:{f:Hr},26:{},27:{},28:{f:AD},29:{},34:{f:Hr},35:{f:S2},38:{f:ti},39:{f:ti},40:{f:ti},41:{f:ti},42:{f:Hr},43:{f:Hr},47:{f:L6},49:{f:J3},51:{f:rn},60:{},61:{f:K3},64:{f:Hr},65:{f:Q3},66:{f:rn},77:{},80:{},81:{},82:{},85:{f:rn},89:{},90:{},91:{},92:{f:M3},93:{f:FD},94:{},95:{f:Hr},96:{},97:{},99:{f:Hr},125:{f:PA},128:{f:hD},129:{f:B3},130:{f:rn},131:{f:Hr},132:{f:Hr},133:{f:j3},134:{},140:{f:MD},141:{f:rn},144:{},146:{f:jD},151:{},152:{},153:{},154:{},155:{},156:{f:rn},157:{},158:{},160:{f:GD},161:{f:zD},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:cD},190:{f:uD},193:{f:mo},197:{},198:{},199:{},200:{},201:{},202:{f:Hr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:rn},220:{},221:{f:Hr},222:{},224:{f:dD},225:{f:O3},226:{f:mo},227:{},229:{f:kD},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:U3},253:{f:eD},255:{f:W3},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:TA},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Hr},353:{f:mo},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:vD},431:{f:Hr},432:{},433:{},434:{},437:{},438:{f:RD},439:{f:Hr},440:{f:ND},441:{},442:{f:Pd},443:{},444:{f:rn},445:{},446:{},448:{f:mo},449:{f:G3,r:2},450:{f:mo},512:{f:y2},513:{f:$D},515:{f:mD},516:{f:rD},517:{f:E2},519:{f:KD},520:{f:H3},523:{},545:{f:A2},549:{f:v2},566:{},574:{f:Y3},638:{f:lD},659:{},1048:{},1054:{f:iD},1084:{},1212:{f:wD},2048:{f:PD},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:D0},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:mo},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:VD,r:12},2173:{f:MP,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Hr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:ED,r:12},2197:{},2198:{f:bP,r:12},2199:{},2200:{},2201:{},2202:{f:SD,r:12},2203:{f:mo},2204:{},2205:{},2206:{},2207:{},2211:{f:$3},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:rn},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:WD},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:BD},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:y2},1:{},2:{f:JD},3:{f:qD},4:{f:YD},5:{f:E2},7:{f:e6},8:{},9:{f:D0},11:{},22:{f:rn},30:{f:aD},31:{},32:{},33:{f:A2},36:{},37:{f:v2},50:{f:t6},62:{},52:{},67:{},68:{f:rn},69:{},86:{},126:{},127:{f:XD},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:r6},223:{},234:{},354:{},421:{},518:{f:Mg},521:{f:D0},536:{f:T2},547:{f:S2},561:{},579:{},1030:{f:Mg},1033:{f:D0},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Ve(t,e,r,n){var i=e;if(!isNaN(i)){var s=n||(r||[]).length||0,a=t.next(4);a.write_shift(2,i),a.write_shift(2,s),s>0&&W1(r)&&t.push(r)}}function eB(t,e,r,n){var i=(r||[]).length||0;if(i<=8224)return Ve(t,e,r,i);var s=e;if(!isNaN(s)){for(var a=r.parts||[],o=0,l=0,c=0;c+(a[o]||8224)<=8224;)c+=a[o]||8224,o++;var d=t.next(4);for(d.write_shift(2,s),d.write_shift(2,c),t.push(r.slice(l,l+c)),l+=c;l<i;){for(d=t.next(4),d.write_shift(2,60),c=0;c+(a[o]||8224)<=8224;)c+=a[o]||8224,o++;d.write_shift(2,c),t.push(r.slice(l,l+c)),l+=c}}}function Bd(t,e,r){return t||(t=ve(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function tB(t,e,r,n){var i=ve(9);return Bd(i,t,e),AA(r,n||"b",i),i}function rB(t,e,r){var n=ve(8+2*r.length);return Bd(n,t,e),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function nB(t,e,r,n){if(e.v!=null)switch(e.t){case"d":case"n":var i=e.t=="d"?vn(xr(e.v)):e.v;i==(i|0)&&i>=0&&i<65536?Ve(t,2,ZD(r,n,i)):Ve(t,3,QD(r,n,i));return;case"b":case"e":Ve(t,5,tB(r,n,e.v,e.t));return;case"s":case"str":Ve(t,4,rB(r,n,(e.v||"").slice(0,255)));return}Ve(t,1,Bd(null,r,n))}function iB(t,e,r,n){var i=Array.isArray(e),s=Wt(e["!ref"]||"A1"),a,o="",l=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),a=Et(s)}for(var c=s.s.r;c<=s.e.r;++c){o=Kr(c);for(var d=s.s.c;d<=s.e.c;++d){c===s.s.r&&(l[d]=Ar(d)),a=l[d]+o;var h=i?(e[c]||[])[d]:e[a];h&&nB(t,h,c,d)}}}function sB(t,e){for(var r=e||{},n=Ri(),i=0,s=0;s<t.SheetNames.length;++s)t.SheetNames[s]==r.sheet&&(i=s);if(i==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Ve(n,r.biff==4?1033:r.biff==3?521:9,Z1(t,16,r)),iB(n,t.Sheets[t.SheetNames[i]],i,r),Ve(n,10),n.end()}function aB(t,e,r){Ve(t,49,Z3({sz:12,name:"Arial"},r))}function oB(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&Ve(t,1054,sD(i,e[i],r))})}function lB(t,e){var r=ve(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Ve(t,2151,r),r=ve(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),bA(Wt(e["!ref"]||"A1"),r),r.write_shift(4,4),Ve(t,2152,r)}function cB(t,e){for(var r=0;r<16;++r)Ve(t,224,_2({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){Ve(t,224,_2(n,0,e))})}function uB(t,e){for(var r=0;r<e["!links"].length;++r){var n=e["!links"][r];Ve(t,440,DD(n)),n[1].Tooltip&&Ve(t,2048,OD(n))}delete e["!links"]}function fB(t,e){if(e){var r=0;e.forEach(function(n,i){++r<=256&&n&&Ve(t,125,UD(Up(i,n),i))})}}function dB(t,e,r,n,i){var s=16+al(i.cellXfs,e,i);if(e.v==null&&!e.bf){Ve(t,513,Gl(r,n,s));return}if(e.bf)Ve(t,6,B5(e,r,n,i,s));else switch(e.t){case"d":case"n":var a=e.t=="d"?vn(xr(e.v)):e.v;Ve(t,515,xD(r,n,a,s));break;case"b":case"e":Ve(t,517,gD(r,n,e.v,s,i,e.t));break;case"s":case"str":if(i.bookSST){var o=ov(i.Strings,e.v,i.revStrings);Ve(t,253,tD(r,n,o,s))}else Ve(t,516,nD(r,n,(e.v||"").slice(0,255),s,i));break;default:Ve(t,513,Gl(r,n,s))}}function hB(t,e,r){var n=Ri(),i=r.SheetNames[t],s=r.Sheets[i]||{},a=(r||{}).Workbook||{},o=(a.Sheets||[])[t]||{},l=Array.isArray(s),c=e.biff==8,d,h="",g=[],m=Wt(s["!ref"]||"A1"),y=c?65536:16384;if(m.e.c>255||m.e.r>=y){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");m.e.c=Math.min(m.e.c,255),m.e.r=Math.min(m.e.c,y-1)}Ve(n,2057,Z1(r,16,e)),Ve(n,13,as(1)),Ve(n,12,as(100)),Ve(n,15,di(!0)),Ve(n,17,di(!1)),Ve(n,16,Hl(.001)),Ve(n,95,di(!0)),Ve(n,42,di(!1)),Ve(n,43,di(!1)),Ve(n,130,as(1)),Ve(n,128,pD()),Ve(n,131,di(!1)),Ve(n,132,di(!1)),c&&fB(n,s["!cols"]),Ve(n,512,oD(m,e)),c&&(s["!links"]=[]);for(var x=m.s.r;x<=m.e.r;++x){h=Kr(x);for(var E=m.s.c;E<=m.e.c;++E){x===m.s.r&&(g[E]=Ar(E)),d=g[E]+h;var A=l?(s[x]||[])[E]:s[d];A&&(dB(n,A,x,E,e),c&&A.l&&s["!links"].push([d,A.l]))}}var k=o.CodeName||o.name||i;return c&&Ve(n,574,q3((a.Views||[])[0])),c&&(s["!merges"]||[]).length&&Ve(n,229,CD(s["!merges"])),c&&uB(n,s),Ve(n,442,kA(k)),c&&lB(n,s),Ve(n,10),n.end()}function pB(t,e,r){var n=Ri(),i=(t||{}).Workbook||{},s=i.Sheets||[],a=i.WBProps||{},o=r.biff==8,l=r.biff==5;if(Ve(n,2057,Z1(t,5,r)),r.bookType=="xla"&&Ve(n,135),Ve(n,225,o?as(1200):null),Ve(n,193,g3(2)),l&&Ve(n,191),l&&Ve(n,192),Ve(n,226),Ve(n,92,L3("SheetJS",r)),Ve(n,66,as(o?1200:1252)),o&&Ve(n,353,as(0)),o&&Ve(n,448),Ve(n,317,HD(t.SheetNames.length)),o&&t.vbaraw&&Ve(n,211),o&&t.vbaraw){var c=a.CodeName||"ThisWorkbook";Ve(n,442,kA(c))}Ve(n,156,as(17)),Ve(n,25,di(!1)),Ve(n,18,di(!1)),Ve(n,19,as(0)),o&&Ve(n,431,di(!1)),o&&Ve(n,444,as(0)),Ve(n,61,X3()),Ve(n,64,di(!1)),Ve(n,141,as(0)),Ve(n,34,di(GM(t)=="true")),Ve(n,14,di(!0)),o&&Ve(n,439,di(!1)),Ve(n,218,as(0)),aB(n,t,r),oB(n,t.SSF,r),cB(n,r),o&&Ve(n,352,di(!1));var d=n.end(),h=Ri();o&&Ve(h,140,LD()),o&&r.Strings&&eB(h,252,z3(r.Strings)),Ve(h,10);var g=h.end(),m=Ri(),y=0,x=0;for(x=0;x<t.SheetNames.length;++x)y+=(o?12:11)+(o?2:1)*t.SheetNames[x].length;var E=d.length+y+g.length;for(x=0;x<t.SheetNames.length;++x){var A=s[x]||{};Ve(m,133,V3({pos:E,hs:A.Hidden||0,dt:0,name:t.SheetNames[x]},r)),E+=e[x].length}var k=m.end();if(y!=k.length)throw new Error("BS8 "+y+" != "+k.length);var _=[];return d.length&&_.push(d),k.length&&_.push(k),g.length&&_.push(g),kn(_)}function gB(t,e){var r=e||{},n=[];t&&!t.SSF&&(t.SSF=vr(st)),t&&t.SSF&&(Fu(),Pp(t.SSF),r.revssf=Mp(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,dv(r),r.cellXfs=[],al(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var i=0;i<t.SheetNames.length;++i)n[n.length]=hB(i,r,t);return n.unshift(pB(t,n,r)),kn(n)}function yk(t,e){for(var r=0;r<=t.SheetNames.length;++r){var n=t.Sheets[t.SheetNames[r]];if(!(!n||!n["!ref"])){var i=Ni(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=e||{};switch(s.biff||2){case 8:case 5:return gB(t,e);case 4:case 3:case 2:return sB(t,e)}throw new Error("invalid type "+s.bookType+" for BIFF")}function O2(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var i=t.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var s=t.match(/<\/table/i),a=i.index,o=s&&s.index||t.length,l=ZR(t.slice(a,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,d=0,h=0,g=0,m={s:{r:1e7,c:1e7},e:{r:0,c:0}},y=[];for(a=0;a<l.length;++a){var x=l[a].trim(),E=x.slice(0,3).toLowerCase();if(E=="<tr"){if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}d=0;continue}if(!(E!="<td"&&E!="<th")){var A=x.split(/<\/t[dh]>/i);for(o=0;o<A.length;++o){var k=A[o].trim();if(k.match(/<t[dh]/i)){for(var _=k,P=0;_.charAt(0)=="<"&&(P=_.indexOf(">"))>-1;)_=_.slice(P+1);for(var K=0;K<y.length;++K){var V=y[K];V.s.c==d&&V.s.r<c&&c<=V.e.r&&(d=V.e.c+1,K=-1)}var S=lt(k.slice(0,k.indexOf(">")));g=S.colspan?+S.colspan:1,((h=+S.rowspan)>1||g>1)&&y.push({s:{r:c,c:d},e:{r:c+(h||1)-1,c:d+g-1}});var F=S.t||S["data-t"]||"";if(!_.length){d+=g;continue}if(_=WT(_),m.s.r>c&&(m.s.r=c),m.e.r<c&&(m.e.r=c),m.s.c>d&&(m.s.c=d),m.e.c<d&&(m.e.c=d),!_.length){d+=g;continue}var w={t:"s",v:_};r.raw||!_.trim().length||F=="s"||(_==="TRUE"?w={t:"b",v:!0}:_==="FALSE"?w={t:"b",v:!1}:isNaN(Ls(_))?isNaN(du(_).getDate())||(w={t:"d",v:xr(_)},r.cellDates||(w={t:"n",v:vn(w.v)}),w.z=r.dateNF||st[14]):w={t:"n",v:Ls(_)}),r.dense?(n[c]||(n[c]=[]),n[c][d]=w):n[at({r:c,c:d})]=w,d+=g}}}}return n["!ref"]=Et(m),y.length&&(n["!merges"]=y),n}function mB(t,e,r,n){for(var i=t["!merges"]||[],s=[],a=e.s.c;a<=e.e.c;++a){for(var o=0,l=0,c=0;c<i.length;++c)if(!(i[c].s.r>r||i[c].s.c>a)&&!(i[c].e.r<r||i[c].e.c<a)){if(i[c].s.r<r||i[c].s.c<a){o=-1;break}o=i[c].e.r-i[c].s.r+1,l=i[c].e.c-i[c].s.c+1;break}if(!(o<0)){var d=at({r,c:a}),h=n.dense?(t[r]||[])[a]:t[d],g=h&&h.v!=null&&(h.h||V1(h.w||(Ua(h),h.w)||""))||"",m={};o>1&&(m.rowspan=o),l>1&&(m.colspan=l),n.editable?g='<span contenteditable="true">'+g+"</span>":h&&(m["data-t"]=h&&h.t||"z",h.v!=null&&(m["data-v"]=h.v),h.z!=null&&(m["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(g='<a href="'+h.l.Target+'">'+g+"</a>")),m.id=(n.id||"sjs")+"-"+d,s.push(Be("td",g,m))}}var y="<tr>";return y+s.join("")+"</tr>"}var xB='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',vB="</body></html>";function yB(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return sl(O2(r[0],e),e);var n=gv();return r.forEach(function(i,s){mv(n,O2(i,e),"Sheet"+(s+1))}),n}function _B(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function _k(t,e){var r=e||{},n=r.header!=null?r.header:xB,i=r.footer!=null?r.footer:vB,s=[n],a=Ni(t["!ref"]);r.dense=Array.isArray(t),s.push(_B(t,a,r));for(var o=a.s.r;o<=a.e.r;++o)s.push(mB(t,a,o,r));return s.push("</table>"+i),s.join("")}function Ek(t,e,r){var n=r||{},i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var a=typeof n.origin=="string"?kr(n.origin):n.origin;i=a.r,s=a.c}var o=e.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:i,c:s}};if(t["!ref"]){var d=Ni(t["!ref"]);c.s.r=Math.min(c.s.r,d.s.r),c.s.c=Math.min(c.s.c,d.s.c),c.e.r=Math.max(c.e.r,d.e.r),c.e.c=Math.max(c.e.c,d.e.c),i==-1&&(c.e.r=i=d.e.r+1)}var h=[],g=0,m=t["!rows"]||(t["!rows"]=[]),y=0,x=0,E=0,A=0,k=0,_=0;for(t["!cols"]||(t["!cols"]=[]);y<o.length&&x<l;++y){var P=o[y];if(M2(P)){if(n.display)continue;m[x]={hidden:!0}}var K=P.children;for(E=A=0;E<K.length;++E){var V=K[E];if(!(n.display&&M2(V))){var S=V.hasAttribute("data-v")?V.getAttribute("data-v"):V.hasAttribute("v")?V.getAttribute("v"):WT(V.innerHTML),F=V.getAttribute("data-z")||V.getAttribute("z");for(g=0;g<h.length;++g){var w=h[g];w.s.c==A+s&&w.s.r<x+i&&x+i<=w.e.r&&(A=w.e.c+1-s,g=-1)}_=+V.getAttribute("colspan")||1,((k=+V.getAttribute("rowspan")||1)>1||_>1)&&h.push({s:{r:x+i,c:A+s},e:{r:x+i+(k||1)-1,c:A+s+(_||1)-1}});var b={t:"s",v:S},N=V.getAttribute("data-t")||V.getAttribute("t")||"";S!=null&&(S.length==0?b.t=N||"z":n.raw||S.trim().length==0||N=="s"||(S==="TRUE"?b={t:"b",v:!0}:S==="FALSE"?b={t:"b",v:!1}:isNaN(Ls(S))?isNaN(du(S).getDate())||(b={t:"d",v:xr(S)},n.cellDates||(b={t:"n",v:vn(b.v)}),b.z=n.dateNF||st[14]):b={t:"n",v:Ls(S)})),b.z===void 0&&F!=null&&(b.z=F);var D="",R=V.getElementsByTagName("A");if(R&&R.length)for(var ze=0;ze<R.length&&!(R[ze].hasAttribute("href")&&(D=R[ze].getAttribute("href"),D.charAt(0)!="#"));++ze);D&&D.charAt(0)!="#"&&(b.l={Target:D}),n.dense?(t[x+i]||(t[x+i]=[]),t[x+i][A+s]=b):t[at({c:A+s,r:x+i})]=b,c.e.c<A+s&&(c.e.c=A+s),A+=_}}++x}return h.length&&(t["!merges"]=(t["!merges"]||[]).concat(h)),c.e.r=Math.max(c.e.r,x-1+i),t["!ref"]=Et(c),x>=l&&(t["!fullref"]=Et((c.e.r=o.length-y+x-1+i,c))),t}function wk(t,e){var r=e||{},n=r.dense?[]:{};return Ek(n,t,e)}function EB(t,e){return sl(wk(t,e),e)}function M2(t){var e="",r=wB(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function wB(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function SB(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=zt(e.replace(/<[^>]*>/g,""));return[r]}var L2={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Sk(t,e){var r=e||{},n=U1(t),i=[],s,a,o={name:""},l="",c=0,d,h,g={},m=[],y=r.dense?[]:{},x,E,A={value:""},k="",_=0,P=[],K=-1,V=-1,S={s:{r:1e6,c:1e7},e:{r:0,c:0}},F=0,w={},b=[],N={},D=0,R=0,ze=[],_e=1,Ie=1,De=[],we={Names:[]},re={},Ae=["",""],Oe=[],z={},ne="",te=0,Y=!1,ge=!1,Ee=0;for(od.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");x=od.exec(n);)switch(x[3]=x[3].replace(/_.*$/,"")){case"table":case"":x[1]==="/"?(S.e.c>=S.s.c&&S.e.r>=S.s.r?y["!ref"]=Et(S):y["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=S.e.r&&(y["!fullref"]=y["!ref"],S.e.r=r.sheetRows-1,y["!ref"]=Et(S)),b.length&&(y["!merges"]=b),ze.length&&(y["!rows"]=ze),d.name=d.||d.name,typeof JSON<"u"&&JSON.stringify(d),m.push(d.name),g[d.name]=y,ge=!1):x[0].charAt(x[0].length-2)!=="/"&&(d=lt(x[0],!1),K=V=-1,S.s.r=S.s.c=1e7,S.e.r=S.e.c=0,y=r.dense?[]:{},b=[],ze=[],ge=!0);break;case"table-row-group":x[1]==="/"?--F:++F;break;case"table-row":case"":if(x[1]==="/"){K+=_e,_e=1;break}if(h=lt(x[0],!1),h.?K=h.-1:K==-1&&(K=0),_e=+h["number-rows-repeated"]||1,_e<10)for(Ee=0;Ee<_e;++Ee)F>0&&(ze[K+Ee]={level:F});V=-1;break;case"covered-table-cell":x[1]!=="/"&&++V,r.sheetStubs&&(r.dense?(y[K]||(y[K]=[]),y[K][V]={t:"z"}):y[at({r:K,c:V})]={t:"z"}),k="",P=[];break;case"table-cell":case"":if(x[0].charAt(x[0].length-2)==="/")++V,A=lt(x[0],!1),Ie=parseInt(A["number-columns-repeated"]||"1",10),E={t:"z",v:null},A.formula&&r.cellFormula!=!1&&(E.f=N2(zt(A.formula))),(A.||A["value-type"])=="string"&&(E.t="s",E.v=zt(A["string-value"]||""),r.dense?(y[K]||(y[K]=[]),y[K][V]=E):y[at({r:K,c:V})]=E),V+=Ie-1;else if(x[1]!=="/"){++V,k="",_=0,P=[],Ie=1;var Pe=_e?K+_e-1:K;if(V>S.e.c&&(S.e.c=V),V<S.s.c&&(S.s.c=V),K<S.s.r&&(S.s.r=K),Pe>S.e.r&&(S.e.r=Pe),A=lt(x[0],!1),Oe=[],z={},E={t:A.||A["value-type"],v:null},r.cellFormula)if(A.formula&&(A.formula=zt(A.formula)),A["number-matrix-columns-spanned"]&&A["number-matrix-rows-spanned"]&&(D=parseInt(A["number-matrix-rows-spanned"],10)||0,R=parseInt(A["number-matrix-columns-spanned"],10)||0,N={s:{r:K,c:V},e:{r:K+D-1,c:V+R-1}},E.F=Et(N),De.push([N,E.F])),A.formula)E.f=N2(A.formula);else for(Ee=0;Ee<De.length;++Ee)K>=De[Ee][0].s.r&&K<=De[Ee][0].e.r&&V>=De[Ee][0].s.c&&V<=De[Ee][0].e.c&&(E.F=De[Ee][1]);switch((A["number-columns-spanned"]||A["number-rows-spanned"])&&(D=parseInt(A["number-rows-spanned"],10)||0,R=parseInt(A["number-columns-spanned"],10)||0,N={s:{r:K,c:V},e:{r:K+D-1,c:V+R-1}},b.push(N)),A["number-columns-repeated"]&&(Ie=parseInt(A["number-columns-repeated"],10)),E.t){case"boolean":E.t="b",E.v=gr(A["boolean-value"]);break;case"float":E.t="n",E.v=parseFloat(A.value);break;case"percentage":E.t="n",E.v=parseFloat(A.value);break;case"currency":E.t="n",E.v=parseFloat(A.value);break;case"date":E.t="d",E.v=xr(A["date-value"]),r.cellDates||(E.t="n",E.v=vn(E.v)),E.z="m/d/yy";break;case"time":E.t="n",E.v=qR(A["time-value"])/86400,r.cellDates&&(E.t="d",E.v=Lp(E.v)),E.z="HH:MM:SS";break;case"number":E.t="n",E.v=parseFloat(A.);break;default:if(E.t==="string"||E.t==="text"||!E.t)E.t="s",A["string-value"]!=null&&(k=zt(A["string-value"]),P=[]);else throw new Error("Unsupported value type "+E.t)}}else{if(Y=!1,E.t==="s"&&(E.v=k||"",P.length&&(E.R=P),Y=_==0),re.Target&&(E.l=re),Oe.length>0&&(E.c=Oe,Oe=[]),k&&r.cellText!==!1&&(E.w=k),Y&&(E.t="z",delete E.v),(!Y||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=K))for(var ke=0;ke<_e;++ke){if(Ie=parseInt(A["number-columns-repeated"]||"1",10),r.dense)for(y[K+ke]||(y[K+ke]=[]),y[K+ke][V]=ke==0?E:vr(E);--Ie>0;)y[K+ke][V+Ie]=vr(E);else for(y[at({r:K+ke,c:V})]=E;--Ie>0;)y[at({r:K+ke,c:V+Ie})]=vr(E);S.e.c<=V&&(S.e.c=V)}Ie=parseInt(A["number-columns-repeated"]||"1",10),V+=Ie-1,Ie=0,E={},k="",P=[]}re={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(x[1]==="/"){if((s=i.pop())[0]!==x[3])throw"Bad state: "+s}else x[0].charAt(x[0].length-2)!=="/"&&i.push([x[3],!0]);break;case"annotation":if(x[1]==="/"){if((s=i.pop())[0]!==x[3])throw"Bad state: "+s;z.t=k,P.length&&(z.R=P),z.a=ne,Oe.push(z)}else x[0].charAt(x[0].length-2)!=="/"&&i.push([x[3],!1]);ne="",te=0,k="",_=0,P=[];break;case"creator":x[1]==="/"?ne=n.slice(te,x.index):te=x.index+x[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(x[1]==="/"){if((s=i.pop())[0]!==x[3])throw"Bad state: "+s}else x[0].charAt(x[0].length-2)!=="/"&&i.push([x[3],!1]);k="",_=0,P=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(x[1]==="/"){if(w[o.name]=l,(s=i.pop())[0]!==x[3])throw"Bad state: "+s}else x[0].charAt(x[0].length-2)!=="/"&&(l="",o=lt(x[0],!1),i.push([x[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":a=lt(x[0],!1),l+=L2[x[3]][a.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":a=lt(x[0],!1),l+=L2[x[3]][a.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(x[0].slice(-2)==="/>")break;if(x[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(c,x.index);break}else c=x.index+x[0].length;break;case"named-range":a=lt(x[0],!1),Ae=Lg(a["cell-range-address"]);var Se={Name:a.name,Ref:Ae[0]+"!"+Ae[1]};ge&&(Se.Sheet=m.length),we.Names.push(Se);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(x[1]==="/"&&(!A||!A["string-value"])){var tt=SB(n.slice(_,x.index));k=(k.length>0?k+`
`:"")+tt[0]}else lt(x[0],!1),_=x.index+x[0].length;break;case"s":break;case"database-range":if(x[1]==="/")break;try{Ae=Lg(lt(x[0])["target-range-address"]),g[Ae[0]]["!autofilter"]={ref:Ae[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(x[1]!=="/"){if(re=lt(x[0],!1),!re.href)break;re.Target=zt(re.href),delete re.href,re.Target.charAt(0)=="#"&&re.Target.indexOf(".")>-1?(Ae=Lg(re.Target.slice(1)),re.Target="#"+Ae[0]+"!"+Ae[1]):re.Target.match(/^\.\.[\\\/]/)&&(re.Target=re.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(x[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(x)}}var Q={Sheets:g,SheetNames:m,Workbook:we};return r.bookSheets&&delete Q.Sheets,Q}function B2(t,e){e=e||{},ss(t,"META-INF/manifest.xml")&&qN(tn(t,"META-INF/manifest.xml"),e);var r=zi(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=Sk(or(r),e);return ss(t,"meta.xml")&&(n.Props=hA(tn(t,"meta.xml"))),n}function j2(t,e){return Sk(t,e)}var TB=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+ad({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return Xr+e}}(),V2=function(){var t=function(s){return nr(s).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,a,o){var l=[];l.push('      <table:table table:name="'+nr(a.SheetNames[o])+`" table:style-name="ta1">
`);var c=0,d=0,h=Ni(s["!ref"]||"A1"),g=s["!merges"]||[],m=0,y=Array.isArray(s);if(s["!cols"])for(d=0;d<=h.e.c;++d)l.push("        <table:table-column"+(s["!cols"][d]?' table:style-name="co'+s["!cols"][d].ods+'"':"")+`></table:table-column>
`);var x="",E=s["!rows"]||[];for(c=0;c<h.s.r;++c)x=E[c]?' table:style-name="ro'+E[c].ods+'"':"",l.push("        <table:table-row"+x+`></table:table-row>
`);for(;c<=h.e.r;++c){for(x=E[c]?' table:style-name="ro'+E[c].ods+'"':"",l.push("        <table:table-row"+x+`>
`),d=0;d<h.s.c;++d)l.push(e);for(;d<=h.e.c;++d){var A=!1,k={},_="";for(m=0;m!=g.length;++m)if(!(g[m].s.c>d)&&!(g[m].s.r>c)&&!(g[m].e.c<d)&&!(g[m].e.r<c)){(g[m].s.c!=d||g[m].s.r!=c)&&(A=!0),k["table:number-columns-spanned"]=g[m].e.c-g[m].s.c+1,k["table:number-rows-spanned"]=g[m].e.r-g[m].s.r+1;break}if(A){l.push(r);continue}var P=at({r:c,c:d}),K=y?(s[c]||[])[d]:s[P];if(K&&K.f&&(k["table:formula"]=nr(H5(K.f)),K.F&&K.F.slice(0,P.length)==P)){var V=Ni(K.F);k["table:number-matrix-columns-spanned"]=V.e.c-V.s.c+1,k["table:number-matrix-rows-spanned"]=V.e.r-V.s.r+1}if(!K){l.push(e);continue}switch(K.t){case"b":_=K.v?"TRUE":"FALSE",k["office:value-type"]="boolean",k["office:boolean-value"]=K.v?"true":"false";break;case"n":_=K.w||String(K.v||0),k["office:value-type"]="float",k["office:value"]=K.v||0;break;case"s":case"str":_=K.v==null?"":K.v,k["office:value-type"]="string";break;case"d":_=K.w||xr(K.v).toISOString(),k["office:value-type"]="date",k["office:date-value"]=xr(K.v).toISOString(),k["table:style-name"]="ce1";break;default:l.push(e);continue}var S=t(_);if(K.l&&K.l.Target){var F=K.l.Target;F=F.charAt(0)=="#"?"#"+$5(F.slice(1)):F,F.charAt(0)!="#"&&!F.match(/^\w+:/)&&(F="../"+F),S=Be("text:a",S,{"xlink:href":F.replace(/&/g,"&amp;")})}l.push("          "+Be("table:table-cell",Be("text:p",S,{}),k)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},i=function(s,a){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;a.SheetNames.map(function(c){return a.Sheets[c]}).forEach(function(c){if(c&&c["!cols"]){for(var d=0;d<c["!cols"].length;++d)if(c["!cols"][d]){var h=c["!cols"][d];if(h.width==null&&h.wpx==null&&h.wch==null)continue;Yo(h),h.ods=o;var g=c["!cols"][d].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+g+`"/>
`),s.push(`  </style:style>
`),++o}}});var l=0;a.SheetNames.map(function(c){return a.Sheets[c]}).forEach(function(c){if(c&&c["!rows"]){for(var d=0;d<c["!rows"].length;++d)if(c["!rows"][d]){c["!rows"][d].ods=l;var h=c["!rows"][d].hpx+"px";s.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h+`"/>
`),s.push(`  </style:style>
`),++l}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(a,o){var l=[Xr],c=ad({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=ad({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+c+d+`>
`),l.push(dA().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+c+`>
`),i(l,a),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var h=0;h!=a.SheetNames.length;++h)l.push(n(a.Sheets[a.SheetNames[h]],a,h));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function Tk(t,e){if(e.bookType=="fods")return V2(t,e);var r=L1(),n="",i=[],s=[];return n="mimetype",wt(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",wt(r,n,V2(t,e)),i.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",wt(r,n,TB(t,e)),i.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",wt(r,n,Xr+dA()),i.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",wt(r,n,ZN(s)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",wt(r,n,QN(i)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Kl(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function dx(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):or(il(t))}function AB(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):Ui(sa(t))}function kB(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var n=0;n<e.length;++n)if(t[r+n]!=e[n])continue e;return!0}return!1}function Qo(t){var e=t.reduce(function(i,s){return i+s.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(i){r.set(i,n),n+=i.length}),r}function U2(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function CB(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,i=e+13;i>=e;--i)n=n*256+t[i];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function FB(t,e,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,n-6176);t[e+15]|=n>>7,t[e+14]|=(n&127)<<1;for(var s=0;i>=1;++s,i/=256)t[e+s]=i&255;t[e+15]|=r>=0?0:128}function pd(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function tr(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function Or(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function Kt(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],i=pd(t,r),s=i&7;i=Math.floor(i/8);var a=0,o;if(i==0)break;switch(s){case 0:{for(var l=r[0];t[r[0]++]>=128;);o=t.slice(l,r[0])}break;case 5:a=4,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 1:a=8,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 2:a=pd(t,r),o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var c={data:o,type:s};e[i]==null?e[i]=[c]:e[i].push(c)}return e}function bn(t){var e=[];return t.forEach(function(r,n){r.forEach(function(i){i.data&&(e.push(tr(n*8+i.type)),i.type==2&&e.push(tr(i.data.length)),e.push(i.data))})}),Qo(e)}function uv(t,e){return(t==null?void 0:t.map(function(r){return e(r.data)}))||[]}function ns(t){for(var e,r=[],n=[0];n[0]<t.length;){var i=pd(t,n),s=Kt(t.slice(n[0],n[0]+i));n[0]+=i;var a={id:Or(s[1][0].data),messages:[]};s[2].forEach(function(o){var l=Kt(o.data),c=Or(l[3][0].data);a.messages.push({meta:l,data:t.slice(n[0],n[0]+c)}),n[0]+=c}),(e=s[3])!=null&&e[0]&&(a.merge=Or(s[3][0].data)>>>0>0),r.push(a)}return r}function Sc(t){var e=[];return t.forEach(function(r){var n=[];n[1]=[{data:tr(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:tr(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(a){i.push(a.data),a.meta[3]=[{type:0,data:tr(a.data.length)}],n[2].push({data:bn(a.meta),type:2})});var s=bn(n);e.push(tr(s.length)),e.push(s),i.forEach(function(a){return e.push(a)})}),Qo(e)}function IB(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=pd(e,r),i=[];r[0]<e.length;){var s=e[r[0]]&3;if(s==0){var a=e[r[0]++]>>2;if(a<60)++a;else{var o=a-59;a=e[r[0]],o>1&&(a|=e[r[0]+1]<<8),o>2&&(a|=e[r[0]+2]<<16),o>3&&(a|=e[r[0]+3]<<24),a>>>=0,a++,r[0]+=o}i.push(e.slice(r[0],r[0]+a)),r[0]+=a;continue}else{var l=0,c=0;if(s==1?(c=(e[r[0]]>>2&7)+4,l=(e[r[0]++]&224)<<3,l|=e[r[0]++]):(c=(e[r[0]++]>>2)+1,s==2?(l=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(l=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),i=[Qo(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(i.push(i[0].slice(-l)),c-=l;c>=i[i.length-1].length;)i.push(i[i.length-1]),c-=i[i.length-1].length;i.push(i[0].slice(-l,-l+c))}}var d=Qo(i);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function is(t){for(var e=[],r=0;r<t.length;){var n=t[r++],i=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(IB(n,t.slice(r,r+i))),r+=i}if(r!==t.length)throw new Error("data is not a valid framed stream!");return Qo(e)}function Tc(t){for(var e=[],r=0;r<t.length;){var n=Math.min(t.length-r,268435455),i=new Uint8Array(4);e.push(i);var s=tr(n),a=s.length;e.push(s),n<=60?(a++,e.push(new Uint8Array([n-1<<2]))):n<=256?(a+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(a+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(a+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(a+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(t.slice(r,r+n)),a+=n,i[0]=0,i[1]=a&255,i[2]=a>>8&255,i[3]=a>>16&255,r+=n}return Qo(e)}function bB(t,e,r,n){var i=Kl(t),s=i.getUint32(4,!0),a=(n>1?12:8)+U2(s&(n>1?3470:398))*4,o=-1,l=-1,c=NaN,d=new Date(2001,0,1);s&512&&(o=i.getUint32(a,!0),a+=4),a+=U2(s&(n>1?12288:4096))*4,s&16&&(l=i.getUint32(a,!0),a+=4),s&32&&(c=i.getFloat64(a,!0),a+=8),s&64&&(d.setTime(d.getTime()+i.getFloat64(a,!0)*1e3),a+=8);var h;switch(t[2]){case 0:break;case 2:h={t:"n",v:c};break;case 3:h={t:"s",v:e[l]};break;case 5:h={t:"d",v:d};break;case 6:h={t:"b",v:c>0};break;case 7:h={t:"n",v:c/86400};break;case 8:h={t:"e",v:0};break;case 9:if(o>-1)h={t:"s",v:r[o]};else if(l>-1)h={t:"s",v:e[l]};else if(!isNaN(c))h={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return h}function RB(t,e,r){var n=Kl(t),i=n.getUint32(8,!0),s=12,a=-1,o=-1,l=NaN,c=NaN,d=new Date(2001,0,1);i&1&&(l=CB(t,s),s+=16),i&2&&(c=n.getFloat64(s,!0),s+=8),i&4&&(d.setTime(d.getTime()+n.getFloat64(s,!0)*1e3),s+=8),i&8&&(o=n.getUint32(s,!0),s+=4),i&16&&(a=n.getUint32(s,!0),s+=4);var h;switch(t[1]){case 0:break;case 2:h={t:"n",v:l};break;case 3:h={t:"s",v:e[o]};break;case 5:h={t:"d",v:d};break;case 6:h={t:"b",v:c>0};break;case 7:h={t:"n",v:c/86400};break;case 8:h={t:"e",v:0};break;case 9:if(a>-1)h={t:"s",v:r[a]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)));break;case 10:h={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)))}return h}function jg(t,e){var r=new Uint8Array(32),n=Kl(r),i=12,s=0;switch(r[0]=5,t.t){case"n":r[1]=2,FB(r,i,t.v),s|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,t.v?1:0,!0),s|=2,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,n.setUint32(i,e.indexOf(t.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,s,!0),r.slice(0,i)}function Vg(t,e){var r=new Uint8Array(32),n=Kl(r),i=12,s=0;switch(r[0]=3,t.t){case"n":r[2]=2,n.setFloat64(i,t.v,!0),s|=32,i+=8;break;case"b":r[2]=6,n.setFloat64(i,t.v?1:0,!0),s|=32,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,n.setUint32(i,e.indexOf(t.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,s,!0),r.slice(0,i)}function NB(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return bB(t,e,r,t[0]);case 5:return RB(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function Yn(t){var e=Kt(t);return pd(e[1][0].data)}function z2(t,e){var r=Kt(e.data),n=Or(r[1][0].data),i=r[3],s=[];return(i||[]).forEach(function(a){var o=Kt(a.data),l=Or(o[1][0].data)>>>0;switch(n){case 1:s[l]=dx(o[3][0].data);break;case 8:{var c=t[Yn(o[9][0].data)][0],d=Kt(c.data),h=t[Yn(d[1][0].data)][0],g=Or(h.meta[1][0].data);if(g!=2001)throw new Error("2000 unexpected reference to ".concat(g));var m=Kt(h.data);s[l]=m[3].map(function(y){return dx(y.data)}).join("")}break}}),s}function DB(t,e){var r,n,i,s,a,o,l,c,d,h,g,m,y,x,E=Kt(t),A=Or(E[1][0].data)>>>0,k=Or(E[2][0].data)>>>0,_=((n=(r=E[8])==null?void 0:r[0])==null?void 0:n.data)&&Or(E[8][0].data)>0||!1,P,K;if((s=(i=E[7])==null?void 0:i[0])!=null&&s.data&&e!=0)P=(o=(a=E[7])==null?void 0:a[0])==null?void 0:o.data,K=(c=(l=E[6])==null?void 0:l[0])==null?void 0:c.data;else if((h=(d=E[4])==null?void 0:d[0])!=null&&h.data&&e!=1)P=(m=(g=E[4])==null?void 0:g[0])==null?void 0:m.data,K=(x=(y=E[3])==null?void 0:y[0])==null?void 0:x.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var V=_?4:1,S=Kl(P),F=[],w=0;w<P.length/2;++w){var b=S.getUint16(w*2,!0);b<65535&&F.push([w,b])}if(F.length!=k)throw"Expected ".concat(k," cells, found ").concat(F.length);var N=[];for(w=0;w<F.length-1;++w)N[F[w][0]]=K.subarray(F[w][1]*V,F[w+1][1]*V);return F.length>=1&&(N[F[F.length-1][0]]=K.subarray(F[F.length-1][1]*V)),{R:A,cells:N}}function PB(t,e){var r,n=Kt(e.data),i=(r=n==null?void 0:n[7])!=null&&r[0]?Or(n[7][0].data)>>>0>0?1:0:-1,s=uv(n[5],function(a){return DB(a,i)});return{nrows:Or(n[4][0].data)>>>0,data:s.reduce(function(a,o){return a[o.R]||(a[o.R]=[]),o.cells.forEach(function(l,c){if(a[o.R][c])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(c));a[o.R][c]=l}),a},[])}}function OB(t,e,r){var n,i=Kt(e.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Or(i[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(s.e.c=(Or(i[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=Et(s);var a=Kt(i[4][0].data),o=z2(t,t[Yn(a[4][0].data)][0]),l=(n=a[17])!=null&&n[0]?z2(t,t[Yn(a[17][0].data)][0]):[],c=Kt(a[3][0].data),d=0;c[1].forEach(function(h){var g=Kt(h.data),m=t[Yn(g[2][0].data)][0],y=Or(m.meta[1][0].data);if(y!=6002)throw new Error("6001 unexpected reference to ".concat(y));var x=PB(t,m);x.data.forEach(function(E,A){E.forEach(function(k,_){var P=at({r:d+A,c:_}),K=NB(k,o,l);K&&(r[P]=K)})}),d+=x.nrows})}function MB(t,e){var r=Kt(e.data),n={"!ref":"A1"},i=t[Yn(r[2][0].data)],s=Or(i[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return OB(t,i[0],n),n}function LB(t,e){var r,n=Kt(e.data),i={name:(r=n[1])!=null&&r[0]?dx(n[1][0].data):"",sheets:[]},s=uv(n[2],Yn);return s.forEach(function(a){t[a].forEach(function(o){var l=Or(o.meta[1][0].data);l==6e3&&i.sheets.push(MB(t,o))})}),i}function BB(t,e){var r=gv(),n=Kt(e.data),i=uv(n[1],Yn);if(i.forEach(function(s){t[s].forEach(function(a){var o=Or(a.meta[1][0].data);if(o==2){var l=LB(t,a);l.sheets.forEach(function(c,d){mv(r,c,d==0?l.name:l.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Ug(t){var e,r,n,i,s={},a=[];if(t.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var c;try{c=is(l.content)}catch(h){return console.log("?? "+l.content.length+" "+(h.message||h))}var d;try{d=ns(c)}catch(h){return console.log("## "+(h.message||h))}d.forEach(function(h){s[h.id]=h.messages,a.push(h.id)})}}),!a.length)throw new Error("File has no messages");var o=((i=(n=(r=(e=s==null?void 0:s[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&Or(s[1][0].meta[1][0].data)==1&&s[1][0];if(o||a.forEach(function(l){s[l].forEach(function(c){var d=Or(c.meta[1][0].data)>>>0;if(d==1)if(!o)o=c;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return BB(s,o)}function jB(t,e,r){var n,i,s,a;if(!((n=t[6])!=null&&n[0])||!((i=t[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var o=((a=(s=t[8])==null?void 0:s[0])==null?void 0:a.data)&&Or(t[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,c=Kl(t[7][0].data),d=0,h=[],g=Kl(t[4][0].data),m=0,y=[],x=0;x<e.length;++x){if(e[x]==null){c.setUint16(x*2,65535,!0),g.setUint16(x*2,65535);continue}c.setUint16(x*2,d,!0),g.setUint16(x*2,m,!0);var E,A;switch(typeof e[x]){case"string":E=jg({t:"s",v:e[x]},r),A=Vg({t:"s",v:e[x]},r);break;case"number":E=jg({t:"n",v:e[x]},r),A=Vg({t:"n",v:e[x]},r);break;case"boolean":E=jg({t:"b",v:e[x]},r),A=Vg({t:"b",v:e[x]},r);break;default:throw new Error("Unsupported value "+e[x])}h.push(E),d+=E.length,y.push(A),m+=A.length,++l}for(t[2][0].data=tr(l);x<t[7][0].data.length/2;++x)c.setUint16(x*2,65535,!0),g.setUint16(x*2,65535,!0);return t[6][0].data=Qo(h),t[3][0].data=Qo(y),l}function VB(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Ni(r["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(Et(n)));var s=Zh(r,{range:n,header:1}),a=["~Sh33tJ5~"];s.forEach(function(ne){return ne.forEach(function(te){typeof te=="string"&&a.push(te)})});var o={},l=[],c=Ze.read(e.numbers,{type:"base64"});c.FileIndex.map(function(ne,te){return[ne,c.FullPaths[te]]}).forEach(function(ne){var te=ne[0],Y=ne[1];if(te.type==2&&te.name.match(/\.iwa/)){var ge=te.content,Ee=is(ge),Pe=ns(Ee);Pe.forEach(function(ke){l.push(ke.id),o[ke.id]={deps:[],location:Y,type:Or(ke.messages[0].meta[1][0].data)}})}}),l.sort(function(ne,te){return ne-te});var d=l.filter(function(ne){return ne>1}).map(function(ne){return[ne,tr(ne)]});c.FileIndex.map(function(ne,te){return[ne,c.FullPaths[te]]}).forEach(function(ne){var te=ne[0];if(ne[1],!!te.name.match(/\.iwa/)){var Y=ns(is(te.content));Y.forEach(function(ge){ge.messages.forEach(function(Ee){d.forEach(function(Pe){ge.messages.some(function(ke){return Or(ke.meta[1][0].data)!=11006&&kB(ke.data,Pe[1])})&&o[Pe[0]].deps.push(ge.id)})})})}});for(var h=Ze.find(c,o[1].location),g=ns(is(h.content)),m,y=0;y<g.length;++y){var x=g[y];x.id==1&&(m=x)}var E=Yn(Kt(m.messages[0].data)[1][0].data);for(h=Ze.find(c,o[E].location),g=ns(is(h.content)),y=0;y<g.length;++y)x=g[y],x.id==E&&(m=x);for(E=Yn(Kt(m.messages[0].data)[2][0].data),h=Ze.find(c,o[E].location),g=ns(is(h.content)),y=0;y<g.length;++y)x=g[y],x.id==E&&(m=x);for(E=Yn(Kt(m.messages[0].data)[2][0].data),h=Ze.find(c,o[E].location),g=ns(is(h.content)),y=0;y<g.length;++y)x=g[y],x.id==E&&(m=x);var A=Kt(m.messages[0].data);{A[6][0].data=tr(n.e.r+1),A[7][0].data=tr(n.e.c+1);var k=Yn(A[46][0].data),_=Ze.find(c,o[k].location),P=ns(is(_.content));{for(var K=0;K<P.length&&P[K].id!=k;++K);if(P[K].id!=k)throw"Bad ColumnRowUIDMapArchive";var V=Kt(P[K].messages[0].data);V[1]=[],V[2]=[],V[3]=[];for(var S=0;S<=n.e.c;++S){var F=[];F[1]=F[2]=[{type:0,data:tr(S+420690)}],V[1].push({type:2,data:bn(F)}),V[2].push({type:0,data:tr(S)}),V[3].push({type:0,data:tr(S)})}V[4]=[],V[5]=[],V[6]=[];for(var w=0;w<=n.e.r;++w)F=[],F[1]=F[2]=[{type:0,data:tr(w+726270)}],V[4].push({type:2,data:bn(F)}),V[5].push({type:0,data:tr(w)}),V[6].push({type:0,data:tr(w)});P[K].messages[0].data=bn(V)}_.content=Tc(Sc(P)),_.size=_.content.length,delete A[46];var b=Kt(A[4][0].data);{b[7][0].data=tr(n.e.r+1);var N=Kt(b[1][0].data),D=Yn(N[2][0].data);_=Ze.find(c,o[D].location),P=ns(is(_.content));{if(P[0].id!=D)throw"Bad HeaderStorageBucket";var R=Kt(P[0].messages[0].data);for(w=0;w<s.length;++w){var ze=Kt(R[2][0].data);ze[1][0].data=tr(w),ze[4][0].data=tr(s[w].length),R[2][w]={type:R[2][0].type,data:bn(ze)}}P[0].messages[0].data=bn(R)}_.content=Tc(Sc(P)),_.size=_.content.length;var _e=Yn(b[2][0].data);_=Ze.find(c,o[_e].location),P=ns(is(_.content));{if(P[0].id!=_e)throw"Bad HeaderStorageBucket";for(R=Kt(P[0].messages[0].data),S=0;S<=n.e.c;++S)ze=Kt(R[2][0].data),ze[1][0].data=tr(S),ze[4][0].data=tr(n.e.r+1),R[2][S]={type:R[2][0].type,data:bn(ze)};P[0].messages[0].data=bn(R)}_.content=Tc(Sc(P)),_.size=_.content.length;var Ie=Yn(b[4][0].data);(function(){for(var ne=Ze.find(c,o[Ie].location),te=ns(is(ne.content)),Y,ge=0;ge<te.length;++ge){var Ee=te[ge];Ee.id==Ie&&(Y=Ee)}var Pe=Kt(Y.messages[0].data);{Pe[3]=[];var ke=[];a.forEach(function(Q,Rt){ke[1]=[{type:0,data:tr(Rt)}],ke[2]=[{type:0,data:tr(1)}],ke[3]=[{type:2,data:AB(Q)}],Pe[3].push({type:2,data:bn(ke)})})}Y.messages[0].data=bn(Pe);var Se=Sc(te),tt=Tc(Se);ne.content=tt,ne.size=ne.content.length})();var De=Kt(b[3][0].data);{var we=De[1][0];delete De[2];var re=Kt(we.data);{var Ae=Yn(re[2][0].data);(function(){for(var ne=Ze.find(c,o[Ae].location),te=ns(is(ne.content)),Y,ge=0;ge<te.length;++ge){var Ee=te[ge];Ee.id==Ae&&(Y=Ee)}var Pe=Kt(Y.messages[0].data);{delete Pe[6],delete De[7];var ke=new Uint8Array(Pe[5][0].data);Pe[5]=[];for(var Se=0,tt=0;tt<=n.e.r;++tt){var Q=Kt(ke);Se+=jB(Q,s[tt],a),Q[1][0].data=tr(tt),Pe[5].push({data:bn(Q),type:2})}Pe[1]=[{type:0,data:tr(n.e.c+1)}],Pe[2]=[{type:0,data:tr(n.e.r+1)}],Pe[3]=[{type:0,data:tr(Se)}],Pe[4]=[{type:0,data:tr(n.e.r+1)}]}Y.messages[0].data=bn(Pe);var Rt=Sc(te),xt=Tc(Rt);ne.content=xt,ne.size=ne.content.length})()}we.data=bn(re)}b[3][0].data=bn(De)}A[4][0].data=bn(b)}m.messages[0].data=bn(A);var Oe=Sc(g),z=Tc(Oe);return h.content=z,h.size=h.content.length,c}function Ak(t){return function(r){for(var n=0;n!=t.length;++n){var i=t[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function fv(t){Ak([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function dv(t){Ak([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function UB(t){return At.WS.indexOf(t)>-1?"sheet":t==At.CS?"chart":t==At.DS?"dialog":t==At.MS?"macro":t&&t.length?t:"sheet"}function zB(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,UB(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function WB(t,e,r,n,i,s,a,o,l,c,d,h){try{s[n]=If(zi(t,r,!0),e);var g=tn(t,e),m;switch(o){case"sheet":m=fL(g,e,i,l,s[n],c,d,h);break;case"chart":if(m=dL(g,e,i,l,s[n],c,d,h),!m||!m["!drawel"])break;var y=df(m["!drawel"].Target,e),x=ld(y),E=JP(zi(t,y,!0),If(zi(t,x,!0),y)),A=df(E,y),k=ld(A);m=jM(zi(t,A,!0),A,l,If(zi(t,k,!0),A),c,m);break;case"macro":m=hL(g,e,i,l,s[n],c,d,h);break;case"dialog":m=pL(g,e,i,l,s[n],c,d,h);break;default:throw new Error("Unrecognized sheet type "+o)}a[n]=m;var _=[];s&&s[n]&&Mr(s[n]).forEach(function(P){var K="";if(s[n][P].Type==At.CMNT){K=df(s[n][P].Target,e);var V=vL(tn(t,K,!0),K,l);if(!V||!V.length)return;C2(m,V,!1)}s[n][P].Type==At.TCMNT&&(K=df(s[n][P].Target,e),_=_.concat(e8(tn(t,K,!0),l)))}),_&&_.length&&C2(m,_,!0,l.people||[])}catch(P){if(l.WTF)throw P}}function ts(t){return t.charAt(0)=="/"?t.slice(1):t}function HB(t,e){if(Fu(),e=e||{},fv(e),ss(t,"META-INF/manifest.xml")||ss(t,"objectdata.xml"))return B2(t,e);if(ss(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Ug<"u"){if(t.FileIndex)return Ug(t);var r=Ze.utils.cfb_new();return X_(t).forEach(function(ze){wt(r,ze,tN(t,ze))}),Ug(r)}throw new Error("Unsupported NUMBERS file")}if(!ss(t,"[Content_Types].xml"))throw ss(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):ss(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=X_(t),i=XN(zi(t,"[Content_Types].xml")),s=!1,a,o;if(i.workbooks.length===0&&(o="xl/workbook.xml",tn(t,o,!0)&&i.workbooks.push(o)),i.workbooks.length===0){if(o="xl/workbook.bin",!tn(t,o,!0))throw new Error("Could not find workbook");i.workbooks.push(o),s=!0}i.workbooks[0].slice(-3)=="bin"&&(s=!0);var l={},c={};if(!e.bookSheets&&!e.bookProps){if(bf=[],i.sst)try{bf=xL(tn(t,ts(i.sst)),i.sst,e)}catch(ze){if(e.WTF)throw ze}e.cellStyles&&i.themes.length&&(l=mL(zi(t,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],e)),i.style&&(c=gL(tn(t,ts(i.style)),i.style,l,e))}i.links.map(function(ze){try{var _e=If(zi(t,ld(ts(ze))),ze);return _L(tn(t,ts(ze)),_e,ze,e)}catch{}});var d=uL(tn(t,ts(i.workbooks[0])),i.workbooks[0],e),h={},g="";i.coreprops.length&&(g=tn(t,ts(i.coreprops[0]),!0),g&&(h=hA(g)),i.extprops.length!==0&&(g=tn(t,ts(i.extprops[0]),!0),g&&t3(g,h,e)));var m={};(!e.bookSheets||e.bookProps)&&i.custprops.length!==0&&(g=zi(t,ts(i.custprops[0]),!0),g&&(m=n3(g,e)));var y={};if((e.bookSheets||e.bookProps)&&(d.Sheets?a=d.Sheets.map(function(_e){return _e.name}):h.Worksheets&&h.SheetNames.length>0&&(a=h.SheetNames),e.bookProps&&(y.Props=h,y.Custprops=m),e.bookSheets&&typeof a<"u"&&(y.SheetNames=a),e.bookSheets?y.SheetNames:e.bookProps))return y;a={};var x={};e.bookDeps&&i.calcchain&&(x=yL(tn(t,ts(i.calcchain)),i.calcchain));var E=0,A={},k,_;{var P=d.Sheets;h.Worksheets=P.length,h.SheetNames=[];for(var K=0;K!=P.length;++K)h.SheetNames[K]=P[K].name}var V=s?"bin":"xml",S=i.workbooks[0].lastIndexOf("/"),F=(i.workbooks[0].slice(0,S+1)+"_rels/"+i.workbooks[0].slice(S+1)+".rels").replace(/^\//,"");ss(t,F)||(F="xl/_rels/workbook."+V+".rels");var w=If(zi(t,F,!0),F.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(e.xlmeta=EL(tn(t,ts(i.metadata[0])),i.metadata[0],e)),(i.people||[]).length>=1&&(e.people=r8(tn(t,ts(i.people[0])),e)),w&&(w=zB(w,d.Sheets));var b=tn(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(E=0;E!=h.Worksheets;++E){var N="sheet";if(w&&w[E]?(k="xl/"+w[E][1].replace(/[\/]?xl\//,""),ss(t,k)||(k=w[E][1]),ss(t,k)||(k=F.replace(/_rels\/.*$/,"")+w[E][1]),N=w[E][2]):(k="xl/worksheets/sheet"+(E+1-b)+"."+V,k=k.replace(/sheet0\./,"sheet.")),_=k.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(E!=e.sheets)continue e;break;case"string":if(h.SheetNames[E].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var D=!1,R=0;R!=e.sheets.length;++R)typeof e.sheets[R]=="number"&&e.sheets[R]==E&&(D=1),typeof e.sheets[R]=="string"&&e.sheets[R].toLowerCase()==h.SheetNames[E].toLowerCase()&&(D=1);if(!D)continue e}}WB(t,k,_,h.SheetNames[E],E,A,a,N,e,d,l,c)}return y={Directory:i,Workbook:d,Props:h,Custprops:m,Deps:x,Sheets:a,SheetNames:h.SheetNames,Strings:bf,Styles:c,Themes:l,SSF:vr(st)},e&&e.bookFiles&&(t.files?(y.keys=n,y.files=t.files):(y.keys=[],y.files={},t.FullPaths.forEach(function(ze,_e){ze=ze.replace(/^Root Entry[\/]/,""),y.keys.push(ze),y.files[ze]=t.FileIndex[_e]}))),e&&e.bookVBA&&(i.vba.length>0?y.vbaraw=tn(t,ts(i.vba[0]),!0):i.defaults&&i.defaults.bin===u8&&(y.vbaraw=tn(t,"xl/vbaProject.bin",!0))),y}function $B(t,e){var r=e||{},n="Workbook",i=Ze.find(t,n);try{if(n="/!DataSpaces/Version",i=Ze.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(E6(i.content),n="/!DataSpaces/DataSpaceMap",i=Ze.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=S6(i.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=Ze.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=T6(i.content);if(a.length!=1||a[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=Ze.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);k6(i.content)}catch{}if(n="/EncryptionInfo",i=Ze.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=C6(i.content);if(n="/EncryptedPackage",i=Ze.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],i.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function GB(t,e){return e.bookType=="ods"?Tk(t,e):e.bookType=="numbers"?VB(t,e):e.bookType=="xlsb"?KB(t,e):XB(t,e)}function KB(t,e){zc=1024,t&&!t.SSF&&(t.SSF=vr(st)),t&&t.SSF&&(Fu(),Pp(t.SSF),e.revssf=Mp(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Rf?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",n=JA.indexOf(e.bookType)>-1,i=Q1();dv(e=e||{});var s=L1(),a="",o=0;if(e.cellXfs=[],al(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),a="docProps/core.xml",wt(s,a,pA(t.Props,e)),i.coreprops.push(a),rr(e.rels,2,a,At.CORE_PROPS),a="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],c=0;c<t.SheetNames.length;++c)(t.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(t.SheetNames[c]);t.Props.SheetNames=l}for(t.Props.Worksheets=t.Props.SheetNames.length,wt(s,a,xA(t.Props)),i.extprops.push(a),rr(e.rels,3,a,At.EXT_PROPS),t.Custprops!==t.Props&&Mr(t.Custprops||{}).length>0&&(a="docProps/custom.xml",wt(s,a,vA(t.Custprops)),i.custprops.push(a),rr(e.rels,4,a,At.CUST_PROPS)),o=1;o<=t.SheetNames.length;++o){var d={"!id":{}},h=t.Sheets[t.SheetNames[o-1]],g=(h||{})["!type"]||"sheet";switch(g){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,wt(s,a,SL(o-1,a,e,t,d)),i.sheets.push(a),rr(e.wbrels,-1,"worksheets/sheet"+o+"."+r,At.WS[0])}if(h){var m=h["!comments"],y=!1,x="";m&&m.length>0&&(x="xl/comments"+o+"."+r,wt(s,x,kL(m,x)),i.comments.push(x),rr(d,-1,"../comments"+o+"."+r,At.CMNT),y=!0),h["!legacy"]&&y&&wt(s,"xl/drawings/vmlDrawing"+o+".vml",qA(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}d["!id"].rId1&&wt(s,ld(a),Jc(d))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+r,wt(s,a,AL(e.Strings,a,e)),i.strs.push(a),rr(e.wbrels,-1,"sharedStrings."+r,At.SST)),a="xl/workbook."+r,wt(s,a,wL(t,a)),i.workbooks.push(a),rr(e.rels,1,a,At.WB),a="xl/theme/theme1.xml",wt(s,a,nv(t.Themes,e)),i.themes.push(a),rr(e.wbrels,-1,"theme/theme1.xml",At.THEME),a="xl/styles."+r,wt(s,a,TL(t,a,e)),i.styles.push(a),rr(e.wbrels,-1,"styles."+r,At.STY),t.vbaraw&&n&&(a="xl/vbaProject.bin",wt(s,a,t.vbaraw),i.vba.push(a),rr(e.wbrels,-1,"vbaProject.bin",At.VBA)),a="xl/metadata."+r,wt(s,a,CL(a)),i.metadata.push(a),rr(e.wbrels,-1,"metadata."+r,At.XLMETA),wt(s,"[Content_Types].xml",fA(i,e)),wt(s,"_rels/.rels",Jc(e.rels)),wt(s,"xl/_rels/workbook."+r+".rels",Jc(e.wbrels)),delete e.revssf,delete e.ssf,s}function XB(t,e){zc=1024,t&&!t.SSF&&(t.SSF=vr(st)),t&&t.SSF&&(Fu(),Pp(t.SSF),e.revssf=Mp(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Rf?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",n=JA.indexOf(e.bookType)>-1,i=Q1();dv(e=e||{});var s=L1(),a="",o=0;if(e.cellXfs=[],al(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),a="docProps/core.xml",wt(s,a,pA(t.Props,e)),i.coreprops.push(a),rr(e.rels,2,a,At.CORE_PROPS),a="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],c=0;c<t.SheetNames.length;++c)(t.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(t.SheetNames[c]);t.Props.SheetNames=l}t.Props.Worksheets=t.Props.SheetNames.length,wt(s,a,xA(t.Props)),i.extprops.push(a),rr(e.rels,3,a,At.EXT_PROPS),t.Custprops!==t.Props&&Mr(t.Custprops||{}).length>0&&(a="docProps/custom.xml",wt(s,a,vA(t.Custprops)),i.custprops.push(a),rr(e.rels,4,a,At.CUST_PROPS));var d=["SheetJ5"];for(e.tcid=0,o=1;o<=t.SheetNames.length;++o){var h={"!id":{}},g=t.Sheets[t.SheetNames[o-1]],m=(g||{})["!type"]||"sheet";switch(m){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,wt(s,a,ck(o-1,e,t,h)),i.sheets.push(a),rr(e.wbrels,-1,"worksheets/sheet"+o+"."+r,At.WS[0])}if(g){var y=g["!comments"],x=!1,E="";if(y&&y.length>0){var A=!1;y.forEach(function(k){k[1].forEach(function(_){_.T==!0&&(A=!0)})}),A&&(E="xl/threadedComments/threadedComment"+o+"."+r,wt(s,E,t8(y,d,e)),i.threadedcomments.push(E),rr(h,-1,"../threadedComments/threadedComment"+o+"."+r,At.TCMNT)),E="xl/comments"+o+"."+r,wt(s,E,QA(y)),i.comments.push(E),rr(h,-1,"../comments"+o+"."+r,At.CMNT),x=!0}g["!legacy"]&&x&&wt(s,"xl/drawings/vmlDrawing"+o+".vml",qA(o,g["!comments"])),delete g["!comments"],delete g["!legacy"]}h["!id"].rId1&&wt(s,ld(a),Jc(h))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+r,wt(s,a,BA(e.Strings,e)),i.strs.push(a),rr(e.wbrels,-1,"sharedStrings."+r,At.SST)),a="xl/workbook."+r,wt(s,a,pk(t)),i.workbooks.push(a),rr(e.rels,1,a,At.WB),a="xl/theme/theme1.xml",wt(s,a,nv(t.Themes,e)),i.themes.push(a),rr(e.wbrels,-1,"theme/theme1.xml",At.THEME),a="xl/styles."+r,wt(s,a,GA(t,e)),i.styles.push(a),rr(e.wbrels,-1,"styles."+r,At.STY),t.vbaraw&&n&&(a="xl/vbaProject.bin",wt(s,a,t.vbaraw),i.vba.push(a),rr(e.wbrels,-1,"vbaProject.bin",At.VBA)),a="xl/metadata."+r,wt(s,a,YA()),i.metadata.push(a),rr(e.wbrels,-1,"metadata."+r,At.XLMETA),d.length>1&&(a="xl/persons/person.xml",wt(s,a,n8(d)),i.people.push(a),rr(e.wbrels,-1,"persons/person.xml",At.PEOPLE)),wt(s,"[Content_Types].xml",fA(i,e)),wt(s,"_rels/.rels",Jc(e.rels)),wt(s,"xl/_rels/workbook."+r+".rels",Jc(e.wbrels)),delete e.revssf,delete e.ssf,s}function hv(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=Ki(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function YB(t,e){return Ze.find(t,"EncryptedPackage")?$B(t,e):vk(t,e)}function qB(t,e){var r,n=t,i=e||{};return i.type||(i.type=Tt&&Buffer.isBuffer(t)?"buffer":"base64"),r=VT(n,i),HB(r,i)}function kk(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return ux(t.slice(r),e);default:break e}return hu.to_workbook(t,e)}function QB(t,e){var r="",n=hv(t,e);switch(e.type){case"base64":r=Ki(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=Wl(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=or(r)),e.type="binary",kk(r,e)}function JB(t,e){var r=t;return e.type=="base64"&&(r=Ki(r)),r=rd.utils.decode(1200,r.slice(2),"str"),e.type="binary",kk(r,e)}function ZB(t){return t.match(/[^\x00-\x7F]/)?sa(t):t}function zg(t,e,r,n){return n?(r.type="string",hu.to_workbook(t,r)):hu.to_workbook(e,r)}function Wc(t,e){N1();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return Wc(new Uint8Array(t),(r=vr(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,i=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),eu={},r.dateNF&&(eu.dateNF=r.dateNF),r.type||(r.type=Tt&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=Tt?"buffer":"binary",n=KR(t),typeof Uint8Array<"u"&&!Tt&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=ZB(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var a=new ArrayBuffer(3),o=new Uint8Array(a);if(o.foo="bar",!o.foo)return r=vr(r),r.type="array",Wc(D1(n),r)}switch((i=hv(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return YB(Ze.read(n,r),r);break;case 9:if(i[1]<=8)return vk(n,r);break;case 60:return ux(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return i6(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return MA.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?qB(n,r):zg(t,n,r,s);case 239:return i[3]===60?ux(n,r):zg(t,n,r,s);case 255:if(i[1]===254)return JB(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return Dl.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return Dl.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return cx.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return WA.to_workbook(n,r);break;case 10:case 13:case 32:return QB(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return n6.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?cx.to_workbook(n,r):zg(t,n,r,s)}function Ck(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return Rd(e.file,Ze.write(t,{type:Tt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return Ze.write(t,e)}function e9(t,e){var r=vr(e||{}),n=GB(t,r);return t9(n,r)}function t9(t,e){var r={},n=Tt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=n;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var i=t.FullPaths?Ze.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(e.type=="binary"||e.type=="base64")return i;i=new Uint8Array(Dp(i))}return e.password&&typeof encrypt_agile<"u"?Ck(encrypt_agile(i,e.password),e):e.type==="file"?Rd(e.file,i):e.type=="string"?or(i):i}function r9(t,e){var r=e||{},n=ZL(t,r);return Ck(n,r)}function ra(t,e,r){r||(r="");var n=r+t;switch(e.type){case"base64":return nd(sa(n));case"binary":return sa(n);case"string":return t;case"file":return Rd(e.file,n,"utf8");case"buffer":return Tt?Xa(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):ra(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function n9(t,e){switch(e.type){case"base64":return nd(t);case"binary":return t;case"string":return t;case"file":return Rd(e.file,t,"binary");case"buffer":return Tt?Xa(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function L0(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",n=0;n<t.length;++n)r+=String.fromCharCode(t[n]);return e.type=="base64"?nd(r):e.type=="string"?or(r):r;case"file":return Rd(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function Fk(t,e){N1(),YM(t);var r=vr(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=Fk(t,r);return r.type="array",Dp(n)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=t.SheetNames.indexOf(r.sheet),!t.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return ra(GL(t,r),r);case"slk":case"sylk":return ra(OA.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"htm":case"html":return ra(_k(t.Sheets[t.SheetNames[i]],r),r);case"txt":return n9(Ik(t.Sheets[t.SheetNames[i]],r),r);case"csv":return ra(pv(t.Sheets[t.SheetNames[i]],r),r,"\uFEFF");case"dif":return ra(MA.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"dbf":return L0(cx.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"prn":return ra(hu.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"rtf":return ra(WA.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"eth":return ra(LA.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"fods":return ra(Tk(t,r),r);case"wk1":return L0(Dl.sheet_to_wk1(t.Sheets[t.SheetNames[i]],r),r);case"wk3":return L0(Dl.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),L0(yk(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),r9(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return e9(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function i9(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(t.bookType=r.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function Ac(t,e,r){var n={};return n.type="file",n.file=e,i9(n),Fk(t,n)}function s9(t,e,r,n,i,s,a,o){var l=Kr(r),c=o.defval,d=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),h=!0,g=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(g,"__rowNum__",{value:r,enumerable:!1})}catch{g.__rowNum__=r}else g.__rowNum__=r;if(!a||t[r])for(var m=e.s.c;m<=e.e.c;++m){var y=a?t[r][m]:t[n[m]+l];if(y===void 0||y.t===void 0){if(c===void 0)continue;s[m]!=null&&(g[s[m]]=c);continue}var x=y.v;switch(y.t){case"z":if(x==null)break;continue;case"e":x=x==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+y.t)}if(s[m]!=null){if(x==null)if(y.t=="e"&&x===null)g[s[m]]=null;else if(c!==void 0)g[s[m]]=c;else if(d&&x===null)g[s[m]]=null;else continue;else g[s[m]]=d&&(y.t!=="n"||y.t==="n"&&o.rawNumbers!==!1)?x:Ua(y,x,o);x!=null&&(h=!1)}}return{row:g,isempty:h}}function Zh(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,s=[],a=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=e||{},d=c.range!=null?c.range:t["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof d){case"string":l=Wt(d);break;case"number":l=Wt(t["!ref"]),l.s.r=d;break;default:l=d}n>0&&(i=0);var h=Kr(l.s.r),g=[],m=[],y=0,x=0,E=Array.isArray(t),A=l.s.r,k=0,_={};E&&!t[A]&&(t[A]=[]);var P=c.skipHidden&&t["!cols"]||[],K=c.skipHidden&&t["!rows"]||[];for(k=l.s.c;k<=l.e.c;++k)if(!(P[k]||{}).hidden)switch(g[k]=Ar(k),r=E?t[A][k]:t[g[k]+h],n){case 1:s[k]=k-l.s.c;break;case 2:s[k]=g[k];break;case 3:s[k]=c.header[k-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=a=Ua(r,null,c),x=_[a]||0,!x)_[a]=1;else{do o=a+"_"+x++;while(_[o]);_[a]=x,_[o]=1}s[k]=o}for(A=l.s.r+i;A<=l.e.r;++A)if(!(K[A]||{}).hidden){var V=s9(t,l,A,g,n,s,E,c);(V.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(m[y++]=V.row)}return m.length=y,m}var W2=/"/g;function a9(t,e,r,n,i,s,a,o){for(var l=!0,c=[],d="",h=Kr(r),g=e.s.c;g<=e.e.c;++g)if(n[g]){var m=o.dense?(t[r]||[])[g]:t[n[g]+h];if(m==null)d="";else if(m.v!=null){l=!1,d=""+(o.rawNumbers&&m.t=="n"?m.v:Ua(m,null,o));for(var y=0,x=0;y!==d.length;++y)if((x=d.charCodeAt(y))===i||x===s||x===34||o.forceQuotes){d='"'+d.replace(W2,'""')+'"';break}d=="ID"&&(d='"ID"')}else m.f!=null&&!m.F?(l=!1,d="="+m.f,d.indexOf(",")>=0&&(d='"'+d.replace(W2,'""')+'"')):d="";c.push(d)}return o.blankrows===!1&&l?null:c.join(a)}function pv(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var i=Wt(t["!ref"]),s=n.FS!==void 0?n.FS:",",a=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),c=new RegExp((s=="|"?"\\|":s)+"+$"),d="",h=[];n.dense=Array.isArray(t);for(var g=n.skipHidden&&t["!cols"]||[],m=n.skipHidden&&t["!rows"]||[],y=i.s.c;y<=i.e.c;++y)(g[y]||{}).hidden||(h[y]=Ar(y));for(var x=0,E=i.s.r;E<=i.e.r;++E)(m[E]||{}).hidden||(d=a9(t,i,E,h,a,l,s,n),d!=null&&(n.strip&&(d=d.replace(c,"")),(d||n.blankrows!==!1)&&r.push((x++?o:"")+d)));return delete n.dense,r.join("")}function Ik(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=pv(t,e);return r}function o9(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var i=Wt(t["!ref"]),s="",a=[],o,l=[],c=Array.isArray(t);for(o=i.s.c;o<=i.e.c;++o)a[o]=Ar(o);for(var d=i.s.r;d<=i.e.r;++d)for(s=Kr(d),o=i.s.c;o<=i.e.c;++o)if(e=a[o]+s,r=c?(t[d]||[])[o]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=e+"="+n}return l}function bk(t,e,r){var n=r||{},i=+!n.skipHeader,s=t||{},a=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?kr(n.origin):n.origin;a=l.r,o=l.c}var c,d={s:{c:0,r:0},e:{c:o,r:a+e.length-1+i}};if(s["!ref"]){var h=Wt(s["!ref"]);d.e.c=Math.max(d.e.c,h.e.c),d.e.r=Math.max(d.e.r,h.e.r),a==-1&&(a=h.e.r+1,d.e.r=a+e.length-1+i)}else a==-1&&(a=0,d.e.r=e.length-1+i);var g=n.header||[],m=0;e.forEach(function(x,E){Mr(x).forEach(function(A){(m=g.indexOf(A))==-1&&(g[m=g.length]=A);var k=x[A],_="z",P="",K=at({c:o+m,r:a+E+i});c=gd(s,K),k&&typeof k=="object"&&!(k instanceof Date)?s[K]=k:(typeof k=="number"?_="n":typeof k=="boolean"?_="b":typeof k=="string"?_="s":k instanceof Date?(_="d",n.cellDates||(_="n",k=vn(k)),P=n.dateNF||st[14]):k===null&&n.nullError&&(_="e",k=0),c?(c.t=_,c.v=k,delete c.w,delete c.R,P&&(c.z=P)):s[K]=c={t:_,v:k},P&&(c.z=P))})}),d.e.c=Math.max(d.e.c,o+g.length-1);var y=Kr(a);if(i)for(m=0;m<g.length;++m)s[Ar(m+o)+y]={t:"s",v:g[m]};return s["!ref"]=Et(d),s}function l9(t,e){return bk(null,t,e)}function gd(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=kr(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?gd(t,at(e)):gd(t,at({r:e,c:r||0}))}function c9(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function gv(){return{SheetNames:[],Sheets:{}}}function mv(t,e,r,n){var i=1;if(!r)for(;i<=65535&&t.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var a=s&&s[1]||r;for(++i;i<=65535&&t.SheetNames.indexOf(r=a+i)!=-1;++i);}if(hk(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function u9(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=c9(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function f9(t,e){return t.z=e,t}function Rk(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function d9(t,e,r){return Rk(t,"#"+e,r)}function h9(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function p9(t,e,r,n){for(var i=typeof e!="string"?e:Wt(e),s=typeof e=="string"?e:Et(e),a=i.s.r;a<=i.e.r;++a)for(var o=i.s.c;o<=i.e.c;++o){var l=gd(t,a,o);l.t="n",l.F=s,delete l.v,a==i.s.r&&o==i.s.c&&(l.f=r,n&&(l.D=!0))}return t}var Rr={encode_col:Ar,encode_row:Kr,encode_cell:at,encode_range:Et,decode_col:$1,decode_row:H1,split_cell:AN,decode_cell:kr,decode_range:Ni,format_cell:Ua,sheet_add_aoa:iA,sheet_add_json:bk,sheet_add_dom:Ek,aoa_to_sheet:Iu,json_to_sheet:l9,table_to_sheet:wk,table_to_book:EB,sheet_to_csv:pv,sheet_to_txt:Ik,sheet_to_json:Zh,sheet_to_html:_k,sheet_to_formulae:o9,sheet_to_row_object_array:Zh,sheet_get_cell:gd,book_new:gv,book_append_sheet:mv,book_set_sheet_visibility:u9,cell_set_number_format:f9,cell_set_hyperlink:Rk,cell_set_internal_link:d9,cell_add_comment:h9,sheet_set_array_formula:p9,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var g9={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m9=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),St=(t,e)=>{const r=ye.forwardRef(({color:n="currentColor",size:i=24,strokeWidth:s=2,absoluteStrokeWidth:a,className:o="",children:l,...c},d)=>ye.createElement("svg",{ref:d,...g9,width:i,height:i,stroke:n,strokeWidth:a?Number(s)*24/Number(i):s,className:["lucide",`lucide-${m9(t)}`,o].join(" "),...c},[...e.map(([h,g])=>ye.createElement(h,g)),...Array.isArray(l)?l:[l]]));return r.displayName=`${t}`,r};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H2=St("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $2=St("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x9=St("BellRing",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}],["path",{d:"M4 2C2.8 3.7 2 5.7 2 8",key:"tap9e0"}],["path",{d:"M22 8c0-2.3-.8-4.3-2-6",key:"5bb3ad"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G2=St("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K2=St("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v9=St("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y9=St("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wg=St("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X2=St("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _9=St("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hg=St("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $g=St("Clipboard",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E9=St("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xo=St("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w9=St("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B0=St("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rf=St("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gg=St("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kg=St("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y2=St("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j0=St("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xg=St("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S9=St("Merge",[["path",{d:"m8 6 4-4 4 4",key:"ybng9g"}],["path",{d:"M12 2v10.3a4 4 0 0 1-1.172 2.872L4 22",key:"1hyw0i"}],["path",{d:"m20 22-5-5",key:"1m27yz"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T9=St("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A9=St("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V0=St("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q2=St("PlusCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nf=St("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yg=St("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vl=St("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1-2-1Z",key:"wqdwcb"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17V7",key:"pyj7ub"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k9=St("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U0=St("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q2=St("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C9=St("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J2=St("Table",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F9=St("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2h0a3.13 3.13 0 0 1 3 3.88Z",key:"y3tblf"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fs=St("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ea=St("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z2=St("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const El=St("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);var eE={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nk=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=i&63|128):(i&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=i&63|128):(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=i&63|128)}return e},I9=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const i=t[r++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[r++];e[n++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[r++],a=t[r++],o=t[r++],l=((i&7)<<18|(s&63)<<12|(a&63)<<6|o&63)-65536;e[n++]=String.fromCharCode(55296+(l>>10)),e[n++]=String.fromCharCode(56320+(l&1023))}else{const s=t[r++],a=t[r++];e[n++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},Dk={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<t.length;i+=3){const s=t[i],a=i+1<t.length,o=a?t[i+1]:0,l=i+2<t.length,c=l?t[i+2]:0,d=s>>2,h=(s&3)<<4|o>>4;let g=(o&15)<<2|c>>6,m=c&63;l||(m=64,a||(g=64)),n.push(r[d],r[h],r[g],r[m])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Nk(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):I9(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<t.length;){const s=r[t.charAt(i++)],o=i<t.length?r[t.charAt(i)]:0;++i;const c=i<t.length?r[t.charAt(i)]:64;++i;const h=i<t.length?r[t.charAt(i)]:64;if(++i,s==null||o==null||c==null||h==null)throw new b9;const g=s<<2|o>>4;if(n.push(g),c!==64){const m=o<<4&240|c>>2;if(n.push(m),h!==64){const y=c<<6&192|h;n.push(y)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class b9 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const R9=function(t){const e=Nk(t);return Dk.encodeByteArray(e,!0)},ep=function(t){return R9(t).replace(/\./g,"")},Pk=function(t){try{return Dk.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N9(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D9=()=>N9().__FIREBASE_DEFAULTS__,P9=()=>{if(typeof process>"u"||typeof eE>"u")return;const t=eE.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},O9=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&Pk(t[1]);return e&&JSON.parse(e)},zp=()=>{try{return D9()||P9()||O9()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},Ok=t=>{var e,r;return(r=(e=zp())===null||e===void 0?void 0:e.emulatorHosts)===null||r===void 0?void 0:r[t]},M9=t=>{const e=Ok(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},Mk=()=>{var t;return(t=zp())===null||t===void 0?void 0:t.config},Lk=t=>{var e;return(e=zp())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L9{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B9(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t);return[ep(JSON.stringify(r)),ep(JSON.stringify(a)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function si(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function j9(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(si())}function V9(){var t;const e=(t=zp())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function U9(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function z9(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function W9(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function H9(){const t=si();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function $9(){return!V9()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function G9(){try{return typeof indexedDB=="object"}catch{return!1}}function K9(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X9="FirebaseError";class Qa extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=X9,Object.setPrototypeOf(this,Qa.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,jd.prototype.create)}}class jd{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?Y9(s,n):"Error",o=`${this.serviceName}: ${a} (${i}).`;return new Qa(i,o,n)}}function Y9(t,e){return t.replace(q9,(r,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const q9=/\{\$([^}]+)}/g;function Q9(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function tp(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const i of r){if(!n.includes(i))return!1;const s=t[i],a=e[i];if(tE(s)&&tE(a)){if(!tp(s,a))return!1}else if(s!==a)return!1}for(const i of n)if(!r.includes(i))return!1;return!0}function tE(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vd(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function J9(t,e){const r=new Z9(t,e);return r.subscribe.bind(r)}class Z9{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let i;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");ej(e,["next","error","complete"])?i=e:i={next:e,error:r,complete:n},i.next===void 0&&(i.next=qg),i.error===void 0&&(i.error=qg),i.complete===void 0&&(i.complete=qg);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function ej(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function qg(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vs(t){return t&&t._delegate?t._delegate:t}class Xl{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wl="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tj{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new L9;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:r});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){var r;const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(r=e==null?void 0:e.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(nj(e))try{this.getOrInitializeService({instanceIdentifier:wl})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(r);try{const s=this.getOrInitializeService({instanceIdentifier:i});n.resolve(s)}catch{}}}}clearInstance(e=wl){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=wl){return this.instances.has(e)}getOptions(e=wl){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[s,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(s);n===o&&a.resolve(i)}return i}onInit(e,r){var n;const i=this.normalizeInstanceIdentifier(r),s=(n=this.onInitCallbacks.get(i))!==null&&n!==void 0?n:new Set;s.add(e),this.onInitCallbacks.set(i,s);const a=this.instances.get(i);return a&&e(a,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const i of n)try{i(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:rj(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=wl){return this.component?this.component.multipleInstances?e:wl:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function rj(t){return t===wl?void 0:t}function nj(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ij{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new tj(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Pt;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Pt||(Pt={}));const sj={debug:Pt.DEBUG,verbose:Pt.VERBOSE,info:Pt.INFO,warn:Pt.WARN,error:Pt.ERROR,silent:Pt.SILENT},aj=Pt.INFO,oj={[Pt.DEBUG]:"log",[Pt.VERBOSE]:"log",[Pt.INFO]:"info",[Pt.WARN]:"warn",[Pt.ERROR]:"error"},lj=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),i=oj[e];if(i)console[i](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class xv{constructor(e){this.name=e,this._logLevel=aj,this._logHandler=lj,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Pt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?sj[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Pt.DEBUG,...e),this._logHandler(this,Pt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Pt.VERBOSE,...e),this._logHandler(this,Pt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Pt.INFO,...e),this._logHandler(this,Pt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Pt.WARN,...e),this._logHandler(this,Pt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Pt.ERROR,...e),this._logHandler(this,Pt.ERROR,...e)}}const cj=(t,e)=>e.some(r=>t instanceof r);let rE,nE;function uj(){return rE||(rE=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function fj(){return nE||(nE=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Bk=new WeakMap,hx=new WeakMap,jk=new WeakMap,Qg=new WeakMap,vv=new WeakMap;function dj(t){const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",a)},s=()=>{r(Uo(t.result)),i()},a=()=>{n(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",a)});return e.then(r=>{r instanceof IDBCursor&&Bk.set(r,t)}).catch(()=>{}),vv.set(e,t),e}function hj(t){if(hx.has(t))return;const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",a),t.removeEventListener("abort",a)},s=()=>{r(),i()},a=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",a),t.addEventListener("abort",a)});hx.set(t,e)}let px={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return hx.get(t);if(e==="objectStoreNames")return t.objectStoreNames||jk.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Uo(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function pj(t){px=t(px)}function gj(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(Jg(this),e,...r);return jk.set(n,e.sort?e.sort():[e]),Uo(n)}:fj().includes(t)?function(...e){return t.apply(Jg(this),e),Uo(Bk.get(this))}:function(...e){return Uo(t.apply(Jg(this),e))}}function mj(t){return typeof t=="function"?gj(t):(t instanceof IDBTransaction&&hj(t),cj(t,uj())?new Proxy(t,px):t)}function Uo(t){if(t instanceof IDBRequest)return dj(t);if(Qg.has(t))return Qg.get(t);const e=mj(t);return e!==t&&(Qg.set(t,e),vv.set(e,t)),e}const Jg=t=>vv.get(t);function xj(t,e,{blocked:r,upgrade:n,blocking:i,terminated:s}={}){const a=indexedDB.open(t,e),o=Uo(a);return n&&a.addEventListener("upgradeneeded",l=>{n(Uo(a.result),l.oldVersion,l.newVersion,Uo(a.transaction),l)}),r&&a.addEventListener("blocked",l=>r(l.oldVersion,l.newVersion,l)),o.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",c=>i(c.oldVersion,c.newVersion,c))}).catch(()=>{}),o}const vj=["get","getKey","getAll","getAllKeys","count"],yj=["put","add","delete","clear"],Zg=new Map;function iE(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Zg.get(e))return Zg.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,i=yj.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||vj.includes(r)))return;const s=async function(a,...o){const l=this.transaction(a,i?"readwrite":"readonly");let c=l.store;return n&&(c=c.index(o.shift())),(await Promise.all([c[r](...o),i&&l.done]))[0]};return Zg.set(e,s),s}pj(t=>({...t,get:(e,r,n)=>iE(e,r)||t.get(e,r,n),has:(e,r)=>!!iE(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _j{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(Ej(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function Ej(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const gx="@firebase/app",sE="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const za=new xv("@firebase/app"),wj="@firebase/app-compat",Sj="@firebase/analytics-compat",Tj="@firebase/analytics",Aj="@firebase/app-check-compat",kj="@firebase/app-check",Cj="@firebase/auth",Fj="@firebase/auth-compat",Ij="@firebase/database",bj="@firebase/data-connect",Rj="@firebase/database-compat",Nj="@firebase/functions",Dj="@firebase/functions-compat",Pj="@firebase/installations",Oj="@firebase/installations-compat",Mj="@firebase/messaging",Lj="@firebase/messaging-compat",Bj="@firebase/performance",jj="@firebase/performance-compat",Vj="@firebase/remote-config",Uj="@firebase/remote-config-compat",zj="@firebase/storage",Wj="@firebase/storage-compat",Hj="@firebase/firestore",$j="@firebase/vertexai-preview",Gj="@firebase/firestore-compat",Kj="firebase",Xj="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mx="[DEFAULT]",Yj={[gx]:"fire-core",[wj]:"fire-core-compat",[Tj]:"fire-analytics",[Sj]:"fire-analytics-compat",[kj]:"fire-app-check",[Aj]:"fire-app-check-compat",[Cj]:"fire-auth",[Fj]:"fire-auth-compat",[Ij]:"fire-rtdb",[bj]:"fire-data-connect",[Rj]:"fire-rtdb-compat",[Nj]:"fire-fn",[Dj]:"fire-fn-compat",[Pj]:"fire-iid",[Oj]:"fire-iid-compat",[Mj]:"fire-fcm",[Lj]:"fire-fcm-compat",[Bj]:"fire-perf",[jj]:"fire-perf-compat",[Vj]:"fire-rc",[Uj]:"fire-rc-compat",[zj]:"fire-gcs",[Wj]:"fire-gcs-compat",[Hj]:"fire-fst",[Gj]:"fire-fst-compat",[$j]:"fire-vertex","fire-js":"fire-js",[Kj]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rp=new Map,qj=new Map,xx=new Map;function aE(t,e){try{t.container.addComponent(e)}catch(r){za.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function gu(t){const e=t.name;if(xx.has(e))return za.debug(`There were multiple attempts to register component ${e}.`),!1;xx.set(e,t);for(const r of rp.values())aE(r,t);for(const r of qj.values())aE(r,t);return!0}function yv(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function Ro(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qj={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},zo=new jd("app","Firebase",Qj);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jj{constructor(e,r,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Xl("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw zo.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ru=Xj;function Vk(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n=Object.assign({name:mx,automaticDataCollectionEnabled:!1},e),i=n.name;if(typeof i!="string"||!i)throw zo.create("bad-app-name",{appName:String(i)});if(r||(r=Mk()),!r)throw zo.create("no-options");const s=rp.get(i);if(s){if(tp(r,s.options)&&tp(n,s.config))return s;throw zo.create("duplicate-app",{appName:i})}const a=new ij(i);for(const l of xx.values())a.addComponent(l);const o=new Jj(r,n,a);return rp.set(i,o),o}function Uk(t=mx){const e=rp.get(t);if(!e&&t===mx&&Mk())return Vk();if(!e)throw zo.create("no-app",{appName:t});return e}function Wo(t,e,r){var n;let i=(n=Yj[t])!==null&&n!==void 0?n:t;r&&(i+=`-${r}`);const s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){const o=[`Unable to register library "${i}" with version "${e}":`];s&&o.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&a&&o.push("and"),a&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),za.warn(o.join(" "));return}gu(new Xl(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zj="firebase-heartbeat-database",e7=1,md="firebase-heartbeat-store";let em=null;function zk(){return em||(em=xj(Zj,e7,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(md)}catch(r){console.warn(r)}}}}).catch(t=>{throw zo.create("idb-open",{originalErrorMessage:t.message})})),em}async function t7(t){try{const r=(await zk()).transaction(md),n=await r.objectStore(md).get(Wk(t));return await r.done,n}catch(e){if(e instanceof Qa)za.warn(e.message);else{const r=zo.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});za.warn(r.message)}}}async function oE(t,e){try{const n=(await zk()).transaction(md,"readwrite");await n.objectStore(md).put(e,Wk(t)),await n.done}catch(r){if(r instanceof Qa)za.warn(r.message);else{const n=zo.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});za.warn(n.message)}}}function Wk(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r7=1024,n7=30*24*60*60*1e3;class i7{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new a7(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=lE();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(a=>a.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const o=new Date(a.date).valueOf();return Date.now()-o<=n7}),this._storage.overwrite(this._heartbeatsCache))}catch(n){za.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=lE(),{heartbeatsToSend:n,unsentEntries:i}=s7(this._heartbeatsCache.heartbeats),s=ep(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(r){return za.warn(r),""}}}function lE(){return new Date().toISOString().substring(0,10)}function s7(t,e=r7){const r=[];let n=t.slice();for(const i of t){const s=r.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),cE(r)>e){s.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),cE(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class a7{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return G9()?K9().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await t7(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return oE(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return oE(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function cE(t){return ep(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o7(t){gu(new Xl("platform-logger",e=>new _j(e),"PRIVATE")),gu(new Xl("heartbeat",e=>new i7(e),"PRIVATE")),Wo(gx,sE,t),Wo(gx,sE,"esm2017"),Wo("fire-js","")}o7("");var l7="firebase",c7="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Wo(l7,c7,"app");var uE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ol,Hk;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(S,F){function w(){}w.prototype=F.prototype,S.D=F.prototype,S.prototype=new w,S.prototype.constructor=S,S.C=function(b,N,D){for(var R=Array(arguments.length-2),ze=2;ze<arguments.length;ze++)R[ze-2]=arguments[ze];return F.prototype[N].apply(b,R)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(S,F,w){w||(w=0);var b=Array(16);if(typeof F=="string")for(var N=0;16>N;++N)b[N]=F.charCodeAt(w++)|F.charCodeAt(w++)<<8|F.charCodeAt(w++)<<16|F.charCodeAt(w++)<<24;else for(N=0;16>N;++N)b[N]=F[w++]|F[w++]<<8|F[w++]<<16|F[w++]<<24;F=S.g[0],w=S.g[1],N=S.g[2];var D=S.g[3],R=F+(D^w&(N^D))+b[0]+3614090360&4294967295;F=w+(R<<7&4294967295|R>>>25),R=D+(N^F&(w^N))+b[1]+3905402710&4294967295,D=F+(R<<12&4294967295|R>>>20),R=N+(w^D&(F^w))+b[2]+606105819&4294967295,N=D+(R<<17&4294967295|R>>>15),R=w+(F^N&(D^F))+b[3]+3250441966&4294967295,w=N+(R<<22&4294967295|R>>>10),R=F+(D^w&(N^D))+b[4]+4118548399&4294967295,F=w+(R<<7&4294967295|R>>>25),R=D+(N^F&(w^N))+b[5]+1200080426&4294967295,D=F+(R<<12&4294967295|R>>>20),R=N+(w^D&(F^w))+b[6]+2821735955&4294967295,N=D+(R<<17&4294967295|R>>>15),R=w+(F^N&(D^F))+b[7]+4249261313&4294967295,w=N+(R<<22&4294967295|R>>>10),R=F+(D^w&(N^D))+b[8]+1770035416&4294967295,F=w+(R<<7&4294967295|R>>>25),R=D+(N^F&(w^N))+b[9]+2336552879&4294967295,D=F+(R<<12&4294967295|R>>>20),R=N+(w^D&(F^w))+b[10]+4294925233&4294967295,N=D+(R<<17&4294967295|R>>>15),R=w+(F^N&(D^F))+b[11]+2304563134&4294967295,w=N+(R<<22&4294967295|R>>>10),R=F+(D^w&(N^D))+b[12]+1804603682&4294967295,F=w+(R<<7&4294967295|R>>>25),R=D+(N^F&(w^N))+b[13]+4254626195&4294967295,D=F+(R<<12&4294967295|R>>>20),R=N+(w^D&(F^w))+b[14]+2792965006&4294967295,N=D+(R<<17&4294967295|R>>>15),R=w+(F^N&(D^F))+b[15]+1236535329&4294967295,w=N+(R<<22&4294967295|R>>>10),R=F+(N^D&(w^N))+b[1]+4129170786&4294967295,F=w+(R<<5&4294967295|R>>>27),R=D+(w^N&(F^w))+b[6]+3225465664&4294967295,D=F+(R<<9&4294967295|R>>>23),R=N+(F^w&(D^F))+b[11]+643717713&4294967295,N=D+(R<<14&4294967295|R>>>18),R=w+(D^F&(N^D))+b[0]+3921069994&4294967295,w=N+(R<<20&4294967295|R>>>12),R=F+(N^D&(w^N))+b[5]+3593408605&4294967295,F=w+(R<<5&4294967295|R>>>27),R=D+(w^N&(F^w))+b[10]+38016083&4294967295,D=F+(R<<9&4294967295|R>>>23),R=N+(F^w&(D^F))+b[15]+3634488961&4294967295,N=D+(R<<14&4294967295|R>>>18),R=w+(D^F&(N^D))+b[4]+3889429448&4294967295,w=N+(R<<20&4294967295|R>>>12),R=F+(N^D&(w^N))+b[9]+568446438&4294967295,F=w+(R<<5&4294967295|R>>>27),R=D+(w^N&(F^w))+b[14]+3275163606&4294967295,D=F+(R<<9&4294967295|R>>>23),R=N+(F^w&(D^F))+b[3]+4107603335&4294967295,N=D+(R<<14&4294967295|R>>>18),R=w+(D^F&(N^D))+b[8]+1163531501&4294967295,w=N+(R<<20&4294967295|R>>>12),R=F+(N^D&(w^N))+b[13]+2850285829&4294967295,F=w+(R<<5&4294967295|R>>>27),R=D+(w^N&(F^w))+b[2]+4243563512&4294967295,D=F+(R<<9&4294967295|R>>>23),R=N+(F^w&(D^F))+b[7]+1735328473&4294967295,N=D+(R<<14&4294967295|R>>>18),R=w+(D^F&(N^D))+b[12]+2368359562&4294967295,w=N+(R<<20&4294967295|R>>>12),R=F+(w^N^D)+b[5]+4294588738&4294967295,F=w+(R<<4&4294967295|R>>>28),R=D+(F^w^N)+b[8]+2272392833&4294967295,D=F+(R<<11&4294967295|R>>>21),R=N+(D^F^w)+b[11]+1839030562&4294967295,N=D+(R<<16&4294967295|R>>>16),R=w+(N^D^F)+b[14]+4259657740&4294967295,w=N+(R<<23&4294967295|R>>>9),R=F+(w^N^D)+b[1]+2763975236&4294967295,F=w+(R<<4&4294967295|R>>>28),R=D+(F^w^N)+b[4]+1272893353&4294967295,D=F+(R<<11&4294967295|R>>>21),R=N+(D^F^w)+b[7]+4139469664&4294967295,N=D+(R<<16&4294967295|R>>>16),R=w+(N^D^F)+b[10]+3200236656&4294967295,w=N+(R<<23&4294967295|R>>>9),R=F+(w^N^D)+b[13]+681279174&4294967295,F=w+(R<<4&4294967295|R>>>28),R=D+(F^w^N)+b[0]+3936430074&4294967295,D=F+(R<<11&4294967295|R>>>21),R=N+(D^F^w)+b[3]+3572445317&4294967295,N=D+(R<<16&4294967295|R>>>16),R=w+(N^D^F)+b[6]+76029189&4294967295,w=N+(R<<23&4294967295|R>>>9),R=F+(w^N^D)+b[9]+3654602809&4294967295,F=w+(R<<4&4294967295|R>>>28),R=D+(F^w^N)+b[12]+3873151461&4294967295,D=F+(R<<11&4294967295|R>>>21),R=N+(D^F^w)+b[15]+530742520&4294967295,N=D+(R<<16&4294967295|R>>>16),R=w+(N^D^F)+b[2]+3299628645&4294967295,w=N+(R<<23&4294967295|R>>>9),R=F+(N^(w|~D))+b[0]+4096336452&4294967295,F=w+(R<<6&4294967295|R>>>26),R=D+(w^(F|~N))+b[7]+1126891415&4294967295,D=F+(R<<10&4294967295|R>>>22),R=N+(F^(D|~w))+b[14]+2878612391&4294967295,N=D+(R<<15&4294967295|R>>>17),R=w+(D^(N|~F))+b[5]+4237533241&4294967295,w=N+(R<<21&4294967295|R>>>11),R=F+(N^(w|~D))+b[12]+1700485571&4294967295,F=w+(R<<6&4294967295|R>>>26),R=D+(w^(F|~N))+b[3]+2399980690&4294967295,D=F+(R<<10&4294967295|R>>>22),R=N+(F^(D|~w))+b[10]+4293915773&4294967295,N=D+(R<<15&4294967295|R>>>17),R=w+(D^(N|~F))+b[1]+2240044497&4294967295,w=N+(R<<21&4294967295|R>>>11),R=F+(N^(w|~D))+b[8]+1873313359&4294967295,F=w+(R<<6&4294967295|R>>>26),R=D+(w^(F|~N))+b[15]+4264355552&4294967295,D=F+(R<<10&4294967295|R>>>22),R=N+(F^(D|~w))+b[6]+2734768916&4294967295,N=D+(R<<15&4294967295|R>>>17),R=w+(D^(N|~F))+b[13]+1309151649&4294967295,w=N+(R<<21&4294967295|R>>>11),R=F+(N^(w|~D))+b[4]+4149444226&4294967295,F=w+(R<<6&4294967295|R>>>26),R=D+(w^(F|~N))+b[11]+3174756917&4294967295,D=F+(R<<10&4294967295|R>>>22),R=N+(F^(D|~w))+b[2]+718787259&4294967295,N=D+(R<<15&4294967295|R>>>17),R=w+(D^(N|~F))+b[9]+3951481745&4294967295,S.g[0]=S.g[0]+F&4294967295,S.g[1]=S.g[1]+(N+(R<<21&4294967295|R>>>11))&4294967295,S.g[2]=S.g[2]+N&4294967295,S.g[3]=S.g[3]+D&4294967295}n.prototype.u=function(S,F){F===void 0&&(F=S.length);for(var w=F-this.blockSize,b=this.B,N=this.h,D=0;D<F;){if(N==0)for(;D<=w;)i(this,S,D),D+=this.blockSize;if(typeof S=="string"){for(;D<F;)if(b[N++]=S.charCodeAt(D++),N==this.blockSize){i(this,b),N=0;break}}else for(;D<F;)if(b[N++]=S[D++],N==this.blockSize){i(this,b),N=0;break}}this.h=N,this.o+=F},n.prototype.v=function(){var S=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);S[0]=128;for(var F=1;F<S.length-8;++F)S[F]=0;var w=8*this.o;for(F=S.length-8;F<S.length;++F)S[F]=w&255,w/=256;for(this.u(S),S=Array(16),F=w=0;4>F;++F)for(var b=0;32>b;b+=8)S[w++]=this.g[F]>>>b&255;return S};function s(S,F){var w=o;return Object.prototype.hasOwnProperty.call(w,S)?w[S]:w[S]=F(S)}function a(S,F){this.h=F;for(var w=[],b=!0,N=S.length-1;0<=N;N--){var D=S[N]|0;b&&D==F||(w[N]=D,b=!1)}this.g=w}var o={};function l(S){return-128<=S&&128>S?s(S,function(F){return new a([F|0],0>F?-1:0)}):new a([S|0],0>S?-1:0)}function c(S){if(isNaN(S)||!isFinite(S))return h;if(0>S)return E(c(-S));for(var F=[],w=1,b=0;S>=w;b++)F[b]=S/w|0,w*=4294967296;return new a(F,0)}function d(S,F){if(S.length==0)throw Error("number format error: empty string");if(F=F||10,2>F||36<F)throw Error("radix out of range: "+F);if(S.charAt(0)=="-")return E(d(S.substring(1),F));if(0<=S.indexOf("-"))throw Error('number format error: interior "-" character');for(var w=c(Math.pow(F,8)),b=h,N=0;N<S.length;N+=8){var D=Math.min(8,S.length-N),R=parseInt(S.substring(N,N+D),F);8>D?(D=c(Math.pow(F,D)),b=b.j(D).add(c(R))):(b=b.j(w),b=b.add(c(R)))}return b}var h=l(0),g=l(1),m=l(16777216);t=a.prototype,t.m=function(){if(x(this))return-E(this).m();for(var S=0,F=1,w=0;w<this.g.length;w++){var b=this.i(w);S+=(0<=b?b:4294967296+b)*F,F*=4294967296}return S},t.toString=function(S){if(S=S||10,2>S||36<S)throw Error("radix out of range: "+S);if(y(this))return"0";if(x(this))return"-"+E(this).toString(S);for(var F=c(Math.pow(S,6)),w=this,b="";;){var N=P(w,F).g;w=A(w,N.j(F));var D=((0<w.g.length?w.g[0]:w.h)>>>0).toString(S);if(w=N,y(w))return D+b;for(;6>D.length;)D="0"+D;b=D+b}},t.i=function(S){return 0>S?0:S<this.g.length?this.g[S]:this.h};function y(S){if(S.h!=0)return!1;for(var F=0;F<S.g.length;F++)if(S.g[F]!=0)return!1;return!0}function x(S){return S.h==-1}t.l=function(S){return S=A(this,S),x(S)?-1:y(S)?0:1};function E(S){for(var F=S.g.length,w=[],b=0;b<F;b++)w[b]=~S.g[b];return new a(w,~S.h).add(g)}t.abs=function(){return x(this)?E(this):this},t.add=function(S){for(var F=Math.max(this.g.length,S.g.length),w=[],b=0,N=0;N<=F;N++){var D=b+(this.i(N)&65535)+(S.i(N)&65535),R=(D>>>16)+(this.i(N)>>>16)+(S.i(N)>>>16);b=R>>>16,D&=65535,R&=65535,w[N]=R<<16|D}return new a(w,w[w.length-1]&-2147483648?-1:0)};function A(S,F){return S.add(E(F))}t.j=function(S){if(y(this)||y(S))return h;if(x(this))return x(S)?E(this).j(E(S)):E(E(this).j(S));if(x(S))return E(this.j(E(S)));if(0>this.l(m)&&0>S.l(m))return c(this.m()*S.m());for(var F=this.g.length+S.g.length,w=[],b=0;b<2*F;b++)w[b]=0;for(b=0;b<this.g.length;b++)for(var N=0;N<S.g.length;N++){var D=this.i(b)>>>16,R=this.i(b)&65535,ze=S.i(N)>>>16,_e=S.i(N)&65535;w[2*b+2*N]+=R*_e,k(w,2*b+2*N),w[2*b+2*N+1]+=D*_e,k(w,2*b+2*N+1),w[2*b+2*N+1]+=R*ze,k(w,2*b+2*N+1),w[2*b+2*N+2]+=D*ze,k(w,2*b+2*N+2)}for(b=0;b<F;b++)w[b]=w[2*b+1]<<16|w[2*b];for(b=F;b<2*F;b++)w[b]=0;return new a(w,0)};function k(S,F){for(;(S[F]&65535)!=S[F];)S[F+1]+=S[F]>>>16,S[F]&=65535,F++}function _(S,F){this.g=S,this.h=F}function P(S,F){if(y(F))throw Error("division by zero");if(y(S))return new _(h,h);if(x(S))return F=P(E(S),F),new _(E(F.g),E(F.h));if(x(F))return F=P(S,E(F)),new _(E(F.g),F.h);if(30<S.g.length){if(x(S)||x(F))throw Error("slowDivide_ only works with positive integers.");for(var w=g,b=F;0>=b.l(S);)w=K(w),b=K(b);var N=V(w,1),D=V(b,1);for(b=V(b,2),w=V(w,2);!y(b);){var R=D.add(b);0>=R.l(S)&&(N=N.add(w),D=R),b=V(b,1),w=V(w,1)}return F=A(S,N.j(F)),new _(N,F)}for(N=h;0<=S.l(F);){for(w=Math.max(1,Math.floor(S.m()/F.m())),b=Math.ceil(Math.log(w)/Math.LN2),b=48>=b?1:Math.pow(2,b-48),D=c(w),R=D.j(F);x(R)||0<R.l(S);)w-=b,D=c(w),R=D.j(F);y(D)&&(D=g),N=N.add(D),S=A(S,R)}return new _(N,S)}t.A=function(S){return P(this,S).h},t.and=function(S){for(var F=Math.max(this.g.length,S.g.length),w=[],b=0;b<F;b++)w[b]=this.i(b)&S.i(b);return new a(w,this.h&S.h)},t.or=function(S){for(var F=Math.max(this.g.length,S.g.length),w=[],b=0;b<F;b++)w[b]=this.i(b)|S.i(b);return new a(w,this.h|S.h)},t.xor=function(S){for(var F=Math.max(this.g.length,S.g.length),w=[],b=0;b<F;b++)w[b]=this.i(b)^S.i(b);return new a(w,this.h^S.h)};function K(S){for(var F=S.g.length+1,w=[],b=0;b<F;b++)w[b]=S.i(b)<<1|S.i(b-1)>>>31;return new a(w,S.h)}function V(S,F){var w=F>>5;F%=32;for(var b=S.g.length-w,N=[],D=0;D<b;D++)N[D]=0<F?S.i(D+w)>>>F|S.i(D+w+1)<<32-F:S.i(D+w);return new a(N,S.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,Hk=n,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=c,a.fromString=d,Ol=a}).apply(typeof uE<"u"?uE:typeof self<"u"?self:typeof window<"u"?window:{});var z0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var $k,hf,Gk,lh,vx,Kk,Xk,Yk;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(f,v,C){return f==Array.prototype||f==Object.prototype||(f[v]=C.value),f};function r(f){f=[typeof globalThis=="object"&&globalThis,f,typeof window=="object"&&window,typeof self=="object"&&self,typeof z0=="object"&&z0];for(var v=0;v<f.length;++v){var C=f[v];if(C&&C.Math==Math)return C}throw Error("Cannot find global object")}var n=r(this);function i(f,v){if(v)e:{var C=n;f=f.split(".");for(var O=0;O<f.length-1;O++){var se=f[O];if(!(se in C))break e;C=C[se]}f=f[f.length-1],O=C[f],v=v(O),v!=O&&v!=null&&e(C,f,{configurable:!0,writable:!0,value:v})}}function s(f,v){f instanceof String&&(f+="");var C=0,O=!1,se={next:function(){if(!O&&C<f.length){var he=C++;return{value:v(he,f[he]),done:!1}}return O=!0,{done:!0,value:void 0}}};return se[Symbol.iterator]=function(){return se},se}i("Array.prototype.values",function(f){return f||function(){return s(this,function(v,C){return C})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},o=this||self;function l(f){var v=typeof f;return v=v!="object"?v:f?Array.isArray(f)?"array":v:"null",v=="array"||v=="object"&&typeof f.length=="number"}function c(f){var v=typeof f;return v=="object"&&f!=null||v=="function"}function d(f,v,C){return f.call.apply(f.bind,arguments)}function h(f,v,C){if(!f)throw Error();if(2<arguments.length){var O=Array.prototype.slice.call(arguments,2);return function(){var se=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(se,O),f.apply(v,se)}}return function(){return f.apply(v,arguments)}}function g(f,v,C){return g=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:h,g.apply(null,arguments)}function m(f,v){var C=Array.prototype.slice.call(arguments,1);return function(){var O=C.slice();return O.push.apply(O,arguments),f.apply(this,O)}}function y(f,v){function C(){}C.prototype=v.prototype,f.aa=v.prototype,f.prototype=new C,f.prototype.constructor=f,f.Qb=function(O,se,he){for(var Ue=Array(arguments.length-2),Jt=2;Jt<arguments.length;Jt++)Ue[Jt-2]=arguments[Jt];return v.prototype[se].apply(O,Ue)}}function x(f){const v=f.length;if(0<v){const C=Array(v);for(let O=0;O<v;O++)C[O]=f[O];return C}return[]}function E(f,v){for(let C=1;C<arguments.length;C++){const O=arguments[C];if(l(O)){const se=f.length||0,he=O.length||0;f.length=se+he;for(let Ue=0;Ue<he;Ue++)f[se+Ue]=O[Ue]}else f.push(O)}}class A{constructor(v,C){this.i=v,this.j=C,this.h=0,this.g=null}get(){let v;return 0<this.h?(this.h--,v=this.g,this.g=v.next,v.next=null):v=this.i(),v}}function k(f){return/^[\s\xa0]*$/.test(f)}function _(){var f=o.navigator;return f&&(f=f.userAgent)?f:""}function P(f){return P[" "](f),f}P[" "]=function(){};var K=_().indexOf("Gecko")!=-1&&!(_().toLowerCase().indexOf("webkit")!=-1&&_().indexOf("Edge")==-1)&&!(_().indexOf("Trident")!=-1||_().indexOf("MSIE")!=-1)&&_().indexOf("Edge")==-1;function V(f,v,C){for(const O in f)v.call(C,f[O],O,f)}function S(f,v){for(const C in f)v.call(void 0,f[C],C,f)}function F(f){const v={};for(const C in f)v[C]=f[C];return v}const w="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function b(f,v){let C,O;for(let se=1;se<arguments.length;se++){O=arguments[se];for(C in O)f[C]=O[C];for(let he=0;he<w.length;he++)C=w[he],Object.prototype.hasOwnProperty.call(O,C)&&(f[C]=O[C])}}function N(f){var v=1;f=f.split(":");const C=[];for(;0<v&&f.length;)C.push(f.shift()),v--;return f.length&&C.push(f.join(":")),C}function D(f){o.setTimeout(()=>{throw f},0)}function R(){var f=re;let v=null;return f.g&&(v=f.g,f.g=f.g.next,f.g||(f.h=null),v.next=null),v}class ze{constructor(){this.h=this.g=null}add(v,C){const O=_e.get();O.set(v,C),this.h?this.h.next=O:this.g=O,this.h=O}}var _e=new A(()=>new Ie,f=>f.reset());class Ie{constructor(){this.next=this.g=this.h=null}set(v,C){this.h=v,this.g=C,this.next=null}reset(){this.next=this.g=this.h=null}}let De,we=!1,re=new ze,Ae=()=>{const f=o.Promise.resolve(void 0);De=()=>{f.then(Oe)}};var Oe=()=>{for(var f;f=R();){try{f.h.call(f.g)}catch(C){D(C)}var v=_e;v.j(f),100>v.h&&(v.h++,f.next=v.g,v.g=f)}we=!1};function z(){this.s=this.s,this.C=this.C}z.prototype.s=!1,z.prototype.ma=function(){this.s||(this.s=!0,this.N())},z.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ne(f,v){this.type=f,this.g=this.target=v,this.defaultPrevented=!1}ne.prototype.h=function(){this.defaultPrevented=!0};var te=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var f=!1,v=Object.defineProperty({},"passive",{get:function(){f=!0}});try{const C=()=>{};o.addEventListener("test",C,v),o.removeEventListener("test",C,v)}catch{}return f}();function Y(f,v){if(ne.call(this,f?f.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,f){var C=this.type=f.type,O=f.changedTouches&&f.changedTouches.length?f.changedTouches[0]:null;if(this.target=f.target||f.srcElement,this.g=v,v=f.relatedTarget){if(K){e:{try{P(v.nodeName);var se=!0;break e}catch{}se=!1}se||(v=null)}}else C=="mouseover"?v=f.fromElement:C=="mouseout"&&(v=f.toElement);this.relatedTarget=v,O?(this.clientX=O.clientX!==void 0?O.clientX:O.pageX,this.clientY=O.clientY!==void 0?O.clientY:O.pageY,this.screenX=O.screenX||0,this.screenY=O.screenY||0):(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0),this.button=f.button,this.key=f.key||"",this.ctrlKey=f.ctrlKey,this.altKey=f.altKey,this.shiftKey=f.shiftKey,this.metaKey=f.metaKey,this.pointerId=f.pointerId||0,this.pointerType=typeof f.pointerType=="string"?f.pointerType:ge[f.pointerType]||"",this.state=f.state,this.i=f,f.defaultPrevented&&Y.aa.h.call(this)}}y(Y,ne);var ge={2:"touch",3:"pen",4:"mouse"};Y.prototype.h=function(){Y.aa.h.call(this);var f=this.i;f.preventDefault?f.preventDefault():f.returnValue=!1};var Ee="closure_listenable_"+(1e6*Math.random()|0),Pe=0;function ke(f,v,C,O,se){this.listener=f,this.proxy=null,this.src=v,this.type=C,this.capture=!!O,this.ha=se,this.key=++Pe,this.da=this.fa=!1}function Se(f){f.da=!0,f.listener=null,f.proxy=null,f.src=null,f.ha=null}function tt(f){this.src=f,this.g={},this.h=0}tt.prototype.add=function(f,v,C,O,se){var he=f.toString();f=this.g[he],f||(f=this.g[he]=[],this.h++);var Ue=Rt(f,v,O,se);return-1<Ue?(v=f[Ue],C||(v.fa=!1)):(v=new ke(v,this.src,he,!!O,se),v.fa=C,f.push(v)),v};function Q(f,v){var C=v.type;if(C in f.g){var O=f.g[C],se=Array.prototype.indexOf.call(O,v,void 0),he;(he=0<=se)&&Array.prototype.splice.call(O,se,1),he&&(Se(v),f.g[C].length==0&&(delete f.g[C],f.h--))}}function Rt(f,v,C,O){for(var se=0;se<f.length;++se){var he=f[se];if(!he.da&&he.listener==v&&he.capture==!!C&&he.ha==O)return se}return-1}var xt="closure_lm_"+(1e6*Math.random()|0),Ft={};function dt(f,v,C,O,se){if(Array.isArray(v)){for(var he=0;he<v.length;he++)dt(f,v[he],C,O,se);return null}return C=yi(C),f&&f[Ee]?f.K(v,C,c(O)?!!O.capture:!1,se):We(f,v,C,!1,O,se)}function We(f,v,C,O,se,he){if(!v)throw Error("Invalid event type");var Ue=c(se)?!!se.capture:!!se,Jt=vi(f);if(Jt||(f[xt]=Jt=new tt(f)),C=Jt.add(v,C,O,Ue,he),C.proxy)return C;if(O=ar(),C.proxy=O,O.src=f,O.listener=C,f.addEventListener)te||(se=Ue),se===void 0&&(se=!1),f.addEventListener(v.toString(),O,se);else if(f.attachEvent)f.attachEvent(xi(v.toString()),O);else if(f.addListener&&f.removeListener)f.addListener(O);else throw Error("addEventListener and attachEvent are unavailable.");return C}function ar(){function f(C){return v.call(f.src,f.listener,C)}const v=qi;return f}function In(f,v,C,O,se){if(Array.isArray(v))for(var he=0;he<v.length;he++)In(f,v[he],C,O,se);else O=c(O)?!!O.capture:!!O,C=yi(C),f&&f[Ee]?(f=f.i,v=String(v).toString(),v in f.g&&(he=f.g[v],C=Rt(he,C,O,se),-1<C&&(Se(he[C]),Array.prototype.splice.call(he,C,1),he.length==0&&(delete f.g[v],f.h--)))):f&&(f=vi(f))&&(v=f.g[v.toString()],f=-1,v&&(f=Rt(v,C,O,se)),(C=-1<f?v[f]:null)&&sn(C))}function sn(f){if(typeof f!="number"&&f&&!f.da){var v=f.src;if(v&&v[Ee])Q(v.i,f);else{var C=f.type,O=f.proxy;v.removeEventListener?v.removeEventListener(C,O,f.capture):v.detachEvent?v.detachEvent(xi(C),O):v.addListener&&v.removeListener&&v.removeListener(O),(C=vi(v))?(Q(C,f),C.h==0&&(C.src=null,v[xt]=null)):Se(f)}}}function xi(f){return f in Ft?Ft[f]:Ft[f]="on"+f}function qi(f,v){if(f.da)f=!0;else{v=new Y(v,this);var C=f.listener,O=f.ha||f.src;f.fa&&sn(f),f=C.call(O,v)}return f}function vi(f){return f=f[xt],f instanceof tt?f:null}var Lr="__closure_events_fn_"+(1e9*Math.random()>>>0);function yi(f){return typeof f=="function"?f:(f[Lr]||(f[Lr]=function(v){return f.handleEvent(v)}),f[Lr])}function Qt(){z.call(this),this.i=new tt(this),this.M=this,this.F=null}y(Qt,z),Qt.prototype[Ee]=!0,Qt.prototype.removeEventListener=function(f,v,C,O){In(this,f,v,C,O)};function Sr(f,v){var C,O=f.F;if(O)for(C=[];O;O=O.F)C.push(O);if(f=f.M,O=v.type||v,typeof v=="string")v=new ne(v,f);else if(v instanceof ne)v.target=v.target||f;else{var se=v;v=new ne(O,f),b(v,se)}if(se=!0,C)for(var he=C.length-1;0<=he;he--){var Ue=v.g=C[he];se=fr(Ue,O,!0,v)&&se}if(Ue=v.g=f,se=fr(Ue,O,!0,v)&&se,se=fr(Ue,O,!1,v)&&se,C)for(he=0;he<C.length;he++)Ue=v.g=C[he],se=fr(Ue,O,!1,v)&&se}Qt.prototype.N=function(){if(Qt.aa.N.call(this),this.i){var f=this.i,v;for(v in f.g){for(var C=f.g[v],O=0;O<C.length;O++)Se(C[O]);delete f.g[v],f.h--}}this.F=null},Qt.prototype.K=function(f,v,C,O){return this.i.add(String(f),v,!1,C,O)},Qt.prototype.L=function(f,v,C,O){return this.i.add(String(f),v,!0,C,O)};function fr(f,v,C,O){if(v=f.i.g[String(v)],!v)return!0;v=v.concat();for(var se=!0,he=0;he<v.length;++he){var Ue=v[he];if(Ue&&!Ue.da&&Ue.capture==C){var Jt=Ue.listener,fn=Ue.ha||Ue.src;Ue.fa&&Q(f.i,Ue),se=Jt.call(fn,O)!==!1&&se}}return se&&!O.defaultPrevented}function oi(f,v,C){if(typeof f=="function")C&&(f=g(f,C));else if(f&&typeof f.handleEvent=="function")f=g(f.handleEvent,f);else throw Error("Invalid listener argument");return 2147483647<Number(v)?-1:o.setTimeout(f,v||0)}function ct(f){f.g=oi(()=>{f.g=null,f.i&&(f.i=!1,ct(f))},f.l);const v=f.h;f.h=null,f.m.apply(null,v)}class dr extends z{constructor(v,C){super(),this.m=v,this.l=C,this.h=null,this.i=!1,this.g=null}j(v){this.h=arguments,this.g?this.i=!0:ct(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function hr(f){z.call(this),this.h=f,this.g={}}y(hr,z);var yr=[];function li(f){V(f.g,function(v,C){this.g.hasOwnProperty(C)&&sn(v)},f),f.g={}}hr.prototype.N=function(){hr.aa.N.call(this),li(this)},hr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ja=o.JSON.stringify,Za=o.JSON.parse,Lu=class{stringify(f){return o.JSON.stringify(f,void 0)}parse(f){return o.JSON.parse(f,void 0)}};function xs(){}xs.prototype.h=null;function ol(f){return f.h||(f.h=f.i())}function vs(){}var ae={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function br(){ne.call(this,"d")}y(br,ne);function _i(){ne.call(this,"c")}y(_i,ne);var Qi={},ma=null;function Us(){return ma=ma||new Qt}Qi.La="serverreachability";function zs(f){ne.call(this,Qi.La,f)}y(zs,ne);function Ei(f){const v=Us();Sr(v,new zs(v))}Qi.STAT_EVENT="statevent";function an(f,v){ne.call(this,Qi.STAT_EVENT,f),this.stat=v}y(an,ne);function Yr(f){const v=Us();Sr(v,new an(v,f))}Qi.Ma="timingevent";function xa(f,v){ne.call(this,Qi.Ma,f),this.size=v}y(xa,ne);function ys(f,v){if(typeof f!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){f()},v)}function on(){this.g=!0}on.prototype.xa=function(){this.g=!1};function cc(f,v,C,O,se,he){f.info(function(){if(f.g)if(he)for(var Ue="",Jt=he.split("&"),fn=0;fn<Jt.length;fn++){var Ot=Jt[fn].split("=");if(1<Ot.length){var Qr=Ot[0];Ot=Ot[1];var _n=Qr.split("_");Ue=2<=_n.length&&_n[1]=="type"?Ue+(Qr+"="+Ot+"&"):Ue+(Qr+"=redacted&")}}else Ue=null;else Ue=he;return"XMLHTTP REQ ("+O+") [attempt "+se+"]: "+v+`
`+C+`
`+Ue})}function Ws(f,v,C,O,se,he,Ue){f.info(function(){return"XMLHTTP RESP ("+O+") [ attempt "+se+"]: "+v+`
`+C+`
`+he+" "+Ue})}function I(f,v,C,O){f.info(function(){return"XMLHTTP TEXT ("+v+"): "+M(f,C)+(O?" "+O:"")})}function G(f,v){f.info(function(){return"TIMEOUT: "+v})}on.prototype.info=function(){};function M(f,v){if(!f.g)return v;if(!v)return null;try{var C=JSON.parse(v);if(C){for(f=0;f<C.length;f++)if(Array.isArray(C[f])){var O=C[f];if(!(2>O.length)){var se=O[1];if(Array.isArray(se)&&!(1>se.length)){var he=se[0];if(he!="noop"&&he!="stop"&&he!="close")for(var Ue=1;Ue<se.length;Ue++)se[Ue]=""}}}}return Ja(C)}catch{return v}}var B={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},X={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},U;function oe(){}y(oe,xs),oe.prototype.g=function(){return new XMLHttpRequest},oe.prototype.i=function(){return{}},U=new oe;function fe(f,v,C,O){this.j=f,this.i=v,this.l=C,this.R=O||1,this.U=new hr(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new le}function le(){this.i=null,this.g="",this.h=!1}var ce={},ue={};function Ce(f,v,C){f.L=1,f.v=Ea(ln(v)),f.m=C,f.P=!0,je(f,null)}function je(f,v){f.F=Date.now(),Ge(f),f.A=ln(f.v);var C=f.A,O=f.R;Array.isArray(O)||(O=[String(O)]),pt(C.i,"t",O),f.C=0,C=f.j.J,f.h=new le,f.g=gc(f.j,C?v:null,!f.m),0<f.O&&(f.M=new dr(g(f.Y,f,f.g),f.O)),v=f.U,C=f.g,O=f.ca;var se="readystatechange";Array.isArray(se)||(se&&(yr[0]=se.toString()),se=yr);for(var he=0;he<se.length;he++){var Ue=dt(C,se[he],O||v.handleEvent,!1,v.h||v);if(!Ue)break;v.g[Ue.key]=Ue}v=f.H?F(f.H):{},f.m?(f.u||(f.u="POST"),v["Content-Type"]="application/x-www-form-urlencoded",f.g.ea(f.A,f.u,f.m,v)):(f.u="GET",f.g.ea(f.A,f.u,null,v)),Ei(),cc(f.i,f.u,f.A,f.l,f.R,f.m)}fe.prototype.ca=function(f){f=f.target;const v=this.M;v&&jr(f)==3?v.j():this.Y(f)},fe.prototype.Y=function(f){try{if(f==this.g)e:{const _n=jr(this.g);var v=this.g.Ba();const co=this.g.Z();if(!(3>_n)&&(_n!=3||this.g&&(this.h.h||this.g.oa()||hc(this.g)))){this.J||_n!=4||v==7||(v==8||0>=co?Ei(3):Ei(2)),ot(this);var C=this.g.Z();this.X=C;t:if($e(this)){var O=hc(this.g);f="";var se=O.length,he=jr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){kt(this),Lt(this);var Ue="";break t}this.h.i=new o.TextDecoder}for(v=0;v<se;v++)this.h.h=!0,f+=this.h.i.decode(O[v],{stream:!(he&&v==se-1)});O.length=0,this.h.g+=f,this.C=0,Ue=this.h.g}else Ue=this.g.oa();if(this.o=C==200,Ws(this.i,this.u,this.A,this.l,this.R,_n,C),this.o){if(this.T&&!this.K){t:{if(this.g){var Jt,fn=this.g;if((Jt=fn.g?fn.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!k(Jt)){var Ot=Jt;break t}}Ot=null}if(C=Ot)I(this.i,this.l,C,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,ci(this,C);else{this.o=!1,this.s=3,Yr(12),kt(this),Lt(this);break e}}if(this.P){C=!0;let Li;for(;!this.J&&this.C<Ue.length;)if(Li=Re(this,Ue),Li==ue){_n==4&&(this.s=4,Yr(14),C=!1),I(this.i,this.l,null,"[Incomplete Response]");break}else if(Li==ce){this.s=4,Yr(15),I(this.i,this.l,Ue,"[Invalid Chunk]"),C=!1;break}else I(this.i,this.l,Li,null),ci(this,Li);if($e(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),_n!=4||Ue.length!=0||this.h.h||(this.s=1,Yr(16),C=!1),this.o=this.o&&C,!C)I(this.i,this.l,Ue,"[Invalid Chunked Response]"),kt(this),Lt(this);else if(0<Ue.length&&!this.W){this.W=!0;var Qr=this.j;Qr.g==this&&Qr.ba&&!Qr.M&&(Qr.j.info("Great, no buffering proxy detected. Bytes received: "+Ue.length),Oi(Qr),Qr.M=!0,Yr(11))}}else I(this.i,this.l,Ue,null),ci(this,Ue);_n==4&&kt(this),this.o&&!this.J&&(_n==4?r0(this.j,this):(this.o=!1,Ge(this)))}else Wu(this.g),C==400&&0<Ue.indexOf("Unknown SID")?(this.s=3,Yr(12)):(this.s=0,Yr(13)),kt(this),Lt(this)}}}catch{}finally{}};function $e(f){return f.g?f.u=="GET"&&f.L!=2&&f.j.Ca:!1}function Re(f,v){var C=f.C,O=v.indexOf(`
`,C);return O==-1?ue:(C=Number(v.substring(C,O)),isNaN(C)?ce:(O+=1,O+C>v.length?ue:(v=v.slice(O,O+C),f.C=O+C,v)))}fe.prototype.cancel=function(){this.J=!0,kt(this)};function Ge(f){f.S=Date.now()+f.I,nt(f,f.I)}function nt(f,v){if(f.B!=null)throw Error("WatchDog timer not null");f.B=ys(g(f.ba,f),v)}function ot(f){f.B&&(o.clearTimeout(f.B),f.B=null)}fe.prototype.ba=function(){this.B=null;const f=Date.now();0<=f-this.S?(G(this.i,this.A),this.L!=2&&(Ei(),Yr(17)),kt(this),this.s=2,Lt(this)):nt(this,this.S-f)};function Lt(f){f.j.G==0||f.J||r0(f.j,f)}function kt(f){ot(f);var v=f.M;v&&typeof v.ma=="function"&&v.ma(),f.M=null,li(f.U),f.g&&(v=f.g,f.g=null,v.abort(),v.ma())}function ci(f,v){try{var C=f.j;if(C.G!=0&&(C.g==f||Yt(C.h,f))){if(!f.K&&Yt(C.h,f)&&C.G==3){try{var O=C.Da.g.parse(v)}catch{O=null}if(Array.isArray(O)&&O.length==3){var se=O;if(se[0]==0){e:if(!C.u){if(C.g)if(C.g.F+3e3<f.F)lo(C),hl(C);else break e;oo(C),Yr(18)}}else C.za=se[1],0<C.za-C.T&&37500>se[2]&&C.F&&C.v==0&&!C.C&&(C.C=ys(g(C.Za,C),6e3));if(1>=yn(C.h)&&C.ca){try{C.ca()}catch{}C.ca=void 0}}else Vr(C,11)}else if((f.K||C.g==f)&&lo(C),!k(v))for(se=C.Da.g.parse(v),v=0;v<se.length;v++){let Ot=se[v];if(C.T=Ot[0],Ot=Ot[1],C.G==2)if(Ot[0]=="c"){C.K=Ot[1],C.ia=Ot[2];const Qr=Ot[3];Qr!=null&&(C.la=Qr,C.j.info("VER="+C.la));const _n=Ot[4];_n!=null&&(C.Aa=_n,C.j.info("SVER="+C.Aa));const co=Ot[5];co!=null&&typeof co=="number"&&0<co&&(O=1.5*co,C.L=O,C.j.info("backChannelRequestTimeoutMs_="+O)),O=C;const Li=f.g;if(Li){const vc=Li.g?Li.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(vc){var he=O.h;he.g||vc.indexOf("spdy")==-1&&vc.indexOf("quic")==-1&&vc.indexOf("h2")==-1||(he.j=he.l,he.g=new Set,he.h&&(_s(he,he.h),he.h=null))}if(O.D){const $u=Li.g?Li.g.getResponseHeader("X-HTTP-Session-Id"):null;$u&&(O.ya=$u,Zt(O.I,O.D,$u))}}C.G=3,C.l&&C.l.ua(),C.ba&&(C.R=Date.now()-f.F,C.j.info("Handshake RTT: "+C.R+"ms")),O=C;var Ue=f;if(O.qa=Mi(O,O.J?O.ia:null,O.W),Ue.K){va(O.h,Ue);var Jt=Ue,fn=O.L;fn&&(Jt.I=fn),Jt.B&&(ot(Jt),Ge(Jt)),O.g=Ue}else t0(O);0<C.i.length&&qs(C)}else Ot[0]!="stop"&&Ot[0]!="close"||Vr(C,7);else C.G==3&&(Ot[0]=="stop"||Ot[0]=="close"?Ot[0]=="stop"?Vr(C,7):pc(C):Ot[0]!="noop"&&C.l&&C.l.ta(Ot),C.v=0)}}Ei(4)}catch{}}var ht=class{constructor(f,v){this.g=f,this.map=v}};function Vn(f){this.l=f||10,o.PerformanceNavigationTiming?(f=o.performance.getEntriesByType("navigation"),f=0<f.length&&(f[0].nextHopProtocol=="hq"||f[0].nextHopProtocol=="h2")):f=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=f?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function vt(f){return f.h?!0:f.g?f.g.size>=f.j:!1}function yn(f){return f.h?1:f.g?f.g.size:0}function Yt(f,v){return f.h?f.h==v:f.g?f.g.has(v):!1}function _s(f,v){f.g?f.g.add(v):f.h=v}function va(f,v){f.h&&f.h==v?f.h=null:f.g&&f.g.has(v)&&f.g.delete(v)}Vn.prototype.cancel=function(){if(this.i=Hs(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const f of this.g.values())f.cancel();this.g.clear()}};function Hs(f){if(f.h!=null)return f.i.concat(f.h.D);if(f.g!=null&&f.g.size!==0){let v=f.i;for(const C of f.g.values())v=v.concat(C.D);return v}return x(f.i)}function uc(f){if(f.V&&typeof f.V=="function")return f.V();if(typeof Map<"u"&&f instanceof Map||typeof Set<"u"&&f instanceof Set)return Array.from(f.values());if(typeof f=="string")return f.split("");if(l(f)){for(var v=[],C=f.length,O=0;O<C;O++)v.push(f[O]);return v}v=[],C=0;for(O in f)v[C++]=f[O];return v}function Bu(f){if(f.na&&typeof f.na=="function")return f.na();if(!f.V||typeof f.V!="function"){if(typeof Map<"u"&&f instanceof Map)return Array.from(f.keys());if(!(typeof Set<"u"&&f instanceof Set)){if(l(f)||typeof f=="string"){var v=[];f=f.length;for(var C=0;C<f;C++)v.push(C);return v}v=[],C=0;for(const O in f)v[C++]=O;return v}}}function Ji(f,v){if(f.forEach&&typeof f.forEach=="function")f.forEach(v,void 0);else if(l(f)||typeof f=="string")Array.prototype.forEach.call(f,v,void 0);else for(var C=Bu(f),O=uc(f),se=O.length,he=0;he<se;he++)v.call(void 0,O[he],C&&C[he],f)}var eo=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function wi(f,v){if(f){f=f.split("&");for(var C=0;C<f.length;C++){var O=f[C].indexOf("="),se=null;if(0<=O){var he=f[C].substring(0,O);se=f[C].substring(O+1)}else he=f[C];v(he,se?decodeURIComponent(se.replace(/\+/g," ")):"")}}}function Di(f){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,f instanceof Di){this.h=f.h,ya(this,f.j),this.o=f.o,this.g=f.g,Es(this,f.s),this.l=f.l;var v=f.i,C=new cl;C.i=v.i,v.g&&(C.g=new Map(v.g),C.h=v.h),_a(this,C),this.m=f.m}else f&&(v=String(f).match(eo))?(this.h=!1,ya(this,v[1]||"",!0),this.o=cn(v[2]||""),this.g=cn(v[3]||"",!0),Es(this,v[4]),this.l=cn(v[5]||"",!0),_a(this,v[6]||"",!0),this.m=cn(v[7]||"")):(this.h=!1,this.i=new cl(null,this.h))}Di.prototype.toString=function(){var f=[],v=this.j;v&&f.push($s(v,ll,!0),":");var C=this.g;return(C||v=="file")&&(f.push("//"),(v=this.o)&&f.push($s(v,ll,!0),"@"),f.push(encodeURIComponent(String(C)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),C=this.s,C!=null&&f.push(":",String(C))),(C=this.l)&&(this.g&&C.charAt(0)!="/"&&f.push("/"),f.push($s(C,C.charAt(0)=="/"?ju:Gs,!0))),(C=this.i.toString())&&f.push("?",C),(C=this.m)&&f.push("#",$s(C,fc)),f.join("")};function ln(f){return new Di(f)}function ya(f,v,C){f.j=C?cn(v,!0):v,f.j&&(f.j=f.j.replace(/:$/,""))}function Es(f,v){if(v){if(v=Number(v),isNaN(v)||0>v)throw Error("Bad port number "+v);f.s=v}else f.s=null}function _a(f,v,C){v instanceof cl?(f.i=v,_r(f.i,f.h)):(C||(v=$s(v,qr)),f.i=new cl(v,f.h))}function Zt(f,v,C){f.i.set(v,C)}function Ea(f){return Zt(f,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),f}function cn(f,v){return f?v?decodeURI(f.replace(/%25/g,"%2525")):decodeURIComponent(f):""}function $s(f,v,C){return typeof f=="string"?(f=encodeURI(f).replace(v,Si),C&&(f=f.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f):null}function Si(f){return f=f.charCodeAt(0),"%"+(f>>4&15).toString(16)+(f&15).toString(16)}var ll=/[#\/\?@]/g,Gs=/[#\?:]/g,ju=/[#\?]/g,qr=/[#\?@]/g,fc=/#/g;function cl(f,v){this.h=this.g=null,this.i=f||null,this.j=!!v}function Pi(f){f.g||(f.g=new Map,f.h=0,f.i&&wi(f.i,function(v,C){f.add(decodeURIComponent(v.replace(/\+/g," ")),C)}))}t=cl.prototype,t.add=function(f,v){Pi(this),this.i=null,f=Zi(this,f);var C=this.g.get(f);return C||this.g.set(f,C=[]),C.push(v),this.h+=1,this};function Vu(f,v){Pi(f),v=Zi(f,v),f.g.has(v)&&(f.i=null,f.h-=f.g.get(v).length,f.g.delete(v))}function dc(f,v){return Pi(f),v=Zi(f,v),f.g.has(v)}t.forEach=function(f,v){Pi(this),this.g.forEach(function(C,O){C.forEach(function(se){f.call(v,se,O,this)},this)},this)},t.na=function(){Pi(this);const f=Array.from(this.g.values()),v=Array.from(this.g.keys()),C=[];for(let O=0;O<v.length;O++){const se=f[O];for(let he=0;he<se.length;he++)C.push(v[O])}return C},t.V=function(f){Pi(this);let v=[];if(typeof f=="string")dc(this,f)&&(v=v.concat(this.g.get(Zi(this,f))));else{f=Array.from(this.g.values());for(let C=0;C<f.length;C++)v=v.concat(f[C])}return v},t.set=function(f,v){return Pi(this),this.i=null,f=Zi(this,f),dc(this,f)&&(this.h-=this.g.get(f).length),this.g.set(f,[v]),this.h+=1,this},t.get=function(f,v){return f?(f=this.V(f),0<f.length?String(f[0]):v):v};function pt(f,v,C){Vu(f,v),0<C.length&&(f.i=null,f.g.set(Zi(f,v),x(C)),f.h+=C.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const f=[],v=Array.from(this.g.keys());for(var C=0;C<v.length;C++){var O=v[C];const he=encodeURIComponent(String(O)),Ue=this.V(O);for(O=0;O<Ue.length;O++){var se=he;Ue[O]!==""&&(se+="="+encodeURIComponent(String(Ue[O]))),f.push(se)}}return this.i=f.join("&")};function Zi(f,v){return v=String(v),f.j&&(v=v.toLowerCase()),v}function _r(f,v){v&&!f.j&&(Pi(f),f.i=null,f.g.forEach(function(C,O){var se=O.toLowerCase();O!=se&&(Vu(this,O),pt(this,se,C))},f)),f.j=v}function to(f,v){const C=new on;if(o.Image){const O=new Image;O.onload=m(ws,C,"TestLoadImage: loaded",!0,v,O),O.onerror=m(ws,C,"TestLoadImage: error",!1,v,O),O.onabort=m(ws,C,"TestLoadImage: abort",!1,v,O),O.ontimeout=m(ws,C,"TestLoadImage: timeout",!1,v,O),o.setTimeout(function(){O.ontimeout&&O.ontimeout()},1e4),O.src=f}else v(!1)}function qd(f,v){const C=new on,O=new AbortController,se=setTimeout(()=>{O.abort(),ws(C,"TestPingServer: timeout",!1,v)},1e4);fetch(f,{signal:O.signal}).then(he=>{clearTimeout(se),he.ok?ws(C,"TestPingServer: ok",!0,v):ws(C,"TestPingServer: server error",!1,v)}).catch(()=>{clearTimeout(se),ws(C,"TestPingServer: error",!1,v)})}function ws(f,v,C,O,se){try{se&&(se.onload=null,se.onerror=null,se.onabort=null,se.ontimeout=null),O(C)}catch{}}function Uu(){this.g=new Lu}function Qd(f,v,C){const O=C||"";try{Ji(f,function(se,he){let Ue=se;c(se)&&(Ue=Ja(se)),v.push(O+he+"="+encodeURIComponent(Ue))})}catch(se){throw v.push(O+"type="+encodeURIComponent("_badmap")),se}}function ul(f){this.l=f.Ub||null,this.j=f.eb||!1}y(ul,xs),ul.prototype.g=function(){return new fl(this.l,this.j)},ul.prototype.i=function(f){return function(){return f}}({});function fl(f,v){Qt.call(this),this.D=f,this.o=v,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}y(fl,Qt),t=fl.prototype,t.open=function(f,v){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=f,this.A=v,this.readyState=1,io(this)},t.send=function(f){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const v={headers:this.u,method:this.B,credentials:this.m,cache:void 0};f&&(v.body=f),(this.D||o).fetch(new Request(this.A,v)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,no(this)),this.readyState=0},t.Sa=function(f){if(this.g&&(this.l=f,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=f.headers,this.readyState=2,io(this)),this.g&&(this.readyState=3,io(this),this.g)))if(this.responseType==="arraybuffer")f.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in f){if(this.j=f.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;ro(this)}else f.text().then(this.Ra.bind(this),this.ga.bind(this))};function ro(f){f.j.read().then(f.Pa.bind(f)).catch(f.ga.bind(f))}t.Pa=function(f){if(this.g){if(this.o&&f.value)this.response.push(f.value);else if(!this.o){var v=f.value?f.value:new Uint8Array(0);(v=this.v.decode(v,{stream:!f.done}))&&(this.response=this.responseText+=v)}f.done?no(this):io(this),this.readyState==3&&ro(this)}},t.Ra=function(f){this.g&&(this.response=this.responseText=f,no(this))},t.Qa=function(f){this.g&&(this.response=f,no(this))},t.ga=function(){this.g&&no(this)};function no(f){f.readyState=4,f.l=null,f.j=null,f.v=null,io(f)}t.setRequestHeader=function(f,v){this.u.append(f,v)},t.getResponseHeader=function(f){return this.h&&this.h.get(f.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const f=[],v=this.h.entries();for(var C=v.next();!C.done;)C=C.value,f.push(C[0]+": "+C[1]),C=v.next();return f.join(`\r
`)};function io(f){f.onreadystatechange&&f.onreadystatechange.call(f)}Object.defineProperty(fl.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(f){this.m=f?"include":"same-origin"}});function un(f){let v="";return V(f,function(C,O){v+=O,v+=":",v+=C,v+=`\r
`}),v}function Ks(f,v,C){e:{for(O in C){var O=!1;break e}O=!0}O||(C=un(C),typeof f=="string"?C!=null&&encodeURIComponent(String(C)):Zt(f,v,C))}function Nt(f){Qt.call(this),this.headers=new Map,this.o=f||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}y(Nt,Qt);var so=/^https?$/i,ao=["POST","PUT"];t=Nt.prototype,t.Ha=function(f){this.J=f},t.ea=function(f,v,C,O){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+f);v=v?v.toUpperCase():"GET",this.D=f,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():U.g(),this.v=this.o?ol(this.o):ol(U),this.g.onreadystatechange=g(this.Ea,this);try{this.B=!0,this.g.open(v,String(f),!0),this.B=!1}catch(he){zu(this,he);return}if(f=C||"",C=new Map(this.headers),O)if(Object.getPrototypeOf(O)===Object.prototype)for(var se in O)C.set(se,O[se]);else if(typeof O.keys=="function"&&typeof O.get=="function")for(const he of O.keys())C.set(he,O.get(he));else throw Error("Unknown input type for opt_headers: "+String(O));O=Array.from(C.keys()).find(he=>he.toLowerCase()=="content-type"),se=o.FormData&&f instanceof o.FormData,!(0<=Array.prototype.indexOf.call(ao,v,void 0))||O||se||C.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[he,Ue]of C)this.g.setRequestHeader(he,Ue);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{qt(this),this.u=!0,this.g.send(f),this.u=!1}catch(he){zu(this,he)}};function zu(f,v){f.h=!1,f.g&&(f.j=!0,f.g.abort(),f.j=!1),f.l=v,f.m=5,dl(f),Ss(f)}function dl(f){f.A||(f.A=!0,Sr(f,"complete"),Sr(f,"error"))}t.abort=function(f){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=f||7,Sr(this,"complete"),Sr(this,"abort"),Ss(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ss(this,!0)),Nt.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Br(this):this.bb())},t.bb=function(){Br(this)};function Br(f){if(f.h&&typeof a<"u"&&(!f.v[1]||jr(f)!=4||f.Z()!=2)){if(f.u&&jr(f)==4)oi(f.Ea,0,f);else if(Sr(f,"readystatechange"),jr(f)==4){f.h=!1;try{const Ue=f.Z();e:switch(Ue){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var v=!0;break e;default:v=!1}var C;if(!(C=v)){var O;if(O=Ue===0){var se=String(f.D).match(eo)[1]||null;!se&&o.self&&o.self.location&&(se=o.self.location.protocol.slice(0,-1)),O=!so.test(se?se.toLowerCase():"")}C=O}if(C)Sr(f,"complete"),Sr(f,"success");else{f.m=6;try{var he=2<jr(f)?f.g.statusText:""}catch{he=""}f.l=he+" ["+f.Z()+"]",dl(f)}}finally{Ss(f)}}}}function Ss(f,v){if(f.g){qt(f);const C=f.g,O=f.v[0]?()=>{}:null;f.g=null,f.v=null,v||Sr(f,"ready");try{C.onreadystatechange=O}catch{}}}function qt(f){f.I&&(o.clearTimeout(f.I),f.I=null)}t.isActive=function(){return!!this.g};function jr(f){return f.g?f.g.readyState:0}t.Z=function(){try{return 2<jr(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(f){if(this.g){var v=this.g.responseText;return f&&v.indexOf(f)==0&&(v=v.substring(f.length)),Za(v)}};function hc(f){try{if(!f.g)return null;if("response"in f.g)return f.g.response;switch(f.H){case"":case"text":return f.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in f.g)return f.g.mozResponseArrayBuffer}return null}catch{return null}}function Wu(f){const v={};f=(f.g&&2<=jr(f)&&f.g.getAllResponseHeaders()||"").split(`\r
`);for(let O=0;O<f.length;O++){if(k(f[O]))continue;var C=N(f[O]);const se=C[0];if(C=C[1],typeof C!="string")continue;C=C.trim();const he=v[se]||[];v[se]=he,he.push(C)}S(v,function(O){return O.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Xs(f,v,C){return C&&C.internalChannelParams&&C.internalChannelParams[f]||v}function Ys(f){this.Aa=0,this.i=[],this.j=new on,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Xs("failFast",!1,f),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Xs("baseRetryDelayMs",5e3,f),this.cb=Xs("retryDelaySeedMs",1e4,f),this.Wa=Xs("forwardChannelMaxRetries",2,f),this.wa=Xs("forwardChannelRequestTimeoutMs",2e4,f),this.pa=f&&f.xmlHttpFactory||void 0,this.Xa=f&&f.Tb||void 0,this.Ca=f&&f.useFetchStreams||!1,this.L=void 0,this.J=f&&f.supportsCrossDomainXhr||!1,this.K="",this.h=new Vn(f&&f.concurrentRequestLimit),this.Da=new Uu,this.P=f&&f.fastHandshake||!1,this.O=f&&f.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=f&&f.Rb||!1,f&&f.xa&&this.j.xa(),f&&f.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&f&&f.detectBufferingProxy||!1,this.ja=void 0,f&&f.longPollingTimeout&&0<f.longPollingTimeout&&(this.ja=f.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Ys.prototype,t.la=8,t.G=1,t.connect=function(f,v,C,O){Yr(0),this.W=f,this.H=v||{},C&&O!==void 0&&(this.H.OSID=C,this.H.OAID=O),this.F=this.X,this.I=Mi(this,null,this.W),qs(this)};function pc(f){if(Jd(f),f.G==3){var v=f.U++,C=ln(f.I);if(Zt(C,"SID",f.K),Zt(C,"RID",v),Zt(C,"TYPE","terminate"),pl(f,C),v=new fe(f,f.j,v),v.L=2,v.v=Ea(ln(C)),C=!1,o.navigator&&o.navigator.sendBeacon)try{C=o.navigator.sendBeacon(v.v.toString(),"")}catch{}!C&&o.Image&&(new Image().src=v.v,C=!0),C||(v.g=gc(v.j,null),v.g.ea(v.v)),v.F=Date.now(),Ge(v)}gl(f)}function hl(f){f.g&&(Oi(f),f.g.cancel(),f.g=null)}function Jd(f){hl(f),f.u&&(o.clearTimeout(f.u),f.u=null),lo(f),f.h.cancel(),f.s&&(typeof f.s=="number"&&o.clearTimeout(f.s),f.s=null)}function qs(f){if(!vt(f.h)&&!f.s){f.s=!0;var v=f.Ga;De||Ae(),we||(De(),we=!0),re.add(v,f),f.B=0}}function Zd(f,v){return yn(f.h)>=f.h.j-(f.s?1:0)?!1:f.s?(f.i=v.D.concat(f.i),!0):f.G==1||f.G==2||f.B>=(f.Va?0:f.Wa)?!1:(f.s=ys(g(f.Ga,f,v),lr(f,f.B)),f.B++,!0)}t.Ga=function(f){if(this.s)if(this.s=null,this.G==1){if(!f){this.U=Math.floor(1e5*Math.random()),f=this.U++;const se=new fe(this,this.j,f);let he=this.o;if(this.S&&(he?(he=F(he),b(he,this.S)):he=this.S),this.m!==null||this.O||(se.H=he,he=null),this.P)e:{for(var v=0,C=0;C<this.i.length;C++){t:{var O=this.i[C];if("__data__"in O.map&&(O=O.map.__data__,typeof O=="string")){O=O.length;break t}O=void 0}if(O===void 0)break;if(v+=O,4096<v){v=C;break e}if(v===4096||C===this.i.length-1){v=C+1;break e}}v=1e3}else v=1e3;v=e0(this,se,v),C=ln(this.I),Zt(C,"RID",f),Zt(C,"CVER",22),this.D&&Zt(C,"X-HTTP-Session-Id",this.D),pl(this,C),he&&(this.O?v="headers="+encodeURIComponent(String(un(he)))+"&"+v:this.m&&Ks(C,this.m,he)),_s(this.h,se),this.Ua&&Zt(C,"TYPE","init"),this.P?(Zt(C,"$req",v),Zt(C,"SID","null"),se.T=!0,Ce(se,C,null)):Ce(se,C,v),this.G=2}}else this.G==3&&(f?Ts(this,f):this.i.length==0||vt(this.h)||Ts(this))};function Ts(f,v){var C;v?C=v.l:C=f.U++;const O=ln(f.I);Zt(O,"SID",f.K),Zt(O,"RID",C),Zt(O,"AID",f.T),pl(f,O),f.m&&f.o&&Ks(O,f.m,f.o),C=new fe(f,f.j,C,f.B+1),f.m===null&&(C.H=f.o),v&&(f.i=v.D.concat(f.i)),v=e0(f,C,1e3),C.I=Math.round(.5*f.wa)+Math.round(.5*f.wa*Math.random()),_s(f.h,C),Ce(C,O,v)}function pl(f,v){f.H&&V(f.H,function(C,O){Zt(v,O,C)}),f.l&&Ji({},function(C,O){Zt(v,O,C)})}function e0(f,v,C){C=Math.min(f.i.length,C);var O=f.l?g(f.l.Na,f.l,f):null;e:{var se=f.i;let he=-1;for(;;){const Ue=["count="+C];he==-1?0<C?(he=se[0].g,Ue.push("ofs="+he)):he=0:Ue.push("ofs="+he);let Jt=!0;for(let fn=0;fn<C;fn++){let Ot=se[fn].g;const Qr=se[fn].map;if(Ot-=he,0>Ot)he=Math.max(0,se[fn].g-100),Jt=!1;else try{Qd(Qr,Ue,"req"+Ot+"_")}catch{O&&O(Qr)}}if(Jt){O=Ue.join("&");break e}}}return f=f.i.splice(0,C),v.D=f,O}function t0(f){if(!f.g&&!f.u){f.Y=1;var v=f.Fa;De||Ae(),we||(De(),we=!0),re.add(v,f),f.v=0}}function oo(f){return f.g||f.u||3<=f.v?!1:(f.Y++,f.u=ys(g(f.Fa,f),lr(f,f.v)),f.v++,!0)}t.Fa=function(){if(this.u=null,Hu(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var f=2*this.R;this.j.info("BP detection timer enabled: "+f),this.A=ys(g(this.ab,this),f)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Yr(10),hl(this),Hu(this))};function Oi(f){f.A!=null&&(o.clearTimeout(f.A),f.A=null)}function Hu(f){f.g=new fe(f,f.j,"rpc",f.Y),f.m===null&&(f.g.H=f.o),f.g.O=0;var v=ln(f.qa);Zt(v,"RID","rpc"),Zt(v,"SID",f.K),Zt(v,"AID",f.T),Zt(v,"CI",f.F?"0":"1"),!f.F&&f.ja&&Zt(v,"TO",f.ja),Zt(v,"TYPE","xmlhttp"),pl(f,v),f.m&&f.o&&Ks(v,f.m,f.o),f.L&&(f.g.I=f.L);var C=f.g;f=f.ia,C.L=1,C.v=Ea(ln(v)),C.m=null,C.P=!0,je(C,f)}t.Za=function(){this.C!=null&&(this.C=null,hl(this),oo(this),Yr(19))};function lo(f){f.C!=null&&(o.clearTimeout(f.C),f.C=null)}function r0(f,v){var C=null;if(f.g==v){lo(f),Oi(f),f.g=null;var O=2}else if(Yt(f.h,v))C=v.D,va(f.h,v),O=1;else return;if(f.G!=0){if(v.o)if(O==1){C=v.m?v.m.length:0,v=Date.now()-v.F;var se=f.B;O=Us(),Sr(O,new xa(O,C)),qs(f)}else t0(f);else if(se=v.s,se==3||se==0&&0<v.X||!(O==1&&Zd(f,v)||O==2&&oo(f)))switch(C&&0<C.length&&(v=f.h,v.i=v.i.concat(C)),se){case 1:Vr(f,5);break;case 4:Vr(f,10);break;case 3:Vr(f,6);break;default:Vr(f,2)}}}function lr(f,v){let C=f.Ta+Math.floor(Math.random()*f.cb);return f.isActive()||(C*=2),C*v}function Vr(f,v){if(f.j.info("Error code "+v),v==2){var C=g(f.fb,f),O=f.Xa;const se=!O;O=new Di(O||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||ya(O,"https"),Ea(O),se?to(O.toString(),C):qd(O.toString(),C)}else Yr(2);f.G=0,f.l&&f.l.sa(v),gl(f),Jd(f)}t.fb=function(f){f?(this.j.info("Successfully pinged google.com"),Yr(2)):(this.j.info("Failed to ping google.com"),Yr(1))};function gl(f){if(f.G=0,f.ka=[],f.l){const v=Hs(f.h);(v.length!=0||f.i.length!=0)&&(E(f.ka,v),E(f.ka,f.i),f.h.i.length=0,x(f.i),f.i.length=0),f.l.ra()}}function Mi(f,v,C){var O=C instanceof Di?ln(C):new Di(C);if(O.g!="")v&&(O.g=v+"."+O.g),Es(O,O.s);else{var se=o.location;O=se.protocol,v=v?v+"."+se.hostname:se.hostname,se=+se.port;var he=new Di(null);O&&ya(he,O),v&&(he.g=v),se&&Es(he,se),C&&(he.l=C),O=he}return C=f.D,v=f.ya,C&&v&&Zt(O,C,v),Zt(O,"VER",f.la),pl(f,O),O}function gc(f,v,C){if(v&&!f.J)throw Error("Can't create secondary domain capable XhrIo object.");return v=f.Ca&&!f.pa?new Nt(new ul({eb:C})):new Nt(f.pa),v.Ha(f.J),v}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function n0(){}t=n0.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function mc(){}mc.prototype.g=function(f,v){return new Ur(f,v)};function Ur(f,v){Qt.call(this),this.g=new Ys(v),this.l=f,this.h=v&&v.messageUrlParams||null,f=v&&v.messageHeaders||null,v&&v.clientProtocolHeaderRequired&&(f?f["X-Client-Protocol"]="webchannel":f={"X-Client-Protocol":"webchannel"}),this.g.o=f,f=v&&v.initMessageHeaders||null,v&&v.messageContentType&&(f?f["X-WebChannel-Content-Type"]=v.messageContentType:f={"X-WebChannel-Content-Type":v.messageContentType}),v&&v.va&&(f?f["X-WebChannel-Client-Profile"]=v.va:f={"X-WebChannel-Client-Profile":v.va}),this.g.S=f,(f=v&&v.Sb)&&!k(f)&&(this.g.m=f),this.v=v&&v.supportsCrossDomainXhr||!1,this.u=v&&v.sendRawJson||!1,(v=v&&v.httpSessionIdParam)&&!k(v)&&(this.g.D=v,f=this.h,f!==null&&v in f&&(f=this.h,v in f&&delete f[v])),this.j=new es(this)}y(Ur,Qt),Ur.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Ur.prototype.close=function(){pc(this.g)},Ur.prototype.o=function(f){var v=this.g;if(typeof f=="string"){var C={};C.__data__=f,f=C}else this.u&&(C={},C.__data__=Ja(f),f=C);v.i.push(new ht(v.Ya++,f)),v.G==3&&qs(v)},Ur.prototype.N=function(){this.g.l=null,delete this.j,pc(this.g),delete this.g,Ur.aa.N.call(this)};function i0(f){br.call(this),f.__headers__&&(this.headers=f.__headers__,this.statusCode=f.__status__,delete f.__headers__,delete f.__status__);var v=f.__sm__;if(v){e:{for(const C in v){f=C;break e}f=void 0}(this.i=f)&&(f=this.i,v=v!==null&&f in v?v[f]:void 0),this.data=v}else this.data=f}y(i0,br);function xc(){_i.call(this),this.status=1}y(xc,_i);function es(f){this.g=f}y(es,n0),es.prototype.ua=function(){Sr(this.g,"a")},es.prototype.ta=function(f){Sr(this.g,new i0(f))},es.prototype.sa=function(f){Sr(this.g,new xc)},es.prototype.ra=function(){Sr(this.g,"b")},mc.prototype.createWebChannel=mc.prototype.g,Ur.prototype.send=Ur.prototype.o,Ur.prototype.open=Ur.prototype.m,Ur.prototype.close=Ur.prototype.close,Yk=function(){return new mc},Xk=function(){return Us()},Kk=Qi,vx={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},B.NO_ERROR=0,B.TIMEOUT=8,B.HTTP_ERROR=6,lh=B,X.COMPLETE="complete",Gk=X,vs.EventType=ae,ae.OPEN="a",ae.CLOSE="b",ae.ERROR="c",ae.MESSAGE="d",Qt.prototype.listen=Qt.prototype.K,hf=vs,Nt.prototype.listenOnce=Nt.prototype.L,Nt.prototype.getLastError=Nt.prototype.Ka,Nt.prototype.getLastErrorCode=Nt.prototype.Ba,Nt.prototype.getStatus=Nt.prototype.Z,Nt.prototype.getResponseJson=Nt.prototype.Oa,Nt.prototype.getResponseText=Nt.prototype.oa,Nt.prototype.send=Nt.prototype.ea,Nt.prototype.setWithCredentials=Nt.prototype.Ha,$k=Nt}).apply(typeof z0<"u"?z0:typeof self<"u"?self:typeof window<"u"?window:{});const fE="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}qn.UNAUTHENTICATED=new qn(null),qn.GOOGLE_CREDENTIALS=new qn("google-credentials-uid"),qn.FIRST_PARTY=new qn("first-party-uid"),qn.MOCK_USER=new qn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Nu="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yl=new xv("@firebase/firestore");function sf(){return Yl.logLevel}function Je(t,...e){if(Yl.logLevel<=Pt.DEBUG){const r=e.map(_v);Yl.debug(`Firestore (${Nu}): ${t}`,...r)}}function Wa(t,...e){if(Yl.logLevel<=Pt.ERROR){const r=e.map(_v);Yl.error(`Firestore (${Nu}): ${t}`,...r)}}function mu(t,...e){if(Yl.logLevel<=Pt.WARN){const r=e.map(_v);Yl.warn(`Firestore (${Nu}): ${t}`,...r)}}function _v(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ft(t="Unexpected state"){const e=`FIRESTORE (${Nu}) INTERNAL ASSERTION FAILED: `+t;throw Wa(e),new Error(e)}function sr(t,e){t||ft()}function mt(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const be={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class rt extends Qa{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ho{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qk{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class u7{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(qn.UNAUTHENTICATED))}shutdown(){}}class f7{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class d7{constructor(e){this.t=e,this.currentUser=qn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){sr(this.o===void 0);let n=this.i;const i=l=>this.i!==n?(n=this.i,r(l)):Promise.resolve();let s=new Ho;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Ho,e.enqueueRetryable(()=>i(this.currentUser))};const a=()=>{const l=s;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},o=l=>{Je("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(l=>o(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?o(l):(Je("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Ho)}},0),a()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(Je("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(sr(typeof n.accessToken=="string"),new qk(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return sr(e===null||typeof e=="string"),new qn(e)}}class h7{constructor(e,r,n){this.l=e,this.h=r,this.P=n,this.type="FirstParty",this.user=qn.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class p7{constructor(e,r,n){this.l=e,this.h=r,this.P=n}getToken(){return Promise.resolve(new h7(this.l,this.h,this.P))}start(e,r){e.enqueueRetryable(()=>r(qn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class g7{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class m7{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,r){sr(this.o===void 0);const n=s=>{s.error!=null&&Je("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const a=s.token!==this.R;return this.R=s.token,Je("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?r(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>n(s))};const i=s=>{Je("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):Je("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(sr(typeof r.token=="string"),this.R=r.token,new g7(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x7(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qk{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=Math.floor(256/e.length)*e.length;let n="";for(;n.length<20;){const i=x7(40);for(let s=0;s<i.length;++s)n.length<20&&i[s]<r&&(n+=e.charAt(i[s]%e.length))}return n}}function Xt(t,e){return t<e?-1:t>e?1:0}function xu(t,e,r){return t.length===e.length&&t.every((n,i)=>r(n,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xn{constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new rt(be.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new rt(be.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<-62135596800)throw new rt(be.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new rt(be.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return xn.fromMillis(Date.now())}static fromDate(e){return xn.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*r));return new xn(r,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Xt(this.nanoseconds,e.nanoseconds):Xt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gt{constructor(e){this.timestamp=e}static fromTimestamp(e){return new gt(e)}static min(){return new gt(new xn(0,0))}static max(){return new gt(new xn(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xd{constructor(e,r,n){r===void 0?r=0:r>e.length&&ft(),n===void 0?n=e.length-r:n>e.length-r&&ft(),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return xd.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof xd?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let i=0;i<n;i++){const s=e.get(i),a=r.get(i);if(s<a)return-1;if(s>a)return 1}return e.length<r.length?-1:e.length>r.length?1:0}}class Pr extends xd{construct(e,r,n){return new Pr(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new rt(be.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(i=>i.length>0))}return new Pr(r)}static emptyPath(){return new Pr([])}}const v7=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class On extends xd{construct(e,r,n){return new On(e,r,n)}static isValidIdentifier(e){return v7.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),On.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new On(["__name__"])}static fromServerFormat(e){const r=[];let n="",i=0;const s=()=>{if(n.length===0)throw new rt(be.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let a=!1;for(;i<e.length;){const o=e[i];if(o==="\\"){if(i+1===e.length)throw new rt(be.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new rt(be.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=l,i+=2}else o==="`"?(a=!a,i++):o!=="."||a?(n+=o,i++):(s(),i++)}if(s(),a)throw new rt(be.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new On(r)}static emptyPath(){return new On([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class it{constructor(e){this.path=e}static fromPath(e){return new it(Pr.fromString(e))}static fromName(e){return new it(Pr.fromString(e).popFirst(5))}static empty(){return new it(Pr.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Pr.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return Pr.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new it(new Pr(e.slice()))}}function y7(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,i=gt.fromTimestamp(n===1e9?new xn(r+1,0):new xn(r,n));return new Jo(i,it.empty(),e)}function _7(t){return new Jo(t.readTime,t.key,-1)}class Jo{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new Jo(gt.min(),it.empty(),-1)}static max(){return new Jo(gt.max(),it.empty(),-1)}}function E7(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=it.comparator(t.documentKey,e.documentKey),r!==0?r:Xt(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w7="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class S7{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ud(t){if(t.code!==be.FAILED_PRECONDITION||t.message!==w7)throw t;Je("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fe{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&ft(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new Fe((n,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(n,i)},this.catchCallback=s=>{this.wrapFailure(r,s).next(n,i)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof Fe?r:Fe.resolve(r)}catch(r){return Fe.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):Fe.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):Fe.reject(r)}static resolve(e){return new Fe((r,n)=>{r(e)})}static reject(e){return new Fe((r,n)=>{n(e)})}static waitFor(e){return new Fe((r,n)=>{let i=0,s=0,a=!1;e.forEach(o=>{++i,o.next(()=>{++s,a&&s===i&&r()},l=>n(l))}),a=!0,s===i&&r()})}static or(e){let r=Fe.resolve(!1);for(const n of e)r=r.next(i=>i?Fe.resolve(i):n());return r}static forEach(e,r){const n=[];return e.forEach((i,s)=>{n.push(r.call(this,i,s))}),this.waitFor(n)}static mapArray(e,r){return new Fe((n,i)=>{const s=e.length,a=new Array(s);let o=0;for(let l=0;l<s;l++){const c=l;r(e[c]).next(d=>{a[c]=d,++o,o===s&&n(a)},d=>i(d))}})}static doWhile(e,r){return new Fe((n,i)=>{const s=()=>{e()===!0?r().next(()=>{s()},i):n()};s()})}}function T7(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function zd(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ev{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ie(n),this.se=n=>r.writeSequenceNumber(n))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Ev.oe=-1;function Wp(t){return t==null}function np(t){return t===0&&1/t==-1/0}function A7(t){return typeof t=="number"&&Number.isInteger(t)&&!np(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dE(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function Du(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function Jk(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ir{constructor(e,r){this.comparator=e,this.root=r||Nn.EMPTY}insert(e,r){return new Ir(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,Nn.BLACK,null,null))}remove(e){return new Ir(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Nn.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return r+n.left.size;i<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new W0(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new W0(this.root,e,this.comparator,!1)}getReverseIterator(){return new W0(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new W0(this.root,e,this.comparator,!0)}}class W0{constructor(e,r,n,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=r?n(e.key,r):1,r&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Nn{constructor(e,r,n,i,s){this.key=e,this.value=r,this.color=n??Nn.RED,this.left=i??Nn.EMPTY,this.right=s??Nn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,i,s){return new Nn(e??this.key,r??this.value,n??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let i=this;const s=n(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,r,n),null):s===0?i.copy(null,r,null,null,null):i.copy(null,null,null,null,i.right.insert(e,r,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Nn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,i=this;if(r(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,r),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),r(e,i.key)===0){if(i.right.isEmpty())return Nn.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,r))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Nn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Nn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw ft();const e=this.left.check();if(e!==this.right.check())throw ft();return e+(this.isRed()?0:1)}}Nn.EMPTY=null,Nn.RED=!0,Nn.BLACK=!1;Nn.EMPTY=new class{constructor(){this.size=0}get key(){throw ft()}get value(){throw ft()}get color(){throw ft()}get left(){throw ft()}get right(){throw ft()}copy(e,r,n,i,s){return this}insert(e,r,n){return new Nn(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ln{constructor(e){this.comparator=e,this.data=new Ir(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;r(i.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new hE(this.data.getIterator())}getIteratorFrom(e){return new hE(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof Ln)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const i=r.getNext().key,s=n.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new Ln(this.comparator);return r.data=e,r}}class hE{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ps{constructor(e){this.fields=e,e.sort(On.comparator)}static empty(){return new Ps([])}unionWith(e){let r=new Ln(On.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new Ps(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return xu(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zk extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jn{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new Zk("Invalid base64 string: "+s):s}}(e);return new jn(r)}static fromUint8Array(e){const r=function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s}(e);return new jn(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Xt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}jn.EMPTY_BYTE_STRING=new jn("");const k7=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Zo(t){if(sr(!!t),typeof t=="string"){let e=0;const r=k7.exec(t);if(sr(!!r),r[1]){let i=r[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:$r(t.seconds),nanos:$r(t.nanos)}}function $r(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function ql(t){return typeof t=="string"?jn.fromBase64String(t):jn.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wv(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="server_timestamp"}function Sv(t){const e=t.mapValue.fields.__previous_value__;return wv(e)?Sv(e):e}function vd(t){const e=Zo(t.mapValue.fields.__local_write_time__.timestampValue);return new xn(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C7{constructor(e,r,n,i,s,a,o,l,c){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=o,this.longPollingOptions=l,this.useFetchStreams=c}}class yd{constructor(e,r){this.projectId=e,this.database=r||"(default)"}static empty(){return new yd("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof yd&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H0={mapValue:{}};function Ql(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?wv(t)?4:I7(t)?9007199254740991:F7(t)?10:11:ft()}function da(t,e){if(t===e)return!0;const r=Ql(t);if(r!==Ql(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return vd(t).isEqual(vd(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const a=Zo(i.timestampValue),o=Zo(s.timestampValue);return a.seconds===o.seconds&&a.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return ql(i.bytesValue).isEqual(ql(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return $r(i.geoPointValue.latitude)===$r(s.geoPointValue.latitude)&&$r(i.geoPointValue.longitude)===$r(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return $r(i.integerValue)===$r(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const a=$r(i.doubleValue),o=$r(s.doubleValue);return a===o?np(a)===np(o):isNaN(a)&&isNaN(o)}return!1}(t,e);case 9:return xu(t.arrayValue.values||[],e.arrayValue.values||[],da);case 10:case 11:return function(i,s){const a=i.mapValue.fields||{},o=s.mapValue.fields||{};if(dE(a)!==dE(o))return!1;for(const l in a)if(a.hasOwnProperty(l)&&(o[l]===void 0||!da(a[l],o[l])))return!1;return!0}(t,e);default:return ft()}}function _d(t,e){return(t.values||[]).find(r=>da(r,e))!==void 0}function vu(t,e){if(t===e)return 0;const r=Ql(t),n=Ql(e);if(r!==n)return Xt(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return Xt(t.booleanValue,e.booleanValue);case 2:return function(s,a){const o=$r(s.integerValue||s.doubleValue),l=$r(a.integerValue||a.doubleValue);return o<l?-1:o>l?1:o===l?0:isNaN(o)?isNaN(l)?0:-1:1}(t,e);case 3:return pE(t.timestampValue,e.timestampValue);case 4:return pE(vd(t),vd(e));case 5:return Xt(t.stringValue,e.stringValue);case 6:return function(s,a){const o=ql(s),l=ql(a);return o.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(s,a){const o=s.split("/"),l=a.split("/");for(let c=0;c<o.length&&c<l.length;c++){const d=Xt(o[c],l[c]);if(d!==0)return d}return Xt(o.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,a){const o=Xt($r(s.latitude),$r(a.latitude));return o!==0?o:Xt($r(s.longitude),$r(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return gE(t.arrayValue,e.arrayValue);case 10:return function(s,a){var o,l,c,d;const h=s.fields||{},g=a.fields||{},m=(o=h.value)===null||o===void 0?void 0:o.arrayValue,y=(l=g.value)===null||l===void 0?void 0:l.arrayValue,x=Xt(((c=m==null?void 0:m.values)===null||c===void 0?void 0:c.length)||0,((d=y==null?void 0:y.values)===null||d===void 0?void 0:d.length)||0);return x!==0?x:gE(m,y)}(t.mapValue,e.mapValue);case 11:return function(s,a){if(s===H0.mapValue&&a===H0.mapValue)return 0;if(s===H0.mapValue)return 1;if(a===H0.mapValue)return-1;const o=s.fields||{},l=Object.keys(o),c=a.fields||{},d=Object.keys(c);l.sort(),d.sort();for(let h=0;h<l.length&&h<d.length;++h){const g=Xt(l[h],d[h]);if(g!==0)return g;const m=vu(o[l[h]],c[d[h]]);if(m!==0)return m}return Xt(l.length,d.length)}(t.mapValue,e.mapValue);default:throw ft()}}function pE(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Xt(t,e);const r=Zo(t),n=Zo(e),i=Xt(r.seconds,n.seconds);return i!==0?i:Xt(r.nanos,n.nanos)}function gE(t,e){const r=t.values||[],n=e.values||[];for(let i=0;i<r.length&&i<n.length;++i){const s=vu(r[i],n[i]);if(s)return s}return Xt(r.length,n.length)}function yu(t){return yx(t)}function yx(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=Zo(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return ql(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return it.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",i=!0;for(const s of r.values||[])i?i=!1:n+=",",n+=yx(s);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let i="{",s=!0;for(const a of n)s?s=!1:i+=",",i+=`${a}:${yx(r.fields[a])}`;return i+"}"}(t.mapValue):ft()}function _x(t){return!!t&&"integerValue"in t}function Tv(t){return!!t&&"arrayValue"in t}function mE(t){return!!t&&"nullValue"in t}function xE(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function ch(t){return!!t&&"mapValue"in t}function F7(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="__vector__"}function Pf(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Du(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=Pf(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=Pf(t.arrayValue.values[r]);return e}return Object.assign({},t)}function I7(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cs{constructor(e){this.value=e}static empty(){return new cs({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!ch(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=Pf(r)}setAll(e){let r=On.emptyPath(),n={},i=[];e.forEach((a,o)=>{if(!r.isImmediateParentOf(o)){const l=this.getFieldsMap(r);this.applyChanges(l,n,i),n={},i=[],r=o.popLast()}a?n[o.lastSegment()]=Pf(a):i.push(o.lastSegment())});const s=this.getFieldsMap(r);this.applyChanges(s,n,i)}delete(e){const r=this.field(e.popLast());ch(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return da(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=r.mapValue.fields[e.get(n)];ch(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=i),r=i}return r.mapValue.fields}applyChanges(e,r,n){Du(r,(i,s)=>e[i]=s);for(const i of n)delete e[i]}clone(){return new cs(Pf(this.value))}}function eC(t){const e=[];return Du(t.fields,(r,n)=>{const i=new On([r]);if(ch(n)){const s=eC(n.mapValue).fields;if(s.length===0)e.push(i);else for(const a of s)e.push(i.child(a))}else e.push(i)}),new Ps(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ei{constructor(e,r,n,i,s,a,o){this.key=e,this.documentType=r,this.version=n,this.readTime=i,this.createTime=s,this.data=a,this.documentState=o}static newInvalidDocument(e){return new ei(e,0,gt.min(),gt.min(),gt.min(),cs.empty(),0)}static newFoundDocument(e,r,n,i){return new ei(e,1,r,gt.min(),n,i,0)}static newNoDocument(e,r){return new ei(e,2,r,gt.min(),gt.min(),cs.empty(),0)}static newUnknownDocument(e,r){return new ei(e,3,r,gt.min(),gt.min(),cs.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(gt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=cs.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=cs.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=gt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof ei&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new ei(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ip{constructor(e,r){this.position=e,this.inclusive=r}}function vE(t,e,r){let n=0;for(let i=0;i<t.position.length;i++){const s=e[i],a=t.position[i];if(s.field.isKeyField()?n=it.comparator(it.fromName(a.referenceValue),r.key):n=vu(a,r.data.field(s.field)),s.dir==="desc"&&(n*=-1),n!==0)break}return n}function yE(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!da(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sp{constructor(e,r="asc"){this.field=e,this.dir=r}}function b7(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tC{}class gn extends tC{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new N7(e,r,n):r==="array-contains"?new O7(e,n):r==="in"?new M7(e,n):r==="not-in"?new L7(e,n):r==="array-contains-any"?new B7(e,n):new gn(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new D7(e,n):new P7(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&this.matchesComparison(vu(r,this.value)):r!==null&&Ql(this.value)===Ql(r)&&this.matchesComparison(vu(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ft()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ha extends tC{constructor(e,r){super(),this.filters=e,this.op=r,this.ae=null}static create(e,r){return new ha(e,r)}matches(e){return rC(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function rC(t){return t.op==="and"}function nC(t){return R7(t)&&rC(t)}function R7(t){for(const e of t.filters)if(e instanceof ha)return!1;return!0}function Ex(t){if(t instanceof gn)return t.field.canonicalString()+t.op.toString()+yu(t.value);if(nC(t))return t.filters.map(e=>Ex(e)).join(",");{const e=t.filters.map(r=>Ex(r)).join(",");return`${t.op}(${e})`}}function iC(t,e){return t instanceof gn?function(n,i){return i instanceof gn&&n.op===i.op&&n.field.isEqual(i.field)&&da(n.value,i.value)}(t,e):t instanceof ha?function(n,i){return i instanceof ha&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((s,a,o)=>s&&iC(a,i.filters[o]),!0):!1}(t,e):void ft()}function sC(t){return t instanceof gn?function(r){return`${r.field.canonicalString()} ${r.op} ${yu(r.value)}`}(t):t instanceof ha?function(r){return r.op.toString()+" {"+r.getFilters().map(sC).join(" ,")+"}"}(t):"Filter"}class N7 extends gn{constructor(e,r,n){super(e,r,n),this.key=it.fromName(n.referenceValue)}matches(e){const r=it.comparator(e.key,this.key);return this.matchesComparison(r)}}class D7 extends gn{constructor(e,r){super(e,"in",r),this.keys=aC("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class P7 extends gn{constructor(e,r){super(e,"not-in",r),this.keys=aC("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function aC(t,e){var r;return(((r=e.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(n=>it.fromName(n.referenceValue))}class O7 extends gn{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return Tv(r)&&_d(r.arrayValue,this.value)}}class M7 extends gn{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&_d(this.value.arrayValue,r)}}class L7 extends gn{constructor(e,r){super(e,"not-in",r)}matches(e){if(_d(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&!_d(this.value.arrayValue,r)}}class B7 extends gn{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!Tv(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>_d(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j7{constructor(e,r=null,n=[],i=[],s=null,a=null,o=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=i,this.limit=s,this.startAt=a,this.endAt=o,this.ue=null}}function _E(t,e=null,r=[],n=[],i=null,s=null,a=null){return new j7(t,e,r,n,i,s,a)}function Av(t){const e=mt(t);if(e.ue===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>Ex(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(s){return s.field.canonicalString()+s.dir}(n)).join(","),Wp(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>yu(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>yu(n)).join(",")),e.ue=r}return e.ue}function kv(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!b7(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!iC(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!yE(t.startAt,e.startAt)&&yE(t.endAt,e.endAt)}function wx(t){return it.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hp{constructor(e,r=null,n=[],i=[],s=null,a="F",o=null,l=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=i,this.limit=s,this.limitType=a,this.startAt=o,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function V7(t,e,r,n,i,s,a,o){return new Hp(t,e,r,n,i,s,a,o)}function $p(t){return new Hp(t)}function EE(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function U7(t){return t.collectionGroup!==null}function Of(t){const e=mt(t);if(e.ce===null){e.ce=[];const r=new Set;for(const s of e.explicitOrderBy)e.ce.push(s),r.add(s.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let o=new Ln(On.comparator);return a.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(o=o.add(c.field))})}),o})(e).forEach(s=>{r.has(s.canonicalString())||s.isKeyField()||e.ce.push(new sp(s,n))}),r.has(On.keyField().canonicalString())||e.ce.push(new sp(On.keyField(),n))}return e.ce}function la(t){const e=mt(t);return e.le||(e.le=z7(e,Of(t))),e.le}function z7(t,e){if(t.limitType==="F")return _E(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new sp(i.field,s)});const r=t.endAt?new ip(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new ip(t.startAt.position,t.startAt.inclusive):null;return _E(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function Sx(t,e,r){return new Hp(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function Gp(t,e){return kv(la(t),la(e))&&t.limitType===e.limitType}function oC(t){return`${Av(la(t))}|lt:${t.limitType}`}function Cc(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(i=>sC(i)).join(", ")}]`),Wp(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(i=>yu(i)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(i=>yu(i)).join(",")),`Target(${n})`}(la(t))}; limitType=${t.limitType})`}function Kp(t,e){return e.isFoundDocument()&&function(n,i){const s=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):it.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)}(t,e)&&function(n,i){for(const s of Of(n))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(n,i){for(const s of n.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(n,i){return!(n.startAt&&!function(a,o,l){const c=vE(a,o,l);return a.inclusive?c<=0:c<0}(n.startAt,Of(n),i)||n.endAt&&!function(a,o,l){const c=vE(a,o,l);return a.inclusive?c>=0:c>0}(n.endAt,Of(n),i))}(t,e)}function W7(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function lC(t){return(e,r)=>{let n=!1;for(const i of Of(t)){const s=H7(i,e,r);if(s!==0)return s;n=n||i.field.isKeyField()}return 0}}function H7(t,e,r){const n=t.field.isKeyField()?it.comparator(e.key,r.key):function(s,a,o){const l=a.data.field(s),c=o.data.field(s);return l!==null&&c!==null?vu(l,c):ft()}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return ft()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pu{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[i,s]of n)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,r]);i.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[r]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Du(this.inner,(r,n)=>{for(const[i,s]of n)e(i,s)})}isEmpty(){return Jk(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $7=new Ir(it.comparator);function Ha(){return $7}const cC=new Ir(it.comparator);function pf(...t){let e=cC;for(const r of t)e=e.insert(r.key,r);return e}function uC(t){let e=cC;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function Fl(){return Mf()}function fC(){return Mf()}function Mf(){return new Pu(t=>t.toString(),(t,e)=>t.isEqual(e))}const G7=new Ir(it.comparator),K7=new Ln(it.comparator);function bt(...t){let e=K7;for(const r of t)e=e.add(r);return e}const X7=new Ln(Xt);function Y7(){return X7}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cv(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:np(e)?"-0":e}}function dC(t){return{integerValue:""+t}}function q7(t,e){return A7(e)?dC(e):Cv(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xp{constructor(){this._=void 0}}function Q7(t,e,r){return t instanceof ap?function(i,s){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&wv(s)&&(s=Sv(s)),s&&(a.fields.__previous_value__=s),{mapValue:a}}(r,e):t instanceof Ed?pC(t,e):t instanceof wd?gC(t,e):function(i,s){const a=hC(i,s),o=wE(a)+wE(i.Pe);return _x(a)&&_x(i.Pe)?dC(o):Cv(i.serializer,o)}(t,e)}function J7(t,e,r){return t instanceof Ed?pC(t,e):t instanceof wd?gC(t,e):r}function hC(t,e){return t instanceof op?function(n){return _x(n)||function(s){return!!s&&"doubleValue"in s}(n)}(e)?e:{integerValue:0}:null}class ap extends Xp{}class Ed extends Xp{constructor(e){super(),this.elements=e}}function pC(t,e){const r=mC(e);for(const n of t.elements)r.some(i=>da(i,n))||r.push(n);return{arrayValue:{values:r}}}class wd extends Xp{constructor(e){super(),this.elements=e}}function gC(t,e){let r=mC(e);for(const n of t.elements)r=r.filter(i=>!da(i,n));return{arrayValue:{values:r}}}class op extends Xp{constructor(e,r){super(),this.serializer=e,this.Pe=r}}function wE(t){return $r(t.integerValue||t.doubleValue)}function mC(t){return Tv(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function Z7(t,e){return t.field.isEqual(e.field)&&function(n,i){return n instanceof Ed&&i instanceof Ed||n instanceof wd&&i instanceof wd?xu(n.elements,i.elements,da):n instanceof op&&i instanceof op?da(n.Pe,i.Pe):n instanceof ap&&i instanceof ap}(t.transform,e.transform)}class eV{constructor(e,r){this.version=e,this.transformResults=r}}class Ma{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new Ma}static exists(e){return new Ma(void 0,e)}static updateTime(e){return new Ma(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function uh(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Yp{}function xC(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new yC(t.key,Ma.none()):new Wd(t.key,t.data,Ma.none());{const r=t.data,n=cs.empty();let i=new Ln(On.comparator);for(let s of e.fields)if(!i.has(s)){let a=r.field(s);a===null&&s.length>1&&(s=s.popLast(),a=r.field(s)),a===null?n.delete(s):n.set(s,a),i=i.add(s)}return new oc(t.key,n,new Ps(i.toArray()),Ma.none())}}function tV(t,e,r){t instanceof Wd?function(i,s,a){const o=i.value.clone(),l=TE(i.fieldTransforms,s,a.transformResults);o.setAll(l),s.convertToFoundDocument(a.version,o).setHasCommittedMutations()}(t,e,r):t instanceof oc?function(i,s,a){if(!uh(i.precondition,s))return void s.convertToUnknownDocument(a.version);const o=TE(i.fieldTransforms,s,a.transformResults),l=s.data;l.setAll(vC(i)),l.setAll(o),s.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(t,e,r):function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,r)}function Lf(t,e,r,n){return t instanceof Wd?function(s,a,o,l){if(!uh(s.precondition,a))return o;const c=s.value.clone(),d=AE(s.fieldTransforms,l,a);return c.setAll(d),a.convertToFoundDocument(a.version,c).setHasLocalMutations(),null}(t,e,r,n):t instanceof oc?function(s,a,o,l){if(!uh(s.precondition,a))return o;const c=AE(s.fieldTransforms,l,a),d=a.data;return d.setAll(vC(s)),d.setAll(c),a.convertToFoundDocument(a.version,d).setHasLocalMutations(),o===null?null:o.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(h=>h.field))}(t,e,r,n):function(s,a,o){return uh(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):o}(t,e,r)}function rV(t,e){let r=null;for(const n of t.fieldTransforms){const i=e.data.field(n.field),s=hC(n.transform,i||null);s!=null&&(r===null&&(r=cs.empty()),r.set(n.field,s))}return r||null}function SE(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&xu(n,i,(s,a)=>Z7(s,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Wd extends Yp{constructor(e,r,n,i=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class oc extends Yp{constructor(e,r,n,i,s=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function vC(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function TE(t,e,r){const n=new Map;sr(t.length===r.length);for(let i=0;i<r.length;i++){const s=t[i],a=s.transform,o=e.data.field(s.field);n.set(s.field,J7(a,o,r[i]))}return n}function AE(t,e,r){const n=new Map;for(const i of t){const s=i.transform,a=r.data.field(i.field);n.set(i.field,Q7(s,a,e))}return n}class yC extends Yp{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class nV extends Yp{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iV{constructor(e,r,n,i){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&tV(s,e,n[i])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=Lf(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=Lf(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=fC();return this.mutations.forEach(i=>{const s=e.get(i.key),a=s.overlayedDocument;let o=this.applyToLocalView(a,s.mutatedFields);o=r.has(i.key)?null:o;const l=xC(a,o);l!==null&&n.set(i.key,l),a.isValidDocument()||a.convertToNoDocument(gt.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),bt())}isEqual(e){return this.batchId===e.batchId&&xu(this.mutations,e.mutations,(r,n)=>SE(r,n))&&xu(this.baseMutations,e.baseMutations,(r,n)=>SE(r,n))}}class Fv{constructor(e,r,n,i){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=i}static from(e,r,n){sr(e.mutations.length===n.length);let i=function(){return G7}();const s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,n[a].version);return new Fv(e,r,n,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sV{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aV{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var en,Mt;function oV(t){switch(t){default:return ft();case be.CANCELLED:case be.UNKNOWN:case be.DEADLINE_EXCEEDED:case be.RESOURCE_EXHAUSTED:case be.INTERNAL:case be.UNAVAILABLE:case be.UNAUTHENTICATED:return!1;case be.INVALID_ARGUMENT:case be.NOT_FOUND:case be.ALREADY_EXISTS:case be.PERMISSION_DENIED:case be.FAILED_PRECONDITION:case be.ABORTED:case be.OUT_OF_RANGE:case be.UNIMPLEMENTED:case be.DATA_LOSS:return!0}}function _C(t){if(t===void 0)return Wa("GRPC error has no .code"),be.UNKNOWN;switch(t){case en.OK:return be.OK;case en.CANCELLED:return be.CANCELLED;case en.UNKNOWN:return be.UNKNOWN;case en.DEADLINE_EXCEEDED:return be.DEADLINE_EXCEEDED;case en.RESOURCE_EXHAUSTED:return be.RESOURCE_EXHAUSTED;case en.INTERNAL:return be.INTERNAL;case en.UNAVAILABLE:return be.UNAVAILABLE;case en.UNAUTHENTICATED:return be.UNAUTHENTICATED;case en.INVALID_ARGUMENT:return be.INVALID_ARGUMENT;case en.NOT_FOUND:return be.NOT_FOUND;case en.ALREADY_EXISTS:return be.ALREADY_EXISTS;case en.PERMISSION_DENIED:return be.PERMISSION_DENIED;case en.FAILED_PRECONDITION:return be.FAILED_PRECONDITION;case en.ABORTED:return be.ABORTED;case en.OUT_OF_RANGE:return be.OUT_OF_RANGE;case en.UNIMPLEMENTED:return be.UNIMPLEMENTED;case en.DATA_LOSS:return be.DATA_LOSS;default:return ft()}}(Mt=en||(en={}))[Mt.OK=0]="OK",Mt[Mt.CANCELLED=1]="CANCELLED",Mt[Mt.UNKNOWN=2]="UNKNOWN",Mt[Mt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Mt[Mt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Mt[Mt.NOT_FOUND=5]="NOT_FOUND",Mt[Mt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Mt[Mt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Mt[Mt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Mt[Mt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Mt[Mt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Mt[Mt.ABORTED=10]="ABORTED",Mt[Mt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Mt[Mt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Mt[Mt.INTERNAL=13]="INTERNAL",Mt[Mt.UNAVAILABLE=14]="UNAVAILABLE",Mt[Mt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lV(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cV=new Ol([4294967295,4294967295],0);function kE(t){const e=lV().encode(t),r=new Hk;return r.update(e),new Uint8Array(r.digest())}function CE(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Ol([r,n],0),new Ol([i,s],0)]}class Iv{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new gf(`Invalid padding: ${r}`);if(n<0)throw new gf(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new gf(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new gf(`Invalid padding when bitmap length is 0: ${r}`);this.Ie=8*e.length-r,this.Te=Ol.fromNumber(this.Ie)}Ee(e,r,n){let i=e.add(r.multiply(Ol.fromNumber(n)));return i.compare(cV)===1&&(i=new Ol([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const r=kE(e),[n,i]=CE(r);for(let s=0;s<this.hashCount;s++){const a=this.Ee(n,i,s);if(!this.de(a))return!1}return!0}static create(e,r,n){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new Iv(s,i,r);return n.forEach(o=>a.insert(o)),a}insert(e){if(this.Ie===0)return;const r=kE(e),[n,i]=CE(r);for(let s=0;s<this.hashCount;s++){const a=this.Ee(n,i,s);this.Ae(a)}}Ae(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class gf extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qp{constructor(e,r,n,i,s){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const i=new Map;return i.set(e,Hd.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new qp(gt.min(),i,new Ir(Xt),Ha(),bt())}}class Hd{constructor(e,r,n,i,s){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new Hd(n,r,bt(),bt(),bt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fh{constructor(e,r,n,i){this.Re=e,this.removedTargetIds=r,this.key=n,this.Ve=i}}class EC{constructor(e,r){this.targetId=e,this.me=r}}class wC{constructor(e,r,n=jn.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=i}}class FE{constructor(){this.fe=0,this.ge=bE(),this.pe=jn.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=bt(),r=bt(),n=bt();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:r=r.add(i);break;case 1:n=n.add(i);break;default:ft()}}),new Hd(this.pe,this.ye,e,r,n)}Ce(){this.we=!1,this.ge=bE()}Fe(e,r){this.we=!0,this.ge=this.ge.insert(e,r)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,sr(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class uV{constructor(e){this.Le=e,this.Be=new Map,this.ke=Ha(),this.qe=IE(),this.Qe=new Ir(Xt)}Ke(e){for(const r of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(r,e.Ve):this.Ue(r,e.key,e.Ve);for(const r of e.removedTargetIds)this.Ue(r,e.key,e.Ve)}We(e){this.forEachTarget(e,r=>{const n=this.Ge(r);switch(e.state){case 0:this.ze(r)&&n.De(e.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(e.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(r);break;case 3:this.ze(r)&&(n.Ne(),n.De(e.resumeToken));break;case 4:this.ze(r)&&(this.je(r),n.De(e.resumeToken));break;default:ft()}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.Be.forEach((n,i)=>{this.ze(i)&&r(i)})}He(e){const r=e.targetId,n=e.me.count,i=this.Je(r);if(i){const s=i.target;if(wx(s))if(n===0){const a=new it(s.path);this.Ue(r,a,ei.newNoDocument(a,gt.min()))}else sr(n===1);else{const a=this.Ye(r);if(a!==n){const o=this.Ze(e),l=o?this.Xe(o,e,a):1;if(l!==0){this.je(r);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(r,c)}}}}}Ze(e){const r=e.me.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:s=0}=r;let a,o;try{a=ql(n).toUint8Array()}catch(l){if(l instanceof Zk)return mu("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{o=new Iv(a,i,s)}catch(l){return mu(l instanceof gf?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return o.Ie===0?null:o}Xe(e,r,n){return r.me.count===n-this.nt(e,r.targetId)?0:2}nt(e,r){const n=this.Le.getRemoteKeysForTarget(r);let i=0;return n.forEach(s=>{const a=this.Le.tt(),o=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(o)||(this.Ue(r,s,null),i++)}),i}rt(e){const r=new Map;this.Be.forEach((s,a)=>{const o=this.Je(a);if(o){if(s.current&&wx(o.target)){const l=new it(o.target.path);this.ke.get(l)!==null||this.it(a,l)||this.Ue(a,l,ei.newNoDocument(l,e))}s.be&&(r.set(a,s.ve()),s.Ce())}});let n=bt();this.qe.forEach((s,a)=>{let o=!0;a.forEachWhile(l=>{const c=this.Je(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)}),o&&(n=n.add(s))}),this.ke.forEach((s,a)=>a.setReadTime(e));const i=new qp(e,r,this.Qe,this.ke,n);return this.ke=Ha(),this.qe=IE(),this.Qe=new Ir(Xt),i}$e(e,r){if(!this.ze(e))return;const n=this.it(e,r.key)?2:0;this.Ge(e).Fe(r.key,n),this.ke=this.ke.insert(r.key,r),this.qe=this.qe.insert(r.key,this.st(r.key).add(e))}Ue(e,r,n){if(!this.ze(e))return;const i=this.Ge(e);this.it(e,r)?i.Fe(r,1):i.Me(r),this.qe=this.qe.insert(r,this.st(r).delete(e)),n&&(this.ke=this.ke.insert(r,n))}removeTarget(e){this.Be.delete(e)}Ye(e){const r=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let r=this.Be.get(e);return r||(r=new FE,this.Be.set(e,r)),r}st(e){let r=this.qe.get(e);return r||(r=new Ln(Xt),this.qe=this.qe.insert(e,r)),r}ze(e){const r=this.Je(e)!==null;return r||Je("WatchChangeAggregator","Detected inactive target",e),r}Je(e){const r=this.Be.get(e);return r&&r.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new FE),this.Le.getRemoteKeysForTarget(e).forEach(r=>{this.Ue(e,r,null)})}it(e,r){return this.Le.getRemoteKeysForTarget(e).has(r)}}function IE(){return new Ir(it.comparator)}function bE(){return new Ir(it.comparator)}const fV={asc:"ASCENDING",desc:"DESCENDING"},dV={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},hV={and:"AND",or:"OR"};class pV{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function Tx(t,e){return t.useProto3Json||Wp(e)?e:{value:e}}function lp(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function SC(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function gV(t,e){return lp(t,e.toTimestamp())}function ca(t){return sr(!!t),gt.fromTimestamp(function(r){const n=Zo(r);return new xn(n.seconds,n.nanos)}(t))}function bv(t,e){return Ax(t,e).canonicalString()}function Ax(t,e){const r=function(i){return new Pr(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?r:r.child(e)}function TC(t){const e=Pr.fromString(t);return sr(IC(e)),e}function kx(t,e){return bv(t.databaseId,e.path)}function tm(t,e){const r=TC(e);if(r.get(1)!==t.databaseId.projectId)throw new rt(be.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new rt(be.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new it(kC(r))}function AC(t,e){return bv(t.databaseId,e)}function mV(t){const e=TC(t);return e.length===4?Pr.emptyPath():kC(e)}function Cx(t){return new Pr(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function kC(t){return sr(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function RE(t,e,r){return{name:kx(t,e),fields:r.value.mapValue.fields}}function xV(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:ft()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(c,d){return c.useProto3Json?(sr(d===void 0||typeof d=="string"),jn.fromBase64String(d||"")):(sr(d===void 0||d instanceof Buffer||d instanceof Uint8Array),jn.fromUint8Array(d||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,o=a&&function(c){const d=c.code===void 0?be.UNKNOWN:_C(c.code);return new rt(d,c.message||"")}(a);r=new wC(n,i,s,o||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const i=tm(t,n.document.name),s=ca(n.document.updateTime),a=n.document.createTime?ca(n.document.createTime):gt.min(),o=new cs({mapValue:{fields:n.document.fields}}),l=ei.newFoundDocument(i,s,a,o),c=n.targetIds||[],d=n.removedTargetIds||[];r=new fh(c,d,l.key,l)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const i=tm(t,n.document),s=n.readTime?ca(n.readTime):gt.min(),a=ei.newNoDocument(i,s),o=n.removedTargetIds||[];r=new fh([],o,a.key,a)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const i=tm(t,n.document),s=n.removedTargetIds||[];r=new fh([],s,i,null)}else{if(!("filter"in e))return ft();{e.filter;const n=e.filter;n.targetId;const{count:i=0,unchangedNames:s}=n,a=new aV(i,s),o=n.targetId;r=new EC(o,a)}}return r}function vV(t,e){let r;if(e instanceof Wd)r={update:RE(t,e.key,e.value)};else if(e instanceof yC)r={delete:kx(t,e.key)};else if(e instanceof oc)r={update:RE(t,e.key,e.data),updateMask:CV(e.fieldMask)};else{if(!(e instanceof nV))return ft();r={verify:kx(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(s,a){const o=a.transform;if(o instanceof ap)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof Ed)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof wd)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof op)return{fieldPath:a.field.canonicalString(),increment:o.Pe};throw ft()}(0,n))),e.precondition.isNone||(r.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:gV(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:ft()}(t,e.precondition)),r}function yV(t,e){return t&&t.length>0?(sr(e!==void 0),t.map(r=>function(i,s){let a=i.updateTime?ca(i.updateTime):ca(s);return a.isEqual(gt.min())&&(a=ca(s)),new eV(a,i.transformResults||[])}(r,e))):[]}function _V(t,e){return{documents:[AC(t,e.path)]}}function EV(t,e){const r={structuredQuery:{}},n=e.path;let i;e.collectionGroup!==null?(i=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=AC(t,i);const s=function(c){if(c.length!==0)return FC(ha.create(c,"and"))}(e.filters);s&&(r.structuredQuery.where=s);const a=function(c){if(c.length!==0)return c.map(d=>function(g){return{field:Fc(g.field),direction:TV(g.dir)}}(d))}(e.orderBy);a&&(r.structuredQuery.orderBy=a);const o=Tx(t,e.limit);return o!==null&&(r.structuredQuery.limit=o),e.startAt&&(r.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{_t:r,parent:i}}function wV(t){let e=mV(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let i=null;if(n>0){sr(n===1);const d=r.from[0];d.allDescendants?i=d.collectionId:e=e.child(d.collectionId)}let s=[];r.where&&(s=function(h){const g=CC(h);return g instanceof ha&&nC(g)?g.getFilters():[g]}(r.where));let a=[];r.orderBy&&(a=function(h){return h.map(g=>function(y){return new sp(Ic(y.field),function(E){switch(E){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(y.direction))}(g))}(r.orderBy));let o=null;r.limit&&(o=function(h){let g;return g=typeof h=="object"?h.value:h,Wp(g)?null:g}(r.limit));let l=null;r.startAt&&(l=function(h){const g=!!h.before,m=h.values||[];return new ip(m,g)}(r.startAt));let c=null;return r.endAt&&(c=function(h){const g=!h.before,m=h.values||[];return new ip(m,g)}(r.endAt)),V7(e,i,a,s,o,"F",l,c)}function SV(t,e){const r=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ft()}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function CC(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=Ic(r.unaryFilter.field);return gn.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=Ic(r.unaryFilter.field);return gn.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Ic(r.unaryFilter.field);return gn.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=Ic(r.unaryFilter.field);return gn.create(a,"!=",{nullValue:"NULL_VALUE"});default:return ft()}}(t):t.fieldFilter!==void 0?function(r){return gn.create(Ic(r.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ft()}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return ha.create(r.compositeFilter.filters.map(n=>CC(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return ft()}}(r.compositeFilter.op))}(t):ft()}function TV(t){return fV[t]}function AV(t){return dV[t]}function kV(t){return hV[t]}function Fc(t){return{fieldPath:t.canonicalString()}}function Ic(t){return On.fromServerFormat(t.fieldPath)}function FC(t){return t instanceof gn?function(r){if(r.op==="=="){if(xE(r.value))return{unaryFilter:{field:Fc(r.field),op:"IS_NAN"}};if(mE(r.value))return{unaryFilter:{field:Fc(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(xE(r.value))return{unaryFilter:{field:Fc(r.field),op:"IS_NOT_NAN"}};if(mE(r.value))return{unaryFilter:{field:Fc(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Fc(r.field),op:AV(r.op),value:r.value}}}(t):t instanceof ha?function(r){const n=r.getFilters().map(i=>FC(i));return n.length===1?n[0]:{compositeFilter:{op:kV(r.op),filters:n}}}(t):ft()}function CV(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function IC(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class No{constructor(e,r,n,i,s=gt.min(),a=gt.min(),o=jn.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=o,this.expectedCount=l}withSequenceNumber(e){return new No(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new No(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new No(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new No(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FV{constructor(e){this.ct=e}}function IV(t){const e=wV({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Sx(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bV{constructor(){this.un=new RV}addToCollectionParentIndex(e,r){return this.un.add(r),Fe.resolve()}getCollectionParents(e,r){return Fe.resolve(this.un.getEntries(r))}addFieldIndex(e,r){return Fe.resolve()}deleteFieldIndex(e,r){return Fe.resolve()}deleteAllFieldIndexes(e){return Fe.resolve()}createTargetIndexes(e,r){return Fe.resolve()}getDocumentsMatchingTarget(e,r){return Fe.resolve(null)}getIndexType(e,r){return Fe.resolve(0)}getFieldIndexes(e,r){return Fe.resolve([])}getNextCollectionGroupToUpdate(e){return Fe.resolve(null)}getMinOffset(e,r){return Fe.resolve(Jo.min())}getMinOffsetFromCollectionGroup(e,r){return Fe.resolve(Jo.min())}updateCollectionGroup(e,r,n){return Fe.resolve()}updateIndexEntries(e,r){return Fe.resolve()}}class RV{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r]||new Ln(Pr.comparator),s=!i.has(n);return this.index[r]=i.add(n),s}has(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r];return i&&i.has(n)}getEntries(e){return(this.index[e]||new Ln(Pr.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _u{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new _u(0)}static kn(){return new _u(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NV{constructor(){this.changes=new Pu(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,ei.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?Fe.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DV{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PV{constructor(e,r,n,i){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,r))).next(i=>(n!==null&&Lf(n.mutation,i,Ps.empty(),xn.now()),i))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,bt()).next(()=>n))}getLocalViewOfDocuments(e,r,n=bt()){const i=Fl();return this.populateOverlays(e,i,r).next(()=>this.computeViews(e,r,i,n).next(s=>{let a=pf();return s.forEach((o,l)=>{a=a.insert(o,l.overlayedDocument)}),a}))}getOverlayedDocuments(e,r){const n=Fl();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,bt()))}populateOverlays(e,r,n){const i=[];return n.forEach(s=>{r.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((a,o)=>{r.set(a,o)})})}computeViews(e,r,n,i){let s=Ha();const a=Mf(),o=function(){return Mf()}();return r.forEach((l,c)=>{const d=n.get(c.key);i.has(c.key)&&(d===void 0||d.mutation instanceof oc)?s=s.insert(c.key,c):d!==void 0?(a.set(c.key,d.mutation.getFieldMask()),Lf(d.mutation,c,d.mutation.getFieldMask(),xn.now())):a.set(c.key,Ps.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((c,d)=>a.set(c,d)),r.forEach((c,d)=>{var h;return o.set(c,new DV(d,(h=a.get(c))!==null&&h!==void 0?h:null))}),o))}recalculateAndSaveOverlays(e,r){const n=Mf();let i=new Ir((a,o)=>a-o),s=bt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(a=>{for(const o of a)o.keys().forEach(l=>{const c=r.get(l);if(c===null)return;let d=n.get(l)||Ps.empty();d=o.applyToLocalView(c,d),n.set(l,d);const h=(i.get(o.batchId)||bt()).add(l);i=i.insert(o.batchId,h)})}).next(()=>{const a=[],o=i.getReverseIterator();for(;o.hasNext();){const l=o.getNext(),c=l.key,d=l.value,h=fC();d.forEach(g=>{if(!s.has(g)){const m=xC(r.get(g),n.get(g));m!==null&&h.set(g,m),s=s.add(g)}}),a.push(this.documentOverlayCache.saveOverlays(e,c,h))}return Fe.waitFor(a)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,i){return function(a){return it.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):U7(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,i):this.getDocumentsMatchingCollectionQuery(e,r,n,i)}getNextDocuments(e,r,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,i).next(s=>{const a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,i-s.size):Fe.resolve(Fl());let o=-1,l=s;return a.next(c=>Fe.forEach(c,(d,h)=>(o<h.largestBatchId&&(o=h.largestBatchId),s.get(d)?Fe.resolve():this.remoteDocumentCache.getEntry(e,d).next(g=>{l=l.insert(d,g)}))).next(()=>this.populateOverlays(e,c,s)).next(()=>this.computeViews(e,l,c,bt())).next(d=>({batchId:o,changes:uC(d)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new it(r)).next(n=>{let i=pf();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,r,n,i){const s=r.collectionGroup;let a=pf();return this.indexManager.getCollectionParents(e,s).next(o=>Fe.forEach(o,l=>{const c=function(h,g){return new Hp(g,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(r,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,c,n,i).next(d=>{d.forEach((h,g)=>{a=a.insert(h,g)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,r,n,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,s,i))).next(a=>{s.forEach((l,c)=>{const d=c.getKey();a.get(d)===null&&(a=a.insert(d,ei.newInvalidDocument(d)))});let o=pf();return a.forEach((l,c)=>{const d=s.get(l);d!==void 0&&Lf(d.mutation,c,Ps.empty(),xn.now()),Kp(r,c)&&(o=o.insert(l,c))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OV{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,r){return Fe.resolve(this.hr.get(r))}saveBundleMetadata(e,r){return this.hr.set(r.id,function(i){return{id:i.id,version:i.version,createTime:ca(i.createTime)}}(r)),Fe.resolve()}getNamedQuery(e,r){return Fe.resolve(this.Pr.get(r))}saveNamedQuery(e,r){return this.Pr.set(r.name,function(i){return{name:i.name,query:IV(i.bundledQuery),readTime:ca(i.readTime)}}(r)),Fe.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MV{constructor(){this.overlays=new Ir(it.comparator),this.Ir=new Map}getOverlay(e,r){return Fe.resolve(this.overlays.get(r))}getOverlays(e,r){const n=Fl();return Fe.forEach(r,i=>this.getOverlay(e,i).next(s=>{s!==null&&n.set(i,s)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((i,s)=>{this.ht(e,r,s)}),Fe.resolve()}removeOverlaysForBatchId(e,r,n){const i=this.Ir.get(n);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(n)),Fe.resolve()}getOverlaysForCollection(e,r,n){const i=Fl(),s=r.length+1,a=new it(r.child("")),o=this.overlays.getIteratorFrom(a);for(;o.hasNext();){const l=o.getNext().value,c=l.getKey();if(!r.isPrefixOf(c.path))break;c.path.length===s&&l.largestBatchId>n&&i.set(l.getKey(),l)}return Fe.resolve(i)}getOverlaysForCollectionGroup(e,r,n,i){let s=new Ir((c,d)=>c-d);const a=this.overlays.getIterator();for(;a.hasNext();){const c=a.getNext().value;if(c.getKey().getCollectionGroup()===r&&c.largestBatchId>n){let d=s.get(c.largestBatchId);d===null&&(d=Fl(),s=s.insert(c.largestBatchId,d)),d.set(c.getKey(),c)}}const o=Fl(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,d)=>o.set(c,d)),!(o.size()>=i)););return Fe.resolve(o)}ht(e,r,n){const i=this.overlays.get(n.key);if(i!==null){const a=this.Ir.get(i.largestBatchId).delete(n.key);this.Ir.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(n.key,new sV(r,n));let s=this.Ir.get(r);s===void 0&&(s=bt(),this.Ir.set(r,s)),this.Ir.set(r,s.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LV{constructor(){this.sessionToken=jn.EMPTY_BYTE_STRING}getSessionToken(e){return Fe.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,Fe.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rv{constructor(){this.Tr=new Ln(Tn.Er),this.dr=new Ln(Tn.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,r){const n=new Tn(e,r);this.Tr=this.Tr.add(n),this.dr=this.dr.add(n)}Rr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Vr(new Tn(e,r))}mr(e,r){e.forEach(n=>this.removeReference(n,r))}gr(e){const r=new it(new Pr([])),n=new Tn(r,e),i=new Tn(r,e+1),s=[];return this.dr.forEachInRange([n,i],a=>{this.Vr(a),s.push(a.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const r=new it(new Pr([])),n=new Tn(r,e),i=new Tn(r,e+1);let s=bt();return this.dr.forEachInRange([n,i],a=>{s=s.add(a.key)}),s}containsKey(e){const r=new Tn(e,0),n=this.Tr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class Tn{constructor(e,r){this.key=e,this.wr=r}static Er(e,r){return it.comparator(e.key,r.key)||Xt(e.wr,r.wr)}static Ar(e,r){return Xt(e.wr,r.wr)||it.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BV{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.Sr=1,this.br=new Ln(Tn.Er)}checkEmpty(e){return Fe.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,i){const s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new iV(s,r,n,i);this.mutationQueue.push(a);for(const o of i)this.br=this.br.add(new Tn(o.key,s)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return Fe.resolve(a)}lookupMutationBatch(e,r){return Fe.resolve(this.Dr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,i=this.vr(n),s=i<0?0:i;return Fe.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return Fe.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return Fe.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new Tn(r,0),i=new Tn(r,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([n,i],a=>{const o=this.Dr(a.wr);s.push(o)}),Fe.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new Ln(Xt);return r.forEach(i=>{const s=new Tn(i,0),a=new Tn(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,a],o=>{n=n.add(o.wr)})}),Fe.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,i=n.length+1;let s=n;it.isDocumentKey(s)||(s=s.child(""));const a=new Tn(new it(s),0);let o=new Ln(Xt);return this.br.forEachWhile(l=>{const c=l.key.path;return!!n.isPrefixOf(c)&&(c.length===i&&(o=o.add(l.wr)),!0)},a),Fe.resolve(this.Cr(o))}Cr(e){const r=[];return e.forEach(n=>{const i=this.Dr(n);i!==null&&r.push(i)}),r}removeMutationBatch(e,r){sr(this.Fr(r.batchId,"removed")===0),this.mutationQueue.shift();let n=this.br;return Fe.forEach(r.mutations,i=>{const s=new Tn(i.key,r.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=n})}On(e){}containsKey(e,r){const n=new Tn(r,0),i=this.br.firstAfterOrEqual(n);return Fe.resolve(r.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,Fe.resolve()}Fr(e,r){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const r=this.vr(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jV{constructor(e){this.Mr=e,this.docs=function(){return new Ir(it.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,i=this.docs.get(n),s=i?i.size:0,a=this.Mr(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return Fe.resolve(n?n.document.mutableCopy():ei.newInvalidDocument(r))}getEntries(e,r){let n=Ha();return r.forEach(i=>{const s=this.docs.get(i);n=n.insert(i,s?s.document.mutableCopy():ei.newInvalidDocument(i))}),Fe.resolve(n)}getDocumentsMatchingQuery(e,r,n,i){let s=Ha();const a=r.path,o=new it(a.child("")),l=this.docs.getIteratorFrom(o);for(;l.hasNext();){const{key:c,value:{document:d}}=l.getNext();if(!a.isPrefixOf(c.path))break;c.path.length>a.length+1||E7(_7(d),n)<=0||(i.has(d.key)||Kp(r,d))&&(s=s.insert(d.key,d.mutableCopy()))}return Fe.resolve(s)}getAllFromCollectionGroup(e,r,n,i){ft()}Or(e,r){return Fe.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new VV(this)}getSize(e){return Fe.resolve(this.size)}}class VV extends NV{constructor(e){super(),this.cr=e}applyChanges(e){const r=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?r.push(this.cr.addEntry(e,i)):this.cr.removeEntry(n)}),Fe.waitFor(r)}getFromCache(e,r){return this.cr.getEntry(e,r)}getAllFromCache(e,r){return this.cr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UV{constructor(e){this.persistence=e,this.Nr=new Pu(r=>Av(r),kv),this.lastRemoteSnapshotVersion=gt.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Rv,this.targetCount=0,this.kr=_u.Bn()}forEachTarget(e,r){return this.Nr.forEach((n,i)=>r(i)),Fe.resolve()}getLastRemoteSnapshotVersion(e){return Fe.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Fe.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),Fe.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.Lr&&(this.Lr=r),Fe.resolve()}Kn(e){this.Nr.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.kr=new _u(r),this.highestTargetId=r),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,r){return this.Kn(r),this.targetCount+=1,Fe.resolve()}updateTargetData(e,r){return this.Kn(r),Fe.resolve()}removeTargetData(e,r){return this.Nr.delete(r.target),this.Br.gr(r.targetId),this.targetCount-=1,Fe.resolve()}removeTargets(e,r,n){let i=0;const s=[];return this.Nr.forEach((a,o)=>{o.sequenceNumber<=r&&n.get(o.targetId)===null&&(this.Nr.delete(a),s.push(this.removeMatchingKeysForTargetId(e,o.targetId)),i++)}),Fe.waitFor(s).next(()=>i)}getTargetCount(e){return Fe.resolve(this.targetCount)}getTargetData(e,r){const n=this.Nr.get(r)||null;return Fe.resolve(n)}addMatchingKeys(e,r,n){return this.Br.Rr(r,n),Fe.resolve()}removeMatchingKeys(e,r,n){this.Br.mr(r,n);const i=this.persistence.referenceDelegate,s=[];return i&&r.forEach(a=>{s.push(i.markPotentiallyOrphaned(e,a))}),Fe.waitFor(s)}removeMatchingKeysForTargetId(e,r){return this.Br.gr(r),Fe.resolve()}getMatchingKeysForTargetId(e,r){const n=this.Br.yr(r);return Fe.resolve(n)}containsKey(e,r){return Fe.resolve(this.Br.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zV{constructor(e,r){this.qr={},this.overlays={},this.Qr=new Ev(0),this.Kr=!1,this.Kr=!0,this.$r=new LV,this.referenceDelegate=e(this),this.Ur=new UV(this),this.indexManager=new bV,this.remoteDocumentCache=function(i){return new jV(i)}(n=>this.referenceDelegate.Wr(n)),this.serializer=new FV(r),this.Gr=new OV(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new MV,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.qr[e.toKey()];return n||(n=new BV(r,this.referenceDelegate),this.qr[e.toKey()]=n),n}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,r,n){Je("MemoryPersistence","Starting transaction:",e);const i=new WV(this.Qr.next());return this.referenceDelegate.zr(),n(i).next(s=>this.referenceDelegate.jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Hr(e,r){return Fe.or(Object.values(this.qr).map(n=>()=>n.containsKey(e,r)))}}class WV extends S7{constructor(e){super(),this.currentSequenceNumber=e}}class Nv{constructor(e){this.persistence=e,this.Jr=new Rv,this.Yr=null}static Zr(e){return new Nv(e)}get Xr(){if(this.Yr)return this.Yr;throw ft()}addReference(e,r,n){return this.Jr.addReference(n,r),this.Xr.delete(n.toString()),Fe.resolve()}removeReference(e,r,n){return this.Jr.removeReference(n,r),this.Xr.add(n.toString()),Fe.resolve()}markPotentiallyOrphaned(e,r){return this.Xr.add(r.toString()),Fe.resolve()}removeTarget(e,r){this.Jr.gr(r.targetId).forEach(i=>this.Xr.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(i=>{i.forEach(s=>this.Xr.add(s.toString()))}).next(()=>n.removeTargetData(e,r))}zr(){this.Yr=new Set}jr(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Fe.forEach(this.Xr,n=>{const i=it.fromPath(n);return this.ei(e,i).next(s=>{s||r.removeEntry(i,gt.min())})}).next(()=>(this.Yr=null,r.apply(e)))}updateLimboDocument(e,r){return this.ei(e,r).next(n=>{n?this.Xr.delete(r.toString()):this.Xr.add(r.toString())})}Wr(e){return 0}ei(e,r){return Fe.or([()=>Fe.resolve(this.Jr.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Hr(e,r)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dv{constructor(e,r,n,i){this.targetId=e,this.fromCache=r,this.$i=n,this.Ui=i}static Wi(e,r){let n=bt(),i=bt();for(const s of r.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new Dv(e,r.fromCache,n,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HV{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $V{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return $9()?8:T7(si())>0?6:4}()}initialize(e,r){this.Ji=e,this.indexManager=r,this.Gi=!0}getDocumentsMatchingQuery(e,r,n,i){const s={result:null};return this.Yi(e,r).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.Zi(e,r,i,n).next(a=>{s.result=a})}).next(()=>{if(s.result)return;const a=new HV;return this.Xi(e,r,a).next(o=>{if(s.result=o,this.zi)return this.es(e,r,a,o.size)})}).next(()=>s.result)}es(e,r,n,i){return n.documentReadCount<this.ji?(sf()<=Pt.DEBUG&&Je("QueryEngine","SDK will not create cache indexes for query:",Cc(r),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),Fe.resolve()):(sf()<=Pt.DEBUG&&Je("QueryEngine","Query:",Cc(r),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.Hi*i?(sf()<=Pt.DEBUG&&Je("QueryEngine","The SDK decides to create cache indexes for query:",Cc(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,la(r))):Fe.resolve())}Yi(e,r){if(EE(r))return Fe.resolve(null);let n=la(r);return this.indexManager.getIndexType(e,n).next(i=>i===0?null:(r.limit!==null&&i===1&&(r=Sx(r,null,"F"),n=la(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(s=>{const a=bt(...s);return this.Ji.getDocuments(e,a).next(o=>this.indexManager.getMinOffset(e,n).next(l=>{const c=this.ts(r,o);return this.ns(r,c,a,l.readTime)?this.Yi(e,Sx(r,null,"F")):this.rs(e,c,r,l)}))})))}Zi(e,r,n,i){return EE(r)||i.isEqual(gt.min())?Fe.resolve(null):this.Ji.getDocuments(e,n).next(s=>{const a=this.ts(r,s);return this.ns(r,a,n,i)?Fe.resolve(null):(sf()<=Pt.DEBUG&&Je("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Cc(r)),this.rs(e,a,r,y7(i,-1)).next(o=>o))})}ts(e,r){let n=new Ln(lC(e));return r.forEach((i,s)=>{Kp(e,s)&&(n=n.add(s))}),n}ns(e,r,n,i){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const s=e.limitType==="F"?r.last():r.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Xi(e,r,n){return sf()<=Pt.DEBUG&&Je("QueryEngine","Using full collection scan to execute query:",Cc(r)),this.Ji.getDocumentsMatchingQuery(e,r,Jo.min(),n)}rs(e,r,n,i){return this.Ji.getDocumentsMatchingQuery(e,n,i).next(s=>(r.forEach(a=>{s=s.insert(a.key,a)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GV{constructor(e,r,n,i){this.persistence=e,this.ss=r,this.serializer=i,this.os=new Ir(Xt),this._s=new Pu(s=>Av(s),kv),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(n)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new PV(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.os))}}function KV(t,e,r,n){return new GV(t,e,r,n)}async function bC(t,e){const r=mt(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let i;return r.mutationQueue.getAllMutationBatches(n).next(s=>(i=s,r.ls(e),r.mutationQueue.getAllMutationBatches(n))).next(s=>{const a=[],o=[];let l=bt();for(const c of i){a.push(c.batchId);for(const d of c.mutations)l=l.add(d.key)}for(const c of s){o.push(c.batchId);for(const d of c.mutations)l=l.add(d.key)}return r.localDocuments.getDocuments(n,l).next(c=>({hs:c,removedBatchIds:a,addedBatchIds:o}))})})}function XV(t,e){const r=mt(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=e.batch.keys(),s=r.cs.newChangeBuffer({trackRemovals:!0});return function(o,l,c,d){const h=c.batch,g=h.keys();let m=Fe.resolve();return g.forEach(y=>{m=m.next(()=>d.getEntry(l,y)).next(x=>{const E=c.docVersions.get(y);sr(E!==null),x.version.compareTo(E)<0&&(h.applyToRemoteDocument(x,c),x.isValidDocument()&&(x.setReadTime(c.commitVersion),d.addEntry(x)))})}),m.next(()=>o.mutationQueue.removeMutationBatch(l,h))}(r,n,e,s).next(()=>s.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(o){let l=bt();for(let c=0;c<o.mutationResults.length;++c)o.mutationResults[c].transformResults.length>0&&(l=l.add(o.batch.mutations[c].key));return l}(e))).next(()=>r.localDocuments.getDocuments(n,i))})}function RC(t){const e=mt(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Ur.getLastRemoteSnapshotVersion(r))}function YV(t,e){const r=mt(t),n=e.snapshotVersion;let i=r.os;return r.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const a=r.cs.newChangeBuffer({trackRemovals:!0});i=r.os;const o=[];e.targetChanges.forEach((d,h)=>{const g=i.get(h);if(!g)return;o.push(r.Ur.removeMatchingKeys(s,d.removedDocuments,h).next(()=>r.Ur.addMatchingKeys(s,d.addedDocuments,h)));let m=g.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(h)!==null?m=m.withResumeToken(jn.EMPTY_BYTE_STRING,gt.min()).withLastLimboFreeSnapshotVersion(gt.min()):d.resumeToken.approximateByteSize()>0&&(m=m.withResumeToken(d.resumeToken,n)),i=i.insert(h,m),function(x,E,A){return x.resumeToken.approximateByteSize()===0||E.snapshotVersion.toMicroseconds()-x.snapshotVersion.toMicroseconds()>=3e8?!0:A.addedDocuments.size+A.modifiedDocuments.size+A.removedDocuments.size>0}(g,m,d)&&o.push(r.Ur.updateTargetData(s,m))});let l=Ha(),c=bt();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&o.push(r.persistence.referenceDelegate.updateLimboDocument(s,d))}),o.push(qV(s,a,e.documentUpdates).next(d=>{l=d.Ps,c=d.Is})),!n.isEqual(gt.min())){const d=r.Ur.getLastRemoteSnapshotVersion(s).next(h=>r.Ur.setTargetsMetadata(s,s.currentSequenceNumber,n));o.push(d)}return Fe.waitFor(o).next(()=>a.apply(s)).next(()=>r.localDocuments.getLocalViewOfDocuments(s,l,c)).next(()=>l)}).then(s=>(r.os=i,s))}function qV(t,e,r){let n=bt(),i=bt();return r.forEach(s=>n=n.add(s)),e.getEntries(t,n).next(s=>{let a=Ha();return r.forEach((o,l)=>{const c=s.get(o);l.isFoundDocument()!==c.isFoundDocument()&&(i=i.add(o)),l.isNoDocument()&&l.version.isEqual(gt.min())?(e.removeEntry(o,l.readTime),a=a.insert(o,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),a=a.insert(o,l)):Je("LocalStore","Ignoring outdated watch update for ",o,". Current version:",c.version," Watch version:",l.version)}),{Ps:a,Is:i}})}function QV(t,e){const r=mt(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=-1),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function JV(t,e){const r=mt(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return r.Ur.getTargetData(n,e).next(s=>s?(i=s,Fe.resolve(i)):r.Ur.allocateTargetId(n).next(a=>(i=new No(e,a,"TargetPurposeListen",n.currentSequenceNumber),r.Ur.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=r.os.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(r.os=r.os.insert(n.targetId,n),r._s.set(e,n.targetId)),n})}async function Fx(t,e,r){const n=mt(t),i=n.os.get(e),s=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",s,a=>n.persistence.referenceDelegate.removeTarget(a,i))}catch(a){if(!zd(a))throw a;Je("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}n.os=n.os.remove(e),n._s.delete(i.target)}function NE(t,e,r){const n=mt(t);let i=gt.min(),s=bt();return n.persistence.runTransaction("Execute query","readwrite",a=>function(l,c,d){const h=mt(l),g=h._s.get(d);return g!==void 0?Fe.resolve(h.os.get(g)):h.Ur.getTargetData(c,d)}(n,a,la(e)).next(o=>{if(o)return i=o.lastLimboFreeSnapshotVersion,n.Ur.getMatchingKeysForTargetId(a,o.targetId).next(l=>{s=l})}).next(()=>n.ss.getDocumentsMatchingQuery(a,e,r?i:gt.min(),r?s:bt())).next(o=>(ZV(n,W7(e),o),{documents:o,Ts:s})))}function ZV(t,e,r){let n=t.us.get(e)||gt.min();r.forEach((i,s)=>{s.readTime.compareTo(n)>0&&(n=s.readTime)}),t.us.set(e,n)}class DE{constructor(){this.activeTargetIds=Y7()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class eU{constructor(){this.so=new DE,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,r,n){this.oo[e]=r}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new DE,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tU{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PE{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){Je("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){Je("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let $0=null;function rm(){return $0===null?$0=function(){return 268435456+Math.round(2147483648*Math.random())}():$0++,"0x"+$0.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rU={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nU{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xn="WebChannelConnection";class iU extends class{constructor(r){this.databaseInfo=r,this.databaseId=r.databaseId;const n=r.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=n+"://"+r.host,this.vo=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Fo(){return!1}Mo(r,n,i,s,a){const o=rm(),l=this.xo(r,n.toUriEncodedString());Je("RestConnection",`Sending RPC '${r}' ${o}:`,l,i);const c={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(c,s,a),this.No(r,l,c,i).then(d=>(Je("RestConnection",`Received RPC '${r}' ${o}: `,d),d),d=>{throw mu("RestConnection",`RPC '${r}' ${o} failed with error: `,d,"url: ",l,"request:",i),d})}Lo(r,n,i,s,a,o){return this.Mo(r,n,i,s,a)}Oo(r,n,i){r["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Nu}(),r["Content-Type"]="text/plain",this.databaseInfo.appId&&(r["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,a)=>r[a]=s),i&&i.headers.forEach((s,a)=>r[a]=s)}xo(r,n){const i=rU[r];return`${this.Do}/v1/${n}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,r,n,i){const s=rm();return new Promise((a,o)=>{const l=new $k;l.setWithCredentials(!0),l.listenOnce(Gk.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case lh.NO_ERROR:const d=l.getResponseJson();Je(Xn,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(d)),a(d);break;case lh.TIMEOUT:Je(Xn,`RPC '${e}' ${s} timed out`),o(new rt(be.DEADLINE_EXCEEDED,"Request time out"));break;case lh.HTTP_ERROR:const h=l.getStatus();if(Je(Xn,`RPC '${e}' ${s} failed with status:`,h,"response text:",l.getResponseText()),h>0){let g=l.getResponseJson();Array.isArray(g)&&(g=g[0]);const m=g==null?void 0:g.error;if(m&&m.status&&m.message){const y=function(E){const A=E.toLowerCase().replace(/_/g,"-");return Object.values(be).indexOf(A)>=0?A:be.UNKNOWN}(m.status);o(new rt(y,m.message))}else o(new rt(be.UNKNOWN,"Server responded with status "+l.getStatus()))}else o(new rt(be.UNAVAILABLE,"Connection failed."));break;default:ft()}}finally{Je(Xn,`RPC '${e}' ${s} completed.`)}});const c=JSON.stringify(i);Je(Xn,`RPC '${e}' ${s} sending request:`,i),l.send(r,"POST",c,n,15)})}Bo(e,r,n){const i=rm(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=Yk(),o=Xk(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Oo(l.initMessageHeaders,r,n),l.encodeInitMessageHeaders=!0;const d=s.join("");Je(Xn,`Creating RPC '${e}' stream ${i}: ${d}`,l);const h=a.createWebChannel(d,l);let g=!1,m=!1;const y=new nU({Io:E=>{m?Je(Xn,`Not sending because RPC '${e}' stream ${i} is closed:`,E):(g||(Je(Xn,`Opening RPC '${e}' stream ${i} transport.`),h.open(),g=!0),Je(Xn,`RPC '${e}' stream ${i} sending:`,E),h.send(E))},To:()=>h.close()}),x=(E,A,k)=>{E.listen(A,_=>{try{k(_)}catch(P){setTimeout(()=>{throw P},0)}})};return x(h,hf.EventType.OPEN,()=>{m||(Je(Xn,`RPC '${e}' stream ${i} transport opened.`),y.yo())}),x(h,hf.EventType.CLOSE,()=>{m||(m=!0,Je(Xn,`RPC '${e}' stream ${i} transport closed`),y.So())}),x(h,hf.EventType.ERROR,E=>{m||(m=!0,mu(Xn,`RPC '${e}' stream ${i} transport errored:`,E),y.So(new rt(be.UNAVAILABLE,"The operation could not be completed")))}),x(h,hf.EventType.MESSAGE,E=>{var A;if(!m){const k=E.data[0];sr(!!k);const _=k,P=_.error||((A=_[0])===null||A===void 0?void 0:A.error);if(P){Je(Xn,`RPC '${e}' stream ${i} received error:`,P);const K=P.status;let V=function(w){const b=en[w];if(b!==void 0)return _C(b)}(K),S=P.message;V===void 0&&(V=be.INTERNAL,S="Unknown error status: "+K+" with message "+P.message),m=!0,y.So(new rt(V,S)),h.close()}else Je(Xn,`RPC '${e}' stream ${i} received:`,k),y.bo(k)}}),x(o,Kk.STAT_EVENT,E=>{E.stat===vx.PROXY?Je(Xn,`RPC '${e}' stream ${i} detected buffering proxy`):E.stat===vx.NOPROXY&&Je(Xn,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{y.wo()},0),y}}function nm(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qp(t){return new pV(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NC{constructor(e,r,n=1e3,i=1.5,s=6e4){this.ui=e,this.timerId=r,this.ko=n,this.qo=i,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const r=Math.floor(this.Ko+this.zo()),n=Math.max(0,Date.now()-this.Uo),i=Math.max(0,r-n);i>0&&Je("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DC{constructor(e,r,n,i,s,a,o,l){this.ui=e,this.Ho=n,this.Jo=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=o,this.listener=l,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new NC(e,r)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,r){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():r&&r.code===be.RESOURCE_EXHAUSTED?(Wa(r.toString()),Wa("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):r&&r.code===be.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(r)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),r=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.Yo===r&&this.P_(n,i)},n=>{e(()=>{const i=new rt(be.UNKNOWN,"Fetching auth token failed: "+n.message);return this.I_(i)})})}P_(e,r){const n=this.h_(this.Yo);this.stream=this.T_(e,r),this.stream.Eo(()=>{n(()=>this.listener.Eo())}),this.stream.Ro(()=>{n(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{n(()=>this.I_(i))}),this.stream.onMessage(i=>{n(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return Je("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return r=>{this.ui.enqueueAndForget(()=>this.Yo===e?r():(Je("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class sU extends DC{constructor(e,r,n,i,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,i,a),this.serializer=s}T_(e,r){return this.connection.Bo("Listen",e,r)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const r=xV(this.serializer,e),n=function(s){if(!("targetChange"in s))return gt.min();const a=s.targetChange;return a.targetIds&&a.targetIds.length?gt.min():a.readTime?ca(a.readTime):gt.min()}(e);return this.listener.d_(r,n)}A_(e){const r={};r.database=Cx(this.serializer),r.addTarget=function(s,a){let o;const l=a.target;if(o=wx(l)?{documents:_V(s,l)}:{query:EV(s,l)._t},o.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){o.resumeToken=SC(s,a.resumeToken);const c=Tx(s,a.expectedCount);c!==null&&(o.expectedCount=c)}else if(a.snapshotVersion.compareTo(gt.min())>0){o.readTime=lp(s,a.snapshotVersion.toTimestamp());const c=Tx(s,a.expectedCount);c!==null&&(o.expectedCount=c)}return o}(this.serializer,e);const n=SV(this.serializer,e);n&&(r.labels=n),this.a_(r)}R_(e){const r={};r.database=Cx(this.serializer),r.removeTarget=e,this.a_(r)}}class aU extends DC{constructor(e,r,n,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,i,a),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,r){return this.connection.Bo("Write",e,r)}E_(e){return sr(!!e.streamToken),this.lastStreamToken=e.streamToken,sr(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){sr(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const r=yV(e.writeResults,e.commitTime),n=ca(e.commitTime);return this.listener.g_(n,r)}p_(){const e={};e.database=Cx(this.serializer),this.a_(e)}m_(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>vV(this.serializer,n))};this.a_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oU extends class{}{constructor(e,r,n,i){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new rt(be.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,r,n,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Mo(e,Ax(r,n),i,s,a)).catch(s=>{throw s.name==="FirebaseError"?(s.code===be.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new rt(be.UNKNOWN,s.toString())})}Lo(e,r,n,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,o])=>this.connection.Lo(e,Ax(r,n),i,a,o,s)).catch(a=>{throw a.name==="FirebaseError"?(a.code===be.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new rt(be.UNKNOWN,a.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class lU{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Wa(r),this.D_=!1):Je("OnlineStateTracker",r)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cU{constructor(e,r,n,i,s){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(a=>{n.enqueueAndForget(async()=>{lc(this)&&(Je("RemoteStore","Restarting streams for network reachability change."),await async function(l){const c=mt(l);c.L_.add(4),await $d(c),c.q_.set("Unknown"),c.L_.delete(4),await Jp(c)}(this))})}),this.q_=new lU(n,i)}}async function Jp(t){if(lc(t))for(const e of t.B_)await e(!0)}async function $d(t){for(const e of t.B_)await e(!1)}function PC(t,e){const r=mt(t);r.N_.has(e.targetId)||(r.N_.set(e.targetId,e),Lv(r)?Mv(r):Ou(r).r_()&&Ov(r,e))}function Pv(t,e){const r=mt(t),n=Ou(r);r.N_.delete(e),n.r_()&&OC(r,e),r.N_.size===0&&(n.r_()?n.o_():lc(r)&&r.q_.set("Unknown"))}function Ov(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(gt.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}Ou(t).A_(e)}function OC(t,e){t.Q_.xe(e),Ou(t).R_(e)}function Mv(t){t.Q_=new uV({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),Ou(t).start(),t.q_.v_()}function Lv(t){return lc(t)&&!Ou(t).n_()&&t.N_.size>0}function lc(t){return mt(t).L_.size===0}function MC(t){t.Q_=void 0}async function uU(t){t.q_.set("Online")}async function fU(t){t.N_.forEach((e,r)=>{Ov(t,e)})}async function dU(t,e){MC(t),Lv(t)?(t.q_.M_(e),Mv(t)):t.q_.set("Unknown")}async function hU(t,e,r){if(t.q_.set("Online"),e instanceof wC&&e.state===2&&e.cause)try{await async function(i,s){const a=s.cause;for(const o of s.targetIds)i.N_.has(o)&&(await i.remoteSyncer.rejectListen(o,a),i.N_.delete(o),i.Q_.removeTarget(o))}(t,e)}catch(n){Je("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),await cp(t,n)}else if(e instanceof fh?t.Q_.Ke(e):e instanceof EC?t.Q_.He(e):t.Q_.We(e),!r.isEqual(gt.min()))try{const n=await RC(t.localStore);r.compareTo(n)>=0&&await function(s,a){const o=s.Q_.rt(a);return o.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const d=s.N_.get(c);d&&s.N_.set(c,d.withResumeToken(l.resumeToken,a))}}),o.targetMismatches.forEach((l,c)=>{const d=s.N_.get(l);if(!d)return;s.N_.set(l,d.withResumeToken(jn.EMPTY_BYTE_STRING,d.snapshotVersion)),OC(s,l);const h=new No(d.target,l,c,d.sequenceNumber);Ov(s,h)}),s.remoteSyncer.applyRemoteEvent(o)}(t,r)}catch(n){Je("RemoteStore","Failed to raise snapshot:",n),await cp(t,n)}}async function cp(t,e,r){if(!zd(e))throw e;t.L_.add(1),await $d(t),t.q_.set("Offline"),r||(r=()=>RC(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Je("RemoteStore","Retrying IndexedDB access"),await r(),t.L_.delete(1),await Jp(t)})}function LC(t,e){return e().catch(r=>cp(t,r,e))}async function Zp(t){const e=mt(t),r=el(e);let n=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;pU(e);)try{const i=await QV(e.localStore,n);if(i===null){e.O_.length===0&&r.o_();break}n=i.batchId,gU(e,i)}catch(i){await cp(e,i)}BC(e)&&jC(e)}function pU(t){return lc(t)&&t.O_.length<10}function gU(t,e){t.O_.push(e);const r=el(t);r.r_()&&r.V_&&r.m_(e.mutations)}function BC(t){return lc(t)&&!el(t).n_()&&t.O_.length>0}function jC(t){el(t).start()}async function mU(t){el(t).p_()}async function xU(t){const e=el(t);for(const r of t.O_)e.m_(r.mutations)}async function vU(t,e,r){const n=t.O_.shift(),i=Fv.from(n,e,r);await LC(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await Zp(t)}async function yU(t,e){e&&el(t).V_&&await async function(n,i){if(function(a){return oV(a)&&a!==be.ABORTED}(i.code)){const s=n.O_.shift();el(n).s_(),await LC(n,()=>n.remoteSyncer.rejectFailedWrite(s.batchId,i)),await Zp(n)}}(t,e),BC(t)&&jC(t)}async function OE(t,e){const r=mt(t);r.asyncQueue.verifyOperationInProgress(),Je("RemoteStore","RemoteStore received new credentials");const n=lc(r);r.L_.add(3),await $d(r),n&&r.q_.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.L_.delete(3),await Jp(r)}async function _U(t,e){const r=mt(t);e?(r.L_.delete(2),await Jp(r)):e||(r.L_.add(2),await $d(r),r.q_.set("Unknown"))}function Ou(t){return t.K_||(t.K_=function(r,n,i){const s=mt(r);return s.w_(),new sU(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:uU.bind(null,t),Ro:fU.bind(null,t),mo:dU.bind(null,t),d_:hU.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),Lv(t)?Mv(t):t.q_.set("Unknown")):(await t.K_.stop(),MC(t))})),t.K_}function el(t){return t.U_||(t.U_=function(r,n,i){const s=mt(r);return s.w_(),new aU(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:mU.bind(null,t),mo:yU.bind(null,t),f_:xU.bind(null,t),g_:vU.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await Zp(t)):(await t.U_.stop(),t.O_.length>0&&(Je("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bv{constructor(e,r,n,i,s){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=i,this.removalCallback=s,this.deferred=new Ho,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,i,s){const a=Date.now()+n,o=new Bv(e,r,a,i,s);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new rt(be.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function jv(t,e){if(Wa("AsyncQueue",`${e}: ${t}`),zd(t))return new rt(be.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tu{constructor(e){this.comparator=e?(r,n)=>e(r,n)||it.comparator(r.key,n.key):(r,n)=>it.comparator(r.key,n.key),this.keyedMap=pf(),this.sortedSet=new Ir(this.comparator)}static emptySet(e){return new tu(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof tu)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const i=r.getNext().key,s=n.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new tu;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ME{constructor(){this.W_=new Ir(it.comparator)}track(e){const r=e.doc.key,n=this.W_.get(r);n?e.type!==0&&n.type===3?this.W_=this.W_.insert(r,e):e.type===3&&n.type!==1?this.W_=this.W_.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.W_=this.W_.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.W_=this.W_.remove(r):e.type===1&&n.type===2?this.W_=this.W_.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):ft():this.W_=this.W_.insert(r,e)}G_(){const e=[];return this.W_.inorderTraversal((r,n)=>{e.push(n)}),e}}class Eu{constructor(e,r,n,i,s,a,o,l,c){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=o,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,r,n,i,s){const a=[];return r.forEach(o=>{a.push({type:0,doc:o})}),new Eu(e,r,tu.emptySet(r),a,n,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Gp(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let i=0;i<r.length;i++)if(r[i].type!==n[i].type||!r[i].doc.isEqual(n[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EU{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class wU{constructor(){this.queries=LE(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(r,n){const i=mt(r),s=i.queries;i.queries=LE(),s.forEach((a,o)=>{for(const l of o.j_)l.onError(n)})})(this,new rt(be.ABORTED,"Firestore shutting down"))}}function LE(){return new Pu(t=>oC(t),Gp)}async function VC(t,e){const r=mt(t);let n=3;const i=e.query;let s=r.queries.get(i);s?!s.H_()&&e.J_()&&(n=2):(s=new EU,n=e.J_()?0:1);try{switch(n){case 0:s.z_=await r.onListen(i,!0);break;case 1:s.z_=await r.onListen(i,!1);break;case 2:await r.onFirstRemoteStoreListen(i)}}catch(a){const o=jv(a,`Initialization of query '${Cc(e.query)}' failed`);return void e.onError(o)}r.queries.set(i,s),s.j_.push(e),e.Z_(r.onlineState),s.z_&&e.X_(s.z_)&&Vv(r)}async function UC(t,e){const r=mt(t),n=e.query;let i=3;const s=r.queries.get(n);if(s){const a=s.j_.indexOf(e);a>=0&&(s.j_.splice(a,1),s.j_.length===0?i=e.J_()?0:1:!s.H_()&&e.J_()&&(i=2))}switch(i){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function SU(t,e){const r=mt(t);let n=!1;for(const i of e){const s=i.query,a=r.queries.get(s);if(a){for(const o of a.j_)o.X_(i)&&(n=!0);a.z_=i}}n&&Vv(r)}function TU(t,e,r){const n=mt(t),i=n.queries.get(e);if(i)for(const s of i.j_)s.onError(r);n.queries.delete(e)}function Vv(t){t.Y_.forEach(e=>{e.next()})}var Ix,BE;(BE=Ix||(Ix={})).ea="default",BE.Cache="cache";class zC{constructor(e,r,n){this.query=e,this.ta=r,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=n||{}}X_(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)i.type!==3&&n.push(i);e=new Eu(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.na?this.ia(e)&&(this.ta.next(e),r=!0):this.sa(e,this.onlineState)&&(this.oa(e),r=!0),this.ra=e,r}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let r=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),r=!0),r}sa(e,r){if(!e.fromCache||!this.J_())return!0;const n=r!=="Offline";return(!this.options._a||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const r=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}oa(e){e=Eu.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Ix.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WC{constructor(e){this.key=e}}class HC{constructor(e){this.key=e}}class AU{constructor(e,r){this.query=e,this.Ta=r,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=bt(),this.mutatedKeys=bt(),this.Aa=lC(e),this.Ra=new tu(this.Aa)}get Va(){return this.Ta}ma(e,r){const n=r?r.fa:new ME,i=r?r.Ra:this.Ra;let s=r?r.mutatedKeys:this.mutatedKeys,a=i,o=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,c=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((d,h)=>{const g=i.get(d),m=Kp(this.query,h)?h:null,y=!!g&&this.mutatedKeys.has(g.key),x=!!m&&(m.hasLocalMutations||this.mutatedKeys.has(m.key)&&m.hasCommittedMutations);let E=!1;g&&m?g.data.isEqual(m.data)?y!==x&&(n.track({type:3,doc:m}),E=!0):this.ga(g,m)||(n.track({type:2,doc:m}),E=!0,(l&&this.Aa(m,l)>0||c&&this.Aa(m,c)<0)&&(o=!0)):!g&&m?(n.track({type:0,doc:m}),E=!0):g&&!m&&(n.track({type:1,doc:g}),E=!0,(l||c)&&(o=!0)),E&&(m?(a=a.add(m),s=x?s.add(d):s.delete(d)):(a=a.delete(d),s=s.delete(d)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const d=this.query.limitType==="F"?a.last():a.first();a=a.delete(d.key),s=s.delete(d.key),n.track({type:1,doc:d})}return{Ra:a,fa:n,ns:o,mutatedKeys:s}}ga(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,i){const s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const a=e.fa.G_();a.sort((d,h)=>function(m,y){const x=E=>{switch(E){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ft()}};return x(m)-x(y)}(d.type,h.type)||this.Aa(d.doc,h.doc)),this.pa(n),i=i!=null&&i;const o=r&&!i?this.ya():[],l=this.da.size===0&&this.current&&!i?1:0,c=l!==this.Ea;return this.Ea=l,a.length!==0||c?{snapshot:new Eu(this.query,e.Ra,s,a,e.mutatedKeys,l===0,c,!1,!!n&&n.resumeToken.approximateByteSize()>0),wa:o}:{wa:o}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new ME,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(r=>this.Ta=this.Ta.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ta=this.Ta.delete(r)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=bt(),this.Ra.forEach(n=>{this.Sa(n.key)&&(this.da=this.da.add(n.key))});const r=[];return e.forEach(n=>{this.da.has(n)||r.push(new HC(n))}),this.da.forEach(n=>{e.has(n)||r.push(new WC(n))}),r}ba(e){this.Ta=e.Ts,this.da=bt();const r=this.ma(e.documents);return this.applyChanges(r,!0)}Da(){return Eu.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class kU{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class CU{constructor(e){this.key=e,this.va=!1}}class FU{constructor(e,r,n,i,s,a){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Ca={},this.Fa=new Pu(o=>oC(o),Gp),this.Ma=new Map,this.xa=new Set,this.Oa=new Ir(it.comparator),this.Na=new Map,this.La=new Rv,this.Ba={},this.ka=new Map,this.qa=_u.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function IU(t,e,r=!0){const n=qC(t);let i;const s=n.Fa.get(e);return s?(n.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=await $C(n,e,r,!0),i}async function bU(t,e){const r=qC(t);await $C(r,e,!0,!1)}async function $C(t,e,r,n){const i=await JV(t.localStore,la(e)),s=i.targetId,a=t.sharedClientState.addLocalQueryTarget(s,r);let o;return n&&(o=await RU(t,e,s,a==="current",i.resumeToken)),t.isPrimaryClient&&r&&PC(t.remoteStore,i),o}async function RU(t,e,r,n,i){t.Ka=(h,g,m)=>async function(x,E,A,k){let _=E.view.ma(A);_.ns&&(_=await NE(x.localStore,E.query,!1).then(({documents:S})=>E.view.ma(S,_)));const P=k&&k.targetChanges.get(E.targetId),K=k&&k.targetMismatches.get(E.targetId)!=null,V=E.view.applyChanges(_,x.isPrimaryClient,P,K);return VE(x,E.targetId,V.wa),V.snapshot}(t,h,g,m);const s=await NE(t.localStore,e,!0),a=new AU(e,s.Ts),o=a.ma(s.documents),l=Hd.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",i),c=a.applyChanges(o,t.isPrimaryClient,l);VE(t,r,c.wa);const d=new kU(e,r,a);return t.Fa.set(e,d),t.Ma.has(r)?t.Ma.get(r).push(e):t.Ma.set(r,[e]),c.snapshot}async function NU(t,e,r){const n=mt(t),i=n.Fa.get(e),s=n.Ma.get(i.targetId);if(s.length>1)return n.Ma.set(i.targetId,s.filter(a=>!Gp(a,e))),void n.Fa.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await Fx(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),r&&Pv(n.remoteStore,i.targetId),bx(n,i.targetId)}).catch(Ud)):(bx(n,i.targetId),await Fx(n.localStore,i.targetId,!0))}async function DU(t,e){const r=mt(t),n=r.Fa.get(e),i=r.Ma.get(n.targetId);r.isPrimaryClient&&i.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),Pv(r.remoteStore,n.targetId))}async function PU(t,e,r){const n=UU(t);try{const i=await function(a,o){const l=mt(a),c=xn.now(),d=o.reduce((m,y)=>m.add(y.key),bt());let h,g;return l.persistence.runTransaction("Locally write mutations","readwrite",m=>{let y=Ha(),x=bt();return l.cs.getEntries(m,d).next(E=>{y=E,y.forEach((A,k)=>{k.isValidDocument()||(x=x.add(A))})}).next(()=>l.localDocuments.getOverlayedDocuments(m,y)).next(E=>{h=E;const A=[];for(const k of o){const _=rV(k,h.get(k.key).overlayedDocument);_!=null&&A.push(new oc(k.key,_,eC(_.value.mapValue),Ma.exists(!0)))}return l.mutationQueue.addMutationBatch(m,c,A,o)}).next(E=>{g=E;const A=E.applyToLocalDocumentSet(h,x);return l.documentOverlayCache.saveOverlays(m,E.batchId,A)})}).then(()=>({batchId:g.batchId,changes:uC(h)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(a,o,l){let c=a.Ba[a.currentUser.toKey()];c||(c=new Ir(Xt)),c=c.insert(o,l),a.Ba[a.currentUser.toKey()]=c}(n,i.batchId,r),await Gd(n,i.changes),await Zp(n.remoteStore)}catch(i){const s=jv(i,"Failed to persist write");r.reject(s)}}async function GC(t,e){const r=mt(t);try{const n=await YV(r.localStore,e);e.targetChanges.forEach((i,s)=>{const a=r.Na.get(s);a&&(sr(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?a.va=!0:i.modifiedDocuments.size>0?sr(a.va):i.removedDocuments.size>0&&(sr(a.va),a.va=!1))}),await Gd(r,n,e)}catch(n){await Ud(n)}}function jE(t,e,r){const n=mt(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const i=[];n.Fa.forEach((s,a)=>{const o=a.view.Z_(e);o.snapshot&&i.push(o.snapshot)}),function(a,o){const l=mt(a);l.onlineState=o;let c=!1;l.queries.forEach((d,h)=>{for(const g of h.j_)g.Z_(o)&&(c=!0)}),c&&Vv(l)}(n.eventManager,e),i.length&&n.Ca.d_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function OU(t,e,r){const n=mt(t);n.sharedClientState.updateQueryState(e,"rejected",r);const i=n.Na.get(e),s=i&&i.key;if(s){let a=new Ir(it.comparator);a=a.insert(s,ei.newNoDocument(s,gt.min()));const o=bt().add(s),l=new qp(gt.min(),new Map,new Ir(Xt),a,o);await GC(n,l),n.Oa=n.Oa.remove(s),n.Na.delete(e),Uv(n)}else await Fx(n.localStore,e,!1).then(()=>bx(n,e,r)).catch(Ud)}async function MU(t,e){const r=mt(t),n=e.batch.batchId;try{const i=await XV(r.localStore,e);XC(r,n,null),KC(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await Gd(r,i)}catch(i){await Ud(i)}}async function LU(t,e,r){const n=mt(t);try{const i=await function(a,o){const l=mt(a);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let d;return l.mutationQueue.lookupMutationBatch(c,o).next(h=>(sr(h!==null),d=h.keys(),l.mutationQueue.removeMutationBatch(c,h))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,d,o)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,d)).next(()=>l.localDocuments.getDocuments(c,d))})}(n.localStore,e);XC(n,e,r),KC(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await Gd(n,i)}catch(i){await Ud(i)}}function KC(t,e){(t.ka.get(e)||[]).forEach(r=>{r.resolve()}),t.ka.delete(e)}function XC(t,e,r){const n=mt(t);let i=n.Ba[n.currentUser.toKey()];if(i){const s=i.get(e);s&&(r?s.reject(r):s.resolve(),i=i.remove(e)),n.Ba[n.currentUser.toKey()]=i}}function bx(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Ma.get(e))t.Fa.delete(n),r&&t.Ca.$a(n,r);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(n=>{t.La.containsKey(n)||YC(t,n)})}function YC(t,e){t.xa.delete(e.path.canonicalString());const r=t.Oa.get(e);r!==null&&(Pv(t.remoteStore,r),t.Oa=t.Oa.remove(e),t.Na.delete(r),Uv(t))}function VE(t,e,r){for(const n of r)n instanceof WC?(t.La.addReference(n.key,e),BU(t,n)):n instanceof HC?(Je("SyncEngine","Document no longer in limbo: "+n.key),t.La.removeReference(n.key,e),t.La.containsKey(n.key)||YC(t,n.key)):ft()}function BU(t,e){const r=e.key,n=r.path.canonicalString();t.Oa.get(r)||t.xa.has(n)||(Je("SyncEngine","New document in limbo: "+r),t.xa.add(n),Uv(t))}function Uv(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const r=new it(Pr.fromString(e)),n=t.qa.next();t.Na.set(n,new CU(r)),t.Oa=t.Oa.insert(r,n),PC(t.remoteStore,new No(la($p(r.path)),n,"TargetPurposeLimboResolution",Ev.oe))}}async function Gd(t,e,r){const n=mt(t),i=[],s=[],a=[];n.Fa.isEmpty()||(n.Fa.forEach((o,l)=>{a.push(n.Ka(l,e,r).then(c=>{var d;if((c||r)&&n.isPrimaryClient){const h=c?!c.fromCache:(d=r==null?void 0:r.targetChanges.get(l.targetId))===null||d===void 0?void 0:d.current;n.sharedClientState.updateQueryState(l.targetId,h?"current":"not-current")}if(c){i.push(c);const h=Dv.Wi(l.targetId,c);s.push(h)}}))}),await Promise.all(a),n.Ca.d_(i),await async function(l,c){const d=mt(l);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>Fe.forEach(c,g=>Fe.forEach(g.$i,m=>d.persistence.referenceDelegate.addReference(h,g.targetId,m)).next(()=>Fe.forEach(g.Ui,m=>d.persistence.referenceDelegate.removeReference(h,g.targetId,m)))))}catch(h){if(!zd(h))throw h;Je("LocalStore","Failed to update sequence numbers: "+h)}for(const h of c){const g=h.targetId;if(!h.fromCache){const m=d.os.get(g),y=m.snapshotVersion,x=m.withLastLimboFreeSnapshotVersion(y);d.os=d.os.insert(g,x)}}}(n.localStore,s))}async function jU(t,e){const r=mt(t);if(!r.currentUser.isEqual(e)){Je("SyncEngine","User change. New user:",e.toKey());const n=await bC(r.localStore,e);r.currentUser=e,function(s,a){s.ka.forEach(o=>{o.forEach(l=>{l.reject(new rt(be.CANCELLED,a))})}),s.ka.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await Gd(r,n.hs)}}function VU(t,e){const r=mt(t),n=r.Na.get(e);if(n&&n.va)return bt().add(n.key);{let i=bt();const s=r.Ma.get(e);if(!s)return i;for(const a of s){const o=r.Fa.get(a);i=i.unionWith(o.view.Va)}return i}}function qC(t){const e=mt(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=GC.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=VU.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=OU.bind(null,e),e.Ca.d_=SU.bind(null,e.eventManager),e.Ca.$a=TU.bind(null,e.eventManager),e}function UU(t){const e=mt(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=MU.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=LU.bind(null,e),e}class up{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Qp(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,r){return null}Ha(e,r){return null}za(e){return KV(this.persistence,new $V,e.initialUser,this.serializer)}Ga(e){return new zV(Nv.Zr,this.serializer)}Wa(e){return new eU}async terminate(){var e,r;(e=this.gcScheduler)===null||e===void 0||e.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}up.provider={build:()=>new up};class Rx{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>jE(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=jU.bind(null,this.syncEngine),await _U(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new wU}()}createDatastore(e){const r=Qp(e.databaseInfo.databaseId),n=function(s){return new iU(s)}(e.databaseInfo);return function(s,a,o,l){return new oU(s,a,o,l)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,i,s,a,o){return new cU(n,i,s,a,o)}(this.localStore,this.datastore,e.asyncQueue,r=>jE(this.syncEngine,r,0),function(){return PE.D()?new PE:new tU}())}createSyncEngine(e,r){return function(i,s,a,o,l,c,d){const h=new FU(i,s,a,o,l,c);return d&&(h.Qa=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await async function(i){const s=mt(i);Je("RemoteStore","RemoteStore shutting down."),s.L_.add(5),await $d(s),s.k_.shutdown(),s.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}Rx.provider={build:()=>new Rx};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QC{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Wa("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zU{constructor(e,r,n,i,s){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=i,this.user=qn.UNAUTHENTICATED,this.clientId=Qk.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(n,async a=>{Je("FirestoreClient","Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(n,a=>(Je("FirestoreClient","Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ho;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=jv(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function im(t,e){t.asyncQueue.verifyOperationInProgress(),Je("FirestoreClient","Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async i=>{n.isEqual(i)||(await bC(e.localStore,i),n=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function UE(t,e){t.asyncQueue.verifyOperationInProgress();const r=await WU(t);Je("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>OE(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,i)=>OE(e.remoteStore,i)),t._onlineComponents=e}async function WU(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Je("FirestoreClient","Using user provided OfflineComponentProvider");try{await im(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(i){return i.name==="FirebaseError"?i.code===be.FAILED_PRECONDITION||i.code===be.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(r))throw r;mu("Error using user provided cache. Falling back to memory cache: "+r),await im(t,new up)}}else Je("FirestoreClient","Using default OfflineComponentProvider"),await im(t,new up);return t._offlineComponents}async function JC(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Je("FirestoreClient","Using user provided OnlineComponentProvider"),await UE(t,t._uninitializedComponentsProvider._online)):(Je("FirestoreClient","Using default OnlineComponentProvider"),await UE(t,new Rx))),t._onlineComponents}function HU(t){return JC(t).then(e=>e.syncEngine)}async function Nx(t){const e=await JC(t),r=e.eventManager;return r.onListen=IU.bind(null,e.syncEngine),r.onUnlisten=NU.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=bU.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=DU.bind(null,e.syncEngine),r}function $U(t,e,r={}){const n=new Ho;return t.asyncQueue.enqueueAndForget(async()=>function(s,a,o,l,c){const d=new QC({next:g=>{d.Za(),a.enqueueAndForget(()=>UC(s,h));const m=g.docs.has(o);!m&&g.fromCache?c.reject(new rt(be.UNAVAILABLE,"Failed to get document because the client is offline.")):m&&g.fromCache&&l&&l.source==="server"?c.reject(new rt(be.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(g)},error:g=>c.reject(g)}),h=new zC($p(o.path),d,{includeMetadataChanges:!0,_a:!0});return VC(s,h)}(await Nx(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZC(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zE=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GU(t,e,r){if(!r)throw new rt(be.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function KU(t,e,r,n){if(e===!0&&n===!0)throw new rt(be.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function WE(t){if(!it.isDocumentKey(t))throw new rt(be.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function zv(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ft()}function $o(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new rt(be.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=zv(t);throw new rt(be.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HE{constructor(e){var r,n;if(e.host===void 0){if(e.ssl!==void 0)throw new rt(be.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(r=e.ssl)===null||r===void 0||r;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new rt(be.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}KU("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=ZC((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new rt(be.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new rt(be.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new rt(be.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Wv{constructor(e,r,n,i){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new HE({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new rt(be.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new rt(be.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new HE(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new u7;switch(n.type){case"firstParty":return new p7(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new rt(be.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=zE.get(r);n&&(Je("ComponentProvider","Removing Datastore"),zE.delete(r),n.terminate())}(this),Promise.resolve()}}function XU(t,e,r,n={}){var i;const s=(t=$o(t,Wv))._getSettings(),a=`${e}:${r}`;if(s.host!=="firestore.googleapis.com"&&s.host!==a&&mu("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:a,ssl:!1})),n.mockUserToken){let o,l;if(typeof n.mockUserToken=="string")o=n.mockUserToken,l=qn.MOCK_USER;else{o=B9(n.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);const c=n.mockUserToken.sub||n.mockUserToken.user_id;if(!c)throw new rt(be.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new qn(c)}t._authCredentials=new f7(new qk(o,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eg{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new eg(this.firestore,e,this._query)}}class $i{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Sd(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new $i(this.firestore,e,this._key)}}class Sd extends eg{constructor(e,r,n){super(e,r,$p(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new $i(this.firestore,null,new it(e))}withConverter(e){return new Sd(this.firestore,e,this._path)}}function Hv(t,e,...r){if(t=Vs(t),arguments.length===1&&(e=Qk.newId()),GU("doc","path",e),t instanceof Wv){const n=Pr.fromString(e,...r);return WE(n),new $i(t,null,new it(n))}{if(!(t instanceof $i||t instanceof Sd))throw new rt(be.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Pr.fromString(e,...r));return WE(n),new $i(t.firestore,t instanceof Sd?t.converter:null,new it(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $E{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new NC(this,"async_queue_retry"),this.Vu=()=>{const n=nm();n&&Je("AsyncQueue","Visibility state changed to "+n.visibilityState),this.t_.jo()},this.mu=e;const r=nm();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const r=nm();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const r=new Ho;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!zd(e))throw e;Je("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const r=this.mu.then(()=>(this.du=!0,e().catch(n=>{this.Eu=n,this.du=!1;const i=function(a){let o=a.message||"";return a.stack&&(o=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),o}(n);throw Wa("INTERNAL UNHANDLED ERROR: ",i),n}).then(n=>(this.du=!1,n))));return this.mu=r,r}enqueueAfterDelay(e,r,n){this.fu(),this.Ru.indexOf(e)>-1&&(r=0);const i=Bv.createAndSchedule(this,e,r,n,s=>this.yu(s));return this.Tu.push(i),i}fu(){this.Eu&&ft()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const r of this.Tu)if(r.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.Tu)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const r=this.Tu.indexOf(e);this.Tu.splice(r,1)}}function GE(t){return function(r,n){if(typeof r!="object"||r===null)return!1;const i=r;for(const s of n)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}class Td extends Wv{constructor(e,r,n,i){super(e,r,n,i),this.type="firestore",this._queue=new $E,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new $E(e),this._firestoreClient=void 0,await e}}}function YU(t,e){const r=typeof t=="object"?t:Uk(),n=typeof t=="string"?t:"(default)",i=yv(r,"firestore").getImmediate({identifier:n});if(!i._initialized){const s=M9("firestore");s&&XU(i,...s)}return i}function $v(t){if(t._terminated)throw new rt(be.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||qU(t),t._firestoreClient}function qU(t){var e,r,n;const i=t._freezeSettings(),s=function(o,l,c,d){return new C7(o,l,c,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,ZC(d.experimentalLongPollingOptions),d.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._componentsProvider||!((r=i.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((n=i.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(t._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),t._firestoreClient=new zU(t._authCredentials,t._appCheckCredentials,t._queue,s,t._componentsProvider&&function(o){const l=o==null?void 0:o._online.build();return{_offline:o==null?void 0:o._offline.build(l),_online:l}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wu{constructor(e){this._byteString=e}static fromBase64String(e){try{return new wu(jn.fromBase64String(e))}catch(r){throw new rt(be.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new wu(jn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gv{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new rt(be.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new On(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e4{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kv{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new rt(be.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new rt(be.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Xt(this._lat,e._lat)||Xt(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xv{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,i){if(n.length!==i.length)return!1;for(let s=0;s<n.length;++s)if(n[s]!==i[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QU=/^__.*__$/;class JU{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new oc(e,this.data,this.fieldMask,r,this.fieldTransforms):new Wd(e,this.data,r,this.fieldTransforms)}}function t4(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ft()}}class Yv{constructor(e,r,n,i,s,a){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=i,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new Yv(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),i=this.Fu({path:n,xu:!1});return i.Ou(e),i}Nu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),i=this.Fu({path:n,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return fp(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(t4(this.Cu)&&QU.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class ZU{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||Qp(e)}Qu(e,r,n,i=!1){return new Yv({Cu:e,methodName:r,qu:n,path:On.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function ez(t){const e=t._freezeSettings(),r=Qp(t._databaseId);return new ZU(t._databaseId,!!e.ignoreUndefinedProperties,r)}function tz(t,e,r,n,i,s={}){const a=t.Qu(s.merge||s.mergeFields?2:0,e,r,i);s4("Data must be an object, but it was:",a,n);const o=n4(n,a);let l,c;if(s.merge)l=new Ps(a.fieldMask),c=a.fieldTransforms;else if(s.mergeFields){const d=[];for(const h of s.mergeFields){const g=rz(e,h,r);if(!a.contains(g))throw new rt(be.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);iz(d,g)||d.push(g)}l=new Ps(d),c=a.fieldTransforms.filter(h=>l.covers(h.field))}else l=null,c=a.fieldTransforms;return new JU(new cs(o),l,c)}function r4(t,e){if(i4(t=Vs(t)))return s4("Unsupported field value:",e,t),n4(t,e);if(t instanceof e4)return function(n,i){if(!t4(i.Cu))throw i.Bu(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${n._methodName}() is not currently supported inside arrays`);const s=n._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(n,i){const s=[];let a=0;for(const o of n){let l=r4(o,i.Lu(a));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),a++}return{arrayValue:{values:s}}}(t,e)}return function(n,i){if((n=Vs(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return q7(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const s=xn.fromDate(n);return{timestampValue:lp(i.serializer,s)}}if(n instanceof xn){const s=new xn(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:lp(i.serializer,s)}}if(n instanceof Kv)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof wu)return{bytesValue:SC(i.serializer,n._byteString)};if(n instanceof $i){const s=i.databaseId,a=n.firestore._databaseId;if(!a.isEqual(s))throw i.Bu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:bv(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof Xv)return function(a,o){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:a.toArray().map(l=>{if(typeof l!="number")throw o.Bu("VectorValues must only contain numeric values.");return Cv(o.serializer,l)})}}}}}}(n,i);throw i.Bu(`Unsupported field value: ${zv(n)}`)}(t,e)}function n4(t,e){const r={};return Jk(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Du(t,(n,i)=>{const s=r4(i,e.Mu(n));s!=null&&(r[n]=s)}),{mapValue:{fields:r}}}function i4(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof xn||t instanceof Kv||t instanceof wu||t instanceof $i||t instanceof e4||t instanceof Xv)}function s4(t,e,r){if(!i4(r)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(r)){const n=zv(r);throw n==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+n)}}function rz(t,e,r){if((e=Vs(e))instanceof Gv)return e._internalPath;if(typeof e=="string")return a4(t,e);throw fp("Field path arguments must be of type string or ",t,!1,void 0,r)}const nz=new RegExp("[~\\*/\\[\\]]");function a4(t,e,r){if(e.search(nz)>=0)throw fp(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new Gv(...e.split("."))._internalPath}catch{throw fp(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function fp(t,e,r,n,i){const s=n&&!n.isEmpty(),a=i!==void 0;let o=`Function ${e}() called with invalid data`;r&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(s||a)&&(l+=" (found",s&&(l+=` in field ${n}`),a&&(l+=` in document ${i}`),l+=")"),new rt(be.INVALID_ARGUMENT,o+t+l)}function iz(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o4{constructor(e,r,n,i,s){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new $i(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new sz(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(l4("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class sz extends o4{data(){return super.data()}}function l4(t,e){return typeof e=="string"?a4(t,e):e instanceof Gv?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function az(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new rt(be.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class oz{convertValue(e,r="none"){switch(Ql(e)){case 0:return null;case 1:return e.booleanValue;case 2:return $r(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(ql(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw ft()}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return Du(e,(i,s)=>{n[i]=this.convertValue(s,r)}),n}convertVectorValue(e){var r,n,i;const s=(i=(n=(r=e.fields)===null||r===void 0?void 0:r.value.arrayValue)===null||n===void 0?void 0:n.values)===null||i===void 0?void 0:i.map(a=>$r(a.doubleValue));return new Xv(s)}convertGeoPoint(e){return new Kv($r(e.latitude),$r(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=Sv(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(vd(e));default:return null}}convertTimestamp(e){const r=Zo(e);return new xn(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=Pr.fromString(e);sr(IC(n));const i=new yd(n.get(1),n.get(3)),s=new it(n.popFirst(5));return i.isEqual(r)||Wa(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lz(t,e,r){let n;return n=t?t.toFirestore(e):e,n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mf{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class c4 extends o4{constructor(e,r,n,i,s,a){super(e,r,n,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new dh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(l4("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}}class dh extends c4{data(e={}){return super.data(e)}}class cz{constructor(e,r,n,i){this._firestore=e,this._userDataWriter=r,this._snapshot=i,this.metadata=new mf(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new dh(this._firestore,this._userDataWriter,n.key,n,new mf(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new rt(be.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(o=>{const l=new dh(i._firestore,i._userDataWriter,o.doc.key,o.doc,new mf(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);return o.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(o=>s||o.type!==3).map(o=>{const l=new dh(i._firestore,i._userDataWriter,o.doc.key,o.doc,new mf(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);let c=-1,d=-1;return o.type!==0&&(c=a.indexOf(o.doc.key),a=a.delete(o.doc.key)),o.type!==1&&(a=a.add(o.doc),d=a.indexOf(o.doc.key)),{type:uz(o.type),doc:l,oldIndex:c,newIndex:d}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}}function uz(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ft()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fz(t){t=$o(t,$i);const e=$o(t.firestore,Td);return $U($v(e),t._key).then(r=>f4(e,t,r))}class u4 extends oz{constructor(e){super(),this.firestore=e}convertBytes(e){return new wu(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new $i(this.firestore,null,r)}}function dz(t,e,r){t=$o(t,$i);const n=$o(t.firestore,Td),i=lz(t.converter,e);return pz(n,[tz(ez(n),"setDoc",t._key,i,t.converter!==null,r).toMutation(t._key,Ma.none())])}function hz(t,...e){var r,n,i;t=Vs(t);let s={includeMetadataChanges:!1,source:"default"},a=0;typeof e[a]!="object"||GE(e[a])||(s=e[a],a++);const o={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(GE(e[a])){const h=e[a];e[a]=(r=h.next)===null||r===void 0?void 0:r.bind(h),e[a+1]=(n=h.error)===null||n===void 0?void 0:n.bind(h),e[a+2]=(i=h.complete)===null||i===void 0?void 0:i.bind(h)}let l,c,d;if(t instanceof $i)c=$o(t.firestore,Td),d=$p(t._key.path),l={next:h=>{e[a]&&e[a](f4(c,t,h))},error:e[a+1],complete:e[a+2]};else{const h=$o(t,eg);c=$o(h.firestore,Td),d=h._query;const g=new u4(c);l={next:m=>{e[a]&&e[a](new cz(c,g,h,m))},error:e[a+1],complete:e[a+2]},az(t._query)}return function(g,m,y,x){const E=new QC(x),A=new zC(m,E,y);return g.asyncQueue.enqueueAndForget(async()=>VC(await Nx(g),A)),()=>{E.Za(),g.asyncQueue.enqueueAndForget(async()=>UC(await Nx(g),A))}}($v(c),d,o,l)}function pz(t,e){return function(n,i){const s=new Ho;return n.asyncQueue.enqueueAndForget(async()=>PU(await HU(n),i,s)),s.promise}($v(t),e)}function f4(t,e,r){const n=r.docs.get(e._key),i=new u4(t);return new c4(t,i,e._key,n,new mf(r.hasPendingWrites,r.fromCache),e.converter)}(function(e,r=!0){(function(i){Nu=i})(Ru),gu(new Xl("firestore",(n,{instanceIdentifier:i,options:s})=>{const a=n.getProvider("app").getImmediate(),o=new Td(new d7(n.getProvider("auth-internal")),new m7(n.getProvider("app-check-internal")),function(c,d){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new rt(be.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new yd(c.options.projectId,d)}(a,i),a);return s=Object.assign({useFetchStreams:r},s),o._setSettings(s),o},"PUBLIC").setMultipleInstances(!0)),Wo(fE,"4.7.3",e),Wo(fE,"4.7.3","esm2017")})();function qv(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function d4(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const gz=d4,h4=new jd("auth","Firebase",d4());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dp=new xv("@firebase/auth");function mz(t,...e){dp.logLevel<=Pt.WARN&&dp.warn(`Auth (${Ru}): ${t}`,...e)}function hh(t,...e){dp.logLevel<=Pt.ERROR&&dp.error(`Auth (${Ru}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $a(t,...e){throw Qv(t,...e)}function ua(t,...e){return Qv(t,...e)}function p4(t,e,r){const n=Object.assign(Object.assign({},gz()),{[e]:r});return new jd("auth","Firebase",n).create(e,{appName:t.name})}function Ml(t){return p4(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Qv(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return h4.create(t,...e)}function ut(t,e,...r){if(!t)throw Qv(e,...r)}function Ia(t){const e="INTERNAL ASSERTION FAILED: "+t;throw hh(e),new Error(e)}function Ga(t,e){t||Ia(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dx(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function xz(){return KE()==="http:"||KE()==="https:"}function KE(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vz(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(xz()||z9()||"connection"in navigator)?navigator.onLine:!0}function yz(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kd{constructor(e,r){this.shortDelay=e,this.longDelay=r,Ga(r>e,"Short delay should be less than long delay!"),this.isMobile=j9()||W9()}get(){return vz()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jv(t,e){Ga(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g4{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ia("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ia("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ia("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _z={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ez=new Kd(3e4,6e4);function Zv(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Mu(t,e,r,n,i={}){return m4(t,i,async()=>{let s={},a={};n&&(e==="GET"?a=n:s={body:JSON.stringify(n)});const o=Vd(Object.assign({key:t.config.apiKey},a)).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const c=Object.assign({method:e,headers:l},s);return U9()||(c.referrerPolicy="no-referrer"),g4.fetch()(x4(t,t.config.apiHost,r,o),c)})}async function m4(t,e,r){t._canInitEmulator=!1;const n=Object.assign(Object.assign({},_z),e);try{const i=new Sz(t),s=await Promise.race([r(),i.promise]);i.clearNetworkTimeout();const a=await s.json();if("needConfirmation"in a)throw G0(t,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{const o=s.ok?a.errorMessage:a.error.message,[l,c]=o.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw G0(t,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw G0(t,"email-already-in-use",a);if(l==="USER_DISABLED")throw G0(t,"user-disabled",a);const d=n[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw p4(t,d,c);$a(t,d)}}catch(i){if(i instanceof Qa)throw i;$a(t,"network-request-failed",{message:String(i)})}}async function wz(t,e,r,n,i={}){const s=await Mu(t,e,r,n,i);return"mfaPendingCredential"in s&&$a(t,"multi-factor-auth-required",{_serverResponse:s}),s}function x4(t,e,r,n){const i=`${e}${r}?${n}`;return t.config.emulator?Jv(t.config,i):`${t.config.apiScheme}://${i}`}class Sz{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(ua(this.auth,"network-request-failed")),Ez.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function G0(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const i=ua(t,e,n);return i.customData._tokenResponse=r,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Tz(t,e){return Mu(t,"POST","/v1/accounts:delete",e)}async function v4(t,e){return Mu(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bf(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Az(t,e=!1){const r=Vs(t),n=await r.getIdToken(e),i=ey(n);ut(i&&i.exp&&i.auth_time&&i.iat,r.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,a=s==null?void 0:s.sign_in_provider;return{claims:i,token:n,authTime:Bf(sm(i.auth_time)),issuedAtTime:Bf(sm(i.iat)),expirationTime:Bf(sm(i.exp)),signInProvider:a||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function sm(t){return Number(t)*1e3}function ey(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return hh("JWT malformed, contained fewer than 3 sections"),null;try{const i=Pk(r);return i?JSON.parse(i):(hh("Failed to decode base64 JWT payload"),null)}catch(i){return hh("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function XE(t){const e=ey(t);return ut(e,"internal-error"),ut(typeof e.exp<"u","internal-error"),ut(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ad(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof Qa&&kz(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function kz({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cz{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var r;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const i=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Px{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=Bf(this.lastLoginAt),this.creationTime=Bf(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hp(t){var e;const r=t.auth,n=await t.getIdToken(),i=await Ad(t,v4(r,{idToken:n}));ut(i==null?void 0:i.users.length,r,"internal-error");const s=i.users[0];t._notifyReloadListener(s);const a=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?y4(s.providerUserInfo):[],o=Iz(t.providerData,a),l=t.isAnonymous,c=!(t.email&&s.passwordHash)&&!(o!=null&&o.length),d=l?c:!1,h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new Px(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(t,h)}async function Fz(t){const e=Vs(t);await hp(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function Iz(t,e){return[...t.filter(n=>!e.some(i=>i.providerId===n.providerId)),...e]}function y4(t){return t.map(e=>{var{providerId:r}=e,n=qv(e,["providerId"]);return{providerId:r,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bz(t,e){const r=await m4(t,{},async()=>{const n=Vd({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,a=x4(t,i,"/v1/token",`key=${s}`),o=await t._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",g4.fetch()(a,{method:"POST",headers:o,body:n})});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function Rz(t,e){return Mu(t,"POST","/v2/accounts:revokeToken",Zv(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ru{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ut(e.idToken,"internal-error"),ut(typeof e.idToken<"u","internal-error"),ut(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):XE(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){ut(e.length!==0,"internal-error");const r=XE(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(ut(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:i,expiresIn:s}=await bz(e,r);this.updateTokensAndExpiration(n,i,Number(s))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:i,expirationTime:s}=r,a=new ru;return n&&(ut(typeof n=="string","internal-error",{appName:e}),a.refreshToken=n),i&&(ut(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),s&&(ut(typeof s=="number","internal-error",{appName:e}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ru,this.toJSON())}_performRefresh(){return Ia("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vo(t,e){ut(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class ba{constructor(e){var{uid:r,auth:n,stsTokenManager:i}=e,s=qv(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Cz(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Px(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const r=await Ad(this,this.stsTokenManager.getToken(this.auth,e));return ut(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return Az(this,e)}reload(){return Fz(this)}_assign(e){this!==e&&(ut(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>Object.assign({},r)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new ba(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(e){ut(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await hp(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Ro(this.auth.app))return Promise.reject(Ml(this.auth));const e=await this.getIdToken();return await Ad(this,Tz(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){var n,i,s,a,o,l,c,d;const h=(n=r.displayName)!==null&&n!==void 0?n:void 0,g=(i=r.email)!==null&&i!==void 0?i:void 0,m=(s=r.phoneNumber)!==null&&s!==void 0?s:void 0,y=(a=r.photoURL)!==null&&a!==void 0?a:void 0,x=(o=r.tenantId)!==null&&o!==void 0?o:void 0,E=(l=r._redirectEventId)!==null&&l!==void 0?l:void 0,A=(c=r.createdAt)!==null&&c!==void 0?c:void 0,k=(d=r.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:_,emailVerified:P,isAnonymous:K,providerData:V,stsTokenManager:S}=r;ut(_&&S,e,"internal-error");const F=ru.fromJSON(this.name,S);ut(typeof _=="string",e,"internal-error"),vo(h,e.name),vo(g,e.name),ut(typeof P=="boolean",e,"internal-error"),ut(typeof K=="boolean",e,"internal-error"),vo(m,e.name),vo(y,e.name),vo(x,e.name),vo(E,e.name),vo(A,e.name),vo(k,e.name);const w=new ba({uid:_,auth:e,email:g,emailVerified:P,displayName:h,isAnonymous:K,photoURL:y,phoneNumber:m,tenantId:x,stsTokenManager:F,createdAt:A,lastLoginAt:k});return V&&Array.isArray(V)&&(w.providerData=V.map(b=>Object.assign({},b))),E&&(w._redirectEventId=E),w}static async _fromIdTokenResponse(e,r,n=!1){const i=new ru;i.updateFromServerResponse(r);const s=new ba({uid:r.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await hp(s),s}static async _fromGetAccountInfoResponse(e,r,n){const i=r.users[0];ut(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?y4(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),o=new ru;o.updateFromIdToken(n);const l=new ba({uid:i.localId,auth:e,stsTokenManager:o,isAnonymous:a}),c={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Px(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(l,c),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YE=new Map;function Ra(t){Ga(t instanceof Function,"Expected a class definition");let e=YE.get(t);return e?(Ga(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,YE.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _4{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}_4.type="NONE";const qE=_4;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ph(t,e,r){return`firebase:${t}:${e}:${r}`}class nu{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:i,name:s}=this.auth;this.fullUserKey=ph(this.userKey,i.apiKey,s),this.fullPersistenceKey=ph("persistence",i.apiKey,s),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?ba._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new nu(Ra(qE),e,n);const i=(await Promise.all(r.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let s=i[0]||Ra(qE);const a=ph(n,e.config.apiKey,e.name);let o=null;for(const c of r)try{const d=await c._get(a);if(d){const h=ba._fromJSON(e,d);c!==s&&(o=h),s=c;break}}catch{}const l=i.filter(c=>c._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new nu(s,e,n):(s=l[0],o&&await s._set(a,o.toJSON()),await Promise.all(r.map(async c=>{if(c!==s)try{await c._remove(a)}catch{}})),new nu(s,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QE(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(T4(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(E4(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(k4(e))return"Blackberry";if(C4(e))return"Webos";if(w4(e))return"Safari";if((e.includes("chrome/")||S4(e))&&!e.includes("edge/"))return"Chrome";if(A4(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function E4(t=si()){return/firefox\//i.test(t)}function w4(t=si()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function S4(t=si()){return/crios\//i.test(t)}function T4(t=si()){return/iemobile/i.test(t)}function A4(t=si()){return/android/i.test(t)}function k4(t=si()){return/blackberry/i.test(t)}function C4(t=si()){return/webos/i.test(t)}function ty(t=si()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function Nz(t=si()){var e;return ty(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function Dz(){return H9()&&document.documentMode===10}function F4(t=si()){return ty(t)||A4(t)||C4(t)||k4(t)||/windows phone/i.test(t)||T4(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I4(t,e=[]){let r;switch(t){case"Browser":r=QE(si());break;case"Worker":r=`${QE(si())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${Ru}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pz{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=s=>new Promise((a,o)=>{try{const l=e(s);a(l)}catch(l){o(l)}});n.onAbort=r,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const i of r)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Oz(t,e={}){return Mu(t,"GET","/v2/passwordPolicy",Zv(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mz=6;class Lz{constructor(e){var r,n,i,s;const a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=a.minPasswordLength)!==null&&r!==void 0?r:Mz,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(n=e.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var r,n,i,s,a,o;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(r=l.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(n=l.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),l.isValid&&(l.isValid=(i=l.containsLowercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(s=l.containsUppercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(a=l.containsNumericCharacter)!==null&&a!==void 0?a:!0),l.isValid&&(l.isValid=(o=l.containsNonAlphanumericCharacter)!==null&&o!==void 0?o:!0),l}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),i&&(r.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bz{constructor(e,r,n,i){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new JE(this),this.idTokenSubscription=new JE(this),this.beforeStateQueue=new Pz(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=h4,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=Ra(r)),this._initializationPromise=this.queue(async()=>{var n,i;if(!this._deleted&&(this.persistenceManager=await nu.create(this,e),!this._deleted)){if(!((n=this._popupRedirectResolver)===null||n===void 0)&&n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await v4(this,{idToken:e}),n=await ba._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var r;if(Ro(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(o,o))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let i=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,o=i==null?void 0:i._redirectEventId,l=await this.tryRedirectSignIn(e);(!a||a===o)&&(l!=null&&l.user)&&(i=l.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(a){i=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return ut(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await hp(e)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=yz()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Ro(this.app))return Promise.reject(Ml(this));const r=e?Vs(e):null;return r&&ut(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&ut(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Ro(this.app)?Promise.reject(Ml(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Ro(this.app)?Promise.reject(Ml(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ra(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await Oz(this),r=new Lz(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new jd("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await Rz(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&Ra(e)||this._popupRedirectResolver;ut(r,this,"argument-error"),this.redirectPersistenceManager=await nu.create(this,[Ra(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(r=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,i){if(this._deleted)return()=>{};const s=typeof r=="function"?r:r.next.bind(r);let a=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(ut(o,this,"internal-error"),o.then(()=>{a||s(this.currentUser)}),typeof r=="function"){const l=e.addObserver(r,n,i);return()=>{a=!0,l()}}else{const l=e.addObserver(r);return()=>{a=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ut(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=I4(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);const n=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());n&&(r["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(r["X-Firebase-AppCheck"]=i),r}async _getAppCheckToken(){var e;const r=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return r!=null&&r.error&&mz(`Error while retrieving App Check token: ${r.error}`),r==null?void 0:r.token}}function ry(t){return Vs(t)}class JE{constructor(e){this.auth=e,this.observer=null,this.addObserver=J9(r=>this.observer=r)}get next(){return ut(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ny={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function jz(t){ny=t}function Vz(t){return ny.loadJS(t)}function Uz(){return ny.gapiScript}function zz(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wz(t,e){const r=yv(t,"auth");if(r.isInitialized()){const i=r.getImmediate(),s=r.getOptions();if(tp(s,e??{}))return i;$a(i,"already-initialized")}return r.initialize({options:e})}function Hz(t,e){const r=(e==null?void 0:e.persistence)||[],n=(Array.isArray(r)?r:[r]).map(Ra);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function $z(t,e,r){const n=ry(t);ut(n._canInitEmulator,n,"emulator-config-failed"),ut(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const i=!1,s=b4(e),{host:a,port:o}=Gz(e),l=o===null?"":`:${o}`;n.config.emulator={url:`${s}//${a}${l}/`},n.settings.appVerificationDisabledForTesting=!0,n.emulatorConfig=Object.freeze({host:a,port:o,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),Kz()}function b4(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function Gz(t){const e=b4(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const s=i[1];return{host:s,port:ZE(n.substr(s.length+1))}}else{const[s,a]=n.split(":");return{host:s,port:ZE(a)}}}function ZE(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function Kz(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R4{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return Ia("not implemented")}_getIdTokenResponse(e){return Ia("not implemented")}_linkToIdToken(e,r){return Ia("not implemented")}_getReauthenticationResolver(e){return Ia("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function iu(t,e){return wz(t,"POST","/v1/accounts:signInWithIdp",Zv(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xz="http://localhost";class Jl extends R4{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new Jl(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):$a("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:i}=r,s=qv(r,["providerId","signInMethod"]);if(!n||!i)return null;const a=new Jl(n,i);return a.idToken=s.idToken||void 0,a.accessToken=s.accessToken||void 0,a.secret=s.secret,a.nonce=s.nonce,a.pendingToken=s.pendingToken||null,a}_getIdTokenResponse(e){const r=this.buildRequest();return iu(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,iu(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,iu(e,r)}buildRequest(){const e={requestUri:Xz,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=Vd(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N4{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xd extends N4{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class So extends Xd{constructor(){super("facebook.com")}static credential(e){return Jl._fromParams({providerId:So.PROVIDER_ID,signInMethod:So.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return So.credentialFromTaggedObject(e)}static credentialFromError(e){return So.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return So.credential(e.oauthAccessToken)}catch{return null}}}So.FACEBOOK_SIGN_IN_METHOD="facebook.com";So.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class To extends Xd{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return Jl._fromParams({providerId:To.PROVIDER_ID,signInMethod:To.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return To.credentialFromTaggedObject(e)}static credentialFromError(e){return To.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return To.credential(r,n)}catch{return null}}}To.GOOGLE_SIGN_IN_METHOD="google.com";To.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ao extends Xd{constructor(){super("github.com")}static credential(e){return Jl._fromParams({providerId:Ao.PROVIDER_ID,signInMethod:Ao.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ao.credentialFromTaggedObject(e)}static credentialFromError(e){return Ao.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ao.credential(e.oauthAccessToken)}catch{return null}}}Ao.GITHUB_SIGN_IN_METHOD="github.com";Ao.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ko extends Xd{constructor(){super("twitter.com")}static credential(e,r){return Jl._fromParams({providerId:ko.PROVIDER_ID,signInMethod:ko.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return ko.credentialFromTaggedObject(e)}static credentialFromError(e){return ko.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return ko.credential(r,n)}catch{return null}}}ko.TWITTER_SIGN_IN_METHOD="twitter.com";ko.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Su{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,i=!1){const s=await ba._fromIdTokenResponse(e,n,i),a=ew(n);return new Su({user:s,providerId:a,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const i=ew(n);return new Su({user:e,providerId:i,_tokenResponse:n,operationType:r})}}function ew(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pp extends Qa{constructor(e,r,n,i){var s;super(r.code,r.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,pp.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,i){return new pp(e,r,n,i)}}function D4(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?pp._fromErrorAndOperation(t,s,e,n):s})}async function Yz(t,e,r=!1){const n=await Ad(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return Su._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qz(t,e,r=!1){const{auth:n}=t;if(Ro(n.app))return Promise.reject(Ml(n));const i="reauthenticate";try{const s=await Ad(t,D4(n,i,e,t),r);ut(s.idToken,n,"internal-error");const a=ey(s.idToken);ut(a,n,"internal-error");const{sub:o}=a;return ut(t.uid===o,n,"user-mismatch"),Su._forOperation(t,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&$a(n,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Qz(t,e,r=!1){if(Ro(t.app))return Promise.reject(Ml(t));const n="signIn",i=await D4(t,n,e),s=await Su._fromIdTokenResponse(t,n,i);return r||await t._updateCurrentUser(s.user),s}function Jz(t,e,r,n){return Vs(t).onIdTokenChanged(e,r,n)}function Zz(t,e,r){return Vs(t).beforeAuthStateChanged(e,r)}const gp="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P4{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(gp,"1"),this.storage.removeItem(gp),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eW=1e3,tW=10;class O4 extends P4{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=F4(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),i=this.localCache[r];n!==i&&e(r,i,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((a,o,l)=>{this.notifyListeners(a,l)});return}const n=e.key;r?this.detachListener():this.stopPolling();const i=()=>{const a=this.storage.getItem(n);!r&&this.localCache[n]===a||this.notifyListeners(n,a)},s=this.storage.getItem(n);Dz()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,tW):i()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},eW)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}O4.type="LOCAL";const rW=O4;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M4 extends P4{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}M4.type="SESSION";const L4=M4;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nW(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tg{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(i=>i.isListeningto(e));if(r)return r;const n=new tg(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:i,data:s}=r.data,a=this.handlersMap[i];if(!(a!=null&&a.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const o=Array.from(a).map(async c=>c(r.origin,s)),l=await nW(o);r.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:l})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}tg.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iy(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iW{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,a;return new Promise((o,l)=>{const c=iy("",20);i.port1.start();const d=setTimeout(()=>{l(new Error("unsupported_event"))},n);a={messageChannel:i,onMessage(h){const g=h;if(g.data.eventId===c)switch(g.data.status){case"ack":clearTimeout(d),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),o(g.data.response);break;default:clearTimeout(d),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:c,data:r},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fa(){return window}function sW(t){fa().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B4(){return typeof fa().WorkerGlobalScope<"u"&&typeof fa().importScripts=="function"}async function aW(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function oW(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function lW(){return B4()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j4="firebaseLocalStorageDb",cW=1,mp="firebaseLocalStorage",V4="fbase_key";class Yd{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function rg(t,e){return t.transaction([mp],e?"readwrite":"readonly").objectStore(mp)}function uW(){const t=indexedDB.deleteDatabase(j4);return new Yd(t).toPromise()}function Ox(){const t=indexedDB.open(j4,cW);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(mp,{keyPath:V4})}catch(i){r(i)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(mp)?e(n):(n.close(),await uW(),e(await Ox()))})})}async function tw(t,e,r){const n=rg(t,!0).put({[V4]:e,value:r});return new Yd(n).toPromise()}async function fW(t,e){const r=rg(t,!1).get(e),n=await new Yd(r).toPromise();return n===void 0?null:n.value}function rw(t,e){const r=rg(t,!0).delete(e);return new Yd(r).toPromise()}const dW=800,hW=3;class U4{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Ox(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>hW)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return B4()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=tg._getInstance(lW()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var e,r;if(this.activeServiceWorker=await aW(),!this.activeServiceWorker)return;this.sender=new iW(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((e=n[0])===null||e===void 0)&&e.fulfilled&&!((r=n[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||oW()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Ox();return await tw(e,gp,"1"),await rw(e,gp),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>tw(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>fW(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>rw(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=rg(i,!1).getAll();return new Yd(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),r.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),r.push(i));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),dW)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}U4.type="LOCAL";const pW=U4;new Kd(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gW(t,e){return e?Ra(e):(ut(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sy extends R4{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return iu(e,this._buildIdpRequest())}_linkToIdToken(e,r){return iu(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return iu(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function mW(t){return Qz(t.auth,new sy(t),t.bypassAuthState)}function xW(t){const{auth:e,user:r}=t;return ut(r,e,"internal-error"),qz(r,new sy(t),t.bypassAuthState)}async function vW(t){const{auth:e,user:r}=t;return ut(r,e,"internal-error"),Yz(r,new sy(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z4{constructor(e,r,n,i,s=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:i,tenantId:s,error:a,type:o}=e;if(a){this.reject(a);return}const l={auth:this.auth,requestUri:r,sessionId:n,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return mW;case"linkViaPopup":case"linkViaRedirect":return vW;case"reauthViaPopup":case"reauthViaRedirect":return xW;default:$a(this.auth,"internal-error")}}resolve(e){Ga(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ga(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yW=new Kd(2e3,1e4);class Hc extends z4{constructor(e,r,n,i,s){super(e,r,i,s),this.provider=n,this.authWindow=null,this.pollId=null,Hc.currentPopupAction&&Hc.currentPopupAction.cancel(),Hc.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ut(e,this.auth,"internal-error"),e}async onExecution(){Ga(this.filter.length===1,"Popup operations only handle one event");const e=iy();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(ua(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(ua(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Hc.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if(!((n=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(ua(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,yW.get())};e()}}Hc.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _W="pendingRedirect",gh=new Map;class EW extends z4{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=gh.get(this.auth._key());if(!e){try{const n=await wW(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}gh.set(this.auth._key(),e)}return this.bypassAuthState||gh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function wW(t,e){const r=AW(e),n=TW(t);if(!await n._isAvailable())return!1;const i=await n._get(r)==="true";return await n._remove(r),i}function SW(t,e){gh.set(t._key(),e)}function TW(t){return Ra(t._redirectPersistence)}function AW(t){return ph(_W,t.config.apiKey,t.name)}async function kW(t,e,r=!1){if(Ro(t.app))return Promise.reject(Ml(t));const n=ry(t),i=gW(n,e),a=await new EW(n,i,r).execute();return a&&!r&&(delete a.user._redirectEventId,await n._persistUserIfCurrent(a.user),await n._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CW=10*60*1e3;class FW{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!IW(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!W4(e)){const i=((n=e.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";r.onError(ua(this.auth,i))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=CW&&this.cachedEventUids.clear(),this.cachedEventUids.has(nw(e))}saveEventToCache(e){this.cachedEventUids.add(nw(e)),this.lastProcessedEventTime=Date.now()}}function nw(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function W4({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function IW(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return W4(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bW(t,e={}){return Mu(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RW=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,NW=/^https?/;async function DW(t){if(t.config.emulator)return;const{authorizedDomains:e}=await bW(t);for(const r of e)try{if(PW(r))return}catch{}$a(t,"unauthorized-domain")}function PW(t){const e=Dx(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const a=new URL(t);return a.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&a.hostname===n}if(!NW.test(r))return!1;if(RW.test(t))return n===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OW=new Kd(3e4,6e4);function iw(){const t=fa().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function MW(t){return new Promise((e,r)=>{var n,i,s;function a(){iw(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{iw(),r(ua(t,"network-request-failed"))},timeout:OW.get()})}if(!((i=(n=fa().gapi)===null||n===void 0?void 0:n.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=fa().gapi)===null||s===void 0)&&s.load)a();else{const o=zz("iframefcb");return fa()[o]=()=>{gapi.load?a():r(ua(t,"network-request-failed"))},Vz(`${Uz()}?onload=${o}`).catch(l=>r(l))}}).catch(e=>{throw mh=null,e})}let mh=null;function LW(t){return mh=mh||MW(t),mh}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BW=new Kd(5e3,15e3),jW="__/auth/iframe",VW="emulator/auth/iframe",UW={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},zW=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function WW(t){const e=t.config;ut(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?Jv(e,VW):`https://${t.config.authDomain}/${jW}`,n={apiKey:e.apiKey,appName:t.name,v:Ru},i=zW.get(t.config.apiHost);i&&(n.eid=i);const s=t._getFrameworks();return s.length&&(n.fw=s.join(",")),`${r}?${Vd(n).slice(1)}`}async function HW(t){const e=await LW(t),r=fa().gapi;return ut(r,t,"internal-error"),e.open({where:document.body,url:WW(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:UW,dontclear:!0},n=>new Promise(async(i,s)=>{await n.restyle({setHideOnLeave:!1});const a=ua(t,"network-request-failed"),o=fa().setTimeout(()=>{s(a)},BW.get());function l(){fa().clearTimeout(o),i(n)}n.ping(l).then(l,()=>{s(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $W={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},GW=500,KW=600,XW="_blank",YW="http://localhost";class sw{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function qW(t,e,r,n=GW,i=KW){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-n)/2,0).toString();let o="";const l=Object.assign(Object.assign({},$W),{width:n.toString(),height:i.toString(),top:s,left:a}),c=si().toLowerCase();r&&(o=S4(c)?XW:r),E4(c)&&(e=e||YW,l.scrollbars="yes");const d=Object.entries(l).reduce((g,[m,y])=>`${g}${m}=${y},`,"");if(Nz(c)&&o!=="_self")return QW(e||"",o),new sw(null);const h=window.open(e||"",o,d);ut(h,t,"popup-blocked");try{h.focus()}catch{}return new sw(h)}function QW(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JW="__/auth/handler",ZW="emulator/auth/handler",eH=encodeURIComponent("fac");async function aw(t,e,r,n,i,s){ut(t.config.authDomain,t,"auth-domain-config-required"),ut(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:Ru,eventId:i};if(e instanceof N4){e.setDefaultLanguage(t.languageCode),a.providerId=e.providerId||"",Q9(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,h]of Object.entries({}))a[d]=h}if(e instanceof Xd){const d=e.getScopes().filter(h=>h!=="");d.length>0&&(a.scopes=d.join(","))}t.tenantId&&(a.tid=t.tenantId);const o=a;for(const d of Object.keys(o))o[d]===void 0&&delete o[d];const l=await t._getAppCheckToken(),c=l?`#${eH}=${encodeURIComponent(l)}`:"";return`${tH(t)}?${Vd(o).slice(1)}${c}`}function tH({config:t}){return t.emulator?Jv(t,ZW):`https://${t.authDomain}/${JW}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const am="webStorageSupport";class rH{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=L4,this._completeRedirectFn=kW,this._overrideRedirectResult=SW}async _openPopup(e,r,n,i){var s;Ga((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const a=await aw(e,r,n,Dx(),i);return qW(e,a,iy())}async _openRedirect(e,r,n,i){await this._originValidation(e);const s=await aw(e,r,n,Dx(),i);return sW(s),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:i,promise:s}=this.eventManagers[r];return i?Promise.resolve(i):(Ga(s,"If manager is not set, promise should be"),s)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await HW(e),n=new FW(e);return r.register("authEvent",i=>(ut(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:n.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(am,{type:am},i=>{var s;const a=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[am];a!==void 0&&r(!!a),$a(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=DW(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return F4()||w4()||ty()}}const nH=rH;var ow="@firebase/auth",lw="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iH{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){ut(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sH(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function aH(t){gu(new Xl("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=n.options;ut(a&&!a.includes(":"),"invalid-api-key",{appName:n.name});const l={apiKey:a,authDomain:o,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:I4(t)},c=new Bz(n,i,s,l);return Hz(c,r),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),gu(new Xl("auth-internal",e=>{const r=ry(e.getProvider("auth").getImmediate());return(n=>new iH(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),Wo(ow,lw,sH(t)),Wo(ow,lw,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oH=5*60,lH=Lk("authIdTokenMaxAge")||oH;let cw=null;const cH=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>lH)return;const i=r==null?void 0:r.token;cw!==i&&(cw=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function uH(t=Uk()){const e=yv(t,"auth");if(e.isInitialized())return e.getImmediate();const r=Wz(t,{popupRedirectResolver:nH,persistence:[pW,rW,L4]}),n=Lk("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(n,location.origin);if(location.origin===s.origin){const a=cH(s.toString());Zz(r,a,()=>a(r.currentUser)),Jz(r,o=>a(o))}}const i=Ok("auth");return i&&$z(r,`http://${i}`),r}function fH(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}jz({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=i=>{const s=ua("internal-error");s.customData=i,r(s)},n.type="text/javascript",n.charset="UTF-8",fH().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});aH("Browser");const dH={apiKey:"AIzaSyAZZ0804o11q-hS6p7XJZNK_FPGJgXpmPc",authDomain:"finance-automation-b28e8.firebaseapp.com",projectId:"finance-automation-b28e8",storageBucket:"finance-automation-b28e8.firebasestorage.app",messagingSenderId:"832501526859",appId:"1:832501526859:web:3a64f40f9db732af1b78ce"},H4=Vk(dH),ay=YU(H4);uH(H4);const om=async(t,e)=>{try{return await dz(Hv(ay,"appState",t),{masterData:e.masterData||[],ledgerEntries:e.ledgerEntries||[],receipts:e.receipts||[],creditNotes:e.creditNotes||[],openingBalances:e.openingBalances||{},mailerImages:e.mailerImages||{},mailerLogo:e.mailerLogo||null,companyConfig:e.companyConfig||{},nextInvoiceNo:e.nextInvoiceNo||1,nextCombineNo:e.nextCombineNo||1,nextReceiptNo:e.nextReceiptNo||1,nextCreditNoteNo:e.nextCreditNoteNo||1,invoiceValues:e.invoiceValues||{},notifications:e.notifications||[],whatsappSettings:e.whatsappSettings||{},partyMaster:e.partyMaster||[],followups:e.followups||[],updatedAt:new Date().toISOString()}),!0}catch(r){return console.error("Error saving app state:",r),!1}},uw=async t=>{try{const e=await fz(Hv(ay,"appState",t));return e.exists()?e.data():null}catch(e){return console.error("Error loading app state:",e),null}},hH=(t,e)=>{const r=Hv(ay,"appState",t);return hz(r,n=>{n.exists()&&e(n.data())},n=>{console.error("Error in real-time listener:",n)})},et=t=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:2,maximumFractionDigits:2}).format(t||0),Dt=t=>""+new Intl.NumberFormat("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2}).format(t||0),Vt=t=>{if(!t)return"-";const e=new Date(t);if(isNaN(e.getTime()))return t;const r=e.getDate().toString().padStart(2,"0"),n=e.toLocaleString("en-US",{month:"short"}),i=e.getFullYear();return`${r}-${n}-${i}`},pH=t=>{if(!t)return"-";const e=new Date(t);if(isNaN(e.getTime()))return t;const r=e.getDate(),n=e.toLocaleString("en-US",{month:"short"}),i=e.getFullYear();return`${r}${(a=>{if(a>3&&a<21)return"th";switch(a%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}})(r)} ${n}, ${i}`},K0=t=>{const e=["","One","Two","Three","Four","Five","Six","Seven","Eight","Nine","Ten","Eleven","Twelve","Thirteen","Fourteen","Fifteen","Sixteen","Seventeen","Eighteen","Nineteen"],r=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"];if(t===0)return"Zero";const n=l=>l<20?e[l]:l<100?r[Math.floor(l/10)]+(l%10?" "+e[l%10]:""):e[Math.floor(l/100)]+" Hundred"+(l%100?" "+n(l%100):""),i=l=>l<1e3?n(l):l<1e5?n(Math.floor(l/1e3))+" Thousand"+(l%1e3?" "+n(l%1e3):""):l<1e7?n(Math.floor(l/1e5))+" Lakh"+(l%1e5?" "+i(l%1e5):""):n(Math.floor(l/1e7))+" Crore"+(l%1e7?" "+i(l%1e7):""),s=Math.floor(t),a=Math.round((t-s)*100);let o="INR "+i(s);return a>0&&(o+=" and "+i(a)+" Paise"),o+" Only"},gH=t=>{if(!t)return"";const e=/[\w.-]+@[\w.-]+\.\w+/g,r=t.match(e);return r?r[0]:""},mH=t=>({Approved:{bg:"#DCFCE7",text:"#166534",border:"#86EFAC"},Created:{bg:"#DBEAFE",text:"#1E40AF",border:"#93C5FD"},"Need Edits":{bg:"#FEE2E2",text:"#991B1B",border:"#FCA5A5"},Paid:{bg:"#D1FAE5",text:"#065F46",border:"#6EE7B7"},Individual:{bg:"#E0E7FF",text:"#3730A3",border:"#A5B4FC"},Combined:{bg:"#F3E8FF",text:"#6B21A8",border:"#DDD6FE"},Yes:{bg:"#DCFCE7",text:"#166534",border:"#86EFAC"},No:{bg:"#FEF3C7",text:"#92400E",border:"#FCD34D"},"Not Yet":{bg:"#F1F5F9",text:"#475569",border:"#CBD5E1"},Pending:{bg:"#FEF3C7",text:"#92400E",border:"#FCD34D"},Sent:{bg:"#D1FAE5",text:"#065F46",border:"#6EE7B7"}})[t]||{bg:"#F1F5F9",text:"#475569",border:"#CBD5E1"},lm=({status:t,small:e=!1})=>{const r=mH(t);return u.jsx("span",{style:{display:"inline-flex",alignItems:"center",padding:e?"2px 8px":"4px 12px",borderRadius:"6px",fontSize:e?"11px":"12px",fontWeight:"600",backgroundColor:r.bg,color:r.text,border:`1px solid ${r.border}`},children:t})},Ye=({icon:t,label:e,onClick:r,variant:n="default",disabled:i=!1,small:s=!1})=>{const a={default:{bg:"#F8FAFC",hoverBg:"#E2E8F0",text:"#475569",border:"#CBD5E1"},primary:{bg:"#2874A6",hoverBg:"#1a5276",text:"#FFFFFF",border:"#2874A6"},success:{bg:"#059669",hoverBg:"#047857",text:"#FFFFFF",border:"#059669"},warning:{bg:"#D97706",hoverBg:"#B45309",text:"#FFFFFF",border:"#D97706"},danger:{bg:"#DC2626",hoverBg:"#B91C1C",text:"#FFFFFF",border:"#DC2626"},brand:{bg:"#2874A6",hoverBg:"#1a5276",text:"#FFFFFF",border:"#2874A6"},purple:{bg:"#7C3AED",hoverBg:"#6D28D9",text:"#FFFFFF",border:"#7C3AED"},secondary:{bg:"#F1F5F9",hoverBg:"#E2E8F0",text:"#475569",border:"#CBD5E1"}},o=a[n]||a.default;return u.jsxs("button",{onClick:r,disabled:i,title:e,style:{display:"inline-flex",alignItems:"center",gap:"6px",padding:s?"5px 10px":"8px 14px",borderRadius:"6px",fontSize:s?"11px":"13px",fontWeight:"600",backgroundColor:i?"#F1F5F9":o.bg,color:i?"#94A3B8":o.text,border:`1px solid ${i?"#E2E8F0":o.border}`,cursor:i?"not-allowed":"pointer",transition:"all 0.15s ease",whiteSpace:"nowrap",opacity:i?.6:1},onMouseEnter:l=>!i&&(l.target.style.backgroundColor=o.hoverBg),onMouseLeave:l=>!i&&(l.target.style.backgroundColor=o.bg),children:[t&&u.jsx(t,{size:s?14:16}),e&&u.jsx("span",{children:e})]})},Er=({label:t,type:e="text",value:r,onChange:n,placeholder:i,disabled:s,small:a})=>u.jsxs("div",{style:{marginBottom:a?"12px":"16px"},children:[t&&u.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:t}),u.jsx("input",{type:e,value:r,onChange:n,placeholder:i,disabled:s,style:{width:"100%",padding:a?"8px 12px":"10px 14px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:a?"13px":"14px",backgroundColor:s?"#F9FAFB":"#FFFFFF",boxSizing:"border-box"}})]}),X0=({label:t,value:e,onChange:r,options:n,small:i})=>u.jsxs("div",{style:{marginBottom:i?"12px":"16px"},children:[t&&u.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:t}),u.jsx("select",{value:e,onChange:r,style:{width:"100%",padding:i?"8px 12px":"10px 14px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:i?"13px":"14px",backgroundColor:"#FFFFFF",boxSizing:"border-box"},children:n.map(s=>u.jsx("option",{value:s.value,children:s.label},s.value))})]}),Zr=({title:t,children:e,actions:r,noPadding:n=!1})=>u.jsxs("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"12px",border:"1px solid #E2E8F0",boxShadow:"0 2px 8px rgba(0,0,0,0.06)",overflow:"hidden"},children:[t&&u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"14px 20px",borderBottom:"1px solid #E2E8F0",backgroundColor:"#FAFBFC"},children:[u.jsx("h3",{style:{margin:0,fontSize:"15px",fontWeight:"700",color:"#1E293B"},children:t}),r&&u.jsx("div",{style:{display:"flex",gap:"10px"},children:r})]}),u.jsx("div",{style:{padding:n?0:"20px"},children:e})]}),wn=({isOpen:t,onClose:e,title:r,children:n,width:i="500px"})=>t?u.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(15, 23, 42, 0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,backdropFilter:"blur(4px)"},onClick:e,children:u.jsxs("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"16px",width:i,maxWidth:"95vw",maxHeight:"90vh",overflow:"hidden",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)"},onClick:s=>s.stopPropagation(),children:[u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"16px 20px",borderBottom:"1px solid #E2E8F0",backgroundColor:"#FAFBFC"},children:[u.jsx("h2",{style:{margin:0,fontSize:"16px",fontWeight:"700",color:"#1E293B"},children:r}),u.jsx("button",{onClick:e,style:{background:"none",border:"none",cursor:"pointer",padding:"4px",color:"#64748B"},children:u.jsx(El,{size:20})})]}),u.jsx("div",{style:{padding:"20px",maxHeight:"calc(90vh - 100px)",overflowY:"auto"},children:n})]})}):null;function xH(){const[t,e]=ye.useState(()=>{const p=localStorage.getItem("financeAppLogin");return p?JSON.parse(p).isLoggedIn:!1}),[r,n]=ye.useState(()=>{const p=localStorage.getItem("financeAppLogin");return p?JSON.parse(p).userRole:null}),[i,s]=ye.useState({username:"",password:""}),[a,o]=ye.useState(""),[l,c]=ye.useState(!1),[d,h]=ye.useState(!1),[g,m]=ye.useState(null),[y,x]=ye.useState({finance:"finance123",director:"director123"}),[E,A]=ye.useState(!1),[k,_]=ye.useState(!1),[P,K]=ye.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[V,S]=ye.useState(""),F={finance:{role:"finance",name:"Finance Team"},director:{role:"director",name:"Director"}};ye.useEffect(()=>{(async()=>{try{const T=await uw("indreesh-media");T&&T.userPasswords&&(x(T.userPasswords),console.log("Passwords loaded from Firebase"))}catch(T){console.error("Error loading passwords:",T)}A(!0)})()},[]);const[w,b]=ye.useState({name:"Indreesh Media LLP",brand:"JAC",address:"A-1701 Sweet Home CHS LTD, SVP, Plot No: 24",addressLine2:"Andheri West, Nr Last Bus St",city:"Mumbai-400053",gstin:"27AAIFI6351A1ZM",stateCode:"27",stateName:"Maharashtra",email:"alliances@mediabrief.com",phone:"+91 7021911036",website:"www.mediabrief.com",pan:"AAIFI6351A",bank:{name:"Axis Bank",account:"921020009075531",branch:"Andheri",ifsc:"UTIB0000020",holder:"Indreesh Media LLP"},invoicePrefix:"MB/2025-26/",hsnCode:"998365",gstRate:18}),[N,D]=ye.useState("master"),[R,ze]=ye.useState(!1),[_e,Ie]=ye.useState([]),[De,we]=ye.useState([]),[re,Ae]=ye.useState([]),[Oe,z]=ye.useState([]),[ne,te]=ye.useState([]),[Y,ge]=ye.useState(null),[Ee,Pe]=ye.useState(null),[ke,Se]=ye.useState(1),[tt,Q]=ye.useState(1),[Rt,xt]=ye.useState(1),[Ft,dt]=ye.useState(1),[We,ar]=ye.useState(1),[In,sn]=ye.useState(!1),[xi,qi]=ye.useState(!1),[vi,Lr]=ye.useState(!1),[yi,Qt]=ye.useState(!1),[Sr,fr]=ye.useState(!1),[oi,ct]=ye.useState(!1),[dr,hr]=ye.useState(!1),[yr,li]=ye.useState(!1),[Ja,Za]=ye.useState(!1),[Lu,xs]=ye.useState(!1),[ol,vs]=ye.useState(!1),[ae,br]=ye.useState(null),[_i,Qi]=ye.useState("reply"),[ma,Us]=ye.useState(""),[zs,Ei]=ye.useState(""),[an,Yr]=ye.useState({fromDate:"2020-01-01",toDate:new Date().toISOString().split("T")[0]}),[xa,ys]=ye.useState(""),[on,cc]=ye.useState("open"),[Ws,I]=ye.useState("open"),[G,M]=ye.useState(!1),[B,X]=ye.useState(null),[U,oe]=ye.useState({partyName:"",statePartyDetails:"",serviceType:"Podcast Production",description:"",date:new Date().toISOString().split("T")[0],amount:""}),[fe,le]=ye.useState({party:"",invoiceStatus:"",receiptStatus:"",invoiceType:"",searchText:""}),[ce,ue]=ye.useState([]),[Ce,je]=ye.useState(!1),[$e,Re]=ye.useState([]),[Ge,nt]=ye.useState(!1),[ot,Lt]=ye.useState(null),[kt,ci]=ye.useState({date:new Date().toISOString().split("T")[0],notes:"",nextFollowupDate:"",status:"Pending"}),[ht,Vn]=ye.useState({enabled:!1,financePhone:"",financeApiKey:"",directorPhone:"",directorApiKey:""}),[vt,yn]=ye.useState({amount:"",tds:"",discount:"",narration:"",paymentAdvisory:null,date:new Date().toISOString().split("T")[0],mode:"Bank"}),[Yt,_s]=ye.useState({amount:"",gst:"",reason:"",date:new Date().toISOString().split("T")[0]}),[va,Hs]=ye.useState({particularsApproved:!1,emailApproved:!1,invoiceTypeApproved:!1}),[uc,Bu]=ye.useState(null),[Ji,eo]=ye.useState(new Set),[wi,Di]=ye.useState({}),[ln,ya]=ye.useState(null),[Es,_a]=ye.useState(null),[Zt,Ea]=ye.useState(!1),[cn,$s]=ye.useState({}),[Si,ll]=ye.useState({partyName:"",amount:"",type:"Dr"}),[Gs,ju]=ye.useState({}),[qr,fc]=ye.useState({}),[cl,Pi]=ye.useState(!1),[Vu,dc]=ye.useState(new Set),[pt,Zi]=ye.useState({party:"",billStatus:"",invoiceStatus:"",mailingStatus:"",invoiceType:"",combinationCode:"",searchText:""}),[_r,to]=ye.useState({amount:"",date:new Date().toISOString().split("T")[0],mode:"Bank",tds:"",discount:"",narration:""}),qd=ye.useRef(null),ws=ye.useRef(null),Uu=ye.useRef(null),Qd=ye.useRef(null),ul=ye.useRef(null),fl=ye.useRef(null),ro=ye.useRef(null),no=ye.useRef(null),io=ye.useRef(null),un=ye.useMemo(()=>Array.isArray(_e)?_e:[],[_e]),Ks=ye.useMemo(()=>Array.isArray(De)?De:[],[De]),Nt=ye.useMemo(()=>Array.isArray(re)?re:[],[re]),so=ye.useMemo(()=>Array.isArray(Oe)?Oe:[],[Oe]),ao=ye.useMemo(()=>Array.isArray(ne)?ne:[],[ne]),zu=ye.useMemo(()=>Array.isArray(ce)?ce:[],[ce]),dl=ye.useMemo(()=>Array.isArray($e)?$e:[],[$e]),Br=ye.useMemo(()=>qr&&typeof qr=="object"&&!Array.isArray(qr)?qr:{},[qr]),Ss=ye.useMemo(()=>cn&&typeof cn=="object"&&!Array.isArray(cn)?cn:{},[cn]),qt=(p,T)=>!p||!T?!1:p.trim().toUpperCase()===T.trim().toUpperCase(),jr=ye.useCallback(p=>{if(!p)return"";const T=p.toUpperCase().trim();return T.includes("MAHARASHTRA")||T==="MH"?"MAHARASHTRA":T.includes("DELHI")||T==="DL"||T.includes("NEW DELHI")?"DELHI":T.includes("KARNATAKA")||T==="KA"||T.includes("BANGALORE")||T.includes("BENGALURU")?"KARNATAKA":T.includes("TAMIL")||T==="TN"||T.includes("CHENNAI")?"TAMIL NADU":T.includes("TELANGANA")||T==="TG"||T==="TS"||T.includes("HYDERABAD")?"TELANGANA":T.includes("UTTAR PRADESH")||T==="UP"||T.includes("NOIDA")||T.includes("LUCKNOW")?"UTTAR PRADESH":T.includes("WEST BENGAL")||T==="WB"||T.includes("KOLKATA")?"WEST BENGAL":T.includes("GUJARAT")||T==="GJ"||T.includes("AHMEDABAD")?"GUJARAT":T.includes("RAJASTHAN")||T==="RJ"||T.includes("JAIPUR")?"RAJASTHAN":T.includes("PUNJAB")||T==="PB"?"PUNJAB":T.includes("HARYANA")||T==="HR"||T.includes("GURGAON")||T.includes("GURUGRAM")?"HARYANA":T.includes("MADHYA PRADESH")||T==="MP"||T.includes("BHOPAL")?"MADHYA PRADESH":T.includes("ANDHRA")||T==="AP"?"ANDHRA PRADESH":T.includes("KERALA")||T==="KL"?"KERALA":T.includes("ODISHA")||T.includes("ORISSA")||T==="OR"||T==="OD"?"ODISHA":T.includes("BIHAR")||T==="BR"?"BIHAR":T.includes("JHARKHAND")||T==="JH"?"JHARKHAND":T.includes("ASSAM")||T==="AS"?"ASSAM":T.includes("CHHATTISGARH")||T==="CG"?"CHHATTISGARH":T.includes("GOA")||T==="GA"?"GOA":T.includes("HIMACHAL")||T==="HP"?"HIMACHAL PRADESH":T.includes("JAMMU")||T==="JK"?"JAMMU AND KASHMIR":T.includes("UTTARAKHAND")||T.includes("UTTARANCHAL")||T==="UK"?"UTTARAKHAND":T.includes("MUMBAI")?"MAHARASHTRA":T.includes("CHANDIGARH")?"CHANDIGARH":T},[]),hc=ye.useCallback((p,T)=>{var q;if(!p)return"";const H=jr(T),W=p.trim().toUpperCase(),L=`${W}|${H}`;if((q=Br[L])!=null&&q.gstin)return Br[L].gstin;for(const Z in Br){const j=Br[Z];if((j.partyName||"").trim().toUpperCase()===W&&j.normalizedState===H)return j.gstin||""}for(const Z in Br){const j=Br[Z];if((j.partyName||"").trim().toUpperCase()===W&&j.gstin)return j.gstin}return""},[Br,jr]),Wu=ye.useCallback((p,T)=>{var q;if(!p)return"";const H=jr(T),W=p.trim().toUpperCase(),L=`${W}|${H}`;if((q=Br[L])!=null&&q.address)return Br[L].address;for(const Z in Br){const j=Br[Z];if((j.partyName||"").trim().toUpperCase()===W&&j.normalizedState===H)return j.address||""}for(const Z in Br){const j=Br[Z];if((j.partyName||"").trim().toUpperCase()===W&&j.address)return j.address}return""},[Br,jr]),Xs=ye.useRef(!1),Ys=ye.useRef(null),pc=async()=>{c(!0);try{const p=await uw("indreesh-media");p&&(Array.isArray(p.masterData)&&Ie(p.masterData),Array.isArray(p.servicesData)&&we(p.servicesData),Array.isArray(p.ledgerEntries)&&Ae(p.ledgerEntries),Array.isArray(p.receipts)&&z(p.receipts),Array.isArray(p.creditNotes)&&te(p.creditNotes),Array.isArray(p.notifications)&&ue(p.notifications),Array.isArray(p.followups)&&Re(p.followups),p.openingBalances&&typeof p.openingBalances=="object"&&!Array.isArray(p.openingBalances)&&$s(p.openingBalances),p.mailerImages&&typeof p.mailerImages=="object"&&!Array.isArray(p.mailerImages)&&Di(p.mailerImages),p.partyMaster&&typeof p.partyMaster=="object"&&!Array.isArray(p.partyMaster)&&fc(p.partyMaster),p.userPasswords&&typeof p.userPasswords=="object"&&!Array.isArray(p.userPasswords)&&x(p.userPasswords),p.mailerLogo&&ya(p.mailerLogo),p.companyConfig&&b(T=>({...T,...p.companyConfig,name:"Indreesh Media LLP",bank:{...p.companyConfig.bank||T.bank,holder:"Indreesh Media LLP"}})),p.nextInvoiceNo&&Se(p.nextInvoiceNo),p.nextCombineNo&&Q(p.nextCombineNo),p.nextReceiptNo&&xt(p.nextReceiptNo),p.nextCreditNoteNo&&dt(p.nextCreditNoteNo),p.nextServiceInvoiceNo&&ar(p.nextServiceInvoiceNo),p.invoiceValues&&ju(p.invoiceValues),p.whatsappSettings&&Vn(T=>({...T,...p.whatsappSettings})),console.log("Data loaded from Firebase"))}catch(p){console.error("Error loading data:",p)}c(!1)},hl=ye.useCallback(async()=>{h(!0);try{await om("indreesh-media",{masterData:_e,servicesData:De,ledgerEntries:re,receipts:Oe,creditNotes:ne,openingBalances:cn,mailerImages:wi,mailerLogo:ln,companyConfig:w,nextInvoiceNo:ke,nextCombineNo:tt,nextReceiptNo:Rt,nextCreditNoteNo:Ft,nextServiceInvoiceNo:We,invoiceValues:Gs,notifications:ce,whatsappSettings:ht,partyMaster:qr,followups:$e,userPasswords:y}),m(new Date),console.log("Data saved to Firebase")}catch(p){console.error("Error saving data:",p)}h(!1)},[_e,De,re,Oe,ne,cn,wi,ln,w,ke,tt,Rt,Ft,We,Gs,ce,ht,qr,$e,y]);ye.useEffect(()=>{if(t&&!Xs.current)return ro.current&&clearTimeout(ro.current),ro.current=setTimeout(()=>{Xs.current||hl()},1e3),()=>{ro.current&&clearTimeout(ro.current)}},[_e,De,re,Oe,ne,cn,wi,ln,w,ke,tt,Rt,Ft,We,Gs,ce,ht,qr,$e,y,t]);const Jd=async(p,T,H)=>{if(!ht.enabled){console.log("WhatsApp notifications not enabled");return}H==="finance"&&ht.financePhone&&ht.financeApiKey?qs(ht.financePhone,ht.financeApiKey,p,T):H==="director"&&ht.directorPhone&&ht.directorApiKey?qs(ht.directorPhone,ht.directorApiKey,p,T):H==="all"&&(ht.financePhone&&ht.financeApiKey&&qs(ht.financePhone,ht.financeApiKey,p,T),ht.directorPhone&&ht.directorApiKey&&qs(ht.directorPhone,ht.directorApiKey,p,T))},qs=async(p,T,H,W)=>{try{const q=`*${{upload:" DATA UPLOAD",invoice:" INVOICE",approval:" APPROVED",edit:" EDIT REQUIRED",receipt:" PAYMENT",info:" UPDATE"}[H]||" NOTIFICATION"}*

${W}

_${w.name}_
_${new Date().toLocaleString("en-IN",{timeZone:"Asia/Kolkata"})}_`,Z=`https://api.callmebot.com/whatsapp.php?phone=${p}&text=${encodeURIComponent(q)}&apikey=${T}`;fetch(Z,{mode:"no-cors"}).then(()=>console.log("WhatsApp notification sent to:",p)).catch(j=>console.log("WhatsApp send attempted:",p))}catch(L){console.error("Failed to send WhatsApp notification:",L)}},Zd=(p,T)=>{if(!p||!T){alert("Please enter phone number and API key first");return}qs(p,T,"info","Test notification from Indreesh Media LLP. WhatsApp notifications are working!"),alert("Test message sent! Check your WhatsApp.")},Ts=(p,T,H="all")=>{const W={id:Date.now()+Math.random(),type:p,message:T,forRole:H,createdAt:new Date().toISOString(),createdBy:r,read:{finance:!1,director:!1}};ue(L=>[W,...L].slice(0,50)),Jd(p,T,H)},pl=p=>{ue(T=>(Array.isArray(T)?T:[]).map(W=>W.id===p?{...W,read:{...W.read,[r]:!0}}:W))},e0=()=>{ue(p=>(Array.isArray(p)?p:[]).map(H=>({...H,read:{...H.read,[r]:!0}})))},t0=()=>{ue([])},oo=ye.useMemo(()=>zu.filter(p=>p.forRole==="all"||p.forRole===r||p.createdBy!==r).map(p=>({...p,read:p.read||{finance:!1,director:!1}})),[zu,r]),Oi=ye.useMemo(()=>r?oo.filter(p=>!(p.read&&p.read[r])).length:0,[oo,r]),Hu=async()=>{const p=F[i.username.toLowerCase()],T=y[i.username.toLowerCase()];p&&T===i.password?(e(!0),n(p.role),localStorage.setItem("financeAppLogin",JSON.stringify({isLoggedIn:!0,userRole:p.role})),o(""),s({username:"",password:""}),await pc()):o("Invalid username or password")},lo=async()=>{if(!P.currentPassword||!P.newPassword||!P.confirmPassword){S("Please fill all fields");return}const p=r==="director"?"director":"finance";if(y[p]!==P.currentPassword){S("Current password is incorrect");return}if(P.newPassword!==P.confirmPassword){S("New passwords do not match");return}if(P.newPassword.length<6){S("Password must be at least 6 characters");return}const T={...y,[p]:P.newPassword};x(T);try{await om("indreesh-media",{masterData:_e,ledgerEntries:re,receipts:Oe,creditNotes:ne,openingBalances:cn,mailerImages:wi,mailerLogo:ln,companyConfig:w,nextInvoiceNo:ke,nextCombineNo:tt,nextReceiptNo:Rt,nextCreditNoteNo:Ft,invoiceValues:Gs,notifications:ce,whatsappSettings:ht,partyMaster:qr,followups:$e,userPasswords:T}),console.log("Password saved to Firebase")}catch(H){console.error("Error saving password:",H),S("Failed to save password. Please try again.");return}_(!1),K({currentPassword:"",newPassword:"",confirmPassword:""}),S(""),alert(" Password changed successfully!")},r0=()=>{hl(),e(!1),n(null),D("master"),localStorage.removeItem("financeAppLogin")};ye.useEffect(()=>{const p=localStorage.getItem("financeAppLogin");if(p){const{isLoggedIn:T}=JSON.parse(p);T&&pc()}},[]),ye.useEffect(()=>{if(!t){Ys.current&&(Ys.current(),Ys.current=null);return}return Ys.current=hH("indreesh-media",p=>{p&&(Xs.current=!0,Array.isArray(p.masterData)&&Ie(p.masterData),Array.isArray(p.servicesData)&&we(p.servicesData),Array.isArray(p.ledgerEntries)&&Ae(p.ledgerEntries),Array.isArray(p.receipts)&&z(p.receipts),Array.isArray(p.creditNotes)&&te(p.creditNotes),Array.isArray(p.notifications)&&ue(p.notifications),Array.isArray(p.followups)&&Re(p.followups),p.openingBalances&&typeof p.openingBalances=="object"&&!Array.isArray(p.openingBalances)&&$s(p.openingBalances),p.mailerImages&&typeof p.mailerImages=="object"&&!Array.isArray(p.mailerImages)&&Di(p.mailerImages),p.partyMaster&&typeof p.partyMaster=="object"&&!Array.isArray(p.partyMaster)&&fc(p.partyMaster),p.userPasswords&&typeof p.userPasswords=="object"&&!Array.isArray(p.userPasswords)&&x(p.userPasswords),p.mailerLogo&&ya(p.mailerLogo),p.companyConfig&&b(T=>({...T,...p.companyConfig,name:"Indreesh Media LLP",bank:{...p.companyConfig.bank||T.bank,holder:"Indreesh Media LLP"}})),p.nextInvoiceNo&&Se(p.nextInvoiceNo),p.nextCombineNo&&Q(p.nextCombineNo),p.nextReceiptNo&&xt(p.nextReceiptNo),p.nextCreditNoteNo&&dt(p.nextCreditNoteNo),p.nextServiceInvoiceNo&&ar(p.nextServiceInvoiceNo),p.invoiceValues&&ju(p.invoiceValues),p.whatsappSettings&&Vn(T=>({...T,...p.whatsappSettings})),setTimeout(()=>{Xs.current=!1},500),console.log("Real-time sync: Data updated from Firebase"))}),()=>{Ys.current&&(Ys.current(),Ys.current=null)}},[t]);const lr=r==="finance",Vr=r==="director",gl=ye.useMemo(()=>{const p=new Set;return un.forEach(T=>{T.partyName&&p.add(T.partyName)}),Object.values(Br).forEach(T=>{T.partyName&&p.add(T.partyName)}),Nt.forEach(T=>{T.partyName&&p.add(T.partyName)}),Object.keys(Ss).forEach(T=>{T&&p.add(T)}),Array.from(p).filter(Boolean).sort()},[un,Br,Nt,Ss]),Mi=ye.useMemo(()=>{const p=[],T=new Set,H=new Set,W=L=>{if(!L)return"";const q=L.toUpperCase().trim();return q.includes("MAHARASHTRA")||q==="MH"||q.includes("MUMBAI")?"MAHARASHTRA":q.includes("DELHI")||q==="DL"||q.includes("NEW DELHI")?"DELHI":q.includes("KARNATAKA")||q==="KA"||q.includes("BANGALORE")||q.includes("BENGALURU")?"KARNATAKA":q.includes("TAMIL")||q==="TN"||q.includes("CHENNAI")?"TAMIL NADU":q.includes("TELANGANA")||q==="TG"||q==="TS"||q.includes("HYDERABAD")?"TELANGANA":q.includes("UTTAR PRADESH")||q==="UP"||q.includes("NOIDA")||q.includes("LUCKNOW")?"UTTAR PRADESH":q.includes("WEST BENGAL")||q==="WB"||q.includes("KOLKATA")?"WEST BENGAL":q.includes("GUJARAT")||q==="GJ"||q.includes("AHMEDABAD")?"GUJARAT":q.includes("RAJASTHAN")||q==="RJ"||q.includes("JAIPUR")?"RAJASTHAN":q.includes("PUNJAB")||q==="PB"?"PUNJAB":q.includes("HARYANA")||q==="HR"||q.includes("GURGAON")||q.includes("GURUGRAM")?"HARYANA":q.includes("MADHYA PRADESH")||q==="MP"||q.includes("BHOPAL")?"MADHYA PRADESH":q.includes("ANDHRA")||q==="AP"?"ANDHRA PRADESH":q.includes("KERALA")||q==="KL"?"KERALA":q.includes("ODISHA")||q.includes("ORISSA")||q==="OR"||q==="OD"?"ODISHA":q.includes("BIHAR")||q==="BR"?"BIHAR":q.includes("JHARKHAND")||q==="JH"?"JHARKHAND":q.includes("ASSAM")||q==="AS"?"ASSAM":q.includes("CHHATTISGARH")||q==="CG"?"CHHATTISGARH":q.includes("GOA")||q==="GA"?"GOA":q.includes("HIMACHAL")||q==="HP"?"HIMACHAL PRADESH":q.includes("JAMMU")||q==="JK"?"JAMMU AND KASHMIR":q.includes("UTTARAKHAND")||q.includes("UTTARANCHAL")||q==="UK"?"UTTARAKHAND":q.includes("CHANDIGARH")?"CHANDIGARH":q};return Object.entries(Br).forEach(([L,q])=>{if(q.partyName){const Z=q.normalizedState||W(q.stateName),j=q.partyName.trim().toUpperCase(),me=`${j}|${Z}`;T.has(me)||(T.add(me),H.add(j),p.push({partyName:q.partyName,partyNameUpper:j,state:q.stateName||"",normalizedState:Z,gstin:q.gstin||"",address:q.address||"",fromPartyMaster:!0}))}}),un.forEach(L=>{if(L.partyName){const q=L.partyName.trim().toUpperCase(),Z=W(L.statePartyDetails),j=`${q}|${Z}`;T.has(j)||(T.add(j),H.add(q),p.push({partyName:L.partyName,partyNameUpper:q,state:L.statePartyDetails||"",normalizedState:Z,gstin:"",address:"",fromPartyMaster:!1}))}}),Nt.forEach(L=>{if(L.partyName){const q=L.partyName.trim().toUpperCase(),Z=W(L.state||L.statePartyDetails||""),j=`${q}|${Z}`;T.has(j)||(T.add(j),H.add(q),p.push({partyName:L.partyName,partyNameUpper:q,state:L.state||L.statePartyDetails||"",normalizedState:Z,gstin:"",address:"",fromPartyMaster:!1}))}}),Object.keys(Ss).forEach(L=>{const q=L.trim().toUpperCase();L&&!H.has(q)&&(H.add(q),p.push({partyName:L,partyNameUpper:q,state:"",normalizedState:"",gstin:"",address:"",fromPartyMaster:!1}))}),Ks.forEach(L=>{if(L.partyName){const q=L.partyName.trim().toUpperCase(),Z=W(L.statePartyDetails),j=`${q}|${Z}`;T.has(j)||(T.add(j),H.add(q),p.push({partyName:L.partyName,partyNameUpper:q,state:L.statePartyDetails||"",normalizedState:Z,gstin:L.gstin||"",address:L.address||"",fromPartyMaster:!1}))}}),p.sort((L,q)=>L.partyName.localeCompare(q.partyName))},[un,Ks,Br,Nt,Ss]);ye.useMemo(()=>[...new Set(un.filter(T=>T.combinationCode&&T.combinationCode!=="NA").map(T=>T.combinationCode))].sort((T,H)=>parseInt(T)-parseInt(H)),[un]);const gc=ye.useMemo(()=>un.filter(p=>{var T,H,W,L,q,Z;if(pt.party&&p.partyName!==pt.party||pt.billStatus&&p.toBeBilled!==pt.billStatus||pt.invoiceStatus&&(pt.invoiceStatus==="Generated"&&!p.invoiceGenerated||pt.invoiceStatus==="Not Generated"&&p.invoiceGenerated||pt.invoiceStatus==="Paid"&&p.invoiceStatus!=="Paid")||pt.mailingStatus&&p.mailingSent!==pt.mailingStatus||pt.invoiceType&&p.invoiceType!==pt.invoiceType||pt.combinationCode&&p.combinationCode!==pt.combinationCode)return!1;if(pt.searchText){const j=pt.searchText.toLowerCase();if(!(((T=p.senderName)==null?void 0:T.toLowerCase().includes(j))||((H=p.subject)==null?void 0:H.toLowerCase().includes(j))||((W=p.campaignName)==null?void 0:W.toLowerCase().includes(j))||((L=p.invoiceNo)==null?void 0:L.toLowerCase().includes(j))||((q=p.partyName)==null?void 0:q.toLowerCase().includes(j))||((Z=p.emailId)==null?void 0:Z.toLowerCase().includes(j))))return!1}return!0}),[un,pt]);ye.useMemo(()=>{const p={};return gc.forEach(T=>{p[T.partyName]||(p[T.partyName]=[]),p[T.partyName].push(T)}),Object.keys(p).forEach(T=>{p[T].sort((H,W)=>H.toBeBilled==="Yes"&&W.toBeBilled!=="Yes"?-1:H.toBeBilled!=="Yes"&&W.toBeBilled==="Yes"?1:0)}),p},[gc]),ye.useMemo(()=>{if(!Y)return[];const p=Ss[Y]||0;let T=p;const H=Nt.filter(W=>qt(W.partyName,Y)).sort((W,L)=>new Date(W.date)-new Date(L.date)).map(W=>(T=T+W.debit-W.credit,{...W,balance:T}));return p!==0?[{id:"opening",date:"",particulars:"Opening Balance",debit:p>0?p:0,credit:p<0?Math.abs(p):0,balance:p,isOpening:!0},...H]:H},[Y,Nt,Ss]);const n0=p=>un.filter(T=>qt(T.partyName,p)&&T.toBeBilled==="Yes"&&!T.invoiceGenerated&&T.invoiceAmount),mc=p=>!p||p==="NA"?!1:un.some(T=>T.combinationCode===p&&T.mailingSent==="Yes"),Ur=p=>p.invoiceType==="Combined"&&p.combinationCode!=="NA"?un.filter(T=>T.combinationCode===p.combinationCode):[p],i0=()=>{Zi({party:"",billStatus:"",invoiceStatus:"",mailingStatus:"",invoiceType:"",combinationCode:"",searchText:""})},xc=Object.values(pt).some(p=>p!==""),es=p=>{const T=[];return p.emailId&&T.push(p.emailId),p.additionalEmails&&p.additionalEmails.length>0&&T.push(...p.additionalEmails),T},f=(p,T)=>{!T||!T.includes("@")||Ie(H=>H.map(W=>{if(W.id===p){const L=W.additionalEmails||[];if(!L.includes(T)&&T!==W.emailId)return{...W,additionalEmails:[...L,T]}}return W}))},v=(p,T)=>{Ie(H=>H.map(W=>W.id===p?{...W,additionalEmails:(W.additionalEmails||[]).filter(L=>L!==T)}:W))},C=p=>{br(p),Ei(p.editComments||p.approvalRemarks||""),Hs({particularsApproved:p.particularsApproved||!1,emailApproved:p.emailApproved||!1,invoiceTypeApproved:p.invoiceTypeApproved||!1}),hr(!0)},O=()=>{if(!ae)return;if(!va.particularsApproved||!va.emailApproved||!va.invoiceTypeApproved){alert("Please confirm all approval checkboxes before approving.");return}const p={invoiceStatus:"Approved",approvalRemarks:zs.trim()||"",editComments:"",particularsApproved:!0,emailApproved:!0,invoiceTypeApproved:!0,approvedBy:r,approvedDate:new Date().toISOString()};let T=[];ae.invoiceType==="Combined"&&ae.combinationCode!=="NA"?(T=_e.filter(Z=>Z.combinationCode===ae.combinationCode),Ie(Z=>Z.map(j=>j.combinationCode===ae.combinationCode?{...j,...p}:j))):(T=[ae],Ie(Z=>Z.map(j=>j.id===ae.id?{...j,...p}:j)));const H=parseFloat(ae.invoiceTotalAmount)||0,W=T.map(Z=>{var j,me;return Z.senderName||((me=(j=Z.campaignName)==null?void 0:j.split("--")[0])==null?void 0:me.trim())}).join(", "),L=`${ae.invoiceNo} - ${W}`;Ae(Z=>[...Z,{id:Date.now(),partyName:ae.partyName,date:ae.invoiceDate,particulars:"Promotional Trade Mailer",narration:L,debit:H,credit:0,type:"invoice",invoiceNo:ae.invoiceNo,combinationCode:ae.combinationCode}]);const q=zs.trim()?` | Remarks: "${zs.trim()}"`:"";Ts("approval",` Invoice ${ae.invoiceNo} has been APPROVED by Director${q} - ready for mailing`,"finance"),hr(!1),br(null),Hs({particularsApproved:!1,emailApproved:!1,invoiceTypeApproved:!1}),Ei(""),alert(` Invoice Approved!

The invoice is now ready for mailing.`)},se=()=>{if(!ae)return;const p=zs.trim();ae.invoiceType==="Combined"&&ae.combinationCode!=="NA"?Ie(H=>H.map(W=>W.combinationCode===ae.combinationCode?{...W,invoiceStatus:"Need Edits",editComments:p,approvalRemarks:""}:W)):Ie(H=>H.map(W=>W.id===ae.id?{...W,invoiceStatus:"Need Edits",editComments:p,approvalRemarks:""}:W));const T=p?`: "${p}"`:"";Ts("edit",` Invoice ${ae.invoiceNo} marked as NEED EDITS by Director${T}`,"finance"),hr(!1),br(null),Ei("")},he=p=>{br(p);const T=parseFloat(p.invoiceTotalAmount)||0;yn({amount:T.toFixed(2),tds:"",discount:"",narration:"",paymentAdvisory:null,date:new Date().toISOString().split("T")[0],mode:"Bank"}),Za(!0)},Ue=()=>{if(!ae||!vt.amount){alert("Please enter receipt amount");return}if(ae.invoiceStatus!=="Approved"){alert("Receipt cannot be posted. Invoice must be approved first.");return}if(!ae.isHistorical&&ae.mailingSent!=="Yes"){alert("Receipt cannot be posted. Invoice must be mailed first.");return}const p=`RCP/${new Date().getFullYear()}-${String(new Date().getFullYear()+1).slice(-2)}/${Rt}`,T=parseFloat(vt.amount)||0,H=parseFloat(vt.tds)||0,W=parseFloat(vt.discount)||0,L=T+H+W,q=Ur(ae),Z=q.map(Me=>Me.subject||Me.senderName).join(", "),j=Z.length>50?Z.substring(0,47)+"...":Z,me={id:Date.now(),receiptNo:p,invoiceNo:ae.invoiceNo,partyName:ae.partyName,date:vt.date,amount:T,tds:H,discount:W,totalCredit:L,narration:vt.narration,paymentAdvisory:vt.paymentAdvisory,mode:vt.mode,campaigns:q.map(Me=>({senderName:Me.senderName,subject:Me.subject}))};z(Me=>[...Me,me]);const ie=vt.narration||j;T>0&&Ae(Me=>[...Me,{id:Date.now(),partyName:ae.partyName,date:vt.date,particulars:`Payment Received - ${ie}`,narration:`${ae.invoiceNo} | ${vt.mode}`,debit:0,credit:T,type:"receipt",receiptNo:p,invoiceNo:ae.invoiceNo,paymentAdvisory:vt.paymentAdvisory}]),H>0&&Ae(Me=>[...Me,{id:Date.now()+1,partyName:ae.partyName,date:vt.date,particulars:"TDS Deducted",narration:`Against ${ae.invoiceNo}`,debit:0,credit:H,type:"tds",receiptNo:p,invoiceNo:ae.invoiceNo}]),W>0&&Ae(Me=>[...Me,{id:Date.now()+2,partyName:ae.partyName,date:vt.date,particulars:"Discount Given",narration:`Against ${ae.invoiceNo}`,debit:0,credit:W,type:"discount",receiptNo:p,invoiceNo:ae.invoiceNo}]);const pe=parseFloat(ae.invoiceTotalAmount)||0,de=ne.find(Me=>Me.invoiceNo===ae.invoiceNo),ee=de?Math.abs(parseFloat(de.totalAmount)||0):0,xe=pe-L-ee<=0;ae.invoiceType==="Combined"&&ae.combinationCode!=="NA"?Ie(Me=>Me.map(Xe=>Xe.combinationCode===ae.combinationCode?{...Xe,receiptStatus:xe?"Closed":"Received",receiptNo:p,receiptDate:vt.date}:Xe)):ae.isHistorical||Ie(Me=>Me.map(Xe=>Xe.id===ae.id?{...Xe,receiptStatus:xe?"Closed":"Received",receiptNo:p,receiptDate:vt.date}:Xe)),xt(Me=>Me+1),Ts("receipt",` Payment received for ${ae.partyName} - Receipt ${p} - ${et(L)}`,"director"),Za(!1),br(null),yn({amount:"",tds:"",discount:"",narration:"",paymentAdvisory:null,date:new Date().toISOString().split("T")[0],mode:"Bank"}),alert(` Receipt Created!

Receipt No: ${p}
Amount: ${et(L)}`)},Jt=p=>{br(p),_s({amount:"",tds:"",discount:"",reason:"",date:new Date().toISOString().split("T")[0]}),xs(!0)},fn=()=>{var Me;if(!ae||!Yt.amount&&!Yt.gst||!Yt.reason){alert("Please enter Amount and/or GST and reason");return}const p=ae.invoiceNo.match(/(\d{4}-\d{2})/),T=p?p[1]:`${new Date().getFullYear()}-${String(new Date().getFullYear()+1).slice(-2)}`,H=ae.invoiceNo.split("/").pop(),W=`CN/${T}/${H}`,L=parseFloat(Yt.amount)||0,q=parseFloat(Yt.gst)||0,Z=L+q,me=((Me=ae.statePartyDetails)==null?void 0:Me.toUpperCase().includes("MAHARASHTRA"))?"CGST/SGST":"IGST",ie={id:Date.now(),creditNoteNo:W,invoiceNo:ae.invoiceNo,partyName:ae.partyName,date:Yt.date,amount:L,gst:q,gstType:me,totalAmount:Z,reason:Yt.reason};te(Xe=>[...Xe,ie]);const pe=parseFloat(ae.invoiceTotalAmount)||0,de=Oe.find(Xe=>Xe.invoiceNo===ae.invoiceNo),ee=de?parseFloat(de.amount)+parseFloat(de.tds||0)+parseFloat(de.discount||0):0,Ke=Z>=pe-ee;ae.isHistorical||Ie(Xe=>Xe.map(Qe=>Qe.invoiceNo===ae.invoiceNo?{...Qe,creditNoteNo:W,receiptStatus:Ke?"Cancelled":Qe.receiptStatus}:Qe)),dt(Xe=>Xe+1),xs(!1),br(null),_s({amount:"",gst:"",reason:"",date:new Date().toISOString().split("T")[0]});let xe=` Credit Note Created!

Credit Note No: ${W}`;L>0&&(xe+=`
Base Amount: ${et(L)}`),q>0&&(xe+=`
${me}: ${et(q)}`),xe+=`
Total: ${et(Z)}`,Ke&&(xe+=`

 Invoice fully covered by CN - marked as Cancelled`),alert(xe)},Ot=p=>{var W;const T=(W=p.target.files)==null?void 0:W[0];if(!T)return;const H=new FileReader;H.onload=L=>{yn(q=>({...q,paymentAdvisory:L.target.result}))},H.readAsDataURL(T),p.target.value=""},Qr=p=>{br(p),li(!0)},_n=()=>{if(!ae)return;const p=ae.invoiceNo;ae.invoiceType==="Combined"&&ae.combinationCode!=="NA"?Ie(W=>W.map(L=>L.combinationCode===ae.combinationCode?{...L,invoiceNo:"",invoiceDate:"",invoiceTotalAmount:"",invoiceGenerated:!1,invoiceStatus:"Pending",invoiceType:"Individual",combinationCode:"NA",mailingSent:"No",mailDate:"",editComments:"",receiptStatus:"",receiptNo:"",receiptDate:""}:L)):Ie(W=>W.map(L=>L.id===ae.id?{...L,invoiceNo:"",invoiceDate:"",invoiceTotalAmount:"",invoiceGenerated:!1,invoiceStatus:"Pending",invoiceType:"Individual",combinationCode:"NA",mailingSent:"No",mailDate:"",editComments:"",receiptStatus:"",receiptNo:"",receiptDate:""}:L)),Ae(W=>W.filter(L=>L.invoiceNo!==p));const T=Oe.filter(W=>W.invoiceNo===p);T.length>0&&z(W=>W.filter(L=>L.invoiceNo!==p)),li(!1),br(null);const H=T.length>0?`
${T.length} receipt(s) also deleted.`:"";alert(` Invoice ${p} deleted.${H}

You can now regenerate the invoice.`)},co=p=>{confirm(`Delete Receipt ${p.receiptNo}?

This will also update the invoice status back to Pending.`)&&(z(T=>T.filter(H=>H.id!==p.id)),Ie(T=>T.map(H=>H.invoiceNo===p.invoiceNo?{...H,receiptStatus:"",receiptNo:"",receiptDate:""}:H)),alert(` Receipt ${p.receiptNo} deleted.`))},Li=p=>{confirm(`Delete Credit Note ${p.creditNoteNo}?

This will remove the CN association from the invoice.`)&&(te(T=>T.filter(H=>H.id!==p.id)),Ie(T=>T.map(H=>H.invoiceNo===p.invoiceNo?{...H,creditNoteNo:""}:H)),alert(` Credit Note ${p.creditNoteNo} deleted.`))},vc=p=>{confirm(`Delete historical entry?

Vch No: ${p.vchNo||"N/A"}
Amount: ${p.debit||p.credit}

This action cannot be undone.`)&&(Ae(T=>T.filter(H=>H.id!==p.id)),alert(" Historical entry deleted."))},$u=()=>{if(!Y||!confirm(`Delete ALL historical entries for "${Y}"?

This will remove all imported historical data for this party.`))return;const p=re.filter(T=>qt(T.partyName,Y)&&T.isHistorical).length;Ae(T=>T.filter(H=>!(qt(H.partyName,Y)&&H.isHistorical))),alert(` ${p} historical entries deleted for ${Y}.`)},$4=p=>{Lt(p),ci({date:new Date().toISOString().split("T")[0],notes:"",nextFollowupDate:"",status:"Pending"}),nt(!0)},G4=()=>{var T,H;if(!ot)return;const p={id:Date.now(),invoiceNo:ot.invoiceNo,partyName:ot.partyName,invoiceDate:ot.invoiceDate||ot.date,invoiceAmount:ot.invoiceTotalAmount||ot.totalAmount,subject:((H=(T=ot.campaigns)==null?void 0:T[0])==null?void 0:H.subject)||ot.subject||"",followupDate:kt.date,notes:kt.notes,nextFollowupDate:kt.nextFollowupDate,status:kt.status};Re(W=>[...W,p]),nt(!1),Lt(null),Ts("followup",`Followup added for ${ot.invoiceNo}`,"all"),alert(` Followup recorded for ${ot.invoiceNo}`)},K4=p=>{confirm("Delete this followup entry?")&&Re(T=>T.filter(H=>H.id!==p))},X4=p=>{var j,me;const T=p.subject||((me=(j=p.campaigns)==null?void 0:j[0])==null?void 0:me.subject)||"",H=p.partyName,W=p.invoiceNo,L=et(p.invoiceTotalAmount||p.totalAmount||0),q=Vt(p.invoiceDate||p.date);return`Subject: RE: ${T} - Payment Followup for Invoice ${W}

Dear Sir/Madam,

Greetings from ${w.name}!

This is a gentle reminder regarding the outstanding payment for:

Invoice No: ${W}
Invoice Date: ${q}
Amount: ${L}
Party: ${H}

We kindly request you to process the payment at the earliest. If the payment has already been made, please share the payment details for our records.

For any queries, please feel free to reach out.

Thanks & Regards,
Finance Team
${w.name}
Email: ${w.email}
Phone: ${w.phone}`},oy=p=>{const T=X4(p);navigator.clipboard.writeText(T),alert(" Followup email template copied to clipboard!")},ly=p=>{var W,L;const T=p.subject||((L=(W=p.campaigns)==null?void 0:W[0])==null?void 0:L.subject)||"",H=encodeURIComponent(T);window.open(`https://mail.google.com/mail/u/0/#search/${H}`,"_blank")},Y4=p=>{var W;const T=(W=p.target.files)==null?void 0:W[0];if(!T)return;const H=new FileReader;H.onload=L=>{const q=Wc(L.target.result,{type:"binary"}),Z=q.SheetNames[0],j=q.Sheets[Z],me=Rr.sheet_to_json(j),ie={};me.forEach(pe=>{const de=pe["Party Name"]||pe["PARTY NAME"]||pe.PartyName||"",ee=parseFloat(pe.Amount||pe.AMOUNT||pe["Invoice Amount"]||0);de&&ee>0&&(ie[de.trim()]=ee)}),ju(pe=>({...pe,...ie})),alert(` Loaded ${Object.keys(ie).length} party invoice values!`)},H.readAsBinaryString(T),p.target.value=""},q4=()=>{const p=Rr.json_to_sheet([{"Party Name":"ABC Group Private Limited",Amount:5500},{"Party Name":"XYZ Media Pvt Ltd",Amount:7500}]),T=Rr.book_new();Rr.book_append_sheet(T,p,"Invoice Values"),Ac(T,"Invoice_Values_Template.xlsx")},Q4=p=>{var W;const T=(W=p.target.files)==null?void 0:W[0];if(!T)return;const H=new FileReader;H.onload=L=>{const q=Wc(L.target.result,{type:"binary"}),Z=q.SheetNames[0],j=q.Sheets[Z],me=Rr.sheet_to_json(j),ie={...qr};let pe=0;me.forEach(de=>{const ee=(de["Name of Ledger"]||de["Party Name"]||de["NAME OF LEDGER"]||de["PARTY NAME"]||"").trim(),Ke=(de["State Name"]||de["STATE NAME"]||de.State||de.STATE||"").trim(),xe=(de.Address||de.ADDRESS||de["Party Address"]||de["PARTY ADDRESS"]||"").trim();if(ee){const Me=jr(Ke),Xe=`${ee.toUpperCase()}|${Me}`;ie[Xe]={partyName:ee,partyNameUpper:ee.toUpperCase(),ledgerGroup:de["Ledger Group"]||de["LEDGER GROUP"]||"Sundry Debtors",stateName:Ke,normalizedState:Me,gstRegType:de["GST Registration Type"]||de["GST REGISTRATION TYPE"]||"Regular",gstin:(de["GSTIN/UIN"]||de.GSTIN||de.GST||"").trim(),address:xe},pe++}}),fc(ie),alert(` Party Master Updated!

${pe} party-state combinations loaded.`)},H.readAsBinaryString(T),p.target.value=""},J4=()=>{const p=Rr.json_to_sheet([{"Sl. No.":1,"Name of Ledger":"ABC PRIVATE LIMITED",Address:"123 Business Park, Andheri East","Ledger Group":"Sundry Debtors","State Name":"Maharashtra","GST Registration Type":"Regular","GSTIN/UIN":"27AAACA1234A1ZQ"},{"Sl. No.":2,"Name of Ledger":"XYZ MEDIA PVT LTD",Address:"456 Media Tower, Connaught Place","Ledger Group":"Sundry Debtors","State Name":"Delhi","GST Registration Type":"Regular","GSTIN/UIN":"07AAACX5678B1ZR"}]),T=Rr.book_new();Rr.book_append_sheet(T,p,"Party Master"),Ac(T,"Party_Master_Template.xlsx")},Z4=p=>{var W;const T=(W=p.target.files)==null?void 0:W[0];if(!T)return;if(!Y){alert(" Please select a party first from the list, then import their historical ledger."),p.target.value="";return}const H=new FileReader;H.onload=L=>{const q=Wc(L.target.result,{type:"binary",cellDates:!0}),Z=q.SheetNames[0],j=q.Sheets[Z],me=Rr.sheet_to_json(j,{raw:!1}),ie=[];let pe=0,de=null;const ee=xe=>{if(!xe)return 0;const Me=String(xe).replace(/,/g,"").replace(/[^\d.-]/g,"");return parseFloat(Me)||0},Ke=xe=>{if(!xe||typeof xe!="string")return"";const Me=xe.trim(),Xe=Me.split(/[-\/]/);if(Xe.length===3){const Qe={jan:"01",feb:"02",mar:"03",apr:"04",may:"05",jun:"06",jul:"07",aug:"08",sep:"09",oct:"10",nov:"11",dec:"12"},yt=Xe[1].toLowerCase().substring(0,3);if(Qe[yt]){const Bt=Xe[0].padStart(2,"0");return`${Xe[2].length===2?parseInt(Xe[2])>50?"19"+Xe[2]:"20"+Xe[2]:Xe[2]}-${Qe[yt]}-${Bt}`}}return Me};me.forEach((xe,Me)=>{const Xe=Ke(xe.Date||xe.DATE||xe.date||""),Qe=(xe.Particular||xe.PARTICULAR||xe.Particulars||xe.PARTICULARS||"").trim(),yt=(xe["Vch Type"]||xe["VCH TYPE"]||xe["Voucher Type"]||xe["vch type"]||"").trim(),Bt=(xe["Vch No."]||xe["VCH NO."]||xe["Voucher No"]||xe["Invoice No"]||xe["Vch No"]||xe["vch no."]||"").trim(),Ht=ee(xe.Debit||xe.DEBIT||xe.debit),He=ee(xe.Credit||xe.CREDIT||xe.credit),_t=xe["Date of Receipt"]||xe["DATE OF RECEIPT"]||xe["Receipt Date"]||"",cr=ee(xe["Amount Received"]||xe["AMOUNT RECEIVED"]||xe["amount received"]),jt=ee(xe["TDS amount Received"]||xe["TDS Received"]||xe.TDS||xe.tds),$t=ee(xe.Balance||xe.BALANCE||xe.balance),uo=(xe["Payment Status"]||xe["PAYMENT STATUS"]||xe.Status||xe.status||"").trim();if(!Xe&&(Qe.toUpperCase().includes("PROMOTIONAL")||Qe.toUpperCase().includes("IGST")||Qe.toUpperCase().includes("CGST")||Qe.toUpperCase().includes("SGST")||Qe.toUpperCase().includes("TRADE EMAILER"))&&de)de.subRows||(de.subRows=[]),de.subRows.push({particular:Qe,debit:Ht,credit:He});else if(Xe&&(Bt||Ht>0||He>0)){de&&(ie.push(de),pe++);let Le="invoice";yt.toLowerCase().includes("credit note")||Bt.toUpperCase().startsWith("CN")?Le="creditnote":yt.toLowerCase().includes("receipt")?Le="receipt":(yt.toLowerCase().includes("sale")||Ht>0)&&(Le="invoice"),de={id:Date.now()+Me,partyName:Y,date:Xe,particulars:Qe||Y,narration:Bt,vchType:yt||"Sales",vchNo:Bt,debit:Ht,credit:He,receiptDate:_t,amountReceived:cr,tdsReceived:jt,balance:$t,paymentStatus:uo,type:Le,isHistorical:!0,subRows:[]}}}),de&&(ie.push(de),pe++),console.log("Parsed entries with sub-rows:",ie),pe>0?(Ae(xe=>[...xe,...ie]),alert(` Historical Ledger Uploaded!

${pe} entries added for "${Y}".`)):alert(` No valid ledger entries found in the file.

Make sure your file has these columns:
 Date (e.g., 02-Jun-21)
 Vch Type (e.g., Sales, Credit Note)
 Vch No. (e.g., MB/2022-23/128)
 Debit or Credit amount`)},H.readAsBinaryString(T),p.target.value="",Pi(!1)},eF=()=>{const p=Rr.json_to_sheet([{Date:"02-Jun-21",Particular:"ABC Corp Ltd.","Vch Type":"Sales","Vch No.":"MB/2020-21/0411",Debit:6e3,Credit:"","Date of Receipt":"","Amount Received":44371,"TDS amount Received":5880,Balance:"","Payment Status":"Received"},{Date:"",Particular:"PROMOTIONAL TRADE EMAILERS","Vch Type":"","Vch No.":"",Debit:"",Credit:22500,"Date of Receipt":"","Amount Received":"","TDS amount Received":"",Balance:"","Payment Status":""},{Date:"",Particular:"IGST","Vch Type":"","Vch No.":"",Debit:"",Credit:4050,"Date of Receipt":"","Amount Received":"","TDS amount Received":"",Balance:"","Payment Status":""},{Date:"26-Mar-25",Particular:"ABC Corp Ltd.","Vch Type":"Credit Note","Vch No.":"CN/2022-23/128",Debit:"",Credit:26550,"Date of Receipt":"","Amount Received":"","TDS amount Received":"",Balance:"","Payment Status":""}]),T=Rr.book_new();Rr.book_append_sheet(T,p,"Historical Ledger"),Ac(T,"Historical_Ledger_Template.xlsx")},tF=p=>{const T=_e.find(H=>H.invoiceNo===p);T?Gu(T):alert("Invoice not found in system. This may be a historical entry.")},rF=p=>{_e.find(H=>H.invoiceNo===p.invoiceNo);let T=` RECEIPT DETAILS

`;T+=`Receipt No: ${p.receiptNo}
`,T+=`Date: ${Vt(p.date)}
`,T+=`Party: ${p.partyName}
`,T+=`Invoice: ${p.invoiceNo}

`,T+=`
`,T+=`Amount Received: ${et(p.amount||0)}
`,T+=`TDS: ${et(p.tds||0)}
`,T+=`Discount: ${et(p.discount||0)}
`,T+=`
`,T+=`Total: ${et((p.amount||0)+(p.tds||0)+(p.discount||0))}
`,p.remarks&&(T+=`
Remarks: ${p.remarks}`),alert(T)},nF=p=>{let T=` CREDIT NOTE DETAILS

`;T+=`Credit Note No: ${p.creditNoteNo}
`,T+=`Date: ${Vt(p.date)}
`,T+=`Party: ${p.partyName}
`,T+=`Against Invoice: ${p.invoiceNo}

`,T+=`
`,T+=`Base Amount: ${et(p.amount||0)}
`,T+=`${p.gstType||"GST"}: ${et(p.gst||0)}
`,T+=`
`,T+=`Total Credit: ${et(p.totalAmount||(p.amount||0)+(p.gst||0))}
`,p.reason&&(T+=`
Reason: ${p.reason}`),alert(T)},iF=p=>{var W;const T=(W=p.target.files)==null?void 0:W[0];if(!T)return;const H=new FileReader;H.onload=L=>{const q=Wc(L.target.result,{type:"binary",cellDates:!0}),Z=q.SheetNames[0],j=q.Sheets[Z],me=Rr.sheet_to_json(j,{raw:!1}),ie=new Set(un.map(xe=>`${xe.date}|${xe.time||""}|${xe.campaignName||""}|${xe.subject}`.toLowerCase()));let pe=0,de=0;const ee=me.map((xe,Me)=>{const Xe=xe["CAMPAIGN NAME"]||xe["Campaign Name"]||"",Qe=gH(Xe);let yt=xe.DATE||xe.Date||new Date;typeof yt=="string"&&(yt=new Date(yt));const Bt=(xe["PARTY NAME"]||xe["Party Name"]||"").trim(),Ht=xe["SENDER NAME"]||xe["Sender Name"]||"",He=xe.SUBJECT||xe.Subject||"",_t=xe.TIME||xe.Time||"",cr=Gs[Bt]||"",jt=yt instanceof Date&&!isNaN(yt)?yt.toISOString().split("T")[0]:"",$t=`${jt}|${_t}|${Xe}|${He}`.toLowerCase();return ie.has($t)?(pe++,null):(ie.add($t),de++,{id:Date.now()+Me+Math.random(),sno:xe.SNO||xe["SNO."]||xe.Sno||Me+1,date:jt,month:xe.Month||xe.MONTH||"",statePartyDetails:xe["State/Party Details"]||xe["STATE/PARTY DETAILS"]||"",partyName:Bt,senderName:Ht,campaignName:Xe,subject:He,emailId:Qe,additionalEmails:[],toBeBilled:"Not Yet",invoiceAmount:cr,cgst:"",sgst:"",igst:"",totalWithGst:"",invoiceType:"Individual",combinationCode:"NA",invoiceNo:"",invoiceDate:"",invoiceTotalAmount:"",invoiceGenerated:!1,invoiceStatus:"Pending",mailingSent:"No",mailerUploaded:!1,editComments:""})}).filter(xe=>xe!==null);if(ee.length>0){Ie(Me=>[...Me,...ee]);const xe=[...new Set(ee.map(Me=>Me.partyName))];dc(Me=>{const Xe=new Set(Me);return xe.forEach(Qe=>Xe.add(Qe)),Xe})}let Ke=` Upload Complete!

`;Ke+=` ${de} new campaigns added
`,pe>0&&(Ke+=` ${pe} duplicate entries skipped`),de>0&&Ts("upload",` ${de} new campaigns uploaded to Master Sheet`,"director"),alert(Ke)},H.readAsBinaryString(T),p.target.value=""},sF=async()=>{Ie([]),we([]),Ae([]),z([]),te([]),Di({}),$s({}),Se(1),Q(1),xt(1),dt(1),ar(1),ge(null),Pe(null),dc(new Set),Re([]),fc({}),ue([]);try{await om("indreesh-media",{masterData:[],servicesData:[],ledgerEntries:[],receipts:[],creditNotes:[],openingBalances:{},mailerImages:{},mailerLogo:ln,companyConfig:w,nextInvoiceNo:1,nextCombineNo:1,nextReceiptNo:1,nextCreditNoteNo:1,nextServiceInvoiceNo:1,invoiceValues:Gs,notifications:[],whatsappSettings:ht,partyMaster:{},followups:[],userPasswords:y}),console.log("Data cleared and saved to Firebase")}catch(p){console.error("Error clearing data:",p)}vs(!1),alert(" All master data, invoices, receipts, and ledger entries have been cleared!")},cy=p=>{var W;const T=parseFloat(p.invoiceAmount)||0;if((W=p.statePartyDetails)==null?void 0:W.toUpperCase().includes("MAHARASHTRA")){const L=T*.09,q=T*.09;return{cgst:L,sgst:q,igst:0,total:T+L+q}}else{const L=T*.18;return{cgst:0,sgst:0,igst:L,total:T+L}}},aF=(p,T)=>{const H=_e.find(W=>W.id===p);Ie(W=>W.map(L=>{if(L.id===p){if(T==="Yes"&&L.invoiceAmount){const q=cy(L);return{...L,toBeBilled:T,cgst:q.cgst.toFixed(2),sgst:q.sgst.toFixed(2),igst:q.igst.toFixed(2),totalWithGst:q.total.toFixed(2)}}return{...L,toBeBilled:T}}return L})),T==="Yes"&&H&&Ts("info",` Campaign marked for billing: ${H.partyName} - ${H.senderName}`,"finance")},s0=(p,T,H)=>{Ie(W=>W.map(L=>{if(L.id===p){const q={...L,[T]:H};if(T==="invoiceAmount"&&L.toBeBilled==="Yes"){const Z=cy(q);return{...q,cgst:Z.cgst.toFixed(2),sgst:Z.sgst.toFixed(2),igst:Z.igst.toFixed(2),totalWithGst:Z.total.toFixed(2)}}return q}return L}))},oF=p=>{const T=`${w.invoicePrefix}${ke}`,H=new Date().toISOString().split("T")[0],W=parseFloat(p.totalWithGst)||parseFloat(p.invoiceAmount)*1.18;Ie(L=>L.map(q=>q.id===p.id?{...q,invoiceNo:T,invoiceDate:H,invoiceTotalAmount:W.toFixed(2),invoiceGenerated:!0,invoiceStatus:"Created",invoiceType:"Individual",combinationCode:"NA"}:q)),Se(L=>L+1),Ts("invoice",` New Invoice ${T} created for ${p.partyName} - ${et(W)}`,"director"),alert(` Invoice Generated!

Invoice No: ${T}
Amount: ${et(W)}

Please review and Approve or mark as Need Edits.`)},lF=()=>{if(Ji.size<2){alert("Please select at least 2 campaigns to combine");return}const p=`${w.invoicePrefix}${ke}`,T=new Date().toISOString().split("T")[0],H=String(tt);let W=0;const L=_e.filter(q=>Ji.has(q.id));L.forEach(q=>{W+=parseFloat(q.totalWithGst)||parseFloat(q.invoiceAmount)*1.18}),Ie(q=>q.map(Z=>Ji.has(Z.id)?{...Z,invoiceNo:p,invoiceDate:T,invoiceTotalAmount:W.toFixed(2),invoiceGenerated:!0,invoiceStatus:"Created",invoiceType:"Combined",combinationCode:H,mailingSent:"No"}:Z)),Se(q=>q+1),Q(q=>q+1),fr(!1),eo(new Set),Ts("invoice",` Combined Invoice ${p} created for ${uc} (${L.length} campaigns) - ${et(W)}`,"director"),Bu(null),alert(` Combined Invoice Generated!

Invoice No: ${p}
Campaigns: ${Ji.size}
Total: ${et(W)}

Please review and Approve or mark as Need Edits.`)},cF=p=>{eo(T=>{const H=new Set(T);return H.has(p)?H.delete(p):H.add(p),H})},uF=p=>{Bu(p.partyName),eo(new Set([p.id])),fr(!0)},fF=p=>{var W;const T=(W=p.target.files)==null?void 0:W[0];if(!T||!ae)return;const H=new FileReader;H.onload=L=>uy(L.target.result),H.readAsDataURL(T),p.target.value=""},uy=p=>{if(!ae)return;const T=ae.id;Di(Zt?H=>({...H,[T]:[p]}):H=>({...H,[T]:[...H[T]||[],p]})),Ie(H=>H.map(W=>W.id===ae.id?{...W,mailerUploaded:!0}:W)),_a(null),Ea(!1),sn(!1),alert(" Mailer image saved!")},dF=p=>{var H;const T=(H=p.clipboardData)==null?void 0:H.items;if(T){for(let W=0;W<T.length;W++)if(T[W].type.indexOf("image")!==-1){const L=T[W].getAsFile(),q=new FileReader;q.onload=Z=>_a(Z.target.result),q.readAsDataURL(L),p.preventDefault();break}}},hF=p=>{const T=encodeURIComponent(p||"campaign");window.open(`https://mail.google.com/mail/u/0/#search/${T}`,"_blank")},pF=p=>{var W;const T=(W=p.target.files)==null?void 0:W[0];if(!T)return;const H=new FileReader;H.onload=L=>ya(L.target.result),H.readAsDataURL(T),p.target.value=""},fy=p=>{const T=Ur(p);if(T.length>1){const H=T.map(W=>W.senderName).join(", ");return`Invoice ${p.invoiceNo||""} - ${H}`}return`Invoice ${p.invoiceNo||""} - ${p.senderName} - ${p.subject}`},a0=p=>{const T=Ur(p),H=parseFloat(p.invoiceTotalAmount)||parseFloat(p.totalWithGst)||parseFloat(p.invoiceAmount)*1.18;let W="";return T.length>1?(W=`Campaigns included in this invoice:
`,T.forEach((L,q)=>{W+=`${q+1}. ${L.senderName} - ${L.subject}
`})):W=`Campaign: ${p.senderName}
Subject: ${p.subject}`,`Dear Sir/Madam,

Please find attached the invoice for the following:

${W}

Invoice No: ${p.invoiceNo||"To be generated"}
Invoice Amount: ${et(H)}

Kindly process the payment at your earliest convenience.

Bank Details:
Bank: ${w.bank.name}
A/C No: ${w.bank.account}
IFSC: ${w.bank.ifsc}
Branch: ${w.bank.branch}

Thank you for your business.

Best Regards,
${w.name}
${w.email}`},[gF,dy]=ye.useState(!1),[hy,py]=ye.useState(""),gy=p=>{var xe;let T=[p],H=parseFloat(p.invoiceAmount)||0;p.invoiceType==="Combined"&&p.combinationCode!=="NA"&&(T=_e.filter(Me=>Me.combinationCode===p.combinationCode),H=T.reduce((Me,Xe)=>Me+(parseFloat(Xe.invoiceAmount)||0),0));const W=hc(p.partyName,p.statePartyDetails),L=Wu(p.partyName,p.statePartyDetails),q=(xe=p.statePartyDetails)==null?void 0:xe.toUpperCase().includes("MAHARASHTRA"),Z=q?H*.09:0,j=q?H*.09:0,me=q?0:H*.18,ie=Z+j+me,pe=H+ie,de=T.map((Me,Xe)=>`
      <tr>
        <td style="border: 1px solid #000; padding: 8px; text-align: center; font-size: 12px;">${Xe+1}</td>
        <td style="border: 1px solid #000; padding: 8px; font-size: 12px;">
          <div style="font-weight: 600;">PROMOTIONAL TRADE EMAILER</div>
          <div style="font-style: italic; color: #555; font-size: 11px; margin-top: 2px;">${Me.senderName||""} - ${Vt(Me.date)}</div>
          <div style="font-style: italic; color: #555; font-size: 11px;">Subject: ${Me.subject||""}</div>
        </td>
        <td style="border: 1px solid #000; padding: 8px; text-align: center; font-size: 12px;">${w.hsnCode}</td>
        <td style="border: 1px solid #000; padding: 8px; text-align: right; font-size: 12px;">${Dt(parseFloat(Me.invoiceAmount)||0)}</td>
      </tr>
    `).join("");let ee=[];p.invoiceType==="Combined"&&p.combinationCode!=="NA"?T.forEach(Me=>{(wi[Me.id]||[]).forEach(Qe=>ee.push({img:Qe,campaign:Me}))}):(wi[p.id]||[]).forEach(Xe=>ee.push({img:Xe,campaign:p}));const Ke=ee.map(({img:Me,campaign:Xe})=>`
      <div class="page-break-before" style="page-break-before: always; padding: 40px; text-align: center; background: white;">
        ${ln?`<div style="margin-bottom: 20px;"><img src="${ln}" alt="Logo" style="max-height: 70px;" /></div>`:`
          <div style="text-align: center; margin-bottom: 25px;">
            <span style="font-size: 22px; font-weight: bold; color: #2874A6;">${w.name}</span>
          </div>
        `}
        <h2 style="font-size: 20px; text-decoration: underline; margin: 25px 0;">MAILER SUPPORTING</h2>
        <p style="font-size: 15px; margin: 12px 0; text-align: left;"><strong>MAILER DATE:</strong> ${pH(Xe.date)}</p>
        <p style="font-size: 15px; margin: 12px 0; text-align: left;"><strong>CAMPAIGN:</strong> ${Xe.senderName}</p>
        <p style="font-size: 15px; margin: 12px 0; text-align: left;"><strong>SUBJECT:</strong> ${Xe.subject||"Campaign"}</p>
        <div style="margin-top: 25px;"><img src="${Me}" alt="Mailer" style="max-width: 100%; max-height: 550px; border: 1px solid #ddd;" /></div>
      </div>
    `).join("");return`
  <div style="max-width: 900px; margin: 0 auto; padding: 15px; background: white; font-family: Arial, sans-serif; font-size: 12px; line-height: 1.4;">
    <style>
      @media print {
        @page { size: A4; margin: 8mm; }
        body { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
        .page-break-before { page-break-before: always; }
      }
    </style>
    <div style="border: 2px solid #000; background: white;">
      <div style="text-align: center; padding: 12px; font-size: 18px; font-weight: bold; border-bottom: 2px solid #000; background: #f8f8f8;">Tax Invoice</div>
      <div style="text-align: center; font-size: 11px; font-style: italic; padding: 5px; border-bottom: 1px solid #000; background: #fafafa;">(Original for Recipient)</div>
      <div style="display: flex; border-bottom: 2px solid #000;">
        <div style="flex: 1.5; padding: 12px; border-right: 2px solid #000;">
          <div style="font-size: 16px; font-weight: bold; margin-bottom: 8px; color: #1a5276;">${w.name}</div>
          <div style="font-size: 11px; line-height: 1.5; color: #333;">${w.address}<br>${w.addressLine2}<br>${w.city}<br><strong>GSTIN/UIN:</strong> ${w.gstin}<br><strong>State:</strong> ${w.stateName}, Code: ${w.stateCode}<br><strong>Contact:</strong> ${w.phone}<br><strong>E-Mail:</strong> ${w.email}</div>
        </div>
        <div style="flex: 1; font-size: 12px;">
          <div style="display: flex; border-bottom: 1px solid #000;"><div style="flex: 1; padding: 8px; border-right: 1px solid #000; font-weight: bold; background: #f5f5f5;">Invoice No.</div><div style="flex: 1; padding: 8px; font-weight: 600; color: #1a5276;">${p.invoiceNo||""}</div></div>
          <div style="display: flex;"><div style="flex: 1; padding: 8px; border-right: 1px solid #000; font-weight: bold; background: #f5f5f5;">Dated</div><div style="flex: 1; padding: 8px;">${Vt(p.invoiceDate||p.date)}</div></div>
        </div>
      </div>
      <div style="padding: 10px 12px; border-bottom: 2px solid #000; background: #fafafa;">
        <div style="font-size: 11px; color: #666; margin-bottom: 3px;">Buyer (Bill to)</div>
        <div style="font-size: 14px; font-weight: bold; margin-bottom: 4px; color: #1a5276;">${p.partyName}</div>
        <div style="font-size: 11px; color: #333;">${L?L+"<br>":""}${p.statePartyDetails||""}${W?"<br><strong>GSTIN/UIN:</strong> "+W:""}<br>Place of Supply: ${p.statePartyDetails||w.stateName}</div>
      </div>
      <table style="width: 100%; border-collapse: collapse;">
        <thead><tr style="background: #e8e8e8;"><th style="border: 1px solid #000; padding: 10px; width: 45px; font-size: 12px;">Sl No.</th><th style="border: 1px solid #000; padding: 10px; font-size: 12px;">Particulars</th><th style="border: 1px solid #000; padding: 10px; width: 80px; font-size: 12px;">HSN/SAC</th><th style="border: 1px solid #000; padding: 10px; width: 100px; text-align: right; font-size: 12px;">Amount</th></tr></thead>
        <tbody>
          ${de}
          ${T.length>1?'<tr style="background: #f5f5f5;"><td colspan="3" style="border: 1px solid #000; padding: 10px; text-align: right; font-weight: bold; font-size: 13px;">Sub Total</td><td style="border: 1px solid #000; padding: 10px; text-align: right; font-weight: bold; font-size: 13px;">'+Dt(H)+"</td></tr>":""}
          ${q?`<tr><td colspan="3" style="border: 1px solid #000; padding: 8px; text-align: right; font-weight: 600; font-size: 12px;">CGST @ 9%</td><td style="border: 1px solid #000; padding: 8px; text-align: right; font-size: 12px;">${Dt(Z)}</td></tr><tr><td colspan="3" style="border: 1px solid #000; padding: 8px; text-align: right; font-weight: 600; font-size: 12px;">SGST @ 9%</td><td style="border: 1px solid #000; padding: 8px; text-align: right; font-size: 12px;">${Dt(j)}</td></tr>`:`<tr><td colspan="3" style="border: 1px solid #000; padding: 8px; text-align: right; font-weight: 600; font-size: 12px;">IGST @ 18%</td><td style="border: 1px solid #000; padding: 8px; text-align: right; font-size: 12px;">${Dt(me)}</td></tr>`}
          <tr style="background: #2874A6; color: white;"><td colspan="3" style="border: 1px solid #000; padding: 12px; text-align: right; font-weight: bold; font-size: 14px;">Total</td><td style="border: 1px solid #000; padding: 12px; text-align: right; font-weight: bold; font-size: 14px;"> ${pe.toLocaleString("en-IN",{minimumFractionDigits:2})}</td></tr>
        </tbody>
      </table>
      <div style="padding: 10px 12px; border: 1px solid #000; border-top: none; background: #fafafa;"><div style="color: #666; font-size: 11px; margin-bottom: 3px;">Amount Chargeable (in words)</div><div style="font-weight: bold; font-size: 13px;">${K0(pe)}</div></div>
      <div style="display: flex; border-top: 2px solid #000;">
        <div style="flex: 1; padding: 10px 12px; border-right: 2px solid #000; font-size: 11px;"><div><strong>Company's PAN:</strong> ${w.pan}</div><div style="margin-top: 4px;"><strong>MSME Reg. No.:</strong> UDYAM-MH-19-0057219</div></div>
        <div style="flex: 1.2; padding: 10px 12px; font-size: 11px;">
          <div style="font-weight: bold; margin-bottom: 6px; color: #1a5276;">Company's Bank Details</div>
          <div style="line-height: 1.5;"><strong>A/c Holder:</strong> ${w.bank.holder}<br><strong>Bank:</strong> ${w.bank.name}<br><strong>A/c No.:</strong> ${w.bank.account}<br><strong>IFSC:</strong> ${w.bank.ifsc}</div>
          <div style="text-align: right; margin-top: 30px;"><div style="font-weight: bold;">for ${w.name}</div><div style="margin-top: 25px; border-top: 1px solid #000; display: inline-block; padding-top: 4px; font-size: 10px;">Authorised Signatory</div></div>
        </div>
      </div>
      <div style="text-align: center; padding: 8px; background: #f0f0f0; border-top: 1px solid #000; font-size: 10px; color: #666; font-style: italic;">This is a Computer Generated Invoice</div>
    </div>
  </div>
  ${Ke}
`},mF=p=>{const T=gy(p);py(T),br(p),dy(!0)},xF=p=>{const T=`<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Invoice ${p.invoiceNo||""}</title>
  <style>
    @page { size: A4; margin: 10mm; }
    @media print { body { -webkit-print-color-adjust: exact; print-color-adjust: exact; } }
    body { font-family: Arial, sans-serif; margin: 0; padding: 20px; }
  </style>
</head>
<body>
${gy(p)}
<script>
  // Auto-open print dialog when file is opened
  window.onload = function() { 
    setTimeout(function() { window.print(); }, 500); 
  };
<\/script>
</body>
</html>`,H=new Blob([T],{type:"text/html"}),W=URL.createObjectURL(H),L=document.createElement("a");L.href=W,L.download=`Invoice_${(p.invoiceNo||"draft").replace(/\//g,"-")}.html`,document.body.appendChild(L),L.click(),document.body.removeChild(L),URL.revokeObjectURL(W)},Gu=p=>{mF(p)},vF=()=>{const p=parseFloat(_r.amount)||0,T=parseFloat(_r.tds)||0,H=parseFloat(_r.discount)||0,W=p+T+H;let L=parseFloat(ae.invoiceTotalAmount)||parseFloat(ae.totalWithGst)||parseFloat(ae.invoiceAmount)*1.18;const q=W>=L?"Paid":"Partially Paid";ae.invoiceType==="Combined"&&ae.combinationCode!=="NA"?Ie(j=>j.map(me=>me.combinationCode===ae.combinationCode?{...me,invoiceStatus:q}:me)):Ie(j=>j.map(me=>me.id===ae.id?{...me,invoiceStatus:q}:me));const Z=[];p>0&&Z.push({id:Date.now(),partyName:ae.partyName,date:_r.date,particulars:_r.narration?`Payment Received - ${_r.mode} (${_r.narration})`:`Payment Received - ${_r.mode}`,debit:0,credit:p,type:"payment"}),T>0&&Z.push({id:Date.now()+1,partyName:ae.partyName,date:_r.date,particulars:`TDS Deducted - Inv: ${ae.invoiceNo}`,debit:0,credit:T,type:"tds"}),H>0&&Z.push({id:Date.now()+2,partyName:ae.partyName,date:_r.date,particulars:`Discount Allowed - Inv: ${ae.invoiceNo}`,debit:0,credit:H,type:"discount"}),Ae(j=>[...j,...Z]),Lr(!1),br(null)},my=p=>{dc(T=>{const H=new Set(T);return H.has(p)?H.delete(p):H.add(p),H})},yF=()=>{const H=r==="director"?[{id:"master",icon:J2,label:"Master Sheet"},{id:"services",icon:Kg,label:"Services Sheet"},{id:"invoices",icon:rf,label:"Invoice Register"},{id:"receipts",icon:vl,label:"Receipt Register"},{id:"ledgers",icon:K2,label:"Party Ledgers"},{id:"followups",icon:V0,label:"Followups"},{id:"reports",icon:$2,label:"Reports"}]:[{id:"master",icon:J2,label:"Master Sheet"},{id:"services",icon:Kg,label:"Services Sheet"},{id:"invoices",icon:rf,label:"Invoice Register"},{id:"receipts",icon:vl,label:"Receipt Register"},{id:"ledgers",icon:K2,label:"Party Ledgers"},{id:"followups",icon:V0,label:"Followups"},{id:"reports",icon:$2,label:"Reports"},{id:"settings",icon:C9,label:"Settings"}];return u.jsxs("div",{style:{width:R?"60px":"220px",backgroundColor:"#1E293B",color:"#FFFFFF",display:"flex",flexDirection:"column",transition:"width 0.2s ease",flexShrink:0},children:[u.jsxs("div",{style:{padding:R?"12px":"16px",borderBottom:"1px solid #334155",display:"flex",alignItems:"center",justifyContent:R?"center":"space-between"},children:[!R&&u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[u.jsx("img",{src:"/logo.png",alt:"JAC",style:{width:"32px",height:"auto",borderRadius:"4px",backgroundColor:"white",padding:"2px"}}),u.jsxs("div",{children:[u.jsx("div",{style:{fontSize:"16px",fontWeight:"700"},children:"FinMate"}),u.jsx("div",{style:{fontSize:"10px",color:"#94A3B8"},children:r==="director"?"Director View":"Finance Team"})]})]}),u.jsx("button",{onClick:()=>ze(!R),style:{background:"none",border:"none",color:"#94A3B8",cursor:"pointer",padding:"4px"},children:R?u.jsx(Hg,{size:18}):u.jsx(_9,{size:18})})]}),!R&&u.jsx("div",{style:{padding:"8px 16px",borderBottom:"1px solid #334155",fontSize:"11px"},children:d?u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",color:"#FCD34D"},children:[u.jsx(Y2,{size:12,style:{animation:"spin 1s linear infinite"}}),u.jsx("span",{children:"Saving..."})]}):g?u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",color:"#86EFAC"},children:[u.jsx(Wg,{size:12}),u.jsxs("span",{children:["Saved ",g.toLocaleTimeString()]})]}):u.jsx("div",{style:{color:"#94A3B8"},children:"Cloud Sync Active"})}),u.jsx("div",{style:{padding:"8px",borderBottom:"1px solid #334155"},children:u.jsxs("button",{onClick:()=>je(!0),style:{width:"100%",display:"flex",alignItems:"center",gap:"10px",padding:R?"12px":"11px 14px",borderRadius:"8px",border:"none",backgroundColor:Oi>0?"#FEF3C7":"#334155",color:Oi>0?"#92400E":"#94A3B8",cursor:"pointer",fontSize:"14px",fontWeight:Oi>0?"700":"500",justifyContent:R?"center":"flex-start",position:"relative"},title:"Notifications",children:[Oi>0?u.jsx(x9,{size:18}):u.jsx(G2,{size:18}),!R&&u.jsx("span",{children:"Notifications"}),Oi>0&&u.jsx("span",{style:{position:R?"absolute":"static",top:R?"4px":"auto",right:R?"4px":"auto",marginLeft:R?"0":"auto",backgroundColor:"#DC2626",color:"#FFFFFF",padding:"2px 6px",borderRadius:"10px",fontSize:"11px",fontWeight:"700",minWidth:"18px",textAlign:"center"},children:Oi})]})}),u.jsx("nav",{style:{flex:1,padding:"8px"},children:H.map(W=>u.jsxs("button",{onClick:()=>D(W.id),style:{width:"100%",display:"flex",alignItems:"center",gap:"10px",padding:R?"12px":"11px 14px",marginBottom:"4px",borderRadius:"8px",border:"none",backgroundColor:N===W.id?"#2874A6":"transparent",color:N===W.id?"#FFFFFF":"#94A3B8",cursor:"pointer",fontSize:"14px",fontWeight:N===W.id?"600":"500",justifyContent:R?"center":"flex-start"},title:W.label,children:[u.jsx(W.icon,{size:18}),!R&&u.jsx("span",{children:W.label})]},W.id))}),u.jsxs("div",{style:{padding:"8px",borderTop:"1px solid #334155"},children:[u.jsxs("button",{onClick:()=>{_(!0),K({currentPassword:"",newPassword:"",confirmPassword:""}),S("")},style:{width:"100%",display:"flex",alignItems:"center",gap:"10px",padding:R?"12px":"11px 14px",marginBottom:"8px",borderRadius:"8px",border:"none",backgroundColor:"#475569",color:"#FFFFFF",cursor:"pointer",fontSize:"14px",fontWeight:"500",justifyContent:R?"center":"flex-start"},title:"Change Password",children:[u.jsx(j0,{size:18}),!R&&u.jsx("span",{children:"Change Password"})]}),u.jsxs("button",{onClick:r0,style:{width:"100%",display:"flex",alignItems:"center",gap:"10px",padding:R?"12px":"11px 14px",borderRadius:"8px",border:"none",backgroundColor:"#DC2626",color:"#FFFFFF",cursor:"pointer",fontSize:"14px",fontWeight:"600",justifyContent:R?"center":"flex-start"},title:"Logout",children:[u.jsx(El,{size:18}),!R&&u.jsx("span",{children:"Logout"})]})]})]})},_F=()=>u.jsx("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"10px",border:"1px solid #E2E8F0",padding:"14px 18px",marginBottom:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"14px",flexWrap:"wrap"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[u.jsx(Gg,{size:18,color:"#64748B"}),u.jsx("span",{style:{fontSize:"13px",fontWeight:"700",color:"#475569"},children:"Filters:"})]}),u.jsxs("div",{style:{position:"relative"},children:[u.jsx(U0,{size:15,style:{position:"absolute",left:"10px",top:"50%",transform:"translateY(-50%)",color:"#94A3B8"}}),u.jsx("input",{type:"text",placeholder:"Search...",value:pt.searchText,onChange:p=>Zi(T=>({...T,searchText:p.target.value})),style:{padding:"8px 12px 8px 32px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",width:"160px"}})]}),u.jsxs("select",{value:pt.party,onChange:p=>Zi(T=>({...T,party:p.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:pt.party?"#EFF6FF":"#FFFFFF"},children:[u.jsx("option",{value:"",children:"All Parties"}),gl.map(p=>u.jsx("option",{value:p,children:p},p))]}),u.jsxs("select",{value:pt.billStatus,onChange:p=>Zi(T=>({...T,billStatus:p.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:pt.billStatus?"#EFF6FF":"#FFFFFF"},children:[u.jsx("option",{value:"",children:"Bill Status"}),u.jsx("option",{value:"Yes",children:"Yes"}),u.jsx("option",{value:"Not Yet",children:"Not Yet"})]}),u.jsxs("select",{value:pt.invoiceStatus,onChange:p=>Zi(T=>({...T,invoiceStatus:p.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:pt.invoiceStatus?"#EFF6FF":"#FFFFFF"},children:[u.jsx("option",{value:"",children:"Invoice Status"}),u.jsx("option",{value:"Generated",children:"Generated"}),u.jsx("option",{value:"Not Generated",children:"Not Generated"}),u.jsx("option",{value:"Paid",children:"Paid"})]}),xc&&u.jsxs(u.Fragment,{children:[u.jsxs("button",{onClick:i0,style:{padding:"8px 12px",fontSize:"13px",fontWeight:"600",border:"1.5px solid #FCA5A5",borderRadius:"8px",backgroundColor:"#FEE2E2",color:"#991B1B",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},children:[u.jsx(El,{size:14})," Clear"]}),u.jsxs("span",{style:{fontSize:"13px",color:"#64748B"},children:["Showing ",gc.length," of ",_e.length]})]})]})}),xy=()=>{const p=_e.filter(Z=>Z.toBeBilled==="Yes"&&Z.invoiceGenerated&&Z.mailingSent==="Yes"&&(Z.receiptStatus==="Received"||Z.receiptStatus==="Cancelled"||Z.receiptStatus==="Closed")),T=_e.filter(Z=>!(Z.toBeBilled==="Yes"&&Z.invoiceGenerated&&Z.mailingSent==="Yes"&&(Z.receiptStatus==="Received"||Z.receiptStatus==="Cancelled"||Z.receiptStatus==="Closed"))),H=on==="open"?T:p,W=H.filter(Z=>{var j,me,ie,pe,de;if(pt.party&&Z.partyName!==pt.party||pt.billStatus&&Z.toBeBilled!==pt.billStatus||pt.invoiceType&&Z.invoiceType!==pt.invoiceType||pt.mailingStatus&&(pt.mailingStatus==="Sent"&&Z.mailingSent!=="Yes"||pt.mailingStatus==="Not Sent"&&Z.mailingSent==="Yes")||pt.invoiceStatus&&(pt.invoiceStatus==="Generated"&&!Z.invoiceGenerated||pt.invoiceStatus==="Not Generated"&&Z.invoiceGenerated||pt.invoiceStatus==="Approved"&&Z.invoiceStatus!=="Approved"||pt.invoiceStatus==="Need Edits"&&Z.invoiceStatus!=="Need Edits"||pt.invoiceStatus==="Paid"&&Z.invoiceStatus!=="Paid"))return!1;if(pt.searchText){const ee=pt.searchText.toLowerCase();if(!((j=Z.partyName)!=null&&j.toLowerCase().includes(ee))&&!((me=Z.senderName)!=null&&me.toLowerCase().includes(ee))&&!((ie=Z.campaignName)!=null&&ie.toLowerCase().includes(ee))&&!((pe=Z.subject)!=null&&pe.toLowerCase().includes(ee))&&!((de=Z.invoiceNo)!=null&&de.toLowerCase().includes(ee)))return!1}return!0}),L=W.reduce((Z,j)=>{const me=j.partyName||"Unknown";return Z[me]||(Z[me]=[]),Z[me].push(j),Z},{}),q=Object.keys(L).sort();return u.jsxs("div",{children:[u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[u.jsxs("div",{children:[u.jsx("h1",{style:{margin:0,fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:" Master Sheet"}),u.jsxs("p",{style:{margin:"4px 0 0",fontSize:"14px",color:"#64748B"},children:[_e.length," campaigns  ",gl.length," parties  ",_e.filter(Z=>Z.invoiceGenerated).length," invoiced"]})]}),u.jsxs("div",{style:{display:"flex",gap:"10px"},children:[u.jsx("input",{type:"file",ref:qd,accept:".xlsx,.xls,.csv",style:{display:"none"},onChange:iF}),u.jsx(Ye,{icon:ea,label:"Upload Data",variant:"brand",onClick:()=>{var Z;return(Z=qd.current)==null?void 0:Z.click()}}),lr&&_e.length>0&&u.jsx(Ye,{icon:Fs,label:"Clear All Data",variant:"danger",onClick:()=>vs(!0)})]})]}),u.jsxs("div",{style:{display:"flex",gap:"4px",marginBottom:"16px",backgroundColor:"#F1F5F9",padding:"4px",borderRadius:"10px",width:"fit-content"},children:[u.jsxs("button",{onClick:()=>cc("open"),style:{padding:"10px 20px",fontSize:"14px",fontWeight:"600",border:"none",borderRadius:"8px",cursor:"pointer",backgroundColor:on==="open"?"#FFFFFF":"transparent",color:on==="open"?"#1E293B":"#64748B",boxShadow:on==="open"?"0 2px 4px rgba(0,0,0,0.1)":"none"},children:[" Open Invoices (",T.length,")"]}),u.jsxs("button",{onClick:()=>cc("closed"),style:{padding:"10px 20px",fontSize:"14px",fontWeight:"600",border:"none",borderRadius:"8px",cursor:"pointer",backgroundColor:on==="closed"?"#FFFFFF":"transparent",color:on==="closed"?"#1E293B":"#64748B",boxShadow:on==="closed"?"0 2px 4px rgba(0,0,0,0.1)":"none"},children:[" Closed Invoices (",p.length,")"]})]}),_e.length>0&&_F(),q.length===0?u.jsx(Zr,{children:u.jsxs("div",{style:{padding:"60px",textAlign:"center",color:"#94A3B8"},children:[u.jsx(ea,{size:48,style:{marginBottom:"16px",opacity:.5}}),u.jsx("div",{style:{fontSize:"18px",fontWeight:"600"},children:xc?"No matching records":on==="closed"?"No closed invoices yet":"No Data Yet"}),u.jsx("div",{style:{fontSize:"14px",marginTop:"4px"},children:xc?"Try adjusting your filters":on==="closed"?"Invoices will appear here once billed, mailed, and payment received":"Upload an Excel file to get started"})]})}):u.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:q.map(Z=>{const j=L[Z],me=Vu.has(Z),ie=j.filter(ee=>ee.toBeBilled==="Yes").length,pe=j.filter(ee=>ee.invoiceGenerated).length,de=j.filter(ee=>ee.toBeBilled==="Yes").reduce((ee,Ke)=>ee+(parseFloat(Ke.totalWithGst)||0),0);return u.jsxs("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"12px",border:"1px solid #E2E8F0",overflow:"hidden",boxShadow:"0 2px 8px rgba(0,0,0,0.04)"},children:[u.jsxs("div",{onClick:()=>my(Z),style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"16px 20px",backgroundColor:on==="closed"?"#F0FDF4":"#F8FAFC",cursor:"pointer",borderBottom:me?"3px solid #2874A6":"none"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[me?u.jsx(X2,{size:22,color:"#2874A6"}):u.jsx(Hg,{size:22,color:"#64748B"}),u.jsxs("div",{children:[u.jsx("div",{style:{fontWeight:"700",fontSize:"16px",color:"#1E293B"},children:Z}),u.jsxs("div",{style:{fontSize:"13px",color:"#64748B",marginTop:"3px"},children:[j.length," campaigns  ",ie," billed  ",pe," invoiced"]})]})]}),de>0&&u.jsxs("div",{style:{textAlign:"right"},children:[u.jsx("div",{style:{fontSize:"11px",color:"#64748B",textTransform:"uppercase"},children:"Total"}),u.jsx("div",{style:{fontSize:"18px",fontWeight:"700",color:"#059669"},children:et(de)})]})]}),me&&u.jsx("div",{style:{overflowX:"auto"},children:u.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"13px",minWidth:"2100px"},children:[u.jsx("thead",{children:u.jsxs("tr",{style:{backgroundColor:"#F1F5F9"},children:[u.jsx("th",{style:{padding:"12px 14px",textAlign:"left",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"90px"},children:"Date"}),u.jsx("th",{style:{padding:"12px 14px",textAlign:"left",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"100px"},children:"Sender"}),u.jsx("th",{style:{padding:"12px 14px",textAlign:"left",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",minWidth:"180px"},children:"Campaign / Subject"}),u.jsx("th",{style:{padding:"12px 14px",textAlign:"left",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"160px"},children:"Email ID"}),u.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"70px"},children:"Mailer"}),u.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"80px"},children:"Bill?"}),u.jsx("th",{style:{padding:"12px 14px",textAlign:"right",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"90px"},children:"Amount"}),u.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"90px"},children:"Type"}),u.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"90px"},children:"Generate"}),u.jsx("th",{style:{padding:"12px 14px",textAlign:"left",fontWeight:"700",color:"#1E40AF",borderBottom:"2px solid #E2E8F0",backgroundColor:"#EFF6FF",width:"110px"},children:"Invoice No."}),u.jsx("th",{style:{padding:"12px 14px",textAlign:"left",fontWeight:"700",color:"#1E40AF",borderBottom:"2px solid #E2E8F0",backgroundColor:"#EFF6FF",width:"90px"},children:"Inv Date"}),u.jsx("th",{style:{padding:"12px 14px",textAlign:"right",fontWeight:"700",color:"#1E40AF",borderBottom:"2px solid #E2E8F0",backgroundColor:"#EFF6FF",width:"100px"},children:"Inv Amount"}),u.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#7C3AED",borderBottom:"2px solid #E2E8F0",backgroundColor:"#FAF5FF",width:"50px"},children:"C#"}),u.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"120px"},children:"Status/Approve"}),u.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"120px"},children:"Actions"}),u.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#059669",borderBottom:"2px solid #E2E8F0",backgroundColor:"#F0FDF4",width:"80px"},children:"Mailed?"}),u.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#059669",borderBottom:"2px solid #E2E8F0",backgroundColor:"#F0FDF4",width:"90px"},children:"Mail Date"}),u.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#7C3AED",borderBottom:"2px solid #E2E8F0",backgroundColor:"#FAF5FF",width:"100px"},children:"Receipt"})]})}),u.jsx("tbody",{children:j.map(ee=>{var Me,Xe;const Ke=ee.invoiceType==="Combined"&&mc(ee.combinationCode)&&ee.mailingSent!=="Yes";es(ee);const xe=wi[ee.id]&&wi[ee.id].length>0;return u.jsxs("tr",{style:{backgroundColor:ee.toBeBilled==="Yes"?ee.invoiceGenerated?"#F0FDF4":"#FFFBEB":"#FFFFFF",borderBottom:"1px solid #F1F5F9"},children:[u.jsx("td",{style:{padding:"12px 14px",whiteSpace:"nowrap",fontSize:"13px"},children:Vt(ee.date)}),u.jsx("td",{style:{padding:"12px 14px",fontWeight:"600",fontSize:"13px"},children:ee.senderName}),u.jsxs("td",{style:{padding:"12px 14px"},children:[u.jsx("div",{style:{fontWeight:"600",fontSize:"13px",lineHeight:"1.4",color:"#1E293B"},children:((Xe=(Me=ee.campaignName)==null?void 0:Me.split("--")[0])==null?void 0:Xe.trim())||ee.senderName}),ee.subject&&u.jsx("div",{style:{fontSize:"12px",color:"#64748B",marginTop:"4px",lineHeight:"1.3"},children:ee.subject})]}),u.jsx("td",{style:{padding:"10px 14px"},children:u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[ee.emailId&&u.jsx("div",{style:{fontSize:"11px",color:"#1E40AF",backgroundColor:"#EFF6FF",padding:"2px 6px",borderRadius:"4px",display:"inline-block"},children:ee.emailId}),(ee.additionalEmails||[]).map((Qe,yt)=>u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[u.jsx("span",{style:{fontSize:"11px",color:"#059669",backgroundColor:"#F0FDF4",padding:"2px 6px",borderRadius:"4px"},children:Qe}),u.jsx("button",{onClick:()=>v(ee.id,Qe),style:{background:"none",border:"none",cursor:"pointer",padding:"2px",color:"#DC2626"},title:"Remove",children:u.jsx(El,{size:12})})]},yt)),u.jsxs("button",{onClick:()=>{br(ee),Us(""),ct(!0)},style:{display:"flex",alignItems:"center",gap:"4px",fontSize:"11px",color:"#2874A6",background:"none",border:"none",cursor:"pointer",padding:"2px 0"},children:[u.jsx(q2,{size:12})," Add"]})]})}),u.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:xe?u.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"2px"},children:[u.jsx("span",{style:{color:"#22C55E",fontWeight:"700",fontSize:"14px"},children:""}),u.jsx("button",{onClick:()=>{br(ee),_a(null),Ea(!0),sn(!0)},style:{fontSize:"10px",color:"#64748B",background:"none",border:"none",cursor:"pointer",textDecoration:"underline"},children:"Replace"})]}):u.jsx(Ye,{icon:y9,small:!0,variant:"default",onClick:()=>{br(ee),_a(null),Ea(!1),sn(!0)}})}),u.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:u.jsxs("select",{value:ee.toBeBilled,onChange:Qe=>aF(ee.id,Qe.target.value),disabled:ee.invoiceGenerated||!Vr,style:{padding:"6px 8px",fontSize:"12px",fontWeight:"600",border:"2px solid",borderRadius:"6px",borderColor:ee.toBeBilled==="Yes"?"#22C55E":"#E2E8F0",backgroundColor:ee.toBeBilled==="Yes"?"#DCFCE7":"#FFFFFF",color:ee.toBeBilled==="Yes"?"#166534":"#64748B",cursor:ee.invoiceGenerated||!Vr?"not-allowed":"pointer",width:"70px",opacity:!Vr&&!ee.invoiceGenerated?.6:1},children:[u.jsx("option",{value:"Not Yet",children:"Not Yet"}),u.jsx("option",{value:"Yes",children:"Yes"})]})}),u.jsx("td",{style:{padding:"10px 14px"},children:u.jsx("input",{type:"number",value:ee.invoiceAmount||"",onChange:Qe=>s0(ee.id,"invoiceAmount",Qe.target.value),disabled:ee.invoiceGenerated,placeholder:"0",style:{width:"80px",padding:"6px 8px",fontSize:"13px",fontWeight:"600",border:"1.5px solid #D1D5DB",borderRadius:"6px",textAlign:"right",backgroundColor:ee.invoiceGenerated?"#F3F4F6":"#FFFFFF"}})}),u.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:ee.invoiceGenerated?u.jsx(lm,{status:ee.invoiceType,small:!0}):ee.toBeBilled==="Yes"?u.jsxs("select",{value:ee.invoiceType||"Individual",onChange:Qe=>s0(ee.id,"invoiceType",Qe.target.value),style:{padding:"6px 6px",fontSize:"11px",fontWeight:"600",border:"2px solid",borderRadius:"6px",borderColor:ee.invoiceType==="Combined"?"#7C3AED":"#A5B4FC",backgroundColor:ee.invoiceType==="Combined"?"#F3E8FF":"#E0E7FF",color:ee.invoiceType==="Combined"?"#6B21A8":"#3730A3",cursor:"pointer",width:"80px"},children:[u.jsx("option",{value:"Individual",children:"Individual"}),u.jsx("option",{value:"Combined",children:"Combined"})]}):u.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),u.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:ee.toBeBilled==="Yes"&&!ee.invoiceGenerated&&ee.invoiceAmount&&lr?ee.invoiceType==="Individual"?u.jsx(Ye,{icon:vl,label:"Create",small:!0,variant:"warning",onClick:()=>oF(ee)}):u.jsx(Ye,{icon:S9,label:"Combine",small:!0,variant:"purple",onClick:()=>uF(ee)}):ee.toBeBilled==="Yes"&&!ee.invoiceGenerated&&ee.invoiceAmount&&Vr?u.jsx("span",{style:{fontSize:"10px",color:"#94A3B8"},children:"Finance to create"}):u.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),u.jsx("td",{style:{padding:"10px 14px",backgroundColor:"#EFF6FF"},children:ee.invoiceNo?u.jsx("span",{style:{fontWeight:"700",color:"#1E40AF",fontSize:"12px"},children:ee.invoiceNo}):u.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),u.jsx("td",{style:{padding:"10px 14px",backgroundColor:"#EFF6FF",fontSize:"12px"},children:ee.invoiceDate?Vt(ee.invoiceDate):"-"}),u.jsx("td",{style:{padding:"10px 14px",backgroundColor:"#EFF6FF",textAlign:"right",fontWeight:"700",color:"#1E40AF",fontSize:"13px"},children:ee.invoiceTotalAmount?Dt(ee.invoiceTotalAmount):"-"}),u.jsx("td",{style:{padding:"10px 14px",textAlign:"center",backgroundColor:"#FAF5FF"},children:ee.combinationCode&&ee.combinationCode!=="NA"?u.jsx("span",{style:{fontWeight:"700",color:"#7C3AED",fontSize:"12px"},children:ee.combinationCode}):"-"}),u.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:ee.invoiceGenerated?Vr?u.jsx("button",{onClick:()=>C(ee),style:{padding:"5px 10px",fontSize:"11px",fontWeight:"700",border:"1.5px solid",borderRadius:"6px",cursor:"pointer",backgroundColor:ee.invoiceStatus==="Approved"?"#DCFCE7":ee.invoiceStatus==="Need Edits"?"#FEE2E2":"#FEF3C7",borderColor:ee.invoiceStatus==="Approved"?"#22C55E":ee.invoiceStatus==="Need Edits"?"#DC2626":"#F59E0B",color:ee.invoiceStatus==="Approved"?"#166534":ee.invoiceStatus==="Need Edits"?"#991B1B":"#92400E"},children:ee.invoiceStatus==="Approved"?" Approved":ee.invoiceStatus==="Need Edits"?" Need Edits":" Review"}):u.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"4px"},children:[u.jsx("span",{style:{padding:"4px 10px",fontSize:"11px",fontWeight:"700",borderRadius:"6px",backgroundColor:ee.invoiceStatus==="Approved"?"#DCFCE7":ee.invoiceStatus==="Need Edits"?"#FEE2E2":"#FEF3C7",color:ee.invoiceStatus==="Approved"?"#166534":ee.invoiceStatus==="Need Edits"?"#991B1B":"#92400E"},children:ee.invoiceStatus==="Approved"?" Approved":ee.invoiceStatus==="Need Edits"?" Need Edits":" Pending"}),(ee.editComments||ee.approvalRemarks)&&u.jsx("button",{onClick:()=>{br(ee),hr(!0)},style:{fontSize:"9px",color:ee.invoiceStatus==="Need Edits"?"#991B1B":"#166534",background:"none",border:"none",cursor:"pointer",textDecoration:"underline"},title:ee.editComments||ee.approvalRemarks,children:"View Remarks"})]}):u.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),u.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:ee.invoiceGenerated&&ee.invoiceStatus==="Approved"?u.jsxs("div",{style:{display:"flex",gap:"6px",justifyContent:"center"},children:[u.jsx(Ye,{icon:B0,small:!0,onClick:()=>Gu(ee),title:"View Invoice"}),lr&&u.jsx(Ye,{icon:Xg,small:!0,variant:"brand",onClick:()=>{br(ee),qi(!0)},title:"Send Email"}),lr&&u.jsx(Ye,{icon:Fs,small:!0,variant:"danger",onClick:()=>Qr(ee),title:"Delete"})]}):ee.invoiceGenerated?u.jsxs("div",{style:{display:"flex",gap:"6px",justifyContent:"center"},children:[u.jsx(Ye,{icon:B0,small:!0,onClick:()=>Gu(ee),title:"View Invoice"}),lr&&u.jsx(Ye,{icon:Fs,small:!0,variant:"danger",onClick:()=>Qr(ee),title:"Delete"})]}):u.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),u.jsx("td",{style:{padding:"10px 14px",textAlign:"center",backgroundColor:"#F0FDF4"},children:ee.invoiceGenerated&&ee.invoiceStatus==="Approved"&&lr?Ke?u.jsx("span",{style:{fontSize:"10px",color:"#94A3B8"},children:"Combined sent"}):u.jsxs("select",{value:ee.mailingSent||"No",onChange:Qe=>s0(ee.id,"mailingSent",Qe.target.value),style:{padding:"5px 8px",fontSize:"11px",fontWeight:"700",border:"2px solid",borderRadius:"6px",borderColor:ee.mailingSent==="Yes"?"#22C55E":"#E2E8F0",backgroundColor:ee.mailingSent==="Yes"?"#DCFCE7":"#FFFFFF",color:ee.mailingSent==="Yes"?"#166534":"#64748B",cursor:"pointer",width:"60px"},children:[u.jsx("option",{value:"No",children:"No"}),u.jsx("option",{value:"Yes",children:"Yes"})]}):ee.invoiceGenerated&&ee.invoiceStatus==="Approved"&&Vr?u.jsx("span",{style:{padding:"4px 8px",borderRadius:"6px",fontSize:"11px",fontWeight:"600",backgroundColor:ee.mailingSent==="Yes"?"#DCFCE7":"#FEF3C7",color:ee.mailingSent==="Yes"?"#166534":"#92400E"},children:ee.mailingSent==="Yes"?" Yes":" No"}):ee.invoiceGenerated&&ee.invoiceStatus!=="Approved"?u.jsx("span",{style:{fontSize:"10px",color:"#94A3B8"},children:"Approve first"}):u.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),u.jsx("td",{style:{padding:"10px 14px",textAlign:"center",backgroundColor:"#F0FDF4"},children:ee.mailingSent==="Yes"?lr?u.jsx("input",{type:"date",value:ee.mailDate||ee.invoiceDate||"",onChange:Qe=>s0(ee.id,"mailDate",Qe.target.value),style:{padding:"4px 6px",fontSize:"11px",border:"1.5px solid #D1D5DB",borderRadius:"6px",width:"100%"}}):u.jsx("span",{style:{fontSize:"11px"},children:Vt(ee.mailDate||ee.invoiceDate)}):u.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),u.jsx("td",{style:{padding:"10px 14px",textAlign:"center",backgroundColor:"#FAF5FF"},children:ee.receiptStatus==="Received"||ee.receiptStatus==="Closed"?u.jsxs("span",{style:{padding:"4px 8px",borderRadius:"6px",fontSize:"10px",fontWeight:"700",backgroundColor:"#DCFCE7",color:"#166534"},children:[" ",ee.receiptNo||"Received"]}):ee.receiptStatus==="Cancelled"?u.jsx("span",{style:{padding:"4px 8px",borderRadius:"6px",fontSize:"10px",fontWeight:"700",backgroundColor:"#FEE2E2",color:"#991B1B"},children:" Cancelled"}):ee.invoiceGenerated&&ee.invoiceStatus==="Approved"?u.jsx("span",{style:{padding:"4px 8px",borderRadius:"6px",fontSize:"10px",fontWeight:"600",backgroundColor:"#FEF3C7",color:"#92400E"},children:" Pending"}):u.jsx("span",{style:{color:"#CBD5E1"},children:"-"})})]},ee.id)})})]})})]},Z)})}),H.length>0&&u.jsxs("div",{style:{marginTop:"16px",padding:"16px 20px",backgroundColor:"#FFFFFF",borderRadius:"12px",border:"1px solid #E2E8F0",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[u.jsxs("div",{style:{display:"flex",gap:"24px",fontSize:"14px",color:"#475569"},children:[u.jsxs("span",{children:[" Total: ",u.jsx("strong",{children:W.length})]}),u.jsxs("span",{children:[" To Bill: ",u.jsx("strong",{children:W.filter(Z=>Z.toBeBilled==="Yes").length})]}),u.jsxs("span",{children:[" Invoiced: ",u.jsx("strong",{children:W.filter(Z=>Z.invoiceGenerated).length})]}),u.jsxs("span",{children:[" Approved: ",u.jsx("strong",{children:W.filter(Z=>Z.invoiceStatus==="Approved").length})]}),on==="closed"&&u.jsxs("span",{children:[" Closed: ",u.jsx("strong",{children:W.filter(Z=>Z.receiptStatus==="Received"||Z.receiptStatus==="Cancelled"||Z.receiptStatus==="Closed").length})]})]}),u.jsxs("div",{style:{fontSize:"18px",fontWeight:"700",color:"#059669"},children:["Total: ",et(W.filter(Z=>Z.toBeBilled==="Yes").reduce((Z,j)=>Z+(parseFloat(j.totalWithGst)||0),0))]})]})]})},EF=["Podcast Production","Podcast Promotion","Video Production","Content Creation","Social Media Management","Consulting","Other Services"],o0=p=>{var H;if(!p)return{state:"",gstin:"",address:""};const T=p.trim().toUpperCase();for(const W in qr){const L=qr[W];if(((H=L.partyName)==null?void 0:H.trim().toUpperCase())===T)return{state:L.stateName||"",gstin:L.gstin||"",address:L.address||""}}return{state:"",gstin:"",address:""}},wF=()=>{if(!U.partyName||!U.amount||!U.description){alert("Please fill Party Name, Description, and Amount");return}const p=o0(U.partyName),T={id:Date.now().toString(),partyName:U.partyName,statePartyDetails:U.statePartyDetails||p.state,serviceType:U.serviceType,description:U.description,date:U.date,invoiceAmount:parseFloat(U.amount).toFixed(2),gstin:p.gstin,address:p.address,toBeBilled:"No",invoiceGenerated:!1,invoiceStatus:null,invoiceNo:null,invoiceDate:null,invoiceTotalAmount:null,receiptStatus:"Pending",isService:!0};we(H=>[...H,T]),M(!1),oe({partyName:"",statePartyDetails:"",serviceType:"Podcast Production",description:"",date:new Date().toISOString().split("T")[0],amount:""})},vy=(p,T,H)=>{we(W=>W.map(L=>L.id===p?{...L,[T]:H}:L))},SF=p=>{var me;if(!p.invoiceAmount||parseFloat(p.invoiceAmount)<=0){alert("Please enter a valid invoice amount");return}const T=`${w.invoicePrefix}${We}`,H=new Date().toISOString().split("T")[0],W=o0(p.partyName);(me=p.statePartyDetails||W.state)==null||me.toUpperCase().includes("MAHARASHTRA");const L=parseFloat(p.invoiceAmount),q=L*.18,Z=L+q;we(ie=>ie.map(pe=>pe.id===p.id?{...pe,invoiceNo:T,invoiceDate:H,invoiceTotalAmount:Z.toFixed(2),invoiceGenerated:!0,invoiceStatus:"Created",statePartyDetails:p.statePartyDetails||W.state}:pe)),ar(ie=>ie+1);const j={id:Date.now(),type:"invoice_created",title:"Service Invoice Created",message:`Invoice ${T} for ${p.partyName} - ${Z.toLocaleString("en-IN")}`,timestamp:new Date().toISOString(),read:!1,forRole:"director"};ue(ie=>[j,...ie])},yy=(p,T,H="")=>{if(T==="approve"){we(L=>L.map(q=>q.id===p.id?{...q,invoiceStatus:"Approved",directorRemarks:H||null}:q));const W={id:Date.now(),type:"invoice_approved",title:"Service Invoice Approved",message:`Invoice ${p.invoiceNo} for ${p.partyName} approved`,timestamp:new Date().toISOString(),read:!1,forRole:"finance"};ue(L=>[W,...L])}else if(T==="needsEdit"){we(L=>L.map(q=>q.id===p.id?{...q,invoiceStatus:"Need Edits",directorRemarks:H}:q));const W={id:Date.now(),type:"invoice_needs_edit",title:"Service Invoice Needs Edits",message:`Invoice ${p.invoiceNo}: ${H}`,timestamp:new Date().toISOString(),read:!1,forRole:"finance"};ue(L=>[W,...L])}},TF=p=>{const T=De.find(H=>H.id===p);if(T!=null&&T.invoiceGenerated&&(T==null?void 0:T.invoiceStatus)==="Approved"){alert("Cannot delete approved invoices");return}confirm("Delete this service entry?")&&we(H=>H.filter(W=>W.id!==p))},_y=p=>{const T=o0(p.partyName),H=p.gstin||T.gstin,W=p.address||T.address,L=p.statePartyDetails||T.state,q=parseFloat(p.invoiceAmount),Z=L==null?void 0:L.toUpperCase().includes("MAHARASHTRA"),j=Z?q*.09:0,me=Z?q*.09:0,ie=Z?0:q*.18,pe=parseFloat(p.invoiceTotalAmount),de=`
<!DOCTYPE html>
<html>
<head>
  <title>Tax Invoice - ${p.invoiceNo}</title>
  <style>
    @media print { body { -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; } @page { size: A4; margin: 10mm; } }
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: Arial, sans-serif; font-size: 12px; }
    .invoice-container { max-width: 800px; margin: 0 auto; border: 2px solid #000; }
  </style>
</head>
<body>
  <div class="invoice-container">
    <div style="text-align: center; padding: 15px; border-bottom: 2px solid #000; font-size: 20px; font-weight: bold;">Tax Invoice</div>
    <div style="text-align: center; padding: 5px; border-bottom: 1px solid #000; font-style: italic; font-size: 11px; background: #f5f5f5;">(Original for Recipient)</div>
    <div style="display: flex; border-bottom: 2px solid #000;">
      <div style="flex: 1.5; padding: 12px; border-right: 2px solid #000;">
        <div style="font-size: 16px; font-weight: bold; color: #1a5276; margin-bottom: 8px;">${w.name}</div>
        <div style="font-size: 11px; line-height: 1.5;">${w.address}<br>${w.addressLine2}, ${w.city}<br><strong>GSTIN/UIN:</strong> ${w.gstin}<br><strong>State:</strong> ${w.stateName}, Code: ${w.stateCode}<br><strong>Contact:</strong> ${w.phone}<br><strong>E-Mail:</strong> ${w.email}</div>
      </div>
      <div style="flex: 1; padding: 0;">
        <div style="display: flex; border-bottom: 1px solid #000;"><div style="flex: 1; padding: 8px; border-right: 1px solid #000; font-weight: bold; background: #f5f5f5;">Invoice No.</div><div style="flex: 1; padding: 8px; color: #1a5276; font-weight: bold;">${p.invoiceNo}</div></div>
        <div style="display: flex;"><div style="flex: 1; padding: 8px; border-right: 1px solid #000; font-weight: bold; background: #f5f5f5;">Dated</div><div style="flex: 1; padding: 8px;">${Vt(p.invoiceDate)}</div></div>
      </div>
    </div>
    <div style="padding: 10px 12px; border-bottom: 2px solid #000; background: #fafafa;">
      <div style="font-size: 11px; color: #666; margin-bottom: 3px;">Buyer (Bill to)</div>
      <div style="font-size: 14px; font-weight: bold; margin-bottom: 4px; color: #1a5276;">${p.partyName}</div>
      <div style="font-size: 11px; color: #333;">${W?W+"<br>":""}${L||""}${H?"<br><strong>GSTIN/UIN:</strong> "+H:""}<br>Place of Supply: ${L||w.stateName}</div>
    </div>
    <table style="width: 100%; border-collapse: collapse;">
      <thead><tr style="background: #e8e8e8;"><th style="border: 1px solid #000; padding: 10px; width: 45px; font-size: 12px;">Sl No.</th><th style="border: 1px solid #000; padding: 10px; font-size: 12px;">Particulars</th><th style="border: 1px solid #000; padding: 10px; width: 80px; font-size: 12px;">HSN/SAC</th><th style="border: 1px solid #000; padding: 10px; width: 100px; text-align: right; font-size: 12px;">Amount</th></tr></thead>
      <tbody>
        <tr>
          <td style="border: 1px solid #000; padding: 8px; text-align: center;">1</td>
          <td style="border: 1px solid #000; padding: 8px;">
            <div style="font-weight: 600;">${p.serviceType.toUpperCase()}</div>
            <div style="font-style: italic; color: #555; font-size: 11px; margin-top: 2px;">${p.description}</div>
            <div style="font-style: italic; color: #555; font-size: 11px;">Date: ${Vt(p.date)}</div>
          </td>
          <td style="border: 1px solid #000; padding: 8px; text-align: center;">${w.hsnCode}</td>
          <td style="border: 1px solid #000; padding: 8px; text-align: right;">${Dt(q)}</td>
        </tr>
        ${Z?`
          <tr><td colspan="3" style="border: 1px solid #000; padding: 8px; text-align: right; font-weight: 600;">CGST @ 9%</td><td style="border: 1px solid #000; padding: 8px; text-align: right;">${Dt(j)}</td></tr>
          <tr><td colspan="3" style="border: 1px solid #000; padding: 8px; text-align: right; font-weight: 600;">SGST @ 9%</td><td style="border: 1px solid #000; padding: 8px; text-align: right;">${Dt(me)}</td></tr>
        `:`
          <tr><td colspan="3" style="border: 1px solid #000; padding: 8px; text-align: right; font-weight: 600;">IGST @ 18%</td><td style="border: 1px solid #000; padding: 8px; text-align: right;">${Dt(ie)}</td></tr>
        `}
        <tr style="background: #2874A6; color: white;"><td colspan="3" style="border: 1px solid #000; padding: 12px; text-align: right; font-weight: bold; font-size: 14px;">Total</td><td style="border: 1px solid #000; padding: 12px; text-align: right; font-weight: bold; font-size: 14px;"> ${pe.toLocaleString("en-IN",{minimumFractionDigits:2})}</td></tr>
      </tbody>
    </table>
    <div style="padding: 10px 12px; border: 1px solid #000; border-top: none; background: #fafafa;"><div style="color: #666; font-size: 11px; margin-bottom: 3px;">Amount Chargeable (in words)</div><div style="font-weight: bold; font-size: 13px;">${K0(pe)}</div></div>
    <div style="display: flex; border-top: 2px solid #000;">
      <div style="flex: 1; padding: 10px 12px; border-right: 2px solid #000; font-size: 11px;"><div><strong>Company's PAN:</strong> ${w.pan}</div><div style="margin-top: 4px;"><strong>MSME Reg. No.:</strong> UDYAM-MH-19-0057219</div></div>
      <div style="flex: 1.2; padding: 10px 12px; font-size: 11px;">
        <div style="font-weight: bold; margin-bottom: 6px; color: #1a5276;">Company's Bank Details</div>
        <div style="line-height: 1.5;"><strong>A/c Holder:</strong> ${w.bank.holder}<br><strong>Bank:</strong> ${w.bank.name}<br><strong>A/c No.:</strong> ${w.bank.account}<br><strong>IFSC:</strong> ${w.bank.ifsc}</div>
        <div style="text-align: right; margin-top: 30px;"><div style="font-weight: bold;">for ${w.name}</div><div style="margin-top: 25px; border-top: 1px solid #000; display: inline-block; padding-top: 4px; font-size: 10px;">Authorised Signatory</div></div>
      </div>
    </div>
    <div style="text-align: center; padding: 8px; background: #f0f0f0; border-top: 1px solid #000; font-size: 10px; color: #666; font-style: italic;">This is a Computer Generated Invoice</div>
  </div>
</body>
</html>`,ee=window.open("","_blank");ee.document.write(de),ee.document.close(),ee.print()},AF=()=>{const p=r==="director",T=Ks.filter(Z=>!Z.invoiceGenerated||Z.invoiceStatus!=="Approved"||Z.receiptStatus==="Pending"),H=Ks.filter(Z=>Z.invoiceGenerated&&Z.invoiceStatus==="Approved"&&Z.receiptStatus!=="Pending"),W=Ws==="open"?T:H,L={};W.forEach(Z=>{const j=Z.partyName||"Unknown";L[j]||(L[j]=[]),L[j].push(Z)});const q=Object.keys(L).sort();return u.jsxs("div",{style:{padding:"20px"},children:[u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[u.jsxs("div",{children:[u.jsx("h1",{style:{fontSize:"22px",fontWeight:"700",color:"#1E293B",marginBottom:"4px"},children:"Services Sheet"}),u.jsx("p",{style:{fontSize:"13px",color:"#64748B"},children:"Non-campaign invoices (Podcast, Video Production, etc.)"})]}),u.jsx("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:!p&&u.jsx(Ye,{icon:nf,label:"Add Service",onClick:()=>M(!0)})})]}),u.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"20px"},children:[u.jsxs("button",{onClick:()=>I("open"),style:{padding:"10px 20px",fontSize:"13px",fontWeight:"600",border:"none",borderRadius:"8px",cursor:"pointer",backgroundColor:Ws==="open"?"#2874A6":"#E2E8F0",color:Ws==="open"?"#FFFFFF":"#64748B"},children:["Open (",T.length,")"]}),u.jsxs("button",{onClick:()=>I("closed"),style:{padding:"10px 20px",fontSize:"13px",fontWeight:"600",border:"none",borderRadius:"8px",cursor:"pointer",backgroundColor:Ws==="closed"?"#22C55E":"#E2E8F0",color:Ws==="closed"?"#FFFFFF":"#64748B"},children:["Closed (",H.length,")"]})]}),u.jsx(Zr,{title:`Services - ${Ws==="open"?"Open":"Closed"}`,noPadding:!0,children:q.length===0?u.jsxs("div",{style:{padding:"40px",textAlign:"center",color:"#94A3B8"},children:[u.jsx(Kg,{size:40,style:{marginBottom:"10px",opacity:.5}}),u.jsx("p",{children:"No services in this tab"})]}):q.map(Z=>u.jsxs("div",{style:{borderBottom:"2px solid #E2E8F0"},children:[u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px 16px",backgroundColor:"#F8FAFC",cursor:"pointer"},children:[u.jsx("div",{style:{fontWeight:"600",color:"#1E293B"},children:Z}),u.jsxs("div",{style:{fontSize:"12px",color:"#64748B"},children:[L[Z].length," items"]})]}),u.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[u.jsx("thead",{children:u.jsxs("tr",{style:{backgroundColor:"#F1F5F9"},children:[u.jsx("th",{style:{padding:"10px",textAlign:"left",fontSize:"11px",fontWeight:"600",color:"#475569"},children:"Date"}),u.jsx("th",{style:{padding:"10px",textAlign:"left",fontSize:"11px",fontWeight:"600",color:"#475569"},children:"Service Type"}),u.jsx("th",{style:{padding:"10px",textAlign:"left",fontSize:"11px",fontWeight:"600",color:"#475569"},children:"Description"}),u.jsx("th",{style:{padding:"10px",textAlign:"left",fontSize:"11px",fontWeight:"600",color:"#475569"},children:"State"}),u.jsx("th",{style:{padding:"10px",textAlign:"center",fontSize:"11px",fontWeight:"600",color:"#475569"},children:"To Bill"}),u.jsx("th",{style:{padding:"10px",textAlign:"right",fontSize:"11px",fontWeight:"600",color:"#475569"},children:"Amount"}),u.jsx("th",{style:{padding:"10px",textAlign:"center",fontSize:"11px",fontWeight:"600",color:"#475569"},children:"Invoice"}),u.jsx("th",{style:{padding:"10px",textAlign:"center",fontSize:"11px",fontWeight:"600",color:"#475569"},children:"Status"}),u.jsx("th",{style:{padding:"10px",textAlign:"center",fontSize:"11px",fontWeight:"600",color:"#475569"},children:"Actions"})]})}),u.jsx("tbody",{children:L[Z].map(j=>u.jsxs("tr",{style:{borderBottom:"1px solid #F1F5F9",backgroundColor:j.invoiceGenerated?"#F0FDF4":"#FFFFFF"},children:[u.jsx("td",{style:{padding:"10px",fontSize:"12px"},children:Vt(j.date)}),u.jsx("td",{style:{padding:"10px",fontSize:"12px",fontWeight:"500"},children:j.serviceType}),u.jsx("td",{style:{padding:"10px",fontSize:"12px",maxWidth:"200px"},children:j.description}),u.jsx("td",{style:{padding:"10px",fontSize:"11px",color:"#64748B"},children:j.statePartyDetails||"-"}),u.jsx("td",{style:{padding:"10px",textAlign:"center"},children:u.jsx("button",{onClick:()=>p&&!j.invoiceGenerated&&vy(j.id,"toBeBilled",j.toBeBilled==="Yes"?"No":"Yes"),disabled:j.invoiceGenerated||!p,style:{padding:"4px 8px",fontSize:"11px",fontWeight:"600",border:"2px solid",borderRadius:"4px",cursor:j.invoiceGenerated||!p?"not-allowed":"pointer",borderColor:j.toBeBilled==="Yes"?"#22C55E":"#E2E8F0",backgroundColor:j.toBeBilled==="Yes"?"#DCFCE7":"#FFFFFF",color:j.toBeBilled==="Yes"?"#166534":"#64748B"},children:j.toBeBilled||"No"})}),u.jsx("td",{style:{padding:"10px",textAlign:"right"},children:j.invoiceGenerated?u.jsxs("span",{style:{fontWeight:"600"},children:["",parseFloat(j.invoiceAmount).toLocaleString("en-IN")]}):u.jsx("input",{type:"number",value:j.invoiceAmount||"",onChange:me=>vy(j.id,"invoiceAmount",me.target.value),disabled:j.invoiceGenerated,placeholder:"0",style:{width:"80px",padding:"4px",fontSize:"12px",border:"1px solid #E2E8F0",borderRadius:"4px",textAlign:"right"}})}),u.jsx("td",{style:{padding:"10px",textAlign:"center"},children:j.invoiceGenerated?u.jsx("span",{style:{fontSize:"11px",color:"#2874A6",fontWeight:"600",cursor:"pointer"},onClick:()=>_y(j),children:j.invoiceNo}):!p&&j.toBeBilled==="Yes"&&j.invoiceAmount?u.jsx("button",{onClick:()=>SF(j),style:{padding:"4px 8px",fontSize:"11px",backgroundColor:"#2874A6",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Generate"}):"-"}),u.jsx("td",{style:{padding:"10px",textAlign:"center"},children:j.invoiceGenerated?u.jsx("span",{style:{padding:"3px 8px",fontSize:"10px",fontWeight:"600",borderRadius:"9999px",backgroundColor:j.invoiceStatus==="Approved"?"#DCFCE7":j.invoiceStatus==="Need Edits"?"#FEF3C7":"#E0E7FF",color:j.invoiceStatus==="Approved"?"#166534":j.invoiceStatus==="Need Edits"?"#92400E":"#3730A3"},children:j.invoiceStatus}):"-"}),u.jsx("td",{style:{padding:"10px",textAlign:"center"},children:u.jsxs("div",{style:{display:"flex",gap:"4px",justifyContent:"center"},children:[p&&j.invoiceGenerated&&j.invoiceStatus==="Created"&&u.jsxs(u.Fragment,{children:[u.jsx("button",{onClick:()=>yy(j,"approve"),style:{padding:"4px 8px",fontSize:"10px",backgroundColor:"#22C55E",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:u.jsx(Wg,{size:12})}),u.jsx("button",{onClick:()=>{const me=prompt("Enter remarks for edits needed:");me&&yy(j,"needsEdit",me)},style:{padding:"4px 8px",fontSize:"10px",backgroundColor:"#F59E0B",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:u.jsx(A9,{size:12})})]}),!p&&!j.invoiceGenerated&&u.jsx("button",{onClick:()=>TF(j.id),style:{padding:"4px 8px",fontSize:"10px",backgroundColor:"#EF4444",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:u.jsx(Fs,{size:12})}),j.invoiceGenerated&&j.invoiceStatus==="Approved"&&u.jsx("button",{onClick:()=>_y(j),style:{padding:"4px 8px",fontSize:"10px",backgroundColor:"#2874A6",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:u.jsx(Yg,{size:12})})]})})]},j.id))})]})]},Z))}),u.jsx(wn,{isOpen:G,onClose:()=>M(!1),title:"Add New Service",width:"500px",children:u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[u.jsxs("div",{children:[u.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:"600",color:"#475569",marginBottom:"6px"},children:"Party Name *"}),u.jsx("input",{list:"partyList",value:U.partyName,onChange:Z=>{const j=Z.target.value;oe(ie=>({...ie,partyName:j}));const me=o0(j);me.state&&oe(ie=>({...ie,statePartyDetails:me.state}))},placeholder:"Select or type party name",style:{width:"100%",padding:"10px",fontSize:"14px",border:"1.5px solid #E2E8F0",borderRadius:"8px"}}),u.jsx("datalist",{id:"partyList",children:Object.values(qr).map((Z,j)=>u.jsx("option",{value:Z.partyName},j))})]}),u.jsxs("div",{children:[u.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:"600",color:"#475569",marginBottom:"6px"},children:"State"}),u.jsx("input",{value:U.statePartyDetails,onChange:Z=>oe(j=>({...j,statePartyDetails:Z.target.value})),placeholder:"State",style:{width:"100%",padding:"10px",fontSize:"14px",border:"1.5px solid #E2E8F0",borderRadius:"8px"}})]}),u.jsxs("div",{children:[u.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:"600",color:"#475569",marginBottom:"6px"},children:"Service Type *"}),u.jsx("select",{value:U.serviceType,onChange:Z=>oe(j=>({...j,serviceType:Z.target.value})),style:{width:"100%",padding:"10px",fontSize:"14px",border:"1.5px solid #E2E8F0",borderRadius:"8px"},children:EF.map(Z=>u.jsx("option",{value:Z,children:Z},Z))})]}),u.jsxs("div",{children:[u.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:"600",color:"#475569",marginBottom:"6px"},children:"Description *"}),u.jsx("textarea",{value:U.description,onChange:Z=>oe(j=>({...j,description:Z.target.value})),placeholder:"Service description...",rows:3,style:{width:"100%",padding:"10px",fontSize:"14px",border:"1.5px solid #E2E8F0",borderRadius:"8px",resize:"vertical"}})]}),u.jsxs("div",{style:{display:"flex",gap:"12px"},children:[u.jsxs("div",{style:{flex:1},children:[u.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:"600",color:"#475569",marginBottom:"6px"},children:"Date *"}),u.jsx("input",{type:"date",value:U.date,onChange:Z=>oe(j=>({...j,date:Z.target.value})),style:{width:"100%",padding:"10px",fontSize:"14px",border:"1.5px solid #E2E8F0",borderRadius:"8px"}})]}),u.jsxs("div",{style:{flex:1},children:[u.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:"600",color:"#475569",marginBottom:"6px"},children:"Amount (Base) *"}),u.jsx("input",{type:"number",value:U.amount,onChange:Z=>oe(j=>({...j,amount:Z.target.value})),placeholder:"0",style:{width:"100%",padding:"10px",fontSize:"14px",border:"1.5px solid #E2E8F0",borderRadius:"8px"}})]})]}),u.jsxs("div",{style:{display:"flex",gap:"12px",marginTop:"8px"},children:[u.jsx(Ye,{label:"Cancel",variant:"secondary",onClick:()=>M(!1)}),u.jsx(Ye,{label:"Add Service",icon:nf,onClick:wF})]})]})})]})},kF=p=>{const T=p.map(L=>{const q=L.cnMatch,Z=q?Math.abs(parseFloat(q.isSystemCN?q.totalAmount:q.credit)||0):0,j=Oe.filter(de=>de.invoiceNo===L.invoiceNo),me=j.reduce((de,ee)=>de+(parseFloat(ee.amount)||0),0),ie=j.reduce((de,ee)=>de+(parseFloat(ee.tdsAmount)||0),0),pe=L.totalAmount-me-ie-Z;return{"Invoice No":L.invoiceNo,Date:L.date,"Party Name":L.partyName,Type:L.isService?"Service":L.invoiceType||"Individual",Source:L.source||"Campaign",Amount:L.totalAmount,Received:me,TDS:ie,"CN Amount":Z,Balance:pe,"Invoice Status":L.invoiceStatus,"Receipt Status":pe<=0?"Paid":"Pending","Receipt No":j.map(de=>de.receiptNo).join(", "),"CN No":q?q.isSystemCN?q.creditNoteNo:q.vchNo:""}}),H=Rr.json_to_sheet(T),W=Rr.book_new();Rr.book_append_sheet(W,H,"Invoice Register"),Ac(W,`Invoice_Register_${new Date().toISOString().split("T")[0]}.xlsx`)},CF=()=>{const p=Rr.book_new();if(Mi.forEach(T=>{const H=T.partyName,W=T.normalizedState,L=cn[H]||0,q=[...un,...Ks].filter(de=>qt(de.partyName,H)&&de.invoiceGenerated&&de.invoiceStatus==="Approved"&&(!W||jr(de.statePartyDetails)===W)),Z=W?[]:Nt.filter(de=>qt(de.partyName,H)&&de.isHistorical&&de.type!=="creditnote"),j=Oe.filter(de=>qt(de.partyName,H));ne.filter(de=>qt(de.partyName,H));const me=[];let ie=L;L!==0&&me.push({Date:"",Particular:"Opening Balance","Vch Type":"","Vch No":"",Debit:L>0?L:"",Credit:L<0?Math.abs(L):"","Amount Received":"",TDS:"",Balance:L});const pe=new Map;if(q.forEach(de=>{pe.has(de.invoiceNo)||pe.set(de.invoiceNo,{date:de.invoiceDate,amount:parseFloat(de.invoiceTotalAmount)||0})}),pe.forEach((de,ee)=>{ie+=de.amount;const Ke=j.filter(Xe=>Xe.invoiceNo===ee),xe=Ke.reduce((Xe,Qe)=>Xe+(parseFloat(Qe.amount)||0),0),Me=Ke.reduce((Xe,Qe)=>Xe+(parseFloat(Qe.tdsAmount)||0),0);me.push({Date:Vt(de.date),Particular:H,"Vch Type":"Sales","Vch No":ee,Debit:de.amount,Credit:"","Amount Received":xe||"",TDS:Me||"",Balance:ie}),(xe>0||Me>0)&&(ie-=xe+Me)}),Z.forEach(de=>{const ee=parseFloat(de.debit)||0,Ke=parseFloat(de.credit)||0;ie+=ee-Ke,me.push({Date:Vt(de.date),Particular:de.particular||H,"Vch Type":de.vchType||"Sales","Vch No":de.vchNo||"",Debit:ee||"",Credit:Ke||"","Amount Received":"",TDS:"",Balance:ie})}),me.length>0){let de=H.substring(0,25).replace(/[\\\/\*\?\[\]:]/g,"");W&&(de+="-"+W.substring(0,4));const ee=Rr.json_to_sheet(me);Rr.book_append_sheet(p,ee,de)}}),p.SheetNames.length===0){alert("No ledger data to export");return}Ac(p,`All_Party_Ledgers_${new Date().toISOString().split("T")[0]}.xlsx`)},FF=()=>{const p=so.map(W=>({"Receipt No":W.receiptNo,Date:W.date,"Party Name":W.partyName,"Invoice No":W.invoiceNo,"Amount Received":parseFloat(W.amount)||0,"TDS Amount":parseFloat(W.tdsAmount)||0,Total:(parseFloat(W.amount)||0)+(parseFloat(W.tdsAmount)||0),"Payment Mode":W.paymentMode||"Bank Transfer",Narration:W.narration||""})),T=Rr.json_to_sheet(p),H=Rr.book_new();Rr.book_append_sheet(H,T,"Receipt Register"),Ac(H,`Receipt_Register_${new Date().toISOString().split("T")[0]}.xlsx`)},IF=p=>{const T=`
<!DOCTYPE html>
<html>
<head>
  <title>Receipt Voucher - ${p.receiptNo}</title>
  <style>
    @media print { @page { size: A5; margin: 10mm; } }
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: Arial, sans-serif; font-size: 12px; padding: 20px; }
    .voucher { max-width: 600px; margin: 0 auto; border: 2px solid #000; }
    .header { text-align: center; padding: 15px; border-bottom: 2px solid #000; background: #f5f5f5; }
    .title { font-size: 18px; font-weight: bold; color: #1a5276; }
    .company { font-size: 14px; font-weight: bold; margin-top: 5px; }
    .details { padding: 15px; }
    .row { display: flex; margin-bottom: 10px; }
    .label { width: 140px; font-weight: bold; color: #475569; }
    .value { flex: 1; }
    .amount-box { background: #e8f4fd; padding: 15px; margin: 15px 0; border-radius: 8px; text-align: center; }
    .amount { font-size: 24px; font-weight: bold; color: #1a5276; }
    .footer { padding: 15px; border-top: 1px solid #ddd; display: flex; justify-content: space-between; }
    .signature { text-align: center; margin-top: 40px; }
    .signature-line { border-top: 1px solid #000; width: 150px; margin: 0 auto; padding-top: 5px; }
  </style>
</head>
<body>
  <div class="voucher">
    <div class="header">
      <div class="title">RECEIPT VOUCHER</div>
      <div class="company">${w.name}</div>
      <div style="font-size: 10px; color: #666; margin-top: 3px;">${w.address}, ${w.city}</div>
    </div>
    <div class="details">
      <div class="row"><div class="label">Receipt No:</div><div class="value" style="font-weight: bold; color: #1a5276;">${p.receiptNo}</div></div>
      <div class="row"><div class="label">Date:</div><div class="value">${Vt(p.date)}</div></div>
      <div class="row"><div class="label">Received From:</div><div class="value" style="font-weight: bold;">${p.partyName}</div></div>
      <div class="row"><div class="label">Against Invoice:</div><div class="value">${p.invoiceNo}</div></div>
      <div class="row"><div class="label">Payment Mode:</div><div class="value">${p.paymentMode||"Bank Transfer"}</div></div>
      ${p.narration?`<div class="row"><div class="label">Narration:</div><div class="value">${p.narration}</div></div>`:""}
      
      <div class="amount-box">
        <div style="font-size: 12px; color: #666;">Amount Received</div>
        <div class="amount">${(parseFloat(p.amount)||0).toLocaleString("en-IN",{minimumFractionDigits:2})}</div>
        ${p.tdsAmount&&parseFloat(p.tdsAmount)>0?`<div style="font-size: 11px; color: #666; margin-top: 5px;">TDS Deducted: ${parseFloat(p.tdsAmount).toLocaleString("en-IN",{minimumFractionDigits:2})}</div>`:""}
        <div style="font-size: 11px; margin-top: 8px;"><strong>Total:</strong> ${((parseFloat(p.amount)||0)+(parseFloat(p.tdsAmount)||0)).toLocaleString("en-IN",{minimumFractionDigits:2})}</div>
      </div>
      
      <div style="font-size: 11px; color: #666; margin-top: 10px;">
        <strong>Amount in words:</strong> ${K0((parseFloat(p.amount)||0)+(parseFloat(p.tdsAmount)||0))}
      </div>
    </div>
    <div class="footer">
      <div class="signature">
        <div class="signature-line">Receiver's Signature</div>
      </div>
      <div class="signature">
        <div class="signature-line">Authorised Signatory</div>
      </div>
    </div>
  </div>
</body>
</html>`,H=window.open("","_blank");H.document.write(T),H.document.close(),H.print()},bF=p=>{const T=`
<!DOCTYPE html>
<html>
<head>
  <title>Credit Note - ${p.creditNoteNo}</title>
  <style>
    @media print { @page { size: A5; margin: 10mm; } }
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: Arial, sans-serif; font-size: 12px; padding: 20px; }
    .voucher { max-width: 600px; margin: 0 auto; border: 2px solid #000; }
    .header { text-align: center; padding: 15px; border-bottom: 2px solid #000; background: #fef3c7; }
    .title { font-size: 18px; font-weight: bold; color: #92400e; }
    .company { font-size: 14px; font-weight: bold; margin-top: 5px; }
    .details { padding: 15px; }
    .row { display: flex; margin-bottom: 10px; }
    .label { width: 140px; font-weight: bold; color: #475569; }
    .value { flex: 1; }
    .amount-box { background: #fef3c7; padding: 15px; margin: 15px 0; border-radius: 8px; text-align: center; }
    .amount { font-size: 24px; font-weight: bold; color: #92400e; }
    .footer { padding: 15px; border-top: 1px solid #ddd; display: flex; justify-content: space-between; }
    .signature { text-align: center; margin-top: 40px; }
    .signature-line { border-top: 1px solid #000; width: 150px; margin: 0 auto; padding-top: 5px; }
  </style>
</head>
<body>
  <div class="voucher">
    <div class="header">
      <div class="title">CREDIT NOTE</div>
      <div class="company">${w.name}</div>
      <div style="font-size: 10px; color: #666; margin-top: 3px;">${w.address}, ${w.city}</div>
    </div>
    <div class="details">
      <div class="row"><div class="label">Credit Note No:</div><div class="value" style="font-weight: bold; color: #92400e;">${p.creditNoteNo}</div></div>
      <div class="row"><div class="label">Date:</div><div class="value">${Vt(p.date)}</div></div>
      <div class="row"><div class="label">Party Name:</div><div class="value" style="font-weight: bold;">${p.partyName}</div></div>
      <div class="row"><div class="label">Against Invoice:</div><div class="value">${p.invoiceNo}</div></div>
      <div class="row"><div class="label">Reason:</div><div class="value">${p.reason||"Discount / Adjustment"}</div></div>
      
      <div class="amount-box">
        <div style="font-size: 12px; color: #666;">Credit Amount</div>
        <div class="amount">${(parseFloat(p.totalAmount)||0).toLocaleString("en-IN",{minimumFractionDigits:2})}</div>
        <div style="font-size: 10px; color: #666; margin-top: 5px;">
          Base: ${(parseFloat(p.baseAmount)||0).toLocaleString("en-IN")} | 
          GST: ${((parseFloat(p.cgstAmount)||0)+(parseFloat(p.sgstAmount)||0)+(parseFloat(p.igstAmount)||0)).toLocaleString("en-IN")}
        </div>
      </div>
      
      <div style="font-size: 11px; color: #666; margin-top: 10px;">
        <strong>Amount in words:</strong> ${K0(parseFloat(p.totalAmount)||0)}
      </div>
    </div>
    <div class="footer">
      <div class="signature">
        <div class="signature-line">Party Signature</div>
      </div>
      <div class="signature">
        <div class="signature-line">Authorised Signatory</div>
      </div>
    </div>
  </div>
</body>
</html>`,H=window.open("","_blank");H.document.write(T),H.document.close(),H.print()},RF=()=>{const p=new Map;un.filter(ie=>ie.invoiceGenerated).forEach(ie=>{p.has(ie.invoiceNo)?p.get(ie.invoiceNo).campaigns.push(ie):p.set(ie.invoiceNo,{invoiceNo:ie.invoiceNo,partyName:ie.partyName,date:ie.invoiceDate,invoiceType:ie.invoiceType,combinationCode:ie.combinationCode,invoiceStatus:ie.invoiceStatus,mailingSent:ie.mailingSent,receiptStatus:ie.receiptStatus||"Pending",receiptNo:ie.receiptNo,campaigns:[ie],totalAmount:parseFloat(ie.invoiceTotalAmount)||0,isFromMaster:!0,source:"Campaign"})}),Ks.filter(ie=>ie.invoiceGenerated).forEach(ie=>{p.has(ie.invoiceNo)||p.set(ie.invoiceNo,{invoiceNo:ie.invoiceNo,partyName:ie.partyName,date:ie.invoiceDate,invoiceType:"Service",combinationCode:"NA",invoiceStatus:ie.invoiceStatus,mailingSent:ie.mailingSent,receiptStatus:ie.receiptStatus||"Pending",receiptNo:ie.receiptNo,campaigns:[ie],totalAmount:parseFloat(ie.invoiceTotalAmount)||0,isFromMaster:!1,isService:!0,source:"Service",serviceType:ie.serviceType})});const T=ie=>{if(!ie)return"";const pe=ie.split("/");return pe.length>=3?pe.slice(1).join("/"):pe.length===2?pe.join("/"):pe[pe.length-1]},H=Nt.filter(ie=>{var pe;return ie.isHistorical&&(ie.type==="creditnote"||((pe=ie.vchNo)==null?void 0:pe.toUpperCase().startsWith("CN")))}),W=new Map;ao.forEach(ie=>{const pe=T(ie.invoiceNo);pe&&W.set(pe,ie)}),H.forEach(ie=>{const pe=T(ie.vchNo);pe&&!W.has(pe)&&W.set(pe,ie)}),Nt.filter(ie=>{var pe;return ie.isHistorical&&ie.type!=="creditnote"&&!((pe=ie.vchNo)!=null&&pe.toUpperCase().startsWith("CN"))&&ie.debit>0}).forEach(ie=>{if(!p.has(ie.vchNo)){const pe=so.find(yt=>yt.invoiceNo===ie.vchNo),de=T(ie.vchNo),ee=W.get(de),Ke=ee?Math.abs(parseFloat(ee.totalAmount)||parseFloat(ee.credit)||parseFloat(ee.debit)||0):0,xe=parseFloat(ie.debit)||0;if(ee&&Ke>=xe)return;const Xe=!pe&&!(ie.amountReceived>0),Qe=ee&&Ke>0&&Ke<xe;if(Xe||Qe){const yt=Qe?xe-Ke:xe;p.set(ie.vchNo,{invoiceNo:ie.vchNo,partyName:ie.partyName,date:ie.date,invoiceType:"Historical",combinationCode:"",invoiceStatus:"Approved",mailingSent:"Yes",receiptStatus:Qe?"Partial CN":"Pending",receiptNo:"",campaigns:[],totalAmount:xe,pendingAmount:yt,hasPartialCN:Qe,cnAmount:Ke,isHistorical:!0,historicalEntry:ie})}}});let L=Array.from(p.values());if(fe.party&&(L=L.filter(ie=>qt(ie.partyName,fe.party))),fe.invoiceStatus&&(L=L.filter(ie=>ie.invoiceStatus===fe.invoiceStatus)),fe.receiptStatus&&(fe.receiptStatus==="Received"?L=L.filter(ie=>ie.receiptStatus==="Received"):fe.receiptStatus==="Pending"&&(L=L.filter(ie=>ie.receiptStatus!=="Received"))),fe.invoiceType&&(L=L.filter(ie=>ie.invoiceType===fe.invoiceType)),fe.searchText){const ie=fe.searchText.toLowerCase();L=L.filter(pe=>{var de,ee;return((de=pe.invoiceNo)==null?void 0:de.toLowerCase().includes(ie))||((ee=pe.partyName)==null?void 0:ee.toLowerCase().includes(ie))})}const q={};L.forEach(ie=>{q[ie.partyName]||(q[ie.partyName]=[]),q[ie.partyName].push(ie)});const Z=Object.keys(q).sort(),j=fe.party||fe.invoiceStatus||fe.receiptStatus||fe.invoiceType||fe.searchText,me=Array.from(p.values());return u.jsxs("div",{children:[u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[u.jsx("h1",{style:{margin:0,fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:" Invoice & Receipt Register"}),u.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[u.jsx(Ye,{icon:xo,label:"Export Excel",variant:"secondary",onClick:()=>kF(L)}),Vr&&u.jsx("span",{style:{padding:"8px 16px",backgroundColor:"#FEF3C7",borderRadius:"8px",fontSize:"13px",color:"#92400E",fontWeight:"600"},children:" View Only"})]})]}),u.jsx("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"10px",border:"1px solid #E2E8F0",padding:"14px 18px",marginBottom:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"14px",flexWrap:"wrap"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[u.jsx(Gg,{size:18,color:"#64748B"}),u.jsx("span",{style:{fontSize:"13px",fontWeight:"700",color:"#475569"},children:"Filters:"})]}),u.jsxs("div",{style:{position:"relative"},children:[u.jsx(U0,{size:14,style:{position:"absolute",left:"10px",top:"50%",transform:"translateY(-50%)",color:"#94A3B8"}}),u.jsx("input",{type:"text",placeholder:"Search invoice...",value:fe.searchText,onChange:ie=>le(pe=>({...pe,searchText:ie.target.value})),style:{padding:"8px 12px 8px 32px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",width:"160px"}})]}),u.jsxs("select",{value:fe.party,onChange:ie=>le(pe=>({...pe,party:ie.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:"#FFFFFF"},children:[u.jsx("option",{value:"",children:"All Parties"}),gl.map(ie=>u.jsx("option",{value:ie,children:ie},ie))]}),u.jsxs("select",{value:fe.invoiceStatus,onChange:ie=>le(pe=>({...pe,invoiceStatus:ie.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:"#FFFFFF"},children:[u.jsx("option",{value:"",children:"All Status"}),u.jsx("option",{value:"Created",children:"Created"}),u.jsx("option",{value:"Approved",children:"Approved"}),u.jsx("option",{value:"Need Edits",children:"Need Edits"})]}),u.jsxs("select",{value:fe.receiptStatus,onChange:ie=>le(pe=>({...pe,receiptStatus:ie.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:"#FFFFFF"},children:[u.jsx("option",{value:"",children:"All Receipts"}),u.jsx("option",{value:"Received",children:"Received"}),u.jsx("option",{value:"Pending",children:"Pending"})]}),u.jsxs("select",{value:fe.invoiceType,onChange:ie=>le(pe=>({...pe,invoiceType:ie.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:"#FFFFFF"},children:[u.jsx("option",{value:"",children:"All Types"}),u.jsx("option",{value:"Individual",children:"Individual"}),u.jsx("option",{value:"Combined",children:"Combined"})]}),j&&u.jsxs(u.Fragment,{children:[u.jsxs("button",{onClick:()=>le({party:"",invoiceStatus:"",receiptStatus:"",invoiceType:"",searchText:""}),style:{padding:"8px 12px",fontSize:"13px",fontWeight:"600",border:"1.5px solid #FCA5A5",borderRadius:"8px",backgroundColor:"#FEE2E2",color:"#991B1B",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},children:[u.jsx(El,{size:14})," Clear"]}),u.jsxs("span",{style:{fontSize:"13px",color:"#64748B"},children:["Showing ",L.length," of ",me.length]})]})]})}),u.jsx(Zr,{noPadding:!0,children:u.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"12px"},children:[u.jsx("thead",{children:u.jsxs("tr",{style:{backgroundColor:"#F8FAFC",borderBottom:"2px solid #E2E8F0"},children:[u.jsx("th",{style:{padding:"10px 12px",textAlign:"left",fontWeight:"700"},children:"Invoice No"}),u.jsx("th",{style:{padding:"10px 12px",textAlign:"left",fontWeight:"700"},children:"Date"}),u.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Type"}),u.jsx("th",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700"},children:"Amount"}),u.jsx("th",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700",backgroundColor:"#F0FDF4",color:"#166534"},children:"Received"}),u.jsx("th",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700",backgroundColor:"#FEF3C7",color:"#92400E"},children:"TDS"}),u.jsx("th",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700",backgroundColor:"#FEE2E2",color:"#991B1B"},children:"CN Amt"}),u.jsx("th",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700",backgroundColor:"#EFF6FF",color:"#1E40AF"},children:"Balance"}),u.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Inv. Status"}),u.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Receipt No."}),u.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"CN No."}),u.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Actions"})]})}),u.jsx("tbody",{children:Z.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:"12",style:{padding:"50px",textAlign:"center",color:"#94A3B8"},children:j?"No matching invoices":"No invoices generated yet"})}):Z.map(ie=>{const pe=q[ie],de=Vu.has(ie);let ee=0;return pe.forEach(Ke=>{const xe=Oe.find(jt=>jt.invoiceNo===Ke.invoiceNo),Me=ne.find(jt=>jt.invoiceNo===Ke.invoiceNo),Xe=re.find(jt=>jt.invoiceNo===Ke.invoiceNo&&jt.type==="tds"),Qe=re.find(jt=>jt.invoiceNo===Ke.invoiceNo&&jt.type==="discount"),yt=Ke.totalAmount||0,Bt=xe&&parseFloat(xe.amount)||0,Ht=Xe?parseFloat(Xe.credit)||0:xe&&parseFloat(xe.tds)||0,He=Me?Math.abs(parseFloat(Me.totalAmount)||0):0,_t=Qe&&parseFloat(Qe.credit)||0,cr=Math.max(0,yt-Bt-Ht-He-_t);ee+=cr}),u.jsxs(Q0.Fragment,{children:[u.jsxs("tr",{onClick:()=>my(ie),style:{backgroundColor:"#1E3A5F",color:"white",cursor:"pointer",borderBottom:"1px solid #0F2744"},children:[u.jsx("td",{colSpan:"3",style:{padding:"10px 12px",fontWeight:"700",fontSize:"13px"},children:u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[de?u.jsx(X2,{size:18}):u.jsx(Hg,{size:18}),u.jsx(Z2,{size:16}),ie,u.jsxs("span",{style:{backgroundColor:"#2874A6",padding:"2px 10px",borderRadius:"12px",fontSize:"11px",fontWeight:"600"},children:[pe.length," inv"]})]})}),u.jsx("td",{colSpan:"4",style:{padding:"10px 12px"}}),u.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700",fontSize:"13px",backgroundColor:ee===0?"#22C55E":"#3B82F6"},children:ee===0?" Nil":`Bal: ${et(ee)}`}),u.jsx("td",{colSpan:"4",style:{padding:"10px 12px"}})]}),de&&pe.map(Ke=>{const xe=Oe.find($t=>$t.invoiceNo===Ke.invoiceNo),Me=ne.find($t=>$t.invoiceNo===Ke.invoiceNo),Xe=re.find($t=>$t.invoiceNo===Ke.invoiceNo&&$t.type==="tds"),Qe=re.find($t=>$t.invoiceNo===Ke.invoiceNo&&$t.type==="discount"),yt=Ke.totalAmount||0,Bt=xe&&parseFloat(xe.amount)||0,Ht=Xe?parseFloat(Xe.credit)||0:xe&&parseFloat(xe.tds)||0,He=Me?Math.abs(parseFloat(Me.totalAmount)||0):0,_t=Qe&&parseFloat(Qe.credit)||0,cr=Math.max(0,yt-Bt-Ht-He-_t),jt=He>=yt&&!xe;return u.jsxs("tr",{style:{borderBottom:"1px solid #F1F5F9",backgroundColor:Ke.invoiceType==="Combined"?"#FAF5FF":cr===0?"#F0FDF4":"transparent"},children:[u.jsx("td",{style:{padding:"10px 12px 10px 36px",fontWeight:"700",color:Ke.invoiceType==="Combined"?"#7C3AED":"#2874A6"},children:Ke.invoiceNo}),u.jsx("td",{style:{padding:"10px 12px"},children:Vt(Ke.date)}),u.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:u.jsx(lm,{status:Ke.invoiceType,small:!0})}),u.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700"},children:et(yt)}),u.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"600",backgroundColor:"#F0FDF4",color:Bt>0?"#166534":"#94A3B8"},children:Bt>0?et(Bt):"-"}),u.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"600",backgroundColor:"#FEF3C7",color:Ht>0?"#92400E":"#94A3B8"},children:Ht>0?et(Ht):"-"}),u.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"600",backgroundColor:"#FEE2E2",color:He>0?"#991B1B":"#94A3B8"},children:He>0?et(He):"-"}),u.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700",backgroundColor:"#EFF6FF",color:cr>0?"#1E40AF":"#166534"},children:cr===0?" Nil":et(cr)}),u.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:u.jsx(lm,{status:Ke.invoiceStatus,small:!0})}),u.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:jt?u.jsx("span",{style:{padding:"4px 10px",borderRadius:"12px",fontSize:"11px",fontWeight:"700",backgroundColor:"#FEE2E2",color:"#991B1B"},children:" Cancelled"}):xe?u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px",justifyContent:"center"},children:[u.jsxs("button",{onClick:()=>rF(xe),style:{padding:"4px 8px",borderRadius:"12px",fontSize:"10px",fontWeight:"700",backgroundColor:"#DCFCE7",color:"#166534",border:"none",cursor:"pointer",textDecoration:"underline"},title:"Click to view receipt",children:[" ",xe.receiptNo]}),lr&&u.jsx("button",{onClick:()=>co(xe),style:{padding:"2px 4px",borderRadius:"4px",fontSize:"10px",backgroundColor:"#FEE2E2",color:"#991B1B",border:"none",cursor:"pointer"},title:"Delete Receipt",children:""})]}):u.jsx("span",{style:{padding:"4px 10px",borderRadius:"12px",fontSize:"11px",fontWeight:"600",backgroundColor:"#FEF3C7",color:"#92400E"},children:" Pending"})}),u.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:Me?u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px",justifyContent:"center"},children:[u.jsx("button",{onClick:()=>nF(Me),style:{padding:"4px 8px",borderRadius:"12px",fontSize:"10px",fontWeight:"700",backgroundColor:"#FEE2E2",color:"#991B1B",border:"none",cursor:"pointer",textDecoration:"underline"},title:"Click to view credit note",children:Me.creditNoteNo}),lr&&u.jsx("button",{onClick:()=>Li(Me),style:{padding:"2px 4px",borderRadius:"4px",fontSize:"10px",backgroundColor:"#FEE2E2",color:"#991B1B",border:"none",cursor:"pointer"},title:"Delete Credit Note",children:""})]}):u.jsx("span",{style:{color:"#94A3B8",fontSize:"11px"},children:"-"})}),u.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:u.jsx("div",{style:{display:"flex",gap:"4px",justifyContent:"center",flexWrap:"wrap"},children:Ke.isHistorical?u.jsxs(u.Fragment,{children:[lr&&!xe&&u.jsx(Ye,{icon:vl,small:!0,variant:"success",onClick:()=>{const $t={invoiceNo:Ke.invoiceNo,partyName:Ke.partyName,invoiceDate:Ke.date,invoiceTotalAmount:Ke.totalAmount,invoiceStatus:"Approved",mailingSent:"Yes",invoiceType:"Historical",isHistorical:!0};he($t)},title:"Create Receipt"}),lr&&!Me&&u.jsx(Ye,{icon:rf,small:!0,variant:"primary",onClick:()=>{const $t={invoiceNo:Ke.invoiceNo,partyName:Ke.partyName,invoiceDate:Ke.date,invoiceTotalAmount:Ke.totalAmount,invoiceStatus:"Approved",isHistorical:!0};Jt($t)},title:"Credit Note"})]}):u.jsxs(u.Fragment,{children:[u.jsx(Ye,{icon:B0,small:!0,variant:"brand",onClick:()=>Gu(Ke.campaigns[0]),title:"View Invoice"}),lr&&Ke.invoiceStatus==="Approved"&&Ke.mailingSent==="Yes"&&!xe&&u.jsx(Ye,{icon:vl,small:!0,variant:"success",onClick:()=>he(Ke.campaigns[0]),title:"Create Receipt"}),lr&&Ke.invoiceStatus==="Approved"&&!Me&&u.jsx(Ye,{icon:rf,small:!0,variant:"primary",onClick:()=>Jt(Ke.campaigns[0]),title:"Credit Note"}),lr&&u.jsx(Ye,{icon:Fs,small:!0,variant:"danger",onClick:()=>Qr(Ke.campaigns[0]),title:"Delete Invoice"})]})})})]},Ke.invoiceNo)})]},ie)})})]})})]})},NF=()=>{if(!Y){alert("Please select a party first");return}const p=cn[Y]||0,T=_e.filter(J=>qt(J.partyName,Y)&&J.invoiceGenerated&&J.invoiceStatus==="Approved"&&(!Ee||jr(J.statePartyDetails)===Ee)),H=new Map;T.forEach(J=>{H.has(J.invoiceNo)?H.get(J.invoiceNo).campaigns.push(J):H.set(J.invoiceNo,{invoiceNo:J.invoiceNo,invoiceDate:J.invoiceDate,campaigns:[J],isFromMaster:!0})});const W=new Set(Array.from(H.keys())),L=Ee?[]:re.filter(J=>{var Le;return qt(J.partyName,Y)&&J.isHistorical&&J.type!=="creditnote"&&!((Le=J.vchNo)!=null&&Le.toUpperCase().startsWith("CN"))}),q=Ee?[]:re.filter(J=>{var Le;return qt(J.partyName,Y)&&J.isHistorical&&(J.type==="creditnote"||((Le=J.vchNo)==null?void 0:Le.toUpperCase().startsWith("CN")))}),Z=Oe.filter(J=>qt(J.partyName,Y)&&(!Ee||W.has(J.invoiceNo))),j=ne.filter(J=>qt(J.partyName,Y)&&(!Ee||W.has(J.invoiceNo))),me=J=>{if(!J)return"";const Le=J.split("/");return Le.length>=3?Le.slice(1).join("/"):Le.length===2?Le.join("/"):Le[Le.length-1]},ie=new Map;j.forEach(J=>{const Le=me(J.invoiceNo);Le&&!ie.has(Le)&&ie.set(Le,{...J,isSystemCN:!0})}),q.forEach(J=>{const Le=me(J.vchNo);Le&&!ie.has(Le)&&ie.set(Le,{...J,isHistoricalCN:!0})});let pe=[],de=0,ee=0,Ke=0,xe=0,Me=p;const Xe=new Set;p!==0&&(de+=p>0?p:0,ee+=p<0?Math.abs(p):0,pe.push({date:"",particular:"Opening Balance",vchType:"",vchNo:"",debit:p>0?p:0,credit:p<0?Math.abs(p):0,receiptDate:"",amountReceived:0,tds:0,balance:p,status:"",isMain:!0,isOpening:!0}));const Qe=[];Array.from(H.values()).filter(J=>{const Le=new Date(J.invoiceDate);return Le>=new Date(an.fromDate)&&Le<=new Date(an.toDate)}).forEach(J=>{Qe.push({...J,entryType:"invoice",sortDate:J.invoiceDate})}),L.filter(J=>{if(!J.date)return!1;const Le=new Date(J.date);return Le>=new Date(an.fromDate)&&Le<=new Date(an.toDate)}).forEach(J=>{Qe.push({...J,entryType:"invoice",sortDate:J.date})}),Qe.sort((J,Le)=>new Date(J.sortDate)-new Date(Le.sortDate)),Qe.forEach(J=>{var Le,Un;if(J.isFromMaster){const It=J;let zr=0;It.campaigns.forEach(Hn=>zr+=parseFloat(Hn.invoiceAmount)||0);const Wr=(Un=(Le=It.campaigns[0])==null?void 0:Le.statePartyDetails)==null?void 0:Un.toUpperCase().includes("MAHARASHTRA"),er=Wr?zr*.09:0,zn=Wr?zr*.09:0,En=Wr?0:zr*.18,dn=zr+er+zn+En,As=me(It.invoiceNo),Gt=ie.get(As),Wn=!!Gt,Ti=Z.find(Hn=>Hn.invoiceNo===It.invoiceNo);Me+=dn,de+=dn;let wa=0,fo=0,Sa="",ho=Wn?"":"Pending";if(Ti&&(ho="Received",wa=Ti.amount||0,fo=Ti.tds||0,Sa=Ti.date,Ke+=wa,xe+=fo,Me-=wa+fo+(Ti.discount||0)),pe.push({date:It.invoiceDate,particular:Y,vchType:"Sales",vchNo:It.invoiceNo,debit:dn,credit:0,receiptDate:Sa,amountReceived:wa,tds:fo,balance:Wn?"-":ho==="Received"?0:dn-wa-fo,status:ho,isMain:!0,hasCN:Wn}),pe.push({particular:"PROMOTIONAL TRADE EMAILER"+(It.campaigns.length>1?"S":""),credit:zr,isMain:!1,hasCN:Wn}),Wr?(pe.push({particular:"CGST",credit:er,isMain:!1,hasCN:Wn}),pe.push({particular:"SGST",credit:zn,isMain:!1,hasCN:Wn})):pe.push({particular:"IGST",credit:En,isMain:!1,hasCN:Wn}),Gt&&!Xe.has(As)){Xe.add(As);const Hn=Math.abs(Gt.totalAmount||Gt.credit||0);Me-=Hn,ee+=Hn,pe.push({date:Gt.date,particular:Y,vchType:"Credit Note",vchNo:Gt.creditNoteNo||Gt.vchNo,debit:0,credit:Hn,receiptDate:"",amountReceived:0,tds:0,balance:"-",status:"",isMain:!0,isCreditNote:!0,hasCN:!0});const po=Math.abs(Gt.amount)||Hn/1.18,ml=Math.abs(Gt.gst)||Hn-po;pe.push({particular:"PROMOTIONAL TRADE EMAILER",credit:po,isMain:!1,isCreditNote:!0,hasCN:!0}),pe.push({particular:Gt.gstType||(Wr?"CGST + SGST":"IGST"),credit:ml,isMain:!1,isCreditNote:!0,hasCN:!0})}}else if(J.isHistorical){const It=J.debit||0,zr=J.credit||0,Wr=me(J.vchNo),er=ie.get(Wr),zn=!!er;if(Me+=It-zr,de+=It,ee+=zr,pe.push({date:J.date,particular:J.particulars||Y,vchType:J.vchType||"Sales",vchNo:J.vchNo,debit:It,credit:zr,receiptDate:J.receiptDate||"",amountReceived:J.amountReceived||0,tds:J.tdsReceived||0,balance:zn?"-":It-(J.amountReceived||0)-(J.tdsReceived||0),status:zn?"":J.paymentStatus||"",isMain:!0,isHistorical:!0,hasCN:zn}),J.subRows&&J.subRows.length>0&&J.subRows.forEach(En=>{pe.push({particular:En.particular,debit:En.debit,credit:En.credit,isMain:!1,hasCN:zn})}),er&&!Xe.has(Wr)){Xe.add(Wr);const En=Math.abs(er.totalAmount||er.credit||0);Me-=En,ee+=En,pe.push({date:er.date,particular:Y,vchType:"Credit Note",vchNo:er.creditNoteNo||er.vchNo,debit:0,credit:En,receiptDate:"",amountReceived:0,tds:0,balance:"-",status:"",isMain:!0,isCreditNote:!0,hasCN:!0}),er.subRows&&er.subRows.length>0&&er.subRows.forEach(dn=>{pe.push({particular:dn.particular,credit:Math.abs(dn.credit||0),isMain:!1,isCreditNote:!0,hasCN:!0})})}}});const yt=pe.reduce((J,Le)=>Le.isMain&&typeof Le.balance=="number"&&Le.balance>0?J+Le.balance:J,0),Bt=(Y||"").trim().toUpperCase();let Ht={};Ee&&(Ht=Mi.find(J=>J.partyNameUpper===Bt&&J.normalizedState===Ee)||{}),Ht.state||(Ht=Mi.find(J=>J.partyNameUpper===Bt)||{});const He=_e.find(J=>{var Le;return((Le=J.partyName)==null?void 0:Le.trim().toUpperCase())===Bt}),_t=Ht.state||(He==null?void 0:He.statePartyDetails)||"",cr=Ht.address||Wu(Y,_t)||"",jt=Ht.gstin||hc(Y,_t),$t=`
<!DOCTYPE html>
<html>
<head>
  <title>Ledger Account - ${Y}</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: Arial, sans-serif; font-size: 11px; padding: 20px; }
    .header { text-align: center; margin-bottom: 15px; }
    .firm-name { font-size: 18px; font-weight: bold; color: #1E293B; }
    .firm-address { font-size: 10px; color: #666; margin-top: 2px; }
    .party-section { text-align: center; margin: 15px 0; padding: 10px; border: 1px solid #ddd; background: #f9f9f9; }
    .party-name { font-size: 14px; font-weight: bold; }
    .ledger-title { font-size: 11px; color: #666; }
    .party-address { font-size: 10px; color: #666; margin-top: 5px; }
    .party-gstin { font-size: 10px; color: #1a5276; margin-top: 3px; font-weight: 600; }
    .period { text-align: center; font-size: 11px; margin: 10px 0; font-weight: bold; }
    .totals { display: flex; justify-content: space-around; background: #e8f4fd; padding: 8px; margin-bottom: 10px; font-size: 10px; border: 1px solid #ccc; }
    .totals div { text-align: center; }
    .totals .label { color: #666; }
    .totals .value { font-weight: bold; font-size: 11px; }
    .closing-balance { text-align: center; background: #1E293B; color: white; padding: 10px; margin-bottom: 10px; font-size: 14px; font-weight: bold; }
    table { width: 100%; border-collapse: collapse; font-size: 10px; }
    th { background: #f0f0f0; border: 1px solid #ccc; padding: 6px 4px; text-align: left; font-weight: bold; }
    td { border: 1px solid #ddd; padding: 5px 4px; }
    .text-right { text-align: right; }
    .text-center { text-align: center; }
    .main-row { background: #fff; }
    .main-row-cn { background: #fffbeb; }
    .sub-row { background: #fafafa; }
    .sub-row-cn { background: #fffbeb; }
    .sub-row td { padding-left: 20px; color: #666; font-size: 9px; }
    .opening-row { background: #fef3c7; font-weight: bold; }
    .credit-note-row { background: #fffbeb; }
    .status-received { background: #dcfce7; color: #166534; padding: 2px 6px; border-radius: 3px; font-size: 9px; }
    .status-pending { background: #fef3c7; color: #92400e; padding: 2px 6px; border-radius: 3px; font-size: 9px; }
    .debit { color: #dc2626; }
    .credit { color: #059669; }
    @media print { 
      body { padding: 10px; } 
      @page { size: landscape; margin: 10mm; }
    }
  </style>
</head>
<body>
  <div class="header">
    <div class="firm-name">${w.name}</div>
    <div class="firm-address">${w.address}</div>
    <div class="firm-address">${w.addressLine2}, ${w.city}</div>
    <div class="firm-address">E-Mail: ${w.email}</div>
  </div>
  
  <div class="party-section">
    <div class="party-name">${Y}</div>
    <div class="ledger-title">Ledger Account</div>
    ${cr?`<div class="party-address">${cr}</div>`:""}
    ${_t?`<div class="party-address"> ${_t}</div>`:""}
    ${jt?`<div class="party-gstin">GSTIN: ${jt}</div>`:""}
  </div>
  
  <div class="period">${Vt(an.fromDate)} to ${Vt(an.toDate)}</div>
  
  <div class="closing-balance">
    Closing Balance: ${Dt(Math.abs(yt))} ${yt>0?"(Dr)":yt<0?"(Cr)":""}
  </div>
  
  <div class="totals">
    <div><div class="label">Debit</div><div class="value">${Dt(de)}</div></div>
    <div><div class="label">Credit</div><div class="value">${Dt(ee)}</div></div>
    <div><div class="label">Amount Received</div><div class="value credit">${Dt(Ke)}</div></div>
    <div><div class="label">TDS Received</div><div class="value">${Dt(xe)}</div></div>
  </div>
  
  <table>
    <thead>
      <tr>
        <th style="width:65px">Date</th>
        <th>Particular</th>
        <th style="width:70px" class="text-center">Vch Type</th>
        <th style="width:100px">Vch No.</th>
        <th style="width:80px" class="text-right">Debit</th>
        <th style="width:80px" class="text-right">Credit</th>
        <th style="width:70px" class="text-center">Date of Receipt</th>
        <th style="width:85px" class="text-right">Amount Received</th>
        <th style="width:70px" class="text-right">TDS Received</th>
        <th style="width:75px" class="text-right">Balance</th>
        <th style="width:70px" class="text-center">Payment Status</th>
      </tr>
    </thead>
    <tbody>
      ${pe.map(J=>J.isMain?`
        <tr class="${J.isOpening?"opening-row":J.hasCN||J.isCreditNote?"main-row-cn":"main-row"}">
          <td>${J.date?Vt(J.date):""}</td>
          <td style="font-weight:600">${J.particular}</td>
          <td class="text-center">${J.vchType||""}</td>
          <td style="color:#2874A6;font-weight:600">${J.vchNo||""}</td>
          <td class="text-right">${J.debit>0?Dt(J.debit):""}</td>
          <td class="text-right" style="color:#DC2626">${J.credit>0?Dt(J.credit):""}</td>
          <td class="text-center">${J.receiptDate?Vt(J.receiptDate):""}</td>
          <td class="text-right credit">${J.amountReceived>0?Dt(J.amountReceived):""}</td>
          <td class="text-right">${J.tds>0?Dt(J.tds):""}</td>
          <td class="text-right">${J.balance==="-"?"-":J.balance>0?Dt(J.balance):""}</td>
          <td class="text-center">${J.status?`<span class="${J.status==="Received"?"status-received":"status-pending"}">${J.status}</span>`:""}</td>
        </tr>
      `:`
        <tr class="${J.hasCN||J.isCreditNote?"sub-row-cn":"sub-row"}">
          <td></td>
          <td style="padding-left:20px;color:#666">${J.particular}</td>
          <td></td>
          <td></td>
          <td class="text-right">${J.debit?Dt(J.debit):""}</td>
          <td class="text-right">${J.credit?Dt(J.credit):""}</td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
        </tr>
      `).join("")}
    </tbody>
  </table>
  
  <script>window.onload = function() { window.print(); }<\/script>
</body>
</html>`,uo=window.open("","_blank");uo.document.write($t),uo.document.close()},DF=()=>{const p=[...so].sort((W,L)=>new Date(L.date)-new Date(W.date)),T=p.reduce((W,L)=>W+(parseFloat(L.amount)||0),0),H=p.reduce((W,L)=>W+(parseFloat(L.tdsAmount)||0),0);return u.jsxs("div",{style:{padding:"20px"},children:[u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[u.jsxs("div",{children:[u.jsx("h1",{style:{fontSize:"22px",fontWeight:"700",color:"#1E293B",marginBottom:"4px"},children:" Receipt Register"}),u.jsx("p",{style:{fontSize:"13px",color:"#64748B"},children:"All receipts and payments received"})]}),u.jsx("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:u.jsx(Ye,{icon:xo,label:"Export Excel",variant:"secondary",onClick:FF})})]}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"16px",marginBottom:"20px"},children:[u.jsxs("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"12px",padding:"20px",border:"1px solid #E2E8F0",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:[u.jsx("div",{style:{fontSize:"12px",fontWeight:"600",color:"#64748B",marginBottom:"8px"},children:"Total Receipts"}),u.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:p.length})]}),u.jsxs("div",{style:{backgroundColor:"#F0FDF4",borderRadius:"12px",padding:"20px",border:"1px solid #BBF7D0",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:[u.jsx("div",{style:{fontSize:"12px",fontWeight:"600",color:"#166534",marginBottom:"8px"},children:"Amount Received"}),u.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#166534"},children:et(T)})]}),u.jsxs("div",{style:{backgroundColor:"#FEF3C7",borderRadius:"12px",padding:"20px",border:"1px solid #FDE68A",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:[u.jsx("div",{style:{fontSize:"12px",fontWeight:"600",color:"#92400E",marginBottom:"8px"},children:"TDS Received"}),u.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#92400E"},children:et(H)})]})]}),u.jsx(Zr,{title:"All Receipts",noPadding:!0,children:u.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"12px"},children:[u.jsx("thead",{children:u.jsxs("tr",{style:{backgroundColor:"#F8FAFC",borderBottom:"2px solid #E2E8F0"},children:[u.jsx("th",{style:{padding:"12px",textAlign:"left",fontWeight:"700"},children:"Receipt No"}),u.jsx("th",{style:{padding:"12px",textAlign:"left",fontWeight:"700"},children:"Date"}),u.jsx("th",{style:{padding:"12px",textAlign:"left",fontWeight:"700"},children:"Party Name"}),u.jsx("th",{style:{padding:"12px",textAlign:"left",fontWeight:"700"},children:"Invoice No"}),u.jsx("th",{style:{padding:"12px",textAlign:"right",fontWeight:"700",backgroundColor:"#F0FDF4",color:"#166534"},children:"Amount"}),u.jsx("th",{style:{padding:"12px",textAlign:"right",fontWeight:"700",backgroundColor:"#FEF3C7",color:"#92400E"},children:"TDS"}),u.jsx("th",{style:{padding:"12px",textAlign:"right",fontWeight:"700"},children:"Total"}),u.jsx("th",{style:{padding:"12px",textAlign:"center",fontWeight:"700"},children:"Payment Mode"}),u.jsx("th",{style:{padding:"12px",textAlign:"center",fontWeight:"700"},children:"Actions"})]})}),u.jsx("tbody",{children:p.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:"9",style:{padding:"50px",textAlign:"center",color:"#94A3B8"},children:"No receipts recorded yet"})}):p.map(W=>u.jsxs("tr",{style:{borderBottom:"1px solid #F1F5F9"},children:[u.jsx("td",{style:{padding:"12px",fontWeight:"600",color:"#2874A6"},children:W.receiptNo}),u.jsx("td",{style:{padding:"12px"},children:Vt(W.date)}),u.jsx("td",{style:{padding:"12px",fontWeight:"500"},children:W.partyName}),u.jsx("td",{style:{padding:"12px",color:"#64748B"},children:W.invoiceNo}),u.jsx("td",{style:{padding:"12px",textAlign:"right",fontWeight:"600",color:"#166534",backgroundColor:"#F0FDF4"},children:et(parseFloat(W.amount)||0)}),u.jsx("td",{style:{padding:"12px",textAlign:"right",fontWeight:"600",color:"#92400E",backgroundColor:"#FEF3C7"},children:et(parseFloat(W.tdsAmount)||0)}),u.jsx("td",{style:{padding:"12px",textAlign:"right",fontWeight:"700"},children:et((parseFloat(W.amount)||0)+(parseFloat(W.tdsAmount)||0))}),u.jsx("td",{style:{padding:"12px",textAlign:"center"},children:u.jsx("span",{style:{padding:"4px 8px",fontSize:"10px",fontWeight:"600",borderRadius:"9999px",backgroundColor:"#E0E7FF",color:"#3730A3"},children:W.paymentMode||"Bank Transfer"})}),u.jsx("td",{style:{padding:"12px",textAlign:"center"},children:u.jsxs("button",{onClick:()=>IF(W),style:{padding:"6px 10px",fontSize:"11px",backgroundColor:"#2874A6",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",display:"inline-flex",alignItems:"center",gap:"4px"},children:[u.jsx(Yg,{size:12})," Print"]})})]},W.id||W.receiptNo))})]})}),u.jsx("div",{style:{marginTop:"30px"},children:u.jsx(Zr,{title:"Credit Notes",noPadding:!0,children:u.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"12px"},children:[u.jsx("thead",{children:u.jsxs("tr",{style:{backgroundColor:"#FEF3C7",borderBottom:"2px solid #FDE68A"},children:[u.jsx("th",{style:{padding:"12px",textAlign:"left",fontWeight:"700"},children:"CN No"}),u.jsx("th",{style:{padding:"12px",textAlign:"left",fontWeight:"700"},children:"Date"}),u.jsx("th",{style:{padding:"12px",textAlign:"left",fontWeight:"700"},children:"Party Name"}),u.jsx("th",{style:{padding:"12px",textAlign:"left",fontWeight:"700"},children:"Against Invoice"}),u.jsx("th",{style:{padding:"12px",textAlign:"right",fontWeight:"700"},children:"Base Amount"}),u.jsx("th",{style:{padding:"12px",textAlign:"right",fontWeight:"700"},children:"GST"}),u.jsx("th",{style:{padding:"12px",textAlign:"right",fontWeight:"700"},children:"Total"}),u.jsx("th",{style:{padding:"12px",textAlign:"left",fontWeight:"700"},children:"Reason"}),u.jsx("th",{style:{padding:"12px",textAlign:"center",fontWeight:"700"},children:"Actions"})]})}),u.jsx("tbody",{children:ao.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:"9",style:{padding:"50px",textAlign:"center",color:"#94A3B8"},children:"No credit notes recorded yet"})}):ao.map(W=>u.jsxs("tr",{style:{borderBottom:"1px solid #F1F5F9",backgroundColor:"#FFFBEB"},children:[u.jsx("td",{style:{padding:"12px",fontWeight:"600",color:"#92400E"},children:W.creditNoteNo}),u.jsx("td",{style:{padding:"12px"},children:Vt(W.date)}),u.jsx("td",{style:{padding:"12px",fontWeight:"500"},children:W.partyName}),u.jsx("td",{style:{padding:"12px",color:"#64748B"},children:W.invoiceNo}),u.jsx("td",{style:{padding:"12px",textAlign:"right"},children:et(parseFloat(W.baseAmount)||0)}),u.jsx("td",{style:{padding:"12px",textAlign:"right"},children:et((parseFloat(W.cgstAmount)||0)+(parseFloat(W.sgstAmount)||0)+(parseFloat(W.igstAmount)||0))}),u.jsx("td",{style:{padding:"12px",textAlign:"right",fontWeight:"700",color:"#92400E"},children:et(parseFloat(W.totalAmount)||0)}),u.jsx("td",{style:{padding:"12px",fontSize:"11px",color:"#64748B"},children:W.reason||"-"}),u.jsx("td",{style:{padding:"12px",textAlign:"center"},children:u.jsxs("button",{onClick:()=>bF(W),style:{padding:"6px 10px",fontSize:"11px",backgroundColor:"#92400E",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",display:"inline-flex",alignItems:"center",gap:"4px"},children:[u.jsx(Yg,{size:12})," Print"]})})]},W.id||W.creditNoteNo))})]})})})]})},PF=()=>{const p=(j,me)=>{const ie=cn[j]||0,pe=_e.filter(He=>qt(He.partyName,j)&&He.invoiceGenerated&&He.invoiceStatus==="Approved"&&(!me||jr(He.statePartyDetails)===me)),de=De.filter(He=>qt(He.partyName,j)&&He.invoiceGenerated&&He.invoiceStatus==="Approved"&&(!me||jr(He.statePartyDetails)===me)),ee=new Map;pe.forEach(He=>{ee.has(He.invoiceNo)?ee.get(He.invoiceNo).campaigns.push(He):ee.set(He.invoiceNo,{invoiceNo:He.invoiceNo,campaigns:[He],totalAmount:parseFloat(He.invoiceTotalAmount)||0})}),de.forEach(He=>{ee.has(He.invoiceNo)||ee.set(He.invoiceNo,{invoiceNo:He.invoiceNo,totalAmount:parseFloat(He.invoiceTotalAmount)||0,isService:!0})});const Ke=new Set(Array.from(ee.keys())),xe=Oe.filter(He=>qt(He.partyName,j)&&(!me||Ke.has(He.invoiceNo))),Me=ne.filter(He=>qt(He.partyName,j)&&(!me||Ke.has(He.invoiceNo))),Xe=me?[]:re.filter(He=>{var _t;return qt(He.partyName,j)&&He.isHistorical&&He.type!=="creditnote"&&!((_t=He.vchNo)!=null&&_t.toUpperCase().startsWith("CN"))}),Qe=me?[]:re.filter(He=>{var _t;return qt(He.partyName,j)&&He.isHistorical&&(He.type==="creditnote"||((_t=He.vchNo)==null?void 0:_t.toUpperCase().startsWith("CN")))}),yt=He=>{if(!He)return"";const _t=He.split("/");return _t.length>=3?_t.slice(1).join("/"):_t.length===2?_t.join("/"):_t[_t.length-1]},Bt=new Map;Me.forEach(He=>{const _t=yt(He.invoiceNo);_t&&!Bt.has(_t)&&Bt.set(_t,He)}),Qe.forEach(He=>{const _t=yt(He.vchNo);_t&&!Bt.has(_t)&&Bt.set(_t,He)});let Ht=0;return ie>0&&(Ht+=ie),Array.from(ee.values()).forEach(He=>{const _t=He.totalAmount,cr=yt(He.invoiceNo),jt=Bt.get(cr),$t=jt?Math.abs(parseFloat(jt.totalAmount)||parseFloat(jt.credit)||0):0;if(!(jt&&$t>=_t)){let J=jt?_t-$t:_t;const Le=xe.find(Un=>Un.invoiceNo===He.invoiceNo);if(Le){const Un=J-(parseFloat(Le.amount)||0)-(parseFloat(Le.tds)||0)-(parseFloat(Le.discount)||0);Un>0&&(Ht+=Un)}else J>0&&(Ht+=J)}}),Xe.forEach(He=>{const _t=yt(He.vchNo),cr=Bt.get(_t),jt=cr?Math.abs(parseFloat(cr.totalAmount)||parseFloat(cr.credit)||parseFloat(cr.debit)||0):0,$t=parseFloat(He.debit)||0;if(!(cr&&jt>=$t)){let J=cr?$t-jt:$t;const Le=parseFloat(He.amountReceived)||0,Un=parseFloat(He.tdsReceived)||0,It=J-Le-Un;It>0&&(Ht+=It)}}),Ht},T=Mi.filter(j=>j.partyName.toLowerCase().includes(xa.toLowerCase())||j.state&&j.state.toLowerCase().includes(xa.toLowerCase())),H=j=>{if(Ee){const de=Mi.find(ee=>ee.partyNameUpper===(j||"").trim().toUpperCase()&&ee.normalizedState===Ee);if(de!=null&&de.state)return de.state}const me=(j||"").trim().toUpperCase(),ie=_e.find(de=>{var ee;return((ee=de.partyName)==null?void 0:ee.trim().toUpperCase())===me});if(ie!=null&&ie.statePartyDetails)return ie.statePartyDetails;const pe=Mi.find(de=>de.partyNameUpper===me);return(pe==null?void 0:pe.state)||""},W=j=>{const me=(j||"").trim().toUpperCase();if(Ee){const pe=Mi.find(de=>de.partyNameUpper===me&&de.normalizedState===Ee);if(pe!=null&&pe.address)return pe.address}const ie=Mi.find(pe=>pe.partyNameUpper===me);return ie!=null&&ie.address?ie.address:Wu(j,H(j))},L=j=>{const me=(j||"").trim().toUpperCase();if(Ee){const de=Mi.find(ee=>ee.partyNameUpper===me&&ee.normalizedState===Ee);if(de!=null&&de.gstin)return de.gstin}const ie=Mi.find(de=>de.partyNameUpper===me);if(ie!=null&&ie.gstin)return ie.gstin;const pe=_e.find(de=>{var ee;return((ee=de.partyName)==null?void 0:ee.trim().toUpperCase())===me});return pe?hc(j,pe.statePartyDetails):""},Z=(()=>{if(!Y)return{entries:[],totals:{debit:0,credit:0,received:0,tds:0,balance:0}};const j=cn[Y]||0,me=J=>{if(!J)return"";const Le=J.split("/");return Le.length>=3?Le.slice(1).join("/"):Le.length===2?Le.join("/"):Le[Le.length-1]},ie=_e.filter(J=>qt(J.partyName,Y)&&J.invoiceGenerated&&J.invoiceStatus==="Approved"&&(!Ee||jr(J.statePartyDetails)===Ee)),pe=De.filter(J=>qt(J.partyName,Y)&&J.invoiceGenerated&&J.invoiceStatus==="Approved"&&(!Ee||jr(J.statePartyDetails)===Ee)),de=new Map;ie.forEach(J=>{de.has(J.invoiceNo)?de.get(J.invoiceNo).campaigns.push(J):de.set(J.invoiceNo,{invoiceNo:J.invoiceNo,invoiceDate:J.invoiceDate,invoiceType:J.invoiceType,combinationCode:J.combinationCode,receiptStatus:J.receiptStatus,receiptNo:J.receiptNo,receiptDate:J.receiptDate,creditNoteNo:J.creditNoteNo,campaigns:[J],isFromMaster:!0})}),pe.forEach(J=>{de.has(J.invoiceNo)||de.set(J.invoiceNo,{invoiceNo:J.invoiceNo,invoiceDate:J.invoiceDate,invoiceType:"Service",combinationCode:"NA",receiptStatus:J.receiptStatus,receiptNo:J.receiptNo,receiptDate:J.receiptDate,creditNoteNo:J.creditNoteNo,campaigns:[J],isFromMaster:!1,isService:!0,serviceType:J.serviceType})});const ee=new Set(Array.from(de.keys())),Ke=Ee?[]:re.filter(J=>{var Le;return qt(J.partyName,Y)&&J.isHistorical&&J.type!=="creditnote"&&!((Le=J.vchNo)!=null&&Le.toUpperCase().startsWith("CN"))}),xe=Ee?[]:re.filter(J=>{var Le;return qt(J.partyName,Y)&&J.isHistorical&&(J.type==="creditnote"||((Le=J.vchNo)==null?void 0:Le.toUpperCase().startsWith("CN")))}),Me=Oe.filter(J=>qt(J.partyName,Y)&&(!Ee||ee.has(J.invoiceNo))),Xe=ne.filter(J=>qt(J.partyName,Y)&&(!Ee||ee.has(J.invoiceNo))),Qe=new Map;Xe.forEach(J=>{const Le=me(J.invoiceNo);Le&&!Qe.has(Le)&&Qe.set(Le,{...J,isSystemCN:!0})}),xe.forEach(J=>{const Le=me(J.vchNo);Le&&!Qe.has(Le)&&Qe.set(Le,{...J,isHistoricalCN:!0})});const yt=[];let Bt=j,Ht=0,He=0,_t=0,cr=0;const jt=new Set;j!==0&&(yt.push({id:"opening",date:"",particular:"Opening Balance",vchType:"",vchNo:"",debit:j>0?j:0,credit:j<0?Math.abs(j):0,receiptDate:"",amountReceived:0,tdsReceived:0,balance:j,paymentStatus:"",isOpening:!0,subRows:[]}),Ht+=j>0?j:0,He+=j<0?Math.abs(j):0);const $t=[];Array.from(de.values()).filter(J=>{const Le=new Date(J.invoiceDate),Un=new Date(an.fromDate),It=new Date(an.toDate);return Le>=Un&&Le<=It}).forEach(J=>{$t.push({...J,entryType:"invoice",sortDate:J.invoiceDate})}),Ke.filter(J=>{if(!J.date)return!1;const Le=new Date(J.date),Un=new Date(an.fromDate),It=new Date(an.toDate);return Le>=Un&&Le<=It}).forEach(J=>{$t.push({...J,entryType:J.type||"invoice",sortDate:J.date})}),$t.sort((J,Le)=>new Date(J.sortDate)-new Date(Le.sortDate)),$t.forEach(J=>{var Le,Un;if(J.isFromMaster){const It=J;let zr=0;It.campaigns.forEach(Qs=>{zr+=parseFloat(Qs.invoiceAmount)||0});const Wr=(Un=(Le=It.campaigns[0])==null?void 0:Le.statePartyDetails)==null?void 0:Un.toUpperCase().includes("MAHARASHTRA"),er=Wr?zr*.09:0,zn=Wr?zr*.09:0,En=Wr?0:zr*.18,dn=zr+er+zn+En,As=me(It.invoiceNo),Gt=Qe.get(As),Wn=Gt?Math.abs(Gt.totalAmount||Gt.credit||0):0,Ti=!!Gt,wa=Ti&&Wn>=dn,fo=Ti&&!wa?dn-Wn:0,Sa=Me.find(Qs=>Qs.invoiceNo===It.invoiceNo);Bt+=dn,Ht+=dn;const ho=[{particular:"PROMOTIONAL TRADE EMAILER"+(It.campaigns.length>1?"S":""),credit:zr}];Wr?(ho.push({particular:"CGST",credit:er}),ho.push({particular:"SGST",credit:zn})):ho.push({particular:"IGST",credit:En});let Hn="",po=0,ml=0,Ty="",_c=dn;if(Sa?(Hn="Received",po=Sa.amount||0,ml=Sa.tds||0,Ty=Sa.date,_t+=po,cr+=ml,_c=dn-po-ml-(Sa.discount||0),Bt-=po+ml+(Sa.discount||0)):It.receiptStatus==="Received"?(Hn="Received",_c=0):wa?(Hn="CN Closed",_c=0):Ti&&fo>0?(Hn="Partial CN",_c=fo):Hn="Pending",yt.push({id:It.invoiceNo,date:It.invoiceDate,particular:Y,vchType:"Sales",vchNo:It.invoiceNo,debit:dn,credit:0,receiptDate:Ty,amountReceived:po,tdsReceived:ml,balance:wa?"-":_c>0?_c:0,paymentStatus:Hn,isInvoice:!0,hasCN:Ti,subRows:ho}),Gt&&!jt.has(As)){jt.add(As);const Qs=Math.abs(Gt.totalAmount||Gt.credit||0);Bt-=Qs,He+=Qs;const xl=[];if(Gt.amount&&xl.push({particular:"PROMOTIONAL TRADE EMAILER",credit:Math.abs(Gt.amount)}),Gt.gst&&xl.push({particular:Gt.gstType||(Wr?"CGST + SGST":"IGST"),credit:Math.abs(Gt.gst)}),xl.length===0&&Qs>0){const Ay=Qs/1.18,UF=Qs-Ay;xl.push({particular:"PROMOTIONAL TRADE EMAILER",credit:Ay}),xl.push({particular:Wr?"CGST + SGST":"IGST",credit:UF})}yt.push({id:Gt.id||Gt.creditNoteNo||`cn-${As}`,date:Gt.date,particular:Y,vchType:"Credit Note",vchNo:Gt.creditNoteNo||Gt.vchNo,debit:0,credit:Qs,receiptDate:"",amountReceived:0,tdsReceived:0,balance:"-",paymentStatus:"",isCreditNote:!0,hasCN:!0,subRows:Gt.isHistoricalCN&&Gt.subRows||xl})}}else if(J.isHistorical){const It=J.debit||0,zr=J.credit||0,Wr=me(J.vchNo),er=Qe.get(Wr),zn=er?Math.abs(er.totalAmount||er.credit||0):0,En=!!er,dn=En&&zn>=It,As=En&&!dn?It-zn:0;Bt+=It-zr,Ht+=It,He+=zr,J.amountReceived&&(_t+=J.amountReceived),J.tdsReceived&&(cr+=J.tdsReceived);const Gt=J.subRows||[];let Wn=It-(J.amountReceived||0)-(J.tdsReceived||0),Ti=J.paymentStatus||"";dn?(Wn=0,Ti="CN Closed"):En&&As>0&&(Wn=As-(J.amountReceived||0)-(J.tdsReceived||0),Wn>0&&(Ti="Partial CN")),yt.push({id:J.id,date:J.date,particular:J.particulars||Y,vchType:J.vchType||"Sales",vchNo:J.vchNo,debit:It,credit:zr,receiptDate:J.receiptDate||"",amountReceived:J.amountReceived||0,tdsReceived:J.tdsReceived||0,balance:dn?"-":Wn>0?Wn:0,paymentStatus:Ti,isInvoice:!0,isHistorical:!0,hasCN:En,subRows:Gt}),er&&!jt.has(Wr)&&(jt.add(Wr),Bt-=zn,He+=zn,yt.push({id:er.id||er.creditNoteNo||er.vchNo||`cn-${Wr}`,date:er.date,particular:Y,vchType:"Credit Note",vchNo:er.creditNoteNo||er.vchNo,debit:0,credit:zn,receiptDate:"",amountReceived:0,tdsReceived:0,balance:"-",paymentStatus:"",isCreditNote:!0,hasCN:!0,subRows:er.subRows||[]}))}});const uo=yt.reduce((J,Le)=>typeof Le.balance=="number"&&Le.balance>0?J+Le.balance:J,0);return{entries:yt,totals:{debit:Ht,credit:He,received:_t,tds:cr,balance:uo}}})();return u.jsxs("div",{children:[u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[u.jsx("h1",{style:{margin:0,fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:" Party Ledgers"}),u.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[u.jsx(Ye,{icon:xo,label:"Export All",variant:"secondary",onClick:CF}),Vr&&u.jsx("span",{style:{padding:"8px 16px",backgroundColor:"#FEF3C7",borderRadius:"8px",fontSize:"13px",color:"#92400E",fontWeight:"600"},children:" View Only"}),lr&&u.jsx(Ye,{icon:ea,label:"Import Historical",variant:"brand",onClick:()=>Pi(!0)}),lr&&Y&&re.some(j=>qt(j.partyName,Y)&&j.isHistorical)&&u.jsx(Ye,{icon:Fs,label:"Clear Historical",variant:"danger",onClick:$u}),lr&&u.jsx(Ye,{icon:nf,label:"Opening Balance",variant:"primary",onClick:()=>Qt(!0)})]})]}),u.jsx("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"10px",border:"1px solid #E2E8F0",padding:"14px 18px",marginBottom:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"14px",flexWrap:"wrap"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[u.jsx(v9,{size:18,color:"#64748B"}),u.jsx("span",{style:{fontSize:"13px",fontWeight:"700",color:"#475569"},children:"Period:"})]}),u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[u.jsx("input",{type:"date",value:an.fromDate,onChange:j=>Yr(me=>({...me,fromDate:j.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px"}}),u.jsx("span",{style:{color:"#64748B"},children:"to"}),u.jsx("input",{type:"date",value:an.toDate,onChange:j=>Yr(me=>({...me,toDate:j.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px"}})]}),u.jsx("div",{style:{marginLeft:"auto",display:"flex",gap:"10px"},children:Y&&u.jsx(Ye,{icon:xo,label:"Download PDF",variant:"brand",onClick:NF})})]})}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"280px 1fr",gap:"16px"},children:[u.jsxs(Zr,{title:"Parties",noPadding:!0,children:[u.jsx("div",{style:{padding:"12px",borderBottom:"1px solid #E2E8F0"},children:u.jsxs("div",{style:{position:"relative"},children:[u.jsx(U0,{size:14,style:{position:"absolute",left:"10px",top:"50%",transform:"translateY(-50%)",color:"#94A3B8"}}),u.jsx("input",{type:"text",placeholder:"Search party...",value:xa,onChange:j=>ys(j.target.value),style:{width:"100%",padding:"8px 12px 8px 32px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",boxSizing:"border-box"}})]})}),u.jsx("div",{style:{maxHeight:"450px",overflowY:"auto"},children:T.length===0?u.jsx("div",{style:{padding:"30px",textAlign:"center",color:"#94A3B8",fontSize:"14px"},children:xa?"No matching parties":"No parties yet"}):T.map((j,me)=>{const ie=p(j.partyName,j.normalizedState),pe=qt(Y,j.partyName)&&Ee===j.normalizedState;return u.jsxs("div",{onClick:()=>{ge(j.partyName),Pe(j.normalizedState||null)},style:{padding:"14px 18px",borderBottom:"1px solid #F1F5F9",cursor:"pointer",backgroundColor:pe?"#EFF6FF":"transparent",borderLeft:pe?"4px solid #2874A6":"4px solid transparent"},children:[u.jsx("div",{style:{fontWeight:"600",fontSize:"14px",color:"#1E293B"},children:j.partyName}),j.state&&u.jsxs("div",{style:{fontSize:"11px",color:"#64748B",marginTop:"2px"},children:[" ",j.state]}),j.gstin&&u.jsxs("div",{style:{fontSize:"10px",color:"#2874A6",marginTop:"1px"},children:["GST: ",j.gstin]}),u.jsxs("div",{style:{fontSize:"14px",color:ie>0?"#DC2626":"#059669",fontWeight:"700",marginTop:"4px"},children:[ie>0?"Dr. ":"Cr. ",et(Math.abs(ie))]})]},`${j.partyName}-${j.state}-${me}`)})})]}),u.jsx(Zr,{title:Y?"Ledger Account":"Select a Party",noPadding:!0,children:Y?u.jsxs("div",{style:{fontSize:"12px"},children:[u.jsxs("div",{style:{textAlign:"center",padding:"16px",borderBottom:"2px solid #1E3A5F",backgroundColor:"#F8FAFC"},children:[u.jsx("div",{style:{fontSize:"16px",fontWeight:"700",color:"#1E3A5F"},children:w.name}),u.jsx("div",{style:{fontSize:"11px",color:"#64748B",marginTop:"4px"},children:w.address}),u.jsxs("div",{style:{fontSize:"11px",color:"#64748B"},children:[w.addressLine2,", ",w.city]}),u.jsxs("div",{style:{fontSize:"11px",color:"#64748B"},children:["E-Mail: ",w.email]})]}),u.jsxs("div",{style:{textAlign:"center",padding:"12px",borderBottom:"1px solid #E2E8F0",backgroundColor:"#FFFFFF"},children:[u.jsx("div",{style:{fontSize:"14px",fontWeight:"700",color:"#1E293B"},children:Y}),u.jsx("div",{style:{fontSize:"11px",fontWeight:"600",color:"#64748B"},children:"Ledger Account"}),W(Y)&&u.jsx("div",{style:{fontSize:"11px",color:"#475569",marginTop:"4px"},children:W(Y)}),H(Y)&&u.jsxs("div",{style:{fontSize:"11px",color:"#64748B",marginTop:"2px"},children:[" ",H(Y)]}),L(Y)&&u.jsxs("div",{style:{fontSize:"11px",color:"#2874A6",marginTop:"3px",fontWeight:"600"},children:["GSTIN: ",L(Y)]})]}),u.jsx("div",{style:{textAlign:"center",padding:"8px",backgroundColor:"#F1F5F9",borderBottom:"1px solid #E2E8F0"},children:u.jsxs("span",{style:{fontSize:"11px",fontWeight:"600",color:"#475569"},children:[Vt(an.fromDate)," to ",Vt(an.toDate)]})}),u.jsxs("div",{style:{backgroundColor:"#1E293B",color:"white",padding:"12px 16px",display:"flex",justifyContent:"center",alignItems:"center",gap:"12px",borderBottom:"3px solid #F59E0B"},children:[u.jsx("span",{style:{fontSize:"14px",fontWeight:"600"},children:"Closing Balance:"}),u.jsxs("span",{style:{fontSize:"18px",fontWeight:"700",color:Z.totals.balance>0?"#FCA5A5":"#86EFAC"},children:[Dt(Math.abs(Z.totals.balance))," ",Z.totals.balance>0?"(Dr)":Z.totals.balance<0?"(Cr)":""]})]}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",backgroundColor:"#EFF6FF",borderBottom:"2px solid #2874A6",fontSize:"11px"},children:[u.jsxs("div",{style:{padding:"8px",textAlign:"center",borderRight:"1px solid #BFDBFE"},children:[u.jsx("div",{style:{color:"#64748B"},children:"Debit"}),u.jsx("div",{style:{fontWeight:"700",color:"#1E293B"},children:Dt(Z.totals.debit)})]}),u.jsxs("div",{style:{padding:"8px",textAlign:"center",borderRight:"1px solid #BFDBFE"},children:[u.jsx("div",{style:{color:"#64748B"},children:"Credit"}),u.jsx("div",{style:{fontWeight:"700",color:"#DC2626"},children:Dt(Z.totals.credit)})]}),u.jsxs("div",{style:{padding:"8px",textAlign:"center",borderRight:"1px solid #BFDBFE"},children:[u.jsx("div",{style:{color:"#64748B"},children:"Amount Received"}),u.jsx("div",{style:{fontWeight:"700",color:"#059669"},children:Dt(Z.totals.received)})]}),u.jsxs("div",{style:{padding:"8px",textAlign:"center"},children:[u.jsx("div",{style:{color:"#64748B"},children:"TDS Received"}),u.jsx("div",{style:{fontWeight:"700",color:"#1E293B"},children:Dt(Z.totals.tds)})]})]}),u.jsx("div",{style:{overflowX:"auto"},children:u.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"11px",minWidth:"1000px"},children:[u.jsx("thead",{children:u.jsxs("tr",{style:{backgroundColor:"#F8FAFC",borderBottom:"2px solid #E2E8F0"},children:[u.jsx("th",{style:{padding:"10px 8px",textAlign:"left",fontWeight:"700",width:"75px",borderRight:"1px solid #E2E8F0"},children:"Date"}),u.jsx("th",{style:{padding:"10px 8px",textAlign:"left",fontWeight:"700",minWidth:"150px",borderRight:"1px solid #E2E8F0"},children:"Particular"}),u.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"700",width:"80px",borderRight:"1px solid #E2E8F0"},children:"Vch Type"}),u.jsx("th",{style:{padding:"10px 8px",textAlign:"left",fontWeight:"700",width:"110px",borderRight:"1px solid #E2E8F0"},children:"Vch No."}),u.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"700",width:"90px",borderRight:"1px solid #E2E8F0"},children:"Debit"}),u.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"700",width:"90px",borderRight:"1px solid #E2E8F0"},children:"Credit"}),u.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"700",width:"85px",borderRight:"1px solid #E2E8F0"},children:"Date of Receipt"}),u.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"700",width:"90px",borderRight:"1px solid #E2E8F0"},children:"Amount Received"}),u.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"700",width:"80px",borderRight:"1px solid #E2E8F0"},children:"TDS Received"}),u.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"700",width:"85px",borderRight:"1px solid #E2E8F0"},children:"Balance"}),u.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"700",width:"75px",borderRight:"1px solid #E2E8F0"},children:"Payment Status"}),lr&&u.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"700",width:"50px"},children:"Action"})]})}),u.jsx("tbody",{children:Z.entries.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:lr?"12":"11",style:{padding:"40px",textAlign:"center",color:"#94A3B8"},children:"No entries in selected period"})}):Z.entries.map(j=>u.jsxs(Q0.Fragment,{children:[u.jsxs("tr",{style:{backgroundColor:j.isOpening?"#FEF3C7":j.hasCN||j.isCreditNote?"#FFFBEB":"#FFFFFF",borderBottom:"1px solid #E2E8F0",borderLeft:j.hasCN||j.isCreditNote?"4px solid #F59E0B":"none"},children:[u.jsx("td",{style:{padding:"8px",borderRight:"1px solid #E2E8F0"},children:j.date?Vt(j.date):""}),u.jsx("td",{style:{padding:"8px",fontWeight:"600",color:j.isCreditNote?"#DC2626":"#1E293B",borderRight:"1px solid #E2E8F0"},children:j.particular}),u.jsx("td",{style:{padding:"8px",textAlign:"center",borderRight:"1px solid #E2E8F0"},children:j.vchType&&u.jsx("span",{style:{padding:"2px 6px",borderRadius:"4px",fontSize:"10px",fontWeight:"600",backgroundColor:j.vchType==="Sales"?"#DCFCE7":"#FEE2E2",color:j.vchType==="Sales"?"#166534":"#991B1B"},children:j.vchType})}),u.jsx("td",{style:{padding:"8px",borderRight:"1px solid #E2E8F0"},children:j.vchNo&&j.isInvoice&&!j.isHistorical?u.jsx("button",{onClick:()=>tF(j.vchNo),style:{background:"none",border:"none",padding:0,fontWeight:"600",color:"#2874A6",cursor:"pointer",textDecoration:"underline",fontSize:"11px"},title:"Click to view invoice",children:j.vchNo}):u.jsx("span",{style:{fontWeight:"600",color:j.isCreditNote?"#DC2626":"#2874A6"},children:j.vchNo})}),u.jsx("td",{style:{padding:"8px",textAlign:"right",fontWeight:"600",borderRight:"1px solid #E2E8F0"},children:j.debit>0?Dt(j.debit):""}),u.jsx("td",{style:{padding:"8px",textAlign:"right",color:"#DC2626",borderRight:"1px solid #E2E8F0"},children:j.credit>0?Dt(j.credit):""}),u.jsx("td",{style:{padding:"8px",textAlign:"center",borderRight:"1px solid #E2E8F0"},children:j.receiptDate?Vt(j.receiptDate):""}),u.jsx("td",{style:{padding:"8px",textAlign:"right",color:"#059669",fontWeight:j.amountReceived>0?"600":"400",borderRight:"1px solid #E2E8F0"},children:j.amountReceived>0?Dt(j.amountReceived):""}),u.jsx("td",{style:{padding:"8px",textAlign:"right",borderRight:"1px solid #E2E8F0"},children:j.tdsReceived>0?Dt(j.tdsReceived):""}),u.jsx("td",{style:{padding:"8px",textAlign:"right",fontWeight:"600",color:typeof j.balance=="number"&&j.balance>0?"#DC2626":"",borderRight:"1px solid #E2E8F0"},children:j.isOpening?j.balance>0?Dt(j.balance):"":j.balance==="-"?"-":typeof j.balance=="number"&&j.balance>0?Dt(j.balance):"-"}),u.jsx("td",{style:{padding:"8px",textAlign:"center"},children:j.paymentStatus&&u.jsx("span",{style:{padding:"2px 8px",borderRadius:"4px",fontSize:"10px",fontWeight:"600",backgroundColor:j.paymentStatus==="Received"?"#DCFCE7":"#FEF3C7",color:j.paymentStatus==="Received"?"#166534":"#92400E"},children:j.paymentStatus})}),lr&&u.jsx("td",{style:{padding:"8px",textAlign:"center"},children:j.isHistorical&&!j.isOpening&&u.jsx("button",{onClick:()=>vc(re.find(me=>me.id===j.id)),style:{padding:"2px 6px",borderRadius:"4px",fontSize:"10px",fontWeight:"600",backgroundColor:"#FEE2E2",color:"#991B1B",border:"none",cursor:"pointer"},title:"Delete historical entry",children:""})})]}),j.subRows&&j.subRows.length>0&&j.subRows.map((me,ie)=>u.jsxs("tr",{style:{backgroundColor:j.isOpening?"#FEF3C7":j.hasCN||j.isCreditNote?"#FFFBEB":"#FFFFFF",borderBottom:ie===j.subRows.length-1?"2px solid #CBD5E1":"1px solid #E2E8F0",borderLeft:j.hasCN||j.isCreditNote?"4px solid #F59E0B":"none"},children:[u.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),u.jsx("td",{style:{padding:"6px 8px 6px 30px",color:"#475569",fontSize:"12px",borderRight:"1px solid #E2E8F0"},children:me.particular}),u.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),u.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),u.jsx("td",{style:{padding:"6px 8px",textAlign:"right",fontSize:"12px",borderRight:"1px solid #E2E8F0"},children:me.debit?Dt(me.debit):""}),u.jsx("td",{style:{padding:"6px 8px",textAlign:"right",fontSize:"12px",borderRight:"1px solid #E2E8F0"},children:me.credit?Dt(me.credit):""}),u.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),u.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),u.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),u.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),u.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),lr&&u.jsx("td",{style:{padding:"6px 8px"}})]},`${j.id}-sub-${ie}`))]},j.id))})]})})]}):u.jsx("div",{style:{padding:"60px",textAlign:"center",color:"#94A3B8"},children:"Select a party to view ledger"})})]})]})},[yc,Ey]=ye.useState(""),l0=ye.useMemo(()=>{const p=new Map,T=L=>{if(!L)return"";const q=L.split("/");return q.length>=3?q.slice(1).join("/"):q.length===2?q.join("/"):q[q.length-1]},H=Nt.filter(L=>{var q;return L.isHistorical&&(L.type==="creditnote"||((q=L.vchNo)==null?void 0:q.toUpperCase().startsWith("CN")))}),W=new Map;return ao.forEach(L=>{const q=T(L.invoiceNo);q&&W.set(q,L)}),H.forEach(L=>{const q=T(L.vchNo);q&&!W.has(q)&&W.set(q,L)}),un.filter(L=>L.invoiceGenerated&&L.invoiceStatus==="Approved").forEach(L=>{if(p.has(L.invoiceNo))p.has(L.invoiceNo)&&p.get(L.invoiceNo).campaigns.push(L);else{const q=so.find(pe=>pe.invoiceNo===L.invoiceNo),Z=ao.find(pe=>pe.invoiceNo===L.invoiceNo),j=parseFloat(L.invoiceTotalAmount)||0,me=Z?Math.abs(parseFloat(Z.totalAmount)||parseFloat(Z.credit)||0):0,ie=Z&&me>=j;if(!q&&!ie){const pe=Z?j-me:j;p.set(L.invoiceNo,{invoiceNo:L.invoiceNo,partyName:L.partyName,invoiceDate:L.invoiceDate,invoiceTotalAmount:L.invoiceTotalAmount,pendingAmount:pe,hasPartialCN:!!Z&&!ie&&me>0,cnAmount:me,subject:L.subject,campaigns:[L],isHistorical:!1,invoiceType:L.invoiceType||"Individual"})}}}),Nt.filter(L=>{var q;return L.isHistorical&&L.type!=="creditnote"&&!((q=L.vchNo)!=null&&q.toUpperCase().startsWith("CN"))&&L.debit>0}).forEach(L=>{if(!p.has(L.vchNo)){const q=so.find(Ke=>Ke.invoiceNo===L.vchNo),Z=T(L.vchNo),j=W.get(Z),me=j?Math.abs(parseFloat(j.totalAmount)||parseFloat(j.credit)||parseFloat(j.debit)||0):0,ie=parseFloat(L.debit)||0,pe=j&&me>=ie;if(q||pe)return;const de=!(L.amountReceived>0),ee=j&&me>0&&me<ie;if(de||ee){const Ke=ee?ie-me:ie;p.set(L.vchNo,{invoiceNo:L.vchNo,partyName:L.partyName,invoiceDate:L.date,invoiceTotalAmount:ie,pendingAmount:Ke,hasPartialCN:ee,cnAmount:me,subject:L.particulars||L.narration,campaigns:[],isHistorical:!0})}}}),Array.from(p.values()).sort((L,q)=>L.partyName.localeCompare(q.partyName))},[un,so,ao,Nt]),OF=ye.useMemo(()=>{const p={};return dl.forEach(T=>{p[T.invoiceNo]||(p[T.invoiceNo]=[]),p[T.invoiceNo].push(T)}),Object.keys(p).forEach(T=>{p[T].sort((H,W)=>new Date(W.followupDate)-new Date(H.followupDate))}),p},[dl]),wy=ye.useMemo(()=>{const p=new Date().toISOString().split("T")[0];return dl.filter(T=>T.nextFollowupDate&&T.nextFollowupDate>=p).sort((T,H)=>new Date(T.nextFollowupDate)-new Date(H.nextFollowupDate))},[dl]),c0=ye.useMemo(()=>{let p=l0;if(yc){const H=yc.toLowerCase();p=l0.filter(W=>{var L,q,Z;return((L=W.invoiceNo)==null?void 0:L.toLowerCase().includes(H))||((q=W.partyName)==null?void 0:q.toLowerCase().includes(H))||((Z=W.subject)==null?void 0:Z.toLowerCase().includes(H))})}const T={};return p.forEach(H=>{T[H.partyName]||(T[H.partyName]={partyName:H.partyName,invoices:[],totalAmount:0}),T[H.partyName].invoices.push(H),T[H.partyName].totalAmount+=parseFloat(H.pendingAmount||H.invoiceTotalAmount)||0}),Object.values(T).sort((H,W)=>H.partyName.localeCompare(W.partyName))},[l0,yc]),MF=()=>{const p=c0.reduce((T,H)=>T+H.invoices.length,0);return u.jsxs("div",{children:[u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[u.jsx("h1",{style:{margin:0,fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:" Followups"}),u.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[u.jsxs("span",{style:{padding:"6px 12px",backgroundColor:"#EFF6FF",borderRadius:"6px",fontSize:"12px",color:"#1E40AF",fontWeight:"600"},children:[c0.length," Parties | ",p," Invoices"]}),Vr&&u.jsx("span",{style:{padding:"8px 16px",backgroundColor:"#FEF3C7",borderRadius:"8px",fontSize:"13px",color:"#92400E",fontWeight:"600"},children:" View Only"})]})]}),u.jsx("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"10px",border:"1px solid #E2E8F0",padding:"14px 18px",marginBottom:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"14px",flexWrap:"wrap"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[u.jsx(Gg,{size:18,color:"#64748B"}),u.jsx("span",{style:{fontSize:"13px",fontWeight:"700",color:"#475569"},children:"Search:"})]}),u.jsxs("div",{style:{position:"relative",flex:1,maxWidth:"300px"},children:[u.jsx(U0,{size:14,style:{position:"absolute",left:"10px",top:"50%",transform:"translateY(-50%)",color:"#94A3B8"}}),u.jsx("input",{type:"text",placeholder:"Search party, invoice, subject...",value:yc,onChange:T=>Ey(T.target.value),style:{padding:"8px 12px 8px 32px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",width:"100%"}})]}),yc&&u.jsxs("button",{onClick:()=>Ey(""),style:{padding:"8px 12px",fontSize:"13px",fontWeight:"600",border:"1.5px solid #FCA5A5",borderRadius:"8px",backgroundColor:"#FEE2E2",color:"#991B1B",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},children:[u.jsx(El,{size:14})," Clear"]}),yc&&u.jsxs("span",{style:{fontSize:"13px",color:"#64748B"},children:["Showing ",p," of ",l0.length]})]})}),wy.length>0&&u.jsx(Zr,{title:" Upcoming Followups",style:{marginBottom:"16px"},children:u.jsx("div",{style:{display:"flex",gap:"12px",flexWrap:"wrap"},children:wy.slice(0,5).map(T=>u.jsxs("div",{style:{padding:"10px 14px",backgroundColor:new Date(T.nextFollowupDate).toISOString().split("T")[0]===new Date().toISOString().split("T")[0]?"#FEE2E2":"#FEF3C7",borderRadius:"8px",border:"1px solid #FCD34D"},children:[u.jsx("div",{style:{fontWeight:"600",fontSize:"13px",color:"#92400E"},children:T.invoiceNo}),u.jsx("div",{style:{fontSize:"11px",color:"#78716C"},children:T.partyName}),u.jsxs("div",{style:{fontSize:"12px",fontWeight:"600",color:"#DC2626",marginTop:"4px"},children:[" ",Vt(T.nextFollowupDate)]})]},T.id))})}),c0.length===0?u.jsx(Zr,{children:u.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#94A3B8"},children:" No pending invoices! All payments received."})}):c0.map(T=>u.jsxs(Zr,{style:{marginBottom:"16px"},noPadding:!0,children:[u.jsxs("div",{style:{padding:"12px 16px",backgroundColor:"#1E293B",color:"white",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[u.jsxs("span",{style:{fontSize:"15px",fontWeight:"700"},children:[" ",T.partyName]}),u.jsxs("span",{style:{padding:"3px 10px",backgroundColor:"#3B82F6",borderRadius:"12px",fontSize:"11px",fontWeight:"600"},children:[T.invoices.length," Invoice",T.invoices.length>1?"s":""]})]}),u.jsxs("div",{style:{fontSize:"14px",fontWeight:"700",color:"#FCD34D"},children:["Total: ",et(T.totalAmount)]})]}),u.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"12px"},children:[u.jsx("thead",{children:u.jsxs("tr",{style:{backgroundColor:"#F8FAFC",borderBottom:"2px solid #E2E8F0"},children:[u.jsx("th",{style:{padding:"10px 12px",textAlign:"left",fontWeight:"700"},children:"Invoice No"}),u.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Type"}),u.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Invoice Date"}),u.jsx("th",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700"},children:"Amount"}),u.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Days Pending"}),u.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Last Followup"}),u.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Actions"})]})}),u.jsx("tbody",{children:T.invoices.map(H=>{var j,me,ie;const W=OF[H.invoiceNo]||[],L=W[0],q=Math.floor((new Date-new Date(H.invoiceDate))/(1e3*60*60*24)),Z=H.isHistorical?"Historical":H.invoiceType||(((j=H.campaigns)==null?void 0:j.length)>1?"Combined":"Individual");return u.jsxs(Q0.Fragment,{children:[u.jsxs("tr",{style:{borderBottom:"1px solid #E2E8F0",backgroundColor:q>30?"#FEF2F2":q>15?"#FFFBEB":"#FFFFFF"},children:[u.jsxs("td",{style:{padding:"10px 12px",fontWeight:"600",color:"#2874A6"},children:[H.invoiceNo,H.hasPartialCN&&u.jsx("span",{style:{marginLeft:"6px",padding:"2px 6px",backgroundColor:"#FEF3C7",color:"#92400E",borderRadius:"4px",fontSize:"9px",fontWeight:"700"},children:"Partial CN"})]}),u.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:u.jsx("span",{style:{padding:"3px 8px",borderRadius:"6px",fontSize:"10px",fontWeight:"600",backgroundColor:Z==="Historical"?"#E0E7FF":Z==="Combined"?"#F3E8FF":"#DCFCE7",color:Z==="Historical"?"#3730A3":Z==="Combined"?"#7C3AED":"#166534"},children:Z})}),u.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:Vt(H.invoiceDate)}),u.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"600"},children:H.hasPartialCN?u.jsxs("div",{children:[u.jsx("div",{style:{color:"#DC2626"},children:et(H.pendingAmount)}),u.jsx("div",{style:{fontSize:"9px",color:"#64748B",textDecoration:"line-through"},children:et(H.invoiceTotalAmount)})]}):et(H.invoiceTotalAmount)}),u.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:u.jsxs("span",{style:{padding:"3px 10px",borderRadius:"12px",fontSize:"11px",fontWeight:"700",backgroundColor:q>30?"#FEE2E2":q>15?"#FEF3C7":"#DCFCE7",color:q>30?"#991B1B":q>15?"#92400E":"#166534"},children:[q," days"]})}),u.jsx("td",{style:{padding:"10px 12px",textAlign:"center",fontSize:"11px"},children:L?u.jsxs("div",{children:[u.jsx("div",{style:{fontWeight:"600"},children:Vt(L.followupDate)}),u.jsxs("div",{style:{color:"#64748B",fontSize:"10px"},children:[(me=L.notes)==null?void 0:me.substring(0,30),((ie=L.notes)==null?void 0:ie.length)>30?"...":""]})]}):u.jsx("span",{style:{color:"#DC2626",fontWeight:"600"},children:"No followup yet"})}),u.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:u.jsxs("div",{style:{display:"flex",gap:"4px",justifyContent:"center"},children:[lr&&u.jsx(Ye,{icon:nf,small:!0,variant:"primary",onClick:()=>$4(H),title:"Add Followup"}),u.jsx(Ye,{icon:$g,small:!0,variant:"brand",onClick:()=>oy(H),title:"Copy Email Template"}),u.jsx(Ye,{icon:Xg,small:!0,variant:"success",onClick:()=>ly(H),title:"Search in Gmail"})]})})]}),W.length>0&&u.jsx("tr",{children:u.jsxs("td",{colSpan:"7",style:{padding:"8px 12px 12px 40px",backgroundColor:"#F8FAFC"},children:[u.jsx("div",{style:{fontSize:"11px",fontWeight:"600",color:"#64748B",marginBottom:"6px"},children:"Followup History:"}),u.jsx("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:W.map(pe=>u.jsxs("div",{style:{padding:"6px 10px",backgroundColor:"#FFFFFF",borderRadius:"6px",border:"1px solid #E2E8F0",fontSize:"11px"},children:[u.jsx("div",{style:{fontWeight:"600",color:"#2874A6"},children:Vt(pe.followupDate)}),u.jsx("div",{style:{color:"#475569",marginTop:"2px"},children:pe.notes}),pe.nextFollowupDate&&u.jsxs("div",{style:{color:"#DC2626",marginTop:"2px",fontSize:"10px"},children:["Next: ",Vt(pe.nextFollowupDate)]}),lr&&u.jsx("button",{onClick:()=>K4(pe.id),style:{background:"none",border:"none",color:"#DC2626",cursor:"pointer",fontSize:"10px",padding:"2px 0",marginTop:"4px"},children:" Delete"})]},pe.id))})]})})]},H.invoiceNo)})})]})]},T.partyName))]})},Sy=()=>{const p=_e.filter(L=>L.invoiceGenerated).reduce((L,q)=>L+(parseFloat(q.invoiceTotalAmount)||0),0),T=_e.filter(L=>L.invoiceStatus==="Paid").reduce((L,q)=>L+(parseFloat(q.invoiceTotalAmount)||0),0),H=_e.filter(L=>L.invoiceStatus==="Approved").reduce((L,q)=>L+(parseFloat(q.invoiceTotalAmount)||0),0),W=_e.filter(L=>L.invoiceStatus==="Need Edits").length;return u.jsxs("div",{children:[u.jsx("h1",{style:{margin:"0 0 16px",fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:" Reports"}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"16px"},children:[u.jsxs(Zr,{children:[u.jsx("div",{style:{fontSize:"14px",color:"#64748B",marginBottom:"8px"},children:"Total Invoiced"}),u.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:et(p)})]}),u.jsxs(Zr,{children:[u.jsx("div",{style:{fontSize:"14px",color:"#64748B",marginBottom:"8px"},children:"Approved"}),u.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#059669"},children:et(H)})]}),u.jsxs(Zr,{children:[u.jsx("div",{style:{fontSize:"14px",color:"#64748B",marginBottom:"8px"},children:"Need Edits"}),u.jsxs("div",{style:{fontSize:"24px",fontWeight:"700",color:"#DC2626"},children:[W," invoices"]})]}),u.jsxs(Zr,{children:[u.jsx("div",{style:{fontSize:"14px",color:"#64748B",marginBottom:"8px"},children:"Paid"}),u.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#059669"},children:et(T)})]})]})]})},LF=()=>u.jsxs("div",{children:[u.jsx("h1",{style:{margin:"0 0 16px",fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:" Settings"}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px"},children:[u.jsxs(Zr,{title:" Invoice Series",children:[u.jsx(Er,{label:"Invoice Prefix",value:w.invoicePrefix,onChange:p=>b(T=>({...T,invoicePrefix:p.target.value})),small:!0}),u.jsx(Er,{label:"Next Invoice Number",type:"number",value:ke,onChange:p=>Se(parseInt(p.target.value)||1),small:!0}),u.jsx(Er,{label:"Next Combine Code",type:"number",value:tt,onChange:p=>Q(parseInt(p.target.value)||1),small:!0}),u.jsxs("div",{style:{padding:"10px",backgroundColor:"#EFF6FF",borderRadius:"8px",fontSize:"14px"},children:[u.jsx("strong",{children:"Preview:"})," ",w.invoicePrefix,ke]})]}),u.jsxs(Zr,{title:" Mailer Logo",children:[u.jsx("input",{type:"file",ref:Uu,accept:"image/*",style:{display:"none"},onChange:pF}),ln?u.jsxs("div",{style:{textAlign:"center"},children:[u.jsx("img",{src:ln,alt:"Logo",style:{maxWidth:"250px",maxHeight:"60px",marginBottom:"12px",border:"1px solid #E2E8F0",padding:"8px",borderRadius:"8px"}}),u.jsxs("div",{style:{display:"flex",gap:"8px",justifyContent:"center"},children:[u.jsx(Ye,{icon:k9,label:"Change",small:!0,onClick:()=>{var p;return(p=Uu.current)==null?void 0:p.click()}}),u.jsx(Ye,{icon:Fs,label:"Remove",variant:"danger",small:!0,onClick:()=>ya(null)})]})]}):u.jsxs("div",{onClick:()=>{var p;return(p=Uu.current)==null?void 0:p.click()},style:{border:"2px dashed #CBD5E1",borderRadius:"10px",padding:"30px",textAlign:"center",cursor:"pointer"},children:[u.jsx(ea,{size:32,color:"#94A3B8",style:{marginBottom:"8px"}}),u.jsx("p",{style:{margin:0,color:"#64748B",fontSize:"14px"},children:"Click to upload"})]})]}),u.jsxs(Zr,{title:" WhatsApp Notifications",children:[u.jsx("div",{style:{marginBottom:"16px"},children:u.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"10px",cursor:"pointer"},children:[u.jsx("input",{type:"checkbox",checked:ht.enabled,onChange:p=>Vn(T=>({...T,enabled:p.target.checked})),style:{width:"18px",height:"18px",cursor:"pointer"}}),u.jsx("span",{style:{fontSize:"14px",fontWeight:"600",color:"#1E293B"},children:"Enable WhatsApp Notifications"})]})}),ht.enabled&&u.jsxs(u.Fragment,{children:[u.jsxs("div",{style:{padding:"12px",backgroundColor:"#DCFCE7",borderRadius:"8px",marginBottom:"16px",fontSize:"12px",color:"#166534",border:"1px solid #86EFAC"},children:[u.jsx("strong",{children:" FREE Setup using CallMeBot:"}),u.jsx("br",{}),"1. Save this number in contacts: ",u.jsx("strong",{children:"+34 644 71 81 99"}),u.jsx("br",{}),"2. Send this message to the number on WhatsApp: ",u.jsx("strong",{children:'"I allow callmebot to send me messages"'}),u.jsx("br",{}),"3. You'll receive an API key - enter it below",u.jsx("br",{}),"4. Repeat for each phone number you want to receive notifications"]}),u.jsxs("div",{style:{padding:"14px",backgroundColor:"#F8FAFC",borderRadius:"8px",marginBottom:"12px",border:"1px solid #E2E8F0"},children:[u.jsxs("div",{style:{fontSize:"13px",fontWeight:"700",color:"#1E293B",marginBottom:"10px",display:"flex",alignItems:"center",gap:"6px"},children:[u.jsx(V0,{size:16})," Finance Team"]}),u.jsx(Er,{label:"Phone (with country code)",value:ht.financePhone,onChange:p=>Vn(T=>({...T,financePhone:p.target.value})),placeholder:"919876543210",small:!0}),u.jsx(Er,{label:"API Key (from CallMeBot)",value:ht.financeApiKey,onChange:p=>Vn(T=>({...T,financeApiKey:p.target.value})),placeholder:"123456",small:!0}),ht.financePhone&&ht.financeApiKey&&u.jsx(Ye,{icon:Q2,label:"Test Finance",variant:"success",small:!0,onClick:()=>Zd(ht.financePhone,ht.financeApiKey)})]}),u.jsxs("div",{style:{padding:"14px",backgroundColor:"#F8FAFC",borderRadius:"8px",border:"1px solid #E2E8F0"},children:[u.jsxs("div",{style:{fontSize:"13px",fontWeight:"700",color:"#1E293B",marginBottom:"10px",display:"flex",alignItems:"center",gap:"6px"},children:[u.jsx(V0,{size:16})," Director"]}),u.jsx(Er,{label:"Phone (with country code)",value:ht.directorPhone,onChange:p=>Vn(T=>({...T,directorPhone:p.target.value})),placeholder:"919876543210",small:!0}),u.jsx(Er,{label:"API Key (from CallMeBot)",value:ht.directorApiKey,onChange:p=>Vn(T=>({...T,directorApiKey:p.target.value})),placeholder:"123456",small:!0}),ht.directorPhone&&ht.directorApiKey&&u.jsx(Ye,{icon:Q2,label:"Test Director",variant:"success",small:!0,onClick:()=>Zd(ht.directorPhone,ht.directorApiKey)})]})]}),!ht.enabled&&u.jsx("div",{style:{padding:"20px",backgroundColor:"#F8FAFC",borderRadius:"8px",textAlign:"center",color:"#64748B",fontSize:"13px"},children:"WhatsApp notifications are disabled. Enable to receive FREE alerts for invoices, approvals, and payments."})]}),u.jsxs(Zr,{title:" Default Invoice Values",children:[u.jsx("input",{type:"file",ref:Qd,accept:".xlsx,.xls,.csv",style:{display:"none"},onChange:Y4}),u.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"12px"},children:[u.jsx(Ye,{icon:ea,label:"Upload",variant:"brand",small:!0,onClick:()=>{var p;return(p=Qd.current)==null?void 0:p.click()}}),u.jsx(Ye,{icon:xo,label:"Template",small:!0,onClick:q4})]}),Object.keys(Gs).length>0&&u.jsx("div",{style:{maxHeight:"180px",overflowY:"auto",border:"1px solid #E2E8F0",borderRadius:"8px"},children:Object.entries(Gs).map(([p,T])=>u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"10px 14px",borderBottom:"1px solid #F1F5F9",fontSize:"13px"},children:[u.jsx("span",{children:p}),u.jsx("span",{style:{fontWeight:"700"},children:et(T)})]},p))})]}),u.jsxs(Zr,{title:" Party Master",children:[u.jsx("input",{type:"file",ref:no,accept:".xlsx,.xls,.csv",style:{display:"none"},onChange:Q4}),u.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"12px"},children:[u.jsx(Ye,{icon:ea,label:"Upload Parties",variant:"brand",small:!0,onClick:()=>{var p;return(p=no.current)==null?void 0:p.click()}}),u.jsx(Ye,{icon:xo,label:"Template",small:!0,onClick:J4})]}),u.jsxs("div",{style:{padding:"10px",backgroundColor:"#EFF6FF",borderRadius:"8px",fontSize:"12px",color:"#1E40AF",marginBottom:"12px"},children:[u.jsx("strong",{children:"Upload Format:"})," Name of Ledger, Ledger Group, State Name, GST Registration Type, GSTIN/UIN"]}),Object.keys(qr).length>0&&u.jsxs("div",{style:{maxHeight:"150px",overflowY:"auto",border:"1px solid #E2E8F0",borderRadius:"8px"},children:[Object.entries(qr).slice(0,20).map(([p,T])=>u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px 12px",borderBottom:"1px solid #F1F5F9",fontSize:"11px"},children:[u.jsx("span",{style:{fontWeight:"600"},children:p.length>30?p.substring(0,30)+"...":p}),u.jsxs("span",{style:{color:"#64748B"},children:[T.stateName||"-"," | ",T.gstin?T.gstin.substring(0,10)+"...":"-"]})]},p)),Object.keys(qr).length>20&&u.jsxs("div",{style:{padding:"8px 12px",textAlign:"center",color:"#64748B",fontSize:"11px"},children:["... and ",Object.keys(qr).length-20," more parties"]})]}),Object.keys(qr).length===0&&u.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#94A3B8",fontSize:"13px"},children:"No party master uploaded yet"})]}),u.jsxs(Zr,{title:" Data Management",children:[u.jsxs("div",{style:{padding:"16px",backgroundColor:"#FEF2F2",borderRadius:"10px",border:"1px solid #FCA5A5",marginBottom:"16px"},children:[u.jsx("div",{style:{fontWeight:"700",color:"#991B1B",fontSize:"14px",marginBottom:"8px"},children:" Danger Zone"}),u.jsxs("div",{style:{fontSize:"13px",color:"#7F1D1D",marginBottom:"16px"},children:["This will permanently delete all data including:",u.jsxs("ul",{style:{margin:"8px 0 0 16px",padding:0},children:[u.jsx("li",{children:"All campaigns and master data"}),u.jsx("li",{children:"All invoices and receipts"}),u.jsx("li",{children:"All ledger entries"}),u.jsx("li",{children:"All mailer images"}),u.jsx("li",{children:"Opening balances and settings"})]})]}),u.jsx(Ye,{icon:Fs,label:"Clear All Data",variant:"danger",onClick:()=>vs(!0)})]}),u.jsxs("div",{style:{fontSize:"12px",color:"#64748B"},children:[u.jsx("strong",{children:"Current Data:"}),u.jsx("br",{})," ",_e.length," campaigns",u.jsx("br",{})," ",re.length," ledger entries",u.jsx("br",{})," ",Oe.length," receipts",u.jsx("br",{})," ",Object.keys(wi).length," mailer images"]})]})]})]}),BF=()=>u.jsxs(u.Fragment,{children:[u.jsx(wn,{isOpen:gF,onClose:()=>{dy(!1),py("")},title:" Invoice Preview",width:"950px",children:ae&&hy&&u.jsxs("div",{children:[u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px",padding:"14px 18px",backgroundColor:"#DCFCE7",borderRadius:"10px",border:"2px solid #22C55E"},children:[u.jsxs("div",{children:[u.jsxs("span",{style:{fontWeight:"700",fontSize:"16px",color:"#166534"},children:["Invoice: ",ae.invoiceNo]}),ae.invoiceType==="Combined"&&u.jsxs("span",{style:{marginLeft:"12px",padding:"4px 10px",backgroundColor:"#7C3AED",color:"white",borderRadius:"6px",fontSize:"12px",fontWeight:"600"},children:["Combined - C",ae.combinationCode]})]}),u.jsxs("button",{onClick:()=>xF(ae),style:{padding:"14px 28px",fontSize:"16px",fontWeight:"bold",border:"none",borderRadius:"10px",cursor:"pointer",backgroundColor:"#22C55E",color:"white",display:"flex",alignItems:"center",gap:"10px",boxShadow:"0 2px 8px rgba(34, 197, 94, 0.4)"},children:[u.jsx(xo,{size:20}),"Download Invoice"]})]}),u.jsx("div",{style:{border:"2px solid #E2E8F0",borderRadius:"10px",overflow:"hidden",backgroundColor:"#f5f5f5"},children:u.jsx("iframe",{id:"invoice-viewer-iframe",srcDoc:hy,style:{width:"100%",height:"480px",border:"none",backgroundColor:"white"},title:"Invoice Preview"})}),u.jsxs("div",{style:{marginTop:"12px",padding:"14px 18px",backgroundColor:"#FEF3C7",borderRadius:"10px",border:"1px solid #FCD34D"},children:[u.jsx("div",{style:{fontSize:"14px",color:"#92400E",fontWeight:"600",marginBottom:"6px"},children:" How to Save as PDF:"}),u.jsxs("ol",{style:{fontSize:"13px",color:"#92400E",margin:"0",paddingLeft:"20px",lineHeight:"1.8"},children:[u.jsxs("li",{children:["Click ",u.jsx("strong",{children:'"Download Invoice"'})," button above"]}),u.jsxs("li",{children:["Open the downloaded ",u.jsx("strong",{children:".html file"})," in Chrome/Edge browser"]}),u.jsxs("li",{children:["Print dialog will open automatically - select ",u.jsx("strong",{children:'"Save as PDF"'})]}),u.jsxs("li",{children:["Click ",u.jsx("strong",{children:"Save"})," to get your PDF!"]})]})]})]})}),u.jsx(wn,{isOpen:dr,onClose:()=>{hr(!1),Ei(""),Hs({particularsApproved:!1,emailApproved:!1,invoiceTypeApproved:!1})},title:Vr?" Review & Approve Invoice":" Invoice Details",width:"550px",children:ae&&u.jsxs("div",{children:[u.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px",borderRadius:"10px",marginBottom:"16px"},children:[u.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[u.jsx("strong",{children:"Invoice:"})," ",ae.invoiceNo]}),u.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[u.jsx("strong",{children:"Party:"})," ",ae.partyName]}),u.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[u.jsx("strong",{children:"Amount:"})," ",et(ae.invoiceTotalAmount)]}),u.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[u.jsx("strong",{children:"Email:"})," ",ae.emailId||"Not set"]}),u.jsxs("div",{style:{fontSize:"14px"},children:[u.jsx("strong",{children:"Invoice Type:"})," ",u.jsx("span",{style:{color:ae.invoiceType==="Combined"?"#7C3AED":"#2874A6",fontWeight:"600"},children:ae.invoiceType||"Individual"})]}),ae.invoiceType==="Combined"&&u.jsxs("div",{style:{marginTop:"8px",fontSize:"13px",color:"#7C3AED"},children:[u.jsx("strong",{children:"Combined Campaigns:"})," ",Ur(ae).map(p=>p.senderName).join(", ")]})]}),ae.editComments&&u.jsxs("div",{style:{backgroundColor:"#FEE2E2",padding:"12px",borderRadius:"8px",marginBottom:"16px",border:"1px solid #FCA5A5"},children:[u.jsx("div",{style:{fontWeight:"600",color:"#991B1B",fontSize:"13px",marginBottom:"4px"},children:" Need Edits - Director Remarks:"}),u.jsx("div",{style:{fontSize:"13px",color:"#7F1D1D"},children:ae.editComments})]}),ae.approvalRemarks&&ae.invoiceStatus==="Approved"&&u.jsxs("div",{style:{backgroundColor:"#DCFCE7",padding:"12px",borderRadius:"8px",marginBottom:"16px",border:"1px solid #86EFAC"},children:[u.jsx("div",{style:{fontWeight:"600",color:"#166534",fontSize:"13px",marginBottom:"4px"},children:" Approved - Director Remarks:"}),u.jsx("div",{style:{fontSize:"13px",color:"#15803D"},children:ae.approvalRemarks})]}),Vr?u.jsxs("div",{style:{backgroundColor:"#F0FDF4",padding:"16px",borderRadius:"10px",marginBottom:"16px",border:"1px solid #86EFAC"},children:[u.jsx("div",{style:{fontWeight:"700",color:"#166534",fontSize:"14px",marginBottom:"12px"},children:" Approval Confirmations"}),u.jsxs("label",{style:{display:"flex",alignItems:"flex-start",gap:"10px",marginBottom:"12px",cursor:"pointer"},children:[u.jsx("input",{type:"checkbox",checked:va.particularsApproved,onChange:p=>Hs(T=>({...T,particularsApproved:p.target.checked})),style:{marginTop:"2px",width:"18px",height:"18px",accentColor:"#059669"}}),u.jsxs("div",{children:[u.jsx("div",{style:{fontWeight:"600",fontSize:"13px",color:"#166534"},children:"1. Particulars & Amount Approved"}),u.jsxs("div",{style:{fontSize:"12px",color:"#15803D"},children:["I confirm that the invoice particulars and amount (",et(ae.invoiceTotalAmount),") are correct."]})]})]}),u.jsxs("label",{style:{display:"flex",alignItems:"flex-start",gap:"10px",marginBottom:"12px",cursor:"pointer"},children:[u.jsx("input",{type:"checkbox",checked:va.emailApproved,onChange:p=>Hs(T=>({...T,emailApproved:p.target.checked})),style:{marginTop:"2px",width:"18px",height:"18px",accentColor:"#059669"}}),u.jsxs("div",{children:[u.jsx("div",{style:{fontWeight:"600",fontSize:"13px",color:"#166534"},children:"2. Email ID Approved for Mailing"}),u.jsxs("div",{style:{fontSize:"12px",color:"#15803D"},children:["I confirm that ",u.jsx("strong",{children:ae.emailId||"the specified email"})," should be used for mailing."]})]})]}),u.jsxs("label",{style:{display:"flex",alignItems:"flex-start",gap:"10px",cursor:"pointer"},children:[u.jsx("input",{type:"checkbox",checked:va.invoiceTypeApproved,onChange:p=>Hs(T=>({...T,invoiceTypeApproved:p.target.checked})),style:{marginTop:"2px",width:"18px",height:"18px",accentColor:"#059669"}}),u.jsxs("div",{children:[u.jsx("div",{style:{fontWeight:"600",fontSize:"13px",color:"#166534"},children:"3. Invoice Type Confirmed"}),u.jsx("div",{style:{fontSize:"12px",color:"#15803D"},children:ae.invoiceType==="Combined"?`I confirm that a Combined Invoice is required for these ${Ur(ae).length} campaigns.`:"I confirm that an Individual Invoice is required (not combined with others)."})]})]})]}):u.jsxs("div",{style:{backgroundColor:ae.invoiceStatus==="Approved"?"#DCFCE7":ae.invoiceStatus==="Need Edits"?"#FEF3C7":"#F8FAFC",padding:"16px",borderRadius:"10px",marginBottom:"16px",border:"1px solid "+(ae.invoiceStatus==="Approved"?"#86EFAC":ae.invoiceStatus==="Need Edits"?"#FCD34D":"#E2E8F0")},children:[u.jsx("div",{style:{fontWeight:"600",color:ae.invoiceStatus==="Approved"?"#166534":ae.invoiceStatus==="Need Edits"?"#92400E":"#64748B",fontSize:"14px"},children:ae.invoiceStatus==="Approved"?" Approved by Director":ae.invoiceStatus==="Need Edits"?" Edits Required by Director":" Pending Director Approval"}),u.jsx("div",{style:{fontSize:"13px",color:ae.invoiceStatus==="Approved"?"#15803D":ae.invoiceStatus==="Need Edits"?"#A16207":"#64748B",marginTop:"6px"},children:ae.invoiceStatus==="Approved"?"This invoice has been approved and is ready for mailing.":ae.invoiceStatus==="Need Edits"?"Please make the required changes and resubmit for approval.":"This invoice is awaiting Director approval."})]}),Vr&&u.jsxs("div",{style:{marginBottom:"16px"},children:[u.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:" Remarks (optional for Approve, visible to Finance)"}),u.jsx("textarea",{value:zs,onChange:p=>Ei(p.target.value),placeholder:"Enter remarks or comments...",style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"13px",minHeight:"80px",resize:"vertical",boxSizing:"border-box"}})]}),u.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[u.jsx(Ye,{label:"Close",onClick:()=>{hr(!1),Ei(""),Hs({particularsApproved:!1,emailApproved:!1,invoiceTypeApproved:!1})}}),Vr&&u.jsxs(u.Fragment,{children:[u.jsx(Ye,{label:"Need Edits",variant:"danger",icon:T9,onClick:se}),u.jsx(Ye,{label:"Approve",variant:"success",icon:F9,onClick:O})]})]})]})}),u.jsx(wn,{isOpen:yr,onClose:()=>li(!1),title:" Delete Invoice",width:"450px",children:ae&&u.jsxs("div",{children:[u.jsxs("div",{style:{backgroundColor:"#FEE2E2",padding:"16px",borderRadius:"10px",marginBottom:"16px",border:"1px solid #FCA5A5"},children:[u.jsx("div",{style:{fontWeight:"700",color:"#991B1B",fontSize:"15px",marginBottom:"8px"},children:" Are you sure?"}),u.jsxs("div",{style:{fontSize:"14px",color:"#7F1D1D",lineHeight:"1.5"},children:["This will delete invoice ",u.jsx("strong",{children:ae.invoiceNo})," and reset the campaign(s) to allow re-generation.",ae.invoiceType==="Combined"&&u.jsxs("div",{style:{marginTop:"8px"},children:[u.jsxs("strong",{children:["All ",Ur(ae).length," combined campaigns"]})," will be reset to Individual type for re-selection."]})]})]}),u.jsxs("div",{style:{backgroundColor:"#F8FAFC",padding:"12px",borderRadius:"8px",marginBottom:"16px"},children:[u.jsxs("div",{style:{fontSize:"13px"},children:[u.jsx("strong",{children:"Invoice:"})," ",ae.invoiceNo]}),u.jsxs("div",{style:{fontSize:"13px"},children:[u.jsx("strong",{children:"Party:"})," ",ae.partyName]}),u.jsxs("div",{style:{fontSize:"13px"},children:[u.jsx("strong",{children:"Amount:"})," ",et(ae.invoiceTotalAmount)]})]}),u.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[u.jsx(Ye,{label:"Cancel",onClick:()=>li(!1)}),u.jsx(Ye,{label:"Delete Invoice",variant:"danger",icon:Fs,onClick:_n})]})]})}),u.jsx(wn,{isOpen:oi,onClose:()=>ct(!1),title:" Add Email Address",width:"400px",children:ae&&u.jsxs("div",{children:[u.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"12px",borderRadius:"8px",marginBottom:"16px"},children:[u.jsxs("div",{style:{fontSize:"13px"},children:[u.jsx("strong",{children:"Campaign:"})," ",ae.senderName]}),u.jsxs("div",{style:{fontSize:"13px",marginTop:"4px"},children:[u.jsx("strong",{children:"Current:"})," ",ae.emailId||"None"]})]}),u.jsx(Er,{label:"Additional Email Address",type:"email",value:ma,onChange:p=>Us(p.target.value),placeholder:"email@example.com",small:!0}),u.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"16px"},children:[u.jsx(Ye,{label:"Cancel",onClick:()=>ct(!1)}),u.jsx(Ye,{label:"Add Email",variant:"brand",icon:q2,onClick:()=>{ma&&ma.includes("@")?(f(ae.id,ma),ct(!1),Us("")):alert("Please enter a valid email address")}})]})]})}),u.jsx(wn,{isOpen:k,onClose:()=>{_(!1),K({currentPassword:"",newPassword:"",confirmPassword:""}),S("")},title:" Change Password",width:"400px",children:u.jsxs("div",{children:[u.jsx("div",{style:{backgroundColor:"#EFF6FF",padding:"12px",borderRadius:"8px",marginBottom:"16px"},children:u.jsxs("div",{style:{fontSize:"13px"},children:[u.jsx("strong",{children:"User:"})," ",r==="director"?"Director":"Finance Team"]})}),u.jsxs("div",{style:{marginBottom:"16px"},children:[u.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Current Password"}),u.jsx("input",{type:"password",value:P.currentPassword,onChange:p=>K(T=>({...T,currentPassword:p.target.value})),placeholder:"Enter current password",style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"14px",boxSizing:"border-box"}})]}),u.jsxs("div",{style:{marginBottom:"16px"},children:[u.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"New Password"}),u.jsx("input",{type:"password",value:P.newPassword,onChange:p=>K(T=>({...T,newPassword:p.target.value})),placeholder:"Enter new password (min 6 characters)",style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"14px",boxSizing:"border-box"}})]}),u.jsxs("div",{style:{marginBottom:"16px"},children:[u.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Confirm New Password"}),u.jsx("input",{type:"password",value:P.confirmPassword,onChange:p=>K(T=>({...T,confirmPassword:p.target.value})),placeholder:"Confirm new password",onKeyPress:p=>p.key==="Enter"&&lo(),style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"14px",boxSizing:"border-box"}})]}),V&&u.jsx("div",{style:{marginBottom:"16px",padding:"10px",backgroundColor:"#FEE2E2",borderRadius:"8px",color:"#991B1B",fontSize:"13px"},children:V}),u.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:[u.jsx(Ye,{label:"Cancel",onClick:()=>{_(!1),K({currentPassword:"",newPassword:"",confirmPassword:""}),S("")}}),u.jsx(Ye,{label:"Change Password",variant:"brand",icon:j0,onClick:lo})]})]})}),u.jsx(wn,{isOpen:k,onClose:()=>{_(!1),S(""),K({currentPassword:"",newPassword:"",confirmPassword:""})},title:" Change Password",width:"400px",children:u.jsxs("div",{children:[u.jsx("div",{style:{backgroundColor:"#EFF6FF",padding:"12px",borderRadius:"8px",marginBottom:"16px"},children:u.jsxs("div",{style:{fontSize:"13px",color:"#1E40AF"},children:["Changing password for: ",u.jsx("strong",{children:r==="director"?"Director":"Finance Team"})]})}),u.jsxs("div",{style:{marginBottom:"16px"},children:[u.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Current Password"}),u.jsx("input",{type:"password",value:P.currentPassword,onChange:p=>K(T=>({...T,currentPassword:p.target.value})),placeholder:"Enter current password",style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"14px",boxSizing:"border-box"}})]}),u.jsxs("div",{style:{marginBottom:"16px"},children:[u.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"New Password"}),u.jsx("input",{type:"password",value:P.newPassword,onChange:p=>K(T=>({...T,newPassword:p.target.value})),placeholder:"Enter new password (min 6 chars)",style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"14px",boxSizing:"border-box"}})]}),u.jsxs("div",{style:{marginBottom:"16px"},children:[u.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Confirm New Password"}),u.jsx("input",{type:"password",value:P.confirmPassword,onChange:p=>K(T=>({...T,confirmPassword:p.target.value})),placeholder:"Re-enter new password",style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"14px",boxSizing:"border-box"}})]}),V&&u.jsx("div",{style:{marginBottom:"16px",padding:"10px",backgroundColor:"#FEE2E2",borderRadius:"8px",color:"#991B1B",fontSize:"13px"},children:V}),u.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:[u.jsx(Ye,{label:"Cancel",onClick:()=>{_(!1),S(""),K({currentPassword:"",newPassword:"",confirmPassword:""})}}),u.jsx(Ye,{label:"Change Password",variant:"brand",icon:j0,onClick:lo})]})]})}),u.jsx(wn,{isOpen:Sr,onClose:()=>{fr(!1),eo(new Set),Bu(null)},title:" Combine Invoices",width:"700px",children:uc&&u.jsxs("div",{children:[u.jsxs("div",{style:{backgroundColor:"#F3E8FF",padding:"14px 18px",borderRadius:"10px",marginBottom:"16px"},children:[u.jsxs("div",{style:{fontSize:"15px",fontWeight:"700",color:"#6B21A8"},children:["Party: ",uc]}),u.jsx("div",{style:{fontSize:"13px",color:"#7C3AED",marginTop:"4px"},children:"Select 2+ campaigns to combine into a single invoice"})]}),u.jsx("div",{style:{maxHeight:"350px",overflowY:"auto",border:"1px solid #E2E8F0",borderRadius:"10px"},children:u.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"13px"},children:[u.jsx("thead",{children:u.jsxs("tr",{style:{backgroundColor:"#F8FAFC",position:"sticky",top:0},children:[u.jsx("th",{style:{padding:"12px",textAlign:"center",width:"50px"},children:""}),u.jsx("th",{style:{padding:"12px",textAlign:"left"},children:"Sender"}),u.jsx("th",{style:{padding:"12px",textAlign:"left"},children:"Subject"}),u.jsx("th",{style:{padding:"12px",textAlign:"left"},children:"Date"}),u.jsx("th",{style:{padding:"12px",textAlign:"right"},children:"Amount"})]})}),u.jsx("tbody",{children:n0(uc).map(p=>{var T;return u.jsxs("tr",{style:{borderBottom:"1px solid #F1F5F9",backgroundColor:Ji.has(p.id)?"#F3E8FF":"transparent",cursor:"pointer"},onClick:()=>cF(p.id),children:[u.jsx("td",{style:{padding:"12px",textAlign:"center"},children:u.jsx("input",{type:"checkbox",checked:Ji.has(p.id),onChange:()=>{},style:{width:"18px",height:"18px",cursor:"pointer"}})}),u.jsx("td",{style:{padding:"12px",fontWeight:"600"},children:p.senderName}),u.jsxs("td",{style:{padding:"12px",color:"#64748B"},children:[(T=p.subject)==null?void 0:T.substring(0,35),"..."]}),u.jsx("td",{style:{padding:"12px"},children:Vt(p.date)}),u.jsx("td",{style:{padding:"12px",textAlign:"right",fontWeight:"700"},children:et(p.totalWithGst)})]},p.id)})})]})}),u.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px 18px",borderRadius:"10px",marginTop:"16px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[u.jsxs("div",{style:{fontSize:"14px",color:"#64748B"},children:["Selected: ",u.jsx("strong",{children:Ji.size})," | Combine Code: ",u.jsxs("strong",{children:["C",tt]})]}),u.jsxs("div",{style:{fontSize:"18px",fontWeight:"700",color:"#2874A6"},children:["Total: ",et(_e.filter(p=>Ji.has(p.id)).reduce((p,T)=>p+(parseFloat(T.totalWithGst)||0),0))]})]}),u.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"16px"},children:[u.jsx(Ye,{label:"Cancel",onClick:()=>{fr(!1),eo(new Set)}}),u.jsx(Ye,{label:"Create Combined Invoice",variant:"purple",icon:vl,disabled:Ji.size<2,onClick:lF})]})]})}),u.jsxs(wn,{isOpen:In,onClose:()=>{sn(!1),_a(null),Ea(!1)},title:Zt?" Replace Mailer":" Upload Mailer",width:"550px",children:[u.jsx("input",{type:"file",ref:ws,accept:"image/*",style:{display:"none"},onChange:fF}),ae&&u.jsxs("div",{children:[u.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px",borderRadius:"10px",marginBottom:"14px"},children:[u.jsxs("div",{style:{fontSize:"14px"},children:[u.jsx("strong",{children:"Sender:"})," ",ae.senderName]}),u.jsxs("div",{style:{fontSize:"14px",marginTop:"4px"},children:[u.jsx("strong",{children:"Subject:"})," ",ae.subject]})]}),Zt&&wi[ae.id]&&u.jsx("div",{style:{backgroundColor:"#FEF3C7",padding:"12px",borderRadius:"10px",marginBottom:"14px",border:"1px solid #FCD34D"},children:u.jsxs("div",{style:{fontWeight:"600",color:"#92400E",fontSize:"13px"},children:[" This will replace ",wi[ae.id].length," existing image(s)"]})}),u.jsxs("div",{style:{backgroundColor:"#FEF3C7",padding:"14px",borderRadius:"10px",marginBottom:"14px",border:"1px solid #FCD34D"},children:[u.jsx("div",{style:{fontWeight:"700",color:"#92400E",marginBottom:"8px",fontSize:"14px"},children:"Step 1: Find Mailer in Gmail"}),u.jsxs("button",{onClick:()=>hF(ae.subject),style:{display:"flex",alignItems:"center",gap:"8px",padding:"10px 18px",backgroundColor:"#EA4335",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"14px",fontWeight:"600"},children:[u.jsx(w9,{size:16})," Search in Gmail"]})]}),u.jsxs("div",{style:{backgroundColor:"#F0FDF4",padding:"14px",borderRadius:"10px",border:"1px solid #86EFAC"},children:[u.jsx("div",{style:{fontWeight:"700",color:"#166534",marginBottom:"8px",fontSize:"14px"},children:"Step 2: Paste Screenshot"}),u.jsx("div",{ref:ul,tabIndex:0,onPaste:dF,onClick:()=>{var p;return(p=ul.current)==null?void 0:p.focus()},style:{border:Es?"3px solid #22C55E":"3px dashed #22C55E",borderRadius:"10px",padding:Es?"8px":"30px",textAlign:"center",cursor:"pointer",backgroundColor:Es?"#FFFFFF":"#ECFDF5",minHeight:"100px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",outline:"none"},children:Es?u.jsxs(u.Fragment,{children:[u.jsx("img",{src:Es,alt:"Pasted",style:{maxWidth:"100%",maxHeight:"200px",borderRadius:"8px",marginBottom:"10px"}}),u.jsxs("div",{style:{display:"flex",gap:"8px"},children:[u.jsx(Ye,{icon:Wg,label:"Save",variant:"success",onClick:()=>uy(Es)}),u.jsx(Ye,{icon:Fs,label:"Clear",variant:"danger",onClick:()=>_a(null)})]})]}):u.jsxs(u.Fragment,{children:[u.jsx($g,{size:36,color:"#22C55E",style:{marginBottom:"8px"}}),u.jsx("div",{style:{fontWeight:"700",fontSize:"14px",color:"#166534"},children:"Click here & Press Ctrl+V"})]})}),u.jsxs("div",{style:{textAlign:"center",marginTop:"12px"},children:[u.jsx("span",{style:{color:"#64748B",fontSize:"13px"},children:" OR "}),u.jsx("div",{style:{marginTop:"8px"},children:u.jsx(Ye,{icon:ea,label:"Browse Files",onClick:()=>{var p;return(p=ws.current)==null?void 0:p.click()}})})]})]})]})]}),u.jsx(wn,{isOpen:xi,onClose:()=>qi(!1),title:" Send Invoice Email",width:"600px",children:ae&&u.jsxs("div",{children:[u.jsxs("div",{style:{display:"flex",gap:"0",marginBottom:"16px",border:"2px solid #E2E8F0",borderRadius:"8px",overflow:"hidden"},children:[u.jsx("button",{onClick:()=>Qi("reply"),style:{flex:1,padding:"12px",backgroundColor:_i==="reply"?"#2874A6":"#F8FAFC",color:_i==="reply"?"white":"#64748B",border:"none",cursor:"pointer",fontWeight:"700",fontSize:"14px"},children:" Reply to Thread"}),u.jsx("button",{onClick:()=>Qi("new"),style:{flex:1,padding:"12px",backgroundColor:_i==="new"?"#2874A6":"#F8FAFC",color:_i==="new"?"white":"#64748B",border:"none",cursor:"pointer",fontWeight:"700",fontSize:"14px"},children:" New Email"})]}),u.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px",borderRadius:"10px",marginBottom:"16px"},children:[u.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[u.jsx("strong",{children:"Invoice:"})," ",ae.invoiceNo]}),u.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[u.jsx("strong",{children:"Amount:"})," ",et(ae.invoiceTotalAmount||ae.totalWithGst)]}),ae.invoiceType==="Combined"&&u.jsxs("div",{style:{fontSize:"13px",marginTop:"8px",color:"#7C3AED"},children:[u.jsx("strong",{children:"Campaigns:"})," ",Ur(ae).map(p=>p.senderName).join(", ")]}),u.jsx("div",{style:{fontSize:"14px",marginTop:"8px"},children:u.jsx("strong",{children:"Recipients:"})}),u.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"6px",marginTop:"6px"},children:[es(ae).map((p,T)=>u.jsx("span",{style:{padding:"4px 10px",backgroundColor:"#DBEAFE",borderRadius:"6px",fontSize:"13px",color:"#1E40AF"},children:p},T)),es(ae).length===0&&u.jsx("span",{style:{color:"#94A3B8"},children:"No email addresses"})]})]}),_i==="reply"?u.jsxs("div",{children:[u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"8px"},children:[u.jsx("span",{style:{fontWeight:"700",fontSize:"14px"},children:"Email Body:"}),u.jsx("button",{onClick:()=>{navigator.clipboard.writeText(a0(ae)),alert(" Copied!")},style:{padding:"6px 14px",backgroundColor:"#22C55E",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"13px",fontWeight:"600"},children:" Copy"})]}),u.jsx("div",{style:{fontSize:"13px",backgroundColor:"#F8FAFC",padding:"14px",borderRadius:"10px",whiteSpace:"pre-wrap",maxHeight:"200px",overflowY:"auto",fontFamily:"monospace",border:"1px solid #E2E8F0",lineHeight:"1.5"},children:a0(ae)})]}):u.jsxs("div",{style:{display:"flex",gap:"10px"},children:[u.jsx("button",{onClick:()=>{const p=es(ae),T=encodeURIComponent(p.join(",")),H=encodeURIComponent(fy(ae)),W=encodeURIComponent(a0(ae));window.open(`https://mail.google.com/mail/?view=cm&to=${T}&su=${H}&body=${W}`,"_blank")},style:{padding:"12px 20px",backgroundColor:"#EA4335",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"14px",fontWeight:"700"},children:" Open Gmail"}),u.jsx("button",{onClick:()=>{const p=es(ae),T=encodeURIComponent(p.join(";")),H=encodeURIComponent(fy(ae)),W=encodeURIComponent(a0(ae));window.open(`https://outlook.live.com/mail/0/deeplink/compose?to=${T}&subject=${H}&body=${W}`,"_blank")},style:{padding:"12px 20px",backgroundColor:"#0078D4",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"14px",fontWeight:"700"},children:" Open Outlook"})]}),u.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"16px"},children:[u.jsx(Ye,{label:"View Invoice",icon:B0,onClick:()=>{qi(!1),Gu(ae)}}),u.jsx(Ye,{label:"Close",onClick:()=>qi(!1)})]})]})}),u.jsx(wn,{isOpen:vi,onClose:()=>Lr(!1),title:" Record Payment",width:"500px",children:ae&&u.jsxs("div",{children:[u.jsxs("div",{style:{backgroundColor:"#F0FDF4",padding:"14px",borderRadius:"10px",marginBottom:"16px"},children:[u.jsxs("div",{style:{fontSize:"14px"},children:[u.jsx("strong",{children:"Invoice:"})," ",ae.invoiceNo]}),u.jsxs("div",{style:{fontSize:"14px",marginTop:"4px"},children:[u.jsx("strong",{children:"Party:"})," ",ae.partyName]})]}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[u.jsx(Er,{label:"Payment Amount",type:"number",value:_r.amount,onChange:p=>to({..._r,amount:p.target.value}),small:!0}),u.jsx(Er,{label:"Date",type:"date",value:_r.date,onChange:p=>to({..._r,date:p.target.value}),small:!0})]}),u.jsx(X0,{label:"Payment Mode",value:_r.mode,onChange:p=>to({..._r,mode:p.target.value}),options:[{value:"Bank",label:"Bank Transfer"},{value:"UPI",label:"UPI"},{value:"Cheque",label:"Cheque"},{value:"Cash",label:"Cash"}],small:!0}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[u.jsx(Er,{label:"TDS Deducted",type:"number",value:_r.tds,onChange:p=>to({..._r,tds:p.target.value}),placeholder:"0",small:!0}),u.jsx(Er,{label:"Discount",type:"number",value:_r.discount,onChange:p=>to({..._r,discount:p.target.value}),placeholder:"0",small:!0})]}),u.jsx(Er,{label:"Narration",value:_r.narration,onChange:p=>to({..._r,narration:p.target.value}),placeholder:"Reference",small:!0}),u.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"16px"},children:[u.jsx(Ye,{label:"Cancel",onClick:()=>Lr(!1)}),u.jsx(Ye,{label:"Record Payment",variant:"success",icon:E9,onClick:vF})]})]})}),u.jsxs(wn,{isOpen:yi,onClose:()=>Qt(!1),title:" Set Opening Balance",width:"450px",children:[u.jsx(X0,{label:"Select Party",value:Si.partyName,onChange:p=>ll({...Si,partyName:p.target.value}),options:[{value:"",label:"Choose a party..."},...gl.map(p=>({value:p,label:p}))],small:!0}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr",gap:"12px"},children:[u.jsx(Er,{label:"Amount",type:"number",value:Si.amount,onChange:p=>ll({...Si,amount:p.target.value}),small:!0}),u.jsx(X0,{label:"Type",value:Si.type,onChange:p=>ll({...Si,type:p.target.value}),options:[{value:"Dr",label:"Debit"},{value:"Cr",label:"Credit"}],small:!0})]}),u.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"16px"},children:[u.jsx(Ye,{label:"Cancel",onClick:()=>Qt(!1)}),u.jsx(Ye,{label:"Save",variant:"brand",onClick:()=>{Si.partyName&&Si.amount&&($s(p=>({...p,[Si.partyName]:Si.type==="Dr"?parseFloat(Si.amount):-parseFloat(Si.amount)})),Qt(!1),ll({partyName:"",amount:"",type:"Dr"}))}})]})]}),u.jsxs(wn,{isOpen:cl,onClose:()=>Pi(!1),title:" Import Historical Ledger",width:"600px",children:[u.jsx("input",{type:"file",ref:io,accept:".xlsx,.xls,.csv",style:{display:"none"},onChange:Z4}),u.jsxs("div",{style:{padding:"16px",backgroundColor:"#EFF6FF",borderRadius:"10px",marginBottom:"16px",border:"1px solid #BFDBFE"},children:[u.jsx("div",{style:{fontWeight:"700",color:"#1E40AF",marginBottom:"8px",fontSize:"14px"},children:" How to Import Historical Ledger"}),u.jsxs("div",{style:{fontSize:"12px",color:"#1E3A8A",lineHeight:"1.6"},children:[u.jsx("p",{style:{margin:"0 0 8px 0"},children:"Upload your existing ledger data in the format shown in the template. This will import all historical transactions."}),u.jsxs("p",{style:{margin:0},children:[u.jsx("strong",{children:"Supported columns:"})," Date, Particular, Vch Type, Vch No., Debit, Credit, Date of Receipt, Amount Received, TDS Received, Balance, Payment Status"]})]})]}),Y&&u.jsxs("div",{style:{padding:"12px",backgroundColor:"#DCFCE7",borderRadius:"8px",marginBottom:"16px",border:"1px solid #86EFAC"},children:[u.jsxs("div",{style:{fontSize:"13px",color:"#166534"},children:[u.jsx("strong",{children:" Selected Party:"})," ",Y]}),u.jsx("div",{style:{fontSize:"11px",color:"#15803D",marginTop:"4px"},children:"All entries from the uploaded file will be imported for this party"})]}),!Y&&u.jsxs("div",{style:{padding:"12px",backgroundColor:"#FEE2E2",borderRadius:"8px",marginBottom:"16px",border:"1px solid #FCA5A5"},children:[u.jsx("div",{style:{fontSize:"13px",color:"#991B1B"},children:u.jsx("strong",{children:" No Party Selected"})}),u.jsx("div",{style:{fontSize:"12px",color:"#B91C1C",marginTop:"4px"},children:'Please close this modal and select a party from the Parties list on the left, then click "Import Historical" again.'})]}),u.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center",marginBottom:"16px"},children:[u.jsx(Ye,{icon:xo,label:"Download Template",variant:"brand",onClick:eF}),Y?u.jsx(Ye,{icon:ea,label:"Upload Ledger",variant:"success",onClick:()=>{var p;return(p=io.current)==null?void 0:p.click()}}):u.jsxs("button",{disabled:!0,style:{padding:"8px 16px",fontSize:"13px",fontWeight:"600",border:"none",borderRadius:"8px",backgroundColor:"#E2E8F0",color:"#94A3B8",cursor:"not-allowed",display:"flex",alignItems:"center",gap:"6px"},children:[u.jsx(ea,{size:16})," Upload Ledger"]})]}),u.jsxs("div",{style:{padding:"14px",backgroundColor:"#F8FAFC",borderRadius:"8px",border:"1px solid #E2E8F0"},children:[u.jsx("div",{style:{fontWeight:"600",color:"#475569",marginBottom:"8px",fontSize:"13px"},children:" Expected Format (matches your ledger export):"}),u.jsx("div",{style:{overflowX:"auto"},children:u.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"10px"},children:[u.jsx("thead",{children:u.jsxs("tr",{style:{backgroundColor:"#E2E8F0"},children:[u.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"left"},children:"Date"}),u.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"left"},children:"Particular"}),u.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"left"},children:"Vch Type"}),u.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"left"},children:"Vch No."}),u.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"right"},children:"Debit"}),u.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"right"},children:"Credit"}),u.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"right"},children:"Amt Recd"}),u.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"left"},children:"Status"})]})}),u.jsx("tbody",{children:u.jsxs("tr",{children:[u.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0"},children:"02-Jun-21"}),u.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0"},children:"DB Corp Ltd"}),u.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0"},children:"Sales"}),u.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0"},children:"MB/2020-21/0411"}),u.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0",textAlign:"right"},children:"6,000"}),u.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0"}}),u.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0",textAlign:"right"},children:"44,371"}),u.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0"},children:"Received"})]})})]})})]}),u.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"16px"},children:u.jsx(Ye,{label:"Close",onClick:()=>Pi(!1)})})]}),u.jsx(wn,{isOpen:Ja,onClose:()=>{Za(!1),yn({amount:"",tds:"",discount:"",narration:"",paymentAdvisory:null,date:new Date().toISOString().split("T")[0],mode:"Bank"})},title:" Create Receipt",width:"550px",children:ae&&u.jsxs("div",{children:[u.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px",borderRadius:"10px",marginBottom:"16px"},children:[u.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[u.jsx("strong",{children:"Invoice:"})," ",ae.invoiceNo]}),u.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[u.jsx("strong",{children:"Party:"})," ",ae.partyName]}),u.jsxs("div",{style:{fontSize:"14px"},children:[u.jsx("strong",{children:"Invoice Amount:"})," ",et(ae.invoiceTotalAmount)]})]}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",marginBottom:"12px"},children:[u.jsx(Er,{label:"Receipt Date",type:"date",value:vt.date,onChange:p=>yn({...vt,date:p.target.value}),small:!0}),u.jsx(X0,{label:"Payment Mode",value:vt.mode,onChange:p=>yn({...vt,mode:p.target.value}),options:[{value:"Bank",label:"Bank Transfer"},{value:"Cash",label:"Cash"},{value:"Cheque",label:"Cheque"},{value:"UPI",label:"UPI"}],small:!0})]}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"12px",marginBottom:"12px"},children:[u.jsx(Er,{label:"Amount Received",type:"number",value:vt.amount,onChange:p=>yn({...vt,amount:p.target.value}),placeholder:"0.00",small:!0}),u.jsx(Er,{label:"TDS Deducted",type:"number",value:vt.tds,onChange:p=>yn({...vt,tds:p.target.value}),placeholder:"0.00",small:!0}),u.jsx(Er,{label:"Discount",type:"number",value:vt.discount,onChange:p=>yn({...vt,discount:p.target.value}),placeholder:"0.00",small:!0})]}),u.jsx("div",{style:{backgroundColor:"#F0FDF4",padding:"12px",borderRadius:"8px",marginBottom:"16px"},children:u.jsxs("div",{style:{fontSize:"14px",fontWeight:"700",color:"#166534"},children:["Total Credit: ",et((parseFloat(vt.amount)||0)+(parseFloat(vt.tds)||0)+(parseFloat(vt.discount)||0))]})}),u.jsx(Er,{label:"Narration",value:vt.narration,onChange:p=>yn({...vt,narration:p.target.value}),placeholder:"Payment reference, remarks...",small:!0}),u.jsxs("div",{style:{marginBottom:"16px"},children:[u.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Payment Advisory (Optional)"}),u.jsx("input",{type:"file",ref:fl,accept:"image/*,.pdf",onChange:Ot,style:{display:"none"}}),vt.paymentAdvisory?u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[u.jsx("div",{style:{flex:1,padding:"10px",backgroundColor:"#F0FDF4",borderRadius:"8px",fontSize:"13px",color:"#166534"},children:" Payment advisory attached"}),u.jsx("button",{onClick:()=>yn(p=>({...p,paymentAdvisory:null})),style:{padding:"8px",border:"none",backgroundColor:"#FEE2E2",borderRadius:"6px",cursor:"pointer",color:"#991B1B"},children:u.jsx(El,{size:16})})]}):u.jsxs("button",{onClick:()=>{var p;return(p=fl.current)==null?void 0:p.click()},style:{padding:"10px 16px",border:"1.5px dashed #D1D5DB",borderRadius:"8px",backgroundColor:"#F9FAFB",cursor:"pointer",fontSize:"13px",color:"#6B7280",display:"flex",alignItems:"center",gap:"8px"},children:[u.jsx(ea,{size:16})," Attach Payment Advisory"]})]}),u.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[u.jsx(Ye,{label:"Cancel",onClick:()=>Za(!1)}),u.jsx(Ye,{label:"Create Receipt",variant:"success",icon:vl,onClick:Ue})]})]})}),u.jsx(wn,{isOpen:Lu,onClose:()=>{xs(!1),_s({amount:"",gst:"",reason:"",date:new Date().toISOString().split("T")[0]})},title:" Create Credit Note",width:"500px",children:ae&&(()=>{var q;const p=(q=ae.statePartyDetails)==null?void 0:q.toUpperCase().includes("MAHARASHTRA"),T=p?"CGST + SGST (9% + 9%)":"IGST (18%)",H=parseFloat(Yt.amount)||0,W=parseFloat(Yt.gst)||0,L=H+W;return u.jsxs("div",{children:[u.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px",borderRadius:"10px",marginBottom:"16px"},children:[u.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[u.jsx("strong",{children:"Invoice:"})," ",ae.invoiceNo]}),u.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[u.jsx("strong",{children:"Party:"})," ",ae.partyName]}),u.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[u.jsx("strong",{children:"Invoice Amount:"})," ",et(ae.invoiceTotalAmount)]}),u.jsxs("div",{style:{fontSize:"12px",color:"#2563EB"},children:[u.jsx("strong",{children:"GST Type:"})," ",p?"CGST + SGST (Intra-state)":"IGST (Inter-state)"]})]}),u.jsx("div",{style:{marginBottom:"12px"},children:u.jsx(Er,{label:"Credit Note Date",type:"date",value:Yt.date,onChange:Z=>_s({...Yt,date:Z.target.value}),small:!0})}),u.jsxs("div",{style:{backgroundColor:"#FEF2F2",padding:"14px",borderRadius:"10px",marginBottom:"12px",border:"1px solid #FECACA"},children:[u.jsx("div",{style:{fontWeight:"700",color:"#991B1B",marginBottom:"10px",fontSize:"13px"},children:" Credit Note Breakdown"}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[u.jsx(Er,{label:"Base Amount",type:"number",value:Yt.amount,onChange:Z=>_s({...Yt,amount:Z.target.value}),placeholder:"0.00",small:!0}),u.jsx(Er,{label:T,type:"number",value:Yt.gst,onChange:Z=>_s({...Yt,gst:Z.target.value}),placeholder:"0.00",small:!0})]}),u.jsxs("div",{style:{marginTop:"10px",padding:"8px",backgroundColor:"#FEE2E2",borderRadius:"6px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[u.jsx("span",{style:{fontSize:"13px",fontWeight:"600",color:"#991B1B"},children:"Total Credit:"}),u.jsx("span",{style:{fontSize:"15px",fontWeight:"700",color:"#991B1B"},children:et(L)})]})]}),u.jsxs("div",{style:{marginBottom:"16px"},children:[u.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Reason for Credit Note *"}),u.jsx("textarea",{value:Yt.reason,onChange:Z=>_s({...Yt,reason:Z.target.value}),placeholder:"Enter reason for issuing credit note...",style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"13px",minHeight:"80px",resize:"vertical",boxSizing:"border-box"}})]}),u.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[u.jsx(Ye,{label:"Cancel",onClick:()=>xs(!1)}),u.jsx(Ye,{label:"Create Credit Note",variant:"danger",icon:rf,onClick:fn})]})]})})()}),u.jsx(wn,{isOpen:Ge,onClose:()=>{nt(!1),Lt(null)},title:" Add Followup",width:"500px",children:ot&&u.jsxs("div",{children:[u.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px",borderRadius:"10px",marginBottom:"16px"},children:[u.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[u.jsx("strong",{children:"Invoice:"})," ",ot.invoiceNo]}),u.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[u.jsx("strong",{children:"Party:"})," ",ot.partyName]}),u.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[u.jsx("strong",{children:"Amount:"})," ",et(ot.invoiceTotalAmount||ot.totalAmount)]}),u.jsxs("div",{style:{fontSize:"14px"},children:[u.jsx("strong",{children:"Invoice Date:"})," ",Vt(ot.invoiceDate||ot.date)]})]}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",marginBottom:"12px"},children:[u.jsx(Er,{label:"Followup Date",type:"date",value:kt.date,onChange:p=>ci({...kt,date:p.target.value}),small:!0}),u.jsx(Er,{label:"Next Followup Date",type:"date",value:kt.nextFollowupDate,onChange:p=>ci({...kt,nextFollowupDate:p.target.value}),small:!0})]}),u.jsxs("div",{style:{marginBottom:"16px"},children:[u.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Followup Notes *"}),u.jsx("textarea",{value:kt.notes,onChange:p=>ci({...kt,notes:p.target.value}),placeholder:"Enter followup notes (e.g., Spoke with accounts team, payment promised by next week)",style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"13px",minHeight:"80px",resize:"vertical",boxSizing:"border-box"}})]}),u.jsxs("div",{style:{marginBottom:"16px"},children:[u.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Status"}),u.jsxs("select",{value:kt.status,onChange:p=>ci({...kt,status:p.target.value}),style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"13px"},children:[u.jsx("option",{value:"Pending",children:"Pending"}),u.jsx("option",{value:"Promised",children:"Promised - Payment Expected"}),u.jsx("option",{value:"Disputed",children:"Disputed"}),u.jsx("option",{value:"No Response",children:"No Response"})]})]}),u.jsxs("div",{style:{backgroundColor:"#F0FDF4",padding:"12px",borderRadius:"8px",marginBottom:"16px",border:"1px solid #86EFAC"},children:[u.jsx("div",{style:{fontSize:"12px",fontWeight:"600",color:"#166534",marginBottom:"8px"},children:" Quick Actions"}),u.jsxs("div",{style:{display:"flex",gap:"8px"},children:[u.jsx(Ye,{icon:$g,label:"Copy Email Template",small:!0,variant:"brand",onClick:()=>oy(ot)}),u.jsx(Ye,{icon:Xg,label:"Search in Gmail",small:!0,variant:"success",onClick:()=>ly(ot)})]})]}),u.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[u.jsx(Ye,{label:"Cancel",onClick:()=>nt(!1)}),u.jsx(Ye,{label:"Save Followup",variant:"primary",icon:nf,onClick:G4})]})]})}),u.jsx(wn,{isOpen:ol,onClose:()=>vs(!1),title:" Clear All Data",width:"500px",children:u.jsxs("div",{children:[u.jsxs("div",{style:{backgroundColor:"#FEE2E2",padding:"20px",borderRadius:"12px",marginBottom:"20px",border:"2px solid #FCA5A5"},children:[u.jsxs("div",{style:{fontWeight:"700",color:"#991B1B",fontSize:"18px",marginBottom:"12px",display:"flex",alignItems:"center",gap:"8px"},children:[u.jsx(H2,{size:24})," Warning: This action cannot be undone!"]}),u.jsxs("div",{style:{fontSize:"14px",color:"#7F1D1D",lineHeight:"1.6"},children:["This will permanently delete:",u.jsxs("ul",{style:{margin:"12px 0 0 20px",padding:0},children:[u.jsxs("li",{children:[u.jsx("strong",{children:_e.length})," campaigns from Master Sheet"]}),u.jsxs("li",{children:[u.jsx("strong",{children:_e.filter(p=>p.invoiceGenerated).length})," generated invoices"]}),u.jsxs("li",{children:[u.jsx("strong",{children:Oe.length})," receipts"]}),u.jsxs("li",{children:[u.jsx("strong",{children:ne.length})," credit notes"]}),u.jsxs("li",{children:[u.jsx("strong",{children:re.length})," ledger entries"]}),u.jsxs("li",{children:[u.jsx("strong",{children:Object.keys(wi).length})," mailer images"]}),u.jsx("li",{children:"All opening balances"})]})]})]}),u.jsx("div",{style:{backgroundColor:"#FEF3C7",padding:"14px",borderRadius:"8px",marginBottom:"20px",border:"1px solid #FCD34D"},children:u.jsxs("div",{style:{fontSize:"13px",color:"#92400E"},children:[u.jsx("strong",{children:"Note:"})," Invoice series numbers will be reset to 1. Your company settings and mailer logo will be preserved."]})}),u.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:[u.jsx(Ye,{label:"Cancel",onClick:()=>vs(!1)}),u.jsx(Ye,{label:"Yes, Clear All Data",variant:"danger",icon:Fs,onClick:sF})]})]})}),u.jsx(wn,{isOpen:Ce,onClose:()=>je(!1),title:" Notifications",width:"550px",children:u.jsxs("div",{children:[u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[u.jsx("div",{style:{fontSize:"14px",color:"#64748B"},children:Oi>0?`${Oi} unread`:"No unread notifications"}),u.jsxs("div",{style:{display:"flex",gap:"8px"},children:[Oi>0&&u.jsx("button",{onClick:e0,style:{padding:"6px 12px",fontSize:"12px",fontWeight:"600",border:"1px solid #E2E8F0",borderRadius:"6px",backgroundColor:"#F8FAFC",color:"#475569",cursor:"pointer"},children:"Mark all as read"}),ce.length>0&&lr&&u.jsx("button",{onClick:t0,style:{padding:"6px 12px",fontSize:"12px",fontWeight:"600",border:"1px solid #FCA5A5",borderRadius:"6px",backgroundColor:"#FEE2E2",color:"#991B1B",cursor:"pointer"},children:"Clear all"})]})]}),u.jsx("div",{style:{maxHeight:"400px",overflowY:"auto"},children:oo.length===0?u.jsxs("div",{style:{padding:"40px",textAlign:"center",color:"#94A3B8"},children:[u.jsx(G2,{size:40,style:{marginBottom:"12px",opacity:.5}}),u.jsx("div",{style:{fontSize:"16px",fontWeight:"600"},children:"No notifications"}),u.jsx("div",{style:{fontSize:"13px",marginTop:"4px"},children:"You're all caught up!"})]}):oo.map(p=>{const T=!(p.read&&p.read[r]),H=L=>{switch(L){case"upload":return"";case"invoice":return"";case"approval":return"";case"edit":return"";case"receipt":return"";default:return""}},W=L=>{switch(L){case"upload":return"#EFF6FF";case"invoice":return"#FEF3C7";case"approval":return"#DCFCE7";case"edit":return"#FEE2E2";case"receipt":return"#F0FDF4";default:return"#F8FAFC"}};return u.jsx("div",{onClick:()=>pl(p.id),style:{padding:"14px",borderRadius:"10px",marginBottom:"8px",backgroundColor:T?W(p.type):"#F8FAFC",border:T?"2px solid #2874A6":"1px solid #E2E8F0",cursor:"pointer",transition:"all 0.2s ease"},children:u.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"12px"},children:[u.jsx("div",{style:{fontSize:"20px"},children:H(p.type)}),u.jsxs("div",{style:{flex:1},children:[u.jsx("div",{style:{fontSize:"14px",fontWeight:T?"600":"500",color:"#1E293B",lineHeight:"1.4"},children:p.message}),u.jsxs("div",{style:{display:"flex",gap:"12px",marginTop:"8px",fontSize:"11px",color:"#64748B"},children:[u.jsxs("span",{children:["By: ",p.createdBy==="finance"?"Finance Team":"Director"]}),u.jsx("span",{children:""}),u.jsx("span",{children:new Date(p.createdAt).toLocaleString()})]})]}),T&&u.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:"#DC2626",flexShrink:0}})]})},p.id)})})]})})]}),jF=()=>{switch(N){case"master":return xy();case"services":return AF();case"invoices":return RF();case"receipts":return DF();case"ledgers":return PF();case"followups":return MF();case"reports":return Sy();case"settings":return r==="finance"?LF():Sy();default:return xy()}},VF=()=>u.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, #1E3A5F 0%, #2874A6 50%, #1E3A5F 100%)",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',padding:"20px"},children:u.jsxs("div",{style:{backgroundColor:"#FFFFFF",padding:"0",borderRadius:"24px",boxShadow:"0 25px 50px -12px rgba(0,0,0,0.25)",width:"420px",maxWidth:"95vw",overflow:"hidden"},children:[u.jsxs("div",{style:{background:"linear-gradient(135deg, #1E3A5F 0%, #2874A6 100%)",padding:"32px 40px",textAlign:"center"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"12px",marginBottom:"8px"},children:[u.jsx("img",{src:"/logo.png",alt:"JAC",style:{width:"60px",height:"auto",borderRadius:"8px",backgroundColor:"white",padding:"4px"}}),u.jsx("span",{style:{fontSize:"36px",fontWeight:"800",color:"#FFFFFF",letterSpacing:"-1px"},children:"FinMate"})]}),u.jsx("p",{style:{margin:0,color:"rgba(255,255,255,0.8)",fontSize:"14px",fontWeight:"500"},children:"Finance Management System"})]}),u.jsxs("div",{style:{padding:"32px 40px"},children:[u.jsxs("div",{style:{marginBottom:"24px"},children:[u.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#1E3A5F",marginBottom:"8px",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Username"}),u.jsxs("div",{style:{position:"relative"},children:[u.jsx(Z2,{size:18,style:{position:"absolute",left:"14px",top:"50%",transform:"translateY(-50%)",color:"#94A3B8"}}),u.jsx("input",{type:"text",value:i.username,onChange:p=>s(T=>({...T,username:p.target.value})),placeholder:"Enter username",style:{width:"100%",padding:"14px 14px 14px 44px",borderRadius:"12px",border:"2px solid #E2E8F0",fontSize:"15px",boxSizing:"border-box",transition:"border-color 0.2s, box-shadow 0.2s",outline:"none"},onFocus:p=>{p.target.style.borderColor="#2874A6",p.target.style.boxShadow="0 0 0 3px rgba(40,116,166,0.1)"},onBlur:p=>{p.target.style.borderColor="#E2E8F0",p.target.style.boxShadow="none"}})]})]}),u.jsxs("div",{style:{marginBottom:"28px"},children:[u.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#1E3A5F",marginBottom:"8px",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Password"}),u.jsxs("div",{style:{position:"relative"},children:[u.jsx(j0,{size:18,style:{position:"absolute",left:"14px",top:"50%",transform:"translateY(-50%)",color:"#94A3B8"}}),u.jsx("input",{type:"password",value:i.password,onChange:p=>s(T=>({...T,password:p.target.value})),placeholder:"Enter password",onKeyPress:p=>p.key==="Enter"&&Hu(),style:{width:"100%",padding:"14px 14px 14px 44px",borderRadius:"12px",border:"2px solid #E2E8F0",fontSize:"15px",boxSizing:"border-box",transition:"border-color 0.2s, box-shadow 0.2s",outline:"none"},onFocus:p=>{p.target.style.borderColor="#2874A6",p.target.style.boxShadow="0 0 0 3px rgba(40,116,166,0.1)"},onBlur:p=>{p.target.style.borderColor="#E2E8F0",p.target.style.boxShadow="none"}})]})]}),a&&u.jsxs("div",{style:{marginBottom:"20px",padding:"14px",backgroundColor:"#FEF2F2",borderRadius:"12px",color:"#DC2626",fontSize:"14px",textAlign:"center",border:"1px solid #FECACA",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[u.jsx(H2,{size:18}),a]}),u.jsx("button",{onClick:Hu,style:{width:"100%",padding:"16px",fontSize:"16px",fontWeight:"700",border:"none",borderRadius:"12px",cursor:E?"pointer":"wait",background:E?"linear-gradient(135deg, #1E3A5F 0%, #2874A6 100%)":"#94A3B8",color:"white",transition:"transform 0.2s, box-shadow 0.2s",boxShadow:E?"0 4px 14px rgba(40,116,166,0.4)":"none",opacity:E?1:.7},disabled:!E,onMouseOver:p=>{E&&(p.target.style.transform="translateY(-2px)",p.target.style.boxShadow="0 6px 20px rgba(40,116,166,0.5)")},onMouseOut:p=>{E&&(p.target.style.transform="translateY(0)",p.target.style.boxShadow="0 4px 14px rgba(40,116,166,0.4)")},children:E?"Sign In":"Loading..."}),u.jsxs("div",{style:{marginTop:"24px",textAlign:"center",color:"#94A3B8",fontSize:"12px"},children:[u.jsx("span",{children:"Powered by "}),u.jsx("span",{style:{fontWeight:"600",color:"#1E3A5F"},children:"JAC"}),u.jsx("span",{children:"  Strategy | Talent | Results"})]})]})]})});return t?l?u.jsxs("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, #1E3A5F 0%, #2874A6 50%, #1E3A5F 100%)",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:[u.jsxs("div",{style:{textAlign:"center"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"12px",marginBottom:"24px"},children:[u.jsx("img",{src:"/logo.png",alt:"JAC",style:{width:"50px",height:"auto",borderRadius:"8px",backgroundColor:"white",padding:"4px"}}),u.jsx("span",{style:{fontSize:"32px",fontWeight:"800",color:"#FFFFFF",letterSpacing:"-1px"},children:"FinMate"})]}),u.jsx(Y2,{size:48,style:{animation:"spin 1s linear infinite",color:"#FFFFFF",marginBottom:"16px"}}),u.jsx("div",{style:{fontSize:"18px",fontWeight:"600",color:"#FFFFFF"},children:"Loading your data..."}),u.jsx("div",{style:{fontSize:"14px",color:"rgba(255,255,255,0.7)",marginTop:"8px"},children:"Please wait while we sync with the cloud"})]}),u.jsx("style",{children:"@keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }"})]}):u.jsxs("div",{style:{display:"flex",height:"100vh",backgroundColor:"#F1F5F9",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:[yF(),u.jsx("main",{style:{flex:1,overflow:"auto",padding:"20px"},children:jF()}),BF(),u.jsx("style",{children:"@keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }"})]}):VF()}cm.createRoot(document.getElementById("root")).render(u.jsx(Q0.StrictMode,{children:u.jsx(xH,{})}));
