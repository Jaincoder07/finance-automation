(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();function eF(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var YE={exports:{}},ap={},QE={exports:{}},wt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var o0=Symbol.for("react.element"),tF=Symbol.for("react.portal"),rF=Symbol.for("react.fragment"),nF=Symbol.for("react.strict_mode"),iF=Symbol.for("react.profiler"),sF=Symbol.for("react.provider"),aF=Symbol.for("react.context"),oF=Symbol.for("react.forward_ref"),lF=Symbol.for("react.suspense"),cF=Symbol.for("react.memo"),uF=Symbol.for("react.lazy"),uy=Symbol.iterator;function fF(t){return t===null||typeof t!="object"?null:(t=uy&&t[uy]||t["@@iterator"],typeof t=="function"?t:null)}var JE={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},ZE=Object.assign,ew={};function su(t,e,r){this.props=t,this.context=e,this.refs=ew,this.updater=r||JE}su.prototype.isReactComponent={};su.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};su.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function tw(){}tw.prototype=su.prototype;function Ax(t,e,r){this.props=t,this.context=e,this.refs=ew,this.updater=r||JE}var Cx=Ax.prototype=new tw;Cx.constructor=Ax;ZE(Cx,su.prototype);Cx.isPureReactComponent=!0;var fy=Array.isArray,rw=Object.prototype.hasOwnProperty,Fx={current:null},nw={key:!0,ref:!0,__self:!0,__source:!0};function iw(t,e,r){var n,i={},s=null,a=null;if(e!=null)for(n in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(s=""+e.key),e)rw.call(e,n)&&!nw.hasOwnProperty(n)&&(i[n]=e[n]);var o=arguments.length-2;if(o===1)i.children=r;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];i.children=l}if(t&&t.defaultProps)for(n in o=t.defaultProps,o)i[n]===void 0&&(i[n]=o[n]);return{$$typeof:o0,type:t,key:s,ref:a,props:i,_owner:Fx.current}}function dF(t,e){return{$$typeof:o0,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Ix(t){return typeof t=="object"&&t!==null&&t.$$typeof===o0}function hF(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var dy=/\/+/g;function Xp(t,e){return typeof t=="object"&&t!==null&&t.key!=null?hF(""+t.key):e.toString(36)}function Bd(t,e,r,n,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case o0:case tF:a=!0}}if(a)return a=t,i=i(a),t=n===""?"."+Xp(a,0):n,fy(i)?(r="",t!=null&&(r=t.replace(dy,"$&/")+"/"),Bd(i,e,r,"",function(c){return c})):i!=null&&(Ix(i)&&(i=dF(i,r+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(dy,"$&/")+"/")+t)),e.push(i)),1;if(a=0,n=n===""?".":n+":",fy(t))for(var o=0;o<t.length;o++){s=t[o];var l=n+Xp(s,o);a+=Bd(s,e,r,l,i)}else if(l=fF(t),typeof l=="function")for(t=l.call(t),o=0;!(s=t.next()).done;)s=s.value,l=n+Xp(s,o++),a+=Bd(s,e,r,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function ed(t,e,r){if(t==null)return t;var n=[],i=0;return Bd(t,n,"","",function(s){return e.call(r,s,i++)}),n}function pF(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var ai={current:null},jd={transition:null},gF={ReactCurrentDispatcher:ai,ReactCurrentBatchConfig:jd,ReactCurrentOwner:Fx};function sw(){throw Error("act(...) is not supported in production builds of React.")}wt.Children={map:ed,forEach:function(t,e,r){ed(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return ed(t,function(){e++}),e},toArray:function(t){return ed(t,function(e){return e})||[]},only:function(t){if(!Ix(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};wt.Component=su;wt.Fragment=rF;wt.Profiler=iF;wt.PureComponent=Ax;wt.StrictMode=nF;wt.Suspense=lF;wt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=gF;wt.act=sw;wt.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=ZE({},t.props),i=t.key,s=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,a=Fx.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var o=t.type.defaultProps;for(l in e)rw.call(e,l)&&!nw.hasOwnProperty(l)&&(n[l]=e[l]===void 0&&o!==void 0?o[l]:e[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var c=0;c<l;c++)o[c]=arguments[c+2];n.children=o}return{$$typeof:o0,type:t.type,key:i,ref:s,props:n,_owner:a}};wt.createContext=function(t){return t={$$typeof:aF,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:sF,_context:t},t.Consumer=t};wt.createElement=iw;wt.createFactory=function(t){var e=iw.bind(null,t);return e.type=t,e};wt.createRef=function(){return{current:null}};wt.forwardRef=function(t){return{$$typeof:oF,render:t}};wt.isValidElement=Ix;wt.lazy=function(t){return{$$typeof:uF,_payload:{_status:-1,_result:t},_init:pF}};wt.memo=function(t,e){return{$$typeof:cF,type:t,compare:e===void 0?null:e}};wt.startTransition=function(t){var e=jd.transition;jd.transition={};try{t()}finally{jd.transition=e}};wt.unstable_act=sw;wt.useCallback=function(t,e){return ai.current.useCallback(t,e)};wt.useContext=function(t){return ai.current.useContext(t)};wt.useDebugValue=function(){};wt.useDeferredValue=function(t){return ai.current.useDeferredValue(t)};wt.useEffect=function(t,e){return ai.current.useEffect(t,e)};wt.useId=function(){return ai.current.useId()};wt.useImperativeHandle=function(t,e,r){return ai.current.useImperativeHandle(t,e,r)};wt.useInsertionEffect=function(t,e){return ai.current.useInsertionEffect(t,e)};wt.useLayoutEffect=function(t,e){return ai.current.useLayoutEffect(t,e)};wt.useMemo=function(t,e){return ai.current.useMemo(t,e)};wt.useReducer=function(t,e,r){return ai.current.useReducer(t,e,r)};wt.useRef=function(t){return ai.current.useRef(t)};wt.useState=function(t){return ai.current.useState(t)};wt.useSyncExternalStore=function(t,e,r){return ai.current.useSyncExternalStore(t,e,r)};wt.useTransition=function(){return ai.current.useTransition()};wt.version="18.3.1";QE.exports=wt;var ve=QE.exports;const Vd=eF(ve);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mF=ve,xF=Symbol.for("react.element"),vF=Symbol.for("react.fragment"),yF=Object.prototype.hasOwnProperty,_F=mF.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,EF={key:!0,ref:!0,__self:!0,__source:!0};function aw(t,e,r){var n,i={},s=null,a=null;r!==void 0&&(s=""+r),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(a=e.ref);for(n in e)yF.call(e,n)&&!EF.hasOwnProperty(n)&&(i[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)i[n]===void 0&&(i[n]=e[n]);return{$$typeof:xF,type:t,key:s,ref:a,props:i,_owner:_F.current}}ap.Fragment=vF;ap.jsx=aw;ap.jsxs=aw;YE.exports=ap;var f=YE.exports,Zg={},ow={exports:{}},Li={},lw={exports:{}},cw={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(xe,J){var ke=xe.length;xe.push(J);e:for(;0<ke;){var Me=ke-1>>>1,j=xe[Me];if(0<i(j,J))xe[Me]=J,xe[ke]=j,ke=Me;else break e}}function r(xe){return xe.length===0?null:xe[0]}function n(xe){if(xe.length===0)return null;var J=xe[0],ke=xe.pop();if(ke!==J){xe[0]=ke;e:for(var Me=0,j=xe.length,H=j>>>1;Me<H;){var q=2*(Me+1)-1,X=xe[q],de=q+1,we=xe[de];if(0>i(X,ke))de<j&&0>i(we,X)?(xe[Me]=we,xe[de]=ke,Me=de):(xe[Me]=X,xe[q]=ke,Me=q);else if(de<j&&0>i(we,ke))xe[Me]=we,xe[de]=ke,Me=de;else break e}}return J}function i(xe,J){var ke=xe.sortIndex-J.sortIndex;return ke!==0?ke:xe.id-J.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();t.unstable_now=function(){return a.now()-o}}var l=[],c=[],d=1,h=null,p=3,m=!1,y=!1,x=!1,E=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function _(xe){for(var J=r(c);J!==null;){if(J.callback===null)n(c);else if(J.startTime<=xe)n(c),J.sortIndex=J.expirationTime,e(l,J);else break;J=r(c)}}function P(xe){if(x=!1,_(xe),!y)if(r(l)!==null)y=!0,Fe(W);else{var J=r(c);J!==null&&Ee(P,J.startTime-xe)}}function W(xe,J){y=!1,x&&(x=!1,T(C),C=-1),m=!0;var ke=p;try{for(_(J),h=r(l);h!==null&&(!(h.expirationTime>J)||xe&&!N());){var Me=h.callback;if(typeof Me=="function"){h.callback=null,p=h.priorityLevel;var j=Me(h.expirationTime<=J);J=t.unstable_now(),typeof j=="function"?h.callback=j:h===r(l)&&n(l),_(J)}else n(l);h=r(l)}if(h!==null)var H=!0;else{var q=r(c);q!==null&&Ee(P,q.startTime-J),H=!1}return H}finally{h=null,p=ke,m=!1}}var B=!1,w=null,C=-1,S=5,b=-1;function N(){return!(t.unstable_now()-b<S)}function D(){if(w!==null){var xe=t.unstable_now();b=xe;var J=!0;try{J=w(!0,xe)}finally{J?R():(B=!1,w=null)}}else B=!1}var R;if(typeof k=="function")R=function(){k(D)};else if(typeof MessageChannel<"u"){var Ue=new MessageChannel,ge=Ue.port2;Ue.port1.onmessage=D,R=function(){ge.postMessage(null)}}else R=function(){E(D,0)};function Fe(xe){w=xe,B||(B=!0,R())}function Ee(xe,J){C=E(function(){xe(t.unstable_now())},J)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(xe){xe.callback=null},t.unstable_continueExecution=function(){y||m||(y=!0,Fe(W))},t.unstable_forceFrameRate=function(xe){0>xe||125<xe?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):S=0<xe?Math.floor(1e3/xe):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return r(l)},t.unstable_next=function(xe){switch(p){case 1:case 2:case 3:var J=3;break;default:J=p}var ke=p;p=J;try{return xe()}finally{p=ke}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(xe,J){switch(xe){case 1:case 2:case 3:case 4:case 5:break;default:xe=3}var ke=p;p=xe;try{return J()}finally{p=ke}},t.unstable_scheduleCallback=function(xe,J,ke){var Me=t.unstable_now();switch(typeof ke=="object"&&ke!==null?(ke=ke.delay,ke=typeof ke=="number"&&0<ke?Me+ke:Me):ke=Me,xe){case 1:var j=-1;break;case 2:j=250;break;case 5:j=1073741823;break;case 4:j=1e4;break;default:j=5e3}return j=ke+j,xe={id:d++,callback:J,priorityLevel:xe,startTime:ke,expirationTime:j,sortIndex:-1},ke>Me?(xe.sortIndex=ke,e(c,xe),r(l)===null&&xe===r(c)&&(x?(T(C),C=-1):x=!0,Ee(P,ke-Me))):(xe.sortIndex=j,e(l,xe),y||m||(y=!0,Fe(W))),xe},t.unstable_shouldYield=N,t.unstable_wrapCallback=function(xe){var J=p;return function(){var ke=p;p=J;try{return xe.apply(this,arguments)}finally{p=ke}}}})(cw);lw.exports=cw;var wF=lw.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var TF=ve,Oi=wF;function De(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var uw=new Set,_f={};function Pl(t,e){Vc(t,e),Vc(t+"Capture",e)}function Vc(t,e){for(_f[t]=e,t=0;t<e.length;t++)uw.add(e[t])}var ka=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),em=Object.prototype.hasOwnProperty,SF=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,hy={},py={};function kF(t){return em.call(py,t)?!0:em.call(hy,t)?!1:SF.test(t)?py[t]=!0:(hy[t]=!0,!1)}function AF(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function CF(t,e,r,n){if(e===null||typeof e>"u"||AF(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function oi(t,e,r,n,i,s,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=a}var An={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){An[t]=new oi(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];An[e]=new oi(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){An[t]=new oi(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){An[t]=new oi(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){An[t]=new oi(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){An[t]=new oi(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){An[t]=new oi(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){An[t]=new oi(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){An[t]=new oi(t,5,!1,t.toLowerCase(),null,!1,!1)});var bx=/[\-:]([a-z])/g;function Rx(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(bx,Rx);An[e]=new oi(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(bx,Rx);An[e]=new oi(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(bx,Rx);An[e]=new oi(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){An[t]=new oi(t,1,!1,t.toLowerCase(),null,!1,!1)});An.xlinkHref=new oi("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){An[t]=new oi(t,1,!1,t.toLowerCase(),null,!0,!0)});function Nx(t,e,r,n){var i=An.hasOwnProperty(e)?An[e]:null;(i!==null?i.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(CF(e,r,i,n)&&(r=null),n||i===null?kF(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):i.mustUseProperty?t[i.propertyName]=r===null?i.type===3?!1:"":r:(e=i.attributeName,n=i.attributeNamespace,r===null?t.removeAttribute(e):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var Oa=TF.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,td=Symbol.for("react.element"),fc=Symbol.for("react.portal"),dc=Symbol.for("react.fragment"),Dx=Symbol.for("react.strict_mode"),tm=Symbol.for("react.profiler"),fw=Symbol.for("react.provider"),dw=Symbol.for("react.context"),Px=Symbol.for("react.forward_ref"),rm=Symbol.for("react.suspense"),nm=Symbol.for("react.suspense_list"),Ox=Symbol.for("react.memo"),eo=Symbol.for("react.lazy"),hw=Symbol.for("react.offscreen"),gy=Symbol.iterator;function Cu(t){return t===null||typeof t!="object"?null:(t=gy&&t[gy]||t["@@iterator"],typeof t=="function"?t:null)}var Sr=Object.assign,qp;function Vu(t){if(qp===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);qp=e&&e[1]||""}return`
`+qp+t}var Yp=!1;function Qp(t,e){if(!t||Yp)return"";Yp=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var n=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){n=c}t.call(e.prototype)}else{try{throw Error()}catch(c){n=c}t()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),s=n.stack.split(`
`),a=i.length-1,o=s.length-1;1<=a&&0<=o&&i[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(i[a]!==s[o]){if(a!==1||o!==1)do if(a--,o--,0>o||i[a]!==s[o]){var l=`
`+i[a].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=a&&0<=o);break}}}finally{Yp=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?Vu(t):""}function FF(t){switch(t.tag){case 5:return Vu(t.type);case 16:return Vu("Lazy");case 13:return Vu("Suspense");case 19:return Vu("SuspenseList");case 0:case 2:case 15:return t=Qp(t.type,!1),t;case 11:return t=Qp(t.type.render,!1),t;case 1:return t=Qp(t.type,!0),t;default:return""}}function im(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case dc:return"Fragment";case fc:return"Portal";case tm:return"Profiler";case Dx:return"StrictMode";case rm:return"Suspense";case nm:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case dw:return(t.displayName||"Context")+".Consumer";case fw:return(t._context.displayName||"Context")+".Provider";case Px:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Ox:return e=t.displayName||null,e!==null?e:im(t.type)||"Memo";case eo:e=t._payload,t=t._init;try{return im(t(e))}catch{}}return null}function IF(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return im(e);case 8:return e===Dx?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Fo(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function pw(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function bF(t){var e=pw(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,s=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(a){n=""+a,s.call(this,a)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(a){n=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function rd(t){t._valueTracker||(t._valueTracker=bF(t))}function gw(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=pw(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function ah(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function sm(t,e){var r=e.checked;return Sr({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function my(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=Fo(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function mw(t,e){e=e.checked,e!=null&&Nx(t,"checked",e,!1)}function am(t,e){mw(t,e);var r=Fo(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?om(t,e.type,r):e.hasOwnProperty("defaultValue")&&om(t,e.type,Fo(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function xy(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function om(t,e,r){(e!=="number"||ah(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var Uu=Array.isArray;function Ac(t,e,r,n){if(t=t.options,e){e={};for(var i=0;i<r.length;i++)e["$"+r[i]]=!0;for(r=0;r<t.length;r++)i=e.hasOwnProperty("$"+t[r].value),t[r].selected!==i&&(t[r].selected=i),i&&n&&(t[r].defaultSelected=!0)}else{for(r=""+Fo(r),e=null,i=0;i<t.length;i++){if(t[i].value===r){t[i].selected=!0,n&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function lm(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(De(91));return Sr({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function vy(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(De(92));if(Uu(r)){if(1<r.length)throw Error(De(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:Fo(r)}}function xw(t,e){var r=Fo(e.value),n=Fo(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function yy(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function vw(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function cm(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?vw(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var nd,yw=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,i){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(nd=nd||document.createElement("div"),nd.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=nd.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Ef(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var Qu={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},RF=["Webkit","ms","Moz","O"];Object.keys(Qu).forEach(function(t){RF.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Qu[e]=Qu[t]})});function _w(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||Qu.hasOwnProperty(t)&&Qu[t]?(""+e).trim():e+"px"}function Ew(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=_w(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,i):t[r]=i}}var NF=Sr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function um(t,e){if(e){if(NF[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(De(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(De(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(De(61))}if(e.style!=null&&typeof e.style!="object")throw Error(De(62))}}function fm(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var dm=null;function Mx(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var hm=null,Cc=null,Fc=null;function _y(t){if(t=u0(t)){if(typeof hm!="function")throw Error(De(280));var e=t.stateNode;e&&(e=fp(e),hm(t.stateNode,t.type,e))}}function ww(t){Cc?Fc?Fc.push(t):Fc=[t]:Cc=t}function Tw(){if(Cc){var t=Cc,e=Fc;if(Fc=Cc=null,_y(t),e)for(t=0;t<e.length;t++)_y(e[t])}}function Sw(t,e){return t(e)}function kw(){}var Jp=!1;function Aw(t,e,r){if(Jp)return t(e,r);Jp=!0;try{return Sw(t,e,r)}finally{Jp=!1,(Cc!==null||Fc!==null)&&(kw(),Tw())}}function wf(t,e){var r=t.stateNode;if(r===null)return null;var n=fp(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(De(231,e,typeof r));return r}var pm=!1;if(ka)try{var Fu={};Object.defineProperty(Fu,"passive",{get:function(){pm=!0}}),window.addEventListener("test",Fu,Fu),window.removeEventListener("test",Fu,Fu)}catch{pm=!1}function DF(t,e,r,n,i,s,a,o,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(r,c)}catch(d){this.onError(d)}}var Ju=!1,oh=null,lh=!1,gm=null,PF={onError:function(t){Ju=!0,oh=t}};function OF(t,e,r,n,i,s,a,o,l){Ju=!1,oh=null,DF.apply(PF,arguments)}function MF(t,e,r,n,i,s,a,o,l){if(OF.apply(this,arguments),Ju){if(Ju){var c=oh;Ju=!1,oh=null}else throw Error(De(198));lh||(lh=!0,gm=c)}}function Ol(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function Cw(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Ey(t){if(Ol(t)!==t)throw Error(De(188))}function LF(t){var e=t.alternate;if(!e){if(e=Ol(t),e===null)throw Error(De(188));return e!==t?null:t}for(var r=t,n=e;;){var i=r.return;if(i===null)break;var s=i.alternate;if(s===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return Ey(i),t;if(s===n)return Ey(i),e;s=s.sibling}throw Error(De(188))}if(r.return!==n.return)r=i,n=s;else{for(var a=!1,o=i.child;o;){if(o===r){a=!0,r=i,n=s;break}if(o===n){a=!0,n=i,r=s;break}o=o.sibling}if(!a){for(o=s.child;o;){if(o===r){a=!0,r=s,n=i;break}if(o===n){a=!0,n=s,r=i;break}o=o.sibling}if(!a)throw Error(De(189))}}if(r.alternate!==n)throw Error(De(190))}if(r.tag!==3)throw Error(De(188));return r.stateNode.current===r?t:e}function Fw(t){return t=LF(t),t!==null?Iw(t):null}function Iw(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Iw(t);if(e!==null)return e;t=t.sibling}return null}var bw=Oi.unstable_scheduleCallback,wy=Oi.unstable_cancelCallback,BF=Oi.unstable_shouldYield,jF=Oi.unstable_requestPaint,Or=Oi.unstable_now,VF=Oi.unstable_getCurrentPriorityLevel,Lx=Oi.unstable_ImmediatePriority,Rw=Oi.unstable_UserBlockingPriority,ch=Oi.unstable_NormalPriority,UF=Oi.unstable_LowPriority,Nw=Oi.unstable_IdlePriority,op=null,Xs=null;function zF(t){if(Xs&&typeof Xs.onCommitFiberRoot=="function")try{Xs.onCommitFiberRoot(op,t,void 0,(t.current.flags&128)===128)}catch{}}var Is=Math.clz32?Math.clz32:HF,WF=Math.log,$F=Math.LN2;function HF(t){return t>>>=0,t===0?32:31-(WF(t)/$F|0)|0}var id=64,sd=4194304;function zu(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function uh(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,i=t.suspendedLanes,s=t.pingedLanes,a=r&268435455;if(a!==0){var o=a&~i;o!==0?n=zu(o):(s&=a,s!==0&&(n=zu(s)))}else a=r&~i,a!==0?n=zu(a):s!==0&&(n=zu(s));if(n===0)return 0;if(e!==0&&e!==n&&!(e&i)&&(i=n&-n,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-Is(e),i=1<<r,n|=t[r],e&=~i;return n}function GF(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function KF(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var a=31-Is(s),o=1<<a,l=i[a];l===-1?(!(o&r)||o&n)&&(i[a]=GF(o,e)):l<=e&&(t.expiredLanes|=o),s&=~o}}function mm(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Dw(){var t=id;return id<<=1,!(id&4194240)&&(id=64),t}function Zp(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function l0(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Is(e),t[e]=r}function XF(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var i=31-Is(r),s=1<<i;e[i]=0,n[i]=-1,t[i]=-1,r&=~s}}function Bx(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-Is(r),i=1<<n;i&e|t[n]&e&&(t[n]|=e),r&=~i}}var qt=0;function Pw(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Ow,jx,Mw,Lw,Bw,xm=!1,ad=[],go=null,mo=null,xo=null,Tf=new Map,Sf=new Map,ro=[],qF="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ty(t,e){switch(t){case"focusin":case"focusout":go=null;break;case"dragenter":case"dragleave":mo=null;break;case"mouseover":case"mouseout":xo=null;break;case"pointerover":case"pointerout":Tf.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Sf.delete(e.pointerId)}}function Iu(t,e,r,n,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},e!==null&&(e=u0(e),e!==null&&jx(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function YF(t,e,r,n,i){switch(e){case"focusin":return go=Iu(go,t,e,r,n,i),!0;case"dragenter":return mo=Iu(mo,t,e,r,n,i),!0;case"mouseover":return xo=Iu(xo,t,e,r,n,i),!0;case"pointerover":var s=i.pointerId;return Tf.set(s,Iu(Tf.get(s)||null,t,e,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,Sf.set(s,Iu(Sf.get(s)||null,t,e,r,n,i)),!0}return!1}function jw(t){var e=sl(t.target);if(e!==null){var r=Ol(e);if(r!==null){if(e=r.tag,e===13){if(e=Cw(r),e!==null){t.blockedOn=e,Bw(t.priority,function(){Mw(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Ud(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=vm(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);dm=n,r.target.dispatchEvent(n),dm=null}else return e=u0(r),e!==null&&jx(e),t.blockedOn=r,!1;e.shift()}return!0}function Sy(t,e,r){Ud(t)&&r.delete(e)}function QF(){xm=!1,go!==null&&Ud(go)&&(go=null),mo!==null&&Ud(mo)&&(mo=null),xo!==null&&Ud(xo)&&(xo=null),Tf.forEach(Sy),Sf.forEach(Sy)}function bu(t,e){t.blockedOn===e&&(t.blockedOn=null,xm||(xm=!0,Oi.unstable_scheduleCallback(Oi.unstable_NormalPriority,QF)))}function kf(t){function e(i){return bu(i,t)}if(0<ad.length){bu(ad[0],t);for(var r=1;r<ad.length;r++){var n=ad[r];n.blockedOn===t&&(n.blockedOn=null)}}for(go!==null&&bu(go,t),mo!==null&&bu(mo,t),xo!==null&&bu(xo,t),Tf.forEach(e),Sf.forEach(e),r=0;r<ro.length;r++)n=ro[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<ro.length&&(r=ro[0],r.blockedOn===null);)jw(r),r.blockedOn===null&&ro.shift()}var Ic=Oa.ReactCurrentBatchConfig,fh=!0;function JF(t,e,r,n){var i=qt,s=Ic.transition;Ic.transition=null;try{qt=1,Vx(t,e,r,n)}finally{qt=i,Ic.transition=s}}function ZF(t,e,r,n){var i=qt,s=Ic.transition;Ic.transition=null;try{qt=4,Vx(t,e,r,n)}finally{qt=i,Ic.transition=s}}function Vx(t,e,r,n){if(fh){var i=vm(t,e,r,n);if(i===null)cg(t,e,n,dh,r),Ty(t,n);else if(YF(i,t,e,r,n))n.stopPropagation();else if(Ty(t,n),e&4&&-1<qF.indexOf(t)){for(;i!==null;){var s=u0(i);if(s!==null&&Ow(s),s=vm(t,e,r,n),s===null&&cg(t,e,n,dh,r),s===i)break;i=s}i!==null&&n.stopPropagation()}else cg(t,e,n,null,r)}}var dh=null;function vm(t,e,r,n){if(dh=null,t=Mx(n),t=sl(t),t!==null)if(e=Ol(t),e===null)t=null;else if(r=e.tag,r===13){if(t=Cw(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return dh=t,null}function Vw(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(VF()){case Lx:return 1;case Rw:return 4;case ch:case UF:return 16;case Nw:return 536870912;default:return 16}default:return 16}}var lo=null,Ux=null,zd=null;function Uw(){if(zd)return zd;var t,e=Ux,r=e.length,n,i="value"in lo?lo.value:lo.textContent,s=i.length;for(t=0;t<r&&e[t]===i[t];t++);var a=r-t;for(n=1;n<=a&&e[r-n]===i[s-n];n++);return zd=i.slice(t,1<n?1-n:void 0)}function Wd(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function od(){return!0}function ky(){return!1}function Bi(t){function e(r,n,i,s,a){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(r=t[o],this[o]=r?r(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?od:ky,this.isPropagationStopped=ky,this}return Sr(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=od)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=od)},persist:function(){},isPersistent:od}),e}var au={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},zx=Bi(au),c0=Sr({},au,{view:0,detail:0}),eI=Bi(c0),eg,tg,Ru,lp=Sr({},c0,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Wx,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Ru&&(Ru&&t.type==="mousemove"?(eg=t.screenX-Ru.screenX,tg=t.screenY-Ru.screenY):tg=eg=0,Ru=t),eg)},movementY:function(t){return"movementY"in t?t.movementY:tg}}),Ay=Bi(lp),tI=Sr({},lp,{dataTransfer:0}),rI=Bi(tI),nI=Sr({},c0,{relatedTarget:0}),rg=Bi(nI),iI=Sr({},au,{animationName:0,elapsedTime:0,pseudoElement:0}),sI=Bi(iI),aI=Sr({},au,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),oI=Bi(aI),lI=Sr({},au,{data:0}),Cy=Bi(lI),cI={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},uI={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},fI={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function dI(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=fI[t])?!!e[t]:!1}function Wx(){return dI}var hI=Sr({},c0,{key:function(t){if(t.key){var e=cI[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Wd(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?uI[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Wx,charCode:function(t){return t.type==="keypress"?Wd(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Wd(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),pI=Bi(hI),gI=Sr({},lp,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Fy=Bi(gI),mI=Sr({},c0,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Wx}),xI=Bi(mI),vI=Sr({},au,{propertyName:0,elapsedTime:0,pseudoElement:0}),yI=Bi(vI),_I=Sr({},lp,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),EI=Bi(_I),wI=[9,13,27,32],$x=ka&&"CompositionEvent"in window,Zu=null;ka&&"documentMode"in document&&(Zu=document.documentMode);var TI=ka&&"TextEvent"in window&&!Zu,zw=ka&&(!$x||Zu&&8<Zu&&11>=Zu),Iy=" ",by=!1;function Ww(t,e){switch(t){case"keyup":return wI.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function $w(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var hc=!1;function SI(t,e){switch(t){case"compositionend":return $w(e);case"keypress":return e.which!==32?null:(by=!0,Iy);case"textInput":return t=e.data,t===Iy&&by?null:t;default:return null}}function kI(t,e){if(hc)return t==="compositionend"||!$x&&Ww(t,e)?(t=Uw(),zd=Ux=lo=null,hc=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return zw&&e.locale!=="ko"?null:e.data;default:return null}}var AI={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ry(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!AI[t.type]:e==="textarea"}function Hw(t,e,r,n){ww(n),e=hh(e,"onChange"),0<e.length&&(r=new zx("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var ef=null,Af=null;function CI(t){rT(t,0)}function cp(t){var e=mc(t);if(gw(e))return t}function FI(t,e){if(t==="change")return e}var Gw=!1;if(ka){var ng;if(ka){var ig="oninput"in document;if(!ig){var Ny=document.createElement("div");Ny.setAttribute("oninput","return;"),ig=typeof Ny.oninput=="function"}ng=ig}else ng=!1;Gw=ng&&(!document.documentMode||9<document.documentMode)}function Dy(){ef&&(ef.detachEvent("onpropertychange",Kw),Af=ef=null)}function Kw(t){if(t.propertyName==="value"&&cp(Af)){var e=[];Hw(e,Af,t,Mx(t)),Aw(CI,e)}}function II(t,e,r){t==="focusin"?(Dy(),ef=e,Af=r,ef.attachEvent("onpropertychange",Kw)):t==="focusout"&&Dy()}function bI(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return cp(Af)}function RI(t,e){if(t==="click")return cp(e)}function NI(t,e){if(t==="input"||t==="change")return cp(e)}function DI(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Ds=typeof Object.is=="function"?Object.is:DI;function Cf(t,e){if(Ds(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!em.call(e,i)||!Ds(t[i],e[i]))return!1}return!0}function Py(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Oy(t,e){var r=Py(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Py(r)}}function Xw(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Xw(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function qw(){for(var t=window,e=ah();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=ah(t.document)}return e}function Hx(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function PI(t){var e=qw(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&Xw(r.ownerDocument.documentElement,r)){if(n!==null&&Hx(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=r.textContent.length,s=Math.min(n.start,i);n=n.end===void 0?s:Math.min(n.end,i),!t.extend&&s>n&&(i=n,n=s,s=i),i=Oy(r,s);var a=Oy(r,n);i&&a&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>n?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var OI=ka&&"documentMode"in document&&11>=document.documentMode,pc=null,ym=null,tf=null,_m=!1;function My(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;_m||pc==null||pc!==ah(n)||(n=pc,"selectionStart"in n&&Hx(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),tf&&Cf(tf,n)||(tf=n,n=hh(ym,"onSelect"),0<n.length&&(e=new zx("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=pc)))}function ld(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var gc={animationend:ld("Animation","AnimationEnd"),animationiteration:ld("Animation","AnimationIteration"),animationstart:ld("Animation","AnimationStart"),transitionend:ld("Transition","TransitionEnd")},sg={},Yw={};ka&&(Yw=document.createElement("div").style,"AnimationEvent"in window||(delete gc.animationend.animation,delete gc.animationiteration.animation,delete gc.animationstart.animation),"TransitionEvent"in window||delete gc.transitionend.transition);function up(t){if(sg[t])return sg[t];if(!gc[t])return t;var e=gc[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in Yw)return sg[t]=e[r];return t}var Qw=up("animationend"),Jw=up("animationiteration"),Zw=up("animationstart"),eT=up("transitionend"),tT=new Map,Ly="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Lo(t,e){tT.set(t,e),Pl(e,[t])}for(var ag=0;ag<Ly.length;ag++){var og=Ly[ag],MI=og.toLowerCase(),LI=og[0].toUpperCase()+og.slice(1);Lo(MI,"on"+LI)}Lo(Qw,"onAnimationEnd");Lo(Jw,"onAnimationIteration");Lo(Zw,"onAnimationStart");Lo("dblclick","onDoubleClick");Lo("focusin","onFocus");Lo("focusout","onBlur");Lo(eT,"onTransitionEnd");Vc("onMouseEnter",["mouseout","mouseover"]);Vc("onMouseLeave",["mouseout","mouseover"]);Vc("onPointerEnter",["pointerout","pointerover"]);Vc("onPointerLeave",["pointerout","pointerover"]);Pl("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Pl("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Pl("onBeforeInput",["compositionend","keypress","textInput","paste"]);Pl("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Pl("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Pl("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Wu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),BI=new Set("cancel close invalid load scroll toggle".split(" ").concat(Wu));function By(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,MF(n,e,void 0,t),t.currentTarget=null}function rT(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],i=n.event;n=n.listeners;e:{var s=void 0;if(e)for(var a=n.length-1;0<=a;a--){var o=n[a],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==s&&i.isPropagationStopped())break e;By(i,o,c),s=l}else for(a=0;a<n.length;a++){if(o=n[a],l=o.instance,c=o.currentTarget,o=o.listener,l!==s&&i.isPropagationStopped())break e;By(i,o,c),s=l}}}if(lh)throw t=gm,lh=!1,gm=null,t}function sr(t,e){var r=e[km];r===void 0&&(r=e[km]=new Set);var n=t+"__bubble";r.has(n)||(nT(e,t,2,!1),r.add(n))}function lg(t,e,r){var n=0;e&&(n|=4),nT(r,t,n,e)}var cd="_reactListening"+Math.random().toString(36).slice(2);function Ff(t){if(!t[cd]){t[cd]=!0,uw.forEach(function(r){r!=="selectionchange"&&(BI.has(r)||lg(r,!1,t),lg(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[cd]||(e[cd]=!0,lg("selectionchange",!1,e))}}function nT(t,e,r,n){switch(Vw(e)){case 1:var i=JF;break;case 4:i=ZF;break;default:i=Vx}r=i.bind(null,e,r,t),i=void 0,!pm||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),n?i!==void 0?t.addEventListener(e,r,{capture:!0,passive:i}):t.addEventListener(e,r,!0):i!==void 0?t.addEventListener(e,r,{passive:i}):t.addEventListener(e,r,!1)}function cg(t,e,r,n,i){var s=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var a=n.tag;if(a===3||a===4){var o=n.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(a===4)for(a=n.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;a=a.return}for(;o!==null;){if(a=sl(o),a===null)return;if(l=a.tag,l===5||l===6){n=s=a;continue e}o=o.parentNode}}n=n.return}Aw(function(){var c=s,d=Mx(r),h=[];e:{var p=tT.get(t);if(p!==void 0){var m=zx,y=t;switch(t){case"keypress":if(Wd(r)===0)break e;case"keydown":case"keyup":m=pI;break;case"focusin":y="focus",m=rg;break;case"focusout":y="blur",m=rg;break;case"beforeblur":case"afterblur":m=rg;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=Ay;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=rI;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=xI;break;case Qw:case Jw:case Zw:m=sI;break;case eT:m=yI;break;case"scroll":m=eI;break;case"wheel":m=EI;break;case"copy":case"cut":case"paste":m=oI;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=Fy}var x=(e&4)!==0,E=!x&&t==="scroll",T=x?p!==null?p+"Capture":null:p;x=[];for(var k=c,_;k!==null;){_=k;var P=_.stateNode;if(_.tag===5&&P!==null&&(_=P,T!==null&&(P=wf(k,T),P!=null&&x.push(If(k,P,_)))),E)break;k=k.return}0<x.length&&(p=new m(p,y,null,r,d),h.push({event:p,listeners:x}))}}if(!(e&7)){e:{if(p=t==="mouseover"||t==="pointerover",m=t==="mouseout"||t==="pointerout",p&&r!==dm&&(y=r.relatedTarget||r.fromElement)&&(sl(y)||y[Aa]))break e;if((m||p)&&(p=d.window===d?d:(p=d.ownerDocument)?p.defaultView||p.parentWindow:window,m?(y=r.relatedTarget||r.toElement,m=c,y=y?sl(y):null,y!==null&&(E=Ol(y),y!==E||y.tag!==5&&y.tag!==6)&&(y=null)):(m=null,y=c),m!==y)){if(x=Ay,P="onMouseLeave",T="onMouseEnter",k="mouse",(t==="pointerout"||t==="pointerover")&&(x=Fy,P="onPointerLeave",T="onPointerEnter",k="pointer"),E=m==null?p:mc(m),_=y==null?p:mc(y),p=new x(P,k+"leave",m,r,d),p.target=E,p.relatedTarget=_,P=null,sl(d)===c&&(x=new x(T,k+"enter",y,r,d),x.target=_,x.relatedTarget=E,P=x),E=P,m&&y)t:{for(x=m,T=y,k=0,_=x;_;_=nc(_))k++;for(_=0,P=T;P;P=nc(P))_++;for(;0<k-_;)x=nc(x),k--;for(;0<_-k;)T=nc(T),_--;for(;k--;){if(x===T||T!==null&&x===T.alternate)break t;x=nc(x),T=nc(T)}x=null}else x=null;m!==null&&jy(h,p,m,x,!1),y!==null&&E!==null&&jy(h,E,y,x,!0)}}e:{if(p=c?mc(c):window,m=p.nodeName&&p.nodeName.toLowerCase(),m==="select"||m==="input"&&p.type==="file")var W=FI;else if(Ry(p))if(Gw)W=NI;else{W=bI;var B=II}else(m=p.nodeName)&&m.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(W=RI);if(W&&(W=W(t,c))){Hw(h,W,r,d);break e}B&&B(t,p,c),t==="focusout"&&(B=p._wrapperState)&&B.controlled&&p.type==="number"&&om(p,"number",p.value)}switch(B=c?mc(c):window,t){case"focusin":(Ry(B)||B.contentEditable==="true")&&(pc=B,ym=c,tf=null);break;case"focusout":tf=ym=pc=null;break;case"mousedown":_m=!0;break;case"contextmenu":case"mouseup":case"dragend":_m=!1,My(h,r,d);break;case"selectionchange":if(OI)break;case"keydown":case"keyup":My(h,r,d)}var w;if($x)e:{switch(t){case"compositionstart":var C="onCompositionStart";break e;case"compositionend":C="onCompositionEnd";break e;case"compositionupdate":C="onCompositionUpdate";break e}C=void 0}else hc?Ww(t,r)&&(C="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(C="onCompositionStart");C&&(zw&&r.locale!=="ko"&&(hc||C!=="onCompositionStart"?C==="onCompositionEnd"&&hc&&(w=Uw()):(lo=d,Ux="value"in lo?lo.value:lo.textContent,hc=!0)),B=hh(c,C),0<B.length&&(C=new Cy(C,t,null,r,d),h.push({event:C,listeners:B}),w?C.data=w:(w=$w(r),w!==null&&(C.data=w)))),(w=TI?SI(t,r):kI(t,r))&&(c=hh(c,"onBeforeInput"),0<c.length&&(d=new Cy("onBeforeInput","beforeinput",null,r,d),h.push({event:d,listeners:c}),d.data=w))}rT(h,e)})}function If(t,e,r){return{instance:t,listener:e,currentTarget:r}}function hh(t,e){for(var r=e+"Capture",n=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=wf(t,r),s!=null&&n.unshift(If(t,s,i)),s=wf(t,e),s!=null&&n.push(If(t,s,i))),t=t.return}return n}function nc(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function jy(t,e,r,n,i){for(var s=e._reactName,a=[];r!==null&&r!==n;){var o=r,l=o.alternate,c=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&c!==null&&(o=c,i?(l=wf(r,s),l!=null&&a.unshift(If(r,l,o))):i||(l=wf(r,s),l!=null&&a.push(If(r,l,o)))),r=r.return}a.length!==0&&t.push({event:e,listeners:a})}var jI=/\r\n?/g,VI=/\u0000|\uFFFD/g;function Vy(t){return(typeof t=="string"?t:""+t).replace(jI,`
`).replace(VI,"")}function ud(t,e,r){if(e=Vy(e),Vy(t)!==e&&r)throw Error(De(425))}function ph(){}var Em=null,wm=null;function Tm(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Sm=typeof setTimeout=="function"?setTimeout:void 0,UI=typeof clearTimeout=="function"?clearTimeout:void 0,Uy=typeof Promise=="function"?Promise:void 0,zI=typeof queueMicrotask=="function"?queueMicrotask:typeof Uy<"u"?function(t){return Uy.resolve(null).then(t).catch(WI)}:Sm;function WI(t){setTimeout(function(){throw t})}function ug(t,e){var r=e,n=0;do{var i=r.nextSibling;if(t.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){t.removeChild(i),kf(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);kf(e)}function vo(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function zy(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var ou=Math.random().toString(36).slice(2),Gs="__reactFiber$"+ou,bf="__reactProps$"+ou,Aa="__reactContainer$"+ou,km="__reactEvents$"+ou,$I="__reactListeners$"+ou,HI="__reactHandles$"+ou;function sl(t){var e=t[Gs];if(e)return e;for(var r=t.parentNode;r;){if(e=r[Aa]||r[Gs]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=zy(t);t!==null;){if(r=t[Gs])return r;t=zy(t)}return e}t=r,r=t.parentNode}return null}function u0(t){return t=t[Gs]||t[Aa],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function mc(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(De(33))}function fp(t){return t[bf]||null}var Am=[],xc=-1;function Bo(t){return{current:t}}function or(t){0>xc||(t.current=Am[xc],Am[xc]=null,xc--)}function rr(t,e){xc++,Am[xc]=t.current,t.current=e}var Io={},Kn=Bo(Io),xi=Bo(!1),vl=Io;function Uc(t,e){var r=t.type.contextTypes;if(!r)return Io;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in r)i[s]=e[s];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function vi(t){return t=t.childContextTypes,t!=null}function gh(){or(xi),or(Kn)}function Wy(t,e,r){if(Kn.current!==Io)throw Error(De(168));rr(Kn,e),rr(xi,r)}function iT(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in e))throw Error(De(108,IF(t)||"Unknown",i));return Sr({},r,n)}function mh(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Io,vl=Kn.current,rr(Kn,t),rr(xi,xi.current),!0}function $y(t,e,r){var n=t.stateNode;if(!n)throw Error(De(169));r?(t=iT(t,e,vl),n.__reactInternalMemoizedMergedChildContext=t,or(xi),or(Kn),rr(Kn,t)):or(xi),rr(xi,r)}var ha=null,dp=!1,fg=!1;function sT(t){ha===null?ha=[t]:ha.push(t)}function GI(t){dp=!0,sT(t)}function jo(){if(!fg&&ha!==null){fg=!0;var t=0,e=qt;try{var r=ha;for(qt=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}ha=null,dp=!1}catch(i){throw ha!==null&&(ha=ha.slice(t+1)),bw(Lx,jo),i}finally{qt=e,fg=!1}}return null}var vc=[],yc=0,xh=null,vh=0,ts=[],rs=0,yl=null,pa=1,ga="";function el(t,e){vc[yc++]=vh,vc[yc++]=xh,xh=t,vh=e}function aT(t,e,r){ts[rs++]=pa,ts[rs++]=ga,ts[rs++]=yl,yl=t;var n=pa;t=ga;var i=32-Is(n)-1;n&=~(1<<i),r+=1;var s=32-Is(e)+i;if(30<s){var a=i-i%5;s=(n&(1<<a)-1).toString(32),n>>=a,i-=a,pa=1<<32-Is(e)+i|r<<i|n,ga=s+t}else pa=1<<s|r<<i|n,ga=t}function Gx(t){t.return!==null&&(el(t,1),aT(t,1,0))}function Kx(t){for(;t===xh;)xh=vc[--yc],vc[yc]=null,vh=vc[--yc],vc[yc]=null;for(;t===yl;)yl=ts[--rs],ts[rs]=null,ga=ts[--rs],ts[rs]=null,pa=ts[--rs],ts[rs]=null}var Di=null,Ni=null,gr=!1,ks=null;function oT(t,e){var r=is(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function Hy(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Di=t,Ni=vo(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Di=t,Ni=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=yl!==null?{id:pa,overflow:ga}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=is(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,Di=t,Ni=null,!0):!1;default:return!1}}function Cm(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Fm(t){if(gr){var e=Ni;if(e){var r=e;if(!Hy(t,e)){if(Cm(t))throw Error(De(418));e=vo(r.nextSibling);var n=Di;e&&Hy(t,e)?oT(n,r):(t.flags=t.flags&-4097|2,gr=!1,Di=t)}}else{if(Cm(t))throw Error(De(418));t.flags=t.flags&-4097|2,gr=!1,Di=t}}}function Gy(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Di=t}function fd(t){if(t!==Di)return!1;if(!gr)return Gy(t),gr=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Tm(t.type,t.memoizedProps)),e&&(e=Ni)){if(Cm(t))throw lT(),Error(De(418));for(;e;)oT(t,e),e=vo(e.nextSibling)}if(Gy(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(De(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){Ni=vo(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}Ni=null}}else Ni=Di?vo(t.stateNode.nextSibling):null;return!0}function lT(){for(var t=Ni;t;)t=vo(t.nextSibling)}function zc(){Ni=Di=null,gr=!1}function Xx(t){ks===null?ks=[t]:ks.push(t)}var KI=Oa.ReactCurrentBatchConfig;function Nu(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(De(309));var n=r.stateNode}if(!n)throw Error(De(147,t));var i=n,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(a){var o=i.refs;a===null?delete o[s]:o[s]=a},e._stringRef=s,e)}if(typeof t!="string")throw Error(De(284));if(!r._owner)throw Error(De(290,t))}return t}function dd(t,e){throw t=Object.prototype.toString.call(e),Error(De(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Ky(t){var e=t._init;return e(t._payload)}function cT(t){function e(T,k){if(t){var _=T.deletions;_===null?(T.deletions=[k],T.flags|=16):_.push(k)}}function r(T,k){if(!t)return null;for(;k!==null;)e(T,k),k=k.sibling;return null}function n(T,k){for(T=new Map;k!==null;)k.key!==null?T.set(k.key,k):T.set(k.index,k),k=k.sibling;return T}function i(T,k){return T=wo(T,k),T.index=0,T.sibling=null,T}function s(T,k,_){return T.index=_,t?(_=T.alternate,_!==null?(_=_.index,_<k?(T.flags|=2,k):_):(T.flags|=2,k)):(T.flags|=1048576,k)}function a(T){return t&&T.alternate===null&&(T.flags|=2),T}function o(T,k,_,P){return k===null||k.tag!==6?(k=vg(_,T.mode,P),k.return=T,k):(k=i(k,_),k.return=T,k)}function l(T,k,_,P){var W=_.type;return W===dc?d(T,k,_.props.children,P,_.key):k!==null&&(k.elementType===W||typeof W=="object"&&W!==null&&W.$$typeof===eo&&Ky(W)===k.type)?(P=i(k,_.props),P.ref=Nu(T,k,_),P.return=T,P):(P=Yd(_.type,_.key,_.props,null,T.mode,P),P.ref=Nu(T,k,_),P.return=T,P)}function c(T,k,_,P){return k===null||k.tag!==4||k.stateNode.containerInfo!==_.containerInfo||k.stateNode.implementation!==_.implementation?(k=yg(_,T.mode,P),k.return=T,k):(k=i(k,_.children||[]),k.return=T,k)}function d(T,k,_,P,W){return k===null||k.tag!==7?(k=fl(_,T.mode,P,W),k.return=T,k):(k=i(k,_),k.return=T,k)}function h(T,k,_){if(typeof k=="string"&&k!==""||typeof k=="number")return k=vg(""+k,T.mode,_),k.return=T,k;if(typeof k=="object"&&k!==null){switch(k.$$typeof){case td:return _=Yd(k.type,k.key,k.props,null,T.mode,_),_.ref=Nu(T,null,k),_.return=T,_;case fc:return k=yg(k,T.mode,_),k.return=T,k;case eo:var P=k._init;return h(T,P(k._payload),_)}if(Uu(k)||Cu(k))return k=fl(k,T.mode,_,null),k.return=T,k;dd(T,k)}return null}function p(T,k,_,P){var W=k!==null?k.key:null;if(typeof _=="string"&&_!==""||typeof _=="number")return W!==null?null:o(T,k,""+_,P);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case td:return _.key===W?l(T,k,_,P):null;case fc:return _.key===W?c(T,k,_,P):null;case eo:return W=_._init,p(T,k,W(_._payload),P)}if(Uu(_)||Cu(_))return W!==null?null:d(T,k,_,P,null);dd(T,_)}return null}function m(T,k,_,P,W){if(typeof P=="string"&&P!==""||typeof P=="number")return T=T.get(_)||null,o(k,T,""+P,W);if(typeof P=="object"&&P!==null){switch(P.$$typeof){case td:return T=T.get(P.key===null?_:P.key)||null,l(k,T,P,W);case fc:return T=T.get(P.key===null?_:P.key)||null,c(k,T,P,W);case eo:var B=P._init;return m(T,k,_,B(P._payload),W)}if(Uu(P)||Cu(P))return T=T.get(_)||null,d(k,T,P,W,null);dd(k,P)}return null}function y(T,k,_,P){for(var W=null,B=null,w=k,C=k=0,S=null;w!==null&&C<_.length;C++){w.index>C?(S=w,w=null):S=w.sibling;var b=p(T,w,_[C],P);if(b===null){w===null&&(w=S);break}t&&w&&b.alternate===null&&e(T,w),k=s(b,k,C),B===null?W=b:B.sibling=b,B=b,w=S}if(C===_.length)return r(T,w),gr&&el(T,C),W;if(w===null){for(;C<_.length;C++)w=h(T,_[C],P),w!==null&&(k=s(w,k,C),B===null?W=w:B.sibling=w,B=w);return gr&&el(T,C),W}for(w=n(T,w);C<_.length;C++)S=m(w,T,C,_[C],P),S!==null&&(t&&S.alternate!==null&&w.delete(S.key===null?C:S.key),k=s(S,k,C),B===null?W=S:B.sibling=S,B=S);return t&&w.forEach(function(N){return e(T,N)}),gr&&el(T,C),W}function x(T,k,_,P){var W=Cu(_);if(typeof W!="function")throw Error(De(150));if(_=W.call(_),_==null)throw Error(De(151));for(var B=W=null,w=k,C=k=0,S=null,b=_.next();w!==null&&!b.done;C++,b=_.next()){w.index>C?(S=w,w=null):S=w.sibling;var N=p(T,w,b.value,P);if(N===null){w===null&&(w=S);break}t&&w&&N.alternate===null&&e(T,w),k=s(N,k,C),B===null?W=N:B.sibling=N,B=N,w=S}if(b.done)return r(T,w),gr&&el(T,C),W;if(w===null){for(;!b.done;C++,b=_.next())b=h(T,b.value,P),b!==null&&(k=s(b,k,C),B===null?W=b:B.sibling=b,B=b);return gr&&el(T,C),W}for(w=n(T,w);!b.done;C++,b=_.next())b=m(w,T,C,b.value,P),b!==null&&(t&&b.alternate!==null&&w.delete(b.key===null?C:b.key),k=s(b,k,C),B===null?W=b:B.sibling=b,B=b);return t&&w.forEach(function(D){return e(T,D)}),gr&&el(T,C),W}function E(T,k,_,P){if(typeof _=="object"&&_!==null&&_.type===dc&&_.key===null&&(_=_.props.children),typeof _=="object"&&_!==null){switch(_.$$typeof){case td:e:{for(var W=_.key,B=k;B!==null;){if(B.key===W){if(W=_.type,W===dc){if(B.tag===7){r(T,B.sibling),k=i(B,_.props.children),k.return=T,T=k;break e}}else if(B.elementType===W||typeof W=="object"&&W!==null&&W.$$typeof===eo&&Ky(W)===B.type){r(T,B.sibling),k=i(B,_.props),k.ref=Nu(T,B,_),k.return=T,T=k;break e}r(T,B);break}else e(T,B);B=B.sibling}_.type===dc?(k=fl(_.props.children,T.mode,P,_.key),k.return=T,T=k):(P=Yd(_.type,_.key,_.props,null,T.mode,P),P.ref=Nu(T,k,_),P.return=T,T=P)}return a(T);case fc:e:{for(B=_.key;k!==null;){if(k.key===B)if(k.tag===4&&k.stateNode.containerInfo===_.containerInfo&&k.stateNode.implementation===_.implementation){r(T,k.sibling),k=i(k,_.children||[]),k.return=T,T=k;break e}else{r(T,k);break}else e(T,k);k=k.sibling}k=yg(_,T.mode,P),k.return=T,T=k}return a(T);case eo:return B=_._init,E(T,k,B(_._payload),P)}if(Uu(_))return y(T,k,_,P);if(Cu(_))return x(T,k,_,P);dd(T,_)}return typeof _=="string"&&_!==""||typeof _=="number"?(_=""+_,k!==null&&k.tag===6?(r(T,k.sibling),k=i(k,_),k.return=T,T=k):(r(T,k),k=vg(_,T.mode,P),k.return=T,T=k),a(T)):r(T,k)}return E}var Wc=cT(!0),uT=cT(!1),yh=Bo(null),_h=null,_c=null,qx=null;function Yx(){qx=_c=_h=null}function Qx(t){var e=yh.current;or(yh),t._currentValue=e}function Im(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function bc(t,e){_h=t,qx=_c=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(mi=!0),t.firstContext=null)}function os(t){var e=t._currentValue;if(qx!==t)if(t={context:t,memoizedValue:e,next:null},_c===null){if(_h===null)throw Error(De(308));_c=t,_h.dependencies={lanes:0,firstContext:t}}else _c=_c.next=t;return e}var al=null;function Jx(t){al===null?al=[t]:al.push(t)}function fT(t,e,r,n){var i=e.interleaved;return i===null?(r.next=r,Jx(e)):(r.next=i.next,i.next=r),e.interleaved=r,Ca(t,n)}function Ca(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var to=!1;function Zx(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function dT(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function _a(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function yo(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,Dt&2){var i=n.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),n.pending=e,Ca(t,r)}return i=n.interleaved,i===null?(e.next=e,Jx(n)):(e.next=i.next,i.next=e),n.interleaved=e,Ca(t,r)}function $d(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,Bx(t,r)}}function Xy(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?i=s=a:s=s.next=a,r=r.next}while(r!==null);s===null?i=s=e:s=s.next=e}else i=s=e;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function Eh(t,e,r,n){var i=t.updateQueue;to=!1;var s=i.firstBaseUpdate,a=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var l=o,c=l.next;l.next=null,a===null?s=c:a.next=c,a=l;var d=t.alternate;d!==null&&(d=d.updateQueue,o=d.lastBaseUpdate,o!==a&&(o===null?d.firstBaseUpdate=c:o.next=c,d.lastBaseUpdate=l))}if(s!==null){var h=i.baseState;a=0,d=c=l=null,o=s;do{var p=o.lane,m=o.eventTime;if((n&p)===p){d!==null&&(d=d.next={eventTime:m,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var y=t,x=o;switch(p=e,m=r,x.tag){case 1:if(y=x.payload,typeof y=="function"){h=y.call(m,h,p);break e}h=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=x.payload,p=typeof y=="function"?y.call(m,h,p):y,p==null)break e;h=Sr({},h,p);break e;case 2:to=!0}}o.callback!==null&&o.lane!==0&&(t.flags|=64,p=i.effects,p===null?i.effects=[o]:p.push(o))}else m={eventTime:m,lane:p,tag:o.tag,payload:o.payload,callback:o.callback,next:null},d===null?(c=d=m,l=h):d=d.next=m,a|=p;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;p=o,o=p.next,p.next=null,i.lastBaseUpdate=p,i.shared.pending=null}}while(!0);if(d===null&&(l=h),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=d,e=i.shared.interleaved,e!==null){i=e;do a|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);El|=a,t.lanes=a,t.memoizedState=h}}function qy(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(De(191,i));i.call(n)}}}var f0={},qs=Bo(f0),Rf=Bo(f0),Nf=Bo(f0);function ol(t){if(t===f0)throw Error(De(174));return t}function e1(t,e){switch(rr(Nf,e),rr(Rf,t),rr(qs,f0),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:cm(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=cm(e,t)}or(qs),rr(qs,e)}function $c(){or(qs),or(Rf),or(Nf)}function hT(t){ol(Nf.current);var e=ol(qs.current),r=cm(e,t.type);e!==r&&(rr(Rf,t),rr(qs,r))}function t1(t){Rf.current===t&&(or(qs),or(Rf))}var _r=Bo(0);function wh(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var dg=[];function r1(){for(var t=0;t<dg.length;t++)dg[t]._workInProgressVersionPrimary=null;dg.length=0}var Hd=Oa.ReactCurrentDispatcher,hg=Oa.ReactCurrentBatchConfig,_l=0,Tr=null,Kr=null,on=null,Th=!1,rf=!1,Df=0,XI=0;function On(){throw Error(De(321))}function n1(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!Ds(t[r],e[r]))return!1;return!0}function i1(t,e,r,n,i,s){if(_l=s,Tr=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Hd.current=t===null||t.memoizedState===null?JI:ZI,t=r(n,i),rf){s=0;do{if(rf=!1,Df=0,25<=s)throw Error(De(301));s+=1,on=Kr=null,e.updateQueue=null,Hd.current=eb,t=r(n,i)}while(rf)}if(Hd.current=Sh,e=Kr!==null&&Kr.next!==null,_l=0,on=Kr=Tr=null,Th=!1,e)throw Error(De(300));return t}function s1(){var t=Df!==0;return Df=0,t}function Hs(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return on===null?Tr.memoizedState=on=t:on=on.next=t,on}function ls(){if(Kr===null){var t=Tr.alternate;t=t!==null?t.memoizedState:null}else t=Kr.next;var e=on===null?Tr.memoizedState:on.next;if(e!==null)on=e,Kr=t;else{if(t===null)throw Error(De(310));Kr=t,t={memoizedState:Kr.memoizedState,baseState:Kr.baseState,baseQueue:Kr.baseQueue,queue:Kr.queue,next:null},on===null?Tr.memoizedState=on=t:on=on.next=t}return on}function Pf(t,e){return typeof e=="function"?e(t):e}function pg(t){var e=ls(),r=e.queue;if(r===null)throw Error(De(311));r.lastRenderedReducer=t;var n=Kr,i=n.baseQueue,s=r.pending;if(s!==null){if(i!==null){var a=i.next;i.next=s.next,s.next=a}n.baseQueue=i=s,r.pending=null}if(i!==null){s=i.next,n=n.baseState;var o=a=null,l=null,c=s;do{var d=c.lane;if((_l&d)===d)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:t(n,c.action);else{var h={lane:d,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(o=l=h,a=n):l=l.next=h,Tr.lanes|=d,El|=d}c=c.next}while(c!==null&&c!==s);l===null?a=n:l.next=o,Ds(n,e.memoizedState)||(mi=!0),e.memoizedState=n,e.baseState=a,e.baseQueue=l,r.lastRenderedState=n}if(t=r.interleaved,t!==null){i=t;do s=i.lane,Tr.lanes|=s,El|=s,i=i.next;while(i!==t)}else i===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function gg(t){var e=ls(),r=e.queue;if(r===null)throw Error(De(311));r.lastRenderedReducer=t;var n=r.dispatch,i=r.pending,s=e.memoizedState;if(i!==null){r.pending=null;var a=i=i.next;do s=t(s,a.action),a=a.next;while(a!==i);Ds(s,e.memoizedState)||(mi=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),r.lastRenderedState=s}return[s,n]}function pT(){}function gT(t,e){var r=Tr,n=ls(),i=e(),s=!Ds(n.memoizedState,i);if(s&&(n.memoizedState=i,mi=!0),n=n.queue,a1(vT.bind(null,r,n,t),[t]),n.getSnapshot!==e||s||on!==null&&on.memoizedState.tag&1){if(r.flags|=2048,Of(9,xT.bind(null,r,n,i,e),void 0,null),un===null)throw Error(De(349));_l&30||mT(r,e,i)}return i}function mT(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=Tr.updateQueue,e===null?(e={lastEffect:null,stores:null},Tr.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function xT(t,e,r,n){e.value=r,e.getSnapshot=n,yT(e)&&_T(t)}function vT(t,e,r){return r(function(){yT(e)&&_T(t)})}function yT(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!Ds(t,r)}catch{return!0}}function _T(t){var e=Ca(t,1);e!==null&&bs(e,t,1,-1)}function Yy(t){var e=Hs();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Pf,lastRenderedState:t},e.queue=t,t=t.dispatch=QI.bind(null,Tr,t),[e.memoizedState,t]}function Of(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=Tr.updateQueue,e===null?(e={lastEffect:null,stores:null},Tr.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function ET(){return ls().memoizedState}function Gd(t,e,r,n){var i=Hs();Tr.flags|=t,i.memoizedState=Of(1|e,r,void 0,n===void 0?null:n)}function hp(t,e,r,n){var i=ls();n=n===void 0?null:n;var s=void 0;if(Kr!==null){var a=Kr.memoizedState;if(s=a.destroy,n!==null&&n1(n,a.deps)){i.memoizedState=Of(e,r,s,n);return}}Tr.flags|=t,i.memoizedState=Of(1|e,r,s,n)}function Qy(t,e){return Gd(8390656,8,t,e)}function a1(t,e){return hp(2048,8,t,e)}function wT(t,e){return hp(4,2,t,e)}function TT(t,e){return hp(4,4,t,e)}function ST(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function kT(t,e,r){return r=r!=null?r.concat([t]):null,hp(4,4,ST.bind(null,e,t),r)}function o1(){}function AT(t,e){var r=ls();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&n1(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function CT(t,e){var r=ls();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&n1(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function FT(t,e,r){return _l&21?(Ds(r,e)||(r=Dw(),Tr.lanes|=r,El|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,mi=!0),t.memoizedState=r)}function qI(t,e){var r=qt;qt=r!==0&&4>r?r:4,t(!0);var n=hg.transition;hg.transition={};try{t(!1),e()}finally{qt=r,hg.transition=n}}function IT(){return ls().memoizedState}function YI(t,e,r){var n=Eo(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},bT(t))RT(e,r);else if(r=fT(t,e,r,n),r!==null){var i=ii();bs(r,t,n,i),NT(r,e,n)}}function QI(t,e,r){var n=Eo(t),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(bT(t))RT(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var a=e.lastRenderedState,o=s(a,r);if(i.hasEagerState=!0,i.eagerState=o,Ds(o,a)){var l=e.interleaved;l===null?(i.next=i,Jx(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}r=fT(t,e,i,n),r!==null&&(i=ii(),bs(r,t,n,i),NT(r,e,n))}}function bT(t){var e=t.alternate;return t===Tr||e!==null&&e===Tr}function RT(t,e){rf=Th=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function NT(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,Bx(t,r)}}var Sh={readContext:os,useCallback:On,useContext:On,useEffect:On,useImperativeHandle:On,useInsertionEffect:On,useLayoutEffect:On,useMemo:On,useReducer:On,useRef:On,useState:On,useDebugValue:On,useDeferredValue:On,useTransition:On,useMutableSource:On,useSyncExternalStore:On,useId:On,unstable_isNewReconciler:!1},JI={readContext:os,useCallback:function(t,e){return Hs().memoizedState=[t,e===void 0?null:e],t},useContext:os,useEffect:Qy,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,Gd(4194308,4,ST.bind(null,e,t),r)},useLayoutEffect:function(t,e){return Gd(4194308,4,t,e)},useInsertionEffect:function(t,e){return Gd(4,2,t,e)},useMemo:function(t,e){var r=Hs();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=Hs();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=YI.bind(null,Tr,t),[n.memoizedState,t]},useRef:function(t){var e=Hs();return t={current:t},e.memoizedState=t},useState:Yy,useDebugValue:o1,useDeferredValue:function(t){return Hs().memoizedState=t},useTransition:function(){var t=Yy(!1),e=t[0];return t=qI.bind(null,t[1]),Hs().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=Tr,i=Hs();if(gr){if(r===void 0)throw Error(De(407));r=r()}else{if(r=e(),un===null)throw Error(De(349));_l&30||mT(n,e,r)}i.memoizedState=r;var s={value:r,getSnapshot:e};return i.queue=s,Qy(vT.bind(null,n,s,t),[t]),n.flags|=2048,Of(9,xT.bind(null,n,s,r,e),void 0,null),r},useId:function(){var t=Hs(),e=un.identifierPrefix;if(gr){var r=ga,n=pa;r=(n&~(1<<32-Is(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=Df++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=XI++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},ZI={readContext:os,useCallback:AT,useContext:os,useEffect:a1,useImperativeHandle:kT,useInsertionEffect:wT,useLayoutEffect:TT,useMemo:CT,useReducer:pg,useRef:ET,useState:function(){return pg(Pf)},useDebugValue:o1,useDeferredValue:function(t){var e=ls();return FT(e,Kr.memoizedState,t)},useTransition:function(){var t=pg(Pf)[0],e=ls().memoizedState;return[t,e]},useMutableSource:pT,useSyncExternalStore:gT,useId:IT,unstable_isNewReconciler:!1},eb={readContext:os,useCallback:AT,useContext:os,useEffect:a1,useImperativeHandle:kT,useInsertionEffect:wT,useLayoutEffect:TT,useMemo:CT,useReducer:gg,useRef:ET,useState:function(){return gg(Pf)},useDebugValue:o1,useDeferredValue:function(t){var e=ls();return Kr===null?e.memoizedState=t:FT(e,Kr.memoizedState,t)},useTransition:function(){var t=gg(Pf)[0],e=ls().memoizedState;return[t,e]},useMutableSource:pT,useSyncExternalStore:gT,useId:IT,unstable_isNewReconciler:!1};function Ts(t,e){if(t&&t.defaultProps){e=Sr({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function bm(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:Sr({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var pp={isMounted:function(t){return(t=t._reactInternals)?Ol(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=ii(),i=Eo(t),s=_a(n,i);s.payload=e,r!=null&&(s.callback=r),e=yo(t,s,i),e!==null&&(bs(e,t,i,n),$d(e,t,i))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=ii(),i=Eo(t),s=_a(n,i);s.tag=1,s.payload=e,r!=null&&(s.callback=r),e=yo(t,s,i),e!==null&&(bs(e,t,i,n),$d(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=ii(),n=Eo(t),i=_a(r,n);i.tag=2,e!=null&&(i.callback=e),e=yo(t,i,n),e!==null&&(bs(e,t,n,r),$d(e,t,n))}};function Jy(t,e,r,n,i,s,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,s,a):e.prototype&&e.prototype.isPureReactComponent?!Cf(r,n)||!Cf(i,s):!0}function DT(t,e,r){var n=!1,i=Io,s=e.contextType;return typeof s=="object"&&s!==null?s=os(s):(i=vi(e)?vl:Kn.current,n=e.contextTypes,s=(n=n!=null)?Uc(t,i):Io),e=new e(r,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=pp,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function Zy(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&pp.enqueueReplaceState(e,e.state,null)}function Rm(t,e,r,n){var i=t.stateNode;i.props=r,i.state=t.memoizedState,i.refs={},Zx(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=os(s):(s=vi(e)?vl:Kn.current,i.context=Uc(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(bm(t,e,s,r),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&pp.enqueueReplaceState(i,i.state,null),Eh(t,r,i,n),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Hc(t,e){try{var r="",n=e;do r+=FF(n),n=n.return;while(n);var i=r}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function mg(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function Nm(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var tb=typeof WeakMap=="function"?WeakMap:Map;function PT(t,e,r){r=_a(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){Ah||(Ah=!0,zm=n),Nm(t,e)},r}function OT(t,e,r){r=_a(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var i=e.value;r.payload=function(){return n(i)},r.callback=function(){Nm(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){Nm(t,e),typeof n!="function"&&(_o===null?_o=new Set([this]):_o.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),r}function e_(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new tb;var i=new Set;n.set(e,i)}else i=n.get(e),i===void 0&&(i=new Set,n.set(e,i));i.has(r)||(i.add(r),t=gb.bind(null,t,e,r),e.then(t,t))}function t_(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function r_(t,e,r,n,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=_a(-1,1),e.tag=2,yo(r,e,1))),r.lanes|=1),t)}var rb=Oa.ReactCurrentOwner,mi=!1;function ti(t,e,r,n){e.child=t===null?uT(e,null,r,n):Wc(e,t.child,r,n)}function n_(t,e,r,n,i){r=r.render;var s=e.ref;return bc(e,i),n=i1(t,e,r,n,s,i),r=s1(),t!==null&&!mi?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Fa(t,e,i)):(gr&&r&&Gx(e),e.flags|=1,ti(t,e,n,i),e.child)}function i_(t,e,r,n,i){if(t===null){var s=r.type;return typeof s=="function"&&!g1(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=s,MT(t,e,s,n,i)):(t=Yd(r.type,null,n,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var a=s.memoizedProps;if(r=r.compare,r=r!==null?r:Cf,r(a,n)&&t.ref===e.ref)return Fa(t,e,i)}return e.flags|=1,t=wo(s,n),t.ref=e.ref,t.return=e,e.child=t}function MT(t,e,r,n,i){if(t!==null){var s=t.memoizedProps;if(Cf(s,n)&&t.ref===e.ref)if(mi=!1,e.pendingProps=n=s,(t.lanes&i)!==0)t.flags&131072&&(mi=!0);else return e.lanes=t.lanes,Fa(t,e,i)}return Dm(t,e,r,n,i)}function LT(t,e,r){var n=e.pendingProps,i=n.children,s=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},rr(wc,Ci),Ci|=r;else{if(!(r&1073741824))return t=s!==null?s.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,rr(wc,Ci),Ci|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,rr(wc,Ci),Ci|=n}else s!==null?(n=s.baseLanes|r,e.memoizedState=null):n=r,rr(wc,Ci),Ci|=n;return ti(t,e,i,r),e.child}function BT(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function Dm(t,e,r,n,i){var s=vi(r)?vl:Kn.current;return s=Uc(e,s),bc(e,i),r=i1(t,e,r,n,s,i),n=s1(),t!==null&&!mi?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Fa(t,e,i)):(gr&&n&&Gx(e),e.flags|=1,ti(t,e,r,i),e.child)}function s_(t,e,r,n,i){if(vi(r)){var s=!0;mh(e)}else s=!1;if(bc(e,i),e.stateNode===null)Kd(t,e),DT(e,r,n),Rm(e,r,n,i),n=!0;else if(t===null){var a=e.stateNode,o=e.memoizedProps;a.props=o;var l=a.context,c=r.contextType;typeof c=="object"&&c!==null?c=os(c):(c=vi(r)?vl:Kn.current,c=Uc(e,c));var d=r.getDerivedStateFromProps,h=typeof d=="function"||typeof a.getSnapshotBeforeUpdate=="function";h||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==n||l!==c)&&Zy(e,a,n,c),to=!1;var p=e.memoizedState;a.state=p,Eh(e,n,a,i),l=e.memoizedState,o!==n||p!==l||xi.current||to?(typeof d=="function"&&(bm(e,r,d,n),l=e.memoizedState),(o=to||Jy(e,r,o,n,p,l,c))?(h||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=l),a.props=n,a.state=l,a.context=c,n=o):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{a=e.stateNode,dT(t,e),o=e.memoizedProps,c=e.type===e.elementType?o:Ts(e.type,o),a.props=c,h=e.pendingProps,p=a.context,l=r.contextType,typeof l=="object"&&l!==null?l=os(l):(l=vi(r)?vl:Kn.current,l=Uc(e,l));var m=r.getDerivedStateFromProps;(d=typeof m=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==h||p!==l)&&Zy(e,a,n,l),to=!1,p=e.memoizedState,a.state=p,Eh(e,n,a,i);var y=e.memoizedState;o!==h||p!==y||xi.current||to?(typeof m=="function"&&(bm(e,r,m,n),y=e.memoizedState),(c=to||Jy(e,r,c,n,p,y,l)||!1)?(d||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(n,y,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(n,y,l)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=y),a.props=n,a.state=y,a.context=l,n=c):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),n=!1)}return Pm(t,e,r,n,s,i)}function Pm(t,e,r,n,i,s){BT(t,e);var a=(e.flags&128)!==0;if(!n&&!a)return i&&$y(e,r,!1),Fa(t,e,s);n=e.stateNode,rb.current=e;var o=a&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&a?(e.child=Wc(e,t.child,null,s),e.child=Wc(e,null,o,s)):ti(t,e,o,s),e.memoizedState=n.state,i&&$y(e,r,!0),e.child}function jT(t){var e=t.stateNode;e.pendingContext?Wy(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Wy(t,e.context,!1),e1(t,e.containerInfo)}function a_(t,e,r,n,i){return zc(),Xx(i),e.flags|=256,ti(t,e,r,n),e.child}var Om={dehydrated:null,treeContext:null,retryLane:0};function Mm(t){return{baseLanes:t,cachePool:null,transitions:null}}function VT(t,e,r){var n=e.pendingProps,i=_r.current,s=!1,a=(e.flags&128)!==0,o;if((o=a)||(o=t!==null&&t.memoizedState===null?!1:(i&2)!==0),o?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),rr(_r,i&1),t===null)return Fm(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=n.children,t=n.fallback,s?(n=e.mode,s=e.child,a={mode:"hidden",children:a},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=xp(a,n,0,null),t=fl(t,n,r,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=Mm(r),e.memoizedState=Om,t):l1(e,a));if(i=t.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return nb(t,e,a,n,o,i,r);if(s){s=n.fallback,a=e.mode,i=t.child,o=i.sibling;var l={mode:"hidden",children:n.children};return!(a&1)&&e.child!==i?(n=e.child,n.childLanes=0,n.pendingProps=l,e.deletions=null):(n=wo(i,l),n.subtreeFlags=i.subtreeFlags&14680064),o!==null?s=wo(o,s):(s=fl(s,a,r,null),s.flags|=2),s.return=e,n.return=e,n.sibling=s,e.child=n,n=s,s=e.child,a=t.child.memoizedState,a=a===null?Mm(r):{baseLanes:a.baseLanes|r,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=t.childLanes&~r,e.memoizedState=Om,n}return s=t.child,t=s.sibling,n=wo(s,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function l1(t,e){return e=xp({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function hd(t,e,r,n){return n!==null&&Xx(n),Wc(e,t.child,null,r),t=l1(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function nb(t,e,r,n,i,s,a){if(r)return e.flags&256?(e.flags&=-257,n=mg(Error(De(422))),hd(t,e,a,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=n.fallback,i=e.mode,n=xp({mode:"visible",children:n.children},i,0,null),s=fl(s,i,a,null),s.flags|=2,n.return=e,s.return=e,n.sibling=s,e.child=n,e.mode&1&&Wc(e,t.child,null,a),e.child.memoizedState=Mm(a),e.memoizedState=Om,s);if(!(e.mode&1))return hd(t,e,a,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var o=n.dgst;return n=o,s=Error(De(419)),n=mg(s,n,void 0),hd(t,e,a,n)}if(o=(a&t.childLanes)!==0,mi||o){if(n=un,n!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|a)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Ca(t,i),bs(n,t,i,-1))}return p1(),n=mg(Error(De(421))),hd(t,e,a,n)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=mb.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,Ni=vo(i.nextSibling),Di=e,gr=!0,ks=null,t!==null&&(ts[rs++]=pa,ts[rs++]=ga,ts[rs++]=yl,pa=t.id,ga=t.overflow,yl=e),e=l1(e,n.children),e.flags|=4096,e)}function o_(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),Im(t.return,e,r)}function xg(t,e,r,n,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function UT(t,e,r){var n=e.pendingProps,i=n.revealOrder,s=n.tail;if(ti(t,e,n.children,r),n=_r.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&o_(t,r,e);else if(t.tag===19)o_(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(rr(_r,n),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(r=e.child,i=null;r!==null;)t=r.alternate,t!==null&&wh(t)===null&&(i=r),r=r.sibling;r=i,r===null?(i=e.child,e.child=null):(i=r.sibling,r.sibling=null),xg(e,!1,i,r,s);break;case"backwards":for(r=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&wh(t)===null){e.child=i;break}t=i.sibling,i.sibling=r,r=i,i=t}xg(e,!0,r,null,s);break;case"together":xg(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Kd(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Fa(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),El|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(De(153));if(e.child!==null){for(t=e.child,r=wo(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=wo(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function ib(t,e,r){switch(e.tag){case 3:jT(e),zc();break;case 5:hT(e);break;case 1:vi(e.type)&&mh(e);break;case 4:e1(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,i=e.memoizedProps.value;rr(yh,n._currentValue),n._currentValue=i;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(rr(_r,_r.current&1),e.flags|=128,null):r&e.child.childLanes?VT(t,e,r):(rr(_r,_r.current&1),t=Fa(t,e,r),t!==null?t.sibling:null);rr(_r,_r.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return UT(t,e,r);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),rr(_r,_r.current),n)break;return null;case 22:case 23:return e.lanes=0,LT(t,e,r)}return Fa(t,e,r)}var zT,Lm,WT,$T;zT=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Lm=function(){};WT=function(t,e,r,n){var i=t.memoizedProps;if(i!==n){t=e.stateNode,ol(qs.current);var s=null;switch(r){case"input":i=sm(t,i),n=sm(t,n),s=[];break;case"select":i=Sr({},i,{value:void 0}),n=Sr({},n,{value:void 0}),s=[];break;case"textarea":i=lm(t,i),n=lm(t,n),s=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=ph)}um(r,n);var a;r=null;for(c in i)if(!n.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var o=i[c];for(a in o)o.hasOwnProperty(a)&&(r||(r={}),r[a]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(_f.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in n){var l=n[c];if(o=i!=null?i[c]:void 0,n.hasOwnProperty(c)&&l!==o&&(l!=null||o!=null))if(c==="style")if(o){for(a in o)!o.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(r||(r={}),r[a]="");for(a in l)l.hasOwnProperty(a)&&o[a]!==l[a]&&(r||(r={}),r[a]=l[a])}else r||(s||(s=[]),s.push(c,r)),r=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(_f.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&sr("scroll",t),s||o===l||(s=[])):(s=s||[]).push(c,l))}r&&(s=s||[]).push("style",r);var c=s;(e.updateQueue=c)&&(e.flags|=4)}};$T=function(t,e,r,n){r!==n&&(e.flags|=4)};function Du(t,e){if(!gr)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function Mn(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function sb(t,e,r){var n=e.pendingProps;switch(Kx(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Mn(e),null;case 1:return vi(e.type)&&gh(),Mn(e),null;case 3:return n=e.stateNode,$c(),or(xi),or(Kn),r1(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(fd(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,ks!==null&&(Hm(ks),ks=null))),Lm(t,e),Mn(e),null;case 5:t1(e);var i=ol(Nf.current);if(r=e.type,t!==null&&e.stateNode!=null)WT(t,e,r,n,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(De(166));return Mn(e),null}if(t=ol(qs.current),fd(e)){n=e.stateNode,r=e.type;var s=e.memoizedProps;switch(n[Gs]=e,n[bf]=s,t=(e.mode&1)!==0,r){case"dialog":sr("cancel",n),sr("close",n);break;case"iframe":case"object":case"embed":sr("load",n);break;case"video":case"audio":for(i=0;i<Wu.length;i++)sr(Wu[i],n);break;case"source":sr("error",n);break;case"img":case"image":case"link":sr("error",n),sr("load",n);break;case"details":sr("toggle",n);break;case"input":my(n,s),sr("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},sr("invalid",n);break;case"textarea":vy(n,s),sr("invalid",n)}um(r,s),i=null;for(var a in s)if(s.hasOwnProperty(a)){var o=s[a];a==="children"?typeof o=="string"?n.textContent!==o&&(s.suppressHydrationWarning!==!0&&ud(n.textContent,o,t),i=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&ud(n.textContent,o,t),i=["children",""+o]):_f.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&sr("scroll",n)}switch(r){case"input":rd(n),xy(n,s,!0);break;case"textarea":rd(n),yy(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=ph)}n=i,e.updateQueue=n,n!==null&&(e.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=vw(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=a.createElement(r,{is:n.is}):(t=a.createElement(r),r==="select"&&(a=t,n.multiple?a.multiple=!0:n.size&&(a.size=n.size))):t=a.createElementNS(t,r),t[Gs]=e,t[bf]=n,zT(t,e,!1,!1),e.stateNode=t;e:{switch(a=fm(r,n),r){case"dialog":sr("cancel",t),sr("close",t),i=n;break;case"iframe":case"object":case"embed":sr("load",t),i=n;break;case"video":case"audio":for(i=0;i<Wu.length;i++)sr(Wu[i],t);i=n;break;case"source":sr("error",t),i=n;break;case"img":case"image":case"link":sr("error",t),sr("load",t),i=n;break;case"details":sr("toggle",t),i=n;break;case"input":my(t,n),i=sm(t,n),sr("invalid",t);break;case"option":i=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},i=Sr({},n,{value:void 0}),sr("invalid",t);break;case"textarea":vy(t,n),i=lm(t,n),sr("invalid",t);break;default:i=n}um(r,i),o=i;for(s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="style"?Ew(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&yw(t,l)):s==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&Ef(t,l):typeof l=="number"&&Ef(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(_f.hasOwnProperty(s)?l!=null&&s==="onScroll"&&sr("scroll",t):l!=null&&Nx(t,s,l,a))}switch(r){case"input":rd(t),xy(t,n,!1);break;case"textarea":rd(t),yy(t);break;case"option":n.value!=null&&t.setAttribute("value",""+Fo(n.value));break;case"select":t.multiple=!!n.multiple,s=n.value,s!=null?Ac(t,!!n.multiple,s,!1):n.defaultValue!=null&&Ac(t,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=ph)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Mn(e),null;case 6:if(t&&e.stateNode!=null)$T(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(De(166));if(r=ol(Nf.current),ol(qs.current),fd(e)){if(n=e.stateNode,r=e.memoizedProps,n[Gs]=e,(s=n.nodeValue!==r)&&(t=Di,t!==null))switch(t.tag){case 3:ud(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&ud(n.nodeValue,r,(t.mode&1)!==0)}s&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Gs]=e,e.stateNode=n}return Mn(e),null;case 13:if(or(_r),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(gr&&Ni!==null&&e.mode&1&&!(e.flags&128))lT(),zc(),e.flags|=98560,s=!1;else if(s=fd(e),n!==null&&n.dehydrated!==null){if(t===null){if(!s)throw Error(De(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(De(317));s[Gs]=e}else zc(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Mn(e),s=!1}else ks!==null&&(Hm(ks),ks=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||_r.current&1?Yr===0&&(Yr=3):p1())),e.updateQueue!==null&&(e.flags|=4),Mn(e),null);case 4:return $c(),Lm(t,e),t===null&&Ff(e.stateNode.containerInfo),Mn(e),null;case 10:return Qx(e.type._context),Mn(e),null;case 17:return vi(e.type)&&gh(),Mn(e),null;case 19:if(or(_r),s=e.memoizedState,s===null)return Mn(e),null;if(n=(e.flags&128)!==0,a=s.rendering,a===null)if(n)Du(s,!1);else{if(Yr!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=wh(t),a!==null){for(e.flags|=128,Du(s,!1),n=a.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)s=r,t=n,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,t=a.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return rr(_r,_r.current&1|2),e.child}t=t.sibling}s.tail!==null&&Or()>Gc&&(e.flags|=128,n=!0,Du(s,!1),e.lanes=4194304)}else{if(!n)if(t=wh(a),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),Du(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!gr)return Mn(e),null}else 2*Or()-s.renderingStartTime>Gc&&r!==1073741824&&(e.flags|=128,n=!0,Du(s,!1),e.lanes=4194304);s.isBackwards?(a.sibling=e.child,e.child=a):(r=s.last,r!==null?r.sibling=a:e.child=a,s.last=a)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Or(),e.sibling=null,r=_r.current,rr(_r,n?r&1|2:r&1),e):(Mn(e),null);case 22:case 23:return h1(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?Ci&1073741824&&(Mn(e),e.subtreeFlags&6&&(e.flags|=8192)):Mn(e),null;case 24:return null;case 25:return null}throw Error(De(156,e.tag))}function ab(t,e){switch(Kx(e),e.tag){case 1:return vi(e.type)&&gh(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return $c(),or(xi),or(Kn),r1(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return t1(e),null;case 13:if(or(_r),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(De(340));zc()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return or(_r),null;case 4:return $c(),null;case 10:return Qx(e.type._context),null;case 22:case 23:return h1(),null;case 24:return null;default:return null}}var pd=!1,zn=!1,ob=typeof WeakSet=="function"?WeakSet:Set,Qe=null;function Ec(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Fr(t,e,n)}else r.current=null}function Bm(t,e,r){try{r()}catch(n){Fr(t,e,n)}}var l_=!1;function lb(t,e){if(Em=fh,t=qw(),Hx(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var a=0,o=-1,l=-1,c=0,d=0,h=t,p=null;t:for(;;){for(var m;h!==r||i!==0&&h.nodeType!==3||(o=a+i),h!==s||n!==0&&h.nodeType!==3||(l=a+n),h.nodeType===3&&(a+=h.nodeValue.length),(m=h.firstChild)!==null;)p=h,h=m;for(;;){if(h===t)break t;if(p===r&&++c===i&&(o=a),p===s&&++d===n&&(l=a),(m=h.nextSibling)!==null)break;h=p,p=h.parentNode}h=m}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(wm={focusedElem:t,selectionRange:r},fh=!1,Qe=e;Qe!==null;)if(e=Qe,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Qe=t;else for(;Qe!==null;){e=Qe;try{var y=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var x=y.memoizedProps,E=y.memoizedState,T=e.stateNode,k=T.getSnapshotBeforeUpdate(e.elementType===e.type?x:Ts(e.type,x),E);T.__reactInternalSnapshotBeforeUpdate=k}break;case 3:var _=e.stateNode.containerInfo;_.nodeType===1?_.textContent="":_.nodeType===9&&_.documentElement&&_.removeChild(_.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(De(163))}}catch(P){Fr(e,e.return,P)}if(t=e.sibling,t!==null){t.return=e.return,Qe=t;break}Qe=e.return}return y=l_,l_=!1,y}function nf(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&Bm(e,r,s)}i=i.next}while(i!==n)}}function gp(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function jm(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function HT(t){var e=t.alternate;e!==null&&(t.alternate=null,HT(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Gs],delete e[bf],delete e[km],delete e[$I],delete e[HI])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function GT(t){return t.tag===5||t.tag===3||t.tag===4}function c_(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||GT(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Vm(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=ph));else if(n!==4&&(t=t.child,t!==null))for(Vm(t,e,r),t=t.sibling;t!==null;)Vm(t,e,r),t=t.sibling}function Um(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(Um(t,e,r),t=t.sibling;t!==null;)Um(t,e,r),t=t.sibling}var yn=null,Ss=!1;function Qa(t,e,r){for(r=r.child;r!==null;)KT(t,e,r),r=r.sibling}function KT(t,e,r){if(Xs&&typeof Xs.onCommitFiberUnmount=="function")try{Xs.onCommitFiberUnmount(op,r)}catch{}switch(r.tag){case 5:zn||Ec(r,e);case 6:var n=yn,i=Ss;yn=null,Qa(t,e,r),yn=n,Ss=i,yn!==null&&(Ss?(t=yn,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):yn.removeChild(r.stateNode));break;case 18:yn!==null&&(Ss?(t=yn,r=r.stateNode,t.nodeType===8?ug(t.parentNode,r):t.nodeType===1&&ug(t,r),kf(t)):ug(yn,r.stateNode));break;case 4:n=yn,i=Ss,yn=r.stateNode.containerInfo,Ss=!0,Qa(t,e,r),yn=n,Ss=i;break;case 0:case 11:case 14:case 15:if(!zn&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var s=i,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&Bm(r,e,a),i=i.next}while(i!==n)}Qa(t,e,r);break;case 1:if(!zn&&(Ec(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){Fr(r,e,o)}Qa(t,e,r);break;case 21:Qa(t,e,r);break;case 22:r.mode&1?(zn=(n=zn)||r.memoizedState!==null,Qa(t,e,r),zn=n):Qa(t,e,r);break;default:Qa(t,e,r)}}function u_(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new ob),e.forEach(function(n){var i=xb.bind(null,t,n);r.has(n)||(r.add(n),n.then(i,i))})}}function Es(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var s=t,a=e,o=a;e:for(;o!==null;){switch(o.tag){case 5:yn=o.stateNode,Ss=!1;break e;case 3:yn=o.stateNode.containerInfo,Ss=!0;break e;case 4:yn=o.stateNode.containerInfo,Ss=!0;break e}o=o.return}if(yn===null)throw Error(De(160));KT(s,a,i),yn=null,Ss=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(c){Fr(i,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)XT(e,t),e=e.sibling}function XT(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Es(e,t),js(t),n&4){try{nf(3,t,t.return),gp(3,t)}catch(x){Fr(t,t.return,x)}try{nf(5,t,t.return)}catch(x){Fr(t,t.return,x)}}break;case 1:Es(e,t),js(t),n&512&&r!==null&&Ec(r,r.return);break;case 5:if(Es(e,t),js(t),n&512&&r!==null&&Ec(r,r.return),t.flags&32){var i=t.stateNode;try{Ef(i,"")}catch(x){Fr(t,t.return,x)}}if(n&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,a=r!==null?r.memoizedProps:s,o=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&mw(i,s),fm(o,a);var c=fm(o,s);for(a=0;a<l.length;a+=2){var d=l[a],h=l[a+1];d==="style"?Ew(i,h):d==="dangerouslySetInnerHTML"?yw(i,h):d==="children"?Ef(i,h):Nx(i,d,h,c)}switch(o){case"input":am(i,s);break;case"textarea":xw(i,s);break;case"select":var p=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var m=s.value;m!=null?Ac(i,!!s.multiple,m,!1):p!==!!s.multiple&&(s.defaultValue!=null?Ac(i,!!s.multiple,s.defaultValue,!0):Ac(i,!!s.multiple,s.multiple?[]:"",!1))}i[bf]=s}catch(x){Fr(t,t.return,x)}}break;case 6:if(Es(e,t),js(t),n&4){if(t.stateNode===null)throw Error(De(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(x){Fr(t,t.return,x)}}break;case 3:if(Es(e,t),js(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{kf(e.containerInfo)}catch(x){Fr(t,t.return,x)}break;case 4:Es(e,t),js(t);break;case 13:Es(e,t),js(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(f1=Or())),n&4&&u_(t);break;case 22:if(d=r!==null&&r.memoizedState!==null,t.mode&1?(zn=(c=zn)||d,Es(e,t),zn=c):Es(e,t),js(t),n&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!d&&t.mode&1)for(Qe=t,d=t.child;d!==null;){for(h=Qe=d;Qe!==null;){switch(p=Qe,m=p.child,p.tag){case 0:case 11:case 14:case 15:nf(4,p,p.return);break;case 1:Ec(p,p.return);var y=p.stateNode;if(typeof y.componentWillUnmount=="function"){n=p,r=p.return;try{e=n,y.props=e.memoizedProps,y.state=e.memoizedState,y.componentWillUnmount()}catch(x){Fr(n,r,x)}}break;case 5:Ec(p,p.return);break;case 22:if(p.memoizedState!==null){d_(h);continue}}m!==null?(m.return=p,Qe=m):d_(h)}d=d.sibling}e:for(d=null,h=t;;){if(h.tag===5){if(d===null){d=h;try{i=h.stateNode,c?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=h.stateNode,l=h.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=_w("display",a))}catch(x){Fr(t,t.return,x)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(x){Fr(t,t.return,x)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Es(e,t),js(t),n&4&&u_(t);break;case 21:break;default:Es(e,t),js(t)}}function js(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(GT(r)){var n=r;break e}r=r.return}throw Error(De(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(Ef(i,""),n.flags&=-33);var s=c_(t);Um(t,s,i);break;case 3:case 4:var a=n.stateNode.containerInfo,o=c_(t);Vm(t,o,a);break;default:throw Error(De(161))}}catch(l){Fr(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function cb(t,e,r){Qe=t,qT(t)}function qT(t,e,r){for(var n=(t.mode&1)!==0;Qe!==null;){var i=Qe,s=i.child;if(i.tag===22&&n){var a=i.memoizedState!==null||pd;if(!a){var o=i.alternate,l=o!==null&&o.memoizedState!==null||zn;o=pd;var c=zn;if(pd=a,(zn=l)&&!c)for(Qe=i;Qe!==null;)a=Qe,l=a.child,a.tag===22&&a.memoizedState!==null?h_(i):l!==null?(l.return=a,Qe=l):h_(i);for(;s!==null;)Qe=s,qT(s),s=s.sibling;Qe=i,pd=o,zn=c}f_(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,Qe=s):f_(t)}}function f_(t){for(;Qe!==null;){var e=Qe;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:zn||gp(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!zn)if(r===null)n.componentDidMount();else{var i=e.elementType===e.type?r.memoizedProps:Ts(e.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&qy(e,s,n);break;case 3:var a=e.updateQueue;if(a!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}qy(e,a,r)}break;case 5:var o=e.stateNode;if(r===null&&e.flags&4){r=o;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var d=c.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&kf(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(De(163))}zn||e.flags&512&&jm(e)}catch(p){Fr(e,e.return,p)}}if(e===t){Qe=null;break}if(r=e.sibling,r!==null){r.return=e.return,Qe=r;break}Qe=e.return}}function d_(t){for(;Qe!==null;){var e=Qe;if(e===t){Qe=null;break}var r=e.sibling;if(r!==null){r.return=e.return,Qe=r;break}Qe=e.return}}function h_(t){for(;Qe!==null;){var e=Qe;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{gp(4,e)}catch(l){Fr(e,r,l)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var i=e.return;try{n.componentDidMount()}catch(l){Fr(e,i,l)}}var s=e.return;try{jm(e)}catch(l){Fr(e,s,l)}break;case 5:var a=e.return;try{jm(e)}catch(l){Fr(e,a,l)}}}catch(l){Fr(e,e.return,l)}if(e===t){Qe=null;break}var o=e.sibling;if(o!==null){o.return=e.return,Qe=o;break}Qe=e.return}}var ub=Math.ceil,kh=Oa.ReactCurrentDispatcher,c1=Oa.ReactCurrentOwner,ss=Oa.ReactCurrentBatchConfig,Dt=0,un=null,Wr=null,Sn=0,Ci=0,wc=Bo(0),Yr=0,Mf=null,El=0,mp=0,u1=0,sf=null,gi=null,f1=0,Gc=1/0,da=null,Ah=!1,zm=null,_o=null,gd=!1,co=null,Ch=0,af=0,Wm=null,Xd=-1,qd=0;function ii(){return Dt&6?Or():Xd!==-1?Xd:Xd=Or()}function Eo(t){return t.mode&1?Dt&2&&Sn!==0?Sn&-Sn:KI.transition!==null?(qd===0&&(qd=Dw()),qd):(t=qt,t!==0||(t=window.event,t=t===void 0?16:Vw(t.type)),t):1}function bs(t,e,r,n){if(50<af)throw af=0,Wm=null,Error(De(185));l0(t,r,n),(!(Dt&2)||t!==un)&&(t===un&&(!(Dt&2)&&(mp|=r),Yr===4&&no(t,Sn)),yi(t,n),r===1&&Dt===0&&!(e.mode&1)&&(Gc=Or()+500,dp&&jo()))}function yi(t,e){var r=t.callbackNode;KF(t,e);var n=uh(t,t===un?Sn:0);if(n===0)r!==null&&wy(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&wy(r),e===1)t.tag===0?GI(p_.bind(null,t)):sT(p_.bind(null,t)),zI(function(){!(Dt&6)&&jo()}),r=null;else{switch(Pw(n)){case 1:r=Lx;break;case 4:r=Rw;break;case 16:r=ch;break;case 536870912:r=Nw;break;default:r=ch}r=nS(r,YT.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function YT(t,e){if(Xd=-1,qd=0,Dt&6)throw Error(De(327));var r=t.callbackNode;if(Rc()&&t.callbackNode!==r)return null;var n=uh(t,t===un?Sn:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=Fh(t,n);else{e=n;var i=Dt;Dt|=2;var s=JT();(un!==t||Sn!==e)&&(da=null,Gc=Or()+500,ul(t,e));do try{hb();break}catch(o){QT(t,o)}while(!0);Yx(),kh.current=s,Dt=i,Wr!==null?e=0:(un=null,Sn=0,e=Yr)}if(e!==0){if(e===2&&(i=mm(t),i!==0&&(n=i,e=$m(t,i))),e===1)throw r=Mf,ul(t,0),no(t,n),yi(t,Or()),r;if(e===6)no(t,n);else{if(i=t.current.alternate,!(n&30)&&!fb(i)&&(e=Fh(t,n),e===2&&(s=mm(t),s!==0&&(n=s,e=$m(t,s))),e===1))throw r=Mf,ul(t,0),no(t,n),yi(t,Or()),r;switch(t.finishedWork=i,t.finishedLanes=n,e){case 0:case 1:throw Error(De(345));case 2:tl(t,gi,da);break;case 3:if(no(t,n),(n&130023424)===n&&(e=f1+500-Or(),10<e)){if(uh(t,0)!==0)break;if(i=t.suspendedLanes,(i&n)!==n){ii(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Sm(tl.bind(null,t,gi,da),e);break}tl(t,gi,da);break;case 4:if(no(t,n),(n&4194240)===n)break;for(e=t.eventTimes,i=-1;0<n;){var a=31-Is(n);s=1<<a,a=e[a],a>i&&(i=a),n&=~s}if(n=i,n=Or()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*ub(n/1960))-n,10<n){t.timeoutHandle=Sm(tl.bind(null,t,gi,da),n);break}tl(t,gi,da);break;case 5:tl(t,gi,da);break;default:throw Error(De(329))}}}return yi(t,Or()),t.callbackNode===r?YT.bind(null,t):null}function $m(t,e){var r=sf;return t.current.memoizedState.isDehydrated&&(ul(t,e).flags|=256),t=Fh(t,e),t!==2&&(e=gi,gi=r,e!==null&&Hm(e)),t}function Hm(t){gi===null?gi=t:gi.push.apply(gi,t)}function fb(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!Ds(s(),i))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function no(t,e){for(e&=~u1,e&=~mp,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-Is(e),n=1<<r;t[r]=-1,e&=~n}}function p_(t){if(Dt&6)throw Error(De(327));Rc();var e=uh(t,0);if(!(e&1))return yi(t,Or()),null;var r=Fh(t,e);if(t.tag!==0&&r===2){var n=mm(t);n!==0&&(e=n,r=$m(t,n))}if(r===1)throw r=Mf,ul(t,0),no(t,e),yi(t,Or()),r;if(r===6)throw Error(De(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,tl(t,gi,da),yi(t,Or()),null}function d1(t,e){var r=Dt;Dt|=1;try{return t(e)}finally{Dt=r,Dt===0&&(Gc=Or()+500,dp&&jo())}}function wl(t){co!==null&&co.tag===0&&!(Dt&6)&&Rc();var e=Dt;Dt|=1;var r=ss.transition,n=qt;try{if(ss.transition=null,qt=1,t)return t()}finally{qt=n,ss.transition=r,Dt=e,!(Dt&6)&&jo()}}function h1(){Ci=wc.current,or(wc)}function ul(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,UI(r)),Wr!==null)for(r=Wr.return;r!==null;){var n=r;switch(Kx(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&gh();break;case 3:$c(),or(xi),or(Kn),r1();break;case 5:t1(n);break;case 4:$c();break;case 13:or(_r);break;case 19:or(_r);break;case 10:Qx(n.type._context);break;case 22:case 23:h1()}r=r.return}if(un=t,Wr=t=wo(t.current,null),Sn=Ci=e,Yr=0,Mf=null,u1=mp=El=0,gi=sf=null,al!==null){for(e=0;e<al.length;e++)if(r=al[e],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,s=r.pending;if(s!==null){var a=s.next;s.next=i,n.next=a}r.pending=n}al=null}return t}function QT(t,e){do{var r=Wr;try{if(Yx(),Hd.current=Sh,Th){for(var n=Tr.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}Th=!1}if(_l=0,on=Kr=Tr=null,rf=!1,Df=0,c1.current=null,r===null||r.return===null){Yr=1,Mf=e,Wr=null;break}e:{var s=t,a=r.return,o=r,l=e;if(e=Sn,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,d=o,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var m=t_(a);if(m!==null){m.flags&=-257,r_(m,a,o,s,e),m.mode&1&&e_(s,c,e),e=m,l=c;var y=e.updateQueue;if(y===null){var x=new Set;x.add(l),e.updateQueue=x}else y.add(l);break e}else{if(!(e&1)){e_(s,c,e),p1();break e}l=Error(De(426))}}else if(gr&&o.mode&1){var E=t_(a);if(E!==null){!(E.flags&65536)&&(E.flags|=256),r_(E,a,o,s,e),Xx(Hc(l,o));break e}}s=l=Hc(l,o),Yr!==4&&(Yr=2),sf===null?sf=[s]:sf.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var T=PT(s,l,e);Xy(s,T);break e;case 1:o=l;var k=s.type,_=s.stateNode;if(!(s.flags&128)&&(typeof k.getDerivedStateFromError=="function"||_!==null&&typeof _.componentDidCatch=="function"&&(_o===null||!_o.has(_)))){s.flags|=65536,e&=-e,s.lanes|=e;var P=OT(s,o,e);Xy(s,P);break e}}s=s.return}while(s!==null)}eS(r)}catch(W){e=W,Wr===r&&r!==null&&(Wr=r=r.return);continue}break}while(!0)}function JT(){var t=kh.current;return kh.current=Sh,t===null?Sh:t}function p1(){(Yr===0||Yr===3||Yr===2)&&(Yr=4),un===null||!(El&268435455)&&!(mp&268435455)||no(un,Sn)}function Fh(t,e){var r=Dt;Dt|=2;var n=JT();(un!==t||Sn!==e)&&(da=null,ul(t,e));do try{db();break}catch(i){QT(t,i)}while(!0);if(Yx(),Dt=r,kh.current=n,Wr!==null)throw Error(De(261));return un=null,Sn=0,Yr}function db(){for(;Wr!==null;)ZT(Wr)}function hb(){for(;Wr!==null&&!BF();)ZT(Wr)}function ZT(t){var e=rS(t.alternate,t,Ci);t.memoizedProps=t.pendingProps,e===null?eS(t):Wr=e,c1.current=null}function eS(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=ab(r,e),r!==null){r.flags&=32767,Wr=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Yr=6,Wr=null;return}}else if(r=sb(r,e,Ci),r!==null){Wr=r;return}if(e=e.sibling,e!==null){Wr=e;return}Wr=e=t}while(e!==null);Yr===0&&(Yr=5)}function tl(t,e,r){var n=qt,i=ss.transition;try{ss.transition=null,qt=1,pb(t,e,r,n)}finally{ss.transition=i,qt=n}return null}function pb(t,e,r,n){do Rc();while(co!==null);if(Dt&6)throw Error(De(327));r=t.finishedWork;var i=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(De(177));t.callbackNode=null,t.callbackPriority=0;var s=r.lanes|r.childLanes;if(XF(t,s),t===un&&(Wr=un=null,Sn=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||gd||(gd=!0,nS(ch,function(){return Rc(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=ss.transition,ss.transition=null;var a=qt;qt=1;var o=Dt;Dt|=4,c1.current=null,lb(t,r),XT(r,t),PI(wm),fh=!!Em,wm=Em=null,t.current=r,cb(r),jF(),Dt=o,qt=a,ss.transition=s}else t.current=r;if(gd&&(gd=!1,co=t,Ch=i),s=t.pendingLanes,s===0&&(_o=null),zF(r.stateNode),yi(t,Or()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)i=e[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(Ah)throw Ah=!1,t=zm,zm=null,t;return Ch&1&&t.tag!==0&&Rc(),s=t.pendingLanes,s&1?t===Wm?af++:(af=0,Wm=t):af=0,jo(),null}function Rc(){if(co!==null){var t=Pw(Ch),e=ss.transition,r=qt;try{if(ss.transition=null,qt=16>t?16:t,co===null)var n=!1;else{if(t=co,co=null,Ch=0,Dt&6)throw Error(De(331));var i=Dt;for(Dt|=4,Qe=t.current;Qe!==null;){var s=Qe,a=s.child;if(Qe.flags&16){var o=s.deletions;if(o!==null){for(var l=0;l<o.length;l++){var c=o[l];for(Qe=c;Qe!==null;){var d=Qe;switch(d.tag){case 0:case 11:case 15:nf(8,d,s)}var h=d.child;if(h!==null)h.return=d,Qe=h;else for(;Qe!==null;){d=Qe;var p=d.sibling,m=d.return;if(HT(d),d===c){Qe=null;break}if(p!==null){p.return=m,Qe=p;break}Qe=m}}}var y=s.alternate;if(y!==null){var x=y.child;if(x!==null){y.child=null;do{var E=x.sibling;x.sibling=null,x=E}while(x!==null)}}Qe=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,Qe=a;else e:for(;Qe!==null;){if(s=Qe,s.flags&2048)switch(s.tag){case 0:case 11:case 15:nf(9,s,s.return)}var T=s.sibling;if(T!==null){T.return=s.return,Qe=T;break e}Qe=s.return}}var k=t.current;for(Qe=k;Qe!==null;){a=Qe;var _=a.child;if(a.subtreeFlags&2064&&_!==null)_.return=a,Qe=_;else e:for(a=k;Qe!==null;){if(o=Qe,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:gp(9,o)}}catch(W){Fr(o,o.return,W)}if(o===a){Qe=null;break e}var P=o.sibling;if(P!==null){P.return=o.return,Qe=P;break e}Qe=o.return}}if(Dt=i,jo(),Xs&&typeof Xs.onPostCommitFiberRoot=="function")try{Xs.onPostCommitFiberRoot(op,t)}catch{}n=!0}return n}finally{qt=r,ss.transition=e}}return!1}function g_(t,e,r){e=Hc(r,e),e=PT(t,e,1),t=yo(t,e,1),e=ii(),t!==null&&(l0(t,1,e),yi(t,e))}function Fr(t,e,r){if(t.tag===3)g_(t,t,r);else for(;e!==null;){if(e.tag===3){g_(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(_o===null||!_o.has(n))){t=Hc(r,t),t=OT(e,t,1),e=yo(e,t,1),t=ii(),e!==null&&(l0(e,1,t),yi(e,t));break}}e=e.return}}function gb(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=ii(),t.pingedLanes|=t.suspendedLanes&r,un===t&&(Sn&r)===r&&(Yr===4||Yr===3&&(Sn&130023424)===Sn&&500>Or()-f1?ul(t,0):u1|=r),yi(t,e)}function tS(t,e){e===0&&(t.mode&1?(e=sd,sd<<=1,!(sd&130023424)&&(sd=4194304)):e=1);var r=ii();t=Ca(t,e),t!==null&&(l0(t,e,r),yi(t,r))}function mb(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),tS(t,r)}function xb(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,i=t.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(De(314))}n!==null&&n.delete(e),tS(t,r)}var rS;rS=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||xi.current)mi=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return mi=!1,ib(t,e,r);mi=!!(t.flags&131072)}else mi=!1,gr&&e.flags&1048576&&aT(e,vh,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;Kd(t,e),t=e.pendingProps;var i=Uc(e,Kn.current);bc(e,r),i=i1(null,e,n,t,i,r);var s=s1();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,vi(n)?(s=!0,mh(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Zx(e),i.updater=pp,e.stateNode=i,i._reactInternals=e,Rm(e,n,t,r),e=Pm(null,e,n,!0,s,r)):(e.tag=0,gr&&s&&Gx(e),ti(null,e,i,r),e=e.child),e;case 16:n=e.elementType;e:{switch(Kd(t,e),t=e.pendingProps,i=n._init,n=i(n._payload),e.type=n,i=e.tag=yb(n),t=Ts(n,t),i){case 0:e=Dm(null,e,n,t,r);break e;case 1:e=s_(null,e,n,t,r);break e;case 11:e=n_(null,e,n,t,r);break e;case 14:e=i_(null,e,n,Ts(n.type,t),r);break e}throw Error(De(306,n,""))}return e;case 0:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Ts(n,i),Dm(t,e,n,i,r);case 1:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Ts(n,i),s_(t,e,n,i,r);case 3:e:{if(jT(e),t===null)throw Error(De(387));n=e.pendingProps,s=e.memoizedState,i=s.element,dT(t,e),Eh(e,n,null,r);var a=e.memoizedState;if(n=a.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=Hc(Error(De(423)),e),e=a_(t,e,n,r,i);break e}else if(n!==i){i=Hc(Error(De(424)),e),e=a_(t,e,n,r,i);break e}else for(Ni=vo(e.stateNode.containerInfo.firstChild),Di=e,gr=!0,ks=null,r=uT(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(zc(),n===i){e=Fa(t,e,r);break e}ti(t,e,n,r)}e=e.child}return e;case 5:return hT(e),t===null&&Fm(e),n=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,a=i.children,Tm(n,i)?a=null:s!==null&&Tm(n,s)&&(e.flags|=32),BT(t,e),ti(t,e,a,r),e.child;case 6:return t===null&&Fm(e),null;case 13:return VT(t,e,r);case 4:return e1(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=Wc(e,null,n,r):ti(t,e,n,r),e.child;case 11:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Ts(n,i),n_(t,e,n,i,r);case 7:return ti(t,e,e.pendingProps,r),e.child;case 8:return ti(t,e,e.pendingProps.children,r),e.child;case 12:return ti(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,i=e.pendingProps,s=e.memoizedProps,a=i.value,rr(yh,n._currentValue),n._currentValue=a,s!==null)if(Ds(s.value,a)){if(s.children===i.children&&!xi.current){e=Fa(t,e,r);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var o=s.dependencies;if(o!==null){a=s.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(s.tag===1){l=_a(-1,r&-r),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var d=c.pending;d===null?l.next=l:(l.next=d.next,d.next=l),c.pending=l}}s.lanes|=r,l=s.alternate,l!==null&&(l.lanes|=r),Im(s.return,r,e),o.lanes|=r;break}l=l.next}}else if(s.tag===10)a=s.type===e.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(De(341));a.lanes|=r,o=a.alternate,o!==null&&(o.lanes|=r),Im(a,r,e),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===e){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}ti(t,e,i.children,r),e=e.child}return e;case 9:return i=e.type,n=e.pendingProps.children,bc(e,r),i=os(i),n=n(i),e.flags|=1,ti(t,e,n,r),e.child;case 14:return n=e.type,i=Ts(n,e.pendingProps),i=Ts(n.type,i),i_(t,e,n,i,r);case 15:return MT(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Ts(n,i),Kd(t,e),e.tag=1,vi(n)?(t=!0,mh(e)):t=!1,bc(e,r),DT(e,n,i),Rm(e,n,i,r),Pm(null,e,n,!0,t,r);case 19:return UT(t,e,r);case 22:return LT(t,e,r)}throw Error(De(156,e.tag))};function nS(t,e){return bw(t,e)}function vb(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function is(t,e,r,n){return new vb(t,e,r,n)}function g1(t){return t=t.prototype,!(!t||!t.isReactComponent)}function yb(t){if(typeof t=="function")return g1(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Px)return 11;if(t===Ox)return 14}return 2}function wo(t,e){var r=t.alternate;return r===null?(r=is(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function Yd(t,e,r,n,i,s){var a=2;if(n=t,typeof t=="function")g1(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case dc:return fl(r.children,i,s,e);case Dx:a=8,i|=8;break;case tm:return t=is(12,r,e,i|2),t.elementType=tm,t.lanes=s,t;case rm:return t=is(13,r,e,i),t.elementType=rm,t.lanes=s,t;case nm:return t=is(19,r,e,i),t.elementType=nm,t.lanes=s,t;case hw:return xp(r,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case fw:a=10;break e;case dw:a=9;break e;case Px:a=11;break e;case Ox:a=14;break e;case eo:a=16,n=null;break e}throw Error(De(130,t==null?t:typeof t,""))}return e=is(a,r,e,i),e.elementType=t,e.type=n,e.lanes=s,e}function fl(t,e,r,n){return t=is(7,t,n,e),t.lanes=r,t}function xp(t,e,r,n){return t=is(22,t,n,e),t.elementType=hw,t.lanes=r,t.stateNode={isHidden:!1},t}function vg(t,e,r){return t=is(6,t,null,e),t.lanes=r,t}function yg(t,e,r){return e=is(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function _b(t,e,r,n,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Zp(0),this.expirationTimes=Zp(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Zp(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function m1(t,e,r,n,i,s,a,o,l){return t=new _b(t,e,r,o,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=is(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Zx(s),t}function Eb(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:fc,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function iS(t){if(!t)return Io;t=t._reactInternals;e:{if(Ol(t)!==t||t.tag!==1)throw Error(De(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(vi(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(De(171))}if(t.tag===1){var r=t.type;if(vi(r))return iT(t,r,e)}return e}function sS(t,e,r,n,i,s,a,o,l){return t=m1(r,n,!0,t,i,s,a,o,l),t.context=iS(null),r=t.current,n=ii(),i=Eo(r),s=_a(n,i),s.callback=e??null,yo(r,s,i),t.current.lanes=i,l0(t,i,n),yi(t,n),t}function vp(t,e,r,n){var i=e.current,s=ii(),a=Eo(i);return r=iS(r),e.context===null?e.context=r:e.pendingContext=r,e=_a(s,a),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=yo(i,e,a),t!==null&&(bs(t,i,a,s),$d(t,i,a)),a}function Ih(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function m_(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function x1(t,e){m_(t,e),(t=t.alternate)&&m_(t,e)}function wb(){return null}var aS=typeof reportError=="function"?reportError:function(t){console.error(t)};function v1(t){this._internalRoot=t}yp.prototype.render=v1.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(De(409));vp(t,e,null,null)};yp.prototype.unmount=v1.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;wl(function(){vp(null,t,null,null)}),e[Aa]=null}};function yp(t){this._internalRoot=t}yp.prototype.unstable_scheduleHydration=function(t){if(t){var e=Lw();t={blockedOn:null,target:t,priority:e};for(var r=0;r<ro.length&&e!==0&&e<ro[r].priority;r++);ro.splice(r,0,t),r===0&&jw(t)}};function y1(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function _p(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function x_(){}function Tb(t,e,r,n,i){if(i){if(typeof n=="function"){var s=n;n=function(){var c=Ih(a);s.call(c)}}var a=sS(e,n,t,0,null,!1,!1,"",x_);return t._reactRootContainer=a,t[Aa]=a.current,Ff(t.nodeType===8?t.parentNode:t),wl(),a}for(;i=t.lastChild;)t.removeChild(i);if(typeof n=="function"){var o=n;n=function(){var c=Ih(l);o.call(c)}}var l=m1(t,0,!1,null,null,!1,!1,"",x_);return t._reactRootContainer=l,t[Aa]=l.current,Ff(t.nodeType===8?t.parentNode:t),wl(function(){vp(e,l,r,n)}),l}function Ep(t,e,r,n,i){var s=r._reactRootContainer;if(s){var a=s;if(typeof i=="function"){var o=i;i=function(){var l=Ih(a);o.call(l)}}vp(e,a,t,i)}else a=Tb(r,e,t,i,n);return Ih(a)}Ow=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=zu(e.pendingLanes);r!==0&&(Bx(e,r|1),yi(e,Or()),!(Dt&6)&&(Gc=Or()+500,jo()))}break;case 13:wl(function(){var n=Ca(t,1);if(n!==null){var i=ii();bs(n,t,1,i)}}),x1(t,1)}};jx=function(t){if(t.tag===13){var e=Ca(t,134217728);if(e!==null){var r=ii();bs(e,t,134217728,r)}x1(t,134217728)}};Mw=function(t){if(t.tag===13){var e=Eo(t),r=Ca(t,e);if(r!==null){var n=ii();bs(r,t,e,n)}x1(t,e)}};Lw=function(){return qt};Bw=function(t,e){var r=qt;try{return qt=t,e()}finally{qt=r}};hm=function(t,e,r){switch(e){case"input":if(am(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var i=fp(n);if(!i)throw Error(De(90));gw(n),am(n,i)}}}break;case"textarea":xw(t,r);break;case"select":e=r.value,e!=null&&Ac(t,!!r.multiple,e,!1)}};Sw=d1;kw=wl;var Sb={usingClientEntryPoint:!1,Events:[u0,mc,fp,ww,Tw,d1]},Pu={findFiberByHostInstance:sl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},kb={bundleType:Pu.bundleType,version:Pu.version,rendererPackageName:Pu.rendererPackageName,rendererConfig:Pu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Oa.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Fw(t),t===null?null:t.stateNode},findFiberByHostInstance:Pu.findFiberByHostInstance||wb,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var md=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!md.isDisabled&&md.supportsFiber)try{op=md.inject(kb),Xs=md}catch{}}Li.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Sb;Li.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!y1(e))throw Error(De(200));return Eb(t,e,null,r)};Li.createRoot=function(t,e){if(!y1(t))throw Error(De(299));var r=!1,n="",i=aS;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=m1(t,1,!1,null,null,r,!1,n,i),t[Aa]=e.current,Ff(t.nodeType===8?t.parentNode:t),new v1(e)};Li.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(De(188)):(t=Object.keys(t).join(","),Error(De(268,t)));return t=Fw(e),t=t===null?null:t.stateNode,t};Li.flushSync=function(t){return wl(t)};Li.hydrate=function(t,e,r){if(!_p(e))throw Error(De(200));return Ep(null,t,e,!0,r)};Li.hydrateRoot=function(t,e,r){if(!y1(t))throw Error(De(405));var n=r!=null&&r.hydratedSources||null,i=!1,s="",a=aS;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(a=r.onRecoverableError)),e=sS(e,null,t,1,r??null,i,!1,s,a),t[Aa]=e.current,Ff(t),n)for(t=0;t<n.length;t++)r=n[t],i=r._getVersion,i=i(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,i]:e.mutableSourceEagerHydrationData.push(r,i);return new yp(e)};Li.render=function(t,e,r){if(!_p(e))throw Error(De(200));return Ep(null,t,e,!1,r)};Li.unmountComponentAtNode=function(t){if(!_p(t))throw Error(De(40));return t._reactRootContainer?(wl(function(){Ep(null,null,t,!1,function(){t._reactRootContainer=null,t[Aa]=null})}),!0):!1};Li.unstable_batchedUpdates=d1;Li.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!_p(r))throw Error(De(200));if(t==null||t._reactInternals===void 0)throw Error(De(38));return Ep(t,e,r,!1,n)};Li.version="18.3.1-next-f1338f8080-20240426";function oS(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(oS)}catch(t){console.error(t)}}oS(),ow.exports=Li;var Ab=ow.exports,v_=Ab;Zg.createRoot=v_.createRoot,Zg.hydrateRoot=v_.hydrateRoot;/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var bh={};bh.version="0.18.5";var lS=1252,Cb=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],_1={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},E1=function(t){Cb.indexOf(t)!=-1&&(lS=_1[0]=t)};function Fb(){E1(1252)}var As=function(t){E1(t)};function w1(){As(1200),Fb()}function y_(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function Ib(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function cS(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var $u=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?Ib(t.slice(2)):e==254&&r==255?cS(t.slice(2)):e==65279?t.slice(1):t},xd=function(e){return String.fromCharCode(e)},__=function(e){return String.fromCharCode(e)},Lf,uo="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Bf(t){for(var e="",r=0,n=0,i=0,s=0,a=0,o=0,l=0,c=0;c<t.length;)r=t.charCodeAt(c++),s=r>>2,n=t.charCodeAt(c++),a=(r&3)<<4|n>>4,i=t.charCodeAt(c++),o=(n&15)<<2|i>>6,l=i&63,isNaN(n)?o=l=64:isNaN(i)&&(l=64),e+=uo.charAt(s)+uo.charAt(a)+uo.charAt(o)+uo.charAt(l);return e}function Mi(t){var e="",r=0,n=0,i=0,s=0,a=0,o=0,l=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<t.length;)s=uo.indexOf(t.charAt(c++)),a=uo.indexOf(t.charAt(c++)),r=s<<2|a>>4,e+=String.fromCharCode(r),o=uo.indexOf(t.charAt(c++)),n=(a&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(n)),l=uo.indexOf(t.charAt(c++)),i=(o&3)<<6|l,l!==64&&(e+=String.fromCharCode(i));return e}var vt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Ma=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function bo(t){return vt?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function E_(t){return vt?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var bi=function(e){return vt?Ma(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function wp(t){if(typeof ArrayBuffer>"u")return bi(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n!=t.length;++n)r[n]=t.charCodeAt(n)&255;return e}function Vo(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function bb(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}function T1(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return T1(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var ln=vt?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:Ma(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),i=0;for(e=0,r=0;e<t.length;r+=i,++e)if(i=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function Rb(t){for(var e=[],r=0,n=t.length+250,i=bo(t.length+255),s=0;s<t.length;++s){var a=t.charCodeAt(s);if(a<128)i[r++]=a;else if(a<2048)i[r++]=192|a>>6&31,i[r++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=t.charCodeAt(++s)&1023;i[r++]=240|a>>8&7,i[r++]=128|a>>2&63,i[r++]=128|o>>6&15|(a&3)<<4,i[r++]=128|o&63}else i[r++]=224|a>>12&15,i[r++]=128|a>>6&63,i[r++]=128|a&63;r>n&&(e.push(i.slice(0,r)),r=0,i=bo(65535),n=65530)}return e.push(i.slice(0,r)),ln(e)}var si=/\u0000/g,Hu=/[\u0001-\u0006]/g;function Nc(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function Cs(t,e){var r=""+t;return r.length>=e?r:Ir("0",e-r.length)+r}function S1(t,e){var r=""+t;return r.length>=e?r:Ir(" ",e-r.length)+r}function Rh(t,e){var r=""+t;return r.length>=e?r:r+Ir(" ",e-r.length)}function Nb(t,e){var r=""+Math.round(t);return r.length>=e?r:Ir("0",e-r.length)+r}function Db(t,e){var r=""+t;return r.length>=e?r:Ir("0",e-r.length)+r}var w_=Math.pow(2,32);function ic(t,e){if(t>w_||t<-w_)return Nb(t,e);var r=Math.round(t);return Db(r,e)}function Nh(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var T_=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],_g=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Pb(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var it={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},S_={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Ob={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Dh(t,e,r){for(var n=t<0?-1:1,i=t*n,s=0,a=1,o=0,l=1,c=0,d=0,h=Math.floor(i);c<e&&(h=Math.floor(i),o=h*a+s,d=h*c+l,!(i-h<5e-8));)i=1/(i-h),s=a,a=o,l=c,c=d;if(d>e&&(c>e?(d=l,o=s):(d=c,o=a)),!r)return[0,n*o,d];var p=Math.floor(n*o/d);return[p,n*o-p*d,d]}function ll(t,e,r){if(t>2958465||t<0)return null;var n=t|0,i=Math.floor(86400*(t-n)),s=0,a=[],o={D:n,T:i,u:86400*(t-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++n,++o.D)),n===60)a=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)a=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),a=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),n<60&&(s=(s+6)%7),r&&(s=Ub(l,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=s,o}var uS=new Date(1899,11,31,0,0,0),Mb=uS.getTime(),Lb=new Date(1900,2,1,0,0,0);function fS(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=Lb&&(r+=24*60*60*1e3),(r-(Mb+(t.getTimezoneOffset()-uS.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function k1(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Bb(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function jb(t){var e=t<0?12:11,r=k1(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function Vb(t){var e=k1(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function jf(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=jb(t):e===10?r=t.toFixed(10).substr(0,12):r=Vb(t),k1(Bb(r.toUpperCase()))}function Tl(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):jf(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return cs(14,fS(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function Ub(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function zb(t,e,r,n){var i="",s=0,a=0,o=r.y,l,c=0;switch(t){case 98:o=r.y+543;case 121:switch(e.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(e.length){case 1:case 2:l=r.m,c=e.length;break;case 3:return _g[r.m-1][1];case 5:return _g[r.m-1][0];default:return _g[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:l=r.d,c=e.length;break;case 3:return T_[r.q][0];default:return T_[r.q][1]}break;case 104:switch(e.length){case 1:case 2:l=1+(r.H+11)%12,c=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:l=r.H,c=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:l=r.M,c=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?Cs(r.S,e.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,s=Math.round(a*(r.S+r.u)),s>=60*a&&(s=0),e==="s"?s===0?"0":""+s/a:(i=Cs(s,2+n),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}c=e.length===3?1:2;break;case 101:l=o,c=1;break}var d=c>0?Cs(l,c):"";return d}function fo(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var dS=/%/g;function Wb(t,e,r){var n=e.replace(dS,""),i=e.length-n.length;return Ea(t,n,r*Math.pow(10,2*i))+Ir("%",i)}function $b(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Ea(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function hS(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+hS(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),r.indexOf("e")===-1){var a=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,d){return l+c+d.substr(0,(i+s)%i)+"."+d.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var pS=/# (\?+)( ?)\/( ?)(\d+)/;function Hb(t,e,r){var n=parseInt(t[4],10),i=Math.round(e*n),s=Math.floor(i/n),a=i-s*n,o=n;return r+(s===0?"":""+s)+" "+(a===0?Ir(" ",t[1].length+1+t[4].length):S1(a,t[1].length)+t[2]+"/"+t[3]+Cs(o,t[4].length))}function Gb(t,e,r){return r+(e===0?"":""+e)+Ir(" ",t[1].length+2+t[4].length)}var gS=/^#*0*\.([0#]+)/,mS=/\).*[0#]/,xS=/\(###\) ###\\?-####/;function ri(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function k_(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function A_(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function Kb(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function Xb(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Yi(t,e,r){if(t.charCodeAt(0)===40&&!e.match(mS)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Yi("n",n,r):"("+Yi("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return $b(t,e,r);if(e.indexOf("%")!==-1)return Wb(t,e,r);if(e.indexOf("E")!==-1)return hS(e,r);if(e.charCodeAt(0)===36)return"$"+Yi(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),c=r<0?"-":"";if(e.match(/^00+$/))return c+ic(l,e.length);if(e.match(/^[#?]+$/))return i=ic(r,0),i==="0"&&(i=""),i.length>e.length?i:ri(e.substr(0,e.length-i.length))+i;if(s=e.match(pS))return Hb(s,l,c);if(e.match(/^#+0+$/))return c+ic(l,e.length-e.indexOf("0"));if(s=e.match(gS))return i=k_(r,s[1].length).replace(/^([^\.]+)$/,"$1."+ri(s[1])).replace(/\.$/,"."+ri(s[1])).replace(/\.(\d*)$/,function(y,x){return"."+x+Ir("0",ri(s[1]).length-x.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return c+k_(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return c+fo(ic(l,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Yi(t,e,-r):fo(""+(Math.floor(r)+Kb(r,s[1].length)))+"."+Cs(A_(r,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return Yi(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Nc(Yi(t,e.replace(/[\\-]/g,""),r)),a=0,Nc(Nc(e.replace(/\\/g,"")).replace(/[0#]/g,function(y){return a<i.length?i.charAt(a++):y==="0"?"0":""}));if(e.match(xS))return i=Yi(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=Dh(l,Math.pow(10,a)-1,!1),i=""+c,d=Ea("n",s[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),i+=d+s[2]+"/"+s[3],d=Rh(o[2],a),d.length<s[4].length&&(d=ri(s[4].substr(s[4].length-d.length))+d),i+=d,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=Dh(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?S1(o[1],a)+s[2]+"/"+s[3]+Rh(o[2],a):Ir(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=ic(r,0),e.length<=i.length?i:ri(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var h=e.indexOf(".")-a,p=e.length-i.length-h;return ri(e.substr(0,h)+i+e.substr(e.length-p))}if(s=e.match(/^00,000\.([#0]*0)$/))return a=A_(r,s[1].length),r<0?"-"+Yi(t,e,-r):fo(Xb(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?Cs(0,3-y.length):"")+y})+"."+Cs(a,s[1].length);switch(e){case"###,##0.00":return Yi(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var m=fo(ic(l,0));return m!=="0"?c+m:"";case"###,###.00":return Yi(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Yi(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function qb(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Ea(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function Yb(t,e,r){var n=e.replace(dS,""),i=e.length-n.length;return Ea(t,n,r*Math.pow(10,2*i))+Ir("%",i)}function vS(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+vS(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!r.match(/[Ee]/)){var a=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,d){return l+c+d.substr(0,(i+s)%i)+"."+d.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Ws(t,e,r){if(t.charCodeAt(0)===40&&!e.match(mS)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ws("n",n,r):"("+Ws("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return qb(t,e,r);if(e.indexOf("%")!==-1)return Yb(t,e,r);if(e.indexOf("E")!==-1)return vS(e,r);if(e.charCodeAt(0)===36)return"$"+Ws(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),c=r<0?"-":"";if(e.match(/^00+$/))return c+Cs(l,e.length);if(e.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>e.length?i:ri(e.substr(0,e.length-i.length))+i;if(s=e.match(pS))return Gb(s,l,c);if(e.match(/^#+0+$/))return c+Cs(l,e.length-e.indexOf("0"));if(s=e.match(gS))return i=(""+r).replace(/^([^\.]+)$/,"$1."+ri(s[1])).replace(/\.$/,"."+ri(s[1])),i=i.replace(/\.(\d*)$/,function(y,x){return"."+x+Ir("0",ri(s[1]).length-x.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return c+fo(""+l);if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ws(t,e,-r):fo(""+r)+"."+Ir("0",s[1].length);if(s=e.match(/^#,#*,#0/))return Ws(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Nc(Ws(t,e.replace(/[\\-]/g,""),r)),a=0,Nc(Nc(e.replace(/\\/g,"")).replace(/[0#]/g,function(y){return a<i.length?i.charAt(a++):y==="0"?"0":""}));if(e.match(xS))return i=Ws(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=Dh(l,Math.pow(10,a)-1,!1),i=""+c,d=Ea("n",s[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),i+=d+s[2]+"/"+s[3],d=Rh(o[2],a),d.length<s[4].length&&(d=ri(s[4].substr(s[4].length-d.length))+d),i+=d,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=Dh(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?S1(o[1],a)+s[2]+"/"+s[3]+Rh(o[2],a):Ir(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=""+r,e.length<=i.length?i:ri(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var h=e.indexOf(".")-a,p=e.length-i.length-h;return ri(e.substr(0,h)+i+e.substr(e.length-p))}if(s=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Ws(t,e,-r):fo(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?Cs(0,3-y.length):"")+y})+"."+Cs(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var m=fo(""+l);return m!=="0"?c+m:"";default:if(e.match(/\.[0#?]*$/))return Ws(t,e.slice(0,e.lastIndexOf(".")),r)+ri(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Ea(t,e,r){return(r|0)===r?Ws(t,e,r):Yi(t,e,r)}function Qb(t){for(var e=[],r=!1,n=0,i=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(i,n-i),i=n+1}if(e[e.length]=t.substr(i),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var yS=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function lu(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":Nh(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(yS))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function Jb(t,e,r,n){for(var i=[],s="",a=0,o="",l="t",c,d,h,p="H";a<t.length;)switch(o=t.charAt(a)){case"G":if(!Nh(t,a))throw new Error("unrecognized character "+o+" in "+t);i[i.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(h=t.charCodeAt(++a))!==34&&a<t.length;)s+=String.fromCharCode(h);i[i.length]={t:"t",v:s},++a;break;case"\\":var m=t.charAt(++a),y=m==="("||m===")"?m:"t";i[i.length]={t:y,v:m},++a;break;case"_":i[i.length]={t:"t",v:" "},a+=2;break;case"@":i[i.length]={t:"T",v:e},++a;break;case"B":case"b":if(t.charAt(a+1)==="1"||t.charAt(a+1)==="2"){if(c==null&&(c=ll(e,r,t.charAt(a+1)==="2"),c==null))return"";i[i.length]={t:"X",v:t.substr(a,2)},l=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||c==null&&(c=ll(e,r),c==null))return"";for(s=o;++a<t.length&&t.charAt(a).toLowerCase()===o;)s+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=p),i[i.length]={t:o,v:s},l=o;break;case"A":case"a":case"":var x={t:o,v:o};if(c==null&&(c=ll(e,r)),t.substr(a,3).toUpperCase()==="A/P"?(c!=null&&(x.v=c.H>=12?"P":"A"),x.t="T",p="h",a+=3):t.substr(a,5).toUpperCase()==="AM/PM"?(c!=null&&(x.v=c.H>=12?"PM":"AM"),x.t="T",a+=5,p="h"):t.substr(a,5).toUpperCase()==="/"?(c!=null&&(x.v=c.H>=12?"":""),x.t="T",a+=5,p="h"):(x.t="t",++a),c==null&&x.t==="T")return"";i[i.length]=x,l=o;break;case"[":for(s=o;t.charAt(a++)!=="]"&&a<t.length;)s+=t.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(yS)){if(c==null&&(c=ll(e,r),c==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",lu(t)||(i[i.length]={t:"t",v:s}));break;case".":if(c!=null){for(s=o;++a<t.length&&(o=t.charAt(a))==="0";)s+=o;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++a<t.length&&"0#?.,E+-%".indexOf(o=t.charAt(a))>-1;)s+=o;i[i.length]={t:"n",v:s};break;case"?":for(s=o;t.charAt(++a)===o;)s+=o;i[i.length]={t:o,v:s},l=o;break;case"*":++a,(t.charAt(a)==" "||t.charAt(a)=="*")&&++a;break;case"(":case")":i[i.length]={t:n===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;a<t.length&&"0123456789".indexOf(t.charAt(++a))>-1;)s+=t.charAt(a);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:o,v:o},++a;break;case"$":i[i.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+t);i[i.length]={t:"t",v:o},++a;break}var E=0,T=0,k;for(a=i.length-1,l="t";a>=0;--a)switch(i[a].t){case"h":case"H":i[a].t=p,l="h",E<1&&(E=1);break;case"s":(k=i[a].v.match(/\.0+$/))&&(T=Math.max(T,k[0].length-1)),E<3&&(E=3);case"d":case"y":case"M":case"e":l=i[a].t;break;case"m":l==="s"&&(i[a].t="M",E<2&&(E=2));break;case"X":break;case"Z":E<1&&i[a].v.match(/[Hh]/)&&(E=1),E<2&&i[a].v.match(/[Mm]/)&&(E=2),E<3&&i[a].v.match(/[Ss]/)&&(E=3)}switch(E){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var _="",P;for(a=0;a<i.length;++a)switch(i[a].t){case"t":case"T":case" ":case"D":break;case"X":i[a].v="",i[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[a].v=zb(i[a].t.charCodeAt(0),i[a].v,c,T),i[a].t="t";break;case"n":case"?":for(P=a+1;i[P]!=null&&((o=i[P].t)==="?"||o==="D"||(o===" "||o==="t")&&i[P+1]!=null&&(i[P+1].t==="?"||i[P+1].t==="t"&&i[P+1].v==="/")||i[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[P].v==="/"||i[P].v===" "&&i[P+1]!=null&&i[P+1].t=="?"));)i[a].v+=i[P].v,i[P]={v:"",t:";"},++P;_+=i[a].v,a=P-1;break;case"G":i[a].t="t",i[a].v=Tl(e,r);break}var W="",B,w;if(_.length>0){_.charCodeAt(0)==40?(B=e<0&&_.charCodeAt(0)===45?-e:e,w=Ea("n",_,B)):(B=e<0&&n>1?-e:e,w=Ea("n",_,B),B<0&&i[0]&&i[0].t=="t"&&(w=w.substr(1),i[0].v="-"+i[0].v)),P=w.length-1;var C=i.length;for(a=0;a<i.length;++a)if(i[a]!=null&&i[a].t!="t"&&i[a].v.indexOf(".")>-1){C=a;break}var S=i.length;if(C===i.length&&w.indexOf("E")===-1){for(a=i.length-1;a>=0;--a)i[a]==null||"n?".indexOf(i[a].t)===-1||(P>=i[a].v.length-1?(P-=i[a].v.length,i[a].v=w.substr(P+1,i[a].v.length)):P<0?i[a].v="":(i[a].v=w.substr(0,P+1),P=-1),i[a].t="t",S=a);P>=0&&S<i.length&&(i[S].v=w.substr(0,P+1)+i[S].v)}else if(C!==i.length&&w.indexOf("E")===-1){for(P=w.indexOf(".")-1,a=C;a>=0;--a)if(!(i[a]==null||"n?".indexOf(i[a].t)===-1)){for(d=i[a].v.indexOf(".")>-1&&a===C?i[a].v.indexOf(".")-1:i[a].v.length-1,W=i[a].v.substr(d+1);d>=0;--d)P>=0&&(i[a].v.charAt(d)==="0"||i[a].v.charAt(d)==="#")&&(W=w.charAt(P--)+W);i[a].v=W,i[a].t="t",S=a}for(P>=0&&S<i.length&&(i[S].v=w.substr(0,P+1)+i[S].v),P=w.indexOf(".")+1,a=C;a<i.length;++a)if(!(i[a]==null||"n?(".indexOf(i[a].t)===-1&&a!==C)){for(d=i[a].v.indexOf(".")>-1&&a===C?i[a].v.indexOf(".")+1:0,W=i[a].v.substr(0,d);d<i[a].v.length;++d)P<w.length&&(W+=w.charAt(P++));i[a].v=W,i[a].t="t",S=a}}}for(a=0;a<i.length;++a)i[a]!=null&&"n?".indexOf(i[a].t)>-1&&(B=n>1&&e<0&&a>0&&i[a-1].v==="-"?-e:e,i[a].v=Ea(i[a].t,i[a].v,B),i[a].t="t");var b="";for(a=0;a!==i.length;++a)i[a]!=null&&(b+=i[a].v);return b}var C_=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function F_(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function Zb(t,e){var r=Qb(t),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var a=r[0].match(C_),o=r[1].match(C_);return F_(e,a)?[n,r[0]]:F_(e,o)?[n,r[1]]:[n,r[a!=null&&o!=null?2:1]]}return[n,s]}function cs(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:it)[t],n==null&&(n=r.table&&r.table[S_[t]]||it[S_[t]]),n==null&&(n=Ob[t]||"General");break}if(Nh(n,0))return Tl(e,r);e instanceof Date&&(e=fS(e,r.date1904));var i=Zb(n,e);if(Nh(i[1]))return Tl(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return Jb(i[1],e,r,i[0])}function wa(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(it[r]==null){e<0&&(e=r);continue}if(it[r]==t){e=r;break}}e<0&&(e=391)}return it[e]=t,e}function Tp(t){for(var e=0;e!=392;++e)t[e]!==void 0&&wa(t[e],e)}function cu(){it=Pb()}var eR={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},_S=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function tR(t){var e=typeof t=="number"?it[t]:t;return e=e.replace(_S,"(\\d+)"),new RegExp("^"+e+"$")}function rR(t,e,r){var n=-1,i=-1,s=-1,a=-1,o=-1,l=-1;(e.match(_S)||[]).forEach(function(h,p){var m=parseInt(r[p+1],10);switch(h.toLowerCase().charAt(0)){case"y":n=m;break;case"d":s=m;break;case"h":a=m;break;case"s":l=m;break;case"m":a>=0?o=m:i=m;break}}),l>=0&&o==-1&&i>=0&&(o=i,i=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var d=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return a==-1&&o==-1&&l==-1?c:n==-1&&i==-1&&s==-1?d:c+"T"+d}var nR=function(){var t={};t.version="1.2.0";function e(){for(var w=0,C=new Array(256),S=0;S!=256;++S)w=S,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,C[S]=w;return typeof Int32Array<"u"?new Int32Array(C):C}var r=e();function n(w){var C=0,S=0,b=0,N=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(b=0;b!=256;++b)N[b]=w[b];for(b=0;b!=256;++b)for(S=w[b],C=256+b;C<4096;C+=256)S=N[C]=S>>>8^w[S&255];var D=[];for(b=1;b!=16;++b)D[b-1]=typeof Int32Array<"u"?N.subarray(b*256,b*256+256):N.slice(b*256,b*256+256);return D}var i=n(r),s=i[0],a=i[1],o=i[2],l=i[3],c=i[4],d=i[5],h=i[6],p=i[7],m=i[8],y=i[9],x=i[10],E=i[11],T=i[12],k=i[13],_=i[14];function P(w,C){for(var S=C^-1,b=0,N=w.length;b<N;)S=S>>>8^r[(S^w.charCodeAt(b++))&255];return~S}function W(w,C){for(var S=C^-1,b=w.length-15,N=0;N<b;)S=_[w[N++]^S&255]^k[w[N++]^S>>8&255]^T[w[N++]^S>>16&255]^E[w[N++]^S>>>24]^x[w[N++]]^y[w[N++]]^m[w[N++]]^p[w[N++]]^h[w[N++]]^d[w[N++]]^c[w[N++]]^l[w[N++]]^o[w[N++]]^a[w[N++]]^s[w[N++]]^r[w[N++]];for(b+=15;N<b;)S=S>>>8^r[(S^w[N++])&255];return~S}function B(w,C){for(var S=C^-1,b=0,N=w.length,D=0,R=0;b<N;)D=w.charCodeAt(b++),D<128?S=S>>>8^r[(S^D)&255]:D<2048?(S=S>>>8^r[(S^(192|D>>6&31))&255],S=S>>>8^r[(S^(128|D&63))&255]):D>=55296&&D<57344?(D=(D&1023)+64,R=w.charCodeAt(b++)&1023,S=S>>>8^r[(S^(240|D>>8&7))&255],S=S>>>8^r[(S^(128|D>>2&63))&255],S=S>>>8^r[(S^(128|R>>6&15|(D&3)<<4))&255],S=S>>>8^r[(S^(128|R&63))&255]):(S=S>>>8^r[(S^(224|D>>12&15))&255],S=S>>>8^r[(S^(128|D>>6&63))&255],S=S>>>8^r[(S^(128|D&63))&255]);return~S}return t.table=r,t.bstr=P,t.buf=W,t.str=B,t}(),Ze=function(){var e={};e.version="1.2.1";function r(F,U){for(var L=F.split("/"),M=U.split("/"),z=0,V=0,le=Math.min(L.length,M.length);z<le;++z){if(V=L[z].length-M[z].length)return V;if(L[z]!=M[z])return L[z]<M[z]?-1:1}return L.length-M.length}function n(F){if(F.charAt(F.length-1)=="/")return F.slice(0,-1).indexOf("/")===-1?F:n(F.slice(0,-1));var U=F.lastIndexOf("/");return U===-1?F:F.slice(0,U+1)}function i(F){if(F.charAt(F.length-1)=="/")return i(F.slice(0,-1));var U=F.lastIndexOf("/");return U===-1?F:F.slice(U+1)}function s(F,U){typeof U=="string"&&(U=new Date(U));var L=U.getHours();L=L<<6|U.getMinutes(),L=L<<5|U.getSeconds()>>>1,F.write_shift(2,L);var M=U.getFullYear()-1980;M=M<<4|U.getMonth()+1,M=M<<5|U.getDate(),F.write_shift(2,M)}function a(F){var U=F.read_shift(2)&65535,L=F.read_shift(2)&65535,M=new Date,z=L&31;L>>>=5;var V=L&15;L>>>=4,M.setMilliseconds(0),M.setFullYear(L+1980),M.setMonth(V-1),M.setDate(z);var le=U&31;U>>>=5;var ie=U&63;return U>>>=6,M.setHours(U),M.setMinutes(ie),M.setSeconds(le<<1),M}function o(F){En(F,0);for(var U={},L=0;F.l<=F.length-4;){var M=F.read_shift(2),z=F.read_shift(2),V=F.l+z,le={};switch(M){case 21589:L=F.read_shift(1),L&1&&(le.mtime=F.read_shift(4)),z>5&&(L&2&&(le.atime=F.read_shift(4)),L&4&&(le.ctime=F.read_shift(4))),le.mtime&&(le.mt=new Date(le.mtime*1e3));break}F.l=V,U[M]=le}return U}var l;function c(){return l||(l={})}function d(F,U){if(F[0]==80&&F[1]==75)return aa(F,U);if((F[0]|32)==109&&(F[1]|32)==105)return er(F,U);if(F.length<512)throw new Error("CFB file size "+F.length+" < 512");var L=3,M=512,z=0,V=0,le=0,ie=0,oe=0,te=[],ce=F.slice(0,512);En(ce,0);var me=h(ce);switch(L=me[0],L){case 3:M=512;break;case 4:M=4096;break;case 0:if(me[1]==0)return aa(F,U);default:throw new Error("Major Version: Expected 3 or 4 saw "+L)}M!==512&&(ce=F.slice(0,M),En(ce,28));var Pe=F.slice(0,M);p(ce,L);var He=ce.read_shift(4,"i");if(L===3&&He!==0)throw new Error("# Directory Sectors: Expected 0 saw "+He);ce.l+=4,le=ce.read_shift(4,"i"),ce.l+=4,ce.chk("00100000","Mini Stream Cutoff Size: "),ie=ce.read_shift(4,"i"),z=ce.read_shift(4,"i"),oe=ce.read_shift(4,"i"),V=ce.read_shift(4,"i");for(var Ce=-1,ze=0;ze<109&&(Ce=ce.read_shift(4,"i"),!(Ce<0));++ze)te[ze]=Ce;var nt=m(F,M);E(oe,V,nt,M,te);var _t=k(nt,le,te,M);_t[le].name="!Directory",z>0&&ie!==R&&(_t[ie].name="!MiniFAT"),_t[te[0]].name="!FAT",_t.fat_addrs=te,_t.ssz=M;var kt={},Et=[],Jn=[],hn=[];_(le,_t,nt,Et,z,kt,Jn,ie),y(Jn,hn,Et),Et.shift();var Si={FileIndex:Jn,FullPaths:hn};return U&&U.raw&&(Si.raw={header:Pe,sectors:nt}),Si}function h(F){if(F[F.l]==80&&F[F.l+1]==75)return[0,0];F.chk(Ue,"Header Signature: "),F.l+=16;var U=F.read_shift(2,"u");return[F.read_shift(2,"u"),U]}function p(F,U){var L=9;switch(F.l+=2,L=F.read_shift(2)){case 9:if(U!=3)throw new Error("Sector Shift: Expected 9 saw "+L);break;case 12:if(U!=4)throw new Error("Sector Shift: Expected 12 saw "+L);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+L)}F.chk("0600","Mini Sector Shift: "),F.chk("000000000000","Reserved: ")}function m(F,U){for(var L=Math.ceil(F.length/U)-1,M=[],z=1;z<L;++z)M[z-1]=F.slice(z*U,(z+1)*U);return M[L-1]=F.slice(L*U),M}function y(F,U,L){for(var M=0,z=0,V=0,le=0,ie=0,oe=L.length,te=[],ce=[];M<oe;++M)te[M]=ce[M]=M,U[M]=L[M];for(;ie<ce.length;++ie)M=ce[ie],z=F[M].L,V=F[M].R,le=F[M].C,te[M]===M&&(z!==-1&&te[z]!==z&&(te[M]=te[z]),V!==-1&&te[V]!==V&&(te[M]=te[V])),le!==-1&&(te[le]=M),z!==-1&&M!=te[M]&&(te[z]=te[M],ce.lastIndexOf(z)<ie&&ce.push(z)),V!==-1&&M!=te[M]&&(te[V]=te[M],ce.lastIndexOf(V)<ie&&ce.push(V));for(M=1;M<oe;++M)te[M]===M&&(V!==-1&&te[V]!==V?te[M]=te[V]:z!==-1&&te[z]!==z&&(te[M]=te[z]));for(M=1;M<oe;++M)if(F[M].type!==0){if(ie=M,ie!=te[ie])do ie=te[ie],U[M]=U[ie]+"/"+U[M];while(ie!==0&&te[ie]!==-1&&ie!=te[ie]);te[M]=-1}for(U[0]+="/",M=1;M<oe;++M)F[M].type!==2&&(U[M]+="/")}function x(F,U,L){for(var M=F.start,z=F.size,V=[],le=M;L&&z>0&&le>=0;)V.push(U.slice(le*D,le*D+D)),z-=D,le=il(L,le*4);return V.length===0?pe(0):ln(V).slice(0,F.size)}function E(F,U,L,M,z){var V=R;if(F===R){if(U!==0)throw new Error("DIFAT chain shorter than expected")}else if(F!==-1){var le=L[F],ie=(M>>>2)-1;if(!le)return;for(var oe=0;oe<ie&&(V=il(le,oe*4))!==R;++oe)z.push(V);E(il(le,M-4),U-1,L,M,z)}}function T(F,U,L,M,z){var V=[],le=[];z||(z=[]);var ie=M-1,oe=0,te=0;for(oe=U;oe>=0;){z[oe]=!0,V[V.length]=oe,le.push(F[oe]);var ce=L[Math.floor(oe*4/M)];if(te=oe*4&ie,M<4+te)throw new Error("FAT boundary crossed: "+oe+" 4 "+M);if(!F[ce])break;oe=il(F[ce],te)}return{nodes:V,data:V_([le])}}function k(F,U,L,M){var z=F.length,V=[],le=[],ie=[],oe=[],te=M-1,ce=0,me=0,Pe=0,He=0;for(ce=0;ce<z;++ce)if(ie=[],Pe=ce+U,Pe>=z&&(Pe-=z),!le[Pe]){oe=[];var Ce=[];for(me=Pe;me>=0;){Ce[me]=!0,le[me]=!0,ie[ie.length]=me,oe.push(F[me]);var ze=L[Math.floor(me*4/M)];if(He=me*4&te,M<4+He)throw new Error("FAT boundary crossed: "+me+" 4 "+M);if(!F[ze]||(me=il(F[ze],He),Ce[me]))break}V[Pe]={nodes:ie,data:V_([oe])}}return V}function _(F,U,L,M,z,V,le,ie){for(var oe=0,te=M.length?2:0,ce=U[F].data,me=0,Pe=0,He;me<ce.length;me+=128){var Ce=ce.slice(me,me+128);En(Ce,64),Pe=Ce.read_shift(2),He=N1(Ce,0,Pe-te),M.push(He);var ze={name:He,type:Ce.read_shift(1),color:Ce.read_shift(1),L:Ce.read_shift(4,"i"),R:Ce.read_shift(4,"i"),C:Ce.read_shift(4,"i"),clsid:Ce.read_shift(16),state:Ce.read_shift(4,"i"),start:0,size:0},nt=Ce.read_shift(2)+Ce.read_shift(2)+Ce.read_shift(2)+Ce.read_shift(2);nt!==0&&(ze.ct=P(Ce,Ce.l-8));var _t=Ce.read_shift(2)+Ce.read_shift(2)+Ce.read_shift(2)+Ce.read_shift(2);_t!==0&&(ze.mt=P(Ce,Ce.l-8)),ze.start=Ce.read_shift(4,"i"),ze.size=Ce.read_shift(4,"i"),ze.size<0&&ze.start<0&&(ze.size=ze.type=0,ze.start=R,ze.name=""),ze.type===5?(oe=ze.start,z>0&&oe!==R&&(U[oe].name="!StreamData")):ze.size>=4096?(ze.storage="fat",U[ze.start]===void 0&&(U[ze.start]=T(L,ze.start,U.fat_addrs,U.ssz)),U[ze.start].name=ze.name,ze.content=U[ze.start].data.slice(0,ze.size)):(ze.storage="minifat",ze.size<0?ze.size=0:oe!==R&&ze.start!==R&&U[oe]&&(ze.content=x(ze,U[oe].data,(U[ie]||{}).data))),ze.content&&En(ze.content,0),V[He]=ze,le.push(ze)}}function P(F,U){return new Date((Ii(F,U+4)/1e7*Math.pow(2,32)+Ii(F,U)/1e7-11644473600)*1e3)}function W(F,U){return c(),d(l.readFileSync(F),U)}function B(F,U){var L=U&&U.type;switch(L||vt&&Buffer.isBuffer(F)&&(L="buffer"),L||"base64"){case"file":return W(F,U);case"base64":return d(bi(Mi(F)),U);case"binary":return d(bi(F),U)}return d(F,U)}function w(F,U){var L=U||{},M=L.root||"Root Entry";if(F.FullPaths||(F.FullPaths=[]),F.FileIndex||(F.FileIndex=[]),F.FullPaths.length!==F.FileIndex.length)throw new Error("inconsistent CFB structure");F.FullPaths.length===0&&(F.FullPaths[0]=M+"/",F.FileIndex[0]={name:M,type:5}),L.CLSID&&(F.FileIndex[0].clsid=L.CLSID),C(F)}function C(F){var U="Sh33tJ5";if(!Ze.find(F,"/"+U)){var L=pe(4);L[0]=55,L[1]=L[3]=50,L[2]=54,F.FileIndex.push({name:U,type:2,content:L,size:4,L:69,R:69,C:69}),F.FullPaths.push(F.FullPaths[0]+U),S(F)}}function S(F,U){w(F);for(var L=!1,M=!1,z=F.FullPaths.length-1;z>=0;--z){var V=F.FileIndex[z];switch(V.type){case 0:M?L=!0:(F.FileIndex.pop(),F.FullPaths.pop());break;case 1:case 2:case 5:M=!0,isNaN(V.R*V.L*V.C)&&(L=!0),V.R>-1&&V.L>-1&&V.R==V.L&&(L=!0);break;default:L=!0;break}}if(!(!L&&!U)){var le=new Date(1987,1,19),ie=0,oe=Object.create?Object.create(null):{},te=[];for(z=0;z<F.FullPaths.length;++z)oe[F.FullPaths[z]]=!0,F.FileIndex[z].type!==0&&te.push([F.FullPaths[z],F.FileIndex[z]]);for(z=0;z<te.length;++z){var ce=n(te[z][0]);M=oe[ce],M||(te.push([ce,{name:i(ce).replace("/",""),type:1,clsid:Fe,ct:le,mt:le,content:null}]),oe[ce]=!0)}for(te.sort(function(He,Ce){return r(He[0],Ce[0])}),F.FullPaths=[],F.FileIndex=[],z=0;z<te.length;++z)F.FullPaths[z]=te[z][0],F.FileIndex[z]=te[z][1];for(z=0;z<te.length;++z){var me=F.FileIndex[z],Pe=F.FullPaths[z];if(me.name=i(Pe).replace("/",""),me.L=me.R=me.C=-(me.color=1),me.size=me.content?me.content.length:0,me.start=0,me.clsid=me.clsid||Fe,z===0)me.C=te.length>1?1:-1,me.size=0,me.type=5;else if(Pe.slice(-1)=="/"){for(ie=z+1;ie<te.length&&n(F.FullPaths[ie])!=Pe;++ie);for(me.C=ie>=te.length?-1:ie,ie=z+1;ie<te.length&&n(F.FullPaths[ie])!=n(Pe);++ie);me.R=ie>=te.length?-1:ie,me.type=1}else n(F.FullPaths[z+1]||"")==n(Pe)&&(me.R=z+1),me.type=2}}}function b(F,U){var L=U||{};if(L.fileType=="mad")return fr(F,L);switch(S(F),L.fileType){case"zip":return Vi(F,L)}var M=function(He){for(var Ce=0,ze=0,nt=0;nt<He.FileIndex.length;++nt){var _t=He.FileIndex[nt];if(_t.content){var kt=_t.content.length;kt>0&&(kt<4096?Ce+=kt+63>>6:ze+=kt+511>>9)}}for(var Et=He.FullPaths.length+3>>2,Jn=Ce+7>>3,hn=Ce+127>>7,Si=Jn+ze+Et+hn,pn=Si+127>>7,ki=pn<=109?0:Math.ceil((pn-109)/127);Si+pn+ki+127>>7>pn;)ki=++pn<=109?0:Math.ceil((pn-109)/127);var gn=[1,ki,pn,hn,Et,ze,Ce,0];return He.FileIndex[0].size=Ce<<6,gn[7]=(He.FileIndex[0].start=gn[0]+gn[1]+gn[2]+gn[3]+gn[4]+gn[5])+(gn[6]+7>>3),gn}(F),z=pe(M[7]<<9),V=0,le=0;{for(V=0;V<8;++V)z.write_shift(1,ge[V]);for(V=0;V<8;++V)z.write_shift(2,0);for(z.write_shift(2,62),z.write_shift(2,3),z.write_shift(2,65534),z.write_shift(2,9),z.write_shift(2,6),V=0;V<3;++V)z.write_shift(2,0);for(z.write_shift(4,0),z.write_shift(4,M[2]),z.write_shift(4,M[0]+M[1]+M[2]+M[3]-1),z.write_shift(4,0),z.write_shift(4,4096),z.write_shift(4,M[3]?M[0]+M[1]+M[2]-1:R),z.write_shift(4,M[3]),z.write_shift(-4,M[1]?M[0]-1:R),z.write_shift(4,M[1]),V=0;V<109;++V)z.write_shift(-4,V<M[2]?M[1]+V:-1)}if(M[1])for(le=0;le<M[1];++le){for(;V<236+le*127;++V)z.write_shift(-4,V<M[2]?M[1]+V:-1);z.write_shift(-4,le===M[1]-1?R:le+1)}var ie=function(He){for(le+=He;V<le-1;++V)z.write_shift(-4,V+1);He&&(++V,z.write_shift(-4,R))};for(le=V=0,le+=M[1];V<le;++V)z.write_shift(-4,Ee.DIFSECT);for(le+=M[2];V<le;++V)z.write_shift(-4,Ee.FATSECT);ie(M[3]),ie(M[4]);for(var oe=0,te=0,ce=F.FileIndex[0];oe<F.FileIndex.length;++oe)ce=F.FileIndex[oe],ce.content&&(te=ce.content.length,!(te<4096)&&(ce.start=le,ie(te+511>>9)));for(ie(M[6]+7>>3);z.l&511;)z.write_shift(-4,Ee.ENDOFCHAIN);for(le=V=0,oe=0;oe<F.FileIndex.length;++oe)ce=F.FileIndex[oe],ce.content&&(te=ce.content.length,!(!te||te>=4096)&&(ce.start=le,ie(te+63>>6)));for(;z.l&511;)z.write_shift(-4,Ee.ENDOFCHAIN);for(V=0;V<M[4]<<2;++V){var me=F.FullPaths[V];if(!me||me.length===0){for(oe=0;oe<17;++oe)z.write_shift(4,0);for(oe=0;oe<3;++oe)z.write_shift(4,-1);for(oe=0;oe<12;++oe)z.write_shift(4,0);continue}ce=F.FileIndex[V],V===0&&(ce.start=ce.size?ce.start-1:R);var Pe=V===0&&L.root||ce.name;if(te=2*(Pe.length+1),z.write_shift(64,Pe,"utf16le"),z.write_shift(2,te),z.write_shift(1,ce.type),z.write_shift(1,ce.color),z.write_shift(-4,ce.L),z.write_shift(-4,ce.R),z.write_shift(-4,ce.C),ce.clsid)z.write_shift(16,ce.clsid,"hex");else for(oe=0;oe<4;++oe)z.write_shift(4,0);z.write_shift(4,ce.state||0),z.write_shift(4,0),z.write_shift(4,0),z.write_shift(4,0),z.write_shift(4,0),z.write_shift(4,ce.start),z.write_shift(4,ce.size),z.write_shift(4,0)}for(V=1;V<F.FileIndex.length;++V)if(ce=F.FileIndex[V],ce.size>=4096)if(z.l=ce.start+1<<9,vt&&Buffer.isBuffer(ce.content))ce.content.copy(z,z.l,0,ce.size),z.l+=ce.size+511&-512;else{for(oe=0;oe<ce.size;++oe)z.write_shift(1,ce.content[oe]);for(;oe&511;++oe)z.write_shift(1,0)}for(V=1;V<F.FileIndex.length;++V)if(ce=F.FileIndex[V],ce.size>0&&ce.size<4096)if(vt&&Buffer.isBuffer(ce.content))ce.content.copy(z,z.l,0,ce.size),z.l+=ce.size+63&-64;else{for(oe=0;oe<ce.size;++oe)z.write_shift(1,ce.content[oe]);for(;oe&63;++oe)z.write_shift(1,0)}if(vt)z.l=z.length;else for(;z.l<z.length;)z.write_shift(1,0);return z}function N(F,U){var L=F.FullPaths.map(function(oe){return oe.toUpperCase()}),M=L.map(function(oe){var te=oe.split("/");return te[te.length-(oe.slice(-1)=="/"?2:1)]}),z=!1;U.charCodeAt(0)===47?(z=!0,U=L[0].slice(0,-1)+U):z=U.indexOf("/")!==-1;var V=U.toUpperCase(),le=z===!0?L.indexOf(V):M.indexOf(V);if(le!==-1)return F.FileIndex[le];var ie=!V.match(Hu);for(V=V.replace(si,""),ie&&(V=V.replace(Hu,"!")),le=0;le<L.length;++le)if((ie?L[le].replace(Hu,"!"):L[le]).replace(si,"")==V||(ie?M[le].replace(Hu,"!"):M[le]).replace(si,"")==V)return F.FileIndex[le];return null}var D=64,R=-2,Ue="d0cf11e0a1b11ae1",ge=[208,207,17,224,161,177,26,225],Fe="00000000000000000000000000000000",Ee={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:R,FREESECT:-1,HEADER_SIGNATURE:Ue,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Fe,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function xe(F,U,L){c();var M=b(F,L);l.writeFileSync(U,M)}function J(F){for(var U=new Array(F.length),L=0;L<F.length;++L)U[L]=String.fromCharCode(F[L]);return U.join("")}function ke(F,U){var L=b(F,U);switch(U&&U.type||"buffer"){case"file":return c(),l.writeFileSync(U.filename,L),L;case"binary":return typeof L=="string"?L:J(L);case"base64":return Bf(typeof L=="string"?L:J(L));case"buffer":if(vt)return Buffer.isBuffer(L)?L:Ma(L);case"array":return typeof L=="string"?bi(L):L}return L}var Me;function j(F){try{var U=F.InflateRaw,L=new U;if(L._processChunk(new Uint8Array([3,0]),L._finishFlushFlag),L.bytesRead)Me=F;else throw new Error("zlib does not expose bytesRead")}catch(M){console.error("cannot use native zlib: "+(M.message||M))}}function H(F,U){if(!Me)return sa(F,U);var L=Me.InflateRaw,M=new L,z=M._processChunk(F.slice(F.l),M._finishFlushFlag);return F.l+=M.bytesRead,z}function q(F){return Me?Me.deflateRawSync(F):ot(F)}var X=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],de=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],we=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Ne(F){var U=(F<<1|F<<11)&139536|(F<<5|F<<15)&558144;return(U>>16|U>>8|U)&255}for(var Te=typeof Uint8Array<"u",_e=Te?new Uint8Array(256):[],rt=0;rt<256;++rt)_e[rt]=Ne(rt);function G(F,U){var L=_e[F&255];return U<=8?L>>>8-U:(L=L<<8|_e[F>>8&255],U<=16?L>>>16-U:(L=L<<8|_e[F>>16&255],L>>>24-U))}function Vt(F,U){var L=U&7,M=U>>>3;return(F[M]|(L<=6?0:F[M+1]<<8))>>>L&3}function gt(F,U){var L=U&7,M=U>>>3;return(F[M]|(L<=5?0:F[M+1]<<8))>>>L&7}function Rt(F,U){var L=U&7,M=U>>>3;return(F[M]|(L<=4?0:F[M+1]<<8))>>>L&15}function dt(F,U){var L=U&7,M=U>>>3;return(F[M]|(L<=3?0:F[M+1]<<8))>>>L&31}function $e(F,U){var L=U&7,M=U>>>3;return(F[M]|(L<=1?0:F[M+1]<<8))>>>L&127}function Zt(F,U,L){var M=U&7,z=U>>>3,V=(1<<L)-1,le=F[z]>>>M;return L<8-M||(le|=F[z+1]<<8-M,L<16-M)||(le|=F[z+2]<<16-M,L<24-M)||(le|=F[z+3]<<24-M),le&V}function fn(F,U,L){var M=U&7,z=U>>>3;return M<=5?F[z]|=(L&7)<<M:(F[z]|=L<<M&255,F[z+1]=(L&7)>>8-M),U+3}function $r(F,U,L){var M=U&7,z=U>>>3;return L=(L&1)<<M,F[z]|=L,U+1}function li(F,U,L){var M=U&7,z=U>>>3;return L<<=M,F[z]|=L&255,L>>>=8,F[z+1]=L,U+8}function ji(F,U,L){var M=U&7,z=U>>>3;return L<<=M,F[z]|=L&255,L>>>=8,F[z+1]=L&255,F[z+2]=L>>>8,U+16}function ci(F,U){var L=F.length,M=2*L>U?2*L:U+5,z=0;if(L>=U)return F;if(vt){var V=E_(M);if(F.copy)F.copy(V);else for(;z<F.length;++z)V[z]=F[z];return V}else if(Te){var le=new Uint8Array(M);if(le.set)le.set(F);else for(;z<L;++z)le[z]=F[z];return le}return F.length=M,F}function Ar(F){for(var U=new Array(F),L=0;L<F;++L)U[L]=0;return U}function ui(F,U,L){var M=1,z=0,V=0,le=0,ie=0,oe=F.length,te=Te?new Uint16Array(32):Ar(32);for(V=0;V<32;++V)te[V]=0;for(V=oe;V<L;++V)F[V]=0;oe=F.length;var ce=Te?new Uint16Array(oe):Ar(oe);for(V=0;V<oe;++V)te[z=F[V]]++,M<z&&(M=z),ce[V]=0;for(te[0]=0,V=1;V<=M;++V)te[V+16]=ie=ie+te[V-1]<<1;for(V=0;V<oe;++V)ie=F[V],ie!=0&&(ce[V]=te[ie+16]++);var me=0;for(V=0;V<oe;++V)if(me=F[V],me!=0)for(ie=G(ce[V],M)>>M-me,le=(1<<M+4-me)-1;le>=0;--le)U[ie|le<<me]=me&15|V<<4;return M}var Mt=Te?new Uint16Array(512):Ar(512),mr=Te?new Uint16Array(32):Ar(32);if(!Te){for(var nr=0;nr<512;++nr)Mt[nr]=0;for(nr=0;nr<32;++nr)mr[nr]=0}(function(){for(var F=[],U=0;U<32;U++)F.push(5);ui(F,mr,32);var L=[];for(U=0;U<=143;U++)L.push(8);for(;U<=255;U++)L.push(9);for(;U<=279;U++)L.push(7);for(;U<=287;U++)L.push(8);ui(L,Mt,288)})();var Qn=function(){for(var U=Te?new Uint8Array(32768):[],L=0,M=0;L<we.length-1;++L)for(;M<we[L+1];++M)U[M]=L;for(;M<32768;++M)U[M]=29;var z=Te?new Uint8Array(259):[];for(L=0,M=0;L<de.length-1;++L)for(;M<de[L+1];++M)z[M]=L;function V(ie,oe){for(var te=0;te<ie.length;){var ce=Math.min(65535,ie.length-te),me=te+ce==ie.length;for(oe.write_shift(1,+me),oe.write_shift(2,ce),oe.write_shift(2,~ce&65535);ce-- >0;)oe[oe.l++]=ie[te++]}return oe.l}function le(ie,oe){for(var te=0,ce=0,me=Te?new Uint16Array(32768):[];ce<ie.length;){var Pe=Math.min(65535,ie.length-ce);if(Pe<10){for(te=fn(oe,te,+(ce+Pe==ie.length)),te&7&&(te+=8-(te&7)),oe.l=te/8|0,oe.write_shift(2,Pe),oe.write_shift(2,~Pe&65535);Pe-- >0;)oe[oe.l++]=ie[ce++];te=oe.l*8;continue}te=fn(oe,te,+(ce+Pe==ie.length)+2);for(var He=0;Pe-- >0;){var Ce=ie[ce];He=(He<<5^Ce)&32767;var ze=-1,nt=0;if((ze=me[He])&&(ze|=ce&-32768,ze>ce&&(ze-=32768),ze<ce))for(;ie[ze+nt]==ie[ce+nt]&&nt<250;)++nt;if(nt>2){Ce=z[nt],Ce<=22?te=li(oe,te,_e[Ce+1]>>1)-1:(li(oe,te,3),te+=5,li(oe,te,_e[Ce-23]>>5),te+=3);var _t=Ce<8?0:Ce-4>>2;_t>0&&(ji(oe,te,nt-de[Ce]),te+=_t),Ce=U[ce-ze],te=li(oe,te,_e[Ce]>>3),te-=3;var kt=Ce<4?0:Ce-2>>1;kt>0&&(ji(oe,te,ce-ze-we[Ce]),te+=kt);for(var Et=0;Et<nt;++Et)me[He]=ce&32767,He=(He<<5^ie[ce])&32767,++ce;Pe-=nt-1}else Ce<=143?Ce=Ce+48:te=$r(oe,te,1),te=li(oe,te,_e[Ce]),me[He]=ce&32767,++ce}te=li(oe,te,0)-1}return oe.l=(te+7)/8|0,oe.l}return function(oe,te){return oe.length<8?V(oe,te):le(oe,te)}}();function ot(F){var U=pe(50+Math.floor(F.length*1.1)),L=Qn(F,U);return U.slice(0,L)}var ir=Te?new Uint16Array(32768):Ar(32768),xr=Te?new Uint16Array(32768):Ar(32768),ur=Te?new Uint16Array(128):Ar(128),Fn=1,ae=1;function Br(F,U){var L=dt(F,U)+257;U+=5;var M=dt(F,U)+1;U+=5;var z=Rt(F,U)+4;U+=4;for(var V=0,le=Te?new Uint8Array(19):Ar(19),ie=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],oe=1,te=Te?new Uint8Array(8):Ar(8),ce=Te?new Uint8Array(8):Ar(8),me=le.length,Pe=0;Pe<z;++Pe)le[X[Pe]]=V=gt(F,U),oe<V&&(oe=V),te[V]++,U+=3;var He=0;for(te[0]=0,Pe=1;Pe<=oe;++Pe)ce[Pe]=He=He+te[Pe-1]<<1;for(Pe=0;Pe<me;++Pe)(He=le[Pe])!=0&&(ie[Pe]=ce[He]++);var Ce=0;for(Pe=0;Pe<me;++Pe)if(Ce=le[Pe],Ce!=0){He=_e[ie[Pe]]>>8-Ce;for(var ze=(1<<7-Ce)-1;ze>=0;--ze)ur[He|ze<<Ce]=Ce&7|Pe<<3}var nt=[];for(oe=1;nt.length<L+M;)switch(He=ur[$e(F,U)],U+=He&7,He>>>=3){case 16:for(V=3+Vt(F,U),U+=2,He=nt[nt.length-1];V-- >0;)nt.push(He);break;case 17:for(V=3+gt(F,U),U+=3;V-- >0;)nt.push(0);break;case 18:for(V=11+$e(F,U),U+=7;V-- >0;)nt.push(0);break;default:nt.push(He),oe<He&&(oe=He);break}var _t=nt.slice(0,L),kt=nt.slice(L);for(Pe=L;Pe<286;++Pe)_t[Pe]=0;for(Pe=M;Pe<30;++Pe)kt[Pe]=0;return Fn=ui(_t,ir,286),ae=ui(kt,xr,30),U}function ia(F,U){if(F[0]==3&&!(F[1]&3))return[bo(U),2];for(var L=0,M=0,z=E_(U||1<<18),V=0,le=z.length>>>0,ie=0,oe=0;!(M&1);){if(M=gt(F,L),L+=3,M>>>1)M>>1==1?(ie=9,oe=5):(L=Br(F,L),ie=Fn,oe=ae);else{L&7&&(L+=8-(L&7));var te=F[L>>>3]|F[(L>>>3)+1]<<8;if(L+=32,te>0)for(!U&&le<V+te&&(z=ci(z,V+te),le=z.length);te-- >0;)z[V++]=F[L>>>3],L+=8;continue}for(;;){!U&&le<V+32767&&(z=ci(z,V+32767),le=z.length);var ce=Zt(F,L,ie),me=M>>>1==1?Mt[ce]:ir[ce];if(L+=me&15,me>>>=4,!(me>>>8&255))z[V++]=me;else{if(me==256)break;me-=257;var Pe=me<8?0:me-4>>2;Pe>5&&(Pe=0);var He=V+de[me];Pe>0&&(He+=Zt(F,L,Pe),L+=Pe),ce=Zt(F,L,oe),me=M>>>1==1?mr[ce]:xr[ce],L+=me&15,me>>>=4;var Ce=me<4?0:me-2>>1,ze=we[me];for(Ce>0&&(ze+=Zt(F,L,Ce),L+=Ce),!U&&le<He&&(z=ci(z,He+100),le=z.length);V<He;)z[V]=z[V-ze],++V}}}return U?[z,L+7>>>3]:[z.slice(0,V),L+7>>>3]}function sa(F,U){var L=F.slice(F.l||0),M=ia(L,U);return F.l+=M[1],M[0]}function Os(F,U){if(F)typeof console<"u"&&console.error(U);else throw new Error(U)}function aa(F,U){var L=F;En(L,0);var M=[],z=[],V={FileIndex:M,FullPaths:z};w(V,{root:U.root});for(var le=L.length-4;(L[le]!=80||L[le+1]!=75||L[le+2]!=5||L[le+3]!=6)&&le>=0;)--le;L.l=le+4,L.l+=4;var ie=L.read_shift(2);L.l+=6;var oe=L.read_shift(4);for(L.l=oe,le=0;le<ie;++le){L.l+=20;var te=L.read_shift(4),ce=L.read_shift(4),me=L.read_shift(2),Pe=L.read_shift(2),He=L.read_shift(2);L.l+=8;var Ce=L.read_shift(4),ze=o(L.slice(L.l+me,L.l+me+Pe));L.l+=me+Pe+He;var nt=L.l;L.l=Ce+4,wi(L,te,ce,V,ze),L.l=nt}return V}function wi(F,U,L,M,z){F.l+=2;var V=F.read_shift(2),le=F.read_shift(2),ie=a(F);if(V&8257)throw new Error("Unsupported ZIP encryption");for(var oe=F.read_shift(4),te=F.read_shift(4),ce=F.read_shift(4),me=F.read_shift(2),Pe=F.read_shift(2),He="",Ce=0;Ce<me;++Ce)He+=String.fromCharCode(F[F.l++]);if(Pe){var ze=o(F.slice(F.l,F.l+Pe));(ze[21589]||{}).mt&&(ie=ze[21589].mt),((z||{})[21589]||{}).mt&&(ie=z[21589].mt)}F.l+=Pe;var nt=F.slice(F.l,F.l+te);switch(le){case 8:nt=H(F,ce);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+le)}var _t=!1;V&8&&(oe=F.read_shift(4),oe==134695760&&(oe=F.read_shift(4),_t=!0),te=F.read_shift(4),ce=F.read_shift(4)),te!=U&&Os(_t,"Bad compressed size: "+U+" != "+te),ce!=L&&Os(_t,"Bad uncompressed size: "+L+" != "+ce),dn(M,He,nt,{unsafe:!0,mt:ie})}function Vi(F,U){var L=U||{},M=[],z=[],V=pe(1),le=L.compression?8:0,ie=0,oe=0,te=0,ce=0,me=0,Pe=F.FullPaths[0],He=Pe,Ce=F.FileIndex[0],ze=[],nt=0;for(oe=1;oe<F.FullPaths.length;++oe)if(He=F.FullPaths[oe].slice(Pe.length),Ce=F.FileIndex[oe],!(!Ce.size||!Ce.content||He=="Sh33tJ5")){var _t=ce,kt=pe(He.length);for(te=0;te<He.length;++te)kt.write_shift(1,He.charCodeAt(te)&127);kt=kt.slice(0,kt.l),ze[me]=nR.buf(Ce.content,0);var Et=Ce.content;le==8&&(Et=q(Et)),V=pe(30),V.write_shift(4,67324752),V.write_shift(2,20),V.write_shift(2,ie),V.write_shift(2,le),Ce.mt?s(V,Ce.mt):V.write_shift(4,0),V.write_shift(-4,ze[me]),V.write_shift(4,Et.length),V.write_shift(4,Ce.content.length),V.write_shift(2,kt.length),V.write_shift(2,0),ce+=V.length,M.push(V),ce+=kt.length,M.push(kt),ce+=Et.length,M.push(Et),V=pe(46),V.write_shift(4,33639248),V.write_shift(2,0),V.write_shift(2,20),V.write_shift(2,ie),V.write_shift(2,le),V.write_shift(4,0),V.write_shift(-4,ze[me]),V.write_shift(4,Et.length),V.write_shift(4,Ce.content.length),V.write_shift(2,kt.length),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(4,0),V.write_shift(4,_t),nt+=V.l,z.push(V),nt+=kt.length,z.push(kt),++me}return V=pe(22),V.write_shift(4,101010256),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(2,me),V.write_shift(2,me),V.write_shift(4,nt),V.write_shift(4,ce),V.write_shift(2,0),ln([ln(M),ln(z),V])}var vr={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Ui(F,U){if(F.ctype)return F.ctype;var L=F.name||"",M=L.match(/\.([^\.]+)$/);return M&&vr[M[1]]||U&&(M=(L=U).match(/[\.\\]([^\.\\])+$/),M&&vr[M[1]])?vr[M[1]]:"application/octet-stream"}function Va(F){for(var U=Bf(F),L=[],M=0;M<U.length;M+=76)L.push(U.slice(M,M+76));return L.join(`\r
`)+`\r
`}function Ua(F){var U=F.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(te){var ce=te.charCodeAt(0).toString(16).toUpperCase();return"="+(ce.length==1?"0"+ce:ce)});U=U.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),U.charAt(0)==`
`&&(U="=0D"+U.slice(1)),U=U.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var L=[],M=U.split(`\r
`),z=0;z<M.length;++z){var V=M[z];if(V.length==0){L.push("");continue}for(var le=0;le<V.length;){var ie=76,oe=V.slice(le,le+ie);oe.charAt(ie-1)=="="?ie--:oe.charAt(ie-2)=="="?ie-=2:oe.charAt(ie-3)=="="&&(ie-=3),oe=V.slice(le,le+ie),le+=ie,le<V.length&&(oe+="="),L.push(oe)}}return L.join(`\r
`)}function In(F){for(var U=[],L=0;L<F.length;++L){for(var M=F[L];L<=F.length&&M.charAt(M.length-1)=="=";)M=M.slice(0,M.length-1)+F[++L];U.push(M)}for(var z=0;z<U.length;++z)U[z]=U[z].replace(/[=][0-9A-Fa-f]{2}/g,function(V){return String.fromCharCode(parseInt(V.slice(1),16))});return bi(U.join(`\r
`))}function Ms(F,U,L){for(var M="",z="",V="",le,ie=0;ie<10;++ie){var oe=U[ie];if(!oe||oe.match(/^\s*$/))break;var te=oe.match(/^(.*?):\s*([^\s].*)$/);if(te)switch(te[1].toLowerCase()){case"content-location":M=te[2].trim();break;case"content-type":V=te[2].trim();break;case"content-transfer-encoding":z=te[2].trim();break}}switch(++ie,z.toLowerCase()){case"base64":le=bi(Mi(U.slice(ie).join("")));break;case"quoted-printable":le=In(U.slice(ie));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+z)}var ce=dn(F,M.slice(L.length),le,{unsafe:!0});V&&(ce.ctype=V)}function er(F,U){if(J(F.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var L=U&&U.root||"",M=(vt&&Buffer.isBuffer(F)?F.toString("binary"):J(F)).split(`\r
`),z=0,V="";for(z=0;z<M.length;++z)if(V=M[z],!!/^Content-Location:/i.test(V)&&(V=V.slice(V.indexOf("file")),L||(L=V.slice(0,V.lastIndexOf("/")+1)),V.slice(0,L.length)!=L))for(;L.length>0&&(L=L.slice(0,L.length-1),L=L.slice(0,L.lastIndexOf("/")+1),V.slice(0,L.length)!=L););var le=(M[1]||"").match(/boundary="(.*?)"/);if(!le)throw new Error("MAD cannot find boundary");var ie="--"+(le[1]||""),oe=[],te=[],ce={FileIndex:oe,FullPaths:te};w(ce);var me,Pe=0;for(z=0;z<M.length;++z){var He=M[z];He!==ie&&He!==ie+"--"||(Pe++&&Ms(ce,M.slice(me,z),L),me=z)}return ce}function fr(F,U){var L=U||{},M=L.boundary||"SheetJS";M="------="+M;for(var z=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+M.slice(2)+'"',"","",""],V=F.FullPaths[0],le=V,ie=F.FileIndex[0],oe=1;oe<F.FullPaths.length;++oe)if(le=F.FullPaths[oe].slice(V.length),ie=F.FileIndex[oe],!(!ie.size||!ie.content||le=="Sh33tJ5")){le=le.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(nt){return"_x"+nt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(nt){return"_u"+nt.charCodeAt(0).toString(16)+"_"});for(var te=ie.content,ce=vt&&Buffer.isBuffer(te)?te.toString("binary"):J(te),me=0,Pe=Math.min(1024,ce.length),He=0,Ce=0;Ce<=Pe;++Ce)(He=ce.charCodeAt(Ce))>=32&&He<128&&++me;var ze=me>=Pe*4/5;z.push(M),z.push("Content-Location: "+(L.root||"file:///C:/SheetJS/")+le),z.push("Content-Transfer-Encoding: "+(ze?"quoted-printable":"base64")),z.push("Content-Type: "+Ui(ie,le)),z.push(""),z.push(ze?Ua(ce):Va(ce))}return z.push(M+`--\r
`),z.join(`\r
`)}function Ti(F){var U={};return w(U,F),U}function dn(F,U,L,M){var z=M&&M.unsafe;z||w(F);var V=!z&&Ze.find(F,U);if(!V){var le=F.FullPaths[0];U.slice(0,le.length)==le?le=U:(le.slice(-1)!="/"&&(le+="/"),le=(le+U).replace("//","/")),V={name:i(U),type:2},F.FileIndex.push(V),F.FullPaths.push(le),z||Ze.utils.cfb_gc(F)}return V.content=L,V.size=L?L.length:0,M&&(M.CLSID&&(V.clsid=M.CLSID),M.mt&&(V.mt=M.mt),M.ct&&(V.ct=M.ct)),V}function oa(F,U){w(F);var L=Ze.find(F,U);if(L){for(var M=0;M<F.FileIndex.length;++M)if(F.FileIndex[M]==L)return F.FileIndex.splice(M,1),F.FullPaths.splice(M,1),!0}return!1}function $l(F,U,L){w(F);var M=Ze.find(F,U);if(M){for(var z=0;z<F.FileIndex.length;++z)if(F.FileIndex[z]==M)return F.FileIndex[z].name=i(L),F.FullPaths[z]=L,!0}return!1}function fs(F){S(F,!0)}return e.find=N,e.read=B,e.parse=d,e.write=ke,e.writeFile=xe,e.utils={cfb_new:Ti,cfb_add:dn,cfb_del:oa,cfb_mov:$l,cfb_gc:fs,ReadShift:of,CheckField:zS,prep_blob:En,bconcat:ln,use_zlib:j,_deflateRaw:ot,_inflateRaw:sa,consts:Ee},e}();function iR(t){return typeof t=="string"?wp(t):Array.isArray(t)?bb(t):t}function d0(t,e,r){if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=wp(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var n=r=="utf8"?Ks(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var i=new Blob([iR(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,t);if(typeof saveAs<"u")return saveAs(i,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:t,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=t,a.href=s,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(t);return o.open("w"),o.encoding="binary",Array.isArray(e)&&(e=Vo(e)),o.write(e),o.close(),e}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+t)}function sR(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function Nr(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function I_(t,e){for(var r=[],n=Nr(t),i=0;i!==n.length;++i)r[t[n[i]][e]]==null&&(r[t[n[i]][e]]=n[i]);return r}function Sp(t){for(var e=[],r=Nr(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}function kp(t){for(var e=[],r=Nr(t),n=0;n!==r.length;++n)e[t[r[n]]]=parseInt(r[n],10);return e}function aR(t){for(var e=[],r=Nr(t),n=0;n!==r.length;++n)e[t[r[n]]]==null&&(e[t[r[n]]]=[]),e[t[r[n]]].push(r[n]);return e}var Ph=new Date(1899,11,30,0,0,0);function Jr(t,e){var r=t.getTime(),n=Ph.getTime()+(t.getTimezoneOffset()-Ph.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var ES=new Date,oR=Ph.getTime()+(ES.getTimezoneOffset()-Ph.getTimezoneOffset())*6e4,b_=ES.getTimezoneOffset();function Ap(t){var e=new Date;return e.setTime(t*24*60*60*1e3+oR),e.getTimezoneOffset()!==b_&&e.setTime(e.getTime()+(e.getTimezoneOffset()-b_)*6e4),e}function lR(t){var e=0,r=0,n=!1,i=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var s=1;s!=i.length;++s)if(i[s]){switch(r=1,s>3&&(n=!0),i[s].slice(i[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[s].slice(i[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(i[s],10)}return e}var R_=new Date("2017-02-19T19:06:09.000Z"),wS=isNaN(R_.getFullYear())?new Date("2/19/17"):R_,cR=wS.getFullYear()==2017;function lr(t,e){var r=new Date(t);if(cR)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(wS.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=t.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return t.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function Sl(t,e){if(vt&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return Ks(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return Ks(cS(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return Ks(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return Ks(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],i=0;i!=t.length;++i)n.push(String.fromCharCode(t[i]));return n.join("")}function cr(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=cr(t[r]));return e}function Ir(t,e){for(var r="";r.length<e;)r+=t;return r}function Rs(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return r=-r,s}),!isNaN(e=Number(n)))?e/r:e}var uR=["january","february","march","april","may","june","july","august","september","october","november","december"];function Kc(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),i=e.getMonth(),s=e.getDate();if(isNaN(s))return r;var a=t.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&uR.indexOf(a)==-1)return r}else if(a.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||s>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var fR=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(t||typeof n=="string")return r.split(n);for(var s=r.split(n),a=[s[0]],o=1;o<s.length;++o)a.push(i),a.push(s[o]);return a}}();function TS(t){return t?t.content&&t.type?Sl(t.content,!0):t.data?$u(t.data):t.asNodeBuffer&&vt?$u(t.asNodeBuffer().toString("binary")):t.asBinary?$u(t.asBinary()):t._data&&t._data.getContent?$u(Sl(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function SS(t){if(!t)return null;if(t.data)return y_(t.data);if(t.asNodeBuffer&&vt)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?y_(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function dR(t){return t&&t.name.slice(-4)===".bin"?SS(t):TS(t)}function Zi(t,e){for(var r=t.FullPaths||Nr(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var a=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==a||i==a)return t.files?t.files[r[s]]:t.FileIndex[s]}return null}function A1(t,e){var r=Zi(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function Ur(t,e,r){if(!r)return dR(A1(t,e));if(!e)return null;try{return Ur(t,e)}catch{return null}}function Ri(t,e,r){if(!r)return TS(A1(t,e));if(!e)return null;try{return Ri(t,e)}catch{return null}}function hR(t,e,r){return SS(A1(t,e))}function N_(t){for(var e=t.FullPaths||Nr(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function xt(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return vt?n=Ma(r):n=Rb(r),Ze.utils.cfb_add(t,e,n)}Ze.utils.cfb_add(t,e,r)}else t.file(e,r)}function C1(){return Ze.utils.cfb_new()}function kS(t,e){switch(e.type){case"base64":return Ze.read(t,{type:"base64"});case"binary":return Ze.read(t,{type:"binary"});case"buffer":case"array":return Ze.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function Gu(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var Lr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,pR=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,D_=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,gR=/<[^>]*>/g,Yn=Lr.match(D_)?D_:gR,mR=/<\w*:/,xR=/<(\/?)\w+:/;function at(t,e,r){for(var n={},i=0,s=0;i!==t.length&&!((s=t.charCodeAt(i))===32||s===10||s===13);++i);if(e||(n[0]=t.slice(0,i)),i===t.length)return n;var a=t.match(pR),o=0,l="",c=0,d="",h="",p=1;if(a)for(c=0;c!=a.length;++c){for(h=a[c],s=0;s!=h.length&&h.charCodeAt(s)!==61;++s);for(d=h.slice(0,s).trim();h.charCodeAt(s+1)==32;)++s;for(p=(i=h.charCodeAt(s+1))==34||i==39?1:0,l=h.slice(s+1+p,h.length-p),o=0;o!=d.length&&d.charCodeAt(o)!==58;++o);if(o===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),n[d]=l,n[d.toLowerCase()]=l;else{var m=(o===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(o+1);if(n[m]&&d.slice(o-3,o)=="ext")continue;n[m]=l,n[m.toLowerCase()]=l}}return n}function ra(t){return t.replace(xR,"<$1")}var AS={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},F1=Sp(AS),Pt=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",s=i.indexOf("<![CDATA[");if(s==-1)return i.replace(t,function(o,l){return AS[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(e,function(o,l){return String.fromCharCode(parseInt(l,16))});var a=i.indexOf("]]>");return r(i.slice(0,s))+i.slice(s+9,a)+r(i.slice(a+3))}}(),I1=/[&<>'"]/g,vR=/[\u0000-\u0008\u000b-\u001f]/g;function Xt(t){var e=t+"";return e.replace(I1,function(r){return F1[r]}).replace(vR,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function P_(t){return Xt(t).replace(/ /g,"_x0020_")}var CS=/[\u0000-\u001f]/g;function b1(t){var e=t+"";return e.replace(I1,function(r){return F1[r]}).replace(/\n/g,"<br/>").replace(CS,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function yR(t){var e=t+"";return e.replace(I1,function(r){return F1[r]}).replace(CS,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var O_=function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}}();function _R(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function ar(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Eg(t){for(var e="",r=0,n=0,i=0,s=0,a=0,o=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(i=t.charCodeAt(r++),n>191&&n<224){a=(n&31)<<6,a|=i&63,e+=String.fromCharCode(a);continue}if(s=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}a=t.charCodeAt(r++),o=((n&7)<<18|(i&63)<<12|(s&63)<<6|a&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function M_(t){var e=bo(2*t.length),r,n,i=1,s=0,a=0,o;for(n=0;n<t.length;n+=i)i=1,(o=t.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(t.charCodeAt(n+1)&63),i=2):o<240?(r=(o&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),i=3):(i=4,r=(o&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,a=55296+(r>>>10&1023),r=56320+(r&1023)),a!==0&&(e[s++]=a&255,e[s++]=a>>>8,a=0),e[s++]=r%256,e[s++]=r>>>8;return e.slice(0,s).toString("ucs2")}function L_(t){return Ma(t,"binary").toString("utf8")}var vd="foo bar baz",Jt=vt&&(L_(vd)==Eg(vd)&&L_||M_(vd)==Eg(vd)&&M_)||Eg,Ks=vt?function(t){return Ma(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,i=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},Vf=function(){var t={};return function(r,n){var i=r+"|"+(n||"");return t[i]?t[i]:t[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),FS=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<t.length;++i)n=n.replace(t[i][0],t[i][1]);return n}}(),ER=function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),wR=/<\/?(?:vt:)?variant>/g,TR=/<(?:vt:)([^>]*)>([\s\S]*)</;function B_(t,e){var r=at(t),n=t.match(ER(r.baseType))||[],i=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(s){var a=s.replace(wR,"").match(TR);a&&i.push({v:Jt(a[2]),t:a[1]})}),i}var IS=/(^\s|\s$|\n)/;function wn(t,e){return"<"+t+(e.match(IS)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function Uf(t){return Nr(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function Be(t,e,r){return"<"+t+(r!=null?Uf(r):"")+(e!=null?(e.match(IS)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function Gm(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function SR(t,e){switch(typeof t){case"string":var r=Be("vt:lpwstr",Xt(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Be((t|0)==t?"vt:i4":"vt:r8",Xt(String(t)));case"boolean":return Be("vt:bool",t?"true":"false")}if(t instanceof Date)return Be("vt:filetime",Gm(t));throw new Error("Unable to serialize "+t)}function R1(t){if(vt&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return Jt(Vo(T1(t)));throw new Error("Bad input format: expected Buffer or string")}var zf=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Xr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Ml=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Fi={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function kR(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),i=t[e+6]&15,s=5;s>=0;--s)i=i*256+t[e+s];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function AR(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,i=0,s=0,a=n?-e:e;isFinite(a)?a==0?i=s=0:(i=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(e)?26985:0);for(var o=0;o<=5;++o,s/=256)t[r+o]=s&255;t[r+6]=(i&15)<<4|s&15,t[r+7]=i>>4|n}var j_=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var i=0,s=t[0][n].length;i<s;i+=r)e.push.apply(e,t[0][n].slice(i,i+r));return e},V_=vt?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:Ma(e)})):j_(t)}:j_,U_=function(t,e,r){for(var n=[],i=e;i<r;i+=2)n.push(String.fromCharCode(ma(t,i)));return n.join("").replace(si,"")},N1=vt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(si,""):U_(t,e,r)}:U_,z_=function(t,e,r){for(var n=[],i=e;i<e+r;++i)n.push(("0"+t[i].toString(16)).slice(-2));return n.join("")},bS=vt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):z_(t,e,r)}:z_,W_=function(t,e,r){for(var n=[],i=e;i<r;i++)n.push(String.fromCharCode(oc(t,i)));return n.join("")},h0=vt?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):W_(e,r,n)}:W_,RS=function(t,e){var r=Ii(t,e);return r>0?h0(t,e+4,e+4+r-1):""},NS=RS,DS=function(t,e){var r=Ii(t,e);return r>0?h0(t,e+4,e+4+r-1):""},PS=DS,OS=function(t,e){var r=2*Ii(t,e);return r>0?h0(t,e+4,e+4+r-1):""},MS=OS,LS=function(e,r){var n=Ii(e,r);return n>0?N1(e,r+4,r+4+n):""},BS=LS,jS=function(t,e){var r=Ii(t,e);return r>0?h0(t,e+4,e+4+r):""},VS=jS,US=function(t,e){return kR(t,e)},Oh=US,D1=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};vt&&(NS=function(e,r){if(!Buffer.isBuffer(e))return RS(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},PS=function(e,r){if(!Buffer.isBuffer(e))return DS(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},MS=function(e,r){if(!Buffer.isBuffer(e))return OS(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},BS=function(e,r){if(!Buffer.isBuffer(e))return LS(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},VS=function(e,r){if(!Buffer.isBuffer(e))return jS(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},Oh=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):US(e,r)},D1=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var oc=function(t,e){return t[e]},ma=function(t,e){return t[e+1]*256+t[e]},CR=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},Ii=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},il=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},FR=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function of(t,e){var r="",n,i,s=[],a,o,l,c;switch(e){case"dbcs":if(c=this.l,vt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(l=0;l<t;++l)r+=String.fromCharCode(ma(this,c)),c+=2;t*=2;break;case"utf8":r=h0(this,this.l,this.l+t);break;case"utf16le":t*=2,r=N1(this,this.l,this.l+t);break;case"wstr":return of.call(this,t,"dbcs");case"lpstr-ansi":r=NS(this,this.l),t=4+Ii(this,this.l);break;case"lpstr-cp":r=PS(this,this.l),t=4+Ii(this,this.l);break;case"lpwstr":r=MS(this,this.l),t=4+2*Ii(this,this.l);break;case"lpp4":t=4+Ii(this,this.l),r=BS(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+Ii(this,this.l),r=VS(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(a=oc(this,this.l+t++))!==0;)s.push(xd(a));r=s.join("");break;case"_wstr":for(t=0,r="";(a=ma(this,this.l+t))!==0;)s.push(xd(a)),t+=2;t+=2,r=s.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=oc(this,c),this.l=c+1,o=of.call(this,t-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(xd(ma(this,c))),c+=2}r=s.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,l=0;l!=t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=oc(this,c),this.l=c+1,o=of.call(this,t-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(xd(oc(this,c))),c+=1}r=s.join("");break;default:switch(t){case 1:return n=oc(this,this.l),this.l++,n;case 2:return n=(e==="i"?CR:ma)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(t>0?il:FR)(this,this.l),this.l+=4,n):(i=Ii(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return t==8?i=Oh(this,this.l):i=Oh([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;t=8;case 16:r=bS(this,this.l,t);break}}return this.l+=t,r}var IR=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},bR=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},RR=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function NR(t,e,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=e.length;++i)RR(this,e.charCodeAt(i),this.l+2*i);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;n=e.length}else if(r==="hex"){for(;i<t;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+t,this.length);for(i=0;i<Math.min(e.length,t);++i){var a=e.charCodeAt(i);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,IR(this,e,this.l);break;case 8:if(n=8,r==="f"){AR(this,e,this.l);break}case 16:break;case-4:n=4,bR(this,e,this.l);break}return this.l+=n,this}function zS(t,e){var r=bS(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function En(t,e){t.l=e,t.read_shift=of,t.chk=zS,t.write_shift=NR}function Xn(t,e){t.l+=e}function pe(t){var e=bo(t);return En(e,0),e}function La(t,e,r){if(t){var n,i,s;En(t,t.l||0);for(var a=t.length,o=0,l=0;t.l<a;){o=t.read_shift(1),o&128&&(o=(o&127)+((t.read_shift(1)&127)<<7));var c=Xf[o]||Xf[65535];for(n=t.read_shift(1),s=n&127,i=1;i<4&&n&128;++i)s+=((n=t.read_shift(1))&127)<<7*i;l=t.l+s;var d=c.f&&c.f(t,s,r);if(t.l=l,e(d,c,o))return}}}function _i(){var t=[],e=vt?256:2048,r=function(c){var d=pe(c);return En(d,0),d},n=r(e),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},s=function(c){return n&&c<n.length-n.l?n:(i(),n=r(Math.max(c+1,e)))},a=function(){return i(),ln(t)},o=function(c){i(),n=c,n.l==null&&(n.l=n.length),s(e)};return{next:s,push:o,end:a,_bufs:t}}function ye(t,e,r,n){var i=+e,s;if(!isNaN(i)){n||(n=Xf[i].p||(r||[]).length||0),s=1+(i>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var a=t.next(s);i<=127?a.write_shift(1,i):(a.write_shift(1,(i&127)+128),a.write_shift(1,i>>7));for(var o=0;o!=4;++o)if(n>=128)a.write_shift(1,(n&127)+128),n>>=7;else{a.write_shift(1,n);break}n>0&&D1(r)&&t.push(r)}}function lf(t,e,r){var n=cr(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function $_(t,e,r){var n=cr(t);return n.s=lf(n.s,e.s,r),n.e=lf(n.e,e.s,r),n}function cf(t,e){if(t.cRel&&t.c<0)for(t=cr(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=cr(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=st(t);return!t.cRel&&t.cRel!=null&&(r=OR(r)),!t.rRel&&t.rRel!=null&&(r=DR(r)),r}function wg(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+Er(t.s.c)+":"+(t.e.cRel?"":"$")+Er(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+Mr(t.s.r)+":"+(t.e.rRel?"":"$")+Mr(t.e.r):cf(t.s,e.biff)+":"+cf(t.e,e.biff)}function P1(t){return parseInt(PR(t),10)-1}function Mr(t){return""+(t+1)}function DR(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function PR(t){return t.replace(/\$(\d+)$/,"$1")}function O1(t){for(var e=MR(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function Er(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function OR(t){return t.replace(/^([A-Z])/,"$$$1")}function MR(t){return t.replace(/^\$([A-Z])/,"$1")}function LR(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function wr(t){for(var e=0,r=0,n=0;n<t.length;++n){var i=t.charCodeAt(n);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:e-1}}function st(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function Ei(t){var e=t.indexOf(":");return e==-1?{s:wr(t),e:wr(t)}:{s:wr(t.slice(0,e)),e:wr(t.slice(e+1))}}function mt(t,e){return typeof e>"u"||typeof e=="number"?mt(t.s,t.e):(typeof t!="string"&&(t=st(t)),typeof e!="string"&&(e=st(e)),t==e?t:t+":"+e)}function Ot(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,s=t.length;for(r=0;n<s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.s.c=--r,r=0;n<s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(e.s.r=--r,n===s||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.e.c=--r,r=0;n!=s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return e.e.r=--r,e}function H_(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=cs(t.z,r?Jr(e):e)}catch{}try{return t.w=cs((t.XF||{}).numFmtId||(r?14:0),r?Jr(e):e)}catch{return""+e}}function Ia(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?Ba[t.v]||t.v:e==null?H_(t,t.v):H_(t,e))}function Uo(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function WS(t,e,r){var n=r||{},i=t?Array.isArray(t):n.dense,s=t||(i?[]:{}),a=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?wr(n.origin):n.origin;a=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var d=Ot(s["!ref"]);c.s.c=d.s.c,c.s.r=d.s.r,c.e.c=Math.max(c.e.c,d.e.c),c.e.r=Math.max(c.e.r,d.e.r),a==-1&&(c.e.r=a=d.e.r+1)}for(var h=0;h!=e.length;++h)if(e[h]){if(!Array.isArray(e[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var p=0;p!=e[h].length;++p)if(!(typeof e[h][p]>"u")){var m={v:e[h][p]},y=a+h,x=o+p;if(c.s.r>y&&(c.s.r=y),c.s.c>x&&(c.s.c=x),c.e.r<y&&(c.e.r=y),c.e.c<x&&(c.e.c=x),e[h][p]&&typeof e[h][p]=="object"&&!Array.isArray(e[h][p])&&!(e[h][p]instanceof Date))m=e[h][p];else if(Array.isArray(m.v)&&(m.f=e[h][p][1],m.v=m.v[0]),m.v===null)if(m.f)m.t="n";else if(n.nullError)m.t="e",m.v=0;else if(n.sheetStubs)m.t="z";else continue;else typeof m.v=="number"?m.t="n":typeof m.v=="boolean"?m.t="b":m.v instanceof Date?(m.z=n.dateNF||it[14],n.cellDates?(m.t="d",m.w=cs(m.z,Jr(m.v))):(m.t="n",m.v=Jr(m.v),m.w=cs(m.z,m.v))):m.t="s";if(i)s[y]||(s[y]=[]),s[y][x]&&s[y][x].z&&(m.z=s[y][x].z),s[y][x]=m;else{var E=st({c:x,r:y});s[E]&&s[E].z&&(m.z=s[E].z),s[E]=m}}}return c.s.c<1e7&&(s["!ref"]=mt(c)),s}function uu(t,e){return WS(null,t,e)}function BR(t){return t.read_shift(4,"i")}function Ns(t,e){return e||(e=pe(4)),e.write_shift(4,t),e}function Gn(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function cn(t,e){var r=!1;return e==null&&(r=!0,e=pe(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function jR(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function VR(t,e){return e||(e=pe(4)),e.write_shift(2,0),e.write_shift(2,0),e}function M1(t,e){var r=t.l,n=t.read_shift(1),i=Gn(t),s=[],a={t:i,h:i};if(n&1){for(var o=t.read_shift(4),l=0;l!=o;++l)s.push(jR(t));a.r=s}else a.r=[{ich:0,ifnt:0}];return t.l=r+e,a}function UR(t,e){var r=!1;return e==null&&(r=!0,e=pe(15+4*t.t.length)),e.write_shift(1,0),cn(t.t,e),r?e.slice(0,e.l):e}var zR=M1;function WR(t,e){var r=!1;return e==null&&(r=!0,e=pe(23+4*t.t.length)),e.write_shift(1,1),cn(t.t,e),e.write_shift(4,1),VR({},e),r?e.slice(0,e.l):e}function us(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function Ll(t,e){return e==null&&(e=pe(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function Bl(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function jl(t,e){return e==null&&(e=pe(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var $R=Gn,$S=cn;function L1(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function Mh(t,e){var r=!1;return e==null&&(r=!0,e=pe(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var HR=Gn,Km=L1,B1=Mh;function j1(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var i=n===0?Oh([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):il(e,0)>>2;return r?i/100:i}function HS(t,e){e==null&&(e=pe(4));var r=0,n=0,i=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?n=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(n=1,r=1),n)e.write_shift(-4,((r?i:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function GS(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function GR(t,e){return e||(e=pe(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var Vl=GS,fu=GR;function Hn(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function kl(t,e){return(e||pe(8)).write_shift(8,t,"f")}function KR(t){var e={},r=t.read_shift(1),n=r>>>1,i=t.read_shift(1),s=t.read_shift(2,"i"),a=t.read_shift(1),o=t.read_shift(1),l=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=i;var c=dl[i];c&&(e.rgb=$f(c));break;case 2:e.rgb=$f([a,o,l]);break;case 3:e.theme=i;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function Lh(t,e){if(e||(e=pe(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function XR(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function qR(t,e){e||(e=pe(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}function KS(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function YR(t){return KS(t,1)}function QR(t){return KS(t,2)}var V1=2,pi=3,yd=11,G_=12,Bh=19,_d=64,JR=65,ZR=71,eN=4108,tN=4126,sn=80,XS=81,rN=[sn,XS],Xm={1:{n:"CodePage",t:V1},2:{n:"Category",t:sn},3:{n:"PresentationFormat",t:sn},4:{n:"ByteCount",t:pi},5:{n:"LineCount",t:pi},6:{n:"ParagraphCount",t:pi},7:{n:"SlideCount",t:pi},8:{n:"NoteCount",t:pi},9:{n:"HiddenCount",t:pi},10:{n:"MultimediaClipCount",t:pi},11:{n:"ScaleCrop",t:yd},12:{n:"HeadingPairs",t:eN},13:{n:"TitlesOfParts",t:tN},14:{n:"Manager",t:sn},15:{n:"Company",t:sn},16:{n:"LinksUpToDate",t:yd},17:{n:"CharacterCount",t:pi},19:{n:"SharedDoc",t:yd},22:{n:"HyperlinksChanged",t:yd},23:{n:"AppVersion",t:pi,p:"version"},24:{n:"DigSig",t:JR},26:{n:"ContentType",t:sn},27:{n:"ContentStatus",t:sn},28:{n:"Language",t:sn},29:{n:"Version",t:sn},255:{},2147483648:{n:"Locale",t:Bh},2147483651:{n:"Behavior",t:Bh},1919054434:{}},qm={1:{n:"CodePage",t:V1},2:{n:"Title",t:sn},3:{n:"Subject",t:sn},4:{n:"Author",t:sn},5:{n:"Keywords",t:sn},6:{n:"Comments",t:sn},7:{n:"Template",t:sn},8:{n:"LastAuthor",t:sn},9:{n:"RevNumber",t:sn},10:{n:"EditTime",t:_d},11:{n:"LastPrinted",t:_d},12:{n:"CreatedDate",t:_d},13:{n:"ModifiedDate",t:_d},14:{n:"PageCount",t:pi},15:{n:"WordCount",t:pi},16:{n:"CharCount",t:pi},17:{n:"Thumbnail",t:ZR},18:{n:"Application",t:sn},19:{n:"DocSecurity",t:pi},255:{},2147483648:{n:"Locale",t:Bh},2147483651:{n:"Behavior",t:Bh},1919054434:{}},K_={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},nN=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function iN(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var sN=iN([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),dl=cr(sN),Ba={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},qS={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Ym={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Ed={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function U1(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function aN(t){var e=U1();if(!t||!t.match)return e;var r={};if((t.match(Yn)||[]).forEach(function(n){var i=at(n);switch(i[0].replace(mR,"<")){case"<?xml":break;case"<Types":e.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":e[Ym[i.ContentType]]!==void 0&&e[Ym[i.ContentType]].push(i.PartName);break}}),e.xmlns!==Xr.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}function YS(t,e){var r=aR(Ym),n=[],i;n[n.length]=Lr,n[n.length]=Be("Types",null,{xmlns:Xr.CT,"xmlns:xsd":Xr.xsd,"xmlns:xsi":Xr.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return Be("Default",null,{Extension:l[0],ContentType:l[1]})}));var s=function(l){t[l]&&t[l].length>0&&(i=t[l][0],n[n.length]=Be("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:Ed[l][e.bookType]||Ed[l].xlsx}))},a=function(l){(t[l]||[]).forEach(function(c){n[n.length]=Be("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:Ed[l][e.bookType]||Ed[l].xlsx})})},o=function(l){(t[l]||[]).forEach(function(c){n[n.length]=Be("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:r[l][0]})})};return s("workbooks"),a("sheets"),a("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),a("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var yt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Wf(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function uf(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(Yn)||[]).forEach(function(i){var s=at(i);if(s[0]==="<Relationship"){var a={};a.Type=s.Type,a.Target=s.Target,a.Id=s.Id,s.TargetMode&&(a.TargetMode=s.TargetMode);var o=s.TargetMode==="External"?s.Target:Gu(s.Target,e);r[o]=a,n[s.Id]=a}}),r["!id"]=n,r}function Dc(t){var e=[Lr,Be("Relationships",null,{xmlns:Xr.RELS})];return Nr(t["!id"]).forEach(function(r){e[e.length]=Be("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function Kt(t,e,r,n,i,s){if(i||(i={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,i.Id="rId"+e,i.Type=n,i.Target=r,[yt.HLINK,yt.XPATH,yt.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),t["!id"][i.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][i.Id]=i,t[("/"+i.Target).replace("//","/")]=i,e}var oN="application/vnd.oasis.opendocument.spreadsheet";function lN(t,e){for(var r=R1(t),n,i;n=zf.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=at(n[0],!1),i.path=="/"&&i.type!==oN)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}function cN(t){var e=[Lr];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function X_(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function uN(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function fN(t){var e=[Lr];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(X_(t[r][0],t[r][1])),e.push(uN("",t[r][0]));return e.push(X_("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function QS(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+bh.version+"</meta:generator></office:meta></office:document-meta>"}var as=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],dN=function(){for(var t=new Array(as.length),e=0;e<as.length;++e){var r=as[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function JS(t){var e={};t=Jt(t);for(var r=0;r<as.length;++r){var n=as[r],i=t.match(dN[r]);i!=null&&i.length>0&&(e[n[1]]=Pt(i[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=lr(e[n[1]]))}return e}function Tg(t,e,r,n,i){i[t]!=null||e==null||e===""||(i[t]=e,e=Xt(e),n[n.length]=r?Be(t,e,r):wn(t,e))}function ZS(t,e){var r=e||{},n=[Lr,Be("cp:coreProperties",null,{"xmlns:cp":Xr.CORE_PROPS,"xmlns:dc":Xr.dc,"xmlns:dcterms":Xr.dcterms,"xmlns:dcmitype":Xr.dcmitype,"xmlns:xsi":Xr.xsi})],i={};if(!t&&!r.Props)return n.join("");t&&(t.CreatedDate!=null&&Tg("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:Gm(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),t.ModifiedDate!=null&&Tg("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:Gm(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var s=0;s!=as.length;++s){var a=as[s],o=r.Props&&r.Props[a[1]]!=null?r.Props[a[1]]:t?t[a[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&Tg(a[0],o,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var hl=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],ek=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function tk(t,e,r,n){var i=[];if(typeof t=="string")i=B_(t,n);else for(var s=0;s<t.length;++s)i=i.concat(t[s].map(function(d){return{v:d}}));var a=typeof e=="string"?B_(e,n).map(function(d){return d.v}):e,o=0,l=0;if(a.length>0)for(var c=0;c!==i.length;c+=2){switch(l=+i[c+1].v,i[c].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=a.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=l,r.DefinedNames=a.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=a.slice(o,o+l);break}o+=l}}function hN(t,e,r){var n={};return e||(e={}),t=Jt(t),hl.forEach(function(i){var s=(t.match(Vf(i[0]))||[])[1];switch(i[2]){case"string":s&&(e[i[1]]=Pt(s));break;case"bool":e[i[1]]=s==="true";break;case"raw":var a=t.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));a&&a.length>0&&(n[i[1]]=a[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&tk(n.HeadingPairs,n.TitlesOfParts,e,r),e}function rk(t){var e=[],r=Be;return t||(t={}),t.Application="SheetJS",e[e.length]=Lr,e[e.length]=Be("Properties",null,{xmlns:Xr.EXT_PROPS,"xmlns:vt":Xr.vt}),hl.forEach(function(n){if(t[n[1]]!==void 0){var i;switch(n[2]){case"string":i=Xt(String(t[n[1]]));break;case"bool":i=t[n[1]]?"true":"false";break}i!==void 0&&(e[e.length]=r(n[0],i))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+Xt(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var pN=/<[^>]+>[^<]*/g;function gN(t,e){var r={},n="",i=t.match(pN);if(i)for(var s=0;s!=i.length;++s){var a=i[s],o=at(a);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Pt(o.name);break;case"</property>":n=null;break;default:if(a.indexOf("<vt:")===0){var l=a.split(">"),c=l[0].slice(4),d=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":r[n]=Pt(d);break;case"bool":r[n]=ar(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(d);break;case"filetime":case"date":r[n]=lr(d);break;case"cy":case"error":r[n]=Pt(d);break;default:if(c.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",a,c,l)}}else if(a.slice(0,2)!=="</"){if(e.WTF)throw new Error(a)}}}return r}function nk(t){var e=[Lr,Be("Properties",null,{xmlns:Xr.CUST_PROPS,"xmlns:vt":Xr.vt})];if(!t)return e.join("");var r=1;return Nr(t).forEach(function(i){++r,e[e.length]=Be("property",SR(t[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Xt(i)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var Qm={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Sg;function mN(t,e,r){Sg||(Sg=Sp(Qm)),e=Sg[e]||e,t[e]=r}function xN(t,e){var r=[];return Nr(Qm).map(function(n){for(var i=0;i<as.length;++i)if(as[i][1]==n)return as[i];for(i=0;i<hl.length;++i)if(hl[i][1]==n)return hl[i];throw n}).forEach(function(n){if(t[n[1]]!=null){var i=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:t[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(wn(Qm[n[1]]||n[1],i))}}),Be("DocumentProperties",r.join(""),{xmlns:Fi.o})}function vN(t,e){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return t&&Nr(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)){for(var a=0;a<as.length;++a)if(s==as[a][1])return;for(a=0;a<hl.length;++a)if(s==hl[a][1])return;for(a=0;a<r.length;++a)if(s==r[a])return;var o=t[s],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),i.push(Be(P_(s),o,{"dt:dt":l}))}}),e&&Nr(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)&&!(t&&Object.prototype.hasOwnProperty.call(t,s))){var a=e[s],o="string";typeof a=="number"?(o="float",a=String(a)):a===!0||a===!1?(o="boolean",a=a?"1":"0"):a instanceof Date?(o="dateTime.tz",a=a.toISOString()):a=String(a),i.push(Be(P_(s),a,{"dt:dt":o}))}}),"<"+n+' xmlns="'+Fi.o+'">'+i.join("")+"</"+n+">"}function z1(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function yN(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,n=r%Math.pow(2,32),i=(r-n)/Math.pow(2,32);n*=1e7,i*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),i+=s);var a=pe(8);return a.write_shift(4,n),a.write_shift(4,i),a}function ik(t,e,r){var n=t.l,i=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return i}function sk(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function ak(t,e,r){return e===31?sk(t):ik(t,e,r)}function Jm(t,e,r){return ak(t,e,r===!1?0:4)}function _N(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return ak(t,e,0)}function EN(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var i=t.l;r[n]=t.read_shift(0,"lpwstr").replace(si,""),t.l-i&2&&(t.l+=2)}return r}function wN(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(si,"");return r}function TN(t){var e=t.l,r=jh(t,XS);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=jh(t,pi);return[r,n]}function SN(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(TN(t));return r}function q_(t,e){for(var r=t.read_shift(4),n={},i=0;i!=r;++i){var s=t.read_shift(4),a=t.read_shift(4);n[s]=t.read_shift(a,e===1200?"utf16le":"utf8").replace(si,"").replace(Hu,"!"),e===1200&&a%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function ok(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function kN(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function jh(t,e,r){var n=t.read_shift(2),i,s=r||{};if(t.l+=2,e!==G_&&n!==e&&rN.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===G_?n:e){case 2:return i=t.read_shift(2,"i"),s.raw||(t.l+=2),i;case 3:return i=t.read_shift(4,"i"),i;case 11:return t.read_shift(4)!==0;case 19:return i=t.read_shift(4),i;case 30:return ik(t,n,4).replace(si,"");case 31:return sk(t);case 64:return z1(t);case 65:return ok(t);case 71:return kN(t);case 80:return Jm(t,n,!s.raw).replace(si,"");case 81:return _N(t,n).replace(si,"");case 4108:return SN(t);case 4126:case 4127:return n==4127?EN(t):wN(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function Y_(t,e){var r=pe(4),n=pe(4);switch(r.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,e);break;case 5:n=pe(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=yN(e);break;case 31:case 80:for(n=pe(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return ln([r,n])}function Q_(t,e){var r=t.l,n=t.read_shift(4),i=t.read_shift(4),s=[],a=0,o=0,l=-1,c={};for(a=0;a!=i;++a){var d=t.read_shift(4),h=t.read_shift(4);s[a]=[d,h+r]}s.sort(function(k,_){return k[1]-_[1]});var p={};for(a=0;a!=i;++a){if(t.l!==s[a][1]){var m=!0;if(a>0&&e)switch(e[s[a-1][0]].t){case 2:t.l+2===s[a][1]&&(t.l+=2,m=!1);break;case 80:t.l<=s[a][1]&&(t.l=s[a][1],m=!1);break;case 4108:t.l<=s[a][1]&&(t.l=s[a][1],m=!1);break}if((!e||a==0)&&t.l<=s[a][1]&&(m=!1,t.l=s[a][1]),m)throw new Error("Read Error: Expected address "+s[a][1]+" at "+t.l+" :"+a)}if(e){var y=e[s[a][0]];if(p[y.n]=jh(t,y.t,{raw:!0}),y.p==="version"&&(p[y.n]=String(p[y.n]>>16)+"."+("0000"+String(p[y.n]&65535)).slice(-4)),y.n=="CodePage")switch(p[y.n]){case 0:p[y.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:As(o=p[y.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+p[y.n])}}else if(s[a][0]===1){if(o=p.CodePage=jh(t,V1),As(o),l!==-1){var x=t.l;t.l=s[l][1],c=q_(t,o),t.l=x}}else if(s[a][0]===0){if(o===0){l=a,t.l=s[a+1][1];continue}c=q_(t,o)}else{var E=c[s[a][0]],T;switch(t[t.l]){case 65:t.l+=4,T=ok(t);break;case 30:t.l+=4,T=Jm(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,T=Jm(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,T=t.read_shift(4,"i");break;case 19:t.l+=4,T=t.read_shift(4);break;case 5:t.l+=4,T=t.read_shift(8,"f");break;case 11:t.l+=4,T=Dr(t,4);break;case 64:t.l+=4,T=lr(z1(t));break;default:throw new Error("unparsed value: "+t[t.l])}p[E]=T}}return t.l=r+n,p}var lk=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function AN(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function J_(t,e,r){var n=pe(8),i=[],s=[],a=8,o=0,l=pe(8),c=pe(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),s.push(l),i.push(c),a+=8+l.length,!e){c=pe(8),c.write_shift(4,0),i.unshift(c);var d=[pe(4)];for(d[0].write_shift(4,t.length),o=0;o<t.length;++o){var h=t[o][0];for(l=pe(8+2*(h.length+1)+(h.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,h.length+1),l.write_shift(0,h,"dbcs");l.l!=l.length;)l.write_shift(1,0);d.push(l)}l=ln(d),s.unshift(l),a+=8+l.length}for(o=0;o<t.length;++o)if(!(e&&!e[t[o][0]])&&!(lk.indexOf(t[o][0])>-1||ek.indexOf(t[o][0])>-1)&&t[o][1]!=null){var p=t[o][1],m=0;if(e){m=+e[t[o][0]];var y=r[m];if(y.p=="version"&&typeof p=="string"){var x=p.split(".");p=(+x[0]<<16)+(+x[1]||0)}l=Y_(y.t,p)}else{var E=AN(p);E==-1&&(E=31,p=String(p)),l=Y_(E,p)}s.push(l),c=pe(8),c.write_shift(4,e?m:2+o),i.push(c),a+=8+l.length}var T=8*(s.length+1);for(o=0;o<s.length;++o)i[o].write_shift(4,T),T+=s[o].length;return n.write_shift(4,a),n.write_shift(4,s.length),ln([n].concat(i).concat(s))}function Z_(t,e,r){var n=t.content;if(!n)return{};En(n,0);var i,s,a,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),d=n.read_shift(16);if(d!==Ze.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(s=n.read_shift(16),o=n.read_shift(4),i===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);i===2&&(a=n.read_shift(16),l=n.read_shift(4));var h=Q_(n,e),p={SystemIdentifier:c};for(var m in h)p[m]=h[m];if(p.FMTID=s,i===1)return p;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var y;try{y=Q_(n,null)}catch{}for(m in y)p[m]=y[m];return p.FMTID=[s,a],p}function e2(t,e,r,n,i,s){var a=pe(i?68:48),o=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,Ze.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,i?2:1),a.write_shift(16,e,"hex"),a.write_shift(4,i?68:48);var l=J_(t,r,n);if(o.push(l),i){var c=J_(i,null,null);a.write_shift(16,s,"hex"),a.write_shift(4,68+l.length),o.push(c)}return ln(o)}function Ja(t,e){return t.read_shift(e),null}function CN(t,e){e||(e=pe(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function FN(t,e,r){for(var n=[],i=t.l+e;t.l<i;)n.push(r(t,i-t.l));if(i!==t.l)throw new Error("Slurp error");return n}function Dr(t,e){return t.read_shift(e)===1}function ni(t,e){return e||(e=pe(2)),e.write_shift(2,+!!t),e}function zr(t){return t.read_shift(2,"u")}function es(t,e){return e||(e=pe(2)),e.write_shift(2,t),e}function ck(t,e){return FN(t,e,zr)}function IN(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function uk(t,e,r){return r||(r=pe(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function p0(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=t.read_shift(1);s&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var a=n?t.read_shift(n,i):"";return a}function bN(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,i=r&8,s=1+(r&1),a=0,o,l={};i&&(a=t.read_shift(2)),n&&(o=t.read_shift(4));var c=s==2?"dbcs-cont":"sbcs-cont",d=e===0?"":t.read_shift(e,c);return i&&(t.l+=4*a),n&&(t.l+=o),l.t=d,i||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function RN(t){var e=t.t||"",r=pe(3);r.write_shift(2,e.length),r.write_shift(1,1);var n=pe(2*e.length);n.write_shift(2*e.length,e,"utf16le");var i=[r,n];return ln(i)}function Al(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var i=t.read_shift(1);return i===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function g0(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):Al(t,n,r)}function Ul(t,e,r){if(r.biff>5)return g0(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function fk(t,e,r){return r||(r=pe(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function NN(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function DN(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var i=t.read_shift((n?e-24:e)>>1,"utf16le").replace(si,"");return n&&(t.l+=24),i}function PN(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=t.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var s=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var a=t.read_shift(s>>1,"utf16le").replace(si,"");return r+a}function ON(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return DN(t);case"0303000000000000c000000000000046":return PN(t);default:throw new Error("Unsupported Moniker "+r)}}function wd(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(si,""):"";return r}function t2(t,e){e||(e=pe(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function MN(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=t.read_shift(2);t.l+=2;var s,a,o,l,c="",d,h;i&16&&(s=wd(t,r-t.l)),i&128&&(a=wd(t,r-t.l)),(i&257)===257&&(o=wd(t,r-t.l)),(i&257)===1&&(l=ON(t,r-t.l)),i&8&&(c=wd(t,r-t.l)),i&32&&(d=t.read_shift(16)),i&64&&(h=z1(t)),t.l=r;var p=a||o||l||"";p&&c&&(p+="#"+c),p||(p="#"+c),i&2&&p.charAt(0)=="/"&&p.charAt(1)!="/"&&(p="file://"+p);var m={Target:p};return d&&(m.guid=d),h&&(m.time=h),s&&(m.Tooltip=s),m}function LN(t){var e=pe(512),r=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),s=i>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}e.write_shift(4,2),e.write_shift(4,s);var a=[8,6815827,6619237,4849780,83];for(r=0;r<a.length;++r)e.write_shift(4,a[r]);if(s==28)n=n.slice(1),t2(n,e);else if(s&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<a.length;++r)e.write_shift(1,parseInt(a[r],16));var o=i>-1?n.slice(0,i):n;for(e.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)e.write_shift(2,o.charCodeAt(r));e.write_shift(2,0),s&8&&t2(i>-1?n.slice(i+1):"",e)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<a.length;++r)e.write_shift(1,parseInt(a[r],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(e.write_shift(2,l),e.write_shift(4,n.length-3*l+1),r=0;r<n.length-3*l;++r)e.write_shift(1,n.charCodeAt(r+3*l)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function dk(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),i=t.read_shift(1);return[e,r,n,i]}function hk(t,e){var r=dk(t);return r[3]=0,r}function na(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function Cl(t,e,r,n){return n||(n=pe(6)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r||0),n}function BN(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function jN(t,e,r){return e===0?"":Ul(t,e,r)}function VN(t,e,r){var n=r.biff>8?4:2,i=t.read_shift(n),s=t.read_shift(n,"i"),a=t.read_shift(n,"i");return[i,s,a]}function pk(t){var e=t.read_shift(2),r=j1(t);return[e,r]}function UN(t,e,r){t.l+=4,e-=4;var n=t.l+e,i=p0(t,e,r),s=t.read_shift(2);if(n-=t.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return t.l+=s,i}function Cp(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2);return{s:{c:n,r:e},e:{c:i,r}}}function gk(t,e){return e||(e=pe(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function mk(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),i=t.read_shift(1);return{s:{c:n,r:e},e:{c:i,r}}}var zN=mk;function xk(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function WN(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function $N(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function Ln(t){t.l+=2,t.l+=t.read_shift(2)}var HN={0:Ln,4:Ln,5:Ln,6:Ln,7:$N,8:Ln,9:Ln,10:Ln,11:Ln,12:Ln,13:WN,14:Ln,15:Ln,16:Ln,17:Ln,18:Ln,19:Ln,20:Ln,21:xk};function GN(t,e){for(var r=t.l+e,n=[];t.l<r;){var i=t.read_shift(2);t.l-=2;try{n.push(HN[i](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function Td(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function W1(t,e,r){var n=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=pe(i);return s.write_shift(2,n),s.write_shift(2,e),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function KN(t,e){return e===0||t.read_shift(2),1200}function XN(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,i=Ul(t,0,r);return t.read_shift(e+n-t.l),i}function qN(t,e){var r=!e||e.biff==8,n=pe(r?112:54);for(n.write_shift(e.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function YN(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function QN(t,e,r){var n=t.read_shift(4),i=t.read_shift(1)&3,s=t.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var a=p0(t,0,r);return a.length===0&&(a="Sheet1"),{pos:n,hs:i,dt:s,name:a}}function JN(t,e){var r=!e||e.biff>=8?2:1,n=pe(8+r*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function ZN(t,e){for(var r=t.l+e,n=t.read_shift(4),i=t.read_shift(4),s=[],a=0;a!=i&&t.l<r;++a)s.push(bN(t));return s.Count=n,s.Unique=i,s}function e3(t,e){var r=pe(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var n=[],i=0;i<t.length;++i)n[i]=RN(t[i]);var s=ln([r].concat(n));return s.parts=[r.length].concat(n.map(function(a){return a.length})),s}function t3(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function r3(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function n3(t){var e=BN(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function i3(t){return t.read_shift(2),t.read_shift(4)}function r2(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var i=t.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,i]}function s3(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2),l=t.read_shift(2),c=t.read_shift(2);return{Pos:[e,r],Dim:[n,i],Flags:s,CurTab:a,FirstTab:o,Selected:l,TabRatio:c}}function a3(){var t=pe(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function o3(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function l3(t){var e=pe(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function c3(){}function u3(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=p0(t,0,r),n}function f3(t,e){var r=t.name||"Arial",n=e&&e.biff==5,i=n?15+r.length:16+2*r.length,s=pe(i);return s.write_shift(2,t.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function d3(t){var e=na(t);return e.isst=t.read_shift(4),e}function h3(t,e,r,n){var i=pe(10);return Cl(t,e,n,i),i.write_shift(4,r),i}function p3(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,i=na(t);r.biff==2&&t.l++;var s=g0(t,n-t.l,r);return i.val=s,i}function g3(t,e,r,n,i){var s=!i||i.biff==8,a=pe(8+ +s+(1+s)*r.length);return Cl(t,e,n,a),a.write_shift(2,r.length),s&&a.write_shift(1,1),a.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),a}function m3(t,e,r){var n=t.read_shift(2),i=Ul(t,0,r);return[n,i]}function x3(t,e,r,n){var i=r&&r.biff==5;n||(n=pe(i?3+e.length:5+2*e.length)),n.write_shift(2,t),n.write_shift(i?1:2,e.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}var v3=Ul;function n2(t,e,r){var n=t.l+e,i=r.biff==8||!r.biff?4:2,s=t.read_shift(i),a=t.read_shift(i),o=t.read_shift(2),l=t.read_shift(2);return t.l=n,{s:{r:s,c:o},e:{r:a,c:l}}}function y3(t,e){var r=e.biff==8||!e.biff?4:2,n=pe(2*r+6);return n.write_shift(r,t.s.r),n.write_shift(r,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function _3(t){var e=t.read_shift(2),r=t.read_shift(2),n=pk(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function E3(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),s=[];t.l<r;)s.push(pk(t));if(t.l!==r)throw new Error("MulRK read error");var a=t.read_shift(2);if(s.length!=a-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:a,rkrec:s}}function w3(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),s=[];t.l<r;)s.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var a=t.read_shift(2);if(s.length!=a-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:a,ixfe:s}}function T3(t,e,r,n){var i={},s=t.read_shift(4),a=t.read_shift(4),o=t.read_shift(4),l=t.read_shift(2);return i.patternType=nN[o>>26],n.cellStyles&&(i.alc=s&7,i.fWrap=s>>3&1,i.alcV=s>>4&7,i.fJustLast=s>>7&1,i.trot=s>>8&255,i.cIndent=s>>16&15,i.fShrinkToFit=s>>20&1,i.iReadOrder=s>>22&2,i.fAtrNum=s>>26&1,i.fAtrFnt=s>>27&1,i.fAtrAlc=s>>28&1,i.fAtrBdr=s>>29&1,i.fAtrPat=s>>30&1,i.fAtrProt=s>>31&1,i.dgLeft=a&15,i.dgRight=a>>4&15,i.dgTop=a>>8&15,i.dgBottom=a>>12&15,i.icvLeft=a>>16&127,i.icvRight=a>>23&127,i.grbitDiag=a>>30&3,i.icvTop=o&127,i.icvBottom=o>>7&127,i.icvDiag=o>>14&127,i.dgDiag=o>>21&15,i.icvFore=l&127,i.icvBack=l>>7&127,i.fsxButton=l>>14&1),i}function S3(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=T3(t,e,n.fStyle,r),n}function i2(t,e,r,n){var i=r&&r.biff==5;n||(n=pe(i?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,e<<4));var s=0;return t.numFmtId>0&&i&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function k3(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function A3(t){var e=pe(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function s2(t,e,r){var n=na(t);(r.biff==2||e==9)&&++t.l;var i=IN(t);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function C3(t,e,r,n,i,s){var a=pe(8);return Cl(t,e,n,a),uk(r,s,a),a}function F3(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=na(t),i=Hn(t);return n.val=i,n}function I3(t,e,r,n){var i=pe(14);return Cl(t,e,n,i),kl(r,i),i}var a2=jN;function b3(t,e,r){var n=t.l+e,i=t.read_shift(2),s=t.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,i];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var a=Al(t,s),o=[];n>t.l;)o.push(g0(t));return[s,i,a,o]}function o2(t,e,r){var n=t.read_shift(2),i,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=UN(t,e-2,r)),s.body=i||t.read_shift(e-2),typeof i=="string"&&(s.Name=i),s}var R3=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function l2(t,e,r){var n=t.l+e,i=t.read_shift(2),s=t.read_shift(1),a=t.read_shift(1),o=t.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),l=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var c=Al(t,a,r);i&32&&(c=R3[c.charCodeAt(0)]);var d=n-t.l;r&&r.biff==2&&--d;var h=n==t.l||o===0||!(d>0)?[]:G8(t,d,r,o);return{chKey:s,Name:c,itab:l,rgce:h}}function vk(t,e,r){if(r.biff<8)return N3(t,e,r);for(var n=[],i=t.l+e,s=t.read_shift(r.biff>8?4:2);s--!==0;)n.push(VN(t,r.biff>8?12:6,r));if(t.l!=i)throw new Error("Bad ExternSheet: "+t.l+" != "+i);return n}function N3(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=p0(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function D3(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),i=t.read_shift(2),s=Al(t,n,r),a=Al(t,i,r);return[s,a]}function P3(t,e,r){var n=mk(t);t.l++;var i=t.read_shift(1);return e-=8,[K8(t,e,r),i,n]}function c2(t,e,r){var n=zN(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,$8(t,e,r)]}function O3(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function M3(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),o=Ul(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:i},o,a,s]}}function L3(t,e,r){return M3(t,e,r)}function B3(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(Cp(t));return r}function j3(t){var e=pe(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)gk(t[r],e);return e}function V3(t,e,r){if(r&&r.biff<8)return z3(t,e,r);var n=xk(t),i=GN(t,e-22,n[1]);return{cmo:n,ft:i}}var U3={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var i=t.read_shift(1);return t.l+=i,t.l=r,{fmt:n}}};function z3(t,e,r){t.l+=4;var n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var a=[];return a.push((U3[n]||Xn)(t,e,r)),{cmo:[i,n,s],ft:a}}function W3(t,e,r){var n=t.l,i="";try{t.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],a;[0,5,7,11,12,14].indexOf(s)==-1?t.l+=6:a=NN(t,6,r);var o=t.read_shift(2);t.read_shift(2),zr(t,2);var l=t.read_shift(2);t.l+=l;for(var c=1;c<t.lens.length-1;++c){if(t.l-n!=t.lens[c])throw new Error("TxO: bad continue record");var d=t[t.l],h=Al(t,t.lens[c+1]-t.lens[c]-1);if(i+=h,i.length>=(d?o:2*o))break}if(i.length!==o&&i.length!==o*2)throw new Error("cchText: "+o+" != "+i.length);return t.l=n+e,{t:i}}catch{return t.l=n+e,{t:i}}}function $3(t,e){var r=Cp(t);t.l+=16;var n=MN(t,e-24);return[r,n]}function H3(t){var e=pe(24),r=wr(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)e.write_shift(1,parseInt(n[i],16));return ln([e,LN(t[1])])}function G3(t,e){t.read_shift(2);var r=Cp(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(si,""),[r,n]}function K3(t){var e=t[1].Tooltip,r=pe(10+2*(e.length+1));r.write_shift(2,2048);var n=wr(t[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<e.length;++i)r.write_shift(2,e.charCodeAt(i));return r.write_shift(2,0),r}function X3(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=K_[r]||r,r=t.read_shift(2),e[1]=K_[r]||r,e}function q3(t){return t||(t=pe(4)),t.write_shift(2,1),t.write_shift(2,1),t}function Y3(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(hk(t));return r}function Q3(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(hk(t));return r}function J3(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function yk(t,e,r){if(!r.cellStyles)return Xn(t,e);var n=r&&r.biff>=12?4:2,i=t.read_shift(n),s=t.read_shift(n),a=t.read_shift(n),o=t.read_shift(n),l=t.read_shift(2);n==2&&(t.l+=2);var c={s:i,e:s,w:a,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function Z3(t,e){var r=pe(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var n=0;return t.hidden&&(n|=1),r.write_shift(1,n),n=t.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function eD(t,e){var r={};return e<32||(t.l+=16,r.header=Hn(t),r.footer=Hn(t),t.l+=2),r}function tD(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var i=t.read_shift(1);return t.l+=3,i&16&&(n.area=!0),n}function rD(t){for(var e=pe(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}var nD=na,iD=ck,sD=g0;function aD(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,i}function oD(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=na(t);++t.l;var i=Ul(t,e-7,r);return n.t="str",n.val=i,n}function lD(t){var e=na(t);++t.l;var r=Hn(t);return e.t="n",e.val=r,e}function cD(t,e,r){var n=pe(15);return y0(n,t,e),n.write_shift(8,r,"f"),n}function uD(t){var e=na(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function fD(t,e,r){var n=pe(9);return y0(n,t,e),n.write_shift(2,r),n}function dD(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function hD(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function pD(t,e,r){var n=t.l+e,i=na(t),s=t.read_shift(2),a=Al(t,s,r);return t.l=n,i.t="str",i.val=a,i}var gD=[2,3,48,49,131,139,140,245],Zm=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=Sp({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var c=[],d=bo(1);switch(l.type){case"base64":d=bi(Mi(o));break;case"binary":d=bi(o);break;case"buffer":case"array":d=o;break}En(d,0);var h=d.read_shift(1),p=!!(h&136),m=!1,y=!1;switch(h){case 2:break;case 3:break;case 48:m=!0,p=!0;break;case 49:m=!0,p=!0;break;case 131:break;case 139:break;case 140:y=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var x=0,E=521;h==2&&(x=d.read_shift(2)),d.l+=3,h!=2&&(x=d.read_shift(4)),x>1048576&&(x=1e6),h!=2&&(E=d.read_shift(2));var T=d.read_shift(2),k=l.codepage||1252;h!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(k=t[d[d.l]]),d.l+=1,d.l+=2),y&&(d.l+=36);for(var _=[],P={},W=Math.min(d.length,h==2?521:E-10-(m?264:0)),B=y?32:11;d.l<W&&d[d.l]!=13;)switch(P={},P.name=Lf.utils.decode(k,d.slice(d.l,d.l+B)).replace(/[\u0000\r\n].*$/g,""),d.l+=B,P.type=String.fromCharCode(d.read_shift(1)),h!=2&&!y&&(P.offset=d.read_shift(4)),P.len=d.read_shift(1),h==2&&(P.offset=d.read_shift(2)),P.dec=d.read_shift(1),P.name.length&&_.push(P),h!=2&&(d.l+=y?13:14),P.type){case"B":(!m||P.len!=8)&&l.WTF&&console.log("Skipping "+P.name+":"+P.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+P.name+":"+P.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+P.type)}if(d[d.l]!==13&&(d.l=E-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=E;var w=0,C=0;for(c[0]=[],C=0;C!=_.length;++C)c[0][C]=_[C].name;for(;x-- >0;){if(d[d.l]===42){d.l+=T;continue}for(++d.l,c[++w]=[],C=0,C=0;C!=_.length;++C){var S=d.slice(d.l,d.l+_[C].len);d.l+=_[C].len,En(S,0);var b=Lf.utils.decode(k,S);switch(_[C].type){case"C":b.trim().length&&(c[w][C]=b.replace(/\s+$/,""));break;case"D":b.length===8?c[w][C]=new Date(+b.slice(0,4),+b.slice(4,6)-1,+b.slice(6,8)):c[w][C]=b;break;case"F":c[w][C]=parseFloat(b.trim());break;case"+":case"I":c[w][C]=y?S.read_shift(-4,"i")^2147483648:S.read_shift(4,"i");break;case"L":switch(b.trim().toUpperCase()){case"Y":case"T":c[w][C]=!0;break;case"N":case"F":c[w][C]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+b+"|")}break;case"M":if(!p)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));c[w][C]="##MEMO##"+(y?parseInt(b.trim(),10):S.read_shift(4));break;case"N":b=b.replace(/\u0000/g,"").trim(),b&&b!="."&&(c[w][C]=+b||0);break;case"@":c[w][C]=new Date(S.read_shift(-8,"f")-621356832e5);break;case"T":c[w][C]=new Date((S.read_shift(4)-2440588)*864e5+S.read_shift(4));break;case"Y":c[w][C]=S.read_shift(4,"i")/1e4+S.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[w][C]=-S.read_shift(-8,"f");break;case"B":if(m&&_[C].len==8){c[w][C]=S.read_shift(8,"f");break}case"G":case"P":S.l+=_[C].len;break;case"0":if(_[C].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+_[C].type)}}}if(h!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=_,c}function n(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var d=uu(r(o,c),c);return d["!cols"]=c.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete c.DBF,d}function i(o,l){try{return Uo(n(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,l){var c=l||{};if(+c.codepage>=0&&As(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var d=_i(),h=zh(o,{header:1,raw:!0,cellDates:!0}),p=h[0],m=h.slice(1),y=o["!cols"]||[],x=0,E=0,T=0,k=1;for(x=0;x<p.length;++x){if(((y[x]||{}).DBF||{}).name){p[x]=y[x].DBF.name,++T;continue}if(p[x]!=null){if(++T,typeof p[x]=="number"&&(p[x]=p[x].toString(10)),typeof p[x]!="string")throw new Error("DBF Invalid column name "+p[x]+" |"+typeof p[x]+"|");if(p.indexOf(p[x])!==x){for(E=0;E<1024;++E)if(p.indexOf(p[x]+"_"+E)==-1){p[x]+="_"+E;break}}}}var _=Ot(o["!ref"]),P=[],W=[],B=[];for(x=0;x<=_.e.c-_.s.c;++x){var w="",C="",S=0,b=[];for(E=0;E<m.length;++E)m[E][x]!=null&&b.push(m[E][x]);if(b.length==0||p[x]==null){P[x]="?";continue}for(E=0;E<b.length;++E){switch(typeof b[E]){case"number":C="B";break;case"string":C="C";break;case"boolean":C="L";break;case"object":C=b[E]instanceof Date?"D":"C";break;default:C="C"}S=Math.max(S,String(b[E]).length),w=w&&w!=C?"C":C}S>250&&(S=250),C=((y[x]||{}).DBF||{}).type,C=="C"&&y[x].DBF.len>S&&(S=y[x].DBF.len),w=="B"&&C=="N"&&(w="N",B[x]=y[x].DBF.dec,S=y[x].DBF.len),W[x]=w=="C"||C=="N"?S:s[w]||0,k+=W[x],P[x]=w}var N=d.next(32);for(N.write_shift(4,318902576),N.write_shift(4,m.length),N.write_shift(2,296+32*T),N.write_shift(2,k),x=0;x<4;++x)N.write_shift(4,0);for(N.write_shift(4,0|(+e[lS]||3)<<8),x=0,E=0;x<p.length;++x)if(p[x]!=null){var D=d.next(32),R=(p[x].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);D.write_shift(1,R,"sbcs"),D.write_shift(1,P[x]=="?"?"C":P[x],"sbcs"),D.write_shift(4,E),D.write_shift(1,W[x]||s[P[x]]||0),D.write_shift(1,B[x]||0),D.write_shift(1,2),D.write_shift(4,0),D.write_shift(1,0),D.write_shift(4,0),D.write_shift(4,0),E+=W[x]||s[P[x]]||0}var Ue=d.next(264);for(Ue.write_shift(4,13),x=0;x<65;++x)Ue.write_shift(4,0);for(x=0;x<m.length;++x){var ge=d.next(k);for(ge.write_shift(1,0),E=0;E<p.length;++E)if(p[E]!=null)switch(P[E]){case"L":ge.write_shift(1,m[x][E]==null?63:m[x][E]?84:70);break;case"B":ge.write_shift(8,m[x][E]||0,"f");break;case"N":var Fe="0";for(typeof m[x][E]=="number"&&(Fe=m[x][E].toFixed(B[E]||0)),T=0;T<W[E]-Fe.length;++T)ge.write_shift(1,32);ge.write_shift(1,Fe,"sbcs");break;case"D":m[x][E]?(ge.write_shift(4,("0000"+m[x][E].getFullYear()).slice(-4),"sbcs"),ge.write_shift(2,("00"+(m[x][E].getMonth()+1)).slice(-2),"sbcs"),ge.write_shift(2,("00"+m[x][E].getDate()).slice(-2),"sbcs")):ge.write_shift(8,"00000000","sbcs");break;case"C":var Ee=String(m[x][E]!=null?m[x][E]:"").slice(0,W[E]);for(ge.write_shift(1,Ee,"sbcs"),T=0;T<W[E]-Ee.length;++T)ge.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:i,to_sheet:n,from_sheet:a}}(),_k=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Nr(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(p,m){var y=t[m];return typeof y=="number"?__(y):y},n=function(p,m,y){var x=m.charCodeAt(0)-32<<4|y.charCodeAt(0)-48;return x==59?p:__(x)};t["|"]=254;function i(p,m){switch(m.type){case"base64":return s(Mi(p),m);case"binary":return s(p,m);case"buffer":return s(vt&&Buffer.isBuffer(p)?p.toString("binary"):Vo(p),m);case"array":return s(Sl(p),m)}throw new Error("Unrecognized type "+m.type)}function s(p,m){var y=p.split(/[\n\r]+/),x=-1,E=-1,T=0,k=0,_=[],P=[],W=null,B={},w=[],C=[],S=[],b=0,N;for(+m.codepage>=0&&As(+m.codepage);T!==y.length;++T){b=0;var D=y[T].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),R=D.replace(/;;/g,"\0").split(";").map(function(X){return X.replace(/\u0000/g,";")}),Ue=R[0],ge;if(D.length>0)switch(Ue){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":R[1].charAt(0)=="P"&&P.push(D.slice(3).replace(/;;/g,";"));break;case"C":var Fe=!1,Ee=!1,xe=!1,J=!1,ke=-1,Me=-1;for(k=1;k<R.length;++k)switch(R[k].charAt(0)){case"A":break;case"X":E=parseInt(R[k].slice(1))-1,Ee=!0;break;case"Y":for(x=parseInt(R[k].slice(1))-1,Ee||(E=0),N=_.length;N<=x;++N)_[N]=[];break;case"K":ge=R[k].slice(1),ge.charAt(0)==='"'?ge=ge.slice(1,ge.length-1):ge==="TRUE"?ge=!0:ge==="FALSE"?ge=!1:isNaN(Rs(ge))?isNaN(Kc(ge).getDate())||(ge=lr(ge)):(ge=Rs(ge),W!==null&&lu(W)&&(ge=Ap(ge))),Fe=!0;break;case"E":J=!0;var j=Pc(R[k].slice(1),{r:x,c:E});_[x][E]=[_[x][E],j];break;case"S":xe=!0,_[x][E]=[_[x][E],"S5S"];break;case"G":break;case"R":ke=parseInt(R[k].slice(1))-1;break;case"C":Me=parseInt(R[k].slice(1))-1;break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+D)}if(Fe&&(_[x][E]&&_[x][E].length==2?_[x][E][0]=ge:_[x][E]=ge,W=null),xe){if(J)throw new Error("SYLK shared formula cannot have own formula");var H=ke>-1&&_[ke][Me];if(!H||!H[1])throw new Error("SYLK shared formula cannot find base");_[x][E][1]=Bk(H[1],{r:x-ke,c:E-Me})}break;case"F":var q=0;for(k=1;k<R.length;++k)switch(R[k].charAt(0)){case"X":E=parseInt(R[k].slice(1))-1,++q;break;case"Y":for(x=parseInt(R[k].slice(1))-1,N=_.length;N<=x;++N)_[N]=[];break;case"M":b=parseInt(R[k].slice(1))/20;break;case"F":break;case"G":break;case"P":W=P[parseInt(R[k].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(S=R[k].slice(1).split(" "),N=parseInt(S[0],10);N<=parseInt(S[1],10);++N)b=parseInt(S[2],10),C[N-1]=b===0?{hidden:!0}:{wch:b},Ro(C[N-1]);break;case"C":E=parseInt(R[k].slice(1))-1,C[E]||(C[E]={});break;case"R":x=parseInt(R[k].slice(1))-1,w[x]||(w[x]={}),b>0?(w[x].hpt=b,w[x].hpx=qc(b)):b===0&&(w[x].hidden=!0);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+D)}q<1&&(W=null);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+D)}}return w.length>0&&(B["!rows"]=w),C.length>0&&(B["!cols"]=C),m&&m.sheetRows&&(_=_.slice(0,m.sheetRows)),[_,B]}function a(p,m){var y=i(p,m),x=y[0],E=y[1],T=uu(x,m);return Nr(E).forEach(function(k){T[k]=E[k]}),T}function o(p,m){return Uo(a(p,m),m)}function l(p,m,y,x){var E="C;Y"+(y+1)+";X"+(x+1)+";K";switch(p.t){case"n":E+=p.v||0,p.f&&!p.F&&(E+=";E"+q1(p.f,{r:y,c:x}));break;case"b":E+=p.v?"TRUE":"FALSE";break;case"e":E+=p.w||p.v;break;case"d":E+='"'+(p.w||p.v)+'"';break;case"s":E+='"'+p.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return E}function c(p,m){m.forEach(function(y,x){var E="F;W"+(x+1)+" "+(x+1)+" ";y.hidden?E+="0":(typeof y.width=="number"&&!y.wpx&&(y.wpx=Hf(y.width)),typeof y.wpx=="number"&&!y.wch&&(y.wch=Gf(y.wpx)),typeof y.wch=="number"&&(E+=Math.round(y.wch))),E.charAt(E.length-1)!=" "&&p.push(E)})}function d(p,m){m.forEach(function(y,x){var E="F;";y.hidden?E+="M0;":y.hpt?E+="M"+20*y.hpt+";":y.hpx&&(E+="M"+20*Kf(y.hpx)+";"),E.length>2&&p.push(E+"R"+(x+1))})}function h(p,m){var y=["ID;PWXL;N;E"],x=[],E=Ot(p["!ref"]),T,k=Array.isArray(p),_=`\r
`;y.push("P;PGeneral"),y.push("F;P0;DG0G8;M255"),p["!cols"]&&c(y,p["!cols"]),p["!rows"]&&d(y,p["!rows"]),y.push("B;Y"+(E.e.r-E.s.r+1)+";X"+(E.e.c-E.s.c+1)+";D"+[E.s.c,E.s.r,E.e.c,E.e.r].join(" "));for(var P=E.s.r;P<=E.e.r;++P)for(var W=E.s.c;W<=E.e.c;++W){var B=st({r:P,c:W});T=k?(p[P]||[])[W]:p[B],!(!T||T.v==null&&(!T.f||T.F))&&x.push(l(T,p,P,W))}return y.join(_)+_+x.join(_)+_+"E"+_}return{to_workbook:o,to_sheet:a,from_sheet:h}}(),Ek=function(){function t(s,a){switch(a.type){case"base64":return e(Mi(s),a);case"binary":return e(s,a);case"buffer":return e(vt&&Buffer.isBuffer(s)?s.toString("binary"):Vo(s),a);case"array":return e(Sl(s),a)}throw new Error("Unrecognized type "+a.type)}function e(s,a){for(var o=s.split(`
`),l=-1,c=-1,d=0,h=[];d!==o.length;++d){if(o[d].trim()==="BOT"){h[++l]=[],c=0;continue}if(!(l<0)){var p=o[d].trim().split(","),m=p[0],y=p[1];++d;for(var x=o[d]||"";(x.match(/["]/g)||[]).length&1&&d<o.length-1;)x+=`
`+o[++d];switch(x=x.trim(),+m){case-1:if(x==="BOT"){h[++l]=[],c=0;continue}else if(x!=="EOD")throw new Error("Unrecognized DIF special command "+x);break;case 0:x==="TRUE"?h[l][c]=!0:x==="FALSE"?h[l][c]=!1:isNaN(Rs(y))?isNaN(Kc(y).getDate())?h[l][c]=y:h[l][c]=lr(y):h[l][c]=Rs(y),++c;break;case 1:x=x.slice(1,x.length-1),x=x.replace(/""/g,'"'),x&&x.match(/^=".*"$/)&&(x=x.slice(2,-1)),h[l][c++]=x!==""?x:null;break}if(x==="EOD")break}}return a&&a.sheetRows&&(h=h.slice(0,a.sheetRows)),h}function r(s,a){return uu(t(s,a),a)}function n(s,a){return Uo(r(s,a),a)}var i=function(){var s=function(l,c,d,h,p){l.push(c),l.push(d+","+h),l.push('"'+p.replace(/"/g,'""')+'"')},a=function(l,c,d,h){l.push(c+","+d),l.push(c==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(l){var c=[],d=Ot(l["!ref"]),h,p=Array.isArray(l);s(c,"TABLE",0,1,"sheetjs"),s(c,"VECTORS",0,d.e.r-d.s.r+1,""),s(c,"TUPLES",0,d.e.c-d.s.c+1,""),s(c,"DATA",0,0,"");for(var m=d.s.r;m<=d.e.r;++m){a(c,-1,0,"BOT");for(var y=d.s.c;y<=d.e.c;++y){var x=st({r:m,c:y});if(h=p?(l[m]||[])[y]:l[x],!h){a(c,1,0,"");continue}switch(h.t){case"n":var E=h.w;!E&&h.v!=null&&(E=h.v),E==null?h.f&&!h.F?a(c,1,0,"="+h.f):a(c,1,0,""):a(c,0,E,"V");break;case"b":a(c,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":a(c,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=cs(h.z||it[14],Jr(lr(h.v)))),a(c,0,h.w,"V");break;default:a(c,1,0,"")}}}a(c,-1,0,"EOD");var T=`\r
`,k=c.join(T);return k}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),wk=function(){function t(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(h,p){for(var m=h.split(`
`),y=-1,x=-1,E=0,T=[];E!==m.length;++E){var k=m[E].trim().split(":");if(k[0]==="cell"){var _=wr(k[1]);if(T.length<=_.r)for(y=T.length;y<=_.r;++y)T[y]||(T[y]=[]);switch(y=_.r,x=_.c,k[2]){case"t":T[y][x]=t(k[3]);break;case"v":T[y][x]=+k[3];break;case"vtf":var P=k[k.length-1];case"vtc":switch(k[3]){case"nl":T[y][x]=!!+k[4];break;default:T[y][x]=+k[4];break}k[2]=="vtf"&&(T[y][x]=[T[y][x],P])}}}return p&&p.sheetRows&&(T=T.slice(0,p.sheetRows)),T}function n(h,p){return uu(r(h,p),p)}function i(h,p){return Uo(n(h,p),p)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(h){if(!h||!h["!ref"])return"";for(var p=[],m=[],y,x="",E=Ei(h["!ref"]),T=Array.isArray(h),k=E.s.r;k<=E.e.r;++k)for(var _=E.s.c;_<=E.e.c;++_)if(x=st({r:k,c:_}),y=T?(h[k]||[])[_]:h[x],!(!y||y.v==null||y.t==="z")){switch(m=["cell",x,"t"],y.t){case"s":case"str":m.push(e(y.v));break;case"n":y.f?(m[2]="vtf",m[3]="n",m[4]=y.v,m[5]=e(y.f)):(m[2]="v",m[3]=y.v);break;case"b":m[2]="vt"+(y.f?"f":"c"),m[3]="nl",m[4]=y.v?"1":"0",m[5]=e(y.f||(y.v?"TRUE":"FALSE"));break;case"d":var P=Jr(lr(y.v));m[2]="vtc",m[3]="nd",m[4]=""+P,m[5]=y.w||cs(y.z||it[14],P);break;case"e":continue}p.push(m.join(":"))}return p.push("sheet:c:"+(E.e.c-E.s.c+1)+":r:"+(E.e.r-E.s.r+1)+":tvf:1"),p.push("valueformat:1:text-wiki"),p.join(`
`)}function d(h){return[s,a,o,a,c(h),l].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:d}}(),Xc=function(){function t(d,h,p,m,y){y.raw?h[p][m]=d:d===""||(d==="TRUE"?h[p][m]=!0:d==="FALSE"?h[p][m]=!1:isNaN(Rs(d))?isNaN(Kc(d).getDate())?h[p][m]=d:h[p][m]=lr(d):h[p][m]=Rs(d))}function e(d,h){var p=h||{},m=[];if(!d||d.length===0)return m;for(var y=d.split(/[\r\n]/),x=y.length-1;x>=0&&y[x].length===0;)--x;for(var E=10,T=0,k=0;k<=x;++k)T=y[k].indexOf(" "),T==-1?T=y[k].length:T++,E=Math.max(E,T);for(k=0;k<=x;++k){m[k]=[];var _=0;for(t(y[k].slice(0,E).trim(),m,k,_,p),_=1;_<=(y[k].length-E)/10+1;++_)t(y[k].slice(E+(_-1)*10,E+_*10).trim(),m,k,_,p)}return p.sheetRows&&(m=m.slice(0,p.sheetRows)),m}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(d){for(var h={},p=!1,m=0,y=0;m<d.length;++m)(y=d.charCodeAt(m))==34?p=!p:!p&&y in r&&(h[y]=(h[y]||0)+1);y=[];for(m in h)Object.prototype.hasOwnProperty.call(h,m)&&y.push([h[m],m]);if(!y.length){h=n;for(m in h)Object.prototype.hasOwnProperty.call(h,m)&&y.push([h[m],m])}return y.sort(function(x,E){return x[0]-E[0]||n[x[1]]-n[E[1]]}),r[y.pop()[1]]||44}function s(d,h){var p=h||{},m="",y=p.dense?[]:{},x={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(m=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(m=d.charAt(4),d=d.slice(6)):m=i(d.slice(0,1024)):p&&p.FS?m=p.FS:m=i(d.slice(0,1024));var E=0,T=0,k=0,_=0,P=0,W=m.charCodeAt(0),B=!1,w=0,C=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var S=p.dateNF!=null?tR(p.dateNF):null;function b(){var N=d.slice(_,P),D={};if(N.charAt(0)=='"'&&N.charAt(N.length-1)=='"'&&(N=N.slice(1,-1).replace(/""/g,'"')),N.length===0)D.t="z";else if(p.raw)D.t="s",D.v=N;else if(N.trim().length===0)D.t="s",D.v=N;else if(N.charCodeAt(0)==61)N.charCodeAt(1)==34&&N.charCodeAt(N.length-1)==34?(D.t="s",D.v=N.slice(2,-1).replace(/""/g,'"')):b6(N)?(D.t="n",D.f=N.slice(1)):(D.t="s",D.v=N);else if(N=="TRUE")D.t="b",D.v=!0;else if(N=="FALSE")D.t="b",D.v=!1;else if(!isNaN(k=Rs(N)))D.t="n",p.cellText!==!1&&(D.w=N),D.v=k;else if(!isNaN(Kc(N).getDate())||S&&N.match(S)){D.z=p.dateNF||it[14];var R=0;S&&N.match(S)&&(N=rR(N,p.dateNF,N.match(S)||[]),R=1),p.cellDates?(D.t="d",D.v=lr(N,R)):(D.t="n",D.v=Jr(lr(N,R))),p.cellText!==!1&&(D.w=cs(D.z,D.v instanceof Date?Jr(D.v):D.v)),p.cellNF||delete D.z}else D.t="s",D.v=N;if(D.t=="z"||(p.dense?(y[E]||(y[E]=[]),y[E][T]=D):y[st({c:T,r:E})]=D),_=P+1,C=d.charCodeAt(_),x.e.c<T&&(x.e.c=T),x.e.r<E&&(x.e.r=E),w==W)++T;else if(T=0,++E,p.sheetRows&&p.sheetRows<=E)return!0}e:for(;P<d.length;++P)switch(w=d.charCodeAt(P)){case 34:C===34&&(B=!B);break;case W:case 10:case 13:if(!B&&b())break e;break}return P-_>0&&b(),y["!ref"]=mt(x),y}function a(d,h){return!(h&&h.PRN)||h.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?s(d,h):uu(e(d,h),h)}function o(d,h){var p="",m=h.type=="string"?[0,0,0,0]:nv(d,h);switch(h.type){case"base64":p=Mi(d);break;case"binary":p=d;break;case"buffer":h.codepage==65001?p=d.toString("utf8"):h.codepage&&typeof Lf<"u"||(p=vt&&Buffer.isBuffer(d)?d.toString("binary"):Vo(d));break;case"array":p=Sl(d);break;case"string":p=d;break;default:throw new Error("Unrecognized type "+h.type)}return m[0]==239&&m[1]==187&&m[2]==191?p=Jt(p.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?p=Jt(p):h.type=="binary"&&typeof Lf<"u",p.slice(0,19)=="socialcalc:version:"?wk.to_sheet(h.type=="string"?p:Jt(p),h):a(p,h)}function l(d,h){return Uo(o(d,h),h)}function c(d){for(var h=[],p=Ot(d["!ref"]),m,y=Array.isArray(d),x=p.s.r;x<=p.e.r;++x){for(var E=[],T=p.s.c;T<=p.e.c;++T){var k=st({r:x,c:T});if(m=y?(d[x]||[])[T]:d[k],!m||m.v==null){E.push("          ");continue}for(var _=(m.w||(Ia(m),m.w)||"").slice(0,10);_.length<10;)_+=" ";E.push(_+(T===0?" ":""))}h.push(E.join(""))}return h.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}}();function mD(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var i=_k.to_workbook(t,r);return r.WTF=n,i}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return Xc.to_workbook(t,e)}}var pl=function(){function t(j,H,q){if(j){En(j,j.l||0);for(var X=q.Enum||ke;j.l<j.length;){var de=j.read_shift(2),we=X[de]||X[65535],Ne=j.read_shift(2),Te=j.l+Ne,_e=we.f&&we.f(j,Ne,q);if(j.l=Te,H(_e,we,de))return}}}function e(j,H){switch(H.type){case"base64":return r(bi(Mi(j)),H);case"binary":return r(bi(j),H);case"buffer":case"array":return r(j,H)}throw"Unsupported type "+H.type}function r(j,H){if(!j)return j;var q=H||{},X=q.dense?[]:{},de="Sheet1",we="",Ne=0,Te={},_e=[],rt=[],G={s:{r:0,c:0},e:{r:0,c:0}},Vt=q.sheetRows||0;if(j[2]==0&&(j[3]==8||j[3]==9)&&j.length>=16&&j[14]==5&&j[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(j[2]==2)q.Enum=ke,t(j,function($e,Zt,fn){switch(fn){case 0:q.vers=$e,$e>=4096&&(q.qpro=!0);break;case 6:G=$e;break;case 204:$e&&(we=$e);break;case 222:we=$e;break;case 15:case 51:q.qpro||($e[1].v=$e[1].v.slice(1));case 13:case 14:case 16:fn==14&&($e[2]&112)==112&&($e[2]&15)>1&&($e[2]&15)<15&&($e[1].z=q.dateNF||it[14],q.cellDates&&($e[1].t="d",$e[1].v=Ap($e[1].v))),q.qpro&&$e[3]>Ne&&(X["!ref"]=mt(G),Te[de]=X,_e.push(de),X=q.dense?[]:{},G={s:{r:0,c:0},e:{r:0,c:0}},Ne=$e[3],de=we||"Sheet"+(Ne+1),we="");var $r=q.dense?(X[$e[0].r]||[])[$e[0].c]:X[st($e[0])];if($r){$r.t=$e[1].t,$r.v=$e[1].v,$e[1].z!=null&&($r.z=$e[1].z),$e[1].f!=null&&($r.f=$e[1].f);break}q.dense?(X[$e[0].r]||(X[$e[0].r]=[]),X[$e[0].r][$e[0].c]=$e[1]):X[st($e[0])]=$e[1];break}},q);else if(j[2]==26||j[2]==14)q.Enum=Me,j[2]==14&&(q.qpro=!0,j.l=0),t(j,function($e,Zt,fn){switch(fn){case 204:de=$e;break;case 22:$e[1].v=$e[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if($e[3]>Ne&&(X["!ref"]=mt(G),Te[de]=X,_e.push(de),X=q.dense?[]:{},G={s:{r:0,c:0},e:{r:0,c:0}},Ne=$e[3],de="Sheet"+(Ne+1)),Vt>0&&$e[0].r>=Vt)break;q.dense?(X[$e[0].r]||(X[$e[0].r]=[]),X[$e[0].r][$e[0].c]=$e[1]):X[st($e[0])]=$e[1],G.e.c<$e[0].c&&(G.e.c=$e[0].c),G.e.r<$e[0].r&&(G.e.r=$e[0].r);break;case 27:$e[14e3]&&(rt[$e[14e3][0]]=$e[14e3][1]);break;case 1537:rt[$e[0]]=$e[1],$e[0]==Ne&&(de=$e[1]);break}},q);else throw new Error("Unrecognized LOTUS BOF "+j[2]);if(X["!ref"]=mt(G),Te[we||de]=X,_e.push(we||de),!rt.length)return{SheetNames:_e,Sheets:Te};for(var gt={},Rt=[],dt=0;dt<rt.length;++dt)Te[_e[dt]]?(Rt.push(rt[dt]||_e[dt]),gt[rt[dt]]=Te[rt[dt]]||Te[_e[dt]]):(Rt.push(rt[dt]),gt[rt[dt]]={"!ref":"A1"});return{SheetNames:Rt,Sheets:gt}}function n(j,H){var q=H||{};if(+q.codepage>=0&&As(+q.codepage),q.type=="string")throw new Error("Cannot write WK1 to JS string");var X=_i(),de=Ot(j["!ref"]),we=Array.isArray(j),Ne=[];je(X,0,s(1030)),je(X,6,l(de));for(var Te=Math.min(de.e.r,8191),_e=de.s.r;_e<=Te;++_e)for(var rt=Mr(_e),G=de.s.c;G<=de.e.c;++G){_e===de.s.r&&(Ne[G]=Er(G));var Vt=Ne[G]+rt,gt=we?(j[_e]||[])[G]:j[Vt];if(!(!gt||gt.t=="z"))if(gt.t=="n")(gt.v|0)==gt.v&&gt.v>=-32768&&gt.v<=32767?je(X,13,m(_e,G,gt.v)):je(X,14,x(_e,G,gt.v));else{var Rt=Ia(gt);je(X,15,h(_e,G,Rt.slice(0,239)))}}return je(X,1),X.end()}function i(j,H){var q=H||{};if(+q.codepage>=0&&As(+q.codepage),q.type=="string")throw new Error("Cannot write WK3 to JS string");var X=_i();je(X,0,a(j));for(var de=0,we=0;de<j.SheetNames.length;++de)(j.Sheets[j.SheetNames[de]]||{})["!ref"]&&je(X,27,J(j.SheetNames[de],we++));var Ne=0;for(de=0;de<j.SheetNames.length;++de){var Te=j.Sheets[j.SheetNames[de]];if(!(!Te||!Te["!ref"])){for(var _e=Ot(Te["!ref"]),rt=Array.isArray(Te),G=[],Vt=Math.min(_e.e.r,8191),gt=_e.s.r;gt<=Vt;++gt)for(var Rt=Mr(gt),dt=_e.s.c;dt<=_e.e.c;++dt){gt===_e.s.r&&(G[dt]=Er(dt));var $e=G[dt]+Rt,Zt=rt?(Te[gt]||[])[dt]:Te[$e];if(!(!Zt||Zt.t=="z"))if(Zt.t=="n")je(X,23,b(gt,dt,Ne,Zt.v));else{var fn=Ia(Zt);je(X,22,w(gt,dt,Ne,fn.slice(0,239)))}}++Ne}}return je(X,1),X.end()}function s(j){var H=pe(2);return H.write_shift(2,j),H}function a(j){var H=pe(26);H.write_shift(2,4096),H.write_shift(2,4),H.write_shift(4,0);for(var q=0,X=0,de=0,we=0;we<j.SheetNames.length;++we){var Ne=j.SheetNames[we],Te=j.Sheets[Ne];if(!(!Te||!Te["!ref"])){++de;var _e=Ei(Te["!ref"]);q<_e.e.r&&(q=_e.e.r),X<_e.e.c&&(X=_e.e.c)}}return q>8191&&(q=8191),H.write_shift(2,q),H.write_shift(1,de),H.write_shift(1,X),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(1,1),H.write_shift(1,2),H.write_shift(4,0),H.write_shift(4,0),H}function o(j,H,q){var X={s:{c:0,r:0},e:{c:0,r:0}};return H==8&&q.qpro?(X.s.c=j.read_shift(1),j.l++,X.s.r=j.read_shift(2),X.e.c=j.read_shift(1),j.l++,X.e.r=j.read_shift(2),X):(X.s.c=j.read_shift(2),X.s.r=j.read_shift(2),H==12&&q.qpro&&(j.l+=2),X.e.c=j.read_shift(2),X.e.r=j.read_shift(2),H==12&&q.qpro&&(j.l+=2),X.s.c==65535&&(X.s.c=X.e.c=X.s.r=X.e.r=0),X)}function l(j){var H=pe(8);return H.write_shift(2,j.s.c),H.write_shift(2,j.s.r),H.write_shift(2,j.e.c),H.write_shift(2,j.e.r),H}function c(j,H,q){var X=[{c:0,r:0},{t:"n",v:0},0,0];return q.qpro&&q.vers!=20768?(X[0].c=j.read_shift(1),X[3]=j.read_shift(1),X[0].r=j.read_shift(2),j.l+=2):(X[2]=j.read_shift(1),X[0].c=j.read_shift(2),X[0].r=j.read_shift(2)),X}function d(j,H,q){var X=j.l+H,de=c(j,H,q);if(de[1].t="s",q.vers==20768){j.l++;var we=j.read_shift(1);return de[1].v=j.read_shift(we,"utf8"),de}return q.qpro&&j.l++,de[1].v=j.read_shift(X-j.l,"cstr"),de}function h(j,H,q){var X=pe(7+q.length);X.write_shift(1,255),X.write_shift(2,H),X.write_shift(2,j),X.write_shift(1,39);for(var de=0;de<X.length;++de){var we=q.charCodeAt(de);X.write_shift(1,we>=128?95:we)}return X.write_shift(1,0),X}function p(j,H,q){var X=c(j,H,q);return X[1].v=j.read_shift(2,"i"),X}function m(j,H,q){var X=pe(7);return X.write_shift(1,255),X.write_shift(2,H),X.write_shift(2,j),X.write_shift(2,q,"i"),X}function y(j,H,q){var X=c(j,H,q);return X[1].v=j.read_shift(8,"f"),X}function x(j,H,q){var X=pe(13);return X.write_shift(1,255),X.write_shift(2,H),X.write_shift(2,j),X.write_shift(8,q,"f"),X}function E(j,H,q){var X=j.l+H,de=c(j,H,q);if(de[1].v=j.read_shift(8,"f"),q.qpro)j.l=X;else{var we=j.read_shift(2);P(j.slice(j.l,j.l+we),de),j.l+=we}return de}function T(j,H,q){var X=H&32768;return H&=-32769,H=(X?j:0)+(H>=8192?H-16384:H),(X?"":"$")+(q?Er(H):Mr(H))}var k={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},_=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function P(j,H){En(j,0);for(var q=[],X=0,de="",we="",Ne="",Te="";j.l<j.length;){var _e=j[j.l++];switch(_e){case 0:q.push(j.read_shift(8,"f"));break;case 1:we=T(H[0].c,j.read_shift(2),!0),de=T(H[0].r,j.read_shift(2),!1),q.push(we+de);break;case 2:{var rt=T(H[0].c,j.read_shift(2),!0),G=T(H[0].r,j.read_shift(2),!1);we=T(H[0].c,j.read_shift(2),!0),de=T(H[0].r,j.read_shift(2),!1),q.push(rt+G+":"+we+de)}break;case 3:if(j.l<j.length){console.error("WK1 premature formula end");return}break;case 4:q.push("("+q.pop()+")");break;case 5:q.push(j.read_shift(2));break;case 6:{for(var Vt="";_e=j[j.l++];)Vt+=String.fromCharCode(_e);q.push('"'+Vt.replace(/"/g,'""')+'"')}break;case 8:q.push("-"+q.pop());break;case 23:q.push("+"+q.pop());break;case 22:q.push("NOT("+q.pop()+")");break;case 20:case 21:Te=q.pop(),Ne=q.pop(),q.push(["AND","OR"][_e-20]+"("+Ne+","+Te+")");break;default:if(_e<32&&_[_e])Te=q.pop(),Ne=q.pop(),q.push(Ne+_[_e]+Te);else if(k[_e]){if(X=k[_e][1],X==69&&(X=j[j.l++]),X>q.length){console.error("WK1 bad formula parse 0x"+_e.toString(16)+":|"+q.join("|")+"|");return}var gt=q.slice(-X);q.length-=X,q.push(k[_e][0]+"("+gt.join(",")+")")}else return _e<=7?console.error("WK1 invalid opcode "+_e.toString(16)):_e<=24?console.error("WK1 unsupported op "+_e.toString(16)):_e<=30?console.error("WK1 invalid opcode "+_e.toString(16)):_e<=115?console.error("WK1 unsupported function opcode "+_e.toString(16)):console.error("WK1 unrecognized opcode "+_e.toString(16))}}q.length==1?H[1].f=""+q[0]:console.error("WK1 bad formula parse |"+q.join("|")+"|")}function W(j){var H=[{c:0,r:0},{t:"n",v:0},0];return H[0].r=j.read_shift(2),H[3]=j[j.l++],H[0].c=j[j.l++],H}function B(j,H){var q=W(j);return q[1].t="s",q[1].v=j.read_shift(H-4,"cstr"),q}function w(j,H,q,X){var de=pe(6+X.length);de.write_shift(2,j),de.write_shift(1,q),de.write_shift(1,H),de.write_shift(1,39);for(var we=0;we<X.length;++we){var Ne=X.charCodeAt(we);de.write_shift(1,Ne>=128?95:Ne)}return de.write_shift(1,0),de}function C(j,H){var q=W(j);q[1].v=j.read_shift(2);var X=q[1].v>>1;if(q[1].v&1)switch(X&7){case 0:X=(X>>3)*5e3;break;case 1:X=(X>>3)*500;break;case 2:X=(X>>3)/20;break;case 3:X=(X>>3)/200;break;case 4:X=(X>>3)/2e3;break;case 5:X=(X>>3)/2e4;break;case 6:X=(X>>3)/16;break;case 7:X=(X>>3)/64;break}return q[1].v=X,q}function S(j,H){var q=W(j),X=j.read_shift(4),de=j.read_shift(4),we=j.read_shift(2);if(we==65535)return X===0&&de===3221225472?(q[1].t="e",q[1].v=15):X===0&&de===3489660928?(q[1].t="e",q[1].v=42):q[1].v=0,q;var Ne=we&32768;return we=(we&32767)-16446,q[1].v=(1-Ne*2)*(de*Math.pow(2,we+32)+X*Math.pow(2,we)),q}function b(j,H,q,X){var de=pe(14);if(de.write_shift(2,j),de.write_shift(1,q),de.write_shift(1,H),X==0)return de.write_shift(4,0),de.write_shift(4,0),de.write_shift(2,65535),de;var we=0,Ne=0,Te=0,_e=0;return X<0&&(we=1,X=-X),Ne=Math.log2(X)|0,X/=Math.pow(2,Ne-31),_e=X>>>0,_e&2147483648||(X/=2,++Ne,_e=X>>>0),X-=_e,_e|=2147483648,_e>>>=0,X*=Math.pow(2,32),Te=X>>>0,de.write_shift(4,Te),de.write_shift(4,_e),Ne+=16383+(we?32768:0),de.write_shift(2,Ne),de}function N(j,H){var q=S(j);return j.l+=H-14,q}function D(j,H){var q=W(j),X=j.read_shift(4);return q[1].v=X>>6,q}function R(j,H){var q=W(j),X=j.read_shift(8,"f");return q[1].v=X,q}function Ue(j,H){var q=R(j);return j.l+=H-10,q}function ge(j,H){return j[j.l+H-1]==0?j.read_shift(H,"cstr"):""}function Fe(j,H){var q=j[j.l++];q>H-1&&(q=H-1);for(var X="";X.length<q;)X+=String.fromCharCode(j[j.l++]);return X}function Ee(j,H,q){if(!(!q.qpro||H<21)){var X=j.read_shift(1);j.l+=17,j.l+=1,j.l+=2;var de=j.read_shift(H-21,"cstr");return[X,de]}}function xe(j,H){for(var q={},X=j.l+H;j.l<X;){var de=j.read_shift(2);if(de==14e3){for(q[de]=[0,""],q[de][0]=j.read_shift(2);j[j.l];)q[de][1]+=String.fromCharCode(j[j.l]),j.l++;j.l++}}return q}function J(j,H){var q=pe(5+j.length);q.write_shift(2,14e3),q.write_shift(2,H);for(var X=0;X<j.length;++X){var de=j.charCodeAt(X);q[q.l++]=de>127?95:de}return q[q.l++]=0,q}var ke={0:{n:"BOF",f:zr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:p},14:{n:"NUMBER",f:y},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:E},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ge},222:{n:"SHEETNAMELP",f:Fe},65535:{n:""}},Me={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:B},23:{n:"NUMBER17",f:S},24:{n:"NUMBER18",f:C},25:{n:"FORMULA19",f:N},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:xe},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:D},38:{n:"??"},39:{n:"NUMBER27",f:R},40:{n:"FORMULA28",f:Ue},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ge},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Ee},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:e}}();function xD(t){var e={},r=t.match(Yn),n=0,i=!1;if(r)for(;n!=r.length;++n){var s=at(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;e.cp=_1[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=s.val;break;case"<sz":e.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":s.rgb&&(e.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+s[0])}}return e}var vD=function(){var t=Vf("t"),e=Vf("rPr");function r(s){var a=s.match(t);if(!a)return{t:"s",v:""};var o={t:"s",v:Pt(a[1])},l=s.match(e);return l&&(o.s=xD(l[1])),o}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(a){return a.replace(n,"").split(i).map(r).filter(function(o){return o.v})}}(),yD=function(){var e=/(\r\n|\n)/g;function r(i,s,a){var o=[];i.u&&o.push("text-decoration: underline;"),i.uval&&o.push("text-underline-style:"+i.uval+";"),i.sz&&o.push("font-size:"+i.sz+"pt;"),i.outline&&o.push("text-effect: outline;"),i.shadow&&o.push("text-shadow: auto;"),s.push('<span style="'+o.join("")+'">'),i.b&&(s.push("<b>"),a.push("</b>")),i.i&&(s.push("<i>"),a.push("</i>")),i.strike&&(s.push("<s>"),a.push("</s>"));var l=i.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(s.push("<"+l+">"),a.push("</"+l+">")),a.push("</span>"),i}function n(i){var s=[[],i.v,[]];return i.v?(i.s&&r(i.s,s[0],s[2]),s[0].join("")+s[1].replace(e,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),_D=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,ED=/<(?:\w+:)?r>/,wD=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function $1(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Pt(Jt(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Jt(t),r&&(n.h=b1(n.t))):t.match(ED)&&(n.r=Jt(t),n.t=Pt(Jt((t.replace(wD,"").match(_D)||[]).join("").replace(Yn,""))),r&&(n.h=yD(vD(n.r)))),n):{t:""}}var TD=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,SD=/<(?:\w+:)?(?:si|sstItem)>/g,kD=/<\/(?:\w+:)?(?:si|sstItem)>/;function AD(t,e){var r=[],n="";if(!t)return r;var i=t.match(TD);if(i){n=i[2].replace(SD,"").split(kD);for(var s=0;s!=n.length;++s){var a=$1(n[s].trim(),e);a!=null&&(r[r.length]=a)}i=at(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}var CD=/^\s|\s$|[\t\n\r]/;function Tk(t,e){if(!e.bookSST)return"";var r=[Lr];r[r.length]=Be("sst",null,{xmlns:Ml[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var i=t[n],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(CD)&&(s+=' xml:space="preserve"'),s+=">"+Xt(i.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function FD(t){return[t.read_shift(4),t.read_shift(4)]}function ID(t,e){var r=[],n=!1;return La(t,function(s,a,o){switch(o){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(a.T,!n||e.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function bD(t,e){return e||(e=pe(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var RD=UR;function ND(t){var e=_i();ye(e,159,bD(t));for(var r=0;r<t.length;++r)ye(e,19,RD(t[r]));return ye(e,160),e.end()}function Sk(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function Ta(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function DD(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=Ta(t,4),e.U=Ta(t,4),e.W=Ta(t,4),e}function PD(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},i=t.read_shift(4),s=[];i-- >0;)s.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=s,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function OD(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(PD(t));return e}function MD(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function LD(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=Ta(t,4),e.U=Ta(t,4),e.W=Ta(t,4),e}function BD(t){var e=LD(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function kk(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function Ak(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function jD(t){var e=Ta(t);switch(e.Minor){case 2:return[e.Minor,VD(t)];case 3:return[e.Minor,UD()];case 4:return[e.Minor,zD(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function VD(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=kk(t,r),i=Ak(t,t.length-t.l);return{t:"Std",h:n,v:i}}function UD(){throw new Error("File is password-protected: ECMA-376 Extensible")}function zD(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(Yn,function(s){var a=at(s);switch(ra(a[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(o){n[o]=a[o]});break;case"<dataIntegrity":n.encryptedHmacKey=a.encryptedHmacKey,n.encryptedHmacValue=a.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=a.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(a);break;default:throw a[0]}}),n}function WD(t,e){var r={},n=r.EncryptionVersionInfo=Ta(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var i=t.read_shift(4);return e-=4,r.EncryptionHeader=kk(t,i),e-=i,r.EncryptionVerifier=Ak(t,e),r}function $D(t){var e={},r=e.EncryptionVersionInfo=Ta(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function H1(t){var e=0,r,n=Sk(t),i=n.length+1,s,a,o,l,c;for(r=bo(i),r[0]=n.length,s=1;s!=i;++s)r[s]=n[s-1];for(s=i-1;s>=0;--s)a=r[s],o=e&16384?1:0,l=e<<1&32767,c=o|l,e=c^a;return e^52811}var Ck=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(a){return(a/2|a*128)&255},i=function(a,o){return n(a^o)},s=function(a){for(var o=e[a.length-1],l=104,c=a.length-1;c>=0;--c)for(var d=a[c],h=0;h!=7;++h)d&64&&(o^=r[l]),d*=2,--l;return o};return function(a){for(var o=Sk(a),l=s(o),c=o.length,d=bo(16),h=0;h!=16;++h)d[h]=0;var p,m,y;for((c&1)===1&&(p=l>>8,d[c]=i(t[0],p),--c,p=l&255,m=o[o.length-1],d[c]=i(m,p));c>0;)--c,p=l>>8,d[c]=i(o[c],p),--c,p=l&255,d[c]=i(o[c],p);for(c=15,y=15-o.length;y>0;)p=l>>8,d[c]=i(t[y],p),--c,--y,p=l&255,d[c]=i(o[c],p),--c,--y;return d}}(),HD=function(t,e,r,n,i){i||(i=e),n||(n=Ck(t));var s,a;for(s=0;s!=e.length;++s)a=e[s],a^=n[r],a=(a>>5|a<<3)&255,i[s]=a,++r;return[i,r,n]},GD=function(t){var e=0,r=Ck(t);return function(n){var i=HD("",n,e,r);return e=i[1],i[0]}};function KD(t,e,r,n){var i={key:zr(t),verificationBytes:zr(t)};return r.password&&(i.verifier=H1(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=GD(r.password)),i}function XD(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=$D(t):n.Data=WD(t,e),n}function qD(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?XD(t,e-2,n):KD(t,r.biff>=8?e:e-2,r,n),n}var Fk=function(){function t(i,s){switch(s.type){case"base64":return e(Mi(i),s);case"binary":return e(i,s);case"buffer":return e(vt&&Buffer.isBuffer(i)?i.toString("binary"):Vo(i),s);case"array":return e(Sl(i),s)}throw new Error("Unrecognized type "+s.type)}function e(i,s){var a=s||{},o=a.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(d,h){Array.isArray(o)&&(o[h]=[]);for(var p=/\\\w+\b/g,m=0,y,x=-1;y=p.exec(d);){switch(y[0]){case"\\cell":var E=d.slice(m,p.lastIndex-y[0].length);if(E[0]==" "&&(E=E.slice(1)),++x,E.length){var T={v:E,t:"s"};Array.isArray(o)?o[h][x]=T:o[st({r:h,c:x})]=T}break}m=p.lastIndex}x>c.e.c&&(c.e.c=x)}),o["!ref"]=mt(c),o}function r(i,s){return Uo(t(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],a=Ot(i["!ref"]),o,l=Array.isArray(i),c=a.s.r;c<=a.e.r;++c){s.push("\\trowd\\trautofit1");for(var d=a.s.c;d<=a.e.c;++d)s.push("\\cellx"+(d+1));for(s.push("\\pard\\intbl"),d=a.s.c;d<=a.e.c;++d){var h=st({r:c,c:d});o=l?(i[c]||[])[d]:i[h],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(Ia(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function YD(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function $f(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function QD(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,i=Math.max(e,r,n),s=Math.min(e,r,n),a=i-s;if(a===0)return[0,0,e];var o=0,l=0,c=i+s;switch(l=a/(c>1?2-c:c),i){case e:o=((r-n)/a+6)%6;break;case r:o=(n-e)/a+2;break;case n:o=(e-r)/a+4;break}return[o/6,l,c/2]}function JD(t){var e=t[0],r=t[1],n=t[2],i=r*2*(n<.5?n:1-n),s=n-i/2,a=[s,s,s],o=6*e,l;if(r!==0)switch(o|0){case 0:case 6:l=i*o,a[0]+=i,a[1]+=l;break;case 1:l=i*(2-o),a[0]+=l,a[1]+=i;break;case 2:l=i*(o-2),a[1]+=i,a[2]+=l;break;case 3:l=i*(4-o),a[1]+=l,a[2]+=i;break;case 4:l=i*(o-4),a[2]+=i,a[0]+=l;break;case 5:l=i*(6-o),a[2]+=l,a[0]+=i;break}for(var c=0;c!=3;++c)a[c]=Math.round(a[c]*255);return a}function Vh(t,e){if(e===0)return t;var r=QD(YD(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),$f(JD(r))}var Ik=6,ZD=15,eP=1,Wn=Ik;function Hf(t){return Math.floor((t+Math.round(128/Wn)/256)*Wn)}function Gf(t){return Math.floor((t-5)/Wn*100+.5)/100}function Uh(t){return Math.round((t*Wn+5)/Wn*256)/256}function kg(t){return Uh(Gf(Hf(t)))}function G1(t){var e=Math.abs(t-kg(t)),r=Wn;if(e>.005)for(Wn=eP;Wn<ZD;++Wn)Math.abs(t-kg(t))<=e&&(e=Math.abs(t-kg(t)),r=Wn);Wn=r}function Ro(t){t.width?(t.wpx=Hf(t.width),t.wch=Gf(t.wpx),t.MDW=Wn):t.wpx?(t.wch=Gf(t.wpx),t.width=Uh(t.wch),t.MDW=Wn):typeof t.wch=="number"&&(t.width=Uh(t.wch),t.wpx=Hf(t.width),t.MDW=Wn),t.customWidth&&delete t.customWidth}var tP=96,bk=tP;function Kf(t){return t*96/bk}function qc(t){return t*bk/96}var rP={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function nP(t,e,r,n){e.Borders=[];var i={},s=!1;(t[0].match(Yn)||[]).forEach(function(a){var o=at(a);switch(ra(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},o.diagonalUp&&(i.diagonalUp=ar(o.diagonalUp)),o.diagonalDown&&(i.diagonalDown=ar(o.diagonalDown)),e.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in borders")}})}function iP(t,e,r,n){e.Fills=[];var i={},s=!1;(t[0].match(Yn)||[]).forEach(function(a){var o=at(a);switch(ra(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},e.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":o.patternType&&(i.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),o.indexed&&(i.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(i.bgColor.theme=parseInt(o.theme,10)),o.tint&&(i.bgColor.tint=parseFloat(o.tint)),o.rgb&&(i.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),o.theme&&(i.fgColor.theme=parseInt(o.theme,10)),o.tint&&(i.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(i.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fills")}})}function sP(t,e,r,n){e.Fonts=[];var i={},s=!1;(t[0].match(Yn)||[]).forEach(function(a){var o=at(a);switch(ra(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(i),i={};break;case"<name":o.val&&(i.name=Jt(o.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=o.val?ar(o.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=o.val?ar(o.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(o.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=o.val?ar(o.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=o.val?ar(o.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=o.val?ar(o.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=o.val?ar(o.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=o.val?ar(o.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":o.val&&(i.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(i.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(i.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(i.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=_1[parseInt(o.val,10)];break;case"<color":if(i.color||(i.color={}),o.auto&&(i.color.auto=ar(o.auto)),o.rgb)i.color.rgb=o.rgb.slice(-6);else if(o.indexed){i.color.index=parseInt(o.indexed,10);var l=dl[i.color.index];i.color.index==81&&(l=dl[1]),l||(l=dl[1]),i.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(i.color.theme=parseInt(o.theme,10),o.tint&&(i.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=Vh(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fonts")}})}function aP(t,e,r){e.NumberFmt=[];for(var n=Nr(it),i=0;i<n.length;++i)e.NumberFmt[n[i]]=it[n[i]];var s=t[0].match(Yn);if(s)for(i=0;i<s.length;++i){var a=at(s[i]);switch(ra(a[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=Pt(Jt(a.formatCode)),l=parseInt(a.numFmtId,10);if(e.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&e.NumberFmt[l]!=null;--l);e.NumberFmt[l]=o}wa(o,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+a[0]+" in numFmts")}}}function oP(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)t[n]!=null&&(e[e.length]=Be("numFmt",null,{numFmtId:n,formatCode:Xt(t[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=Be("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var Sd=["numFmtId","fillId","fontId","borderId","xfId"],kd=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function lP(t,e,r){e.CellXf=[];var n,i=!1;(t[0].match(Yn)||[]).forEach(function(s){var a=at(s),o=0;switch(ra(a[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=a,delete n[0],o=0;o<Sd.length;++o)n[Sd[o]]&&(n[Sd[o]]=parseInt(n[Sd[o]],10));for(o=0;o<kd.length;++o)n[kd[o]]&&(n[kd[o]]=ar(n[kd[o]]));if(e.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[o]){n.numFmtId=o;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};a.vertical&&(l.vertical=a.vertical),a.horizontal&&(l.horizontal=a.horizontal),a.textRotation!=null&&(l.textRotation=a.textRotation),a.indent&&(l.indent=a.indent),a.wrapText&&(l.wrapText=ar(a.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+a[0]+" in cellXfs")}})}function cP(t){var e=[];return e[e.length]=Be("cellXfs",null),t.forEach(function(r){e[e.length]=Be("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=Be("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var uP=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,c){var d={};if(!o)return d;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var h;return(h=o.match(e))&&aP(h,d,c),(h=o.match(i))&&sP(h,d,l,c),(h=o.match(n))&&iP(h,d,l,c),(h=o.match(s))&&nP(h,d,l,c),(h=o.match(r))&&lP(h,d,c),d}}();function Rk(t,e){var r=[Lr,Be("styleSheet",null,{xmlns:Ml[0],"xmlns:vt":Xr.vt})],n;return t.SSF&&(n=oP(t.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=cP(e.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function fP(t,e){var r=t.read_shift(2),n=Gn(t);return[r,n]}function dP(t,e,r){r||(r=pe(6+4*e.length)),r.write_shift(2,t),cn(e,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function hP(t,e,r){var n={};n.sz=t.read_shift(2)/20;var i=XR(t);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=t.read_shift(2);switch(s===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=t.read_shift(1);a!=0&&(n.underline=a);var o=t.read_shift(1);o>0&&(n.family=o);var l=t.read_shift(1);switch(l>0&&(n.charset=l),t.l++,n.color=KR(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Gn(t),n}function pP(t,e){e||(e=pe(25+4*32)),e.write_shift(2,t.sz*20),qR(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),Lh(t.color,e);var n=0;return n=2,e.write_shift(1,n),cn(t.name,e),e.length>e.l?e.slice(0,e.l):e}var gP=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Ag,mP=Xn;function u2(t,e){e||(e=pe(4*3+8*7+16*1)),Ag||(Ag=Sp(gP));var r=Ag[t.patternType];r==null&&(r=40),e.write_shift(4,r);var n=0;if(r!=40)for(Lh({auto:1},e),Lh({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function xP(t,e){var r=t.l+e,n=t.read_shift(2),i=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:i}}function Nk(t,e,r){r||(r=pe(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Ou(t,e){return e||(e=pe(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var vP=Xn;function yP(t,e){return e||(e=pe(51)),e.write_shift(1,0),Ou(null,e),Ou(null,e),Ou(null,e),Ou(null,e),Ou(null,e),e.length>e.l?e.slice(0,e.l):e}function _P(t,e){return e||(e=pe(12+4*10)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),Mh(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function EP(t,e,r){var n=pe(2052);return n.write_shift(4,t),Mh(e,n),Mh(r,n),n.length>n.l?n.slice(0,n.l):n}function wP(t,e,r){var n={};n.NumberFmt=[];for(var i in it)n.NumberFmt[i]=it[i];n.CellXf=[],n.Fonts=[];var s=[],a=!1;return La(t,function(l,c,d){switch(d){case 44:n.NumberFmt[l[0]]=l[1],wa(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(l.color.rgb=Vh(e.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:s.push(d),a=!0;break;case 38:s.pop(),a=!1;break;default:if(c.T>0)s.push(d);else if(c.T<0)s.pop();else if(!a||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),n}function TP(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&++r}),r!=0&&(ye(t,615,Ns(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&ye(t,44,dP(i,e[i]))}),ye(t,616))}}function SP(t){var e=1;ye(t,611,Ns(e)),ye(t,43,pP({sz:12,color:{theme:1},name:"Calibri",family:2})),ye(t,612)}function kP(t){var e=2;ye(t,603,Ns(e)),ye(t,45,u2({patternType:"none"})),ye(t,45,u2({patternType:"gray125"})),ye(t,604)}function AP(t){var e=1;ye(t,613,Ns(e)),ye(t,46,yP()),ye(t,614)}function CP(t){var e=1;ye(t,626,Ns(e)),ye(t,47,Nk({numFmtId:0},65535)),ye(t,627)}function FP(t,e){ye(t,617,Ns(e.length)),e.forEach(function(r){ye(t,47,Nk(r,0))}),ye(t,618)}function IP(t){var e=1;ye(t,619,Ns(e)),ye(t,48,_P({xfId:0,name:"Normal"})),ye(t,620)}function bP(t){var e=0;ye(t,505,Ns(e)),ye(t,506)}function RP(t){var e=0;ye(t,508,EP(e,"TableStyleMedium9","PivotStyleMedium4")),ye(t,509)}function NP(t,e){var r=_i();return ye(r,278),TP(r,t.SSF),SP(r),kP(r),AP(r),CP(r),FP(r,e.cellXfs),IP(r),bP(r),RP(r),ye(r,279),r.end()}var DP=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function PP(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(Yn)||[]).forEach(function(i){var s=at(i);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(e.themeElements.clrScheme[DP.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function OP(){}function MP(){}var LP=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,BP=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,jP=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function VP(t,e,r){e.themeElements={};var n;[["clrScheme",LP,PP],["fontScheme",BP,OP],["fmtScheme",jP,MP]].forEach(function(i){if(!(n=t.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,e,r)})}var UP=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Dk(t,e){(!t||t.length===0)&&(t=K1());var r,n={};if(!(r=t.match(UP)))throw new Error("themeElements not found in theme");return VP(r[0],n,e),n.raw=t,n}function K1(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[Lr];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function zP(t,e,r){var n=t.l+e,i=t.read_shift(4);if(i!==124226){if(!r.cellStyles){t.l=n;return}var s=t.slice(t.l);t.l=n;var a;try{a=kS(s,{type:"array"})}catch{return}var o=Ri(a,"theme/theme/theme1.xml",!0);if(o)return Dk(o,r)}}function WP(t){return t.read_shift(4)}function $P(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=HP(t,4);break;case 2:e.xclrValue=dk(t);break;case 3:e.xclrValue=WP(t);break;case 4:t.l+=4;break}return t.l+=8,e}function HP(t,e){return Xn(t,e)}function GP(t,e){return Xn(t,e)}function KP(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=$P(t);break;case 6:n[1]=GP(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function XP(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var i=t.read_shift(2),s=[];i-- >0;)s.push(KP(t,r-t.l));return{ixfe:n,ext:s}}function qP(t,e){e.forEach(function(r){switch(r[0]){}})}function YP(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:Gn(t)}}function QP(t){var e=pe(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),cn(t.name,e),e.slice(0,e.l)}function JP(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function ZP(t){var e=pe(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function e6(t,e){var r=pe(8+2*e.length);return r.write_shift(4,t),cn(e,r),r.slice(0,r.l)}function t6(t){return t.l+=4,t.read_shift(4)!=0}function r6(t,e){var r=pe(8);return r.write_shift(4,t),r.write_shift(4,1),r}function n6(t,e,r){var n={Types:[],Cell:[],Value:[]},i=r||{},s=[],a=!1,o=2;return La(t,function(l,c,d){switch(d){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(h){o==1?n.Cell.push({type:n.Types[h[0]-1].name,index:h[1]}):o==0&&n.Value.push({type:n.Types[h[0]-1].name,index:h[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:s.push(d),a=!0;break;case 36:s.pop(),a=!1;break;default:if(!c.T){if(!a||i.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),n}function i6(){var t=_i();return ye(t,332),ye(t,334,Ns(1)),ye(t,335,QP({name:"XLDAPR",version:12e4,flags:3496657072})),ye(t,336),ye(t,339,e6(1,"XLDAPR")),ye(t,52),ye(t,35,Ns(514)),ye(t,4096,Ns(0)),ye(t,4097,es(1)),ye(t,36),ye(t,53),ye(t,340),ye(t,337,r6(1)),ye(t,51,ZP([[1,0]])),ye(t,338),ye(t,333),t.end()}function s6(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var i=!1,s=2,a;return t.replace(Yn,function(o){var l=at(o);switch(ra(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<n.Types.length;++c)n.Types[c].name==l.name&&(a=n.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):s==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!a)break;a.offsets||(a.offsets=[]),a.offsets.push(+l.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function Pk(){var t=[Lr];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function a6(t){var e=[];if(!t)return e;var r=1;return(t.match(Yn)||[]).forEach(function(n){var i=at(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,e.push(i);break}}),e}function o6(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=st(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function l6(t,e,r){var n=[];return La(t,function(s,a,o){switch(o){case 63:n.push(s);break;default:if(!a.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function c6(t,e,r,n){if(!t)return t;var i=n||{},s=!1;La(t,function(o,l,c){switch(c){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!l.T){if(!s||i.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}},i)}function u6(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}var Tc=1024;function Ok(t,e){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[Be("xml",null,{"xmlns:v":Fi.v,"xmlns:o":Fi.o,"xmlns:x":Fi.x,"xmlns:mv":Fi.mv}).replace(/\/>/,">"),Be("o:shapelayout",Be("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),Be("v:shapetype",[Be("v:stroke",null,{joinstyle:"miter"}),Be("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Tc<t*1e3;)Tc+=1e3;return e.forEach(function(s){var a=wr(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?Be("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=Be("v:fill",l,o),d={on:"t",obscured:"t"};++Tc,i=i.concat(["<v:shape"+Uf({id:"_x0000_s"+Tc,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,Be("v:shadow",null,d),Be("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",wn("x:Anchor",[a.c+1,0,a.r+1,0,a.c+3,20,a.r+5,20].join(",")),wn("x:AutoFill","False"),wn("x:Row",String(a.r)),wn("x:Column",String(a.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function f2(t,e,r,n){var i=Array.isArray(t),s;e.forEach(function(a){var o=wr(a.ref);if(i?(t[o.r]||(t[o.r]=[]),s=t[o.r][o.c]):s=t[a.ref],!s){s={t:"z"},i?t[o.r][o.c]=s:t[a.ref]=s;var l=Ot(t["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var c=mt(l);c!==t["!ref"]&&(t["!ref"]=c)}s.c||(s.c=[]);var d={a:a.author,t:a.t,r:a.r,T:r};a.h&&(d.h=a.h);for(var h=s.c.length-1;h>=0;--h){if(!r&&s.c[h].T)return;r&&!s.c[h].T&&s.c.splice(h,1)}if(r&&n){for(h=0;h<n.length;++h)if(d.a==n[h].id){d.a=n[h].name||d.a;break}}s.c.push(d)})}function f6(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var s=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=at(o[0]),c={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},d=wr(l.ref);if(!(e.sheetRows&&e.sheetRows<=d.r)){var h=a.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),p=!!h&&!!h[1]&&$1(h[1])||{r:"",t:"",h:""};c.r=p.r,p.r=="<t></t>"&&(p.t=p.h=""),c.t=(p.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(c.h=p.h),n.push(c)}}}}),n}function Mk(t){var e=[Lr,Be("comments",null,{xmlns:Ml[0]})],r=[];return e.push("<authors>"),t.forEach(function(n){n[1].forEach(function(i){var s=Xt(i.a);r.indexOf(s)==-1&&(r.push(s),e.push("<author>"+s+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),e.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(n){var i=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(l){l.a&&(i=r.indexOf(Xt(l.a))),s.push(l.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),s.length<=1)e.push(wn("t",Xt(s[0]||"")));else{for(var a=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)a+=`Reply:
    `+s[o]+`
`;e.push(wn("t",Xt(a)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function d6(t,e){var r=[],n=!1,i={},s=0;return t.replace(Yn,function(o,l){var c=at(o);switch(ra(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":s=l+o.length;break;case"</text>":i.t=t.slice(s,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),r}function h6(t,e,r){var n=[Lr,Be("ThreadedComments",null,{xmlns:Xr.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(i){var s="";(i[1]||[]).forEach(function(a,o){if(!a.T){delete a.ID;return}a.a&&e.indexOf(a.a)==-1&&e.push(a.a);var l={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?s=l.id:l.parentId=s,a.ID=l.id,a.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(a.a)).slice(-12)+"}"),n.push(Be("threadedComment",wn("text",a.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function p6(t,e){var r=[],n=!1;return t.replace(Yn,function(s){var a=at(s);switch(ra(a[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:a.displayname,id:a.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+a[0]+" in threaded comments")}return s}),r}function g6(t){var e=[Lr,Be("personList",null,{xmlns:Xr.TCMNT,"xmlns:x":Ml[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,n){e.push(Be("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function m6(t){var e={};e.iauthor=t.read_shift(4);var r=Vl(t);return e.rfx=r.s,e.ref=st(r.s),t.l+=16,e}function x6(t,e){return e==null&&(e=pe(36)),e.write_shift(4,t[1].iauthor),fu(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var v6=Gn;function y6(t){return cn(t.slice(0,54))}function _6(t,e){var r=[],n=[],i={},s=!1;return La(t,function(o,l,c){switch(c){case 632:n.push(o);break;case 635:i=o;break;case 637:i.t=o.t,i.h=o.h,i.r=o.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,e.sheetRows&&i.rfx&&e.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!s||e.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),r}function E6(t){var e=_i(),r=[];return ye(e,628),ye(e,630),t.forEach(function(n){n[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),ye(e,632,y6(i.a)))})}),ye(e,631),ye(e,633),t.forEach(function(n){n[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var s={s:wr(n[0]),e:wr(n[0])};ye(e,635,x6([s,i])),i.t&&i.t.length>0&&ye(e,637,WR(i)),ye(e,636),delete i.iauthor})}),ye(e,634),ye(e,629),e.end()}var w6="application/vnd.ms-office.vbaProject";function T6(t){var e=Ze.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Ze.utils.cfb_add(e,i,t.FileIndex[n].content)}}),Ze.write(e)}function S6(t,e){e.FullPaths.forEach(function(r,n){if(n!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&Ze.utils.cfb_add(t,i,e.FileIndex[n].content)}})}var Lk=["xlsb","xlsm","xlam","biff8","xla"];function k6(){return{"!type":"dialog"}}function A6(){return{"!type":"dialog"}}function C6(){return{"!type":"macro"}}function F6(){return{"!type":"macro"}}var Pc=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,i,s,a){var o=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var c=s.length>0?parseInt(s,10)|0:0,d=a.length>0?parseInt(a,10)|0:0;return o?d+=e.c:--d,l?c+=e.r:--c,i+(o?"":"$")+Er(d)+(l?"":"$")+Mr(c)}return function(i,s){return e=s,i.replace(t,r)}}(),X1=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,q1=function(){return function(e,r){return e.replace(X1,function(n,i,s,a,o,l){var c=O1(a)-(s?0:r.c),d=P1(l)-(o?0:r.r),h=d==0?"":o?d+1:"["+d+"]",p=c==0?"":s?c+1:"["+c+"]";return i+"R"+h+"C"+p})}}();function Bk(t,e){return t.replace(X1,function(r,n,i,s,a,o){return n+(i=="$"?i+s:Er(O1(s)+e.c))+(a=="$"?a+o:Mr(P1(o)+e.r))})}function I6(t,e,r){var n=Ei(e),i=n.s,s=wr(r),a={r:s.r-i.r,c:s.c-i.c};return Bk(t,a)}function b6(t){return t.length!=1}function d2(t){return t.replace(/_xlfn\./g,"")}function jr(t){t.l+=1}function No(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function jk(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return Vk(t);r.biff==12&&(n=4)}var i=t.read_shift(n),s=t.read_shift(n),a=No(t),o=No(t);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function Vk(t){var e=No(t),r=No(t),n=t.read_shift(1),i=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function R6(t,e,r){if(r.biff<8)return Vk(t);var n=t.read_shift(r.biff==12?4:2),i=t.read_shift(r.biff==12?4:2),s=No(t),a=No(t);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}function Uk(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return N6(t);var n=t.read_shift(r&&r.biff==12?4:2),i=No(t);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function N6(t){var e=No(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function D6(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function P6(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return O6(t);var i=t.read_shift(n>=12?4:2),s=t.read_shift(2),a=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;i>524287;)i-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:a,rRel:o}}function O6(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),i==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:i,rRel:n}}function M6(t,e,r){var n=(t[t.l++]&96)>>5,i=jk(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function L6(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}var a=jk(t,s,r);return[n,i,a]}function B6(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function j6(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}return t.l+=s,[n,i]}function V6(t,e,r){var n=(t[t.l++]&96)>>5,i=R6(t,e-1,r);return[n,i]}function U6(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function h2(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function z6(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(t.read_shift(r&&r.biff==2?1:2));return i}function W6(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function $6(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function H6(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function G6(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function zk(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function K6(t){return t.read_shift(2),zk(t)}function X6(t){return t.read_shift(2),zk(t)}function q6(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=Uk(t,0,r);return[n,i]}function Y6(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=P6(t,0,r);return[n,i]}function Q6(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var s=Uk(t,0,r);return[n,i,s]}function J6(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(r&&r.biff<=3?1:2);return[t5[i],Hk[i],n]}function Z6(t,e,r){var n=t[t.l++],i=t.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:e8(t);return[i,(s[0]===0?Hk:e5)[s[1]]]}function e8(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function t8(t,e,r){t.l+=r&&r.biff==2?3:4}function r8(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function n8(t){return t.l++,Ba[t.read_shift(1)]}function i8(t){return t.l++,t.read_shift(2)}function s8(t){return t.l++,t.read_shift(1)!==0}function a8(t){return t.l++,Hn(t)}function o8(t,e,r){return t.l++,p0(t,e-1,r)}function l8(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Dr(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=Ba[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=Hn(t);break;case 2:r[1]=Ul(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function c8(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((r.biff==12?Vl:Cp)(t));return i}function u8(t,e,r){var n=0,i=0;r.biff==12?(n=t.read_shift(4),i=t.read_shift(4)):(i=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var s=0,a=[];s!=n&&(a[s]=[]);++s)for(var o=0;o!=i;++o)a[s][o]=l8(t,r.biff);return a}function f8(t,e,r){var n=t.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,s=t.read_shift(i);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,s]}function d8(t,e,r){if(r.biff==5)return h8(t);var n=t.read_shift(1)>>>5&3,i=t.read_shift(2),s=t.read_shift(4);return[n,i,s]}function h8(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function p8(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function g8(t,e,r){var n=t.read_shift(1)>>>5&3,i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function m8(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function x8(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return t.l+=s,[n,i]}var v8=Xn,y8=Xn,_8=Xn;function m0(t,e,r){return t.l+=2,[D6(t)]}function Y1(t){return t.l+=6,[]}var E8=m0,w8=Y1,T8=Y1,S8=m0;function Wk(t){return t.l+=2,[zr(t),t.read_shift(2)&1]}var k8=m0,A8=Wk,C8=Y1,F8=m0,I8=m0,b8=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function R8(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i=t.read_shift(2),s=t.read_shift(2),a=b8[r>>2&31];return{ixti:e,coltype:r&3,rt:a,idx:n,c:i,C:s}}function N8(t){return t.l+=2,[t.read_shift(4)]}function D8(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function P8(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function O8(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function M8(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function L8(t){return t.l+=4,[0,0]}var p2={1:{n:"PtgExp",f:r8},2:{n:"PtgTbl",f:_8},3:{n:"PtgAdd",f:jr},4:{n:"PtgSub",f:jr},5:{n:"PtgMul",f:jr},6:{n:"PtgDiv",f:jr},7:{n:"PtgPower",f:jr},8:{n:"PtgConcat",f:jr},9:{n:"PtgLt",f:jr},10:{n:"PtgLe",f:jr},11:{n:"PtgEq",f:jr},12:{n:"PtgGe",f:jr},13:{n:"PtgGt",f:jr},14:{n:"PtgNe",f:jr},15:{n:"PtgIsect",f:jr},16:{n:"PtgUnion",f:jr},17:{n:"PtgRange",f:jr},18:{n:"PtgUplus",f:jr},19:{n:"PtgUminus",f:jr},20:{n:"PtgPercent",f:jr},21:{n:"PtgParen",f:jr},22:{n:"PtgMissArg",f:jr},23:{n:"PtgStr",f:o8},26:{n:"PtgSheet",f:D8},27:{n:"PtgEndSheet",f:P8},28:{n:"PtgErr",f:n8},29:{n:"PtgBool",f:s8},30:{n:"PtgInt",f:i8},31:{n:"PtgNum",f:a8},32:{n:"PtgArray",f:U6},33:{n:"PtgFunc",f:J6},34:{n:"PtgFuncVar",f:Z6},35:{n:"PtgName",f:f8},36:{n:"PtgRef",f:q6},37:{n:"PtgArea",f:M6},38:{n:"PtgMemArea",f:p8},39:{n:"PtgMemErr",f:v8},40:{n:"PtgMemNoMem",f:y8},41:{n:"PtgMemFunc",f:g8},42:{n:"PtgRefErr",f:m8},43:{n:"PtgAreaErr",f:B6},44:{n:"PtgRefN",f:Y6},45:{n:"PtgAreaN",f:V6},46:{n:"PtgMemAreaN",f:O8},47:{n:"PtgMemNoMemN",f:M8},57:{n:"PtgNameX",f:d8},58:{n:"PtgRef3d",f:Q6},59:{n:"PtgArea3d",f:L6},60:{n:"PtgRefErr3d",f:x8},61:{n:"PtgAreaErr3d",f:j6},255:{}},B8={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},j8={1:{n:"PtgElfLel",f:Wk},2:{n:"PtgElfRw",f:F8},3:{n:"PtgElfCol",f:E8},6:{n:"PtgElfRwV",f:I8},7:{n:"PtgElfColV",f:S8},10:{n:"PtgElfRadical",f:k8},11:{n:"PtgElfRadicalS",f:C8},13:{n:"PtgElfColS",f:w8},15:{n:"PtgElfColSV",f:T8},16:{n:"PtgElfRadicalLel",f:A8},25:{n:"PtgList",f:R8},29:{n:"PtgSxName",f:N8},255:{}},V8={0:{n:"PtgAttrNoop",f:L8},1:{n:"PtgAttrSemi",f:G6},2:{n:"PtgAttrIf",f:$6},4:{n:"PtgAttrChoose",f:z6},8:{n:"PtgAttrGoto",f:W6},16:{n:"PtgAttrSum",f:t8},32:{n:"PtgAttrBaxcel",f:h2},33:{n:"PtgAttrBaxcel",f:h2},64:{n:"PtgAttrSpace",f:K6},65:{n:"PtgAttrSpaceSemi",f:X6},128:{n:"PtgAttrIfError",f:H6},255:{}};function x0(t,e,r,n){if(n.biff<8)return Xn(t,e);for(var i=t.l+e,s=[],a=0;a!==r.length;++a)switch(r[a][0]){case"PtgArray":r[a][1]=u8(t,0,n),s.push(r[a][1]);break;case"PtgMemArea":r[a][2]=c8(t,r[a][1],n),s.push(r[a][2]);break;case"PtgExp":n&&n.biff==12&&(r[a][1][1]=t.read_shift(4),s.push(r[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[a][0]}return e=i-t.l,e!==0&&s.push(Xn(t,e)),s}function v0(t,e,r){for(var n=t.l+e,i,s,a=[];n!=t.l;)e=n-t.l,s=t[t.l],i=p2[s]||p2[B8[s]],(s===24||s===25)&&(i=(s===24?j8:V8)[t[t.l+1]]),!i||!i.f?Xn(t,e):a.push([i.n,i.f(t,e,r)]);return a}function U8(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],i=[],s=0;s<n.length;++s){var a=n[s];if(a)switch(a[0]){case 2:i.push('"'+a[1].replace(/"/g,'""')+'"');break;default:i.push(a[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var z8={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function W8(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function $k(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(t[n[0]][0]){case 357:return i=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return t[n[0]][0][3]?(i=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function g2(t,e,r){var n=$k(t,e,r);return n=="#REF"?n:W8(n,r)}function Un(t,e,r,n,i){var s=i&&i.biff||8,a={s:{c:0,r:0}},o=[],l,c,d,h=0,p=0,m,y="";if(!t[0]||!t[0][0])return"";for(var x=-1,E="",T=0,k=t[0].length;T<k;++T){var _=t[0][T];switch(_[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),x>=0){switch(t[0][x][1][0]){case 0:E=Ir(" ",t[0][x][1][1]);break;case 1:E=Ir("\r",t[0][x][1][1]);break;default:if(E="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][x][1][0])}c=c+E,x=-1}o.push(c+z8[_[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=lf(_[1][1],a,i),o.push(cf(d,s));break;case"PtgRefN":d=r?lf(_[1][1],r,i):_[1][1],o.push(cf(d,s));break;case"PtgRef3d":h=_[1][1],d=lf(_[1][2],a,i),y=g2(n,h,i),o.push(y+"!"+cf(d,s));break;case"PtgFunc":case"PtgFuncVar":var P=_[1][0],W=_[1][1];P||(P=0),P&=127;var B=P==0?[]:o.slice(-P);o.length-=P,W==="User"&&(W=B.shift()),o.push(W+"("+B.join(",")+")");break;case"PtgBool":o.push(_[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(_[1]);break;case"PtgNum":o.push(String(_[1]));break;case"PtgStr":o.push('"'+_[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(_[1]);break;case"PtgAreaN":m=$_(_[1][1],r?{s:r}:a,i),o.push(wg(m,i));break;case"PtgArea":m=$_(_[1][1],a,i),o.push(wg(m,i));break;case"PtgArea3d":h=_[1][1],m=_[1][2],y=g2(n,h,i),o.push(y+"!"+wg(m,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":p=_[1][2];var w=(n.names||[])[p-1]||(n[0]||[])[p],C=w?w.Name:"SH33TJSNAME"+String(p);C&&C.slice(0,6)=="_xlfn."&&!i.xlfn&&(C=C.slice(6)),o.push(C);break;case"PtgNameX":var S=_[1][1];p=_[1][2];var b;if(i.biff<=5)S<0&&(S=-S),n[S]&&(b=n[S][p]);else{var N="";if(((n[S]||[])[0]||[])[0]==14849||(((n[S]||[])[0]||[])[0]==1025?n[S][p]&&n[S][p].itab>0&&(N=n.SheetNames[n[S][p].itab-1]+"!"):N=n.SheetNames[p-1]+"!"),n[S]&&n[S][p])N+=n[S][p].Name;else if(n[0]&&n[0][p])N+=n[0][p].Name;else{var D=($k(n,S,i)||"").split(";;");D[p-1]?N=D[p-1]:N+="SH33TJSERRX"}o.push(N);break}b||(b={Name:"SH33TJSERRY"}),o.push(b.Name);break;case"PtgParen":var R="(",Ue=")";if(x>=0){switch(E="",t[0][x][1][0]){case 2:R=Ir(" ",t[0][x][1][1])+R;break;case 3:R=Ir("\r",t[0][x][1][1])+R;break;case 4:Ue=Ir(" ",t[0][x][1][1])+Ue;break;case 5:Ue=Ir("\r",t[0][x][1][1])+Ue;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][x][1][0])}x=-1}o.push(R+o.pop()+Ue);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":d={c:_[1][1],r:_[1][0]};var ge={c:r.c,r:r.r};if(n.sharedf[st(d)]){var Fe=n.sharedf[st(d)];o.push(Un(Fe,a,ge,n,i))}else{var Ee=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(d.c<c[0].s.c||d.c>c[0].e.c)&&!(d.r<c[0].s.r||d.r>c[0].e.r)){o.push(Un(c[1],a,ge,n,i)),Ee=!0;break}Ee||o.push(_[1])}break;case"PtgArray":o.push("{"+U8(_[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":x=T;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+_[1].idx+"[#"+_[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(_));default:throw new Error("Unrecognized Formula Token: "+String(_))}var xe=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&x>=0&&xe.indexOf(t[0][T][0])==-1){_=t[0][x];var J=!0;switch(_[1][0]){case 4:J=!1;case 0:E=Ir(" ",_[1][1]);break;case 5:J=!1;case 1:E=Ir("\r",_[1][1]);break;default:if(E="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+_[1][0])}o.push((J?E:"")+o.pop()+(J?"":E)),x=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function $8(t,e,r){var n=t.l+e,i=r.biff==2?1:2,s,a=t.read_shift(i);if(a==65535)return[[],Xn(t,e-2)];var o=v0(t,a,r);return e!==a+i&&(s=x0(t,e-a-i,o,r)),t.l=n,[o,s]}function H8(t,e,r){var n=t.l+e,i=r.biff==2?1:2,s,a=t.read_shift(i);if(a==65535)return[[],Xn(t,e-2)];var o=v0(t,a,r);return e!==a+i&&(s=x0(t,e-a-i,o,r)),t.l=n,[o,s]}function G8(t,e,r,n){var i=t.l+e,s=v0(t,n,r),a;return i!==t.l&&(a=x0(t,i-t.l,s,r)),[s,a]}function K8(t,e,r){var n=t.l+e,i,s=t.read_shift(2),a=v0(t,s,r);return s==65535?[[],Xn(t,e-2)]:(e!==s+2&&(i=x0(t,n-s-2,a,r)),[a,i])}function X8(t){var e;if(ma(t,t.l+6)!==65535)return[Hn(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function q8(t){if(t==null){var e=pe(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return kl(t);return kl(0)}function Cg(t,e,r){var n=t.l+e,i=na(t);r.biff==2&&++t.l;var s=X8(t),a=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var o=H8(t,n-t.l,r);return{cell:i,val:s[0],formula:o,shared:a>>3&1,tt:s[1]}}function Y8(t,e,r,n,i){var s=Cl(e,r,i),a=q8(t.v),o=pe(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var c=pe(t.bf.length),d=0;d<t.bf.length;++d)c[d]=t.bf[d];var h=ln([s,a,o,c]);return h}function Fp(t,e,r){var n=t.read_shift(4),i=v0(t,n,r),s=t.read_shift(4),a=s>0?x0(t,s,i,r):null;return[i,a]}var Q8=Fp,Ip=Fp,J8=Fp,Z8=Fp,e5={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Hk={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},t5={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function m2(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function r5(t){var e="of:="+t.replace(X1,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function Fg(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function n5(t){return t.replace(/\./,"!")}var ff={},Oc={},df=typeof Map<"u";function Q1(t,e,r){var n=0,i=t.length;if(r){if(df?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var s=df?r.get(e):r[e];n<s.length;++n)if(t[s[n]].t===e)return t.Count++,s[n]}}else for(;n<i;++n)if(t[n].t===e)return t.Count++,n;return t[i]={t:e},t.Count++,t.Unique++,r&&(df?(r.has(e)||r.set(e,[]),r.get(e).push(i)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(i))),i}function bp(t,e){var r={min:t+1,max:t+1},n=-1;return e.MDW&&(Wn=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?n=Gf(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(r.width=Uh(n),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function gl(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function zo(t,e,r){var n=r.revssf[e.z!=null?e.z:"General"],i=60,s=t.length;if(n==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){wa(e.z,i),r.ssf[i]=e.z,r.revssf[e.z]=n=i;break}}for(i=0;i!=s;++i)if(t[i].numFmtId===n)return i;return t[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function Gk(t,e,r,n,i,s){try{n.cellNF&&(t.z=it[e])}catch(o){if(n.WTF)throw o}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=lr(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(it[e]==null&&wa(eR[e]||"General",e),t.t==="e")t.w=t.w||Ba[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=jf(t.v);else if(t.t==="d"){var a=Jr(t.v);(a|0)===a?t.w=a.toString(10):t.w=jf(a)}else{if(t.v===void 0)return"";t.w=Tl(t.v,Oc)}else t.t==="d"?t.w=cs(e,Jr(t.v),Oc):t.w=cs(e,t.v,Oc)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{t.s=s.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=Vh(i.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=i.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=Vh(i.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=i.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&s.Fills)throw o}}}function i5(t,e,r){if(t&&t["!ref"]){var n=Ot(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function s5(t,e){var r=Ot(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=mt(r))}var a5=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,o5=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,l5=/<(?:\w:)?hyperlink [^>]*>/mg,c5=/"(\w*:\w*)"/,u5=/<(?:\w:)?col\b[^>]*[\/]?>/g,f5=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,d5=/<(?:\w:)?pageMargins[^>]*\/>/g,Kk=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,h5=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,p5=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function g5(t,e,r,n,i,s,a){if(!t)return t;n||(n={"!id":{}});var o=e.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",d="",h=t.match(o5);h?(c=t.slice(0,h.index),d=t.slice(h.index+h[0].length)):c=d=t;var p=c.match(Kk);p?J1(p[0],o,i,r):(p=c.match(h5))&&x5(p[0],p[1]||"",o,i,r);var m=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(m>0){var y=c.slice(m,m+50).match(c5);y&&s5(o,y[1])}var x=c.match(p5);x&&x[1]&&b5(x[1],i);var E=[];if(e.cellStyles){var T=c.match(u5);T&&k5(E,T)}h&&D5(h[1],o,e,l,s,a);var k=d.match(f5);k&&(o["!autofilter"]=C5(k[0]));var _=[],P=d.match(a5);if(P)for(m=0;m!=P.length;++m)_[m]=Ot(P[m].slice(P[m].indexOf('"')+1));var W=d.match(l5);W&&w5(o,W,n);var B=d.match(d5);if(B&&(o["!margins"]=T5(at(B[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=mt(l)),e.sheetRows>0&&o["!ref"]){var w=Ot(o["!ref"]);e.sheetRows<=+w.e.r&&(w.e.r=e.sheetRows-1,w.e.r>l.e.r&&(w.e.r=l.e.r),w.e.r<w.s.r&&(w.s.r=w.e.r),w.e.c>l.e.c&&(w.e.c=l.e.c),w.e.c<w.s.c&&(w.s.c=w.e.c),o["!fullref"]=o["!ref"],o["!ref"]=mt(w))}return E.length>0&&(o["!cols"]=E),_.length>0&&(o["!merges"]=_),o}function m5(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+mt(t[r])+'"/>';return e+"</mergeCells>"}function J1(t,e,r,n){var i=at(t);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=Pt(Jt(i.codeName)))}function x5(t,e,r,n,i){J1(t.slice(0,t.indexOf(">")),r,n,i)}function v5(t,e,r,n,i){var s=!1,a={},o=null;if(n.bookType!=="xlsx"&&e.vbaraw){var l=e.SheetNames[r];try{e.Workbook&&(l=e.Workbook.Sheets[r].CodeName||l)}catch{}s=!0,a.codeName=Ks(Xt(l))}if(t&&t["!outline"]){var c={summaryBelow:1,summaryRight:1};t["!outline"].above&&(c.summaryBelow=0),t["!outline"].left&&(c.summaryRight=0),o=(o||"")+Be("outlinePr",null,c)}!s&&!o||(i[i.length]=Be("sheetPr",o,a))}var y5=["objects","scenarios","selectLockedCells","selectUnlockedCells"],_5=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function E5(t){var e={sheet:1};return y5.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),_5.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=H1(t.password).toString(16).toUpperCase()),Be("sheetProtection",null,e)}function w5(t,e,r){for(var n=Array.isArray(t),i=0;i!=e.length;++i){var s=at(Jt(e[i]),!0);if(!s.ref)return;var a=((r||{})["!id"]||[])[s.id];a?(s.Target=a.Target,s.location&&(s.Target+="#"+Pt(s.location))):(s.Target="#"+Pt(s.location),a={Target:s.Target,TargetMode:"Internal"}),s.Rel=a,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=Ot(s.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var d=st({c,r:l});n?(t[l]||(t[l]=[]),t[l][c]||(t[l][c]={t:"z",v:void 0}),t[l][c].l=s):(t[d]||(t[d]={t:"z",v:void 0}),t[d].l=s)}}}function T5(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function S5(t){return gl(t),Be("pageMargins",null,t)}function k5(t,e){for(var r=!1,n=0;n!=e.length;++n){var i=at(e[n],!0);i.hidden&&(i.hidden=ar(i.hidden));var s=parseInt(i.min,10)-1,a=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,G1(i.width)),Ro(i);s<=a;)t[s++]=cr(i)}}function A5(t,e){for(var r=["<cols>"],n,i=0;i!=e.length;++i)(n=e[i])&&(r[r.length]=Be("col",null,bp(i,n)));return r[r.length]="</cols>",r.join("")}function C5(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}function F5(t,e,r,n){var i=typeof t.ref=="string"?t.ref:mt(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,a=Ei(i);a.s.r==a.e.r&&(a.e.r=Ei(e["!ref"]).e.r,i=mt(a));for(var o=0;o<s.length;++o){var l=s[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+i;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),Be("autoFilter",null,{ref:i})}var I5=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function b5(t,e){e.Views||(e.Views=[{}]),(t.match(I5)||[]).forEach(function(r,n){var i=at(r);e.Views[n]||(e.Views[n]={}),+i.zoomScale&&(e.Views[n].zoom=+i.zoomScale),ar(i.rightToLeft)&&(e.Views[n].RTL=!0)})}function R5(t,e,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Be("sheetViews",Be("sheetView",null,i),{})}function N5(t,e,r,n){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var i="",s=t.t,a=t.v;if(t.t!=="z")switch(t.t){case"b":i=t.v?"1":"0";break;case"n":i=""+t.v;break;case"e":i=Ba[t.v];break;case"d":n&&n.cellDates?i=lr(t.v,-1).toISOString():(t=cr(t),t.t="n",i=""+(t.v=Jr(lr(t.v)))),typeof t.z>"u"&&(t.z=it[14]);break;default:i=t.v;break}var o=wn("v",Xt(i)),l={r:e},c=zo(n.cellXfs,t,n);switch(c!==0&&(l.s=c),t.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=wn("v",""+Q1(n.Strings,t.v,n.revStrings)),l.t="s";break}l.t="str";break}if(t.t!=s&&(t.t=s,t.v=a),typeof t.f=="string"&&t.f){var d=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;o=Be("f",Xt(t.f),d)+(t.v!=null?o:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(l.cm=1),Be("c",o,l)}var D5=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,s=Vf("v"),a=Vf("f");return function(l,c,d,h,p,m){for(var y=0,x="",E=[],T=[],k=0,_=0,P=0,W="",B,w,C=0,S=0,b,N,D=0,R=0,Ue=Array.isArray(m.CellXf),ge,Fe=[],Ee=[],xe=Array.isArray(c),J=[],ke={},Me=!1,j=!!d.sheetStubs,H=l.split(e),q=0,X=H.length;q!=X;++q){x=H[q].trim();var de=x.length;if(de!==0){var we=0;e:for(y=0;y<de;++y)switch(x[y]){case">":if(x[y-1]!="/"){++y;break e}if(d&&d.cellStyles){if(w=at(x.slice(we,y),!0),C=w.r!=null?parseInt(w.r,10):C+1,S=-1,d.sheetRows&&d.sheetRows<C)continue;ke={},Me=!1,w.ht&&(Me=!0,ke.hpt=parseFloat(w.ht),ke.hpx=qc(ke.hpt)),w.hidden=="1"&&(Me=!0,ke.hidden=!0),w.outlineLevel!=null&&(Me=!0,ke.level=+w.outlineLevel),Me&&(J[C-1]=ke)}break;case"<":we=y;break}if(we>=y)break;if(w=at(x.slice(we,y),!0),C=w.r!=null?parseInt(w.r,10):C+1,S=-1,!(d.sheetRows&&d.sheetRows<C)){h.s.r>C-1&&(h.s.r=C-1),h.e.r<C-1&&(h.e.r=C-1),d&&d.cellStyles&&(ke={},Me=!1,w.ht&&(Me=!0,ke.hpt=parseFloat(w.ht),ke.hpx=qc(ke.hpt)),w.hidden=="1"&&(Me=!0,ke.hidden=!0),w.outlineLevel!=null&&(Me=!0,ke.level=+w.outlineLevel),Me&&(J[C-1]=ke)),E=x.slice(y).split(t);for(var Ne=0;Ne!=E.length&&E[Ne].trim().charAt(0)=="<";++Ne);for(E=E.slice(Ne),y=0;y!=E.length;++y)if(x=E[y].trim(),x.length!==0){if(T=x.match(r),k=y,_=0,P=0,x="<c "+(x.slice(0,1)=="<"?">":"")+x,T!=null&&T.length===2){for(k=0,W=T[1],_=0;_!=W.length&&!((P=W.charCodeAt(_)-64)<1||P>26);++_)k=26*k+P;--k,S=k}else++S;for(_=0;_!=x.length&&x.charCodeAt(_)!==62;++_);if(++_,w=at(x.slice(0,_),!0),w.r||(w.r=st({r:C-1,c:S})),W=x.slice(_),B={t:""},(T=W.match(s))!=null&&T[1]!==""&&(B.v=Pt(T[1])),d.cellFormula){if((T=W.match(a))!=null&&T[1]!==""){if(B.f=Pt(Jt(T[1])).replace(/\r\n/g,`
`),d.xlfn||(B.f=d2(B.f)),T[0].indexOf('t="array"')>-1)B.F=(W.match(i)||[])[1],B.F.indexOf(":")>-1&&Fe.push([Ot(B.F),B.F]);else if(T[0].indexOf('t="shared"')>-1){N=at(T[0]);var Te=Pt(Jt(T[1]));d.xlfn||(Te=d2(Te)),Ee[parseInt(N.si,10)]=[N,Te,w.r]}}else(T=W.match(/<f[^>]*\/>/))&&(N=at(T[0]),Ee[N.si]&&(B.f=I6(Ee[N.si][1],Ee[N.si][2],w.r)));var _e=wr(w.r);for(_=0;_<Fe.length;++_)_e.r>=Fe[_][0].s.r&&_e.r<=Fe[_][0].e.r&&_e.c>=Fe[_][0].s.c&&_e.c<=Fe[_][0].e.c&&(B.F=Fe[_][1])}if(w.t==null&&B.v===void 0)if(B.f||B.F)B.v=0,B.t="n";else if(j)B.t="z";else continue;else B.t=w.t||"n";switch(h.s.c>S&&(h.s.c=S),h.e.c<S&&(h.e.c=S),B.t){case"n":if(B.v==""||B.v==null){if(!j)continue;B.t="z"}else B.v=parseFloat(B.v);break;case"s":if(typeof B.v>"u"){if(!j)continue;B.t="z"}else b=ff[parseInt(B.v,10)],B.v=b.t,B.r=b.r,d.cellHTML&&(B.h=b.h);break;case"str":B.t="s",B.v=B.v!=null?Jt(B.v):"",d.cellHTML&&(B.h=b1(B.v));break;case"inlineStr":T=W.match(n),B.t="s",T!=null&&(b=$1(T[1]))?(B.v=b.t,d.cellHTML&&(B.h=b.h)):B.v="";break;case"b":B.v=ar(B.v);break;case"d":d.cellDates?B.v=lr(B.v,1):(B.v=Jr(lr(B.v,1)),B.t="n");break;case"e":(!d||d.cellText!==!1)&&(B.w=B.v),B.v=qS[B.v];break}if(D=R=0,ge=null,Ue&&w.s!==void 0&&(ge=m.CellXf[w.s],ge!=null&&(ge.numFmtId!=null&&(D=ge.numFmtId),d.cellStyles&&ge.fillId!=null&&(R=ge.fillId))),Gk(B,D,R,d,p,m),d.cellDates&&Ue&&B.t=="n"&&lu(it[D])&&(B.t="d",B.v=Ap(B.v)),w.cm&&d.xlmeta){var rt=(d.xlmeta.Cell||[])[+w.cm-1];rt&&rt.type=="XLDAPR"&&(B.D=!0)}if(xe){var G=wr(w.r);c[G.r]||(c[G.r]=[]),c[G.r][G.c]=B}else c[w.r]=B}}}}J.length>0&&(c["!rows"]=J)}}();function P5(t,e,r,n){var i=[],s=[],a=Ot(t["!ref"]),o="",l,c="",d=[],h=0,p=0,m=t["!rows"],y=Array.isArray(t),x={r:c},E,T=-1;for(p=a.s.c;p<=a.e.c;++p)d[p]=Er(p);for(h=a.s.r;h<=a.e.r;++h){for(s=[],c=Mr(h),p=a.s.c;p<=a.e.c;++p){l=d[p]+c;var k=y?(t[h]||[])[p]:t[l];k!==void 0&&(o=N5(k,l,t,e))!=null&&s.push(o)}(s.length>0||m&&m[h])&&(x={r:c},m&&m[h]&&(E=m[h],E.hidden&&(x.hidden=1),T=-1,E.hpx?T=Kf(E.hpx):E.hpt&&(T=E.hpt),T>-1&&(x.ht=T,x.customHeight=1),E.level&&(x.outlineLevel=E.level)),i[i.length]=Be("row",s.join(""),x))}if(m)for(;h<m.length;++h)m&&m[h]&&(x={r:h+1},E=m[h],E.hidden&&(x.hidden=1),T=-1,E.hpx?T=Kf(E.hpx):E.hpt&&(T=E.hpt),T>-1&&(x.ht=T,x.customHeight=1),E.level&&(x.outlineLevel=E.level),i[i.length]=Be("row","",x));return i.join("")}function Xk(t,e,r,n){var i=[Lr,Be("worksheet",null,{xmlns:Ml[0],"xmlns:r":Xr.r})],s=r.SheetNames[t],a=0,o="",l=r.Sheets[s];l==null&&(l={});var c=l["!ref"]||"A1",d=Ot(c);if(d.e.c>16383||d.e.r>1048575){if(e.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),c=mt(d)}n||(n={}),l["!comments"]=[];var h=[];v5(l,r,t,e,i),i[i.length]=Be("dimension",null,{ref:c}),i[i.length]=R5(l,e,t,r),e.sheetFormat&&(i[i.length]=Be("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(i[i.length]=A5(l,l["!cols"])),i[a=i.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=P5(l,e),o.length>0&&(i[i.length]=o)),i.length>a+1&&(i[i.length]="</sheetData>",i[a]=i[a].replace("/>",">")),l["!protect"]&&(i[i.length]=E5(l["!protect"])),l["!autofilter"]!=null&&(i[i.length]=F5(l["!autofilter"],l,r,t)),l["!merges"]!=null&&l["!merges"].length>0&&(i[i.length]=m5(l["!merges"]));var p=-1,m,y=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(x){x[1].Target&&(m={ref:x[0]},x[1].Target.charAt(0)!="#"&&(y=Kt(n,-1,Xt(x[1].Target).replace(/#.*$/,""),yt.HLINK),m["r:id"]="rId"+y),(p=x[1].Target.indexOf("#"))>-1&&(m.location=Xt(x[1].Target.slice(p+1))),x[1].Tooltip&&(m.tooltip=Xt(x[1].Tooltip)),i[i.length]=Be("hyperlink",null,m))}),i[i.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(i[i.length]=S5(l["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(i[i.length]=wn("ignoredErrors",Be("ignoredError",null,{numberStoredAsText:1,sqref:c}))),h.length>0&&(y=Kt(n,-1,"../drawings/drawing"+(t+1)+".xml",yt.DRAW),i[i.length]=Be("drawing",null,{"r:id":"rId"+y}),l["!drawing"]=h),l["!comments"].length>0&&(y=Kt(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",yt.VML),i[i.length]=Be("legacyDrawing",null,{"r:id":"rId"+y}),l["!legacy"]=y),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function O5(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var i=t.read_shift(2);t.l+=1;var s=t.read_shift(1);return t.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=i/20),r}function M5(t,e,r){var n=pe(145),i=(r["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var s=320;i.hpx?s=Kf(i.hpx)*20:i.hpt&&(s=i.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var a=0;i.level&&(a|=i.level),i.hidden&&(a|=16),(i.hpx||i.hpt)&&(a|=32),n.write_shift(1,a),n.write_shift(1,0);var o=0,l=n.l;n.l+=4;for(var c={r:t,c:0},d=0;d<16;++d)if(!(e.s.c>d+1<<10||e.e.c<d<<10)){for(var h=-1,p=-1,m=d<<10;m<d+1<<10;++m){c.c=m;var y=Array.isArray(r)?(r[c.r]||[])[c.c]:r[st(c)];y&&(h<0&&(h=m),p=m)}h<0||(++o,n.write_shift(4,h),n.write_shift(4,p))}var x=n.l;return n.l=l,n.write_shift(4,o),n.l=x,n.length>n.l?n.slice(0,n.l):n}function L5(t,e,r,n){var i=M5(n,r,e);(i.length>17||(e["!rows"]||[])[n])&&ye(t,0,i)}var B5=Vl,j5=fu;function V5(){}function U5(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=$R(t),r}function z5(t,e,r){r==null&&(r=pe(84+4*t.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),r.write_shift(1,n);for(var i=1;i<3;++i)r.write_shift(1,0);return Lh({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),$S(t,r),r.slice(0,r.l)}function W5(t){var e=us(t);return[e]}function $5(t,e,r){return r==null&&(r=pe(8)),Ll(e,r)}function H5(t){var e=Bl(t);return[e]}function G5(t,e,r){return r==null&&(r=pe(4)),jl(e,r)}function K5(t){var e=us(t),r=t.read_shift(1);return[e,r,"b"]}function X5(t,e,r){return r==null&&(r=pe(9)),Ll(e,r),r.write_shift(1,t.v?1:0),r}function q5(t){var e=Bl(t),r=t.read_shift(1);return[e,r,"b"]}function Y5(t,e,r){return r==null&&(r=pe(5)),jl(e,r),r.write_shift(1,t.v?1:0),r}function Q5(t){var e=us(t),r=t.read_shift(1);return[e,r,"e"]}function J5(t,e,r){return r==null&&(r=pe(9)),Ll(e,r),r.write_shift(1,t.v),r}function Z5(t){var e=Bl(t),r=t.read_shift(1);return[e,r,"e"]}function eO(t,e,r){return r==null&&(r=pe(8)),jl(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function tO(t){var e=us(t),r=t.read_shift(4);return[e,r,"s"]}function rO(t,e,r){return r==null&&(r=pe(12)),Ll(e,r),r.write_shift(4,e.v),r}function nO(t){var e=Bl(t),r=t.read_shift(4);return[e,r,"s"]}function iO(t,e,r){return r==null&&(r=pe(8)),jl(e,r),r.write_shift(4,e.v),r}function sO(t){var e=us(t),r=Hn(t);return[e,r,"n"]}function aO(t,e,r){return r==null&&(r=pe(16)),Ll(e,r),kl(t.v,r),r}function qk(t){var e=Bl(t),r=Hn(t);return[e,r,"n"]}function oO(t,e,r){return r==null&&(r=pe(12)),jl(e,r),kl(t.v,r),r}function lO(t){var e=us(t),r=j1(t);return[e,r,"n"]}function cO(t,e,r){return r==null&&(r=pe(12)),Ll(e,r),HS(t.v,r),r}function uO(t){var e=Bl(t),r=j1(t);return[e,r,"n"]}function fO(t,e,r){return r==null&&(r=pe(8)),jl(e,r),HS(t.v,r),r}function dO(t){var e=us(t),r=M1(t);return[e,r,"is"]}function hO(t){var e=us(t),r=Gn(t);return[e,r,"str"]}function pO(t,e,r){return r==null&&(r=pe(12+4*t.v.length)),Ll(e,r),cn(t.v,r),r.length>r.l?r.slice(0,r.l):r}function gO(t){var e=Bl(t),r=Gn(t);return[e,r,"str"]}function mO(t,e,r){return r==null&&(r=pe(8+4*t.v.length)),jl(e,r),cn(t.v,r),r.length>r.l?r.slice(0,r.l):r}function xO(t,e,r){var n=t.l+e,i=us(t);i.r=r["!row"];var s=t.read_shift(1),a=[i,s,"b"];if(r.cellFormula){t.l+=2;var o=Ip(t,n-t.l,r);a[3]=Un(o,null,i,r.supbooks,r)}else t.l=n;return a}function vO(t,e,r){var n=t.l+e,i=us(t);i.r=r["!row"];var s=t.read_shift(1),a=[i,s,"e"];if(r.cellFormula){t.l+=2;var o=Ip(t,n-t.l,r);a[3]=Un(o,null,i,r.supbooks,r)}else t.l=n;return a}function yO(t,e,r){var n=t.l+e,i=us(t);i.r=r["!row"];var s=Hn(t),a=[i,s,"n"];if(r.cellFormula){t.l+=2;var o=Ip(t,n-t.l,r);a[3]=Un(o,null,i,r.supbooks,r)}else t.l=n;return a}function _O(t,e,r){var n=t.l+e,i=us(t);i.r=r["!row"];var s=Gn(t),a=[i,s,"str"];if(r.cellFormula){t.l+=2;var o=Ip(t,n-t.l,r);a[3]=Un(o,null,i,r.supbooks,r)}else t.l=n;return a}var EO=Vl,wO=fu;function TO(t,e){return e==null&&(e=pe(4)),e.write_shift(4,t),e}function SO(t,e){var r=t.l+e,n=Vl(t),i=L1(t),s=Gn(t),a=Gn(t),o=Gn(t);t.l=r;var l={rfx:n,relId:i,loc:s,display:o};return a&&(l.Tooltip=a),l}function kO(t,e){var r=pe(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));fu({s:wr(t[0]),e:wr(t[0])},r),B1("rId"+e,r);var n=t[1].Target.indexOf("#"),i=n==-1?"":t[1].Target.slice(n+1);return cn(i||"",r),cn(t[1].Tooltip||"",r),cn("",r),r.slice(0,r.l)}function AO(){}function CO(t,e,r){var n=t.l+e,i=GS(t),s=t.read_shift(1),a=[i];if(a[2]=s,r.cellFormula){var o=Q8(t,n-t.l,r);a[1]=o}else t.l=n;return a}function FO(t,e,r){var n=t.l+e,i=Vl(t),s=[i];if(r.cellFormula){var a=Z8(t,n-t.l,r);s[1]=a,t.l=n}else t.l=n;return s}function IO(t,e,r){r==null&&(r=pe(18));var n=bp(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var i=0;return e.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),e.level&&(i|=e.level<<8),r.write_shift(2,i),r}var Yk=["left","right","top","bottom","header","footer"];function bO(t){var e={};return Yk.forEach(function(r){e[r]=Hn(t)}),e}function RO(t,e){return e==null&&(e=pe(6*8)),gl(t),Yk.forEach(function(r){kl(t[r],e)}),e}function NO(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function DO(t,e,r){r==null&&(r=pe(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function PO(t){var e=pe(24);return e.write_shift(4,4),e.write_shift(4,1),fu(t,e),e}function OO(t,e){return e==null&&(e=pe(16*4+2)),e.write_shift(2,t.password?H1(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function MO(){}function LO(){}function BO(t,e,r,n,i,s,a){if(!t)return t;var o=e||{};n||(n={"!id":{}});var l=o.dense?[]:{},c,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},h=!1,p=!1,m,y,x,E,T,k,_,P,W,B=[];o.biff=12,o["!row"]=0;var w=0,C=!1,S=[],b={},N=o.supbooks||i.supbooks||[[]];if(N.sharedf=b,N.arrayf=S,N.SheetNames=i.SheetNames||i.Sheets.map(function(xe){return xe.name}),!o.supbooks&&(o.supbooks=N,i.Names))for(var D=0;D<i.Names.length;++D)N[0][D+1]=i.Names[D];var R=[],Ue=[],ge=!1;Xf[16]={n:"BrtShortReal",f:qk};var Fe;if(La(t,function(J,ke,Me){if(!p)switch(Me){case 148:c=J;break;case 0:m=J,o.sheetRows&&o.sheetRows<=m.r&&(p=!0),P=Mr(E=m.r),o["!row"]=m.r,(J.hidden||J.hpt||J.level!=null)&&(J.hpt&&(J.hpx=qc(J.hpt)),Ue[J.r]=J);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(y={t:J[2]},J[2]){case"n":y.v=J[1];break;case"s":_=ff[J[1]],y.v=_.t,y.r=_.r;break;case"b":y.v=!!J[1];break;case"e":y.v=J[1],o.cellText!==!1&&(y.w=Ba[y.v]);break;case"str":y.t="s",y.v=J[1];break;case"is":y.t="s",y.v=J[1].t;break}if((x=a.CellXf[J[0].iStyleRef])&&Gk(y,x.numFmtId,null,o,s,a),T=J[0].c==-1?T+1:J[0].c,o.dense?(l[E]||(l[E]=[]),l[E][T]=y):l[Er(T)+P]=y,o.cellFormula){for(C=!1,w=0;w<S.length;++w){var j=S[w];m.r>=j[0].s.r&&m.r<=j[0].e.r&&T>=j[0].s.c&&T<=j[0].e.c&&(y.F=mt(j[0]),C=!0)}!C&&J.length>3&&(y.f=J[3])}if(d.s.r>m.r&&(d.s.r=m.r),d.s.c>T&&(d.s.c=T),d.e.r<m.r&&(d.e.r=m.r),d.e.c<T&&(d.e.c=T),o.cellDates&&x&&y.t=="n"&&lu(it[x.numFmtId])){var H=ll(y.v);H&&(y.t="d",y.v=new Date(H.y,H.m-1,H.d,H.H,H.M,H.S,H.u))}Fe&&(Fe.type=="XLDAPR"&&(y.D=!0),Fe=void 0);break;case 1:case 12:if(!o.sheetStubs||h)break;y={t:"z",v:void 0},T=J[0].c==-1?T+1:J[0].c,o.dense?(l[E]||(l[E]=[]),l[E][T]=y):l[Er(T)+P]=y,d.s.r>m.r&&(d.s.r=m.r),d.s.c>T&&(d.s.c=T),d.e.r<m.r&&(d.e.r=m.r),d.e.c<T&&(d.e.c=T),Fe&&(Fe.type=="XLDAPR"&&(y.D=!0),Fe=void 0);break;case 176:B.push(J);break;case 49:Fe=((o.xlmeta||{}).Cell||[])[J-1];break;case 494:var q=n["!id"][J.relId];for(q?(J.Target=q.Target,J.loc&&(J.Target+="#"+J.loc),J.Rel=q):J.relId==""&&(J.Target="#"+J.loc),E=J.rfx.s.r;E<=J.rfx.e.r;++E)for(T=J.rfx.s.c;T<=J.rfx.e.c;++T)o.dense?(l[E]||(l[E]=[]),l[E][T]||(l[E][T]={t:"z",v:void 0}),l[E][T].l=J):(k=st({c:T,r:E}),l[k]||(l[k]={t:"z",v:void 0}),l[k].l=J);break;case 426:if(!o.cellFormula)break;S.push(J),W=o.dense?l[E][T]:l[Er(T)+P],W.f=Un(J[1],d,{r:m.r,c:T},N,o),W.F=mt(J[0]);break;case 427:if(!o.cellFormula)break;b[st(J[0].s)]=J[1],W=o.dense?l[E][T]:l[Er(T)+P],W.f=Un(J[1],d,{r:m.r,c:T},N,o);break;case 60:if(!o.cellStyles)break;for(;J.e>=J.s;)R[J.e--]={width:J.w/256,hidden:!!(J.flags&1),level:J.level},ge||(ge=!0,G1(J.w/256)),Ro(R[J.e+1]);break;case 161:l["!autofilter"]={ref:mt(J)};break;case 476:l["!margins"]=J;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),J.name&&(i.Sheets[r].CodeName=J.name),(J.above||J.left)&&(l["!outline"]={above:J.above,left:J.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),J.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:h=!0;break;case 36:h=!1;break;case 37:h=!0;break;case 38:h=!1;break;default:if(!ke.T){if(!h||o.WTF)throw new Error("Unexpected record 0x"+Me.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(d.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(l["!ref"]=mt(c||d)),o.sheetRows&&l["!ref"]){var Ee=Ot(l["!ref"]);o.sheetRows<=+Ee.e.r&&(Ee.e.r=o.sheetRows-1,Ee.e.r>d.e.r&&(Ee.e.r=d.e.r),Ee.e.r<Ee.s.r&&(Ee.s.r=Ee.e.r),Ee.e.c>d.e.c&&(Ee.e.c=d.e.c),Ee.e.c<Ee.s.c&&(Ee.s.c=Ee.e.c),l["!fullref"]=l["!ref"],l["!ref"]=mt(Ee))}return B.length>0&&(l["!merges"]=B),R.length>0&&(l["!cols"]=R),Ue.length>0&&(l["!rows"]=Ue),l}function jO(t,e,r,n,i,s,a){if(e.v===void 0)return!1;var o="";switch(e.t){case"b":o=e.v?"1":"0";break;case"d":e=cr(e),e.z=e.z||it[14],e.v=Jr(lr(e.v)),e.t="n";break;case"n":case"e":o=""+e.v;break;default:o=e.v;break}var l={r,c:n};switch(l.s=zo(i.cellXfs,e,i),e.l&&s["!links"].push([st(l),e.l]),e.c&&s["!comments"].push([st(l),e.c]),e.t){case"s":case"str":return i.bookSST?(o=Q1(i.Strings,e.v,i.revStrings),l.t="s",l.v=o,a?ye(t,18,iO(e,l)):ye(t,7,rO(e,l))):(l.t="str",a?ye(t,17,mO(e,l)):ye(t,6,pO(e,l))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?a?ye(t,13,fO(e,l)):ye(t,2,cO(e,l)):a?ye(t,16,oO(e,l)):ye(t,5,aO(e,l)),!0;case"b":return l.t="b",a?ye(t,15,Y5(e,l)):ye(t,4,X5(e,l)),!0;case"e":return l.t="e",a?ye(t,14,eO(e,l)):ye(t,3,J5(e,l)),!0}return a?ye(t,12,G5(e,l)):ye(t,1,$5(e,l)),!0}function VO(t,e,r,n){var i=Ot(e["!ref"]||"A1"),s,a="",o=[];ye(t,145);var l=Array.isArray(e),c=i.e.r;e["!rows"]&&(c=Math.max(i.e.r,e["!rows"].length-1));for(var d=i.s.r;d<=c;++d){a=Mr(d),L5(t,e,i,d);var h=!1;if(d<=i.e.r)for(var p=i.s.c;p<=i.e.c;++p){d===i.s.r&&(o[p]=Er(p)),s=o[p]+a;var m=l?(e[d]||[])[p]:e[s];if(!m){h=!1;continue}h=jO(t,m,d,p,n,e,h)}}ye(t,146)}function UO(t,e){!e||!e["!merges"]||(ye(t,177,TO(e["!merges"].length)),e["!merges"].forEach(function(r){ye(t,176,wO(r))}),ye(t,178))}function zO(t,e){!e||!e["!cols"]||(ye(t,390),e["!cols"].forEach(function(r,n){r&&ye(t,60,IO(n,r))}),ye(t,391))}function WO(t,e){!e||!e["!ref"]||(ye(t,648),ye(t,649,PO(Ot(e["!ref"]))),ye(t,650))}function $O(t,e,r){e["!links"].forEach(function(n){if(n[1].Target){var i=Kt(r,-1,n[1].Target.replace(/#.*$/,""),yt.HLINK);ye(t,494,kO(n,i))}}),delete e["!links"]}function HO(t,e,r,n){if(e["!comments"].length>0){var i=Kt(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",yt.VML);ye(t,551,B1("rId"+i)),e["!legacy"]=i}}function GO(t,e,r,n){if(e["!autofilter"]){var i=e["!autofilter"],s=typeof i.ref=="string"?i.ref:mt(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,o=Ei(s);o.s.r==o.e.r&&(o.e.r=Ei(e["!ref"]).e.r,s=mt(o));for(var l=0;l<a.length;++l){var c=a[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+s;break}}l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),ye(t,161,fu(Ot(s))),ye(t,162)}}function KO(t,e,r){ye(t,133),ye(t,137,DO(e,r)),ye(t,138),ye(t,134)}function XO(t,e){e["!protect"]&&ye(t,535,OO(e["!protect"]))}function qO(t,e,r,n){var i=_i(),s=r.SheetNames[t],a=r.Sheets[s]||{},o=s;try{r&&r.Workbook&&(o=r.Workbook.Sheets[t].CodeName||o)}catch{}var l=Ot(a["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(e.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],ye(i,129),(r.vbaraw||a["!outline"])&&ye(i,147,z5(o,a["!outline"])),ye(i,148,j5(l)),KO(i,a,r.Workbook),zO(i,a),VO(i,a,t,e),XO(i,a),GO(i,a,r,t),UO(i,a),$O(i,a,n),a["!margins"]&&ye(i,476,RO(a["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&WO(i,a),HO(i,a,t,n),ye(i,130),i.end()}function YO(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var a=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);a&&(e[+a[1]]=r?+a[2]:a[2])});var i=Pt((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[e,i,n]}function QO(t,e,r,n,i,s){var a=s||{"!type":"chart"};if(!t)return s;var o=0,l=0,c="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(h){var p=YO(h);d.s.r=d.s.c=0,d.e.c=o,c=Er(o),p[0].forEach(function(m,y){a[c+Mr(y)]={t:"n",v:m,z:p[1]},l=y}),d.e.r<l&&(d.e.r=l),++o}),o>0&&(a["!ref"]=mt(d)),a}function JO(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a,o=t.match(Kk);return o&&J1(o[0],s,i,r),(a=t.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=a[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function ZO(t,e){t.l+=10;var r=Gn(t);return{name:r}}function eM(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a=!1;return La(t,function(l,c,d){switch(d){case 550:s["!rel"]=l;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),l.name&&(i.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!(c.T>0)){if(!(c.T<0)){if(!a||e.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},e),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var Z1=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],tM=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],rM=[],nM=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function x2(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],i=0;i!=e.length;++i){var s=e[i];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=ar(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function v2(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=ar(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function Qk(t){v2(t.WBProps,Z1),v2(t.CalcPr,nM),x2(t.WBView,tM),x2(t.Sheets,rM),Oc.date1904=ar(t.WBProps.date1904)}function iM(t){return!t.Workbook||!t.Workbook.WBProps?"false":ar(t.Workbook.WBProps.date1904)?"true":"false"}var sM="][*?/\\".split("");function Jk(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return sM.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function aM(t,e,r){t.forEach(function(n,i){Jk(n);for(var s=0;s<i;++s)if(n==t[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var a=e&&e[i]&&e[i].CodeName||n;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function oM(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];aM(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)i5(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}var lM=/<\w+:workbook/;function cM(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",s={},a=0;if(t.replace(Yn,function(l,c){var d=at(l);switch(ra(d[0])){case"<?xml":break;case"<workbook":l.match(lM)&&(i="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=d[i];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Z1.forEach(function(h){if(d[h[0]]!=null)switch(h[2]){case"bool":r.WBProps[h[0]]=ar(d[h[0]]);break;case"int":r.WBProps[h[0]]=parseInt(d[h[0]],10);break;default:r.WBProps[h[0]]=d[h[0]]}}),d.codeName&&(r.WBProps.CodeName=Jt(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=Pt(Jt(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=Jt(d.name),d.comment&&(s.Comment=d.comment),d.localSheetId&&(s.Sheet=+d.localSheetId),ar(d.hidden||"0")&&(s.Hidden=!0),a=c+l.length;break;case"</definedName>":s.Ref=Pt(Jt(t.slice(a,c))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return l}),Ml.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return Qk(r),r}function Zk(t){var e=[Lr];e[e.length]=Be("workbook",null,{xmlns:Ml[0],"xmlns:r":Xr.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(Z1.forEach(function(o){t.Workbook.WBProps[o[0]]!=null&&t.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=t.Workbook.WBProps[o[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=Be("workbookPr",null,n);var i=t.Workbook&&t.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(e[e.length]="<bookViews>",s=0;s!=t.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==t.SheetNames.length&&(s=0),e[e.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",s=0;s!=t.SheetNames.length;++s){var a={name:Xt(t.SheetNames[s].slice(0,31))};if(a.sheetId=""+(s+1),a["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}e[e.length]=Be("sheet",null,a)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(e[e.length]=Be("definedName",Xt(o.Ref),l))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function uM(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=Km(t),r.name=Gn(t),r}function fM(t,e){return e||(e=pe(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),B1(t.strRelID,e),cn(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function dM(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var i=e>8?Gn(t):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function hM(t,e){e||(e=pe(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),$S(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function pM(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function gM(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var i=t.read_shift(4),s=HR(t),a=J8(t,0,r),o=L1(t);t.l=n;var l={Name:s,Ptg:a};return i<268435455&&(l.Sheet=i),o&&(l.Comment=o),l}function mM(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;e||(e={}),e.biff=12;var s=[],a=[[]];return a.SheetNames=[],a.XTI=[],Xf[16]={n:"BrtFRTArchID$",f:pM},La(t,function(l,c,d){switch(d){case 156:a.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(e.SID=l.Sheet),l.Ref=Un(l.Ptg,null,null,a,e),delete e.SID,delete l.Ptg,s.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:a[0].length?a.push([d,l]):a[0]=[d,l],a[a.length-1].XTI=[];break;case 362:a.length===0&&(a[0]=[],a[0].XTI=[]),a[a.length-1].XTI=a[a.length-1].XTI.concat(l),a.XTI=a.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(d),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(d),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!c.T){if(!i||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},e),Qk(r),r.Names=s,r.supbooks=a,r}function xM(t,e){ye(t,143);for(var r=0;r!=e.SheetNames.length;++r){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,i={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};ye(t,156,fM(i))}ye(t,144)}function vM(t,e){e||(e=pe(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return cn("SheetJS",e),cn(bh.version,e),cn(bh.version,e),cn("7262",e),e.length>e.l?e.slice(0,e.l):e}function yM(t,e){e||(e=pe(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function _M(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,n=0,i=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&i==-1?i=n:r[n].Hidden==1&&s==-1&&(s=n);s>i||(ye(t,135),ye(t,158,yM(i)),ye(t,136))}}function EM(t,e){var r=_i();return ye(r,131),ye(r,128,vM()),ye(r,153,hM(t.Workbook&&t.Workbook.WBProps||null)),_M(r,t),xM(r,t),ye(r,132),r.end()}function wM(t,e,r){return e.slice(-4)===".bin"?mM(t,r):cM(t,r)}function TM(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?BO(t,n,r,i,s,a,o):g5(t,n,r,i,s,a,o)}function SM(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?eM(t,n,r,i,s):JO(t,n,r,i,s)}function kM(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?C6():F6()}function AM(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?k6():A6()}function CM(t,e,r,n){return e.slice(-4)===".bin"?wP(t,r,n):uP(t,r,n)}function FM(t,e,r){return Dk(t,r)}function IM(t,e,r){return e.slice(-4)===".bin"?ID(t,r):AD(t,r)}function bM(t,e,r){return e.slice(-4)===".bin"?_6(t,r):f6(t,r)}function RM(t,e,r){return e.slice(-4)===".bin"?l6(t):a6(t)}function NM(t,e,r,n){return r.slice(-4)===".bin"?c6(t,e,r,n):void 0}function DM(t,e,r){return e.slice(-4)===".bin"?n6(t,e,r):s6(t,e,r)}function PM(t,e,r){return(e.slice(-4)===".bin"?EM:Zk)(t)}function OM(t,e,r,n,i){return(e.slice(-4)===".bin"?qO:Xk)(t,r,n,i)}function MM(t,e,r){return(e.slice(-4)===".bin"?NP:Rk)(t,r)}function LM(t,e,r){return(e.slice(-4)===".bin"?ND:Tk)(t,r)}function BM(t,e,r){return(e.slice(-4)===".bin"?E6:Mk)(t)}function jM(t){return(t.slice(-4)===".bin"?i6:Pk)()}var eA=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,tA=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function ws(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var i=t.match(eA),s,a,o,l;if(i)for(l=0;l!=i.length;++l)s=i[l].match(tA),(a=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(a+1),n[o]=s[2].slice(1,s[2].length-1));return n}function VM(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(eA),i,s,a,o;if(n)for(o=0;o!=n.length;++o)i=n[o].match(tA),(s=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?a="xmlns"+i[1].slice(6):a=i[1].slice(s+1),r[a]=i[2].slice(1,i[2].length-1));return r}var hf;function UM(t,e){var r=hf[t]||Pt(t);return r==="General"?Tl(e):cs(r,e)}function zM(t,e,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=ar(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=lr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[Pt(e)]=i}function WM(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||Ba[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=jf(t.v):t.w=Tl(t.v):t.w=UM(e||"General",t.v)}catch(s){if(r.WTF)throw s}try{var n=hf[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&lu(n)){var i=ll(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(s){if(r.WTF)throw s}}}function $M(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=rP[n.Pattern]||n.Pattern)}t[e.ID]=e}function HM(t,e,r,n,i,s,a,o,l,c){var d="General",h=n.StyleID,p={};c=c||{};var m=[],y=0;for(h===void 0&&o&&(h=o.StyleID),h===void 0&&a&&(h=a.StyleID);s[h]!==void 0&&(s[h].nf&&(d=s[h].nf),s[h].Interior&&m.push(s[h].Interior),!!s[h].Parent);)h=s[h].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=ar(t);break;case"String":n.t="s",n.r=O_(Pt(t)),n.v=t.indexOf("<")>-1?Pt(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(lr(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=Pt(t):n.v<60&&(n.v=n.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=qS[t],c.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=O_(e||t));break}if(WM(n,d,c),c.cellFormula!==!1)if(n.Formula){var x=Pt(n.Formula);x.charCodeAt(0)==61&&(x=x.slice(1)),n.f=Pc(x,i),delete n.Formula,n.ArrayRange=="RC"?n.F=Pc("RC:RC",i):n.ArrayRange&&(n.F=Pc(n.ArrayRange,i),l.push([Ot(n.F),n.F]))}else for(y=0;y<l.length;++y)i.r>=l[y][0].s.r&&i.r<=l[y][0].e.r&&i.c>=l[y][0].s.c&&i.c<=l[y][0].e.c&&(n.F=l[y][1]);c.cellStyles&&(m.forEach(function(E){!p.patternType&&E.patternType&&(p.patternType=E.patternType)}),n.s=p),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function GM(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function Ig(t,e){var r=e||{};cu();var n=$u(R1(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Jt(n));var i=n.slice(0,1024).toLowerCase(),s=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var a=cr(r);return a.type="string",Xc.to_workbook(n,a)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Zt){i.indexOf("<"+Zt)>=0&&(s=!0)}),s)return RL(n,r);hf={"General Number":"General","General Date":it[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":it[15],"Short Date":it[14],"Long Time":it[19],"Medium Time":it[18],"Short Time":it[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:it[2],Standard:it[4],Percent:it[10],Scientific:it[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],c,d={},h=[],p=r.dense?[]:{},m="",y={},x={},E=ws('<Data ss:Type="String">'),T=0,k=0,_=0,P={s:{r:2e6,c:2e6},e:{r:0,c:0}},W={},B={},w="",C=0,S=[],b={},N={},D=0,R=[],Ue=[],ge={},Fe=[],Ee,xe=!1,J=[],ke=[],Me={},j=0,H=0,q={Sheets:[],WBProps:{date1904:!1}},X={};zf.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var de="";o=zf.exec(n);)switch(o[3]=(de=o[3]).toLowerCase()){case"data":if(de=="data"){if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?HM(n.slice(T,o.index),w,E,l[l.length-1][0]=="comment"?ge:y,{c:k,r:_},W,Fe[k],x,J,r):(w="",E=ws(o[0]),T=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(Ue.length>0&&(y.c=Ue),(!r.sheetRows||r.sheetRows>_)&&y.v!==void 0&&(r.dense?(p[_]||(p[_]=[]),p[_][k]=y):p[Er(k)+Mr(_)]=y),y.HRef&&(y.l={Target:Pt(y.HRef)},y.HRefScreenTip&&(y.l.Tooltip=y.HRefScreenTip),delete y.HRef,delete y.HRefScreenTip),(y.MergeAcross||y.MergeDown)&&(j=k+(parseInt(y.MergeAcross,10)|0),H=_+(parseInt(y.MergeDown,10)|0),S.push({s:{c:k,r:_},e:{c:j,r:H}})),!r.sheetStubs)y.MergeAcross?k=j+1:++k;else if(y.MergeAcross||y.MergeDown){for(var we=k;we<=j;++we)for(var Ne=_;Ne<=H;++Ne)(we>k||Ne>_)&&(r.dense?(p[Ne]||(p[Ne]=[]),p[Ne][we]={t:"z"}):p[Er(we)+Mr(Ne)]={t:"z"});k=j+1}else++k;else y=VM(o[0]),y.Index&&(k=+y.Index-1),k<P.s.c&&(P.s.c=k),k>P.e.c&&(P.e.c=k),o[0].slice(-2)==="/>"&&++k,Ue=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(_<P.s.r&&(P.s.r=_),_>P.e.r&&(P.e.r=_),o[0].slice(-2)==="/>"&&(x=ws(o[0]),x.Index&&(_=+x.Index-1)),k=0,++_):(x=ws(o[0]),x.Index&&(_=+x.Index-1),Me={},(x.AutoFitHeight=="0"||x.Height)&&(Me.hpx=parseInt(x.Height,10),Me.hpt=Kf(Me.hpx),ke[_]=Me),x.Hidden=="1"&&(Me.hidden=!0,ke[_]=Me));break;case"worksheet":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));h.push(m),P.s.r<=P.e.r&&P.s.c<=P.e.c&&(p["!ref"]=mt(P),r.sheetRows&&r.sheetRows<=P.e.r&&(p["!fullref"]=p["!ref"],P.e.r=r.sheetRows-1,p["!ref"]=mt(P))),S.length&&(p["!merges"]=S),Fe.length>0&&(p["!cols"]=Fe),ke.length>0&&(p["!rows"]=ke),d[m]=p}else P={s:{r:2e6,c:2e6},e:{r:0,c:0}},_=k=0,l.push([o[3],!1]),c=ws(o[0]),m=Pt(c.Name),p=r.dense?[]:{},S=[],J=[],ke=[],X={name:m,Hidden:0},q.Sheets.push(X);break;case"table":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),Fe=[],xe=!1}break;case"style":o[1]==="/"?$M(W,B,r):B=ws(o[0]);break;case"numberformat":B.nf=Pt(ws(o[0]).Format||"General"),hf[B.nf]&&(B.nf=hf[B.nf]);for(var Te=0;Te!=392&&it[Te]!=B.nf;++Te);if(Te==392){for(Te=57;Te!=392;++Te)if(it[Te]==null){wa(B.nf,Te);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(Ee=ws(o[0]),Ee.Hidden&&(Ee.hidden=!0,delete Ee.Hidden),Ee.Width&&(Ee.wpx=parseInt(Ee.Width,10)),!xe&&Ee.wpx>10){xe=!0,Wn=Ik;for(var _e=0;_e<Fe.length;++_e)Fe[_e]&&Ro(Fe[_e])}xe&&Ro(Ee),Fe[Ee.Index-1||Fe.length]=Ee;for(var rt=0;rt<+Ee.Span;++rt)Fe[Fe.length]=cr(Ee);break;case"namedrange":if(o[1]==="/")break;q.Names||(q.Names=[]);var G=at(o[0]),Vt={Name:G.Name,Ref:Pc(G.RefersTo.slice(1),{r:0,c:0})};q.Sheets.length>0&&(Vt.Sheet=q.Sheets.length-1),q.Names.push(Vt);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?w+=n.slice(C,o.index):C=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;B.Interior=ws(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?mN(b,de,n.slice(D,o.index)):D=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));GM(ge),Ue.push(ge)}else l.push([o[3],!1]),c=ws(o[0]),ge={a:c.Author};break;case"autofilter":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var gt=ws(o[0]);p["!autofilter"]={ref:Pc(gt.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return T2(n,r);var Rt=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Rt=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Rt=!1}break;case"excelworkbook":switch(o[3]){case"date1904":q.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Rt=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:Rt=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(D,o.index)){case"SheetHidden":X.Hidden=1;break;case"SheetVeryHidden":X.Hidden=2;break}else D=o.index+o[0].length;break;case"header":p["!margins"]||gl(p["!margins"]={},"xlml"),isNaN(+at(o[0]).Margin)||(p["!margins"].header=+at(o[0]).Margin);break;case"footer":p["!margins"]||gl(p["!margins"]={},"xlml"),isNaN(+at(o[0]).Margin)||(p["!margins"].footer=+at(o[0]).Margin);break;case"pagemargins":var dt=at(o[0]);p["!margins"]||gl(p["!margins"]={},"xlml"),isNaN(+dt.Top)||(p["!margins"].top=+dt.Top),isNaN(+dt.Left)||(p["!margins"].left=+dt.Left),isNaN(+dt.Right)||(p["!margins"].right=+dt.Right),isNaN(+dt.Bottom)||(p["!margins"].bottom=+dt.Bottom);break;case"displayrighttoleft":q.Views||(q.Views=[]),q.Views[0]||(q.Views[0]={}),q.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":p["!outline"]||(p["!outline"]={}),p["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":p["!outline"]||(p["!outline"]={}),p["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Rt=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Rt=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Rt=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Rt=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Rt=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Rt=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Rt=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Rt=!1}break;case"smarttags":break;default:Rt=!1;break}if(Rt||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?zM(N,de,R,n.slice(D,o.index)):(R=o,D=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var $e={};return!r.bookSheets&&!r.bookProps&&($e.Sheets=d),$e.SheetNames=h,$e.Workbook=q,$e.SSF=cr(it),$e.Props=b,$e.Custprops=N,$e}function ex(t,e){switch(tv(e=e||{}),e.type||"base64"){case"base64":return Ig(Mi(t),e);case"binary":case"buffer":case"file":return Ig(t,e);case"array":return Ig(Vo(t),e)}}function KM(t,e){var r=[];return t.Props&&r.push(xN(t.Props,e)),t.Custprops&&r.push(vN(t.Props,t.Custprops)),r.join("")}function XM(){return""}function qM(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,i){var s=[];s.push(Be("NumberFormat",null,{"ss:Format":Xt(it[n.numFmtId])}));var a={"ss:ID":"s"+(21+i)};r.push(Be("Style",s.join(""),a))}),Be("Styles",r.join(""))}function rA(t){return Be("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+q1(t.Ref,{r:0,c:0})})}function YM(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],n=0;n<e.length;++n){var i=e[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(rA(i)))}return Be("Names",r.join(""))}function QM(t,e,r,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,s=[],a=0;a<i.length;++a){var o=i[a];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||s.push(rA(o)))}return s.join("")}function JM(t,e,r,n){if(!t)return"";var i=[];if(t["!margins"]&&(i.push("<PageSetup>"),t["!margins"].header&&i.push(Be("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&i.push(Be("Footer",null,{"x:Margin":t["!margins"].footer})),i.push(Be("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push(Be("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),t["!protect"]&&(i.push(wn("ProtectContents","True")),t["!protect"].objects&&i.push(wn("ProtectObjects","True")),t["!protect"].scenarios&&i.push(wn("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?i.push(wn("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&i.push(wn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){t["!protect"][a[0]]&&i.push("<"+a[1]+"/>")})),i.length==0?"":Be("WorksheetOptions",i.join(""),{xmlns:Fi.x})}function ZM(t){return t.map(function(e){var r=_R(e.t||""),n=Be("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Be("Comment",n,{"ss:Author":e.a})}).join("")}function eL(t,e,r,n,i,s,a){if(!t||t.v==null&&t.f==null)return"";var o={};if(t.f&&(o["ss:Formula"]="="+Xt(q1(t.f,a))),t.F&&t.F.slice(0,e.length)==e){var l=wr(t.F.slice(e.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==a.r?"":"["+(l.r-a.r)+"]")+"C"+(l.c==a.c?"":"["+(l.c-a.c)+"]")}if(t.l&&t.l.Target&&(o["ss:HRef"]=Xt(t.l.Target),t.l.Tooltip&&(o["x:HRefScreenTip"]=Xt(t.l.Tooltip))),r["!merges"])for(var c=r["!merges"],d=0;d!=c.length;++d)c[d].s.c!=a.c||c[d].s.r!=a.r||(c[d].e.c>c[d].s.c&&(o["ss:MergeAcross"]=c[d].e.c-c[d].s.c),c[d].e.r>c[d].s.r&&(o["ss:MergeDown"]=c[d].e.r-c[d].s.r));var h="",p="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":h="Number",p=String(t.v);break;case"b":h="Boolean",p=t.v?"1":"0";break;case"e":h="Error",p=Ba[t.v];break;case"d":h="DateTime",p=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||it[14]);break;case"s":h="String",p=yR(t.v||"");break}var m=zo(n.cellXfs,t,n);o["ss:StyleID"]="s"+(21+m),o["ss:Index"]=a.c+1;var y=t.v!=null?p:"",x=t.t=="z"?"":'<Data ss:Type="'+h+'">'+y+"</Data>";return(t.c||[]).length>0&&(x+=ZM(t.c)),Be("Cell",x,o)}function tL(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=qc(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function rL(t,e,r,n){if(!t["!ref"])return"";var i=Ot(t["!ref"]),s=t["!merges"]||[],a=0,o=[];t["!cols"]&&t["!cols"].forEach(function(E,T){Ro(E);var k=!!E.width,_=bp(T,E),P={"ss:Index":T+1};k&&(P["ss:Width"]=Hf(_.width)),E.hidden&&(P["ss:Hidden"]="1"),o.push(Be("Column",null,P))});for(var l=Array.isArray(t),c=i.s.r;c<=i.e.r;++c){for(var d=[tL(c,(t["!rows"]||[])[c])],h=i.s.c;h<=i.e.c;++h){var p=!1;for(a=0;a!=s.length;++a)if(!(s[a].s.c>h)&&!(s[a].s.r>c)&&!(s[a].e.c<h)&&!(s[a].e.r<c)){(s[a].s.c!=h||s[a].s.r!=c)&&(p=!0);break}if(!p){var m={r:c,c:h},y=st(m),x=l?(t[c]||[])[h]:t[y];d.push(eL(x,y,t,e,r,n,m))}}d.push("</Row>"),d.length>2&&o.push(d.join(""))}return o.join("")}function nL(t,e,r){var n=[],i=r.SheetNames[t],s=r.Sheets[i],a=s?QM(s,e,t,r):"";return a.length>0&&n.push("<Names>"+a+"</Names>"),a=s?rL(s,e,t,r):"",a.length>0&&n.push("<Table>"+a+"</Table>"),n.push(JM(s,e,t,r)),n.join("")}function iL(t,e){e||(e={}),t.SSF||(t.SSF=cr(it)),t.SSF&&(cu(),Tp(t.SSF),e.revssf=kp(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],zo(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(KM(t,e)),r.push(XM()),r.push(""),r.push("");for(var n=0;n<t.SheetNames.length;++n)r.push(Be("Worksheet",nL(n,e,t),{"ss:Name":Xt(t.SheetNames[n])}));return r[2]=qM(t,e),r[3]=YM(t),Lr+Be("Workbook",r.join(""),{xmlns:Fi.ss,"xmlns:o":Fi.o,"xmlns:x":Fi.x,"xmlns:ss":Fi.ss,"xmlns:dt":Fi.dt,"xmlns:html":Fi.html})}function sL(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=YR(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=QR(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var aL=[60,1084,2066,2165,2175];function oL(t,e,r,n,i){var s=n,a=[],o=r.slice(r.l,r.l+s);if(i&&i.enc&&i.enc.insitu&&o.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(o)}a.push(o),r.l+=s;for(var l=ma(r,r.l),c=tx[l],d=0;c!=null&&aL.indexOf(l)>-1;)s=ma(r,r.l+2),d=r.l+4,l==2066?d+=4:(l==2165||l==2175)&&(d+=12),o=r.slice(d,r.l+4+s),a.push(o),r.l+=4+s,c=tx[l=ma(r,r.l)];var h=ln(a);En(h,0);var p=0;h.lens=[];for(var m=0;m<a.length;++m)h.lens.push(p),p+=a[m].length;if(h.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+h.length+" < "+n;return e.f(h,h.length,i)}function Vs(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=it[n])}catch(s){if(e.WTF)throw s}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||Ba[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=jf(t.v):t.w=Tl(t.v):t.w=cs(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(s){if(e.WTF)throw s}if(e.cellDates&&n&&t.t=="n"&&lu(it[n]||String(n))){var i=ll(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function Ad(t,e,r){return{v:t,ixfe:e,t:r}}function lL(t,e){var r={opts:{}},n={},i=e.dense?[]:{},s={},a={},o=null,l=[],c="",d={},h,p="",m,y,x,E,T={},k=[],_,P,W=[],B=[],w={Sheets:[],WBProps:{date1904:!1},Views:[{}]},C={},S=function(ot){return ot<8?dl[ot]:ot<64&&B[ot-8]||dl[ot]},b=function(ot,ir,xr){var ur=ir.XF.data;if(!(!ur||!ur.patternType||!xr||!xr.cellStyles)){ir.s={},ir.s.patternType=ur.patternType;var Fn;(Fn=$f(S(ur.icvFore)))&&(ir.s.fgColor={rgb:Fn}),(Fn=$f(S(ur.icvBack)))&&(ir.s.bgColor={rgb:Fn})}},N=function(ot,ir,xr){if(!(Me>1)&&!(xr.sheetRows&&ot.r>=xr.sheetRows)){if(xr.cellStyles&&ir.XF&&ir.XF.data&&b(ot,ir,xr),delete ir.ixfe,delete ir.XF,h=ot,p=st(ot),(!a||!a.s||!a.e)&&(a={s:{r:0,c:0},e:{r:0,c:0}}),ot.r<a.s.r&&(a.s.r=ot.r),ot.c<a.s.c&&(a.s.c=ot.c),ot.r+1>a.e.r&&(a.e.r=ot.r+1),ot.c+1>a.e.c&&(a.e.c=ot.c+1),xr.cellFormula&&ir.f){for(var ur=0;ur<k.length;++ur)if(!(k[ur][0].s.c>ot.c||k[ur][0].s.r>ot.r)&&!(k[ur][0].e.c<ot.c||k[ur][0].e.r<ot.r)){ir.F=mt(k[ur][0]),(k[ur][0].s.c!=ot.c||k[ur][0].s.r!=ot.r)&&delete ir.f,ir.f&&(ir.f=""+Un(k[ur][1],a,ot,J,D));break}}xr.dense?(i[ot.r]||(i[ot.r]=[]),i[ot.r][ot.c]=ir):i[p]=ir}},D={enc:!1,sbcch:0,snames:[],sharedf:T,arrayf:k,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(D.password=e.password);var R,Ue=[],ge=[],Fe=[],Ee=[],xe=!1,J=[];J.SheetNames=D.snames,J.sharedf=D.sharedf,J.arrayf=D.arrayf,J.names=[],J.XTI=[];var ke=0,Me=0,j=0,H=[],q=[],X;D.codepage=1200,As(1200);for(var de=!1;t.l<t.length-1;){var we=t.l,Ne=t.read_shift(2);if(Ne===0&&ke===10)break;var Te=t.l===t.length?0:t.read_shift(2),_e=tx[Ne];if(_e&&_e.f){if(e.bookSheets&&ke===133&&Ne!==133)break;if(ke=Ne,_e.r===2||_e.r==12){var rt=t.read_shift(2);if(Te-=2,!D.enc&&rt!==Ne&&((rt&255)<<8|rt>>8)!==Ne)throw new Error("rt mismatch: "+rt+"!="+Ne);_e.r==12&&(t.l+=10,Te-=10)}var G={};if(Ne===10?G=_e.f(t,Te,D):G=oL(Ne,_e,t,Te,D),Me==0&&[9,521,1033,2057].indexOf(ke)===-1)continue;switch(Ne){case 34:r.opts.Date1904=w.WBProps.date1904=G;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(D.enc||(t.l=0),D.enc=G,!e.password)throw new Error("File is password-protected");if(G.valid==null)throw new Error("Encryption scheme unsupported");if(!G.valid)throw new Error("Password is incorrect");break;case 92:D.lastuser=G;break;case 66:var Vt=Number(G);switch(Vt){case 21010:Vt=1200;break;case 32768:Vt=1e4;break;case 32769:Vt=1252;break}As(D.codepage=Vt),de=!0;break;case 317:D.rrtabid=G;break;case 25:D.winlocked=G;break;case 439:r.opts.RefreshAll=G;break;case 12:r.opts.CalcCount=G;break;case 16:r.opts.CalcDelta=G;break;case 17:r.opts.CalcIter=G;break;case 13:r.opts.CalcMode=G;break;case 14:r.opts.CalcPrecision=G;break;case 95:r.opts.CalcSaveRecalc=G;break;case 15:D.CalcRefMode=G;break;case 2211:r.opts.FullCalc=G;break;case 129:G.fDialog&&(i["!type"]="dialog"),G.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),G.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:W.push(G);break;case 430:J.push([G]),J[J.length-1].XTI=[];break;case 35:case 547:J[J.length-1].push(G);break;case 24:case 536:X={Name:G.Name,Ref:Un(G.rgce,a,null,J,D)},G.itab>0&&(X.Sheet=G.itab-1),J.names.push(X),J[0]||(J[0]=[],J[0].XTI=[]),J[J.length-1].push(G),G.Name=="_xlnm._FilterDatabase"&&G.itab>0&&G.rgce&&G.rgce[0]&&G.rgce[0][0]&&G.rgce[0][0][0]=="PtgArea3d"&&(q[G.itab-1]={ref:mt(G.rgce[0][0][1][2])});break;case 22:D.ExternCount=G;break;case 23:J.length==0&&(J[0]=[],J[0].XTI=[]),J[J.length-1].XTI=J[J.length-1].XTI.concat(G),J.XTI=J.XTI.concat(G);break;case 2196:if(D.biff<8)break;X!=null&&(X.Comment=G[1]);break;case 18:i["!protect"]=G;break;case 19:G!==0&&D.WTF&&console.error("Password verifier: "+G);break;case 133:s[G.pos]=G,D.snames.push(G.name);break;case 10:{if(--Me)break;if(a.e){if(a.e.r>0&&a.e.c>0){if(a.e.r--,a.e.c--,i["!ref"]=mt(a),e.sheetRows&&e.sheetRows<=a.e.r){var gt=a.e.r;a.e.r=e.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=mt(a),a.e.r=gt}a.e.r++,a.e.c++}Ue.length>0&&(i["!merges"]=Ue),ge.length>0&&(i["!objects"]=ge),Fe.length>0&&(i["!cols"]=Fe),Ee.length>0&&(i["!rows"]=Ee),w.Sheets.push(C)}c===""?d=i:n[c]=i,i=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(D.biff===8&&(D.biff={9:2,521:3,1033:4}[Ne]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[G.BIFFVer]||8),D.biffguess=G.BIFFVer==0,G.BIFFVer==0&&G.dt==4096&&(D.biff=5,de=!0,As(D.codepage=28591)),D.biff==8&&G.BIFFVer==0&&G.dt==16&&(D.biff=2),Me++)break;if(i=e.dense?[]:{},D.biff<8&&!de&&(de=!0,As(D.codepage=e.codepage||1252)),D.biff<5||G.BIFFVer==0&&G.dt==4096){c===""&&(c="Sheet1"),a={s:{r:0,c:0},e:{r:0,c:0}};var Rt={pos:t.l-Te,name:c};s[Rt.pos]=Rt,D.snames.push(c)}else c=(s[we]||{name:""}).name;G.dt==32&&(i["!type"]="chart"),G.dt==64&&(i["!type"]="macro"),Ue=[],ge=[],D.arrayf=k=[],Fe=[],Ee=[],xe=!1,C={Hidden:(s[we]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(e.dense?(i[G.r]||[])[G.c]:i[st({c:G.c,r:G.r})])&&++G.c,_={ixfe:G.ixfe,XF:W[G.ixfe]||{},v:G.val,t:"n"},j>0&&(_.z=H[_.ixfe>>8&63]),Vs(_,e,r.opts.Date1904),N({c:G.c,r:G.r},_,e);break;case 5:case 517:_={ixfe:G.ixfe,XF:W[G.ixfe],v:G.val,t:G.t},j>0&&(_.z=H[_.ixfe>>8&63]),Vs(_,e,r.opts.Date1904),N({c:G.c,r:G.r},_,e);break;case 638:_={ixfe:G.ixfe,XF:W[G.ixfe],v:G.rknum,t:"n"},j>0&&(_.z=H[_.ixfe>>8&63]),Vs(_,e,r.opts.Date1904),N({c:G.c,r:G.r},_,e);break;case 189:for(var dt=G.c;dt<=G.C;++dt){var $e=G.rkrec[dt-G.c][0];_={ixfe:$e,XF:W[$e],v:G.rkrec[dt-G.c][1],t:"n"},j>0&&(_.z=H[_.ixfe>>8&63]),Vs(_,e,r.opts.Date1904),N({c:dt,r:G.r},_,e)}break;case 6:case 518:case 1030:{if(G.val=="String"){o=G;break}if(_=Ad(G.val,G.cell.ixfe,G.tt),_.XF=W[_.ixfe],e.cellFormula){var Zt=G.formula;if(Zt&&Zt[0]&&Zt[0][0]&&Zt[0][0][0]=="PtgExp"){var fn=Zt[0][0][1][0],$r=Zt[0][0][1][1],li=st({r:fn,c:$r});T[li]?_.f=""+Un(G.formula,a,G.cell,J,D):_.F=((e.dense?(i[fn]||[])[$r]:i[li])||{}).F}else _.f=""+Un(G.formula,a,G.cell,J,D)}j>0&&(_.z=H[_.ixfe>>8&63]),Vs(_,e,r.opts.Date1904),N(G.cell,_,e),o=G}break;case 7:case 519:if(o)o.val=G,_=Ad(G,o.cell.ixfe,"s"),_.XF=W[_.ixfe],e.cellFormula&&(_.f=""+Un(o.formula,a,o.cell,J,D)),j>0&&(_.z=H[_.ixfe>>8&63]),Vs(_,e,r.opts.Date1904),N(o.cell,_,e),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{k.push(G);var ji=st(G[0].s);if(m=e.dense?(i[G[0].s.r]||[])[G[0].s.c]:i[ji],e.cellFormula&&m){if(!o||!ji||!m)break;m.f=""+Un(G[1],a,G[0],J,D),m.F=mt(G[0])}}break;case 1212:{if(!e.cellFormula)break;if(p){if(!o)break;T[st(o.cell)]=G[0],m=e.dense?(i[o.cell.r]||[])[o.cell.c]:i[st(o.cell)],(m||{}).f=""+Un(G[0],a,h,J,D)}}break;case 253:_=Ad(l[G.isst].t,G.ixfe,"s"),l[G.isst].h&&(_.h=l[G.isst].h),_.XF=W[_.ixfe],j>0&&(_.z=H[_.ixfe>>8&63]),Vs(_,e,r.opts.Date1904),N({c:G.c,r:G.r},_,e);break;case 513:e.sheetStubs&&(_={ixfe:G.ixfe,XF:W[G.ixfe],t:"z"},j>0&&(_.z=H[_.ixfe>>8&63]),Vs(_,e,r.opts.Date1904),N({c:G.c,r:G.r},_,e));break;case 190:if(e.sheetStubs)for(var ci=G.c;ci<=G.C;++ci){var Ar=G.ixfe[ci-G.c];_={ixfe:Ar,XF:W[Ar],t:"z"},j>0&&(_.z=H[_.ixfe>>8&63]),Vs(_,e,r.opts.Date1904),N({c:ci,r:G.r},_,e)}break;case 214:case 516:case 4:_=Ad(G.val,G.ixfe,"s"),_.XF=W[_.ixfe],j>0&&(_.z=H[_.ixfe>>8&63]),Vs(_,e,r.opts.Date1904),N({c:G.c,r:G.r},_,e);break;case 0:case 512:Me===1&&(a=G);break;case 252:l=G;break;case 1054:if(D.biff==4){H[j++]=G[1];for(var ui=0;ui<j+163&&it[ui]!=G[1];++ui);ui>=163&&wa(G[1],j+163)}else wa(G[1],G[0]);break;case 30:{H[j++]=G;for(var Mt=0;Mt<j+163&&it[Mt]!=G;++Mt);Mt>=163&&wa(G,j+163)}break;case 229:Ue=Ue.concat(G);break;case 93:ge[G.cmo[0]]=D.lastobj=G;break;case 438:D.lastobj.TxO=G;break;case 127:D.lastobj.ImData=G;break;case 440:for(E=G[0].s.r;E<=G[0].e.r;++E)for(x=G[0].s.c;x<=G[0].e.c;++x)m=e.dense?(i[E]||[])[x]:i[st({c:x,r:E})],m&&(m.l=G[1]);break;case 2048:for(E=G[0].s.r;E<=G[0].e.r;++E)for(x=G[0].s.c;x<=G[0].e.c;++x)m=e.dense?(i[E]||[])[x]:i[st({c:x,r:E})],m&&m.l&&(m.l.Tooltip=G[1]);break;case 28:{if(D.biff<=5&&D.biff>=2)break;m=e.dense?(i[G[0].r]||[])[G[0].c]:i[st(G[0])];var mr=ge[G[2]];m||(e.dense?(i[G[0].r]||(i[G[0].r]=[]),m=i[G[0].r][G[0].c]={t:"z"}):m=i[st(G[0])]={t:"z"},a.e.r=Math.max(a.e.r,G[0].r),a.s.r=Math.min(a.s.r,G[0].r),a.e.c=Math.max(a.e.c,G[0].c),a.s.c=Math.min(a.s.c,G[0].c)),m.c||(m.c=[]),y={a:G[1],t:mr.TxO.t},m.c.push(y)}break;case 2173:qP(W[G.ixfe],G.ext);break;case 125:{if(!D.cellStyles)break;for(;G.e>=G.s;)Fe[G.e--]={width:G.w/256,level:G.level||0,hidden:!!(G.flags&1)},xe||(xe=!0,G1(G.w/256)),Ro(Fe[G.e+1])}break;case 520:{var nr={};G.level!=null&&(Ee[G.r]=nr,nr.level=G.level),G.hidden&&(Ee[G.r]=nr,nr.hidden=!0),G.hpt&&(Ee[G.r]=nr,nr.hpt=G.hpt,nr.hpx=qc(G.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||gl(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Ne]]=G;break;case 161:i["!margins"]||gl(i["!margins"]={}),i["!margins"].header=G.header,i["!margins"].footer=G.footer;break;case 574:G.RTL&&(w.Views[0].RTL=!0);break;case 146:B=G;break;case 2198:R=G;break;case 140:P=G;break;case 442:c?C.CodeName=G||C.name:w.WBProps.CodeName=G||"ThisWorkbook";break}}else _e||console.error("Missing Info for XLS Record 0x"+Ne.toString(16)),t.l+=Te}return r.SheetNames=Nr(s).sort(function(Qn,ot){return Number(Qn)-Number(ot)}).map(function(Qn){return s[Qn].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&q.forEach(function(Qn,ot){r.Sheets[r.SheetNames[ot]]["!autofilter"]=Qn}),r.Strings=l,r.SSF=cr(it),D.enc&&(r.Encryption=D.enc),R&&(r.Themes=R),r.Metadata={},P!==void 0&&(r.Metadata.Country=P),J.names.length>0&&(w.Names=J.names),r.Workbook=w,r}var pf={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function cL(t,e,r){var n=Ze.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=Z_(n,Xm,pf.DSI);for(var s in i)e[s]=i[s]}catch(c){if(r.WTF)throw c}var a=Ze.find(t,"/!SummaryInformation");if(a&&a.size>0)try{var o=Z_(a,qm,pf.SI);for(var l in o)e[l]==null&&(e[l]=o[l])}catch(c){if(r.WTF)throw c}e.HeadingPairs&&e.TitlesOfParts&&(tk(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function uL(t,e){var r=[],n=[],i=[],s=0,a,o=I_(Xm,"n"),l=I_(qm,"n");if(t.Props)for(a=Nr(t.Props),s=0;s<a.length;++s)(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(l,a[s])?n:i).push([a[s],t.Props[a[s]]]);if(t.Custprops)for(a=Nr(t.Custprops),s=0;s<a.length;++s)Object.prototype.hasOwnProperty.call(t.Props||{},a[s])||(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(l,a[s])?n:i).push([a[s],t.Custprops[a[s]]]);var c=[];for(s=0;s<i.length;++s)lk.indexOf(i[s][0])>-1||ek.indexOf(i[s][0])>-1||i[s][1]!=null&&c.push(i[s]);n.length&&Ze.utils.cfb_add(e,"/SummaryInformation",e2(n,pf.SI,l,qm)),(r.length||c.length)&&Ze.utils.cfb_add(e,"/DocumentSummaryInformation",e2(r,pf.DSI,o,Xm,c.length?c:null,pf.UDI))}function nA(t,e){e||(e={}),tv(e),w1(),e.codepage&&E1(e.codepage);var r,n;if(t.FullPaths){if(Ze.find(t,"/encryption"))throw new Error("File is password-protected");r=Ze.find(t,"!CompObj"),n=Ze.find(t,"/Workbook")||Ze.find(t,"/Book")}else{switch(e.type){case"base64":t=bi(Mi(t));break;case"binary":t=bi(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}En(t,0),n={content:t}}var i,s;if(r&&sL(r),e.bookProps&&!e.bookSheets)i={};else{var a=vt?"buffer":"array";if(n&&n.content)i=lL(n.content,e);else if((s=Ze.find(t,"PerfectOffice_MAIN"))&&s.content)i=pl.to_workbook(s.content,(e.type=a,e));else if((s=Ze.find(t,"NativeContent_MAIN"))&&s.content)i=pl.to_workbook(s.content,(e.type=a,e));else throw(s=Ze.find(t,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&Ze.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=T6(t))}var o={};return t.FullPaths&&cL(t,o,e),i.Props=i.Custprops=o,e.bookFiles&&(i.cfb=t),i}function fL(t,e){var r=e||{},n=Ze.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Ze.utils.cfb_add(n,i,iA(t,r)),r.biff==8&&(t.Props||t.Custprops)&&uL(t,n),r.biff==8&&t.vbaraw&&S6(n,Ze.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var Xf={0:{f:O5},1:{f:W5},2:{f:lO},3:{f:Q5},4:{f:K5},5:{f:sO},6:{f:hO},7:{f:tO},8:{f:_O},9:{f:yO},10:{f:xO},11:{f:vO},12:{f:H5},13:{f:uO},14:{f:Z5},15:{f:q5},16:{f:qk},17:{f:gO},18:{f:nO},19:{f:M1},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:gM},40:{},42:{},43:{f:hP},44:{f:fP},45:{f:mP},46:{f:vP},47:{f:xP},48:{},49:{f:BR},50:{},51:{f:JP},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:yk},62:{f:dO},63:{f:o6},64:{f:MO},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Xn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:NO},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:U5},148:{f:B5,p:16},151:{f:AO},152:{},153:{f:dM},154:{},155:{},156:{f:uM},157:{},158:{},159:{T:1,f:FD},160:{T:-1},161:{T:1,f:Vl},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:EO},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:YP},336:{T:-1},337:{f:t6,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Km},357:{},358:{},359:{},360:{T:1},361:{},362:{f:vk},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:CO},427:{f:FO},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:bO},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:V5},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:SO},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Km},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:v6},633:{T:1},634:{T:-1},635:{T:1,f:m6},636:{T:-1},637:{f:zR},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:ZO},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:LO},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},tx={6:{f:Cg},10:{f:Ja},12:{f:zr},13:{f:zr},14:{f:Dr},15:{f:Dr},16:{f:Hn},17:{f:Dr},18:{f:Dr},19:{f:zr},20:{f:a2},21:{f:a2},23:{f:vk},24:{f:l2},25:{f:Dr},26:{},27:{},28:{f:L3},29:{},34:{f:Dr},35:{f:o2},38:{f:Hn},39:{f:Hn},40:{f:Hn},41:{f:Hn},42:{f:Dr},43:{f:Dr},47:{f:qD},49:{f:u3},51:{f:zr},60:{},61:{f:s3},64:{f:Dr},65:{f:c3},66:{f:zr},77:{},80:{},81:{},82:{},85:{f:zr},89:{},90:{},91:{},92:{f:XN},93:{f:V3},94:{},95:{f:Dr},96:{},97:{},99:{f:Dr},125:{f:yk},128:{f:k3},129:{f:YN},130:{f:zr},131:{f:Dr},132:{f:Dr},133:{f:QN},134:{},140:{f:X3},141:{f:zr},144:{},146:{f:Q3},151:{},152:{},153:{},154:{},155:{},156:{f:zr},157:{},158:{},160:{f:iD},161:{f:eD},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:E3},190:{f:w3},193:{f:Ja},197:{},198:{},199:{},200:{},201:{},202:{f:Dr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:zr},220:{},221:{f:Dr},222:{},224:{f:S3},225:{f:KN},226:{f:Ja},227:{},229:{f:B3},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:ZN},253:{f:d3},255:{f:t3},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:ck},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Dr},353:{f:Ja},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:b3},431:{f:Dr},432:{},433:{},434:{},437:{},438:{f:W3},439:{f:Dr},440:{f:$3},441:{},442:{f:g0},443:{},444:{f:zr},445:{},446:{},448:{f:Ja},449:{f:i3,r:2},450:{f:Ja},512:{f:n2},513:{f:nD},515:{f:F3},516:{f:p3},517:{f:s2},519:{f:sD},520:{f:r3},523:{},545:{f:c2},549:{f:r2},566:{},574:{f:o3},638:{f:_3},659:{},1048:{},1054:{f:m3},1084:{},1212:{f:P3},2048:{f:G3},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Td},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Ja},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:J3,r:12},2173:{f:XP,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Dr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:D3,r:12},2197:{},2198:{f:zP,r:12},2199:{},2200:{},2201:{},2202:{f:O3,r:12},2203:{f:Ja},2204:{},2205:{},2206:{},2207:{},2211:{f:n3},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:zr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:tD},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:Y3},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:n2},1:{},2:{f:uD},3:{f:lD},4:{f:oD},5:{f:s2},7:{f:dD},8:{},9:{f:Td},11:{},22:{f:zr},30:{f:v3},31:{},32:{},33:{f:c2},36:{},37:{f:r2},50:{f:hD},62:{},52:{},67:{},68:{f:zr},69:{},86:{},126:{},127:{f:aD},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:pD},223:{},234:{},354:{},421:{},518:{f:Cg},521:{f:Td},536:{f:l2},547:{f:o2},561:{},579:{},1030:{f:Cg},1033:{f:Td},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function je(t,e,r,n){var i=e;if(!isNaN(i)){var s=n||(r||[]).length||0,a=t.next(4);a.write_shift(2,i),a.write_shift(2,s),s>0&&D1(r)&&t.push(r)}}function dL(t,e,r,n){var i=(r||[]).length||0;if(i<=8224)return je(t,e,r,i);var s=e;if(!isNaN(s)){for(var a=r.parts||[],o=0,l=0,c=0;c+(a[o]||8224)<=8224;)c+=a[o]||8224,o++;var d=t.next(4);for(d.write_shift(2,s),d.write_shift(2,c),t.push(r.slice(l,l+c)),l+=c;l<i;){for(d=t.next(4),d.write_shift(2,60),c=0;c+(a[o]||8224)<=8224;)c+=a[o]||8224,o++;d.write_shift(2,c),t.push(r.slice(l,l+c)),l+=c}}}function y0(t,e,r){return t||(t=pe(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function hL(t,e,r,n){var i=pe(9);return y0(i,t,e),uk(r,n||"b",i),i}function pL(t,e,r){var n=pe(8+2*r.length);return y0(n,t,e),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function gL(t,e,r,n){if(e.v!=null)switch(e.t){case"d":case"n":var i=e.t=="d"?Jr(lr(e.v)):e.v;i==(i|0)&&i>=0&&i<65536?je(t,2,fD(r,n,i)):je(t,3,cD(r,n,i));return;case"b":case"e":je(t,5,hL(r,n,e.v,e.t));return;case"s":case"str":je(t,4,pL(r,n,(e.v||"").slice(0,255)));return}je(t,1,y0(null,r,n))}function mL(t,e,r,n){var i=Array.isArray(e),s=Ot(e["!ref"]||"A1"),a,o="",l=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),a=mt(s)}for(var c=s.s.r;c<=s.e.r;++c){o=Mr(c);for(var d=s.s.c;d<=s.e.c;++d){c===s.s.r&&(l[d]=Er(d)),a=l[d]+o;var h=i?(e[c]||[])[d]:e[a];h&&gL(t,h,c,d)}}}function xL(t,e){for(var r=e||{},n=_i(),i=0,s=0;s<t.SheetNames.length;++s)t.SheetNames[s]==r.sheet&&(i=s);if(i==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return je(n,r.biff==4?1033:r.biff==3?521:9,W1(t,16,r)),mL(n,t.Sheets[t.SheetNames[i]],i,r),je(n,10),n.end()}function vL(t,e,r){je(t,49,f3({sz:12,name:"Arial"},r))}function yL(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&je(t,1054,x3(i,e[i],r))})}function _L(t,e){var r=pe(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),je(t,2151,r),r=pe(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),gk(Ot(e["!ref"]||"A1"),r),r.write_shift(4,4),je(t,2152,r)}function EL(t,e){for(var r=0;r<16;++r)je(t,224,i2({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){je(t,224,i2(n,0,e))})}function wL(t,e){for(var r=0;r<e["!links"].length;++r){var n=e["!links"][r];je(t,440,H3(n)),n[1].Tooltip&&je(t,2048,K3(n))}delete e["!links"]}function TL(t,e){if(e){var r=0;e.forEach(function(n,i){++r<=256&&n&&je(t,125,Z3(bp(i,n),i))})}}function SL(t,e,r,n,i){var s=16+zo(i.cellXfs,e,i);if(e.v==null&&!e.bf){je(t,513,Cl(r,n,s));return}if(e.bf)je(t,6,Y8(e,r,n,i,s));else switch(e.t){case"d":case"n":var a=e.t=="d"?Jr(lr(e.v)):e.v;je(t,515,I3(r,n,a,s));break;case"b":case"e":je(t,517,C3(r,n,e.v,s,i,e.t));break;case"s":case"str":if(i.bookSST){var o=Q1(i.Strings,e.v,i.revStrings);je(t,253,h3(r,n,o,s))}else je(t,516,g3(r,n,(e.v||"").slice(0,255),s,i));break;default:je(t,513,Cl(r,n,s))}}function kL(t,e,r){var n=_i(),i=r.SheetNames[t],s=r.Sheets[i]||{},a=(r||{}).Workbook||{},o=(a.Sheets||[])[t]||{},l=Array.isArray(s),c=e.biff==8,d,h="",p=[],m=Ot(s["!ref"]||"A1"),y=c?65536:16384;if(m.e.c>255||m.e.r>=y){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");m.e.c=Math.min(m.e.c,255),m.e.r=Math.min(m.e.c,y-1)}je(n,2057,W1(r,16,e)),je(n,13,es(1)),je(n,12,es(100)),je(n,15,ni(!0)),je(n,17,ni(!1)),je(n,16,kl(.001)),je(n,95,ni(!0)),je(n,42,ni(!1)),je(n,43,ni(!1)),je(n,130,es(1)),je(n,128,A3()),je(n,131,ni(!1)),je(n,132,ni(!1)),c&&TL(n,s["!cols"]),je(n,512,y3(m,e)),c&&(s["!links"]=[]);for(var x=m.s.r;x<=m.e.r;++x){h=Mr(x);for(var E=m.s.c;E<=m.e.c;++E){x===m.s.r&&(p[E]=Er(E)),d=p[E]+h;var T=l?(s[x]||[])[E]:s[d];T&&(SL(n,T,x,E,e),c&&T.l&&s["!links"].push([d,T.l]))}}var k=o.CodeName||o.name||i;return c&&je(n,574,l3((a.Views||[])[0])),c&&(s["!merges"]||[]).length&&je(n,229,j3(s["!merges"])),c&&wL(n,s),je(n,442,fk(k)),c&&_L(n,s),je(n,10),n.end()}function AL(t,e,r){var n=_i(),i=(t||{}).Workbook||{},s=i.Sheets||[],a=i.WBProps||{},o=r.biff==8,l=r.biff==5;if(je(n,2057,W1(t,5,r)),r.bookType=="xla"&&je(n,135),je(n,225,o?es(1200):null),je(n,193,CN(2)),l&&je(n,191),l&&je(n,192),je(n,226),je(n,92,qN("SheetJS",r)),je(n,66,es(o?1200:1252)),o&&je(n,353,es(0)),o&&je(n,448),je(n,317,rD(t.SheetNames.length)),o&&t.vbaraw&&je(n,211),o&&t.vbaraw){var c=a.CodeName||"ThisWorkbook";je(n,442,fk(c))}je(n,156,es(17)),je(n,25,ni(!1)),je(n,18,ni(!1)),je(n,19,es(0)),o&&je(n,431,ni(!1)),o&&je(n,444,es(0)),je(n,61,a3()),je(n,64,ni(!1)),je(n,141,es(0)),je(n,34,ni(iM(t)=="true")),je(n,14,ni(!0)),o&&je(n,439,ni(!1)),je(n,218,es(0)),vL(n,t,r),yL(n,t.SSF,r),EL(n,r),o&&je(n,352,ni(!1));var d=n.end(),h=_i();o&&je(h,140,q3()),o&&r.Strings&&dL(h,252,e3(r.Strings)),je(h,10);var p=h.end(),m=_i(),y=0,x=0;for(x=0;x<t.SheetNames.length;++x)y+=(o?12:11)+(o?2:1)*t.SheetNames[x].length;var E=d.length+y+p.length;for(x=0;x<t.SheetNames.length;++x){var T=s[x]||{};je(m,133,JN({pos:E,hs:T.Hidden||0,dt:0,name:t.SheetNames[x]},r)),E+=e[x].length}var k=m.end();if(y!=k.length)throw new Error("BS8 "+y+" != "+k.length);var _=[];return d.length&&_.push(d),k.length&&_.push(k),p.length&&_.push(p),ln(_)}function CL(t,e){var r=e||{},n=[];t&&!t.SSF&&(t.SSF=cr(it)),t&&t.SSF&&(cu(),Tp(t.SSF),r.revssf=kp(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,rv(r),r.cellXfs=[],zo(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var i=0;i<t.SheetNames.length;++i)n[n.length]=kL(i,r,t);return n.unshift(AL(t,n,r)),ln(n)}function iA(t,e){for(var r=0;r<=t.SheetNames.length;++r){var n=t.Sheets[t.SheetNames[r]];if(!(!n||!n["!ref"])){var i=Ei(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=e||{};switch(s.biff||2){case 8:case 5:return CL(t,e);case 4:case 3:case 2:return xL(t,e)}throw new Error("invalid type "+s.bookType+" for BIFF")}function y2(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var i=t.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var s=t.match(/<\/table/i),a=i.index,o=s&&s.index||t.length,l=fR(t.slice(a,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,d=0,h=0,p=0,m={s:{r:1e7,c:1e7},e:{r:0,c:0}},y=[];for(a=0;a<l.length;++a){var x=l[a].trim(),E=x.slice(0,3).toLowerCase();if(E=="<tr"){if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}d=0;continue}if(!(E!="<td"&&E!="<th")){var T=x.split(/<\/t[dh]>/i);for(o=0;o<T.length;++o){var k=T[o].trim();if(k.match(/<t[dh]/i)){for(var _=k,P=0;_.charAt(0)=="<"&&(P=_.indexOf(">"))>-1;)_=_.slice(P+1);for(var W=0;W<y.length;++W){var B=y[W];B.s.c==d&&B.s.r<c&&c<=B.e.r&&(d=B.e.c+1,W=-1)}var w=at(k.slice(0,k.indexOf(">")));p=w.colspan?+w.colspan:1,((h=+w.rowspan)>1||p>1)&&y.push({s:{r:c,c:d},e:{r:c+(h||1)-1,c:d+p-1}});var C=w.t||w["data-t"]||"";if(!_.length){d+=p;continue}if(_=FS(_),m.s.r>c&&(m.s.r=c),m.e.r<c&&(m.e.r=c),m.s.c>d&&(m.s.c=d),m.e.c<d&&(m.e.c=d),!_.length){d+=p;continue}var S={t:"s",v:_};r.raw||!_.trim().length||C=="s"||(_==="TRUE"?S={t:"b",v:!0}:_==="FALSE"?S={t:"b",v:!1}:isNaN(Rs(_))?isNaN(Kc(_).getDate())||(S={t:"d",v:lr(_)},r.cellDates||(S={t:"n",v:Jr(S.v)}),S.z=r.dateNF||it[14]):S={t:"n",v:Rs(_)}),r.dense?(n[c]||(n[c]=[]),n[c][d]=S):n[st({r:c,c:d})]=S,d+=p}}}}return n["!ref"]=mt(m),y.length&&(n["!merges"]=y),n}function FL(t,e,r,n){for(var i=t["!merges"]||[],s=[],a=e.s.c;a<=e.e.c;++a){for(var o=0,l=0,c=0;c<i.length;++c)if(!(i[c].s.r>r||i[c].s.c>a)&&!(i[c].e.r<r||i[c].e.c<a)){if(i[c].s.r<r||i[c].s.c<a){o=-1;break}o=i[c].e.r-i[c].s.r+1,l=i[c].e.c-i[c].s.c+1;break}if(!(o<0)){var d=st({r,c:a}),h=n.dense?(t[r]||[])[a]:t[d],p=h&&h.v!=null&&(h.h||b1(h.w||(Ia(h),h.w)||""))||"",m={};o>1&&(m.rowspan=o),l>1&&(m.colspan=l),n.editable?p='<span contenteditable="true">'+p+"</span>":h&&(m["data-t"]=h&&h.t||"z",h.v!=null&&(m["data-v"]=h.v),h.z!=null&&(m["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(p='<a href="'+h.l.Target+'">'+p+"</a>")),m.id=(n.id||"sjs")+"-"+d,s.push(Be("td",p,m))}}var y="<tr>";return y+s.join("")+"</tr>"}var IL='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',bL="</body></html>";function RL(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Uo(y2(r[0],e),e);var n=sv();return r.forEach(function(i,s){av(n,y2(i,e),"Sheet"+(s+1))}),n}function NL(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function sA(t,e){var r=e||{},n=r.header!=null?r.header:IL,i=r.footer!=null?r.footer:bL,s=[n],a=Ei(t["!ref"]);r.dense=Array.isArray(t),s.push(NL(t,a,r));for(var o=a.s.r;o<=a.e.r;++o)s.push(FL(t,a,o,r));return s.push("</table>"+i),s.join("")}function aA(t,e,r){var n=r||{},i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var a=typeof n.origin=="string"?wr(n.origin):n.origin;i=a.r,s=a.c}var o=e.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:i,c:s}};if(t["!ref"]){var d=Ei(t["!ref"]);c.s.r=Math.min(c.s.r,d.s.r),c.s.c=Math.min(c.s.c,d.s.c),c.e.r=Math.max(c.e.r,d.e.r),c.e.c=Math.max(c.e.c,d.e.c),i==-1&&(c.e.r=i=d.e.r+1)}var h=[],p=0,m=t["!rows"]||(t["!rows"]=[]),y=0,x=0,E=0,T=0,k=0,_=0;for(t["!cols"]||(t["!cols"]=[]);y<o.length&&x<l;++y){var P=o[y];if(_2(P)){if(n.display)continue;m[x]={hidden:!0}}var W=P.children;for(E=T=0;E<W.length;++E){var B=W[E];if(!(n.display&&_2(B))){var w=B.hasAttribute("data-v")?B.getAttribute("data-v"):B.hasAttribute("v")?B.getAttribute("v"):FS(B.innerHTML),C=B.getAttribute("data-z")||B.getAttribute("z");for(p=0;p<h.length;++p){var S=h[p];S.s.c==T+s&&S.s.r<x+i&&x+i<=S.e.r&&(T=S.e.c+1-s,p=-1)}_=+B.getAttribute("colspan")||1,((k=+B.getAttribute("rowspan")||1)>1||_>1)&&h.push({s:{r:x+i,c:T+s},e:{r:x+i+(k||1)-1,c:T+s+(_||1)-1}});var b={t:"s",v:w},N=B.getAttribute("data-t")||B.getAttribute("t")||"";w!=null&&(w.length==0?b.t=N||"z":n.raw||w.trim().length==0||N=="s"||(w==="TRUE"?b={t:"b",v:!0}:w==="FALSE"?b={t:"b",v:!1}:isNaN(Rs(w))?isNaN(Kc(w).getDate())||(b={t:"d",v:lr(w)},n.cellDates||(b={t:"n",v:Jr(b.v)}),b.z=n.dateNF||it[14]):b={t:"n",v:Rs(w)})),b.z===void 0&&C!=null&&(b.z=C);var D="",R=B.getElementsByTagName("A");if(R&&R.length)for(var Ue=0;Ue<R.length&&!(R[Ue].hasAttribute("href")&&(D=R[Ue].getAttribute("href"),D.charAt(0)!="#"));++Ue);D&&D.charAt(0)!="#"&&(b.l={Target:D}),n.dense?(t[x+i]||(t[x+i]=[]),t[x+i][T+s]=b):t[st({c:T+s,r:x+i})]=b,c.e.c<T+s&&(c.e.c=T+s),T+=_}}++x}return h.length&&(t["!merges"]=(t["!merges"]||[]).concat(h)),c.e.r=Math.max(c.e.r,x-1+i),t["!ref"]=mt(c),x>=l&&(t["!fullref"]=mt((c.e.r=o.length-y+x-1+i,c))),t}function oA(t,e){var r=e||{},n=r.dense?[]:{};return aA(n,t,e)}function DL(t,e){return Uo(oA(t,e),e)}function _2(t){var e="",r=PL(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function PL(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function OL(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Pt(e.replace(/<[^>]*>/g,""));return[r]}var E2={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function lA(t,e){var r=e||{},n=R1(t),i=[],s,a,o={name:""},l="",c=0,d,h,p={},m=[],y=r.dense?[]:{},x,E,T={value:""},k="",_=0,P=[],W=-1,B=-1,w={s:{r:1e6,c:1e7},e:{r:0,c:0}},C=0,S={},b=[],N={},D=0,R=0,Ue=[],ge=1,Fe=1,Ee=[],xe={Names:[]},J={},ke=["",""],Me=[],j={},H="",q=0,X=!1,de=!1,we=0;for(zf.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");x=zf.exec(n);)switch(x[3]=x[3].replace(/_.*$/,"")){case"table":case"":x[1]==="/"?(w.e.c>=w.s.c&&w.e.r>=w.s.r?y["!ref"]=mt(w):y["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=w.e.r&&(y["!fullref"]=y["!ref"],w.e.r=r.sheetRows-1,y["!ref"]=mt(w)),b.length&&(y["!merges"]=b),Ue.length&&(y["!rows"]=Ue),d.name=d.||d.name,typeof JSON<"u"&&JSON.stringify(d),m.push(d.name),p[d.name]=y,de=!1):x[0].charAt(x[0].length-2)!=="/"&&(d=at(x[0],!1),W=B=-1,w.s.r=w.s.c=1e7,w.e.r=w.e.c=0,y=r.dense?[]:{},b=[],Ue=[],de=!0);break;case"table-row-group":x[1]==="/"?--C:++C;break;case"table-row":case"":if(x[1]==="/"){W+=ge,ge=1;break}if(h=at(x[0],!1),h.?W=h.-1:W==-1&&(W=0),ge=+h["number-rows-repeated"]||1,ge<10)for(we=0;we<ge;++we)C>0&&(Ue[W+we]={level:C});B=-1;break;case"covered-table-cell":x[1]!=="/"&&++B,r.sheetStubs&&(r.dense?(y[W]||(y[W]=[]),y[W][B]={t:"z"}):y[st({r:W,c:B})]={t:"z"}),k="",P=[];break;case"table-cell":case"":if(x[0].charAt(x[0].length-2)==="/")++B,T=at(x[0],!1),Fe=parseInt(T["number-columns-repeated"]||"1",10),E={t:"z",v:null},T.formula&&r.cellFormula!=!1&&(E.f=m2(Pt(T.formula))),(T.||T["value-type"])=="string"&&(E.t="s",E.v=Pt(T["string-value"]||""),r.dense?(y[W]||(y[W]=[]),y[W][B]=E):y[st({r:W,c:B})]=E),B+=Fe-1;else if(x[1]!=="/"){++B,k="",_=0,P=[],Fe=1;var Ne=ge?W+ge-1:W;if(B>w.e.c&&(w.e.c=B),B<w.s.c&&(w.s.c=B),W<w.s.r&&(w.s.r=W),Ne>w.e.r&&(w.e.r=Ne),T=at(x[0],!1),Me=[],j={},E={t:T.||T["value-type"],v:null},r.cellFormula)if(T.formula&&(T.formula=Pt(T.formula)),T["number-matrix-columns-spanned"]&&T["number-matrix-rows-spanned"]&&(D=parseInt(T["number-matrix-rows-spanned"],10)||0,R=parseInt(T["number-matrix-columns-spanned"],10)||0,N={s:{r:W,c:B},e:{r:W+D-1,c:B+R-1}},E.F=mt(N),Ee.push([N,E.F])),T.formula)E.f=m2(T.formula);else for(we=0;we<Ee.length;++we)W>=Ee[we][0].s.r&&W<=Ee[we][0].e.r&&B>=Ee[we][0].s.c&&B<=Ee[we][0].e.c&&(E.F=Ee[we][1]);switch((T["number-columns-spanned"]||T["number-rows-spanned"])&&(D=parseInt(T["number-rows-spanned"],10)||0,R=parseInt(T["number-columns-spanned"],10)||0,N={s:{r:W,c:B},e:{r:W+D-1,c:B+R-1}},b.push(N)),T["number-columns-repeated"]&&(Fe=parseInt(T["number-columns-repeated"],10)),E.t){case"boolean":E.t="b",E.v=ar(T["boolean-value"]);break;case"float":E.t="n",E.v=parseFloat(T.value);break;case"percentage":E.t="n",E.v=parseFloat(T.value);break;case"currency":E.t="n",E.v=parseFloat(T.value);break;case"date":E.t="d",E.v=lr(T["date-value"]),r.cellDates||(E.t="n",E.v=Jr(E.v)),E.z="m/d/yy";break;case"time":E.t="n",E.v=lR(T["time-value"])/86400,r.cellDates&&(E.t="d",E.v=Ap(E.v)),E.z="HH:MM:SS";break;case"number":E.t="n",E.v=parseFloat(T.);break;default:if(E.t==="string"||E.t==="text"||!E.t)E.t="s",T["string-value"]!=null&&(k=Pt(T["string-value"]),P=[]);else throw new Error("Unsupported value type "+E.t)}}else{if(X=!1,E.t==="s"&&(E.v=k||"",P.length&&(E.R=P),X=_==0),J.Target&&(E.l=J),Me.length>0&&(E.c=Me,Me=[]),k&&r.cellText!==!1&&(E.w=k),X&&(E.t="z",delete E.v),(!X||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=W))for(var Te=0;Te<ge;++Te){if(Fe=parseInt(T["number-columns-repeated"]||"1",10),r.dense)for(y[W+Te]||(y[W+Te]=[]),y[W+Te][B]=Te==0?E:cr(E);--Fe>0;)y[W+Te][B+Fe]=cr(E);else for(y[st({r:W+Te,c:B})]=E;--Fe>0;)y[st({r:W+Te,c:B+Fe})]=cr(E);w.e.c<=B&&(w.e.c=B)}Fe=parseInt(T["number-columns-repeated"]||"1",10),B+=Fe-1,Fe=0,E={},k="",P=[]}J={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(x[1]==="/"){if((s=i.pop())[0]!==x[3])throw"Bad state: "+s}else x[0].charAt(x[0].length-2)!=="/"&&i.push([x[3],!0]);break;case"annotation":if(x[1]==="/"){if((s=i.pop())[0]!==x[3])throw"Bad state: "+s;j.t=k,P.length&&(j.R=P),j.a=H,Me.push(j)}else x[0].charAt(x[0].length-2)!=="/"&&i.push([x[3],!1]);H="",q=0,k="",_=0,P=[];break;case"creator":x[1]==="/"?H=n.slice(q,x.index):q=x.index+x[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(x[1]==="/"){if((s=i.pop())[0]!==x[3])throw"Bad state: "+s}else x[0].charAt(x[0].length-2)!=="/"&&i.push([x[3],!1]);k="",_=0,P=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(x[1]==="/"){if(S[o.name]=l,(s=i.pop())[0]!==x[3])throw"Bad state: "+s}else x[0].charAt(x[0].length-2)!=="/"&&(l="",o=at(x[0],!1),i.push([x[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":a=at(x[0],!1),l+=E2[x[3]][a.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":a=at(x[0],!1),l+=E2[x[3]][a.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(x[0].slice(-2)==="/>")break;if(x[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(c,x.index);break}else c=x.index+x[0].length;break;case"named-range":a=at(x[0],!1),ke=Fg(a["cell-range-address"]);var _e={Name:a.name,Ref:ke[0]+"!"+ke[1]};de&&(_e.Sheet=m.length),xe.Names.push(_e);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(x[1]==="/"&&(!T||!T["string-value"])){var rt=OL(n.slice(_,x.index));k=(k.length>0?k+`
`:"")+rt[0]}else at(x[0],!1),_=x.index+x[0].length;break;case"s":break;case"database-range":if(x[1]==="/")break;try{ke=Fg(at(x[0])["target-range-address"]),p[ke[0]]["!autofilter"]={ref:ke[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(x[1]!=="/"){if(J=at(x[0],!1),!J.href)break;J.Target=Pt(J.href),delete J.href,J.Target.charAt(0)=="#"&&J.Target.indexOf(".")>-1?(ke=Fg(J.Target.slice(1)),J.Target="#"+ke[0]+"!"+ke[1]):J.Target.match(/^\.\.[\\\/]/)&&(J.Target=J.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(x[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(x)}}var G={Sheets:p,SheetNames:m,Workbook:xe};return r.bookSheets&&delete G.Sheets,G}function w2(t,e){e=e||{},Zi(t,"META-INF/manifest.xml")&&lN(Ur(t,"META-INF/manifest.xml"),e);var r=Ri(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=lA(Jt(r),e);return Zi(t,"meta.xml")&&(n.Props=JS(Ur(t,"meta.xml"))),n}function T2(t,e){return lA(t,e)}var ML=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+Uf({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return Lr+e}}(),S2=function(){var t=function(s){return Xt(s).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,a,o){var l=[];l.push('      <table:table table:name="'+Xt(a.SheetNames[o])+`" table:style-name="ta1">
`);var c=0,d=0,h=Ei(s["!ref"]||"A1"),p=s["!merges"]||[],m=0,y=Array.isArray(s);if(s["!cols"])for(d=0;d<=h.e.c;++d)l.push("        <table:table-column"+(s["!cols"][d]?' table:style-name="co'+s["!cols"][d].ods+'"':"")+`></table:table-column>
`);var x="",E=s["!rows"]||[];for(c=0;c<h.s.r;++c)x=E[c]?' table:style-name="ro'+E[c].ods+'"':"",l.push("        <table:table-row"+x+`></table:table-row>
`);for(;c<=h.e.r;++c){for(x=E[c]?' table:style-name="ro'+E[c].ods+'"':"",l.push("        <table:table-row"+x+`>
`),d=0;d<h.s.c;++d)l.push(e);for(;d<=h.e.c;++d){var T=!1,k={},_="";for(m=0;m!=p.length;++m)if(!(p[m].s.c>d)&&!(p[m].s.r>c)&&!(p[m].e.c<d)&&!(p[m].e.r<c)){(p[m].s.c!=d||p[m].s.r!=c)&&(T=!0),k["table:number-columns-spanned"]=p[m].e.c-p[m].s.c+1,k["table:number-rows-spanned"]=p[m].e.r-p[m].s.r+1;break}if(T){l.push(r);continue}var P=st({r:c,c:d}),W=y?(s[c]||[])[d]:s[P];if(W&&W.f&&(k["table:formula"]=Xt(r5(W.f)),W.F&&W.F.slice(0,P.length)==P)){var B=Ei(W.F);k["table:number-matrix-columns-spanned"]=B.e.c-B.s.c+1,k["table:number-matrix-rows-spanned"]=B.e.r-B.s.r+1}if(!W){l.push(e);continue}switch(W.t){case"b":_=W.v?"TRUE":"FALSE",k["office:value-type"]="boolean",k["office:boolean-value"]=W.v?"true":"false";break;case"n":_=W.w||String(W.v||0),k["office:value-type"]="float",k["office:value"]=W.v||0;break;case"s":case"str":_=W.v==null?"":W.v,k["office:value-type"]="string";break;case"d":_=W.w||lr(W.v).toISOString(),k["office:value-type"]="date",k["office:date-value"]=lr(W.v).toISOString(),k["table:style-name"]="ce1";break;default:l.push(e);continue}var w=t(_);if(W.l&&W.l.Target){var C=W.l.Target;C=C.charAt(0)=="#"?"#"+n5(C.slice(1)):C,C.charAt(0)!="#"&&!C.match(/^\w+:/)&&(C="../"+C),w=Be("text:a",w,{"xlink:href":C.replace(/&/g,"&amp;")})}l.push("          "+Be("table:table-cell",Be("text:p",w,{}),k)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},i=function(s,a){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;a.SheetNames.map(function(c){return a.Sheets[c]}).forEach(function(c){if(c&&c["!cols"]){for(var d=0;d<c["!cols"].length;++d)if(c["!cols"][d]){var h=c["!cols"][d];if(h.width==null&&h.wpx==null&&h.wch==null)continue;Ro(h),h.ods=o;var p=c["!cols"][d].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+p+`"/>
`),s.push(`  </style:style>
`),++o}}});var l=0;a.SheetNames.map(function(c){return a.Sheets[c]}).forEach(function(c){if(c&&c["!rows"]){for(var d=0;d<c["!rows"].length;++d)if(c["!rows"][d]){c["!rows"][d].ods=l;var h=c["!rows"][d].hpx+"px";s.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h+`"/>
`),s.push(`  </style:style>
`),++l}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(a,o){var l=[Lr],c=Uf({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=Uf({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+c+d+`>
`),l.push(QS().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+c+`>
`),i(l,a),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var h=0;h!=a.SheetNames.length;++h)l.push(n(a.Sheets[a.SheetNames[h]],a,h));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function cA(t,e){if(e.bookType=="fods")return S2(t,e);var r=C1(),n="",i=[],s=[];return n="mimetype",xt(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",xt(r,n,S2(t,e)),i.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",xt(r,n,ML(t,e)),i.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",xt(r,n,Lr+QS()),i.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",xt(r,n,fN(s)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",xt(r,n,cN(i)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Fl(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function rx(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):Jt(Vo(t))}function LL(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):bi(Ks(t))}function BL(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var n=0;n<e.length;++n)if(t[r+n]!=e[n])continue e;return!0}return!1}function Do(t){var e=t.reduce(function(i,s){return i+s.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(i){r.set(i,n),n+=i.length}),r}function k2(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function jL(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,i=e+13;i>=e;--i)n=n*256+t[i];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function VL(t,e,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,n-6176);t[e+15]|=n>>7,t[e+14]|=(n&127)<<1;for(var s=0;i>=1;++s,i/=256)t[e+s]=i&255;t[e+15]|=r>=0?0:128}function qf(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function Gt(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function Rr(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function Bt(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],i=qf(t,r),s=i&7;i=Math.floor(i/8);var a=0,o;if(i==0)break;switch(s){case 0:{for(var l=r[0];t[r[0]++]>=128;);o=t.slice(l,r[0])}break;case 5:a=4,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 1:a=8,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 2:a=qf(t,r),o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var c={data:o,type:s};e[i]==null?e[i]=[c]:e[i].push(c)}return e}function vn(t){var e=[];return t.forEach(function(r,n){r.forEach(function(i){i.data&&(e.push(Gt(n*8+i.type)),i.type==2&&e.push(Gt(i.data.length)),e.push(i.data))})}),Do(e)}function ev(t,e){return(t==null?void 0:t.map(function(r){return e(r.data)}))||[]}function Qi(t){for(var e,r=[],n=[0];n[0]<t.length;){var i=qf(t,n),s=Bt(t.slice(n[0],n[0]+i));n[0]+=i;var a={id:Rr(s[1][0].data),messages:[]};s[2].forEach(function(o){var l=Bt(o.data),c=Rr(l[3][0].data);a.messages.push({meta:l,data:t.slice(n[0],n[0]+c)}),n[0]+=c}),(e=s[3])!=null&&e[0]&&(a.merge=Rr(s[3][0].data)>>>0>0),r.push(a)}return r}function sc(t){var e=[];return t.forEach(function(r){var n=[];n[1]=[{data:Gt(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Gt(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(a){i.push(a.data),a.meta[3]=[{type:0,data:Gt(a.data.length)}],n[2].push({data:vn(a.meta),type:2})});var s=vn(n);e.push(Gt(s.length)),e.push(s),i.forEach(function(a){return e.push(a)})}),Do(e)}function UL(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=qf(e,r),i=[];r[0]<e.length;){var s=e[r[0]]&3;if(s==0){var a=e[r[0]++]>>2;if(a<60)++a;else{var o=a-59;a=e[r[0]],o>1&&(a|=e[r[0]+1]<<8),o>2&&(a|=e[r[0]+2]<<16),o>3&&(a|=e[r[0]+3]<<24),a>>>=0,a++,r[0]+=o}i.push(e.slice(r[0],r[0]+a)),r[0]+=a;continue}else{var l=0,c=0;if(s==1?(c=(e[r[0]]>>2&7)+4,l=(e[r[0]++]&224)<<3,l|=e[r[0]++]):(c=(e[r[0]++]>>2)+1,s==2?(l=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(l=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),i=[Do(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(i.push(i[0].slice(-l)),c-=l;c>=i[i.length-1].length;)i.push(i[i.length-1]),c-=i[i.length-1].length;i.push(i[0].slice(-l,-l+c))}}var d=Do(i);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function Ji(t){for(var e=[],r=0;r<t.length;){var n=t[r++],i=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(UL(n,t.slice(r,r+i))),r+=i}if(r!==t.length)throw new Error("data is not a valid framed stream!");return Do(e)}function ac(t){for(var e=[],r=0;r<t.length;){var n=Math.min(t.length-r,268435455),i=new Uint8Array(4);e.push(i);var s=Gt(n),a=s.length;e.push(s),n<=60?(a++,e.push(new Uint8Array([n-1<<2]))):n<=256?(a+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(a+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(a+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(a+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(t.slice(r,r+n)),a+=n,i[0]=0,i[1]=a&255,i[2]=a>>8&255,i[3]=a>>16&255,r+=n}return Do(e)}function zL(t,e,r,n){var i=Fl(t),s=i.getUint32(4,!0),a=(n>1?12:8)+k2(s&(n>1?3470:398))*4,o=-1,l=-1,c=NaN,d=new Date(2001,0,1);s&512&&(o=i.getUint32(a,!0),a+=4),a+=k2(s&(n>1?12288:4096))*4,s&16&&(l=i.getUint32(a,!0),a+=4),s&32&&(c=i.getFloat64(a,!0),a+=8),s&64&&(d.setTime(d.getTime()+i.getFloat64(a,!0)*1e3),a+=8);var h;switch(t[2]){case 0:break;case 2:h={t:"n",v:c};break;case 3:h={t:"s",v:e[l]};break;case 5:h={t:"d",v:d};break;case 6:h={t:"b",v:c>0};break;case 7:h={t:"n",v:c/86400};break;case 8:h={t:"e",v:0};break;case 9:if(o>-1)h={t:"s",v:r[o]};else if(l>-1)h={t:"s",v:e[l]};else if(!isNaN(c))h={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return h}function WL(t,e,r){var n=Fl(t),i=n.getUint32(8,!0),s=12,a=-1,o=-1,l=NaN,c=NaN,d=new Date(2001,0,1);i&1&&(l=jL(t,s),s+=16),i&2&&(c=n.getFloat64(s,!0),s+=8),i&4&&(d.setTime(d.getTime()+n.getFloat64(s,!0)*1e3),s+=8),i&8&&(o=n.getUint32(s,!0),s+=4),i&16&&(a=n.getUint32(s,!0),s+=4);var h;switch(t[1]){case 0:break;case 2:h={t:"n",v:l};break;case 3:h={t:"s",v:e[o]};break;case 5:h={t:"d",v:d};break;case 6:h={t:"b",v:c>0};break;case 7:h={t:"n",v:c/86400};break;case 8:h={t:"e",v:0};break;case 9:if(a>-1)h={t:"s",v:r[a]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)));break;case 10:h={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)))}return h}function bg(t,e){var r=new Uint8Array(32),n=Fl(r),i=12,s=0;switch(r[0]=5,t.t){case"n":r[1]=2,VL(r,i,t.v),s|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,t.v?1:0,!0),s|=2,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,n.setUint32(i,e.indexOf(t.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,s,!0),r.slice(0,i)}function Rg(t,e){var r=new Uint8Array(32),n=Fl(r),i=12,s=0;switch(r[0]=3,t.t){case"n":r[2]=2,n.setFloat64(i,t.v,!0),s|=32,i+=8;break;case"b":r[2]=6,n.setFloat64(i,t.v?1:0,!0),s|=32,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,n.setUint32(i,e.indexOf(t.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,s,!0),r.slice(0,i)}function $L(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return zL(t,e,r,t[0]);case 5:return WL(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function jn(t){var e=Bt(t);return qf(e[1][0].data)}function A2(t,e){var r=Bt(e.data),n=Rr(r[1][0].data),i=r[3],s=[];return(i||[]).forEach(function(a){var o=Bt(a.data),l=Rr(o[1][0].data)>>>0;switch(n){case 1:s[l]=rx(o[3][0].data);break;case 8:{var c=t[jn(o[9][0].data)][0],d=Bt(c.data),h=t[jn(d[1][0].data)][0],p=Rr(h.meta[1][0].data);if(p!=2001)throw new Error("2000 unexpected reference to ".concat(p));var m=Bt(h.data);s[l]=m[3].map(function(y){return rx(y.data)}).join("")}break}}),s}function HL(t,e){var r,n,i,s,a,o,l,c,d,h,p,m,y,x,E=Bt(t),T=Rr(E[1][0].data)>>>0,k=Rr(E[2][0].data)>>>0,_=((n=(r=E[8])==null?void 0:r[0])==null?void 0:n.data)&&Rr(E[8][0].data)>0||!1,P,W;if((s=(i=E[7])==null?void 0:i[0])!=null&&s.data&&e!=0)P=(o=(a=E[7])==null?void 0:a[0])==null?void 0:o.data,W=(c=(l=E[6])==null?void 0:l[0])==null?void 0:c.data;else if((h=(d=E[4])==null?void 0:d[0])!=null&&h.data&&e!=1)P=(m=(p=E[4])==null?void 0:p[0])==null?void 0:m.data,W=(x=(y=E[3])==null?void 0:y[0])==null?void 0:x.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var B=_?4:1,w=Fl(P),C=[],S=0;S<P.length/2;++S){var b=w.getUint16(S*2,!0);b<65535&&C.push([S,b])}if(C.length!=k)throw"Expected ".concat(k," cells, found ").concat(C.length);var N=[];for(S=0;S<C.length-1;++S)N[C[S][0]]=W.subarray(C[S][1]*B,C[S+1][1]*B);return C.length>=1&&(N[C[C.length-1][0]]=W.subarray(C[C.length-1][1]*B)),{R:T,cells:N}}function GL(t,e){var r,n=Bt(e.data),i=(r=n==null?void 0:n[7])!=null&&r[0]?Rr(n[7][0].data)>>>0>0?1:0:-1,s=ev(n[5],function(a){return HL(a,i)});return{nrows:Rr(n[4][0].data)>>>0,data:s.reduce(function(a,o){return a[o.R]||(a[o.R]=[]),o.cells.forEach(function(l,c){if(a[o.R][c])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(c));a[o.R][c]=l}),a},[])}}function KL(t,e,r){var n,i=Bt(e.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Rr(i[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(s.e.c=(Rr(i[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=mt(s);var a=Bt(i[4][0].data),o=A2(t,t[jn(a[4][0].data)][0]),l=(n=a[17])!=null&&n[0]?A2(t,t[jn(a[17][0].data)][0]):[],c=Bt(a[3][0].data),d=0;c[1].forEach(function(h){var p=Bt(h.data),m=t[jn(p[2][0].data)][0],y=Rr(m.meta[1][0].data);if(y!=6002)throw new Error("6001 unexpected reference to ".concat(y));var x=GL(t,m);x.data.forEach(function(E,T){E.forEach(function(k,_){var P=st({r:d+T,c:_}),W=$L(k,o,l);W&&(r[P]=W)})}),d+=x.nrows})}function XL(t,e){var r=Bt(e.data),n={"!ref":"A1"},i=t[jn(r[2][0].data)],s=Rr(i[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return KL(t,i[0],n),n}function qL(t,e){var r,n=Bt(e.data),i={name:(r=n[1])!=null&&r[0]?rx(n[1][0].data):"",sheets:[]},s=ev(n[2],jn);return s.forEach(function(a){t[a].forEach(function(o){var l=Rr(o.meta[1][0].data);l==6e3&&i.sheets.push(XL(t,o))})}),i}function YL(t,e){var r=sv(),n=Bt(e.data),i=ev(n[1],jn);if(i.forEach(function(s){t[s].forEach(function(a){var o=Rr(a.meta[1][0].data);if(o==2){var l=qL(t,a);l.sheets.forEach(function(c,d){av(r,c,d==0?l.name:l.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Ng(t){var e,r,n,i,s={},a=[];if(t.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var c;try{c=Ji(l.content)}catch(h){return console.log("?? "+l.content.length+" "+(h.message||h))}var d;try{d=Qi(c)}catch(h){return console.log("## "+(h.message||h))}d.forEach(function(h){s[h.id]=h.messages,a.push(h.id)})}}),!a.length)throw new Error("File has no messages");var o=((i=(n=(r=(e=s==null?void 0:s[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&Rr(s[1][0].meta[1][0].data)==1&&s[1][0];if(o||a.forEach(function(l){s[l].forEach(function(c){var d=Rr(c.meta[1][0].data)>>>0;if(d==1)if(!o)o=c;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return YL(s,o)}function QL(t,e,r){var n,i,s,a;if(!((n=t[6])!=null&&n[0])||!((i=t[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var o=((a=(s=t[8])==null?void 0:s[0])==null?void 0:a.data)&&Rr(t[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,c=Fl(t[7][0].data),d=0,h=[],p=Fl(t[4][0].data),m=0,y=[],x=0;x<e.length;++x){if(e[x]==null){c.setUint16(x*2,65535,!0),p.setUint16(x*2,65535);continue}c.setUint16(x*2,d,!0),p.setUint16(x*2,m,!0);var E,T;switch(typeof e[x]){case"string":E=bg({t:"s",v:e[x]},r),T=Rg({t:"s",v:e[x]},r);break;case"number":E=bg({t:"n",v:e[x]},r),T=Rg({t:"n",v:e[x]},r);break;case"boolean":E=bg({t:"b",v:e[x]},r),T=Rg({t:"b",v:e[x]},r);break;default:throw new Error("Unsupported value "+e[x])}h.push(E),d+=E.length,y.push(T),m+=T.length,++l}for(t[2][0].data=Gt(l);x<t[7][0].data.length/2;++x)c.setUint16(x*2,65535,!0),p.setUint16(x*2,65535,!0);return t[6][0].data=Do(h),t[3][0].data=Do(y),l}function JL(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Ei(r["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(mt(n)));var s=zh(r,{range:n,header:1}),a=["~Sh33tJ5~"];s.forEach(function(H){return H.forEach(function(q){typeof q=="string"&&a.push(q)})});var o={},l=[],c=Ze.read(e.numbers,{type:"base64"});c.FileIndex.map(function(H,q){return[H,c.FullPaths[q]]}).forEach(function(H){var q=H[0],X=H[1];if(q.type==2&&q.name.match(/\.iwa/)){var de=q.content,we=Ji(de),Ne=Qi(we);Ne.forEach(function(Te){l.push(Te.id),o[Te.id]={deps:[],location:X,type:Rr(Te.messages[0].meta[1][0].data)}})}}),l.sort(function(H,q){return H-q});var d=l.filter(function(H){return H>1}).map(function(H){return[H,Gt(H)]});c.FileIndex.map(function(H,q){return[H,c.FullPaths[q]]}).forEach(function(H){var q=H[0];if(H[1],!!q.name.match(/\.iwa/)){var X=Qi(Ji(q.content));X.forEach(function(de){de.messages.forEach(function(we){d.forEach(function(Ne){de.messages.some(function(Te){return Rr(Te.meta[1][0].data)!=11006&&BL(Te.data,Ne[1])})&&o[Ne[0]].deps.push(de.id)})})})}});for(var h=Ze.find(c,o[1].location),p=Qi(Ji(h.content)),m,y=0;y<p.length;++y){var x=p[y];x.id==1&&(m=x)}var E=jn(Bt(m.messages[0].data)[1][0].data);for(h=Ze.find(c,o[E].location),p=Qi(Ji(h.content)),y=0;y<p.length;++y)x=p[y],x.id==E&&(m=x);for(E=jn(Bt(m.messages[0].data)[2][0].data),h=Ze.find(c,o[E].location),p=Qi(Ji(h.content)),y=0;y<p.length;++y)x=p[y],x.id==E&&(m=x);for(E=jn(Bt(m.messages[0].data)[2][0].data),h=Ze.find(c,o[E].location),p=Qi(Ji(h.content)),y=0;y<p.length;++y)x=p[y],x.id==E&&(m=x);var T=Bt(m.messages[0].data);{T[6][0].data=Gt(n.e.r+1),T[7][0].data=Gt(n.e.c+1);var k=jn(T[46][0].data),_=Ze.find(c,o[k].location),P=Qi(Ji(_.content));{for(var W=0;W<P.length&&P[W].id!=k;++W);if(P[W].id!=k)throw"Bad ColumnRowUIDMapArchive";var B=Bt(P[W].messages[0].data);B[1]=[],B[2]=[],B[3]=[];for(var w=0;w<=n.e.c;++w){var C=[];C[1]=C[2]=[{type:0,data:Gt(w+420690)}],B[1].push({type:2,data:vn(C)}),B[2].push({type:0,data:Gt(w)}),B[3].push({type:0,data:Gt(w)})}B[4]=[],B[5]=[],B[6]=[];for(var S=0;S<=n.e.r;++S)C=[],C[1]=C[2]=[{type:0,data:Gt(S+726270)}],B[4].push({type:2,data:vn(C)}),B[5].push({type:0,data:Gt(S)}),B[6].push({type:0,data:Gt(S)});P[W].messages[0].data=vn(B)}_.content=ac(sc(P)),_.size=_.content.length,delete T[46];var b=Bt(T[4][0].data);{b[7][0].data=Gt(n.e.r+1);var N=Bt(b[1][0].data),D=jn(N[2][0].data);_=Ze.find(c,o[D].location),P=Qi(Ji(_.content));{if(P[0].id!=D)throw"Bad HeaderStorageBucket";var R=Bt(P[0].messages[0].data);for(S=0;S<s.length;++S){var Ue=Bt(R[2][0].data);Ue[1][0].data=Gt(S),Ue[4][0].data=Gt(s[S].length),R[2][S]={type:R[2][0].type,data:vn(Ue)}}P[0].messages[0].data=vn(R)}_.content=ac(sc(P)),_.size=_.content.length;var ge=jn(b[2][0].data);_=Ze.find(c,o[ge].location),P=Qi(Ji(_.content));{if(P[0].id!=ge)throw"Bad HeaderStorageBucket";for(R=Bt(P[0].messages[0].data),w=0;w<=n.e.c;++w)Ue=Bt(R[2][0].data),Ue[1][0].data=Gt(w),Ue[4][0].data=Gt(n.e.r+1),R[2][w]={type:R[2][0].type,data:vn(Ue)};P[0].messages[0].data=vn(R)}_.content=ac(sc(P)),_.size=_.content.length;var Fe=jn(b[4][0].data);(function(){for(var H=Ze.find(c,o[Fe].location),q=Qi(Ji(H.content)),X,de=0;de<q.length;++de){var we=q[de];we.id==Fe&&(X=we)}var Ne=Bt(X.messages[0].data);{Ne[3]=[];var Te=[];a.forEach(function(G,Vt){Te[1]=[{type:0,data:Gt(Vt)}],Te[2]=[{type:0,data:Gt(1)}],Te[3]=[{type:2,data:LL(G)}],Ne[3].push({type:2,data:vn(Te)})})}X.messages[0].data=vn(Ne);var _e=sc(q),rt=ac(_e);H.content=rt,H.size=H.content.length})();var Ee=Bt(b[3][0].data);{var xe=Ee[1][0];delete Ee[2];var J=Bt(xe.data);{var ke=jn(J[2][0].data);(function(){for(var H=Ze.find(c,o[ke].location),q=Qi(Ji(H.content)),X,de=0;de<q.length;++de){var we=q[de];we.id==ke&&(X=we)}var Ne=Bt(X.messages[0].data);{delete Ne[6],delete Ee[7];var Te=new Uint8Array(Ne[5][0].data);Ne[5]=[];for(var _e=0,rt=0;rt<=n.e.r;++rt){var G=Bt(Te);_e+=QL(G,s[rt],a),G[1][0].data=Gt(rt),Ne[5].push({data:vn(G),type:2})}Ne[1]=[{type:0,data:Gt(n.e.c+1)}],Ne[2]=[{type:0,data:Gt(n.e.r+1)}],Ne[3]=[{type:0,data:Gt(_e)}],Ne[4]=[{type:0,data:Gt(n.e.r+1)}]}X.messages[0].data=vn(Ne);var Vt=sc(q),gt=ac(Vt);H.content=gt,H.size=H.content.length})()}xe.data=vn(J)}b[3][0].data=vn(Ee)}T[4][0].data=vn(b)}m.messages[0].data=vn(T);var Me=sc(p),j=ac(Me);return h.content=j,h.size=h.content.length,c}function uA(t){return function(r){for(var n=0;n!=t.length;++n){var i=t[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function tv(t){uA([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function rv(t){uA([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function ZL(t){return yt.WS.indexOf(t)>-1?"sheet":t==yt.CS?"chart":t==yt.DS?"dialog":t==yt.MS?"macro":t&&t.length?t:"sheet"}function eB(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,ZL(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function tB(t,e,r,n,i,s,a,o,l,c,d,h){try{s[n]=uf(Ri(t,r,!0),e);var p=Ur(t,e),m;switch(o){case"sheet":m=TM(p,e,i,l,s[n],c,d,h);break;case"chart":if(m=SM(p,e,i,l,s[n],c,d,h),!m||!m["!drawel"])break;var y=Gu(m["!drawel"].Target,e),x=Wf(y),E=u6(Ri(t,y,!0),uf(Ri(t,x,!0),y)),T=Gu(E,y),k=Wf(T);m=QO(Ri(t,T,!0),T,l,uf(Ri(t,k,!0),T),c,m);break;case"macro":m=kM(p,e,i,l,s[n],c,d,h);break;case"dialog":m=AM(p,e,i,l,s[n],c,d,h);break;default:throw new Error("Unrecognized sheet type "+o)}a[n]=m;var _=[];s&&s[n]&&Nr(s[n]).forEach(function(P){var W="";if(s[n][P].Type==yt.CMNT){W=Gu(s[n][P].Target,e);var B=bM(Ur(t,W,!0),W,l);if(!B||!B.length)return;f2(m,B,!1)}s[n][P].Type==yt.TCMNT&&(W=Gu(s[n][P].Target,e),_=_.concat(d6(Ur(t,W,!0),l)))}),_&&_.length&&f2(m,_,!0,l.people||[])}catch(P){if(l.WTF)throw P}}function qi(t){return t.charAt(0)=="/"?t.slice(1):t}function rB(t,e){if(cu(),e=e||{},tv(e),Zi(t,"META-INF/manifest.xml")||Zi(t,"objectdata.xml"))return w2(t,e);if(Zi(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Ng<"u"){if(t.FileIndex)return Ng(t);var r=Ze.utils.cfb_new();return N_(t).forEach(function(Ue){xt(r,Ue,hR(t,Ue))}),Ng(r)}throw new Error("Unsupported NUMBERS file")}if(!Zi(t,"[Content_Types].xml"))throw Zi(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Zi(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=N_(t),i=aN(Ri(t,"[Content_Types].xml")),s=!1,a,o;if(i.workbooks.length===0&&(o="xl/workbook.xml",Ur(t,o,!0)&&i.workbooks.push(o)),i.workbooks.length===0){if(o="xl/workbook.bin",!Ur(t,o,!0))throw new Error("Could not find workbook");i.workbooks.push(o),s=!0}i.workbooks[0].slice(-3)=="bin"&&(s=!0);var l={},c={};if(!e.bookSheets&&!e.bookProps){if(ff=[],i.sst)try{ff=IM(Ur(t,qi(i.sst)),i.sst,e)}catch(Ue){if(e.WTF)throw Ue}e.cellStyles&&i.themes.length&&(l=FM(Ri(t,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],e)),i.style&&(c=CM(Ur(t,qi(i.style)),i.style,l,e))}i.links.map(function(Ue){try{var ge=uf(Ri(t,Wf(qi(Ue))),Ue);return NM(Ur(t,qi(Ue)),ge,Ue,e)}catch{}});var d=wM(Ur(t,qi(i.workbooks[0])),i.workbooks[0],e),h={},p="";i.coreprops.length&&(p=Ur(t,qi(i.coreprops[0]),!0),p&&(h=JS(p)),i.extprops.length!==0&&(p=Ur(t,qi(i.extprops[0]),!0),p&&hN(p,h,e)));var m={};(!e.bookSheets||e.bookProps)&&i.custprops.length!==0&&(p=Ri(t,qi(i.custprops[0]),!0),p&&(m=gN(p,e)));var y={};if((e.bookSheets||e.bookProps)&&(d.Sheets?a=d.Sheets.map(function(ge){return ge.name}):h.Worksheets&&h.SheetNames.length>0&&(a=h.SheetNames),e.bookProps&&(y.Props=h,y.Custprops=m),e.bookSheets&&typeof a<"u"&&(y.SheetNames=a),e.bookSheets?y.SheetNames:e.bookProps))return y;a={};var x={};e.bookDeps&&i.calcchain&&(x=RM(Ur(t,qi(i.calcchain)),i.calcchain));var E=0,T={},k,_;{var P=d.Sheets;h.Worksheets=P.length,h.SheetNames=[];for(var W=0;W!=P.length;++W)h.SheetNames[W]=P[W].name}var B=s?"bin":"xml",w=i.workbooks[0].lastIndexOf("/"),C=(i.workbooks[0].slice(0,w+1)+"_rels/"+i.workbooks[0].slice(w+1)+".rels").replace(/^\//,"");Zi(t,C)||(C="xl/_rels/workbook."+B+".rels");var S=uf(Ri(t,C,!0),C.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(e.xlmeta=DM(Ur(t,qi(i.metadata[0])),i.metadata[0],e)),(i.people||[]).length>=1&&(e.people=p6(Ur(t,qi(i.people[0])),e)),S&&(S=eB(S,d.Sheets));var b=Ur(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(E=0;E!=h.Worksheets;++E){var N="sheet";if(S&&S[E]?(k="xl/"+S[E][1].replace(/[\/]?xl\//,""),Zi(t,k)||(k=S[E][1]),Zi(t,k)||(k=C.replace(/_rels\/.*$/,"")+S[E][1]),N=S[E][2]):(k="xl/worksheets/sheet"+(E+1-b)+"."+B,k=k.replace(/sheet0\./,"sheet.")),_=k.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(E!=e.sheets)continue e;break;case"string":if(h.SheetNames[E].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var D=!1,R=0;R!=e.sheets.length;++R)typeof e.sheets[R]=="number"&&e.sheets[R]==E&&(D=1),typeof e.sheets[R]=="string"&&e.sheets[R].toLowerCase()==h.SheetNames[E].toLowerCase()&&(D=1);if(!D)continue e}}tB(t,k,_,h.SheetNames[E],E,T,a,N,e,d,l,c)}return y={Directory:i,Workbook:d,Props:h,Custprops:m,Deps:x,Sheets:a,SheetNames:h.SheetNames,Strings:ff,Styles:c,Themes:l,SSF:cr(it)},e&&e.bookFiles&&(t.files?(y.keys=n,y.files=t.files):(y.keys=[],y.files={},t.FullPaths.forEach(function(Ue,ge){Ue=Ue.replace(/^Root Entry[\/]/,""),y.keys.push(Ue),y.files[Ue]=t.FileIndex[ge]}))),e&&e.bookVBA&&(i.vba.length>0?y.vbaraw=Ur(t,qi(i.vba[0]),!0):i.defaults&&i.defaults.bin===w6&&(y.vbaraw=Ur(t,"xl/vbaProject.bin",!0))),y}function nB(t,e){var r=e||{},n="Workbook",i=Ze.find(t,n);try{if(n="/!DataSpaces/Version",i=Ze.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(DD(i.content),n="/!DataSpaces/DataSpaceMap",i=Ze.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=OD(i.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=Ze.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=MD(i.content);if(a.length!=1||a[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=Ze.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);BD(i.content)}catch{}if(n="/EncryptionInfo",i=Ze.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=jD(i.content);if(n="/EncryptedPackage",i=Ze.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],i.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function iB(t,e){return e.bookType=="ods"?cA(t,e):e.bookType=="numbers"?JL(t,e):e.bookType=="xlsb"?sB(t,e):aB(t,e)}function sB(t,e){Tc=1024,t&&!t.SSF&&(t.SSF=cr(it)),t&&t.SSF&&(cu(),Tp(t.SSF),e.revssf=kp(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,df?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",n=Lk.indexOf(e.bookType)>-1,i=U1();rv(e=e||{});var s=C1(),a="",o=0;if(e.cellXfs=[],zo(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),a="docProps/core.xml",xt(s,a,ZS(t.Props,e)),i.coreprops.push(a),Kt(e.rels,2,a,yt.CORE_PROPS),a="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],c=0;c<t.SheetNames.length;++c)(t.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(t.SheetNames[c]);t.Props.SheetNames=l}for(t.Props.Worksheets=t.Props.SheetNames.length,xt(s,a,rk(t.Props)),i.extprops.push(a),Kt(e.rels,3,a,yt.EXT_PROPS),t.Custprops!==t.Props&&Nr(t.Custprops||{}).length>0&&(a="docProps/custom.xml",xt(s,a,nk(t.Custprops)),i.custprops.push(a),Kt(e.rels,4,a,yt.CUST_PROPS)),o=1;o<=t.SheetNames.length;++o){var d={"!id":{}},h=t.Sheets[t.SheetNames[o-1]],p=(h||{})["!type"]||"sheet";switch(p){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,xt(s,a,OM(o-1,a,e,t,d)),i.sheets.push(a),Kt(e.wbrels,-1,"worksheets/sheet"+o+"."+r,yt.WS[0])}if(h){var m=h["!comments"],y=!1,x="";m&&m.length>0&&(x="xl/comments"+o+"."+r,xt(s,x,BM(m,x)),i.comments.push(x),Kt(d,-1,"../comments"+o+"."+r,yt.CMNT),y=!0),h["!legacy"]&&y&&xt(s,"xl/drawings/vmlDrawing"+o+".vml",Ok(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}d["!id"].rId1&&xt(s,Wf(a),Dc(d))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+r,xt(s,a,LM(e.Strings,a,e)),i.strs.push(a),Kt(e.wbrels,-1,"sharedStrings."+r,yt.SST)),a="xl/workbook."+r,xt(s,a,PM(t,a)),i.workbooks.push(a),Kt(e.rels,1,a,yt.WB),a="xl/theme/theme1.xml",xt(s,a,K1(t.Themes,e)),i.themes.push(a),Kt(e.wbrels,-1,"theme/theme1.xml",yt.THEME),a="xl/styles."+r,xt(s,a,MM(t,a,e)),i.styles.push(a),Kt(e.wbrels,-1,"styles."+r,yt.STY),t.vbaraw&&n&&(a="xl/vbaProject.bin",xt(s,a,t.vbaraw),i.vba.push(a),Kt(e.wbrels,-1,"vbaProject.bin",yt.VBA)),a="xl/metadata."+r,xt(s,a,jM(a)),i.metadata.push(a),Kt(e.wbrels,-1,"metadata."+r,yt.XLMETA),xt(s,"[Content_Types].xml",YS(i,e)),xt(s,"_rels/.rels",Dc(e.rels)),xt(s,"xl/_rels/workbook."+r+".rels",Dc(e.wbrels)),delete e.revssf,delete e.ssf,s}function aB(t,e){Tc=1024,t&&!t.SSF&&(t.SSF=cr(it)),t&&t.SSF&&(cu(),Tp(t.SSF),e.revssf=kp(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,df?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",n=Lk.indexOf(e.bookType)>-1,i=U1();rv(e=e||{});var s=C1(),a="",o=0;if(e.cellXfs=[],zo(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),a="docProps/core.xml",xt(s,a,ZS(t.Props,e)),i.coreprops.push(a),Kt(e.rels,2,a,yt.CORE_PROPS),a="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],c=0;c<t.SheetNames.length;++c)(t.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(t.SheetNames[c]);t.Props.SheetNames=l}t.Props.Worksheets=t.Props.SheetNames.length,xt(s,a,rk(t.Props)),i.extprops.push(a),Kt(e.rels,3,a,yt.EXT_PROPS),t.Custprops!==t.Props&&Nr(t.Custprops||{}).length>0&&(a="docProps/custom.xml",xt(s,a,nk(t.Custprops)),i.custprops.push(a),Kt(e.rels,4,a,yt.CUST_PROPS));var d=["SheetJ5"];for(e.tcid=0,o=1;o<=t.SheetNames.length;++o){var h={"!id":{}},p=t.Sheets[t.SheetNames[o-1]],m=(p||{})["!type"]||"sheet";switch(m){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,xt(s,a,Xk(o-1,e,t,h)),i.sheets.push(a),Kt(e.wbrels,-1,"worksheets/sheet"+o+"."+r,yt.WS[0])}if(p){var y=p["!comments"],x=!1,E="";if(y&&y.length>0){var T=!1;y.forEach(function(k){k[1].forEach(function(_){_.T==!0&&(T=!0)})}),T&&(E="xl/threadedComments/threadedComment"+o+"."+r,xt(s,E,h6(y,d,e)),i.threadedcomments.push(E),Kt(h,-1,"../threadedComments/threadedComment"+o+"."+r,yt.TCMNT)),E="xl/comments"+o+"."+r,xt(s,E,Mk(y)),i.comments.push(E),Kt(h,-1,"../comments"+o+"."+r,yt.CMNT),x=!0}p["!legacy"]&&x&&xt(s,"xl/drawings/vmlDrawing"+o+".vml",Ok(o,p["!comments"])),delete p["!comments"],delete p["!legacy"]}h["!id"].rId1&&xt(s,Wf(a),Dc(h))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+r,xt(s,a,Tk(e.Strings,e)),i.strs.push(a),Kt(e.wbrels,-1,"sharedStrings."+r,yt.SST)),a="xl/workbook."+r,xt(s,a,Zk(t)),i.workbooks.push(a),Kt(e.rels,1,a,yt.WB),a="xl/theme/theme1.xml",xt(s,a,K1(t.Themes,e)),i.themes.push(a),Kt(e.wbrels,-1,"theme/theme1.xml",yt.THEME),a="xl/styles."+r,xt(s,a,Rk(t,e)),i.styles.push(a),Kt(e.wbrels,-1,"styles."+r,yt.STY),t.vbaraw&&n&&(a="xl/vbaProject.bin",xt(s,a,t.vbaraw),i.vba.push(a),Kt(e.wbrels,-1,"vbaProject.bin",yt.VBA)),a="xl/metadata."+r,xt(s,a,Pk()),i.metadata.push(a),Kt(e.wbrels,-1,"metadata."+r,yt.XLMETA),d.length>1&&(a="xl/persons/person.xml",xt(s,a,g6(d)),i.people.push(a),Kt(e.wbrels,-1,"persons/person.xml",yt.PEOPLE)),xt(s,"[Content_Types].xml",YS(i,e)),xt(s,"_rels/.rels",Dc(e.rels)),xt(s,"xl/_rels/workbook."+r+".rels",Dc(e.wbrels)),delete e.revssf,delete e.ssf,s}function nv(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=Mi(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function oB(t,e){return Ze.find(t,"EncryptedPackage")?nB(t,e):nA(t,e)}function lB(t,e){var r,n=t,i=e||{};return i.type||(i.type=vt&&Buffer.isBuffer(t)?"buffer":"base64"),r=kS(n,i),rB(r,i)}function fA(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return ex(t.slice(r),e);default:break e}return Xc.to_workbook(t,e)}function cB(t,e){var r="",n=nv(t,e);switch(e.type){case"base64":r=Mi(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=Sl(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Jt(r)),e.type="binary",fA(r,e)}function uB(t,e){var r=t;return e.type=="base64"&&(r=Mi(r)),r=Lf.utils.decode(1200,r.slice(2),"str"),e.type="binary",fA(r,e)}function fB(t){return t.match(/[^\x00-\x7F]/)?Ks(t):t}function Dg(t,e,r,n){return n?(r.type="string",Xc.to_workbook(t,r)):Xc.to_workbook(e,r)}function Sc(t,e){w1();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return Sc(new Uint8Array(t),(r=cr(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,i=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Oc={},r.dateNF&&(Oc.dateNF=r.dateNF),r.type||(r.type=vt&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=vt?"buffer":"binary",n=sR(t),typeof Uint8Array<"u"&&!vt&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=fB(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var a=new ArrayBuffer(3),o=new Uint8Array(a);if(o.foo="bar",!o.foo)return r=cr(r),r.type="array",Sc(T1(n),r)}switch((i=nv(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return oB(Ze.read(n,r),r);break;case 9:if(i[1]<=8)return nA(n,r);break;case 60:return ex(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return mD(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return Ek.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?lB(n,r):Dg(t,n,r,s);case 239:return i[3]===60?ex(n,r):Dg(t,n,r,s);case 255:if(i[1]===254)return uB(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return pl.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return pl.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return Zm.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return Fk.to_workbook(n,r);break;case 10:case 13:case 32:return cB(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return gD.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?Zm.to_workbook(n,r):Dg(t,n,r,s)}function dA(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return d0(e.file,Ze.write(t,{type:vt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return Ze.write(t,e)}function dB(t,e){var r=cr(e||{}),n=iB(t,r);return hB(n,r)}function hB(t,e){var r={},n=vt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=n;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var i=t.FullPaths?Ze.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(e.type=="binary"||e.type=="base64")return i;i=new Uint8Array(wp(i))}return e.password&&typeof encrypt_agile<"u"?dA(encrypt_agile(i,e.password),e):e.type==="file"?d0(e.file,i):e.type=="string"?Jt(i):i}function pB(t,e){var r=e||{},n=fL(t,r);return dA(n,r)}function $s(t,e,r){r||(r="");var n=r+t;switch(e.type){case"base64":return Bf(Ks(n));case"binary":return Ks(n);case"string":return t;case"file":return d0(e.file,n,"utf8");case"buffer":return vt?Ma(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):$s(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function gB(t,e){switch(e.type){case"base64":return Bf(t);case"binary":return t;case"string":return t;case"file":return d0(e.file,t,"binary");case"buffer":return vt?Ma(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function Cd(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",n=0;n<t.length;++n)r+=String.fromCharCode(t[n]);return e.type=="base64"?Bf(r):e.type=="string"?Jt(r):r;case"file":return d0(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function hA(t,e){w1(),oM(t);var r=cr(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=hA(t,r);return r.type="array",wp(n)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=t.SheetNames.indexOf(r.sheet),!t.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return $s(iL(t,r),r);case"slk":case"sylk":return $s(_k.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"htm":case"html":return $s(sA(t.Sheets[t.SheetNames[i]],r),r);case"txt":return gB(pA(t.Sheets[t.SheetNames[i]],r),r);case"csv":return $s(iv(t.Sheets[t.SheetNames[i]],r),r,"\uFEFF");case"dif":return $s(Ek.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"dbf":return Cd(Zm.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"prn":return $s(Xc.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"rtf":return $s(Fk.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"eth":return $s(wk.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"fods":return $s(cA(t,r),r);case"wk1":return Cd(pl.sheet_to_wk1(t.Sheets[t.SheetNames[i]],r),r);case"wk3":return Cd(pl.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Cd(iA(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),pB(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return dB(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function mB(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(t.bookType=r.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function Pg(t,e,r){var n={};return n.type="file",n.file=e,mB(n),hA(t,n)}function xB(t,e,r,n,i,s,a,o){var l=Mr(r),c=o.defval,d=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),h=!0,p=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(p,"__rowNum__",{value:r,enumerable:!1})}catch{p.__rowNum__=r}else p.__rowNum__=r;if(!a||t[r])for(var m=e.s.c;m<=e.e.c;++m){var y=a?t[r][m]:t[n[m]+l];if(y===void 0||y.t===void 0){if(c===void 0)continue;s[m]!=null&&(p[s[m]]=c);continue}var x=y.v;switch(y.t){case"z":if(x==null)break;continue;case"e":x=x==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+y.t)}if(s[m]!=null){if(x==null)if(y.t=="e"&&x===null)p[s[m]]=null;else if(c!==void 0)p[s[m]]=c;else if(d&&x===null)p[s[m]]=null;else continue;else p[s[m]]=d&&(y.t!=="n"||y.t==="n"&&o.rawNumbers!==!1)?x:Ia(y,x,o);x!=null&&(h=!1)}}return{row:p,isempty:h}}function zh(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,s=[],a=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=e||{},d=c.range!=null?c.range:t["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof d){case"string":l=Ot(d);break;case"number":l=Ot(t["!ref"]),l.s.r=d;break;default:l=d}n>0&&(i=0);var h=Mr(l.s.r),p=[],m=[],y=0,x=0,E=Array.isArray(t),T=l.s.r,k=0,_={};E&&!t[T]&&(t[T]=[]);var P=c.skipHidden&&t["!cols"]||[],W=c.skipHidden&&t["!rows"]||[];for(k=l.s.c;k<=l.e.c;++k)if(!(P[k]||{}).hidden)switch(p[k]=Er(k),r=E?t[T][k]:t[p[k]+h],n){case 1:s[k]=k-l.s.c;break;case 2:s[k]=p[k];break;case 3:s[k]=c.header[k-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=a=Ia(r,null,c),x=_[a]||0,!x)_[a]=1;else{do o=a+"_"+x++;while(_[o]);_[a]=x,_[o]=1}s[k]=o}for(T=l.s.r+i;T<=l.e.r;++T)if(!(W[T]||{}).hidden){var B=xB(t,l,T,p,n,s,E,c);(B.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(m[y++]=B.row)}return m.length=y,m}var C2=/"/g;function vB(t,e,r,n,i,s,a,o){for(var l=!0,c=[],d="",h=Mr(r),p=e.s.c;p<=e.e.c;++p)if(n[p]){var m=o.dense?(t[r]||[])[p]:t[n[p]+h];if(m==null)d="";else if(m.v!=null){l=!1,d=""+(o.rawNumbers&&m.t=="n"?m.v:Ia(m,null,o));for(var y=0,x=0;y!==d.length;++y)if((x=d.charCodeAt(y))===i||x===s||x===34||o.forceQuotes){d='"'+d.replace(C2,'""')+'"';break}d=="ID"&&(d='"ID"')}else m.f!=null&&!m.F?(l=!1,d="="+m.f,d.indexOf(",")>=0&&(d='"'+d.replace(C2,'""')+'"')):d="";c.push(d)}return o.blankrows===!1&&l?null:c.join(a)}function iv(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var i=Ot(t["!ref"]),s=n.FS!==void 0?n.FS:",",a=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),c=new RegExp((s=="|"?"\\|":s)+"+$"),d="",h=[];n.dense=Array.isArray(t);for(var p=n.skipHidden&&t["!cols"]||[],m=n.skipHidden&&t["!rows"]||[],y=i.s.c;y<=i.e.c;++y)(p[y]||{}).hidden||(h[y]=Er(y));for(var x=0,E=i.s.r;E<=i.e.r;++E)(m[E]||{}).hidden||(d=vB(t,i,E,h,a,l,s,n),d!=null&&(n.strip&&(d=d.replace(c,"")),(d||n.blankrows!==!1)&&r.push((x++?o:"")+d)));return delete n.dense,r.join("")}function pA(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=iv(t,e);return r}function yB(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var i=Ot(t["!ref"]),s="",a=[],o,l=[],c=Array.isArray(t);for(o=i.s.c;o<=i.e.c;++o)a[o]=Er(o);for(var d=i.s.r;d<=i.e.r;++d)for(s=Mr(d),o=i.s.c;o<=i.e.c;++o)if(e=a[o]+s,r=c?(t[d]||[])[o]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=e+"="+n}return l}function gA(t,e,r){var n=r||{},i=+!n.skipHeader,s=t||{},a=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?wr(n.origin):n.origin;a=l.r,o=l.c}var c,d={s:{c:0,r:0},e:{c:o,r:a+e.length-1+i}};if(s["!ref"]){var h=Ot(s["!ref"]);d.e.c=Math.max(d.e.c,h.e.c),d.e.r=Math.max(d.e.r,h.e.r),a==-1&&(a=h.e.r+1,d.e.r=a+e.length-1+i)}else a==-1&&(a=0,d.e.r=e.length-1+i);var p=n.header||[],m=0;e.forEach(function(x,E){Nr(x).forEach(function(T){(m=p.indexOf(T))==-1&&(p[m=p.length]=T);var k=x[T],_="z",P="",W=st({c:o+m,r:a+E+i});c=Yf(s,W),k&&typeof k=="object"&&!(k instanceof Date)?s[W]=k:(typeof k=="number"?_="n":typeof k=="boolean"?_="b":typeof k=="string"?_="s":k instanceof Date?(_="d",n.cellDates||(_="n",k=Jr(k)),P=n.dateNF||it[14]):k===null&&n.nullError&&(_="e",k=0),c?(c.t=_,c.v=k,delete c.w,delete c.R,P&&(c.z=P)):s[W]=c={t:_,v:k},P&&(c.z=P))})}),d.e.c=Math.max(d.e.c,o+p.length-1);var y=Mr(a);if(i)for(m=0;m<p.length;++m)s[Er(m+o)+y]={t:"s",v:p[m]};return s["!ref"]=mt(d),s}function _B(t,e){return gA(null,t,e)}function Yf(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=wr(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?Yf(t,st(e)):Yf(t,st({r:e,c:r||0}))}function EB(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function sv(){return{SheetNames:[],Sheets:{}}}function av(t,e,r,n){var i=1;if(!r)for(;i<=65535&&t.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var a=s&&s[1]||r;for(++i;i<=65535&&t.SheetNames.indexOf(r=a+i)!=-1;++i);}if(Jk(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function wB(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=EB(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function TB(t,e){return t.z=e,t}function mA(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function SB(t,e,r){return mA(t,"#"+e,r)}function kB(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function AB(t,e,r,n){for(var i=typeof e!="string"?e:Ot(e),s=typeof e=="string"?e:mt(e),a=i.s.r;a<=i.e.r;++a)for(var o=i.s.c;o<=i.e.c;++o){var l=Yf(t,a,o);l.t="n",l.F=s,delete l.v,a==i.s.r&&o==i.s.c&&(l.f=r,n&&(l.D=!0))}return t}var Ai={encode_col:Er,encode_row:Mr,encode_cell:st,encode_range:mt,decode_col:O1,decode_row:P1,split_cell:LR,decode_cell:wr,decode_range:Ei,format_cell:Ia,sheet_add_aoa:WS,sheet_add_json:gA,sheet_add_dom:aA,aoa_to_sheet:uu,json_to_sheet:_B,table_to_sheet:oA,table_to_book:DL,sheet_to_csv:iv,sheet_to_txt:pA,sheet_to_json:zh,sheet_to_html:sA,sheet_to_formulae:yB,sheet_to_row_object_array:zh,sheet_get_cell:Yf,book_new:sv,book_append_sheet:av,book_set_sheet_visibility:wB,cell_set_number_format:TB,cell_set_hyperlink:mA,cell_set_internal_link:SB,cell_add_comment:kB,sheet_set_array_formula:AB,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var CB={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FB=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Tt=(t,e)=>{const r=ve.forwardRef(({color:n="currentColor",size:i=24,strokeWidth:s=2,absoluteStrokeWidth:a,className:o="",children:l,...c},d)=>ve.createElement("svg",{ref:d,...CB,width:i,height:i,stroke:n,strokeWidth:a?Number(s)*24/Number(i):s,className:["lucide",`lucide-${FB(t)}`,o].join(" "),...c},[...e.map(([h,p])=>ve.createElement(h,p)),...Array.isArray(l)?l:[l]]));return r.displayName=`${t}`,r};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F2=Tt("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I2=Tt("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IB=Tt("BellRing",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}],["path",{d:"M4 2C2.8 3.7 2 5.7 2 8",key:"tap9e0"}],["path",{d:"M22 8c0-2.3-.8-4.3-2-6",key:"5bb3ad"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b2=Tt("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R2=Tt("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bB=Tt("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RB=Tt("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N2=Tt("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D2=Tt("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NB=Tt("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Og=Tt("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mg=Tt("Clipboard",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DB=Tt("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mu=Tt("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PB=Tt("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fd=Tt("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lu=Tt("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lg=Tt("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P2=Tt("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Id=Tt("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bg=Tt("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OB=Tt("Merge",[["path",{d:"m8 6 4-4 4 4",key:"ybng9g"}],["path",{d:"M12 2v10.3a4 4 0 0 1-1.172 2.872L4 22",key:"1hyw0i"}],["path",{d:"m20 22-5-5",key:"1m27yz"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MB=Tt("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bd=Tt("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O2=Tt("PlusCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jg=Tt("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bu=Tt("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1-2-1Z",key:"wqdwcb"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17V7",key:"pyj7ub"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LB=Tt("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rd=Tt("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M2=Tt("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BB=Tt("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L2=Tt("Table",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jB=Tt("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2h0a3.13 3.13 0 0 1 3 3.88Z",key:"y3tblf"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Us=Tt("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zs=Tt("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B2=Tt("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rl=Tt("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);var j2={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xA=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=i&63|128):(i&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=i&63|128):(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=i&63|128)}return e},VB=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const i=t[r++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[r++];e[n++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[r++],a=t[r++],o=t[r++],l=((i&7)<<18|(s&63)<<12|(a&63)<<6|o&63)-65536;e[n++]=String.fromCharCode(55296+(l>>10)),e[n++]=String.fromCharCode(56320+(l&1023))}else{const s=t[r++],a=t[r++];e[n++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},vA={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<t.length;i+=3){const s=t[i],a=i+1<t.length,o=a?t[i+1]:0,l=i+2<t.length,c=l?t[i+2]:0,d=s>>2,h=(s&3)<<4|o>>4;let p=(o&15)<<2|c>>6,m=c&63;l||(m=64,a||(p=64)),n.push(r[d],r[h],r[p],r[m])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(xA(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):VB(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<t.length;){const s=r[t.charAt(i++)],o=i<t.length?r[t.charAt(i)]:0;++i;const c=i<t.length?r[t.charAt(i)]:64;++i;const h=i<t.length?r[t.charAt(i)]:64;if(++i,s==null||o==null||c==null||h==null)throw new UB;const p=s<<2|o>>4;if(n.push(p),c!==64){const m=o<<4&240|c>>2;if(n.push(m),h!==64){const y=c<<6&192|h;n.push(y)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class UB extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const zB=function(t){const e=xA(t);return vA.encodeByteArray(e,!0)},Wh=function(t){return zB(t).replace(/\./g,"")},yA=function(t){try{return vA.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WB(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $B=()=>WB().__FIREBASE_DEFAULTS__,HB=()=>{if(typeof process>"u"||typeof j2>"u")return;const t=j2.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},GB=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&yA(t[1]);return e&&JSON.parse(e)},Rp=()=>{try{return $B()||HB()||GB()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},_A=t=>{var e,r;return(r=(e=Rp())===null||e===void 0?void 0:e.emulatorHosts)===null||r===void 0?void 0:r[t]},KB=t=>{const e=_A(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},EA=()=>{var t;return(t=Rp())===null||t===void 0?void 0:t.config},wA=t=>{var e;return(e=Rp())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XB{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qB(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t);return[Wh(JSON.stringify(r)),Wh(JSON.stringify(a)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function YB(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(qn())}function QB(){var t;const e=(t=Rp())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function JB(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function ZB(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function e9(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function t9(){const t=qn();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function r9(){return!QB()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function n9(){try{return typeof indexedDB=="object"}catch{return!1}}function i9(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s9="FirebaseError";class ja extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=s9,Object.setPrototypeOf(this,ja.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,_0.prototype.create)}}class _0{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?a9(s,n):"Error",o=`${this.serviceName}: ${a} (${i}).`;return new ja(i,o,n)}}function a9(t,e){return t.replace(o9,(r,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const o9=/\{\$([^}]+)}/g;function l9(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function $h(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const i of r){if(!n.includes(i))return!1;const s=t[i],a=e[i];if(V2(s)&&V2(a)){if(!$h(s,a))return!1}else if(s!==a)return!1}for(const i of n)if(!r.includes(i))return!1;return!0}function V2(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function E0(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function c9(t,e){const r=new u9(t,e);return r.subscribe.bind(r)}class u9{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let i;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");f9(e,["next","error","complete"])?i=e:i={next:e,error:r,complete:n},i.next===void 0&&(i.next=Vg),i.error===void 0&&(i.error=Vg),i.complete===void 0&&(i.complete=Vg);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function f9(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function Vg(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ps(t){return t&&t._delegate?t._delegate:t}class Il{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nl="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d9{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new XB;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:r});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){var r;const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(r=e==null?void 0:e.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(p9(e))try{this.getOrInitializeService({instanceIdentifier:nl})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(r);try{const s=this.getOrInitializeService({instanceIdentifier:i});n.resolve(s)}catch{}}}}clearInstance(e=nl){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=nl){return this.instances.has(e)}getOptions(e=nl){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[s,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(s);n===o&&a.resolve(i)}return i}onInit(e,r){var n;const i=this.normalizeInstanceIdentifier(r),s=(n=this.onInitCallbacks.get(i))!==null&&n!==void 0?n:new Set;s.add(e),this.onInitCallbacks.set(i,s);const a=this.instances.get(i);return a&&e(a,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const i of n)try{i(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:h9(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=nl){return this.component?this.component.multipleInstances?e:nl:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function h9(t){return t===nl?void 0:t}function p9(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g9{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new d9(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ct;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Ct||(Ct={}));const m9={debug:Ct.DEBUG,verbose:Ct.VERBOSE,info:Ct.INFO,warn:Ct.WARN,error:Ct.ERROR,silent:Ct.SILENT},x9=Ct.INFO,v9={[Ct.DEBUG]:"log",[Ct.VERBOSE]:"log",[Ct.INFO]:"info",[Ct.WARN]:"warn",[Ct.ERROR]:"error"},y9=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),i=v9[e];if(i)console[i](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class ov{constructor(e){this.name=e,this._logLevel=x9,this._logHandler=y9,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ct))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?m9[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ct.DEBUG,...e),this._logHandler(this,Ct.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ct.VERBOSE,...e),this._logHandler(this,Ct.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ct.INFO,...e),this._logHandler(this,Ct.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ct.WARN,...e),this._logHandler(this,Ct.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ct.ERROR,...e),this._logHandler(this,Ct.ERROR,...e)}}const _9=(t,e)=>e.some(r=>t instanceof r);let U2,z2;function E9(){return U2||(U2=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function w9(){return z2||(z2=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const TA=new WeakMap,nx=new WeakMap,SA=new WeakMap,Ug=new WeakMap,lv=new WeakMap;function T9(t){const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",a)},s=()=>{r(To(t.result)),i()},a=()=>{n(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",a)});return e.then(r=>{r instanceof IDBCursor&&TA.set(r,t)}).catch(()=>{}),lv.set(e,t),e}function S9(t){if(nx.has(t))return;const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",a),t.removeEventListener("abort",a)},s=()=>{r(),i()},a=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",a),t.addEventListener("abort",a)});nx.set(t,e)}let ix={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return nx.get(t);if(e==="objectStoreNames")return t.objectStoreNames||SA.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return To(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function k9(t){ix=t(ix)}function A9(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(zg(this),e,...r);return SA.set(n,e.sort?e.sort():[e]),To(n)}:w9().includes(t)?function(...e){return t.apply(zg(this),e),To(TA.get(this))}:function(...e){return To(t.apply(zg(this),e))}}function C9(t){return typeof t=="function"?A9(t):(t instanceof IDBTransaction&&S9(t),_9(t,E9())?new Proxy(t,ix):t)}function To(t){if(t instanceof IDBRequest)return T9(t);if(Ug.has(t))return Ug.get(t);const e=C9(t);return e!==t&&(Ug.set(t,e),lv.set(e,t)),e}const zg=t=>lv.get(t);function F9(t,e,{blocked:r,upgrade:n,blocking:i,terminated:s}={}){const a=indexedDB.open(t,e),o=To(a);return n&&a.addEventListener("upgradeneeded",l=>{n(To(a.result),l.oldVersion,l.newVersion,To(a.transaction),l)}),r&&a.addEventListener("blocked",l=>r(l.oldVersion,l.newVersion,l)),o.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",c=>i(c.oldVersion,c.newVersion,c))}).catch(()=>{}),o}const I9=["get","getKey","getAll","getAllKeys","count"],b9=["put","add","delete","clear"],Wg=new Map;function W2(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Wg.get(e))return Wg.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,i=b9.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||I9.includes(r)))return;const s=async function(a,...o){const l=this.transaction(a,i?"readwrite":"readonly");let c=l.store;return n&&(c=c.index(o.shift())),(await Promise.all([c[r](...o),i&&l.done]))[0]};return Wg.set(e,s),s}k9(t=>({...t,get:(e,r,n)=>W2(e,r)||t.get(e,r,n),has:(e,r)=>!!W2(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R9{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(N9(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function N9(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const sx="@firebase/app",$2="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ba=new ov("@firebase/app"),D9="@firebase/app-compat",P9="@firebase/analytics-compat",O9="@firebase/analytics",M9="@firebase/app-check-compat",L9="@firebase/app-check",B9="@firebase/auth",j9="@firebase/auth-compat",V9="@firebase/database",U9="@firebase/data-connect",z9="@firebase/database-compat",W9="@firebase/functions",$9="@firebase/functions-compat",H9="@firebase/installations",G9="@firebase/installations-compat",K9="@firebase/messaging",X9="@firebase/messaging-compat",q9="@firebase/performance",Y9="@firebase/performance-compat",Q9="@firebase/remote-config",J9="@firebase/remote-config-compat",Z9="@firebase/storage",ej="@firebase/storage-compat",tj="@firebase/firestore",rj="@firebase/vertexai-preview",nj="@firebase/firestore-compat",ij="firebase",sj="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ax="[DEFAULT]",aj={[sx]:"fire-core",[D9]:"fire-core-compat",[O9]:"fire-analytics",[P9]:"fire-analytics-compat",[L9]:"fire-app-check",[M9]:"fire-app-check-compat",[B9]:"fire-auth",[j9]:"fire-auth-compat",[V9]:"fire-rtdb",[U9]:"fire-data-connect",[z9]:"fire-rtdb-compat",[W9]:"fire-fn",[$9]:"fire-fn-compat",[H9]:"fire-iid",[G9]:"fire-iid-compat",[K9]:"fire-fcm",[X9]:"fire-fcm-compat",[q9]:"fire-perf",[Y9]:"fire-perf-compat",[Q9]:"fire-rc",[J9]:"fire-rc-compat",[Z9]:"fire-gcs",[ej]:"fire-gcs-compat",[tj]:"fire-fst",[nj]:"fire-fst-compat",[rj]:"fire-vertex","fire-js":"fire-js",[ij]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hh=new Map,oj=new Map,ox=new Map;function H2(t,e){try{t.container.addComponent(e)}catch(r){ba.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function Yc(t){const e=t.name;if(ox.has(e))return ba.debug(`There were multiple attempts to register component ${e}.`),!1;ox.set(e,t);for(const r of Hh.values())H2(r,t);for(const r of oj.values())H2(r,t);return!0}function cv(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function ho(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lj={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},So=new _0("app","Firebase",lj);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cj{constructor(e,r,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Il("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw So.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const du=sj;function kA(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n=Object.assign({name:ax,automaticDataCollectionEnabled:!1},e),i=n.name;if(typeof i!="string"||!i)throw So.create("bad-app-name",{appName:String(i)});if(r||(r=EA()),!r)throw So.create("no-options");const s=Hh.get(i);if(s){if($h(r,s.options)&&$h(n,s.config))return s;throw So.create("duplicate-app",{appName:i})}const a=new g9(i);for(const l of ox.values())a.addComponent(l);const o=new cj(r,n,a);return Hh.set(i,o),o}function AA(t=ax){const e=Hh.get(t);if(!e&&t===ax&&EA())return kA();if(!e)throw So.create("no-app",{appName:t});return e}function ko(t,e,r){var n;let i=(n=aj[t])!==null&&n!==void 0?n:t;r&&(i+=`-${r}`);const s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){const o=[`Unable to register library "${i}" with version "${e}":`];s&&o.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&a&&o.push("and"),a&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ba.warn(o.join(" "));return}Yc(new Il(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uj="firebase-heartbeat-database",fj=1,Qf="firebase-heartbeat-store";let $g=null;function CA(){return $g||($g=F9(uj,fj,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Qf)}catch(r){console.warn(r)}}}}).catch(t=>{throw So.create("idb-open",{originalErrorMessage:t.message})})),$g}async function dj(t){try{const r=(await CA()).transaction(Qf),n=await r.objectStore(Qf).get(FA(t));return await r.done,n}catch(e){if(e instanceof ja)ba.warn(e.message);else{const r=So.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});ba.warn(r.message)}}}async function G2(t,e){try{const n=(await CA()).transaction(Qf,"readwrite");await n.objectStore(Qf).put(e,FA(t)),await n.done}catch(r){if(r instanceof ja)ba.warn(r.message);else{const n=So.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});ba.warn(n.message)}}}function FA(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hj=1024,pj=30*24*60*60*1e3;class gj{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new xj(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=K2();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(a=>a.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const o=new Date(a.date).valueOf();return Date.now()-o<=pj}),this._storage.overwrite(this._heartbeatsCache))}catch(n){ba.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=K2(),{heartbeatsToSend:n,unsentEntries:i}=mj(this._heartbeatsCache.heartbeats),s=Wh(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(r){return ba.warn(r),""}}}function K2(){return new Date().toISOString().substring(0,10)}function mj(t,e=hj){const r=[];let n=t.slice();for(const i of t){const s=r.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),X2(r)>e){s.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),X2(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class xj{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return n9()?i9().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await dj(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return G2(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return G2(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function X2(t){return Wh(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vj(t){Yc(new Il("platform-logger",e=>new R9(e),"PRIVATE")),Yc(new Il("heartbeat",e=>new gj(e),"PRIVATE")),ko(sx,$2,t),ko(sx,$2,"esm2017"),ko("fire-js","")}vj("");var yj="firebase",_j="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ko(yj,_j,"app");var q2=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var ml,IA;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(w,C){function S(){}S.prototype=C.prototype,w.D=C.prototype,w.prototype=new S,w.prototype.constructor=w,w.C=function(b,N,D){for(var R=Array(arguments.length-2),Ue=2;Ue<arguments.length;Ue++)R[Ue-2]=arguments[Ue];return C.prototype[N].apply(b,R)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(w,C,S){S||(S=0);var b=Array(16);if(typeof C=="string")for(var N=0;16>N;++N)b[N]=C.charCodeAt(S++)|C.charCodeAt(S++)<<8|C.charCodeAt(S++)<<16|C.charCodeAt(S++)<<24;else for(N=0;16>N;++N)b[N]=C[S++]|C[S++]<<8|C[S++]<<16|C[S++]<<24;C=w.g[0],S=w.g[1],N=w.g[2];var D=w.g[3],R=C+(D^S&(N^D))+b[0]+3614090360&4294967295;C=S+(R<<7&4294967295|R>>>25),R=D+(N^C&(S^N))+b[1]+3905402710&4294967295,D=C+(R<<12&4294967295|R>>>20),R=N+(S^D&(C^S))+b[2]+606105819&4294967295,N=D+(R<<17&4294967295|R>>>15),R=S+(C^N&(D^C))+b[3]+3250441966&4294967295,S=N+(R<<22&4294967295|R>>>10),R=C+(D^S&(N^D))+b[4]+4118548399&4294967295,C=S+(R<<7&4294967295|R>>>25),R=D+(N^C&(S^N))+b[5]+1200080426&4294967295,D=C+(R<<12&4294967295|R>>>20),R=N+(S^D&(C^S))+b[6]+2821735955&4294967295,N=D+(R<<17&4294967295|R>>>15),R=S+(C^N&(D^C))+b[7]+4249261313&4294967295,S=N+(R<<22&4294967295|R>>>10),R=C+(D^S&(N^D))+b[8]+1770035416&4294967295,C=S+(R<<7&4294967295|R>>>25),R=D+(N^C&(S^N))+b[9]+2336552879&4294967295,D=C+(R<<12&4294967295|R>>>20),R=N+(S^D&(C^S))+b[10]+4294925233&4294967295,N=D+(R<<17&4294967295|R>>>15),R=S+(C^N&(D^C))+b[11]+2304563134&4294967295,S=N+(R<<22&4294967295|R>>>10),R=C+(D^S&(N^D))+b[12]+1804603682&4294967295,C=S+(R<<7&4294967295|R>>>25),R=D+(N^C&(S^N))+b[13]+4254626195&4294967295,D=C+(R<<12&4294967295|R>>>20),R=N+(S^D&(C^S))+b[14]+2792965006&4294967295,N=D+(R<<17&4294967295|R>>>15),R=S+(C^N&(D^C))+b[15]+1236535329&4294967295,S=N+(R<<22&4294967295|R>>>10),R=C+(N^D&(S^N))+b[1]+4129170786&4294967295,C=S+(R<<5&4294967295|R>>>27),R=D+(S^N&(C^S))+b[6]+3225465664&4294967295,D=C+(R<<9&4294967295|R>>>23),R=N+(C^S&(D^C))+b[11]+643717713&4294967295,N=D+(R<<14&4294967295|R>>>18),R=S+(D^C&(N^D))+b[0]+3921069994&4294967295,S=N+(R<<20&4294967295|R>>>12),R=C+(N^D&(S^N))+b[5]+3593408605&4294967295,C=S+(R<<5&4294967295|R>>>27),R=D+(S^N&(C^S))+b[10]+38016083&4294967295,D=C+(R<<9&4294967295|R>>>23),R=N+(C^S&(D^C))+b[15]+3634488961&4294967295,N=D+(R<<14&4294967295|R>>>18),R=S+(D^C&(N^D))+b[4]+3889429448&4294967295,S=N+(R<<20&4294967295|R>>>12),R=C+(N^D&(S^N))+b[9]+568446438&4294967295,C=S+(R<<5&4294967295|R>>>27),R=D+(S^N&(C^S))+b[14]+3275163606&4294967295,D=C+(R<<9&4294967295|R>>>23),R=N+(C^S&(D^C))+b[3]+4107603335&4294967295,N=D+(R<<14&4294967295|R>>>18),R=S+(D^C&(N^D))+b[8]+1163531501&4294967295,S=N+(R<<20&4294967295|R>>>12),R=C+(N^D&(S^N))+b[13]+2850285829&4294967295,C=S+(R<<5&4294967295|R>>>27),R=D+(S^N&(C^S))+b[2]+4243563512&4294967295,D=C+(R<<9&4294967295|R>>>23),R=N+(C^S&(D^C))+b[7]+1735328473&4294967295,N=D+(R<<14&4294967295|R>>>18),R=S+(D^C&(N^D))+b[12]+2368359562&4294967295,S=N+(R<<20&4294967295|R>>>12),R=C+(S^N^D)+b[5]+4294588738&4294967295,C=S+(R<<4&4294967295|R>>>28),R=D+(C^S^N)+b[8]+2272392833&4294967295,D=C+(R<<11&4294967295|R>>>21),R=N+(D^C^S)+b[11]+1839030562&4294967295,N=D+(R<<16&4294967295|R>>>16),R=S+(N^D^C)+b[14]+4259657740&4294967295,S=N+(R<<23&4294967295|R>>>9),R=C+(S^N^D)+b[1]+2763975236&4294967295,C=S+(R<<4&4294967295|R>>>28),R=D+(C^S^N)+b[4]+1272893353&4294967295,D=C+(R<<11&4294967295|R>>>21),R=N+(D^C^S)+b[7]+4139469664&4294967295,N=D+(R<<16&4294967295|R>>>16),R=S+(N^D^C)+b[10]+3200236656&4294967295,S=N+(R<<23&4294967295|R>>>9),R=C+(S^N^D)+b[13]+681279174&4294967295,C=S+(R<<4&4294967295|R>>>28),R=D+(C^S^N)+b[0]+3936430074&4294967295,D=C+(R<<11&4294967295|R>>>21),R=N+(D^C^S)+b[3]+3572445317&4294967295,N=D+(R<<16&4294967295|R>>>16),R=S+(N^D^C)+b[6]+76029189&4294967295,S=N+(R<<23&4294967295|R>>>9),R=C+(S^N^D)+b[9]+3654602809&4294967295,C=S+(R<<4&4294967295|R>>>28),R=D+(C^S^N)+b[12]+3873151461&4294967295,D=C+(R<<11&4294967295|R>>>21),R=N+(D^C^S)+b[15]+530742520&4294967295,N=D+(R<<16&4294967295|R>>>16),R=S+(N^D^C)+b[2]+3299628645&4294967295,S=N+(R<<23&4294967295|R>>>9),R=C+(N^(S|~D))+b[0]+4096336452&4294967295,C=S+(R<<6&4294967295|R>>>26),R=D+(S^(C|~N))+b[7]+1126891415&4294967295,D=C+(R<<10&4294967295|R>>>22),R=N+(C^(D|~S))+b[14]+2878612391&4294967295,N=D+(R<<15&4294967295|R>>>17),R=S+(D^(N|~C))+b[5]+4237533241&4294967295,S=N+(R<<21&4294967295|R>>>11),R=C+(N^(S|~D))+b[12]+1700485571&4294967295,C=S+(R<<6&4294967295|R>>>26),R=D+(S^(C|~N))+b[3]+2399980690&4294967295,D=C+(R<<10&4294967295|R>>>22),R=N+(C^(D|~S))+b[10]+4293915773&4294967295,N=D+(R<<15&4294967295|R>>>17),R=S+(D^(N|~C))+b[1]+2240044497&4294967295,S=N+(R<<21&4294967295|R>>>11),R=C+(N^(S|~D))+b[8]+1873313359&4294967295,C=S+(R<<6&4294967295|R>>>26),R=D+(S^(C|~N))+b[15]+4264355552&4294967295,D=C+(R<<10&4294967295|R>>>22),R=N+(C^(D|~S))+b[6]+2734768916&4294967295,N=D+(R<<15&4294967295|R>>>17),R=S+(D^(N|~C))+b[13]+1309151649&4294967295,S=N+(R<<21&4294967295|R>>>11),R=C+(N^(S|~D))+b[4]+4149444226&4294967295,C=S+(R<<6&4294967295|R>>>26),R=D+(S^(C|~N))+b[11]+3174756917&4294967295,D=C+(R<<10&4294967295|R>>>22),R=N+(C^(D|~S))+b[2]+718787259&4294967295,N=D+(R<<15&4294967295|R>>>17),R=S+(D^(N|~C))+b[9]+3951481745&4294967295,w.g[0]=w.g[0]+C&4294967295,w.g[1]=w.g[1]+(N+(R<<21&4294967295|R>>>11))&4294967295,w.g[2]=w.g[2]+N&4294967295,w.g[3]=w.g[3]+D&4294967295}n.prototype.u=function(w,C){C===void 0&&(C=w.length);for(var S=C-this.blockSize,b=this.B,N=this.h,D=0;D<C;){if(N==0)for(;D<=S;)i(this,w,D),D+=this.blockSize;if(typeof w=="string"){for(;D<C;)if(b[N++]=w.charCodeAt(D++),N==this.blockSize){i(this,b),N=0;break}}else for(;D<C;)if(b[N++]=w[D++],N==this.blockSize){i(this,b),N=0;break}}this.h=N,this.o+=C},n.prototype.v=function(){var w=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);w[0]=128;for(var C=1;C<w.length-8;++C)w[C]=0;var S=8*this.o;for(C=w.length-8;C<w.length;++C)w[C]=S&255,S/=256;for(this.u(w),w=Array(16),C=S=0;4>C;++C)for(var b=0;32>b;b+=8)w[S++]=this.g[C]>>>b&255;return w};function s(w,C){var S=o;return Object.prototype.hasOwnProperty.call(S,w)?S[w]:S[w]=C(w)}function a(w,C){this.h=C;for(var S=[],b=!0,N=w.length-1;0<=N;N--){var D=w[N]|0;b&&D==C||(S[N]=D,b=!1)}this.g=S}var o={};function l(w){return-128<=w&&128>w?s(w,function(C){return new a([C|0],0>C?-1:0)}):new a([w|0],0>w?-1:0)}function c(w){if(isNaN(w)||!isFinite(w))return h;if(0>w)return E(c(-w));for(var C=[],S=1,b=0;w>=S;b++)C[b]=w/S|0,S*=4294967296;return new a(C,0)}function d(w,C){if(w.length==0)throw Error("number format error: empty string");if(C=C||10,2>C||36<C)throw Error("radix out of range: "+C);if(w.charAt(0)=="-")return E(d(w.substring(1),C));if(0<=w.indexOf("-"))throw Error('number format error: interior "-" character');for(var S=c(Math.pow(C,8)),b=h,N=0;N<w.length;N+=8){var D=Math.min(8,w.length-N),R=parseInt(w.substring(N,N+D),C);8>D?(D=c(Math.pow(C,D)),b=b.j(D).add(c(R))):(b=b.j(S),b=b.add(c(R)))}return b}var h=l(0),p=l(1),m=l(16777216);t=a.prototype,t.m=function(){if(x(this))return-E(this).m();for(var w=0,C=1,S=0;S<this.g.length;S++){var b=this.i(S);w+=(0<=b?b:4294967296+b)*C,C*=4294967296}return w},t.toString=function(w){if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(y(this))return"0";if(x(this))return"-"+E(this).toString(w);for(var C=c(Math.pow(w,6)),S=this,b="";;){var N=P(S,C).g;S=T(S,N.j(C));var D=((0<S.g.length?S.g[0]:S.h)>>>0).toString(w);if(S=N,y(S))return D+b;for(;6>D.length;)D="0"+D;b=D+b}},t.i=function(w){return 0>w?0:w<this.g.length?this.g[w]:this.h};function y(w){if(w.h!=0)return!1;for(var C=0;C<w.g.length;C++)if(w.g[C]!=0)return!1;return!0}function x(w){return w.h==-1}t.l=function(w){return w=T(this,w),x(w)?-1:y(w)?0:1};function E(w){for(var C=w.g.length,S=[],b=0;b<C;b++)S[b]=~w.g[b];return new a(S,~w.h).add(p)}t.abs=function(){return x(this)?E(this):this},t.add=function(w){for(var C=Math.max(this.g.length,w.g.length),S=[],b=0,N=0;N<=C;N++){var D=b+(this.i(N)&65535)+(w.i(N)&65535),R=(D>>>16)+(this.i(N)>>>16)+(w.i(N)>>>16);b=R>>>16,D&=65535,R&=65535,S[N]=R<<16|D}return new a(S,S[S.length-1]&-2147483648?-1:0)};function T(w,C){return w.add(E(C))}t.j=function(w){if(y(this)||y(w))return h;if(x(this))return x(w)?E(this).j(E(w)):E(E(this).j(w));if(x(w))return E(this.j(E(w)));if(0>this.l(m)&&0>w.l(m))return c(this.m()*w.m());for(var C=this.g.length+w.g.length,S=[],b=0;b<2*C;b++)S[b]=0;for(b=0;b<this.g.length;b++)for(var N=0;N<w.g.length;N++){var D=this.i(b)>>>16,R=this.i(b)&65535,Ue=w.i(N)>>>16,ge=w.i(N)&65535;S[2*b+2*N]+=R*ge,k(S,2*b+2*N),S[2*b+2*N+1]+=D*ge,k(S,2*b+2*N+1),S[2*b+2*N+1]+=R*Ue,k(S,2*b+2*N+1),S[2*b+2*N+2]+=D*Ue,k(S,2*b+2*N+2)}for(b=0;b<C;b++)S[b]=S[2*b+1]<<16|S[2*b];for(b=C;b<2*C;b++)S[b]=0;return new a(S,0)};function k(w,C){for(;(w[C]&65535)!=w[C];)w[C+1]+=w[C]>>>16,w[C]&=65535,C++}function _(w,C){this.g=w,this.h=C}function P(w,C){if(y(C))throw Error("division by zero");if(y(w))return new _(h,h);if(x(w))return C=P(E(w),C),new _(E(C.g),E(C.h));if(x(C))return C=P(w,E(C)),new _(E(C.g),C.h);if(30<w.g.length){if(x(w)||x(C))throw Error("slowDivide_ only works with positive integers.");for(var S=p,b=C;0>=b.l(w);)S=W(S),b=W(b);var N=B(S,1),D=B(b,1);for(b=B(b,2),S=B(S,2);!y(b);){var R=D.add(b);0>=R.l(w)&&(N=N.add(S),D=R),b=B(b,1),S=B(S,1)}return C=T(w,N.j(C)),new _(N,C)}for(N=h;0<=w.l(C);){for(S=Math.max(1,Math.floor(w.m()/C.m())),b=Math.ceil(Math.log(S)/Math.LN2),b=48>=b?1:Math.pow(2,b-48),D=c(S),R=D.j(C);x(R)||0<R.l(w);)S-=b,D=c(S),R=D.j(C);y(D)&&(D=p),N=N.add(D),w=T(w,R)}return new _(N,w)}t.A=function(w){return P(this,w).h},t.and=function(w){for(var C=Math.max(this.g.length,w.g.length),S=[],b=0;b<C;b++)S[b]=this.i(b)&w.i(b);return new a(S,this.h&w.h)},t.or=function(w){for(var C=Math.max(this.g.length,w.g.length),S=[],b=0;b<C;b++)S[b]=this.i(b)|w.i(b);return new a(S,this.h|w.h)},t.xor=function(w){for(var C=Math.max(this.g.length,w.g.length),S=[],b=0;b<C;b++)S[b]=this.i(b)^w.i(b);return new a(S,this.h^w.h)};function W(w){for(var C=w.g.length+1,S=[],b=0;b<C;b++)S[b]=w.i(b)<<1|w.i(b-1)>>>31;return new a(S,w.h)}function B(w,C){var S=C>>5;C%=32;for(var b=w.g.length-S,N=[],D=0;D<b;D++)N[D]=0<C?w.i(D+S)>>>C|w.i(D+S+1)<<32-C:w.i(D+S);return new a(N,w.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,IA=n,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=c,a.fromString=d,ml=a}).apply(typeof q2<"u"?q2:typeof self<"u"?self:typeof window<"u"?window:{});var Nd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var bA,Ku,RA,Qd,lx,NA,DA,PA;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(u,v,A){return u==Array.prototype||u==Object.prototype||(u[v]=A.value),u};function r(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof Nd=="object"&&Nd];for(var v=0;v<u.length;++v){var A=u[v];if(A&&A.Math==Math)return A}throw Error("Cannot find global object")}var n=r(this);function i(u,v){if(v)e:{var A=n;u=u.split(".");for(var O=0;O<u.length-1;O++){var se=u[O];if(!(se in A))break e;A=A[se]}u=u[u.length-1],O=A[u],v=v(O),v!=O&&v!=null&&e(A,u,{configurable:!0,writable:!0,value:v})}}function s(u,v){u instanceof String&&(u+="");var A=0,O=!1,se={next:function(){if(!O&&A<u.length){var he=A++;return{value:v(he,u[he]),done:!1}}return O=!0,{done:!0,value:void 0}}};return se[Symbol.iterator]=function(){return se},se}i("Array.prototype.values",function(u){return u||function(){return s(this,function(v,A){return A})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},o=this||self;function l(u){var v=typeof u;return v=v!="object"?v:u?Array.isArray(u)?"array":v:"null",v=="array"||v=="object"&&typeof u.length=="number"}function c(u){var v=typeof u;return v=="object"&&u!=null||v=="function"}function d(u,v,A){return u.call.apply(u.bind,arguments)}function h(u,v,A){if(!u)throw Error();if(2<arguments.length){var O=Array.prototype.slice.call(arguments,2);return function(){var se=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(se,O),u.apply(v,se)}}return function(){return u.apply(v,arguments)}}function p(u,v,A){return p=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:h,p.apply(null,arguments)}function m(u,v){var A=Array.prototype.slice.call(arguments,1);return function(){var O=A.slice();return O.push.apply(O,arguments),u.apply(this,O)}}function y(u,v){function A(){}A.prototype=v.prototype,u.aa=v.prototype,u.prototype=new A,u.prototype.constructor=u,u.Qb=function(O,se,he){for(var Ve=Array(arguments.length-2),Wt=2;Wt<arguments.length;Wt++)Ve[Wt-2]=arguments[Wt];return v.prototype[se].apply(O,Ve)}}function x(u){const v=u.length;if(0<v){const A=Array(v);for(let O=0;O<v;O++)A[O]=u[O];return A}return[]}function E(u,v){for(let A=1;A<arguments.length;A++){const O=arguments[A];if(l(O)){const se=u.length||0,he=O.length||0;u.length=se+he;for(let Ve=0;Ve<he;Ve++)u[se+Ve]=O[Ve]}else u.push(O)}}class T{constructor(v,A){this.i=v,this.j=A,this.h=0,this.g=null}get(){let v;return 0<this.h?(this.h--,v=this.g,this.g=v.next,v.next=null):v=this.i(),v}}function k(u){return/^[\s\xa0]*$/.test(u)}function _(){var u=o.navigator;return u&&(u=u.userAgent)?u:""}function P(u){return P[" "](u),u}P[" "]=function(){};var W=_().indexOf("Gecko")!=-1&&!(_().toLowerCase().indexOf("webkit")!=-1&&_().indexOf("Edge")==-1)&&!(_().indexOf("Trident")!=-1||_().indexOf("MSIE")!=-1)&&_().indexOf("Edge")==-1;function B(u,v,A){for(const O in u)v.call(A,u[O],O,u)}function w(u,v){for(const A in u)v.call(void 0,u[A],A,u)}function C(u){const v={};for(const A in u)v[A]=u[A];return v}const S="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function b(u,v){let A,O;for(let se=1;se<arguments.length;se++){O=arguments[se];for(A in O)u[A]=O[A];for(let he=0;he<S.length;he++)A=S[he],Object.prototype.hasOwnProperty.call(O,A)&&(u[A]=O[A])}}function N(u){var v=1;u=u.split(":");const A=[];for(;0<v&&u.length;)A.push(u.shift()),v--;return u.length&&A.push(u.join(":")),A}function D(u){o.setTimeout(()=>{throw u},0)}function R(){var u=J;let v=null;return u.g&&(v=u.g,u.g=u.g.next,u.g||(u.h=null),v.next=null),v}class Ue{constructor(){this.h=this.g=null}add(v,A){const O=ge.get();O.set(v,A),this.h?this.h.next=O:this.g=O,this.h=O}}var ge=new T(()=>new Fe,u=>u.reset());class Fe{constructor(){this.next=this.g=this.h=null}set(v,A){this.h=v,this.g=A,this.next=null}reset(){this.next=this.g=this.h=null}}let Ee,xe=!1,J=new Ue,ke=()=>{const u=o.Promise.resolve(void 0);Ee=()=>{u.then(Me)}};var Me=()=>{for(var u;u=R();){try{u.h.call(u.g)}catch(A){D(A)}var v=ge;v.j(u),100>v.h&&(v.h++,u.next=v.g,v.g=u)}xe=!1};function j(){this.s=this.s,this.C=this.C}j.prototype.s=!1,j.prototype.ma=function(){this.s||(this.s=!0,this.N())},j.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function H(u,v){this.type=u,this.g=this.target=v,this.defaultPrevented=!1}H.prototype.h=function(){this.defaultPrevented=!0};var q=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var u=!1,v=Object.defineProperty({},"passive",{get:function(){u=!0}});try{const A=()=>{};o.addEventListener("test",A,v),o.removeEventListener("test",A,v)}catch{}return u}();function X(u,v){if(H.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u){var A=this.type=u.type,O=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=v,v=u.relatedTarget){if(W){e:{try{P(v.nodeName);var se=!0;break e}catch{}se=!1}se||(v=null)}}else A=="mouseover"?v=u.fromElement:A=="mouseout"&&(v=u.toElement);this.relatedTarget=v,O?(this.clientX=O.clientX!==void 0?O.clientX:O.pageX,this.clientY=O.clientY!==void 0?O.clientY:O.pageY,this.screenX=O.screenX||0,this.screenY=O.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=typeof u.pointerType=="string"?u.pointerType:de[u.pointerType]||"",this.state=u.state,this.i=u,u.defaultPrevented&&X.aa.h.call(this)}}y(X,H);var de={2:"touch",3:"pen",4:"mouse"};X.prototype.h=function(){X.aa.h.call(this);var u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var we="closure_listenable_"+(1e6*Math.random()|0),Ne=0;function Te(u,v,A,O,se){this.listener=u,this.proxy=null,this.src=v,this.type=A,this.capture=!!O,this.ha=se,this.key=++Ne,this.da=this.fa=!1}function _e(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function rt(u){this.src=u,this.g={},this.h=0}rt.prototype.add=function(u,v,A,O,se){var he=u.toString();u=this.g[he],u||(u=this.g[he]=[],this.h++);var Ve=Vt(u,v,O,se);return-1<Ve?(v=u[Ve],A||(v.fa=!1)):(v=new Te(v,this.src,he,!!O,se),v.fa=A,u.push(v)),v};function G(u,v){var A=v.type;if(A in u.g){var O=u.g[A],se=Array.prototype.indexOf.call(O,v,void 0),he;(he=0<=se)&&Array.prototype.splice.call(O,se,1),he&&(_e(v),u.g[A].length==0&&(delete u.g[A],u.h--))}}function Vt(u,v,A,O){for(var se=0;se<u.length;++se){var he=u[se];if(!he.da&&he.listener==v&&he.capture==!!A&&he.ha==O)return se}return-1}var gt="closure_lm_"+(1e6*Math.random()|0),Rt={};function dt(u,v,A,O,se){if(Array.isArray(v)){for(var he=0;he<v.length;he++)dt(u,v[he],A,O,se);return null}return A=ui(A),u&&u[we]?u.K(v,A,c(O)?!!O.capture:!1,se):$e(u,v,A,!1,O,se)}function $e(u,v,A,O,se,he){if(!v)throw Error("Invalid event type");var Ve=c(se)?!!se.capture:!!se,Wt=ci(u);if(Wt||(u[gt]=Wt=new rt(u)),A=Wt.add(v,A,O,Ve,he),A.proxy)return A;if(O=Zt(),A.proxy=O,O.src=u,O.listener=A,u.addEventListener)q||(se=Ve),se===void 0&&(se=!1),u.addEventListener(v.toString(),O,se);else if(u.attachEvent)u.attachEvent(li(v.toString()),O);else if(u.addListener&&u.removeListener)u.addListener(O);else throw Error("addEventListener and attachEvent are unavailable.");return A}function Zt(){function u(A){return v.call(u.src,u.listener,A)}const v=ji;return u}function fn(u,v,A,O,se){if(Array.isArray(v))for(var he=0;he<v.length;he++)fn(u,v[he],A,O,se);else O=c(O)?!!O.capture:!!O,A=ui(A),u&&u[we]?(u=u.i,v=String(v).toString(),v in u.g&&(he=u.g[v],A=Vt(he,A,O,se),-1<A&&(_e(he[A]),Array.prototype.splice.call(he,A,1),he.length==0&&(delete u.g[v],u.h--)))):u&&(u=ci(u))&&(v=u.g[v.toString()],u=-1,v&&(u=Vt(v,A,O,se)),(A=-1<u?v[u]:null)&&$r(A))}function $r(u){if(typeof u!="number"&&u&&!u.da){var v=u.src;if(v&&v[we])G(v.i,u);else{var A=u.type,O=u.proxy;v.removeEventListener?v.removeEventListener(A,O,u.capture):v.detachEvent?v.detachEvent(li(A),O):v.addListener&&v.removeListener&&v.removeListener(O),(A=ci(v))?(G(A,u),A.h==0&&(A.src=null,v[gt]=null)):_e(u)}}}function li(u){return u in Rt?Rt[u]:Rt[u]="on"+u}function ji(u,v){if(u.da)u=!0;else{v=new X(v,this);var A=u.listener,O=u.ha||u.src;u.fa&&$r(u),u=A.call(O,v)}return u}function ci(u){return u=u[gt],u instanceof rt?u:null}var Ar="__closure_events_fn_"+(1e9*Math.random()>>>0);function ui(u){return typeof u=="function"?u:(u[Ar]||(u[Ar]=function(v){return u.handleEvent(v)}),u[Ar])}function Mt(){j.call(this),this.i=new rt(this),this.M=this,this.F=null}y(Mt,j),Mt.prototype[we]=!0,Mt.prototype.removeEventListener=function(u,v,A,O){fn(this,u,v,A,O)};function mr(u,v){var A,O=u.F;if(O)for(A=[];O;O=O.F)A.push(O);if(u=u.M,O=v.type||v,typeof v=="string")v=new H(v,u);else if(v instanceof H)v.target=v.target||u;else{var se=v;v=new H(O,u),b(v,se)}if(se=!0,A)for(var he=A.length-1;0<=he;he--){var Ve=v.g=A[he];se=nr(Ve,O,!0,v)&&se}if(Ve=v.g=u,se=nr(Ve,O,!0,v)&&se,se=nr(Ve,O,!1,v)&&se,A)for(he=0;he<A.length;he++)Ve=v.g=A[he],se=nr(Ve,O,!1,v)&&se}Mt.prototype.N=function(){if(Mt.aa.N.call(this),this.i){var u=this.i,v;for(v in u.g){for(var A=u.g[v],O=0;O<A.length;O++)_e(A[O]);delete u.g[v],u.h--}}this.F=null},Mt.prototype.K=function(u,v,A,O){return this.i.add(String(u),v,!1,A,O)},Mt.prototype.L=function(u,v,A,O){return this.i.add(String(u),v,!0,A,O)};function nr(u,v,A,O){if(v=u.i.g[String(v)],!v)return!0;v=v.concat();for(var se=!0,he=0;he<v.length;++he){var Ve=v[he];if(Ve&&!Ve.da&&Ve.capture==A){var Wt=Ve.listener,Hr=Ve.ha||Ve.src;Ve.fa&&G(u.i,Ve),se=Wt.call(Hr,O)!==!1&&se}}return se&&!O.defaultPrevented}function Qn(u,v,A){if(typeof u=="function")A&&(u=p(u,A));else if(u&&typeof u.handleEvent=="function")u=p(u.handleEvent,u);else throw Error("Invalid listener argument");return 2147483647<Number(v)?-1:o.setTimeout(u,v||0)}function ot(u){u.g=Qn(()=>{u.g=null,u.i&&(u.i=!1,ot(u))},u.l);const v=u.h;u.h=null,u.m.apply(null,v)}class ir extends j{constructor(v,A){super(),this.m=v,this.l=A,this.h=null,this.i=!1,this.g=null}j(v){this.h=arguments,this.g?this.i=!0:ot(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function xr(u){j.call(this),this.h=u,this.g={}}y(xr,j);var ur=[];function Fn(u){B(u.g,function(v,A){this.g.hasOwnProperty(A)&&$r(v)},u),u.g={}}xr.prototype.N=function(){xr.aa.N.call(this),Fn(this)},xr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ae=o.JSON.stringify,Br=o.JSON.parse,ia=class{stringify(u){return o.JSON.stringify(u,void 0)}parse(u){return o.JSON.parse(u,void 0)}};function sa(){}sa.prototype.h=null;function Os(u){return u.h||(u.h=u.i())}function aa(){}var wi={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Vi(){H.call(this,"d")}y(Vi,H);function vr(){H.call(this,"c")}y(vr,H);var Ui={},Va=null;function Ua(){return Va=Va||new Mt}Ui.La="serverreachability";function In(u){H.call(this,Ui.La,u)}y(In,H);function Ms(u){const v=Ua();mr(v,new In(v))}Ui.STAT_EVENT="statevent";function er(u,v){H.call(this,Ui.STAT_EVENT,u),this.stat=v}y(er,H);function fr(u){const v=Ua();mr(v,new er(v,u))}Ui.Ma="timingevent";function Ti(u,v){H.call(this,Ui.Ma,u),this.size=v}y(Ti,H);function dn(u,v){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){u()},v)}function oa(){this.g=!0}oa.prototype.xa=function(){this.g=!1};function $l(u,v,A,O,se,he){u.info(function(){if(u.g)if(he)for(var Ve="",Wt=he.split("&"),Hr=0;Hr<Wt.length;Hr++){var It=Wt[Hr].split("=");if(1<It.length){var en=It[0];It=It[1];var tn=en.split("_");Ve=2<=tn.length&&tn[1]=="type"?Ve+(en+"="+It+"&"):Ve+(en+"=redacted&")}}else Ve=null;else Ve=he;return"XMLHTTP REQ ("+O+") [attempt "+se+"]: "+v+`
`+A+`
`+Ve})}function fs(u,v,A,O,se,he,Ve){u.info(function(){return"XMLHTTP RESP ("+O+") [ attempt "+se+"]: "+v+`
`+A+`
`+he+" "+Ve})}function F(u,v,A,O){u.info(function(){return"XMLHTTP TEXT ("+v+"): "+L(u,A)+(O?" "+O:"")})}function U(u,v){u.info(function(){return"TIMEOUT: "+v})}oa.prototype.info=function(){};function L(u,v){if(!u.g)return v;if(!v)return null;try{var A=JSON.parse(v);if(A){for(u=0;u<A.length;u++)if(Array.isArray(A[u])){var O=A[u];if(!(2>O.length)){var se=O[1];if(Array.isArray(se)&&!(1>se.length)){var he=se[0];if(he!="noop"&&he!="stop"&&he!="close")for(var Ve=1;Ve<se.length;Ve++)se[Ve]=""}}}}return ae(A)}catch{return v}}var M={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},z={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},V;function le(){}y(le,sa),le.prototype.g=function(){return new XMLHttpRequest},le.prototype.i=function(){return{}},V=new le;function ie(u,v,A,O){this.j=u,this.i=v,this.l=A,this.R=O||1,this.U=new xr(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new oe}function oe(){this.i=null,this.g="",this.h=!1}var te={},ce={};function me(u,v,A){u.L=1,u.v=Ls(hs(v)),u.m=A,u.P=!0,Pe(u,null)}function Pe(u,v){u.F=Date.now(),ze(u),u.A=hs(u.v);var A=u.A,O=u.R;Array.isArray(O)||(O=[String(O)]),$i(A.i,"t",O),u.C=0,A=u.j.J,u.h=new oe,u.g=K0(u.j,A?v:null,!u.m),0<u.O&&(u.M=new ir(p(u.Y,u,u.g),u.O)),v=u.U,A=u.g,O=u.ca;var se="readystatechange";Array.isArray(se)||(se&&(ur[0]=se.toString()),se=ur);for(var he=0;he<se.length;he++){var Ve=dt(A,se[he],O||v.handleEvent,!1,v.h||v);if(!Ve)break;v.g[Ve.key]=Ve}v=u.H?C(u.H):{},u.m?(u.u||(u.u="POST"),v["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.A,u.u,u.m,v)):(u.u="GET",u.g.ea(u.A,u.u,null,v)),Ms(),$l(u.i,u.u,u.A,u.l,u.R,u.m)}ie.prototype.ca=function(u){u=u.target;const v=this.M;v&&Ft(u)==3?v.j():this.Y(u)},ie.prototype.Y=function(u){try{if(u==this.g)e:{const tn=Ft(this.g);var v=this.g.Ba();const Ga=this.g.Z();if(!(3>tn)&&(tn!=3||this.g&&(this.h.h||this.g.oa()||Rn(this.g)))){this.J||tn!=4||v==7||(v==8||0>=Ga?Ms(3):Ms(2)),_t(this);var A=this.g.Z();this.X=A;t:if(He(this)){var O=Rn(this.g);u="";var se=O.length,he=Ft(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Et(this),kt(this);var Ve="";break t}this.h.i=new o.TextDecoder}for(v=0;v<se;v++)this.h.h=!0,u+=this.h.i.decode(O[v],{stream:!(he&&v==se-1)});O.length=0,this.h.g+=u,this.C=0,Ve=this.h.g}else Ve=this.g.oa();if(this.o=A==200,fs(this.i,this.u,this.A,this.l,this.R,tn,A),this.o){if(this.T&&!this.K){t:{if(this.g){var Wt,Hr=this.g;if((Wt=Hr.g?Hr.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!k(Wt)){var It=Wt;break t}}It=null}if(A=It)F(this.i,this.l,A,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Jn(this,A);else{this.o=!1,this.s=3,fr(12),Et(this),kt(this);break e}}if(this.P){A=!0;let di;for(;!this.J&&this.C<Ve.length;)if(di=Ce(this,Ve),di==ce){tn==4&&(this.s=4,fr(14),A=!1),F(this.i,this.l,null,"[Incomplete Response]");break}else if(di==te){this.s=4,fr(15),F(this.i,this.l,Ve,"[Invalid Chunk]"),A=!1;break}else F(this.i,this.l,di,null),Jn(this,di);if(He(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),tn!=4||Ve.length!=0||this.h.h||(this.s=1,fr(16),A=!1),this.o=this.o&&A,!A)F(this.i,this.l,Ve,"[Invalid Chunked Response]"),Et(this),kt(this);else if(0<Ve.length&&!this.W){this.W=!0;var en=this.j;en.g==this&&en.ba&&!en.M&&(en.j.info("Great, no buffering proxy detected. Bytes received: "+Ve.length),Jl(en),en.M=!0,fr(11))}}else F(this.i,this.l,Ve,null),Jn(this,Ve);tn==4&&Et(this),this.o&&!this.J&&(tn==4?W0(this.j,this):(this.o=!1,ze(this)))}else Xo(this.g),A==400&&0<Ve.indexOf("Unknown SID")?(this.s=3,fr(12)):(this.s=0,fr(13)),Et(this),kt(this)}}}catch{}finally{}};function He(u){return u.g?u.u=="GET"&&u.L!=2&&u.j.Ca:!1}function Ce(u,v){var A=u.C,O=v.indexOf(`
`,A);return O==-1?ce:(A=Number(v.substring(A,O)),isNaN(A)?te:(O+=1,O+A>v.length?ce:(v=v.slice(O,O+A),u.C=O+A,v)))}ie.prototype.cancel=function(){this.J=!0,Et(this)};function ze(u){u.S=Date.now()+u.I,nt(u,u.I)}function nt(u,v){if(u.B!=null)throw Error("WatchDog timer not null");u.B=dn(p(u.ba,u),v)}function _t(u){u.B&&(o.clearTimeout(u.B),u.B=null)}ie.prototype.ba=function(){this.B=null;const u=Date.now();0<=u-this.S?(U(this.i,this.A),this.L!=2&&(Ms(),fr(17)),Et(this),this.s=2,kt(this)):nt(this,this.S-u)};function kt(u){u.j.G==0||u.J||W0(u.j,u)}function Et(u){_t(u);var v=u.M;v&&typeof v.ma=="function"&&v.ma(),u.M=null,Fn(u.U),u.g&&(v=u.g,u.g=null,v.abort(),v.ma())}function Jn(u,v){try{var A=u.j;if(A.G!=0&&(A.g==u||gn(A.h,u))){if(!u.K&&gn(A.h,u)&&A.G==3){try{var O=A.Da.g.parse(v)}catch{O=null}if(Array.isArray(O)&&O.length==3){var se=O;if(se[0]==0){e:if(!A.u){if(A.g)if(A.g.F+3e3<u.F)Qo(A),Xi(A);else break e;ku(A),fr(18)}}else A.za=se[1],0<A.za-A.T&&37500>se[2]&&A.F&&A.v==0&&!A.C&&(A.C=dn(p(A.Za,A),6e3));if(1>=ki(A.h)&&A.ca){try{A.ca()}catch{}A.ca=void 0}}else ys(A,11)}else if((u.K||A.g==u)&&Qo(A),!k(v))for(se=A.Da.g.parse(v),v=0;v<se.length;v++){let It=se[v];if(A.T=It[0],It=It[1],A.G==2)if(It[0]=="c"){A.K=It[1],A.ia=It[2];const en=It[3];en!=null&&(A.la=en,A.j.info("VER="+A.la));const tn=It[4];tn!=null&&(A.Aa=tn,A.j.info("SVER="+A.Aa));const Ga=It[5];Ga!=null&&typeof Ga=="number"&&0<Ga&&(O=1.5*Ga,A.L=O,A.j.info("backChannelRequestTimeoutMs_="+O)),O=A;const di=u.g;if(di){const ec=di.g?di.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ec){var he=O.h;he.g||ec.indexOf("spdy")==-1&&ec.indexOf("quic")==-1&&ec.indexOf("h2")==-1||(he.j=he.l,he.g=new Set,he.h&&(za(he,he.h),he.h=null))}if(O.D){const Ka=di.g?di.g.getResponseHeader("X-HTTP-Session-Id"):null;Ka&&(O.ya=Ka,Xe(O.I,O.D,Ka))}}A.G=3,A.l&&A.l.ua(),A.ba&&(A.R=Date.now()-u.F,A.j.info("Handshake RTT: "+A.R+"ms")),O=A;var Ve=u;if(O.qa=G0(O,O.J?O.ia:null,O.W),Ve.K){Zn(O.h,Ve);var Wt=Ve,Hr=O.L;Hr&&(Wt.I=Hr),Wt.B&&(_t(Wt),ze(Wt)),O.g=Ve}else U0(O);0<A.i.length&&$a(A)}else It[0]!="stop"&&It[0]!="close"||ys(A,7);else A.G==3&&(It[0]=="stop"||It[0]=="close"?It[0]=="stop"?ys(A,7):Su(A):It[0]!="noop"&&A.l&&A.l.ta(It),A.v=0)}}Ms(4)}catch{}}var hn=class{constructor(u,v){this.g=u,this.map=v}};function Si(u){this.l=u||10,o.PerformanceNavigationTiming?(u=o.performance.getEntriesByType("navigation"),u=0<u.length&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function pn(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function ki(u){return u.h?1:u.g?u.g.size:0}function gn(u,v){return u.h?u.h==v:u.g?u.g.has(v):!1}function za(u,v){u.g?u.g.add(v):u.h=v}function Zn(u,v){u.h&&u.h==v?u.h=null:u.g&&u.g.has(v)&&u.g.delete(v)}Si.prototype.cancel=function(){if(this.i=Wo(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const u of this.g.values())u.cancel();this.g.clear()}};function Wo(u){if(u.h!=null)return u.i.concat(u.h.D);if(u.g!=null&&u.g.size!==0){let v=u.i;for(const A of u.g.values())v=v.concat(A.D);return v}return x(u.i)}function fi(u){if(u.V&&typeof u.V=="function")return u.V();if(typeof Map<"u"&&u instanceof Map||typeof Set<"u"&&u instanceof Set)return Array.from(u.values());if(typeof u=="string")return u.split("");if(l(u)){for(var v=[],A=u.length,O=0;O<A;O++)v.push(u[O]);return v}v=[],A=0;for(O in u)v[A++]=u[O];return v}function Hl(u){if(u.na&&typeof u.na=="function")return u.na();if(!u.V||typeof u.V!="function"){if(typeof Map<"u"&&u instanceof Map)return Array.from(u.keys());if(!(typeof Set<"u"&&u instanceof Set)){if(l(u)||typeof u=="string"){var v=[];u=u.length;for(var A=0;A<u;A++)v.push(A);return v}v=[],A=0;for(const O in u)v[A++]=O;return v}}}function ds(u,v){if(u.forEach&&typeof u.forEach=="function")u.forEach(v,void 0);else if(l(u)||typeof u=="string")Array.prototype.forEach.call(u,v,void 0);else for(var A=Hl(u),O=fi(u),se=O.length,he=0;he<se;he++)v.call(void 0,O[he],A&&A[he],u)}var Gl=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Zr(u,v){if(u){u=u.split("&");for(var A=0;A<u.length;A++){var O=u[A].indexOf("="),se=null;if(0<=O){var he=u[A].substring(0,O);se=u[A].substring(O+1)}else he=u[A];v(he,se?decodeURIComponent(se.replace(/\+/g," ")):"")}}}function zi(u){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,u instanceof zi){this.h=u.h,la(this,u.j),this.o=u.o,this.g=u.g,$o(this,u.s),this.l=u.l;var v=u.i,A=new ps;A.i=v.i,v.g&&(A.g=new Map(v.g),A.h=v.h),Kl(this,A),this.m=u.m}else u&&(v=String(u).match(Gl))?(this.h=!1,la(this,v[1]||"",!0),this.o=Qt(v[2]||""),this.g=Qt(v[3]||"",!0),$o(this,v[4]),this.l=Qt(v[5]||"",!0),Kl(this,v[6]||"",!0),this.m=Qt(v[7]||"")):(this.h=!1,this.i=new ps(null,this.h))}zi.prototype.toString=function(){var u=[],v=this.j;v&&u.push(Wi(v,vu,!0),":");var A=this.g;return(A||v=="file")&&(u.push("//"),(v=this.o)&&u.push(Wi(v,vu,!0),"@"),u.push(encodeURIComponent(String(A)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),A=this.s,A!=null&&u.push(":",String(A))),(A=this.l)&&(this.g&&A.charAt(0)!="/"&&u.push("/"),u.push(Wi(A,A.charAt(0)=="/"?N0:yu,!0))),(A=this.i.toString())&&u.push("?",A),(A=this.m)&&u.push("#",Wi(A,P0)),u.join("")};function hs(u){return new zi(u)}function la(u,v,A){u.j=A?Qt(v,!0):v,u.j&&(u.j=u.j.replace(/:$/,""))}function $o(u,v){if(v){if(v=Number(v),isNaN(v)||0>v)throw Error("Bad port number "+v);u.s=v}else u.s=null}function Kl(u,v,A){v instanceof ps?(u.i=v,Xl(u.i,u.h)):(A||(v=Wi(v,D0)),u.i=new ps(v,u.h))}function Xe(u,v,A){u.i.set(v,A)}function Ls(u){return Xe(u,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),u}function Qt(u,v){return u?v?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function Wi(u,v,A){return typeof u=="string"?(u=encodeURI(u).replace(v,R0),A&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function R0(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var vu=/[#\/\?@]/g,yu=/[#\?:]/g,N0=/[#\?]/g,D0=/[#\?@]/g,P0=/#/g;function ps(u,v){this.h=this.g=null,this.i=u||null,this.j=!!v}function gs(u){u.g||(u.g=new Map,u.h=0,u.i&&Zr(u.i,function(v,A){u.add(decodeURIComponent(v.replace(/\+/g," ")),A)}))}t=ps.prototype,t.add=function(u,v){gs(this),this.i=null,u=ms(this,u);var A=this.g.get(u);return A||this.g.set(u,A=[]),A.push(v),this.h+=1,this};function _u(u,v){gs(u),v=ms(u,v),u.g.has(v)&&(u.i=null,u.h-=u.g.get(v).length,u.g.delete(v))}function bn(u,v){return gs(u),v=ms(u,v),u.g.has(v)}t.forEach=function(u,v){gs(this),this.g.forEach(function(A,O){A.forEach(function(se){u.call(v,se,O,this)},this)},this)},t.na=function(){gs(this);const u=Array.from(this.g.values()),v=Array.from(this.g.keys()),A=[];for(let O=0;O<v.length;O++){const se=u[O];for(let he=0;he<se.length;he++)A.push(v[O])}return A},t.V=function(u){gs(this);let v=[];if(typeof u=="string")bn(this,u)&&(v=v.concat(this.g.get(ms(this,u))));else{u=Array.from(this.g.values());for(let A=0;A<u.length;A++)v=v.concat(u[A])}return v},t.set=function(u,v){return gs(this),this.i=null,u=ms(this,u),bn(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[v]),this.h+=1,this},t.get=function(u,v){return u?(u=this.V(u),0<u.length?String(u[0]):v):v};function $i(u,v,A){_u(u,v),0<A.length&&(u.i=null,u.g.set(ms(u,v),x(A)),u.h+=A.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const u=[],v=Array.from(this.g.keys());for(var A=0;A<v.length;A++){var O=v[A];const he=encodeURIComponent(String(O)),Ve=this.V(O);for(O=0;O<Ve.length;O++){var se=he;Ve[O]!==""&&(se+="="+encodeURIComponent(String(Ve[O]))),u.push(se)}}return this.i=u.join("&")};function ms(u,v){return v=String(v),u.j&&(v=v.toLowerCase()),v}function Xl(u,v){v&&!u.j&&(gs(u),u.i=null,u.g.forEach(function(A,O){var se=O.toLowerCase();O!=se&&(_u(this,O),$i(this,se,A))},u)),u.j=v}function O0(u,v){const A=new oa;if(o.Image){const O=new Image;O.onload=m(xs,A,"TestLoadImage: loaded",!0,v,O),O.onerror=m(xs,A,"TestLoadImage: error",!1,v,O),O.onabort=m(xs,A,"TestLoadImage: abort",!1,v,O),O.ontimeout=m(xs,A,"TestLoadImage: timeout",!1,v,O),o.setTimeout(function(){O.ontimeout&&O.ontimeout()},1e4),O.src=u}else v(!1)}function ql(u,v){const A=new oa,O=new AbortController,se=setTimeout(()=>{O.abort(),xs(A,"TestPingServer: timeout",!1,v)},1e4);fetch(u,{signal:O.signal}).then(he=>{clearTimeout(se),he.ok?xs(A,"TestPingServer: ok",!0,v):xs(A,"TestPingServer: server error",!1,v)}).catch(()=>{clearTimeout(se),xs(A,"TestPingServer: error",!1,v)})}function xs(u,v,A,O,se){try{se&&(se.onload=null,se.onerror=null,se.onabort=null,se.ontimeout=null),O(A)}catch{}}function Yl(){this.g=new ia}function Ql(u,v,A){const O=A||"";try{ds(u,function(se,he){let Ve=se;c(se)&&(Ve=ae(se)),v.push(O+he+"="+encodeURIComponent(Ve))})}catch(se){throw v.push(O+"type="+encodeURIComponent("_badmap")),se}}function Hi(u){this.l=u.Ub||null,this.j=u.eb||!1}y(Hi,sa),Hi.prototype.g=function(){return new Ho(this.l,this.j)},Hi.prototype.i=function(u){return function(){return u}}({});function Ho(u,v){Mt.call(this),this.D=u,this.o=v,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}y(Ho,Mt),t=Ho.prototype,t.open=function(u,v){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=u,this.A=v,this.readyState=1,vs(this)},t.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const v={headers:this.u,method:this.B,credentials:this.m,cache:void 0};u&&(v.body=u),(this.D||o).fetch(new Request(this.A,v)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Go(this)),this.readyState=0},t.Sa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,vs(this)),this.g&&(this.readyState=3,vs(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Eu(this)}else u.text().then(this.Ra.bind(this),this.ga.bind(this))};function Eu(u){u.j.read().then(u.Pa.bind(u)).catch(u.ga.bind(u))}t.Pa=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var v=u.value?u.value:new Uint8Array(0);(v=this.v.decode(v,{stream:!u.done}))&&(this.response=this.responseText+=v)}u.done?Go(this):vs(this),this.readyState==3&&Eu(this)}},t.Ra=function(u){this.g&&(this.response=this.responseText=u,Go(this))},t.Qa=function(u){this.g&&(this.response=u,Go(this))},t.ga=function(){this.g&&Go(this)};function Go(u){u.readyState=4,u.l=null,u.j=null,u.v=null,vs(u)}t.setRequestHeader=function(u,v){this.u.append(u,v)},t.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const u=[],v=this.h.entries();for(var A=v.next();!A.done;)A=A.value,u.push(A[0]+": "+A[1]),A=v.next();return u.join(`\r
`)};function vs(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(Ho.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function wu(u){let v="";return B(u,function(A,O){v+=O,v+=":",v+=A,v+=`\r
`}),v}function Gi(u,v,A){e:{for(O in A){var O=!1;break e}O=!0}O||(A=wu(A),typeof u=="string"?A!=null&&encodeURIComponent(String(A)):Xe(u,v,A))}function dr(u){Mt.call(this),this.headers=new Map,this.o=u||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}y(dr,Mt);var Gp=/^https?$/i,Kp=["POST","PUT"];t=dr.prototype,t.Ha=function(u){this.J=u},t.ea=function(u,v,A,O){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);v=v?v.toUpperCase():"GET",this.D=u,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():V.g(),this.v=this.o?Os(this.o):Os(V),this.g.onreadystatechange=p(this.Ea,this);try{this.B=!0,this.g.open(v,String(u),!0),this.B=!1}catch(he){Ko(this,he);return}if(u=A||"",A=new Map(this.headers),O)if(Object.getPrototypeOf(O)===Object.prototype)for(var se in O)A.set(se,O[se]);else if(typeof O.keys=="function"&&typeof O.get=="function")for(const he of O.keys())A.set(he,O.get(he));else throw Error("Unknown input type for opt_headers: "+String(O));O=Array.from(A.keys()).find(he=>he.toLowerCase()=="content-type"),se=o.FormData&&u instanceof o.FormData,!(0<=Array.prototype.indexOf.call(Kp,v,void 0))||O||se||A.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[he,Ve]of A)this.g.setRequestHeader(he,Ve);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{M0(this),this.u=!0,this.g.send(u),this.u=!1}catch(he){Ko(this,he)}};function Ko(u,v){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=v,u.m=5,Ki(u),Wa(u)}function Ki(u){u.A||(u.A=!0,mr(u,"complete"),mr(u,"error"))}t.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=u||7,mr(this,"complete"),mr(this,"abort"),Wa(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Wa(this,!0)),dr.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Tu(this):this.bb())},t.bb=function(){Tu(this)};function Tu(u){if(u.h&&typeof a<"u"&&(!u.v[1]||Ft(u)!=4||u.Z()!=2)){if(u.u&&Ft(u)==4)Qn(u.Ea,0,u);else if(mr(u,"readystatechange"),Ft(u)==4){u.h=!1;try{const Ve=u.Z();e:switch(Ve){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var v=!0;break e;default:v=!1}var A;if(!(A=v)){var O;if(O=Ve===0){var se=String(u.D).match(Gl)[1]||null;!se&&o.self&&o.self.location&&(se=o.self.location.protocol.slice(0,-1)),O=!Gp.test(se?se.toLowerCase():"")}A=O}if(A)mr(u,"complete"),mr(u,"success");else{u.m=6;try{var he=2<Ft(u)?u.g.statusText:""}catch{he=""}u.l=he+" ["+u.Z()+"]",Ki(u)}}finally{Wa(u)}}}}function Wa(u,v){if(u.g){M0(u);const A=u.g,O=u.v[0]?()=>{}:null;u.g=null,u.v=null,v||mr(u,"ready");try{A.onreadystatechange=O}catch{}}}function M0(u){u.I&&(o.clearTimeout(u.I),u.I=null)}t.isActive=function(){return!!this.g};function Ft(u){return u.g?u.g.readyState:0}t.Z=function(){try{return 2<Ft(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(u){if(this.g){var v=this.g.responseText;return u&&v.indexOf(u)==0&&(v=v.substring(u.length)),Br(v)}};function Rn(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.H){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function Xo(u){const v={};u=(u.g&&2<=Ft(u)&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let O=0;O<u.length;O++){if(k(u[O]))continue;var A=N(u[O]);const se=A[0];if(A=A[1],typeof A!="string")continue;A=A.trim();const he=v[se]||[];v[se]=he,he.push(A)}w(v,function(O){return O.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function ca(u,v,A){return A&&A.internalChannelParams&&A.internalChannelParams[u]||v}function L0(u){this.Aa=0,this.i=[],this.j=new oa,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=ca("failFast",!1,u),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=ca("baseRetryDelayMs",5e3,u),this.cb=ca("retryDelaySeedMs",1e4,u),this.Wa=ca("forwardChannelMaxRetries",2,u),this.wa=ca("forwardChannelRequestTimeoutMs",2e4,u),this.pa=u&&u.xmlHttpFactory||void 0,this.Xa=u&&u.Tb||void 0,this.Ca=u&&u.useFetchStreams||!1,this.L=void 0,this.J=u&&u.supportsCrossDomainXhr||!1,this.K="",this.h=new Si(u&&u.concurrentRequestLimit),this.Da=new Yl,this.P=u&&u.fastHandshake||!1,this.O=u&&u.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=u&&u.Rb||!1,u&&u.xa&&this.j.xa(),u&&u.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&u&&u.detectBufferingProxy||!1,this.ja=void 0,u&&u.longPollingTimeout&&0<u.longPollingTimeout&&(this.ja=u.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=L0.prototype,t.la=8,t.G=1,t.connect=function(u,v,A,O){fr(0),this.W=u,this.H=v||{},A&&O!==void 0&&(this.H.OSID=A,this.H.OAID=O),this.F=this.X,this.I=G0(this,null,this.W),$a(this)};function Su(u){if(B0(u),u.G==3){var v=u.U++,A=hs(u.I);if(Xe(A,"SID",u.K),Xe(A,"RID",v),Xe(A,"TYPE","terminate"),Yo(u,A),v=new ie(u,u.j,v),v.L=2,v.v=Ls(hs(A)),A=!1,o.navigator&&o.navigator.sendBeacon)try{A=o.navigator.sendBeacon(v.v.toString(),"")}catch{}!A&&o.Image&&(new Image().src=v.v,A=!0),A||(v.g=K0(v.j,null),v.g.ea(v.v)),v.F=Date.now(),ze(v)}H0(u)}function Xi(u){u.g&&(Jl(u),u.g.cancel(),u.g=null)}function B0(u){Xi(u),u.u&&(o.clearTimeout(u.u),u.u=null),Qo(u),u.h.cancel(),u.s&&(typeof u.s=="number"&&o.clearTimeout(u.s),u.s=null)}function $a(u){if(!pn(u.h)&&!u.s){u.s=!0;var v=u.Ga;Ee||ke(),xe||(Ee(),xe=!0),J.add(v,u),u.B=0}}function qo(u,v){return ki(u.h)>=u.h.j-(u.s?1:0)?!1:u.s?(u.i=v.D.concat(u.i),!0):u.G==1||u.G==2||u.B>=(u.Va?0:u.Wa)?!1:(u.s=dn(p(u.Ga,u,v),$0(u,u.B)),u.B++,!0)}t.Ga=function(u){if(this.s)if(this.s=null,this.G==1){if(!u){this.U=Math.floor(1e5*Math.random()),u=this.U++;const se=new ie(this,this.j,u);let he=this.o;if(this.S&&(he?(he=C(he),b(he,this.S)):he=this.S),this.m!==null||this.O||(se.H=he,he=null),this.P)e:{for(var v=0,A=0;A<this.i.length;A++){t:{var O=this.i[A];if("__data__"in O.map&&(O=O.map.__data__,typeof O=="string")){O=O.length;break t}O=void 0}if(O===void 0)break;if(v+=O,4096<v){v=A;break e}if(v===4096||A===this.i.length-1){v=A+1;break e}}v=1e3}else v=1e3;v=V0(this,se,v),A=hs(this.I),Xe(A,"RID",u),Xe(A,"CVER",22),this.D&&Xe(A,"X-HTTP-Session-Id",this.D),Yo(this,A),he&&(this.O?v="headers="+encodeURIComponent(String(wu(he)))+"&"+v:this.m&&Gi(A,this.m,he)),za(this.h,se),this.Ua&&Xe(A,"TYPE","init"),this.P?(Xe(A,"$req",v),Xe(A,"SID","null"),se.T=!0,me(se,A,null)):me(se,A,v),this.G=2}}else this.G==3&&(u?j0(this,u):this.i.length==0||pn(this.h)||j0(this))};function j0(u,v){var A;v?A=v.l:A=u.U++;const O=hs(u.I);Xe(O,"SID",u.K),Xe(O,"RID",A),Xe(O,"AID",u.T),Yo(u,O),u.m&&u.o&&Gi(O,u.m,u.o),A=new ie(u,u.j,A,u.B+1),u.m===null&&(A.H=u.o),v&&(u.i=v.D.concat(u.i)),v=V0(u,A,1e3),A.I=Math.round(.5*u.wa)+Math.round(.5*u.wa*Math.random()),za(u.h,A),me(A,O,v)}function Yo(u,v){u.H&&B(u.H,function(A,O){Xe(v,O,A)}),u.l&&ds({},function(A,O){Xe(v,O,A)})}function V0(u,v,A){A=Math.min(u.i.length,A);var O=u.l?p(u.l.Na,u.l,u):null;e:{var se=u.i;let he=-1;for(;;){const Ve=["count="+A];he==-1?0<A?(he=se[0].g,Ve.push("ofs="+he)):he=0:Ve.push("ofs="+he);let Wt=!0;for(let Hr=0;Hr<A;Hr++){let It=se[Hr].g;const en=se[Hr].map;if(It-=he,0>It)he=Math.max(0,se[Hr].g-100),Wt=!1;else try{Ql(en,Ve,"req"+It+"_")}catch{O&&O(en)}}if(Wt){O=Ve.join("&");break e}}}return u=u.i.splice(0,A),v.D=u,O}function U0(u){if(!u.g&&!u.u){u.Y=1;var v=u.Fa;Ee||ke(),xe||(Ee(),xe=!0),J.add(v,u),u.v=0}}function ku(u){return u.g||u.u||3<=u.v?!1:(u.Y++,u.u=dn(p(u.Fa,u),$0(u,u.v)),u.v++,!0)}t.Fa=function(){if(this.u=null,z0(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var u=2*this.R;this.j.info("BP detection timer enabled: "+u),this.A=dn(p(this.ab,this),u)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,fr(10),Xi(this),z0(this))};function Jl(u){u.A!=null&&(o.clearTimeout(u.A),u.A=null)}function z0(u){u.g=new ie(u,u.j,"rpc",u.Y),u.m===null&&(u.g.H=u.o),u.g.O=0;var v=hs(u.qa);Xe(v,"RID","rpc"),Xe(v,"SID",u.K),Xe(v,"AID",u.T),Xe(v,"CI",u.F?"0":"1"),!u.F&&u.ja&&Xe(v,"TO",u.ja),Xe(v,"TYPE","xmlhttp"),Yo(u,v),u.m&&u.o&&Gi(v,u.m,u.o),u.L&&(u.g.I=u.L);var A=u.g;u=u.ia,A.L=1,A.v=Ls(hs(v)),A.m=null,A.P=!0,Pe(A,u)}t.Za=function(){this.C!=null&&(this.C=null,Xi(this),ku(this),fr(19))};function Qo(u){u.C!=null&&(o.clearTimeout(u.C),u.C=null)}function W0(u,v){var A=null;if(u.g==v){Qo(u),Jl(u),u.g=null;var O=2}else if(gn(u.h,v))A=v.D,Zn(u.h,v),O=1;else return;if(u.G!=0){if(v.o)if(O==1){A=v.m?v.m.length:0,v=Date.now()-v.F;var se=u.B;O=Ua(),mr(O,new Ti(O,A)),$a(u)}else U0(u);else if(se=v.s,se==3||se==0&&0<v.X||!(O==1&&qo(u,v)||O==2&&ku(u)))switch(A&&0<A.length&&(v=u.h,v.i=v.i.concat(A)),se){case 1:ys(u,5);break;case 4:ys(u,10);break;case 3:ys(u,6);break;default:ys(u,2)}}}function $0(u,v){let A=u.Ta+Math.floor(Math.random()*u.cb);return u.isActive()||(A*=2),A*v}function ys(u,v){if(u.j.info("Error code "+v),v==2){var A=p(u.fb,u),O=u.Xa;const se=!O;O=new zi(O||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||la(O,"https"),Ls(O),se?O0(O.toString(),A):ql(O.toString(),A)}else fr(2);u.G=0,u.l&&u.l.sa(v),H0(u),B0(u)}t.fb=function(u){u?(this.j.info("Successfully pinged google.com"),fr(2)):(this.j.info("Failed to ping google.com"),fr(1))};function H0(u){if(u.G=0,u.ka=[],u.l){const v=Wo(u.h);(v.length!=0||u.i.length!=0)&&(E(u.ka,v),E(u.ka,u.i),u.h.i.length=0,x(u.i),u.i.length=0),u.l.ra()}}function G0(u,v,A){var O=A instanceof zi?hs(A):new zi(A);if(O.g!="")v&&(O.g=v+"."+O.g),$o(O,O.s);else{var se=o.location;O=se.protocol,v=v?v+"."+se.hostname:se.hostname,se=+se.port;var he=new zi(null);O&&la(he,O),v&&(he.g=v),se&&$o(he,se),A&&(he.l=A),O=he}return A=u.D,v=u.ya,A&&v&&Xe(O,A,v),Xe(O,"VER",u.la),Yo(u,O),O}function K0(u,v,A){if(v&&!u.J)throw Error("Can't create secondary domain capable XhrIo object.");return v=u.Ca&&!u.pa?new dr(new Hi({eb:A})):new dr(u.pa),v.Ha(u.J),v}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function X0(){}t=X0.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Zl(){}Zl.prototype.g=function(u,v){return new ei(u,v)};function ei(u,v){Mt.call(this),this.g=new L0(v),this.l=u,this.h=v&&v.messageUrlParams||null,u=v&&v.messageHeaders||null,v&&v.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=v&&v.initMessageHeaders||null,v&&v.messageContentType&&(u?u["X-WebChannel-Content-Type"]=v.messageContentType:u={"X-WebChannel-Content-Type":v.messageContentType}),v&&v.va&&(u?u["X-WebChannel-Client-Profile"]=v.va:u={"X-WebChannel-Client-Profile":v.va}),this.g.S=u,(u=v&&v.Sb)&&!k(u)&&(this.g.m=u),this.v=v&&v.supportsCrossDomainXhr||!1,this.u=v&&v.sendRawJson||!1,(v=v&&v.httpSessionIdParam)&&!k(v)&&(this.g.D=v,u=this.h,u!==null&&v in u&&(u=this.h,v in u&&delete u[v])),this.j=new Ha(this)}y(ei,Mt),ei.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},ei.prototype.close=function(){Su(this.g)},ei.prototype.o=function(u){var v=this.g;if(typeof u=="string"){var A={};A.__data__=u,u=A}else this.u&&(A={},A.__data__=ae(u),u=A);v.i.push(new hn(v.Ya++,u)),v.G==3&&$a(v)},ei.prototype.N=function(){this.g.l=null,delete this.j,Su(this.g),delete this.g,ei.aa.N.call(this)};function q0(u){Vi.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var v=u.__sm__;if(v){e:{for(const A in v){u=A;break e}u=void 0}(this.i=u)&&(u=this.i,v=v!==null&&u in v?v[u]:void 0),this.data=v}else this.data=u}y(q0,Vi);function Y0(){vr.call(this),this.status=1}y(Y0,vr);function Ha(u){this.g=u}y(Ha,X0),Ha.prototype.ua=function(){mr(this.g,"a")},Ha.prototype.ta=function(u){mr(this.g,new q0(u))},Ha.prototype.sa=function(u){mr(this.g,new Y0)},Ha.prototype.ra=function(){mr(this.g,"b")},Zl.prototype.createWebChannel=Zl.prototype.g,ei.prototype.send=ei.prototype.o,ei.prototype.open=ei.prototype.m,ei.prototype.close=ei.prototype.close,PA=function(){return new Zl},DA=function(){return Ua()},NA=Ui,lx={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},M.NO_ERROR=0,M.TIMEOUT=8,M.HTTP_ERROR=6,Qd=M,z.COMPLETE="complete",RA=z,aa.EventType=wi,wi.OPEN="a",wi.CLOSE="b",wi.ERROR="c",wi.MESSAGE="d",Mt.prototype.listen=Mt.prototype.K,Ku=aa,dr.prototype.listenOnce=dr.prototype.L,dr.prototype.getLastError=dr.prototype.Ka,dr.prototype.getLastErrorCode=dr.prototype.Ba,dr.prototype.getStatus=dr.prototype.Z,dr.prototype.getResponseJson=dr.prototype.Oa,dr.prototype.getResponseText=dr.prototype.oa,dr.prototype.send=dr.prototype.ea,dr.prototype.setWithCredentials=dr.prototype.Ha,bA=dr}).apply(typeof Nd<"u"?Nd:typeof self<"u"?self:typeof window<"u"?window:{});const Y2="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Vn.UNAUTHENTICATED=new Vn(null),Vn.GOOGLE_CREDENTIALS=new Vn("google-credentials-uid"),Vn.FIRST_PARTY=new Vn("first-party-uid"),Vn.MOCK_USER=new Vn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let hu="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bl=new ov("@firebase/firestore");function ju(){return bl.logLevel}function Je(t,...e){if(bl.logLevel<=Ct.DEBUG){const r=e.map(uv);bl.debug(`Firestore (${hu}): ${t}`,...r)}}function Ra(t,...e){if(bl.logLevel<=Ct.ERROR){const r=e.map(uv);bl.error(`Firestore (${hu}): ${t}`,...r)}}function Qc(t,...e){if(bl.logLevel<=Ct.WARN){const r=e.map(uv);bl.warn(`Firestore (${hu}): ${t}`,...r)}}function uv(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ft(t="Unexpected state"){const e=`FIRESTORE (${hu}) INTERNAL ASSERTION FAILED: `+t;throw Ra(e),new Error(e)}function Yt(t,e){t||ft()}function pt(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Re={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class et extends ja{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ao{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OA{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Ej{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(Vn.UNAUTHENTICATED))}shutdown(){}}class wj{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class Tj{constructor(e){this.t=e,this.currentUser=Vn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){Yt(this.o===void 0);let n=this.i;const i=l=>this.i!==n?(n=this.i,r(l)):Promise.resolve();let s=new Ao;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Ao,e.enqueueRetryable(()=>i(this.currentUser))};const a=()=>{const l=s;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},o=l=>{Je("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(l=>o(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?o(l):(Je("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Ao)}},0),a()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(Je("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Yt(typeof n.accessToken=="string"),new OA(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Yt(e===null||typeof e=="string"),new Vn(e)}}class Sj{constructor(e,r,n){this.l=e,this.h=r,this.P=n,this.type="FirstParty",this.user=Vn.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class kj{constructor(e,r,n){this.l=e,this.h=r,this.P=n}getToken(){return Promise.resolve(new Sj(this.l,this.h,this.P))}start(e,r){e.enqueueRetryable(()=>r(Vn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Aj{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Cj{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,r){Yt(this.o===void 0);const n=s=>{s.error!=null&&Je("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const a=s.token!==this.R;return this.R=s.token,Je("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?r(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>n(s))};const i=s=>{Je("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):Je("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(Yt(typeof r.token=="string"),this.R=r.token,new Aj(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fj(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MA{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=Math.floor(256/e.length)*e.length;let n="";for(;n.length<20;){const i=Fj(40);for(let s=0;s<i.length;++s)n.length<20&&i[s]<r&&(n+=e.charAt(i[s]%e.length))}return n}}function jt(t,e){return t<e?-1:t>e?1:0}function Jc(t,e,r){return t.length===e.length&&t.every((n,i)=>r(n,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qr{constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new et(Re.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new et(Re.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<-62135596800)throw new et(Re.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new et(Re.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Qr.fromMillis(Date.now())}static fromDate(e){return Qr.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*r));return new Qr(r,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?jt(this.nanoseconds,e.nanoseconds):jt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ht{constructor(e){this.timestamp=e}static fromTimestamp(e){return new ht(e)}static min(){return new ht(new Qr(0,0))}static max(){return new ht(new Qr(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jf{constructor(e,r,n){r===void 0?r=0:r>e.length&&ft(),n===void 0?n=e.length-r:n>e.length-r&&ft(),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return Jf.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof Jf?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let i=0;i<n;i++){const s=e.get(i),a=r.get(i);if(s<a)return-1;if(s>a)return 1}return e.length<r.length?-1:e.length>r.length?1:0}}class br extends Jf{construct(e,r,n){return new br(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new et(Re.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(i=>i.length>0))}return new br(r)}static emptyPath(){return new br([])}}const Ij=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Tn extends Jf{construct(e,r,n){return new Tn(e,r,n)}static isValidIdentifier(e){return Ij.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Tn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Tn(["__name__"])}static fromServerFormat(e){const r=[];let n="",i=0;const s=()=>{if(n.length===0)throw new et(Re.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let a=!1;for(;i<e.length;){const o=e[i];if(o==="\\"){if(i+1===e.length)throw new et(Re.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new et(Re.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=l,i+=2}else o==="`"?(a=!a,i++):o!=="."||a?(n+=o,i++):(s(),i++)}if(s(),a)throw new et(Re.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Tn(r)}static emptyPath(){return new Tn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tt{constructor(e){this.path=e}static fromPath(e){return new tt(br.fromString(e))}static fromName(e){return new tt(br.fromString(e).popFirst(5))}static empty(){return new tt(br.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&br.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return br.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new tt(new br(e.slice()))}}function bj(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,i=ht.fromTimestamp(n===1e9?new Qr(r+1,0):new Qr(r,n));return new Po(i,tt.empty(),e)}function Rj(t){return new Po(t.readTime,t.key,-1)}class Po{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new Po(ht.min(),tt.empty(),-1)}static max(){return new Po(ht.max(),tt.empty(),-1)}}function Nj(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=tt.comparator(t.documentKey,e.documentKey),r!==0?r:jt(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dj="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Pj{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function w0(t){if(t.code!==Re.FAILED_PRECONDITION||t.message!==Dj)throw t;Je("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ae{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&ft(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new Ae((n,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(n,i)},this.catchCallback=s=>{this.wrapFailure(r,s).next(n,i)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof Ae?r:Ae.resolve(r)}catch(r){return Ae.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):Ae.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):Ae.reject(r)}static resolve(e){return new Ae((r,n)=>{r(e)})}static reject(e){return new Ae((r,n)=>{n(e)})}static waitFor(e){return new Ae((r,n)=>{let i=0,s=0,a=!1;e.forEach(o=>{++i,o.next(()=>{++s,a&&s===i&&r()},l=>n(l))}),a=!0,s===i&&r()})}static or(e){let r=Ae.resolve(!1);for(const n of e)r=r.next(i=>i?Ae.resolve(i):n());return r}static forEach(e,r){const n=[];return e.forEach((i,s)=>{n.push(r.call(this,i,s))}),this.waitFor(n)}static mapArray(e,r){return new Ae((n,i)=>{const s=e.length,a=new Array(s);let o=0;for(let l=0;l<s;l++){const c=l;r(e[c]).next(d=>{a[c]=d,++o,o===s&&n(a)},d=>i(d))}})}static doWhile(e,r){return new Ae((n,i)=>{const s=()=>{e()===!0?r().next(()=>{s()},i):n()};s()})}}function Oj(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function T0(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fv{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ie(n),this.se=n=>r.writeSequenceNumber(n))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}fv.oe=-1;function Np(t){return t==null}function Gh(t){return t===0&&1/t==-1/0}function Mj(t){return typeof t=="number"&&Number.isInteger(t)&&!Gh(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q2(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function pu(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function LA(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kr{constructor(e,r){this.comparator=e,this.root=r||_n.EMPTY}insert(e,r){return new kr(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,_n.BLACK,null,null))}remove(e){return new kr(this.comparator,this.root.remove(e,this.comparator).copy(null,null,_n.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return r+n.left.size;i<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Dd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Dd(this.root,e,this.comparator,!1)}getReverseIterator(){return new Dd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Dd(this.root,e,this.comparator,!0)}}class Dd{constructor(e,r,n,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=r?n(e.key,r):1,r&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class _n{constructor(e,r,n,i,s){this.key=e,this.value=r,this.color=n??_n.RED,this.left=i??_n.EMPTY,this.right=s??_n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,i,s){return new _n(e??this.key,r??this.value,n??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let i=this;const s=n(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,r,n),null):s===0?i.copy(null,r,null,null,null):i.copy(null,null,null,null,i.right.insert(e,r,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return _n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,i=this;if(r(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,r),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),r(e,i.key)===0){if(i.right.isEmpty())return _n.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,r))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,_n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,_n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw ft();const e=this.left.check();if(e!==this.right.check())throw ft();return e+(this.isRed()?0:1)}}_n.EMPTY=null,_n.RED=!0,_n.BLACK=!1;_n.EMPTY=new class{constructor(){this.size=0}get key(){throw ft()}get value(){throw ft()}get color(){throw ft()}get left(){throw ft()}get right(){throw ft()}copy(e,r,n,i,s){return this}insert(e,r,n){return new _n(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kn{constructor(e){this.comparator=e,this.data=new kr(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;r(i.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new J2(this.data.getIterator())}getIteratorFrom(e){return new J2(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof kn)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const i=r.getNext().key,s=n.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new kn(this.comparator);return r.data=e,r}}class J2{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fs{constructor(e){this.fields=e,e.sort(Tn.comparator)}static empty(){return new Fs([])}unionWith(e){let r=new kn(Tn.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new Fs(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return Jc(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BA extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cn{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new BA("Invalid base64 string: "+s):s}}(e);return new Cn(r)}static fromUint8Array(e){const r=function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s}(e);return new Cn(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return jt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Cn.EMPTY_BYTE_STRING=new Cn("");const Lj=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Oo(t){if(Yt(!!t),typeof t=="string"){let e=0;const r=Lj.exec(t);if(Yt(!!r),r[1]){let i=r[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Pr(t.seconds),nanos:Pr(t.nanos)}}function Pr(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Rl(t){return typeof t=="string"?Cn.fromBase64String(t):Cn.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dv(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="server_timestamp"}function hv(t){const e=t.mapValue.fields.__previous_value__;return dv(e)?hv(e):e}function Zf(t){const e=Oo(t.mapValue.fields.__local_write_time__.timestampValue);return new Qr(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bj{constructor(e,r,n,i,s,a,o,l,c){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=o,this.longPollingOptions=l,this.useFetchStreams=c}}class e0{constructor(e,r){this.projectId=e,this.database=r||"(default)"}static empty(){return new e0("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof e0&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pd={mapValue:{}};function Nl(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?dv(t)?4:Vj(t)?9007199254740991:jj(t)?10:11:ft()}function ea(t,e){if(t===e)return!0;const r=Nl(t);if(r!==Nl(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Zf(t).isEqual(Zf(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const a=Oo(i.timestampValue),o=Oo(s.timestampValue);return a.seconds===o.seconds&&a.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return Rl(i.bytesValue).isEqual(Rl(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return Pr(i.geoPointValue.latitude)===Pr(s.geoPointValue.latitude)&&Pr(i.geoPointValue.longitude)===Pr(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return Pr(i.integerValue)===Pr(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const a=Pr(i.doubleValue),o=Pr(s.doubleValue);return a===o?Gh(a)===Gh(o):isNaN(a)&&isNaN(o)}return!1}(t,e);case 9:return Jc(t.arrayValue.values||[],e.arrayValue.values||[],ea);case 10:case 11:return function(i,s){const a=i.mapValue.fields||{},o=s.mapValue.fields||{};if(Q2(a)!==Q2(o))return!1;for(const l in a)if(a.hasOwnProperty(l)&&(o[l]===void 0||!ea(a[l],o[l])))return!1;return!0}(t,e);default:return ft()}}function t0(t,e){return(t.values||[]).find(r=>ea(r,e))!==void 0}function Zc(t,e){if(t===e)return 0;const r=Nl(t),n=Nl(e);if(r!==n)return jt(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return jt(t.booleanValue,e.booleanValue);case 2:return function(s,a){const o=Pr(s.integerValue||s.doubleValue),l=Pr(a.integerValue||a.doubleValue);return o<l?-1:o>l?1:o===l?0:isNaN(o)?isNaN(l)?0:-1:1}(t,e);case 3:return Z2(t.timestampValue,e.timestampValue);case 4:return Z2(Zf(t),Zf(e));case 5:return jt(t.stringValue,e.stringValue);case 6:return function(s,a){const o=Rl(s),l=Rl(a);return o.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(s,a){const o=s.split("/"),l=a.split("/");for(let c=0;c<o.length&&c<l.length;c++){const d=jt(o[c],l[c]);if(d!==0)return d}return jt(o.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,a){const o=jt(Pr(s.latitude),Pr(a.latitude));return o!==0?o:jt(Pr(s.longitude),Pr(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return eE(t.arrayValue,e.arrayValue);case 10:return function(s,a){var o,l,c,d;const h=s.fields||{},p=a.fields||{},m=(o=h.value)===null||o===void 0?void 0:o.arrayValue,y=(l=p.value)===null||l===void 0?void 0:l.arrayValue,x=jt(((c=m==null?void 0:m.values)===null||c===void 0?void 0:c.length)||0,((d=y==null?void 0:y.values)===null||d===void 0?void 0:d.length)||0);return x!==0?x:eE(m,y)}(t.mapValue,e.mapValue);case 11:return function(s,a){if(s===Pd.mapValue&&a===Pd.mapValue)return 0;if(s===Pd.mapValue)return 1;if(a===Pd.mapValue)return-1;const o=s.fields||{},l=Object.keys(o),c=a.fields||{},d=Object.keys(c);l.sort(),d.sort();for(let h=0;h<l.length&&h<d.length;++h){const p=jt(l[h],d[h]);if(p!==0)return p;const m=Zc(o[l[h]],c[d[h]]);if(m!==0)return m}return jt(l.length,d.length)}(t.mapValue,e.mapValue);default:throw ft()}}function Z2(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return jt(t,e);const r=Oo(t),n=Oo(e),i=jt(r.seconds,n.seconds);return i!==0?i:jt(r.nanos,n.nanos)}function eE(t,e){const r=t.values||[],n=e.values||[];for(let i=0;i<r.length&&i<n.length;++i){const s=Zc(r[i],n[i]);if(s)return s}return jt(r.length,n.length)}function eu(t){return cx(t)}function cx(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=Oo(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return Rl(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return tt.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",i=!0;for(const s of r.values||[])i?i=!1:n+=",",n+=cx(s);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let i="{",s=!0;for(const a of n)s?s=!1:i+=",",i+=`${a}:${cx(r.fields[a])}`;return i+"}"}(t.mapValue):ft()}function ux(t){return!!t&&"integerValue"in t}function pv(t){return!!t&&"arrayValue"in t}function tE(t){return!!t&&"nullValue"in t}function rE(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Jd(t){return!!t&&"mapValue"in t}function jj(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="__vector__"}function gf(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return pu(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=gf(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=gf(t.arrayValue.values[r]);return e}return Object.assign({},t)}function Vj(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ns{constructor(e){this.value=e}static empty(){return new ns({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!Jd(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=gf(r)}setAll(e){let r=Tn.emptyPath(),n={},i=[];e.forEach((a,o)=>{if(!r.isImmediateParentOf(o)){const l=this.getFieldsMap(r);this.applyChanges(l,n,i),n={},i=[],r=o.popLast()}a?n[o.lastSegment()]=gf(a):i.push(o.lastSegment())});const s=this.getFieldsMap(r);this.applyChanges(s,n,i)}delete(e){const r=this.field(e.popLast());Jd(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return ea(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=r.mapValue.fields[e.get(n)];Jd(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=i),r=i}return r.mapValue.fields}applyChanges(e,r,n){pu(r,(i,s)=>e[i]=s);for(const i of n)delete e[i]}clone(){return new ns(gf(this.value))}}function jA(t){const e=[];return pu(t.fields,(r,n)=>{const i=new Tn([r]);if(Jd(n)){const s=jA(n.mapValue).fields;if(s.length===0)e.push(i);else for(const a of s)e.push(i.child(a))}else e.push(i)}),new Fs(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $n{constructor(e,r,n,i,s,a,o){this.key=e,this.documentType=r,this.version=n,this.readTime=i,this.createTime=s,this.data=a,this.documentState=o}static newInvalidDocument(e){return new $n(e,0,ht.min(),ht.min(),ht.min(),ns.empty(),0)}static newFoundDocument(e,r,n,i){return new $n(e,1,r,ht.min(),n,i,0)}static newNoDocument(e,r){return new $n(e,2,r,ht.min(),ht.min(),ns.empty(),0)}static newUnknownDocument(e,r){return new $n(e,3,r,ht.min(),ht.min(),ns.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(ht.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ns.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ns.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ht.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof $n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new $n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kh{constructor(e,r){this.position=e,this.inclusive=r}}function nE(t,e,r){let n=0;for(let i=0;i<t.position.length;i++){const s=e[i],a=t.position[i];if(s.field.isKeyField()?n=tt.comparator(tt.fromName(a.referenceValue),r.key):n=Zc(a,r.data.field(s.field)),s.dir==="desc"&&(n*=-1),n!==0)break}return n}function iE(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!ea(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xh{constructor(e,r="asc"){this.field=e,this.dir=r}}function Uj(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VA{}class qr extends VA{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new Wj(e,r,n):r==="array-contains"?new Gj(e,n):r==="in"?new Kj(e,n):r==="not-in"?new Xj(e,n):r==="array-contains-any"?new qj(e,n):new qr(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new $j(e,n):new Hj(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&this.matchesComparison(Zc(r,this.value)):r!==null&&Nl(this.value)===Nl(r)&&this.matchesComparison(Zc(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ft()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ta extends VA{constructor(e,r){super(),this.filters=e,this.op=r,this.ae=null}static create(e,r){return new ta(e,r)}matches(e){return UA(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function UA(t){return t.op==="and"}function zA(t){return zj(t)&&UA(t)}function zj(t){for(const e of t.filters)if(e instanceof ta)return!1;return!0}function fx(t){if(t instanceof qr)return t.field.canonicalString()+t.op.toString()+eu(t.value);if(zA(t))return t.filters.map(e=>fx(e)).join(",");{const e=t.filters.map(r=>fx(r)).join(",");return`${t.op}(${e})`}}function WA(t,e){return t instanceof qr?function(n,i){return i instanceof qr&&n.op===i.op&&n.field.isEqual(i.field)&&ea(n.value,i.value)}(t,e):t instanceof ta?function(n,i){return i instanceof ta&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((s,a,o)=>s&&WA(a,i.filters[o]),!0):!1}(t,e):void ft()}function $A(t){return t instanceof qr?function(r){return`${r.field.canonicalString()} ${r.op} ${eu(r.value)}`}(t):t instanceof ta?function(r){return r.op.toString()+" {"+r.getFilters().map($A).join(" ,")+"}"}(t):"Filter"}class Wj extends qr{constructor(e,r,n){super(e,r,n),this.key=tt.fromName(n.referenceValue)}matches(e){const r=tt.comparator(e.key,this.key);return this.matchesComparison(r)}}class $j extends qr{constructor(e,r){super(e,"in",r),this.keys=HA("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class Hj extends qr{constructor(e,r){super(e,"not-in",r),this.keys=HA("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function HA(t,e){var r;return(((r=e.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(n=>tt.fromName(n.referenceValue))}class Gj extends qr{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return pv(r)&&t0(r.arrayValue,this.value)}}class Kj extends qr{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&t0(this.value.arrayValue,r)}}class Xj extends qr{constructor(e,r){super(e,"not-in",r)}matches(e){if(t0(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&!t0(this.value.arrayValue,r)}}class qj extends qr{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!pv(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>t0(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yj{constructor(e,r=null,n=[],i=[],s=null,a=null,o=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=i,this.limit=s,this.startAt=a,this.endAt=o,this.ue=null}}function sE(t,e=null,r=[],n=[],i=null,s=null,a=null){return new Yj(t,e,r,n,i,s,a)}function gv(t){const e=pt(t);if(e.ue===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>fx(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(s){return s.field.canonicalString()+s.dir}(n)).join(","),Np(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>eu(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>eu(n)).join(",")),e.ue=r}return e.ue}function mv(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!Uj(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!WA(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!iE(t.startAt,e.startAt)&&iE(t.endAt,e.endAt)}function dx(t){return tt.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dp{constructor(e,r=null,n=[],i=[],s=null,a="F",o=null,l=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=i,this.limit=s,this.limitType=a,this.startAt=o,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function Qj(t,e,r,n,i,s,a,o){return new Dp(t,e,r,n,i,s,a,o)}function Pp(t){return new Dp(t)}function aE(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function Jj(t){return t.collectionGroup!==null}function mf(t){const e=pt(t);if(e.ce===null){e.ce=[];const r=new Set;for(const s of e.explicitOrderBy)e.ce.push(s),r.add(s.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let o=new kn(Tn.comparator);return a.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(o=o.add(c.field))})}),o})(e).forEach(s=>{r.has(s.canonicalString())||s.isKeyField()||e.ce.push(new Xh(s,n))}),r.has(Tn.keyField().canonicalString())||e.ce.push(new Xh(Tn.keyField(),n))}return e.ce}function Ys(t){const e=pt(t);return e.le||(e.le=Zj(e,mf(t))),e.le}function Zj(t,e){if(t.limitType==="F")return sE(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new Xh(i.field,s)});const r=t.endAt?new Kh(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new Kh(t.startAt.position,t.startAt.inclusive):null;return sE(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function hx(t,e,r){return new Dp(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function Op(t,e){return mv(Ys(t),Ys(e))&&t.limitType===e.limitType}function GA(t){return`${gv(Ys(t))}|lt:${t.limitType}`}function lc(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(i=>$A(i)).join(", ")}]`),Np(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(i=>eu(i)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(i=>eu(i)).join(",")),`Target(${n})`}(Ys(t))}; limitType=${t.limitType})`}function Mp(t,e){return e.isFoundDocument()&&function(n,i){const s=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):tt.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)}(t,e)&&function(n,i){for(const s of mf(n))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(n,i){for(const s of n.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(n,i){return!(n.startAt&&!function(a,o,l){const c=nE(a,o,l);return a.inclusive?c<=0:c<0}(n.startAt,mf(n),i)||n.endAt&&!function(a,o,l){const c=nE(a,o,l);return a.inclusive?c>=0:c>0}(n.endAt,mf(n),i))}(t,e)}function e7(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function KA(t){return(e,r)=>{let n=!1;for(const i of mf(t)){const s=t7(i,e,r);if(s!==0)return s;n=n||i.field.isKeyField()}return 0}}function t7(t,e,r){const n=t.field.isKeyField()?tt.comparator(e.key,r.key):function(s,a,o){const l=a.data.field(s),c=o.data.field(s);return l!==null&&c!==null?Zc(l,c):ft()}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return ft()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gu{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[i,s]of n)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,r]);i.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[r]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){pu(this.inner,(r,n)=>{for(const[i,s]of n)e(i,s)})}isEmpty(){return LA(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r7=new kr(tt.comparator);function Na(){return r7}const XA=new kr(tt.comparator);function Xu(...t){let e=XA;for(const r of t)e=e.insert(r.key,r);return e}function qA(t){let e=XA;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function cl(){return xf()}function YA(){return xf()}function xf(){return new gu(t=>t.toString(),(t,e)=>t.isEqual(e))}const n7=new kr(tt.comparator),i7=new kn(tt.comparator);function St(...t){let e=i7;for(const r of t)e=e.add(r);return e}const s7=new kn(jt);function a7(){return s7}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xv(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Gh(e)?"-0":e}}function QA(t){return{integerValue:""+t}}function o7(t,e){return Mj(e)?QA(e):xv(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lp{constructor(){this._=void 0}}function l7(t,e,r){return t instanceof qh?function(i,s){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&dv(s)&&(s=hv(s)),s&&(a.fields.__previous_value__=s),{mapValue:a}}(r,e):t instanceof r0?ZA(t,e):t instanceof n0?eC(t,e):function(i,s){const a=JA(i,s),o=oE(a)+oE(i.Pe);return ux(a)&&ux(i.Pe)?QA(o):xv(i.serializer,o)}(t,e)}function c7(t,e,r){return t instanceof r0?ZA(t,e):t instanceof n0?eC(t,e):r}function JA(t,e){return t instanceof Yh?function(n){return ux(n)||function(s){return!!s&&"doubleValue"in s}(n)}(e)?e:{integerValue:0}:null}class qh extends Lp{}class r0 extends Lp{constructor(e){super(),this.elements=e}}function ZA(t,e){const r=tC(e);for(const n of t.elements)r.some(i=>ea(i,n))||r.push(n);return{arrayValue:{values:r}}}class n0 extends Lp{constructor(e){super(),this.elements=e}}function eC(t,e){let r=tC(e);for(const n of t.elements)r=r.filter(i=>!ea(i,n));return{arrayValue:{values:r}}}class Yh extends Lp{constructor(e,r){super(),this.serializer=e,this.Pe=r}}function oE(t){return Pr(t.integerValue||t.doubleValue)}function tC(t){return pv(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function u7(t,e){return t.field.isEqual(e.field)&&function(n,i){return n instanceof r0&&i instanceof r0||n instanceof n0&&i instanceof n0?Jc(n.elements,i.elements,ea):n instanceof Yh&&i instanceof Yh?ea(n.Pe,i.Pe):n instanceof qh&&i instanceof qh}(t.transform,e.transform)}class f7{constructor(e,r){this.version=e,this.transformResults=r}}class Sa{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new Sa}static exists(e){return new Sa(void 0,e)}static updateTime(e){return new Sa(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Zd(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Bp{}function rC(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new iC(t.key,Sa.none()):new S0(t.key,t.data,Sa.none());{const r=t.data,n=ns.empty();let i=new kn(Tn.comparator);for(let s of e.fields)if(!i.has(s)){let a=r.field(s);a===null&&s.length>1&&(s=s.popLast(),a=r.field(s)),a===null?n.delete(s):n.set(s,a),i=i.add(s)}return new zl(t.key,n,new Fs(i.toArray()),Sa.none())}}function d7(t,e,r){t instanceof S0?function(i,s,a){const o=i.value.clone(),l=cE(i.fieldTransforms,s,a.transformResults);o.setAll(l),s.convertToFoundDocument(a.version,o).setHasCommittedMutations()}(t,e,r):t instanceof zl?function(i,s,a){if(!Zd(i.precondition,s))return void s.convertToUnknownDocument(a.version);const o=cE(i.fieldTransforms,s,a.transformResults),l=s.data;l.setAll(nC(i)),l.setAll(o),s.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(t,e,r):function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,r)}function vf(t,e,r,n){return t instanceof S0?function(s,a,o,l){if(!Zd(s.precondition,a))return o;const c=s.value.clone(),d=uE(s.fieldTransforms,l,a);return c.setAll(d),a.convertToFoundDocument(a.version,c).setHasLocalMutations(),null}(t,e,r,n):t instanceof zl?function(s,a,o,l){if(!Zd(s.precondition,a))return o;const c=uE(s.fieldTransforms,l,a),d=a.data;return d.setAll(nC(s)),d.setAll(c),a.convertToFoundDocument(a.version,d).setHasLocalMutations(),o===null?null:o.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(h=>h.field))}(t,e,r,n):function(s,a,o){return Zd(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):o}(t,e,r)}function h7(t,e){let r=null;for(const n of t.fieldTransforms){const i=e.data.field(n.field),s=JA(n.transform,i||null);s!=null&&(r===null&&(r=ns.empty()),r.set(n.field,s))}return r||null}function lE(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&Jc(n,i,(s,a)=>u7(s,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class S0 extends Bp{constructor(e,r,n,i=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class zl extends Bp{constructor(e,r,n,i,s=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function nC(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function cE(t,e,r){const n=new Map;Yt(t.length===r.length);for(let i=0;i<r.length;i++){const s=t[i],a=s.transform,o=e.data.field(s.field);n.set(s.field,c7(a,o,r[i]))}return n}function uE(t,e,r){const n=new Map;for(const i of t){const s=i.transform,a=r.data.field(i.field);n.set(i.field,l7(s,a,e))}return n}class iC extends Bp{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class p7 extends Bp{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g7{constructor(e,r,n,i){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&d7(s,e,n[i])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=vf(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=vf(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=YA();return this.mutations.forEach(i=>{const s=e.get(i.key),a=s.overlayedDocument;let o=this.applyToLocalView(a,s.mutatedFields);o=r.has(i.key)?null:o;const l=rC(a,o);l!==null&&n.set(i.key,l),a.isValidDocument()||a.convertToNoDocument(ht.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),St())}isEqual(e){return this.batchId===e.batchId&&Jc(this.mutations,e.mutations,(r,n)=>lE(r,n))&&Jc(this.baseMutations,e.baseMutations,(r,n)=>lE(r,n))}}class vv{constructor(e,r,n,i){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=i}static from(e,r,n){Yt(e.mutations.length===n.length);let i=function(){return n7}();const s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,n[a].version);return new vv(e,r,n,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m7{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x7{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Vr,bt;function v7(t){switch(t){default:return ft();case Re.CANCELLED:case Re.UNKNOWN:case Re.DEADLINE_EXCEEDED:case Re.RESOURCE_EXHAUSTED:case Re.INTERNAL:case Re.UNAVAILABLE:case Re.UNAUTHENTICATED:return!1;case Re.INVALID_ARGUMENT:case Re.NOT_FOUND:case Re.ALREADY_EXISTS:case Re.PERMISSION_DENIED:case Re.FAILED_PRECONDITION:case Re.ABORTED:case Re.OUT_OF_RANGE:case Re.UNIMPLEMENTED:case Re.DATA_LOSS:return!0}}function sC(t){if(t===void 0)return Ra("GRPC error has no .code"),Re.UNKNOWN;switch(t){case Vr.OK:return Re.OK;case Vr.CANCELLED:return Re.CANCELLED;case Vr.UNKNOWN:return Re.UNKNOWN;case Vr.DEADLINE_EXCEEDED:return Re.DEADLINE_EXCEEDED;case Vr.RESOURCE_EXHAUSTED:return Re.RESOURCE_EXHAUSTED;case Vr.INTERNAL:return Re.INTERNAL;case Vr.UNAVAILABLE:return Re.UNAVAILABLE;case Vr.UNAUTHENTICATED:return Re.UNAUTHENTICATED;case Vr.INVALID_ARGUMENT:return Re.INVALID_ARGUMENT;case Vr.NOT_FOUND:return Re.NOT_FOUND;case Vr.ALREADY_EXISTS:return Re.ALREADY_EXISTS;case Vr.PERMISSION_DENIED:return Re.PERMISSION_DENIED;case Vr.FAILED_PRECONDITION:return Re.FAILED_PRECONDITION;case Vr.ABORTED:return Re.ABORTED;case Vr.OUT_OF_RANGE:return Re.OUT_OF_RANGE;case Vr.UNIMPLEMENTED:return Re.UNIMPLEMENTED;case Vr.DATA_LOSS:return Re.DATA_LOSS;default:return ft()}}(bt=Vr||(Vr={}))[bt.OK=0]="OK",bt[bt.CANCELLED=1]="CANCELLED",bt[bt.UNKNOWN=2]="UNKNOWN",bt[bt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",bt[bt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",bt[bt.NOT_FOUND=5]="NOT_FOUND",bt[bt.ALREADY_EXISTS=6]="ALREADY_EXISTS",bt[bt.PERMISSION_DENIED=7]="PERMISSION_DENIED",bt[bt.UNAUTHENTICATED=16]="UNAUTHENTICATED",bt[bt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",bt[bt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",bt[bt.ABORTED=10]="ABORTED",bt[bt.OUT_OF_RANGE=11]="OUT_OF_RANGE",bt[bt.UNIMPLEMENTED=12]="UNIMPLEMENTED",bt[bt.INTERNAL=13]="INTERNAL",bt[bt.UNAVAILABLE=14]="UNAVAILABLE",bt[bt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y7(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _7=new ml([4294967295,4294967295],0);function fE(t){const e=y7().encode(t),r=new IA;return r.update(e),new Uint8Array(r.digest())}function dE(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new ml([r,n],0),new ml([i,s],0)]}class yv{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new qu(`Invalid padding: ${r}`);if(n<0)throw new qu(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new qu(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new qu(`Invalid padding when bitmap length is 0: ${r}`);this.Ie=8*e.length-r,this.Te=ml.fromNumber(this.Ie)}Ee(e,r,n){let i=e.add(r.multiply(ml.fromNumber(n)));return i.compare(_7)===1&&(i=new ml([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const r=fE(e),[n,i]=dE(r);for(let s=0;s<this.hashCount;s++){const a=this.Ee(n,i,s);if(!this.de(a))return!1}return!0}static create(e,r,n){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new yv(s,i,r);return n.forEach(o=>a.insert(o)),a}insert(e){if(this.Ie===0)return;const r=fE(e),[n,i]=dE(r);for(let s=0;s<this.hashCount;s++){const a=this.Ee(n,i,s);this.Ae(a)}}Ae(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class qu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jp{constructor(e,r,n,i,s){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const i=new Map;return i.set(e,k0.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new jp(ht.min(),i,new kr(jt),Na(),St())}}class k0{constructor(e,r,n,i,s){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new k0(n,r,St(),St(),St())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eh{constructor(e,r,n,i){this.Re=e,this.removedTargetIds=r,this.key=n,this.Ve=i}}class aC{constructor(e,r){this.targetId=e,this.me=r}}class oC{constructor(e,r,n=Cn.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=i}}class hE{constructor(){this.fe=0,this.ge=gE(),this.pe=Cn.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=St(),r=St(),n=St();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:r=r.add(i);break;case 1:n=n.add(i);break;default:ft()}}),new k0(this.pe,this.ye,e,r,n)}Ce(){this.we=!1,this.ge=gE()}Fe(e,r){this.we=!0,this.ge=this.ge.insert(e,r)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Yt(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class E7{constructor(e){this.Le=e,this.Be=new Map,this.ke=Na(),this.qe=pE(),this.Qe=new kr(jt)}Ke(e){for(const r of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(r,e.Ve):this.Ue(r,e.key,e.Ve);for(const r of e.removedTargetIds)this.Ue(r,e.key,e.Ve)}We(e){this.forEachTarget(e,r=>{const n=this.Ge(r);switch(e.state){case 0:this.ze(r)&&n.De(e.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(e.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(r);break;case 3:this.ze(r)&&(n.Ne(),n.De(e.resumeToken));break;case 4:this.ze(r)&&(this.je(r),n.De(e.resumeToken));break;default:ft()}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.Be.forEach((n,i)=>{this.ze(i)&&r(i)})}He(e){const r=e.targetId,n=e.me.count,i=this.Je(r);if(i){const s=i.target;if(dx(s))if(n===0){const a=new tt(s.path);this.Ue(r,a,$n.newNoDocument(a,ht.min()))}else Yt(n===1);else{const a=this.Ye(r);if(a!==n){const o=this.Ze(e),l=o?this.Xe(o,e,a):1;if(l!==0){this.je(r);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(r,c)}}}}}Ze(e){const r=e.me.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:s=0}=r;let a,o;try{a=Rl(n).toUint8Array()}catch(l){if(l instanceof BA)return Qc("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{o=new yv(a,i,s)}catch(l){return Qc(l instanceof qu?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return o.Ie===0?null:o}Xe(e,r,n){return r.me.count===n-this.nt(e,r.targetId)?0:2}nt(e,r){const n=this.Le.getRemoteKeysForTarget(r);let i=0;return n.forEach(s=>{const a=this.Le.tt(),o=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(o)||(this.Ue(r,s,null),i++)}),i}rt(e){const r=new Map;this.Be.forEach((s,a)=>{const o=this.Je(a);if(o){if(s.current&&dx(o.target)){const l=new tt(o.target.path);this.ke.get(l)!==null||this.it(a,l)||this.Ue(a,l,$n.newNoDocument(l,e))}s.be&&(r.set(a,s.ve()),s.Ce())}});let n=St();this.qe.forEach((s,a)=>{let o=!0;a.forEachWhile(l=>{const c=this.Je(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)}),o&&(n=n.add(s))}),this.ke.forEach((s,a)=>a.setReadTime(e));const i=new jp(e,r,this.Qe,this.ke,n);return this.ke=Na(),this.qe=pE(),this.Qe=new kr(jt),i}$e(e,r){if(!this.ze(e))return;const n=this.it(e,r.key)?2:0;this.Ge(e).Fe(r.key,n),this.ke=this.ke.insert(r.key,r),this.qe=this.qe.insert(r.key,this.st(r.key).add(e))}Ue(e,r,n){if(!this.ze(e))return;const i=this.Ge(e);this.it(e,r)?i.Fe(r,1):i.Me(r),this.qe=this.qe.insert(r,this.st(r).delete(e)),n&&(this.ke=this.ke.insert(r,n))}removeTarget(e){this.Be.delete(e)}Ye(e){const r=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let r=this.Be.get(e);return r||(r=new hE,this.Be.set(e,r)),r}st(e){let r=this.qe.get(e);return r||(r=new kn(jt),this.qe=this.qe.insert(e,r)),r}ze(e){const r=this.Je(e)!==null;return r||Je("WatchChangeAggregator","Detected inactive target",e),r}Je(e){const r=this.Be.get(e);return r&&r.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new hE),this.Le.getRemoteKeysForTarget(e).forEach(r=>{this.Ue(e,r,null)})}it(e,r){return this.Le.getRemoteKeysForTarget(e).has(r)}}function pE(){return new kr(tt.comparator)}function gE(){return new kr(tt.comparator)}const w7={asc:"ASCENDING",desc:"DESCENDING"},T7={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},S7={and:"AND",or:"OR"};class k7{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function px(t,e){return t.useProto3Json||Np(e)?e:{value:e}}function Qh(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function lC(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function A7(t,e){return Qh(t,e.toTimestamp())}function Qs(t){return Yt(!!t),ht.fromTimestamp(function(r){const n=Oo(r);return new Qr(n.seconds,n.nanos)}(t))}function _v(t,e){return gx(t,e).canonicalString()}function gx(t,e){const r=function(i){return new br(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?r:r.child(e)}function cC(t){const e=br.fromString(t);return Yt(pC(e)),e}function mx(t,e){return _v(t.databaseId,e.path)}function Hg(t,e){const r=cC(e);if(r.get(1)!==t.databaseId.projectId)throw new et(Re.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new et(Re.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new tt(fC(r))}function uC(t,e){return _v(t.databaseId,e)}function C7(t){const e=cC(t);return e.length===4?br.emptyPath():fC(e)}function xx(t){return new br(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function fC(t){return Yt(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function mE(t,e,r){return{name:mx(t,e),fields:r.value.mapValue.fields}}function F7(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:ft()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(c,d){return c.useProto3Json?(Yt(d===void 0||typeof d=="string"),Cn.fromBase64String(d||"")):(Yt(d===void 0||d instanceof Buffer||d instanceof Uint8Array),Cn.fromUint8Array(d||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,o=a&&function(c){const d=c.code===void 0?Re.UNKNOWN:sC(c.code);return new et(d,c.message||"")}(a);r=new oC(n,i,s,o||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const i=Hg(t,n.document.name),s=Qs(n.document.updateTime),a=n.document.createTime?Qs(n.document.createTime):ht.min(),o=new ns({mapValue:{fields:n.document.fields}}),l=$n.newFoundDocument(i,s,a,o),c=n.targetIds||[],d=n.removedTargetIds||[];r=new eh(c,d,l.key,l)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const i=Hg(t,n.document),s=n.readTime?Qs(n.readTime):ht.min(),a=$n.newNoDocument(i,s),o=n.removedTargetIds||[];r=new eh([],o,a.key,a)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const i=Hg(t,n.document),s=n.removedTargetIds||[];r=new eh([],s,i,null)}else{if(!("filter"in e))return ft();{e.filter;const n=e.filter;n.targetId;const{count:i=0,unchangedNames:s}=n,a=new x7(i,s),o=n.targetId;r=new aC(o,a)}}return r}function I7(t,e){let r;if(e instanceof S0)r={update:mE(t,e.key,e.value)};else if(e instanceof iC)r={delete:mx(t,e.key)};else if(e instanceof zl)r={update:mE(t,e.key,e.data),updateMask:B7(e.fieldMask)};else{if(!(e instanceof p7))return ft();r={verify:mx(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(s,a){const o=a.transform;if(o instanceof qh)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof r0)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof n0)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof Yh)return{fieldPath:a.field.canonicalString(),increment:o.Pe};throw ft()}(0,n))),e.precondition.isNone||(r.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:A7(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:ft()}(t,e.precondition)),r}function b7(t,e){return t&&t.length>0?(Yt(e!==void 0),t.map(r=>function(i,s){let a=i.updateTime?Qs(i.updateTime):Qs(s);return a.isEqual(ht.min())&&(a=Qs(s)),new f7(a,i.transformResults||[])}(r,e))):[]}function R7(t,e){return{documents:[uC(t,e.path)]}}function N7(t,e){const r={structuredQuery:{}},n=e.path;let i;e.collectionGroup!==null?(i=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=uC(t,i);const s=function(c){if(c.length!==0)return hC(ta.create(c,"and"))}(e.filters);s&&(r.structuredQuery.where=s);const a=function(c){if(c.length!==0)return c.map(d=>function(p){return{field:cc(p.field),direction:O7(p.dir)}}(d))}(e.orderBy);a&&(r.structuredQuery.orderBy=a);const o=px(t,e.limit);return o!==null&&(r.structuredQuery.limit=o),e.startAt&&(r.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{_t:r,parent:i}}function D7(t){let e=C7(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let i=null;if(n>0){Yt(n===1);const d=r.from[0];d.allDescendants?i=d.collectionId:e=e.child(d.collectionId)}let s=[];r.where&&(s=function(h){const p=dC(h);return p instanceof ta&&zA(p)?p.getFilters():[p]}(r.where));let a=[];r.orderBy&&(a=function(h){return h.map(p=>function(y){return new Xh(uc(y.field),function(E){switch(E){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(y.direction))}(p))}(r.orderBy));let o=null;r.limit&&(o=function(h){let p;return p=typeof h=="object"?h.value:h,Np(p)?null:p}(r.limit));let l=null;r.startAt&&(l=function(h){const p=!!h.before,m=h.values||[];return new Kh(m,p)}(r.startAt));let c=null;return r.endAt&&(c=function(h){const p=!h.before,m=h.values||[];return new Kh(m,p)}(r.endAt)),Qj(e,i,a,s,o,"F",l,c)}function P7(t,e){const r=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ft()}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function dC(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=uc(r.unaryFilter.field);return qr.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=uc(r.unaryFilter.field);return qr.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=uc(r.unaryFilter.field);return qr.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=uc(r.unaryFilter.field);return qr.create(a,"!=",{nullValue:"NULL_VALUE"});default:return ft()}}(t):t.fieldFilter!==void 0?function(r){return qr.create(uc(r.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ft()}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return ta.create(r.compositeFilter.filters.map(n=>dC(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return ft()}}(r.compositeFilter.op))}(t):ft()}function O7(t){return w7[t]}function M7(t){return T7[t]}function L7(t){return S7[t]}function cc(t){return{fieldPath:t.canonicalString()}}function uc(t){return Tn.fromServerFormat(t.fieldPath)}function hC(t){return t instanceof qr?function(r){if(r.op==="=="){if(rE(r.value))return{unaryFilter:{field:cc(r.field),op:"IS_NAN"}};if(tE(r.value))return{unaryFilter:{field:cc(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(rE(r.value))return{unaryFilter:{field:cc(r.field),op:"IS_NOT_NAN"}};if(tE(r.value))return{unaryFilter:{field:cc(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:cc(r.field),op:M7(r.op),value:r.value}}}(t):t instanceof ta?function(r){const n=r.getFilters().map(i=>hC(i));return n.length===1?n[0]:{compositeFilter:{op:L7(r.op),filters:n}}}(t):ft()}function B7(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function pC(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class po{constructor(e,r,n,i,s=ht.min(),a=ht.min(),o=Cn.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=o,this.expectedCount=l}withSequenceNumber(e){return new po(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new po(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new po(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new po(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j7{constructor(e){this.ct=e}}function V7(t){const e=D7({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?hx(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U7{constructor(){this.un=new z7}addToCollectionParentIndex(e,r){return this.un.add(r),Ae.resolve()}getCollectionParents(e,r){return Ae.resolve(this.un.getEntries(r))}addFieldIndex(e,r){return Ae.resolve()}deleteFieldIndex(e,r){return Ae.resolve()}deleteAllFieldIndexes(e){return Ae.resolve()}createTargetIndexes(e,r){return Ae.resolve()}getDocumentsMatchingTarget(e,r){return Ae.resolve(null)}getIndexType(e,r){return Ae.resolve(0)}getFieldIndexes(e,r){return Ae.resolve([])}getNextCollectionGroupToUpdate(e){return Ae.resolve(null)}getMinOffset(e,r){return Ae.resolve(Po.min())}getMinOffsetFromCollectionGroup(e,r){return Ae.resolve(Po.min())}updateCollectionGroup(e,r,n){return Ae.resolve()}updateIndexEntries(e,r){return Ae.resolve()}}class z7{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r]||new kn(br.comparator),s=!i.has(n);return this.index[r]=i.add(n),s}has(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r];return i&&i.has(n)}getEntries(e){return(this.index[e]||new kn(br.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tu{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new tu(0)}static kn(){return new tu(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W7{constructor(){this.changes=new gu(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,$n.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?Ae.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $7{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H7{constructor(e,r,n,i){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,r))).next(i=>(n!==null&&vf(n.mutation,i,Fs.empty(),Qr.now()),i))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,St()).next(()=>n))}getLocalViewOfDocuments(e,r,n=St()){const i=cl();return this.populateOverlays(e,i,r).next(()=>this.computeViews(e,r,i,n).next(s=>{let a=Xu();return s.forEach((o,l)=>{a=a.insert(o,l.overlayedDocument)}),a}))}getOverlayedDocuments(e,r){const n=cl();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,St()))}populateOverlays(e,r,n){const i=[];return n.forEach(s=>{r.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((a,o)=>{r.set(a,o)})})}computeViews(e,r,n,i){let s=Na();const a=xf(),o=function(){return xf()}();return r.forEach((l,c)=>{const d=n.get(c.key);i.has(c.key)&&(d===void 0||d.mutation instanceof zl)?s=s.insert(c.key,c):d!==void 0?(a.set(c.key,d.mutation.getFieldMask()),vf(d.mutation,c,d.mutation.getFieldMask(),Qr.now())):a.set(c.key,Fs.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((c,d)=>a.set(c,d)),r.forEach((c,d)=>{var h;return o.set(c,new $7(d,(h=a.get(c))!==null&&h!==void 0?h:null))}),o))}recalculateAndSaveOverlays(e,r){const n=xf();let i=new kr((a,o)=>a-o),s=St();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(a=>{for(const o of a)o.keys().forEach(l=>{const c=r.get(l);if(c===null)return;let d=n.get(l)||Fs.empty();d=o.applyToLocalView(c,d),n.set(l,d);const h=(i.get(o.batchId)||St()).add(l);i=i.insert(o.batchId,h)})}).next(()=>{const a=[],o=i.getReverseIterator();for(;o.hasNext();){const l=o.getNext(),c=l.key,d=l.value,h=YA();d.forEach(p=>{if(!s.has(p)){const m=rC(r.get(p),n.get(p));m!==null&&h.set(p,m),s=s.add(p)}}),a.push(this.documentOverlayCache.saveOverlays(e,c,h))}return Ae.waitFor(a)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,i){return function(a){return tt.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):Jj(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,i):this.getDocumentsMatchingCollectionQuery(e,r,n,i)}getNextDocuments(e,r,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,i).next(s=>{const a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,i-s.size):Ae.resolve(cl());let o=-1,l=s;return a.next(c=>Ae.forEach(c,(d,h)=>(o<h.largestBatchId&&(o=h.largestBatchId),s.get(d)?Ae.resolve():this.remoteDocumentCache.getEntry(e,d).next(p=>{l=l.insert(d,p)}))).next(()=>this.populateOverlays(e,c,s)).next(()=>this.computeViews(e,l,c,St())).next(d=>({batchId:o,changes:qA(d)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new tt(r)).next(n=>{let i=Xu();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,r,n,i){const s=r.collectionGroup;let a=Xu();return this.indexManager.getCollectionParents(e,s).next(o=>Ae.forEach(o,l=>{const c=function(h,p){return new Dp(p,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(r,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,c,n,i).next(d=>{d.forEach((h,p)=>{a=a.insert(h,p)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,r,n,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,s,i))).next(a=>{s.forEach((l,c)=>{const d=c.getKey();a.get(d)===null&&(a=a.insert(d,$n.newInvalidDocument(d)))});let o=Xu();return a.forEach((l,c)=>{const d=s.get(l);d!==void 0&&vf(d.mutation,c,Fs.empty(),Qr.now()),Mp(r,c)&&(o=o.insert(l,c))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G7{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,r){return Ae.resolve(this.hr.get(r))}saveBundleMetadata(e,r){return this.hr.set(r.id,function(i){return{id:i.id,version:i.version,createTime:Qs(i.createTime)}}(r)),Ae.resolve()}getNamedQuery(e,r){return Ae.resolve(this.Pr.get(r))}saveNamedQuery(e,r){return this.Pr.set(r.name,function(i){return{name:i.name,query:V7(i.bundledQuery),readTime:Qs(i.readTime)}}(r)),Ae.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K7{constructor(){this.overlays=new kr(tt.comparator),this.Ir=new Map}getOverlay(e,r){return Ae.resolve(this.overlays.get(r))}getOverlays(e,r){const n=cl();return Ae.forEach(r,i=>this.getOverlay(e,i).next(s=>{s!==null&&n.set(i,s)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((i,s)=>{this.ht(e,r,s)}),Ae.resolve()}removeOverlaysForBatchId(e,r,n){const i=this.Ir.get(n);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(n)),Ae.resolve()}getOverlaysForCollection(e,r,n){const i=cl(),s=r.length+1,a=new tt(r.child("")),o=this.overlays.getIteratorFrom(a);for(;o.hasNext();){const l=o.getNext().value,c=l.getKey();if(!r.isPrefixOf(c.path))break;c.path.length===s&&l.largestBatchId>n&&i.set(l.getKey(),l)}return Ae.resolve(i)}getOverlaysForCollectionGroup(e,r,n,i){let s=new kr((c,d)=>c-d);const a=this.overlays.getIterator();for(;a.hasNext();){const c=a.getNext().value;if(c.getKey().getCollectionGroup()===r&&c.largestBatchId>n){let d=s.get(c.largestBatchId);d===null&&(d=cl(),s=s.insert(c.largestBatchId,d)),d.set(c.getKey(),c)}}const o=cl(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,d)=>o.set(c,d)),!(o.size()>=i)););return Ae.resolve(o)}ht(e,r,n){const i=this.overlays.get(n.key);if(i!==null){const a=this.Ir.get(i.largestBatchId).delete(n.key);this.Ir.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(n.key,new m7(r,n));let s=this.Ir.get(r);s===void 0&&(s=St(),this.Ir.set(r,s)),this.Ir.set(r,s.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X7{constructor(){this.sessionToken=Cn.EMPTY_BYTE_STRING}getSessionToken(e){return Ae.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,Ae.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ev{constructor(){this.Tr=new kn(an.Er),this.dr=new kn(an.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,r){const n=new an(e,r);this.Tr=this.Tr.add(n),this.dr=this.dr.add(n)}Rr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Vr(new an(e,r))}mr(e,r){e.forEach(n=>this.removeReference(n,r))}gr(e){const r=new tt(new br([])),n=new an(r,e),i=new an(r,e+1),s=[];return this.dr.forEachInRange([n,i],a=>{this.Vr(a),s.push(a.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const r=new tt(new br([])),n=new an(r,e),i=new an(r,e+1);let s=St();return this.dr.forEachInRange([n,i],a=>{s=s.add(a.key)}),s}containsKey(e){const r=new an(e,0),n=this.Tr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class an{constructor(e,r){this.key=e,this.wr=r}static Er(e,r){return tt.comparator(e.key,r.key)||jt(e.wr,r.wr)}static Ar(e,r){return jt(e.wr,r.wr)||tt.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q7{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.Sr=1,this.br=new kn(an.Er)}checkEmpty(e){return Ae.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,i){const s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new g7(s,r,n,i);this.mutationQueue.push(a);for(const o of i)this.br=this.br.add(new an(o.key,s)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return Ae.resolve(a)}lookupMutationBatch(e,r){return Ae.resolve(this.Dr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,i=this.vr(n),s=i<0?0:i;return Ae.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return Ae.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return Ae.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new an(r,0),i=new an(r,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([n,i],a=>{const o=this.Dr(a.wr);s.push(o)}),Ae.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new kn(jt);return r.forEach(i=>{const s=new an(i,0),a=new an(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,a],o=>{n=n.add(o.wr)})}),Ae.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,i=n.length+1;let s=n;tt.isDocumentKey(s)||(s=s.child(""));const a=new an(new tt(s),0);let o=new kn(jt);return this.br.forEachWhile(l=>{const c=l.key.path;return!!n.isPrefixOf(c)&&(c.length===i&&(o=o.add(l.wr)),!0)},a),Ae.resolve(this.Cr(o))}Cr(e){const r=[];return e.forEach(n=>{const i=this.Dr(n);i!==null&&r.push(i)}),r}removeMutationBatch(e,r){Yt(this.Fr(r.batchId,"removed")===0),this.mutationQueue.shift();let n=this.br;return Ae.forEach(r.mutations,i=>{const s=new an(i.key,r.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=n})}On(e){}containsKey(e,r){const n=new an(r,0),i=this.br.firstAfterOrEqual(n);return Ae.resolve(r.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,Ae.resolve()}Fr(e,r){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const r=this.vr(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y7{constructor(e){this.Mr=e,this.docs=function(){return new kr(tt.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,i=this.docs.get(n),s=i?i.size:0,a=this.Mr(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return Ae.resolve(n?n.document.mutableCopy():$n.newInvalidDocument(r))}getEntries(e,r){let n=Na();return r.forEach(i=>{const s=this.docs.get(i);n=n.insert(i,s?s.document.mutableCopy():$n.newInvalidDocument(i))}),Ae.resolve(n)}getDocumentsMatchingQuery(e,r,n,i){let s=Na();const a=r.path,o=new tt(a.child("")),l=this.docs.getIteratorFrom(o);for(;l.hasNext();){const{key:c,value:{document:d}}=l.getNext();if(!a.isPrefixOf(c.path))break;c.path.length>a.length+1||Nj(Rj(d),n)<=0||(i.has(d.key)||Mp(r,d))&&(s=s.insert(d.key,d.mutableCopy()))}return Ae.resolve(s)}getAllFromCollectionGroup(e,r,n,i){ft()}Or(e,r){return Ae.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new Q7(this)}getSize(e){return Ae.resolve(this.size)}}class Q7 extends W7{constructor(e){super(),this.cr=e}applyChanges(e){const r=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?r.push(this.cr.addEntry(e,i)):this.cr.removeEntry(n)}),Ae.waitFor(r)}getFromCache(e,r){return this.cr.getEntry(e,r)}getAllFromCache(e,r){return this.cr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J7{constructor(e){this.persistence=e,this.Nr=new gu(r=>gv(r),mv),this.lastRemoteSnapshotVersion=ht.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Ev,this.targetCount=0,this.kr=tu.Bn()}forEachTarget(e,r){return this.Nr.forEach((n,i)=>r(i)),Ae.resolve()}getLastRemoteSnapshotVersion(e){return Ae.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Ae.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),Ae.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.Lr&&(this.Lr=r),Ae.resolve()}Kn(e){this.Nr.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.kr=new tu(r),this.highestTargetId=r),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,r){return this.Kn(r),this.targetCount+=1,Ae.resolve()}updateTargetData(e,r){return this.Kn(r),Ae.resolve()}removeTargetData(e,r){return this.Nr.delete(r.target),this.Br.gr(r.targetId),this.targetCount-=1,Ae.resolve()}removeTargets(e,r,n){let i=0;const s=[];return this.Nr.forEach((a,o)=>{o.sequenceNumber<=r&&n.get(o.targetId)===null&&(this.Nr.delete(a),s.push(this.removeMatchingKeysForTargetId(e,o.targetId)),i++)}),Ae.waitFor(s).next(()=>i)}getTargetCount(e){return Ae.resolve(this.targetCount)}getTargetData(e,r){const n=this.Nr.get(r)||null;return Ae.resolve(n)}addMatchingKeys(e,r,n){return this.Br.Rr(r,n),Ae.resolve()}removeMatchingKeys(e,r,n){this.Br.mr(r,n);const i=this.persistence.referenceDelegate,s=[];return i&&r.forEach(a=>{s.push(i.markPotentiallyOrphaned(e,a))}),Ae.waitFor(s)}removeMatchingKeysForTargetId(e,r){return this.Br.gr(r),Ae.resolve()}getMatchingKeysForTargetId(e,r){const n=this.Br.yr(r);return Ae.resolve(n)}containsKey(e,r){return Ae.resolve(this.Br.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z7{constructor(e,r){this.qr={},this.overlays={},this.Qr=new fv(0),this.Kr=!1,this.Kr=!0,this.$r=new X7,this.referenceDelegate=e(this),this.Ur=new J7(this),this.indexManager=new U7,this.remoteDocumentCache=function(i){return new Y7(i)}(n=>this.referenceDelegate.Wr(n)),this.serializer=new j7(r),this.Gr=new G7(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new K7,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.qr[e.toKey()];return n||(n=new q7(r,this.referenceDelegate),this.qr[e.toKey()]=n),n}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,r,n){Je("MemoryPersistence","Starting transaction:",e);const i=new eV(this.Qr.next());return this.referenceDelegate.zr(),n(i).next(s=>this.referenceDelegate.jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Hr(e,r){return Ae.or(Object.values(this.qr).map(n=>()=>n.containsKey(e,r)))}}class eV extends Pj{constructor(e){super(),this.currentSequenceNumber=e}}class wv{constructor(e){this.persistence=e,this.Jr=new Ev,this.Yr=null}static Zr(e){return new wv(e)}get Xr(){if(this.Yr)return this.Yr;throw ft()}addReference(e,r,n){return this.Jr.addReference(n,r),this.Xr.delete(n.toString()),Ae.resolve()}removeReference(e,r,n){return this.Jr.removeReference(n,r),this.Xr.add(n.toString()),Ae.resolve()}markPotentiallyOrphaned(e,r){return this.Xr.add(r.toString()),Ae.resolve()}removeTarget(e,r){this.Jr.gr(r.targetId).forEach(i=>this.Xr.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(i=>{i.forEach(s=>this.Xr.add(s.toString()))}).next(()=>n.removeTargetData(e,r))}zr(){this.Yr=new Set}jr(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Ae.forEach(this.Xr,n=>{const i=tt.fromPath(n);return this.ei(e,i).next(s=>{s||r.removeEntry(i,ht.min())})}).next(()=>(this.Yr=null,r.apply(e)))}updateLimboDocument(e,r){return this.ei(e,r).next(n=>{n?this.Xr.delete(r.toString()):this.Xr.add(r.toString())})}Wr(e){return 0}ei(e,r){return Ae.or([()=>Ae.resolve(this.Jr.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Hr(e,r)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tv{constructor(e,r,n,i){this.targetId=e,this.fromCache=r,this.$i=n,this.Ui=i}static Wi(e,r){let n=St(),i=St();for(const s of r.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new Tv(e,r.fromCache,n,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tV{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rV{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return r9()?8:Oj(qn())>0?6:4}()}initialize(e,r){this.Ji=e,this.indexManager=r,this.Gi=!0}getDocumentsMatchingQuery(e,r,n,i){const s={result:null};return this.Yi(e,r).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.Zi(e,r,i,n).next(a=>{s.result=a})}).next(()=>{if(s.result)return;const a=new tV;return this.Xi(e,r,a).next(o=>{if(s.result=o,this.zi)return this.es(e,r,a,o.size)})}).next(()=>s.result)}es(e,r,n,i){return n.documentReadCount<this.ji?(ju()<=Ct.DEBUG&&Je("QueryEngine","SDK will not create cache indexes for query:",lc(r),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),Ae.resolve()):(ju()<=Ct.DEBUG&&Je("QueryEngine","Query:",lc(r),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.Hi*i?(ju()<=Ct.DEBUG&&Je("QueryEngine","The SDK decides to create cache indexes for query:",lc(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ys(r))):Ae.resolve())}Yi(e,r){if(aE(r))return Ae.resolve(null);let n=Ys(r);return this.indexManager.getIndexType(e,n).next(i=>i===0?null:(r.limit!==null&&i===1&&(r=hx(r,null,"F"),n=Ys(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(s=>{const a=St(...s);return this.Ji.getDocuments(e,a).next(o=>this.indexManager.getMinOffset(e,n).next(l=>{const c=this.ts(r,o);return this.ns(r,c,a,l.readTime)?this.Yi(e,hx(r,null,"F")):this.rs(e,c,r,l)}))})))}Zi(e,r,n,i){return aE(r)||i.isEqual(ht.min())?Ae.resolve(null):this.Ji.getDocuments(e,n).next(s=>{const a=this.ts(r,s);return this.ns(r,a,n,i)?Ae.resolve(null):(ju()<=Ct.DEBUG&&Je("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),lc(r)),this.rs(e,a,r,bj(i,-1)).next(o=>o))})}ts(e,r){let n=new kn(KA(e));return r.forEach((i,s)=>{Mp(e,s)&&(n=n.add(s))}),n}ns(e,r,n,i){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const s=e.limitType==="F"?r.last():r.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Xi(e,r,n){return ju()<=Ct.DEBUG&&Je("QueryEngine","Using full collection scan to execute query:",lc(r)),this.Ji.getDocumentsMatchingQuery(e,r,Po.min(),n)}rs(e,r,n,i){return this.Ji.getDocumentsMatchingQuery(e,n,i).next(s=>(r.forEach(a=>{s=s.insert(a.key,a)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nV{constructor(e,r,n,i){this.persistence=e,this.ss=r,this.serializer=i,this.os=new kr(jt),this._s=new gu(s=>gv(s),mv),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(n)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new H7(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.os))}}function iV(t,e,r,n){return new nV(t,e,r,n)}async function gC(t,e){const r=pt(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let i;return r.mutationQueue.getAllMutationBatches(n).next(s=>(i=s,r.ls(e),r.mutationQueue.getAllMutationBatches(n))).next(s=>{const a=[],o=[];let l=St();for(const c of i){a.push(c.batchId);for(const d of c.mutations)l=l.add(d.key)}for(const c of s){o.push(c.batchId);for(const d of c.mutations)l=l.add(d.key)}return r.localDocuments.getDocuments(n,l).next(c=>({hs:c,removedBatchIds:a,addedBatchIds:o}))})})}function sV(t,e){const r=pt(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=e.batch.keys(),s=r.cs.newChangeBuffer({trackRemovals:!0});return function(o,l,c,d){const h=c.batch,p=h.keys();let m=Ae.resolve();return p.forEach(y=>{m=m.next(()=>d.getEntry(l,y)).next(x=>{const E=c.docVersions.get(y);Yt(E!==null),x.version.compareTo(E)<0&&(h.applyToRemoteDocument(x,c),x.isValidDocument()&&(x.setReadTime(c.commitVersion),d.addEntry(x)))})}),m.next(()=>o.mutationQueue.removeMutationBatch(l,h))}(r,n,e,s).next(()=>s.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(o){let l=St();for(let c=0;c<o.mutationResults.length;++c)o.mutationResults[c].transformResults.length>0&&(l=l.add(o.batch.mutations[c].key));return l}(e))).next(()=>r.localDocuments.getDocuments(n,i))})}function mC(t){const e=pt(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Ur.getLastRemoteSnapshotVersion(r))}function aV(t,e){const r=pt(t),n=e.snapshotVersion;let i=r.os;return r.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const a=r.cs.newChangeBuffer({trackRemovals:!0});i=r.os;const o=[];e.targetChanges.forEach((d,h)=>{const p=i.get(h);if(!p)return;o.push(r.Ur.removeMatchingKeys(s,d.removedDocuments,h).next(()=>r.Ur.addMatchingKeys(s,d.addedDocuments,h)));let m=p.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(h)!==null?m=m.withResumeToken(Cn.EMPTY_BYTE_STRING,ht.min()).withLastLimboFreeSnapshotVersion(ht.min()):d.resumeToken.approximateByteSize()>0&&(m=m.withResumeToken(d.resumeToken,n)),i=i.insert(h,m),function(x,E,T){return x.resumeToken.approximateByteSize()===0||E.snapshotVersion.toMicroseconds()-x.snapshotVersion.toMicroseconds()>=3e8?!0:T.addedDocuments.size+T.modifiedDocuments.size+T.removedDocuments.size>0}(p,m,d)&&o.push(r.Ur.updateTargetData(s,m))});let l=Na(),c=St();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&o.push(r.persistence.referenceDelegate.updateLimboDocument(s,d))}),o.push(oV(s,a,e.documentUpdates).next(d=>{l=d.Ps,c=d.Is})),!n.isEqual(ht.min())){const d=r.Ur.getLastRemoteSnapshotVersion(s).next(h=>r.Ur.setTargetsMetadata(s,s.currentSequenceNumber,n));o.push(d)}return Ae.waitFor(o).next(()=>a.apply(s)).next(()=>r.localDocuments.getLocalViewOfDocuments(s,l,c)).next(()=>l)}).then(s=>(r.os=i,s))}function oV(t,e,r){let n=St(),i=St();return r.forEach(s=>n=n.add(s)),e.getEntries(t,n).next(s=>{let a=Na();return r.forEach((o,l)=>{const c=s.get(o);l.isFoundDocument()!==c.isFoundDocument()&&(i=i.add(o)),l.isNoDocument()&&l.version.isEqual(ht.min())?(e.removeEntry(o,l.readTime),a=a.insert(o,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),a=a.insert(o,l)):Je("LocalStore","Ignoring outdated watch update for ",o,". Current version:",c.version," Watch version:",l.version)}),{Ps:a,Is:i}})}function lV(t,e){const r=pt(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=-1),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function cV(t,e){const r=pt(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return r.Ur.getTargetData(n,e).next(s=>s?(i=s,Ae.resolve(i)):r.Ur.allocateTargetId(n).next(a=>(i=new po(e,a,"TargetPurposeListen",n.currentSequenceNumber),r.Ur.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=r.os.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(r.os=r.os.insert(n.targetId,n),r._s.set(e,n.targetId)),n})}async function vx(t,e,r){const n=pt(t),i=n.os.get(e),s=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",s,a=>n.persistence.referenceDelegate.removeTarget(a,i))}catch(a){if(!T0(a))throw a;Je("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}n.os=n.os.remove(e),n._s.delete(i.target)}function xE(t,e,r){const n=pt(t);let i=ht.min(),s=St();return n.persistence.runTransaction("Execute query","readwrite",a=>function(l,c,d){const h=pt(l),p=h._s.get(d);return p!==void 0?Ae.resolve(h.os.get(p)):h.Ur.getTargetData(c,d)}(n,a,Ys(e)).next(o=>{if(o)return i=o.lastLimboFreeSnapshotVersion,n.Ur.getMatchingKeysForTargetId(a,o.targetId).next(l=>{s=l})}).next(()=>n.ss.getDocumentsMatchingQuery(a,e,r?i:ht.min(),r?s:St())).next(o=>(uV(n,e7(e),o),{documents:o,Ts:s})))}function uV(t,e,r){let n=t.us.get(e)||ht.min();r.forEach((i,s)=>{s.readTime.compareTo(n)>0&&(n=s.readTime)}),t.us.set(e,n)}class vE{constructor(){this.activeTargetIds=a7()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class fV{constructor(){this.so=new vE,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,r,n){this.oo[e]=r}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new vE,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dV{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yE{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){Je("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){Je("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Od=null;function Gg(){return Od===null?Od=function(){return 268435456+Math.round(2147483648*Math.random())}():Od++,"0x"+Od.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hV={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pV{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bn="WebChannelConnection";class gV extends class{constructor(r){this.databaseInfo=r,this.databaseId=r.databaseId;const n=r.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=n+"://"+r.host,this.vo=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Fo(){return!1}Mo(r,n,i,s,a){const o=Gg(),l=this.xo(r,n.toUriEncodedString());Je("RestConnection",`Sending RPC '${r}' ${o}:`,l,i);const c={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(c,s,a),this.No(r,l,c,i).then(d=>(Je("RestConnection",`Received RPC '${r}' ${o}: `,d),d),d=>{throw Qc("RestConnection",`RPC '${r}' ${o} failed with error: `,d,"url: ",l,"request:",i),d})}Lo(r,n,i,s,a,o){return this.Mo(r,n,i,s,a)}Oo(r,n,i){r["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+hu}(),r["Content-Type"]="text/plain",this.databaseInfo.appId&&(r["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,a)=>r[a]=s),i&&i.headers.forEach((s,a)=>r[a]=s)}xo(r,n){const i=hV[r];return`${this.Do}/v1/${n}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,r,n,i){const s=Gg();return new Promise((a,o)=>{const l=new bA;l.setWithCredentials(!0),l.listenOnce(RA.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case Qd.NO_ERROR:const d=l.getResponseJson();Je(Bn,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(d)),a(d);break;case Qd.TIMEOUT:Je(Bn,`RPC '${e}' ${s} timed out`),o(new et(Re.DEADLINE_EXCEEDED,"Request time out"));break;case Qd.HTTP_ERROR:const h=l.getStatus();if(Je(Bn,`RPC '${e}' ${s} failed with status:`,h,"response text:",l.getResponseText()),h>0){let p=l.getResponseJson();Array.isArray(p)&&(p=p[0]);const m=p==null?void 0:p.error;if(m&&m.status&&m.message){const y=function(E){const T=E.toLowerCase().replace(/_/g,"-");return Object.values(Re).indexOf(T)>=0?T:Re.UNKNOWN}(m.status);o(new et(y,m.message))}else o(new et(Re.UNKNOWN,"Server responded with status "+l.getStatus()))}else o(new et(Re.UNAVAILABLE,"Connection failed."));break;default:ft()}}finally{Je(Bn,`RPC '${e}' ${s} completed.`)}});const c=JSON.stringify(i);Je(Bn,`RPC '${e}' ${s} sending request:`,i),l.send(r,"POST",c,n,15)})}Bo(e,r,n){const i=Gg(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=PA(),o=DA(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Oo(l.initMessageHeaders,r,n),l.encodeInitMessageHeaders=!0;const d=s.join("");Je(Bn,`Creating RPC '${e}' stream ${i}: ${d}`,l);const h=a.createWebChannel(d,l);let p=!1,m=!1;const y=new pV({Io:E=>{m?Je(Bn,`Not sending because RPC '${e}' stream ${i} is closed:`,E):(p||(Je(Bn,`Opening RPC '${e}' stream ${i} transport.`),h.open(),p=!0),Je(Bn,`RPC '${e}' stream ${i} sending:`,E),h.send(E))},To:()=>h.close()}),x=(E,T,k)=>{E.listen(T,_=>{try{k(_)}catch(P){setTimeout(()=>{throw P},0)}})};return x(h,Ku.EventType.OPEN,()=>{m||(Je(Bn,`RPC '${e}' stream ${i} transport opened.`),y.yo())}),x(h,Ku.EventType.CLOSE,()=>{m||(m=!0,Je(Bn,`RPC '${e}' stream ${i} transport closed`),y.So())}),x(h,Ku.EventType.ERROR,E=>{m||(m=!0,Qc(Bn,`RPC '${e}' stream ${i} transport errored:`,E),y.So(new et(Re.UNAVAILABLE,"The operation could not be completed")))}),x(h,Ku.EventType.MESSAGE,E=>{var T;if(!m){const k=E.data[0];Yt(!!k);const _=k,P=_.error||((T=_[0])===null||T===void 0?void 0:T.error);if(P){Je(Bn,`RPC '${e}' stream ${i} received error:`,P);const W=P.status;let B=function(S){const b=Vr[S];if(b!==void 0)return sC(b)}(W),w=P.message;B===void 0&&(B=Re.INTERNAL,w="Unknown error status: "+W+" with message "+P.message),m=!0,y.So(new et(B,w)),h.close()}else Je(Bn,`RPC '${e}' stream ${i} received:`,k),y.bo(k)}}),x(o,NA.STAT_EVENT,E=>{E.stat===lx.PROXY?Je(Bn,`RPC '${e}' stream ${i} detected buffering proxy`):E.stat===lx.NOPROXY&&Je(Bn,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{y.wo()},0),y}}function Kg(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vp(t){return new k7(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xC{constructor(e,r,n=1e3,i=1.5,s=6e4){this.ui=e,this.timerId=r,this.ko=n,this.qo=i,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const r=Math.floor(this.Ko+this.zo()),n=Math.max(0,Date.now()-this.Uo),i=Math.max(0,r-n);i>0&&Je("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vC{constructor(e,r,n,i,s,a,o,l){this.ui=e,this.Ho=n,this.Jo=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=o,this.listener=l,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new xC(e,r)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,r){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():r&&r.code===Re.RESOURCE_EXHAUSTED?(Ra(r.toString()),Ra("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):r&&r.code===Re.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(r)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),r=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.Yo===r&&this.P_(n,i)},n=>{e(()=>{const i=new et(Re.UNKNOWN,"Fetching auth token failed: "+n.message);return this.I_(i)})})}P_(e,r){const n=this.h_(this.Yo);this.stream=this.T_(e,r),this.stream.Eo(()=>{n(()=>this.listener.Eo())}),this.stream.Ro(()=>{n(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{n(()=>this.I_(i))}),this.stream.onMessage(i=>{n(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return Je("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return r=>{this.ui.enqueueAndForget(()=>this.Yo===e?r():(Je("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class mV extends vC{constructor(e,r,n,i,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,i,a),this.serializer=s}T_(e,r){return this.connection.Bo("Listen",e,r)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const r=F7(this.serializer,e),n=function(s){if(!("targetChange"in s))return ht.min();const a=s.targetChange;return a.targetIds&&a.targetIds.length?ht.min():a.readTime?Qs(a.readTime):ht.min()}(e);return this.listener.d_(r,n)}A_(e){const r={};r.database=xx(this.serializer),r.addTarget=function(s,a){let o;const l=a.target;if(o=dx(l)?{documents:R7(s,l)}:{query:N7(s,l)._t},o.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){o.resumeToken=lC(s,a.resumeToken);const c=px(s,a.expectedCount);c!==null&&(o.expectedCount=c)}else if(a.snapshotVersion.compareTo(ht.min())>0){o.readTime=Qh(s,a.snapshotVersion.toTimestamp());const c=px(s,a.expectedCount);c!==null&&(o.expectedCount=c)}return o}(this.serializer,e);const n=P7(this.serializer,e);n&&(r.labels=n),this.a_(r)}R_(e){const r={};r.database=xx(this.serializer),r.removeTarget=e,this.a_(r)}}class xV extends vC{constructor(e,r,n,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,i,a),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,r){return this.connection.Bo("Write",e,r)}E_(e){return Yt(!!e.streamToken),this.lastStreamToken=e.streamToken,Yt(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){Yt(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const r=b7(e.writeResults,e.commitTime),n=Qs(e.commitTime);return this.listener.g_(n,r)}p_(){const e={};e.database=xx(this.serializer),this.a_(e)}m_(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>I7(this.serializer,n))};this.a_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vV extends class{}{constructor(e,r,n,i){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new et(Re.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,r,n,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Mo(e,gx(r,n),i,s,a)).catch(s=>{throw s.name==="FirebaseError"?(s.code===Re.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new et(Re.UNKNOWN,s.toString())})}Lo(e,r,n,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,o])=>this.connection.Lo(e,gx(r,n),i,a,o,s)).catch(a=>{throw a.name==="FirebaseError"?(a.code===Re.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new et(Re.UNKNOWN,a.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class yV{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Ra(r),this.D_=!1):Je("OnlineStateTracker",r)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _V{constructor(e,r,n,i,s){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(a=>{n.enqueueAndForget(async()=>{Wl(this)&&(Je("RemoteStore","Restarting streams for network reachability change."),await async function(l){const c=pt(l);c.L_.add(4),await A0(c),c.q_.set("Unknown"),c.L_.delete(4),await Up(c)}(this))})}),this.q_=new yV(n,i)}}async function Up(t){if(Wl(t))for(const e of t.B_)await e(!0)}async function A0(t){for(const e of t.B_)await e(!1)}function yC(t,e){const r=pt(t);r.N_.has(e.targetId)||(r.N_.set(e.targetId,e),Cv(r)?Av(r):mu(r).r_()&&kv(r,e))}function Sv(t,e){const r=pt(t),n=mu(r);r.N_.delete(e),n.r_()&&_C(r,e),r.N_.size===0&&(n.r_()?n.o_():Wl(r)&&r.q_.set("Unknown"))}function kv(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ht.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}mu(t).A_(e)}function _C(t,e){t.Q_.xe(e),mu(t).R_(e)}function Av(t){t.Q_=new E7({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),mu(t).start(),t.q_.v_()}function Cv(t){return Wl(t)&&!mu(t).n_()&&t.N_.size>0}function Wl(t){return pt(t).L_.size===0}function EC(t){t.Q_=void 0}async function EV(t){t.q_.set("Online")}async function wV(t){t.N_.forEach((e,r)=>{kv(t,e)})}async function TV(t,e){EC(t),Cv(t)?(t.q_.M_(e),Av(t)):t.q_.set("Unknown")}async function SV(t,e,r){if(t.q_.set("Online"),e instanceof oC&&e.state===2&&e.cause)try{await async function(i,s){const a=s.cause;for(const o of s.targetIds)i.N_.has(o)&&(await i.remoteSyncer.rejectListen(o,a),i.N_.delete(o),i.Q_.removeTarget(o))}(t,e)}catch(n){Je("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),await Jh(t,n)}else if(e instanceof eh?t.Q_.Ke(e):e instanceof aC?t.Q_.He(e):t.Q_.We(e),!r.isEqual(ht.min()))try{const n=await mC(t.localStore);r.compareTo(n)>=0&&await function(s,a){const o=s.Q_.rt(a);return o.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const d=s.N_.get(c);d&&s.N_.set(c,d.withResumeToken(l.resumeToken,a))}}),o.targetMismatches.forEach((l,c)=>{const d=s.N_.get(l);if(!d)return;s.N_.set(l,d.withResumeToken(Cn.EMPTY_BYTE_STRING,d.snapshotVersion)),_C(s,l);const h=new po(d.target,l,c,d.sequenceNumber);kv(s,h)}),s.remoteSyncer.applyRemoteEvent(o)}(t,r)}catch(n){Je("RemoteStore","Failed to raise snapshot:",n),await Jh(t,n)}}async function Jh(t,e,r){if(!T0(e))throw e;t.L_.add(1),await A0(t),t.q_.set("Offline"),r||(r=()=>mC(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Je("RemoteStore","Retrying IndexedDB access"),await r(),t.L_.delete(1),await Up(t)})}function wC(t,e){return e().catch(r=>Jh(t,r,e))}async function zp(t){const e=pt(t),r=Mo(e);let n=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;kV(e);)try{const i=await lV(e.localStore,n);if(i===null){e.O_.length===0&&r.o_();break}n=i.batchId,AV(e,i)}catch(i){await Jh(e,i)}TC(e)&&SC(e)}function kV(t){return Wl(t)&&t.O_.length<10}function AV(t,e){t.O_.push(e);const r=Mo(t);r.r_()&&r.V_&&r.m_(e.mutations)}function TC(t){return Wl(t)&&!Mo(t).n_()&&t.O_.length>0}function SC(t){Mo(t).start()}async function CV(t){Mo(t).p_()}async function FV(t){const e=Mo(t);for(const r of t.O_)e.m_(r.mutations)}async function IV(t,e,r){const n=t.O_.shift(),i=vv.from(n,e,r);await wC(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await zp(t)}async function bV(t,e){e&&Mo(t).V_&&await async function(n,i){if(function(a){return v7(a)&&a!==Re.ABORTED}(i.code)){const s=n.O_.shift();Mo(n).s_(),await wC(n,()=>n.remoteSyncer.rejectFailedWrite(s.batchId,i)),await zp(n)}}(t,e),TC(t)&&SC(t)}async function _E(t,e){const r=pt(t);r.asyncQueue.verifyOperationInProgress(),Je("RemoteStore","RemoteStore received new credentials");const n=Wl(r);r.L_.add(3),await A0(r),n&&r.q_.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.L_.delete(3),await Up(r)}async function RV(t,e){const r=pt(t);e?(r.L_.delete(2),await Up(r)):e||(r.L_.add(2),await A0(r),r.q_.set("Unknown"))}function mu(t){return t.K_||(t.K_=function(r,n,i){const s=pt(r);return s.w_(),new mV(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:EV.bind(null,t),Ro:wV.bind(null,t),mo:TV.bind(null,t),d_:SV.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),Cv(t)?Av(t):t.q_.set("Unknown")):(await t.K_.stop(),EC(t))})),t.K_}function Mo(t){return t.U_||(t.U_=function(r,n,i){const s=pt(r);return s.w_(),new xV(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:CV.bind(null,t),mo:bV.bind(null,t),f_:FV.bind(null,t),g_:IV.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await zp(t)):(await t.U_.stop(),t.O_.length>0&&(Je("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fv{constructor(e,r,n,i,s){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=i,this.removalCallback=s,this.deferred=new Ao,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,i,s){const a=Date.now()+n,o=new Fv(e,r,a,i,s);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new et(Re.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Iv(t,e){if(Ra("AsyncQueue",`${e}: ${t}`),T0(t))return new et(Re.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mc{constructor(e){this.comparator=e?(r,n)=>e(r,n)||tt.comparator(r.key,n.key):(r,n)=>tt.comparator(r.key,n.key),this.keyedMap=Xu(),this.sortedSet=new kr(this.comparator)}static emptySet(e){return new Mc(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof Mc)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const i=r.getNext().key,s=n.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new Mc;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EE{constructor(){this.W_=new kr(tt.comparator)}track(e){const r=e.doc.key,n=this.W_.get(r);n?e.type!==0&&n.type===3?this.W_=this.W_.insert(r,e):e.type===3&&n.type!==1?this.W_=this.W_.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.W_=this.W_.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.W_=this.W_.remove(r):e.type===1&&n.type===2?this.W_=this.W_.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):ft():this.W_=this.W_.insert(r,e)}G_(){const e=[];return this.W_.inorderTraversal((r,n)=>{e.push(n)}),e}}class ru{constructor(e,r,n,i,s,a,o,l,c){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=o,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,r,n,i,s){const a=[];return r.forEach(o=>{a.push({type:0,doc:o})}),new ru(e,r,Mc.emptySet(r),a,n,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Op(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let i=0;i<r.length;i++)if(r[i].type!==n[i].type||!r[i].doc.isEqual(n[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NV{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class DV{constructor(){this.queries=wE(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(r,n){const i=pt(r),s=i.queries;i.queries=wE(),s.forEach((a,o)=>{for(const l of o.j_)l.onError(n)})})(this,new et(Re.ABORTED,"Firestore shutting down"))}}function wE(){return new gu(t=>GA(t),Op)}async function kC(t,e){const r=pt(t);let n=3;const i=e.query;let s=r.queries.get(i);s?!s.H_()&&e.J_()&&(n=2):(s=new NV,n=e.J_()?0:1);try{switch(n){case 0:s.z_=await r.onListen(i,!0);break;case 1:s.z_=await r.onListen(i,!1);break;case 2:await r.onFirstRemoteStoreListen(i)}}catch(a){const o=Iv(a,`Initialization of query '${lc(e.query)}' failed`);return void e.onError(o)}r.queries.set(i,s),s.j_.push(e),e.Z_(r.onlineState),s.z_&&e.X_(s.z_)&&bv(r)}async function AC(t,e){const r=pt(t),n=e.query;let i=3;const s=r.queries.get(n);if(s){const a=s.j_.indexOf(e);a>=0&&(s.j_.splice(a,1),s.j_.length===0?i=e.J_()?0:1:!s.H_()&&e.J_()&&(i=2))}switch(i){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function PV(t,e){const r=pt(t);let n=!1;for(const i of e){const s=i.query,a=r.queries.get(s);if(a){for(const o of a.j_)o.X_(i)&&(n=!0);a.z_=i}}n&&bv(r)}function OV(t,e,r){const n=pt(t),i=n.queries.get(e);if(i)for(const s of i.j_)s.onError(r);n.queries.delete(e)}function bv(t){t.Y_.forEach(e=>{e.next()})}var yx,TE;(TE=yx||(yx={})).ea="default",TE.Cache="cache";class CC{constructor(e,r,n){this.query=e,this.ta=r,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=n||{}}X_(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)i.type!==3&&n.push(i);e=new ru(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.na?this.ia(e)&&(this.ta.next(e),r=!0):this.sa(e,this.onlineState)&&(this.oa(e),r=!0),this.ra=e,r}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let r=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),r=!0),r}sa(e,r){if(!e.fromCache||!this.J_())return!0;const n=r!=="Offline";return(!this.options._a||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const r=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}oa(e){e=ru.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==yx.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FC{constructor(e){this.key=e}}class IC{constructor(e){this.key=e}}class MV{constructor(e,r){this.query=e,this.Ta=r,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=St(),this.mutatedKeys=St(),this.Aa=KA(e),this.Ra=new Mc(this.Aa)}get Va(){return this.Ta}ma(e,r){const n=r?r.fa:new EE,i=r?r.Ra:this.Ra;let s=r?r.mutatedKeys:this.mutatedKeys,a=i,o=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,c=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((d,h)=>{const p=i.get(d),m=Mp(this.query,h)?h:null,y=!!p&&this.mutatedKeys.has(p.key),x=!!m&&(m.hasLocalMutations||this.mutatedKeys.has(m.key)&&m.hasCommittedMutations);let E=!1;p&&m?p.data.isEqual(m.data)?y!==x&&(n.track({type:3,doc:m}),E=!0):this.ga(p,m)||(n.track({type:2,doc:m}),E=!0,(l&&this.Aa(m,l)>0||c&&this.Aa(m,c)<0)&&(o=!0)):!p&&m?(n.track({type:0,doc:m}),E=!0):p&&!m&&(n.track({type:1,doc:p}),E=!0,(l||c)&&(o=!0)),E&&(m?(a=a.add(m),s=x?s.add(d):s.delete(d)):(a=a.delete(d),s=s.delete(d)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const d=this.query.limitType==="F"?a.last():a.first();a=a.delete(d.key),s=s.delete(d.key),n.track({type:1,doc:d})}return{Ra:a,fa:n,ns:o,mutatedKeys:s}}ga(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,i){const s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const a=e.fa.G_();a.sort((d,h)=>function(m,y){const x=E=>{switch(E){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ft()}};return x(m)-x(y)}(d.type,h.type)||this.Aa(d.doc,h.doc)),this.pa(n),i=i!=null&&i;const o=r&&!i?this.ya():[],l=this.da.size===0&&this.current&&!i?1:0,c=l!==this.Ea;return this.Ea=l,a.length!==0||c?{snapshot:new ru(this.query,e.Ra,s,a,e.mutatedKeys,l===0,c,!1,!!n&&n.resumeToken.approximateByteSize()>0),wa:o}:{wa:o}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new EE,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(r=>this.Ta=this.Ta.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ta=this.Ta.delete(r)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=St(),this.Ra.forEach(n=>{this.Sa(n.key)&&(this.da=this.da.add(n.key))});const r=[];return e.forEach(n=>{this.da.has(n)||r.push(new IC(n))}),this.da.forEach(n=>{e.has(n)||r.push(new FC(n))}),r}ba(e){this.Ta=e.Ts,this.da=St();const r=this.ma(e.documents);return this.applyChanges(r,!0)}Da(){return ru.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class LV{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class BV{constructor(e){this.key=e,this.va=!1}}class jV{constructor(e,r,n,i,s,a){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Ca={},this.Fa=new gu(o=>GA(o),Op),this.Ma=new Map,this.xa=new Set,this.Oa=new kr(tt.comparator),this.Na=new Map,this.La=new Ev,this.Ba={},this.ka=new Map,this.qa=tu.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function VV(t,e,r=!0){const n=OC(t);let i;const s=n.Fa.get(e);return s?(n.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=await bC(n,e,r,!0),i}async function UV(t,e){const r=OC(t);await bC(r,e,!0,!1)}async function bC(t,e,r,n){const i=await cV(t.localStore,Ys(e)),s=i.targetId,a=t.sharedClientState.addLocalQueryTarget(s,r);let o;return n&&(o=await zV(t,e,s,a==="current",i.resumeToken)),t.isPrimaryClient&&r&&yC(t.remoteStore,i),o}async function zV(t,e,r,n,i){t.Ka=(h,p,m)=>async function(x,E,T,k){let _=E.view.ma(T);_.ns&&(_=await xE(x.localStore,E.query,!1).then(({documents:w})=>E.view.ma(w,_)));const P=k&&k.targetChanges.get(E.targetId),W=k&&k.targetMismatches.get(E.targetId)!=null,B=E.view.applyChanges(_,x.isPrimaryClient,P,W);return kE(x,E.targetId,B.wa),B.snapshot}(t,h,p,m);const s=await xE(t.localStore,e,!0),a=new MV(e,s.Ts),o=a.ma(s.documents),l=k0.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",i),c=a.applyChanges(o,t.isPrimaryClient,l);kE(t,r,c.wa);const d=new LV(e,r,a);return t.Fa.set(e,d),t.Ma.has(r)?t.Ma.get(r).push(e):t.Ma.set(r,[e]),c.snapshot}async function WV(t,e,r){const n=pt(t),i=n.Fa.get(e),s=n.Ma.get(i.targetId);if(s.length>1)return n.Ma.set(i.targetId,s.filter(a=>!Op(a,e))),void n.Fa.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await vx(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),r&&Sv(n.remoteStore,i.targetId),_x(n,i.targetId)}).catch(w0)):(_x(n,i.targetId),await vx(n.localStore,i.targetId,!0))}async function $V(t,e){const r=pt(t),n=r.Fa.get(e),i=r.Ma.get(n.targetId);r.isPrimaryClient&&i.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),Sv(r.remoteStore,n.targetId))}async function HV(t,e,r){const n=JV(t);try{const i=await function(a,o){const l=pt(a),c=Qr.now(),d=o.reduce((m,y)=>m.add(y.key),St());let h,p;return l.persistence.runTransaction("Locally write mutations","readwrite",m=>{let y=Na(),x=St();return l.cs.getEntries(m,d).next(E=>{y=E,y.forEach((T,k)=>{k.isValidDocument()||(x=x.add(T))})}).next(()=>l.localDocuments.getOverlayedDocuments(m,y)).next(E=>{h=E;const T=[];for(const k of o){const _=h7(k,h.get(k.key).overlayedDocument);_!=null&&T.push(new zl(k.key,_,jA(_.value.mapValue),Sa.exists(!0)))}return l.mutationQueue.addMutationBatch(m,c,T,o)}).next(E=>{p=E;const T=E.applyToLocalDocumentSet(h,x);return l.documentOverlayCache.saveOverlays(m,E.batchId,T)})}).then(()=>({batchId:p.batchId,changes:qA(h)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(a,o,l){let c=a.Ba[a.currentUser.toKey()];c||(c=new kr(jt)),c=c.insert(o,l),a.Ba[a.currentUser.toKey()]=c}(n,i.batchId,r),await C0(n,i.changes),await zp(n.remoteStore)}catch(i){const s=Iv(i,"Failed to persist write");r.reject(s)}}async function RC(t,e){const r=pt(t);try{const n=await aV(r.localStore,e);e.targetChanges.forEach((i,s)=>{const a=r.Na.get(s);a&&(Yt(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?a.va=!0:i.modifiedDocuments.size>0?Yt(a.va):i.removedDocuments.size>0&&(Yt(a.va),a.va=!1))}),await C0(r,n,e)}catch(n){await w0(n)}}function SE(t,e,r){const n=pt(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const i=[];n.Fa.forEach((s,a)=>{const o=a.view.Z_(e);o.snapshot&&i.push(o.snapshot)}),function(a,o){const l=pt(a);l.onlineState=o;let c=!1;l.queries.forEach((d,h)=>{for(const p of h.j_)p.Z_(o)&&(c=!0)}),c&&bv(l)}(n.eventManager,e),i.length&&n.Ca.d_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function GV(t,e,r){const n=pt(t);n.sharedClientState.updateQueryState(e,"rejected",r);const i=n.Na.get(e),s=i&&i.key;if(s){let a=new kr(tt.comparator);a=a.insert(s,$n.newNoDocument(s,ht.min()));const o=St().add(s),l=new jp(ht.min(),new Map,new kr(jt),a,o);await RC(n,l),n.Oa=n.Oa.remove(s),n.Na.delete(e),Rv(n)}else await vx(n.localStore,e,!1).then(()=>_x(n,e,r)).catch(w0)}async function KV(t,e){const r=pt(t),n=e.batch.batchId;try{const i=await sV(r.localStore,e);DC(r,n,null),NC(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await C0(r,i)}catch(i){await w0(i)}}async function XV(t,e,r){const n=pt(t);try{const i=await function(a,o){const l=pt(a);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let d;return l.mutationQueue.lookupMutationBatch(c,o).next(h=>(Yt(h!==null),d=h.keys(),l.mutationQueue.removeMutationBatch(c,h))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,d,o)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,d)).next(()=>l.localDocuments.getDocuments(c,d))})}(n.localStore,e);DC(n,e,r),NC(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await C0(n,i)}catch(i){await w0(i)}}function NC(t,e){(t.ka.get(e)||[]).forEach(r=>{r.resolve()}),t.ka.delete(e)}function DC(t,e,r){const n=pt(t);let i=n.Ba[n.currentUser.toKey()];if(i){const s=i.get(e);s&&(r?s.reject(r):s.resolve(),i=i.remove(e)),n.Ba[n.currentUser.toKey()]=i}}function _x(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Ma.get(e))t.Fa.delete(n),r&&t.Ca.$a(n,r);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(n=>{t.La.containsKey(n)||PC(t,n)})}function PC(t,e){t.xa.delete(e.path.canonicalString());const r=t.Oa.get(e);r!==null&&(Sv(t.remoteStore,r),t.Oa=t.Oa.remove(e),t.Na.delete(r),Rv(t))}function kE(t,e,r){for(const n of r)n instanceof FC?(t.La.addReference(n.key,e),qV(t,n)):n instanceof IC?(Je("SyncEngine","Document no longer in limbo: "+n.key),t.La.removeReference(n.key,e),t.La.containsKey(n.key)||PC(t,n.key)):ft()}function qV(t,e){const r=e.key,n=r.path.canonicalString();t.Oa.get(r)||t.xa.has(n)||(Je("SyncEngine","New document in limbo: "+r),t.xa.add(n),Rv(t))}function Rv(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const r=new tt(br.fromString(e)),n=t.qa.next();t.Na.set(n,new BV(r)),t.Oa=t.Oa.insert(r,n),yC(t.remoteStore,new po(Ys(Pp(r.path)),n,"TargetPurposeLimboResolution",fv.oe))}}async function C0(t,e,r){const n=pt(t),i=[],s=[],a=[];n.Fa.isEmpty()||(n.Fa.forEach((o,l)=>{a.push(n.Ka(l,e,r).then(c=>{var d;if((c||r)&&n.isPrimaryClient){const h=c?!c.fromCache:(d=r==null?void 0:r.targetChanges.get(l.targetId))===null||d===void 0?void 0:d.current;n.sharedClientState.updateQueryState(l.targetId,h?"current":"not-current")}if(c){i.push(c);const h=Tv.Wi(l.targetId,c);s.push(h)}}))}),await Promise.all(a),n.Ca.d_(i),await async function(l,c){const d=pt(l);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>Ae.forEach(c,p=>Ae.forEach(p.$i,m=>d.persistence.referenceDelegate.addReference(h,p.targetId,m)).next(()=>Ae.forEach(p.Ui,m=>d.persistence.referenceDelegate.removeReference(h,p.targetId,m)))))}catch(h){if(!T0(h))throw h;Je("LocalStore","Failed to update sequence numbers: "+h)}for(const h of c){const p=h.targetId;if(!h.fromCache){const m=d.os.get(p),y=m.snapshotVersion,x=m.withLastLimboFreeSnapshotVersion(y);d.os=d.os.insert(p,x)}}}(n.localStore,s))}async function YV(t,e){const r=pt(t);if(!r.currentUser.isEqual(e)){Je("SyncEngine","User change. New user:",e.toKey());const n=await gC(r.localStore,e);r.currentUser=e,function(s,a){s.ka.forEach(o=>{o.forEach(l=>{l.reject(new et(Re.CANCELLED,a))})}),s.ka.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await C0(r,n.hs)}}function QV(t,e){const r=pt(t),n=r.Na.get(e);if(n&&n.va)return St().add(n.key);{let i=St();const s=r.Ma.get(e);if(!s)return i;for(const a of s){const o=r.Fa.get(a);i=i.unionWith(o.view.Va)}return i}}function OC(t){const e=pt(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=RC.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=QV.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=GV.bind(null,e),e.Ca.d_=PV.bind(null,e.eventManager),e.Ca.$a=OV.bind(null,e.eventManager),e}function JV(t){const e=pt(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=KV.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=XV.bind(null,e),e}class Zh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Vp(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,r){return null}Ha(e,r){return null}za(e){return iV(this.persistence,new rV,e.initialUser,this.serializer)}Ga(e){return new Z7(wv.Zr,this.serializer)}Wa(e){return new fV}async terminate(){var e,r;(e=this.gcScheduler)===null||e===void 0||e.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Zh.provider={build:()=>new Zh};class Ex{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>SE(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=YV.bind(null,this.syncEngine),await RV(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new DV}()}createDatastore(e){const r=Vp(e.databaseInfo.databaseId),n=function(s){return new gV(s)}(e.databaseInfo);return function(s,a,o,l){return new vV(s,a,o,l)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,i,s,a,o){return new _V(n,i,s,a,o)}(this.localStore,this.datastore,e.asyncQueue,r=>SE(this.syncEngine,r,0),function(){return yE.D()?new yE:new dV}())}createSyncEngine(e,r){return function(i,s,a,o,l,c,d){const h=new jV(i,s,a,o,l,c);return d&&(h.Qa=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await async function(i){const s=pt(i);Je("RemoteStore","RemoteStore shutting down."),s.L_.add(5),await A0(s),s.k_.shutdown(),s.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}Ex.provider={build:()=>new Ex};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MC{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Ra("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZV{constructor(e,r,n,i,s){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=i,this.user=Vn.UNAUTHENTICATED,this.clientId=MA.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(n,async a=>{Je("FirestoreClient","Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(n,a=>(Je("FirestoreClient","Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ao;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=Iv(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function Xg(t,e){t.asyncQueue.verifyOperationInProgress(),Je("FirestoreClient","Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async i=>{n.isEqual(i)||(await gC(e.localStore,i),n=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function AE(t,e){t.asyncQueue.verifyOperationInProgress();const r=await eU(t);Je("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>_E(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,i)=>_E(e.remoteStore,i)),t._onlineComponents=e}async function eU(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Je("FirestoreClient","Using user provided OfflineComponentProvider");try{await Xg(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(i){return i.name==="FirebaseError"?i.code===Re.FAILED_PRECONDITION||i.code===Re.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(r))throw r;Qc("Error using user provided cache. Falling back to memory cache: "+r),await Xg(t,new Zh)}}else Je("FirestoreClient","Using default OfflineComponentProvider"),await Xg(t,new Zh);return t._offlineComponents}async function LC(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Je("FirestoreClient","Using user provided OnlineComponentProvider"),await AE(t,t._uninitializedComponentsProvider._online)):(Je("FirestoreClient","Using default OnlineComponentProvider"),await AE(t,new Ex))),t._onlineComponents}function tU(t){return LC(t).then(e=>e.syncEngine)}async function wx(t){const e=await LC(t),r=e.eventManager;return r.onListen=VV.bind(null,e.syncEngine),r.onUnlisten=WV.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=UV.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=$V.bind(null,e.syncEngine),r}function rU(t,e,r={}){const n=new Ao;return t.asyncQueue.enqueueAndForget(async()=>function(s,a,o,l,c){const d=new MC({next:p=>{d.Za(),a.enqueueAndForget(()=>AC(s,h));const m=p.docs.has(o);!m&&p.fromCache?c.reject(new et(Re.UNAVAILABLE,"Failed to get document because the client is offline.")):m&&p.fromCache&&l&&l.source==="server"?c.reject(new et(Re.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(p)},error:p=>c.reject(p)}),h=new CC(Pp(o.path),d,{includeMetadataChanges:!0,_a:!0});return kC(s,h)}(await wx(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BC(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CE=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nU(t,e,r){if(!r)throw new et(Re.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function iU(t,e,r,n){if(e===!0&&n===!0)throw new et(Re.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function FE(t){if(!tt.isDocumentKey(t))throw new et(Re.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Nv(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ft()}function Co(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new et(Re.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=Nv(t);throw new et(Re.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IE{constructor(e){var r,n;if(e.host===void 0){if(e.ssl!==void 0)throw new et(Re.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(r=e.ssl)===null||r===void 0||r;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new et(Re.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}iU("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=BC((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new et(Re.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new et(Re.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new et(Re.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Dv{constructor(e,r,n,i){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new IE({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new et(Re.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new et(Re.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new IE(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new Ej;switch(n.type){case"firstParty":return new kj(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new et(Re.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=CE.get(r);n&&(Je("ComponentProvider","Removing Datastore"),CE.delete(r),n.terminate())}(this),Promise.resolve()}}function sU(t,e,r,n={}){var i;const s=(t=Co(t,Dv))._getSettings(),a=`${e}:${r}`;if(s.host!=="firestore.googleapis.com"&&s.host!==a&&Qc("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:a,ssl:!1})),n.mockUserToken){let o,l;if(typeof n.mockUserToken=="string")o=n.mockUserToken,l=Vn.MOCK_USER;else{o=qB(n.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);const c=n.mockUserToken.sub||n.mockUserToken.user_id;if(!c)throw new et(Re.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new Vn(c)}t._authCredentials=new wj(new OA(o,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wp{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Wp(this.firestore,e,this._query)}}class Pi{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new i0(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Pi(this.firestore,e,this._key)}}class i0 extends Wp{constructor(e,r,n){super(e,r,Pp(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Pi(this.firestore,null,new tt(e))}withConverter(e){return new i0(this.firestore,e,this._path)}}function Pv(t,e,...r){if(t=Ps(t),arguments.length===1&&(e=MA.newId()),nU("doc","path",e),t instanceof Dv){const n=br.fromString(e,...r);return FE(n),new Pi(t,null,new tt(n))}{if(!(t instanceof Pi||t instanceof i0))throw new et(Re.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(br.fromString(e,...r));return FE(n),new Pi(t.firestore,t instanceof i0?t.converter:null,new tt(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bE{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new xC(this,"async_queue_retry"),this.Vu=()=>{const n=Kg();n&&Je("AsyncQueue","Visibility state changed to "+n.visibilityState),this.t_.jo()},this.mu=e;const r=Kg();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const r=Kg();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const r=new Ao;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!T0(e))throw e;Je("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const r=this.mu.then(()=>(this.du=!0,e().catch(n=>{this.Eu=n,this.du=!1;const i=function(a){let o=a.message||"";return a.stack&&(o=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),o}(n);throw Ra("INTERNAL UNHANDLED ERROR: ",i),n}).then(n=>(this.du=!1,n))));return this.mu=r,r}enqueueAfterDelay(e,r,n){this.fu(),this.Ru.indexOf(e)>-1&&(r=0);const i=Fv.createAndSchedule(this,e,r,n,s=>this.yu(s));return this.Tu.push(i),i}fu(){this.Eu&&ft()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const r of this.Tu)if(r.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.Tu)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const r=this.Tu.indexOf(e);this.Tu.splice(r,1)}}function RE(t){return function(r,n){if(typeof r!="object"||r===null)return!1;const i=r;for(const s of n)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}class s0 extends Dv{constructor(e,r,n,i){super(e,r,n,i),this.type="firestore",this._queue=new bE,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new bE(e),this._firestoreClient=void 0,await e}}}function aU(t,e){const r=typeof t=="object"?t:AA(),n=typeof t=="string"?t:"(default)",i=cv(r,"firestore").getImmediate({identifier:n});if(!i._initialized){const s=KB("firestore");s&&sU(i,...s)}return i}function Ov(t){if(t._terminated)throw new et(Re.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||oU(t),t._firestoreClient}function oU(t){var e,r,n;const i=t._freezeSettings(),s=function(o,l,c,d){return new Bj(o,l,c,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,BC(d.experimentalLongPollingOptions),d.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._componentsProvider||!((r=i.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((n=i.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(t._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),t._firestoreClient=new ZV(t._authCredentials,t._appCheckCredentials,t._queue,s,t._componentsProvider&&function(o){const l=o==null?void 0:o._online.build();return{_offline:o==null?void 0:o._offline.build(l),_online:l}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nu{constructor(e){this._byteString=e}static fromBase64String(e){try{return new nu(Cn.fromBase64String(e))}catch(r){throw new et(Re.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new nu(Cn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mv{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new et(Re.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Tn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jC{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lv{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new et(Re.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new et(Re.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return jt(this._lat,e._lat)||jt(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bv{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,i){if(n.length!==i.length)return!1;for(let s=0;s<n.length;++s)if(n[s]!==i[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lU=/^__.*__$/;class cU{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new zl(e,this.data,this.fieldMask,r,this.fieldTransforms):new S0(e,this.data,r,this.fieldTransforms)}}function VC(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ft()}}class jv{constructor(e,r,n,i,s,a){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=i,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new jv(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),i=this.Fu({path:n,xu:!1});return i.Ou(e),i}Nu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),i=this.Fu({path:n,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return ep(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(VC(this.Cu)&&lU.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class uU{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||Vp(e)}Qu(e,r,n,i=!1){return new jv({Cu:e,methodName:r,qu:n,path:Tn.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function fU(t){const e=t._freezeSettings(),r=Vp(t._databaseId);return new uU(t._databaseId,!!e.ignoreUndefinedProperties,r)}function dU(t,e,r,n,i,s={}){const a=t.Qu(s.merge||s.mergeFields?2:0,e,r,i);$C("Data must be an object, but it was:",a,n);const o=zC(n,a);let l,c;if(s.merge)l=new Fs(a.fieldMask),c=a.fieldTransforms;else if(s.mergeFields){const d=[];for(const h of s.mergeFields){const p=hU(e,h,r);if(!a.contains(p))throw new et(Re.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);gU(d,p)||d.push(p)}l=new Fs(d),c=a.fieldTransforms.filter(h=>l.covers(h.field))}else l=null,c=a.fieldTransforms;return new cU(new ns(o),l,c)}function UC(t,e){if(WC(t=Ps(t)))return $C("Unsupported field value:",e,t),zC(t,e);if(t instanceof jC)return function(n,i){if(!VC(i.Cu))throw i.Bu(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${n._methodName}() is not currently supported inside arrays`);const s=n._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(n,i){const s=[];let a=0;for(const o of n){let l=UC(o,i.Lu(a));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),a++}return{arrayValue:{values:s}}}(t,e)}return function(n,i){if((n=Ps(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return o7(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const s=Qr.fromDate(n);return{timestampValue:Qh(i.serializer,s)}}if(n instanceof Qr){const s=new Qr(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Qh(i.serializer,s)}}if(n instanceof Lv)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof nu)return{bytesValue:lC(i.serializer,n._byteString)};if(n instanceof Pi){const s=i.databaseId,a=n.firestore._databaseId;if(!a.isEqual(s))throw i.Bu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:_v(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof Bv)return function(a,o){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:a.toArray().map(l=>{if(typeof l!="number")throw o.Bu("VectorValues must only contain numeric values.");return xv(o.serializer,l)})}}}}}}(n,i);throw i.Bu(`Unsupported field value: ${Nv(n)}`)}(t,e)}function zC(t,e){const r={};return LA(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):pu(t,(n,i)=>{const s=UC(i,e.Mu(n));s!=null&&(r[n]=s)}),{mapValue:{fields:r}}}function WC(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Qr||t instanceof Lv||t instanceof nu||t instanceof Pi||t instanceof jC||t instanceof Bv)}function $C(t,e,r){if(!WC(r)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(r)){const n=Nv(r);throw n==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+n)}}function hU(t,e,r){if((e=Ps(e))instanceof Mv)return e._internalPath;if(typeof e=="string")return HC(t,e);throw ep("Field path arguments must be of type string or ",t,!1,void 0,r)}const pU=new RegExp("[~\\*/\\[\\]]");function HC(t,e,r){if(e.search(pU)>=0)throw ep(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new Mv(...e.split("."))._internalPath}catch{throw ep(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function ep(t,e,r,n,i){const s=n&&!n.isEmpty(),a=i!==void 0;let o=`Function ${e}() called with invalid data`;r&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(s||a)&&(l+=" (found",s&&(l+=` in field ${n}`),a&&(l+=` in document ${i}`),l+=")"),new et(Re.INVALID_ARGUMENT,o+t+l)}function gU(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GC{constructor(e,r,n,i,s){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Pi(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new mU(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(KC("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class mU extends GC{data(){return super.data()}}function KC(t,e){return typeof e=="string"?HC(t,e):e instanceof Mv?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xU(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new et(Re.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class vU{convertValue(e,r="none"){switch(Nl(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Pr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(Rl(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw ft()}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return pu(e,(i,s)=>{n[i]=this.convertValue(s,r)}),n}convertVectorValue(e){var r,n,i;const s=(i=(n=(r=e.fields)===null||r===void 0?void 0:r.value.arrayValue)===null||n===void 0?void 0:n.values)===null||i===void 0?void 0:i.map(a=>Pr(a.doubleValue));return new Bv(s)}convertGeoPoint(e){return new Lv(Pr(e.latitude),Pr(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=hv(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(Zf(e));default:return null}}convertTimestamp(e){const r=Oo(e);return new Qr(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=br.fromString(e);Yt(pC(n));const i=new e0(n.get(1),n.get(3)),s=new tt(n.popFirst(5));return i.isEqual(r)||Ra(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yU(t,e,r){let n;return n=t?t.toFirestore(e):e,n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yu{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class XC extends GC{constructor(e,r,n,i,s,a){super(e,r,n,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new th(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(KC("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}}class th extends XC{data(e={}){return super.data(e)}}class _U{constructor(e,r,n,i){this._firestore=e,this._userDataWriter=r,this._snapshot=i,this.metadata=new Yu(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new th(this._firestore,this._userDataWriter,n.key,n,new Yu(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new et(Re.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(o=>{const l=new th(i._firestore,i._userDataWriter,o.doc.key,o.doc,new Yu(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);return o.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(o=>s||o.type!==3).map(o=>{const l=new th(i._firestore,i._userDataWriter,o.doc.key,o.doc,new Yu(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);let c=-1,d=-1;return o.type!==0&&(c=a.indexOf(o.doc.key),a=a.delete(o.doc.key)),o.type!==1&&(a=a.add(o.doc),d=a.indexOf(o.doc.key)),{type:EU(o.type),doc:l,oldIndex:c,newIndex:d}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}}function EU(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ft()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wU(t){t=Co(t,Pi);const e=Co(t.firestore,s0);return rU(Ov(e),t._key).then(r=>YC(e,t,r))}class qC extends vU{constructor(e){super(),this.firestore=e}convertBytes(e){return new nu(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new Pi(this.firestore,null,r)}}function TU(t,e,r){t=Co(t,Pi);const n=Co(t.firestore,s0),i=yU(t.converter,e);return kU(n,[dU(fU(n),"setDoc",t._key,i,t.converter!==null,r).toMutation(t._key,Sa.none())])}function SU(t,...e){var r,n,i;t=Ps(t);let s={includeMetadataChanges:!1,source:"default"},a=0;typeof e[a]!="object"||RE(e[a])||(s=e[a],a++);const o={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(RE(e[a])){const h=e[a];e[a]=(r=h.next)===null||r===void 0?void 0:r.bind(h),e[a+1]=(n=h.error)===null||n===void 0?void 0:n.bind(h),e[a+2]=(i=h.complete)===null||i===void 0?void 0:i.bind(h)}let l,c,d;if(t instanceof Pi)c=Co(t.firestore,s0),d=Pp(t._key.path),l={next:h=>{e[a]&&e[a](YC(c,t,h))},error:e[a+1],complete:e[a+2]};else{const h=Co(t,Wp);c=Co(h.firestore,s0),d=h._query;const p=new qC(c);l={next:m=>{e[a]&&e[a](new _U(c,p,h,m))},error:e[a+1],complete:e[a+2]},xU(t._query)}return function(p,m,y,x){const E=new MC(x),T=new CC(m,E,y);return p.asyncQueue.enqueueAndForget(async()=>kC(await wx(p),T)),()=>{E.Za(),p.asyncQueue.enqueueAndForget(async()=>AC(await wx(p),T))}}(Ov(c),d,o,l)}function kU(t,e){return function(n,i){const s=new Ao;return n.asyncQueue.enqueueAndForget(async()=>HV(await tU(n),i,s)),s.promise}(Ov(t),e)}function YC(t,e,r){const n=r.docs.get(e._key),i=new qC(t);return new XC(t,i,e._key,n,new Yu(r.hasPendingWrites,r.fromCache),e.converter)}(function(e,r=!0){(function(i){hu=i})(du),Yc(new Il("firestore",(n,{instanceIdentifier:i,options:s})=>{const a=n.getProvider("app").getImmediate(),o=new s0(new Tj(n.getProvider("auth-internal")),new Cj(n.getProvider("app-check-internal")),function(c,d){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new et(Re.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new e0(c.options.projectId,d)}(a,i),a);return s=Object.assign({useFetchStreams:r},s),o._setSettings(s),o},"PUBLIC").setMultipleInstances(!0)),ko(Y2,"4.7.3",e),ko(Y2,"4.7.3","esm2017")})();function Vv(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function QC(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const AU=QC,JC=new _0("auth","Firebase",QC());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tp=new ov("@firebase/auth");function CU(t,...e){tp.logLevel<=Ct.WARN&&tp.warn(`Auth (${du}): ${t}`,...e)}function rh(t,...e){tp.logLevel<=Ct.ERROR&&tp.error(`Auth (${du}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Da(t,...e){throw Uv(t,...e)}function Js(t,...e){return Uv(t,...e)}function ZC(t,e,r){const n=Object.assign(Object.assign({},AU()),{[e]:r});return new _0("auth","Firebase",n).create(e,{appName:t.name})}function xl(t){return ZC(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Uv(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return JC.create(t,...e)}function ut(t,e,...r){if(!t)throw Uv(e,...r)}function xa(t){const e="INTERNAL ASSERTION FAILED: "+t;throw rh(e),new Error(e)}function Pa(t,e){t||xa(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tx(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function FU(){return NE()==="http:"||NE()==="https:"}function NE(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IU(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(FU()||ZB()||"connection"in navigator)?navigator.onLine:!0}function bU(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F0{constructor(e,r){this.shortDelay=e,this.longDelay=r,Pa(r>e,"Short delay should be less than long delay!"),this.isMobile=YB()||e9()}get(){return IU()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zv(t,e){Pa(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e4{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;xa("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;xa("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;xa("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RU={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NU=new F0(3e4,6e4);function Wv(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function xu(t,e,r,n,i={}){return t4(t,i,async()=>{let s={},a={};n&&(e==="GET"?a=n:s={body:JSON.stringify(n)});const o=E0(Object.assign({key:t.config.apiKey},a)).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const c=Object.assign({method:e,headers:l},s);return JB()||(c.referrerPolicy="no-referrer"),e4.fetch()(r4(t,t.config.apiHost,r,o),c)})}async function t4(t,e,r){t._canInitEmulator=!1;const n=Object.assign(Object.assign({},RU),e);try{const i=new PU(t),s=await Promise.race([r(),i.promise]);i.clearNetworkTimeout();const a=await s.json();if("needConfirmation"in a)throw Md(t,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{const o=s.ok?a.errorMessage:a.error.message,[l,c]=o.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Md(t,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw Md(t,"email-already-in-use",a);if(l==="USER_DISABLED")throw Md(t,"user-disabled",a);const d=n[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw ZC(t,d,c);Da(t,d)}}catch(i){if(i instanceof ja)throw i;Da(t,"network-request-failed",{message:String(i)})}}async function DU(t,e,r,n,i={}){const s=await xu(t,e,r,n,i);return"mfaPendingCredential"in s&&Da(t,"multi-factor-auth-required",{_serverResponse:s}),s}function r4(t,e,r,n){const i=`${e}${r}?${n}`;return t.config.emulator?zv(t.config,i):`${t.config.apiScheme}://${i}`}class PU{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(Js(this.auth,"network-request-failed")),NU.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Md(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const i=Js(t,e,n);return i.customData._tokenResponse=r,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function OU(t,e){return xu(t,"POST","/v1/accounts:delete",e)}async function n4(t,e){return xu(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yf(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function MU(t,e=!1){const r=Ps(t),n=await r.getIdToken(e),i=$v(n);ut(i&&i.exp&&i.auth_time&&i.iat,r.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,a=s==null?void 0:s.sign_in_provider;return{claims:i,token:n,authTime:yf(qg(i.auth_time)),issuedAtTime:yf(qg(i.iat)),expirationTime:yf(qg(i.exp)),signInProvider:a||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function qg(t){return Number(t)*1e3}function $v(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return rh("JWT malformed, contained fewer than 3 sections"),null;try{const i=yA(r);return i?JSON.parse(i):(rh("Failed to decode base64 JWT payload"),null)}catch(i){return rh("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function DE(t){const e=$v(t);return ut(e,"internal-error"),ut(typeof e.exp<"u","internal-error"),ut(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function a0(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof ja&&LU(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function LU({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BU{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var r;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const i=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sx{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=yf(this.lastLoginAt),this.creationTime=yf(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rp(t){var e;const r=t.auth,n=await t.getIdToken(),i=await a0(t,n4(r,{idToken:n}));ut(i==null?void 0:i.users.length,r,"internal-error");const s=i.users[0];t._notifyReloadListener(s);const a=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?i4(s.providerUserInfo):[],o=VU(t.providerData,a),l=t.isAnonymous,c=!(t.email&&s.passwordHash)&&!(o!=null&&o.length),d=l?c:!1,h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new Sx(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(t,h)}async function jU(t){const e=Ps(t);await rp(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function VU(t,e){return[...t.filter(n=>!e.some(i=>i.providerId===n.providerId)),...e]}function i4(t){return t.map(e=>{var{providerId:r}=e,n=Vv(e,["providerId"]);return{providerId:r,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function UU(t,e){const r=await t4(t,{},async()=>{const n=E0({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,a=r4(t,i,"/v1/token",`key=${s}`),o=await t._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",e4.fetch()(a,{method:"POST",headers:o,body:n})});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function zU(t,e){return xu(t,"POST","/v2/accounts:revokeToken",Wv(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lc{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ut(e.idToken,"internal-error"),ut(typeof e.idToken<"u","internal-error"),ut(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):DE(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){ut(e.length!==0,"internal-error");const r=DE(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(ut(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:i,expiresIn:s}=await UU(e,r);this.updateTokensAndExpiration(n,i,Number(s))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:i,expirationTime:s}=r,a=new Lc;return n&&(ut(typeof n=="string","internal-error",{appName:e}),a.refreshToken=n),i&&(ut(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),s&&(ut(typeof s=="number","internal-error",{appName:e}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Lc,this.toJSON())}_performRefresh(){return xa("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Za(t,e){ut(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class va{constructor(e){var{uid:r,auth:n,stsTokenManager:i}=e,s=Vv(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new BU(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Sx(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const r=await a0(this,this.stsTokenManager.getToken(this.auth,e));return ut(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return MU(this,e)}reload(){return jU(this)}_assign(e){this!==e&&(ut(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>Object.assign({},r)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new va(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(e){ut(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await rp(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(ho(this.auth.app))return Promise.reject(xl(this.auth));const e=await this.getIdToken();return await a0(this,OU(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){var n,i,s,a,o,l,c,d;const h=(n=r.displayName)!==null&&n!==void 0?n:void 0,p=(i=r.email)!==null&&i!==void 0?i:void 0,m=(s=r.phoneNumber)!==null&&s!==void 0?s:void 0,y=(a=r.photoURL)!==null&&a!==void 0?a:void 0,x=(o=r.tenantId)!==null&&o!==void 0?o:void 0,E=(l=r._redirectEventId)!==null&&l!==void 0?l:void 0,T=(c=r.createdAt)!==null&&c!==void 0?c:void 0,k=(d=r.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:_,emailVerified:P,isAnonymous:W,providerData:B,stsTokenManager:w}=r;ut(_&&w,e,"internal-error");const C=Lc.fromJSON(this.name,w);ut(typeof _=="string",e,"internal-error"),Za(h,e.name),Za(p,e.name),ut(typeof P=="boolean",e,"internal-error"),ut(typeof W=="boolean",e,"internal-error"),Za(m,e.name),Za(y,e.name),Za(x,e.name),Za(E,e.name),Za(T,e.name),Za(k,e.name);const S=new va({uid:_,auth:e,email:p,emailVerified:P,displayName:h,isAnonymous:W,photoURL:y,phoneNumber:m,tenantId:x,stsTokenManager:C,createdAt:T,lastLoginAt:k});return B&&Array.isArray(B)&&(S.providerData=B.map(b=>Object.assign({},b))),E&&(S._redirectEventId=E),S}static async _fromIdTokenResponse(e,r,n=!1){const i=new Lc;i.updateFromServerResponse(r);const s=new va({uid:r.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await rp(s),s}static async _fromGetAccountInfoResponse(e,r,n){const i=r.users[0];ut(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?i4(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),o=new Lc;o.updateFromIdToken(n);const l=new va({uid:i.localId,auth:e,stsTokenManager:o,isAnonymous:a}),c={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Sx(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(l,c),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PE=new Map;function ya(t){Pa(t instanceof Function,"Expected a class definition");let e=PE.get(t);return e?(Pa(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,PE.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s4{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}s4.type="NONE";const OE=s4;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nh(t,e,r){return`firebase:${t}:${e}:${r}`}class Bc{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:i,name:s}=this.auth;this.fullUserKey=nh(this.userKey,i.apiKey,s),this.fullPersistenceKey=nh("persistence",i.apiKey,s),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?va._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new Bc(ya(OE),e,n);const i=(await Promise.all(r.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let s=i[0]||ya(OE);const a=nh(n,e.config.apiKey,e.name);let o=null;for(const c of r)try{const d=await c._get(a);if(d){const h=va._fromJSON(e,d);c!==s&&(o=h),s=c;break}}catch{}const l=i.filter(c=>c._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new Bc(s,e,n):(s=l[0],o&&await s._set(a,o.toJSON()),await Promise.all(r.map(async c=>{if(c!==s)try{await c._remove(a)}catch{}})),new Bc(s,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ME(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(c4(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(a4(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(f4(e))return"Blackberry";if(d4(e))return"Webos";if(o4(e))return"Safari";if((e.includes("chrome/")||l4(e))&&!e.includes("edge/"))return"Chrome";if(u4(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function a4(t=qn()){return/firefox\//i.test(t)}function o4(t=qn()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function l4(t=qn()){return/crios\//i.test(t)}function c4(t=qn()){return/iemobile/i.test(t)}function u4(t=qn()){return/android/i.test(t)}function f4(t=qn()){return/blackberry/i.test(t)}function d4(t=qn()){return/webos/i.test(t)}function Hv(t=qn()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function WU(t=qn()){var e;return Hv(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function $U(){return t9()&&document.documentMode===10}function h4(t=qn()){return Hv(t)||u4(t)||d4(t)||f4(t)||/windows phone/i.test(t)||c4(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p4(t,e=[]){let r;switch(t){case"Browser":r=ME(qn());break;case"Worker":r=`${ME(qn())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${du}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HU{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=s=>new Promise((a,o)=>{try{const l=e(s);a(l)}catch(l){o(l)}});n.onAbort=r,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const i of r)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function GU(t,e={}){return xu(t,"GET","/v2/passwordPolicy",Wv(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KU=6;class XU{constructor(e){var r,n,i,s;const a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=a.minPasswordLength)!==null&&r!==void 0?r:KU,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(n=e.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var r,n,i,s,a,o;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(r=l.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(n=l.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),l.isValid&&(l.isValid=(i=l.containsLowercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(s=l.containsUppercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(a=l.containsNumericCharacter)!==null&&a!==void 0?a:!0),l.isValid&&(l.isValid=(o=l.containsNonAlphanumericCharacter)!==null&&o!==void 0?o:!0),l}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),i&&(r.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qU{constructor(e,r,n,i){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new LE(this),this.idTokenSubscription=new LE(this),this.beforeStateQueue=new HU(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=JC,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=ya(r)),this._initializationPromise=this.queue(async()=>{var n,i;if(!this._deleted&&(this.persistenceManager=await Bc.create(this,e),!this._deleted)){if(!((n=this._popupRedirectResolver)===null||n===void 0)&&n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await n4(this,{idToken:e}),n=await va._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var r;if(ho(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(o,o))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let i=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,o=i==null?void 0:i._redirectEventId,l=await this.tryRedirectSignIn(e);(!a||a===o)&&(l!=null&&l.user)&&(i=l.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(a){i=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return ut(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await rp(e)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=bU()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(ho(this.app))return Promise.reject(xl(this));const r=e?Ps(e):null;return r&&ut(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&ut(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return ho(this.app)?Promise.reject(xl(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return ho(this.app)?Promise.reject(xl(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ya(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await GU(this),r=new XU(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new _0("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await zU(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&ya(e)||this._popupRedirectResolver;ut(r,this,"argument-error"),this.redirectPersistenceManager=await Bc.create(this,[ya(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(r=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,i){if(this._deleted)return()=>{};const s=typeof r=="function"?r:r.next.bind(r);let a=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(ut(o,this,"internal-error"),o.then(()=>{a||s(this.currentUser)}),typeof r=="function"){const l=e.addObserver(r,n,i);return()=>{a=!0,l()}}else{const l=e.addObserver(r);return()=>{a=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ut(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=p4(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);const n=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());n&&(r["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(r["X-Firebase-AppCheck"]=i),r}async _getAppCheckToken(){var e;const r=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return r!=null&&r.error&&CU(`Error while retrieving App Check token: ${r.error}`),r==null?void 0:r.token}}function Gv(t){return Ps(t)}class LE{constructor(e){this.auth=e,this.observer=null,this.addObserver=c9(r=>this.observer=r)}get next(){return ut(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Kv={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function YU(t){Kv=t}function QU(t){return Kv.loadJS(t)}function JU(){return Kv.gapiScript}function ZU(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ez(t,e){const r=cv(t,"auth");if(r.isInitialized()){const i=r.getImmediate(),s=r.getOptions();if($h(s,e??{}))return i;Da(i,"already-initialized")}return r.initialize({options:e})}function tz(t,e){const r=(e==null?void 0:e.persistence)||[],n=(Array.isArray(r)?r:[r]).map(ya);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function rz(t,e,r){const n=Gv(t);ut(n._canInitEmulator,n,"emulator-config-failed"),ut(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const i=!1,s=g4(e),{host:a,port:o}=nz(e),l=o===null?"":`:${o}`;n.config.emulator={url:`${s}//${a}${l}/`},n.settings.appVerificationDisabledForTesting=!0,n.emulatorConfig=Object.freeze({host:a,port:o,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),iz()}function g4(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function nz(t){const e=g4(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const s=i[1];return{host:s,port:BE(n.substr(s.length+1))}}else{const[s,a]=n.split(":");return{host:s,port:BE(a)}}}function BE(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function iz(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m4{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return xa("not implemented")}_getIdTokenResponse(e){return xa("not implemented")}_linkToIdToken(e,r){return xa("not implemented")}_getReauthenticationResolver(e){return xa("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jc(t,e){return DU(t,"POST","/v1/accounts:signInWithIdp",Wv(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sz="http://localhost";class Dl extends m4{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new Dl(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):Da("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:i}=r,s=Vv(r,["providerId","signInMethod"]);if(!n||!i)return null;const a=new Dl(n,i);return a.idToken=s.idToken||void 0,a.accessToken=s.accessToken||void 0,a.secret=s.secret,a.nonce=s.nonce,a.pendingToken=s.pendingToken||null,a}_getIdTokenResponse(e){const r=this.buildRequest();return jc(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,jc(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,jc(e,r)}buildRequest(){const e={requestUri:sz,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=E0(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x4{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I0 extends x4{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class io extends I0{constructor(){super("facebook.com")}static credential(e){return Dl._fromParams({providerId:io.PROVIDER_ID,signInMethod:io.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return io.credentialFromTaggedObject(e)}static credentialFromError(e){return io.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return io.credential(e.oauthAccessToken)}catch{return null}}}io.FACEBOOK_SIGN_IN_METHOD="facebook.com";io.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class so extends I0{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return Dl._fromParams({providerId:so.PROVIDER_ID,signInMethod:so.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return so.credentialFromTaggedObject(e)}static credentialFromError(e){return so.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return so.credential(r,n)}catch{return null}}}so.GOOGLE_SIGN_IN_METHOD="google.com";so.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ao extends I0{constructor(){super("github.com")}static credential(e){return Dl._fromParams({providerId:ao.PROVIDER_ID,signInMethod:ao.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ao.credentialFromTaggedObject(e)}static credentialFromError(e){return ao.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ao.credential(e.oauthAccessToken)}catch{return null}}}ao.GITHUB_SIGN_IN_METHOD="github.com";ao.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oo extends I0{constructor(){super("twitter.com")}static credential(e,r){return Dl._fromParams({providerId:oo.PROVIDER_ID,signInMethod:oo.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return oo.credentialFromTaggedObject(e)}static credentialFromError(e){return oo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return oo.credential(r,n)}catch{return null}}}oo.TWITTER_SIGN_IN_METHOD="twitter.com";oo.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iu{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,i=!1){const s=await va._fromIdTokenResponse(e,n,i),a=jE(n);return new iu({user:s,providerId:a,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const i=jE(n);return new iu({user:e,providerId:i,_tokenResponse:n,operationType:r})}}function jE(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class np extends ja{constructor(e,r,n,i){var s;super(r.code,r.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,np.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,i){return new np(e,r,n,i)}}function v4(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?np._fromErrorAndOperation(t,s,e,n):s})}async function az(t,e,r=!1){const n=await a0(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return iu._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oz(t,e,r=!1){const{auth:n}=t;if(ho(n.app))return Promise.reject(xl(n));const i="reauthenticate";try{const s=await a0(t,v4(n,i,e,t),r);ut(s.idToken,n,"internal-error");const a=$v(s.idToken);ut(a,n,"internal-error");const{sub:o}=a;return ut(t.uid===o,n,"user-mismatch"),iu._forOperation(t,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&Da(n,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lz(t,e,r=!1){if(ho(t.app))return Promise.reject(xl(t));const n="signIn",i=await v4(t,n,e),s=await iu._fromIdTokenResponse(t,n,i);return r||await t._updateCurrentUser(s.user),s}function cz(t,e,r,n){return Ps(t).onIdTokenChanged(e,r,n)}function uz(t,e,r){return Ps(t).beforeAuthStateChanged(e,r)}const ip="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y4{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(ip,"1"),this.storage.removeItem(ip),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fz=1e3,dz=10;class _4 extends y4{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=h4(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),i=this.localCache[r];n!==i&&e(r,i,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((a,o,l)=>{this.notifyListeners(a,l)});return}const n=e.key;r?this.detachListener():this.stopPolling();const i=()=>{const a=this.storage.getItem(n);!r&&this.localCache[n]===a||this.notifyListeners(n,a)},s=this.storage.getItem(n);$U()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,dz):i()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},fz)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}_4.type="LOCAL";const hz=_4;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E4 extends y4{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}E4.type="SESSION";const w4=E4;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pz(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $p{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(i=>i.isListeningto(e));if(r)return r;const n=new $p(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:i,data:s}=r.data,a=this.handlersMap[i];if(!(a!=null&&a.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const o=Array.from(a).map(async c=>c(r.origin,s)),l=await pz(o);r.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:l})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}$p.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xv(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gz{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,a;return new Promise((o,l)=>{const c=Xv("",20);i.port1.start();const d=setTimeout(()=>{l(new Error("unsupported_event"))},n);a={messageChannel:i,onMessage(h){const p=h;if(p.data.eventId===c)switch(p.data.status){case"ack":clearTimeout(d),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),o(p.data.response);break;default:clearTimeout(d),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:c,data:r},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zs(){return window}function mz(t){Zs().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T4(){return typeof Zs().WorkerGlobalScope<"u"&&typeof Zs().importScripts=="function"}async function xz(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function vz(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function yz(){return T4()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S4="firebaseLocalStorageDb",_z=1,sp="firebaseLocalStorage",k4="fbase_key";class b0{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function Hp(t,e){return t.transaction([sp],e?"readwrite":"readonly").objectStore(sp)}function Ez(){const t=indexedDB.deleteDatabase(S4);return new b0(t).toPromise()}function kx(){const t=indexedDB.open(S4,_z);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(sp,{keyPath:k4})}catch(i){r(i)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(sp)?e(n):(n.close(),await Ez(),e(await kx()))})})}async function VE(t,e,r){const n=Hp(t,!0).put({[k4]:e,value:r});return new b0(n).toPromise()}async function wz(t,e){const r=Hp(t,!1).get(e),n=await new b0(r).toPromise();return n===void 0?null:n.value}function UE(t,e){const r=Hp(t,!0).delete(e);return new b0(r).toPromise()}const Tz=800,Sz=3;class A4{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await kx(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>Sz)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return T4()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=$p._getInstance(yz()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var e,r;if(this.activeServiceWorker=await xz(),!this.activeServiceWorker)return;this.sender=new gz(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((e=n[0])===null||e===void 0)&&e.fulfilled&&!((r=n[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||vz()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await kx();return await VE(e,ip,"1"),await UE(e,ip),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>VE(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>wz(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>UE(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=Hp(i,!1).getAll();return new b0(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),r.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),r.push(i));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Tz)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}A4.type="LOCAL";const kz=A4;new F0(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Az(t,e){return e?ya(e):(ut(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qv extends m4{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return jc(e,this._buildIdpRequest())}_linkToIdToken(e,r){return jc(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return jc(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function Cz(t){return lz(t.auth,new qv(t),t.bypassAuthState)}function Fz(t){const{auth:e,user:r}=t;return ut(r,e,"internal-error"),oz(r,new qv(t),t.bypassAuthState)}async function Iz(t){const{auth:e,user:r}=t;return ut(r,e,"internal-error"),az(r,new qv(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C4{constructor(e,r,n,i,s=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:i,tenantId:s,error:a,type:o}=e;if(a){this.reject(a);return}const l={auth:this.auth,requestUri:r,sessionId:n,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Cz;case"linkViaPopup":case"linkViaRedirect":return Iz;case"reauthViaPopup":case"reauthViaRedirect":return Fz;default:Da(this.auth,"internal-error")}}resolve(e){Pa(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Pa(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bz=new F0(2e3,1e4);class kc extends C4{constructor(e,r,n,i,s){super(e,r,i,s),this.provider=n,this.authWindow=null,this.pollId=null,kc.currentPopupAction&&kc.currentPopupAction.cancel(),kc.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ut(e,this.auth,"internal-error"),e}async onExecution(){Pa(this.filter.length===1,"Popup operations only handle one event");const e=Xv();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(Js(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Js(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,kc.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if(!((n=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Js(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,bz.get())};e()}}kc.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rz="pendingRedirect",ih=new Map;class Nz extends C4{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=ih.get(this.auth._key());if(!e){try{const n=await Dz(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}ih.set(this.auth._key(),e)}return this.bypassAuthState||ih.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function Dz(t,e){const r=Mz(e),n=Oz(t);if(!await n._isAvailable())return!1;const i=await n._get(r)==="true";return await n._remove(r),i}function Pz(t,e){ih.set(t._key(),e)}function Oz(t){return ya(t._redirectPersistence)}function Mz(t){return nh(Rz,t.config.apiKey,t.name)}async function Lz(t,e,r=!1){if(ho(t.app))return Promise.reject(xl(t));const n=Gv(t),i=Az(n,e),a=await new Nz(n,i,r).execute();return a&&!r&&(delete a.user._redirectEventId,await n._persistUserIfCurrent(a.user),await n._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bz=10*60*1e3;class jz{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Vz(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!F4(e)){const i=((n=e.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";r.onError(Js(this.auth,i))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Bz&&this.cachedEventUids.clear(),this.cachedEventUids.has(zE(e))}saveEventToCache(e){this.cachedEventUids.add(zE(e)),this.lastProcessedEventTime=Date.now()}}function zE(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function F4({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function Vz(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return F4(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Uz(t,e={}){return xu(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zz=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Wz=/^https?/;async function $z(t){if(t.config.emulator)return;const{authorizedDomains:e}=await Uz(t);for(const r of e)try{if(Hz(r))return}catch{}Da(t,"unauthorized-domain")}function Hz(t){const e=Tx(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const a=new URL(t);return a.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&a.hostname===n}if(!Wz.test(r))return!1;if(zz.test(t))return n===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gz=new F0(3e4,6e4);function WE(){const t=Zs().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function Kz(t){return new Promise((e,r)=>{var n,i,s;function a(){WE(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{WE(),r(Js(t,"network-request-failed"))},timeout:Gz.get()})}if(!((i=(n=Zs().gapi)===null||n===void 0?void 0:n.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=Zs().gapi)===null||s===void 0)&&s.load)a();else{const o=ZU("iframefcb");return Zs()[o]=()=>{gapi.load?a():r(Js(t,"network-request-failed"))},QU(`${JU()}?onload=${o}`).catch(l=>r(l))}}).catch(e=>{throw sh=null,e})}let sh=null;function Xz(t){return sh=sh||Kz(t),sh}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qz=new F0(5e3,15e3),Yz="__/auth/iframe",Qz="emulator/auth/iframe",Jz={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Zz=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function eW(t){const e=t.config;ut(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?zv(e,Qz):`https://${t.config.authDomain}/${Yz}`,n={apiKey:e.apiKey,appName:t.name,v:du},i=Zz.get(t.config.apiHost);i&&(n.eid=i);const s=t._getFrameworks();return s.length&&(n.fw=s.join(",")),`${r}?${E0(n).slice(1)}`}async function tW(t){const e=await Xz(t),r=Zs().gapi;return ut(r,t,"internal-error"),e.open({where:document.body,url:eW(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Jz,dontclear:!0},n=>new Promise(async(i,s)=>{await n.restyle({setHideOnLeave:!1});const a=Js(t,"network-request-failed"),o=Zs().setTimeout(()=>{s(a)},qz.get());function l(){Zs().clearTimeout(o),i(n)}n.ping(l).then(l,()=>{s(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rW={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},nW=500,iW=600,sW="_blank",aW="http://localhost";class $E{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function oW(t,e,r,n=nW,i=iW){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-n)/2,0).toString();let o="";const l=Object.assign(Object.assign({},rW),{width:n.toString(),height:i.toString(),top:s,left:a}),c=qn().toLowerCase();r&&(o=l4(c)?sW:r),a4(c)&&(e=e||aW,l.scrollbars="yes");const d=Object.entries(l).reduce((p,[m,y])=>`${p}${m}=${y},`,"");if(WU(c)&&o!=="_self")return lW(e||"",o),new $E(null);const h=window.open(e||"",o,d);ut(h,t,"popup-blocked");try{h.focus()}catch{}return new $E(h)}function lW(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cW="__/auth/handler",uW="emulator/auth/handler",fW=encodeURIComponent("fac");async function HE(t,e,r,n,i,s){ut(t.config.authDomain,t,"auth-domain-config-required"),ut(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:du,eventId:i};if(e instanceof x4){e.setDefaultLanguage(t.languageCode),a.providerId=e.providerId||"",l9(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,h]of Object.entries({}))a[d]=h}if(e instanceof I0){const d=e.getScopes().filter(h=>h!=="");d.length>0&&(a.scopes=d.join(","))}t.tenantId&&(a.tid=t.tenantId);const o=a;for(const d of Object.keys(o))o[d]===void 0&&delete o[d];const l=await t._getAppCheckToken(),c=l?`#${fW}=${encodeURIComponent(l)}`:"";return`${dW(t)}?${E0(o).slice(1)}${c}`}function dW({config:t}){return t.emulator?zv(t,uW):`https://${t.authDomain}/${cW}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yg="webStorageSupport";class hW{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=w4,this._completeRedirectFn=Lz,this._overrideRedirectResult=Pz}async _openPopup(e,r,n,i){var s;Pa((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const a=await HE(e,r,n,Tx(),i);return oW(e,a,Xv())}async _openRedirect(e,r,n,i){await this._originValidation(e);const s=await HE(e,r,n,Tx(),i);return mz(s),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:i,promise:s}=this.eventManagers[r];return i?Promise.resolve(i):(Pa(s,"If manager is not set, promise should be"),s)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await tW(e),n=new jz(e);return r.register("authEvent",i=>(ut(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:n.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(Yg,{type:Yg},i=>{var s;const a=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[Yg];a!==void 0&&r(!!a),Da(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=$z(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return h4()||o4()||Hv()}}const pW=hW;var GE="@firebase/auth",KE="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gW{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){ut(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mW(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function xW(t){Yc(new Il("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=n.options;ut(a&&!a.includes(":"),"invalid-api-key",{appName:n.name});const l={apiKey:a,authDomain:o,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:p4(t)},c=new qU(n,i,s,l);return tz(c,r),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),Yc(new Il("auth-internal",e=>{const r=Gv(e.getProvider("auth").getImmediate());return(n=>new gW(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),ko(GE,KE,mW(t)),ko(GE,KE,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vW=5*60,yW=wA("authIdTokenMaxAge")||vW;let XE=null;const _W=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>yW)return;const i=r==null?void 0:r.token;XE!==i&&(XE=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function EW(t=AA()){const e=cv(t,"auth");if(e.isInitialized())return e.getImmediate();const r=ez(t,{popupRedirectResolver:pW,persistence:[kz,hz,w4]}),n=wA("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(n,location.origin);if(location.origin===s.origin){const a=_W(s.toString());uz(r,a,()=>a(r.currentUser)),cz(r,o=>a(o))}}const i=_A("auth");return i&&rz(r,`http://${i}`),r}function wW(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}YU({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=i=>{const s=Js("internal-error");s.customData=i,r(s)},n.type="text/javascript",n.charset="UTF-8",wW().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});xW("Browser");const TW={apiKey:"AIzaSyAZZ0804o11q-hS6p7XJZNK_FPGJgXpmPc",authDomain:"finance-automation-b28e8.firebaseapp.com",projectId:"finance-automation-b28e8",storageBucket:"finance-automation-b28e8.firebasestorage.app",messagingSenderId:"832501526859",appId:"1:832501526859:web:3a64f40f9db732af1b78ce"},I4=kA(TW),Yv=aU(I4);EW(I4);const Qg=async(t,e)=>{try{return await TU(Pv(Yv,"appState",t),{masterData:e.masterData||[],ledgerEntries:e.ledgerEntries||[],receipts:e.receipts||[],creditNotes:e.creditNotes||[],openingBalances:e.openingBalances||{},mailerImages:e.mailerImages||{},mailerLogo:e.mailerLogo||null,companyConfig:e.companyConfig||{},nextInvoiceNo:e.nextInvoiceNo||1,nextCombineNo:e.nextCombineNo||1,nextReceiptNo:e.nextReceiptNo||1,nextCreditNoteNo:e.nextCreditNoteNo||1,invoiceValues:e.invoiceValues||{},notifications:e.notifications||[],whatsappSettings:e.whatsappSettings||{},partyMaster:e.partyMaster||[],followups:e.followups||[],updatedAt:new Date().toISOString()}),!0}catch(r){return console.error("Error saving app state:",r),!1}},qE=async t=>{try{const e=await wU(Pv(Yv,"appState",t));return e.exists()?e.data():null}catch(e){return console.error("Error loading app state:",e),null}},SW=(t,e)=>{const r=Pv(Yv,"appState",t);return SU(r,n=>{n.exists()&&e(n.data())},n=>{console.error("Error in real-time listener:",n)})},ct=t=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:2,maximumFractionDigits:2}).format(t||0),zt=t=>""+new Intl.NumberFormat("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2}).format(t||0),hr=t=>{if(!t)return"-";const e=new Date(t);if(isNaN(e.getTime()))return t;const r=e.getDate().toString().padStart(2,"0"),n=e.toLocaleString("en-US",{month:"short"}),i=e.getFullYear();return`${r}-${n}-${i}`},kW=t=>{if(!t)return"-";const e=new Date(t);if(isNaN(e.getTime()))return t;const r=e.getDate(),n=e.toLocaleString("en-US",{month:"short"}),i=e.getFullYear();return`${r}${(a=>{if(a>3&&a<21)return"th";switch(a%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}})(r)} ${n}, ${i}`},AW=t=>{const e=["","One","Two","Three","Four","Five","Six","Seven","Eight","Nine","Ten","Eleven","Twelve","Thirteen","Fourteen","Fifteen","Sixteen","Seventeen","Eighteen","Nineteen"],r=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"];if(t===0)return"Zero";const n=l=>l<20?e[l]:l<100?r[Math.floor(l/10)]+(l%10?" "+e[l%10]:""):e[Math.floor(l/100)]+" Hundred"+(l%100?" "+n(l%100):""),i=l=>l<1e3?n(l):l<1e5?n(Math.floor(l/1e3))+" Thousand"+(l%1e3?" "+n(l%1e3):""):l<1e7?n(Math.floor(l/1e5))+" Lakh"+(l%1e5?" "+i(l%1e5):""):n(Math.floor(l/1e7))+" Crore"+(l%1e7?" "+i(l%1e7):""),s=Math.floor(t),a=Math.round((t-s)*100);let o="INR "+i(s);return a>0&&(o+=" and "+i(a)+" Paise"),o+" Only"},CW=t=>{if(!t)return"";const e=/[\w.-]+@[\w.-]+\.\w+/g,r=t.match(e);return r?r[0]:""},FW=t=>({Approved:{bg:"#DCFCE7",text:"#166534",border:"#86EFAC"},Created:{bg:"#DBEAFE",text:"#1E40AF",border:"#93C5FD"},"Need Edits":{bg:"#FEE2E2",text:"#991B1B",border:"#FCA5A5"},Paid:{bg:"#D1FAE5",text:"#065F46",border:"#6EE7B7"},Individual:{bg:"#E0E7FF",text:"#3730A3",border:"#A5B4FC"},Combined:{bg:"#F3E8FF",text:"#6B21A8",border:"#DDD6FE"},Yes:{bg:"#DCFCE7",text:"#166534",border:"#86EFAC"},No:{bg:"#FEF3C7",text:"#92400E",border:"#FCD34D"},"Not Yet":{bg:"#F1F5F9",text:"#475569",border:"#CBD5E1"},Pending:{bg:"#FEF3C7",text:"#92400E",border:"#FCD34D"},Sent:{bg:"#D1FAE5",text:"#065F46",border:"#6EE7B7"}})[t]||{bg:"#F1F5F9",text:"#475569",border:"#CBD5E1"},Jg=({status:t,small:e=!1})=>{const r=FW(t);return f.jsx("span",{style:{display:"inline-flex",alignItems:"center",padding:e?"2px 8px":"4px 12px",borderRadius:"6px",fontSize:e?"11px":"12px",fontWeight:"600",backgroundColor:r.bg,color:r.text,border:`1px solid ${r.border}`},children:t})},Ye=({icon:t,label:e,onClick:r,variant:n="default",disabled:i=!1,small:s=!1})=>{const o={default:{bg:"#F8FAFC",hoverBg:"#E2E8F0",text:"#475569",border:"#CBD5E1"},primary:{bg:"#2874A6",hoverBg:"#1a5276",text:"#FFFFFF",border:"#2874A6"},success:{bg:"#059669",hoverBg:"#047857",text:"#FFFFFF",border:"#059669"},warning:{bg:"#D97706",hoverBg:"#B45309",text:"#FFFFFF",border:"#D97706"},danger:{bg:"#DC2626",hoverBg:"#B91C1C",text:"#FFFFFF",border:"#DC2626"},brand:{bg:"#2874A6",hoverBg:"#1a5276",text:"#FFFFFF",border:"#2874A6"},purple:{bg:"#7C3AED",hoverBg:"#6D28D9",text:"#FFFFFF",border:"#7C3AED"}}[n];return f.jsxs("button",{onClick:r,disabled:i,title:e,style:{display:"inline-flex",alignItems:"center",gap:"6px",padding:s?"5px 10px":"8px 14px",borderRadius:"6px",fontSize:s?"11px":"13px",fontWeight:"600",backgroundColor:i?"#F1F5F9":o.bg,color:i?"#94A3B8":o.text,border:`1px solid ${i?"#E2E8F0":o.border}`,cursor:i?"not-allowed":"pointer",transition:"all 0.15s ease",whiteSpace:"nowrap",opacity:i?.6:1},onMouseEnter:l=>!i&&(l.target.style.backgroundColor=o.hoverBg),onMouseLeave:l=>!i&&(l.target.style.backgroundColor=o.bg),children:[t&&f.jsx(t,{size:s?14:16}),e&&f.jsx("span",{children:e})]})},pr=({label:t,type:e="text",value:r,onChange:n,placeholder:i,disabled:s,small:a})=>f.jsxs("div",{style:{marginBottom:a?"12px":"16px"},children:[t&&f.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:t}),f.jsx("input",{type:e,value:r,onChange:n,placeholder:i,disabled:s,style:{width:"100%",padding:a?"8px 12px":"10px 14px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:a?"13px":"14px",backgroundColor:s?"#F9FAFB":"#FFFFFF",boxSizing:"border-box"}})]}),Ld=({label:t,value:e,onChange:r,options:n,small:i})=>f.jsxs("div",{style:{marginBottom:i?"12px":"16px"},children:[t&&f.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:t}),f.jsx("select",{value:e,onChange:r,style:{width:"100%",padding:i?"8px 12px":"10px 14px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:i?"13px":"14px",backgroundColor:"#FFFFFF",boxSizing:"border-box"},children:n.map(s=>f.jsx("option",{value:s.value,children:s.label},s.value))})]}),mn=({title:t,children:e,actions:r,noPadding:n=!1})=>f.jsxs("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"12px",border:"1px solid #E2E8F0",boxShadow:"0 2px 8px rgba(0,0,0,0.06)",overflow:"hidden"},children:[t&&f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"14px 20px",borderBottom:"1px solid #E2E8F0",backgroundColor:"#FAFBFC"},children:[f.jsx("h3",{style:{margin:0,fontSize:"15px",fontWeight:"700",color:"#1E293B"},children:t}),r&&f.jsx("div",{style:{display:"flex",gap:"10px"},children:r})]}),f.jsx("div",{style:{padding:n?0:"20px"},children:e})]}),xn=({isOpen:t,onClose:e,title:r,children:n,width:i="500px"})=>t?f.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(15, 23, 42, 0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,backdropFilter:"blur(4px)"},onClick:e,children:f.jsxs("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"16px",width:i,maxWidth:"95vw",maxHeight:"90vh",overflow:"hidden",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)"},onClick:s=>s.stopPropagation(),children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"16px 20px",borderBottom:"1px solid #E2E8F0",backgroundColor:"#FAFBFC"},children:[f.jsx("h2",{style:{margin:0,fontSize:"16px",fontWeight:"700",color:"#1E293B"},children:r}),f.jsx("button",{onClick:e,style:{background:"none",border:"none",cursor:"pointer",padding:"4px",color:"#64748B"},children:f.jsx(rl,{size:20})})]}),f.jsx("div",{style:{padding:"20px",maxHeight:"calc(90vh - 100px)",overflowY:"auto"},children:n})]})}):null;function IW(){const[t,e]=ve.useState(()=>{const g=localStorage.getItem("financeAppLogin");return g?JSON.parse(g).isLoggedIn:!1}),[r,n]=ve.useState(()=>{const g=localStorage.getItem("financeAppLogin");return g?JSON.parse(g).userRole:null}),[i,s]=ve.useState({username:"",password:""}),[a,o]=ve.useState(""),[l,c]=ve.useState(!1),[d,h]=ve.useState(!1),[p,m]=ve.useState(null),[y,x]=ve.useState({finance:"finance123",director:"director123"}),[E,T]=ve.useState(!1),[k,_]=ve.useState(!1),[P,W]=ve.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[B,w]=ve.useState(""),C={finance:{role:"finance",name:"Finance Team"},director:{role:"director",name:"Director"}};ve.useEffect(()=>{(async()=>{try{const I=await qE("indreesh-media");I&&I.userPasswords&&(x(I.userPasswords),console.log("Passwords loaded from Firebase"))}catch(I){console.error("Error loading passwords:",I)}T(!0)})()},[]);const[S,b]=ve.useState({name:"Indreesh Media LLP",brand:"JAC",address:"A-1701 Sweet Home CHS LTD, SVP, Plot No: 24",addressLine2:"Andheri West, Nr Last Bus St",city:"Mumbai-400053",gstin:"27AAIFI6351A1ZM",stateCode:"27",stateName:"Maharashtra",email:"alliances@mediabrief.com",phone:"+91 7021911036",website:"www.mediabrief.com",pan:"AAIFI6351A",bank:{name:"Axis Bank",account:"921020009075531",branch:"Andheri",ifsc:"UTIB0000020",holder:"Indreesh Media LLP"},invoicePrefix:"MB/2025-26/",hsnCode:"998365",gstRate:18}),[N,D]=ve.useState("master"),[R,Ue]=ve.useState(!1),[ge,Fe]=ve.useState([]),[Ee,xe]=ve.useState([]),[J,ke]=ve.useState([]),[Me,j]=ve.useState([]),[H,q]=ve.useState(null),[X,de]=ve.useState(1),[we,Ne]=ve.useState(1),[Te,_e]=ve.useState(1),[rt,G]=ve.useState(1),[Vt,gt]=ve.useState(!1),[Rt,dt]=ve.useState(!1),[$e,Zt]=ve.useState(!1),[fn,$r]=ve.useState(!1),[li,ji]=ve.useState(!1),[ci,Ar]=ve.useState(!1),[ui,Mt]=ve.useState(!1),[mr,nr]=ve.useState(!1),[Qn,ot]=ve.useState(!1),[ir,xr]=ve.useState(!1),[ur,Fn]=ve.useState(!1),[ae,Br]=ve.useState(null),[ia,sa]=ve.useState("reply"),[Os,aa]=ve.useState(""),[wi,Vi]=ve.useState(""),[vr,Ui]=ve.useState({fromDate:"2020-01-01",toDate:new Date().toISOString().split("T")[0]}),[Va,Ua]=ve.useState(""),[In,Ms]=ve.useState("open"),[er,fr]=ve.useState({party:"",invoiceStatus:"",receiptStatus:"",invoiceType:"",searchText:""}),[Ti,dn]=ve.useState([]),[oa,$l]=ve.useState(!1),[fs,F]=ve.useState([]),[U,L]=ve.useState(!1),[M,z]=ve.useState(null),[V,le]=ve.useState({date:new Date().toISOString().split("T")[0],notes:"",nextFollowupDate:"",status:"Pending"}),[ie,oe]=ve.useState({enabled:!1,financePhone:"",financeApiKey:"",directorPhone:"",directorApiKey:""}),[te,ce]=ve.useState({amount:"",tds:"",discount:"",narration:"",paymentAdvisory:null,date:new Date().toISOString().split("T")[0],mode:"Bank"}),[me,Pe]=ve.useState({amount:"",gst:"",reason:"",date:new Date().toISOString().split("T")[0]}),[He,Ce]=ve.useState({particularsApproved:!1,emailApproved:!1,invoiceTypeApproved:!1}),[ze,nt]=ve.useState(null),[_t,kt]=ve.useState(new Set),[Et,Jn]=ve.useState({}),[hn,Si]=ve.useState(null),[pn,ki]=ve.useState(null),[gn,za]=ve.useState(!1),[Zn,Wo]=ve.useState({}),[fi,Hl]=ve.useState({partyName:"",amount:"",type:"Dr"}),[ds,Gl]=ve.useState({}),[Zr,zi]=ve.useState({}),[hs,la]=ve.useState(!1),[$o,Kl]=ve.useState(new Set),[Xe,Ls]=ve.useState({party:"",billStatus:"",invoiceStatus:"",mailingStatus:"",invoiceType:"",combinationCode:"",searchText:""}),[Qt,Wi]=ve.useState({amount:"",date:new Date().toISOString().split("T")[0],mode:"Bank",tds:"",discount:"",narration:""}),R0=ve.useRef(null),vu=ve.useRef(null),yu=ve.useRef(null),N0=ve.useRef(null),D0=ve.useRef(null),P0=ve.useRef(null),ps=ve.useRef(null),gs=ve.useRef(null),_u=ve.useRef(null),bn=ve.useMemo(()=>Array.isArray(ge)?ge:[],[ge]),$i=ve.useMemo(()=>Array.isArray(Ee)?Ee:[],[Ee]),ms=ve.useMemo(()=>Array.isArray(J)?J:[],[J]),Xl=ve.useMemo(()=>Array.isArray(Me)?Me:[],[Me]),O0=ve.useMemo(()=>Array.isArray(Ti)?Ti:[],[Ti]),ql=ve.useMemo(()=>Array.isArray(fs)?fs:[],[fs]),xs=ve.useMemo(()=>Zr&&typeof Zr=="object"&&!Array.isArray(Zr)?Zr:{},[Zr]),Yl=ve.useMemo(()=>Zn&&typeof Zn=="object"&&!Array.isArray(Zn)?Zn:{},[Zn]),Ql=ve.useRef(!1),Hi=ve.useRef(null),Ho=async()=>{c(!0);try{const g=await qE("indreesh-media");g&&(Array.isArray(g.masterData)&&Fe(g.masterData),Array.isArray(g.ledgerEntries)&&xe(g.ledgerEntries),Array.isArray(g.receipts)&&ke(g.receipts),Array.isArray(g.creditNotes)&&j(g.creditNotes),Array.isArray(g.notifications)&&dn(g.notifications),Array.isArray(g.followups)&&F(g.followups),g.openingBalances&&typeof g.openingBalances=="object"&&!Array.isArray(g.openingBalances)&&Wo(g.openingBalances),g.mailerImages&&typeof g.mailerImages=="object"&&!Array.isArray(g.mailerImages)&&Jn(g.mailerImages),g.partyMaster&&typeof g.partyMaster=="object"&&!Array.isArray(g.partyMaster)&&zi(g.partyMaster),g.userPasswords&&typeof g.userPasswords=="object"&&!Array.isArray(g.userPasswords)&&x(g.userPasswords),g.mailerLogo&&Si(g.mailerLogo),g.companyConfig&&b(I=>({...I,...g.companyConfig})),g.nextInvoiceNo&&de(g.nextInvoiceNo),g.nextCombineNo&&Ne(g.nextCombineNo),g.nextReceiptNo&&_e(g.nextReceiptNo),g.nextCreditNoteNo&&G(g.nextCreditNoteNo),g.invoiceValues&&Gl(g.invoiceValues),g.whatsappSettings&&oe(I=>({...I,...g.whatsappSettings})),console.log("Data loaded from Firebase"))}catch(g){console.error("Error loading data:",g)}c(!1)},Eu=ve.useCallback(async()=>{h(!0);try{await Qg("indreesh-media",{masterData:ge,ledgerEntries:Ee,receipts:J,creditNotes:Me,openingBalances:Zn,mailerImages:Et,mailerLogo:hn,companyConfig:S,nextInvoiceNo:X,nextCombineNo:we,nextReceiptNo:Te,nextCreditNoteNo:rt,invoiceValues:ds,notifications:Ti,whatsappSettings:ie,partyMaster:Zr,followups:fs,userPasswords:y}),m(new Date),console.log("Data saved to Firebase")}catch(g){console.error("Error saving data:",g)}h(!1)},[ge,Ee,J,Me,Zn,Et,hn,S,X,we,Te,rt,ds,Ti,ie,Zr,fs,y]);ve.useEffect(()=>{if(t&&!Ql.current)return ps.current&&clearTimeout(ps.current),ps.current=setTimeout(()=>{Ql.current||Eu()},1e3),()=>{ps.current&&clearTimeout(ps.current)}},[ge,Ee,J,Me,Zn,Et,hn,S,X,we,Te,rt,ds,Ti,ie,Zr,fs,y,t]);const Go=async(g,I,Y)=>{if(!ie.enabled){console.log("WhatsApp notifications not enabled");return}Y==="finance"&&ie.financePhone&&ie.financeApiKey?vs(ie.financePhone,ie.financeApiKey,g,I):Y==="director"&&ie.directorPhone&&ie.directorApiKey?vs(ie.directorPhone,ie.directorApiKey,g,I):Y==="all"&&(ie.financePhone&&ie.financeApiKey&&vs(ie.financePhone,ie.financeApiKey,g,I),ie.directorPhone&&ie.directorApiKey&&vs(ie.directorPhone,ie.directorApiKey,g,I))},vs=async(g,I,Y,ee)=>{try{const K=`*${{upload:" DATA UPLOAD",invoice:" INVOICE",approval:" APPROVED",edit:" EDIT REQUIRED",receipt:" PAYMENT",info:" UPDATE"}[Y]||" NOTIFICATION"}*

${ee}

_${S.name}_
_${new Date().toLocaleString("en-IN",{timeZone:"Asia/Kolkata"})}_`,ne=`https://api.callmebot.com/whatsapp.php?phone=${g}&text=${encodeURIComponent(K)}&apikey=${I}`;fetch(ne,{mode:"no-cors"}).then(()=>console.log("WhatsApp notification sent to:",g)).catch(Le=>console.log("WhatsApp send attempted:",g))}catch(Q){console.error("Failed to send WhatsApp notification:",Q)}},wu=(g,I)=>{if(!g||!I){alert("Please enter phone number and API key first");return}vs(g,I,"info","Test notification from Indreesh Media LLP. WhatsApp notifications are working!"),alert("Test message sent! Check your WhatsApp.")},Gi=(g,I,Y="all")=>{const ee={id:Date.now()+Math.random(),type:g,message:I,forRole:Y,createdAt:new Date().toISOString(),createdBy:r,read:{finance:!1,director:!1}};dn(Q=>[ee,...Q].slice(0,50)),Go(g,I,Y)},dr=g=>{dn(I=>(Array.isArray(I)?I:[]).map(ee=>ee.id===g?{...ee,read:{...ee.read,[r]:!0}}:ee))},Gp=()=>{dn(g=>(Array.isArray(g)?g:[]).map(Y=>({...Y,read:{...Y.read,[r]:!0}})))},Kp=()=>{dn([])},Ko=ve.useMemo(()=>O0.filter(g=>g.forRole==="all"||g.forRole===r||g.createdBy!==r).map(g=>({...g,read:g.read||{finance:!1,director:!1}})),[O0,r]),Ki=ve.useMemo(()=>r?Ko.filter(g=>!(g.read&&g.read[r])).length:0,[Ko,r]),Tu=async()=>{const g=C[i.username.toLowerCase()],I=y[i.username.toLowerCase()];g&&I===i.password?(e(!0),n(g.role),localStorage.setItem("financeAppLogin",JSON.stringify({isLoggedIn:!0,userRole:g.role})),o(""),s({username:"",password:""}),await Ho()):o("Invalid username or password")},Wa=async()=>{if(!P.currentPassword||!P.newPassword||!P.confirmPassword){w("Please fill all fields");return}const g=r==="director"?"director":"finance";if(y[g]!==P.currentPassword){w("Current password is incorrect");return}if(P.newPassword!==P.confirmPassword){w("New passwords do not match");return}if(P.newPassword.length<6){w("Password must be at least 6 characters");return}const I={...y,[g]:P.newPassword};x(I);try{await Qg("indreesh-media",{masterData:ge,ledgerEntries:Ee,receipts:J,creditNotes:Me,openingBalances:Zn,mailerImages:Et,mailerLogo:hn,companyConfig:S,nextInvoiceNo:X,nextCombineNo:we,nextReceiptNo:Te,nextCreditNoteNo:rt,invoiceValues:ds,notifications:Ti,whatsappSettings:ie,partyMaster:Zr,followups:fs,userPasswords:I}),console.log("Password saved to Firebase")}catch(Y){console.error("Error saving password:",Y),w("Failed to save password. Please try again.");return}_(!1),W({currentPassword:"",newPassword:"",confirmPassword:""}),w(""),alert(" Password changed successfully!")},M0=()=>{Eu(),e(!1),n(null),D("master"),localStorage.removeItem("financeAppLogin")};ve.useEffect(()=>{const g=localStorage.getItem("financeAppLogin");if(g){const{isLoggedIn:I}=JSON.parse(g);I&&Ho()}},[]),ve.useEffect(()=>{if(!t){Hi.current&&(Hi.current(),Hi.current=null);return}return Hi.current=SW("indreesh-media",g=>{g&&(Ql.current=!0,Array.isArray(g.masterData)&&Fe(g.masterData),Array.isArray(g.ledgerEntries)&&xe(g.ledgerEntries),Array.isArray(g.receipts)&&ke(g.receipts),Array.isArray(g.creditNotes)&&j(g.creditNotes),Array.isArray(g.notifications)&&dn(g.notifications),Array.isArray(g.followups)&&F(g.followups),g.openingBalances&&typeof g.openingBalances=="object"&&!Array.isArray(g.openingBalances)&&Wo(g.openingBalances),g.mailerImages&&typeof g.mailerImages=="object"&&!Array.isArray(g.mailerImages)&&Jn(g.mailerImages),g.partyMaster&&typeof g.partyMaster=="object"&&!Array.isArray(g.partyMaster)&&zi(g.partyMaster),g.userPasswords&&typeof g.userPasswords=="object"&&!Array.isArray(g.userPasswords)&&x(g.userPasswords),g.mailerLogo&&Si(g.mailerLogo),g.companyConfig&&b(I=>({...I,...g.companyConfig})),g.nextInvoiceNo&&de(g.nextInvoiceNo),g.nextCombineNo&&Ne(g.nextCombineNo),g.nextReceiptNo&&_e(g.nextReceiptNo),g.nextCreditNoteNo&&G(g.nextCreditNoteNo),g.invoiceValues&&Gl(g.invoiceValues),g.whatsappSettings&&oe(I=>({...I,...g.whatsappSettings})),setTimeout(()=>{Ql.current=!1},500),console.log("Real-time sync: Data updated from Firebase"))}),()=>{Hi.current&&(Hi.current(),Hi.current=null)}},[t]);const Ft=r==="finance",Rn=r==="director",Xo=ve.useMemo(()=>{const g=bn.map(ne=>ne.partyName),I=Object.keys(xs),Y=$i.map(ne=>ne.partyName),ee=Object.keys(Yl),Q=[...g,...I,...Y,...ee];return[...new Set(Q)].filter(Boolean).sort()},[bn,xs,$i,Yl]);ve.useMemo(()=>[...new Set(bn.filter(I=>I.combinationCode&&I.combinationCode!=="NA").map(I=>I.combinationCode))].sort((I,Y)=>parseInt(I)-parseInt(Y)),[bn]);const ca=ve.useMemo(()=>bn.filter(g=>{var I,Y,ee,Q,K,ne;if(Xe.party&&g.partyName!==Xe.party||Xe.billStatus&&g.toBeBilled!==Xe.billStatus||Xe.invoiceStatus&&(Xe.invoiceStatus==="Generated"&&!g.invoiceGenerated||Xe.invoiceStatus==="Not Generated"&&g.invoiceGenerated||Xe.invoiceStatus==="Paid"&&g.invoiceStatus!=="Paid")||Xe.mailingStatus&&g.mailingSent!==Xe.mailingStatus||Xe.invoiceType&&g.invoiceType!==Xe.invoiceType||Xe.combinationCode&&g.combinationCode!==Xe.combinationCode)return!1;if(Xe.searchText){const Le=Xe.searchText.toLowerCase();if(!(((I=g.senderName)==null?void 0:I.toLowerCase().includes(Le))||((Y=g.subject)==null?void 0:Y.toLowerCase().includes(Le))||((ee=g.campaignName)==null?void 0:ee.toLowerCase().includes(Le))||((Q=g.invoiceNo)==null?void 0:Q.toLowerCase().includes(Le))||((K=g.partyName)==null?void 0:K.toLowerCase().includes(Le))||((ne=g.emailId)==null?void 0:ne.toLowerCase().includes(Le))))return!1}return!0}),[bn,Xe]);ve.useMemo(()=>{const g={};return ca.forEach(I=>{g[I.partyName]||(g[I.partyName]=[]),g[I.partyName].push(I)}),Object.keys(g).forEach(I=>{g[I].sort((Y,ee)=>Y.toBeBilled==="Yes"&&ee.toBeBilled!=="Yes"?-1:Y.toBeBilled!=="Yes"&&ee.toBeBilled==="Yes"?1:0)}),g},[ca]),ve.useMemo(()=>{if(!H)return[];const g=Yl[H]||0;let I=g;const Y=$i.filter(ee=>ee.partyName===H).sort((ee,Q)=>new Date(ee.date)-new Date(Q.date)).map(ee=>(I=I+ee.debit-ee.credit,{...ee,balance:I}));return g!==0?[{id:"opening",date:"",particulars:"Opening Balance",debit:g>0?g:0,credit:g<0?Math.abs(g):0,balance:g,isOpening:!0},...Y]:Y},[H,$i,Yl]);const L0=g=>bn.filter(I=>I.partyName===g&&I.toBeBilled==="Yes"&&!I.invoiceGenerated&&I.invoiceAmount),Su=g=>!g||g==="NA"?!1:bn.some(I=>I.combinationCode===g&&I.mailingSent==="Yes"),Xi=g=>g.invoiceType==="Combined"&&g.combinationCode!=="NA"?bn.filter(I=>I.combinationCode===g.combinationCode):[g],B0=()=>{Ls({party:"",billStatus:"",invoiceStatus:"",mailingStatus:"",invoiceType:"",combinationCode:"",searchText:""})},$a=Object.values(Xe).some(g=>g!==""),qo=g=>{const I=[];return g.emailId&&I.push(g.emailId),g.additionalEmails&&g.additionalEmails.length>0&&I.push(...g.additionalEmails),I},j0=(g,I)=>{!I||!I.includes("@")||Fe(Y=>Y.map(ee=>{if(ee.id===g){const Q=ee.additionalEmails||[];if(!Q.includes(I)&&I!==ee.emailId)return{...ee,additionalEmails:[...Q,I]}}return ee}))},Yo=(g,I)=>{Fe(Y=>Y.map(ee=>ee.id===g?{...ee,additionalEmails:(ee.additionalEmails||[]).filter(Q=>Q!==I)}:ee))},V0=g=>{Br(g),Vi(g.editComments||g.approvalRemarks||""),Ce({particularsApproved:g.particularsApproved||!1,emailApproved:g.emailApproved||!1,invoiceTypeApproved:g.invoiceTypeApproved||!1}),Mt(!0)},U0=()=>{if(!ae)return;if(!He.particularsApproved||!He.emailApproved||!He.invoiceTypeApproved){alert("Please confirm all approval checkboxes before approving.");return}const g={invoiceStatus:"Approved",approvalRemarks:wi.trim()||"",editComments:"",particularsApproved:!0,emailApproved:!0,invoiceTypeApproved:!0,approvedBy:r,approvedDate:new Date().toISOString()};let I=[];ae.invoiceType==="Combined"&&ae.combinationCode!=="NA"?(I=ge.filter(ne=>ne.combinationCode===ae.combinationCode),Fe(ne=>ne.map(Le=>Le.combinationCode===ae.combinationCode?{...Le,...g}:Le))):(I=[ae],Fe(ne=>ne.map(Le=>Le.id===ae.id?{...Le,...g}:Le)));const Y=parseFloat(ae.invoiceTotalAmount)||0,ee=I.map(ne=>{var Le,Ke;return ne.senderName||((Ke=(Le=ne.campaignName)==null?void 0:Le.split("--")[0])==null?void 0:Ke.trim())}).join(", "),Q=`${ae.invoiceNo} - ${ee}`;xe(ne=>[...ne,{id:Date.now(),partyName:ae.partyName,date:ae.invoiceDate,particulars:"Promotional Trade Mailer",narration:Q,debit:Y,credit:0,type:"invoice",invoiceNo:ae.invoiceNo,combinationCode:ae.combinationCode}]);const K=wi.trim()?` | Remarks: "${wi.trim()}"`:"";Gi("approval",` Invoice ${ae.invoiceNo} has been APPROVED by Director${K} - ready for mailing`,"finance"),Mt(!1),Br(null),Ce({particularsApproved:!1,emailApproved:!1,invoiceTypeApproved:!1}),Vi(""),alert(` Invoice Approved!

The invoice is now ready for mailing.`)},ku=()=>{if(!ae)return;const g=wi.trim();ae.invoiceType==="Combined"&&ae.combinationCode!=="NA"?Fe(Y=>Y.map(ee=>ee.combinationCode===ae.combinationCode?{...ee,invoiceStatus:"Need Edits",editComments:g,approvalRemarks:""}:ee)):Fe(Y=>Y.map(ee=>ee.id===ae.id?{...ee,invoiceStatus:"Need Edits",editComments:g,approvalRemarks:""}:ee));const I=g?`: "${g}"`:"";Gi("edit",` Invoice ${ae.invoiceNo} marked as NEED EDITS by Director${I}`,"finance"),Mt(!1),Br(null),Vi("")},Jl=g=>{Br(g);const I=parseFloat(g.invoiceTotalAmount)||0;ce({amount:I.toFixed(2),tds:"",discount:"",narration:"",paymentAdvisory:null,date:new Date().toISOString().split("T")[0],mode:"Bank"}),ot(!0)},z0=()=>{if(!ae||!te.amount){alert("Please enter receipt amount");return}if(ae.invoiceStatus!=="Approved"){alert("Receipt cannot be posted. Invoice must be approved first.");return}if(!ae.isHistorical&&ae.mailingSent!=="Yes"){alert("Receipt cannot be posted. Invoice must be mailed first.");return}const g=`RCP/${new Date().getFullYear()}-${String(new Date().getFullYear()+1).slice(-2)}/${Te}`,I=parseFloat(te.amount)||0,Y=parseFloat(te.tds)||0,ee=parseFloat(te.discount)||0,Q=I+Y+ee,K=Xi(ae),ne=K.map(Ge=>Ge.subject||Ge.senderName).join(", "),Le=ne.length>50?ne.substring(0,47)+"...":ne,Ke={id:Date.now(),receiptNo:g,invoiceNo:ae.invoiceNo,partyName:ae.partyName,date:te.date,amount:I,tds:Y,discount:ee,totalCredit:Q,narration:te.narration,paymentAdvisory:te.paymentAdvisory,mode:te.mode,campaigns:K.map(Ge=>({senderName:Ge.senderName,subject:Ge.subject}))};ke(Ge=>[...Ge,Ke]);const fe=te.narration||Le;I>0&&xe(Ge=>[...Ge,{id:Date.now(),partyName:ae.partyName,date:te.date,particulars:`Payment Received - ${fe}`,narration:`${ae.invoiceNo} | ${te.mode}`,debit:0,credit:I,type:"receipt",receiptNo:g,invoiceNo:ae.invoiceNo,paymentAdvisory:te.paymentAdvisory}]),Y>0&&xe(Ge=>[...Ge,{id:Date.now()+1,partyName:ae.partyName,date:te.date,particulars:"TDS Deducted",narration:`Against ${ae.invoiceNo}`,debit:0,credit:Y,type:"tds",receiptNo:g,invoiceNo:ae.invoiceNo}]),ee>0&&xe(Ge=>[...Ge,{id:Date.now()+2,partyName:ae.partyName,date:te.date,particulars:"Discount Given",narration:`Against ${ae.invoiceNo}`,debit:0,credit:ee,type:"discount",receiptNo:g,invoiceNo:ae.invoiceNo}]);const Ie=parseFloat(ae.invoiceTotalAmount)||0,qe=Me.find(Ge=>Ge.invoiceNo===ae.invoiceNo),re=qe?Math.abs(parseFloat(qe.totalAmount)||0):0,ue=Ie-Q-re<=0;ae.invoiceType==="Combined"&&ae.combinationCode!=="NA"?Fe(Ge=>Ge.map(Se=>Se.combinationCode===ae.combinationCode?{...Se,receiptStatus:ue?"Closed":"Received",receiptNo:g,receiptDate:te.date}:Se)):ae.isHistorical||Fe(Ge=>Ge.map(Se=>Se.id===ae.id?{...Se,receiptStatus:ue?"Closed":"Received",receiptNo:g,receiptDate:te.date}:Se)),_e(Ge=>Ge+1),Gi("receipt",` Payment received for ${ae.partyName} - Receipt ${g} - ${ct(Q)}`,"director"),ot(!1),Br(null),ce({amount:"",tds:"",discount:"",narration:"",paymentAdvisory:null,date:new Date().toISOString().split("T")[0],mode:"Bank"}),alert(` Receipt Created!

Receipt No: ${g}
Amount: ${ct(Q)}`)},Qo=g=>{Br(g),Pe({amount:"",tds:"",discount:"",reason:"",date:new Date().toISOString().split("T")[0]}),xr(!0)},W0=()=>{var Ge;if(!ae||!me.amount&&!me.gst||!me.reason){alert("Please enter Amount and/or GST and reason");return}const g=ae.invoiceNo.match(/(\d{4}-\d{2})/),I=g?g[1]:`${new Date().getFullYear()}-${String(new Date().getFullYear()+1).slice(-2)}`,Y=ae.invoiceNo.split("/").pop(),ee=`CN/${I}/${Y}`,Q=parseFloat(me.amount)||0,K=parseFloat(me.gst)||0,ne=Q+K,Ke=((Ge=ae.statePartyDetails)==null?void 0:Ge.toUpperCase().includes("MAHARASHTRA"))?"CGST/SGST":"IGST",fe={id:Date.now(),creditNoteNo:ee,invoiceNo:ae.invoiceNo,partyName:ae.partyName,date:me.date,amount:Q,gst:K,gstType:Ke,totalAmount:ne,reason:me.reason};j(Se=>[...Se,fe]);const Ie=parseFloat(ae.invoiceTotalAmount)||0,qe=J.find(Se=>Se.invoiceNo===ae.invoiceNo),re=qe?parseFloat(qe.amount)+parseFloat(qe.tds||0)+parseFloat(qe.discount||0):0,Oe=ne>=Ie-re;ae.isHistorical||Fe(Se=>Se.map(We=>We.invoiceNo===ae.invoiceNo?{...We,creditNoteNo:ee,receiptStatus:Oe?"Cancelled":We.receiptStatus}:We)),G(Se=>Se+1),xr(!1),Br(null),Pe({amount:"",gst:"",reason:"",date:new Date().toISOString().split("T")[0]});let ue=` Credit Note Created!

Credit Note No: ${ee}`;Q>0&&(ue+=`
Base Amount: ${ct(Q)}`),K>0&&(ue+=`
${Ke}: ${ct(K)}`),ue+=`
Total: ${ct(ne)}`,Oe&&(ue+=`

 Invoice fully covered by CN - marked as Cancelled`),alert(ue)},$0=g=>{var ee;const I=(ee=g.target.files)==null?void 0:ee[0];if(!I)return;const Y=new FileReader;Y.onload=Q=>{ce(K=>({...K,paymentAdvisory:Q.target.result}))},Y.readAsDataURL(I),g.target.value=""},ys=g=>{Br(g),nr(!0)},H0=()=>{if(!ae)return;const g=ae.invoiceNo;ae.invoiceType==="Combined"&&ae.combinationCode!=="NA"?Fe(ee=>ee.map(Q=>Q.combinationCode===ae.combinationCode?{...Q,invoiceNo:"",invoiceDate:"",invoiceTotalAmount:"",invoiceGenerated:!1,invoiceStatus:"Pending",invoiceType:"Individual",combinationCode:"NA",mailingSent:"No",mailDate:"",editComments:"",receiptStatus:"",receiptNo:"",receiptDate:""}:Q)):Fe(ee=>ee.map(Q=>Q.id===ae.id?{...Q,invoiceNo:"",invoiceDate:"",invoiceTotalAmount:"",invoiceGenerated:!1,invoiceStatus:"Pending",invoiceType:"Individual",combinationCode:"NA",mailingSent:"No",mailDate:"",editComments:"",receiptStatus:"",receiptNo:"",receiptDate:""}:Q)),xe(ee=>ee.filter(Q=>Q.invoiceNo!==g));const I=J.filter(ee=>ee.invoiceNo===g);I.length>0&&ke(ee=>ee.filter(Q=>Q.invoiceNo!==g)),nr(!1),Br(null);const Y=I.length>0?`
${I.length} receipt(s) also deleted.`:"";alert(` Invoice ${g} deleted.${Y}

You can now regenerate the invoice.`)},G0=g=>{confirm(`Delete Receipt ${g.receiptNo}?

This will also update the invoice status back to Pending.`)&&(ke(I=>I.filter(Y=>Y.id!==g.id)),Fe(I=>I.map(Y=>Y.invoiceNo===g.invoiceNo?{...Y,receiptStatus:"",receiptNo:"",receiptDate:""}:Y)),alert(` Receipt ${g.receiptNo} deleted.`))},K0=g=>{confirm(`Delete Credit Note ${g.creditNoteNo}?

This will remove the CN association from the invoice.`)&&(j(I=>I.filter(Y=>Y.id!==g.id)),Fe(I=>I.map(Y=>Y.invoiceNo===g.invoiceNo?{...Y,creditNoteNo:""}:Y)),alert(` Credit Note ${g.creditNoteNo} deleted.`))},X0=g=>{confirm(`Delete historical entry?

Vch No: ${g.vchNo||"N/A"}
Amount: ${g.debit||g.credit}

This action cannot be undone.`)&&(xe(I=>I.filter(Y=>Y.id!==g.id)),alert(" Historical entry deleted."))},Zl=()=>{if(!H||!confirm(`Delete ALL historical entries for "${H}"?

This will remove all imported historical data for this party.`))return;const g=Ee.filter(I=>I.partyName===H&&I.isHistorical).length;xe(I=>I.filter(Y=>!(Y.partyName===H&&Y.isHistorical))),alert(` ${g} historical entries deleted for ${H}.`)},ei=g=>{z(g),le({date:new Date().toISOString().split("T")[0],notes:"",nextFollowupDate:"",status:"Pending"}),L(!0)},q0=()=>{var I,Y;if(!M)return;const g={id:Date.now(),invoiceNo:M.invoiceNo,partyName:M.partyName,invoiceDate:M.invoiceDate||M.date,invoiceAmount:M.invoiceTotalAmount||M.totalAmount,subject:((Y=(I=M.campaigns)==null?void 0:I[0])==null?void 0:Y.subject)||M.subject||"",followupDate:V.date,notes:V.notes,nextFollowupDate:V.nextFollowupDate,status:V.status};F(ee=>[...ee,g]),L(!1),z(null),Gi("followup",`Followup added for ${M.invoiceNo}`,"all"),alert(` Followup recorded for ${M.invoiceNo}`)},Y0=g=>{confirm("Delete this followup entry?")&&F(I=>I.filter(Y=>Y.id!==g))},Ha=g=>{var Le,Ke;const I=g.subject||((Ke=(Le=g.campaigns)==null?void 0:Le[0])==null?void 0:Ke.subject)||"",Y=g.partyName,ee=g.invoiceNo,Q=ct(g.invoiceTotalAmount||g.totalAmount||0),K=hr(g.invoiceDate||g.date);return`Subject: RE: ${I} - Payment Followup for Invoice ${ee}

Dear Sir/Madam,

Greetings from ${S.name}!

This is a gentle reminder regarding the outstanding payment for:

Invoice No: ${ee}
Invoice Date: ${K}
Amount: ${Q}
Party: ${Y}

We kindly request you to process the payment at the earliest. If the payment has already been made, please share the payment details for our records.

For any queries, please feel free to reach out.

Thanks & Regards,
Finance Team
${S.name}
Email: ${S.email}
Phone: ${S.phone}`},u=g=>{const I=Ha(g);navigator.clipboard.writeText(I),alert(" Followup email template copied to clipboard!")},v=g=>{var ee,Q;const I=g.subject||((Q=(ee=g.campaigns)==null?void 0:ee[0])==null?void 0:Q.subject)||"",Y=encodeURIComponent(I);window.open(`https://mail.google.com/mail/u/0/#search/${Y}`,"_blank")},A=g=>{var ee;const I=(ee=g.target.files)==null?void 0:ee[0];if(!I)return;const Y=new FileReader;Y.onload=Q=>{const K=Sc(Q.target.result,{type:"binary"}),ne=K.SheetNames[0],Le=K.Sheets[ne],Ke=Ai.sheet_to_json(Le),fe={};Ke.forEach(Ie=>{const qe=Ie["Party Name"]||Ie["PARTY NAME"]||Ie.PartyName||"",re=parseFloat(Ie.Amount||Ie.AMOUNT||Ie["Invoice Amount"]||0);qe&&re>0&&(fe[qe.trim()]=re)}),Gl(Ie=>({...Ie,...fe})),alert(` Loaded ${Object.keys(fe).length} party invoice values!`)},Y.readAsBinaryString(I),g.target.value=""},O=()=>{const g=Ai.json_to_sheet([{"Party Name":"ABC Group Private Limited",Amount:5500},{"Party Name":"XYZ Media Pvt Ltd",Amount:7500}]),I=Ai.book_new();Ai.book_append_sheet(I,g,"Invoice Values"),Pg(I,"Invoice_Values_Template.xlsx")},se=g=>{var ee;const I=(ee=g.target.files)==null?void 0:ee[0];if(!I)return;const Y=new FileReader;Y.onload=Q=>{const K=Sc(Q.target.result,{type:"binary"}),ne=K.SheetNames[0],Le=K.Sheets[ne],Ke=Ai.sheet_to_json(Le),fe={...Zr};let Ie=0;Ke.forEach(qe=>{const re=qe["Name of Ledger"]||qe["Party Name"]||qe["NAME OF LEDGER"]||qe["PARTY NAME"]||"";re.trim()&&(fe[re.trim()]={ledgerGroup:qe["Ledger Group"]||qe["LEDGER GROUP"]||"Sundry Debtors",stateName:qe["State Name"]||qe["STATE NAME"]||"",gstRegType:qe["GST Registration Type"]||qe["GST REGISTRATION TYPE"]||"Regular",gstin:qe["GSTIN/UIN"]||qe.GSTIN||qe.GST||""},Ie++)}),zi(fe),alert(` Party Master Updated!

${Ie} parties loaded.`)},Y.readAsBinaryString(I),g.target.value=""},he=()=>{const g=Ai.json_to_sheet([{"Sl. No.":1,"Name of Ledger":"ABC PRIVATE LIMITED","Ledger Group":"Sundry Debtors","State Name":"Maharashtra","GST Registration Type":"Regular","GSTIN/UIN":"27AAACA1234A1ZQ"},{"Sl. No.":2,"Name of Ledger":"XYZ MEDIA PVT LTD","Ledger Group":"Sundry Debtors","State Name":"Delhi","GST Registration Type":"Regular","GSTIN/UIN":"07AAACX5678B1ZR"}]),I=Ai.book_new();Ai.book_append_sheet(I,g,"Party Master"),Pg(I,"Party_Master_Template.xlsx")},Ve=g=>{var ee;const I=(ee=g.target.files)==null?void 0:ee[0];if(!I)return;if(!H){alert(" Please select a party first from the list, then import their historical ledger."),g.target.value="";return}const Y=new FileReader;Y.onload=Q=>{const K=Sc(Q.target.result,{type:"binary",cellDates:!0}),ne=K.SheetNames[0],Le=K.Sheets[ne],Ke=Ai.sheet_to_json(Le,{raw:!1}),fe=[];let Ie=0,qe=null;const re=ue=>{if(!ue)return 0;const Ge=String(ue).replace(/,/g,"").replace(/[^\d.-]/g,"");return parseFloat(Ge)||0},Oe=ue=>{if(!ue||typeof ue!="string")return"";const Ge=ue.trim(),Se=Ge.split(/[-\/]/);if(Se.length===3){const We={jan:"01",feb:"02",mar:"03",apr:"04",may:"05",jun:"06",jul:"07",aug:"08",sep:"09",oct:"10",nov:"11",dec:"12"},lt=Se[1].toLowerCase().substring(0,3);if(We[lt]){const Nt=Se[0].padStart(2,"0");return`${Se[2].length===2?parseInt(Se[2])>50?"19"+Se[2]:"20"+Se[2]:Se[2]}-${We[lt]}-${Nt}`}}return Ge};Ke.forEach((ue,Ge)=>{const Se=Oe(ue.Date||ue.DATE||ue.date||""),We=(ue.Particular||ue.PARTICULAR||ue.Particulars||ue.PARTICULARS||"").trim(),lt=(ue["Vch Type"]||ue["VCH TYPE"]||ue["Voucher Type"]||ue["vch type"]||"").trim(),Nt=(ue["Vch No."]||ue["VCH NO."]||ue["Voucher No"]||ue["Invoice No"]||ue["Vch No"]||ue["vch no."]||"").trim(),$t=re(ue.Debit||ue.DEBIT||ue.debit),yr=re(ue.Credit||ue.CREDIT||ue.credit),rn=ue["Date of Receipt"]||ue["DATE OF RECEIPT"]||ue["Receipt Date"]||"",Z=re(ue["Amount Received"]||ue["AMOUNT RECEIVED"]||ue["amount received"]),be=re(ue["TDS amount Received"]||ue["TDS Received"]||ue.TDS||ue.tds),Ut=re(ue.Balance||ue.BALANCE||ue.balance),At=(ue["Payment Status"]||ue["PAYMENT STATUS"]||ue.Status||ue.status||"").trim();if(!Se&&(We.toUpperCase().includes("PROMOTIONAL")||We.toUpperCase().includes("IGST")||We.toUpperCase().includes("CGST")||We.toUpperCase().includes("SGST")||We.toUpperCase().includes("TRADE EMAILER"))&&qe)qe.subRows||(qe.subRows=[]),qe.subRows.push({particular:We,debit:$t,credit:yr});else if(Se&&(Nt||$t>0||yr>0)){qe&&(fe.push(qe),Ie++);let tr="invoice";lt.toLowerCase().includes("credit note")||Nt.toUpperCase().startsWith("CN")?tr="creditnote":lt.toLowerCase().includes("receipt")?tr="receipt":(lt.toLowerCase().includes("sale")||$t>0)&&(tr="invoice"),qe={id:Date.now()+Ge,partyName:H,date:Se,particulars:We||H,narration:Nt,vchType:lt||"Sales",vchNo:Nt,debit:$t,credit:yr,receiptDate:rn,amountReceived:Z,tdsReceived:be,balance:Ut,paymentStatus:At,type:tr,isHistorical:!0,subRows:[]}}}),qe&&(fe.push(qe),Ie++),console.log("Parsed entries with sub-rows:",fe),Ie>0?(xe(ue=>[...ue,...fe]),alert(` Historical Ledger Uploaded!

${Ie} entries added for "${H}".`)):alert(` No valid ledger entries found in the file.

Make sure your file has these columns:
 Date (e.g., 02-Jun-21)
 Vch Type (e.g., Sales, Credit Note)
 Vch No. (e.g., MB/2022-23/128)
 Debit or Credit amount`)},Y.readAsBinaryString(I),g.target.value="",la(!1)},Wt=()=>{const g=Ai.json_to_sheet([{Date:"02-Jun-21",Particular:"ABC Corp Ltd.","Vch Type":"Sales","Vch No.":"MB/2020-21/0411",Debit:6e3,Credit:"","Date of Receipt":"","Amount Received":44371,"TDS amount Received":5880,Balance:"","Payment Status":"Received"},{Date:"",Particular:"PROMOTIONAL TRADE EMAILERS","Vch Type":"","Vch No.":"",Debit:"",Credit:22500,"Date of Receipt":"","Amount Received":"","TDS amount Received":"",Balance:"","Payment Status":""},{Date:"",Particular:"IGST","Vch Type":"","Vch No.":"",Debit:"",Credit:4050,"Date of Receipt":"","Amount Received":"","TDS amount Received":"",Balance:"","Payment Status":""},{Date:"26-Mar-25",Particular:"ABC Corp Ltd.","Vch Type":"Credit Note","Vch No.":"CN/2022-23/128",Debit:"",Credit:26550,"Date of Receipt":"","Amount Received":"","TDS amount Received":"",Balance:"","Payment Status":""}]),I=Ai.book_new();Ai.book_append_sheet(I,g,"Historical Ledger"),Pg(I,"Historical_Ledger_Template.xlsx")},Hr=g=>{const I=ge.find(Y=>Y.invoiceNo===g);I?Au(I):alert("Invoice not found in system. This may be a historical entry.")},It=g=>{ge.find(Y=>Y.invoiceNo===g.invoiceNo);let I=` RECEIPT DETAILS

`;I+=`Receipt No: ${g.receiptNo}
`,I+=`Date: ${hr(g.date)}
`,I+=`Party: ${g.partyName}
`,I+=`Invoice: ${g.invoiceNo}

`,I+=`
`,I+=`Amount Received: ${ct(g.amount||0)}
`,I+=`TDS: ${ct(g.tds||0)}
`,I+=`Discount: ${ct(g.discount||0)}
`,I+=`
`,I+=`Total: ${ct((g.amount||0)+(g.tds||0)+(g.discount||0))}
`,g.remarks&&(I+=`
Remarks: ${g.remarks}`),alert(I)},en=g=>{let I=` CREDIT NOTE DETAILS

`;I+=`Credit Note No: ${g.creditNoteNo}
`,I+=`Date: ${hr(g.date)}
`,I+=`Party: ${g.partyName}
`,I+=`Against Invoice: ${g.invoiceNo}

`,I+=`
`,I+=`Base Amount: ${ct(g.amount||0)}
`,I+=`${g.gstType||"GST"}: ${ct(g.gst||0)}
`,I+=`
`,I+=`Total Credit: ${ct(g.totalAmount||(g.amount||0)+(g.gst||0))}
`,g.reason&&(I+=`
Reason: ${g.reason}`),alert(I)},tn=g=>{var ee;const I=(ee=g.target.files)==null?void 0:ee[0];if(!I)return;const Y=new FileReader;Y.onload=Q=>{const K=Sc(Q.target.result,{type:"binary",cellDates:!0}),ne=K.SheetNames[0],Le=K.Sheets[ne],Ke=Ai.sheet_to_json(Le,{raw:!1}),fe=new Set(bn.map(ue=>`${ue.date}|${ue.time||""}|${ue.campaignName||""}|${ue.subject}`.toLowerCase()));let Ie=0,qe=0;const re=Ke.map((ue,Ge)=>{const Se=ue["CAMPAIGN NAME"]||ue["Campaign Name"]||"",We=CW(Se);let lt=ue.DATE||ue.Date||new Date;typeof lt=="string"&&(lt=new Date(lt));const Nt=(ue["PARTY NAME"]||ue["Party Name"]||"").trim(),$t=ue["SENDER NAME"]||ue["Sender Name"]||"",yr=ue.SUBJECT||ue.Subject||"",rn=ue.TIME||ue.Time||"",Z=ds[Nt]||"",be=lt instanceof Date&&!isNaN(lt)?lt.toISOString().split("T")[0]:"",Ut=`${be}|${rn}|${Se}|${yr}`.toLowerCase();return fe.has(Ut)?(Ie++,null):(fe.add(Ut),qe++,{id:Date.now()+Ge+Math.random(),sno:ue.SNO||ue["SNO."]||ue.Sno||Ge+1,date:be,month:ue.Month||ue.MONTH||"",statePartyDetails:ue["State/Party Details"]||ue["STATE/PARTY DETAILS"]||"",partyName:Nt,senderName:$t,campaignName:Se,subject:yr,emailId:We,additionalEmails:[],toBeBilled:"Not Yet",invoiceAmount:Z,cgst:"",sgst:"",igst:"",totalWithGst:"",invoiceType:"Individual",combinationCode:"NA",invoiceNo:"",invoiceDate:"",invoiceTotalAmount:"",invoiceGenerated:!1,invoiceStatus:"Pending",mailingSent:"No",mailerUploaded:!1,editComments:""})}).filter(ue=>ue!==null);if(re.length>0){Fe(Ge=>[...Ge,...re]);const ue=[...new Set(re.map(Ge=>Ge.partyName))];Kl(Ge=>{const Se=new Set(Ge);return ue.forEach(We=>Se.add(We)),Se})}let Oe=` Upload Complete!

`;Oe+=` ${qe} new campaigns added
`,Ie>0&&(Oe+=` ${Ie} duplicate entries skipped`),qe>0&&Gi("upload",` ${qe} new campaigns uploaded to Master Sheet`,"director"),alert(Oe)},Y.readAsBinaryString(I),g.target.value=""},Ga=async()=>{Fe([]),xe([]),ke([]),j([]),Jn({}),Wo({}),de(1),Ne(1),_e(1),G(1),q(null),Kl(new Set),F([]),zi({}),dn([]);try{await Qg("indreesh-media",{masterData:[],ledgerEntries:[],receipts:[],creditNotes:[],openingBalances:{},mailerImages:{},mailerLogo:hn,companyConfig:S,nextInvoiceNo:1,nextCombineNo:1,nextReceiptNo:1,nextCreditNoteNo:1,invoiceValues:ds,notifications:[],whatsappSettings:ie,partyMaster:{},followups:[],userPasswords:y}),console.log("Data cleared and saved to Firebase")}catch(g){console.error("Error clearing data:",g)}Fn(!1),alert(" All master data, invoices, receipts, and ledger entries have been cleared!")},di=g=>{var ee;const I=parseFloat(g.invoiceAmount)||0;if((ee=g.statePartyDetails)==null?void 0:ee.toUpperCase().includes("MAHARASHTRA")){const Q=I*.09,K=I*.09;return{cgst:Q,sgst:K,igst:0,total:I+Q+K}}else{const Q=I*.18;return{cgst:0,sgst:0,igst:Q,total:I+Q}}},ec=(g,I)=>{const Y=ge.find(ee=>ee.id===g);Fe(ee=>ee.map(Q=>{if(Q.id===g){if(I==="Yes"&&Q.invoiceAmount){const K=di(Q);return{...Q,toBeBilled:I,cgst:K.cgst.toFixed(2),sgst:K.sgst.toFixed(2),igst:K.igst.toFixed(2),totalWithGst:K.total.toFixed(2)}}return{...Q,toBeBilled:I}}return Q})),I==="Yes"&&Y&&Gi("info",` Campaign marked for billing: ${Y.partyName} - ${Y.senderName}`,"finance")},Ka=(g,I,Y)=>{Fe(ee=>ee.map(Q=>{if(Q.id===g){const K={...Q,[I]:Y};if(I==="invoiceAmount"&&Q.toBeBilled==="Yes"){const ne=di(K);return{...K,cgst:ne.cgst.toFixed(2),sgst:ne.sgst.toFixed(2),igst:ne.igst.toFixed(2),totalWithGst:ne.total.toFixed(2)}}return K}return Q}))},b4=g=>{const I=`${S.invoicePrefix}${X}`,Y=new Date().toISOString().split("T")[0],ee=parseFloat(g.totalWithGst)||parseFloat(g.invoiceAmount)*1.18;Fe(Q=>Q.map(K=>K.id===g.id?{...K,invoiceNo:I,invoiceDate:Y,invoiceTotalAmount:ee.toFixed(2),invoiceGenerated:!0,invoiceStatus:"Created",invoiceType:"Individual",combinationCode:"NA"}:K)),de(Q=>Q+1),Gi("invoice",` New Invoice ${I} created for ${g.partyName} - ${ct(ee)}`,"director"),alert(` Invoice Generated!

Invoice No: ${I}
Amount: ${ct(ee)}

Please review and Approve or mark as Need Edits.`)},R4=()=>{if(_t.size<2){alert("Please select at least 2 campaigns to combine");return}const g=`${S.invoicePrefix}${X}`,I=new Date().toISOString().split("T")[0],Y=String(we);let ee=0;const Q=ge.filter(K=>_t.has(K.id));Q.forEach(K=>{ee+=parseFloat(K.totalWithGst)||parseFloat(K.invoiceAmount)*1.18}),Fe(K=>K.map(ne=>_t.has(ne.id)?{...ne,invoiceNo:g,invoiceDate:I,invoiceTotalAmount:ee.toFixed(2),invoiceGenerated:!0,invoiceStatus:"Created",invoiceType:"Combined",combinationCode:Y,mailingSent:"No"}:ne)),de(K=>K+1),Ne(K=>K+1),ji(!1),kt(new Set),Gi("invoice",` Combined Invoice ${g} created for ${ze} (${Q.length} campaigns) - ${ct(ee)}`,"director"),nt(null),alert(` Combined Invoice Generated!

Invoice No: ${g}
Campaigns: ${_t.size}
Total: ${ct(ee)}

Please review and Approve or mark as Need Edits.`)},N4=g=>{kt(I=>{const Y=new Set(I);return Y.has(g)?Y.delete(g):Y.add(g),Y})},D4=g=>{nt(g.partyName),kt(new Set([g.id])),ji(!0)},P4=g=>{var ee;const I=(ee=g.target.files)==null?void 0:ee[0];if(!I||!ae)return;const Y=new FileReader;Y.onload=Q=>Qv(Q.target.result),Y.readAsDataURL(I),g.target.value=""},Qv=g=>{if(!ae)return;const I=ae.id;Jn(gn?Y=>({...Y,[I]:[g]}):Y=>({...Y,[I]:[...Y[I]||[],g]})),Fe(Y=>Y.map(ee=>ee.id===ae.id?{...ee,mailerUploaded:!0}:ee)),ki(null),za(!1),gt(!1),alert(" Mailer image saved!")},O4=g=>{var Y;const I=(Y=g.clipboardData)==null?void 0:Y.items;if(I){for(let ee=0;ee<I.length;ee++)if(I[ee].type.indexOf("image")!==-1){const Q=I[ee].getAsFile(),K=new FileReader;K.onload=ne=>ki(ne.target.result),K.readAsDataURL(Q),g.preventDefault();break}}},M4=g=>{const I=encodeURIComponent(g||"campaign");window.open(`https://mail.google.com/mail/u/0/#search/${I}`,"_blank")},L4=g=>{var ee;const I=(ee=g.target.files)==null?void 0:ee[0];if(!I)return;const Y=new FileReader;Y.onload=Q=>Si(Q.target.result),Y.readAsDataURL(I),g.target.value=""},Jv=g=>{const I=Xi(g);if(I.length>1){const Y=I.map(ee=>ee.senderName).join(", ");return`Invoice ${g.invoiceNo||""} - ${Y}`}return`Invoice ${g.invoiceNo||""} - ${g.senderName} - ${g.subject}`},Q0=g=>{const I=Xi(g),Y=parseFloat(g.invoiceTotalAmount)||parseFloat(g.totalWithGst)||parseFloat(g.invoiceAmount)*1.18;let ee="";return I.length>1?(ee=`Campaigns included in this invoice:
`,I.forEach((Q,K)=>{ee+=`${K+1}. ${Q.senderName} - ${Q.subject}
`})):ee=`Campaign: ${g.senderName}
Subject: ${g.subject}`,`Dear Sir/Madam,

Please find attached the invoice for the following:

${ee}

Invoice No: ${g.invoiceNo||"To be generated"}
Invoice Amount: ${ct(Y)}

Kindly process the payment at your earliest convenience.

Bank Details:
Bank: ${S.bank.name}
A/C No: ${S.bank.account}
IFSC: ${S.bank.ifsc}
Branch: ${S.bank.branch}

Thank you for your business.

Best Regards,
${S.name}
${S.email}`},[B4,Zv]=ve.useState(!1),[ey,ty]=ve.useState(""),ry=g=>{var re;let I=[g],Y=parseFloat(g.invoiceAmount)||0;g.invoiceType==="Combined"&&g.combinationCode!=="NA"&&(I=ge.filter(Oe=>Oe.combinationCode===g.combinationCode),Y=I.reduce((Oe,ue)=>Oe+(parseFloat(ue.invoiceAmount)||0),0));const ee=(re=g.statePartyDetails)==null?void 0:re.toUpperCase().includes("MAHARASHTRA"),Q=ee?Y*.09:0,K=ee?Y*.09:0,ne=ee?0:Y*.18,Le=Q+K+ne,Ke=Y+Le,fe=I.map((Oe,ue)=>`
      <tr>
        <td style="border: 1px solid #000; padding: 8px; text-align: center; font-size: 12px;">${ue+1}</td>
        <td style="border: 1px solid #000; padding: 8px; font-size: 12px;">
          <div style="font-weight: 600;">PROMOTIONAL TRADE EMAILER</div>
          <div style="font-style: italic; color: #555; font-size: 11px; margin-top: 2px;">${Oe.senderName||""} - ${hr(Oe.date)}</div>
          <div style="font-style: italic; color: #555; font-size: 11px;">Subject: ${Oe.subject||""}</div>
        </td>
        <td style="border: 1px solid #000; padding: 8px; text-align: center; font-size: 12px;">${S.hsnCode}</td>
        <td style="border: 1px solid #000; padding: 8px; text-align: right; font-size: 12px;">${zt(parseFloat(Oe.invoiceAmount)||0)}</td>
      </tr>
    `).join("");let Ie=[];g.invoiceType==="Combined"&&g.combinationCode!=="NA"?I.forEach(Oe=>{(Et[Oe.id]||[]).forEach(Ge=>Ie.push({img:Ge,campaign:Oe}))}):(Et[g.id]||[]).forEach(ue=>Ie.push({img:ue,campaign:g}));const qe=Ie.map(({img:Oe,campaign:ue})=>`
      <div class="page-break-before" style="page-break-before: always; padding: 40px; text-align: center; background: white;">
        ${hn?`<div style="margin-bottom: 20px;"><img src="${hn}" alt="Logo" style="max-height: 70px;" /></div>`:`
          <div style="text-align: center; margin-bottom: 25px;">
            <span style="font-size: 22px; font-weight: bold; color: #2874A6;">${S.name}</span>
          </div>
        `}
        <h2 style="font-size: 20px; text-decoration: underline; margin: 25px 0;">MAILER SUPPORTING</h2>
        <p style="font-size: 15px; margin: 12px 0; text-align: left;"><strong>MAILER DATE:</strong> ${kW(ue.date)}</p>
        <p style="font-size: 15px; margin: 12px 0; text-align: left;"><strong>CAMPAIGN:</strong> ${ue.senderName}</p>
        <p style="font-size: 15px; margin: 12px 0; text-align: left;"><strong>SUBJECT:</strong> ${ue.subject||"Campaign"}</p>
        <div style="margin-top: 25px;"><img src="${Oe}" alt="Mailer" style="max-width: 100%; max-height: 550px; border: 1px solid #ddd;" /></div>
      </div>
    `).join("");return`
  <div style="max-width: 900px; margin: 0 auto; padding: 15px; background: white; font-family: Arial, sans-serif; font-size: 12px; line-height: 1.4;">
    <style>
      @media print {
        @page { size: A4; margin: 8mm; }
        body { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
        .page-break-before { page-break-before: always; }
      }
    </style>
    <div style="border: 2px solid #000; background: white;">
      <div style="text-align: center; padding: 12px; font-size: 18px; font-weight: bold; border-bottom: 2px solid #000; background: #f8f8f8;">Tax Invoice</div>
      <div style="text-align: center; font-size: 11px; font-style: italic; padding: 5px; border-bottom: 1px solid #000; background: #fafafa;">(Original for Recipient)</div>
      <div style="display: flex; border-bottom: 2px solid #000;">
        <div style="flex: 1.5; padding: 12px; border-right: 2px solid #000;">
          <div style="font-size: 16px; font-weight: bold; margin-bottom: 8px; color: #1a5276;">${S.name}</div>
          <div style="font-size: 11px; line-height: 1.5; color: #333;">${S.address}<br>${S.addressLine2}<br>${S.city}<br><strong>GSTIN/UIN:</strong> ${S.gstin}<br><strong>State:</strong> ${S.stateName}, Code: ${S.stateCode}<br><strong>Contact:</strong> ${S.phone}<br><strong>E-Mail:</strong> ${S.email}</div>
        </div>
        <div style="flex: 1; font-size: 12px;">
          <div style="display: flex; border-bottom: 1px solid #000;"><div style="flex: 1; padding: 8px; border-right: 1px solid #000; font-weight: bold; background: #f5f5f5;">Invoice No.</div><div style="flex: 1; padding: 8px; font-weight: 600; color: #1a5276;">${g.invoiceNo||""}</div></div>
          <div style="display: flex;"><div style="flex: 1; padding: 8px; border-right: 1px solid #000; font-weight: bold; background: #f5f5f5;">Dated</div><div style="flex: 1; padding: 8px;">${hr(g.invoiceDate||g.date)}</div></div>
        </div>
      </div>
      <div style="padding: 10px 12px; border-bottom: 2px solid #000; background: #fafafa;">
        <div style="font-size: 11px; color: #666; margin-bottom: 3px;">Buyer (Bill to)</div>
        <div style="font-size: 14px; font-weight: bold; margin-bottom: 4px; color: #1a5276;">${g.partyName}</div>
        <div style="font-size: 11px; color: #333;">${g.statePartyDetails||""}<br>Place of Supply: ${g.statePartyDetails||S.stateName}</div>
      </div>
      <table style="width: 100%; border-collapse: collapse;">
        <thead><tr style="background: #e8e8e8;"><th style="border: 1px solid #000; padding: 10px; width: 45px; font-size: 12px;">Sl No.</th><th style="border: 1px solid #000; padding: 10px; font-size: 12px;">Particulars</th><th style="border: 1px solid #000; padding: 10px; width: 80px; font-size: 12px;">HSN/SAC</th><th style="border: 1px solid #000; padding: 10px; width: 100px; text-align: right; font-size: 12px;">Amount</th></tr></thead>
        <tbody>
          ${fe}
          ${I.length>1?'<tr style="background: #f5f5f5;"><td colspan="3" style="border: 1px solid #000; padding: 10px; text-align: right; font-weight: bold; font-size: 13px;">Sub Total</td><td style="border: 1px solid #000; padding: 10px; text-align: right; font-weight: bold; font-size: 13px;">'+zt(Y)+"</td></tr>":""}
          ${ee?`<tr><td colspan="3" style="border: 1px solid #000; padding: 8px; text-align: right; font-weight: 600; font-size: 12px;">CGST @ 9%</td><td style="border: 1px solid #000; padding: 8px; text-align: right; font-size: 12px;">${zt(Q)}</td></tr><tr><td colspan="3" style="border: 1px solid #000; padding: 8px; text-align: right; font-weight: 600; font-size: 12px;">SGST @ 9%</td><td style="border: 1px solid #000; padding: 8px; text-align: right; font-size: 12px;">${zt(K)}</td></tr>`:`<tr><td colspan="3" style="border: 1px solid #000; padding: 8px; text-align: right; font-weight: 600; font-size: 12px;">IGST @ 18%</td><td style="border: 1px solid #000; padding: 8px; text-align: right; font-size: 12px;">${zt(ne)}</td></tr>`}
          <tr style="background: #2874A6; color: white;"><td colspan="3" style="border: 1px solid #000; padding: 12px; text-align: right; font-weight: bold; font-size: 14px;">Total</td><td style="border: 1px solid #000; padding: 12px; text-align: right; font-weight: bold; font-size: 14px;"> ${Ke.toLocaleString("en-IN",{minimumFractionDigits:2})}</td></tr>
        </tbody>
      </table>
      <div style="padding: 10px 12px; border: 1px solid #000; border-top: none; background: #fafafa;"><div style="color: #666; font-size: 11px; margin-bottom: 3px;">Amount Chargeable (in words)</div><div style="font-weight: bold; font-size: 13px;">${AW(Ke)}</div></div>
      <div style="display: flex; border-top: 2px solid #000;">
        <div style="flex: 1; padding: 10px 12px; border-right: 2px solid #000; font-size: 11px;"><div><strong>Company's PAN:</strong> ${S.pan}</div></div>
        <div style="flex: 1.2; padding: 10px 12px; font-size: 11px;">
          <div style="font-weight: bold; margin-bottom: 6px; color: #1a5276;">Company's Bank Details</div>
          <div style="line-height: 1.5;"><strong>A/c Holder:</strong> ${S.bank.holder}<br><strong>Bank:</strong> ${S.bank.name}<br><strong>A/c No.:</strong> ${S.bank.account}<br><strong>IFSC:</strong> ${S.bank.ifsc}</div>
          <div style="text-align: right; margin-top: 30px;"><div style="font-weight: bold;">for ${S.name}</div><div style="margin-top: 25px; border-top: 1px solid #000; display: inline-block; padding-top: 4px; font-size: 10px;">Authorised Signatory</div></div>
        </div>
      </div>
      <div style="text-align: center; padding: 8px; background: #f0f0f0; border-top: 1px solid #000; font-size: 10px; color: #666; font-style: italic;">This is a Computer Generated Invoice</div>
    </div>
  </div>
  ${qe}
`},j4=g=>{const I=ry(g);ty(I),Br(g),Zv(!0)},V4=g=>{const I=`<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Invoice ${g.invoiceNo||""}</title>
  <style>
    @page { size: A4; margin: 10mm; }
    @media print { body { -webkit-print-color-adjust: exact; print-color-adjust: exact; } }
    body { font-family: Arial, sans-serif; margin: 0; padding: 20px; }
  </style>
</head>
<body>
${ry(g)}
<script>
  // Auto-open print dialog when file is opened
  window.onload = function() { 
    setTimeout(function() { window.print(); }, 500); 
  };
<\/script>
</body>
</html>`,Y=new Blob([I],{type:"text/html"}),ee=URL.createObjectURL(Y),Q=document.createElement("a");Q.href=ee,Q.download=`Invoice_${(g.invoiceNo||"draft").replace(/\//g,"-")}.html`,document.body.appendChild(Q),Q.click(),document.body.removeChild(Q),URL.revokeObjectURL(ee)},Au=g=>{j4(g)},U4=()=>{const g=parseFloat(Qt.amount)||0,I=parseFloat(Qt.tds)||0,Y=parseFloat(Qt.discount)||0,ee=g+I+Y;let Q=parseFloat(ae.invoiceTotalAmount)||parseFloat(ae.totalWithGst)||parseFloat(ae.invoiceAmount)*1.18;const K=ee>=Q?"Paid":"Partially Paid";ae.invoiceType==="Combined"&&ae.combinationCode!=="NA"?Fe(Le=>Le.map(Ke=>Ke.combinationCode===ae.combinationCode?{...Ke,invoiceStatus:K}:Ke)):Fe(Le=>Le.map(Ke=>Ke.id===ae.id?{...Ke,invoiceStatus:K}:Ke));const ne=[];g>0&&ne.push({id:Date.now(),partyName:ae.partyName,date:Qt.date,particulars:Qt.narration?`Payment Received - ${Qt.mode} (${Qt.narration})`:`Payment Received - ${Qt.mode}`,debit:0,credit:g,type:"payment"}),I>0&&ne.push({id:Date.now()+1,partyName:ae.partyName,date:Qt.date,particulars:`TDS Deducted - Inv: ${ae.invoiceNo}`,debit:0,credit:I,type:"tds"}),Y>0&&ne.push({id:Date.now()+2,partyName:ae.partyName,date:Qt.date,particulars:`Discount Allowed - Inv: ${ae.invoiceNo}`,debit:0,credit:Y,type:"discount"}),xe(Le=>[...Le,...ne]),Zt(!1),Br(null)},ny=g=>{Kl(I=>{const Y=new Set(I);return Y.has(g)?Y.delete(g):Y.add(g),Y})},z4=()=>{const Y=r==="director"?[{id:"master",icon:L2,label:"Master Sheet"},{id:"invoices",icon:Lu,label:"Invoice Register"},{id:"ledgers",icon:R2,label:"Party Ledgers"},{id:"followups",icon:bd,label:"Followups"},{id:"reports",icon:I2,label:"Reports"}]:[{id:"master",icon:L2,label:"Master Sheet"},{id:"invoices",icon:Lu,label:"Invoice Register"},{id:"ledgers",icon:R2,label:"Party Ledgers"},{id:"followups",icon:bd,label:"Followups"},{id:"reports",icon:I2,label:"Reports"},{id:"settings",icon:BB,label:"Settings"}];return f.jsxs("div",{style:{width:R?"60px":"220px",backgroundColor:"#1E293B",color:"#FFFFFF",display:"flex",flexDirection:"column",transition:"width 0.2s ease",flexShrink:0},children:[f.jsxs("div",{style:{padding:R?"12px":"16px",borderBottom:"1px solid #334155",display:"flex",alignItems:"center",justifyContent:R?"center":"space-between"},children:[!R&&f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[f.jsx("img",{src:"/logo.png",alt:"JAC",style:{width:"32px",height:"auto",borderRadius:"4px",backgroundColor:"white",padding:"2px"}}),f.jsxs("div",{children:[f.jsx("div",{style:{fontSize:"16px",fontWeight:"700"},children:"FinMate"}),f.jsx("div",{style:{fontSize:"10px",color:"#94A3B8"},children:r==="director"?"Director View":"Finance Team"})]})]}),f.jsx("button",{onClick:()=>Ue(!R),style:{background:"none",border:"none",color:"#94A3B8",cursor:"pointer",padding:"4px"},children:R?f.jsx(Og,{size:18}):f.jsx(NB,{size:18})})]}),!R&&f.jsx("div",{style:{padding:"8px 16px",borderBottom:"1px solid #334155",fontSize:"11px"},children:d?f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",color:"#FCD34D"},children:[f.jsx(P2,{size:12,style:{animation:"spin 1s linear infinite"}}),f.jsx("span",{children:"Saving..."})]}):p?f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",color:"#86EFAC"},children:[f.jsx(N2,{size:12}),f.jsxs("span",{children:["Saved ",p.toLocaleTimeString()]})]}):f.jsx("div",{style:{color:"#94A3B8"},children:"Cloud Sync Active"})}),f.jsx("div",{style:{padding:"8px",borderBottom:"1px solid #334155"},children:f.jsxs("button",{onClick:()=>$l(!0),style:{width:"100%",display:"flex",alignItems:"center",gap:"10px",padding:R?"12px":"11px 14px",borderRadius:"8px",border:"none",backgroundColor:Ki>0?"#FEF3C7":"#334155",color:Ki>0?"#92400E":"#94A3B8",cursor:"pointer",fontSize:"14px",fontWeight:Ki>0?"700":"500",justifyContent:R?"center":"flex-start",position:"relative"},title:"Notifications",children:[Ki>0?f.jsx(IB,{size:18}):f.jsx(b2,{size:18}),!R&&f.jsx("span",{children:"Notifications"}),Ki>0&&f.jsx("span",{style:{position:R?"absolute":"static",top:R?"4px":"auto",right:R?"4px":"auto",marginLeft:R?"0":"auto",backgroundColor:"#DC2626",color:"#FFFFFF",padding:"2px 6px",borderRadius:"10px",fontSize:"11px",fontWeight:"700",minWidth:"18px",textAlign:"center"},children:Ki})]})}),f.jsx("nav",{style:{flex:1,padding:"8px"},children:Y.map(ee=>f.jsxs("button",{onClick:()=>D(ee.id),style:{width:"100%",display:"flex",alignItems:"center",gap:"10px",padding:R?"12px":"11px 14px",marginBottom:"4px",borderRadius:"8px",border:"none",backgroundColor:N===ee.id?"#2874A6":"transparent",color:N===ee.id?"#FFFFFF":"#94A3B8",cursor:"pointer",fontSize:"14px",fontWeight:N===ee.id?"600":"500",justifyContent:R?"center":"flex-start"},title:ee.label,children:[f.jsx(ee.icon,{size:18}),!R&&f.jsx("span",{children:ee.label})]},ee.id))}),f.jsxs("div",{style:{padding:"8px",borderTop:"1px solid #334155"},children:[f.jsxs("button",{onClick:()=>{_(!0),W({currentPassword:"",newPassword:"",confirmPassword:""}),w("")},style:{width:"100%",display:"flex",alignItems:"center",gap:"10px",padding:R?"12px":"11px 14px",marginBottom:"8px",borderRadius:"8px",border:"none",backgroundColor:"#475569",color:"#FFFFFF",cursor:"pointer",fontSize:"14px",fontWeight:"500",justifyContent:R?"center":"flex-start"},title:"Change Password",children:[f.jsx(Id,{size:18}),!R&&f.jsx("span",{children:"Change Password"})]}),f.jsxs("button",{onClick:M0,style:{width:"100%",display:"flex",alignItems:"center",gap:"10px",padding:R?"12px":"11px 14px",borderRadius:"8px",border:"none",backgroundColor:"#DC2626",color:"#FFFFFF",cursor:"pointer",fontSize:"14px",fontWeight:"600",justifyContent:R?"center":"flex-start"},title:"Logout",children:[f.jsx(rl,{size:18}),!R&&f.jsx("span",{children:"Logout"})]})]})]})},W4=()=>f.jsx("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"10px",border:"1px solid #E2E8F0",padding:"14px 18px",marginBottom:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"14px",flexWrap:"wrap"},children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[f.jsx(Lg,{size:18,color:"#64748B"}),f.jsx("span",{style:{fontSize:"13px",fontWeight:"700",color:"#475569"},children:"Filters:"})]}),f.jsxs("div",{style:{position:"relative"},children:[f.jsx(Rd,{size:15,style:{position:"absolute",left:"10px",top:"50%",transform:"translateY(-50%)",color:"#94A3B8"}}),f.jsx("input",{type:"text",placeholder:"Search...",value:Xe.searchText,onChange:g=>Ls(I=>({...I,searchText:g.target.value})),style:{padding:"8px 12px 8px 32px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",width:"160px"}})]}),f.jsxs("select",{value:Xe.party,onChange:g=>Ls(I=>({...I,party:g.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:Xe.party?"#EFF6FF":"#FFFFFF"},children:[f.jsx("option",{value:"",children:"All Parties"}),Xo.map(g=>f.jsx("option",{value:g,children:g},g))]}),f.jsxs("select",{value:Xe.billStatus,onChange:g=>Ls(I=>({...I,billStatus:g.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:Xe.billStatus?"#EFF6FF":"#FFFFFF"},children:[f.jsx("option",{value:"",children:"Bill Status"}),f.jsx("option",{value:"Yes",children:"Yes"}),f.jsx("option",{value:"Not Yet",children:"Not Yet"})]}),f.jsxs("select",{value:Xe.invoiceStatus,onChange:g=>Ls(I=>({...I,invoiceStatus:g.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:Xe.invoiceStatus?"#EFF6FF":"#FFFFFF"},children:[f.jsx("option",{value:"",children:"Invoice Status"}),f.jsx("option",{value:"Generated",children:"Generated"}),f.jsx("option",{value:"Not Generated",children:"Not Generated"}),f.jsx("option",{value:"Paid",children:"Paid"})]}),$a&&f.jsxs(f.Fragment,{children:[f.jsxs("button",{onClick:B0,style:{padding:"8px 12px",fontSize:"13px",fontWeight:"600",border:"1.5px solid #FCA5A5",borderRadius:"8px",backgroundColor:"#FEE2E2",color:"#991B1B",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},children:[f.jsx(rl,{size:14})," Clear"]}),f.jsxs("span",{style:{fontSize:"13px",color:"#64748B"},children:["Showing ",ca.length," of ",ge.length]})]})]})}),iy=()=>{const g=ge.filter(ne=>ne.toBeBilled==="Yes"&&ne.invoiceGenerated&&ne.mailingSent==="Yes"&&(ne.receiptStatus==="Received"||ne.receiptStatus==="Cancelled"||ne.receiptStatus==="Closed")),I=ge.filter(ne=>!(ne.toBeBilled==="Yes"&&ne.invoiceGenerated&&ne.mailingSent==="Yes"&&(ne.receiptStatus==="Received"||ne.receiptStatus==="Cancelled"||ne.receiptStatus==="Closed"))),Y=In==="open"?I:g,ee=Y.filter(ne=>{var Le,Ke,fe,Ie,qe;if(Xe.party&&ne.partyName!==Xe.party||Xe.billStatus&&ne.toBeBilled!==Xe.billStatus||Xe.invoiceType&&ne.invoiceType!==Xe.invoiceType||Xe.mailingStatus&&(Xe.mailingStatus==="Sent"&&ne.mailingSent!=="Yes"||Xe.mailingStatus==="Not Sent"&&ne.mailingSent==="Yes")||Xe.invoiceStatus&&(Xe.invoiceStatus==="Generated"&&!ne.invoiceGenerated||Xe.invoiceStatus==="Not Generated"&&ne.invoiceGenerated||Xe.invoiceStatus==="Approved"&&ne.invoiceStatus!=="Approved"||Xe.invoiceStatus==="Need Edits"&&ne.invoiceStatus!=="Need Edits"||Xe.invoiceStatus==="Paid"&&ne.invoiceStatus!=="Paid"))return!1;if(Xe.searchText){const re=Xe.searchText.toLowerCase();if(!((Le=ne.partyName)!=null&&Le.toLowerCase().includes(re))&&!((Ke=ne.senderName)!=null&&Ke.toLowerCase().includes(re))&&!((fe=ne.campaignName)!=null&&fe.toLowerCase().includes(re))&&!((Ie=ne.subject)!=null&&Ie.toLowerCase().includes(re))&&!((qe=ne.invoiceNo)!=null&&qe.toLowerCase().includes(re)))return!1}return!0}),Q=ee.reduce((ne,Le)=>{const Ke=Le.partyName||"Unknown";return ne[Ke]||(ne[Ke]=[]),ne[Ke].push(Le),ne},{}),K=Object.keys(Q).sort();return f.jsxs("div",{children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[f.jsxs("div",{children:[f.jsx("h1",{style:{margin:0,fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:" Master Sheet"}),f.jsxs("p",{style:{margin:"4px 0 0",fontSize:"14px",color:"#64748B"},children:[ge.length," campaigns  ",Xo.length," parties  ",ge.filter(ne=>ne.invoiceGenerated).length," invoiced"]})]}),f.jsxs("div",{style:{display:"flex",gap:"10px"},children:[f.jsx("input",{type:"file",ref:R0,accept:".xlsx,.xls,.csv",style:{display:"none"},onChange:tn}),f.jsx(Ye,{icon:zs,label:"Upload Data",variant:"brand",onClick:()=>{var ne;return(ne=R0.current)==null?void 0:ne.click()}}),Ft&&ge.length>0&&f.jsx(Ye,{icon:Us,label:"Clear All Data",variant:"danger",onClick:()=>Fn(!0)})]})]}),f.jsxs("div",{style:{display:"flex",gap:"4px",marginBottom:"16px",backgroundColor:"#F1F5F9",padding:"4px",borderRadius:"10px",width:"fit-content"},children:[f.jsxs("button",{onClick:()=>Ms("open"),style:{padding:"10px 20px",fontSize:"14px",fontWeight:"600",border:"none",borderRadius:"8px",cursor:"pointer",backgroundColor:In==="open"?"#FFFFFF":"transparent",color:In==="open"?"#1E293B":"#64748B",boxShadow:In==="open"?"0 2px 4px rgba(0,0,0,0.1)":"none"},children:[" Open Invoices (",I.length,")"]}),f.jsxs("button",{onClick:()=>Ms("closed"),style:{padding:"10px 20px",fontSize:"14px",fontWeight:"600",border:"none",borderRadius:"8px",cursor:"pointer",backgroundColor:In==="closed"?"#FFFFFF":"transparent",color:In==="closed"?"#1E293B":"#64748B",boxShadow:In==="closed"?"0 2px 4px rgba(0,0,0,0.1)":"none"},children:[" Closed Invoices (",g.length,")"]})]}),ge.length>0&&W4(),K.length===0?f.jsx(mn,{children:f.jsxs("div",{style:{padding:"60px",textAlign:"center",color:"#94A3B8"},children:[f.jsx(zs,{size:48,style:{marginBottom:"16px",opacity:.5}}),f.jsx("div",{style:{fontSize:"18px",fontWeight:"600"},children:$a?"No matching records":In==="closed"?"No closed invoices yet":"No Data Yet"}),f.jsx("div",{style:{fontSize:"14px",marginTop:"4px"},children:$a?"Try adjusting your filters":In==="closed"?"Invoices will appear here once billed, mailed, and payment received":"Upload an Excel file to get started"})]})}):f.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:K.map(ne=>{const Le=Q[ne],Ke=$o.has(ne),fe=Le.filter(re=>re.toBeBilled==="Yes").length,Ie=Le.filter(re=>re.invoiceGenerated).length,qe=Le.filter(re=>re.toBeBilled==="Yes").reduce((re,Oe)=>re+(parseFloat(Oe.totalWithGst)||0),0);return f.jsxs("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"12px",border:"1px solid #E2E8F0",overflow:"hidden",boxShadow:"0 2px 8px rgba(0,0,0,0.04)"},children:[f.jsxs("div",{onClick:()=>ny(ne),style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"16px 20px",backgroundColor:In==="closed"?"#F0FDF4":"#F8FAFC",cursor:"pointer",borderBottom:Ke?"3px solid #2874A6":"none"},children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[Ke?f.jsx(D2,{size:22,color:"#2874A6"}):f.jsx(Og,{size:22,color:"#64748B"}),f.jsxs("div",{children:[f.jsx("div",{style:{fontWeight:"700",fontSize:"16px",color:"#1E293B"},children:ne}),f.jsxs("div",{style:{fontSize:"13px",color:"#64748B",marginTop:"3px"},children:[Le.length," campaigns  ",fe," billed  ",Ie," invoiced"]})]})]}),qe>0&&f.jsxs("div",{style:{textAlign:"right"},children:[f.jsx("div",{style:{fontSize:"11px",color:"#64748B",textTransform:"uppercase"},children:"Total"}),f.jsx("div",{style:{fontSize:"18px",fontWeight:"700",color:"#059669"},children:ct(qe)})]})]}),Ke&&f.jsx("div",{style:{overflowX:"auto"},children:f.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"13px",minWidth:"2100px"},children:[f.jsx("thead",{children:f.jsxs("tr",{style:{backgroundColor:"#F1F5F9"},children:[f.jsx("th",{style:{padding:"12px 14px",textAlign:"left",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"90px"},children:"Date"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"left",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"100px"},children:"Sender"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"left",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",minWidth:"180px"},children:"Campaign / Subject"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"left",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"160px"},children:"Email ID"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"70px"},children:"Mailer"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"80px"},children:"Bill?"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"right",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"90px"},children:"Amount"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"90px"},children:"Type"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"90px"},children:"Generate"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"left",fontWeight:"700",color:"#1E40AF",borderBottom:"2px solid #E2E8F0",backgroundColor:"#EFF6FF",width:"110px"},children:"Invoice No."}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"left",fontWeight:"700",color:"#1E40AF",borderBottom:"2px solid #E2E8F0",backgroundColor:"#EFF6FF",width:"90px"},children:"Inv Date"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"right",fontWeight:"700",color:"#1E40AF",borderBottom:"2px solid #E2E8F0",backgroundColor:"#EFF6FF",width:"100px"},children:"Inv Amount"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#7C3AED",borderBottom:"2px solid #E2E8F0",backgroundColor:"#FAF5FF",width:"50px"},children:"C#"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"120px"},children:"Status/Approve"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"120px"},children:"Actions"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#059669",borderBottom:"2px solid #E2E8F0",backgroundColor:"#F0FDF4",width:"80px"},children:"Mailed?"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#059669",borderBottom:"2px solid #E2E8F0",backgroundColor:"#F0FDF4",width:"90px"},children:"Mail Date"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#7C3AED",borderBottom:"2px solid #E2E8F0",backgroundColor:"#FAF5FF",width:"100px"},children:"Receipt"})]})}),f.jsx("tbody",{children:Le.map(re=>{var Ge,Se;const Oe=re.invoiceType==="Combined"&&Su(re.combinationCode)&&re.mailingSent!=="Yes";qo(re);const ue=Et[re.id]&&Et[re.id].length>0;return f.jsxs("tr",{style:{backgroundColor:re.toBeBilled==="Yes"?re.invoiceGenerated?"#F0FDF4":"#FFFBEB":"#FFFFFF",borderBottom:"1px solid #F1F5F9"},children:[f.jsx("td",{style:{padding:"12px 14px",whiteSpace:"nowrap",fontSize:"13px"},children:hr(re.date)}),f.jsx("td",{style:{padding:"12px 14px",fontWeight:"600",fontSize:"13px"},children:re.senderName}),f.jsxs("td",{style:{padding:"12px 14px"},children:[f.jsx("div",{style:{fontWeight:"600",fontSize:"13px",lineHeight:"1.4",color:"#1E293B"},children:((Se=(Ge=re.campaignName)==null?void 0:Ge.split("--")[0])==null?void 0:Se.trim())||re.senderName}),re.subject&&f.jsx("div",{style:{fontSize:"12px",color:"#64748B",marginTop:"4px",lineHeight:"1.3"},children:re.subject})]}),f.jsx("td",{style:{padding:"10px 14px"},children:f.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[re.emailId&&f.jsx("div",{style:{fontSize:"11px",color:"#1E40AF",backgroundColor:"#EFF6FF",padding:"2px 6px",borderRadius:"4px",display:"inline-block"},children:re.emailId}),(re.additionalEmails||[]).map((We,lt)=>f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[f.jsx("span",{style:{fontSize:"11px",color:"#059669",backgroundColor:"#F0FDF4",padding:"2px 6px",borderRadius:"4px"},children:We}),f.jsx("button",{onClick:()=>Yo(re.id,We),style:{background:"none",border:"none",cursor:"pointer",padding:"2px",color:"#DC2626"},title:"Remove",children:f.jsx(rl,{size:12})})]},lt)),f.jsxs("button",{onClick:()=>{Br(re),aa(""),Ar(!0)},style:{display:"flex",alignItems:"center",gap:"4px",fontSize:"11px",color:"#2874A6",background:"none",border:"none",cursor:"pointer",padding:"2px 0"},children:[f.jsx(O2,{size:12})," Add"]})]})}),f.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:ue?f.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"2px"},children:[f.jsx("span",{style:{color:"#22C55E",fontWeight:"700",fontSize:"14px"},children:""}),f.jsx("button",{onClick:()=>{Br(re),ki(null),za(!0),gt(!0)},style:{fontSize:"10px",color:"#64748B",background:"none",border:"none",cursor:"pointer",textDecoration:"underline"},children:"Replace"})]}):f.jsx(Ye,{icon:RB,small:!0,variant:"default",onClick:()=>{Br(re),ki(null),za(!1),gt(!0)}})}),f.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:f.jsxs("select",{value:re.toBeBilled,onChange:We=>ec(re.id,We.target.value),disabled:re.invoiceGenerated||!Rn,style:{padding:"6px 8px",fontSize:"12px",fontWeight:"600",border:"2px solid",borderRadius:"6px",borderColor:re.toBeBilled==="Yes"?"#22C55E":"#E2E8F0",backgroundColor:re.toBeBilled==="Yes"?"#DCFCE7":"#FFFFFF",color:re.toBeBilled==="Yes"?"#166534":"#64748B",cursor:re.invoiceGenerated||!Rn?"not-allowed":"pointer",width:"70px",opacity:!Rn&&!re.invoiceGenerated?.6:1},children:[f.jsx("option",{value:"Not Yet",children:"Not Yet"}),f.jsx("option",{value:"Yes",children:"Yes"})]})}),f.jsx("td",{style:{padding:"10px 14px"},children:f.jsx("input",{type:"number",value:re.invoiceAmount||"",onChange:We=>Ka(re.id,"invoiceAmount",We.target.value),disabled:re.invoiceGenerated,placeholder:"0",style:{width:"80px",padding:"6px 8px",fontSize:"13px",fontWeight:"600",border:"1.5px solid #D1D5DB",borderRadius:"6px",textAlign:"right",backgroundColor:re.invoiceGenerated?"#F3F4F6":"#FFFFFF"}})}),f.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:re.invoiceGenerated?f.jsx(Jg,{status:re.invoiceType,small:!0}):re.toBeBilled==="Yes"?f.jsxs("select",{value:re.invoiceType||"Individual",onChange:We=>Ka(re.id,"invoiceType",We.target.value),style:{padding:"6px 6px",fontSize:"11px",fontWeight:"600",border:"2px solid",borderRadius:"6px",borderColor:re.invoiceType==="Combined"?"#7C3AED":"#A5B4FC",backgroundColor:re.invoiceType==="Combined"?"#F3E8FF":"#E0E7FF",color:re.invoiceType==="Combined"?"#6B21A8":"#3730A3",cursor:"pointer",width:"80px"},children:[f.jsx("option",{value:"Individual",children:"Individual"}),f.jsx("option",{value:"Combined",children:"Combined"})]}):f.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),f.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:re.toBeBilled==="Yes"&&!re.invoiceGenerated&&re.invoiceAmount&&Ft?re.invoiceType==="Individual"?f.jsx(Ye,{icon:Bu,label:"Create",small:!0,variant:"warning",onClick:()=>b4(re)}):f.jsx(Ye,{icon:OB,label:"Combine",small:!0,variant:"purple",onClick:()=>D4(re)}):re.toBeBilled==="Yes"&&!re.invoiceGenerated&&re.invoiceAmount&&Rn?f.jsx("span",{style:{fontSize:"10px",color:"#94A3B8"},children:"Finance to create"}):f.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),f.jsx("td",{style:{padding:"10px 14px",backgroundColor:"#EFF6FF"},children:re.invoiceNo?f.jsx("span",{style:{fontWeight:"700",color:"#1E40AF",fontSize:"12px"},children:re.invoiceNo}):f.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),f.jsx("td",{style:{padding:"10px 14px",backgroundColor:"#EFF6FF",fontSize:"12px"},children:re.invoiceDate?hr(re.invoiceDate):"-"}),f.jsx("td",{style:{padding:"10px 14px",backgroundColor:"#EFF6FF",textAlign:"right",fontWeight:"700",color:"#1E40AF",fontSize:"13px"},children:re.invoiceTotalAmount?zt(re.invoiceTotalAmount):"-"}),f.jsx("td",{style:{padding:"10px 14px",textAlign:"center",backgroundColor:"#FAF5FF"},children:re.combinationCode&&re.combinationCode!=="NA"?f.jsx("span",{style:{fontWeight:"700",color:"#7C3AED",fontSize:"12px"},children:re.combinationCode}):"-"}),f.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:re.invoiceGenerated?Rn?f.jsx("button",{onClick:()=>V0(re),style:{padding:"5px 10px",fontSize:"11px",fontWeight:"700",border:"1.5px solid",borderRadius:"6px",cursor:"pointer",backgroundColor:re.invoiceStatus==="Approved"?"#DCFCE7":re.invoiceStatus==="Need Edits"?"#FEE2E2":"#FEF3C7",borderColor:re.invoiceStatus==="Approved"?"#22C55E":re.invoiceStatus==="Need Edits"?"#DC2626":"#F59E0B",color:re.invoiceStatus==="Approved"?"#166534":re.invoiceStatus==="Need Edits"?"#991B1B":"#92400E"},children:re.invoiceStatus==="Approved"?" Approved":re.invoiceStatus==="Need Edits"?" Need Edits":" Review"}):f.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"4px"},children:[f.jsx("span",{style:{padding:"4px 10px",fontSize:"11px",fontWeight:"700",borderRadius:"6px",backgroundColor:re.invoiceStatus==="Approved"?"#DCFCE7":re.invoiceStatus==="Need Edits"?"#FEE2E2":"#FEF3C7",color:re.invoiceStatus==="Approved"?"#166534":re.invoiceStatus==="Need Edits"?"#991B1B":"#92400E"},children:re.invoiceStatus==="Approved"?" Approved":re.invoiceStatus==="Need Edits"?" Need Edits":" Pending"}),(re.editComments||re.approvalRemarks)&&f.jsx("button",{onClick:()=>{Br(re),Mt(!0)},style:{fontSize:"9px",color:re.invoiceStatus==="Need Edits"?"#991B1B":"#166534",background:"none",border:"none",cursor:"pointer",textDecoration:"underline"},title:re.editComments||re.approvalRemarks,children:"View Remarks"})]}):f.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),f.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:re.invoiceGenerated&&re.invoiceStatus==="Approved"?f.jsxs("div",{style:{display:"flex",gap:"6px",justifyContent:"center"},children:[f.jsx(Ye,{icon:Fd,small:!0,onClick:()=>Au(re),title:"View Invoice"}),Ft&&f.jsx(Ye,{icon:Bg,small:!0,variant:"brand",onClick:()=>{Br(re),dt(!0)},title:"Send Email"}),Ft&&f.jsx(Ye,{icon:Us,small:!0,variant:"danger",onClick:()=>ys(re),title:"Delete"})]}):re.invoiceGenerated?f.jsxs("div",{style:{display:"flex",gap:"6px",justifyContent:"center"},children:[f.jsx(Ye,{icon:Fd,small:!0,onClick:()=>Au(re),title:"View Invoice"}),Ft&&f.jsx(Ye,{icon:Us,small:!0,variant:"danger",onClick:()=>ys(re),title:"Delete"})]}):f.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),f.jsx("td",{style:{padding:"10px 14px",textAlign:"center",backgroundColor:"#F0FDF4"},children:re.invoiceGenerated&&re.invoiceStatus==="Approved"&&Ft?Oe?f.jsx("span",{style:{fontSize:"10px",color:"#94A3B8"},children:"Combined sent"}):f.jsxs("select",{value:re.mailingSent||"No",onChange:We=>Ka(re.id,"mailingSent",We.target.value),style:{padding:"5px 8px",fontSize:"11px",fontWeight:"700",border:"2px solid",borderRadius:"6px",borderColor:re.mailingSent==="Yes"?"#22C55E":"#E2E8F0",backgroundColor:re.mailingSent==="Yes"?"#DCFCE7":"#FFFFFF",color:re.mailingSent==="Yes"?"#166534":"#64748B",cursor:"pointer",width:"60px"},children:[f.jsx("option",{value:"No",children:"No"}),f.jsx("option",{value:"Yes",children:"Yes"})]}):re.invoiceGenerated&&re.invoiceStatus==="Approved"&&Rn?f.jsx("span",{style:{padding:"4px 8px",borderRadius:"6px",fontSize:"11px",fontWeight:"600",backgroundColor:re.mailingSent==="Yes"?"#DCFCE7":"#FEF3C7",color:re.mailingSent==="Yes"?"#166534":"#92400E"},children:re.mailingSent==="Yes"?" Yes":" No"}):re.invoiceGenerated&&re.invoiceStatus!=="Approved"?f.jsx("span",{style:{fontSize:"10px",color:"#94A3B8"},children:"Approve first"}):f.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),f.jsx("td",{style:{padding:"10px 14px",textAlign:"center",backgroundColor:"#F0FDF4"},children:re.mailingSent==="Yes"?Ft?f.jsx("input",{type:"date",value:re.mailDate||re.invoiceDate||"",onChange:We=>Ka(re.id,"mailDate",We.target.value),style:{padding:"4px 6px",fontSize:"11px",border:"1.5px solid #D1D5DB",borderRadius:"6px",width:"100%"}}):f.jsx("span",{style:{fontSize:"11px"},children:hr(re.mailDate||re.invoiceDate)}):f.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),f.jsx("td",{style:{padding:"10px 14px",textAlign:"center",backgroundColor:"#FAF5FF"},children:re.receiptStatus==="Received"||re.receiptStatus==="Closed"?f.jsxs("span",{style:{padding:"4px 8px",borderRadius:"6px",fontSize:"10px",fontWeight:"700",backgroundColor:"#DCFCE7",color:"#166534"},children:[" ",re.receiptNo||"Received"]}):re.receiptStatus==="Cancelled"?f.jsx("span",{style:{padding:"4px 8px",borderRadius:"6px",fontSize:"10px",fontWeight:"700",backgroundColor:"#FEE2E2",color:"#991B1B"},children:" Cancelled"}):re.invoiceGenerated&&re.invoiceStatus==="Approved"?f.jsx("span",{style:{padding:"4px 8px",borderRadius:"6px",fontSize:"10px",fontWeight:"600",backgroundColor:"#FEF3C7",color:"#92400E"},children:" Pending"}):f.jsx("span",{style:{color:"#CBD5E1"},children:"-"})})]},re.id)})})]})})]},ne)})}),Y.length>0&&f.jsxs("div",{style:{marginTop:"16px",padding:"16px 20px",backgroundColor:"#FFFFFF",borderRadius:"12px",border:"1px solid #E2E8F0",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[f.jsxs("div",{style:{display:"flex",gap:"24px",fontSize:"14px",color:"#475569"},children:[f.jsxs("span",{children:[" Total: ",f.jsx("strong",{children:ee.length})]}),f.jsxs("span",{children:[" To Bill: ",f.jsx("strong",{children:ee.filter(ne=>ne.toBeBilled==="Yes").length})]}),f.jsxs("span",{children:[" Invoiced: ",f.jsx("strong",{children:ee.filter(ne=>ne.invoiceGenerated).length})]}),f.jsxs("span",{children:[" Approved: ",f.jsx("strong",{children:ee.filter(ne=>ne.invoiceStatus==="Approved").length})]}),In==="closed"&&f.jsxs("span",{children:[" Closed: ",f.jsx("strong",{children:ee.filter(ne=>ne.receiptStatus==="Received"||ne.receiptStatus==="Cancelled"||ne.receiptStatus==="Closed").length})]})]}),f.jsxs("div",{style:{fontSize:"18px",fontWeight:"700",color:"#059669"},children:["Total: ",ct(ee.filter(ne=>ne.toBeBilled==="Yes").reduce((ne,Le)=>ne+(parseFloat(Le.totalWithGst)||0),0))]})]})]})},$4=()=>{const g=new Map;bn.filter(fe=>fe.invoiceGenerated).forEach(fe=>{g.has(fe.invoiceNo)?g.get(fe.invoiceNo).campaigns.push(fe):g.set(fe.invoiceNo,{invoiceNo:fe.invoiceNo,partyName:fe.partyName,date:fe.invoiceDate,invoiceType:fe.invoiceType,combinationCode:fe.combinationCode,invoiceStatus:fe.invoiceStatus,mailingSent:fe.mailingSent,receiptStatus:fe.receiptStatus||"Pending",receiptNo:fe.receiptNo,campaigns:[fe],totalAmount:parseFloat(fe.invoiceTotalAmount)||0,isFromMaster:!0})});const I=fe=>{if(!fe)return"";const Ie=fe.split("/");return Ie.length>=3?Ie.slice(1).join("/"):Ie.length===2?Ie.join("/"):Ie[Ie.length-1]},Y=$i.filter(fe=>{var Ie;return fe.isHistorical&&(fe.type==="creditnote"||((Ie=fe.vchNo)==null?void 0:Ie.toUpperCase().startsWith("CN")))}),ee=new Map;Xl.forEach(fe=>{const Ie=I(fe.invoiceNo);Ie&&ee.set(Ie,fe)}),Y.forEach(fe=>{const Ie=I(fe.vchNo);Ie&&!ee.has(Ie)&&ee.set(Ie,fe)}),$i.filter(fe=>{var Ie;return fe.isHistorical&&fe.type!=="creditnote"&&!((Ie=fe.vchNo)!=null&&Ie.toUpperCase().startsWith("CN"))&&fe.debit>0}).forEach(fe=>{if(!g.has(fe.vchNo)){const Ie=ms.find(lt=>lt.invoiceNo===fe.vchNo),qe=I(fe.vchNo),re=ee.get(qe),Oe=re?Math.abs(parseFloat(re.totalAmount)||parseFloat(re.credit)||parseFloat(re.debit)||0):0,ue=parseFloat(fe.debit)||0;if(re&&Oe>=ue)return;const Se=!Ie&&!(fe.amountReceived>0),We=re&&Oe>0&&Oe<ue;if(Se||We){const lt=We?ue-Oe:ue;g.set(fe.vchNo,{invoiceNo:fe.vchNo,partyName:fe.partyName,date:fe.date,invoiceType:"Historical",combinationCode:"",invoiceStatus:"Approved",mailingSent:"Yes",receiptStatus:We?"Partial CN":"Pending",receiptNo:"",campaigns:[],totalAmount:ue,pendingAmount:lt,hasPartialCN:We,cnAmount:Oe,isHistorical:!0,historicalEntry:fe})}}});let Q=Array.from(g.values());if(er.party&&(Q=Q.filter(fe=>fe.partyName===er.party)),er.invoiceStatus&&(Q=Q.filter(fe=>fe.invoiceStatus===er.invoiceStatus)),er.receiptStatus&&(er.receiptStatus==="Received"?Q=Q.filter(fe=>fe.receiptStatus==="Received"):er.receiptStatus==="Pending"&&(Q=Q.filter(fe=>fe.receiptStatus!=="Received"))),er.invoiceType&&(Q=Q.filter(fe=>fe.invoiceType===er.invoiceType)),er.searchText){const fe=er.searchText.toLowerCase();Q=Q.filter(Ie=>{var qe,re;return((qe=Ie.invoiceNo)==null?void 0:qe.toLowerCase().includes(fe))||((re=Ie.partyName)==null?void 0:re.toLowerCase().includes(fe))})}const K={};Q.forEach(fe=>{K[fe.partyName]||(K[fe.partyName]=[]),K[fe.partyName].push(fe)});const ne=Object.keys(K).sort(),Le=er.party||er.invoiceStatus||er.receiptStatus||er.invoiceType||er.searchText,Ke=Array.from(g.values());return f.jsxs("div",{children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[f.jsx("h1",{style:{margin:0,fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:" Invoice & Receipt Register"}),Rn&&f.jsx("span",{style:{padding:"8px 16px",backgroundColor:"#FEF3C7",borderRadius:"8px",fontSize:"13px",color:"#92400E",fontWeight:"600"},children:" View Only"})]}),f.jsx("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"10px",border:"1px solid #E2E8F0",padding:"14px 18px",marginBottom:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"14px",flexWrap:"wrap"},children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[f.jsx(Lg,{size:18,color:"#64748B"}),f.jsx("span",{style:{fontSize:"13px",fontWeight:"700",color:"#475569"},children:"Filters:"})]}),f.jsxs("div",{style:{position:"relative"},children:[f.jsx(Rd,{size:14,style:{position:"absolute",left:"10px",top:"50%",transform:"translateY(-50%)",color:"#94A3B8"}}),f.jsx("input",{type:"text",placeholder:"Search invoice...",value:er.searchText,onChange:fe=>fr(Ie=>({...Ie,searchText:fe.target.value})),style:{padding:"8px 12px 8px 32px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",width:"160px"}})]}),f.jsxs("select",{value:er.party,onChange:fe=>fr(Ie=>({...Ie,party:fe.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:"#FFFFFF"},children:[f.jsx("option",{value:"",children:"All Parties"}),Xo.map(fe=>f.jsx("option",{value:fe,children:fe},fe))]}),f.jsxs("select",{value:er.invoiceStatus,onChange:fe=>fr(Ie=>({...Ie,invoiceStatus:fe.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:"#FFFFFF"},children:[f.jsx("option",{value:"",children:"All Status"}),f.jsx("option",{value:"Created",children:"Created"}),f.jsx("option",{value:"Approved",children:"Approved"}),f.jsx("option",{value:"Need Edits",children:"Need Edits"})]}),f.jsxs("select",{value:er.receiptStatus,onChange:fe=>fr(Ie=>({...Ie,receiptStatus:fe.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:"#FFFFFF"},children:[f.jsx("option",{value:"",children:"All Receipts"}),f.jsx("option",{value:"Received",children:"Received"}),f.jsx("option",{value:"Pending",children:"Pending"})]}),f.jsxs("select",{value:er.invoiceType,onChange:fe=>fr(Ie=>({...Ie,invoiceType:fe.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:"#FFFFFF"},children:[f.jsx("option",{value:"",children:"All Types"}),f.jsx("option",{value:"Individual",children:"Individual"}),f.jsx("option",{value:"Combined",children:"Combined"})]}),Le&&f.jsxs(f.Fragment,{children:[f.jsxs("button",{onClick:()=>fr({party:"",invoiceStatus:"",receiptStatus:"",invoiceType:"",searchText:""}),style:{padding:"8px 12px",fontSize:"13px",fontWeight:"600",border:"1.5px solid #FCA5A5",borderRadius:"8px",backgroundColor:"#FEE2E2",color:"#991B1B",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},children:[f.jsx(rl,{size:14})," Clear"]}),f.jsxs("span",{style:{fontSize:"13px",color:"#64748B"},children:["Showing ",Q.length," of ",Ke.length]})]})]})}),f.jsx(mn,{noPadding:!0,children:f.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"12px"},children:[f.jsx("thead",{children:f.jsxs("tr",{style:{backgroundColor:"#F8FAFC",borderBottom:"2px solid #E2E8F0"},children:[f.jsx("th",{style:{padding:"10px 12px",textAlign:"left",fontWeight:"700"},children:"Invoice No"}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"left",fontWeight:"700"},children:"Date"}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Type"}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700"},children:"Amount"}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700",backgroundColor:"#F0FDF4",color:"#166534"},children:"Received"}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700",backgroundColor:"#FEF3C7",color:"#92400E"},children:"TDS"}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700",backgroundColor:"#FEE2E2",color:"#991B1B"},children:"CN Amt"}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700",backgroundColor:"#EFF6FF",color:"#1E40AF"},children:"Balance"}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Inv. Status"}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Receipt No."}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"CN No."}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Actions"})]})}),f.jsx("tbody",{children:ne.length===0?f.jsx("tr",{children:f.jsx("td",{colSpan:"12",style:{padding:"50px",textAlign:"center",color:"#94A3B8"},children:Le?"No matching invoices":"No invoices generated yet"})}):ne.map(fe=>{const Ie=K[fe],qe=$o.has(fe);let re=0;return Ie.forEach(Oe=>{const ue=J.find(be=>be.invoiceNo===Oe.invoiceNo),Ge=Me.find(be=>be.invoiceNo===Oe.invoiceNo),Se=Ee.find(be=>be.invoiceNo===Oe.invoiceNo&&be.type==="tds"),We=Ee.find(be=>be.invoiceNo===Oe.invoiceNo&&be.type==="discount"),lt=Oe.totalAmount||0,Nt=ue&&parseFloat(ue.amount)||0,$t=Se?parseFloat(Se.credit)||0:ue&&parseFloat(ue.tds)||0,yr=Ge?Math.abs(parseFloat(Ge.totalAmount)||0):0,rn=We&&parseFloat(We.credit)||0,Z=Math.max(0,lt-Nt-$t-yr-rn);re+=Z}),f.jsxs(Vd.Fragment,{children:[f.jsxs("tr",{onClick:()=>ny(fe),style:{backgroundColor:"#1E3A5F",color:"white",cursor:"pointer",borderBottom:"1px solid #0F2744"},children:[f.jsx("td",{colSpan:"3",style:{padding:"10px 12px",fontWeight:"700",fontSize:"13px"},children:f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[qe?f.jsx(D2,{size:18}):f.jsx(Og,{size:18}),f.jsx(B2,{size:16}),fe,f.jsxs("span",{style:{backgroundColor:"#2874A6",padding:"2px 10px",borderRadius:"12px",fontSize:"11px",fontWeight:"600"},children:[Ie.length," inv"]})]})}),f.jsx("td",{colSpan:"4",style:{padding:"10px 12px"}}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700",fontSize:"13px",backgroundColor:re===0?"#22C55E":"#3B82F6"},children:re===0?" Nil":`Bal: ${ct(re)}`}),f.jsx("td",{colSpan:"4",style:{padding:"10px 12px"}})]}),qe&&Ie.map(Oe=>{const ue=J.find(Ut=>Ut.invoiceNo===Oe.invoiceNo),Ge=Me.find(Ut=>Ut.invoiceNo===Oe.invoiceNo),Se=Ee.find(Ut=>Ut.invoiceNo===Oe.invoiceNo&&Ut.type==="tds"),We=Ee.find(Ut=>Ut.invoiceNo===Oe.invoiceNo&&Ut.type==="discount"),lt=Oe.totalAmount||0,Nt=ue&&parseFloat(ue.amount)||0,$t=Se?parseFloat(Se.credit)||0:ue&&parseFloat(ue.tds)||0,yr=Ge?Math.abs(parseFloat(Ge.totalAmount)||0):0,rn=We&&parseFloat(We.credit)||0,Z=Math.max(0,lt-Nt-$t-yr-rn),be=yr>=lt&&!ue;return f.jsxs("tr",{style:{borderBottom:"1px solid #F1F5F9",backgroundColor:Oe.invoiceType==="Combined"?"#FAF5FF":Z===0?"#F0FDF4":"transparent"},children:[f.jsx("td",{style:{padding:"10px 12px 10px 36px",fontWeight:"700",color:Oe.invoiceType==="Combined"?"#7C3AED":"#2874A6"},children:Oe.invoiceNo}),f.jsx("td",{style:{padding:"10px 12px"},children:hr(Oe.date)}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:f.jsx(Jg,{status:Oe.invoiceType,small:!0})}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700"},children:ct(lt)}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"600",backgroundColor:"#F0FDF4",color:Nt>0?"#166534":"#94A3B8"},children:Nt>0?ct(Nt):"-"}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"600",backgroundColor:"#FEF3C7",color:$t>0?"#92400E":"#94A3B8"},children:$t>0?ct($t):"-"}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"600",backgroundColor:"#FEE2E2",color:yr>0?"#991B1B":"#94A3B8"},children:yr>0?ct(yr):"-"}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700",backgroundColor:"#EFF6FF",color:Z>0?"#1E40AF":"#166534"},children:Z===0?" Nil":ct(Z)}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:f.jsx(Jg,{status:Oe.invoiceStatus,small:!0})}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:be?f.jsx("span",{style:{padding:"4px 10px",borderRadius:"12px",fontSize:"11px",fontWeight:"700",backgroundColor:"#FEE2E2",color:"#991B1B"},children:" Cancelled"}):ue?f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px",justifyContent:"center"},children:[f.jsxs("button",{onClick:()=>It(ue),style:{padding:"4px 8px",borderRadius:"12px",fontSize:"10px",fontWeight:"700",backgroundColor:"#DCFCE7",color:"#166534",border:"none",cursor:"pointer",textDecoration:"underline"},title:"Click to view receipt",children:[" ",ue.receiptNo]}),Ft&&f.jsx("button",{onClick:()=>G0(ue),style:{padding:"2px 4px",borderRadius:"4px",fontSize:"10px",backgroundColor:"#FEE2E2",color:"#991B1B",border:"none",cursor:"pointer"},title:"Delete Receipt",children:""})]}):f.jsx("span",{style:{padding:"4px 10px",borderRadius:"12px",fontSize:"11px",fontWeight:"600",backgroundColor:"#FEF3C7",color:"#92400E"},children:" Pending"})}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:Ge?f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px",justifyContent:"center"},children:[f.jsx("button",{onClick:()=>en(Ge),style:{padding:"4px 8px",borderRadius:"12px",fontSize:"10px",fontWeight:"700",backgroundColor:"#FEE2E2",color:"#991B1B",border:"none",cursor:"pointer",textDecoration:"underline"},title:"Click to view credit note",children:Ge.creditNoteNo}),Ft&&f.jsx("button",{onClick:()=>K0(Ge),style:{padding:"2px 4px",borderRadius:"4px",fontSize:"10px",backgroundColor:"#FEE2E2",color:"#991B1B",border:"none",cursor:"pointer"},title:"Delete Credit Note",children:""})]}):f.jsx("span",{style:{color:"#94A3B8",fontSize:"11px"},children:"-"})}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:f.jsx("div",{style:{display:"flex",gap:"4px",justifyContent:"center",flexWrap:"wrap"},children:Oe.isHistorical?f.jsxs(f.Fragment,{children:[Ft&&!ue&&f.jsx(Ye,{icon:Bu,small:!0,variant:"success",onClick:()=>{const Ut={invoiceNo:Oe.invoiceNo,partyName:Oe.partyName,invoiceDate:Oe.date,invoiceTotalAmount:Oe.totalAmount,invoiceStatus:"Approved",mailingSent:"Yes",invoiceType:"Historical",isHistorical:!0};Jl(Ut)},title:"Create Receipt"}),Ft&&!Ge&&f.jsx(Ye,{icon:Lu,small:!0,variant:"primary",onClick:()=>{const Ut={invoiceNo:Oe.invoiceNo,partyName:Oe.partyName,invoiceDate:Oe.date,invoiceTotalAmount:Oe.totalAmount,invoiceStatus:"Approved",isHistorical:!0};Qo(Ut)},title:"Credit Note"})]}):f.jsxs(f.Fragment,{children:[f.jsx(Ye,{icon:Fd,small:!0,variant:"brand",onClick:()=>Au(Oe.campaigns[0]),title:"View Invoice"}),Ft&&Oe.invoiceStatus==="Approved"&&Oe.mailingSent==="Yes"&&!ue&&f.jsx(Ye,{icon:Bu,small:!0,variant:"success",onClick:()=>Jl(Oe.campaigns[0]),title:"Create Receipt"}),Ft&&Oe.invoiceStatus==="Approved"&&!Ge&&f.jsx(Ye,{icon:Lu,small:!0,variant:"primary",onClick:()=>Qo(Oe.campaigns[0]),title:"Credit Note"}),Ft&&f.jsx(Ye,{icon:Us,small:!0,variant:"danger",onClick:()=>ys(Oe.campaigns[0]),title:"Delete Invoice"})]})})})]},Oe.invoiceNo)})]},fe)})})]})})]})},H4=()=>{if(!H){alert("Please select a party first");return}const g=Zn[H]||0,I=ge.filter(Z=>Z.partyName===H&&Z.invoiceGenerated&&Z.invoiceStatus==="Approved"),Y=new Map;I.forEach(Z=>{Y.has(Z.invoiceNo)?Y.get(Z.invoiceNo).campaigns.push(Z):Y.set(Z.invoiceNo,{invoiceNo:Z.invoiceNo,invoiceDate:Z.invoiceDate,campaigns:[Z],isFromMaster:!0})});const ee=Ee.filter(Z=>{var be;return Z.partyName===H&&Z.isHistorical&&Z.type!=="creditnote"&&!((be=Z.vchNo)!=null&&be.toUpperCase().startsWith("CN"))}),Q=Ee.filter(Z=>{var be;return Z.partyName===H&&Z.isHistorical&&(Z.type==="creditnote"||((be=Z.vchNo)==null?void 0:be.toUpperCase().startsWith("CN")))}),K=J.filter(Z=>Z.partyName===H),ne=Me.filter(Z=>Z.partyName===H),Le=Z=>{if(!Z)return"";const be=Z.split("/");return be.length>=3?be.slice(1).join("/"):be.length===2?be.join("/"):be[be.length-1]},Ke=new Map;ne.forEach(Z=>{const be=Le(Z.invoiceNo);be&&!Ke.has(be)&&Ke.set(be,{...Z,isSystemCN:!0})}),Q.forEach(Z=>{const be=Le(Z.vchNo);be&&!Ke.has(be)&&Ke.set(be,{...Z,isHistoricalCN:!0})});let fe=[],Ie=0,qe=0,re=0,Oe=0,ue=g;const Ge=new Set;g!==0&&(Ie+=g>0?g:0,qe+=g<0?Math.abs(g):0,fe.push({date:"",particular:"Opening Balance",vchType:"",vchNo:"",debit:g>0?g:0,credit:g<0?Math.abs(g):0,receiptDate:"",amountReceived:0,tds:0,balance:g,status:"",isMain:!0,isOpening:!0}));const Se=[];Array.from(Y.values()).filter(Z=>{const be=new Date(Z.invoiceDate);return be>=new Date(vr.fromDate)&&be<=new Date(vr.toDate)}).forEach(Z=>{Se.push({...Z,entryType:"invoice",sortDate:Z.invoiceDate})}),ee.filter(Z=>{if(!Z.date)return!1;const be=new Date(Z.date);return be>=new Date(vr.fromDate)&&be<=new Date(vr.toDate)}).forEach(Z=>{Se.push({...Z,entryType:"invoice",sortDate:Z.date})}),Se.sort((Z,be)=>new Date(Z.sortDate)-new Date(be.sortDate)),Se.forEach(Z=>{var be,Ut;if(Z.isFromMaster){const At=Z;let Cr=0;At.campaigns.forEach(Pn=>Cr+=parseFloat(Pn.invoiceAmount)||0);const tr=(Ut=(be=At.campaigns[0])==null?void 0:be.statePartyDetails)==null?void 0:Ut.toUpperCase().includes("MAHARASHTRA"),Ht=tr?Cr*.09:0,Nn=tr?Cr*.09:0,nn=tr?0:Cr*.18,Gr=Cr+Ht+Nn+nn,_s=Le(At.invoiceNo),Lt=Ke.get(_s),Dn=!!Lt,hi=K.find(Pn=>Pn.invoiceNo===At.invoiceNo);ue+=Gr,Ie+=Gr;let ua=0,Xa=0,fa="",qa=Dn?"":"Pending";if(hi&&(qa="Received",ua=hi.amount||0,Xa=hi.tds||0,fa=hi.date,re+=ua,Oe+=Xa,ue-=ua+Xa+(hi.discount||0)),fe.push({date:At.invoiceDate,particular:H,vchType:"Sales",vchNo:At.invoiceNo,debit:Gr,credit:0,receiptDate:fa,amountReceived:ua,tds:Xa,balance:Dn?"-":qa==="Received"?0:Gr-ua-Xa,status:qa,isMain:!0,hasCN:Dn}),fe.push({particular:"PROMOTIONAL TRADE EMAILER"+(At.campaigns.length>1?"S":""),credit:Cr,isMain:!1,hasCN:Dn}),tr?(fe.push({particular:"CGST",credit:Ht,isMain:!1,hasCN:Dn}),fe.push({particular:"SGST",credit:Nn,isMain:!1,hasCN:Dn})):fe.push({particular:"IGST",credit:nn,isMain:!1,hasCN:Dn}),Lt&&!Ge.has(_s)){Ge.add(_s);const Pn=Math.abs(Lt.totalAmount||Lt.credit||0);ue-=Pn,qe+=Pn,fe.push({date:Lt.date,particular:H,vchType:"Credit Note",vchNo:Lt.creditNoteNo||Lt.vchNo,debit:0,credit:Pn,receiptDate:"",amountReceived:0,tds:0,balance:"-",status:"",isMain:!0,isCreditNote:!0,hasCN:!0});const Ya=Math.abs(Lt.amount)||Pn/1.18,Jo=Math.abs(Lt.gst)||Pn-Ya;fe.push({particular:"PROMOTIONAL TRADE EMAILER",credit:Ya,isMain:!1,isCreditNote:!0,hasCN:!0}),fe.push({particular:Lt.gstType||(tr?"CGST + SGST":"IGST"),credit:Jo,isMain:!1,isCreditNote:!0,hasCN:!0})}}else if(Z.isHistorical){const At=Z.debit||0,Cr=Z.credit||0,tr=Le(Z.vchNo),Ht=Ke.get(tr),Nn=!!Ht;if(ue+=At-Cr,Ie+=At,qe+=Cr,fe.push({date:Z.date,particular:Z.particulars||H,vchType:Z.vchType||"Sales",vchNo:Z.vchNo,debit:At,credit:Cr,receiptDate:Z.receiptDate||"",amountReceived:Z.amountReceived||0,tds:Z.tdsReceived||0,balance:Nn?"-":At-(Z.amountReceived||0)-(Z.tdsReceived||0),status:Nn?"":Z.paymentStatus||"",isMain:!0,isHistorical:!0,hasCN:Nn}),Z.subRows&&Z.subRows.length>0&&Z.subRows.forEach(nn=>{fe.push({particular:nn.particular,debit:nn.debit,credit:nn.credit,isMain:!1,hasCN:Nn})}),Ht&&!Ge.has(tr)){Ge.add(tr);const nn=Math.abs(Ht.totalAmount||Ht.credit||0);ue-=nn,qe+=nn,fe.push({date:Ht.date,particular:H,vchType:"Credit Note",vchNo:Ht.creditNoteNo||Ht.vchNo,debit:0,credit:nn,receiptDate:"",amountReceived:0,tds:0,balance:"-",status:"",isMain:!0,isCreditNote:!0,hasCN:!0}),Ht.subRows&&Ht.subRows.length>0&&Ht.subRows.forEach(Gr=>{fe.push({particular:Gr.particular,credit:Math.abs(Gr.credit||0),isMain:!1,isCreditNote:!0,hasCN:!0})})}}});const We=fe.reduce((Z,be)=>be.isMain&&typeof be.balance=="number"&&be.balance>0?Z+be.balance:Z,0),lt=ge.find(Z=>Z.partyName===H),Nt=Zr[H],$t=(lt==null?void 0:lt.statePartyDetails)||(lt==null?void 0:lt.address)||(Nt==null?void 0:Nt.stateName)||"",yr=`
<!DOCTYPE html>
<html>
<head>
  <title>Ledger Account - ${H}</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: Arial, sans-serif; font-size: 11px; padding: 20px; }
    .header { text-align: center; margin-bottom: 15px; }
    .firm-name { font-size: 18px; font-weight: bold; color: #1E293B; }
    .firm-address { font-size: 10px; color: #666; margin-top: 2px; }
    .party-section { text-align: center; margin: 15px 0; padding: 10px; border: 1px solid #ddd; background: #f9f9f9; }
    .party-name { font-size: 14px; font-weight: bold; }
    .ledger-title { font-size: 11px; color: #666; }
    .party-address { font-size: 10px; color: #666; margin-top: 5px; }
    .period { text-align: center; font-size: 11px; margin: 10px 0; font-weight: bold; }
    .totals { display: flex; justify-content: space-around; background: #e8f4fd; padding: 8px; margin-bottom: 10px; font-size: 10px; border: 1px solid #ccc; }
    .totals div { text-align: center; }
    .totals .label { color: #666; }
    .totals .value { font-weight: bold; font-size: 11px; }
    .closing-balance { text-align: center; background: #1E293B; color: white; padding: 10px; margin-bottom: 10px; font-size: 14px; font-weight: bold; }
    table { width: 100%; border-collapse: collapse; font-size: 10px; }
    th { background: #f0f0f0; border: 1px solid #ccc; padding: 6px 4px; text-align: left; font-weight: bold; }
    td { border: 1px solid #ddd; padding: 5px 4px; }
    .text-right { text-align: right; }
    .text-center { text-align: center; }
    .main-row { background: #fff; }
    .main-row-cn { background: #fffbeb; }
    .sub-row { background: #fafafa; }
    .sub-row-cn { background: #fffbeb; }
    .sub-row td { padding-left: 20px; color: #666; font-size: 9px; }
    .opening-row { background: #fef3c7; font-weight: bold; }
    .credit-note-row { background: #fffbeb; }
    .status-received { background: #dcfce7; color: #166534; padding: 2px 6px; border-radius: 3px; font-size: 9px; }
    .status-pending { background: #fef3c7; color: #92400e; padding: 2px 6px; border-radius: 3px; font-size: 9px; }
    .debit { color: #dc2626; }
    .credit { color: #059669; }
    @media print { 
      body { padding: 10px; } 
      @page { size: landscape; margin: 10mm; }
    }
  </style>
</head>
<body>
  <div class="header">
    <div class="firm-name">${S.name}</div>
    <div class="firm-address">${S.address}</div>
    <div class="firm-address">${S.addressLine2}, ${S.city}</div>
    <div class="firm-address">E-Mail: ${S.email}</div>
  </div>
  
  <div class="party-section">
    <div class="party-name">${H}</div>
    <div class="ledger-title">Ledger Account</div>
    ${$t?`<div class="party-address">${$t}</div>`:""}
  </div>
  
  <div class="period">${hr(vr.fromDate)} to ${hr(vr.toDate)}</div>
  
  <div class="closing-balance">
    Closing Balance: ${zt(Math.abs(We))} ${We>0?"(Dr)":We<0?"(Cr)":""}
  </div>
  
  <div class="totals">
    <div><div class="label">Debit</div><div class="value">${zt(Ie)}</div></div>
    <div><div class="label">Credit</div><div class="value">${zt(qe)}</div></div>
    <div><div class="label">Amount Received</div><div class="value credit">${zt(re)}</div></div>
    <div><div class="label">TDS Received</div><div class="value">${zt(Oe)}</div></div>
  </div>
  
  <table>
    <thead>
      <tr>
        <th style="width:65px">Date</th>
        <th>Particular</th>
        <th style="width:70px" class="text-center">Vch Type</th>
        <th style="width:100px">Vch No.</th>
        <th style="width:80px" class="text-right">Debit</th>
        <th style="width:80px" class="text-right">Credit</th>
        <th style="width:70px" class="text-center">Date of Receipt</th>
        <th style="width:85px" class="text-right">Amount Received</th>
        <th style="width:70px" class="text-right">TDS Received</th>
        <th style="width:75px" class="text-right">Balance</th>
        <th style="width:70px" class="text-center">Payment Status</th>
      </tr>
    </thead>
    <tbody>
      ${fe.map(Z=>Z.isMain?`
        <tr class="${Z.isOpening?"opening-row":Z.hasCN||Z.isCreditNote?"main-row-cn":"main-row"}">
          <td>${Z.date?hr(Z.date):""}</td>
          <td style="font-weight:600">${Z.particular}</td>
          <td class="text-center">${Z.vchType||""}</td>
          <td style="color:#2874A6;font-weight:600">${Z.vchNo||""}</td>
          <td class="text-right">${Z.debit>0?zt(Z.debit):""}</td>
          <td class="text-right" style="color:#DC2626">${Z.credit>0?zt(Z.credit):""}</td>
          <td class="text-center">${Z.receiptDate?hr(Z.receiptDate):""}</td>
          <td class="text-right credit">${Z.amountReceived>0?zt(Z.amountReceived):""}</td>
          <td class="text-right">${Z.tds>0?zt(Z.tds):""}</td>
          <td class="text-right">${Z.balance==="-"?"-":Z.balance>0?zt(Z.balance):""}</td>
          <td class="text-center">${Z.status?`<span class="${Z.status==="Received"?"status-received":"status-pending"}">${Z.status}</span>`:""}</td>
        </tr>
      `:`
        <tr class="${Z.hasCN||Z.isCreditNote?"sub-row-cn":"sub-row"}">
          <td></td>
          <td style="padding-left:20px;color:#666">${Z.particular}</td>
          <td></td>
          <td></td>
          <td class="text-right">${Z.debit?zt(Z.debit):""}</td>
          <td class="text-right">${Z.credit?zt(Z.credit):""}</td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
        </tr>
      `).join("")}
    </tbody>
  </table>
  
  <script>window.onload = function() { window.print(); }<\/script>
</body>
</html>`,rn=window.open("","_blank");rn.document.write(yr),rn.document.close()},G4=()=>{const g=K=>{const ne=Zn[K]||0,Le=ge.filter(Se=>Se.partyName===K&&Se.invoiceGenerated&&Se.invoiceStatus==="Approved"),Ke=new Map;Le.forEach(Se=>{Ke.has(Se.invoiceNo)?Ke.get(Se.invoiceNo).campaigns.push(Se):Ke.set(Se.invoiceNo,{invoiceNo:Se.invoiceNo,campaigns:[Se],totalAmount:parseFloat(Se.invoiceTotalAmount)||0})});const fe=J.filter(Se=>Se.partyName===K),Ie=Me.filter(Se=>Se.partyName===K),qe=Ee.filter(Se=>{var We;return Se.partyName===K&&Se.isHistorical&&Se.type!=="creditnote"&&!((We=Se.vchNo)!=null&&We.toUpperCase().startsWith("CN"))}),re=Ee.filter(Se=>{var We;return Se.partyName===K&&Se.isHistorical&&(Se.type==="creditnote"||((We=Se.vchNo)==null?void 0:We.toUpperCase().startsWith("CN")))}),Oe=Se=>{if(!Se)return"";const We=Se.split("/");return We.length>=3?We.slice(1).join("/"):We.length===2?We.join("/"):We[We.length-1]},ue=new Map;Ie.forEach(Se=>{const We=Oe(Se.invoiceNo);We&&!ue.has(We)&&ue.set(We,Se)}),re.forEach(Se=>{const We=Oe(Se.vchNo);We&&!ue.has(We)&&ue.set(We,Se)});let Ge=0;return ne>0&&(Ge+=ne),Array.from(Ke.values()).forEach(Se=>{const We=Se.totalAmount,lt=Oe(Se.invoiceNo),Nt=ue.get(lt),$t=Nt?Math.abs(parseFloat(Nt.totalAmount)||parseFloat(Nt.credit)||0):0;if(!(Nt&&$t>=We)){let rn=Nt?We-$t:We;const Z=fe.find(be=>be.invoiceNo===Se.invoiceNo);if(Z){const be=rn-(parseFloat(Z.amount)||0)-(parseFloat(Z.tds)||0)-(parseFloat(Z.discount)||0);be>0&&(Ge+=be)}else rn>0&&(Ge+=rn)}}),qe.forEach(Se=>{const We=Oe(Se.vchNo),lt=ue.get(We),Nt=lt?Math.abs(parseFloat(lt.totalAmount)||parseFloat(lt.credit)||parseFloat(lt.debit)||0):0,$t=parseFloat(Se.debit)||0;if(!(lt&&Nt>=$t)){let rn=lt?$t-Nt:$t;const Z=parseFloat(Se.amountReceived)||0,be=parseFloat(Se.tdsReceived)||0,Ut=rn-Z-be;Ut>0&&(Ge+=Ut)}}),Ge},I=Xo.filter(K=>K.toLowerCase().includes(Va.toLowerCase())),Y=K=>{const ne=ge.find(Le=>Le.partyName===K);return(ne==null?void 0:ne.statePartyDetails)||""},Q=(()=>{if(!H)return{entries:[],totals:{debit:0,credit:0,received:0,tds:0,balance:0}};const K=Zn[H]||0,ne=Z=>{if(!Z)return"";const be=Z.split("/");return be.length>=3?be.slice(1).join("/"):be.length===2?be.join("/"):be[be.length-1]},Le=ge.filter(Z=>Z.partyName===H&&Z.invoiceGenerated&&Z.invoiceStatus==="Approved"),Ke=new Map;Le.forEach(Z=>{Ke.has(Z.invoiceNo)?Ke.get(Z.invoiceNo).campaigns.push(Z):Ke.set(Z.invoiceNo,{invoiceNo:Z.invoiceNo,invoiceDate:Z.invoiceDate,invoiceType:Z.invoiceType,combinationCode:Z.combinationCode,receiptStatus:Z.receiptStatus,receiptNo:Z.receiptNo,receiptDate:Z.receiptDate,creditNoteNo:Z.creditNoteNo,campaigns:[Z],isFromMaster:!0})});const fe=Ee.filter(Z=>{var be;return Z.partyName===H&&Z.isHistorical&&Z.type!=="creditnote"&&!((be=Z.vchNo)!=null&&be.toUpperCase().startsWith("CN"))}),Ie=Ee.filter(Z=>{var be;return Z.partyName===H&&Z.isHistorical&&(Z.type==="creditnote"||((be=Z.vchNo)==null?void 0:be.toUpperCase().startsWith("CN")))}),qe=J.filter(Z=>Z.partyName===H),re=Me.filter(Z=>Z.partyName===H),Oe=new Map;re.forEach(Z=>{const be=ne(Z.invoiceNo);be&&!Oe.has(be)&&Oe.set(be,{...Z,isSystemCN:!0})}),Ie.forEach(Z=>{const be=ne(Z.vchNo);be&&!Oe.has(be)&&Oe.set(be,{...Z,isHistoricalCN:!0})});const ue=[];let Ge=K,Se=0,We=0,lt=0,Nt=0;const $t=new Set;K!==0&&(ue.push({id:"opening",date:"",particular:"Opening Balance",vchType:"",vchNo:"",debit:K>0?K:0,credit:K<0?Math.abs(K):0,receiptDate:"",amountReceived:0,tdsReceived:0,balance:K,paymentStatus:"",isOpening:!0,subRows:[]}),Se+=K>0?K:0,We+=K<0?Math.abs(K):0);const yr=[];Array.from(Ke.values()).filter(Z=>{const be=new Date(Z.invoiceDate),Ut=new Date(vr.fromDate),At=new Date(vr.toDate);return be>=Ut&&be<=At}).forEach(Z=>{yr.push({...Z,entryType:"invoice",sortDate:Z.invoiceDate})}),fe.filter(Z=>{if(!Z.date)return!1;const be=new Date(Z.date),Ut=new Date(vr.fromDate),At=new Date(vr.toDate);return be>=Ut&&be<=At}).forEach(Z=>{yr.push({...Z,entryType:Z.type||"invoice",sortDate:Z.date})}),yr.sort((Z,be)=>new Date(Z.sortDate)-new Date(be.sortDate)),yr.forEach(Z=>{var be,Ut;if(Z.isFromMaster){const At=Z;let Cr=0;At.campaigns.forEach(Bs=>{Cr+=parseFloat(Bs.invoiceAmount)||0});const tr=(Ut=(be=At.campaigns[0])==null?void 0:be.statePartyDetails)==null?void 0:Ut.toUpperCase().includes("MAHARASHTRA"),Ht=tr?Cr*.09:0,Nn=tr?Cr*.09:0,nn=tr?0:Cr*.18,Gr=Cr+Ht+Nn+nn,_s=ne(At.invoiceNo),Lt=Oe.get(_s),Dn=Lt?Math.abs(Lt.totalAmount||Lt.credit||0):0,hi=!!Lt,ua=hi&&Dn>=Gr,Xa=hi&&!ua?Gr-Dn:0,fa=qe.find(Bs=>Bs.invoiceNo===At.invoiceNo);Ge+=Gr,Se+=Gr;const qa=[{particular:"PROMOTIONAL TRADE EMAILER"+(At.campaigns.length>1?"S":""),credit:Cr}];tr?(qa.push({particular:"CGST",credit:Ht}),qa.push({particular:"SGST",credit:Nn})):qa.push({particular:"IGST",credit:nn});let Pn="",Ya=0,Jo=0,ly="",rc=Gr;if(fa?(Pn="Received",Ya=fa.amount||0,Jo=fa.tds||0,ly=fa.date,lt+=Ya,Nt+=Jo,rc=Gr-Ya-Jo-(fa.discount||0),Ge-=Ya+Jo+(fa.discount||0)):At.receiptStatus==="Received"?(Pn="Received",rc=0):ua?(Pn="CN Closed",rc=0):hi&&Xa>0?(Pn="Partial CN",rc=Xa):Pn="Pending",ue.push({id:At.invoiceNo,date:At.invoiceDate,particular:H,vchType:"Sales",vchNo:At.invoiceNo,debit:Gr,credit:0,receiptDate:ly,amountReceived:Ya,tdsReceived:Jo,balance:ua?"-":rc>0?rc:0,paymentStatus:Pn,isInvoice:!0,hasCN:hi,subRows:qa}),Lt&&!$t.has(_s)){$t.add(_s);const Bs=Math.abs(Lt.totalAmount||Lt.credit||0);Ge-=Bs,We+=Bs;const Zo=[];if(Lt.amount&&Zo.push({particular:"PROMOTIONAL TRADE EMAILER",credit:Math.abs(Lt.amount)}),Lt.gst&&Zo.push({particular:Lt.gstType||(tr?"CGST + SGST":"IGST"),credit:Math.abs(Lt.gst)}),Zo.length===0&&Bs>0){const cy=Bs/1.18,Z4=Bs-cy;Zo.push({particular:"PROMOTIONAL TRADE EMAILER",credit:cy}),Zo.push({particular:tr?"CGST + SGST":"IGST",credit:Z4})}ue.push({id:Lt.id||Lt.creditNoteNo||`cn-${_s}`,date:Lt.date,particular:H,vchType:"Credit Note",vchNo:Lt.creditNoteNo||Lt.vchNo,debit:0,credit:Bs,receiptDate:"",amountReceived:0,tdsReceived:0,balance:"-",paymentStatus:"",isCreditNote:!0,hasCN:!0,subRows:Lt.isHistoricalCN&&Lt.subRows||Zo})}}else if(Z.isHistorical){const At=Z.debit||0,Cr=Z.credit||0,tr=ne(Z.vchNo),Ht=Oe.get(tr),Nn=Ht?Math.abs(Ht.totalAmount||Ht.credit||0):0,nn=!!Ht,Gr=nn&&Nn>=At,_s=nn&&!Gr?At-Nn:0;Ge+=At-Cr,Se+=At,We+=Cr,Z.amountReceived&&(lt+=Z.amountReceived),Z.tdsReceived&&(Nt+=Z.tdsReceived);const Lt=Z.subRows||[];let Dn=At-(Z.amountReceived||0)-(Z.tdsReceived||0),hi=Z.paymentStatus||"";Gr?(Dn=0,hi="CN Closed"):nn&&_s>0&&(Dn=_s-(Z.amountReceived||0)-(Z.tdsReceived||0),Dn>0&&(hi="Partial CN")),ue.push({id:Z.id,date:Z.date,particular:Z.particulars||H,vchType:Z.vchType||"Sales",vchNo:Z.vchNo,debit:At,credit:Cr,receiptDate:Z.receiptDate||"",amountReceived:Z.amountReceived||0,tdsReceived:Z.tdsReceived||0,balance:Gr?"-":Dn>0?Dn:0,paymentStatus:hi,isInvoice:!0,isHistorical:!0,hasCN:nn,subRows:Lt}),Ht&&!$t.has(tr)&&($t.add(tr),Ge-=Nn,We+=Nn,ue.push({id:Ht.id||Ht.creditNoteNo||Ht.vchNo||`cn-${tr}`,date:Ht.date,particular:H,vchType:"Credit Note",vchNo:Ht.creditNoteNo||Ht.vchNo,debit:0,credit:Nn,receiptDate:"",amountReceived:0,tdsReceived:0,balance:"-",paymentStatus:"",isCreditNote:!0,hasCN:!0,subRows:Ht.subRows||[]}))}});const rn=ue.reduce((Z,be)=>typeof be.balance=="number"&&be.balance>0?Z+be.balance:Z,0);return{entries:ue,totals:{debit:Se,credit:We,received:lt,tds:Nt,balance:rn}}})();return f.jsxs("div",{children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[f.jsx("h1",{style:{margin:0,fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:" Party Ledgers"}),f.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[Rn&&f.jsx("span",{style:{padding:"8px 16px",backgroundColor:"#FEF3C7",borderRadius:"8px",fontSize:"13px",color:"#92400E",fontWeight:"600"},children:" View Only"}),Ft&&f.jsx(Ye,{icon:zs,label:"Import Historical",variant:"brand",onClick:()=>la(!0)}),Ft&&H&&Ee.some(K=>K.partyName===H&&K.isHistorical)&&f.jsx(Ye,{icon:Us,label:"Clear Historical",variant:"danger",onClick:Zl}),Ft&&f.jsx(Ye,{icon:jg,label:"Opening Balance",variant:"primary",onClick:()=>$r(!0)})]})]}),f.jsx("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"10px",border:"1px solid #E2E8F0",padding:"14px 18px",marginBottom:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"14px",flexWrap:"wrap"},children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[f.jsx(bB,{size:18,color:"#64748B"}),f.jsx("span",{style:{fontSize:"13px",fontWeight:"700",color:"#475569"},children:"Period:"})]}),f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[f.jsx("input",{type:"date",value:vr.fromDate,onChange:K=>Ui(ne=>({...ne,fromDate:K.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px"}}),f.jsx("span",{style:{color:"#64748B"},children:"to"}),f.jsx("input",{type:"date",value:vr.toDate,onChange:K=>Ui(ne=>({...ne,toDate:K.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px"}})]}),f.jsx("div",{style:{marginLeft:"auto",display:"flex",gap:"10px"},children:H&&f.jsx(Ye,{icon:Mu,label:"Download PDF",variant:"brand",onClick:H4})})]})}),f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"280px 1fr",gap:"16px"},children:[f.jsxs(mn,{title:"Parties",noPadding:!0,children:[f.jsx("div",{style:{padding:"12px",borderBottom:"1px solid #E2E8F0"},children:f.jsxs("div",{style:{position:"relative"},children:[f.jsx(Rd,{size:14,style:{position:"absolute",left:"10px",top:"50%",transform:"translateY(-50%)",color:"#94A3B8"}}),f.jsx("input",{type:"text",placeholder:"Search party...",value:Va,onChange:K=>Ua(K.target.value),style:{width:"100%",padding:"8px 12px 8px 32px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",boxSizing:"border-box"}})]})}),f.jsx("div",{style:{maxHeight:"450px",overflowY:"auto"},children:I.length===0?f.jsx("div",{style:{padding:"30px",textAlign:"center",color:"#94A3B8",fontSize:"14px"},children:Va?"No matching parties":"No parties yet"}):I.map(K=>{const ne=g(K);return f.jsxs("div",{onClick:()=>q(K),style:{padding:"14px 18px",borderBottom:"1px solid #F1F5F9",cursor:"pointer",backgroundColor:H===K?"#EFF6FF":"transparent",borderLeft:H===K?"4px solid #2874A6":"4px solid transparent"},children:[f.jsx("div",{style:{fontWeight:"600",fontSize:"14px",color:"#1E293B"},children:K}),f.jsxs("div",{style:{fontSize:"14px",color:ne>0?"#DC2626":"#059669",fontWeight:"700",marginTop:"4px"},children:[ne>0?"Dr. ":"Cr. ",ct(Math.abs(ne))]})]},K)})})]}),f.jsx(mn,{title:H?"Ledger Account":"Select a Party",noPadding:!0,children:H?f.jsxs("div",{style:{fontSize:"12px"},children:[f.jsxs("div",{style:{textAlign:"center",padding:"16px",borderBottom:"2px solid #1E3A5F",backgroundColor:"#F8FAFC"},children:[f.jsx("div",{style:{fontSize:"16px",fontWeight:"700",color:"#1E3A5F"},children:S.name}),f.jsx("div",{style:{fontSize:"11px",color:"#64748B",marginTop:"4px"},children:S.address}),f.jsxs("div",{style:{fontSize:"11px",color:"#64748B"},children:[S.addressLine2,", ",S.city]}),f.jsxs("div",{style:{fontSize:"11px",color:"#64748B"},children:["E-Mail: ",S.email]})]}),f.jsxs("div",{style:{textAlign:"center",padding:"12px",borderBottom:"1px solid #E2E8F0",backgroundColor:"#FFFFFF"},children:[f.jsx("div",{style:{fontSize:"14px",fontWeight:"700",color:"#1E293B"},children:H}),f.jsx("div",{style:{fontSize:"11px",fontWeight:"600",color:"#64748B"},children:"Ledger Account"}),Y(H)&&f.jsx("div",{style:{fontSize:"11px",color:"#64748B",marginTop:"4px"},children:Y(H)})]}),f.jsx("div",{style:{textAlign:"center",padding:"8px",backgroundColor:"#F1F5F9",borderBottom:"1px solid #E2E8F0"},children:f.jsxs("span",{style:{fontSize:"11px",fontWeight:"600",color:"#475569"},children:[hr(vr.fromDate)," to ",hr(vr.toDate)]})}),f.jsxs("div",{style:{backgroundColor:"#1E293B",color:"white",padding:"12px 16px",display:"flex",justifyContent:"center",alignItems:"center",gap:"12px",borderBottom:"3px solid #F59E0B"},children:[f.jsx("span",{style:{fontSize:"14px",fontWeight:"600"},children:"Closing Balance:"}),f.jsxs("span",{style:{fontSize:"18px",fontWeight:"700",color:Q.totals.balance>0?"#FCA5A5":"#86EFAC"},children:[zt(Math.abs(Q.totals.balance))," ",Q.totals.balance>0?"(Dr)":Q.totals.balance<0?"(Cr)":""]})]}),f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",backgroundColor:"#EFF6FF",borderBottom:"2px solid #2874A6",fontSize:"11px"},children:[f.jsxs("div",{style:{padding:"8px",textAlign:"center",borderRight:"1px solid #BFDBFE"},children:[f.jsx("div",{style:{color:"#64748B"},children:"Debit"}),f.jsx("div",{style:{fontWeight:"700",color:"#1E293B"},children:zt(Q.totals.debit)})]}),f.jsxs("div",{style:{padding:"8px",textAlign:"center",borderRight:"1px solid #BFDBFE"},children:[f.jsx("div",{style:{color:"#64748B"},children:"Credit"}),f.jsx("div",{style:{fontWeight:"700",color:"#DC2626"},children:zt(Q.totals.credit)})]}),f.jsxs("div",{style:{padding:"8px",textAlign:"center",borderRight:"1px solid #BFDBFE"},children:[f.jsx("div",{style:{color:"#64748B"},children:"Amount Received"}),f.jsx("div",{style:{fontWeight:"700",color:"#059669"},children:zt(Q.totals.received)})]}),f.jsxs("div",{style:{padding:"8px",textAlign:"center"},children:[f.jsx("div",{style:{color:"#64748B"},children:"TDS Received"}),f.jsx("div",{style:{fontWeight:"700",color:"#1E293B"},children:zt(Q.totals.tds)})]})]}),f.jsx("div",{style:{overflowX:"auto"},children:f.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"11px",minWidth:"1000px"},children:[f.jsx("thead",{children:f.jsxs("tr",{style:{backgroundColor:"#F8FAFC",borderBottom:"2px solid #E2E8F0"},children:[f.jsx("th",{style:{padding:"10px 8px",textAlign:"left",fontWeight:"700",width:"75px",borderRight:"1px solid #E2E8F0"},children:"Date"}),f.jsx("th",{style:{padding:"10px 8px",textAlign:"left",fontWeight:"700",minWidth:"150px",borderRight:"1px solid #E2E8F0"},children:"Particular"}),f.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"700",width:"80px",borderRight:"1px solid #E2E8F0"},children:"Vch Type"}),f.jsx("th",{style:{padding:"10px 8px",textAlign:"left",fontWeight:"700",width:"110px",borderRight:"1px solid #E2E8F0"},children:"Vch No."}),f.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"700",width:"90px",borderRight:"1px solid #E2E8F0"},children:"Debit"}),f.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"700",width:"90px",borderRight:"1px solid #E2E8F0"},children:"Credit"}),f.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"700",width:"85px",borderRight:"1px solid #E2E8F0"},children:"Date of Receipt"}),f.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"700",width:"90px",borderRight:"1px solid #E2E8F0"},children:"Amount Received"}),f.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"700",width:"80px",borderRight:"1px solid #E2E8F0"},children:"TDS Received"}),f.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"700",width:"85px",borderRight:"1px solid #E2E8F0"},children:"Balance"}),f.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"700",width:"75px",borderRight:"1px solid #E2E8F0"},children:"Payment Status"}),Ft&&f.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"700",width:"50px"},children:"Action"})]})}),f.jsx("tbody",{children:Q.entries.length===0?f.jsx("tr",{children:f.jsx("td",{colSpan:Ft?"12":"11",style:{padding:"40px",textAlign:"center",color:"#94A3B8"},children:"No entries in selected period"})}):Q.entries.map(K=>f.jsxs(Vd.Fragment,{children:[f.jsxs("tr",{style:{backgroundColor:K.isOpening?"#FEF3C7":K.hasCN||K.isCreditNote?"#FFFBEB":"#FFFFFF",borderBottom:"1px solid #E2E8F0",borderLeft:K.hasCN||K.isCreditNote?"4px solid #F59E0B":"none"},children:[f.jsx("td",{style:{padding:"8px",borderRight:"1px solid #E2E8F0"},children:K.date?hr(K.date):""}),f.jsx("td",{style:{padding:"8px",fontWeight:"600",color:K.isCreditNote?"#DC2626":"#1E293B",borderRight:"1px solid #E2E8F0"},children:K.particular}),f.jsx("td",{style:{padding:"8px",textAlign:"center",borderRight:"1px solid #E2E8F0"},children:K.vchType&&f.jsx("span",{style:{padding:"2px 6px",borderRadius:"4px",fontSize:"10px",fontWeight:"600",backgroundColor:K.vchType==="Sales"?"#DCFCE7":"#FEE2E2",color:K.vchType==="Sales"?"#166534":"#991B1B"},children:K.vchType})}),f.jsx("td",{style:{padding:"8px",borderRight:"1px solid #E2E8F0"},children:K.vchNo&&K.isInvoice&&!K.isHistorical?f.jsx("button",{onClick:()=>Hr(K.vchNo),style:{background:"none",border:"none",padding:0,fontWeight:"600",color:"#2874A6",cursor:"pointer",textDecoration:"underline",fontSize:"11px"},title:"Click to view invoice",children:K.vchNo}):f.jsx("span",{style:{fontWeight:"600",color:K.isCreditNote?"#DC2626":"#2874A6"},children:K.vchNo})}),f.jsx("td",{style:{padding:"8px",textAlign:"right",fontWeight:"600",borderRight:"1px solid #E2E8F0"},children:K.debit>0?zt(K.debit):""}),f.jsx("td",{style:{padding:"8px",textAlign:"right",color:"#DC2626",borderRight:"1px solid #E2E8F0"},children:K.credit>0?zt(K.credit):""}),f.jsx("td",{style:{padding:"8px",textAlign:"center",borderRight:"1px solid #E2E8F0"},children:K.receiptDate?hr(K.receiptDate):""}),f.jsx("td",{style:{padding:"8px",textAlign:"right",color:"#059669",fontWeight:K.amountReceived>0?"600":"400",borderRight:"1px solid #E2E8F0"},children:K.amountReceived>0?zt(K.amountReceived):""}),f.jsx("td",{style:{padding:"8px",textAlign:"right",borderRight:"1px solid #E2E8F0"},children:K.tdsReceived>0?zt(K.tdsReceived):""}),f.jsx("td",{style:{padding:"8px",textAlign:"right",fontWeight:"600",color:typeof K.balance=="number"&&K.balance>0?"#DC2626":"",borderRight:"1px solid #E2E8F0"},children:K.isOpening?K.balance>0?zt(K.balance):"":K.balance==="-"?"-":typeof K.balance=="number"&&K.balance>0?zt(K.balance):"-"}),f.jsx("td",{style:{padding:"8px",textAlign:"center"},children:K.paymentStatus&&f.jsx("span",{style:{padding:"2px 8px",borderRadius:"4px",fontSize:"10px",fontWeight:"600",backgroundColor:K.paymentStatus==="Received"?"#DCFCE7":"#FEF3C7",color:K.paymentStatus==="Received"?"#166534":"#92400E"},children:K.paymentStatus})}),Ft&&f.jsx("td",{style:{padding:"8px",textAlign:"center"},children:K.isHistorical&&!K.isOpening&&f.jsx("button",{onClick:()=>X0(Ee.find(ne=>ne.id===K.id)),style:{padding:"2px 6px",borderRadius:"4px",fontSize:"10px",fontWeight:"600",backgroundColor:"#FEE2E2",color:"#991B1B",border:"none",cursor:"pointer"},title:"Delete historical entry",children:""})})]}),K.subRows&&K.subRows.length>0&&K.subRows.map((ne,Le)=>f.jsxs("tr",{style:{backgroundColor:K.isOpening?"#FEF3C7":K.hasCN||K.isCreditNote?"#FFFBEB":"#FFFFFF",borderBottom:Le===K.subRows.length-1?"2px solid #CBD5E1":"1px solid #E2E8F0",borderLeft:K.hasCN||K.isCreditNote?"4px solid #F59E0B":"none"},children:[f.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),f.jsx("td",{style:{padding:"6px 8px 6px 30px",color:"#475569",fontSize:"12px",borderRight:"1px solid #E2E8F0"},children:ne.particular}),f.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),f.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),f.jsx("td",{style:{padding:"6px 8px",textAlign:"right",fontSize:"12px",borderRight:"1px solid #E2E8F0"},children:ne.debit?zt(ne.debit):""}),f.jsx("td",{style:{padding:"6px 8px",textAlign:"right",fontSize:"12px",borderRight:"1px solid #E2E8F0"},children:ne.credit?zt(ne.credit):""}),f.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),f.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),f.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),f.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),f.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),Ft&&f.jsx("td",{style:{padding:"6px 8px"}})]},`${K.id}-sub-${Le}`))]},K.id))})]})})]}):f.jsx("div",{style:{padding:"60px",textAlign:"center",color:"#94A3B8"},children:"Select a party to view ledger"})})]})]})},[tc,sy]=ve.useState(""),J0=ve.useMemo(()=>{const g=new Map,I=Q=>{if(!Q)return"";const K=Q.split("/");return K.length>=3?K.slice(1).join("/"):K.length===2?K.join("/"):K[K.length-1]},Y=$i.filter(Q=>{var K;return Q.isHistorical&&(Q.type==="creditnote"||((K=Q.vchNo)==null?void 0:K.toUpperCase().startsWith("CN")))}),ee=new Map;return Xl.forEach(Q=>{const K=I(Q.invoiceNo);K&&ee.set(K,Q)}),Y.forEach(Q=>{const K=I(Q.vchNo);K&&!ee.has(K)&&ee.set(K,Q)}),bn.filter(Q=>Q.invoiceGenerated&&Q.invoiceStatus==="Approved").forEach(Q=>{if(g.has(Q.invoiceNo))g.has(Q.invoiceNo)&&g.get(Q.invoiceNo).campaigns.push(Q);else{const K=ms.find(Ie=>Ie.invoiceNo===Q.invoiceNo),ne=Xl.find(Ie=>Ie.invoiceNo===Q.invoiceNo),Le=parseFloat(Q.invoiceTotalAmount)||0,Ke=ne?Math.abs(parseFloat(ne.totalAmount)||parseFloat(ne.credit)||0):0,fe=ne&&Ke>=Le;if(!K&&!fe){const Ie=ne?Le-Ke:Le;g.set(Q.invoiceNo,{invoiceNo:Q.invoiceNo,partyName:Q.partyName,invoiceDate:Q.invoiceDate,invoiceTotalAmount:Q.invoiceTotalAmount,pendingAmount:Ie,hasPartialCN:!!ne&&!fe&&Ke>0,cnAmount:Ke,subject:Q.subject,campaigns:[Q],isHistorical:!1,invoiceType:Q.invoiceType||"Individual"})}}}),$i.filter(Q=>{var K;return Q.isHistorical&&Q.type!=="creditnote"&&!((K=Q.vchNo)!=null&&K.toUpperCase().startsWith("CN"))&&Q.debit>0}).forEach(Q=>{if(!g.has(Q.vchNo)){const K=ms.find(Oe=>Oe.invoiceNo===Q.vchNo),ne=I(Q.vchNo),Le=ee.get(ne),Ke=Le?Math.abs(parseFloat(Le.totalAmount)||parseFloat(Le.credit)||parseFloat(Le.debit)||0):0,fe=parseFloat(Q.debit)||0,Ie=Le&&Ke>=fe;if(K||Ie)return;const qe=!(Q.amountReceived>0),re=Le&&Ke>0&&Ke<fe;if(qe||re){const Oe=re?fe-Ke:fe;g.set(Q.vchNo,{invoiceNo:Q.vchNo,partyName:Q.partyName,invoiceDate:Q.date,invoiceTotalAmount:fe,pendingAmount:Oe,hasPartialCN:re,cnAmount:Ke,subject:Q.particulars||Q.narration,campaigns:[],isHistorical:!0})}}}),Array.from(g.values()).sort((Q,K)=>Q.partyName.localeCompare(K.partyName))},[bn,ms,Xl,$i]),K4=ve.useMemo(()=>{const g={};return ql.forEach(I=>{g[I.invoiceNo]||(g[I.invoiceNo]=[]),g[I.invoiceNo].push(I)}),Object.keys(g).forEach(I=>{g[I].sort((Y,ee)=>new Date(ee.followupDate)-new Date(Y.followupDate))}),g},[ql]),ay=ve.useMemo(()=>{const g=new Date().toISOString().split("T")[0];return ql.filter(I=>I.nextFollowupDate&&I.nextFollowupDate>=g).sort((I,Y)=>new Date(I.nextFollowupDate)-new Date(Y.nextFollowupDate))},[ql]),Z0=ve.useMemo(()=>{let g=J0;if(tc){const Y=tc.toLowerCase();g=J0.filter(ee=>{var Q,K,ne;return((Q=ee.invoiceNo)==null?void 0:Q.toLowerCase().includes(Y))||((K=ee.partyName)==null?void 0:K.toLowerCase().includes(Y))||((ne=ee.subject)==null?void 0:ne.toLowerCase().includes(Y))})}const I={};return g.forEach(Y=>{I[Y.partyName]||(I[Y.partyName]={partyName:Y.partyName,invoices:[],totalAmount:0}),I[Y.partyName].invoices.push(Y),I[Y.partyName].totalAmount+=parseFloat(Y.pendingAmount||Y.invoiceTotalAmount)||0}),Object.values(I).sort((Y,ee)=>Y.partyName.localeCompare(ee.partyName))},[J0,tc]),X4=()=>{const g=Z0.reduce((I,Y)=>I+Y.invoices.length,0);return f.jsxs("div",{children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[f.jsx("h1",{style:{margin:0,fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:" Followups"}),f.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[f.jsxs("span",{style:{padding:"6px 12px",backgroundColor:"#EFF6FF",borderRadius:"6px",fontSize:"12px",color:"#1E40AF",fontWeight:"600"},children:[Z0.length," Parties | ",g," Invoices"]}),Rn&&f.jsx("span",{style:{padding:"8px 16px",backgroundColor:"#FEF3C7",borderRadius:"8px",fontSize:"13px",color:"#92400E",fontWeight:"600"},children:" View Only"})]})]}),f.jsx("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"10px",border:"1px solid #E2E8F0",padding:"14px 18px",marginBottom:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"14px",flexWrap:"wrap"},children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[f.jsx(Lg,{size:18,color:"#64748B"}),f.jsx("span",{style:{fontSize:"13px",fontWeight:"700",color:"#475569"},children:"Search:"})]}),f.jsxs("div",{style:{position:"relative",flex:1,maxWidth:"300px"},children:[f.jsx(Rd,{size:14,style:{position:"absolute",left:"10px",top:"50%",transform:"translateY(-50%)",color:"#94A3B8"}}),f.jsx("input",{type:"text",placeholder:"Search party, invoice, subject...",value:tc,onChange:I=>sy(I.target.value),style:{padding:"8px 12px 8px 32px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",width:"100%"}})]}),tc&&f.jsxs("button",{onClick:()=>sy(""),style:{padding:"8px 12px",fontSize:"13px",fontWeight:"600",border:"1.5px solid #FCA5A5",borderRadius:"8px",backgroundColor:"#FEE2E2",color:"#991B1B",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},children:[f.jsx(rl,{size:14})," Clear"]}),tc&&f.jsxs("span",{style:{fontSize:"13px",color:"#64748B"},children:["Showing ",g," of ",J0.length]})]})}),ay.length>0&&f.jsx(mn,{title:" Upcoming Followups",style:{marginBottom:"16px"},children:f.jsx("div",{style:{display:"flex",gap:"12px",flexWrap:"wrap"},children:ay.slice(0,5).map(I=>f.jsxs("div",{style:{padding:"10px 14px",backgroundColor:new Date(I.nextFollowupDate).toISOString().split("T")[0]===new Date().toISOString().split("T")[0]?"#FEE2E2":"#FEF3C7",borderRadius:"8px",border:"1px solid #FCD34D"},children:[f.jsx("div",{style:{fontWeight:"600",fontSize:"13px",color:"#92400E"},children:I.invoiceNo}),f.jsx("div",{style:{fontSize:"11px",color:"#78716C"},children:I.partyName}),f.jsxs("div",{style:{fontSize:"12px",fontWeight:"600",color:"#DC2626",marginTop:"4px"},children:[" ",hr(I.nextFollowupDate)]})]},I.id))})}),Z0.length===0?f.jsx(mn,{children:f.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#94A3B8"},children:" No pending invoices! All payments received."})}):Z0.map(I=>f.jsxs(mn,{style:{marginBottom:"16px"},noPadding:!0,children:[f.jsxs("div",{style:{padding:"12px 16px",backgroundColor:"#1E293B",color:"white",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[f.jsxs("span",{style:{fontSize:"15px",fontWeight:"700"},children:[" ",I.partyName]}),f.jsxs("span",{style:{padding:"3px 10px",backgroundColor:"#3B82F6",borderRadius:"12px",fontSize:"11px",fontWeight:"600"},children:[I.invoices.length," Invoice",I.invoices.length>1?"s":""]})]}),f.jsxs("div",{style:{fontSize:"14px",fontWeight:"700",color:"#FCD34D"},children:["Total: ",ct(I.totalAmount)]})]}),f.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"12px"},children:[f.jsx("thead",{children:f.jsxs("tr",{style:{backgroundColor:"#F8FAFC",borderBottom:"2px solid #E2E8F0"},children:[f.jsx("th",{style:{padding:"10px 12px",textAlign:"left",fontWeight:"700"},children:"Invoice No"}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Type"}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Invoice Date"}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700"},children:"Amount"}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Days Pending"}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Last Followup"}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Actions"})]})}),f.jsx("tbody",{children:I.invoices.map(Y=>{var Le,Ke,fe;const ee=K4[Y.invoiceNo]||[],Q=ee[0],K=Math.floor((new Date-new Date(Y.invoiceDate))/(1e3*60*60*24)),ne=Y.isHistorical?"Historical":Y.invoiceType||(((Le=Y.campaigns)==null?void 0:Le.length)>1?"Combined":"Individual");return f.jsxs(Vd.Fragment,{children:[f.jsxs("tr",{style:{borderBottom:"1px solid #E2E8F0",backgroundColor:K>30?"#FEF2F2":K>15?"#FFFBEB":"#FFFFFF"},children:[f.jsxs("td",{style:{padding:"10px 12px",fontWeight:"600",color:"#2874A6"},children:[Y.invoiceNo,Y.hasPartialCN&&f.jsx("span",{style:{marginLeft:"6px",padding:"2px 6px",backgroundColor:"#FEF3C7",color:"#92400E",borderRadius:"4px",fontSize:"9px",fontWeight:"700"},children:"Partial CN"})]}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:f.jsx("span",{style:{padding:"3px 8px",borderRadius:"6px",fontSize:"10px",fontWeight:"600",backgroundColor:ne==="Historical"?"#E0E7FF":ne==="Combined"?"#F3E8FF":"#DCFCE7",color:ne==="Historical"?"#3730A3":ne==="Combined"?"#7C3AED":"#166534"},children:ne})}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:hr(Y.invoiceDate)}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"600"},children:Y.hasPartialCN?f.jsxs("div",{children:[f.jsx("div",{style:{color:"#DC2626"},children:ct(Y.pendingAmount)}),f.jsx("div",{style:{fontSize:"9px",color:"#64748B",textDecoration:"line-through"},children:ct(Y.invoiceTotalAmount)})]}):ct(Y.invoiceTotalAmount)}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:f.jsxs("span",{style:{padding:"3px 10px",borderRadius:"12px",fontSize:"11px",fontWeight:"700",backgroundColor:K>30?"#FEE2E2":K>15?"#FEF3C7":"#DCFCE7",color:K>30?"#991B1B":K>15?"#92400E":"#166534"},children:[K," days"]})}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"center",fontSize:"11px"},children:Q?f.jsxs("div",{children:[f.jsx("div",{style:{fontWeight:"600"},children:hr(Q.followupDate)}),f.jsxs("div",{style:{color:"#64748B",fontSize:"10px"},children:[(Ke=Q.notes)==null?void 0:Ke.substring(0,30),((fe=Q.notes)==null?void 0:fe.length)>30?"...":""]})]}):f.jsx("span",{style:{color:"#DC2626",fontWeight:"600"},children:"No followup yet"})}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:f.jsxs("div",{style:{display:"flex",gap:"4px",justifyContent:"center"},children:[Ft&&f.jsx(Ye,{icon:jg,small:!0,variant:"primary",onClick:()=>ei(Y),title:"Add Followup"}),f.jsx(Ye,{icon:Mg,small:!0,variant:"brand",onClick:()=>u(Y),title:"Copy Email Template"}),f.jsx(Ye,{icon:Bg,small:!0,variant:"success",onClick:()=>v(Y),title:"Search in Gmail"})]})})]}),ee.length>0&&f.jsx("tr",{children:f.jsxs("td",{colSpan:"7",style:{padding:"8px 12px 12px 40px",backgroundColor:"#F8FAFC"},children:[f.jsx("div",{style:{fontSize:"11px",fontWeight:"600",color:"#64748B",marginBottom:"6px"},children:"Followup History:"}),f.jsx("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:ee.map(Ie=>f.jsxs("div",{style:{padding:"6px 10px",backgroundColor:"#FFFFFF",borderRadius:"6px",border:"1px solid #E2E8F0",fontSize:"11px"},children:[f.jsx("div",{style:{fontWeight:"600",color:"#2874A6"},children:hr(Ie.followupDate)}),f.jsx("div",{style:{color:"#475569",marginTop:"2px"},children:Ie.notes}),Ie.nextFollowupDate&&f.jsxs("div",{style:{color:"#DC2626",marginTop:"2px",fontSize:"10px"},children:["Next: ",hr(Ie.nextFollowupDate)]}),Ft&&f.jsx("button",{onClick:()=>Y0(Ie.id),style:{background:"none",border:"none",color:"#DC2626",cursor:"pointer",fontSize:"10px",padding:"2px 0",marginTop:"4px"},children:" Delete"})]},Ie.id))})]})})]},Y.invoiceNo)})})]})]},I.partyName))]})},oy=()=>{const g=ge.filter(Q=>Q.invoiceGenerated).reduce((Q,K)=>Q+(parseFloat(K.invoiceTotalAmount)||0),0),I=ge.filter(Q=>Q.invoiceStatus==="Paid").reduce((Q,K)=>Q+(parseFloat(K.invoiceTotalAmount)||0),0),Y=ge.filter(Q=>Q.invoiceStatus==="Approved").reduce((Q,K)=>Q+(parseFloat(K.invoiceTotalAmount)||0),0),ee=ge.filter(Q=>Q.invoiceStatus==="Need Edits").length;return f.jsxs("div",{children:[f.jsx("h1",{style:{margin:"0 0 16px",fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:" Reports"}),f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"16px"},children:[f.jsxs(mn,{children:[f.jsx("div",{style:{fontSize:"14px",color:"#64748B",marginBottom:"8px"},children:"Total Invoiced"}),f.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:ct(g)})]}),f.jsxs(mn,{children:[f.jsx("div",{style:{fontSize:"14px",color:"#64748B",marginBottom:"8px"},children:"Approved"}),f.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#059669"},children:ct(Y)})]}),f.jsxs(mn,{children:[f.jsx("div",{style:{fontSize:"14px",color:"#64748B",marginBottom:"8px"},children:"Need Edits"}),f.jsxs("div",{style:{fontSize:"24px",fontWeight:"700",color:"#DC2626"},children:[ee," invoices"]})]}),f.jsxs(mn,{children:[f.jsx("div",{style:{fontSize:"14px",color:"#64748B",marginBottom:"8px"},children:"Paid"}),f.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#059669"},children:ct(I)})]})]})]})},q4=()=>f.jsxs("div",{children:[f.jsx("h1",{style:{margin:"0 0 16px",fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:" Settings"}),f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px"},children:[f.jsxs(mn,{title:" Invoice Series",children:[f.jsx(pr,{label:"Invoice Prefix",value:S.invoicePrefix,onChange:g=>b(I=>({...I,invoicePrefix:g.target.value})),small:!0}),f.jsx(pr,{label:"Next Invoice Number",type:"number",value:X,onChange:g=>de(parseInt(g.target.value)||1),small:!0}),f.jsx(pr,{label:"Next Combine Code",type:"number",value:we,onChange:g=>Ne(parseInt(g.target.value)||1),small:!0}),f.jsxs("div",{style:{padding:"10px",backgroundColor:"#EFF6FF",borderRadius:"8px",fontSize:"14px"},children:[f.jsx("strong",{children:"Preview:"})," ",S.invoicePrefix,X]})]}),f.jsxs(mn,{title:" Mailer Logo",children:[f.jsx("input",{type:"file",ref:yu,accept:"image/*",style:{display:"none"},onChange:L4}),hn?f.jsxs("div",{style:{textAlign:"center"},children:[f.jsx("img",{src:hn,alt:"Logo",style:{maxWidth:"250px",maxHeight:"60px",marginBottom:"12px",border:"1px solid #E2E8F0",padding:"8px",borderRadius:"8px"}}),f.jsxs("div",{style:{display:"flex",gap:"8px",justifyContent:"center"},children:[f.jsx(Ye,{icon:LB,label:"Change",small:!0,onClick:()=>{var g;return(g=yu.current)==null?void 0:g.click()}}),f.jsx(Ye,{icon:Us,label:"Remove",variant:"danger",small:!0,onClick:()=>Si(null)})]})]}):f.jsxs("div",{onClick:()=>{var g;return(g=yu.current)==null?void 0:g.click()},style:{border:"2px dashed #CBD5E1",borderRadius:"10px",padding:"30px",textAlign:"center",cursor:"pointer"},children:[f.jsx(zs,{size:32,color:"#94A3B8",style:{marginBottom:"8px"}}),f.jsx("p",{style:{margin:0,color:"#64748B",fontSize:"14px"},children:"Click to upload"})]})]}),f.jsxs(mn,{title:" WhatsApp Notifications",children:[f.jsx("div",{style:{marginBottom:"16px"},children:f.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"10px",cursor:"pointer"},children:[f.jsx("input",{type:"checkbox",checked:ie.enabled,onChange:g=>oe(I=>({...I,enabled:g.target.checked})),style:{width:"18px",height:"18px",cursor:"pointer"}}),f.jsx("span",{style:{fontSize:"14px",fontWeight:"600",color:"#1E293B"},children:"Enable WhatsApp Notifications"})]})}),ie.enabled&&f.jsxs(f.Fragment,{children:[f.jsxs("div",{style:{padding:"12px",backgroundColor:"#DCFCE7",borderRadius:"8px",marginBottom:"16px",fontSize:"12px",color:"#166534",border:"1px solid #86EFAC"},children:[f.jsx("strong",{children:" FREE Setup using CallMeBot:"}),f.jsx("br",{}),"1. Save this number in contacts: ",f.jsx("strong",{children:"+34 644 71 81 99"}),f.jsx("br",{}),"2. Send this message to the number on WhatsApp: ",f.jsx("strong",{children:'"I allow callmebot to send me messages"'}),f.jsx("br",{}),"3. You'll receive an API key - enter it below",f.jsx("br",{}),"4. Repeat for each phone number you want to receive notifications"]}),f.jsxs("div",{style:{padding:"14px",backgroundColor:"#F8FAFC",borderRadius:"8px",marginBottom:"12px",border:"1px solid #E2E8F0"},children:[f.jsxs("div",{style:{fontSize:"13px",fontWeight:"700",color:"#1E293B",marginBottom:"10px",display:"flex",alignItems:"center",gap:"6px"},children:[f.jsx(bd,{size:16})," Finance Team"]}),f.jsx(pr,{label:"Phone (with country code)",value:ie.financePhone,onChange:g=>oe(I=>({...I,financePhone:g.target.value})),placeholder:"919876543210",small:!0}),f.jsx(pr,{label:"API Key (from CallMeBot)",value:ie.financeApiKey,onChange:g=>oe(I=>({...I,financeApiKey:g.target.value})),placeholder:"123456",small:!0}),ie.financePhone&&ie.financeApiKey&&f.jsx(Ye,{icon:M2,label:"Test Finance",variant:"success",small:!0,onClick:()=>wu(ie.financePhone,ie.financeApiKey)})]}),f.jsxs("div",{style:{padding:"14px",backgroundColor:"#F8FAFC",borderRadius:"8px",border:"1px solid #E2E8F0"},children:[f.jsxs("div",{style:{fontSize:"13px",fontWeight:"700",color:"#1E293B",marginBottom:"10px",display:"flex",alignItems:"center",gap:"6px"},children:[f.jsx(bd,{size:16})," Director"]}),f.jsx(pr,{label:"Phone (with country code)",value:ie.directorPhone,onChange:g=>oe(I=>({...I,directorPhone:g.target.value})),placeholder:"919876543210",small:!0}),f.jsx(pr,{label:"API Key (from CallMeBot)",value:ie.directorApiKey,onChange:g=>oe(I=>({...I,directorApiKey:g.target.value})),placeholder:"123456",small:!0}),ie.directorPhone&&ie.directorApiKey&&f.jsx(Ye,{icon:M2,label:"Test Director",variant:"success",small:!0,onClick:()=>wu(ie.directorPhone,ie.directorApiKey)})]})]}),!ie.enabled&&f.jsx("div",{style:{padding:"20px",backgroundColor:"#F8FAFC",borderRadius:"8px",textAlign:"center",color:"#64748B",fontSize:"13px"},children:"WhatsApp notifications are disabled. Enable to receive FREE alerts for invoices, approvals, and payments."})]}),f.jsxs(mn,{title:" Default Invoice Values",children:[f.jsx("input",{type:"file",ref:N0,accept:".xlsx,.xls,.csv",style:{display:"none"},onChange:A}),f.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"12px"},children:[f.jsx(Ye,{icon:zs,label:"Upload",variant:"brand",small:!0,onClick:()=>{var g;return(g=N0.current)==null?void 0:g.click()}}),f.jsx(Ye,{icon:Mu,label:"Template",small:!0,onClick:O})]}),Object.keys(ds).length>0&&f.jsx("div",{style:{maxHeight:"180px",overflowY:"auto",border:"1px solid #E2E8F0",borderRadius:"8px"},children:Object.entries(ds).map(([g,I])=>f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"10px 14px",borderBottom:"1px solid #F1F5F9",fontSize:"13px"},children:[f.jsx("span",{children:g}),f.jsx("span",{style:{fontWeight:"700"},children:ct(I)})]},g))})]}),f.jsxs(mn,{title:" Party Master",children:[f.jsx("input",{type:"file",ref:gs,accept:".xlsx,.xls,.csv",style:{display:"none"},onChange:se}),f.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"12px"},children:[f.jsx(Ye,{icon:zs,label:"Upload Parties",variant:"brand",small:!0,onClick:()=>{var g;return(g=gs.current)==null?void 0:g.click()}}),f.jsx(Ye,{icon:Mu,label:"Template",small:!0,onClick:he})]}),f.jsxs("div",{style:{padding:"10px",backgroundColor:"#EFF6FF",borderRadius:"8px",fontSize:"12px",color:"#1E40AF",marginBottom:"12px"},children:[f.jsx("strong",{children:"Upload Format:"})," Name of Ledger, Ledger Group, State Name, GST Registration Type, GSTIN/UIN"]}),Object.keys(Zr).length>0&&f.jsxs("div",{style:{maxHeight:"150px",overflowY:"auto",border:"1px solid #E2E8F0",borderRadius:"8px"},children:[Object.entries(Zr).slice(0,20).map(([g,I])=>f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px 12px",borderBottom:"1px solid #F1F5F9",fontSize:"11px"},children:[f.jsx("span",{style:{fontWeight:"600"},children:g.length>30?g.substring(0,30)+"...":g}),f.jsxs("span",{style:{color:"#64748B"},children:[I.stateName||"-"," | ",I.gstin?I.gstin.substring(0,10)+"...":"-"]})]},g)),Object.keys(Zr).length>20&&f.jsxs("div",{style:{padding:"8px 12px",textAlign:"center",color:"#64748B",fontSize:"11px"},children:["... and ",Object.keys(Zr).length-20," more parties"]})]}),Object.keys(Zr).length===0&&f.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#94A3B8",fontSize:"13px"},children:"No party master uploaded yet"})]}),f.jsxs(mn,{title:" Data Management",children:[f.jsxs("div",{style:{padding:"16px",backgroundColor:"#FEF2F2",borderRadius:"10px",border:"1px solid #FCA5A5",marginBottom:"16px"},children:[f.jsx("div",{style:{fontWeight:"700",color:"#991B1B",fontSize:"14px",marginBottom:"8px"},children:" Danger Zone"}),f.jsxs("div",{style:{fontSize:"13px",color:"#7F1D1D",marginBottom:"16px"},children:["This will permanently delete all data including:",f.jsxs("ul",{style:{margin:"8px 0 0 16px",padding:0},children:[f.jsx("li",{children:"All campaigns and master data"}),f.jsx("li",{children:"All invoices and receipts"}),f.jsx("li",{children:"All ledger entries"}),f.jsx("li",{children:"All mailer images"}),f.jsx("li",{children:"Opening balances and settings"})]})]}),f.jsx(Ye,{icon:Us,label:"Clear All Data",variant:"danger",onClick:()=>Fn(!0)})]}),f.jsxs("div",{style:{fontSize:"12px",color:"#64748B"},children:[f.jsx("strong",{children:"Current Data:"}),f.jsx("br",{})," ",ge.length," campaigns",f.jsx("br",{})," ",Ee.length," ledger entries",f.jsx("br",{})," ",J.length," receipts",f.jsx("br",{})," ",Object.keys(Et).length," mailer images"]})]})]})]}),Y4=()=>f.jsxs(f.Fragment,{children:[f.jsx(xn,{isOpen:B4,onClose:()=>{Zv(!1),ty("")},title:" Invoice Preview",width:"950px",children:ae&&ey&&f.jsxs("div",{children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px",padding:"14px 18px",backgroundColor:"#DCFCE7",borderRadius:"10px",border:"2px solid #22C55E"},children:[f.jsxs("div",{children:[f.jsxs("span",{style:{fontWeight:"700",fontSize:"16px",color:"#166534"},children:["Invoice: ",ae.invoiceNo]}),ae.invoiceType==="Combined"&&f.jsxs("span",{style:{marginLeft:"12px",padding:"4px 10px",backgroundColor:"#7C3AED",color:"white",borderRadius:"6px",fontSize:"12px",fontWeight:"600"},children:["Combined - C",ae.combinationCode]})]}),f.jsxs("button",{onClick:()=>V4(ae),style:{padding:"14px 28px",fontSize:"16px",fontWeight:"bold",border:"none",borderRadius:"10px",cursor:"pointer",backgroundColor:"#22C55E",color:"white",display:"flex",alignItems:"center",gap:"10px",boxShadow:"0 2px 8px rgba(34, 197, 94, 0.4)"},children:[f.jsx(Mu,{size:20}),"Download Invoice"]})]}),f.jsx("div",{style:{border:"2px solid #E2E8F0",borderRadius:"10px",overflow:"hidden",backgroundColor:"#f5f5f5"},children:f.jsx("iframe",{id:"invoice-viewer-iframe",srcDoc:ey,style:{width:"100%",height:"480px",border:"none",backgroundColor:"white"},title:"Invoice Preview"})}),f.jsxs("div",{style:{marginTop:"12px",padding:"14px 18px",backgroundColor:"#FEF3C7",borderRadius:"10px",border:"1px solid #FCD34D"},children:[f.jsx("div",{style:{fontSize:"14px",color:"#92400E",fontWeight:"600",marginBottom:"6px"},children:" How to Save as PDF:"}),f.jsxs("ol",{style:{fontSize:"13px",color:"#92400E",margin:"0",paddingLeft:"20px",lineHeight:"1.8"},children:[f.jsxs("li",{children:["Click ",f.jsx("strong",{children:'"Download Invoice"'})," button above"]}),f.jsxs("li",{children:["Open the downloaded ",f.jsx("strong",{children:".html file"})," in Chrome/Edge browser"]}),f.jsxs("li",{children:["Print dialog will open automatically - select ",f.jsx("strong",{children:'"Save as PDF"'})]}),f.jsxs("li",{children:["Click ",f.jsx("strong",{children:"Save"})," to get your PDF!"]})]})]})]})}),f.jsx(xn,{isOpen:ui,onClose:()=>{Mt(!1),Vi(""),Ce({particularsApproved:!1,emailApproved:!1,invoiceTypeApproved:!1})},title:Rn?" Review & Approve Invoice":" Invoice Details",width:"550px",children:ae&&f.jsxs("div",{children:[f.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px",borderRadius:"10px",marginBottom:"16px"},children:[f.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[f.jsx("strong",{children:"Invoice:"})," ",ae.invoiceNo]}),f.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[f.jsx("strong",{children:"Party:"})," ",ae.partyName]}),f.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[f.jsx("strong",{children:"Amount:"})," ",ct(ae.invoiceTotalAmount)]}),f.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[f.jsx("strong",{children:"Email:"})," ",ae.emailId||"Not set"]}),f.jsxs("div",{style:{fontSize:"14px"},children:[f.jsx("strong",{children:"Invoice Type:"})," ",f.jsx("span",{style:{color:ae.invoiceType==="Combined"?"#7C3AED":"#2874A6",fontWeight:"600"},children:ae.invoiceType||"Individual"})]}),ae.invoiceType==="Combined"&&f.jsxs("div",{style:{marginTop:"8px",fontSize:"13px",color:"#7C3AED"},children:[f.jsx("strong",{children:"Combined Campaigns:"})," ",Xi(ae).map(g=>g.senderName).join(", ")]})]}),ae.editComments&&f.jsxs("div",{style:{backgroundColor:"#FEE2E2",padding:"12px",borderRadius:"8px",marginBottom:"16px",border:"1px solid #FCA5A5"},children:[f.jsx("div",{style:{fontWeight:"600",color:"#991B1B",fontSize:"13px",marginBottom:"4px"},children:" Need Edits - Director Remarks:"}),f.jsx("div",{style:{fontSize:"13px",color:"#7F1D1D"},children:ae.editComments})]}),ae.approvalRemarks&&ae.invoiceStatus==="Approved"&&f.jsxs("div",{style:{backgroundColor:"#DCFCE7",padding:"12px",borderRadius:"8px",marginBottom:"16px",border:"1px solid #86EFAC"},children:[f.jsx("div",{style:{fontWeight:"600",color:"#166534",fontSize:"13px",marginBottom:"4px"},children:" Approved - Director Remarks:"}),f.jsx("div",{style:{fontSize:"13px",color:"#15803D"},children:ae.approvalRemarks})]}),Rn?f.jsxs("div",{style:{backgroundColor:"#F0FDF4",padding:"16px",borderRadius:"10px",marginBottom:"16px",border:"1px solid #86EFAC"},children:[f.jsx("div",{style:{fontWeight:"700",color:"#166534",fontSize:"14px",marginBottom:"12px"},children:" Approval Confirmations"}),f.jsxs("label",{style:{display:"flex",alignItems:"flex-start",gap:"10px",marginBottom:"12px",cursor:"pointer"},children:[f.jsx("input",{type:"checkbox",checked:He.particularsApproved,onChange:g=>Ce(I=>({...I,particularsApproved:g.target.checked})),style:{marginTop:"2px",width:"18px",height:"18px",accentColor:"#059669"}}),f.jsxs("div",{children:[f.jsx("div",{style:{fontWeight:"600",fontSize:"13px",color:"#166534"},children:"1. Particulars & Amount Approved"}),f.jsxs("div",{style:{fontSize:"12px",color:"#15803D"},children:["I confirm that the invoice particulars and amount (",ct(ae.invoiceTotalAmount),") are correct."]})]})]}),f.jsxs("label",{style:{display:"flex",alignItems:"flex-start",gap:"10px",marginBottom:"12px",cursor:"pointer"},children:[f.jsx("input",{type:"checkbox",checked:He.emailApproved,onChange:g=>Ce(I=>({...I,emailApproved:g.target.checked})),style:{marginTop:"2px",width:"18px",height:"18px",accentColor:"#059669"}}),f.jsxs("div",{children:[f.jsx("div",{style:{fontWeight:"600",fontSize:"13px",color:"#166534"},children:"2. Email ID Approved for Mailing"}),f.jsxs("div",{style:{fontSize:"12px",color:"#15803D"},children:["I confirm that ",f.jsx("strong",{children:ae.emailId||"the specified email"})," should be used for mailing."]})]})]}),f.jsxs("label",{style:{display:"flex",alignItems:"flex-start",gap:"10px",cursor:"pointer"},children:[f.jsx("input",{type:"checkbox",checked:He.invoiceTypeApproved,onChange:g=>Ce(I=>({...I,invoiceTypeApproved:g.target.checked})),style:{marginTop:"2px",width:"18px",height:"18px",accentColor:"#059669"}}),f.jsxs("div",{children:[f.jsx("div",{style:{fontWeight:"600",fontSize:"13px",color:"#166534"},children:"3. Invoice Type Confirmed"}),f.jsx("div",{style:{fontSize:"12px",color:"#15803D"},children:ae.invoiceType==="Combined"?`I confirm that a Combined Invoice is required for these ${Xi(ae).length} campaigns.`:"I confirm that an Individual Invoice is required (not combined with others)."})]})]})]}):f.jsxs("div",{style:{backgroundColor:ae.invoiceStatus==="Approved"?"#DCFCE7":ae.invoiceStatus==="Need Edits"?"#FEF3C7":"#F8FAFC",padding:"16px",borderRadius:"10px",marginBottom:"16px",border:"1px solid "+(ae.invoiceStatus==="Approved"?"#86EFAC":ae.invoiceStatus==="Need Edits"?"#FCD34D":"#E2E8F0")},children:[f.jsx("div",{style:{fontWeight:"600",color:ae.invoiceStatus==="Approved"?"#166534":ae.invoiceStatus==="Need Edits"?"#92400E":"#64748B",fontSize:"14px"},children:ae.invoiceStatus==="Approved"?" Approved by Director":ae.invoiceStatus==="Need Edits"?" Edits Required by Director":" Pending Director Approval"}),f.jsx("div",{style:{fontSize:"13px",color:ae.invoiceStatus==="Approved"?"#15803D":ae.invoiceStatus==="Need Edits"?"#A16207":"#64748B",marginTop:"6px"},children:ae.invoiceStatus==="Approved"?"This invoice has been approved and is ready for mailing.":ae.invoiceStatus==="Need Edits"?"Please make the required changes and resubmit for approval.":"This invoice is awaiting Director approval."})]}),Rn&&f.jsxs("div",{style:{marginBottom:"16px"},children:[f.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:" Remarks (optional for Approve, visible to Finance)"}),f.jsx("textarea",{value:wi,onChange:g=>Vi(g.target.value),placeholder:"Enter remarks or comments...",style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"13px",minHeight:"80px",resize:"vertical",boxSizing:"border-box"}})]}),f.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[f.jsx(Ye,{label:"Close",onClick:()=>{Mt(!1),Vi(""),Ce({particularsApproved:!1,emailApproved:!1,invoiceTypeApproved:!1})}}),Rn&&f.jsxs(f.Fragment,{children:[f.jsx(Ye,{label:"Need Edits",variant:"danger",icon:MB,onClick:ku}),f.jsx(Ye,{label:"Approve",variant:"success",icon:jB,onClick:U0})]})]})]})}),f.jsx(xn,{isOpen:mr,onClose:()=>nr(!1),title:" Delete Invoice",width:"450px",children:ae&&f.jsxs("div",{children:[f.jsxs("div",{style:{backgroundColor:"#FEE2E2",padding:"16px",borderRadius:"10px",marginBottom:"16px",border:"1px solid #FCA5A5"},children:[f.jsx("div",{style:{fontWeight:"700",color:"#991B1B",fontSize:"15px",marginBottom:"8px"},children:" Are you sure?"}),f.jsxs("div",{style:{fontSize:"14px",color:"#7F1D1D",lineHeight:"1.5"},children:["This will delete invoice ",f.jsx("strong",{children:ae.invoiceNo})," and reset the campaign(s) to allow re-generation.",ae.invoiceType==="Combined"&&f.jsxs("div",{style:{marginTop:"8px"},children:[f.jsxs("strong",{children:["All ",Xi(ae).length," combined campaigns"]})," will be reset to Individual type for re-selection."]})]})]}),f.jsxs("div",{style:{backgroundColor:"#F8FAFC",padding:"12px",borderRadius:"8px",marginBottom:"16px"},children:[f.jsxs("div",{style:{fontSize:"13px"},children:[f.jsx("strong",{children:"Invoice:"})," ",ae.invoiceNo]}),f.jsxs("div",{style:{fontSize:"13px"},children:[f.jsx("strong",{children:"Party:"})," ",ae.partyName]}),f.jsxs("div",{style:{fontSize:"13px"},children:[f.jsx("strong",{children:"Amount:"})," ",ct(ae.invoiceTotalAmount)]})]}),f.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[f.jsx(Ye,{label:"Cancel",onClick:()=>nr(!1)}),f.jsx(Ye,{label:"Delete Invoice",variant:"danger",icon:Us,onClick:H0})]})]})}),f.jsx(xn,{isOpen:ci,onClose:()=>Ar(!1),title:" Add Email Address",width:"400px",children:ae&&f.jsxs("div",{children:[f.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"12px",borderRadius:"8px",marginBottom:"16px"},children:[f.jsxs("div",{style:{fontSize:"13px"},children:[f.jsx("strong",{children:"Campaign:"})," ",ae.senderName]}),f.jsxs("div",{style:{fontSize:"13px",marginTop:"4px"},children:[f.jsx("strong",{children:"Current:"})," ",ae.emailId||"None"]})]}),f.jsx(pr,{label:"Additional Email Address",type:"email",value:Os,onChange:g=>aa(g.target.value),placeholder:"email@example.com",small:!0}),f.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"16px"},children:[f.jsx(Ye,{label:"Cancel",onClick:()=>Ar(!1)}),f.jsx(Ye,{label:"Add Email",variant:"brand",icon:O2,onClick:()=>{Os&&Os.includes("@")?(j0(ae.id,Os),Ar(!1),aa("")):alert("Please enter a valid email address")}})]})]})}),f.jsx(xn,{isOpen:k,onClose:()=>{_(!1),W({currentPassword:"",newPassword:"",confirmPassword:""}),w("")},title:" Change Password",width:"400px",children:f.jsxs("div",{children:[f.jsx("div",{style:{backgroundColor:"#EFF6FF",padding:"12px",borderRadius:"8px",marginBottom:"16px"},children:f.jsxs("div",{style:{fontSize:"13px"},children:[f.jsx("strong",{children:"User:"})," ",r==="director"?"Director":"Finance Team"]})}),f.jsxs("div",{style:{marginBottom:"16px"},children:[f.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Current Password"}),f.jsx("input",{type:"password",value:P.currentPassword,onChange:g=>W(I=>({...I,currentPassword:g.target.value})),placeholder:"Enter current password",style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"14px",boxSizing:"border-box"}})]}),f.jsxs("div",{style:{marginBottom:"16px"},children:[f.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"New Password"}),f.jsx("input",{type:"password",value:P.newPassword,onChange:g=>W(I=>({...I,newPassword:g.target.value})),placeholder:"Enter new password (min 6 characters)",style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"14px",boxSizing:"border-box"}})]}),f.jsxs("div",{style:{marginBottom:"16px"},children:[f.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Confirm New Password"}),f.jsx("input",{type:"password",value:P.confirmPassword,onChange:g=>W(I=>({...I,confirmPassword:g.target.value})),placeholder:"Confirm new password",onKeyPress:g=>g.key==="Enter"&&Wa(),style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"14px",boxSizing:"border-box"}})]}),B&&f.jsx("div",{style:{marginBottom:"16px",padding:"10px",backgroundColor:"#FEE2E2",borderRadius:"8px",color:"#991B1B",fontSize:"13px"},children:B}),f.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:[f.jsx(Ye,{label:"Cancel",onClick:()=>{_(!1),W({currentPassword:"",newPassword:"",confirmPassword:""}),w("")}}),f.jsx(Ye,{label:"Change Password",variant:"brand",icon:Id,onClick:Wa})]})]})}),f.jsx(xn,{isOpen:k,onClose:()=>{_(!1),w(""),W({currentPassword:"",newPassword:"",confirmPassword:""})},title:" Change Password",width:"400px",children:f.jsxs("div",{children:[f.jsx("div",{style:{backgroundColor:"#EFF6FF",padding:"12px",borderRadius:"8px",marginBottom:"16px"},children:f.jsxs("div",{style:{fontSize:"13px",color:"#1E40AF"},children:["Changing password for: ",f.jsx("strong",{children:r==="director"?"Director":"Finance Team"})]})}),f.jsxs("div",{style:{marginBottom:"16px"},children:[f.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Current Password"}),f.jsx("input",{type:"password",value:P.currentPassword,onChange:g=>W(I=>({...I,currentPassword:g.target.value})),placeholder:"Enter current password",style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"14px",boxSizing:"border-box"}})]}),f.jsxs("div",{style:{marginBottom:"16px"},children:[f.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"New Password"}),f.jsx("input",{type:"password",value:P.newPassword,onChange:g=>W(I=>({...I,newPassword:g.target.value})),placeholder:"Enter new password (min 6 chars)",style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"14px",boxSizing:"border-box"}})]}),f.jsxs("div",{style:{marginBottom:"16px"},children:[f.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Confirm New Password"}),f.jsx("input",{type:"password",value:P.confirmPassword,onChange:g=>W(I=>({...I,confirmPassword:g.target.value})),placeholder:"Re-enter new password",style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"14px",boxSizing:"border-box"}})]}),B&&f.jsx("div",{style:{marginBottom:"16px",padding:"10px",backgroundColor:"#FEE2E2",borderRadius:"8px",color:"#991B1B",fontSize:"13px"},children:B}),f.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:[f.jsx(Ye,{label:"Cancel",onClick:()=>{_(!1),w(""),W({currentPassword:"",newPassword:"",confirmPassword:""})}}),f.jsx(Ye,{label:"Change Password",variant:"brand",icon:Id,onClick:Wa})]})]})}),f.jsx(xn,{isOpen:li,onClose:()=>{ji(!1),kt(new Set),nt(null)},title:" Combine Invoices",width:"700px",children:ze&&f.jsxs("div",{children:[f.jsxs("div",{style:{backgroundColor:"#F3E8FF",padding:"14px 18px",borderRadius:"10px",marginBottom:"16px"},children:[f.jsxs("div",{style:{fontSize:"15px",fontWeight:"700",color:"#6B21A8"},children:["Party: ",ze]}),f.jsx("div",{style:{fontSize:"13px",color:"#7C3AED",marginTop:"4px"},children:"Select 2+ campaigns to combine into a single invoice"})]}),f.jsx("div",{style:{maxHeight:"350px",overflowY:"auto",border:"1px solid #E2E8F0",borderRadius:"10px"},children:f.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"13px"},children:[f.jsx("thead",{children:f.jsxs("tr",{style:{backgroundColor:"#F8FAFC",position:"sticky",top:0},children:[f.jsx("th",{style:{padding:"12px",textAlign:"center",width:"50px"},children:""}),f.jsx("th",{style:{padding:"12px",textAlign:"left"},children:"Sender"}),f.jsx("th",{style:{padding:"12px",textAlign:"left"},children:"Subject"}),f.jsx("th",{style:{padding:"12px",textAlign:"left"},children:"Date"}),f.jsx("th",{style:{padding:"12px",textAlign:"right"},children:"Amount"})]})}),f.jsx("tbody",{children:L0(ze).map(g=>{var I;return f.jsxs("tr",{style:{borderBottom:"1px solid #F1F5F9",backgroundColor:_t.has(g.id)?"#F3E8FF":"transparent",cursor:"pointer"},onClick:()=>N4(g.id),children:[f.jsx("td",{style:{padding:"12px",textAlign:"center"},children:f.jsx("input",{type:"checkbox",checked:_t.has(g.id),onChange:()=>{},style:{width:"18px",height:"18px",cursor:"pointer"}})}),f.jsx("td",{style:{padding:"12px",fontWeight:"600"},children:g.senderName}),f.jsxs("td",{style:{padding:"12px",color:"#64748B"},children:[(I=g.subject)==null?void 0:I.substring(0,35),"..."]}),f.jsx("td",{style:{padding:"12px"},children:hr(g.date)}),f.jsx("td",{style:{padding:"12px",textAlign:"right",fontWeight:"700"},children:ct(g.totalWithGst)})]},g.id)})})]})}),f.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px 18px",borderRadius:"10px",marginTop:"16px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[f.jsxs("div",{style:{fontSize:"14px",color:"#64748B"},children:["Selected: ",f.jsx("strong",{children:_t.size})," | Combine Code: ",f.jsxs("strong",{children:["C",we]})]}),f.jsxs("div",{style:{fontSize:"18px",fontWeight:"700",color:"#2874A6"},children:["Total: ",ct(ge.filter(g=>_t.has(g.id)).reduce((g,I)=>g+(parseFloat(I.totalWithGst)||0),0))]})]}),f.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"16px"},children:[f.jsx(Ye,{label:"Cancel",onClick:()=>{ji(!1),kt(new Set)}}),f.jsx(Ye,{label:"Create Combined Invoice",variant:"purple",icon:Bu,disabled:_t.size<2,onClick:R4})]})]})}),f.jsxs(xn,{isOpen:Vt,onClose:()=>{gt(!1),ki(null),za(!1)},title:gn?" Replace Mailer":" Upload Mailer",width:"550px",children:[f.jsx("input",{type:"file",ref:vu,accept:"image/*",style:{display:"none"},onChange:P4}),ae&&f.jsxs("div",{children:[f.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px",borderRadius:"10px",marginBottom:"14px"},children:[f.jsxs("div",{style:{fontSize:"14px"},children:[f.jsx("strong",{children:"Sender:"})," ",ae.senderName]}),f.jsxs("div",{style:{fontSize:"14px",marginTop:"4px"},children:[f.jsx("strong",{children:"Subject:"})," ",ae.subject]})]}),gn&&Et[ae.id]&&f.jsx("div",{style:{backgroundColor:"#FEF3C7",padding:"12px",borderRadius:"10px",marginBottom:"14px",border:"1px solid #FCD34D"},children:f.jsxs("div",{style:{fontWeight:"600",color:"#92400E",fontSize:"13px"},children:[" This will replace ",Et[ae.id].length," existing image(s)"]})}),f.jsxs("div",{style:{backgroundColor:"#FEF3C7",padding:"14px",borderRadius:"10px",marginBottom:"14px",border:"1px solid #FCD34D"},children:[f.jsx("div",{style:{fontWeight:"700",color:"#92400E",marginBottom:"8px",fontSize:"14px"},children:"Step 1: Find Mailer in Gmail"}),f.jsxs("button",{onClick:()=>M4(ae.subject),style:{display:"flex",alignItems:"center",gap:"8px",padding:"10px 18px",backgroundColor:"#EA4335",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"14px",fontWeight:"600"},children:[f.jsx(PB,{size:16})," Search in Gmail"]})]}),f.jsxs("div",{style:{backgroundColor:"#F0FDF4",padding:"14px",borderRadius:"10px",border:"1px solid #86EFAC"},children:[f.jsx("div",{style:{fontWeight:"700",color:"#166534",marginBottom:"8px",fontSize:"14px"},children:"Step 2: Paste Screenshot"}),f.jsx("div",{ref:D0,tabIndex:0,onPaste:O4,onClick:()=>{var g;return(g=D0.current)==null?void 0:g.focus()},style:{border:pn?"3px solid #22C55E":"3px dashed #22C55E",borderRadius:"10px",padding:pn?"8px":"30px",textAlign:"center",cursor:"pointer",backgroundColor:pn?"#FFFFFF":"#ECFDF5",minHeight:"100px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",outline:"none"},children:pn?f.jsxs(f.Fragment,{children:[f.jsx("img",{src:pn,alt:"Pasted",style:{maxWidth:"100%",maxHeight:"200px",borderRadius:"8px",marginBottom:"10px"}}),f.jsxs("div",{style:{display:"flex",gap:"8px"},children:[f.jsx(Ye,{icon:N2,label:"Save",variant:"success",onClick:()=>Qv(pn)}),f.jsx(Ye,{icon:Us,label:"Clear",variant:"danger",onClick:()=>ki(null)})]})]}):f.jsxs(f.Fragment,{children:[f.jsx(Mg,{size:36,color:"#22C55E",style:{marginBottom:"8px"}}),f.jsx("div",{style:{fontWeight:"700",fontSize:"14px",color:"#166534"},children:"Click here & Press Ctrl+V"})]})}),f.jsxs("div",{style:{textAlign:"center",marginTop:"12px"},children:[f.jsx("span",{style:{color:"#64748B",fontSize:"13px"},children:" OR "}),f.jsx("div",{style:{marginTop:"8px"},children:f.jsx(Ye,{icon:zs,label:"Browse Files",onClick:()=>{var g;return(g=vu.current)==null?void 0:g.click()}})})]})]})]})]}),f.jsx(xn,{isOpen:Rt,onClose:()=>dt(!1),title:" Send Invoice Email",width:"600px",children:ae&&f.jsxs("div",{children:[f.jsxs("div",{style:{display:"flex",gap:"0",marginBottom:"16px",border:"2px solid #E2E8F0",borderRadius:"8px",overflow:"hidden"},children:[f.jsx("button",{onClick:()=>sa("reply"),style:{flex:1,padding:"12px",backgroundColor:ia==="reply"?"#2874A6":"#F8FAFC",color:ia==="reply"?"white":"#64748B",border:"none",cursor:"pointer",fontWeight:"700",fontSize:"14px"},children:" Reply to Thread"}),f.jsx("button",{onClick:()=>sa("new"),style:{flex:1,padding:"12px",backgroundColor:ia==="new"?"#2874A6":"#F8FAFC",color:ia==="new"?"white":"#64748B",border:"none",cursor:"pointer",fontWeight:"700",fontSize:"14px"},children:" New Email"})]}),f.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px",borderRadius:"10px",marginBottom:"16px"},children:[f.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[f.jsx("strong",{children:"Invoice:"})," ",ae.invoiceNo]}),f.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[f.jsx("strong",{children:"Amount:"})," ",ct(ae.invoiceTotalAmount||ae.totalWithGst)]}),ae.invoiceType==="Combined"&&f.jsxs("div",{style:{fontSize:"13px",marginTop:"8px",color:"#7C3AED"},children:[f.jsx("strong",{children:"Campaigns:"})," ",Xi(ae).map(g=>g.senderName).join(", ")]}),f.jsx("div",{style:{fontSize:"14px",marginTop:"8px"},children:f.jsx("strong",{children:"Recipients:"})}),f.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"6px",marginTop:"6px"},children:[qo(ae).map((g,I)=>f.jsx("span",{style:{padding:"4px 10px",backgroundColor:"#DBEAFE",borderRadius:"6px",fontSize:"13px",color:"#1E40AF"},children:g},I)),qo(ae).length===0&&f.jsx("span",{style:{color:"#94A3B8"},children:"No email addresses"})]})]}),ia==="reply"?f.jsxs("div",{children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"8px"},children:[f.jsx("span",{style:{fontWeight:"700",fontSize:"14px"},children:"Email Body:"}),f.jsx("button",{onClick:()=>{navigator.clipboard.writeText(Q0(ae)),alert(" Copied!")},style:{padding:"6px 14px",backgroundColor:"#22C55E",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"13px",fontWeight:"600"},children:" Copy"})]}),f.jsx("div",{style:{fontSize:"13px",backgroundColor:"#F8FAFC",padding:"14px",borderRadius:"10px",whiteSpace:"pre-wrap",maxHeight:"200px",overflowY:"auto",fontFamily:"monospace",border:"1px solid #E2E8F0",lineHeight:"1.5"},children:Q0(ae)})]}):f.jsxs("div",{style:{display:"flex",gap:"10px"},children:[f.jsx("button",{onClick:()=>{const g=qo(ae),I=encodeURIComponent(g.join(",")),Y=encodeURIComponent(Jv(ae)),ee=encodeURIComponent(Q0(ae));window.open(`https://mail.google.com/mail/?view=cm&to=${I}&su=${Y}&body=${ee}`,"_blank")},style:{padding:"12px 20px",backgroundColor:"#EA4335",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"14px",fontWeight:"700"},children:" Open Gmail"}),f.jsx("button",{onClick:()=>{const g=qo(ae),I=encodeURIComponent(g.join(";")),Y=encodeURIComponent(Jv(ae)),ee=encodeURIComponent(Q0(ae));window.open(`https://outlook.live.com/mail/0/deeplink/compose?to=${I}&subject=${Y}&body=${ee}`,"_blank")},style:{padding:"12px 20px",backgroundColor:"#0078D4",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"14px",fontWeight:"700"},children:" Open Outlook"})]}),f.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"16px"},children:[f.jsx(Ye,{label:"View Invoice",icon:Fd,onClick:()=>{dt(!1),Au(ae)}}),f.jsx(Ye,{label:"Close",onClick:()=>dt(!1)})]})]})}),f.jsx(xn,{isOpen:$e,onClose:()=>Zt(!1),title:" Record Payment",width:"500px",children:ae&&f.jsxs("div",{children:[f.jsxs("div",{style:{backgroundColor:"#F0FDF4",padding:"14px",borderRadius:"10px",marginBottom:"16px"},children:[f.jsxs("div",{style:{fontSize:"14px"},children:[f.jsx("strong",{children:"Invoice:"})," ",ae.invoiceNo]}),f.jsxs("div",{style:{fontSize:"14px",marginTop:"4px"},children:[f.jsx("strong",{children:"Party:"})," ",ae.partyName]})]}),f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[f.jsx(pr,{label:"Payment Amount",type:"number",value:Qt.amount,onChange:g=>Wi({...Qt,amount:g.target.value}),small:!0}),f.jsx(pr,{label:"Date",type:"date",value:Qt.date,onChange:g=>Wi({...Qt,date:g.target.value}),small:!0})]}),f.jsx(Ld,{label:"Payment Mode",value:Qt.mode,onChange:g=>Wi({...Qt,mode:g.target.value}),options:[{value:"Bank",label:"Bank Transfer"},{value:"UPI",label:"UPI"},{value:"Cheque",label:"Cheque"},{value:"Cash",label:"Cash"}],small:!0}),f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[f.jsx(pr,{label:"TDS Deducted",type:"number",value:Qt.tds,onChange:g=>Wi({...Qt,tds:g.target.value}),placeholder:"0",small:!0}),f.jsx(pr,{label:"Discount",type:"number",value:Qt.discount,onChange:g=>Wi({...Qt,discount:g.target.value}),placeholder:"0",small:!0})]}),f.jsx(pr,{label:"Narration",value:Qt.narration,onChange:g=>Wi({...Qt,narration:g.target.value}),placeholder:"Reference",small:!0}),f.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"16px"},children:[f.jsx(Ye,{label:"Cancel",onClick:()=>Zt(!1)}),f.jsx(Ye,{label:"Record Payment",variant:"success",icon:DB,onClick:U4})]})]})}),f.jsxs(xn,{isOpen:fn,onClose:()=>$r(!1),title:" Set Opening Balance",width:"450px",children:[f.jsx(Ld,{label:"Select Party",value:fi.partyName,onChange:g=>Hl({...fi,partyName:g.target.value}),options:[{value:"",label:"Choose a party..."},...Xo.map(g=>({value:g,label:g}))],small:!0}),f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr",gap:"12px"},children:[f.jsx(pr,{label:"Amount",type:"number",value:fi.amount,onChange:g=>Hl({...fi,amount:g.target.value}),small:!0}),f.jsx(Ld,{label:"Type",value:fi.type,onChange:g=>Hl({...fi,type:g.target.value}),options:[{value:"Dr",label:"Debit"},{value:"Cr",label:"Credit"}],small:!0})]}),f.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"16px"},children:[f.jsx(Ye,{label:"Cancel",onClick:()=>$r(!1)}),f.jsx(Ye,{label:"Save",variant:"brand",onClick:()=>{fi.partyName&&fi.amount&&(Wo(g=>({...g,[fi.partyName]:fi.type==="Dr"?parseFloat(fi.amount):-parseFloat(fi.amount)})),$r(!1),Hl({partyName:"",amount:"",type:"Dr"}))}})]})]}),f.jsxs(xn,{isOpen:hs,onClose:()=>la(!1),title:" Import Historical Ledger",width:"600px",children:[f.jsx("input",{type:"file",ref:_u,accept:".xlsx,.xls,.csv",style:{display:"none"},onChange:Ve}),f.jsxs("div",{style:{padding:"16px",backgroundColor:"#EFF6FF",borderRadius:"10px",marginBottom:"16px",border:"1px solid #BFDBFE"},children:[f.jsx("div",{style:{fontWeight:"700",color:"#1E40AF",marginBottom:"8px",fontSize:"14px"},children:" How to Import Historical Ledger"}),f.jsxs("div",{style:{fontSize:"12px",color:"#1E3A8A",lineHeight:"1.6"},children:[f.jsx("p",{style:{margin:"0 0 8px 0"},children:"Upload your existing ledger data in the format shown in the template. This will import all historical transactions."}),f.jsxs("p",{style:{margin:0},children:[f.jsx("strong",{children:"Supported columns:"})," Date, Particular, Vch Type, Vch No., Debit, Credit, Date of Receipt, Amount Received, TDS Received, Balance, Payment Status"]})]})]}),H&&f.jsxs("div",{style:{padding:"12px",backgroundColor:"#DCFCE7",borderRadius:"8px",marginBottom:"16px",border:"1px solid #86EFAC"},children:[f.jsxs("div",{style:{fontSize:"13px",color:"#166534"},children:[f.jsx("strong",{children:" Selected Party:"})," ",H]}),f.jsx("div",{style:{fontSize:"11px",color:"#15803D",marginTop:"4px"},children:"All entries from the uploaded file will be imported for this party"})]}),!H&&f.jsxs("div",{style:{padding:"12px",backgroundColor:"#FEE2E2",borderRadius:"8px",marginBottom:"16px",border:"1px solid #FCA5A5"},children:[f.jsx("div",{style:{fontSize:"13px",color:"#991B1B"},children:f.jsx("strong",{children:" No Party Selected"})}),f.jsx("div",{style:{fontSize:"12px",color:"#B91C1C",marginTop:"4px"},children:'Please close this modal and select a party from the Parties list on the left, then click "Import Historical" again.'})]}),f.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center",marginBottom:"16px"},children:[f.jsx(Ye,{icon:Mu,label:"Download Template",variant:"brand",onClick:Wt}),H?f.jsx(Ye,{icon:zs,label:"Upload Ledger",variant:"success",onClick:()=>{var g;return(g=_u.current)==null?void 0:g.click()}}):f.jsxs("button",{disabled:!0,style:{padding:"8px 16px",fontSize:"13px",fontWeight:"600",border:"none",borderRadius:"8px",backgroundColor:"#E2E8F0",color:"#94A3B8",cursor:"not-allowed",display:"flex",alignItems:"center",gap:"6px"},children:[f.jsx(zs,{size:16})," Upload Ledger"]})]}),f.jsxs("div",{style:{padding:"14px",backgroundColor:"#F8FAFC",borderRadius:"8px",border:"1px solid #E2E8F0"},children:[f.jsx("div",{style:{fontWeight:"600",color:"#475569",marginBottom:"8px",fontSize:"13px"},children:" Expected Format (matches your ledger export):"}),f.jsx("div",{style:{overflowX:"auto"},children:f.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"10px"},children:[f.jsx("thead",{children:f.jsxs("tr",{style:{backgroundColor:"#E2E8F0"},children:[f.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"left"},children:"Date"}),f.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"left"},children:"Particular"}),f.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"left"},children:"Vch Type"}),f.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"left"},children:"Vch No."}),f.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"right"},children:"Debit"}),f.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"right"},children:"Credit"}),f.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"right"},children:"Amt Recd"}),f.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"left"},children:"Status"})]})}),f.jsx("tbody",{children:f.jsxs("tr",{children:[f.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0"},children:"02-Jun-21"}),f.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0"},children:"DB Corp Ltd"}),f.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0"},children:"Sales"}),f.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0"},children:"MB/2020-21/0411"}),f.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0",textAlign:"right"},children:"6,000"}),f.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0"}}),f.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0",textAlign:"right"},children:"44,371"}),f.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0"},children:"Received"})]})})]})})]}),f.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"16px"},children:f.jsx(Ye,{label:"Close",onClick:()=>la(!1)})})]}),f.jsx(xn,{isOpen:Qn,onClose:()=>{ot(!1),ce({amount:"",tds:"",discount:"",narration:"",paymentAdvisory:null,date:new Date().toISOString().split("T")[0],mode:"Bank"})},title:" Create Receipt",width:"550px",children:ae&&f.jsxs("div",{children:[f.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px",borderRadius:"10px",marginBottom:"16px"},children:[f.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[f.jsx("strong",{children:"Invoice:"})," ",ae.invoiceNo]}),f.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[f.jsx("strong",{children:"Party:"})," ",ae.partyName]}),f.jsxs("div",{style:{fontSize:"14px"},children:[f.jsx("strong",{children:"Invoice Amount:"})," ",ct(ae.invoiceTotalAmount)]})]}),f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",marginBottom:"12px"},children:[f.jsx(pr,{label:"Receipt Date",type:"date",value:te.date,onChange:g=>ce({...te,date:g.target.value}),small:!0}),f.jsx(Ld,{label:"Payment Mode",value:te.mode,onChange:g=>ce({...te,mode:g.target.value}),options:[{value:"Bank",label:"Bank Transfer"},{value:"Cash",label:"Cash"},{value:"Cheque",label:"Cheque"},{value:"UPI",label:"UPI"}],small:!0})]}),f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"12px",marginBottom:"12px"},children:[f.jsx(pr,{label:"Amount Received",type:"number",value:te.amount,onChange:g=>ce({...te,amount:g.target.value}),placeholder:"0.00",small:!0}),f.jsx(pr,{label:"TDS Deducted",type:"number",value:te.tds,onChange:g=>ce({...te,tds:g.target.value}),placeholder:"0.00",small:!0}),f.jsx(pr,{label:"Discount",type:"number",value:te.discount,onChange:g=>ce({...te,discount:g.target.value}),placeholder:"0.00",small:!0})]}),f.jsx("div",{style:{backgroundColor:"#F0FDF4",padding:"12px",borderRadius:"8px",marginBottom:"16px"},children:f.jsxs("div",{style:{fontSize:"14px",fontWeight:"700",color:"#166534"},children:["Total Credit: ",ct((parseFloat(te.amount)||0)+(parseFloat(te.tds)||0)+(parseFloat(te.discount)||0))]})}),f.jsx(pr,{label:"Narration",value:te.narration,onChange:g=>ce({...te,narration:g.target.value}),placeholder:"Payment reference, remarks...",small:!0}),f.jsxs("div",{style:{marginBottom:"16px"},children:[f.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Payment Advisory (Optional)"}),f.jsx("input",{type:"file",ref:P0,accept:"image/*,.pdf",onChange:$0,style:{display:"none"}}),te.paymentAdvisory?f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[f.jsx("div",{style:{flex:1,padding:"10px",backgroundColor:"#F0FDF4",borderRadius:"8px",fontSize:"13px",color:"#166534"},children:" Payment advisory attached"}),f.jsx("button",{onClick:()=>ce(g=>({...g,paymentAdvisory:null})),style:{padding:"8px",border:"none",backgroundColor:"#FEE2E2",borderRadius:"6px",cursor:"pointer",color:"#991B1B"},children:f.jsx(rl,{size:16})})]}):f.jsxs("button",{onClick:()=>{var g;return(g=P0.current)==null?void 0:g.click()},style:{padding:"10px 16px",border:"1.5px dashed #D1D5DB",borderRadius:"8px",backgroundColor:"#F9FAFB",cursor:"pointer",fontSize:"13px",color:"#6B7280",display:"flex",alignItems:"center",gap:"8px"},children:[f.jsx(zs,{size:16})," Attach Payment Advisory"]})]}),f.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[f.jsx(Ye,{label:"Cancel",onClick:()=>ot(!1)}),f.jsx(Ye,{label:"Create Receipt",variant:"success",icon:Bu,onClick:z0})]})]})}),f.jsx(xn,{isOpen:ir,onClose:()=>{xr(!1),Pe({amount:"",gst:"",reason:"",date:new Date().toISOString().split("T")[0]})},title:" Create Credit Note",width:"500px",children:ae&&(()=>{var K;const g=(K=ae.statePartyDetails)==null?void 0:K.toUpperCase().includes("MAHARASHTRA"),I=g?"CGST + SGST (9% + 9%)":"IGST (18%)",Y=parseFloat(me.amount)||0,ee=parseFloat(me.gst)||0,Q=Y+ee;return f.jsxs("div",{children:[f.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px",borderRadius:"10px",marginBottom:"16px"},children:[f.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[f.jsx("strong",{children:"Invoice:"})," ",ae.invoiceNo]}),f.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[f.jsx("strong",{children:"Party:"})," ",ae.partyName]}),f.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[f.jsx("strong",{children:"Invoice Amount:"})," ",ct(ae.invoiceTotalAmount)]}),f.jsxs("div",{style:{fontSize:"12px",color:"#2563EB"},children:[f.jsx("strong",{children:"GST Type:"})," ",g?"CGST + SGST (Intra-state)":"IGST (Inter-state)"]})]}),f.jsx("div",{style:{marginBottom:"12px"},children:f.jsx(pr,{label:"Credit Note Date",type:"date",value:me.date,onChange:ne=>Pe({...me,date:ne.target.value}),small:!0})}),f.jsxs("div",{style:{backgroundColor:"#FEF2F2",padding:"14px",borderRadius:"10px",marginBottom:"12px",border:"1px solid #FECACA"},children:[f.jsx("div",{style:{fontWeight:"700",color:"#991B1B",marginBottom:"10px",fontSize:"13px"},children:" Credit Note Breakdown"}),f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[f.jsx(pr,{label:"Base Amount",type:"number",value:me.amount,onChange:ne=>Pe({...me,amount:ne.target.value}),placeholder:"0.00",small:!0}),f.jsx(pr,{label:I,type:"number",value:me.gst,onChange:ne=>Pe({...me,gst:ne.target.value}),placeholder:"0.00",small:!0})]}),f.jsxs("div",{style:{marginTop:"10px",padding:"8px",backgroundColor:"#FEE2E2",borderRadius:"6px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[f.jsx("span",{style:{fontSize:"13px",fontWeight:"600",color:"#991B1B"},children:"Total Credit:"}),f.jsx("span",{style:{fontSize:"15px",fontWeight:"700",color:"#991B1B"},children:ct(Q)})]})]}),f.jsxs("div",{style:{marginBottom:"16px"},children:[f.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Reason for Credit Note *"}),f.jsx("textarea",{value:me.reason,onChange:ne=>Pe({...me,reason:ne.target.value}),placeholder:"Enter reason for issuing credit note...",style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"13px",minHeight:"80px",resize:"vertical",boxSizing:"border-box"}})]}),f.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[f.jsx(Ye,{label:"Cancel",onClick:()=>xr(!1)}),f.jsx(Ye,{label:"Create Credit Note",variant:"danger",icon:Lu,onClick:W0})]})]})})()}),f.jsx(xn,{isOpen:U,onClose:()=>{L(!1),z(null)},title:" Add Followup",width:"500px",children:M&&f.jsxs("div",{children:[f.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px",borderRadius:"10px",marginBottom:"16px"},children:[f.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[f.jsx("strong",{children:"Invoice:"})," ",M.invoiceNo]}),f.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[f.jsx("strong",{children:"Party:"})," ",M.partyName]}),f.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[f.jsx("strong",{children:"Amount:"})," ",ct(M.invoiceTotalAmount||M.totalAmount)]}),f.jsxs("div",{style:{fontSize:"14px"},children:[f.jsx("strong",{children:"Invoice Date:"})," ",hr(M.invoiceDate||M.date)]})]}),f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",marginBottom:"12px"},children:[f.jsx(pr,{label:"Followup Date",type:"date",value:V.date,onChange:g=>le({...V,date:g.target.value}),small:!0}),f.jsx(pr,{label:"Next Followup Date",type:"date",value:V.nextFollowupDate,onChange:g=>le({...V,nextFollowupDate:g.target.value}),small:!0})]}),f.jsxs("div",{style:{marginBottom:"16px"},children:[f.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Followup Notes *"}),f.jsx("textarea",{value:V.notes,onChange:g=>le({...V,notes:g.target.value}),placeholder:"Enter followup notes (e.g., Spoke with accounts team, payment promised by next week)",style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"13px",minHeight:"80px",resize:"vertical",boxSizing:"border-box"}})]}),f.jsxs("div",{style:{marginBottom:"16px"},children:[f.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Status"}),f.jsxs("select",{value:V.status,onChange:g=>le({...V,status:g.target.value}),style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"13px"},children:[f.jsx("option",{value:"Pending",children:"Pending"}),f.jsx("option",{value:"Promised",children:"Promised - Payment Expected"}),f.jsx("option",{value:"Disputed",children:"Disputed"}),f.jsx("option",{value:"No Response",children:"No Response"})]})]}),f.jsxs("div",{style:{backgroundColor:"#F0FDF4",padding:"12px",borderRadius:"8px",marginBottom:"16px",border:"1px solid #86EFAC"},children:[f.jsx("div",{style:{fontSize:"12px",fontWeight:"600",color:"#166534",marginBottom:"8px"},children:" Quick Actions"}),f.jsxs("div",{style:{display:"flex",gap:"8px"},children:[f.jsx(Ye,{icon:Mg,label:"Copy Email Template",small:!0,variant:"brand",onClick:()=>u(M)}),f.jsx(Ye,{icon:Bg,label:"Search in Gmail",small:!0,variant:"success",onClick:()=>v(M)})]})]}),f.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[f.jsx(Ye,{label:"Cancel",onClick:()=>L(!1)}),f.jsx(Ye,{label:"Save Followup",variant:"primary",icon:jg,onClick:q0})]})]})}),f.jsx(xn,{isOpen:ur,onClose:()=>Fn(!1),title:" Clear All Data",width:"500px",children:f.jsxs("div",{children:[f.jsxs("div",{style:{backgroundColor:"#FEE2E2",padding:"20px",borderRadius:"12px",marginBottom:"20px",border:"2px solid #FCA5A5"},children:[f.jsxs("div",{style:{fontWeight:"700",color:"#991B1B",fontSize:"18px",marginBottom:"12px",display:"flex",alignItems:"center",gap:"8px"},children:[f.jsx(F2,{size:24})," Warning: This action cannot be undone!"]}),f.jsxs("div",{style:{fontSize:"14px",color:"#7F1D1D",lineHeight:"1.6"},children:["This will permanently delete:",f.jsxs("ul",{style:{margin:"12px 0 0 20px",padding:0},children:[f.jsxs("li",{children:[f.jsx("strong",{children:ge.length})," campaigns from Master Sheet"]}),f.jsxs("li",{children:[f.jsx("strong",{children:ge.filter(g=>g.invoiceGenerated).length})," generated invoices"]}),f.jsxs("li",{children:[f.jsx("strong",{children:J.length})," receipts"]}),f.jsxs("li",{children:[f.jsx("strong",{children:Me.length})," credit notes"]}),f.jsxs("li",{children:[f.jsx("strong",{children:Ee.length})," ledger entries"]}),f.jsxs("li",{children:[f.jsx("strong",{children:Object.keys(Et).length})," mailer images"]}),f.jsx("li",{children:"All opening balances"})]})]})]}),f.jsx("div",{style:{backgroundColor:"#FEF3C7",padding:"14px",borderRadius:"8px",marginBottom:"20px",border:"1px solid #FCD34D"},children:f.jsxs("div",{style:{fontSize:"13px",color:"#92400E"},children:[f.jsx("strong",{children:"Note:"})," Invoice series numbers will be reset to 1. Your company settings and mailer logo will be preserved."]})}),f.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:[f.jsx(Ye,{label:"Cancel",onClick:()=>Fn(!1)}),f.jsx(Ye,{label:"Yes, Clear All Data",variant:"danger",icon:Us,onClick:Ga})]})]})}),f.jsx(xn,{isOpen:oa,onClose:()=>$l(!1),title:" Notifications",width:"550px",children:f.jsxs("div",{children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[f.jsx("div",{style:{fontSize:"14px",color:"#64748B"},children:Ki>0?`${Ki} unread`:"No unread notifications"}),f.jsxs("div",{style:{display:"flex",gap:"8px"},children:[Ki>0&&f.jsx("button",{onClick:Gp,style:{padding:"6px 12px",fontSize:"12px",fontWeight:"600",border:"1px solid #E2E8F0",borderRadius:"6px",backgroundColor:"#F8FAFC",color:"#475569",cursor:"pointer"},children:"Mark all as read"}),Ti.length>0&&Ft&&f.jsx("button",{onClick:Kp,style:{padding:"6px 12px",fontSize:"12px",fontWeight:"600",border:"1px solid #FCA5A5",borderRadius:"6px",backgroundColor:"#FEE2E2",color:"#991B1B",cursor:"pointer"},children:"Clear all"})]})]}),f.jsx("div",{style:{maxHeight:"400px",overflowY:"auto"},children:Ko.length===0?f.jsxs("div",{style:{padding:"40px",textAlign:"center",color:"#94A3B8"},children:[f.jsx(b2,{size:40,style:{marginBottom:"12px",opacity:.5}}),f.jsx("div",{style:{fontSize:"16px",fontWeight:"600"},children:"No notifications"}),f.jsx("div",{style:{fontSize:"13px",marginTop:"4px"},children:"You're all caught up!"})]}):Ko.map(g=>{const I=!(g.read&&g.read[r]),Y=Q=>{switch(Q){case"upload":return"";case"invoice":return"";case"approval":return"";case"edit":return"";case"receipt":return"";default:return""}},ee=Q=>{switch(Q){case"upload":return"#EFF6FF";case"invoice":return"#FEF3C7";case"approval":return"#DCFCE7";case"edit":return"#FEE2E2";case"receipt":return"#F0FDF4";default:return"#F8FAFC"}};return f.jsx("div",{onClick:()=>dr(g.id),style:{padding:"14px",borderRadius:"10px",marginBottom:"8px",backgroundColor:I?ee(g.type):"#F8FAFC",border:I?"2px solid #2874A6":"1px solid #E2E8F0",cursor:"pointer",transition:"all 0.2s ease"},children:f.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"12px"},children:[f.jsx("div",{style:{fontSize:"20px"},children:Y(g.type)}),f.jsxs("div",{style:{flex:1},children:[f.jsx("div",{style:{fontSize:"14px",fontWeight:I?"600":"500",color:"#1E293B",lineHeight:"1.4"},children:g.message}),f.jsxs("div",{style:{display:"flex",gap:"12px",marginTop:"8px",fontSize:"11px",color:"#64748B"},children:[f.jsxs("span",{children:["By: ",g.createdBy==="finance"?"Finance Team":"Director"]}),f.jsx("span",{children:""}),f.jsx("span",{children:new Date(g.createdAt).toLocaleString()})]})]}),I&&f.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:"#DC2626",flexShrink:0}})]})},g.id)})})]})})]}),Q4=()=>{switch(N){case"master":return iy();case"invoices":return $4();case"ledgers":return G4();case"followups":return X4();case"reports":return oy();case"settings":return r==="finance"?q4():oy();default:return iy()}},J4=()=>f.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, #1E3A5F 0%, #2874A6 50%, #1E3A5F 100%)",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',padding:"20px"},children:f.jsxs("div",{style:{backgroundColor:"#FFFFFF",padding:"0",borderRadius:"24px",boxShadow:"0 25px 50px -12px rgba(0,0,0,0.25)",width:"420px",maxWidth:"95vw",overflow:"hidden"},children:[f.jsxs("div",{style:{background:"linear-gradient(135deg, #1E3A5F 0%, #2874A6 100%)",padding:"32px 40px",textAlign:"center"},children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"12px",marginBottom:"8px"},children:[f.jsx("img",{src:"/logo.png",alt:"JAC",style:{width:"60px",height:"auto",borderRadius:"8px",backgroundColor:"white",padding:"4px"}}),f.jsx("span",{style:{fontSize:"36px",fontWeight:"800",color:"#FFFFFF",letterSpacing:"-1px"},children:"FinMate"})]}),f.jsx("p",{style:{margin:0,color:"rgba(255,255,255,0.8)",fontSize:"14px",fontWeight:"500"},children:"Finance Management System"})]}),f.jsxs("div",{style:{padding:"32px 40px"},children:[f.jsxs("div",{style:{marginBottom:"24px"},children:[f.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#1E3A5F",marginBottom:"8px",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Username"}),f.jsxs("div",{style:{position:"relative"},children:[f.jsx(B2,{size:18,style:{position:"absolute",left:"14px",top:"50%",transform:"translateY(-50%)",color:"#94A3B8"}}),f.jsx("input",{type:"text",value:i.username,onChange:g=>s(I=>({...I,username:g.target.value})),placeholder:"Enter username",style:{width:"100%",padding:"14px 14px 14px 44px",borderRadius:"12px",border:"2px solid #E2E8F0",fontSize:"15px",boxSizing:"border-box",transition:"border-color 0.2s, box-shadow 0.2s",outline:"none"},onFocus:g=>{g.target.style.borderColor="#2874A6",g.target.style.boxShadow="0 0 0 3px rgba(40,116,166,0.1)"},onBlur:g=>{g.target.style.borderColor="#E2E8F0",g.target.style.boxShadow="none"}})]})]}),f.jsxs("div",{style:{marginBottom:"28px"},children:[f.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#1E3A5F",marginBottom:"8px",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Password"}),f.jsxs("div",{style:{position:"relative"},children:[f.jsx(Id,{size:18,style:{position:"absolute",left:"14px",top:"50%",transform:"translateY(-50%)",color:"#94A3B8"}}),f.jsx("input",{type:"password",value:i.password,onChange:g=>s(I=>({...I,password:g.target.value})),placeholder:"Enter password",onKeyPress:g=>g.key==="Enter"&&Tu(),style:{width:"100%",padding:"14px 14px 14px 44px",borderRadius:"12px",border:"2px solid #E2E8F0",fontSize:"15px",boxSizing:"border-box",transition:"border-color 0.2s, box-shadow 0.2s",outline:"none"},onFocus:g=>{g.target.style.borderColor="#2874A6",g.target.style.boxShadow="0 0 0 3px rgba(40,116,166,0.1)"},onBlur:g=>{g.target.style.borderColor="#E2E8F0",g.target.style.boxShadow="none"}})]})]}),a&&f.jsxs("div",{style:{marginBottom:"20px",padding:"14px",backgroundColor:"#FEF2F2",borderRadius:"12px",color:"#DC2626",fontSize:"14px",textAlign:"center",border:"1px solid #FECACA",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[f.jsx(F2,{size:18}),a]}),f.jsx("button",{onClick:Tu,style:{width:"100%",padding:"16px",fontSize:"16px",fontWeight:"700",border:"none",borderRadius:"12px",cursor:E?"pointer":"wait",background:E?"linear-gradient(135deg, #1E3A5F 0%, #2874A6 100%)":"#94A3B8",color:"white",transition:"transform 0.2s, box-shadow 0.2s",boxShadow:E?"0 4px 14px rgba(40,116,166,0.4)":"none",opacity:E?1:.7},disabled:!E,onMouseOver:g=>{E&&(g.target.style.transform="translateY(-2px)",g.target.style.boxShadow="0 6px 20px rgba(40,116,166,0.5)")},onMouseOut:g=>{E&&(g.target.style.transform="translateY(0)",g.target.style.boxShadow="0 4px 14px rgba(40,116,166,0.4)")},children:E?"Sign In":"Loading..."}),f.jsxs("div",{style:{marginTop:"24px",textAlign:"center",color:"#94A3B8",fontSize:"12px"},children:[f.jsx("span",{children:"Powered by "}),f.jsx("span",{style:{fontWeight:"600",color:"#1E3A5F"},children:"JAC"}),f.jsx("span",{children:"  Strategy | Talent | Results"})]})]})]})});return t?l?f.jsxs("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, #1E3A5F 0%, #2874A6 50%, #1E3A5F 100%)",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:[f.jsxs("div",{style:{textAlign:"center"},children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"12px",marginBottom:"24px"},children:[f.jsx("img",{src:"/logo.png",alt:"JAC",style:{width:"50px",height:"auto",borderRadius:"8px",backgroundColor:"white",padding:"4px"}}),f.jsx("span",{style:{fontSize:"32px",fontWeight:"800",color:"#FFFFFF",letterSpacing:"-1px"},children:"FinMate"})]}),f.jsx(P2,{size:48,style:{animation:"spin 1s linear infinite",color:"#FFFFFF",marginBottom:"16px"}}),f.jsx("div",{style:{fontSize:"18px",fontWeight:"600",color:"#FFFFFF"},children:"Loading your data..."}),f.jsx("div",{style:{fontSize:"14px",color:"rgba(255,255,255,0.7)",marginTop:"8px"},children:"Please wait while we sync with the cloud"})]}),f.jsx("style",{children:"@keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }"})]}):f.jsxs("div",{style:{display:"flex",height:"100vh",backgroundColor:"#F1F5F9",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:[z4(),f.jsx("main",{style:{flex:1,overflow:"auto",padding:"20px"},children:Q4()}),Y4(),f.jsx("style",{children:"@keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }"})]}):J4()}Zg.createRoot(document.getElementById("root")).render(f.jsx(Vd.StrictMode,{children:f.jsx(IW,{})}));
