(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();function sb(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var vS={exports:{}},kp={},yS={exports:{}},Lt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Uf=Symbol.for("react.element"),ab=Symbol.for("react.portal"),ob=Symbol.for("react.fragment"),lb=Symbol.for("react.strict_mode"),cb=Symbol.for("react.profiler"),ub=Symbol.for("react.provider"),db=Symbol.for("react.context"),fb=Symbol.for("react.forward_ref"),hb=Symbol.for("react.suspense"),pb=Symbol.for("react.memo"),gb=Symbol.for("react.lazy"),Ry=Symbol.iterator;function mb(t){return t===null||typeof t!="object"?null:(t=Ry&&t[Ry]||t["@@iterator"],typeof t=="function"?t:null)}var _S={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},ES=Object.assign,SS={};function Du(t,e,r){this.props=t,this.context=e,this.refs=SS,this.updater=r||_S}Du.prototype.isReactComponent={};Du.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Du.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function wS(){}wS.prototype=Du.prototype;function Gx(t,e,r){this.props=t,this.context=e,this.refs=SS,this.updater=r||_S}var Kx=Gx.prototype=new wS;Kx.constructor=Gx;ES(Kx,Du.prototype);Kx.isPureReactComponent=!0;var Dy=Array.isArray,TS=Object.prototype.hasOwnProperty,Yx={current:null},AS={key:!0,ref:!0,__self:!0,__source:!0};function CS(t,e,r){var n,i={},s=null,a=null;if(e!=null)for(n in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(s=""+e.key),e)TS.call(e,n)&&!AS.hasOwnProperty(n)&&(i[n]=e[n]);var o=arguments.length-2;if(o===1)i.children=r;else if(1<o){for(var l=Array(o),u=0;u<o;u++)l[u]=arguments[u+2];i.children=l}if(t&&t.defaultProps)for(n in o=t.defaultProps,o)i[n]===void 0&&(i[n]=o[n]);return{$$typeof:Uf,type:t,key:s,ref:a,props:i,_owner:Yx.current}}function xb(t,e){return{$$typeof:Uf,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Xx(t){return typeof t=="object"&&t!==null&&t.$$typeof===Uf}function vb(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var Py=/\/+/g;function xg(t,e){return typeof t=="object"&&t!==null&&t.key!=null?vb(""+t.key):e.toString(36)}function sh(t,e,r,n,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case Uf:case ab:a=!0}}if(a)return a=t,i=i(a),t=n===""?"."+xg(a,0):n,Dy(i)?(r="",t!=null&&(r=t.replace(Py,"$&/")+"/"),sh(i,e,r,"",function(u){return u})):i!=null&&(Xx(i)&&(i=xb(i,r+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(Py,"$&/")+"/")+t)),e.push(i)),1;if(a=0,n=n===""?".":n+":",Dy(t))for(var o=0;o<t.length;o++){s=t[o];var l=n+xg(s,o);a+=sh(s,e,r,l,i)}else if(l=mb(t),typeof l=="function")for(t=l.call(t),o=0;!(s=t.next()).done;)s=s.value,l=n+xg(s,o++),a+=sh(s,e,r,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function y0(t,e,r){if(t==null)return t;var n=[],i=0;return sh(t,n,"","",function(s){return e.call(r,s,i++)}),n}function yb(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Ri={current:null},ah={transition:null},_b={ReactCurrentDispatcher:Ri,ReactCurrentBatchConfig:ah,ReactCurrentOwner:Yx};function kS(){throw Error("act(...) is not supported in production builds of React.")}Lt.Children={map:y0,forEach:function(t,e,r){y0(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return y0(t,function(){e++}),e},toArray:function(t){return y0(t,function(e){return e})||[]},only:function(t){if(!Xx(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Lt.Component=Du;Lt.Fragment=ob;Lt.Profiler=cb;Lt.PureComponent=Gx;Lt.StrictMode=lb;Lt.Suspense=hb;Lt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=_b;Lt.act=kS;Lt.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=ES({},t.props),i=t.key,s=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,a=Yx.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var o=t.type.defaultProps;for(l in e)TS.call(e,l)&&!AS.hasOwnProperty(l)&&(n[l]=e[l]===void 0&&o!==void 0?o[l]:e[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var u=0;u<l;u++)o[u]=arguments[u+2];n.children=o}return{$$typeof:Uf,type:t.type,key:i,ref:s,props:n,_owner:a}};Lt.createContext=function(t){return t={$$typeof:db,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:ub,_context:t},t.Consumer=t};Lt.createElement=CS;Lt.createFactory=function(t){var e=CS.bind(null,t);return e.type=t,e};Lt.createRef=function(){return{current:null}};Lt.forwardRef=function(t){return{$$typeof:fb,render:t}};Lt.isValidElement=Xx;Lt.lazy=function(t){return{$$typeof:gb,_payload:{_status:-1,_result:t},_init:yb}};Lt.memo=function(t,e){return{$$typeof:pb,type:t,compare:e===void 0?null:e}};Lt.startTransition=function(t){var e=ah.transition;ah.transition={};try{t()}finally{ah.transition=e}};Lt.unstable_act=kS;Lt.useCallback=function(t,e){return Ri.current.useCallback(t,e)};Lt.useContext=function(t){return Ri.current.useContext(t)};Lt.useDebugValue=function(){};Lt.useDeferredValue=function(t){return Ri.current.useDeferredValue(t)};Lt.useEffect=function(t,e){return Ri.current.useEffect(t,e)};Lt.useId=function(){return Ri.current.useId()};Lt.useImperativeHandle=function(t,e,r){return Ri.current.useImperativeHandle(t,e,r)};Lt.useInsertionEffect=function(t,e){return Ri.current.useInsertionEffect(t,e)};Lt.useLayoutEffect=function(t,e){return Ri.current.useLayoutEffect(t,e)};Lt.useMemo=function(t,e){return Ri.current.useMemo(t,e)};Lt.useReducer=function(t,e,r){return Ri.current.useReducer(t,e,r)};Lt.useRef=function(t){return Ri.current.useRef(t)};Lt.useState=function(t){return Ri.current.useState(t)};Lt.useSyncExternalStore=function(t,e,r){return Ri.current.useSyncExternalStore(t,e,r)};Lt.useTransition=function(){return Ri.current.useTransition()};Lt.version="18.3.1";yS.exports=Lt;var ye=yS.exports;const oh=sb(ye);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Eb=ye,Sb=Symbol.for("react.element"),wb=Symbol.for("react.fragment"),Tb=Object.prototype.hasOwnProperty,Ab=Eb.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Cb={key:!0,ref:!0,__self:!0,__source:!0};function FS(t,e,r){var n,i={},s=null,a=null;r!==void 0&&(s=""+r),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(a=e.ref);for(n in e)Tb.call(e,n)&&!Cb.hasOwnProperty(n)&&(i[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)i[n]===void 0&&(i[n]=e[n]);return{$$typeof:Sb,type:t,key:s,ref:a,props:i,_owner:Ab.current}}kp.Fragment=wb;kp.jsx=FS;kp.jsxs=FS;vS.exports=kp;var c=vS.exports,ym={},bS={exports:{}},hs={},IS={exports:{}},NS={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(ke,ne){var Ie=ke.length;ke.push(ne);e:for(;0<Ie;){var je=Ie-1>>>1,K=ke[je];if(0<i(K,ne))ke[je]=ne,ke[Ie]=K,Ie=je;else break e}}function r(ke){return ke.length===0?null:ke[0]}function n(ke){if(ke.length===0)return null;var ne=ke[0],Ie=ke.pop();if(Ie!==ne){ke[0]=Ie;e:for(var je=0,K=ke.length,te=K>>>1;je<te;){var re=2*(je+1)-1,X=ke[re],_e=re+1,Ce=ke[_e];if(0>i(X,Ie))_e<K&&0>i(Ce,X)?(ke[je]=Ce,ke[_e]=Ie,je=_e):(ke[je]=X,ke[re]=Ie,je=re);else if(_e<K&&0>i(Ce,Ie))ke[je]=Ce,ke[_e]=Ie,je=_e;else break e}}return ne}function i(ke,ne){var Ie=ke.sortIndex-ne.sortIndex;return Ie!==0?Ie:ke.id-ne.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();t.unstable_now=function(){return a.now()-o}}var l=[],u=[],f=1,p=null,g=3,m=!1,y=!1,x=!1,S=typeof setTimeout=="function"?setTimeout:null,A=typeof clearTimeout=="function"?clearTimeout:null,C=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function E(ke){for(var ne=r(u);ne!==null;){if(ne.callback===null)n(u);else if(ne.startTime<=ke)n(u),ne.sortIndex=ne.expirationTime,e(l,ne);else break;ne=r(u)}}function O(ke){if(x=!1,E(ke),!y)if(r(l)!==null)y=!0,Oe(q);else{var ne=r(u);ne!==null&&be(O,ne.startTime-ke)}}function q(ke,ne){y=!1,x&&(x=!1,A(F),F=-1),m=!0;var Ie=g;try{for(E(ne),p=r(l);p!==null&&(!(p.expirationTime>ne)||ke&&!D());){var je=p.callback;if(typeof je=="function"){p.callback=null,g=p.priorityLevel;var K=je(p.expirationTime<=ne);ne=t.unstable_now(),typeof K=="function"?p.callback=K:p===r(l)&&n(l),E(ne)}else n(l);p=r(l)}if(p!==null)var te=!0;else{var re=r(u);re!==null&&be(O,re.startTime-ne),te=!1}return te}finally{p=null,g=Ie,m=!1}}var H=!1,T=null,F=-1,w=5,N=-1;function D(){return!(t.unstable_now()-N<w)}function P(){if(T!==null){var ke=t.unstable_now();N=ke;var ne=!0;try{ne=T(!0,ke)}finally{ne?R():(H=!1,T=null)}}else H=!1}var R;if(typeof C=="function")R=function(){C(P)};else if(typeof MessageChannel<"u"){var qe=new MessageChannel,Se=qe.port2;qe.port1.onmessage=P,R=function(){Se.postMessage(null)}}else R=function(){S(P,0)};function Oe(ke){T=ke,H||(H=!0,R())}function be(ke,ne){F=S(function(){ke(t.unstable_now())},ne)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(ke){ke.callback=null},t.unstable_continueExecution=function(){y||m||(y=!0,Oe(q))},t.unstable_forceFrameRate=function(ke){0>ke||125<ke?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):w=0<ke?Math.floor(1e3/ke):5},t.unstable_getCurrentPriorityLevel=function(){return g},t.unstable_getFirstCallbackNode=function(){return r(l)},t.unstable_next=function(ke){switch(g){case 1:case 2:case 3:var ne=3;break;default:ne=g}var Ie=g;g=ne;try{return ke()}finally{g=Ie}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(ke,ne){switch(ke){case 1:case 2:case 3:case 4:case 5:break;default:ke=3}var Ie=g;g=ke;try{return ne()}finally{g=Ie}},t.unstable_scheduleCallback=function(ke,ne,Ie){var je=t.unstable_now();switch(typeof Ie=="object"&&Ie!==null?(Ie=Ie.delay,Ie=typeof Ie=="number"&&0<Ie?je+Ie:je):Ie=je,ke){case 1:var K=-1;break;case 2:K=250;break;case 5:K=1073741823;break;case 4:K=1e4;break;default:K=5e3}return K=Ie+K,ke={id:f++,callback:ne,priorityLevel:ke,startTime:Ie,expirationTime:K,sortIndex:-1},Ie>je?(ke.sortIndex=Ie,e(u,ke),r(l)===null&&ke===r(u)&&(x?(A(F),F=-1):x=!0,be(O,Ie-je))):(ke.sortIndex=K,e(l,ke),y||m||(y=!0,Oe(q))),ke},t.unstable_shouldYield=D,t.unstable_wrapCallback=function(ke){var ne=g;return function(){var Ie=g;g=ne;try{return ke.apply(this,arguments)}finally{g=Ie}}}})(NS);IS.exports=NS;var kb=IS.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Fb=ye,ds=kb;function Le(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var RS=new Set,Jd={};function uc(t,e){pu(t,e),pu(t+"Capture",e)}function pu(t,e){for(Jd[t]=e,t=0;t<e.length;t++)RS.add(e[t])}var ro=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),_m=Object.prototype.hasOwnProperty,bb=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Oy={},My={};function Ib(t){return _m.call(My,t)?!0:_m.call(Oy,t)?!1:bb.test(t)?My[t]=!0:(Oy[t]=!0,!1)}function Nb(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function Rb(t,e,r,n){if(e===null||typeof e>"u"||Nb(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Di(t,e,r,n,i,s,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=a}var ti={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){ti[t]=new Di(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];ti[e]=new Di(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){ti[t]=new Di(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){ti[t]=new Di(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){ti[t]=new Di(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){ti[t]=new Di(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){ti[t]=new Di(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){ti[t]=new Di(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){ti[t]=new Di(t,5,!1,t.toLowerCase(),null,!1,!1)});var qx=/[\-:]([a-z])/g;function Qx(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(qx,Qx);ti[e]=new Di(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(qx,Qx);ti[e]=new Di(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(qx,Qx);ti[e]=new Di(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){ti[t]=new Di(t,1,!1,t.toLowerCase(),null,!1,!1)});ti.xlinkHref=new Di("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){ti[t]=new Di(t,1,!1,t.toLowerCase(),null,!0,!0)});function Jx(t,e,r,n){var i=ti.hasOwnProperty(e)?ti[e]:null;(i!==null?i.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Rb(e,r,i,n)&&(r=null),n||i===null?Ib(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):i.mustUseProperty?t[i.propertyName]=r===null?i.type===3?!1:"":r:(e=i.attributeName,n=i.attributeNamespace,r===null?t.removeAttribute(e):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var ho=Fb.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,_0=Symbol.for("react.element"),Uc=Symbol.for("react.portal"),Vc=Symbol.for("react.fragment"),Zx=Symbol.for("react.strict_mode"),Em=Symbol.for("react.profiler"),DS=Symbol.for("react.provider"),PS=Symbol.for("react.context"),e1=Symbol.for("react.forward_ref"),Sm=Symbol.for("react.suspense"),wm=Symbol.for("react.suspense_list"),t1=Symbol.for("react.memo"),Bo=Symbol.for("react.lazy"),OS=Symbol.for("react.offscreen"),By=Symbol.iterator;function sd(t){return t===null||typeof t!="object"?null:(t=By&&t[By]||t["@@iterator"],typeof t=="function"?t:null)}var Qr=Object.assign,vg;function yd(t){if(vg===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);vg=e&&e[1]||""}return`
`+vg+t}var yg=!1;function _g(t,e){if(!t||yg)return"";yg=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var n=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){n=u}t.call(e.prototype)}else{try{throw Error()}catch(u){n=u}t()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=n.stack.split(`
`),a=i.length-1,o=s.length-1;1<=a&&0<=o&&i[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(i[a]!==s[o]){if(a!==1||o!==1)do if(a--,o--,0>o||i[a]!==s[o]){var l=`
`+i[a].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=a&&0<=o);break}}}finally{yg=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?yd(t):""}function Db(t){switch(t.tag){case 5:return yd(t.type);case 16:return yd("Lazy");case 13:return yd("Suspense");case 19:return yd("SuspenseList");case 0:case 2:case 15:return t=_g(t.type,!1),t;case 11:return t=_g(t.type.render,!1),t;case 1:return t=_g(t.type,!0),t;default:return""}}function Tm(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Vc:return"Fragment";case Uc:return"Portal";case Em:return"Profiler";case Zx:return"StrictMode";case Sm:return"Suspense";case wm:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case PS:return(t.displayName||"Context")+".Consumer";case DS:return(t._context.displayName||"Context")+".Provider";case e1:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case t1:return e=t.displayName||null,e!==null?e:Tm(t.type)||"Memo";case Bo:e=t._payload,t=t._init;try{return Tm(t(e))}catch{}}return null}function Pb(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Tm(e);case 8:return e===Zx?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function ul(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function MS(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Ob(t){var e=MS(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,s=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(a){n=""+a,s.call(this,a)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(a){n=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function E0(t){t._valueTracker||(t._valueTracker=Ob(t))}function BS(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=MS(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function kh(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Am(t,e){var r=e.checked;return Qr({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function jy(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=ul(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function jS(t,e){e=e.checked,e!=null&&Jx(t,"checked",e,!1)}function Cm(t,e){jS(t,e);var r=ul(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?km(t,e.type,r):e.hasOwnProperty("defaultValue")&&km(t,e.type,ul(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Ly(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function km(t,e,r){(e!=="number"||kh(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var _d=Array.isArray;function eu(t,e,r,n){if(t=t.options,e){e={};for(var i=0;i<r.length;i++)e["$"+r[i]]=!0;for(r=0;r<t.length;r++)i=e.hasOwnProperty("$"+t[r].value),t[r].selected!==i&&(t[r].selected=i),i&&n&&(t[r].defaultSelected=!0)}else{for(r=""+ul(r),e=null,i=0;i<t.length;i++){if(t[i].value===r){t[i].selected=!0,n&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function Fm(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Le(91));return Qr({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Uy(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(Le(92));if(_d(r)){if(1<r.length)throw Error(Le(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:ul(r)}}function LS(t,e){var r=ul(e.value),n=ul(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function Vy(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function US(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function bm(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?US(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var S0,VS=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,i){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(S0=S0||document.createElement("div"),S0.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=S0.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Zd(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var Id={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Mb=["Webkit","ms","Moz","O"];Object.keys(Id).forEach(function(t){Mb.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Id[e]=Id[t]})});function zS(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||Id.hasOwnProperty(t)&&Id[t]?(""+e).trim():e+"px"}function WS(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=zS(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,i):t[r]=i}}var Bb=Qr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Im(t,e){if(e){if(Bb[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Le(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Le(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Le(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Le(62))}}function Nm(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Rm=null;function r1(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Dm=null,tu=null,ru=null;function zy(t){if(t=Wf(t)){if(typeof Dm!="function")throw Error(Le(280));var e=t.stateNode;e&&(e=Rp(e),Dm(t.stateNode,t.type,e))}}function $S(t){tu?ru?ru.push(t):ru=[t]:tu=t}function HS(){if(tu){var t=tu,e=ru;if(ru=tu=null,zy(t),e)for(t=0;t<e.length;t++)zy(e[t])}}function GS(t,e){return t(e)}function KS(){}var Eg=!1;function YS(t,e,r){if(Eg)return t(e,r);Eg=!0;try{return GS(t,e,r)}finally{Eg=!1,(tu!==null||ru!==null)&&(KS(),HS())}}function ef(t,e){var r=t.stateNode;if(r===null)return null;var n=Rp(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(Le(231,e,typeof r));return r}var Pm=!1;if(ro)try{var ad={};Object.defineProperty(ad,"passive",{get:function(){Pm=!0}}),window.addEventListener("test",ad,ad),window.removeEventListener("test",ad,ad)}catch{Pm=!1}function jb(t,e,r,n,i,s,a,o,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(r,u)}catch(f){this.onError(f)}}var Nd=!1,Fh=null,bh=!1,Om=null,Lb={onError:function(t){Nd=!0,Fh=t}};function Ub(t,e,r,n,i,s,a,o,l){Nd=!1,Fh=null,jb.apply(Lb,arguments)}function Vb(t,e,r,n,i,s,a,o,l){if(Ub.apply(this,arguments),Nd){if(Nd){var u=Fh;Nd=!1,Fh=null}else throw Error(Le(198));bh||(bh=!0,Om=u)}}function dc(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function XS(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Wy(t){if(dc(t)!==t)throw Error(Le(188))}function zb(t){var e=t.alternate;if(!e){if(e=dc(t),e===null)throw Error(Le(188));return e!==t?null:t}for(var r=t,n=e;;){var i=r.return;if(i===null)break;var s=i.alternate;if(s===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return Wy(i),t;if(s===n)return Wy(i),e;s=s.sibling}throw Error(Le(188))}if(r.return!==n.return)r=i,n=s;else{for(var a=!1,o=i.child;o;){if(o===r){a=!0,r=i,n=s;break}if(o===n){a=!0,n=i,r=s;break}o=o.sibling}if(!a){for(o=s.child;o;){if(o===r){a=!0,r=s,n=i;break}if(o===n){a=!0,n=s,r=i;break}o=o.sibling}if(!a)throw Error(Le(189))}}if(r.alternate!==n)throw Error(Le(190))}if(r.tag!==3)throw Error(Le(188));return r.stateNode.current===r?t:e}function qS(t){return t=zb(t),t!==null?QS(t):null}function QS(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=QS(t);if(e!==null)return e;t=t.sibling}return null}var JS=ds.unstable_scheduleCallback,$y=ds.unstable_cancelCallback,Wb=ds.unstable_shouldYield,$b=ds.unstable_requestPaint,cn=ds.unstable_now,Hb=ds.unstable_getCurrentPriorityLevel,n1=ds.unstable_ImmediatePriority,ZS=ds.unstable_UserBlockingPriority,Ih=ds.unstable_NormalPriority,Gb=ds.unstable_LowPriority,ew=ds.unstable_IdlePriority,Fp=null,ka=null;function Kb(t){if(ka&&typeof ka.onCommitFiberRoot=="function")try{ka.onCommitFiberRoot(Fp,t,void 0,(t.current.flags&128)===128)}catch{}}var ta=Math.clz32?Math.clz32:qb,Yb=Math.log,Xb=Math.LN2;function qb(t){return t>>>=0,t===0?32:31-(Yb(t)/Xb|0)|0}var w0=64,T0=4194304;function Ed(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Nh(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,i=t.suspendedLanes,s=t.pingedLanes,a=r&268435455;if(a!==0){var o=a&~i;o!==0?n=Ed(o):(s&=a,s!==0&&(n=Ed(s)))}else a=r&~i,a!==0?n=Ed(a):s!==0&&(n=Ed(s));if(n===0)return 0;if(e!==0&&e!==n&&!(e&i)&&(i=n&-n,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-ta(e),i=1<<r,n|=t[r],e&=~i;return n}function Qb(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Jb(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var a=31-ta(s),o=1<<a,l=i[a];l===-1?(!(o&r)||o&n)&&(i[a]=Qb(o,e)):l<=e&&(t.expiredLanes|=o),s&=~o}}function Mm(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function tw(){var t=w0;return w0<<=1,!(w0&4194240)&&(w0=64),t}function Sg(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function Vf(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-ta(e),t[e]=r}function Zb(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var i=31-ta(r),s=1<<i;e[i]=0,n[i]=-1,t[i]=-1,r&=~s}}function i1(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-ta(r),i=1<<n;i&e|t[n]&e&&(t[n]|=e),r&=~i}}var gr=0;function rw(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var nw,s1,iw,sw,aw,Bm=!1,A0=[],Qo=null,Jo=null,Zo=null,tf=new Map,rf=new Map,Lo=[],eI="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Hy(t,e){switch(t){case"focusin":case"focusout":Qo=null;break;case"dragenter":case"dragleave":Jo=null;break;case"mouseover":case"mouseout":Zo=null;break;case"pointerover":case"pointerout":tf.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":rf.delete(e.pointerId)}}function od(t,e,r,n,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},e!==null&&(e=Wf(e),e!==null&&s1(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function tI(t,e,r,n,i){switch(e){case"focusin":return Qo=od(Qo,t,e,r,n,i),!0;case"dragenter":return Jo=od(Jo,t,e,r,n,i),!0;case"mouseover":return Zo=od(Zo,t,e,r,n,i),!0;case"pointerover":var s=i.pointerId;return tf.set(s,od(tf.get(s)||null,t,e,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,rf.set(s,od(rf.get(s)||null,t,e,r,n,i)),!0}return!1}function ow(t){var e=Ol(t.target);if(e!==null){var r=dc(e);if(r!==null){if(e=r.tag,e===13){if(e=XS(r),e!==null){t.blockedOn=e,aw(t.priority,function(){iw(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function lh(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=jm(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);Rm=n,r.target.dispatchEvent(n),Rm=null}else return e=Wf(r),e!==null&&s1(e),t.blockedOn=r,!1;e.shift()}return!0}function Gy(t,e,r){lh(t)&&r.delete(e)}function rI(){Bm=!1,Qo!==null&&lh(Qo)&&(Qo=null),Jo!==null&&lh(Jo)&&(Jo=null),Zo!==null&&lh(Zo)&&(Zo=null),tf.forEach(Gy),rf.forEach(Gy)}function ld(t,e){t.blockedOn===e&&(t.blockedOn=null,Bm||(Bm=!0,ds.unstable_scheduleCallback(ds.unstable_NormalPriority,rI)))}function nf(t){function e(i){return ld(i,t)}if(0<A0.length){ld(A0[0],t);for(var r=1;r<A0.length;r++){var n=A0[r];n.blockedOn===t&&(n.blockedOn=null)}}for(Qo!==null&&ld(Qo,t),Jo!==null&&ld(Jo,t),Zo!==null&&ld(Zo,t),tf.forEach(e),rf.forEach(e),r=0;r<Lo.length;r++)n=Lo[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<Lo.length&&(r=Lo[0],r.blockedOn===null);)ow(r),r.blockedOn===null&&Lo.shift()}var nu=ho.ReactCurrentBatchConfig,Rh=!0;function nI(t,e,r,n){var i=gr,s=nu.transition;nu.transition=null;try{gr=1,a1(t,e,r,n)}finally{gr=i,nu.transition=s}}function iI(t,e,r,n){var i=gr,s=nu.transition;nu.transition=null;try{gr=4,a1(t,e,r,n)}finally{gr=i,nu.transition=s}}function a1(t,e,r,n){if(Rh){var i=jm(t,e,r,n);if(i===null)Rg(t,e,n,Dh,r),Hy(t,n);else if(tI(i,t,e,r,n))n.stopPropagation();else if(Hy(t,n),e&4&&-1<eI.indexOf(t)){for(;i!==null;){var s=Wf(i);if(s!==null&&nw(s),s=jm(t,e,r,n),s===null&&Rg(t,e,n,Dh,r),s===i)break;i=s}i!==null&&n.stopPropagation()}else Rg(t,e,n,null,r)}}var Dh=null;function jm(t,e,r,n){if(Dh=null,t=r1(n),t=Ol(t),t!==null)if(e=dc(t),e===null)t=null;else if(r=e.tag,r===13){if(t=XS(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Dh=t,null}function lw(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Hb()){case n1:return 1;case ZS:return 4;case Ih:case Gb:return 16;case ew:return 536870912;default:return 16}default:return 16}}var Ho=null,o1=null,ch=null;function cw(){if(ch)return ch;var t,e=o1,r=e.length,n,i="value"in Ho?Ho.value:Ho.textContent,s=i.length;for(t=0;t<r&&e[t]===i[t];t++);var a=r-t;for(n=1;n<=a&&e[r-n]===i[s-n];n++);return ch=i.slice(t,1<n?1-n:void 0)}function uh(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function C0(){return!0}function Ky(){return!1}function ps(t){function e(r,n,i,s,a){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(r=t[o],this[o]=r?r(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?C0:Ky,this.isPropagationStopped=Ky,this}return Qr(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=C0)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=C0)},persist:function(){},isPersistent:C0}),e}var Pu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},l1=ps(Pu),zf=Qr({},Pu,{view:0,detail:0}),sI=ps(zf),wg,Tg,cd,bp=Qr({},zf,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:c1,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==cd&&(cd&&t.type==="mousemove"?(wg=t.screenX-cd.screenX,Tg=t.screenY-cd.screenY):Tg=wg=0,cd=t),wg)},movementY:function(t){return"movementY"in t?t.movementY:Tg}}),Yy=ps(bp),aI=Qr({},bp,{dataTransfer:0}),oI=ps(aI),lI=Qr({},zf,{relatedTarget:0}),Ag=ps(lI),cI=Qr({},Pu,{animationName:0,elapsedTime:0,pseudoElement:0}),uI=ps(cI),dI=Qr({},Pu,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),fI=ps(dI),hI=Qr({},Pu,{data:0}),Xy=ps(hI),pI={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},gI={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},mI={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function xI(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=mI[t])?!!e[t]:!1}function c1(){return xI}var vI=Qr({},zf,{key:function(t){if(t.key){var e=pI[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=uh(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?gI[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:c1,charCode:function(t){return t.type==="keypress"?uh(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?uh(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),yI=ps(vI),_I=Qr({},bp,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),qy=ps(_I),EI=Qr({},zf,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:c1}),SI=ps(EI),wI=Qr({},Pu,{propertyName:0,elapsedTime:0,pseudoElement:0}),TI=ps(wI),AI=Qr({},bp,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),CI=ps(AI),kI=[9,13,27,32],u1=ro&&"CompositionEvent"in window,Rd=null;ro&&"documentMode"in document&&(Rd=document.documentMode);var FI=ro&&"TextEvent"in window&&!Rd,uw=ro&&(!u1||Rd&&8<Rd&&11>=Rd),Qy=" ",Jy=!1;function dw(t,e){switch(t){case"keyup":return kI.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function fw(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var zc=!1;function bI(t,e){switch(t){case"compositionend":return fw(e);case"keypress":return e.which!==32?null:(Jy=!0,Qy);case"textInput":return t=e.data,t===Qy&&Jy?null:t;default:return null}}function II(t,e){if(zc)return t==="compositionend"||!u1&&dw(t,e)?(t=cw(),ch=o1=Ho=null,zc=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return uw&&e.locale!=="ko"?null:e.data;default:return null}}var NI={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Zy(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!NI[t.type]:e==="textarea"}function hw(t,e,r,n){$S(n),e=Ph(e,"onChange"),0<e.length&&(r=new l1("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var Dd=null,sf=null;function RI(t){Tw(t,0)}function Ip(t){var e=Hc(t);if(BS(e))return t}function DI(t,e){if(t==="change")return e}var pw=!1;if(ro){var Cg;if(ro){var kg="oninput"in document;if(!kg){var e2=document.createElement("div");e2.setAttribute("oninput","return;"),kg=typeof e2.oninput=="function"}Cg=kg}else Cg=!1;pw=Cg&&(!document.documentMode||9<document.documentMode)}function t2(){Dd&&(Dd.detachEvent("onpropertychange",gw),sf=Dd=null)}function gw(t){if(t.propertyName==="value"&&Ip(sf)){var e=[];hw(e,sf,t,r1(t)),YS(RI,e)}}function PI(t,e,r){t==="focusin"?(t2(),Dd=e,sf=r,Dd.attachEvent("onpropertychange",gw)):t==="focusout"&&t2()}function OI(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Ip(sf)}function MI(t,e){if(t==="click")return Ip(e)}function BI(t,e){if(t==="input"||t==="change")return Ip(e)}function jI(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var sa=typeof Object.is=="function"?Object.is:jI;function af(t,e){if(sa(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!_m.call(e,i)||!sa(t[i],e[i]))return!1}return!0}function r2(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function n2(t,e){var r=r2(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=r2(r)}}function mw(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?mw(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function xw(){for(var t=window,e=kh();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=kh(t.document)}return e}function d1(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function LI(t){var e=xw(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&mw(r.ownerDocument.documentElement,r)){if(n!==null&&d1(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=r.textContent.length,s=Math.min(n.start,i);n=n.end===void 0?s:Math.min(n.end,i),!t.extend&&s>n&&(i=n,n=s,s=i),i=n2(r,s);var a=n2(r,n);i&&a&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>n?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var UI=ro&&"documentMode"in document&&11>=document.documentMode,Wc=null,Lm=null,Pd=null,Um=!1;function i2(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Um||Wc==null||Wc!==kh(n)||(n=Wc,"selectionStart"in n&&d1(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Pd&&af(Pd,n)||(Pd=n,n=Ph(Lm,"onSelect"),0<n.length&&(e=new l1("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=Wc)))}function k0(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var $c={animationend:k0("Animation","AnimationEnd"),animationiteration:k0("Animation","AnimationIteration"),animationstart:k0("Animation","AnimationStart"),transitionend:k0("Transition","TransitionEnd")},Fg={},vw={};ro&&(vw=document.createElement("div").style,"AnimationEvent"in window||(delete $c.animationend.animation,delete $c.animationiteration.animation,delete $c.animationstart.animation),"TransitionEvent"in window||delete $c.transitionend.transition);function Np(t){if(Fg[t])return Fg[t];if(!$c[t])return t;var e=$c[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in vw)return Fg[t]=e[r];return t}var yw=Np("animationend"),_w=Np("animationiteration"),Ew=Np("animationstart"),Sw=Np("transitionend"),ww=new Map,s2="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function yl(t,e){ww.set(t,e),uc(e,[t])}for(var bg=0;bg<s2.length;bg++){var Ig=s2[bg],VI=Ig.toLowerCase(),zI=Ig[0].toUpperCase()+Ig.slice(1);yl(VI,"on"+zI)}yl(yw,"onAnimationEnd");yl(_w,"onAnimationIteration");yl(Ew,"onAnimationStart");yl("dblclick","onDoubleClick");yl("focusin","onFocus");yl("focusout","onBlur");yl(Sw,"onTransitionEnd");pu("onMouseEnter",["mouseout","mouseover"]);pu("onMouseLeave",["mouseout","mouseover"]);pu("onPointerEnter",["pointerout","pointerover"]);pu("onPointerLeave",["pointerout","pointerover"]);uc("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));uc("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));uc("onBeforeInput",["compositionend","keypress","textInput","paste"]);uc("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));uc("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));uc("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Sd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),WI=new Set("cancel close invalid load scroll toggle".split(" ").concat(Sd));function a2(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,Vb(n,e,void 0,t),t.currentTarget=null}function Tw(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],i=n.event;n=n.listeners;e:{var s=void 0;if(e)for(var a=n.length-1;0<=a;a--){var o=n[a],l=o.instance,u=o.currentTarget;if(o=o.listener,l!==s&&i.isPropagationStopped())break e;a2(i,o,u),s=l}else for(a=0;a<n.length;a++){if(o=n[a],l=o.instance,u=o.currentTarget,o=o.listener,l!==s&&i.isPropagationStopped())break e;a2(i,o,u),s=l}}}if(bh)throw t=Om,bh=!1,Om=null,t}function br(t,e){var r=e[Hm];r===void 0&&(r=e[Hm]=new Set);var n=t+"__bubble";r.has(n)||(Aw(e,t,2,!1),r.add(n))}function Ng(t,e,r){var n=0;e&&(n|=4),Aw(r,t,n,e)}var F0="_reactListening"+Math.random().toString(36).slice(2);function of(t){if(!t[F0]){t[F0]=!0,RS.forEach(function(r){r!=="selectionchange"&&(WI.has(r)||Ng(r,!1,t),Ng(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[F0]||(e[F0]=!0,Ng("selectionchange",!1,e))}}function Aw(t,e,r,n){switch(lw(e)){case 1:var i=nI;break;case 4:i=iI;break;default:i=a1}r=i.bind(null,e,r,t),i=void 0,!Pm||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),n?i!==void 0?t.addEventListener(e,r,{capture:!0,passive:i}):t.addEventListener(e,r,!0):i!==void 0?t.addEventListener(e,r,{passive:i}):t.addEventListener(e,r,!1)}function Rg(t,e,r,n,i){var s=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var a=n.tag;if(a===3||a===4){var o=n.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(a===4)for(a=n.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;a=a.return}for(;o!==null;){if(a=Ol(o),a===null)return;if(l=a.tag,l===5||l===6){n=s=a;continue e}o=o.parentNode}}n=n.return}YS(function(){var u=s,f=r1(r),p=[];e:{var g=ww.get(t);if(g!==void 0){var m=l1,y=t;switch(t){case"keypress":if(uh(r)===0)break e;case"keydown":case"keyup":m=yI;break;case"focusin":y="focus",m=Ag;break;case"focusout":y="blur",m=Ag;break;case"beforeblur":case"afterblur":m=Ag;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=Yy;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=oI;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=SI;break;case yw:case _w:case Ew:m=uI;break;case Sw:m=TI;break;case"scroll":m=sI;break;case"wheel":m=CI;break;case"copy":case"cut":case"paste":m=fI;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=qy}var x=(e&4)!==0,S=!x&&t==="scroll",A=x?g!==null?g+"Capture":null:g;x=[];for(var C=u,E;C!==null;){E=C;var O=E.stateNode;if(E.tag===5&&O!==null&&(E=O,A!==null&&(O=ef(C,A),O!=null&&x.push(lf(C,O,E)))),S)break;C=C.return}0<x.length&&(g=new m(g,y,null,r,f),p.push({event:g,listeners:x}))}}if(!(e&7)){e:{if(g=t==="mouseover"||t==="pointerover",m=t==="mouseout"||t==="pointerout",g&&r!==Rm&&(y=r.relatedTarget||r.fromElement)&&(Ol(y)||y[no]))break e;if((m||g)&&(g=f.window===f?f:(g=f.ownerDocument)?g.defaultView||g.parentWindow:window,m?(y=r.relatedTarget||r.toElement,m=u,y=y?Ol(y):null,y!==null&&(S=dc(y),y!==S||y.tag!==5&&y.tag!==6)&&(y=null)):(m=null,y=u),m!==y)){if(x=Yy,O="onMouseLeave",A="onMouseEnter",C="mouse",(t==="pointerout"||t==="pointerover")&&(x=qy,O="onPointerLeave",A="onPointerEnter",C="pointer"),S=m==null?g:Hc(m),E=y==null?g:Hc(y),g=new x(O,C+"leave",m,r,f),g.target=S,g.relatedTarget=E,O=null,Ol(f)===u&&(x=new x(A,C+"enter",y,r,f),x.target=E,x.relatedTarget=S,O=x),S=O,m&&y)t:{for(x=m,A=y,C=0,E=x;E;E=Ic(E))C++;for(E=0,O=A;O;O=Ic(O))E++;for(;0<C-E;)x=Ic(x),C--;for(;0<E-C;)A=Ic(A),E--;for(;C--;){if(x===A||A!==null&&x===A.alternate)break t;x=Ic(x),A=Ic(A)}x=null}else x=null;m!==null&&o2(p,g,m,x,!1),y!==null&&S!==null&&o2(p,S,y,x,!0)}}e:{if(g=u?Hc(u):window,m=g.nodeName&&g.nodeName.toLowerCase(),m==="select"||m==="input"&&g.type==="file")var q=DI;else if(Zy(g))if(pw)q=BI;else{q=OI;var H=PI}else(m=g.nodeName)&&m.toLowerCase()==="input"&&(g.type==="checkbox"||g.type==="radio")&&(q=MI);if(q&&(q=q(t,u))){hw(p,q,r,f);break e}H&&H(t,g,u),t==="focusout"&&(H=g._wrapperState)&&H.controlled&&g.type==="number"&&km(g,"number",g.value)}switch(H=u?Hc(u):window,t){case"focusin":(Zy(H)||H.contentEditable==="true")&&(Wc=H,Lm=u,Pd=null);break;case"focusout":Pd=Lm=Wc=null;break;case"mousedown":Um=!0;break;case"contextmenu":case"mouseup":case"dragend":Um=!1,i2(p,r,f);break;case"selectionchange":if(UI)break;case"keydown":case"keyup":i2(p,r,f)}var T;if(u1)e:{switch(t){case"compositionstart":var F="onCompositionStart";break e;case"compositionend":F="onCompositionEnd";break e;case"compositionupdate":F="onCompositionUpdate";break e}F=void 0}else zc?dw(t,r)&&(F="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(F="onCompositionStart");F&&(uw&&r.locale!=="ko"&&(zc||F!=="onCompositionStart"?F==="onCompositionEnd"&&zc&&(T=cw()):(Ho=f,o1="value"in Ho?Ho.value:Ho.textContent,zc=!0)),H=Ph(u,F),0<H.length&&(F=new Xy(F,t,null,r,f),p.push({event:F,listeners:H}),T?F.data=T:(T=fw(r),T!==null&&(F.data=T)))),(T=FI?bI(t,r):II(t,r))&&(u=Ph(u,"onBeforeInput"),0<u.length&&(f=new Xy("onBeforeInput","beforeinput",null,r,f),p.push({event:f,listeners:u}),f.data=T))}Tw(p,e)})}function lf(t,e,r){return{instance:t,listener:e,currentTarget:r}}function Ph(t,e){for(var r=e+"Capture",n=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=ef(t,r),s!=null&&n.unshift(lf(t,s,i)),s=ef(t,e),s!=null&&n.push(lf(t,s,i))),t=t.return}return n}function Ic(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function o2(t,e,r,n,i){for(var s=e._reactName,a=[];r!==null&&r!==n;){var o=r,l=o.alternate,u=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&u!==null&&(o=u,i?(l=ef(r,s),l!=null&&a.unshift(lf(r,l,o))):i||(l=ef(r,s),l!=null&&a.push(lf(r,l,o)))),r=r.return}a.length!==0&&t.push({event:e,listeners:a})}var $I=/\r\n?/g,HI=/\u0000|\uFFFD/g;function l2(t){return(typeof t=="string"?t:""+t).replace($I,`
`).replace(HI,"")}function b0(t,e,r){if(e=l2(e),l2(t)!==e&&r)throw Error(Le(425))}function Oh(){}var Vm=null,zm=null;function Wm(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var $m=typeof setTimeout=="function"?setTimeout:void 0,GI=typeof clearTimeout=="function"?clearTimeout:void 0,c2=typeof Promise=="function"?Promise:void 0,KI=typeof queueMicrotask=="function"?queueMicrotask:typeof c2<"u"?function(t){return c2.resolve(null).then(t).catch(YI)}:$m;function YI(t){setTimeout(function(){throw t})}function Dg(t,e){var r=e,n=0;do{var i=r.nextSibling;if(t.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){t.removeChild(i),nf(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);nf(e)}function el(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function u2(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var Ou=Math.random().toString(36).slice(2),Aa="__reactFiber$"+Ou,cf="__reactProps$"+Ou,no="__reactContainer$"+Ou,Hm="__reactEvents$"+Ou,XI="__reactListeners$"+Ou,qI="__reactHandles$"+Ou;function Ol(t){var e=t[Aa];if(e)return e;for(var r=t.parentNode;r;){if(e=r[no]||r[Aa]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=u2(t);t!==null;){if(r=t[Aa])return r;t=u2(t)}return e}t=r,r=t.parentNode}return null}function Wf(t){return t=t[Aa]||t[no],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Hc(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Le(33))}function Rp(t){return t[cf]||null}var Gm=[],Gc=-1;function _l(t){return{current:t}}function Nr(t){0>Gc||(t.current=Gm[Gc],Gm[Gc]=null,Gc--)}function Tr(t,e){Gc++,Gm[Gc]=t.current,t.current=e}var dl={},vi=_l(dl),Hi=_l(!1),Yl=dl;function gu(t,e){var r=t.type.contextTypes;if(!r)return dl;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in r)i[s]=e[s];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function Gi(t){return t=t.childContextTypes,t!=null}function Mh(){Nr(Hi),Nr(vi)}function d2(t,e,r){if(vi.current!==dl)throw Error(Le(168));Tr(vi,e),Tr(Hi,r)}function Cw(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in e))throw Error(Le(108,Pb(t)||"Unknown",i));return Qr({},r,n)}function Bh(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||dl,Yl=vi.current,Tr(vi,t),Tr(Hi,Hi.current),!0}function f2(t,e,r){var n=t.stateNode;if(!n)throw Error(Le(169));r?(t=Cw(t,e,Yl),n.__reactInternalMemoizedMergedChildContext=t,Nr(Hi),Nr(vi),Tr(vi,t)):Nr(Hi),Tr(Hi,r)}var $a=null,Dp=!1,Pg=!1;function kw(t){$a===null?$a=[t]:$a.push(t)}function QI(t){Dp=!0,kw(t)}function El(){if(!Pg&&$a!==null){Pg=!0;var t=0,e=gr;try{var r=$a;for(gr=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}$a=null,Dp=!1}catch(i){throw $a!==null&&($a=$a.slice(t+1)),JS(n1,El),i}finally{gr=e,Pg=!1}}return null}var Kc=[],Yc=0,jh=null,Lh=0,bs=[],Is=0,Xl=null,Ha=1,Ga="";function Il(t,e){Kc[Yc++]=Lh,Kc[Yc++]=jh,jh=t,Lh=e}function Fw(t,e,r){bs[Is++]=Ha,bs[Is++]=Ga,bs[Is++]=Xl,Xl=t;var n=Ha;t=Ga;var i=32-ta(n)-1;n&=~(1<<i),r+=1;var s=32-ta(e)+i;if(30<s){var a=i-i%5;s=(n&(1<<a)-1).toString(32),n>>=a,i-=a,Ha=1<<32-ta(e)+i|r<<i|n,Ga=s+t}else Ha=1<<s|r<<i|n,Ga=t}function f1(t){t.return!==null&&(Il(t,1),Fw(t,1,0))}function h1(t){for(;t===jh;)jh=Kc[--Yc],Kc[Yc]=null,Lh=Kc[--Yc],Kc[Yc]=null;for(;t===Xl;)Xl=bs[--Is],bs[Is]=null,Ga=bs[--Is],bs[Is]=null,Ha=bs[--Is],bs[Is]=null}var cs=null,ls=null,Ur=!1,Qs=null;function bw(t,e){var r=Rs(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function h2(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,cs=t,ls=el(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,cs=t,ls=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=Xl!==null?{id:Ha,overflow:Ga}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=Rs(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,cs=t,ls=null,!0):!1;default:return!1}}function Km(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Ym(t){if(Ur){var e=ls;if(e){var r=e;if(!h2(t,e)){if(Km(t))throw Error(Le(418));e=el(r.nextSibling);var n=cs;e&&h2(t,e)?bw(n,r):(t.flags=t.flags&-4097|2,Ur=!1,cs=t)}}else{if(Km(t))throw Error(Le(418));t.flags=t.flags&-4097|2,Ur=!1,cs=t}}}function p2(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;cs=t}function I0(t){if(t!==cs)return!1;if(!Ur)return p2(t),Ur=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Wm(t.type,t.memoizedProps)),e&&(e=ls)){if(Km(t))throw Iw(),Error(Le(418));for(;e;)bw(t,e),e=el(e.nextSibling)}if(p2(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Le(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){ls=el(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}ls=null}}else ls=cs?el(t.stateNode.nextSibling):null;return!0}function Iw(){for(var t=ls;t;)t=el(t.nextSibling)}function mu(){ls=cs=null,Ur=!1}function p1(t){Qs===null?Qs=[t]:Qs.push(t)}var JI=ho.ReactCurrentBatchConfig;function ud(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Le(309));var n=r.stateNode}if(!n)throw Error(Le(147,t));var i=n,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(a){var o=i.refs;a===null?delete o[s]:o[s]=a},e._stringRef=s,e)}if(typeof t!="string")throw Error(Le(284));if(!r._owner)throw Error(Le(290,t))}return t}function N0(t,e){throw t=Object.prototype.toString.call(e),Error(Le(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function g2(t){var e=t._init;return e(t._payload)}function Nw(t){function e(A,C){if(t){var E=A.deletions;E===null?(A.deletions=[C],A.flags|=16):E.push(C)}}function r(A,C){if(!t)return null;for(;C!==null;)e(A,C),C=C.sibling;return null}function n(A,C){for(A=new Map;C!==null;)C.key!==null?A.set(C.key,C):A.set(C.index,C),C=C.sibling;return A}function i(A,C){return A=il(A,C),A.index=0,A.sibling=null,A}function s(A,C,E){return A.index=E,t?(E=A.alternate,E!==null?(E=E.index,E<C?(A.flags|=2,C):E):(A.flags|=2,C)):(A.flags|=1048576,C)}function a(A){return t&&A.alternate===null&&(A.flags|=2),A}function o(A,C,E,O){return C===null||C.tag!==6?(C=Vg(E,A.mode,O),C.return=A,C):(C=i(C,E),C.return=A,C)}function l(A,C,E,O){var q=E.type;return q===Vc?f(A,C,E.props.children,O,E.key):C!==null&&(C.elementType===q||typeof q=="object"&&q!==null&&q.$$typeof===Bo&&g2(q)===C.type)?(O=i(C,E.props),O.ref=ud(A,C,E),O.return=A,O):(O=xh(E.type,E.key,E.props,null,A.mode,O),O.ref=ud(A,C,E),O.return=A,O)}function u(A,C,E,O){return C===null||C.tag!==4||C.stateNode.containerInfo!==E.containerInfo||C.stateNode.implementation!==E.implementation?(C=zg(E,A.mode,O),C.return=A,C):(C=i(C,E.children||[]),C.return=A,C)}function f(A,C,E,O,q){return C===null||C.tag!==7?(C=Vl(E,A.mode,O,q),C.return=A,C):(C=i(C,E),C.return=A,C)}function p(A,C,E){if(typeof C=="string"&&C!==""||typeof C=="number")return C=Vg(""+C,A.mode,E),C.return=A,C;if(typeof C=="object"&&C!==null){switch(C.$$typeof){case _0:return E=xh(C.type,C.key,C.props,null,A.mode,E),E.ref=ud(A,null,C),E.return=A,E;case Uc:return C=zg(C,A.mode,E),C.return=A,C;case Bo:var O=C._init;return p(A,O(C._payload),E)}if(_d(C)||sd(C))return C=Vl(C,A.mode,E,null),C.return=A,C;N0(A,C)}return null}function g(A,C,E,O){var q=C!==null?C.key:null;if(typeof E=="string"&&E!==""||typeof E=="number")return q!==null?null:o(A,C,""+E,O);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case _0:return E.key===q?l(A,C,E,O):null;case Uc:return E.key===q?u(A,C,E,O):null;case Bo:return q=E._init,g(A,C,q(E._payload),O)}if(_d(E)||sd(E))return q!==null?null:f(A,C,E,O,null);N0(A,E)}return null}function m(A,C,E,O,q){if(typeof O=="string"&&O!==""||typeof O=="number")return A=A.get(E)||null,o(C,A,""+O,q);if(typeof O=="object"&&O!==null){switch(O.$$typeof){case _0:return A=A.get(O.key===null?E:O.key)||null,l(C,A,O,q);case Uc:return A=A.get(O.key===null?E:O.key)||null,u(C,A,O,q);case Bo:var H=O._init;return m(A,C,E,H(O._payload),q)}if(_d(O)||sd(O))return A=A.get(E)||null,f(C,A,O,q,null);N0(C,O)}return null}function y(A,C,E,O){for(var q=null,H=null,T=C,F=C=0,w=null;T!==null&&F<E.length;F++){T.index>F?(w=T,T=null):w=T.sibling;var N=g(A,T,E[F],O);if(N===null){T===null&&(T=w);break}t&&T&&N.alternate===null&&e(A,T),C=s(N,C,F),H===null?q=N:H.sibling=N,H=N,T=w}if(F===E.length)return r(A,T),Ur&&Il(A,F),q;if(T===null){for(;F<E.length;F++)T=p(A,E[F],O),T!==null&&(C=s(T,C,F),H===null?q=T:H.sibling=T,H=T);return Ur&&Il(A,F),q}for(T=n(A,T);F<E.length;F++)w=m(T,A,F,E[F],O),w!==null&&(t&&w.alternate!==null&&T.delete(w.key===null?F:w.key),C=s(w,C,F),H===null?q=w:H.sibling=w,H=w);return t&&T.forEach(function(D){return e(A,D)}),Ur&&Il(A,F),q}function x(A,C,E,O){var q=sd(E);if(typeof q!="function")throw Error(Le(150));if(E=q.call(E),E==null)throw Error(Le(151));for(var H=q=null,T=C,F=C=0,w=null,N=E.next();T!==null&&!N.done;F++,N=E.next()){T.index>F?(w=T,T=null):w=T.sibling;var D=g(A,T,N.value,O);if(D===null){T===null&&(T=w);break}t&&T&&D.alternate===null&&e(A,T),C=s(D,C,F),H===null?q=D:H.sibling=D,H=D,T=w}if(N.done)return r(A,T),Ur&&Il(A,F),q;if(T===null){for(;!N.done;F++,N=E.next())N=p(A,N.value,O),N!==null&&(C=s(N,C,F),H===null?q=N:H.sibling=N,H=N);return Ur&&Il(A,F),q}for(T=n(A,T);!N.done;F++,N=E.next())N=m(T,A,F,N.value,O),N!==null&&(t&&N.alternate!==null&&T.delete(N.key===null?F:N.key),C=s(N,C,F),H===null?q=N:H.sibling=N,H=N);return t&&T.forEach(function(P){return e(A,P)}),Ur&&Il(A,F),q}function S(A,C,E,O){if(typeof E=="object"&&E!==null&&E.type===Vc&&E.key===null&&(E=E.props.children),typeof E=="object"&&E!==null){switch(E.$$typeof){case _0:e:{for(var q=E.key,H=C;H!==null;){if(H.key===q){if(q=E.type,q===Vc){if(H.tag===7){r(A,H.sibling),C=i(H,E.props.children),C.return=A,A=C;break e}}else if(H.elementType===q||typeof q=="object"&&q!==null&&q.$$typeof===Bo&&g2(q)===H.type){r(A,H.sibling),C=i(H,E.props),C.ref=ud(A,H,E),C.return=A,A=C;break e}r(A,H);break}else e(A,H);H=H.sibling}E.type===Vc?(C=Vl(E.props.children,A.mode,O,E.key),C.return=A,A=C):(O=xh(E.type,E.key,E.props,null,A.mode,O),O.ref=ud(A,C,E),O.return=A,A=O)}return a(A);case Uc:e:{for(H=E.key;C!==null;){if(C.key===H)if(C.tag===4&&C.stateNode.containerInfo===E.containerInfo&&C.stateNode.implementation===E.implementation){r(A,C.sibling),C=i(C,E.children||[]),C.return=A,A=C;break e}else{r(A,C);break}else e(A,C);C=C.sibling}C=zg(E,A.mode,O),C.return=A,A=C}return a(A);case Bo:return H=E._init,S(A,C,H(E._payload),O)}if(_d(E))return y(A,C,E,O);if(sd(E))return x(A,C,E,O);N0(A,E)}return typeof E=="string"&&E!==""||typeof E=="number"?(E=""+E,C!==null&&C.tag===6?(r(A,C.sibling),C=i(C,E),C.return=A,A=C):(r(A,C),C=Vg(E,A.mode,O),C.return=A,A=C),a(A)):r(A,C)}return S}var xu=Nw(!0),Rw=Nw(!1),Uh=_l(null),Vh=null,Xc=null,g1=null;function m1(){g1=Xc=Vh=null}function x1(t){var e=Uh.current;Nr(Uh),t._currentValue=e}function Xm(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function iu(t,e){Vh=t,g1=Xc=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&($i=!0),t.firstContext=null)}function Os(t){var e=t._currentValue;if(g1!==t)if(t={context:t,memoizedValue:e,next:null},Xc===null){if(Vh===null)throw Error(Le(308));Xc=t,Vh.dependencies={lanes:0,firstContext:t}}else Xc=Xc.next=t;return e}var Ml=null;function v1(t){Ml===null?Ml=[t]:Ml.push(t)}function Dw(t,e,r,n){var i=e.interleaved;return i===null?(r.next=r,v1(e)):(r.next=i.next,i.next=r),e.interleaved=r,io(t,n)}function io(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var jo=!1;function y1(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Pw(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Qa(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function tl(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,tr&2){var i=n.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),n.pending=e,io(t,r)}return i=n.interleaved,i===null?(e.next=e,v1(n)):(e.next=i.next,i.next=e),n.interleaved=e,io(t,r)}function dh(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,i1(t,r)}}function m2(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?i=s=a:s=s.next=a,r=r.next}while(r!==null);s===null?i=s=e:s=s.next=e}else i=s=e;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function zh(t,e,r,n){var i=t.updateQueue;jo=!1;var s=i.firstBaseUpdate,a=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var l=o,u=l.next;l.next=null,a===null?s=u:a.next=u,a=l;var f=t.alternate;f!==null&&(f=f.updateQueue,o=f.lastBaseUpdate,o!==a&&(o===null?f.firstBaseUpdate=u:o.next=u,f.lastBaseUpdate=l))}if(s!==null){var p=i.baseState;a=0,f=u=l=null,o=s;do{var g=o.lane,m=o.eventTime;if((n&g)===g){f!==null&&(f=f.next={eventTime:m,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var y=t,x=o;switch(g=e,m=r,x.tag){case 1:if(y=x.payload,typeof y=="function"){p=y.call(m,p,g);break e}p=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=x.payload,g=typeof y=="function"?y.call(m,p,g):y,g==null)break e;p=Qr({},p,g);break e;case 2:jo=!0}}o.callback!==null&&o.lane!==0&&(t.flags|=64,g=i.effects,g===null?i.effects=[o]:g.push(o))}else m={eventTime:m,lane:g,tag:o.tag,payload:o.payload,callback:o.callback,next:null},f===null?(u=f=m,l=p):f=f.next=m,a|=g;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;g=o,o=g.next,g.next=null,i.lastBaseUpdate=g,i.shared.pending=null}}while(!0);if(f===null&&(l=p),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=f,e=i.shared.interleaved,e!==null){i=e;do a|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);Ql|=a,t.lanes=a,t.memoizedState=p}}function x2(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(Le(191,i));i.call(n)}}}var $f={},Fa=_l($f),uf=_l($f),df=_l($f);function Bl(t){if(t===$f)throw Error(Le(174));return t}function _1(t,e){switch(Tr(df,e),Tr(uf,t),Tr(Fa,$f),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:bm(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=bm(e,t)}Nr(Fa),Tr(Fa,e)}function vu(){Nr(Fa),Nr(uf),Nr(df)}function Ow(t){Bl(df.current);var e=Bl(Fa.current),r=bm(e,t.type);e!==r&&(Tr(uf,t),Tr(Fa,r))}function E1(t){uf.current===t&&(Nr(Fa),Nr(uf))}var Kr=_l(0);function Wh(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Og=[];function S1(){for(var t=0;t<Og.length;t++)Og[t]._workInProgressVersionPrimary=null;Og.length=0}var fh=ho.ReactCurrentDispatcher,Mg=ho.ReactCurrentBatchConfig,ql=0,qr=null,Cn=null,jn=null,$h=!1,Od=!1,ff=0,ZI=0;function ai(){throw Error(Le(321))}function w1(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!sa(t[r],e[r]))return!1;return!0}function T1(t,e,r,n,i,s){if(ql=s,qr=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,fh.current=t===null||t.memoizedState===null?nN:iN,t=r(n,i),Od){s=0;do{if(Od=!1,ff=0,25<=s)throw Error(Le(301));s+=1,jn=Cn=null,e.updateQueue=null,fh.current=sN,t=r(n,i)}while(Od)}if(fh.current=Hh,e=Cn!==null&&Cn.next!==null,ql=0,jn=Cn=qr=null,$h=!1,e)throw Error(Le(300));return t}function A1(){var t=ff!==0;return ff=0,t}function Ta(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return jn===null?qr.memoizedState=jn=t:jn=jn.next=t,jn}function Ms(){if(Cn===null){var t=qr.alternate;t=t!==null?t.memoizedState:null}else t=Cn.next;var e=jn===null?qr.memoizedState:jn.next;if(e!==null)jn=e,Cn=t;else{if(t===null)throw Error(Le(310));Cn=t,t={memoizedState:Cn.memoizedState,baseState:Cn.baseState,baseQueue:Cn.baseQueue,queue:Cn.queue,next:null},jn===null?qr.memoizedState=jn=t:jn=jn.next=t}return jn}function hf(t,e){return typeof e=="function"?e(t):e}function Bg(t){var e=Ms(),r=e.queue;if(r===null)throw Error(Le(311));r.lastRenderedReducer=t;var n=Cn,i=n.baseQueue,s=r.pending;if(s!==null){if(i!==null){var a=i.next;i.next=s.next,s.next=a}n.baseQueue=i=s,r.pending=null}if(i!==null){s=i.next,n=n.baseState;var o=a=null,l=null,u=s;do{var f=u.lane;if((ql&f)===f)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:t(n,u.action);else{var p={lane:f,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(o=l=p,a=n):l=l.next=p,qr.lanes|=f,Ql|=f}u=u.next}while(u!==null&&u!==s);l===null?a=n:l.next=o,sa(n,e.memoizedState)||($i=!0),e.memoizedState=n,e.baseState=a,e.baseQueue=l,r.lastRenderedState=n}if(t=r.interleaved,t!==null){i=t;do s=i.lane,qr.lanes|=s,Ql|=s,i=i.next;while(i!==t)}else i===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function jg(t){var e=Ms(),r=e.queue;if(r===null)throw Error(Le(311));r.lastRenderedReducer=t;var n=r.dispatch,i=r.pending,s=e.memoizedState;if(i!==null){r.pending=null;var a=i=i.next;do s=t(s,a.action),a=a.next;while(a!==i);sa(s,e.memoizedState)||($i=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),r.lastRenderedState=s}return[s,n]}function Mw(){}function Bw(t,e){var r=qr,n=Ms(),i=e(),s=!sa(n.memoizedState,i);if(s&&(n.memoizedState=i,$i=!0),n=n.queue,C1(Uw.bind(null,r,n,t),[t]),n.getSnapshot!==e||s||jn!==null&&jn.memoizedState.tag&1){if(r.flags|=2048,pf(9,Lw.bind(null,r,n,i,e),void 0,null),Vn===null)throw Error(Le(349));ql&30||jw(r,e,i)}return i}function jw(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=qr.updateQueue,e===null?(e={lastEffect:null,stores:null},qr.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function Lw(t,e,r,n){e.value=r,e.getSnapshot=n,Vw(e)&&zw(t)}function Uw(t,e,r){return r(function(){Vw(e)&&zw(t)})}function Vw(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!sa(t,r)}catch{return!0}}function zw(t){var e=io(t,1);e!==null&&ra(e,t,1,-1)}function v2(t){var e=Ta();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:hf,lastRenderedState:t},e.queue=t,t=t.dispatch=rN.bind(null,qr,t),[e.memoizedState,t]}function pf(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=qr.updateQueue,e===null?(e={lastEffect:null,stores:null},qr.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function Ww(){return Ms().memoizedState}function hh(t,e,r,n){var i=Ta();qr.flags|=t,i.memoizedState=pf(1|e,r,void 0,n===void 0?null:n)}function Pp(t,e,r,n){var i=Ms();n=n===void 0?null:n;var s=void 0;if(Cn!==null){var a=Cn.memoizedState;if(s=a.destroy,n!==null&&w1(n,a.deps)){i.memoizedState=pf(e,r,s,n);return}}qr.flags|=t,i.memoizedState=pf(1|e,r,s,n)}function y2(t,e){return hh(8390656,8,t,e)}function C1(t,e){return Pp(2048,8,t,e)}function $w(t,e){return Pp(4,2,t,e)}function Hw(t,e){return Pp(4,4,t,e)}function Gw(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Kw(t,e,r){return r=r!=null?r.concat([t]):null,Pp(4,4,Gw.bind(null,e,t),r)}function k1(){}function Yw(t,e){var r=Ms();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&w1(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function Xw(t,e){var r=Ms();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&w1(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function qw(t,e,r){return ql&21?(sa(r,e)||(r=tw(),qr.lanes|=r,Ql|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,$i=!0),t.memoizedState=r)}function eN(t,e){var r=gr;gr=r!==0&&4>r?r:4,t(!0);var n=Mg.transition;Mg.transition={};try{t(!1),e()}finally{gr=r,Mg.transition=n}}function Qw(){return Ms().memoizedState}function tN(t,e,r){var n=nl(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},Jw(t))Zw(e,r);else if(r=Dw(t,e,r,n),r!==null){var i=Ii();ra(r,t,n,i),eT(r,e,n)}}function rN(t,e,r){var n=nl(t),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(Jw(t))Zw(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var a=e.lastRenderedState,o=s(a,r);if(i.hasEagerState=!0,i.eagerState=o,sa(o,a)){var l=e.interleaved;l===null?(i.next=i,v1(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}r=Dw(t,e,i,n),r!==null&&(i=Ii(),ra(r,t,n,i),eT(r,e,n))}}function Jw(t){var e=t.alternate;return t===qr||e!==null&&e===qr}function Zw(t,e){Od=$h=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function eT(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,i1(t,r)}}var Hh={readContext:Os,useCallback:ai,useContext:ai,useEffect:ai,useImperativeHandle:ai,useInsertionEffect:ai,useLayoutEffect:ai,useMemo:ai,useReducer:ai,useRef:ai,useState:ai,useDebugValue:ai,useDeferredValue:ai,useTransition:ai,useMutableSource:ai,useSyncExternalStore:ai,useId:ai,unstable_isNewReconciler:!1},nN={readContext:Os,useCallback:function(t,e){return Ta().memoizedState=[t,e===void 0?null:e],t},useContext:Os,useEffect:y2,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,hh(4194308,4,Gw.bind(null,e,t),r)},useLayoutEffect:function(t,e){return hh(4194308,4,t,e)},useInsertionEffect:function(t,e){return hh(4,2,t,e)},useMemo:function(t,e){var r=Ta();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=Ta();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=tN.bind(null,qr,t),[n.memoizedState,t]},useRef:function(t){var e=Ta();return t={current:t},e.memoizedState=t},useState:v2,useDebugValue:k1,useDeferredValue:function(t){return Ta().memoizedState=t},useTransition:function(){var t=v2(!1),e=t[0];return t=eN.bind(null,t[1]),Ta().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=qr,i=Ta();if(Ur){if(r===void 0)throw Error(Le(407));r=r()}else{if(r=e(),Vn===null)throw Error(Le(349));ql&30||jw(n,e,r)}i.memoizedState=r;var s={value:r,getSnapshot:e};return i.queue=s,y2(Uw.bind(null,n,s,t),[t]),n.flags|=2048,pf(9,Lw.bind(null,n,s,r,e),void 0,null),r},useId:function(){var t=Ta(),e=Vn.identifierPrefix;if(Ur){var r=Ga,n=Ha;r=(n&~(1<<32-ta(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=ff++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=ZI++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},iN={readContext:Os,useCallback:Yw,useContext:Os,useEffect:C1,useImperativeHandle:Kw,useInsertionEffect:$w,useLayoutEffect:Hw,useMemo:Xw,useReducer:Bg,useRef:Ww,useState:function(){return Bg(hf)},useDebugValue:k1,useDeferredValue:function(t){var e=Ms();return qw(e,Cn.memoizedState,t)},useTransition:function(){var t=Bg(hf)[0],e=Ms().memoizedState;return[t,e]},useMutableSource:Mw,useSyncExternalStore:Bw,useId:Qw,unstable_isNewReconciler:!1},sN={readContext:Os,useCallback:Yw,useContext:Os,useEffect:C1,useImperativeHandle:Kw,useInsertionEffect:$w,useLayoutEffect:Hw,useMemo:Xw,useReducer:jg,useRef:Ww,useState:function(){return jg(hf)},useDebugValue:k1,useDeferredValue:function(t){var e=Ms();return Cn===null?e.memoizedState=t:qw(e,Cn.memoizedState,t)},useTransition:function(){var t=jg(hf)[0],e=Ms().memoizedState;return[t,e]},useMutableSource:Mw,useSyncExternalStore:Bw,useId:Qw,unstable_isNewReconciler:!1};function Xs(t,e){if(t&&t.defaultProps){e=Qr({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function qm(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:Qr({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var Op={isMounted:function(t){return(t=t._reactInternals)?dc(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=Ii(),i=nl(t),s=Qa(n,i);s.payload=e,r!=null&&(s.callback=r),e=tl(t,s,i),e!==null&&(ra(e,t,i,n),dh(e,t,i))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=Ii(),i=nl(t),s=Qa(n,i);s.tag=1,s.payload=e,r!=null&&(s.callback=r),e=tl(t,s,i),e!==null&&(ra(e,t,i,n),dh(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=Ii(),n=nl(t),i=Qa(r,n);i.tag=2,e!=null&&(i.callback=e),e=tl(t,i,n),e!==null&&(ra(e,t,n,r),dh(e,t,n))}};function _2(t,e,r,n,i,s,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,s,a):e.prototype&&e.prototype.isPureReactComponent?!af(r,n)||!af(i,s):!0}function tT(t,e,r){var n=!1,i=dl,s=e.contextType;return typeof s=="object"&&s!==null?s=Os(s):(i=Gi(e)?Yl:vi.current,n=e.contextTypes,s=(n=n!=null)?gu(t,i):dl),e=new e(r,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Op,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function E2(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&Op.enqueueReplaceState(e,e.state,null)}function Qm(t,e,r,n){var i=t.stateNode;i.props=r,i.state=t.memoizedState,i.refs={},y1(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=Os(s):(s=Gi(e)?Yl:vi.current,i.context=gu(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(qm(t,e,s,r),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Op.enqueueReplaceState(i,i.state,null),zh(t,r,i,n),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function yu(t,e){try{var r="",n=e;do r+=Db(n),n=n.return;while(n);var i=r}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function Lg(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function Jm(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var aN=typeof WeakMap=="function"?WeakMap:Map;function rT(t,e,r){r=Qa(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){Kh||(Kh=!0,lx=n),Jm(t,e)},r}function nT(t,e,r){r=Qa(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var i=e.value;r.payload=function(){return n(i)},r.callback=function(){Jm(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){Jm(t,e),typeof n!="function"&&(rl===null?rl=new Set([this]):rl.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),r}function S2(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new aN;var i=new Set;n.set(e,i)}else i=n.get(e),i===void 0&&(i=new Set,n.set(e,i));i.has(r)||(i.add(r),t=_N.bind(null,t,e,r),e.then(t,t))}function w2(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function T2(t,e,r,n,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=Qa(-1,1),e.tag=2,tl(r,e,1))),r.lanes|=1),t)}var oN=ho.ReactCurrentOwner,$i=!1;function ki(t,e,r,n){e.child=t===null?Rw(e,null,r,n):xu(e,t.child,r,n)}function A2(t,e,r,n,i){r=r.render;var s=e.ref;return iu(e,i),n=T1(t,e,r,n,s,i),r=A1(),t!==null&&!$i?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,so(t,e,i)):(Ur&&r&&f1(e),e.flags|=1,ki(t,e,n,i),e.child)}function C2(t,e,r,n,i){if(t===null){var s=r.type;return typeof s=="function"&&!O1(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=s,iT(t,e,s,n,i)):(t=xh(r.type,null,n,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var a=s.memoizedProps;if(r=r.compare,r=r!==null?r:af,r(a,n)&&t.ref===e.ref)return so(t,e,i)}return e.flags|=1,t=il(s,n),t.ref=e.ref,t.return=e,e.child=t}function iT(t,e,r,n,i){if(t!==null){var s=t.memoizedProps;if(af(s,n)&&t.ref===e.ref)if($i=!1,e.pendingProps=n=s,(t.lanes&i)!==0)t.flags&131072&&($i=!0);else return e.lanes=t.lanes,so(t,e,i)}return Zm(t,e,r,n,i)}function sT(t,e,r){var n=e.pendingProps,i=n.children,s=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Tr(Qc,ns),ns|=r;else{if(!(r&1073741824))return t=s!==null?s.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Tr(Qc,ns),ns|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,Tr(Qc,ns),ns|=n}else s!==null?(n=s.baseLanes|r,e.memoizedState=null):n=r,Tr(Qc,ns),ns|=n;return ki(t,e,i,r),e.child}function aT(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function Zm(t,e,r,n,i){var s=Gi(r)?Yl:vi.current;return s=gu(e,s),iu(e,i),r=T1(t,e,r,n,s,i),n=A1(),t!==null&&!$i?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,so(t,e,i)):(Ur&&n&&f1(e),e.flags|=1,ki(t,e,r,i),e.child)}function k2(t,e,r,n,i){if(Gi(r)){var s=!0;Bh(e)}else s=!1;if(iu(e,i),e.stateNode===null)ph(t,e),tT(e,r,n),Qm(e,r,n,i),n=!0;else if(t===null){var a=e.stateNode,o=e.memoizedProps;a.props=o;var l=a.context,u=r.contextType;typeof u=="object"&&u!==null?u=Os(u):(u=Gi(r)?Yl:vi.current,u=gu(e,u));var f=r.getDerivedStateFromProps,p=typeof f=="function"||typeof a.getSnapshotBeforeUpdate=="function";p||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==n||l!==u)&&E2(e,a,n,u),jo=!1;var g=e.memoizedState;a.state=g,zh(e,n,a,i),l=e.memoizedState,o!==n||g!==l||Hi.current||jo?(typeof f=="function"&&(qm(e,r,f,n),l=e.memoizedState),(o=jo||_2(e,r,o,n,g,l,u))?(p||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=l),a.props=n,a.state=l,a.context=u,n=o):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{a=e.stateNode,Pw(t,e),o=e.memoizedProps,u=e.type===e.elementType?o:Xs(e.type,o),a.props=u,p=e.pendingProps,g=a.context,l=r.contextType,typeof l=="object"&&l!==null?l=Os(l):(l=Gi(r)?Yl:vi.current,l=gu(e,l));var m=r.getDerivedStateFromProps;(f=typeof m=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==p||g!==l)&&E2(e,a,n,l),jo=!1,g=e.memoizedState,a.state=g,zh(e,n,a,i);var y=e.memoizedState;o!==p||g!==y||Hi.current||jo?(typeof m=="function"&&(qm(e,r,m,n),y=e.memoizedState),(u=jo||_2(e,r,u,n,g,y,l)||!1)?(f||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(n,y,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(n,y,l)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=y),a.props=n,a.state=y,a.context=l,n=u):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),n=!1)}return ex(t,e,r,n,s,i)}function ex(t,e,r,n,i,s){aT(t,e);var a=(e.flags&128)!==0;if(!n&&!a)return i&&f2(e,r,!1),so(t,e,s);n=e.stateNode,oN.current=e;var o=a&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&a?(e.child=xu(e,t.child,null,s),e.child=xu(e,null,o,s)):ki(t,e,o,s),e.memoizedState=n.state,i&&f2(e,r,!0),e.child}function oT(t){var e=t.stateNode;e.pendingContext?d2(t,e.pendingContext,e.pendingContext!==e.context):e.context&&d2(t,e.context,!1),_1(t,e.containerInfo)}function F2(t,e,r,n,i){return mu(),p1(i),e.flags|=256,ki(t,e,r,n),e.child}var tx={dehydrated:null,treeContext:null,retryLane:0};function rx(t){return{baseLanes:t,cachePool:null,transitions:null}}function lT(t,e,r){var n=e.pendingProps,i=Kr.current,s=!1,a=(e.flags&128)!==0,o;if((o=a)||(o=t!==null&&t.memoizedState===null?!1:(i&2)!==0),o?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),Tr(Kr,i&1),t===null)return Ym(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=n.children,t=n.fallback,s?(n=e.mode,s=e.child,a={mode:"hidden",children:a},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=jp(a,n,0,null),t=Vl(t,n,r,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=rx(r),e.memoizedState=tx,t):F1(e,a));if(i=t.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return lN(t,e,a,n,o,i,r);if(s){s=n.fallback,a=e.mode,i=t.child,o=i.sibling;var l={mode:"hidden",children:n.children};return!(a&1)&&e.child!==i?(n=e.child,n.childLanes=0,n.pendingProps=l,e.deletions=null):(n=il(i,l),n.subtreeFlags=i.subtreeFlags&14680064),o!==null?s=il(o,s):(s=Vl(s,a,r,null),s.flags|=2),s.return=e,n.return=e,n.sibling=s,e.child=n,n=s,s=e.child,a=t.child.memoizedState,a=a===null?rx(r):{baseLanes:a.baseLanes|r,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=t.childLanes&~r,e.memoizedState=tx,n}return s=t.child,t=s.sibling,n=il(s,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function F1(t,e){return e=jp({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function R0(t,e,r,n){return n!==null&&p1(n),xu(e,t.child,null,r),t=F1(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function lN(t,e,r,n,i,s,a){if(r)return e.flags&256?(e.flags&=-257,n=Lg(Error(Le(422))),R0(t,e,a,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=n.fallback,i=e.mode,n=jp({mode:"visible",children:n.children},i,0,null),s=Vl(s,i,a,null),s.flags|=2,n.return=e,s.return=e,n.sibling=s,e.child=n,e.mode&1&&xu(e,t.child,null,a),e.child.memoizedState=rx(a),e.memoizedState=tx,s);if(!(e.mode&1))return R0(t,e,a,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var o=n.dgst;return n=o,s=Error(Le(419)),n=Lg(s,n,void 0),R0(t,e,a,n)}if(o=(a&t.childLanes)!==0,$i||o){if(n=Vn,n!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|a)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,io(t,i),ra(n,t,i,-1))}return P1(),n=Lg(Error(Le(421))),R0(t,e,a,n)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=EN.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,ls=el(i.nextSibling),cs=e,Ur=!0,Qs=null,t!==null&&(bs[Is++]=Ha,bs[Is++]=Ga,bs[Is++]=Xl,Ha=t.id,Ga=t.overflow,Xl=e),e=F1(e,n.children),e.flags|=4096,e)}function b2(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),Xm(t.return,e,r)}function Ug(t,e,r,n,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function cT(t,e,r){var n=e.pendingProps,i=n.revealOrder,s=n.tail;if(ki(t,e,n.children,r),n=Kr.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&b2(t,r,e);else if(t.tag===19)b2(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(Tr(Kr,n),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(r=e.child,i=null;r!==null;)t=r.alternate,t!==null&&Wh(t)===null&&(i=r),r=r.sibling;r=i,r===null?(i=e.child,e.child=null):(i=r.sibling,r.sibling=null),Ug(e,!1,i,r,s);break;case"backwards":for(r=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Wh(t)===null){e.child=i;break}t=i.sibling,i.sibling=r,r=i,i=t}Ug(e,!0,r,null,s);break;case"together":Ug(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function ph(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function so(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),Ql|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Le(153));if(e.child!==null){for(t=e.child,r=il(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=il(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function cN(t,e,r){switch(e.tag){case 3:oT(e),mu();break;case 5:Ow(e);break;case 1:Gi(e.type)&&Bh(e);break;case 4:_1(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,i=e.memoizedProps.value;Tr(Uh,n._currentValue),n._currentValue=i;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(Tr(Kr,Kr.current&1),e.flags|=128,null):r&e.child.childLanes?lT(t,e,r):(Tr(Kr,Kr.current&1),t=so(t,e,r),t!==null?t.sibling:null);Tr(Kr,Kr.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return cT(t,e,r);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Tr(Kr,Kr.current),n)break;return null;case 22:case 23:return e.lanes=0,sT(t,e,r)}return so(t,e,r)}var uT,nx,dT,fT;uT=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};nx=function(){};dT=function(t,e,r,n){var i=t.memoizedProps;if(i!==n){t=e.stateNode,Bl(Fa.current);var s=null;switch(r){case"input":i=Am(t,i),n=Am(t,n),s=[];break;case"select":i=Qr({},i,{value:void 0}),n=Qr({},n,{value:void 0}),s=[];break;case"textarea":i=Fm(t,i),n=Fm(t,n),s=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=Oh)}Im(r,n);var a;r=null;for(u in i)if(!n.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var o=i[u];for(a in o)o.hasOwnProperty(a)&&(r||(r={}),r[a]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Jd.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in n){var l=n[u];if(o=i!=null?i[u]:void 0,n.hasOwnProperty(u)&&l!==o&&(l!=null||o!=null))if(u==="style")if(o){for(a in o)!o.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(r||(r={}),r[a]="");for(a in l)l.hasOwnProperty(a)&&o[a]!==l[a]&&(r||(r={}),r[a]=l[a])}else r||(s||(s=[]),s.push(u,r)),r=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Jd.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&br("scroll",t),s||o===l||(s=[])):(s=s||[]).push(u,l))}r&&(s=s||[]).push("style",r);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};fT=function(t,e,r,n){r!==n&&(e.flags|=4)};function dd(t,e){if(!Ur)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function oi(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function uN(t,e,r){var n=e.pendingProps;switch(h1(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return oi(e),null;case 1:return Gi(e.type)&&Mh(),oi(e),null;case 3:return n=e.stateNode,vu(),Nr(Hi),Nr(vi),S1(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(I0(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Qs!==null&&(dx(Qs),Qs=null))),nx(t,e),oi(e),null;case 5:E1(e);var i=Bl(df.current);if(r=e.type,t!==null&&e.stateNode!=null)dT(t,e,r,n,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(Le(166));return oi(e),null}if(t=Bl(Fa.current),I0(e)){n=e.stateNode,r=e.type;var s=e.memoizedProps;switch(n[Aa]=e,n[cf]=s,t=(e.mode&1)!==0,r){case"dialog":br("cancel",n),br("close",n);break;case"iframe":case"object":case"embed":br("load",n);break;case"video":case"audio":for(i=0;i<Sd.length;i++)br(Sd[i],n);break;case"source":br("error",n);break;case"img":case"image":case"link":br("error",n),br("load",n);break;case"details":br("toggle",n);break;case"input":jy(n,s),br("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},br("invalid",n);break;case"textarea":Uy(n,s),br("invalid",n)}Im(r,s),i=null;for(var a in s)if(s.hasOwnProperty(a)){var o=s[a];a==="children"?typeof o=="string"?n.textContent!==o&&(s.suppressHydrationWarning!==!0&&b0(n.textContent,o,t),i=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&b0(n.textContent,o,t),i=["children",""+o]):Jd.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&br("scroll",n)}switch(r){case"input":E0(n),Ly(n,s,!0);break;case"textarea":E0(n),Vy(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=Oh)}n=i,e.updateQueue=n,n!==null&&(e.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=US(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=a.createElement(r,{is:n.is}):(t=a.createElement(r),r==="select"&&(a=t,n.multiple?a.multiple=!0:n.size&&(a.size=n.size))):t=a.createElementNS(t,r),t[Aa]=e,t[cf]=n,uT(t,e,!1,!1),e.stateNode=t;e:{switch(a=Nm(r,n),r){case"dialog":br("cancel",t),br("close",t),i=n;break;case"iframe":case"object":case"embed":br("load",t),i=n;break;case"video":case"audio":for(i=0;i<Sd.length;i++)br(Sd[i],t);i=n;break;case"source":br("error",t),i=n;break;case"img":case"image":case"link":br("error",t),br("load",t),i=n;break;case"details":br("toggle",t),i=n;break;case"input":jy(t,n),i=Am(t,n),br("invalid",t);break;case"option":i=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},i=Qr({},n,{value:void 0}),br("invalid",t);break;case"textarea":Uy(t,n),i=Fm(t,n),br("invalid",t);break;default:i=n}Im(r,i),o=i;for(s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="style"?WS(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&VS(t,l)):s==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&Zd(t,l):typeof l=="number"&&Zd(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Jd.hasOwnProperty(s)?l!=null&&s==="onScroll"&&br("scroll",t):l!=null&&Jx(t,s,l,a))}switch(r){case"input":E0(t),Ly(t,n,!1);break;case"textarea":E0(t),Vy(t);break;case"option":n.value!=null&&t.setAttribute("value",""+ul(n.value));break;case"select":t.multiple=!!n.multiple,s=n.value,s!=null?eu(t,!!n.multiple,s,!1):n.defaultValue!=null&&eu(t,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=Oh)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return oi(e),null;case 6:if(t&&e.stateNode!=null)fT(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(Le(166));if(r=Bl(df.current),Bl(Fa.current),I0(e)){if(n=e.stateNode,r=e.memoizedProps,n[Aa]=e,(s=n.nodeValue!==r)&&(t=cs,t!==null))switch(t.tag){case 3:b0(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&b0(n.nodeValue,r,(t.mode&1)!==0)}s&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Aa]=e,e.stateNode=n}return oi(e),null;case 13:if(Nr(Kr),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Ur&&ls!==null&&e.mode&1&&!(e.flags&128))Iw(),mu(),e.flags|=98560,s=!1;else if(s=I0(e),n!==null&&n.dehydrated!==null){if(t===null){if(!s)throw Error(Le(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Le(317));s[Aa]=e}else mu(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;oi(e),s=!1}else Qs!==null&&(dx(Qs),Qs=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||Kr.current&1?bn===0&&(bn=3):P1())),e.updateQueue!==null&&(e.flags|=4),oi(e),null);case 4:return vu(),nx(t,e),t===null&&of(e.stateNode.containerInfo),oi(e),null;case 10:return x1(e.type._context),oi(e),null;case 17:return Gi(e.type)&&Mh(),oi(e),null;case 19:if(Nr(Kr),s=e.memoizedState,s===null)return oi(e),null;if(n=(e.flags&128)!==0,a=s.rendering,a===null)if(n)dd(s,!1);else{if(bn!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=Wh(t),a!==null){for(e.flags|=128,dd(s,!1),n=a.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)s=r,t=n,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,t=a.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return Tr(Kr,Kr.current&1|2),e.child}t=t.sibling}s.tail!==null&&cn()>_u&&(e.flags|=128,n=!0,dd(s,!1),e.lanes=4194304)}else{if(!n)if(t=Wh(a),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),dd(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!Ur)return oi(e),null}else 2*cn()-s.renderingStartTime>_u&&r!==1073741824&&(e.flags|=128,n=!0,dd(s,!1),e.lanes=4194304);s.isBackwards?(a.sibling=e.child,e.child=a):(r=s.last,r!==null?r.sibling=a:e.child=a,s.last=a)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=cn(),e.sibling=null,r=Kr.current,Tr(Kr,n?r&1|2:r&1),e):(oi(e),null);case 22:case 23:return D1(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?ns&1073741824&&(oi(e),e.subtreeFlags&6&&(e.flags|=8192)):oi(e),null;case 24:return null;case 25:return null}throw Error(Le(156,e.tag))}function dN(t,e){switch(h1(e),e.tag){case 1:return Gi(e.type)&&Mh(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return vu(),Nr(Hi),Nr(vi),S1(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return E1(e),null;case 13:if(Nr(Kr),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Le(340));mu()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Nr(Kr),null;case 4:return vu(),null;case 10:return x1(e.type._context),null;case 22:case 23:return D1(),null;case 24:return null;default:return null}}var D0=!1,hi=!1,fN=typeof WeakSet=="function"?WeakSet:Set,et=null;function qc(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){en(t,e,n)}else r.current=null}function ix(t,e,r){try{r()}catch(n){en(t,e,n)}}var I2=!1;function hN(t,e){if(Vm=Rh,t=xw(),d1(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var a=0,o=-1,l=-1,u=0,f=0,p=t,g=null;t:for(;;){for(var m;p!==r||i!==0&&p.nodeType!==3||(o=a+i),p!==s||n!==0&&p.nodeType!==3||(l=a+n),p.nodeType===3&&(a+=p.nodeValue.length),(m=p.firstChild)!==null;)g=p,p=m;for(;;){if(p===t)break t;if(g===r&&++u===i&&(o=a),g===s&&++f===n&&(l=a),(m=p.nextSibling)!==null)break;p=g,g=p.parentNode}p=m}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(zm={focusedElem:t,selectionRange:r},Rh=!1,et=e;et!==null;)if(e=et,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,et=t;else for(;et!==null;){e=et;try{var y=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var x=y.memoizedProps,S=y.memoizedState,A=e.stateNode,C=A.getSnapshotBeforeUpdate(e.elementType===e.type?x:Xs(e.type,x),S);A.__reactInternalSnapshotBeforeUpdate=C}break;case 3:var E=e.stateNode.containerInfo;E.nodeType===1?E.textContent="":E.nodeType===9&&E.documentElement&&E.removeChild(E.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Le(163))}}catch(O){en(e,e.return,O)}if(t=e.sibling,t!==null){t.return=e.return,et=t;break}et=e.return}return y=I2,I2=!1,y}function Md(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&ix(e,r,s)}i=i.next}while(i!==n)}}function Mp(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function sx(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function hT(t){var e=t.alternate;e!==null&&(t.alternate=null,hT(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Aa],delete e[cf],delete e[Hm],delete e[XI],delete e[qI])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function pT(t){return t.tag===5||t.tag===3||t.tag===4}function N2(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||pT(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function ax(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=Oh));else if(n!==4&&(t=t.child,t!==null))for(ax(t,e,r),t=t.sibling;t!==null;)ax(t,e,r),t=t.sibling}function ox(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(ox(t,e,r),t=t.sibling;t!==null;)ox(t,e,r),t=t.sibling}var Yn=null,qs=!1;function Ro(t,e,r){for(r=r.child;r!==null;)gT(t,e,r),r=r.sibling}function gT(t,e,r){if(ka&&typeof ka.onCommitFiberUnmount=="function")try{ka.onCommitFiberUnmount(Fp,r)}catch{}switch(r.tag){case 5:hi||qc(r,e);case 6:var n=Yn,i=qs;Yn=null,Ro(t,e,r),Yn=n,qs=i,Yn!==null&&(qs?(t=Yn,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):Yn.removeChild(r.stateNode));break;case 18:Yn!==null&&(qs?(t=Yn,r=r.stateNode,t.nodeType===8?Dg(t.parentNode,r):t.nodeType===1&&Dg(t,r),nf(t)):Dg(Yn,r.stateNode));break;case 4:n=Yn,i=qs,Yn=r.stateNode.containerInfo,qs=!0,Ro(t,e,r),Yn=n,qs=i;break;case 0:case 11:case 14:case 15:if(!hi&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var s=i,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&ix(r,e,a),i=i.next}while(i!==n)}Ro(t,e,r);break;case 1:if(!hi&&(qc(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){en(r,e,o)}Ro(t,e,r);break;case 21:Ro(t,e,r);break;case 22:r.mode&1?(hi=(n=hi)||r.memoizedState!==null,Ro(t,e,r),hi=n):Ro(t,e,r);break;default:Ro(t,e,r)}}function R2(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new fN),e.forEach(function(n){var i=SN.bind(null,t,n);r.has(n)||(r.add(n),n.then(i,i))})}}function Gs(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var s=t,a=e,o=a;e:for(;o!==null;){switch(o.tag){case 5:Yn=o.stateNode,qs=!1;break e;case 3:Yn=o.stateNode.containerInfo,qs=!0;break e;case 4:Yn=o.stateNode.containerInfo,qs=!0;break e}o=o.return}if(Yn===null)throw Error(Le(160));gT(s,a,i),Yn=null,qs=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(u){en(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)mT(e,t),e=e.sibling}function mT(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Gs(e,t),ya(t),n&4){try{Md(3,t,t.return),Mp(3,t)}catch(x){en(t,t.return,x)}try{Md(5,t,t.return)}catch(x){en(t,t.return,x)}}break;case 1:Gs(e,t),ya(t),n&512&&r!==null&&qc(r,r.return);break;case 5:if(Gs(e,t),ya(t),n&512&&r!==null&&qc(r,r.return),t.flags&32){var i=t.stateNode;try{Zd(i,"")}catch(x){en(t,t.return,x)}}if(n&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,a=r!==null?r.memoizedProps:s,o=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&jS(i,s),Nm(o,a);var u=Nm(o,s);for(a=0;a<l.length;a+=2){var f=l[a],p=l[a+1];f==="style"?WS(i,p):f==="dangerouslySetInnerHTML"?VS(i,p):f==="children"?Zd(i,p):Jx(i,f,p,u)}switch(o){case"input":Cm(i,s);break;case"textarea":LS(i,s);break;case"select":var g=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var m=s.value;m!=null?eu(i,!!s.multiple,m,!1):g!==!!s.multiple&&(s.defaultValue!=null?eu(i,!!s.multiple,s.defaultValue,!0):eu(i,!!s.multiple,s.multiple?[]:"",!1))}i[cf]=s}catch(x){en(t,t.return,x)}}break;case 6:if(Gs(e,t),ya(t),n&4){if(t.stateNode===null)throw Error(Le(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(x){en(t,t.return,x)}}break;case 3:if(Gs(e,t),ya(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{nf(e.containerInfo)}catch(x){en(t,t.return,x)}break;case 4:Gs(e,t),ya(t);break;case 13:Gs(e,t),ya(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(N1=cn())),n&4&&R2(t);break;case 22:if(f=r!==null&&r.memoizedState!==null,t.mode&1?(hi=(u=hi)||f,Gs(e,t),hi=u):Gs(e,t),ya(t),n&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!f&&t.mode&1)for(et=t,f=t.child;f!==null;){for(p=et=f;et!==null;){switch(g=et,m=g.child,g.tag){case 0:case 11:case 14:case 15:Md(4,g,g.return);break;case 1:qc(g,g.return);var y=g.stateNode;if(typeof y.componentWillUnmount=="function"){n=g,r=g.return;try{e=n,y.props=e.memoizedProps,y.state=e.memoizedState,y.componentWillUnmount()}catch(x){en(n,r,x)}}break;case 5:qc(g,g.return);break;case 22:if(g.memoizedState!==null){P2(p);continue}}m!==null?(m.return=g,et=m):P2(p)}f=f.sibling}e:for(f=null,p=t;;){if(p.tag===5){if(f===null){f=p;try{i=p.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=p.stateNode,l=p.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=zS("display",a))}catch(x){en(t,t.return,x)}}}else if(p.tag===6){if(f===null)try{p.stateNode.nodeValue=u?"":p.memoizedProps}catch(x){en(t,t.return,x)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===t)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===t)break e;for(;p.sibling===null;){if(p.return===null||p.return===t)break e;f===p&&(f=null),p=p.return}f===p&&(f=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:Gs(e,t),ya(t),n&4&&R2(t);break;case 21:break;default:Gs(e,t),ya(t)}}function ya(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(pT(r)){var n=r;break e}r=r.return}throw Error(Le(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(Zd(i,""),n.flags&=-33);var s=N2(t);ox(t,s,i);break;case 3:case 4:var a=n.stateNode.containerInfo,o=N2(t);ax(t,o,a);break;default:throw Error(Le(161))}}catch(l){en(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function pN(t,e,r){et=t,xT(t)}function xT(t,e,r){for(var n=(t.mode&1)!==0;et!==null;){var i=et,s=i.child;if(i.tag===22&&n){var a=i.memoizedState!==null||D0;if(!a){var o=i.alternate,l=o!==null&&o.memoizedState!==null||hi;o=D0;var u=hi;if(D0=a,(hi=l)&&!u)for(et=i;et!==null;)a=et,l=a.child,a.tag===22&&a.memoizedState!==null?O2(i):l!==null?(l.return=a,et=l):O2(i);for(;s!==null;)et=s,xT(s),s=s.sibling;et=i,D0=o,hi=u}D2(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,et=s):D2(t)}}function D2(t){for(;et!==null;){var e=et;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:hi||Mp(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!hi)if(r===null)n.componentDidMount();else{var i=e.elementType===e.type?r.memoizedProps:Xs(e.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&x2(e,s,n);break;case 3:var a=e.updateQueue;if(a!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}x2(e,a,r)}break;case 5:var o=e.stateNode;if(r===null&&e.flags&4){r=o;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var f=u.memoizedState;if(f!==null){var p=f.dehydrated;p!==null&&nf(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Le(163))}hi||e.flags&512&&sx(e)}catch(g){en(e,e.return,g)}}if(e===t){et=null;break}if(r=e.sibling,r!==null){r.return=e.return,et=r;break}et=e.return}}function P2(t){for(;et!==null;){var e=et;if(e===t){et=null;break}var r=e.sibling;if(r!==null){r.return=e.return,et=r;break}et=e.return}}function O2(t){for(;et!==null;){var e=et;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{Mp(4,e)}catch(l){en(e,r,l)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var i=e.return;try{n.componentDidMount()}catch(l){en(e,i,l)}}var s=e.return;try{sx(e)}catch(l){en(e,s,l)}break;case 5:var a=e.return;try{sx(e)}catch(l){en(e,a,l)}}}catch(l){en(e,e.return,l)}if(e===t){et=null;break}var o=e.sibling;if(o!==null){o.return=e.return,et=o;break}et=e.return}}var gN=Math.ceil,Gh=ho.ReactCurrentDispatcher,b1=ho.ReactCurrentOwner,Ds=ho.ReactCurrentBatchConfig,tr=0,Vn=null,_n=null,Zn=0,ns=0,Qc=_l(0),bn=0,gf=null,Ql=0,Bp=0,I1=0,Bd=null,Wi=null,N1=0,_u=1/0,Wa=null,Kh=!1,lx=null,rl=null,P0=!1,Go=null,Yh=0,jd=0,cx=null,gh=-1,mh=0;function Ii(){return tr&6?cn():gh!==-1?gh:gh=cn()}function nl(t){return t.mode&1?tr&2&&Zn!==0?Zn&-Zn:JI.transition!==null?(mh===0&&(mh=tw()),mh):(t=gr,t!==0||(t=window.event,t=t===void 0?16:lw(t.type)),t):1}function ra(t,e,r,n){if(50<jd)throw jd=0,cx=null,Error(Le(185));Vf(t,r,n),(!(tr&2)||t!==Vn)&&(t===Vn&&(!(tr&2)&&(Bp|=r),bn===4&&Uo(t,Zn)),Ki(t,n),r===1&&tr===0&&!(e.mode&1)&&(_u=cn()+500,Dp&&El()))}function Ki(t,e){var r=t.callbackNode;Jb(t,e);var n=Nh(t,t===Vn?Zn:0);if(n===0)r!==null&&$y(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&$y(r),e===1)t.tag===0?QI(M2.bind(null,t)):kw(M2.bind(null,t)),KI(function(){!(tr&6)&&El()}),r=null;else{switch(rw(n)){case 1:r=n1;break;case 4:r=ZS;break;case 16:r=Ih;break;case 536870912:r=ew;break;default:r=Ih}r=AT(r,vT.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function vT(t,e){if(gh=-1,mh=0,tr&6)throw Error(Le(327));var r=t.callbackNode;if(su()&&t.callbackNode!==r)return null;var n=Nh(t,t===Vn?Zn:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=Xh(t,n);else{e=n;var i=tr;tr|=2;var s=_T();(Vn!==t||Zn!==e)&&(Wa=null,_u=cn()+500,Ul(t,e));do try{vN();break}catch(o){yT(t,o)}while(!0);m1(),Gh.current=s,tr=i,_n!==null?e=0:(Vn=null,Zn=0,e=bn)}if(e!==0){if(e===2&&(i=Mm(t),i!==0&&(n=i,e=ux(t,i))),e===1)throw r=gf,Ul(t,0),Uo(t,n),Ki(t,cn()),r;if(e===6)Uo(t,n);else{if(i=t.current.alternate,!(n&30)&&!mN(i)&&(e=Xh(t,n),e===2&&(s=Mm(t),s!==0&&(n=s,e=ux(t,s))),e===1))throw r=gf,Ul(t,0),Uo(t,n),Ki(t,cn()),r;switch(t.finishedWork=i,t.finishedLanes=n,e){case 0:case 1:throw Error(Le(345));case 2:Nl(t,Wi,Wa);break;case 3:if(Uo(t,n),(n&130023424)===n&&(e=N1+500-cn(),10<e)){if(Nh(t,0)!==0)break;if(i=t.suspendedLanes,(i&n)!==n){Ii(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=$m(Nl.bind(null,t,Wi,Wa),e);break}Nl(t,Wi,Wa);break;case 4:if(Uo(t,n),(n&4194240)===n)break;for(e=t.eventTimes,i=-1;0<n;){var a=31-ta(n);s=1<<a,a=e[a],a>i&&(i=a),n&=~s}if(n=i,n=cn()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*gN(n/1960))-n,10<n){t.timeoutHandle=$m(Nl.bind(null,t,Wi,Wa),n);break}Nl(t,Wi,Wa);break;case 5:Nl(t,Wi,Wa);break;default:throw Error(Le(329))}}}return Ki(t,cn()),t.callbackNode===r?vT.bind(null,t):null}function ux(t,e){var r=Bd;return t.current.memoizedState.isDehydrated&&(Ul(t,e).flags|=256),t=Xh(t,e),t!==2&&(e=Wi,Wi=r,e!==null&&dx(e)),t}function dx(t){Wi===null?Wi=t:Wi.push.apply(Wi,t)}function mN(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!sa(s(),i))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Uo(t,e){for(e&=~I1,e&=~Bp,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-ta(e),n=1<<r;t[r]=-1,e&=~n}}function M2(t){if(tr&6)throw Error(Le(327));su();var e=Nh(t,0);if(!(e&1))return Ki(t,cn()),null;var r=Xh(t,e);if(t.tag!==0&&r===2){var n=Mm(t);n!==0&&(e=n,r=ux(t,n))}if(r===1)throw r=gf,Ul(t,0),Uo(t,e),Ki(t,cn()),r;if(r===6)throw Error(Le(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Nl(t,Wi,Wa),Ki(t,cn()),null}function R1(t,e){var r=tr;tr|=1;try{return t(e)}finally{tr=r,tr===0&&(_u=cn()+500,Dp&&El())}}function Jl(t){Go!==null&&Go.tag===0&&!(tr&6)&&su();var e=tr;tr|=1;var r=Ds.transition,n=gr;try{if(Ds.transition=null,gr=1,t)return t()}finally{gr=n,Ds.transition=r,tr=e,!(tr&6)&&El()}}function D1(){ns=Qc.current,Nr(Qc)}function Ul(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,GI(r)),_n!==null)for(r=_n.return;r!==null;){var n=r;switch(h1(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Mh();break;case 3:vu(),Nr(Hi),Nr(vi),S1();break;case 5:E1(n);break;case 4:vu();break;case 13:Nr(Kr);break;case 19:Nr(Kr);break;case 10:x1(n.type._context);break;case 22:case 23:D1()}r=r.return}if(Vn=t,_n=t=il(t.current,null),Zn=ns=e,bn=0,gf=null,I1=Bp=Ql=0,Wi=Bd=null,Ml!==null){for(e=0;e<Ml.length;e++)if(r=Ml[e],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,s=r.pending;if(s!==null){var a=s.next;s.next=i,n.next=a}r.pending=n}Ml=null}return t}function yT(t,e){do{var r=_n;try{if(m1(),fh.current=Hh,$h){for(var n=qr.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}$h=!1}if(ql=0,jn=Cn=qr=null,Od=!1,ff=0,b1.current=null,r===null||r.return===null){bn=1,gf=e,_n=null;break}e:{var s=t,a=r.return,o=r,l=e;if(e=Zn,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,f=o,p=f.tag;if(!(f.mode&1)&&(p===0||p===11||p===15)){var g=f.alternate;g?(f.updateQueue=g.updateQueue,f.memoizedState=g.memoizedState,f.lanes=g.lanes):(f.updateQueue=null,f.memoizedState=null)}var m=w2(a);if(m!==null){m.flags&=-257,T2(m,a,o,s,e),m.mode&1&&S2(s,u,e),e=m,l=u;var y=e.updateQueue;if(y===null){var x=new Set;x.add(l),e.updateQueue=x}else y.add(l);break e}else{if(!(e&1)){S2(s,u,e),P1();break e}l=Error(Le(426))}}else if(Ur&&o.mode&1){var S=w2(a);if(S!==null){!(S.flags&65536)&&(S.flags|=256),T2(S,a,o,s,e),p1(yu(l,o));break e}}s=l=yu(l,o),bn!==4&&(bn=2),Bd===null?Bd=[s]:Bd.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var A=rT(s,l,e);m2(s,A);break e;case 1:o=l;var C=s.type,E=s.stateNode;if(!(s.flags&128)&&(typeof C.getDerivedStateFromError=="function"||E!==null&&typeof E.componentDidCatch=="function"&&(rl===null||!rl.has(E)))){s.flags|=65536,e&=-e,s.lanes|=e;var O=nT(s,o,e);m2(s,O);break e}}s=s.return}while(s!==null)}ST(r)}catch(q){e=q,_n===r&&r!==null&&(_n=r=r.return);continue}break}while(!0)}function _T(){var t=Gh.current;return Gh.current=Hh,t===null?Hh:t}function P1(){(bn===0||bn===3||bn===2)&&(bn=4),Vn===null||!(Ql&268435455)&&!(Bp&268435455)||Uo(Vn,Zn)}function Xh(t,e){var r=tr;tr|=2;var n=_T();(Vn!==t||Zn!==e)&&(Wa=null,Ul(t,e));do try{xN();break}catch(i){yT(t,i)}while(!0);if(m1(),tr=r,Gh.current=n,_n!==null)throw Error(Le(261));return Vn=null,Zn=0,bn}function xN(){for(;_n!==null;)ET(_n)}function vN(){for(;_n!==null&&!Wb();)ET(_n)}function ET(t){var e=TT(t.alternate,t,ns);t.memoizedProps=t.pendingProps,e===null?ST(t):_n=e,b1.current=null}function ST(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=dN(r,e),r!==null){r.flags&=32767,_n=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{bn=6,_n=null;return}}else if(r=uN(r,e,ns),r!==null){_n=r;return}if(e=e.sibling,e!==null){_n=e;return}_n=e=t}while(e!==null);bn===0&&(bn=5)}function Nl(t,e,r){var n=gr,i=Ds.transition;try{Ds.transition=null,gr=1,yN(t,e,r,n)}finally{Ds.transition=i,gr=n}return null}function yN(t,e,r,n){do su();while(Go!==null);if(tr&6)throw Error(Le(327));r=t.finishedWork;var i=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(Le(177));t.callbackNode=null,t.callbackPriority=0;var s=r.lanes|r.childLanes;if(Zb(t,s),t===Vn&&(_n=Vn=null,Zn=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||P0||(P0=!0,AT(Ih,function(){return su(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=Ds.transition,Ds.transition=null;var a=gr;gr=1;var o=tr;tr|=4,b1.current=null,hN(t,r),mT(r,t),LI(zm),Rh=!!Vm,zm=Vm=null,t.current=r,pN(r),$b(),tr=o,gr=a,Ds.transition=s}else t.current=r;if(P0&&(P0=!1,Go=t,Yh=i),s=t.pendingLanes,s===0&&(rl=null),Kb(r.stateNode),Ki(t,cn()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)i=e[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(Kh)throw Kh=!1,t=lx,lx=null,t;return Yh&1&&t.tag!==0&&su(),s=t.pendingLanes,s&1?t===cx?jd++:(jd=0,cx=t):jd=0,El(),null}function su(){if(Go!==null){var t=rw(Yh),e=Ds.transition,r=gr;try{if(Ds.transition=null,gr=16>t?16:t,Go===null)var n=!1;else{if(t=Go,Go=null,Yh=0,tr&6)throw Error(Le(331));var i=tr;for(tr|=4,et=t.current;et!==null;){var s=et,a=s.child;if(et.flags&16){var o=s.deletions;if(o!==null){for(var l=0;l<o.length;l++){var u=o[l];for(et=u;et!==null;){var f=et;switch(f.tag){case 0:case 11:case 15:Md(8,f,s)}var p=f.child;if(p!==null)p.return=f,et=p;else for(;et!==null;){f=et;var g=f.sibling,m=f.return;if(hT(f),f===u){et=null;break}if(g!==null){g.return=m,et=g;break}et=m}}}var y=s.alternate;if(y!==null){var x=y.child;if(x!==null){y.child=null;do{var S=x.sibling;x.sibling=null,x=S}while(x!==null)}}et=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,et=a;else e:for(;et!==null;){if(s=et,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Md(9,s,s.return)}var A=s.sibling;if(A!==null){A.return=s.return,et=A;break e}et=s.return}}var C=t.current;for(et=C;et!==null;){a=et;var E=a.child;if(a.subtreeFlags&2064&&E!==null)E.return=a,et=E;else e:for(a=C;et!==null;){if(o=et,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:Mp(9,o)}}catch(q){en(o,o.return,q)}if(o===a){et=null;break e}var O=o.sibling;if(O!==null){O.return=o.return,et=O;break e}et=o.return}}if(tr=i,El(),ka&&typeof ka.onPostCommitFiberRoot=="function")try{ka.onPostCommitFiberRoot(Fp,t)}catch{}n=!0}return n}finally{gr=r,Ds.transition=e}}return!1}function B2(t,e,r){e=yu(r,e),e=rT(t,e,1),t=tl(t,e,1),e=Ii(),t!==null&&(Vf(t,1,e),Ki(t,e))}function en(t,e,r){if(t.tag===3)B2(t,t,r);else for(;e!==null;){if(e.tag===3){B2(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(rl===null||!rl.has(n))){t=yu(r,t),t=nT(e,t,1),e=tl(e,t,1),t=Ii(),e!==null&&(Vf(e,1,t),Ki(e,t));break}}e=e.return}}function _N(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=Ii(),t.pingedLanes|=t.suspendedLanes&r,Vn===t&&(Zn&r)===r&&(bn===4||bn===3&&(Zn&130023424)===Zn&&500>cn()-N1?Ul(t,0):I1|=r),Ki(t,e)}function wT(t,e){e===0&&(t.mode&1?(e=T0,T0<<=1,!(T0&130023424)&&(T0=4194304)):e=1);var r=Ii();t=io(t,e),t!==null&&(Vf(t,e,r),Ki(t,r))}function EN(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),wT(t,r)}function SN(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,i=t.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(Le(314))}n!==null&&n.delete(e),wT(t,r)}var TT;TT=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||Hi.current)$i=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return $i=!1,cN(t,e,r);$i=!!(t.flags&131072)}else $i=!1,Ur&&e.flags&1048576&&Fw(e,Lh,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;ph(t,e),t=e.pendingProps;var i=gu(e,vi.current);iu(e,r),i=T1(null,e,n,t,i,r);var s=A1();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Gi(n)?(s=!0,Bh(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,y1(e),i.updater=Op,e.stateNode=i,i._reactInternals=e,Qm(e,n,t,r),e=ex(null,e,n,!0,s,r)):(e.tag=0,Ur&&s&&f1(e),ki(null,e,i,r),e=e.child),e;case 16:n=e.elementType;e:{switch(ph(t,e),t=e.pendingProps,i=n._init,n=i(n._payload),e.type=n,i=e.tag=TN(n),t=Xs(n,t),i){case 0:e=Zm(null,e,n,t,r);break e;case 1:e=k2(null,e,n,t,r);break e;case 11:e=A2(null,e,n,t,r);break e;case 14:e=C2(null,e,n,Xs(n.type,t),r);break e}throw Error(Le(306,n,""))}return e;case 0:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Xs(n,i),Zm(t,e,n,i,r);case 1:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Xs(n,i),k2(t,e,n,i,r);case 3:e:{if(oT(e),t===null)throw Error(Le(387));n=e.pendingProps,s=e.memoizedState,i=s.element,Pw(t,e),zh(e,n,null,r);var a=e.memoizedState;if(n=a.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=yu(Error(Le(423)),e),e=F2(t,e,n,r,i);break e}else if(n!==i){i=yu(Error(Le(424)),e),e=F2(t,e,n,r,i);break e}else for(ls=el(e.stateNode.containerInfo.firstChild),cs=e,Ur=!0,Qs=null,r=Rw(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(mu(),n===i){e=so(t,e,r);break e}ki(t,e,n,r)}e=e.child}return e;case 5:return Ow(e),t===null&&Ym(e),n=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,a=i.children,Wm(n,i)?a=null:s!==null&&Wm(n,s)&&(e.flags|=32),aT(t,e),ki(t,e,a,r),e.child;case 6:return t===null&&Ym(e),null;case 13:return lT(t,e,r);case 4:return _1(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=xu(e,null,n,r):ki(t,e,n,r),e.child;case 11:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Xs(n,i),A2(t,e,n,i,r);case 7:return ki(t,e,e.pendingProps,r),e.child;case 8:return ki(t,e,e.pendingProps.children,r),e.child;case 12:return ki(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,i=e.pendingProps,s=e.memoizedProps,a=i.value,Tr(Uh,n._currentValue),n._currentValue=a,s!==null)if(sa(s.value,a)){if(s.children===i.children&&!Hi.current){e=so(t,e,r);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var o=s.dependencies;if(o!==null){a=s.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(s.tag===1){l=Qa(-1,r&-r),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var f=u.pending;f===null?l.next=l:(l.next=f.next,f.next=l),u.pending=l}}s.lanes|=r,l=s.alternate,l!==null&&(l.lanes|=r),Xm(s.return,r,e),o.lanes|=r;break}l=l.next}}else if(s.tag===10)a=s.type===e.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(Le(341));a.lanes|=r,o=a.alternate,o!==null&&(o.lanes|=r),Xm(a,r,e),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===e){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}ki(t,e,i.children,r),e=e.child}return e;case 9:return i=e.type,n=e.pendingProps.children,iu(e,r),i=Os(i),n=n(i),e.flags|=1,ki(t,e,n,r),e.child;case 14:return n=e.type,i=Xs(n,e.pendingProps),i=Xs(n.type,i),C2(t,e,n,i,r);case 15:return iT(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Xs(n,i),ph(t,e),e.tag=1,Gi(n)?(t=!0,Bh(e)):t=!1,iu(e,r),tT(e,n,i),Qm(e,n,i,r),ex(null,e,n,!0,t,r);case 19:return cT(t,e,r);case 22:return sT(t,e,r)}throw Error(Le(156,e.tag))};function AT(t,e){return JS(t,e)}function wN(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Rs(t,e,r,n){return new wN(t,e,r,n)}function O1(t){return t=t.prototype,!(!t||!t.isReactComponent)}function TN(t){if(typeof t=="function")return O1(t)?1:0;if(t!=null){if(t=t.$$typeof,t===e1)return 11;if(t===t1)return 14}return 2}function il(t,e){var r=t.alternate;return r===null?(r=Rs(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function xh(t,e,r,n,i,s){var a=2;if(n=t,typeof t=="function")O1(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case Vc:return Vl(r.children,i,s,e);case Zx:a=8,i|=8;break;case Em:return t=Rs(12,r,e,i|2),t.elementType=Em,t.lanes=s,t;case Sm:return t=Rs(13,r,e,i),t.elementType=Sm,t.lanes=s,t;case wm:return t=Rs(19,r,e,i),t.elementType=wm,t.lanes=s,t;case OS:return jp(r,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case DS:a=10;break e;case PS:a=9;break e;case e1:a=11;break e;case t1:a=14;break e;case Bo:a=16,n=null;break e}throw Error(Le(130,t==null?t:typeof t,""))}return e=Rs(a,r,e,i),e.elementType=t,e.type=n,e.lanes=s,e}function Vl(t,e,r,n){return t=Rs(7,t,n,e),t.lanes=r,t}function jp(t,e,r,n){return t=Rs(22,t,n,e),t.elementType=OS,t.lanes=r,t.stateNode={isHidden:!1},t}function Vg(t,e,r){return t=Rs(6,t,null,e),t.lanes=r,t}function zg(t,e,r){return e=Rs(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function AN(t,e,r,n,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Sg(0),this.expirationTimes=Sg(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Sg(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function M1(t,e,r,n,i,s,a,o,l){return t=new AN(t,e,r,o,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Rs(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},y1(s),t}function CN(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Uc,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function CT(t){if(!t)return dl;t=t._reactInternals;e:{if(dc(t)!==t||t.tag!==1)throw Error(Le(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Gi(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Le(171))}if(t.tag===1){var r=t.type;if(Gi(r))return Cw(t,r,e)}return e}function kT(t,e,r,n,i,s,a,o,l){return t=M1(r,n,!0,t,i,s,a,o,l),t.context=CT(null),r=t.current,n=Ii(),i=nl(r),s=Qa(n,i),s.callback=e??null,tl(r,s,i),t.current.lanes=i,Vf(t,i,n),Ki(t,n),t}function Lp(t,e,r,n){var i=e.current,s=Ii(),a=nl(i);return r=CT(r),e.context===null?e.context=r:e.pendingContext=r,e=Qa(s,a),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=tl(i,e,a),t!==null&&(ra(t,i,a,s),dh(t,i,a)),a}function qh(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function j2(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function B1(t,e){j2(t,e),(t=t.alternate)&&j2(t,e)}function kN(){return null}var FT=typeof reportError=="function"?reportError:function(t){console.error(t)};function j1(t){this._internalRoot=t}Up.prototype.render=j1.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Le(409));Lp(t,e,null,null)};Up.prototype.unmount=j1.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Jl(function(){Lp(null,t,null,null)}),e[no]=null}};function Up(t){this._internalRoot=t}Up.prototype.unstable_scheduleHydration=function(t){if(t){var e=sw();t={blockedOn:null,target:t,priority:e};for(var r=0;r<Lo.length&&e!==0&&e<Lo[r].priority;r++);Lo.splice(r,0,t),r===0&&ow(t)}};function L1(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Vp(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function L2(){}function FN(t,e,r,n,i){if(i){if(typeof n=="function"){var s=n;n=function(){var u=qh(a);s.call(u)}}var a=kT(e,n,t,0,null,!1,!1,"",L2);return t._reactRootContainer=a,t[no]=a.current,of(t.nodeType===8?t.parentNode:t),Jl(),a}for(;i=t.lastChild;)t.removeChild(i);if(typeof n=="function"){var o=n;n=function(){var u=qh(l);o.call(u)}}var l=M1(t,0,!1,null,null,!1,!1,"",L2);return t._reactRootContainer=l,t[no]=l.current,of(t.nodeType===8?t.parentNode:t),Jl(function(){Lp(e,l,r,n)}),l}function zp(t,e,r,n,i){var s=r._reactRootContainer;if(s){var a=s;if(typeof i=="function"){var o=i;i=function(){var l=qh(a);o.call(l)}}Lp(e,a,t,i)}else a=FN(r,e,t,i,n);return qh(a)}nw=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=Ed(e.pendingLanes);r!==0&&(i1(e,r|1),Ki(e,cn()),!(tr&6)&&(_u=cn()+500,El()))}break;case 13:Jl(function(){var n=io(t,1);if(n!==null){var i=Ii();ra(n,t,1,i)}}),B1(t,1)}};s1=function(t){if(t.tag===13){var e=io(t,134217728);if(e!==null){var r=Ii();ra(e,t,134217728,r)}B1(t,134217728)}};iw=function(t){if(t.tag===13){var e=nl(t),r=io(t,e);if(r!==null){var n=Ii();ra(r,t,e,n)}B1(t,e)}};sw=function(){return gr};aw=function(t,e){var r=gr;try{return gr=t,e()}finally{gr=r}};Dm=function(t,e,r){switch(e){case"input":if(Cm(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var i=Rp(n);if(!i)throw Error(Le(90));BS(n),Cm(n,i)}}}break;case"textarea":LS(t,r);break;case"select":e=r.value,e!=null&&eu(t,!!r.multiple,e,!1)}};GS=R1;KS=Jl;var bN={usingClientEntryPoint:!1,Events:[Wf,Hc,Rp,$S,HS,R1]},fd={findFiberByHostInstance:Ol,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},IN={bundleType:fd.bundleType,version:fd.version,rendererPackageName:fd.rendererPackageName,rendererConfig:fd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ho.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=qS(t),t===null?null:t.stateNode},findFiberByHostInstance:fd.findFiberByHostInstance||kN,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var O0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!O0.isDisabled&&O0.supportsFiber)try{Fp=O0.inject(IN),ka=O0}catch{}}hs.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=bN;hs.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!L1(e))throw Error(Le(200));return CN(t,e,null,r)};hs.createRoot=function(t,e){if(!L1(t))throw Error(Le(299));var r=!1,n="",i=FT;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=M1(t,1,!1,null,null,r,!1,n,i),t[no]=e.current,of(t.nodeType===8?t.parentNode:t),new j1(e)};hs.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Le(188)):(t=Object.keys(t).join(","),Error(Le(268,t)));return t=qS(e),t=t===null?null:t.stateNode,t};hs.flushSync=function(t){return Jl(t)};hs.hydrate=function(t,e,r){if(!Vp(e))throw Error(Le(200));return zp(null,t,e,!0,r)};hs.hydrateRoot=function(t,e,r){if(!L1(t))throw Error(Le(405));var n=r!=null&&r.hydratedSources||null,i=!1,s="",a=FT;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(a=r.onRecoverableError)),e=kT(e,null,t,1,r??null,i,!1,s,a),t[no]=e.current,of(t),n)for(t=0;t<n.length;t++)r=n[t],i=r._getVersion,i=i(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,i]:e.mutableSourceEagerHydrationData.push(r,i);return new Up(e)};hs.render=function(t,e,r){if(!Vp(e))throw Error(Le(200));return zp(null,t,e,!1,r)};hs.unmountComponentAtNode=function(t){if(!Vp(t))throw Error(Le(40));return t._reactRootContainer?(Jl(function(){zp(null,null,t,!1,function(){t._reactRootContainer=null,t[no]=null})}),!0):!1};hs.unstable_batchedUpdates=R1;hs.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!Vp(r))throw Error(Le(200));if(t==null||t._reactInternals===void 0)throw Error(Le(38));return zp(t,e,r,!1,n)};hs.version="18.3.1-next-f1338f8080-20240426";function bT(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(bT)}catch(t){console.error(t)}}bT(),bS.exports=hs;var NN=bS.exports,U2=NN;ym.createRoot=U2.createRoot,ym.hydrateRoot=U2.hydrateRoot;/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Qh={};Qh.version="0.18.5";var IT=1252,RN=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],U1={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},V1=function(t){RN.indexOf(t)!=-1&&(IT=U1[0]=t)};function DN(){V1(1252)}var Js=function(t){V1(t)};function z1(){Js(1200),DN()}function V2(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function PN(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function NT(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var wd=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?PN(t.slice(2)):e==254&&r==255?NT(t.slice(2)):e==65279?t.slice(1):t},M0=function(e){return String.fromCharCode(e)},z2=function(e){return String.fromCharCode(e)},mf,Ko="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function xf(t){for(var e="",r=0,n=0,i=0,s=0,a=0,o=0,l=0,u=0;u<t.length;)r=t.charCodeAt(u++),s=r>>2,n=t.charCodeAt(u++),a=(r&3)<<4|n>>4,i=t.charCodeAt(u++),o=(n&15)<<2|i>>6,l=i&63,isNaN(n)?o=l=64:isNaN(i)&&(l=64),e+=Ko.charAt(s)+Ko.charAt(a)+Ko.charAt(o)+Ko.charAt(l);return e}function fs(t){var e="",r=0,n=0,i=0,s=0,a=0,o=0,l=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<t.length;)s=Ko.indexOf(t.charAt(u++)),a=Ko.indexOf(t.charAt(u++)),r=s<<2|a>>4,e+=String.fromCharCode(r),o=Ko.indexOf(t.charAt(u++)),n=(a&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(n)),l=Ko.indexOf(t.charAt(u++)),i=(o&3)<<6|l,l!==64&&(e+=String.fromCharCode(i));return e}var Pt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),po=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function fl(t){return Pt?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function W2(t){return Pt?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var as=function(e){return Pt?po(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function Wp(t){if(typeof ArrayBuffer>"u")return as(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n!=t.length;++n)r[n]=t.charCodeAt(n)&255;return e}function Sl(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function ON(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}function W1(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return W1(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var Ln=Pt?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:po(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),i=0;for(e=0,r=0;e<t.length;r+=i,++e)if(i=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function MN(t){for(var e=[],r=0,n=t.length+250,i=fl(t.length+255),s=0;s<t.length;++s){var a=t.charCodeAt(s);if(a<128)i[r++]=a;else if(a<2048)i[r++]=192|a>>6&31,i[r++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=t.charCodeAt(++s)&1023;i[r++]=240|a>>8&7,i[r++]=128|a>>2&63,i[r++]=128|o>>6&15|(a&3)<<4,i[r++]=128|o&63}else i[r++]=224|a>>12&15,i[r++]=128|a>>6&63,i[r++]=128|a&63;r>n&&(e.push(i.slice(0,r)),r=0,i=fl(65535),n=65530)}return e.push(i.slice(0,r)),Ln(e)}var Ni=/\u0000/g,Td=/[\u0001-\u0006]/g;function au(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function Zs(t,e){var r=""+t;return r.length>=e?r:tn("0",e-r.length)+r}function $1(t,e){var r=""+t;return r.length>=e?r:tn(" ",e-r.length)+r}function Jh(t,e){var r=""+t;return r.length>=e?r:r+tn(" ",e-r.length)}function BN(t,e){var r=""+Math.round(t);return r.length>=e?r:tn("0",e-r.length)+r}function jN(t,e){var r=""+t;return r.length>=e?r:tn("0",e-r.length)+r}var $2=Math.pow(2,32);function Nc(t,e){if(t>$2||t<-$2)return BN(t,e);var r=Math.round(t);return jN(r,e)}function Zh(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var H2=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Wg=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function LN(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var pt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},G2={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},UN={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function ep(t,e,r){for(var n=t<0?-1:1,i=t*n,s=0,a=1,o=0,l=1,u=0,f=0,p=Math.floor(i);u<e&&(p=Math.floor(i),o=p*a+s,f=p*u+l,!(i-p<5e-8));)i=1/(i-p),s=a,a=o,l=u,u=f;if(f>e&&(u>e?(f=l,o=s):(f=u,o=a)),!r)return[0,n*o,f];var g=Math.floor(n*o/f);return[g,n*o-g*f,f]}function jl(t,e,r){if(t>2958465||t<0)return null;var n=t|0,i=Math.floor(86400*(t-n)),s=0,a=[],o={D:n,T:i,u:86400*(t-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++n,++o.D)),n===60)a=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)a=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),a=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),n<60&&(s=(s+6)%7),r&&(s=GN(l,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=s,o}var RT=new Date(1899,11,31,0,0,0),VN=RT.getTime(),zN=new Date(1900,2,1,0,0,0);function DT(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=zN&&(r+=24*60*60*1e3),(r-(VN+(t.getTimezoneOffset()-RT.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function H1(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function WN(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function $N(t){var e=t<0?12:11,r=H1(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function HN(t){var e=H1(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function vf(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=$N(t):e===10?r=t.toFixed(10).substr(0,12):r=HN(t),H1(WN(r.toUpperCase()))}function Zl(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):vf(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return Bs(14,DT(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function GN(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function KN(t,e,r,n){var i="",s=0,a=0,o=r.y,l,u=0;switch(t){case 98:o=r.y+543;case 121:switch(e.length){case 1:case 2:l=o%100,u=2;break;default:l=o%1e4,u=4;break}break;case 109:switch(e.length){case 1:case 2:l=r.m,u=e.length;break;case 3:return Wg[r.m-1][1];case 5:return Wg[r.m-1][0];default:return Wg[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:l=r.d,u=e.length;break;case 3:return H2[r.q][0];default:return H2[r.q][1]}break;case 104:switch(e.length){case 1:case 2:l=1+(r.H+11)%12,u=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:l=r.H,u=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:l=r.M,u=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?Zs(r.S,e.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,s=Math.round(a*(r.S+r.u)),s>=60*a&&(s=0),e==="s"?s===0?"0":""+s/a:(i=Zs(s,2+n),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}u=e.length===3?1:2;break;case 101:l=o,u=1;break}var f=u>0?Zs(l,u):"";return f}function Yo(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var PT=/%/g;function YN(t,e,r){var n=e.replace(PT,""),i=e.length-n.length;return Ja(t,n,r*Math.pow(10,2*i))+tn("%",i)}function XN(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Ja(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function OT(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+OT(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),r.indexOf("e")===-1){var a=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,u,f){return l+u+f.substr(0,(i+s)%i)+"."+f.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var MT=/# (\?+)( ?)\/( ?)(\d+)/;function qN(t,e,r){var n=parseInt(t[4],10),i=Math.round(e*n),s=Math.floor(i/n),a=i-s*n,o=n;return r+(s===0?"":""+s)+" "+(a===0?tn(" ",t[1].length+1+t[4].length):$1(a,t[1].length)+t[2]+"/"+t[3]+Zs(o,t[4].length))}function QN(t,e,r){return r+(e===0?"":""+e)+tn(" ",t[1].length+2+t[4].length)}var BT=/^#*0*\.([0#]+)/,jT=/\).*[0#]/,LT=/\(###\) ###\\?-####/;function Fi(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function K2(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function Y2(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function JN(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function ZN(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Ts(t,e,r){if(t.charCodeAt(0)===40&&!e.match(jT)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ts("n",n,r):"("+Ts("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return XN(t,e,r);if(e.indexOf("%")!==-1)return YN(t,e,r);if(e.indexOf("E")!==-1)return OT(e,r);if(e.charCodeAt(0)===36)return"$"+Ts(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),u=r<0?"-":"";if(e.match(/^00+$/))return u+Nc(l,e.length);if(e.match(/^[#?]+$/))return i=Nc(r,0),i==="0"&&(i=""),i.length>e.length?i:Fi(e.substr(0,e.length-i.length))+i;if(s=e.match(MT))return qN(s,l,u);if(e.match(/^#+0+$/))return u+Nc(l,e.length-e.indexOf("0"));if(s=e.match(BT))return i=K2(r,s[1].length).replace(/^([^\.]+)$/,"$1."+Fi(s[1])).replace(/\.$/,"."+Fi(s[1])).replace(/\.(\d*)$/,function(y,x){return"."+x+tn("0",Fi(s[1]).length-x.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return u+K2(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return u+Yo(Nc(l,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ts(t,e,-r):Yo(""+(Math.floor(r)+JN(r,s[1].length)))+"."+Zs(Y2(r,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return Ts(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=au(Ts(t,e.replace(/[\\-]/g,""),r)),a=0,au(au(e.replace(/\\/g,"")).replace(/[0#]/g,function(y){return a<i.length?i.charAt(a++):y==="0"?"0":""}));if(e.match(LT))return i=Ts(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var f="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=ep(l,Math.pow(10,a)-1,!1),i=""+u,f=Ja("n",s[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),i+=f+s[2]+"/"+s[3],f=Jh(o[2],a),f.length<s[4].length&&(f=Fi(s[4].substr(s[4].length-f.length))+f),i+=f,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=ep(l,Math.pow(10,a)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?$1(o[1],a)+s[2]+"/"+s[3]+Jh(o[2],a):tn(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=Nc(r,0),e.length<=i.length?i:Fi(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var p=e.indexOf(".")-a,g=e.length-i.length-p;return Fi(e.substr(0,p)+i+e.substr(e.length-g))}if(s=e.match(/^00,000\.([#0]*0)$/))return a=Y2(r,s[1].length),r<0?"-"+Ts(t,e,-r):Yo(ZN(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?Zs(0,3-y.length):"")+y})+"."+Zs(a,s[1].length);switch(e){case"###,##0.00":return Ts(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var m=Yo(Nc(l,0));return m!=="0"?u+m:"";case"###,###.00":return Ts(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Ts(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function eR(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Ja(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function tR(t,e,r){var n=e.replace(PT,""),i=e.length-n.length;return Ja(t,n,r*Math.pow(10,2*i))+tn("%",i)}function UT(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+UT(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!r.match(/[Ee]/)){var a=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,u,f){return l+u+f.substr(0,(i+s)%i)+"."+f.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Ea(t,e,r){if(t.charCodeAt(0)===40&&!e.match(jT)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ea("n",n,r):"("+Ea("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return eR(t,e,r);if(e.indexOf("%")!==-1)return tR(t,e,r);if(e.indexOf("E")!==-1)return UT(e,r);if(e.charCodeAt(0)===36)return"$"+Ea(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),u=r<0?"-":"";if(e.match(/^00+$/))return u+Zs(l,e.length);if(e.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>e.length?i:Fi(e.substr(0,e.length-i.length))+i;if(s=e.match(MT))return QN(s,l,u);if(e.match(/^#+0+$/))return u+Zs(l,e.length-e.indexOf("0"));if(s=e.match(BT))return i=(""+r).replace(/^([^\.]+)$/,"$1."+Fi(s[1])).replace(/\.$/,"."+Fi(s[1])),i=i.replace(/\.(\d*)$/,function(y,x){return"."+x+tn("0",Fi(s[1]).length-x.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return u+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return u+Yo(""+l);if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ea(t,e,-r):Yo(""+r)+"."+tn("0",s[1].length);if(s=e.match(/^#,#*,#0/))return Ea(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=au(Ea(t,e.replace(/[\\-]/g,""),r)),a=0,au(au(e.replace(/\\/g,"")).replace(/[0#]/g,function(y){return a<i.length?i.charAt(a++):y==="0"?"0":""}));if(e.match(LT))return i=Ea(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var f="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=ep(l,Math.pow(10,a)-1,!1),i=""+u,f=Ja("n",s[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),i+=f+s[2]+"/"+s[3],f=Jh(o[2],a),f.length<s[4].length&&(f=Fi(s[4].substr(s[4].length-f.length))+f),i+=f,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=ep(l,Math.pow(10,a)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?$1(o[1],a)+s[2]+"/"+s[3]+Jh(o[2],a):tn(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=""+r,e.length<=i.length?i:Fi(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var p=e.indexOf(".")-a,g=e.length-i.length-p;return Fi(e.substr(0,p)+i+e.substr(e.length-g))}if(s=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Ea(t,e,-r):Yo(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?Zs(0,3-y.length):"")+y})+"."+Zs(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var m=Yo(""+l);return m!=="0"?u+m:"";default:if(e.match(/\.[0#?]*$/))return Ea(t,e.slice(0,e.lastIndexOf(".")),r)+Fi(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Ja(t,e,r){return(r|0)===r?Ea(t,e,r):Ts(t,e,r)}function rR(t){for(var e=[],r=!1,n=0,i=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(i,n-i),i=n+1}if(e[e.length]=t.substr(i),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var VT=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Mu(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":Zh(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(VT))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function nR(t,e,r,n){for(var i=[],s="",a=0,o="",l="t",u,f,p,g="H";a<t.length;)switch(o=t.charAt(a)){case"G":if(!Zh(t,a))throw new Error("unrecognized character "+o+" in "+t);i[i.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(p=t.charCodeAt(++a))!==34&&a<t.length;)s+=String.fromCharCode(p);i[i.length]={t:"t",v:s},++a;break;case"\\":var m=t.charAt(++a),y=m==="("||m===")"?m:"t";i[i.length]={t:y,v:m},++a;break;case"_":i[i.length]={t:"t",v:" "},a+=2;break;case"@":i[i.length]={t:"T",v:e},++a;break;case"B":case"b":if(t.charAt(a+1)==="1"||t.charAt(a+1)==="2"){if(u==null&&(u=jl(e,r,t.charAt(a+1)==="2"),u==null))return"";i[i.length]={t:"X",v:t.substr(a,2)},l=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||u==null&&(u=jl(e,r),u==null))return"";for(s=o;++a<t.length&&t.charAt(a).toLowerCase()===o;)s+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=g),i[i.length]={t:o,v:s},l=o;break;case"A":case"a":case"":var x={t:o,v:o};if(u==null&&(u=jl(e,r)),t.substr(a,3).toUpperCase()==="A/P"?(u!=null&&(x.v=u.H>=12?"P":"A"),x.t="T",g="h",a+=3):t.substr(a,5).toUpperCase()==="AM/PM"?(u!=null&&(x.v=u.H>=12?"PM":"AM"),x.t="T",a+=5,g="h"):t.substr(a,5).toUpperCase()==="/"?(u!=null&&(x.v=u.H>=12?"":""),x.t="T",a+=5,g="h"):(x.t="t",++a),u==null&&x.t==="T")return"";i[i.length]=x,l=o;break;case"[":for(s=o;t.charAt(a++)!=="]"&&a<t.length;)s+=t.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(VT)){if(u==null&&(u=jl(e,r),u==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",Mu(t)||(i[i.length]={t:"t",v:s}));break;case".":if(u!=null){for(s=o;++a<t.length&&(o=t.charAt(a))==="0";)s+=o;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++a<t.length&&"0#?.,E+-%".indexOf(o=t.charAt(a))>-1;)s+=o;i[i.length]={t:"n",v:s};break;case"?":for(s=o;t.charAt(++a)===o;)s+=o;i[i.length]={t:o,v:s},l=o;break;case"*":++a,(t.charAt(a)==" "||t.charAt(a)=="*")&&++a;break;case"(":case")":i[i.length]={t:n===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;a<t.length&&"0123456789".indexOf(t.charAt(++a))>-1;)s+=t.charAt(a);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:o,v:o},++a;break;case"$":i[i.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+t);i[i.length]={t:"t",v:o},++a;break}var S=0,A=0,C;for(a=i.length-1,l="t";a>=0;--a)switch(i[a].t){case"h":case"H":i[a].t=g,l="h",S<1&&(S=1);break;case"s":(C=i[a].v.match(/\.0+$/))&&(A=Math.max(A,C[0].length-1)),S<3&&(S=3);case"d":case"y":case"M":case"e":l=i[a].t;break;case"m":l==="s"&&(i[a].t="M",S<2&&(S=2));break;case"X":break;case"Z":S<1&&i[a].v.match(/[Hh]/)&&(S=1),S<2&&i[a].v.match(/[Mm]/)&&(S=2),S<3&&i[a].v.match(/[Ss]/)&&(S=3)}switch(S){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var E="",O;for(a=0;a<i.length;++a)switch(i[a].t){case"t":case"T":case" ":case"D":break;case"X":i[a].v="",i[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[a].v=KN(i[a].t.charCodeAt(0),i[a].v,u,A),i[a].t="t";break;case"n":case"?":for(O=a+1;i[O]!=null&&((o=i[O].t)==="?"||o==="D"||(o===" "||o==="t")&&i[O+1]!=null&&(i[O+1].t==="?"||i[O+1].t==="t"&&i[O+1].v==="/")||i[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[O].v==="/"||i[O].v===" "&&i[O+1]!=null&&i[O+1].t=="?"));)i[a].v+=i[O].v,i[O]={v:"",t:";"},++O;E+=i[a].v,a=O-1;break;case"G":i[a].t="t",i[a].v=Zl(e,r);break}var q="",H,T;if(E.length>0){E.charCodeAt(0)==40?(H=e<0&&E.charCodeAt(0)===45?-e:e,T=Ja("n",E,H)):(H=e<0&&n>1?-e:e,T=Ja("n",E,H),H<0&&i[0]&&i[0].t=="t"&&(T=T.substr(1),i[0].v="-"+i[0].v)),O=T.length-1;var F=i.length;for(a=0;a<i.length;++a)if(i[a]!=null&&i[a].t!="t"&&i[a].v.indexOf(".")>-1){F=a;break}var w=i.length;if(F===i.length&&T.indexOf("E")===-1){for(a=i.length-1;a>=0;--a)i[a]==null||"n?".indexOf(i[a].t)===-1||(O>=i[a].v.length-1?(O-=i[a].v.length,i[a].v=T.substr(O+1,i[a].v.length)):O<0?i[a].v="":(i[a].v=T.substr(0,O+1),O=-1),i[a].t="t",w=a);O>=0&&w<i.length&&(i[w].v=T.substr(0,O+1)+i[w].v)}else if(F!==i.length&&T.indexOf("E")===-1){for(O=T.indexOf(".")-1,a=F;a>=0;--a)if(!(i[a]==null||"n?".indexOf(i[a].t)===-1)){for(f=i[a].v.indexOf(".")>-1&&a===F?i[a].v.indexOf(".")-1:i[a].v.length-1,q=i[a].v.substr(f+1);f>=0;--f)O>=0&&(i[a].v.charAt(f)==="0"||i[a].v.charAt(f)==="#")&&(q=T.charAt(O--)+q);i[a].v=q,i[a].t="t",w=a}for(O>=0&&w<i.length&&(i[w].v=T.substr(0,O+1)+i[w].v),O=T.indexOf(".")+1,a=F;a<i.length;++a)if(!(i[a]==null||"n?(".indexOf(i[a].t)===-1&&a!==F)){for(f=i[a].v.indexOf(".")>-1&&a===F?i[a].v.indexOf(".")+1:0,q=i[a].v.substr(0,f);f<i[a].v.length;++f)O<T.length&&(q+=T.charAt(O++));i[a].v=q,i[a].t="t",w=a}}}for(a=0;a<i.length;++a)i[a]!=null&&"n?".indexOf(i[a].t)>-1&&(H=n>1&&e<0&&a>0&&i[a-1].v==="-"?-e:e,i[a].v=Ja(i[a].t,i[a].v,H),i[a].t="t");var N="";for(a=0;a!==i.length;++a)i[a]!=null&&(N+=i[a].v);return N}var X2=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function q2(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function iR(t,e){var r=rR(t),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var a=r[0].match(X2),o=r[1].match(X2);return q2(e,a)?[n,r[0]]:q2(e,o)?[n,r[1]]:[n,r[a!=null&&o!=null?2:1]]}return[n,s]}function Bs(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:pt)[t],n==null&&(n=r.table&&r.table[G2[t]]||pt[G2[t]]),n==null&&(n=UN[t]||"General");break}if(Zh(n,0))return Zl(e,r);e instanceof Date&&(e=DT(e,r.date1904));var i=iR(n,e);if(Zh(i[1]))return Zl(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return nR(i[1],e,r,i[0])}function Za(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(pt[r]==null){e<0&&(e=r);continue}if(pt[r]==t){e=r;break}}e<0&&(e=391)}return pt[e]=t,e}function $p(t){for(var e=0;e!=392;++e)t[e]!==void 0&&Za(t[e],e)}function Bu(){pt=LN()}var sR={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},zT=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function aR(t){var e=typeof t=="number"?pt[t]:t;return e=e.replace(zT,"(\\d+)"),new RegExp("^"+e+"$")}function oR(t,e,r){var n=-1,i=-1,s=-1,a=-1,o=-1,l=-1;(e.match(zT)||[]).forEach(function(p,g){var m=parseInt(r[g+1],10);switch(p.toLowerCase().charAt(0)){case"y":n=m;break;case"d":s=m;break;case"h":a=m;break;case"s":l=m;break;case"m":a>=0?o=m:i=m;break}}),l>=0&&o==-1&&i>=0&&(o=i,i=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var f=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return a==-1&&o==-1&&l==-1?u:n==-1&&i==-1&&s==-1?f:u+"T"+f}var lR=function(){var t={};t.version="1.2.0";function e(){for(var T=0,F=new Array(256),w=0;w!=256;++w)T=w,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,F[w]=T;return typeof Int32Array<"u"?new Int32Array(F):F}var r=e();function n(T){var F=0,w=0,N=0,D=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(N=0;N!=256;++N)D[N]=T[N];for(N=0;N!=256;++N)for(w=T[N],F=256+N;F<4096;F+=256)w=D[F]=w>>>8^T[w&255];var P=[];for(N=1;N!=16;++N)P[N-1]=typeof Int32Array<"u"?D.subarray(N*256,N*256+256):D.slice(N*256,N*256+256);return P}var i=n(r),s=i[0],a=i[1],o=i[2],l=i[3],u=i[4],f=i[5],p=i[6],g=i[7],m=i[8],y=i[9],x=i[10],S=i[11],A=i[12],C=i[13],E=i[14];function O(T,F){for(var w=F^-1,N=0,D=T.length;N<D;)w=w>>>8^r[(w^T.charCodeAt(N++))&255];return~w}function q(T,F){for(var w=F^-1,N=T.length-15,D=0;D<N;)w=E[T[D++]^w&255]^C[T[D++]^w>>8&255]^A[T[D++]^w>>16&255]^S[T[D++]^w>>>24]^x[T[D++]]^y[T[D++]]^m[T[D++]]^g[T[D++]]^p[T[D++]]^f[T[D++]]^u[T[D++]]^l[T[D++]]^o[T[D++]]^a[T[D++]]^s[T[D++]]^r[T[D++]];for(N+=15;D<N;)w=w>>>8^r[(w^T[D++])&255];return~w}function H(T,F){for(var w=F^-1,N=0,D=T.length,P=0,R=0;N<D;)P=T.charCodeAt(N++),P<128?w=w>>>8^r[(w^P)&255]:P<2048?(w=w>>>8^r[(w^(192|P>>6&31))&255],w=w>>>8^r[(w^(128|P&63))&255]):P>=55296&&P<57344?(P=(P&1023)+64,R=T.charCodeAt(N++)&1023,w=w>>>8^r[(w^(240|P>>8&7))&255],w=w>>>8^r[(w^(128|P>>2&63))&255],w=w>>>8^r[(w^(128|R>>6&15|(P&3)<<4))&255],w=w>>>8^r[(w^(128|R&63))&255]):(w=w>>>8^r[(w^(224|P>>12&15))&255],w=w>>>8^r[(w^(128|P>>6&63))&255],w=w>>>8^r[(w^(128|P&63))&255]);return~w}return t.table=r,t.bstr=O,t.buf=q,t.str=H,t}(),st=function(){var e={};e.version="1.2.1";function r(I,G){for(var j=I.split("/"),W=G.split("/"),Y=0,J=0,pe=Math.min(j.length,W.length);Y<pe;++Y){if(J=j[Y].length-W[Y].length)return J;if(j[Y]!=W[Y])return j[Y]<W[Y]?-1:1}return j.length-W.length}function n(I){if(I.charAt(I.length-1)=="/")return I.slice(0,-1).indexOf("/")===-1?I:n(I.slice(0,-1));var G=I.lastIndexOf("/");return G===-1?I:I.slice(0,G+1)}function i(I){if(I.charAt(I.length-1)=="/")return i(I.slice(0,-1));var G=I.lastIndexOf("/");return G===-1?I:I.slice(G+1)}function s(I,G){typeof G=="string"&&(G=new Date(G));var j=G.getHours();j=j<<6|G.getMinutes(),j=j<<5|G.getSeconds()>>>1,I.write_shift(2,j);var W=G.getFullYear()-1980;W=W<<4|G.getMonth()+1,W=W<<5|G.getDate(),I.write_shift(2,W)}function a(I){var G=I.read_shift(2)&65535,j=I.read_shift(2)&65535,W=new Date,Y=j&31;j>>>=5;var J=j&15;j>>>=4,W.setMilliseconds(0),W.setFullYear(j+1980),W.setMonth(J-1),W.setDate(Y);var pe=G&31;G>>>=5;var ve=G&63;return G>>>=6,W.setHours(G),W.setMinutes(ve),W.setSeconds(pe<<1),W}function o(I){qn(I,0);for(var G={},j=0;I.l<=I.length-4;){var W=I.read_shift(2),Y=I.read_shift(2),J=I.l+Y,pe={};switch(W){case 21589:j=I.read_shift(1),j&1&&(pe.mtime=I.read_shift(4)),Y>5&&(j&2&&(pe.atime=I.read_shift(4)),j&4&&(pe.ctime=I.read_shift(4))),pe.mtime&&(pe.mt=new Date(pe.mtime*1e3));break}I.l=J,G[W]=pe}return G}var l;function u(){return l||(l={})}function f(I,G){if(I[0]==80&&I[1]==75)return oa(I,G);if((I[0]|32)==109&&(I[1]|32)==105)return ca(I,G);if(I.length<512)throw new Error("CFB file size "+I.length+" < 512");var j=3,W=512,Y=0,J=0,pe=0,ve=0,he=0,de=[],ge=I.slice(0,512);qn(ge,0);var Ae=p(ge);switch(j=Ae[0],j){case 3:W=512;break;case 4:W=4096;break;case 0:if(Ae[1]==0)return oa(I,G);default:throw new Error("Major Version: Expected 3 or 4 saw "+j)}W!==512&&(ge=I.slice(0,W),qn(ge,28));var We=I.slice(0,W);g(ge,j);var Ue=ge.read_shift(4,"i");if(j===3&&Ue!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ue);ge.l+=4,pe=ge.read_shift(4,"i"),ge.l+=4,ge.chk("00100000","Mini Stream Cutoff Size: "),ve=ge.read_shift(4,"i"),Y=ge.read_shift(4,"i"),he=ge.read_shift(4,"i"),J=ge.read_shift(4,"i");for(var Me=-1,$e=0;$e<109&&(Me=ge.read_shift(4,"i"),!(Me<0));++$e)de[$e]=Me;var at=m(I,W);S(he,J,at,W,de);var ur=C(at,pe,de,W);ur[pe].name="!Directory",Y>0&&ve!==R&&(ur[ve].name="!MiniFAT"),ur[de[0]].name="!FAT",ur.fat_addrs=de,ur.ssz=W;var ir={},Gt=[],Ti=[],Ua=[];E(pe,ur,at,Gt,Y,ir,Ti,ve),y(Ti,Ua,Gt),Gt.shift();var qi={FileIndex:Ti,FullPaths:Ua};return G&&G.raw&&(qi.raw={header:We,sectors:at}),qi}function p(I){if(I[I.l]==80&&I[I.l+1]==75)return[0,0];I.chk(qe,"Header Signature: "),I.l+=16;var G=I.read_shift(2,"u");return[I.read_shift(2,"u"),G]}function g(I,G){var j=9;switch(I.l+=2,j=I.read_shift(2)){case 9:if(G!=3)throw new Error("Sector Shift: Expected 9 saw "+j);break;case 12:if(G!=4)throw new Error("Sector Shift: Expected 12 saw "+j);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+j)}I.chk("0600","Mini Sector Shift: "),I.chk("000000000000","Reserved: ")}function m(I,G){for(var j=Math.ceil(I.length/G)-1,W=[],Y=1;Y<j;++Y)W[Y-1]=I.slice(Y*G,(Y+1)*G);return W[j-1]=I.slice(j*G),W}function y(I,G,j){for(var W=0,Y=0,J=0,pe=0,ve=0,he=j.length,de=[],ge=[];W<he;++W)de[W]=ge[W]=W,G[W]=j[W];for(;ve<ge.length;++ve)W=ge[ve],Y=I[W].L,J=I[W].R,pe=I[W].C,de[W]===W&&(Y!==-1&&de[Y]!==Y&&(de[W]=de[Y]),J!==-1&&de[J]!==J&&(de[W]=de[J])),pe!==-1&&(de[pe]=W),Y!==-1&&W!=de[W]&&(de[Y]=de[W],ge.lastIndexOf(Y)<ve&&ge.push(Y)),J!==-1&&W!=de[W]&&(de[J]=de[W],ge.lastIndexOf(J)<ve&&ge.push(J));for(W=1;W<he;++W)de[W]===W&&(J!==-1&&de[J]!==J?de[W]=de[J]:Y!==-1&&de[Y]!==Y&&(de[W]=de[Y]));for(W=1;W<he;++W)if(I[W].type!==0){if(ve=W,ve!=de[ve])do ve=de[ve],G[W]=G[ve]+"/"+G[W];while(ve!==0&&de[ve]!==-1&&ve!=de[ve]);de[W]=-1}for(G[0]+="/",W=1;W<he;++W)I[W].type!==2&&(G[W]+="/")}function x(I,G,j){for(var W=I.start,Y=I.size,J=[],pe=W;j&&Y>0&&pe>=0;)J.push(G.slice(pe*P,pe*P+P)),Y-=P,pe=Dl(j,pe*4);return J.length===0?Ee(0):Ln(J).slice(0,I.size)}function S(I,G,j,W,Y){var J=R;if(I===R){if(G!==0)throw new Error("DIFAT chain shorter than expected")}else if(I!==-1){var pe=j[I],ve=(W>>>2)-1;if(!pe)return;for(var he=0;he<ve&&(J=Dl(pe,he*4))!==R;++he)Y.push(J);S(Dl(pe,W-4),G-1,j,W,Y)}}function A(I,G,j,W,Y){var J=[],pe=[];Y||(Y=[]);var ve=W-1,he=0,de=0;for(he=G;he>=0;){Y[he]=!0,J[J.length]=he,pe.push(I[he]);var ge=j[Math.floor(he*4/W)];if(de=he*4&ve,W<4+de)throw new Error("FAT boundary crossed: "+he+" 4 "+W);if(!I[ge])break;he=Dl(I[ge],de)}return{nodes:J,data:l_([pe])}}function C(I,G,j,W){var Y=I.length,J=[],pe=[],ve=[],he=[],de=W-1,ge=0,Ae=0,We=0,Ue=0;for(ge=0;ge<Y;++ge)if(ve=[],We=ge+G,We>=Y&&(We-=Y),!pe[We]){he=[];var Me=[];for(Ae=We;Ae>=0;){Me[Ae]=!0,pe[Ae]=!0,ve[ve.length]=Ae,he.push(I[Ae]);var $e=j[Math.floor(Ae*4/W)];if(Ue=Ae*4&de,W<4+Ue)throw new Error("FAT boundary crossed: "+Ae+" 4 "+W);if(!I[$e]||(Ae=Dl(I[$e],Ue),Me[Ae]))break}J[We]={nodes:ve,data:l_([he])}}return J}function E(I,G,j,W,Y,J,pe,ve){for(var he=0,de=W.length?2:0,ge=G[I].data,Ae=0,We=0,Ue;Ae<ge.length;Ae+=128){var Me=ge.slice(Ae,Ae+128);qn(Me,64),We=Me.read_shift(2),Ue=J1(Me,0,We-de),W.push(Ue);var $e={name:Ue,type:Me.read_shift(1),color:Me.read_shift(1),L:Me.read_shift(4,"i"),R:Me.read_shift(4,"i"),C:Me.read_shift(4,"i"),clsid:Me.read_shift(16),state:Me.read_shift(4,"i"),start:0,size:0},at=Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2);at!==0&&($e.ct=O(Me,Me.l-8));var ur=Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2);ur!==0&&($e.mt=O(Me,Me.l-8)),$e.start=Me.read_shift(4,"i"),$e.size=Me.read_shift(4,"i"),$e.size<0&&$e.start<0&&($e.size=$e.type=0,$e.start=R,$e.name=""),$e.type===5?(he=$e.start,Y>0&&he!==R&&(G[he].name="!StreamData")):$e.size>=4096?($e.storage="fat",G[$e.start]===void 0&&(G[$e.start]=A(j,$e.start,G.fat_addrs,G.ssz)),G[$e.start].name=$e.name,$e.content=G[$e.start].data.slice(0,$e.size)):($e.storage="minifat",$e.size<0?$e.size=0:he!==R&&$e.start!==R&&G[he]&&($e.content=x($e,G[he].data,(G[ve]||{}).data))),$e.content&&qn($e.content,0),J[Ue]=$e,pe.push($e)}}function O(I,G){return new Date((ss(I,G+4)/1e7*Math.pow(2,32)+ss(I,G)/1e7-11644473600)*1e3)}function q(I,G){return u(),f(l.readFileSync(I),G)}function H(I,G){var j=G&&G.type;switch(j||Pt&&Buffer.isBuffer(I)&&(j="buffer"),j||"base64"){case"file":return q(I,G);case"base64":return f(as(fs(I)),G);case"binary":return f(as(I),G)}return f(I,G)}function T(I,G){var j=G||{},W=j.root||"Root Entry";if(I.FullPaths||(I.FullPaths=[]),I.FileIndex||(I.FileIndex=[]),I.FullPaths.length!==I.FileIndex.length)throw new Error("inconsistent CFB structure");I.FullPaths.length===0&&(I.FullPaths[0]=W+"/",I.FileIndex[0]={name:W,type:5}),j.CLSID&&(I.FileIndex[0].clsid=j.CLSID),F(I)}function F(I){var G="Sh33tJ5";if(!st.find(I,"/"+G)){var j=Ee(4);j[0]=55,j[1]=j[3]=50,j[2]=54,I.FileIndex.push({name:G,type:2,content:j,size:4,L:69,R:69,C:69}),I.FullPaths.push(I.FullPaths[0]+G),w(I)}}function w(I,G){T(I);for(var j=!1,W=!1,Y=I.FullPaths.length-1;Y>=0;--Y){var J=I.FileIndex[Y];switch(J.type){case 0:W?j=!0:(I.FileIndex.pop(),I.FullPaths.pop());break;case 1:case 2:case 5:W=!0,isNaN(J.R*J.L*J.C)&&(j=!0),J.R>-1&&J.L>-1&&J.R==J.L&&(j=!0);break;default:j=!0;break}}if(!(!j&&!G)){var pe=new Date(1987,1,19),ve=0,he=Object.create?Object.create(null):{},de=[];for(Y=0;Y<I.FullPaths.length;++Y)he[I.FullPaths[Y]]=!0,I.FileIndex[Y].type!==0&&de.push([I.FullPaths[Y],I.FileIndex[Y]]);for(Y=0;Y<de.length;++Y){var ge=n(de[Y][0]);W=he[ge],W||(de.push([ge,{name:i(ge).replace("/",""),type:1,clsid:Oe,ct:pe,mt:pe,content:null}]),he[ge]=!0)}for(de.sort(function(Ue,Me){return r(Ue[0],Me[0])}),I.FullPaths=[],I.FileIndex=[],Y=0;Y<de.length;++Y)I.FullPaths[Y]=de[Y][0],I.FileIndex[Y]=de[Y][1];for(Y=0;Y<de.length;++Y){var Ae=I.FileIndex[Y],We=I.FullPaths[Y];if(Ae.name=i(We).replace("/",""),Ae.L=Ae.R=Ae.C=-(Ae.color=1),Ae.size=Ae.content?Ae.content.length:0,Ae.start=0,Ae.clsid=Ae.clsid||Oe,Y===0)Ae.C=de.length>1?1:-1,Ae.size=0,Ae.type=5;else if(We.slice(-1)=="/"){for(ve=Y+1;ve<de.length&&n(I.FullPaths[ve])!=We;++ve);for(Ae.C=ve>=de.length?-1:ve,ve=Y+1;ve<de.length&&n(I.FullPaths[ve])!=n(We);++ve);Ae.R=ve>=de.length?-1:ve,Ae.type=1}else n(I.FullPaths[Y+1]||"")==n(We)&&(Ae.R=Y+1),Ae.type=2}}}function N(I,G){var j=G||{};if(j.fileType=="mad")return Mr(I,j);switch(w(I),j.fileType){case"zip":return Us(I,j)}var W=function(Ue){for(var Me=0,$e=0,at=0;at<Ue.FileIndex.length;++at){var ur=Ue.FileIndex[at];if(ur.content){var ir=ur.content.length;ir>0&&(ir<4096?Me+=ir+63>>6:$e+=ir+511>>9)}}for(var Gt=Ue.FullPaths.length+3>>2,Ti=Me+7>>3,Ua=Me+127>>7,qi=Ti+$e+Gt+Ua,lr=qi+127>>7,ua=lr<=109?0:Math.ceil((lr-109)/127);qi+lr+ua+127>>7>lr;)ua=++lr<=109?0:Math.ceil((lr-109)/127);var Sr=[1,ua,lr,Ua,Gt,$e,Me,0];return Ue.FileIndex[0].size=Me<<6,Sr[7]=(Ue.FileIndex[0].start=Sr[0]+Sr[1]+Sr[2]+Sr[3]+Sr[4]+Sr[5])+(Sr[6]+7>>3),Sr}(I),Y=Ee(W[7]<<9),J=0,pe=0;{for(J=0;J<8;++J)Y.write_shift(1,Se[J]);for(J=0;J<8;++J)Y.write_shift(2,0);for(Y.write_shift(2,62),Y.write_shift(2,3),Y.write_shift(2,65534),Y.write_shift(2,9),Y.write_shift(2,6),J=0;J<3;++J)Y.write_shift(2,0);for(Y.write_shift(4,0),Y.write_shift(4,W[2]),Y.write_shift(4,W[0]+W[1]+W[2]+W[3]-1),Y.write_shift(4,0),Y.write_shift(4,4096),Y.write_shift(4,W[3]?W[0]+W[1]+W[2]-1:R),Y.write_shift(4,W[3]),Y.write_shift(-4,W[1]?W[0]-1:R),Y.write_shift(4,W[1]),J=0;J<109;++J)Y.write_shift(-4,J<W[2]?W[1]+J:-1)}if(W[1])for(pe=0;pe<W[1];++pe){for(;J<236+pe*127;++J)Y.write_shift(-4,J<W[2]?W[1]+J:-1);Y.write_shift(-4,pe===W[1]-1?R:pe+1)}var ve=function(Ue){for(pe+=Ue;J<pe-1;++J)Y.write_shift(-4,J+1);Ue&&(++J,Y.write_shift(-4,R))};for(pe=J=0,pe+=W[1];J<pe;++J)Y.write_shift(-4,be.DIFSECT);for(pe+=W[2];J<pe;++J)Y.write_shift(-4,be.FATSECT);ve(W[3]),ve(W[4]);for(var he=0,de=0,ge=I.FileIndex[0];he<I.FileIndex.length;++he)ge=I.FileIndex[he],ge.content&&(de=ge.content.length,!(de<4096)&&(ge.start=pe,ve(de+511>>9)));for(ve(W[6]+7>>3);Y.l&511;)Y.write_shift(-4,be.ENDOFCHAIN);for(pe=J=0,he=0;he<I.FileIndex.length;++he)ge=I.FileIndex[he],ge.content&&(de=ge.content.length,!(!de||de>=4096)&&(ge.start=pe,ve(de+63>>6)));for(;Y.l&511;)Y.write_shift(-4,be.ENDOFCHAIN);for(J=0;J<W[4]<<2;++J){var Ae=I.FullPaths[J];if(!Ae||Ae.length===0){for(he=0;he<17;++he)Y.write_shift(4,0);for(he=0;he<3;++he)Y.write_shift(4,-1);for(he=0;he<12;++he)Y.write_shift(4,0);continue}ge=I.FileIndex[J],J===0&&(ge.start=ge.size?ge.start-1:R);var We=J===0&&j.root||ge.name;if(de=2*(We.length+1),Y.write_shift(64,We,"utf16le"),Y.write_shift(2,de),Y.write_shift(1,ge.type),Y.write_shift(1,ge.color),Y.write_shift(-4,ge.L),Y.write_shift(-4,ge.R),Y.write_shift(-4,ge.C),ge.clsid)Y.write_shift(16,ge.clsid,"hex");else for(he=0;he<4;++he)Y.write_shift(4,0);Y.write_shift(4,ge.state||0),Y.write_shift(4,0),Y.write_shift(4,0),Y.write_shift(4,0),Y.write_shift(4,0),Y.write_shift(4,ge.start),Y.write_shift(4,ge.size),Y.write_shift(4,0)}for(J=1;J<I.FileIndex.length;++J)if(ge=I.FileIndex[J],ge.size>=4096)if(Y.l=ge.start+1<<9,Pt&&Buffer.isBuffer(ge.content))ge.content.copy(Y,Y.l,0,ge.size),Y.l+=ge.size+511&-512;else{for(he=0;he<ge.size;++he)Y.write_shift(1,ge.content[he]);for(;he&511;++he)Y.write_shift(1,0)}for(J=1;J<I.FileIndex.length;++J)if(ge=I.FileIndex[J],ge.size>0&&ge.size<4096)if(Pt&&Buffer.isBuffer(ge.content))ge.content.copy(Y,Y.l,0,ge.size),Y.l+=ge.size+63&-64;else{for(he=0;he<ge.size;++he)Y.write_shift(1,ge.content[he]);for(;he&63;++he)Y.write_shift(1,0)}if(Pt)Y.l=Y.length;else for(;Y.l<Y.length;)Y.write_shift(1,0);return Y}function D(I,G){var j=I.FullPaths.map(function(he){return he.toUpperCase()}),W=j.map(function(he){var de=he.split("/");return de[de.length-(he.slice(-1)=="/"?2:1)]}),Y=!1;G.charCodeAt(0)===47?(Y=!0,G=j[0].slice(0,-1)+G):Y=G.indexOf("/")!==-1;var J=G.toUpperCase(),pe=Y===!0?j.indexOf(J):W.indexOf(J);if(pe!==-1)return I.FileIndex[pe];var ve=!J.match(Td);for(J=J.replace(Ni,""),ve&&(J=J.replace(Td,"!")),pe=0;pe<j.length;++pe)if((ve?j[pe].replace(Td,"!"):j[pe]).replace(Ni,"")==J||(ve?W[pe].replace(Td,"!"):W[pe]).replace(Ni,"")==J)return I.FileIndex[pe];return null}var P=64,R=-2,qe="d0cf11e0a1b11ae1",Se=[208,207,17,224,161,177,26,225],Oe="00000000000000000000000000000000",be={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:R,FREESECT:-1,HEADER_SIGNATURE:qe,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Oe,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ke(I,G,j){u();var W=N(I,j);l.writeFileSync(G,W)}function ne(I){for(var G=new Array(I.length),j=0;j<I.length;++j)G[j]=String.fromCharCode(I[j]);return G.join("")}function Ie(I,G){var j=N(I,G);switch(G&&G.type||"buffer"){case"file":return u(),l.writeFileSync(G.filename,j),j;case"binary":return typeof j=="string"?j:ne(j);case"base64":return xf(typeof j=="string"?j:ne(j));case"buffer":if(Pt)return Buffer.isBuffer(j)?j:po(j);case"array":return typeof j=="string"?as(j):j}return j}var je;function K(I){try{var G=I.InflateRaw,j=new G;if(j._processChunk(new Uint8Array([3,0]),j._finishFlushFlag),j.bytesRead)je=I;else throw new Error("zlib does not expose bytesRead")}catch(W){console.error("cannot use native zlib: "+(W.message||W))}}function te(I,G){if(!je)return Ls(I,G);var j=je.InflateRaw,W=new j,Y=W._processChunk(I.slice(I.l),W._finishFlushFlag);return I.l+=W.bytesRead,Y}function re(I){return je?je.deflateRawSync(I):xt(I)}var X=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],_e=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Ce=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Ve(I){var G=(I<<1|I<<11)&139536|(I<<5|I<<15)&558144;return(G>>16|G>>8|G)&255}for(var De=typeof Uint8Array<"u",Ne=De?new Uint8Array(256):[],it=0;it<256;++it)Ne[it]=Ve(it);function Z(I,G){var j=Ne[I&255];return G<=8?j>>>8-G:(j=j<<8|Ne[I>>8&255],G<=16?j>>>16-G:(j=j<<8|Ne[I>>16&255],j>>>24-G))}function Rt(I,G){var j=G&7,W=G>>>3;return(I[W]|(j<=6?0:I[W+1]<<8))>>>j&3}function wt(I,G){var j=G&7,W=G>>>3;return(I[W]|(j<=5?0:I[W+1]<<8))>>>j&7}function Dt(I,G){var j=G&7,W=G>>>3;return(I[W]|(j<=4?0:I[W+1]<<8))>>>j&15}function Et(I,G){var j=G&7,W=G>>>3;return(I[W]|(j<=3?0:I[W+1]<<8))>>>j&31}function Ye(I,G){var j=G&7,W=G>>>3;return(I[W]|(j<=1?0:I[W+1]<<8))>>>j&127}function xr(I,G,j){var W=G&7,Y=G>>>3,J=(1<<j)-1,pe=I[Y]>>>W;return j<8-W||(pe|=I[Y+1]<<8-W,j<16-W)||(pe|=I[Y+2]<<16-W,j<24-W)||(pe|=I[Y+3]<<24-W),pe&J}function Zr(I,G,j){var W=G&7,Y=G>>>3;return W<=5?I[Y]|=(j&7)<<W:(I[Y]|=j<<W&255,I[Y+1]=(j&7)>>8-W),G+3}function En(I,G,j){var W=G&7,Y=G>>>3;return j=(j&1)<<W,I[Y]|=j,G+1}function Pi(I,G,j){var W=G&7,Y=G>>>3;return j<<=W,I[Y]|=j&255,j>>>=8,I[Y+1]=j,G+8}function Oi(I,G,j){var W=G&7,Y=G>>>3;return j<<=W,I[Y]|=j&255,j>>>=8,I[Y+1]=j&255,I[Y+2]=j>>>8,G+16}function Mi(I,G){var j=I.length,W=2*j>G?2*j:G+5,Y=0;if(j>=G)return I;if(Pt){var J=W2(W);if(I.copy)I.copy(J);else for(;Y<I.length;++Y)J[Y]=I[Y];return J}else if(De){var pe=new Uint8Array(W);if(pe.set)pe.set(I);else for(;Y<j;++Y)pe[Y]=I[Y];return pe}return I.length=W,I}function Vr(I){for(var G=new Array(I),j=0;j<I;++j)G[j]=0;return G}function Bi(I,G,j){var W=1,Y=0,J=0,pe=0,ve=0,he=I.length,de=De?new Uint16Array(32):Vr(32);for(J=0;J<32;++J)de[J]=0;for(J=he;J<j;++J)I[J]=0;he=I.length;var ge=De?new Uint16Array(he):Vr(he);for(J=0;J<he;++J)de[Y=I[J]]++,W<Y&&(W=Y),ge[J]=0;for(de[0]=0,J=1;J<=W;++J)de[J+16]=ve=ve+de[J-1]<<1;for(J=0;J<he;++J)ve=I[J],ve!=0&&(ge[J]=de[ve+16]++);var Ae=0;for(J=0;J<he;++J)if(Ae=I[J],Ae!=0)for(ve=Z(ge[J],W)>>W-Ae,pe=(1<<W+4-Ae)-1;pe>=0;--pe)G[ve|pe<<Ae]=Ae&15|J<<4;return W}var cr=De?new Uint16Array(512):Vr(512),zr=De?new Uint16Array(32):Vr(32);if(!De){for(var Ar=0;Ar<512;++Ar)cr[Ar]=0;for(Ar=0;Ar<32;++Ar)zr[Ar]=0}(function(){for(var I=[],G=0;G<32;G++)I.push(5);Bi(I,zr,32);var j=[];for(G=0;G<=143;G++)j.push(8);for(;G<=255;G++)j.push(9);for(;G<=279;G++)j.push(7);for(;G<=287;G++)j.push(8);Bi(j,cr,288)})();var Si=function(){for(var G=De?new Uint8Array(32768):[],j=0,W=0;j<Ce.length-1;++j)for(;W<Ce[j+1];++W)G[W]=j;for(;W<32768;++W)G[W]=29;var Y=De?new Uint8Array(259):[];for(j=0,W=0;j<_e.length-1;++j)for(;W<_e[j+1];++W)Y[W]=j;function J(ve,he){for(var de=0;de<ve.length;){var ge=Math.min(65535,ve.length-de),Ae=de+ge==ve.length;for(he.write_shift(1,+Ae),he.write_shift(2,ge),he.write_shift(2,~ge&65535);ge-- >0;)he[he.l++]=ve[de++]}return he.l}function pe(ve,he){for(var de=0,ge=0,Ae=De?new Uint16Array(32768):[];ge<ve.length;){var We=Math.min(65535,ve.length-ge);if(We<10){for(de=Zr(he,de,+(ge+We==ve.length)),de&7&&(de+=8-(de&7)),he.l=de/8|0,he.write_shift(2,We),he.write_shift(2,~We&65535);We-- >0;)he[he.l++]=ve[ge++];de=he.l*8;continue}de=Zr(he,de,+(ge+We==ve.length)+2);for(var Ue=0;We-- >0;){var Me=ve[ge];Ue=(Ue<<5^Me)&32767;var $e=-1,at=0;if(($e=Ae[Ue])&&($e|=ge&-32768,$e>ge&&($e-=32768),$e<ge))for(;ve[$e+at]==ve[ge+at]&&at<250;)++at;if(at>2){Me=Y[at],Me<=22?de=Pi(he,de,Ne[Me+1]>>1)-1:(Pi(he,de,3),de+=5,Pi(he,de,Ne[Me-23]>>5),de+=3);var ur=Me<8?0:Me-4>>2;ur>0&&(Oi(he,de,at-_e[Me]),de+=ur),Me=G[ge-$e],de=Pi(he,de,Ne[Me]>>3),de-=3;var ir=Me<4?0:Me-2>>1;ir>0&&(Oi(he,de,ge-$e-Ce[Me]),de+=ir);for(var Gt=0;Gt<at;++Gt)Ae[Ue]=ge&32767,Ue=(Ue<<5^ve[ge])&32767,++ge;We-=at-1}else Me<=143?Me=Me+48:de=En(he,de,1),de=Pi(he,de,Ne[Me]),Ae[Ue]=ge&32767,++ge}de=Pi(he,de,0)-1}return he.l=(de+7)/8|0,he.l}return function(he,de){return he.length<8?J(he,de):pe(he,de)}}();function xt(I){var G=Ee(50+Math.floor(I.length*1.1)),j=Si(I,G);return G.slice(0,j)}var Cr=De?new Uint16Array(32768):Vr(32768),Pr=De?new Uint16Array(32768):Vr(32768),Or=De?new Uint16Array(128):Vr(128),Rn=1,vo=1;function yo(I,G){var j=Et(I,G)+257;G+=5;var W=Et(I,G)+1;G+=5;var Y=Dt(I,G)+4;G+=4;for(var J=0,pe=De?new Uint8Array(19):Vr(19),ve=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],he=1,de=De?new Uint8Array(8):Vr(8),ge=De?new Uint8Array(8):Vr(8),Ae=pe.length,We=0;We<Y;++We)pe[X[We]]=J=wt(I,G),he<J&&(he=J),de[J]++,G+=3;var Ue=0;for(de[0]=0,We=1;We<=he;++We)ge[We]=Ue=Ue+de[We-1]<<1;for(We=0;We<Ae;++We)(Ue=pe[We])!=0&&(ve[We]=ge[Ue]++);var Me=0;for(We=0;We<Ae;++We)if(Me=pe[We],Me!=0){Ue=Ne[ve[We]]>>8-Me;for(var $e=(1<<7-Me)-1;$e>=0;--$e)Or[Ue|$e<<Me]=Me&7|We<<3}var at=[];for(he=1;at.length<j+W;)switch(Ue=Or[Ye(I,G)],G+=Ue&7,Ue>>>=3){case 16:for(J=3+Rt(I,G),G+=2,Ue=at[at.length-1];J-- >0;)at.push(Ue);break;case 17:for(J=3+wt(I,G),G+=3;J-- >0;)at.push(0);break;case 18:for(J=11+Ye(I,G),G+=7;J-- >0;)at.push(0);break;default:at.push(Ue),he<Ue&&(he=Ue);break}var ur=at.slice(0,j),ir=at.slice(j);for(We=j;We<286;++We)ur[We]=0;for(We=W;We<30;++We)ir[We]=0;return Rn=Bi(ur,Cr,286),vo=Bi(ir,Pr,30),G}function Gu(I,G){if(I[0]==3&&!(I[1]&3))return[fl(G),2];for(var j=0,W=0,Y=W2(G||1<<18),J=0,pe=Y.length>>>0,ve=0,he=0;!(W&1);){if(W=wt(I,j),j+=3,W>>>1)W>>1==1?(ve=9,he=5):(j=yo(I,j),ve=Rn,he=vo);else{j&7&&(j+=8-(j&7));var de=I[j>>>3]|I[(j>>>3)+1]<<8;if(j+=32,de>0)for(!G&&pe<J+de&&(Y=Mi(Y,J+de),pe=Y.length);de-- >0;)Y[J++]=I[j>>>3],j+=8;continue}for(;;){!G&&pe<J+32767&&(Y=Mi(Y,J+32767),pe=Y.length);var ge=xr(I,j,ve),Ae=W>>>1==1?cr[ge]:Cr[ge];if(j+=Ae&15,Ae>>>=4,!(Ae>>>8&255))Y[J++]=Ae;else{if(Ae==256)break;Ae-=257;var We=Ae<8?0:Ae-4>>2;We>5&&(We=0);var Ue=J+_e[Ae];We>0&&(Ue+=xr(I,j,We),j+=We),ge=xr(I,j,he),Ae=W>>>1==1?zr[ge]:Pr[ge],j+=Ae&15,Ae>>>=4;var Me=Ae<4?0:Ae-2>>1,$e=Ce[Ae];for(Me>0&&($e+=xr(I,j,Me),j+=Me),!G&&pe<Ue&&(Y=Mi(Y,Ue+100),pe=Y.length);J<Ue;)Y[J]=Y[J-$e],++J}}}return G?[Y,j+7>>>3]:[Y.slice(0,J),j+7>>>3]}function Ls(I,G){var j=I.slice(I.l||0),W=Gu(j,G);return I.l+=W[1],W[0]}function Al(I,G){if(I)typeof console<"u"&&console.error(G);else throw new Error(G)}function oa(I,G){var j=I;qn(j,0);var W=[],Y=[],J={FileIndex:W,FullPaths:Y};T(J,{root:G.root});for(var pe=j.length-4;(j[pe]!=80||j[pe+1]!=75||j[pe+2]!=5||j[pe+3]!=6)&&pe>=0;)--pe;j.l=pe+4,j.l+=4;var ve=j.read_shift(2);j.l+=6;var he=j.read_shift(4);for(j.l=he,pe=0;pe<ve;++pe){j.l+=20;var de=j.read_shift(4),ge=j.read_shift(4),Ae=j.read_shift(2),We=j.read_shift(2),Ue=j.read_shift(2);j.l+=8;var Me=j.read_shift(4),$e=o(j.slice(j.l+Ae,j.l+Ae+We));j.l+=Ae+We+Ue;var at=j.l;j.l=Me+4,Ba(j,de,ge,J,$e),j.l=at}return J}function Ba(I,G,j,W,Y){I.l+=2;var J=I.read_shift(2),pe=I.read_shift(2),ve=a(I);if(J&8257)throw new Error("Unsupported ZIP encryption");for(var he=I.read_shift(4),de=I.read_shift(4),ge=I.read_shift(4),Ae=I.read_shift(2),We=I.read_shift(2),Ue="",Me=0;Me<Ae;++Me)Ue+=String.fromCharCode(I[I.l++]);if(We){var $e=o(I.slice(I.l,I.l+We));($e[21589]||{}).mt&&(ve=$e[21589].mt),((Y||{})[21589]||{}).mt&&(ve=Y[21589].mt)}I.l+=We;var at=I.slice(I.l,I.l+de);switch(pe){case 8:at=te(I,ge);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+pe)}var ur=!1;J&8&&(he=I.read_shift(4),he==134695760&&(he=I.read_shift(4),ur=!0),de=I.read_shift(4),ge=I.read_shift(4)),de!=G&&Al(ur,"Bad compressed size: "+G+" != "+de),ge!=j&&Al(ur,"Bad uncompressed size: "+j+" != "+ge),ms(W,Ue,at,{unsafe:!0,mt:ve})}function Us(I,G){var j=G||{},W=[],Y=[],J=Ee(1),pe=j.compression?8:0,ve=0,he=0,de=0,ge=0,Ae=0,We=I.FullPaths[0],Ue=We,Me=I.FileIndex[0],$e=[],at=0;for(he=1;he<I.FullPaths.length;++he)if(Ue=I.FullPaths[he].slice(We.length),Me=I.FileIndex[he],!(!Me.size||!Me.content||Ue=="Sh33tJ5")){var ur=ge,ir=Ee(Ue.length);for(de=0;de<Ue.length;++de)ir.write_shift(1,Ue.charCodeAt(de)&127);ir=ir.slice(0,ir.l),$e[Ae]=lR.buf(Me.content,0);var Gt=Me.content;pe==8&&(Gt=re(Gt)),J=Ee(30),J.write_shift(4,67324752),J.write_shift(2,20),J.write_shift(2,ve),J.write_shift(2,pe),Me.mt?s(J,Me.mt):J.write_shift(4,0),J.write_shift(-4,$e[Ae]),J.write_shift(4,Gt.length),J.write_shift(4,Me.content.length),J.write_shift(2,ir.length),J.write_shift(2,0),ge+=J.length,W.push(J),ge+=ir.length,W.push(ir),ge+=Gt.length,W.push(Gt),J=Ee(46),J.write_shift(4,33639248),J.write_shift(2,0),J.write_shift(2,20),J.write_shift(2,ve),J.write_shift(2,pe),J.write_shift(4,0),J.write_shift(-4,$e[Ae]),J.write_shift(4,Gt.length),J.write_shift(4,Me.content.length),J.write_shift(2,ir.length),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(4,0),J.write_shift(4,ur),at+=J.l,Y.push(J),at+=ir.length,Y.push(ir),++Ae}return J=Ee(22),J.write_shift(4,101010256),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(2,Ae),J.write_shift(2,Ae),J.write_shift(4,at),J.write_shift(4,ge),J.write_shift(2,0),Ln([Ln(W),Ln(Y),J])}var le={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function or(I,G){if(I.ctype)return I.ctype;var j=I.name||"",W=j.match(/\.([^\.]+)$/);return W&&le[W[1]]||G&&(W=(j=G).match(/[\.\\]([^\.\\])+$/),W&&le[W[1]])?le[W[1]]:"application/octet-stream"}function la(I){for(var G=xf(I),j=[],W=0;W<G.length;W+=76)j.push(G.slice(W,W+76));return j.join(`\r
`)+`\r
`}function ja(I){var G=I.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(de){var ge=de.charCodeAt(0).toString(16).toUpperCase();return"="+(ge.length==1?"0"+ge:ge)});G=G.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),G.charAt(0)==`
`&&(G="=0D"+G.slice(1)),G=G.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var j=[],W=G.split(`\r
`),Y=0;Y<W.length;++Y){var J=W[Y];if(J.length==0){j.push("");continue}for(var pe=0;pe<J.length;){var ve=76,he=J.slice(pe,pe+ve);he.charAt(ve-1)=="="?ve--:he.charAt(ve-2)=="="?ve-=2:he.charAt(ve-3)=="="&&(ve-=3),he=J.slice(pe,pe+ve),pe+=ve,pe<J.length&&(he+="="),j.push(he)}}return j.join(`\r
`)}function La(I){for(var G=[],j=0;j<I.length;++j){for(var W=I[j];j<=I.length&&W.charAt(W.length-1)=="=";)W=W.slice(0,W.length-1)+I[++j];G.push(W)}for(var Y=0;Y<G.length;++Y)G[Y]=G[Y].replace(/[=][0-9A-Fa-f]{2}/g,function(J){return String.fromCharCode(parseInt(J.slice(1),16))});return as(G.join(`\r
`))}function gs(I,G,j){for(var W="",Y="",J="",pe,ve=0;ve<10;++ve){var he=G[ve];if(!he||he.match(/^\s*$/))break;var de=he.match(/^(.*?):\s*([^\s].*)$/);if(de)switch(de[1].toLowerCase()){case"content-location":W=de[2].trim();break;case"content-type":J=de[2].trim();break;case"content-transfer-encoding":Y=de[2].trim();break}}switch(++ve,Y.toLowerCase()){case"base64":pe=as(fs(G.slice(ve).join("")));break;case"quoted-printable":pe=La(G.slice(ve));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+Y)}var ge=ms(I,W.slice(j.length),pe,{unsafe:!0});J&&(ge.ctype=J)}function ca(I,G){if(ne(I.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var j=G&&G.root||"",W=(Pt&&Buffer.isBuffer(I)?I.toString("binary"):ne(I)).split(`\r
`),Y=0,J="";for(Y=0;Y<W.length;++Y)if(J=W[Y],!!/^Content-Location:/i.test(J)&&(J=J.slice(J.indexOf("file")),j||(j=J.slice(0,J.lastIndexOf("/")+1)),J.slice(0,j.length)!=j))for(;j.length>0&&(j=j.slice(0,j.length-1),j=j.slice(0,j.lastIndexOf("/")+1),J.slice(0,j.length)!=j););var pe=(W[1]||"").match(/boundary="(.*?)"/);if(!pe)throw new Error("MAD cannot find boundary");var ve="--"+(pe[1]||""),he=[],de=[],ge={FileIndex:he,FullPaths:de};T(ge);var Ae,We=0;for(Y=0;Y<W.length;++Y){var Ue=W[Y];Ue!==ve&&Ue!==ve+"--"||(We++&&gs(ge,W.slice(Ae,Y),j),Ae=Y)}return ge}function Mr(I,G){var j=G||{},W=j.boundary||"SheetJS";W="------="+W;for(var Y=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+W.slice(2)+'"',"","",""],J=I.FullPaths[0],pe=J,ve=I.FileIndex[0],he=1;he<I.FullPaths.length;++he)if(pe=I.FullPaths[he].slice(J.length),ve=I.FileIndex[he],!(!ve.size||!ve.content||pe=="Sh33tJ5")){pe=pe.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(at){return"_x"+at.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(at){return"_u"+at.charCodeAt(0).toString(16)+"_"});for(var de=ve.content,ge=Pt&&Buffer.isBuffer(de)?de.toString("binary"):ne(de),Ae=0,We=Math.min(1024,ge.length),Ue=0,Me=0;Me<=We;++Me)(Ue=ge.charCodeAt(Me))>=32&&Ue<128&&++Ae;var $e=Ae>=We*4/5;Y.push(W),Y.push("Content-Location: "+(j.root||"file:///C:/SheetJS/")+pe),Y.push("Content-Transfer-Encoding: "+($e?"quoted-printable":"base64")),Y.push("Content-Type: "+or(ve,pe)),Y.push(""),Y.push($e?ja(ge):la(ge))}return Y.push(W+`--\r
`),Y.join(`\r
`)}function Sn(I){var G={};return T(G,I),G}function ms(I,G,j,W){var Y=W&&W.unsafe;Y||T(I);var J=!Y&&st.find(I,G);if(!J){var pe=I.FullPaths[0];G.slice(0,pe.length)==pe?pe=G:(pe.slice(-1)!="/"&&(pe+="/"),pe=(pe+G).replace("//","/")),J={name:i(G),type:2},I.FileIndex.push(J),I.FullPaths.push(pe),Y||st.utils.cfb_gc(I)}return J.content=j,J.size=j?j.length:0,W&&(W.CLSID&&(J.clsid=W.CLSID),W.mt&&(J.mt=W.mt),W.ct&&(J.ct=W.ct)),J}function xs(I,G){T(I);var j=st.find(I,G);if(j){for(var W=0;W<I.FileIndex.length;++W)if(I.FileIndex[W]==j)return I.FileIndex.splice(W,1),I.FullPaths.splice(W,1),!0}return!1}function Ku(I,G,j){T(I);var W=st.find(I,G);if(W){for(var Y=0;Y<I.FileIndex.length;++Y)if(I.FileIndex[Y]==W)return I.FileIndex[Y].name=i(j),I.FullPaths[Y]=j,!0}return!1}function wi(I){w(I,!0)}return e.find=D,e.read=H,e.parse=f,e.write=Ie,e.writeFile=ke,e.utils={cfb_new:Sn,cfb_add:ms,cfb_del:xs,cfb_mov:Ku,cfb_gc:wi,ReadShift:Ld,CheckField:uA,prep_blob:qn,bconcat:Ln,use_zlib:K,_deflateRaw:xt,_inflateRaw:Ls,consts:be},e}();function cR(t){return typeof t=="string"?Wp(t):Array.isArray(t)?ON(t):t}function Hf(t,e,r){if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=Wp(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var n=r=="utf8"?Ca(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var i=new Blob([cR(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,t);if(typeof saveAs<"u")return saveAs(i,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:t,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=t,a.href=s,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(t);return o.open("w"),o.encoding="binary",Array.isArray(e)&&(e=Sl(e)),o.write(e),o.close(),e}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+t)}function uR(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function sn(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function Q2(t,e){for(var r=[],n=sn(t),i=0;i!==n.length;++i)r[t[n[i]][e]]==null&&(r[t[n[i]][e]]=n[i]);return r}function Hp(t){for(var e=[],r=sn(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}function Gp(t){for(var e=[],r=sn(t),n=0;n!==r.length;++n)e[t[r[n]]]=parseInt(r[n],10);return e}function dR(t){for(var e=[],r=sn(t),n=0;n!==r.length;++n)e[t[r[n]]]==null&&(e[t[r[n]]]=[]),e[t[r[n]]].push(r[n]);return e}var tp=new Date(1899,11,30,0,0,0);function Nn(t,e){var r=t.getTime(),n=tp.getTime()+(t.getTimezoneOffset()-tp.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var WT=new Date,fR=tp.getTime()+(WT.getTimezoneOffset()-tp.getTimezoneOffset())*6e4,J2=WT.getTimezoneOffset();function Kp(t){var e=new Date;return e.setTime(t*24*60*60*1e3+fR),e.getTimezoneOffset()!==J2&&e.setTime(e.getTime()+(e.getTimezoneOffset()-J2)*6e4),e}function hR(t){var e=0,r=0,n=!1,i=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var s=1;s!=i.length;++s)if(i[s]){switch(r=1,s>3&&(n=!0),i[s].slice(i[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[s].slice(i[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(i[s],10)}return e}var Z2=new Date("2017-02-19T19:06:09.000Z"),$T=isNaN(Z2.getFullYear())?new Date("2/19/17"):Z2,pR=$T.getFullYear()==2017;function Rr(t,e){var r=new Date(t);if(pR)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if($T.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=t.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return t.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function ec(t,e){if(Pt&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return Ca(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return Ca(NT(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return Ca(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return Ca(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],i=0;i!=t.length;++i)n.push(String.fromCharCode(t[i]));return n.join("")}function Dr(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=Dr(t[r]));return e}function tn(t,e){for(var r="";r.length<e;)r+=t;return r}function na(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return r=-r,s}),!isNaN(e=Number(n)))?e/r:e}var gR=["january","february","march","april","may","june","july","august","september","october","november","december"];function Eu(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),i=e.getMonth(),s=e.getDate();if(isNaN(s))return r;var a=t.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&gR.indexOf(a)==-1)return r}else if(a.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||s>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var mR=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(t||typeof n=="string")return r.split(n);for(var s=r.split(n),a=[s[0]],o=1;o<s.length;++o)a.push(i),a.push(s[o]);return a}}();function HT(t){return t?t.content&&t.type?ec(t.content,!0):t.data?wd(t.data):t.asNodeBuffer&&Pt?wd(t.asNodeBuffer().toString("binary")):t.asBinary?wd(t.asBinary()):t._data&&t._data.getContent?wd(ec(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function GT(t){if(!t)return null;if(t.data)return V2(t.data);if(t.asNodeBuffer&&Pt)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?V2(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function xR(t){return t&&t.name.slice(-4)===".bin"?GT(t):HT(t)}function ks(t,e){for(var r=t.FullPaths||sn(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var a=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==a||i==a)return t.files?t.files[r[s]]:t.FileIndex[s]}return null}function G1(t,e){var r=ks(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function vn(t,e,r){if(!r)return xR(G1(t,e));if(!e)return null;try{return vn(t,e)}catch{return null}}function os(t,e,r){if(!r)return HT(G1(t,e));if(!e)return null;try{return os(t,e)}catch{return null}}function vR(t,e,r){return GT(G1(t,e))}function e_(t){for(var e=t.FullPaths||sn(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function It(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return Pt?n=po(r):n=MN(r),st.utils.cfb_add(t,e,n)}st.utils.cfb_add(t,e,r)}else t.file(e,r)}function K1(){return st.utils.cfb_new()}function KT(t,e){switch(e.type){case"base64":return st.read(t,{type:"base64"});case"binary":return st.read(t,{type:"binary"});case"buffer":case"array":return st.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function Ad(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var dn=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,yR=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,t_=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,_R=/<[^>]*>/g,Ei=dn.match(t_)?t_:_R,ER=/<\w*:/,SR=/<(\/?)\w+:/;function mt(t,e,r){for(var n={},i=0,s=0;i!==t.length&&!((s=t.charCodeAt(i))===32||s===10||s===13);++i);if(e||(n[0]=t.slice(0,i)),i===t.length)return n;var a=t.match(yR),o=0,l="",u=0,f="",p="",g=1;if(a)for(u=0;u!=a.length;++u){for(p=a[u],s=0;s!=p.length&&p.charCodeAt(s)!==61;++s);for(f=p.slice(0,s).trim();p.charCodeAt(s+1)==32;)++s;for(g=(i=p.charCodeAt(s+1))==34||i==39?1:0,l=p.slice(s+1+g,p.length-g),o=0;o!=f.length&&f.charCodeAt(o)!==58;++o);if(o===f.length)f.indexOf("_")>0&&(f=f.slice(0,f.indexOf("_"))),n[f]=l,n[f.toLowerCase()]=l;else{var m=(o===5&&f.slice(0,5)==="xmlns"?"xmlns":"")+f.slice(o+1);if(n[m]&&f.slice(o-3,o)=="ext")continue;n[m]=l,n[m.toLowerCase()]=l}}return n}function Oa(t){return t.replace(SR,"<$1")}var YT={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Y1=Hp(YT),rr=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",s=i.indexOf("<![CDATA[");if(s==-1)return i.replace(t,function(o,l){return YT[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(e,function(o,l){return String.fromCharCode(parseInt(l,16))});var a=i.indexOf("]]>");return r(i.slice(0,s))+i.slice(s+9,a)+r(i.slice(a+3))}}(),X1=/[&<>'"]/g,wR=/[\u0000-\u0008\u000b-\u001f]/g;function pr(t){var e=t+"";return e.replace(X1,function(r){return Y1[r]}).replace(wR,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function r_(t){return pr(t).replace(/ /g,"_x0020_")}var XT=/[\u0000-\u001f]/g;function q1(t){var e=t+"";return e.replace(X1,function(r){return Y1[r]}).replace(/\n/g,"<br/>").replace(XT,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function TR(t){var e=t+"";return e.replace(X1,function(r){return Y1[r]}).replace(XT,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var n_=function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}}();function AR(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function Ir(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function $g(t){for(var e="",r=0,n=0,i=0,s=0,a=0,o=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(i=t.charCodeAt(r++),n>191&&n<224){a=(n&31)<<6,a|=i&63,e+=String.fromCharCode(a);continue}if(s=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}a=t.charCodeAt(r++),o=((n&7)<<18|(i&63)<<12|(s&63)<<6|a&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function i_(t){var e=fl(2*t.length),r,n,i=1,s=0,a=0,o;for(n=0;n<t.length;n+=i)i=1,(o=t.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(t.charCodeAt(n+1)&63),i=2):o<240?(r=(o&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),i=3):(i=4,r=(o&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,a=55296+(r>>>10&1023),r=56320+(r&1023)),a!==0&&(e[s++]=a&255,e[s++]=a>>>8,a=0),e[s++]=r%256,e[s++]=r>>>8;return e.slice(0,s).toString("ucs2")}function s_(t){return po(t,"binary").toString("utf8")}var B0="foo bar baz",vr=Pt&&(s_(B0)==$g(B0)&&s_||i_(B0)==$g(B0)&&i_)||$g,Ca=Pt?function(t){return po(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,i=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},yf=function(){var t={};return function(r,n){var i=r+"|"+(n||"");return t[i]?t[i]:t[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),qT=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<t.length;++i)n=n.replace(t[i][0],t[i][1]);return n}}(),CR=function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),kR=/<\/?(?:vt:)?variant>/g,FR=/<(?:vt:)([^>]*)>([\s\S]*)</;function a_(t,e){var r=mt(t),n=t.match(CR(r.baseType))||[],i=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(s){var a=s.replace(kR,"").match(FR);a&&i.push({v:vr(a[2]),t:a[1]})}),i}var QT=/(^\s|\s$|\n)/;function Qn(t,e){return"<"+t+(e.match(QT)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function _f(t){return sn(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function Ge(t,e,r){return"<"+t+(r!=null?_f(r):"")+(e!=null?(e.match(QT)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function fx(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function bR(t,e){switch(typeof t){case"string":var r=Ge("vt:lpwstr",pr(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Ge((t|0)==t?"vt:i4":"vt:r8",pr(String(t)));case"boolean":return Ge("vt:bool",t?"true":"false")}if(t instanceof Date)return Ge("vt:filetime",fx(t));throw new Error("Unable to serialize "+t)}function Q1(t){if(Pt&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return vr(Sl(W1(t)));throw new Error("Bad input format: expected Buffer or string")}var Ef=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,kn={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},fc=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],is={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function IR(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),i=t[e+6]&15,s=5;s>=0;--s)i=i*256+t[e+s];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function NR(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,i=0,s=0,a=n?-e:e;isFinite(a)?a==0?i=s=0:(i=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(e)?26985:0);for(var o=0;o<=5;++o,s/=256)t[r+o]=s&255;t[r+6]=(i&15)<<4|s&15,t[r+7]=i>>4|n}var o_=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var i=0,s=t[0][n].length;i<s;i+=r)e.push.apply(e,t[0][n].slice(i,i+r));return e},l_=Pt?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:po(e)})):o_(t)}:o_,c_=function(t,e,r){for(var n=[],i=e;i<r;i+=2)n.push(String.fromCharCode(Ka(t,i)));return n.join("").replace(Ni,"")},J1=Pt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(Ni,""):c_(t,e,r)}:c_,u_=function(t,e,r){for(var n=[],i=e;i<e+r;++i)n.push(("0"+t[i].toString(16)).slice(-2));return n.join("")},JT=Pt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):u_(t,e,r)}:u_,d_=function(t,e,r){for(var n=[],i=e;i<r;i++)n.push(String.fromCharCode(Mc(t,i)));return n.join("")},Gf=Pt?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):d_(e,r,n)}:d_,ZT=function(t,e){var r=ss(t,e);return r>0?Gf(t,e+4,e+4+r-1):""},eA=ZT,tA=function(t,e){var r=ss(t,e);return r>0?Gf(t,e+4,e+4+r-1):""},rA=tA,nA=function(t,e){var r=2*ss(t,e);return r>0?Gf(t,e+4,e+4+r-1):""},iA=nA,sA=function(e,r){var n=ss(e,r);return n>0?J1(e,r+4,r+4+n):""},aA=sA,oA=function(t,e){var r=ss(t,e);return r>0?Gf(t,e+4,e+4+r):""},lA=oA,cA=function(t,e){return IR(t,e)},rp=cA,Z1=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Pt&&(eA=function(e,r){if(!Buffer.isBuffer(e))return ZT(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},rA=function(e,r){if(!Buffer.isBuffer(e))return tA(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},iA=function(e,r){if(!Buffer.isBuffer(e))return nA(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},aA=function(e,r){if(!Buffer.isBuffer(e))return sA(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},lA=function(e,r){if(!Buffer.isBuffer(e))return oA(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},rp=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):cA(e,r)},Z1=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Mc=function(t,e){return t[e]},Ka=function(t,e){return t[e+1]*256+t[e]},RR=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},ss=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},Dl=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},DR=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function Ld(t,e){var r="",n,i,s=[],a,o,l,u;switch(e){case"dbcs":if(u=this.l,Pt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(l=0;l<t;++l)r+=String.fromCharCode(Ka(this,u)),u+=2;t*=2;break;case"utf8":r=Gf(this,this.l,this.l+t);break;case"utf16le":t*=2,r=J1(this,this.l,this.l+t);break;case"wstr":return Ld.call(this,t,"dbcs");case"lpstr-ansi":r=eA(this,this.l),t=4+ss(this,this.l);break;case"lpstr-cp":r=rA(this,this.l),t=4+ss(this,this.l);break;case"lpwstr":r=iA(this,this.l),t=4+2*ss(this,this.l);break;case"lpp4":t=4+ss(this,this.l),r=aA(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+ss(this,this.l),r=lA(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(a=Mc(this,this.l+t++))!==0;)s.push(M0(a));r=s.join("");break;case"_wstr":for(t=0,r="";(a=Ka(this,this.l+t))!==0;)s.push(M0(a)),t+=2;t+=2,r=s.join("");break;case"dbcs-cont":for(r="",u=this.l,l=0;l<t;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return a=Mc(this,u),this.l=u+1,o=Ld.call(this,t-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(M0(Ka(this,u))),u+=2}r=s.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,l=0;l!=t;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return a=Mc(this,u),this.l=u+1,o=Ld.call(this,t-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(M0(Mc(this,u))),u+=1}r=s.join("");break;default:switch(t){case 1:return n=Mc(this,this.l),this.l++,n;case 2:return n=(e==="i"?RR:Ka)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(t>0?Dl:DR)(this,this.l),this.l+=4,n):(i=ss(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return t==8?i=rp(this,this.l):i=rp([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;t=8;case 16:r=JT(this,this.l,t);break}}return this.l+=t,r}var PR=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},OR=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},MR=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function BR(t,e,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=e.length;++i)MR(this,e.charCodeAt(i),this.l+2*i);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;n=e.length}else if(r==="hex"){for(;i<t;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+t,this.length);for(i=0;i<Math.min(e.length,t);++i){var a=e.charCodeAt(i);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,PR(this,e,this.l);break;case 8:if(n=8,r==="f"){NR(this,e,this.l);break}case 16:break;case-4:n=4,OR(this,e,this.l);break}return this.l+=n,this}function uA(t,e){var r=JT(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function qn(t,e){t.l=e,t.read_shift=Ld,t.chk=uA,t.write_shift=BR}function yi(t,e){t.l+=e}function Ee(t){var e=fl(t);return qn(e,0),e}function go(t,e,r){if(t){var n,i,s;qn(t,t.l||0);for(var a=t.length,o=0,l=0;t.l<a;){o=t.read_shift(1),o&128&&(o=(o&127)+((t.read_shift(1)&127)<<7));var u=kf[o]||kf[65535];for(n=t.read_shift(1),s=n&127,i=1;i<4&&n&128;++i)s+=((n=t.read_shift(1))&127)<<7*i;l=t.l+s;var f=u.f&&u.f(t,s,r);if(t.l=l,e(f,u,o))return}}}function Yi(){var t=[],e=Pt?256:2048,r=function(u){var f=Ee(u);return qn(f,0),f},n=r(e),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},s=function(u){return n&&u<n.length-n.l?n:(i(),n=r(Math.max(u+1,e)))},a=function(){return i(),Ln(t)},o=function(u){i(),n=u,n.l==null&&(n.l=n.length),s(e)};return{next:s,push:o,end:a,_bufs:t}}function Fe(t,e,r,n){var i=+e,s;if(!isNaN(i)){n||(n=kf[i].p||(r||[]).length||0),s=1+(i>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var a=t.next(s);i<=127?a.write_shift(1,i):(a.write_shift(1,(i&127)+128),a.write_shift(1,i>>7));for(var o=0;o!=4;++o)if(n>=128)a.write_shift(1,(n&127)+128),n>>=7;else{a.write_shift(1,n);break}n>0&&Z1(r)&&t.push(r)}}function Ud(t,e,r){var n=Dr(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function f_(t,e,r){var n=Dr(t);return n.s=Ud(n.s,e.s,r),n.e=Ud(n.e,e.s,r),n}function Vd(t,e){if(t.cRel&&t.c<0)for(t=Dr(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=Dr(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=gt(t);return!t.cRel&&t.cRel!=null&&(r=UR(r)),!t.rRel&&t.rRel!=null&&(r=jR(r)),r}function Hg(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+Yr(t.s.c)+":"+(t.e.cRel?"":"$")+Yr(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+un(t.s.r)+":"+(t.e.rRel?"":"$")+un(t.e.r):Vd(t.s,e.biff)+":"+Vd(t.e,e.biff)}function ev(t){return parseInt(LR(t),10)-1}function un(t){return""+(t+1)}function jR(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function LR(t){return t.replace(/\$(\d+)$/,"$1")}function tv(t){for(var e=VR(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function Yr(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function UR(t){return t.replace(/^([A-Z])/,"$$$1")}function VR(t){return t.replace(/^\$([A-Z])/,"$1")}function zR(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Xr(t){for(var e=0,r=0,n=0;n<t.length;++n){var i=t.charCodeAt(n);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:e-1}}function gt(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function Xi(t){var e=t.indexOf(":");return e==-1?{s:Xr(t),e:Xr(t)}:{s:Xr(t.slice(0,e)),e:Xr(t.slice(e+1))}}function bt(t,e){return typeof e>"u"||typeof e=="number"?bt(t.s,t.e):(typeof t!="string"&&(t=gt(t)),typeof e!="string"&&(e=gt(e)),t==e?t:t+":"+e)}function nr(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,s=t.length;for(r=0;n<s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.s.c=--r,r=0;n<s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(e.s.r=--r,n===s||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.e.c=--r,r=0;n!=s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return e.e.r=--r,e}function h_(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=Bs(t.z,r?Nn(e):e)}catch{}try{return t.w=Bs((t.XF||{}).numFmtId||(r?14:0),r?Nn(e):e)}catch{return""+e}}function ao(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?mo[t.v]||t.v:e==null?h_(t,t.v):h_(t,e))}function wl(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function dA(t,e,r){var n=r||{},i=t?Array.isArray(t):n.dense,s=t||(i?[]:{}),a=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?Xr(n.origin):n.origin;a=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var f=nr(s["!ref"]);u.s.c=f.s.c,u.s.r=f.s.r,u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),a==-1&&(u.e.r=a=f.e.r+1)}for(var p=0;p!=e.length;++p)if(e[p]){if(!Array.isArray(e[p]))throw new Error("aoa_to_sheet expects an array of arrays");for(var g=0;g!=e[p].length;++g)if(!(typeof e[p][g]>"u")){var m={v:e[p][g]},y=a+p,x=o+g;if(u.s.r>y&&(u.s.r=y),u.s.c>x&&(u.s.c=x),u.e.r<y&&(u.e.r=y),u.e.c<x&&(u.e.c=x),e[p][g]&&typeof e[p][g]=="object"&&!Array.isArray(e[p][g])&&!(e[p][g]instanceof Date))m=e[p][g];else if(Array.isArray(m.v)&&(m.f=e[p][g][1],m.v=m.v[0]),m.v===null)if(m.f)m.t="n";else if(n.nullError)m.t="e",m.v=0;else if(n.sheetStubs)m.t="z";else continue;else typeof m.v=="number"?m.t="n":typeof m.v=="boolean"?m.t="b":m.v instanceof Date?(m.z=n.dateNF||pt[14],n.cellDates?(m.t="d",m.w=Bs(m.z,Nn(m.v))):(m.t="n",m.v=Nn(m.v),m.w=Bs(m.z,m.v))):m.t="s";if(i)s[y]||(s[y]=[]),s[y][x]&&s[y][x].z&&(m.z=s[y][x].z),s[y][x]=m;else{var S=gt({c:x,r:y});s[S]&&s[S].z&&(m.z=s[S].z),s[S]=m}}}return u.s.c<1e7&&(s["!ref"]=bt(u)),s}function ju(t,e){return dA(null,t,e)}function WR(t){return t.read_shift(4,"i")}function ia(t,e){return e||(e=Ee(4)),e.write_shift(4,t),e}function xi(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function Un(t,e){var r=!1;return e==null&&(r=!0,e=Ee(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function $R(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function HR(t,e){return e||(e=Ee(4)),e.write_shift(2,0),e.write_shift(2,0),e}function rv(t,e){var r=t.l,n=t.read_shift(1),i=xi(t),s=[],a={t:i,h:i};if(n&1){for(var o=t.read_shift(4),l=0;l!=o;++l)s.push($R(t));a.r=s}else a.r=[{ich:0,ifnt:0}];return t.l=r+e,a}function GR(t,e){var r=!1;return e==null&&(r=!0,e=Ee(15+4*t.t.length)),e.write_shift(1,0),Un(t.t,e),r?e.slice(0,e.l):e}var KR=rv;function YR(t,e){var r=!1;return e==null&&(r=!0,e=Ee(23+4*t.t.length)),e.write_shift(1,1),Un(t.t,e),e.write_shift(4,1),HR({},e),r?e.slice(0,e.l):e}function js(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function hc(t,e){return e==null&&(e=Ee(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function pc(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function gc(t,e){return e==null&&(e=Ee(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var XR=xi,fA=Un;function nv(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function np(t,e){var r=!1;return e==null&&(r=!0,e=Ee(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var qR=xi,hx=nv,iv=np;function sv(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var i=n===0?rp([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):Dl(e,0)>>2;return r?i/100:i}function hA(t,e){e==null&&(e=Ee(4));var r=0,n=0,i=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?n=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(n=1,r=1),n)e.write_shift(-4,((r?i:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function pA(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function QR(t,e){return e||(e=Ee(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var mc=pA,Lu=QR;function mi(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function tc(t,e){return(e||Ee(8)).write_shift(8,t,"f")}function JR(t){var e={},r=t.read_shift(1),n=r>>>1,i=t.read_shift(1),s=t.read_shift(2,"i"),a=t.read_shift(1),o=t.read_shift(1),l=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=i;var u=zl[i];u&&(e.rgb=wf(u));break;case 2:e.rgb=wf([a,o,l]);break;case 3:e.theme=i;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function ip(t,e){if(e||(e=Ee(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function ZR(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function eD(t,e){e||(e=Ee(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}function gA(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function tD(t){return gA(t,1)}function rD(t){return gA(t,2)}var av=2,zi=3,j0=11,p_=12,sp=19,L0=64,nD=65,iD=71,sD=4108,aD=4126,Mn=80,mA=81,oD=[Mn,mA],px={1:{n:"CodePage",t:av},2:{n:"Category",t:Mn},3:{n:"PresentationFormat",t:Mn},4:{n:"ByteCount",t:zi},5:{n:"LineCount",t:zi},6:{n:"ParagraphCount",t:zi},7:{n:"SlideCount",t:zi},8:{n:"NoteCount",t:zi},9:{n:"HiddenCount",t:zi},10:{n:"MultimediaClipCount",t:zi},11:{n:"ScaleCrop",t:j0},12:{n:"HeadingPairs",t:sD},13:{n:"TitlesOfParts",t:aD},14:{n:"Manager",t:Mn},15:{n:"Company",t:Mn},16:{n:"LinksUpToDate",t:j0},17:{n:"CharacterCount",t:zi},19:{n:"SharedDoc",t:j0},22:{n:"HyperlinksChanged",t:j0},23:{n:"AppVersion",t:zi,p:"version"},24:{n:"DigSig",t:nD},26:{n:"ContentType",t:Mn},27:{n:"ContentStatus",t:Mn},28:{n:"Language",t:Mn},29:{n:"Version",t:Mn},255:{},2147483648:{n:"Locale",t:sp},2147483651:{n:"Behavior",t:sp},1919054434:{}},gx={1:{n:"CodePage",t:av},2:{n:"Title",t:Mn},3:{n:"Subject",t:Mn},4:{n:"Author",t:Mn},5:{n:"Keywords",t:Mn},6:{n:"Comments",t:Mn},7:{n:"Template",t:Mn},8:{n:"LastAuthor",t:Mn},9:{n:"RevNumber",t:Mn},10:{n:"EditTime",t:L0},11:{n:"LastPrinted",t:L0},12:{n:"CreatedDate",t:L0},13:{n:"ModifiedDate",t:L0},14:{n:"PageCount",t:zi},15:{n:"WordCount",t:zi},16:{n:"CharCount",t:zi},17:{n:"Thumbnail",t:iD},18:{n:"Application",t:Mn},19:{n:"DocSecurity",t:zi},255:{},2147483648:{n:"Locale",t:sp},2147483651:{n:"Behavior",t:sp},1919054434:{}},g_={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},lD=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function cD(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var uD=cD([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),zl=Dr(uD),mo={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},xA={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},mx={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},U0={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function ov(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function dD(t){var e=ov();if(!t||!t.match)return e;var r={};if((t.match(Ei)||[]).forEach(function(n){var i=mt(n);switch(i[0].replace(ER,"<")){case"<?xml":break;case"<Types":e.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":e[mx[i.ContentType]]!==void 0&&e[mx[i.ContentType]].push(i.PartName);break}}),e.xmlns!==kn.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}function vA(t,e){var r=dR(mx),n=[],i;n[n.length]=dn,n[n.length]=Ge("Types",null,{xmlns:kn.CT,"xmlns:xsd":kn.xsd,"xmlns:xsi":kn.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return Ge("Default",null,{Extension:l[0],ContentType:l[1]})}));var s=function(l){t[l]&&t[l].length>0&&(i=t[l][0],n[n.length]=Ge("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:U0[l][e.bookType]||U0[l].xlsx}))},a=function(l){(t[l]||[]).forEach(function(u){n[n.length]=Ge("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:U0[l][e.bookType]||U0[l].xlsx})})},o=function(l){(t[l]||[]).forEach(function(u){n[n.length]=Ge("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[l][0]})})};return s("workbooks"),a("sheets"),a("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),a("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Bt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Sf(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function zd(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(Ei)||[]).forEach(function(i){var s=mt(i);if(s[0]==="<Relationship"){var a={};a.Type=s.Type,a.Target=s.Target,a.Id=s.Id,s.TargetMode&&(a.TargetMode=s.TargetMode);var o=s.TargetMode==="External"?s.Target:Ad(s.Target,e);r[o]=a,n[s.Id]=a}}),r["!id"]=n,r}function ou(t){var e=[dn,Ge("Relationships",null,{xmlns:kn.RELS})];return sn(t["!id"]).forEach(function(r){e[e.length]=Ge("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function hr(t,e,r,n,i,s){if(i||(i={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,i.Id="rId"+e,i.Type=n,i.Target=r,[Bt.HLINK,Bt.XPATH,Bt.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),t["!id"][i.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][i.Id]=i,t[("/"+i.Target).replace("//","/")]=i,e}var fD="application/vnd.oasis.opendocument.spreadsheet";function hD(t,e){for(var r=Q1(t),n,i;n=Ef.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=mt(n[0],!1),i.path=="/"&&i.type!==fD)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}function pD(t){var e=[dn];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function m_(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function gD(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function mD(t){var e=[dn];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(m_(t[r][0],t[r][1])),e.push(gD("",t[r][0]));return e.push(m_("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function yA(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Qh.version+"</meta:generator></office:meta></office:document-meta>"}var Ps=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],xD=function(){for(var t=new Array(Ps.length),e=0;e<Ps.length;++e){var r=Ps[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function _A(t){var e={};t=vr(t);for(var r=0;r<Ps.length;++r){var n=Ps[r],i=t.match(xD[r]);i!=null&&i.length>0&&(e[n[1]]=rr(i[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=Rr(e[n[1]]))}return e}function Gg(t,e,r,n,i){i[t]!=null||e==null||e===""||(i[t]=e,e=pr(e),n[n.length]=r?Ge(t,e,r):Qn(t,e))}function EA(t,e){var r=e||{},n=[dn,Ge("cp:coreProperties",null,{"xmlns:cp":kn.CORE_PROPS,"xmlns:dc":kn.dc,"xmlns:dcterms":kn.dcterms,"xmlns:dcmitype":kn.dcmitype,"xmlns:xsi":kn.xsi})],i={};if(!t&&!r.Props)return n.join("");t&&(t.CreatedDate!=null&&Gg("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:fx(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),t.ModifiedDate!=null&&Gg("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:fx(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var s=0;s!=Ps.length;++s){var a=Ps[s],o=r.Props&&r.Props[a[1]]!=null?r.Props[a[1]]:t?t[a[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&Gg(a[0],o,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Wl=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],SA=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function wA(t,e,r,n){var i=[];if(typeof t=="string")i=a_(t,n);else for(var s=0;s<t.length;++s)i=i.concat(t[s].map(function(f){return{v:f}}));var a=typeof e=="string"?a_(e,n).map(function(f){return f.v}):e,o=0,l=0;if(a.length>0)for(var u=0;u!==i.length;u+=2){switch(l=+i[u+1].v,i[u].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=a.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=l,r.DefinedNames=a.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=a.slice(o,o+l);break}o+=l}}function vD(t,e,r){var n={};return e||(e={}),t=vr(t),Wl.forEach(function(i){var s=(t.match(yf(i[0]))||[])[1];switch(i[2]){case"string":s&&(e[i[1]]=rr(s));break;case"bool":e[i[1]]=s==="true";break;case"raw":var a=t.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));a&&a.length>0&&(n[i[1]]=a[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&wA(n.HeadingPairs,n.TitlesOfParts,e,r),e}function TA(t){var e=[],r=Ge;return t||(t={}),t.Application="SheetJS",e[e.length]=dn,e[e.length]=Ge("Properties",null,{xmlns:kn.EXT_PROPS,"xmlns:vt":kn.vt}),Wl.forEach(function(n){if(t[n[1]]!==void 0){var i;switch(n[2]){case"string":i=pr(String(t[n[1]]));break;case"bool":i=t[n[1]]?"true":"false";break}i!==void 0&&(e[e.length]=r(n[0],i))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+pr(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var yD=/<[^>]+>[^<]*/g;function _D(t,e){var r={},n="",i=t.match(yD);if(i)for(var s=0;s!=i.length;++s){var a=i[s],o=mt(a);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=rr(o.name);break;case"</property>":n=null;break;default:if(a.indexOf("<vt:")===0){var l=a.split(">"),u=l[0].slice(4),f=l[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[n]=rr(f);break;case"bool":r[n]=Ir(f);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(f,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(f);break;case"filetime":case"date":r[n]=Rr(f);break;case"cy":case"error":r[n]=rr(f);break;default:if(u.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",a,u,l)}}else if(a.slice(0,2)!=="</"){if(e.WTF)throw new Error(a)}}}return r}function AA(t){var e=[dn,Ge("Properties",null,{xmlns:kn.CUST_PROPS,"xmlns:vt":kn.vt})];if(!t)return e.join("");var r=1;return sn(t).forEach(function(i){++r,e[e.length]=Ge("property",bR(t[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:pr(i)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var xx={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Kg;function ED(t,e,r){Kg||(Kg=Hp(xx)),e=Kg[e]||e,t[e]=r}function SD(t,e){var r=[];return sn(xx).map(function(n){for(var i=0;i<Ps.length;++i)if(Ps[i][1]==n)return Ps[i];for(i=0;i<Wl.length;++i)if(Wl[i][1]==n)return Wl[i];throw n}).forEach(function(n){if(t[n[1]]!=null){var i=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:t[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(Qn(xx[n[1]]||n[1],i))}}),Ge("DocumentProperties",r.join(""),{xmlns:is.o})}function wD(t,e){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return t&&sn(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)){for(var a=0;a<Ps.length;++a)if(s==Ps[a][1])return;for(a=0;a<Wl.length;++a)if(s==Wl[a][1])return;for(a=0;a<r.length;++a)if(s==r[a])return;var o=t[s],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),i.push(Ge(r_(s),o,{"dt:dt":l}))}}),e&&sn(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)&&!(t&&Object.prototype.hasOwnProperty.call(t,s))){var a=e[s],o="string";typeof a=="number"?(o="float",a=String(a)):a===!0||a===!1?(o="boolean",a=a?"1":"0"):a instanceof Date?(o="dateTime.tz",a=a.toISOString()):a=String(a),i.push(Ge(r_(s),a,{"dt:dt":o}))}}),"<"+n+' xmlns="'+is.o+'">'+i.join("")+"</"+n+">"}function lv(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function TD(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,n=r%Math.pow(2,32),i=(r-n)/Math.pow(2,32);n*=1e7,i*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),i+=s);var a=Ee(8);return a.write_shift(4,n),a.write_shift(4,i),a}function CA(t,e,r){var n=t.l,i=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return i}function kA(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function FA(t,e,r){return e===31?kA(t):CA(t,e,r)}function vx(t,e,r){return FA(t,e,r===!1?0:4)}function AD(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return FA(t,e,0)}function CD(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var i=t.l;r[n]=t.read_shift(0,"lpwstr").replace(Ni,""),t.l-i&2&&(t.l+=2)}return r}function kD(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(Ni,"");return r}function FD(t){var e=t.l,r=ap(t,mA);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=ap(t,zi);return[r,n]}function bD(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(FD(t));return r}function x_(t,e){for(var r=t.read_shift(4),n={},i=0;i!=r;++i){var s=t.read_shift(4),a=t.read_shift(4);n[s]=t.read_shift(a,e===1200?"utf16le":"utf8").replace(Ni,"").replace(Td,"!"),e===1200&&a%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function bA(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function ID(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function ap(t,e,r){var n=t.read_shift(2),i,s=r||{};if(t.l+=2,e!==p_&&n!==e&&oD.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===p_?n:e){case 2:return i=t.read_shift(2,"i"),s.raw||(t.l+=2),i;case 3:return i=t.read_shift(4,"i"),i;case 11:return t.read_shift(4)!==0;case 19:return i=t.read_shift(4),i;case 30:return CA(t,n,4).replace(Ni,"");case 31:return kA(t);case 64:return lv(t);case 65:return bA(t);case 71:return ID(t);case 80:return vx(t,n,!s.raw).replace(Ni,"");case 81:return AD(t,n).replace(Ni,"");case 4108:return bD(t);case 4126:case 4127:return n==4127?CD(t):kD(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function v_(t,e){var r=Ee(4),n=Ee(4);switch(r.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,e);break;case 5:n=Ee(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=TD(e);break;case 31:case 80:for(n=Ee(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return Ln([r,n])}function y_(t,e){var r=t.l,n=t.read_shift(4),i=t.read_shift(4),s=[],a=0,o=0,l=-1,u={};for(a=0;a!=i;++a){var f=t.read_shift(4),p=t.read_shift(4);s[a]=[f,p+r]}s.sort(function(C,E){return C[1]-E[1]});var g={};for(a=0;a!=i;++a){if(t.l!==s[a][1]){var m=!0;if(a>0&&e)switch(e[s[a-1][0]].t){case 2:t.l+2===s[a][1]&&(t.l+=2,m=!1);break;case 80:t.l<=s[a][1]&&(t.l=s[a][1],m=!1);break;case 4108:t.l<=s[a][1]&&(t.l=s[a][1],m=!1);break}if((!e||a==0)&&t.l<=s[a][1]&&(m=!1,t.l=s[a][1]),m)throw new Error("Read Error: Expected address "+s[a][1]+" at "+t.l+" :"+a)}if(e){var y=e[s[a][0]];if(g[y.n]=ap(t,y.t,{raw:!0}),y.p==="version"&&(g[y.n]=String(g[y.n]>>16)+"."+("0000"+String(g[y.n]&65535)).slice(-4)),y.n=="CodePage")switch(g[y.n]){case 0:g[y.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Js(o=g[y.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+g[y.n])}}else if(s[a][0]===1){if(o=g.CodePage=ap(t,av),Js(o),l!==-1){var x=t.l;t.l=s[l][1],u=x_(t,o),t.l=x}}else if(s[a][0]===0){if(o===0){l=a,t.l=s[a+1][1];continue}u=x_(t,o)}else{var S=u[s[a][0]],A;switch(t[t.l]){case 65:t.l+=4,A=bA(t);break;case 30:t.l+=4,A=vx(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,A=vx(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,A=t.read_shift(4,"i");break;case 19:t.l+=4,A=t.read_shift(4);break;case 5:t.l+=4,A=t.read_shift(8,"f");break;case 11:t.l+=4,A=on(t,4);break;case 64:t.l+=4,A=Rr(lv(t));break;default:throw new Error("unparsed value: "+t[t.l])}g[S]=A}}return t.l=r+n,g}var IA=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function ND(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function __(t,e,r){var n=Ee(8),i=[],s=[],a=8,o=0,l=Ee(8),u=Ee(8);if(l.write_shift(4,2),l.write_shift(4,1200),u.write_shift(4,1),s.push(l),i.push(u),a+=8+l.length,!e){u=Ee(8),u.write_shift(4,0),i.unshift(u);var f=[Ee(4)];for(f[0].write_shift(4,t.length),o=0;o<t.length;++o){var p=t[o][0];for(l=Ee(8+2*(p.length+1)+(p.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,p.length+1),l.write_shift(0,p,"dbcs");l.l!=l.length;)l.write_shift(1,0);f.push(l)}l=Ln(f),s.unshift(l),a+=8+l.length}for(o=0;o<t.length;++o)if(!(e&&!e[t[o][0]])&&!(IA.indexOf(t[o][0])>-1||SA.indexOf(t[o][0])>-1)&&t[o][1]!=null){var g=t[o][1],m=0;if(e){m=+e[t[o][0]];var y=r[m];if(y.p=="version"&&typeof g=="string"){var x=g.split(".");g=(+x[0]<<16)+(+x[1]||0)}l=v_(y.t,g)}else{var S=ND(g);S==-1&&(S=31,g=String(g)),l=v_(S,g)}s.push(l),u=Ee(8),u.write_shift(4,e?m:2+o),i.push(u),a+=8+l.length}var A=8*(s.length+1);for(o=0;o<s.length;++o)i[o].write_shift(4,A),A+=s[o].length;return n.write_shift(4,a),n.write_shift(4,s.length),Ln([n].concat(i).concat(s))}function E_(t,e,r){var n=t.content;if(!n)return{};qn(n,0);var i,s,a,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var u=n.read_shift(4),f=n.read_shift(16);if(f!==st.utils.consts.HEADER_CLSID&&f!==r)throw new Error("Bad PropertySet CLSID "+f);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(s=n.read_shift(16),o=n.read_shift(4),i===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);i===2&&(a=n.read_shift(16),l=n.read_shift(4));var p=y_(n,e),g={SystemIdentifier:u};for(var m in p)g[m]=p[m];if(g.FMTID=s,i===1)return g;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var y;try{y=y_(n,null)}catch{}for(m in y)g[m]=y[m];return g.FMTID=[s,a],g}function S_(t,e,r,n,i,s){var a=Ee(i?68:48),o=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,st.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,i?2:1),a.write_shift(16,e,"hex"),a.write_shift(4,i?68:48);var l=__(t,r,n);if(o.push(l),i){var u=__(i,null,null);a.write_shift(16,s,"hex"),a.write_shift(4,68+l.length),o.push(u)}return Ln(o)}function Do(t,e){return t.read_shift(e),null}function RD(t,e){e||(e=Ee(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function DD(t,e,r){for(var n=[],i=t.l+e;t.l<i;)n.push(r(t,i-t.l));if(i!==t.l)throw new Error("Slurp error");return n}function on(t,e){return t.read_shift(e)===1}function bi(t,e){return e||(e=Ee(2)),e.write_shift(2,+!!t),e}function yn(t){return t.read_shift(2,"u")}function Fs(t,e){return e||(e=Ee(2)),e.write_shift(2,t),e}function NA(t,e){return DD(t,e,yn)}function PD(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function RA(t,e,r){return r||(r=Ee(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function Kf(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=t.read_shift(1);s&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var a=n?t.read_shift(n,i):"";return a}function OD(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,i=r&8,s=1+(r&1),a=0,o,l={};i&&(a=t.read_shift(2)),n&&(o=t.read_shift(4));var u=s==2?"dbcs-cont":"sbcs-cont",f=e===0?"":t.read_shift(e,u);return i&&(t.l+=4*a),n&&(t.l+=o),l.t=f,i||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function MD(t){var e=t.t||"",r=Ee(3);r.write_shift(2,e.length),r.write_shift(1,1);var n=Ee(2*e.length);n.write_shift(2*e.length,e,"utf16le");var i=[r,n];return Ln(i)}function rc(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var i=t.read_shift(1);return i===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function Yf(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):rc(t,n,r)}function xc(t,e,r){if(r.biff>5)return Yf(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function DA(t,e,r){return r||(r=Ee(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function BD(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function jD(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var i=t.read_shift((n?e-24:e)>>1,"utf16le").replace(Ni,"");return n&&(t.l+=24),i}function LD(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=t.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var s=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var a=t.read_shift(s>>1,"utf16le").replace(Ni,"");return r+a}function UD(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return jD(t);case"0303000000000000c000000000000046":return LD(t);default:throw new Error("Unsupported Moniker "+r)}}function V0(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(Ni,""):"";return r}function w_(t,e){e||(e=Ee(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function VD(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=t.read_shift(2);t.l+=2;var s,a,o,l,u="",f,p;i&16&&(s=V0(t,r-t.l)),i&128&&(a=V0(t,r-t.l)),(i&257)===257&&(o=V0(t,r-t.l)),(i&257)===1&&(l=UD(t,r-t.l)),i&8&&(u=V0(t,r-t.l)),i&32&&(f=t.read_shift(16)),i&64&&(p=lv(t)),t.l=r;var g=a||o||l||"";g&&u&&(g+="#"+u),g||(g="#"+u),i&2&&g.charAt(0)=="/"&&g.charAt(1)!="/"&&(g="file://"+g);var m={Target:g};return f&&(m.guid=f),p&&(m.time=p),s&&(m.Tooltip=s),m}function zD(t){var e=Ee(512),r=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),s=i>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}e.write_shift(4,2),e.write_shift(4,s);var a=[8,6815827,6619237,4849780,83];for(r=0;r<a.length;++r)e.write_shift(4,a[r]);if(s==28)n=n.slice(1),w_(n,e);else if(s&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<a.length;++r)e.write_shift(1,parseInt(a[r],16));var o=i>-1?n.slice(0,i):n;for(e.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)e.write_shift(2,o.charCodeAt(r));e.write_shift(2,0),s&8&&w_(i>-1?n.slice(i+1):"",e)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<a.length;++r)e.write_shift(1,parseInt(a[r],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(e.write_shift(2,l),e.write_shift(4,n.length-3*l+1),r=0;r<n.length-3*l;++r)e.write_shift(1,n.charCodeAt(r+3*l)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function PA(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),i=t.read_shift(1);return[e,r,n,i]}function OA(t,e){var r=PA(t);return r[3]=0,r}function Ma(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function nc(t,e,r,n){return n||(n=Ee(6)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r||0),n}function WD(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function $D(t,e,r){return e===0?"":xc(t,e,r)}function HD(t,e,r){var n=r.biff>8?4:2,i=t.read_shift(n),s=t.read_shift(n,"i"),a=t.read_shift(n,"i");return[i,s,a]}function MA(t){var e=t.read_shift(2),r=sv(t);return[e,r]}function GD(t,e,r){t.l+=4,e-=4;var n=t.l+e,i=Kf(t,e,r),s=t.read_shift(2);if(n-=t.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return t.l+=s,i}function Yp(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2);return{s:{c:n,r:e},e:{c:i,r}}}function BA(t,e){return e||(e=Ee(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function jA(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),i=t.read_shift(1);return{s:{c:n,r:e},e:{c:i,r}}}var KD=jA;function LA(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function YD(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function XD(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function li(t){t.l+=2,t.l+=t.read_shift(2)}var qD={0:li,4:li,5:li,6:li,7:XD,8:li,9:li,10:li,11:li,12:li,13:YD,14:li,15:li,16:li,17:li,18:li,19:li,20:li,21:LA};function QD(t,e){for(var r=t.l+e,n=[];t.l<r;){var i=t.read_shift(2);t.l-=2;try{n.push(qD[i](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function z0(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function cv(t,e,r){var n=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=Ee(i);return s.write_shift(2,n),s.write_shift(2,e),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function JD(t,e){return e===0||t.read_shift(2),1200}function ZD(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,i=xc(t,0,r);return t.read_shift(e+n-t.l),i}function e3(t,e){var r=!e||e.biff==8,n=Ee(r?112:54);for(n.write_shift(e.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function t3(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function r3(t,e,r){var n=t.read_shift(4),i=t.read_shift(1)&3,s=t.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var a=Kf(t,0,r);return a.length===0&&(a="Sheet1"),{pos:n,hs:i,dt:s,name:a}}function n3(t,e){var r=!e||e.biff>=8?2:1,n=Ee(8+r*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function i3(t,e){for(var r=t.l+e,n=t.read_shift(4),i=t.read_shift(4),s=[],a=0;a!=i&&t.l<r;++a)s.push(OD(t));return s.Count=n,s.Unique=i,s}function s3(t,e){var r=Ee(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var n=[],i=0;i<t.length;++i)n[i]=MD(t[i]);var s=Ln([r].concat(n));return s.parts=[r.length].concat(n.map(function(a){return a.length})),s}function a3(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function o3(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function l3(t){var e=WD(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function c3(t){return t.read_shift(2),t.read_shift(4)}function T_(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var i=t.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,i]}function u3(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2),l=t.read_shift(2),u=t.read_shift(2);return{Pos:[e,r],Dim:[n,i],Flags:s,CurTab:a,FirstTab:o,Selected:l,TabRatio:u}}function d3(){var t=Ee(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function f3(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function h3(t){var e=Ee(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function p3(){}function g3(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=Kf(t,0,r),n}function m3(t,e){var r=t.name||"Arial",n=e&&e.biff==5,i=n?15+r.length:16+2*r.length,s=Ee(i);return s.write_shift(2,t.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function x3(t){var e=Ma(t);return e.isst=t.read_shift(4),e}function v3(t,e,r,n){var i=Ee(10);return nc(t,e,n,i),i.write_shift(4,r),i}function y3(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,i=Ma(t);r.biff==2&&t.l++;var s=Yf(t,n-t.l,r);return i.val=s,i}function _3(t,e,r,n,i){var s=!i||i.biff==8,a=Ee(8+ +s+(1+s)*r.length);return nc(t,e,n,a),a.write_shift(2,r.length),s&&a.write_shift(1,1),a.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),a}function E3(t,e,r){var n=t.read_shift(2),i=xc(t,0,r);return[n,i]}function S3(t,e,r,n){var i=r&&r.biff==5;n||(n=Ee(i?3+e.length:5+2*e.length)),n.write_shift(2,t),n.write_shift(i?1:2,e.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}var w3=xc;function A_(t,e,r){var n=t.l+e,i=r.biff==8||!r.biff?4:2,s=t.read_shift(i),a=t.read_shift(i),o=t.read_shift(2),l=t.read_shift(2);return t.l=n,{s:{r:s,c:o},e:{r:a,c:l}}}function T3(t,e){var r=e.biff==8||!e.biff?4:2,n=Ee(2*r+6);return n.write_shift(r,t.s.r),n.write_shift(r,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function A3(t){var e=t.read_shift(2),r=t.read_shift(2),n=MA(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function C3(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),s=[];t.l<r;)s.push(MA(t));if(t.l!==r)throw new Error("MulRK read error");var a=t.read_shift(2);if(s.length!=a-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:a,rkrec:s}}function k3(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),s=[];t.l<r;)s.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var a=t.read_shift(2);if(s.length!=a-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:a,ixfe:s}}function F3(t,e,r,n){var i={},s=t.read_shift(4),a=t.read_shift(4),o=t.read_shift(4),l=t.read_shift(2);return i.patternType=lD[o>>26],n.cellStyles&&(i.alc=s&7,i.fWrap=s>>3&1,i.alcV=s>>4&7,i.fJustLast=s>>7&1,i.trot=s>>8&255,i.cIndent=s>>16&15,i.fShrinkToFit=s>>20&1,i.iReadOrder=s>>22&2,i.fAtrNum=s>>26&1,i.fAtrFnt=s>>27&1,i.fAtrAlc=s>>28&1,i.fAtrBdr=s>>29&1,i.fAtrPat=s>>30&1,i.fAtrProt=s>>31&1,i.dgLeft=a&15,i.dgRight=a>>4&15,i.dgTop=a>>8&15,i.dgBottom=a>>12&15,i.icvLeft=a>>16&127,i.icvRight=a>>23&127,i.grbitDiag=a>>30&3,i.icvTop=o&127,i.icvBottom=o>>7&127,i.icvDiag=o>>14&127,i.dgDiag=o>>21&15,i.icvFore=l&127,i.icvBack=l>>7&127,i.fsxButton=l>>14&1),i}function b3(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=F3(t,e,n.fStyle,r),n}function C_(t,e,r,n){var i=r&&r.biff==5;n||(n=Ee(i?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,e<<4));var s=0;return t.numFmtId>0&&i&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function I3(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function N3(t){var e=Ee(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function k_(t,e,r){var n=Ma(t);(r.biff==2||e==9)&&++t.l;var i=PD(t);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function R3(t,e,r,n,i,s){var a=Ee(8);return nc(t,e,n,a),RA(r,s,a),a}function D3(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Ma(t),i=mi(t);return n.val=i,n}function P3(t,e,r,n){var i=Ee(14);return nc(t,e,n,i),tc(r,i),i}var F_=$D;function O3(t,e,r){var n=t.l+e,i=t.read_shift(2),s=t.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,i];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var a=rc(t,s),o=[];n>t.l;)o.push(Yf(t));return[s,i,a,o]}function b_(t,e,r){var n=t.read_shift(2),i,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=GD(t,e-2,r)),s.body=i||t.read_shift(e-2),typeof i=="string"&&(s.Name=i),s}var M3=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function I_(t,e,r){var n=t.l+e,i=t.read_shift(2),s=t.read_shift(1),a=t.read_shift(1),o=t.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),l=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var u=rc(t,a,r);i&32&&(u=M3[u.charCodeAt(0)]);var f=n-t.l;r&&r.biff==2&&--f;var p=n==t.l||o===0||!(f>0)?[]:Q5(t,f,r,o);return{chKey:s,Name:u,itab:l,rgce:p}}function UA(t,e,r){if(r.biff<8)return B3(t,e,r);for(var n=[],i=t.l+e,s=t.read_shift(r.biff>8?4:2);s--!==0;)n.push(HD(t,r.biff>8?12:6,r));if(t.l!=i)throw new Error("Bad ExternSheet: "+t.l+" != "+i);return n}function B3(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=Kf(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function j3(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),i=t.read_shift(2),s=rc(t,n,r),a=rc(t,i,r);return[s,a]}function L3(t,e,r){var n=jA(t);t.l++;var i=t.read_shift(1);return e-=8,[J5(t,e,r),i,n]}function N_(t,e,r){var n=KD(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,X5(t,e,r)]}function U3(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function V3(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),o=xc(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:i},o,a,s]}}function z3(t,e,r){return V3(t,e,r)}function W3(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(Yp(t));return r}function $3(t){var e=Ee(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)BA(t[r],e);return e}function H3(t,e,r){if(r&&r.biff<8)return K3(t,e,r);var n=LA(t),i=QD(t,e-22,n[1]);return{cmo:n,ft:i}}var G3={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var i=t.read_shift(1);return t.l+=i,t.l=r,{fmt:n}}};function K3(t,e,r){t.l+=4;var n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var a=[];return a.push((G3[n]||yi)(t,e,r)),{cmo:[i,n,s],ft:a}}function Y3(t,e,r){var n=t.l,i="";try{t.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],a;[0,5,7,11,12,14].indexOf(s)==-1?t.l+=6:a=BD(t,6,r);var o=t.read_shift(2);t.read_shift(2),yn(t,2);var l=t.read_shift(2);t.l+=l;for(var u=1;u<t.lens.length-1;++u){if(t.l-n!=t.lens[u])throw new Error("TxO: bad continue record");var f=t[t.l],p=rc(t,t.lens[u+1]-t.lens[u]-1);if(i+=p,i.length>=(f?o:2*o))break}if(i.length!==o&&i.length!==o*2)throw new Error("cchText: "+o+" != "+i.length);return t.l=n+e,{t:i}}catch{return t.l=n+e,{t:i}}}function X3(t,e){var r=Yp(t);t.l+=16;var n=VD(t,e-24);return[r,n]}function q3(t){var e=Ee(24),r=Xr(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)e.write_shift(1,parseInt(n[i],16));return Ln([e,zD(t[1])])}function Q3(t,e){t.read_shift(2);var r=Yp(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(Ni,""),[r,n]}function J3(t){var e=t[1].Tooltip,r=Ee(10+2*(e.length+1));r.write_shift(2,2048);var n=Xr(t[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<e.length;++i)r.write_shift(2,e.charCodeAt(i));return r.write_shift(2,0),r}function Z3(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=g_[r]||r,r=t.read_shift(2),e[1]=g_[r]||r,e}function e6(t){return t||(t=Ee(4)),t.write_shift(2,1),t.write_shift(2,1),t}function t6(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(OA(t));return r}function r6(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(OA(t));return r}function n6(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function VA(t,e,r){if(!r.cellStyles)return yi(t,e);var n=r&&r.biff>=12?4:2,i=t.read_shift(n),s=t.read_shift(n),a=t.read_shift(n),o=t.read_shift(n),l=t.read_shift(2);n==2&&(t.l+=2);var u={s:i,e:s,w:a,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(u.level=l>>8&7),u}function i6(t,e){var r=Ee(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var n=0;return t.hidden&&(n|=1),r.write_shift(1,n),n=t.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function s6(t,e){var r={};return e<32||(t.l+=16,r.header=mi(t),r.footer=mi(t),t.l+=2),r}function a6(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var i=t.read_shift(1);return t.l+=3,i&16&&(n.area=!0),n}function o6(t){for(var e=Ee(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}var l6=Ma,c6=NA,u6=Yf;function d6(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,i}function f6(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Ma(t);++t.l;var i=xc(t,e-7,r);return n.t="str",n.val=i,n}function h6(t){var e=Ma(t);++t.l;var r=mi(t);return e.t="n",e.val=r,e}function p6(t,e,r){var n=Ee(15);return Jf(n,t,e),n.write_shift(8,r,"f"),n}function g6(t){var e=Ma(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function m6(t,e,r){var n=Ee(9);return Jf(n,t,e),n.write_shift(2,r),n}function x6(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function v6(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function y6(t,e,r){var n=t.l+e,i=Ma(t),s=t.read_shift(2),a=rc(t,s,r);return t.l=n,i.t="str",i.val=a,i}var _6=[2,3,48,49,131,139,140,245],yx=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=Hp({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var u=[],f=fl(1);switch(l.type){case"base64":f=as(fs(o));break;case"binary":f=as(o);break;case"buffer":case"array":f=o;break}qn(f,0);var p=f.read_shift(1),g=!!(p&136),m=!1,y=!1;switch(p){case 2:break;case 3:break;case 48:m=!0,g=!0;break;case 49:m=!0,g=!0;break;case 131:break;case 139:break;case 140:y=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+p.toString(16))}var x=0,S=521;p==2&&(x=f.read_shift(2)),f.l+=3,p!=2&&(x=f.read_shift(4)),x>1048576&&(x=1e6),p!=2&&(S=f.read_shift(2));var A=f.read_shift(2),C=l.codepage||1252;p!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(C=t[f[f.l]]),f.l+=1,f.l+=2),y&&(f.l+=36);for(var E=[],O={},q=Math.min(f.length,p==2?521:S-10-(m?264:0)),H=y?32:11;f.l<q&&f[f.l]!=13;)switch(O={},O.name=mf.utils.decode(C,f.slice(f.l,f.l+H)).replace(/[\u0000\r\n].*$/g,""),f.l+=H,O.type=String.fromCharCode(f.read_shift(1)),p!=2&&!y&&(O.offset=f.read_shift(4)),O.len=f.read_shift(1),p==2&&(O.offset=f.read_shift(2)),O.dec=f.read_shift(1),O.name.length&&E.push(O),p!=2&&(f.l+=y?13:14),O.type){case"B":(!m||O.len!=8)&&l.WTF&&console.log("Skipping "+O.name+":"+O.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+O.name+":"+O.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+O.type)}if(f[f.l]!==13&&(f.l=S-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=S;var T=0,F=0;for(u[0]=[],F=0;F!=E.length;++F)u[0][F]=E[F].name;for(;x-- >0;){if(f[f.l]===42){f.l+=A;continue}for(++f.l,u[++T]=[],F=0,F=0;F!=E.length;++F){var w=f.slice(f.l,f.l+E[F].len);f.l+=E[F].len,qn(w,0);var N=mf.utils.decode(C,w);switch(E[F].type){case"C":N.trim().length&&(u[T][F]=N.replace(/\s+$/,""));break;case"D":N.length===8?u[T][F]=new Date(+N.slice(0,4),+N.slice(4,6)-1,+N.slice(6,8)):u[T][F]=N;break;case"F":u[T][F]=parseFloat(N.trim());break;case"+":case"I":u[T][F]=y?w.read_shift(-4,"i")^2147483648:w.read_shift(4,"i");break;case"L":switch(N.trim().toUpperCase()){case"Y":case"T":u[T][F]=!0;break;case"N":case"F":u[T][F]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+N+"|")}break;case"M":if(!g)throw new Error("DBF Unexpected MEMO for type "+p.toString(16));u[T][F]="##MEMO##"+(y?parseInt(N.trim(),10):w.read_shift(4));break;case"N":N=N.replace(/\u0000/g,"").trim(),N&&N!="."&&(u[T][F]=+N||0);break;case"@":u[T][F]=new Date(w.read_shift(-8,"f")-621356832e5);break;case"T":u[T][F]=new Date((w.read_shift(4)-2440588)*864e5+w.read_shift(4));break;case"Y":u[T][F]=w.read_shift(4,"i")/1e4+w.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[T][F]=-w.read_shift(-8,"f");break;case"B":if(m&&E[F].len==8){u[T][F]=w.read_shift(8,"f");break}case"G":case"P":w.l+=E[F].len;break;case"0":if(E[F].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+E[F].type)}}}if(p!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return l&&l.sheetRows&&(u=u.slice(0,l.sheetRows)),l.DBF=E,u}function n(o,l){var u=l||{};u.dateNF||(u.dateNF="yyyymmdd");var f=ju(r(o,u),u);return f["!cols"]=u.DBF.map(function(p){return{wch:p.len,DBF:p}}),delete u.DBF,f}function i(o,l){try{return wl(n(o,l),l)}catch(u){if(l&&l.WTF)throw u}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,l){var u=l||{};if(+u.codepage>=0&&Js(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var f=Yi(),p=cp(o,{header:1,raw:!0,cellDates:!0}),g=p[0],m=p.slice(1),y=o["!cols"]||[],x=0,S=0,A=0,C=1;for(x=0;x<g.length;++x){if(((y[x]||{}).DBF||{}).name){g[x]=y[x].DBF.name,++A;continue}if(g[x]!=null){if(++A,typeof g[x]=="number"&&(g[x]=g[x].toString(10)),typeof g[x]!="string")throw new Error("DBF Invalid column name "+g[x]+" |"+typeof g[x]+"|");if(g.indexOf(g[x])!==x){for(S=0;S<1024;++S)if(g.indexOf(g[x]+"_"+S)==-1){g[x]+="_"+S;break}}}}var E=nr(o["!ref"]),O=[],q=[],H=[];for(x=0;x<=E.e.c-E.s.c;++x){var T="",F="",w=0,N=[];for(S=0;S<m.length;++S)m[S][x]!=null&&N.push(m[S][x]);if(N.length==0||g[x]==null){O[x]="?";continue}for(S=0;S<N.length;++S){switch(typeof N[S]){case"number":F="B";break;case"string":F="C";break;case"boolean":F="L";break;case"object":F=N[S]instanceof Date?"D":"C";break;default:F="C"}w=Math.max(w,String(N[S]).length),T=T&&T!=F?"C":F}w>250&&(w=250),F=((y[x]||{}).DBF||{}).type,F=="C"&&y[x].DBF.len>w&&(w=y[x].DBF.len),T=="B"&&F=="N"&&(T="N",H[x]=y[x].DBF.dec,w=y[x].DBF.len),q[x]=T=="C"||F=="N"?w:s[T]||0,C+=q[x],O[x]=T}var D=f.next(32);for(D.write_shift(4,318902576),D.write_shift(4,m.length),D.write_shift(2,296+32*A),D.write_shift(2,C),x=0;x<4;++x)D.write_shift(4,0);for(D.write_shift(4,0|(+e[IT]||3)<<8),x=0,S=0;x<g.length;++x)if(g[x]!=null){var P=f.next(32),R=(g[x].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);P.write_shift(1,R,"sbcs"),P.write_shift(1,O[x]=="?"?"C":O[x],"sbcs"),P.write_shift(4,S),P.write_shift(1,q[x]||s[O[x]]||0),P.write_shift(1,H[x]||0),P.write_shift(1,2),P.write_shift(4,0),P.write_shift(1,0),P.write_shift(4,0),P.write_shift(4,0),S+=q[x]||s[O[x]]||0}var qe=f.next(264);for(qe.write_shift(4,13),x=0;x<65;++x)qe.write_shift(4,0);for(x=0;x<m.length;++x){var Se=f.next(C);for(Se.write_shift(1,0),S=0;S<g.length;++S)if(g[S]!=null)switch(O[S]){case"L":Se.write_shift(1,m[x][S]==null?63:m[x][S]?84:70);break;case"B":Se.write_shift(8,m[x][S]||0,"f");break;case"N":var Oe="0";for(typeof m[x][S]=="number"&&(Oe=m[x][S].toFixed(H[S]||0)),A=0;A<q[S]-Oe.length;++A)Se.write_shift(1,32);Se.write_shift(1,Oe,"sbcs");break;case"D":m[x][S]?(Se.write_shift(4,("0000"+m[x][S].getFullYear()).slice(-4),"sbcs"),Se.write_shift(2,("00"+(m[x][S].getMonth()+1)).slice(-2),"sbcs"),Se.write_shift(2,("00"+m[x][S].getDate()).slice(-2),"sbcs")):Se.write_shift(8,"00000000","sbcs");break;case"C":var be=String(m[x][S]!=null?m[x][S]:"").slice(0,q[S]);for(Se.write_shift(1,be,"sbcs"),A=0;A<q[S]-be.length;++A)Se.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:i,to_sheet:n,from_sheet:a}}(),zA=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+sn(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(g,m){var y=t[m];return typeof y=="number"?z2(y):y},n=function(g,m,y){var x=m.charCodeAt(0)-32<<4|y.charCodeAt(0)-48;return x==59?g:z2(x)};t["|"]=254;function i(g,m){switch(m.type){case"base64":return s(fs(g),m);case"binary":return s(g,m);case"buffer":return s(Pt&&Buffer.isBuffer(g)?g.toString("binary"):Sl(g),m);case"array":return s(ec(g),m)}throw new Error("Unrecognized type "+m.type)}function s(g,m){var y=g.split(/[\n\r]+/),x=-1,S=-1,A=0,C=0,E=[],O=[],q=null,H={},T=[],F=[],w=[],N=0,D;for(+m.codepage>=0&&Js(+m.codepage);A!==y.length;++A){N=0;var P=y[A].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),R=P.replace(/;;/g,"\0").split(";").map(function(X){return X.replace(/\u0000/g,";")}),qe=R[0],Se;if(P.length>0)switch(qe){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":R[1].charAt(0)=="P"&&O.push(P.slice(3).replace(/;;/g,";"));break;case"C":var Oe=!1,be=!1,ke=!1,ne=!1,Ie=-1,je=-1;for(C=1;C<R.length;++C)switch(R[C].charAt(0)){case"A":break;case"X":S=parseInt(R[C].slice(1))-1,be=!0;break;case"Y":for(x=parseInt(R[C].slice(1))-1,be||(S=0),D=E.length;D<=x;++D)E[D]=[];break;case"K":Se=R[C].slice(1),Se.charAt(0)==='"'?Se=Se.slice(1,Se.length-1):Se==="TRUE"?Se=!0:Se==="FALSE"?Se=!1:isNaN(na(Se))?isNaN(Eu(Se).getDate())||(Se=Rr(Se)):(Se=na(Se),q!==null&&Mu(q)&&(Se=Kp(Se))),Oe=!0;break;case"E":ne=!0;var K=lu(R[C].slice(1),{r:x,c:S});E[x][S]=[E[x][S],K];break;case"S":ke=!0,E[x][S]=[E[x][S],"S5S"];break;case"G":break;case"R":Ie=parseInt(R[C].slice(1))-1;break;case"C":je=parseInt(R[C].slice(1))-1;break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+P)}if(Oe&&(E[x][S]&&E[x][S].length==2?E[x][S][0]=Se:E[x][S]=Se,q=null),ke){if(ne)throw new Error("SYLK shared formula cannot have own formula");var te=Ie>-1&&E[Ie][je];if(!te||!te[1])throw new Error("SYLK shared formula cannot find base");E[x][S][1]=aC(te[1],{r:x-Ie,c:S-je})}break;case"F":var re=0;for(C=1;C<R.length;++C)switch(R[C].charAt(0)){case"X":S=parseInt(R[C].slice(1))-1,++re;break;case"Y":for(x=parseInt(R[C].slice(1))-1,D=E.length;D<=x;++D)E[D]=[];break;case"M":N=parseInt(R[C].slice(1))/20;break;case"F":break;case"G":break;case"P":q=O[parseInt(R[C].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(w=R[C].slice(1).split(" "),D=parseInt(w[0],10);D<=parseInt(w[1],10);++D)N=parseInt(w[2],10),F[D-1]=N===0?{hidden:!0}:{wch:N},hl(F[D-1]);break;case"C":S=parseInt(R[C].slice(1))-1,F[S]||(F[S]={});break;case"R":x=parseInt(R[C].slice(1))-1,T[x]||(T[x]={}),N>0?(T[x].hpt=N,T[x].hpx=wu(N)):N===0&&(T[x].hidden=!0);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+P)}re<1&&(q=null);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+P)}}return T.length>0&&(H["!rows"]=T),F.length>0&&(H["!cols"]=F),m&&m.sheetRows&&(E=E.slice(0,m.sheetRows)),[E,H]}function a(g,m){var y=i(g,m),x=y[0],S=y[1],A=ju(x,m);return sn(S).forEach(function(C){A[C]=S[C]}),A}function o(g,m){return wl(a(g,m),m)}function l(g,m,y,x){var S="C;Y"+(y+1)+";X"+(x+1)+";K";switch(g.t){case"n":S+=g.v||0,g.f&&!g.F&&(S+=";E"+gv(g.f,{r:y,c:x}));break;case"b":S+=g.v?"TRUE":"FALSE";break;case"e":S+=g.w||g.v;break;case"d":S+='"'+(g.w||g.v)+'"';break;case"s":S+='"'+g.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return S}function u(g,m){m.forEach(function(y,x){var S="F;W"+(x+1)+" "+(x+1)+" ";y.hidden?S+="0":(typeof y.width=="number"&&!y.wpx&&(y.wpx=Tf(y.width)),typeof y.wpx=="number"&&!y.wch&&(y.wch=Af(y.wpx)),typeof y.wch=="number"&&(S+=Math.round(y.wch))),S.charAt(S.length-1)!=" "&&g.push(S)})}function f(g,m){m.forEach(function(y,x){var S="F;";y.hidden?S+="M0;":y.hpt?S+="M"+20*y.hpt+";":y.hpx&&(S+="M"+20*Cf(y.hpx)+";"),S.length>2&&g.push(S+"R"+(x+1))})}function p(g,m){var y=["ID;PWXL;N;E"],x=[],S=nr(g["!ref"]),A,C=Array.isArray(g),E=`\r
`;y.push("P;PGeneral"),y.push("F;P0;DG0G8;M255"),g["!cols"]&&u(y,g["!cols"]),g["!rows"]&&f(y,g["!rows"]),y.push("B;Y"+(S.e.r-S.s.r+1)+";X"+(S.e.c-S.s.c+1)+";D"+[S.s.c,S.s.r,S.e.c,S.e.r].join(" "));for(var O=S.s.r;O<=S.e.r;++O)for(var q=S.s.c;q<=S.e.c;++q){var H=gt({r:O,c:q});A=C?(g[O]||[])[q]:g[H],!(!A||A.v==null&&(!A.f||A.F))&&x.push(l(A,g,O,q))}return y.join(E)+E+x.join(E)+E+"E"+E}return{to_workbook:o,to_sheet:a,from_sheet:p}}(),WA=function(){function t(s,a){switch(a.type){case"base64":return e(fs(s),a);case"binary":return e(s,a);case"buffer":return e(Pt&&Buffer.isBuffer(s)?s.toString("binary"):Sl(s),a);case"array":return e(ec(s),a)}throw new Error("Unrecognized type "+a.type)}function e(s,a){for(var o=s.split(`
`),l=-1,u=-1,f=0,p=[];f!==o.length;++f){if(o[f].trim()==="BOT"){p[++l]=[],u=0;continue}if(!(l<0)){var g=o[f].trim().split(","),m=g[0],y=g[1];++f;for(var x=o[f]||"";(x.match(/["]/g)||[]).length&1&&f<o.length-1;)x+=`
`+o[++f];switch(x=x.trim(),+m){case-1:if(x==="BOT"){p[++l]=[],u=0;continue}else if(x!=="EOD")throw new Error("Unrecognized DIF special command "+x);break;case 0:x==="TRUE"?p[l][u]=!0:x==="FALSE"?p[l][u]=!1:isNaN(na(y))?isNaN(Eu(y).getDate())?p[l][u]=y:p[l][u]=Rr(y):p[l][u]=na(y),++u;break;case 1:x=x.slice(1,x.length-1),x=x.replace(/""/g,'"'),x&&x.match(/^=".*"$/)&&(x=x.slice(2,-1)),p[l][u++]=x!==""?x:null;break}if(x==="EOD")break}}return a&&a.sheetRows&&(p=p.slice(0,a.sheetRows)),p}function r(s,a){return ju(t(s,a),a)}function n(s,a){return wl(r(s,a),a)}var i=function(){var s=function(l,u,f,p,g){l.push(u),l.push(f+","+p),l.push('"'+g.replace(/"/g,'""')+'"')},a=function(l,u,f,p){l.push(u+","+f),l.push(u==1?'"'+p.replace(/"/g,'""')+'"':p)};return function(l){var u=[],f=nr(l["!ref"]),p,g=Array.isArray(l);s(u,"TABLE",0,1,"sheetjs"),s(u,"VECTORS",0,f.e.r-f.s.r+1,""),s(u,"TUPLES",0,f.e.c-f.s.c+1,""),s(u,"DATA",0,0,"");for(var m=f.s.r;m<=f.e.r;++m){a(u,-1,0,"BOT");for(var y=f.s.c;y<=f.e.c;++y){var x=gt({r:m,c:y});if(p=g?(l[m]||[])[y]:l[x],!p){a(u,1,0,"");continue}switch(p.t){case"n":var S=p.w;!S&&p.v!=null&&(S=p.v),S==null?p.f&&!p.F?a(u,1,0,"="+p.f):a(u,1,0,""):a(u,0,S,"V");break;case"b":a(u,0,p.v?1:0,p.v?"TRUE":"FALSE");break;case"s":a(u,1,0,isNaN(p.v)?p.v:'="'+p.v+'"');break;case"d":p.w||(p.w=Bs(p.z||pt[14],Nn(Rr(p.v)))),a(u,0,p.w,"V");break;default:a(u,1,0,"")}}}a(u,-1,0,"EOD");var A=`\r
`,C=u.join(A);return C}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),$A=function(){function t(p){return p.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(p){return p.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(p,g){for(var m=p.split(`
`),y=-1,x=-1,S=0,A=[];S!==m.length;++S){var C=m[S].trim().split(":");if(C[0]==="cell"){var E=Xr(C[1]);if(A.length<=E.r)for(y=A.length;y<=E.r;++y)A[y]||(A[y]=[]);switch(y=E.r,x=E.c,C[2]){case"t":A[y][x]=t(C[3]);break;case"v":A[y][x]=+C[3];break;case"vtf":var O=C[C.length-1];case"vtc":switch(C[3]){case"nl":A[y][x]=!!+C[4];break;default:A[y][x]=+C[4];break}C[2]=="vtf"&&(A[y][x]=[A[y][x],O])}}}return g&&g.sheetRows&&(A=A.slice(0,g.sheetRows)),A}function n(p,g){return ju(r(p,g),g)}function i(p,g){return wl(n(p,g),g)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function u(p){if(!p||!p["!ref"])return"";for(var g=[],m=[],y,x="",S=Xi(p["!ref"]),A=Array.isArray(p),C=S.s.r;C<=S.e.r;++C)for(var E=S.s.c;E<=S.e.c;++E)if(x=gt({r:C,c:E}),y=A?(p[C]||[])[E]:p[x],!(!y||y.v==null||y.t==="z")){switch(m=["cell",x,"t"],y.t){case"s":case"str":m.push(e(y.v));break;case"n":y.f?(m[2]="vtf",m[3]="n",m[4]=y.v,m[5]=e(y.f)):(m[2]="v",m[3]=y.v);break;case"b":m[2]="vt"+(y.f?"f":"c"),m[3]="nl",m[4]=y.v?"1":"0",m[5]=e(y.f||(y.v?"TRUE":"FALSE"));break;case"d":var O=Nn(Rr(y.v));m[2]="vtc",m[3]="nd",m[4]=""+O,m[5]=y.w||Bs(y.z||pt[14],O);break;case"e":continue}g.push(m.join(":"))}return g.push("sheet:c:"+(S.e.c-S.s.c+1)+":r:"+(S.e.r-S.s.r+1)+":tvf:1"),g.push("valueformat:1:text-wiki"),g.join(`
`)}function f(p){return[s,a,o,a,u(p),l].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:f}}(),Su=function(){function t(f,p,g,m,y){y.raw?p[g][m]=f:f===""||(f==="TRUE"?p[g][m]=!0:f==="FALSE"?p[g][m]=!1:isNaN(na(f))?isNaN(Eu(f).getDate())?p[g][m]=f:p[g][m]=Rr(f):p[g][m]=na(f))}function e(f,p){var g=p||{},m=[];if(!f||f.length===0)return m;for(var y=f.split(/[\r\n]/),x=y.length-1;x>=0&&y[x].length===0;)--x;for(var S=10,A=0,C=0;C<=x;++C)A=y[C].indexOf(" "),A==-1?A=y[C].length:A++,S=Math.max(S,A);for(C=0;C<=x;++C){m[C]=[];var E=0;for(t(y[C].slice(0,S).trim(),m,C,E,g),E=1;E<=(y[C].length-S)/10+1;++E)t(y[C].slice(S+(E-1)*10,S+E*10).trim(),m,C,E,g)}return g.sheetRows&&(m=m.slice(0,g.sheetRows)),m}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(f){for(var p={},g=!1,m=0,y=0;m<f.length;++m)(y=f.charCodeAt(m))==34?g=!g:!g&&y in r&&(p[y]=(p[y]||0)+1);y=[];for(m in p)Object.prototype.hasOwnProperty.call(p,m)&&y.push([p[m],m]);if(!y.length){p=n;for(m in p)Object.prototype.hasOwnProperty.call(p,m)&&y.push([p[m],m])}return y.sort(function(x,S){return x[0]-S[0]||n[x[1]]-n[S[1]]}),r[y.pop()[1]]||44}function s(f,p){var g=p||{},m="",y=g.dense?[]:{},x={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(m=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(m=f.charAt(4),f=f.slice(6)):m=i(f.slice(0,1024)):g&&g.FS?m=g.FS:m=i(f.slice(0,1024));var S=0,A=0,C=0,E=0,O=0,q=m.charCodeAt(0),H=!1,T=0,F=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var w=g.dateNF!=null?aR(g.dateNF):null;function N(){var D=f.slice(E,O),P={};if(D.charAt(0)=='"'&&D.charAt(D.length-1)=='"'&&(D=D.slice(1,-1).replace(/""/g,'"')),D.length===0)P.t="z";else if(g.raw)P.t="s",P.v=D;else if(D.trim().length===0)P.t="s",P.v=D;else if(D.charCodeAt(0)==61)D.charCodeAt(1)==34&&D.charCodeAt(D.length-1)==34?(P.t="s",P.v=D.slice(2,-1).replace(/""/g,'"')):O8(D)?(P.t="n",P.f=D.slice(1)):(P.t="s",P.v=D);else if(D=="TRUE")P.t="b",P.v=!0;else if(D=="FALSE")P.t="b",P.v=!1;else if(!isNaN(C=na(D)))P.t="n",g.cellText!==!1&&(P.w=D),P.v=C;else if(!isNaN(Eu(D).getDate())||w&&D.match(w)){P.z=g.dateNF||pt[14];var R=0;w&&D.match(w)&&(D=oR(D,g.dateNF,D.match(w)||[]),R=1),g.cellDates?(P.t="d",P.v=Rr(D,R)):(P.t="n",P.v=Nn(Rr(D,R))),g.cellText!==!1&&(P.w=Bs(P.z,P.v instanceof Date?Nn(P.v):P.v)),g.cellNF||delete P.z}else P.t="s",P.v=D;if(P.t=="z"||(g.dense?(y[S]||(y[S]=[]),y[S][A]=P):y[gt({c:A,r:S})]=P),E=O+1,F=f.charCodeAt(E),x.e.c<A&&(x.e.c=A),x.e.r<S&&(x.e.r=S),T==q)++A;else if(A=0,++S,g.sheetRows&&g.sheetRows<=S)return!0}e:for(;O<f.length;++O)switch(T=f.charCodeAt(O)){case 34:F===34&&(H=!H);break;case q:case 10:case 13:if(!H&&N())break e;break}return O-E>0&&N(),y["!ref"]=bt(x),y}function a(f,p){return!(p&&p.PRN)||p.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?s(f,p):ju(e(f,p),p)}function o(f,p){var g="",m=p.type=="string"?[0,0,0,0]:wv(f,p);switch(p.type){case"base64":g=fs(f);break;case"binary":g=f;break;case"buffer":p.codepage==65001?g=f.toString("utf8"):p.codepage&&typeof mf<"u"||(g=Pt&&Buffer.isBuffer(f)?f.toString("binary"):Sl(f));break;case"array":g=ec(f);break;case"string":g=f;break;default:throw new Error("Unrecognized type "+p.type)}return m[0]==239&&m[1]==187&&m[2]==191?g=vr(g.slice(3)):p.type!="string"&&p.type!="buffer"&&p.codepage==65001?g=vr(g):p.type=="binary"&&typeof mf<"u",g.slice(0,19)=="socialcalc:version:"?$A.to_sheet(p.type=="string"?g:vr(g),p):a(g,p)}function l(f,p){return wl(o(f,p),p)}function u(f){for(var p=[],g=nr(f["!ref"]),m,y=Array.isArray(f),x=g.s.r;x<=g.e.r;++x){for(var S=[],A=g.s.c;A<=g.e.c;++A){var C=gt({r:x,c:A});if(m=y?(f[x]||[])[A]:f[C],!m||m.v==null){S.push("          ");continue}for(var E=(m.w||(ao(m),m.w)||"").slice(0,10);E.length<10;)E+=" ";S.push(E+(A===0?" ":""))}p.push(S.join(""))}return p.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:u}}();function E6(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var i=zA.to_workbook(t,r);return r.WTF=n,i}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return Su.to_workbook(t,e)}}var $l=function(){function t(K,te,re){if(K){qn(K,K.l||0);for(var X=re.Enum||Ie;K.l<K.length;){var _e=K.read_shift(2),Ce=X[_e]||X[65535],Ve=K.read_shift(2),De=K.l+Ve,Ne=Ce.f&&Ce.f(K,Ve,re);if(K.l=De,te(Ne,Ce,_e))return}}}function e(K,te){switch(te.type){case"base64":return r(as(fs(K)),te);case"binary":return r(as(K),te);case"buffer":case"array":return r(K,te)}throw"Unsupported type "+te.type}function r(K,te){if(!K)return K;var re=te||{},X=re.dense?[]:{},_e="Sheet1",Ce="",Ve=0,De={},Ne=[],it=[],Z={s:{r:0,c:0},e:{r:0,c:0}},Rt=re.sheetRows||0;if(K[2]==0&&(K[3]==8||K[3]==9)&&K.length>=16&&K[14]==5&&K[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(K[2]==2)re.Enum=Ie,t(K,function(Ye,xr,Zr){switch(Zr){case 0:re.vers=Ye,Ye>=4096&&(re.qpro=!0);break;case 6:Z=Ye;break;case 204:Ye&&(Ce=Ye);break;case 222:Ce=Ye;break;case 15:case 51:re.qpro||(Ye[1].v=Ye[1].v.slice(1));case 13:case 14:case 16:Zr==14&&(Ye[2]&112)==112&&(Ye[2]&15)>1&&(Ye[2]&15)<15&&(Ye[1].z=re.dateNF||pt[14],re.cellDates&&(Ye[1].t="d",Ye[1].v=Kp(Ye[1].v))),re.qpro&&Ye[3]>Ve&&(X["!ref"]=bt(Z),De[_e]=X,Ne.push(_e),X=re.dense?[]:{},Z={s:{r:0,c:0},e:{r:0,c:0}},Ve=Ye[3],_e=Ce||"Sheet"+(Ve+1),Ce="");var En=re.dense?(X[Ye[0].r]||[])[Ye[0].c]:X[gt(Ye[0])];if(En){En.t=Ye[1].t,En.v=Ye[1].v,Ye[1].z!=null&&(En.z=Ye[1].z),Ye[1].f!=null&&(En.f=Ye[1].f);break}re.dense?(X[Ye[0].r]||(X[Ye[0].r]=[]),X[Ye[0].r][Ye[0].c]=Ye[1]):X[gt(Ye[0])]=Ye[1];break}},re);else if(K[2]==26||K[2]==14)re.Enum=je,K[2]==14&&(re.qpro=!0,K.l=0),t(K,function(Ye,xr,Zr){switch(Zr){case 204:_e=Ye;break;case 22:Ye[1].v=Ye[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Ye[3]>Ve&&(X["!ref"]=bt(Z),De[_e]=X,Ne.push(_e),X=re.dense?[]:{},Z={s:{r:0,c:0},e:{r:0,c:0}},Ve=Ye[3],_e="Sheet"+(Ve+1)),Rt>0&&Ye[0].r>=Rt)break;re.dense?(X[Ye[0].r]||(X[Ye[0].r]=[]),X[Ye[0].r][Ye[0].c]=Ye[1]):X[gt(Ye[0])]=Ye[1],Z.e.c<Ye[0].c&&(Z.e.c=Ye[0].c),Z.e.r<Ye[0].r&&(Z.e.r=Ye[0].r);break;case 27:Ye[14e3]&&(it[Ye[14e3][0]]=Ye[14e3][1]);break;case 1537:it[Ye[0]]=Ye[1],Ye[0]==Ve&&(_e=Ye[1]);break}},re);else throw new Error("Unrecognized LOTUS BOF "+K[2]);if(X["!ref"]=bt(Z),De[Ce||_e]=X,Ne.push(Ce||_e),!it.length)return{SheetNames:Ne,Sheets:De};for(var wt={},Dt=[],Et=0;Et<it.length;++Et)De[Ne[Et]]?(Dt.push(it[Et]||Ne[Et]),wt[it[Et]]=De[it[Et]]||De[Ne[Et]]):(Dt.push(it[Et]),wt[it[Et]]={"!ref":"A1"});return{SheetNames:Dt,Sheets:wt}}function n(K,te){var re=te||{};if(+re.codepage>=0&&Js(+re.codepage),re.type=="string")throw new Error("Cannot write WK1 to JS string");var X=Yi(),_e=nr(K["!ref"]),Ce=Array.isArray(K),Ve=[];Ke(X,0,s(1030)),Ke(X,6,l(_e));for(var De=Math.min(_e.e.r,8191),Ne=_e.s.r;Ne<=De;++Ne)for(var it=un(Ne),Z=_e.s.c;Z<=_e.e.c;++Z){Ne===_e.s.r&&(Ve[Z]=Yr(Z));var Rt=Ve[Z]+it,wt=Ce?(K[Ne]||[])[Z]:K[Rt];if(!(!wt||wt.t=="z"))if(wt.t=="n")(wt.v|0)==wt.v&&wt.v>=-32768&&wt.v<=32767?Ke(X,13,m(Ne,Z,wt.v)):Ke(X,14,x(Ne,Z,wt.v));else{var Dt=ao(wt);Ke(X,15,p(Ne,Z,Dt.slice(0,239)))}}return Ke(X,1),X.end()}function i(K,te){var re=te||{};if(+re.codepage>=0&&Js(+re.codepage),re.type=="string")throw new Error("Cannot write WK3 to JS string");var X=Yi();Ke(X,0,a(K));for(var _e=0,Ce=0;_e<K.SheetNames.length;++_e)(K.Sheets[K.SheetNames[_e]]||{})["!ref"]&&Ke(X,27,ne(K.SheetNames[_e],Ce++));var Ve=0;for(_e=0;_e<K.SheetNames.length;++_e){var De=K.Sheets[K.SheetNames[_e]];if(!(!De||!De["!ref"])){for(var Ne=nr(De["!ref"]),it=Array.isArray(De),Z=[],Rt=Math.min(Ne.e.r,8191),wt=Ne.s.r;wt<=Rt;++wt)for(var Dt=un(wt),Et=Ne.s.c;Et<=Ne.e.c;++Et){wt===Ne.s.r&&(Z[Et]=Yr(Et));var Ye=Z[Et]+Dt,xr=it?(De[wt]||[])[Et]:De[Ye];if(!(!xr||xr.t=="z"))if(xr.t=="n")Ke(X,23,N(wt,Et,Ve,xr.v));else{var Zr=ao(xr);Ke(X,22,T(wt,Et,Ve,Zr.slice(0,239)))}}++Ve}}return Ke(X,1),X.end()}function s(K){var te=Ee(2);return te.write_shift(2,K),te}function a(K){var te=Ee(26);te.write_shift(2,4096),te.write_shift(2,4),te.write_shift(4,0);for(var re=0,X=0,_e=0,Ce=0;Ce<K.SheetNames.length;++Ce){var Ve=K.SheetNames[Ce],De=K.Sheets[Ve];if(!(!De||!De["!ref"])){++_e;var Ne=Xi(De["!ref"]);re<Ne.e.r&&(re=Ne.e.r),X<Ne.e.c&&(X=Ne.e.c)}}return re>8191&&(re=8191),te.write_shift(2,re),te.write_shift(1,_e),te.write_shift(1,X),te.write_shift(2,0),te.write_shift(2,0),te.write_shift(1,1),te.write_shift(1,2),te.write_shift(4,0),te.write_shift(4,0),te}function o(K,te,re){var X={s:{c:0,r:0},e:{c:0,r:0}};return te==8&&re.qpro?(X.s.c=K.read_shift(1),K.l++,X.s.r=K.read_shift(2),X.e.c=K.read_shift(1),K.l++,X.e.r=K.read_shift(2),X):(X.s.c=K.read_shift(2),X.s.r=K.read_shift(2),te==12&&re.qpro&&(K.l+=2),X.e.c=K.read_shift(2),X.e.r=K.read_shift(2),te==12&&re.qpro&&(K.l+=2),X.s.c==65535&&(X.s.c=X.e.c=X.s.r=X.e.r=0),X)}function l(K){var te=Ee(8);return te.write_shift(2,K.s.c),te.write_shift(2,K.s.r),te.write_shift(2,K.e.c),te.write_shift(2,K.e.r),te}function u(K,te,re){var X=[{c:0,r:0},{t:"n",v:0},0,0];return re.qpro&&re.vers!=20768?(X[0].c=K.read_shift(1),X[3]=K.read_shift(1),X[0].r=K.read_shift(2),K.l+=2):(X[2]=K.read_shift(1),X[0].c=K.read_shift(2),X[0].r=K.read_shift(2)),X}function f(K,te,re){var X=K.l+te,_e=u(K,te,re);if(_e[1].t="s",re.vers==20768){K.l++;var Ce=K.read_shift(1);return _e[1].v=K.read_shift(Ce,"utf8"),_e}return re.qpro&&K.l++,_e[1].v=K.read_shift(X-K.l,"cstr"),_e}function p(K,te,re){var X=Ee(7+re.length);X.write_shift(1,255),X.write_shift(2,te),X.write_shift(2,K),X.write_shift(1,39);for(var _e=0;_e<X.length;++_e){var Ce=re.charCodeAt(_e);X.write_shift(1,Ce>=128?95:Ce)}return X.write_shift(1,0),X}function g(K,te,re){var X=u(K,te,re);return X[1].v=K.read_shift(2,"i"),X}function m(K,te,re){var X=Ee(7);return X.write_shift(1,255),X.write_shift(2,te),X.write_shift(2,K),X.write_shift(2,re,"i"),X}function y(K,te,re){var X=u(K,te,re);return X[1].v=K.read_shift(8,"f"),X}function x(K,te,re){var X=Ee(13);return X.write_shift(1,255),X.write_shift(2,te),X.write_shift(2,K),X.write_shift(8,re,"f"),X}function S(K,te,re){var X=K.l+te,_e=u(K,te,re);if(_e[1].v=K.read_shift(8,"f"),re.qpro)K.l=X;else{var Ce=K.read_shift(2);O(K.slice(K.l,K.l+Ce),_e),K.l+=Ce}return _e}function A(K,te,re){var X=te&32768;return te&=-32769,te=(X?K:0)+(te>=8192?te-16384:te),(X?"":"$")+(re?Yr(te):un(te))}var C={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},E=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function O(K,te){qn(K,0);for(var re=[],X=0,_e="",Ce="",Ve="",De="";K.l<K.length;){var Ne=K[K.l++];switch(Ne){case 0:re.push(K.read_shift(8,"f"));break;case 1:Ce=A(te[0].c,K.read_shift(2),!0),_e=A(te[0].r,K.read_shift(2),!1),re.push(Ce+_e);break;case 2:{var it=A(te[0].c,K.read_shift(2),!0),Z=A(te[0].r,K.read_shift(2),!1);Ce=A(te[0].c,K.read_shift(2),!0),_e=A(te[0].r,K.read_shift(2),!1),re.push(it+Z+":"+Ce+_e)}break;case 3:if(K.l<K.length){console.error("WK1 premature formula end");return}break;case 4:re.push("("+re.pop()+")");break;case 5:re.push(K.read_shift(2));break;case 6:{for(var Rt="";Ne=K[K.l++];)Rt+=String.fromCharCode(Ne);re.push('"'+Rt.replace(/"/g,'""')+'"')}break;case 8:re.push("-"+re.pop());break;case 23:re.push("+"+re.pop());break;case 22:re.push("NOT("+re.pop()+")");break;case 20:case 21:De=re.pop(),Ve=re.pop(),re.push(["AND","OR"][Ne-20]+"("+Ve+","+De+")");break;default:if(Ne<32&&E[Ne])De=re.pop(),Ve=re.pop(),re.push(Ve+E[Ne]+De);else if(C[Ne]){if(X=C[Ne][1],X==69&&(X=K[K.l++]),X>re.length){console.error("WK1 bad formula parse 0x"+Ne.toString(16)+":|"+re.join("|")+"|");return}var wt=re.slice(-X);re.length-=X,re.push(C[Ne][0]+"("+wt.join(",")+")")}else return Ne<=7?console.error("WK1 invalid opcode "+Ne.toString(16)):Ne<=24?console.error("WK1 unsupported op "+Ne.toString(16)):Ne<=30?console.error("WK1 invalid opcode "+Ne.toString(16)):Ne<=115?console.error("WK1 unsupported function opcode "+Ne.toString(16)):console.error("WK1 unrecognized opcode "+Ne.toString(16))}}re.length==1?te[1].f=""+re[0]:console.error("WK1 bad formula parse |"+re.join("|")+"|")}function q(K){var te=[{c:0,r:0},{t:"n",v:0},0];return te[0].r=K.read_shift(2),te[3]=K[K.l++],te[0].c=K[K.l++],te}function H(K,te){var re=q(K);return re[1].t="s",re[1].v=K.read_shift(te-4,"cstr"),re}function T(K,te,re,X){var _e=Ee(6+X.length);_e.write_shift(2,K),_e.write_shift(1,re),_e.write_shift(1,te),_e.write_shift(1,39);for(var Ce=0;Ce<X.length;++Ce){var Ve=X.charCodeAt(Ce);_e.write_shift(1,Ve>=128?95:Ve)}return _e.write_shift(1,0),_e}function F(K,te){var re=q(K);re[1].v=K.read_shift(2);var X=re[1].v>>1;if(re[1].v&1)switch(X&7){case 0:X=(X>>3)*5e3;break;case 1:X=(X>>3)*500;break;case 2:X=(X>>3)/20;break;case 3:X=(X>>3)/200;break;case 4:X=(X>>3)/2e3;break;case 5:X=(X>>3)/2e4;break;case 6:X=(X>>3)/16;break;case 7:X=(X>>3)/64;break}return re[1].v=X,re}function w(K,te){var re=q(K),X=K.read_shift(4),_e=K.read_shift(4),Ce=K.read_shift(2);if(Ce==65535)return X===0&&_e===3221225472?(re[1].t="e",re[1].v=15):X===0&&_e===3489660928?(re[1].t="e",re[1].v=42):re[1].v=0,re;var Ve=Ce&32768;return Ce=(Ce&32767)-16446,re[1].v=(1-Ve*2)*(_e*Math.pow(2,Ce+32)+X*Math.pow(2,Ce)),re}function N(K,te,re,X){var _e=Ee(14);if(_e.write_shift(2,K),_e.write_shift(1,re),_e.write_shift(1,te),X==0)return _e.write_shift(4,0),_e.write_shift(4,0),_e.write_shift(2,65535),_e;var Ce=0,Ve=0,De=0,Ne=0;return X<0&&(Ce=1,X=-X),Ve=Math.log2(X)|0,X/=Math.pow(2,Ve-31),Ne=X>>>0,Ne&2147483648||(X/=2,++Ve,Ne=X>>>0),X-=Ne,Ne|=2147483648,Ne>>>=0,X*=Math.pow(2,32),De=X>>>0,_e.write_shift(4,De),_e.write_shift(4,Ne),Ve+=16383+(Ce?32768:0),_e.write_shift(2,Ve),_e}function D(K,te){var re=w(K);return K.l+=te-14,re}function P(K,te){var re=q(K),X=K.read_shift(4);return re[1].v=X>>6,re}function R(K,te){var re=q(K),X=K.read_shift(8,"f");return re[1].v=X,re}function qe(K,te){var re=R(K);return K.l+=te-10,re}function Se(K,te){return K[K.l+te-1]==0?K.read_shift(te,"cstr"):""}function Oe(K,te){var re=K[K.l++];re>te-1&&(re=te-1);for(var X="";X.length<re;)X+=String.fromCharCode(K[K.l++]);return X}function be(K,te,re){if(!(!re.qpro||te<21)){var X=K.read_shift(1);K.l+=17,K.l+=1,K.l+=2;var _e=K.read_shift(te-21,"cstr");return[X,_e]}}function ke(K,te){for(var re={},X=K.l+te;K.l<X;){var _e=K.read_shift(2);if(_e==14e3){for(re[_e]=[0,""],re[_e][0]=K.read_shift(2);K[K.l];)re[_e][1]+=String.fromCharCode(K[K.l]),K.l++;K.l++}}return re}function ne(K,te){var re=Ee(5+K.length);re.write_shift(2,14e3),re.write_shift(2,te);for(var X=0;X<K.length;++X){var _e=K.charCodeAt(X);re[re.l++]=_e>127?95:_e}return re[re.l++]=0,re}var Ie={0:{n:"BOF",f:yn},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:g},14:{n:"NUMBER",f:y},15:{n:"LABEL",f},16:{n:"FORMULA",f:S},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Se},222:{n:"SHEETNAMELP",f:Oe},65535:{n:""}},je={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:H},23:{n:"NUMBER17",f:w},24:{n:"NUMBER18",f:F},25:{n:"FORMULA19",f:D},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ke},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:P},38:{n:"??"},39:{n:"NUMBER27",f:R},40:{n:"FORMULA28",f:qe},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Se},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:be},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:e}}();function S6(t){var e={},r=t.match(Ei),n=0,i=!1;if(r)for(;n!=r.length;++n){var s=mt(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;e.cp=U1[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=s.val;break;case"<sz":e.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":s.rgb&&(e.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+s[0])}}return e}var w6=function(){var t=yf("t"),e=yf("rPr");function r(s){var a=s.match(t);if(!a)return{t:"s",v:""};var o={t:"s",v:rr(a[1])},l=s.match(e);return l&&(o.s=S6(l[1])),o}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(a){return a.replace(n,"").split(i).map(r).filter(function(o){return o.v})}}(),T6=function(){var e=/(\r\n|\n)/g;function r(i,s,a){var o=[];i.u&&o.push("text-decoration: underline;"),i.uval&&o.push("text-underline-style:"+i.uval+";"),i.sz&&o.push("font-size:"+i.sz+"pt;"),i.outline&&o.push("text-effect: outline;"),i.shadow&&o.push("text-shadow: auto;"),s.push('<span style="'+o.join("")+'">'),i.b&&(s.push("<b>"),a.push("</b>")),i.i&&(s.push("<i>"),a.push("</i>")),i.strike&&(s.push("<s>"),a.push("</s>"));var l=i.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(s.push("<"+l+">"),a.push("</"+l+">")),a.push("</span>"),i}function n(i){var s=[[],i.v,[]];return i.v?(i.s&&r(i.s,s[0],s[2]),s[0].join("")+s[1].replace(e,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),A6=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,C6=/<(?:\w+:)?r>/,k6=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function uv(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=rr(vr(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=vr(t),r&&(n.h=q1(n.t))):t.match(C6)&&(n.r=vr(t),n.t=rr(vr((t.replace(k6,"").match(A6)||[]).join("").replace(Ei,""))),r&&(n.h=T6(w6(n.r)))),n):{t:""}}var F6=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,b6=/<(?:\w+:)?(?:si|sstItem)>/g,I6=/<\/(?:\w+:)?(?:si|sstItem)>/;function N6(t,e){var r=[],n="";if(!t)return r;var i=t.match(F6);if(i){n=i[2].replace(b6,"").split(I6);for(var s=0;s!=n.length;++s){var a=uv(n[s].trim(),e);a!=null&&(r[r.length]=a)}i=mt(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}var R6=/^\s|\s$|[\t\n\r]/;function HA(t,e){if(!e.bookSST)return"";var r=[dn];r[r.length]=Ge("sst",null,{xmlns:fc[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var i=t[n],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(R6)&&(s+=' xml:space="preserve"'),s+=">"+pr(i.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function D6(t){return[t.read_shift(4),t.read_shift(4)]}function P6(t,e){var r=[],n=!1;return go(t,function(s,a,o){switch(o){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(a.T,!n||e.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function O6(t,e){return e||(e=Ee(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var M6=GR;function B6(t){var e=Yi();Fe(e,159,O6(t));for(var r=0;r<t.length;++r)Fe(e,19,M6(t[r]));return Fe(e,160),e.end()}function GA(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function eo(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function j6(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=eo(t,4),e.U=eo(t,4),e.W=eo(t,4),e}function L6(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},i=t.read_shift(4),s=[];i-- >0;)s.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=s,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function U6(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(L6(t));return e}function V6(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function z6(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=eo(t,4),e.U=eo(t,4),e.W=eo(t,4),e}function W6(t){var e=z6(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function KA(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function YA(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function $6(t){var e=eo(t);switch(e.Minor){case 2:return[e.Minor,H6(t)];case 3:return[e.Minor,G6()];case 4:return[e.Minor,K6(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function H6(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=KA(t,r),i=YA(t,t.length-t.l);return{t:"Std",h:n,v:i}}function G6(){throw new Error("File is password-protected: ECMA-376 Extensible")}function K6(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(Ei,function(s){var a=mt(s);switch(Oa(a[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(o){n[o]=a[o]});break;case"<dataIntegrity":n.encryptedHmacKey=a.encryptedHmacKey,n.encryptedHmacValue=a.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=a.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(a);break;default:throw a[0]}}),n}function Y6(t,e){var r={},n=r.EncryptionVersionInfo=eo(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var i=t.read_shift(4);return e-=4,r.EncryptionHeader=KA(t,i),e-=i,r.EncryptionVerifier=YA(t,e),r}function X6(t){var e={},r=e.EncryptionVersionInfo=eo(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function dv(t){var e=0,r,n=GA(t),i=n.length+1,s,a,o,l,u;for(r=fl(i),r[0]=n.length,s=1;s!=i;++s)r[s]=n[s-1];for(s=i-1;s>=0;--s)a=r[s],o=e&16384?1:0,l=e<<1&32767,u=o|l,e=u^a;return e^52811}var XA=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(a){return(a/2|a*128)&255},i=function(a,o){return n(a^o)},s=function(a){for(var o=e[a.length-1],l=104,u=a.length-1;u>=0;--u)for(var f=a[u],p=0;p!=7;++p)f&64&&(o^=r[l]),f*=2,--l;return o};return function(a){for(var o=GA(a),l=s(o),u=o.length,f=fl(16),p=0;p!=16;++p)f[p]=0;var g,m,y;for((u&1)===1&&(g=l>>8,f[u]=i(t[0],g),--u,g=l&255,m=o[o.length-1],f[u]=i(m,g));u>0;)--u,g=l>>8,f[u]=i(o[u],g),--u,g=l&255,f[u]=i(o[u],g);for(u=15,y=15-o.length;y>0;)g=l>>8,f[u]=i(t[y],g),--u,--y,g=l&255,f[u]=i(o[u],g),--u,--y;return f}}(),q6=function(t,e,r,n,i){i||(i=e),n||(n=XA(t));var s,a;for(s=0;s!=e.length;++s)a=e[s],a^=n[r],a=(a>>5|a<<3)&255,i[s]=a,++r;return[i,r,n]},Q6=function(t){var e=0,r=XA(t);return function(n){var i=q6("",n,e,r);return e=i[1],i[0]}};function J6(t,e,r,n){var i={key:yn(t),verificationBytes:yn(t)};return r.password&&(i.verifier=dv(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=Q6(r.password)),i}function Z6(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=X6(t):n.Data=Y6(t,e),n}function eP(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?Z6(t,e-2,n):J6(t,r.biff>=8?e:e-2,r,n),n}var qA=function(){function t(i,s){switch(s.type){case"base64":return e(fs(i),s);case"binary":return e(i,s);case"buffer":return e(Pt&&Buffer.isBuffer(i)?i.toString("binary"):Sl(i),s);case"array":return e(ec(i),s)}throw new Error("Unrecognized type "+s.type)}function e(i,s){var a=s||{},o=a.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(f,p){Array.isArray(o)&&(o[p]=[]);for(var g=/\\\w+\b/g,m=0,y,x=-1;y=g.exec(f);){switch(y[0]){case"\\cell":var S=f.slice(m,g.lastIndex-y[0].length);if(S[0]==" "&&(S=S.slice(1)),++x,S.length){var A={v:S,t:"s"};Array.isArray(o)?o[p][x]=A:o[gt({r:p,c:x})]=A}break}m=g.lastIndex}x>u.e.c&&(u.e.c=x)}),o["!ref"]=bt(u),o}function r(i,s){return wl(t(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],a=nr(i["!ref"]),o,l=Array.isArray(i),u=a.s.r;u<=a.e.r;++u){s.push("\\trowd\\trautofit1");for(var f=a.s.c;f<=a.e.c;++f)s.push("\\cellx"+(f+1));for(s.push("\\pard\\intbl"),f=a.s.c;f<=a.e.c;++f){var p=gt({r:u,c:f});o=l?(i[u]||[])[f]:i[p],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(ao(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function tP(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function wf(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function rP(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,i=Math.max(e,r,n),s=Math.min(e,r,n),a=i-s;if(a===0)return[0,0,e];var o=0,l=0,u=i+s;switch(l=a/(u>1?2-u:u),i){case e:o=((r-n)/a+6)%6;break;case r:o=(n-e)/a+2;break;case n:o=(e-r)/a+4;break}return[o/6,l,u/2]}function nP(t){var e=t[0],r=t[1],n=t[2],i=r*2*(n<.5?n:1-n),s=n-i/2,a=[s,s,s],o=6*e,l;if(r!==0)switch(o|0){case 0:case 6:l=i*o,a[0]+=i,a[1]+=l;break;case 1:l=i*(2-o),a[0]+=l,a[1]+=i;break;case 2:l=i*(o-2),a[1]+=i,a[2]+=l;break;case 3:l=i*(4-o),a[1]+=l,a[2]+=i;break;case 4:l=i*(o-4),a[2]+=i,a[0]+=l;break;case 5:l=i*(6-o),a[2]+=l,a[0]+=i;break}for(var u=0;u!=3;++u)a[u]=Math.round(a[u]*255);return a}function op(t,e){if(e===0)return t;var r=rP(tP(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),wf(nP(r))}var QA=6,iP=15,sP=1,pi=QA;function Tf(t){return Math.floor((t+Math.round(128/pi)/256)*pi)}function Af(t){return Math.floor((t-5)/pi*100+.5)/100}function lp(t){return Math.round((t*pi+5)/pi*256)/256}function Yg(t){return lp(Af(Tf(t)))}function fv(t){var e=Math.abs(t-Yg(t)),r=pi;if(e>.005)for(pi=sP;pi<iP;++pi)Math.abs(t-Yg(t))<=e&&(e=Math.abs(t-Yg(t)),r=pi);pi=r}function hl(t){t.width?(t.wpx=Tf(t.width),t.wch=Af(t.wpx),t.MDW=pi):t.wpx?(t.wch=Af(t.wpx),t.width=lp(t.wch),t.MDW=pi):typeof t.wch=="number"&&(t.width=lp(t.wch),t.wpx=Tf(t.width),t.MDW=pi),t.customWidth&&delete t.customWidth}var aP=96,JA=aP;function Cf(t){return t*96/JA}function wu(t){return t*JA/96}var oP={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function lP(t,e,r,n){e.Borders=[];var i={},s=!1;(t[0].match(Ei)||[]).forEach(function(a){var o=mt(a);switch(Oa(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},o.diagonalUp&&(i.diagonalUp=Ir(o.diagonalUp)),o.diagonalDown&&(i.diagonalDown=Ir(o.diagonalDown)),e.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in borders")}})}function cP(t,e,r,n){e.Fills=[];var i={},s=!1;(t[0].match(Ei)||[]).forEach(function(a){var o=mt(a);switch(Oa(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},e.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":o.patternType&&(i.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),o.indexed&&(i.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(i.bgColor.theme=parseInt(o.theme,10)),o.tint&&(i.bgColor.tint=parseFloat(o.tint)),o.rgb&&(i.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),o.theme&&(i.fgColor.theme=parseInt(o.theme,10)),o.tint&&(i.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(i.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fills")}})}function uP(t,e,r,n){e.Fonts=[];var i={},s=!1;(t[0].match(Ei)||[]).forEach(function(a){var o=mt(a);switch(Oa(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(i),i={};break;case"<name":o.val&&(i.name=vr(o.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=o.val?Ir(o.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=o.val?Ir(o.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(o.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=o.val?Ir(o.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=o.val?Ir(o.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=o.val?Ir(o.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=o.val?Ir(o.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=o.val?Ir(o.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":o.val&&(i.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(i.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(i.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(i.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=U1[parseInt(o.val,10)];break;case"<color":if(i.color||(i.color={}),o.auto&&(i.color.auto=Ir(o.auto)),o.rgb)i.color.rgb=o.rgb.slice(-6);else if(o.indexed){i.color.index=parseInt(o.indexed,10);var l=zl[i.color.index];i.color.index==81&&(l=zl[1]),l||(l=zl[1]),i.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(i.color.theme=parseInt(o.theme,10),o.tint&&(i.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=op(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fonts")}})}function dP(t,e,r){e.NumberFmt=[];for(var n=sn(pt),i=0;i<n.length;++i)e.NumberFmt[n[i]]=pt[n[i]];var s=t[0].match(Ei);if(s)for(i=0;i<s.length;++i){var a=mt(s[i]);switch(Oa(a[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=rr(vr(a.formatCode)),l=parseInt(a.numFmtId,10);if(e.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&e.NumberFmt[l]!=null;--l);e.NumberFmt[l]=o}Za(o,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+a[0]+" in numFmts")}}}function fP(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)t[n]!=null&&(e[e.length]=Ge("numFmt",null,{numFmtId:n,formatCode:pr(t[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=Ge("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var W0=["numFmtId","fillId","fontId","borderId","xfId"],$0=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function hP(t,e,r){e.CellXf=[];var n,i=!1;(t[0].match(Ei)||[]).forEach(function(s){var a=mt(s),o=0;switch(Oa(a[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=a,delete n[0],o=0;o<W0.length;++o)n[W0[o]]&&(n[W0[o]]=parseInt(n[W0[o]],10));for(o=0;o<$0.length;++o)n[$0[o]]&&(n[$0[o]]=Ir(n[$0[o]]));if(e.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[o]){n.numFmtId=o;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};a.vertical&&(l.vertical=a.vertical),a.horizontal&&(l.horizontal=a.horizontal),a.textRotation!=null&&(l.textRotation=a.textRotation),a.indent&&(l.indent=a.indent),a.wrapText&&(l.wrapText=Ir(a.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+a[0]+" in cellXfs")}})}function pP(t){var e=[];return e[e.length]=Ge("cellXfs",null),t.forEach(function(r){e[e.length]=Ge("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=Ge("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var gP=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,u){var f={};if(!o)return f;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var p;return(p=o.match(e))&&dP(p,f,u),(p=o.match(i))&&uP(p,f,l,u),(p=o.match(n))&&cP(p,f,l,u),(p=o.match(s))&&lP(p,f,l,u),(p=o.match(r))&&hP(p,f,u),f}}();function ZA(t,e){var r=[dn,Ge("styleSheet",null,{xmlns:fc[0],"xmlns:vt":kn.vt})],n;return t.SSF&&(n=fP(t.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=pP(e.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function mP(t,e){var r=t.read_shift(2),n=xi(t);return[r,n]}function xP(t,e,r){r||(r=Ee(6+4*e.length)),r.write_shift(2,t),Un(e,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function vP(t,e,r){var n={};n.sz=t.read_shift(2)/20;var i=ZR(t);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=t.read_shift(2);switch(s===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=t.read_shift(1);a!=0&&(n.underline=a);var o=t.read_shift(1);o>0&&(n.family=o);var l=t.read_shift(1);switch(l>0&&(n.charset=l),t.l++,n.color=JR(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=xi(t),n}function yP(t,e){e||(e=Ee(25+4*32)),e.write_shift(2,t.sz*20),eD(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),ip(t.color,e);var n=0;return n=2,e.write_shift(1,n),Un(t.name,e),e.length>e.l?e.slice(0,e.l):e}var _P=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Xg,EP=yi;function R_(t,e){e||(e=Ee(4*3+8*7+16*1)),Xg||(Xg=Hp(_P));var r=Xg[t.patternType];r==null&&(r=40),e.write_shift(4,r);var n=0;if(r!=40)for(ip({auto:1},e),ip({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function SP(t,e){var r=t.l+e,n=t.read_shift(2),i=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:i}}function eC(t,e,r){r||(r=Ee(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function hd(t,e){return e||(e=Ee(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var wP=yi;function TP(t,e){return e||(e=Ee(51)),e.write_shift(1,0),hd(null,e),hd(null,e),hd(null,e),hd(null,e),hd(null,e),e.length>e.l?e.slice(0,e.l):e}function AP(t,e){return e||(e=Ee(12+4*10)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),np(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function CP(t,e,r){var n=Ee(2052);return n.write_shift(4,t),np(e,n),np(r,n),n.length>n.l?n.slice(0,n.l):n}function kP(t,e,r){var n={};n.NumberFmt=[];for(var i in pt)n.NumberFmt[i]=pt[i];n.CellXf=[],n.Fonts=[];var s=[],a=!1;return go(t,function(l,u,f){switch(f){case 44:n.NumberFmt[l[0]]=l[1],Za(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(l.color.rgb=op(e.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:s.push(f),a=!0;break;case 38:s.pop(),a=!1;break;default:if(u.T>0)s.push(f);else if(u.T<0)s.pop();else if(!a||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+f.toString(16))}}),n}function FP(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&++r}),r!=0&&(Fe(t,615,ia(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&Fe(t,44,xP(i,e[i]))}),Fe(t,616))}}function bP(t){var e=1;Fe(t,611,ia(e)),Fe(t,43,yP({sz:12,color:{theme:1},name:"Calibri",family:2})),Fe(t,612)}function IP(t){var e=2;Fe(t,603,ia(e)),Fe(t,45,R_({patternType:"none"})),Fe(t,45,R_({patternType:"gray125"})),Fe(t,604)}function NP(t){var e=1;Fe(t,613,ia(e)),Fe(t,46,TP()),Fe(t,614)}function RP(t){var e=1;Fe(t,626,ia(e)),Fe(t,47,eC({numFmtId:0},65535)),Fe(t,627)}function DP(t,e){Fe(t,617,ia(e.length)),e.forEach(function(r){Fe(t,47,eC(r,0))}),Fe(t,618)}function PP(t){var e=1;Fe(t,619,ia(e)),Fe(t,48,AP({xfId:0,name:"Normal"})),Fe(t,620)}function OP(t){var e=0;Fe(t,505,ia(e)),Fe(t,506)}function MP(t){var e=0;Fe(t,508,CP(e,"TableStyleMedium9","PivotStyleMedium4")),Fe(t,509)}function BP(t,e){var r=Yi();return Fe(r,278),FP(r,t.SSF),bP(r),IP(r),NP(r),RP(r),DP(r,e.cellXfs),PP(r),OP(r),MP(r),Fe(r,279),r.end()}var jP=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function LP(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(Ei)||[]).forEach(function(i){var s=mt(i);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(e.themeElements.clrScheme[jP.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function UP(){}function VP(){}var zP=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,WP=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,$P=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function HP(t,e,r){e.themeElements={};var n;[["clrScheme",zP,LP],["fontScheme",WP,UP],["fmtScheme",$P,VP]].forEach(function(i){if(!(n=t.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,e,r)})}var GP=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function tC(t,e){(!t||t.length===0)&&(t=hv());var r,n={};if(!(r=t.match(GP)))throw new Error("themeElements not found in theme");return HP(r[0],n,e),n.raw=t,n}function hv(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[dn];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function KP(t,e,r){var n=t.l+e,i=t.read_shift(4);if(i!==124226){if(!r.cellStyles){t.l=n;return}var s=t.slice(t.l);t.l=n;var a;try{a=KT(s,{type:"array"})}catch{return}var o=os(a,"theme/theme/theme1.xml",!0);if(o)return tC(o,r)}}function YP(t){return t.read_shift(4)}function XP(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=qP(t,4);break;case 2:e.xclrValue=PA(t);break;case 3:e.xclrValue=YP(t);break;case 4:t.l+=4;break}return t.l+=8,e}function qP(t,e){return yi(t,e)}function QP(t,e){return yi(t,e)}function JP(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=XP(t);break;case 6:n[1]=QP(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function ZP(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var i=t.read_shift(2),s=[];i-- >0;)s.push(JP(t,r-t.l));return{ixfe:n,ext:s}}function e8(t,e){e.forEach(function(r){switch(r[0]){}})}function t8(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:xi(t)}}function r8(t){var e=Ee(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),Un(t.name,e),e.slice(0,e.l)}function n8(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function i8(t){var e=Ee(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function s8(t,e){var r=Ee(8+2*e.length);return r.write_shift(4,t),Un(e,r),r.slice(0,r.l)}function a8(t){return t.l+=4,t.read_shift(4)!=0}function o8(t,e){var r=Ee(8);return r.write_shift(4,t),r.write_shift(4,1),r}function l8(t,e,r){var n={Types:[],Cell:[],Value:[]},i=r||{},s=[],a=!1,o=2;return go(t,function(l,u,f){switch(f){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(p){o==1?n.Cell.push({type:n.Types[p[0]-1].name,index:p[1]}):o==0&&n.Value.push({type:n.Types[p[0]-1].name,index:p[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:s.push(f),a=!0;break;case 36:s.pop(),a=!1;break;default:if(!u.T){if(!a||i.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}}),n}function c8(){var t=Yi();return Fe(t,332),Fe(t,334,ia(1)),Fe(t,335,r8({name:"XLDAPR",version:12e4,flags:3496657072})),Fe(t,336),Fe(t,339,s8(1,"XLDAPR")),Fe(t,52),Fe(t,35,ia(514)),Fe(t,4096,ia(0)),Fe(t,4097,Fs(1)),Fe(t,36),Fe(t,53),Fe(t,340),Fe(t,337,o8(1)),Fe(t,51,i8([[1,0]])),Fe(t,338),Fe(t,333),t.end()}function u8(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var i=!1,s=2,a;return t.replace(Ei,function(o){var l=mt(o);switch(Oa(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<n.Types.length;++u)n.Types[u].name==l.name&&(a=n.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):s==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!a)break;a.offsets||(a.offsets=[]),a.offsets.push(+l.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function rC(){var t=[dn];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function d8(t){var e=[];if(!t)return e;var r=1;return(t.match(Ei)||[]).forEach(function(n){var i=mt(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,e.push(i);break}}),e}function f8(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=gt(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function h8(t,e,r){var n=[];return go(t,function(s,a,o){switch(o){case 63:n.push(s);break;default:if(!a.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function p8(t,e,r,n){if(!t)return t;var i=n||{},s=!1;go(t,function(o,l,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!l.T){if(!s||i.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},i)}function g8(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}var Jc=1024;function nC(t,e){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[Ge("xml",null,{"xmlns:v":is.v,"xmlns:o":is.o,"xmlns:x":is.x,"xmlns:mv":is.mv}).replace(/\/>/,">"),Ge("o:shapelayout",Ge("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),Ge("v:shapetype",[Ge("v:stroke",null,{joinstyle:"miter"}),Ge("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Jc<t*1e3;)Jc+=1e3;return e.forEach(function(s){var a=Xr(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?Ge("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=Ge("v:fill",l,o),f={on:"t",obscured:"t"};++Jc,i=i.concat(["<v:shape"+_f({id:"_x0000_s"+Jc,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,Ge("v:shadow",null,f),Ge("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Qn("x:Anchor",[a.c+1,0,a.r+1,0,a.c+3,20,a.r+5,20].join(",")),Qn("x:AutoFill","False"),Qn("x:Row",String(a.r)),Qn("x:Column",String(a.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function D_(t,e,r,n){var i=Array.isArray(t),s;e.forEach(function(a){var o=Xr(a.ref);if(i?(t[o.r]||(t[o.r]=[]),s=t[o.r][o.c]):s=t[a.ref],!s){s={t:"z"},i?t[o.r][o.c]=s:t[a.ref]=s;var l=nr(t["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var u=bt(l);u!==t["!ref"]&&(t["!ref"]=u)}s.c||(s.c=[]);var f={a:a.author,t:a.t,r:a.r,T:r};a.h&&(f.h=a.h);for(var p=s.c.length-1;p>=0;--p){if(!r&&s.c[p].T)return;r&&!s.c[p].T&&s.c.splice(p,1)}if(r&&n){for(p=0;p<n.length;++p)if(f.a==n[p].id){f.a=n[p].name||f.a;break}}s.c.push(f)})}function m8(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var s=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=mt(o[0]),u={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},f=Xr(l.ref);if(!(e.sheetRows&&e.sheetRows<=f.r)){var p=a.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),g=!!p&&!!p[1]&&uv(p[1])||{r:"",t:"",h:""};u.r=g.r,g.r=="<t></t>"&&(g.t=g.h=""),u.t=(g.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(u.h=g.h),n.push(u)}}}}),n}function iC(t){var e=[dn,Ge("comments",null,{xmlns:fc[0]})],r=[];return e.push("<authors>"),t.forEach(function(n){n[1].forEach(function(i){var s=pr(i.a);r.indexOf(s)==-1&&(r.push(s),e.push("<author>"+s+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),e.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(n){var i=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(l){l.a&&(i=r.indexOf(pr(l.a))),s.push(l.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),s.length<=1)e.push(Qn("t",pr(s[0]||"")));else{for(var a=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)a+=`Reply:
    `+s[o]+`
`;e.push(Qn("t",pr(a)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function x8(t,e){var r=[],n=!1,i={},s=0;return t.replace(Ei,function(o,l){var u=mt(o);switch(Oa(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":s=l+o.length;break;case"</text>":i.t=t.slice(s,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return o}),r}function v8(t,e,r){var n=[dn,Ge("ThreadedComments",null,{xmlns:kn.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(i){var s="";(i[1]||[]).forEach(function(a,o){if(!a.T){delete a.ID;return}a.a&&e.indexOf(a.a)==-1&&e.push(a.a);var l={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?s=l.id:l.parentId=s,a.ID=l.id,a.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(a.a)).slice(-12)+"}"),n.push(Ge("threadedComment",Qn("text",a.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function y8(t,e){var r=[],n=!1;return t.replace(Ei,function(s){var a=mt(s);switch(Oa(a[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:a.displayname,id:a.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+a[0]+" in threaded comments")}return s}),r}function _8(t){var e=[dn,Ge("personList",null,{xmlns:kn.TCMNT,"xmlns:x":fc[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,n){e.push(Ge("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function E8(t){var e={};e.iauthor=t.read_shift(4);var r=mc(t);return e.rfx=r.s,e.ref=gt(r.s),t.l+=16,e}function S8(t,e){return e==null&&(e=Ee(36)),e.write_shift(4,t[1].iauthor),Lu(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var w8=xi;function T8(t){return Un(t.slice(0,54))}function A8(t,e){var r=[],n=[],i={},s=!1;return go(t,function(o,l,u){switch(u){case 632:n.push(o);break;case 635:i=o;break;case 637:i.t=o.t,i.h=o.h,i.r=o.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,e.sheetRows&&i.rfx&&e.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!s||e.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}function C8(t){var e=Yi(),r=[];return Fe(e,628),Fe(e,630),t.forEach(function(n){n[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),Fe(e,632,T8(i.a)))})}),Fe(e,631),Fe(e,633),t.forEach(function(n){n[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var s={s:Xr(n[0]),e:Xr(n[0])};Fe(e,635,S8([s,i])),i.t&&i.t.length>0&&Fe(e,637,YR(i)),Fe(e,636),delete i.iauthor})}),Fe(e,634),Fe(e,629),e.end()}var k8="application/vnd.ms-office.vbaProject";function F8(t){var e=st.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");st.utils.cfb_add(e,i,t.FileIndex[n].content)}}),st.write(e)}function b8(t,e){e.FullPaths.forEach(function(r,n){if(n!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&st.utils.cfb_add(t,i,e.FileIndex[n].content)}})}var sC=["xlsb","xlsm","xlam","biff8","xla"];function I8(){return{"!type":"dialog"}}function N8(){return{"!type":"dialog"}}function R8(){return{"!type":"macro"}}function D8(){return{"!type":"macro"}}var lu=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,i,s,a){var o=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var u=s.length>0?parseInt(s,10)|0:0,f=a.length>0?parseInt(a,10)|0:0;return o?f+=e.c:--f,l?u+=e.r:--u,i+(o?"":"$")+Yr(f)+(l?"":"$")+un(u)}return function(i,s){return e=s,i.replace(t,r)}}(),pv=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,gv=function(){return function(e,r){return e.replace(pv,function(n,i,s,a,o,l){var u=tv(a)-(s?0:r.c),f=ev(l)-(o?0:r.r),p=f==0?"":o?f+1:"["+f+"]",g=u==0?"":s?u+1:"["+u+"]";return i+"R"+p+"C"+g})}}();function aC(t,e){return t.replace(pv,function(r,n,i,s,a,o){return n+(i=="$"?i+s:Yr(tv(s)+e.c))+(a=="$"?a+o:un(ev(o)+e.r))})}function P8(t,e,r){var n=Xi(e),i=n.s,s=Xr(r),a={r:s.r-i.r,c:s.c-i.c};return aC(t,a)}function O8(t){return t.length!=1}function P_(t){return t.replace(/_xlfn\./g,"")}function gn(t){t.l+=1}function pl(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function oC(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return lC(t);r.biff==12&&(n=4)}var i=t.read_shift(n),s=t.read_shift(n),a=pl(t),o=pl(t);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function lC(t){var e=pl(t),r=pl(t),n=t.read_shift(1),i=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function M8(t,e,r){if(r.biff<8)return lC(t);var n=t.read_shift(r.biff==12?4:2),i=t.read_shift(r.biff==12?4:2),s=pl(t),a=pl(t);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}function cC(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return B8(t);var n=t.read_shift(r&&r.biff==12?4:2),i=pl(t);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function B8(t){var e=pl(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function j8(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function L8(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return U8(t);var i=t.read_shift(n>=12?4:2),s=t.read_shift(2),a=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;i>524287;)i-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:a,rRel:o}}function U8(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),i==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:i,rRel:n}}function V8(t,e,r){var n=(t[t.l++]&96)>>5,i=oC(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function z8(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}var a=oC(t,s,r);return[n,i,a]}function W8(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function $8(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}return t.l+=s,[n,i]}function H8(t,e,r){var n=(t[t.l++]&96)>>5,i=M8(t,e-1,r);return[n,i]}function G8(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function O_(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function K8(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(t.read_shift(r&&r.biff==2?1:2));return i}function Y8(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function X8(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function q8(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function Q8(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function uC(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function J8(t){return t.read_shift(2),uC(t)}function Z8(t){return t.read_shift(2),uC(t)}function e5(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=cC(t,0,r);return[n,i]}function t5(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=L8(t,0,r);return[n,i]}function r5(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var s=cC(t,0,r);return[n,i,s]}function n5(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(r&&r.biff<=3?1:2);return[aO[i],hC[i],n]}function i5(t,e,r){var n=t[t.l++],i=t.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:s5(t);return[i,(s[0]===0?hC:sO)[s[1]]]}function s5(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function a5(t,e,r){t.l+=r&&r.biff==2?3:4}function o5(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function l5(t){return t.l++,mo[t.read_shift(1)]}function c5(t){return t.l++,t.read_shift(2)}function u5(t){return t.l++,t.read_shift(1)!==0}function d5(t){return t.l++,mi(t)}function f5(t,e,r){return t.l++,Kf(t,e-1,r)}function h5(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=on(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=mo[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=mi(t);break;case 2:r[1]=xc(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function p5(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((r.biff==12?mc:Yp)(t));return i}function g5(t,e,r){var n=0,i=0;r.biff==12?(n=t.read_shift(4),i=t.read_shift(4)):(i=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var s=0,a=[];s!=n&&(a[s]=[]);++s)for(var o=0;o!=i;++o)a[s][o]=h5(t,r.biff);return a}function m5(t,e,r){var n=t.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,s=t.read_shift(i);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,s]}function x5(t,e,r){if(r.biff==5)return v5(t);var n=t.read_shift(1)>>>5&3,i=t.read_shift(2),s=t.read_shift(4);return[n,i,s]}function v5(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function y5(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function _5(t,e,r){var n=t.read_shift(1)>>>5&3,i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function E5(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function S5(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return t.l+=s,[n,i]}var w5=yi,T5=yi,A5=yi;function Xf(t,e,r){return t.l+=2,[j8(t)]}function mv(t){return t.l+=6,[]}var C5=Xf,k5=mv,F5=mv,b5=Xf;function dC(t){return t.l+=2,[yn(t),t.read_shift(2)&1]}var I5=Xf,N5=dC,R5=mv,D5=Xf,P5=Xf,O5=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function M5(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i=t.read_shift(2),s=t.read_shift(2),a=O5[r>>2&31];return{ixti:e,coltype:r&3,rt:a,idx:n,c:i,C:s}}function B5(t){return t.l+=2,[t.read_shift(4)]}function j5(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function L5(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function U5(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function V5(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function z5(t){return t.l+=4,[0,0]}var M_={1:{n:"PtgExp",f:o5},2:{n:"PtgTbl",f:A5},3:{n:"PtgAdd",f:gn},4:{n:"PtgSub",f:gn},5:{n:"PtgMul",f:gn},6:{n:"PtgDiv",f:gn},7:{n:"PtgPower",f:gn},8:{n:"PtgConcat",f:gn},9:{n:"PtgLt",f:gn},10:{n:"PtgLe",f:gn},11:{n:"PtgEq",f:gn},12:{n:"PtgGe",f:gn},13:{n:"PtgGt",f:gn},14:{n:"PtgNe",f:gn},15:{n:"PtgIsect",f:gn},16:{n:"PtgUnion",f:gn},17:{n:"PtgRange",f:gn},18:{n:"PtgUplus",f:gn},19:{n:"PtgUminus",f:gn},20:{n:"PtgPercent",f:gn},21:{n:"PtgParen",f:gn},22:{n:"PtgMissArg",f:gn},23:{n:"PtgStr",f:f5},26:{n:"PtgSheet",f:j5},27:{n:"PtgEndSheet",f:L5},28:{n:"PtgErr",f:l5},29:{n:"PtgBool",f:u5},30:{n:"PtgInt",f:c5},31:{n:"PtgNum",f:d5},32:{n:"PtgArray",f:G8},33:{n:"PtgFunc",f:n5},34:{n:"PtgFuncVar",f:i5},35:{n:"PtgName",f:m5},36:{n:"PtgRef",f:e5},37:{n:"PtgArea",f:V8},38:{n:"PtgMemArea",f:y5},39:{n:"PtgMemErr",f:w5},40:{n:"PtgMemNoMem",f:T5},41:{n:"PtgMemFunc",f:_5},42:{n:"PtgRefErr",f:E5},43:{n:"PtgAreaErr",f:W8},44:{n:"PtgRefN",f:t5},45:{n:"PtgAreaN",f:H8},46:{n:"PtgMemAreaN",f:U5},47:{n:"PtgMemNoMemN",f:V5},57:{n:"PtgNameX",f:x5},58:{n:"PtgRef3d",f:r5},59:{n:"PtgArea3d",f:z8},60:{n:"PtgRefErr3d",f:S5},61:{n:"PtgAreaErr3d",f:$8},255:{}},W5={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},$5={1:{n:"PtgElfLel",f:dC},2:{n:"PtgElfRw",f:D5},3:{n:"PtgElfCol",f:C5},6:{n:"PtgElfRwV",f:P5},7:{n:"PtgElfColV",f:b5},10:{n:"PtgElfRadical",f:I5},11:{n:"PtgElfRadicalS",f:R5},13:{n:"PtgElfColS",f:k5},15:{n:"PtgElfColSV",f:F5},16:{n:"PtgElfRadicalLel",f:N5},25:{n:"PtgList",f:M5},29:{n:"PtgSxName",f:B5},255:{}},H5={0:{n:"PtgAttrNoop",f:z5},1:{n:"PtgAttrSemi",f:Q8},2:{n:"PtgAttrIf",f:X8},4:{n:"PtgAttrChoose",f:K8},8:{n:"PtgAttrGoto",f:Y8},16:{n:"PtgAttrSum",f:a5},32:{n:"PtgAttrBaxcel",f:O_},33:{n:"PtgAttrBaxcel",f:O_},64:{n:"PtgAttrSpace",f:J8},65:{n:"PtgAttrSpaceSemi",f:Z8},128:{n:"PtgAttrIfError",f:q8},255:{}};function qf(t,e,r,n){if(n.biff<8)return yi(t,e);for(var i=t.l+e,s=[],a=0;a!==r.length;++a)switch(r[a][0]){case"PtgArray":r[a][1]=g5(t,0,n),s.push(r[a][1]);break;case"PtgMemArea":r[a][2]=p5(t,r[a][1],n),s.push(r[a][2]);break;case"PtgExp":n&&n.biff==12&&(r[a][1][1]=t.read_shift(4),s.push(r[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[a][0]}return e=i-t.l,e!==0&&s.push(yi(t,e)),s}function Qf(t,e,r){for(var n=t.l+e,i,s,a=[];n!=t.l;)e=n-t.l,s=t[t.l],i=M_[s]||M_[W5[s]],(s===24||s===25)&&(i=(s===24?$5:H5)[t[t.l+1]]),!i||!i.f?yi(t,e):a.push([i.n,i.f(t,e,r)]);return a}function G5(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],i=[],s=0;s<n.length;++s){var a=n[s];if(a)switch(a[0]){case 2:i.push('"'+a[1].replace(/"/g,'""')+'"');break;default:i.push(a[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var K5={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Y5(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function fC(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(t[n[0]][0]){case 357:return i=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return t[n[0]][0][3]?(i=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function B_(t,e,r){var n=fC(t,e,r);return n=="#REF"?n:Y5(n,r)}function fi(t,e,r,n,i){var s=i&&i.biff||8,a={s:{c:0,r:0}},o=[],l,u,f,p=0,g=0,m,y="";if(!t[0]||!t[0][0])return"";for(var x=-1,S="",A=0,C=t[0].length;A<C;++A){var E=t[0][A];switch(E[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),u=o.pop(),x>=0){switch(t[0][x][1][0]){case 0:S=tn(" ",t[0][x][1][1]);break;case 1:S=tn("\r",t[0][x][1][1]);break;default:if(S="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][x][1][0])}u=u+S,x=-1}o.push(u+K5[E[0]]+l);break;case"PtgIsect":l=o.pop(),u=o.pop(),o.push(u+" "+l);break;case"PtgUnion":l=o.pop(),u=o.pop(),o.push(u+","+l);break;case"PtgRange":l=o.pop(),u=o.pop(),o.push(u+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=Ud(E[1][1],a,i),o.push(Vd(f,s));break;case"PtgRefN":f=r?Ud(E[1][1],r,i):E[1][1],o.push(Vd(f,s));break;case"PtgRef3d":p=E[1][1],f=Ud(E[1][2],a,i),y=B_(n,p,i),o.push(y+"!"+Vd(f,s));break;case"PtgFunc":case"PtgFuncVar":var O=E[1][0],q=E[1][1];O||(O=0),O&=127;var H=O==0?[]:o.slice(-O);o.length-=O,q==="User"&&(q=H.shift()),o.push(q+"("+H.join(",")+")");break;case"PtgBool":o.push(E[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(E[1]);break;case"PtgNum":o.push(String(E[1]));break;case"PtgStr":o.push('"'+E[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(E[1]);break;case"PtgAreaN":m=f_(E[1][1],r?{s:r}:a,i),o.push(Hg(m,i));break;case"PtgArea":m=f_(E[1][1],a,i),o.push(Hg(m,i));break;case"PtgArea3d":p=E[1][1],m=E[1][2],y=B_(n,p,i),o.push(y+"!"+Hg(m,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":g=E[1][2];var T=(n.names||[])[g-1]||(n[0]||[])[g],F=T?T.Name:"SH33TJSNAME"+String(g);F&&F.slice(0,6)=="_xlfn."&&!i.xlfn&&(F=F.slice(6)),o.push(F);break;case"PtgNameX":var w=E[1][1];g=E[1][2];var N;if(i.biff<=5)w<0&&(w=-w),n[w]&&(N=n[w][g]);else{var D="";if(((n[w]||[])[0]||[])[0]==14849||(((n[w]||[])[0]||[])[0]==1025?n[w][g]&&n[w][g].itab>0&&(D=n.SheetNames[n[w][g].itab-1]+"!"):D=n.SheetNames[g-1]+"!"),n[w]&&n[w][g])D+=n[w][g].Name;else if(n[0]&&n[0][g])D+=n[0][g].Name;else{var P=(fC(n,w,i)||"").split(";;");P[g-1]?D=P[g-1]:D+="SH33TJSERRX"}o.push(D);break}N||(N={Name:"SH33TJSERRY"}),o.push(N.Name);break;case"PtgParen":var R="(",qe=")";if(x>=0){switch(S="",t[0][x][1][0]){case 2:R=tn(" ",t[0][x][1][1])+R;break;case 3:R=tn("\r",t[0][x][1][1])+R;break;case 4:qe=tn(" ",t[0][x][1][1])+qe;break;case 5:qe=tn("\r",t[0][x][1][1])+qe;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][x][1][0])}x=-1}o.push(R+o.pop()+qe);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":f={c:E[1][1],r:E[1][0]};var Se={c:r.c,r:r.r};if(n.sharedf[gt(f)]){var Oe=n.sharedf[gt(f)];o.push(fi(Oe,a,Se,n,i))}else{var be=!1;for(l=0;l!=n.arrayf.length;++l)if(u=n.arrayf[l],!(f.c<u[0].s.c||f.c>u[0].e.c)&&!(f.r<u[0].s.r||f.r>u[0].e.r)){o.push(fi(u[1],a,Se,n,i)),be=!0;break}be||o.push(E[1])}break;case"PtgArray":o.push("{"+G5(E[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":x=A;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+E[1].idx+"[#"+E[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(E));default:throw new Error("Unrecognized Formula Token: "+String(E))}var ke=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&x>=0&&ke.indexOf(t[0][A][0])==-1){E=t[0][x];var ne=!0;switch(E[1][0]){case 4:ne=!1;case 0:S=tn(" ",E[1][1]);break;case 5:ne=!1;case 1:S=tn("\r",E[1][1]);break;default:if(S="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+E[1][0])}o.push((ne?S:"")+o.pop()+(ne?"":S)),x=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function X5(t,e,r){var n=t.l+e,i=r.biff==2?1:2,s,a=t.read_shift(i);if(a==65535)return[[],yi(t,e-2)];var o=Qf(t,a,r);return e!==a+i&&(s=qf(t,e-a-i,o,r)),t.l=n,[o,s]}function q5(t,e,r){var n=t.l+e,i=r.biff==2?1:2,s,a=t.read_shift(i);if(a==65535)return[[],yi(t,e-2)];var o=Qf(t,a,r);return e!==a+i&&(s=qf(t,e-a-i,o,r)),t.l=n,[o,s]}function Q5(t,e,r,n){var i=t.l+e,s=Qf(t,n,r),a;return i!==t.l&&(a=qf(t,i-t.l,s,r)),[s,a]}function J5(t,e,r){var n=t.l+e,i,s=t.read_shift(2),a=Qf(t,s,r);return s==65535?[[],yi(t,e-2)]:(e!==s+2&&(i=qf(t,n-s-2,a,r)),[a,i])}function Z5(t){var e;if(Ka(t,t.l+6)!==65535)return[mi(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function eO(t){if(t==null){var e=Ee(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return tc(t);return tc(0)}function qg(t,e,r){var n=t.l+e,i=Ma(t);r.biff==2&&++t.l;var s=Z5(t),a=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var o=q5(t,n-t.l,r);return{cell:i,val:s[0],formula:o,shared:a>>3&1,tt:s[1]}}function tO(t,e,r,n,i){var s=nc(e,r,i),a=eO(t.v),o=Ee(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var u=Ee(t.bf.length),f=0;f<t.bf.length;++f)u[f]=t.bf[f];var p=Ln([s,a,o,u]);return p}function Xp(t,e,r){var n=t.read_shift(4),i=Qf(t,n,r),s=t.read_shift(4),a=s>0?qf(t,s,i,r):null;return[i,a]}var rO=Xp,qp=Xp,nO=Xp,iO=Xp,sO={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},hC={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},aO={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function j_(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function oO(t){var e="of:="+t.replace(pv,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function Qg(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function lO(t){return t.replace(/\./,"!")}var Wd={},cu={},$d=typeof Map<"u";function xv(t,e,r){var n=0,i=t.length;if(r){if($d?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var s=$d?r.get(e):r[e];n<s.length;++n)if(t[s[n]].t===e)return t.Count++,s[n]}}else for(;n<i;++n)if(t[n].t===e)return t.Count++,n;return t[i]={t:e},t.Count++,t.Unique++,r&&($d?(r.has(e)||r.set(e,[]),r.get(e).push(i)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(i))),i}function Qp(t,e){var r={min:t+1,max:t+1},n=-1;return e.MDW&&(pi=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?n=Af(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(r.width=lp(n),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function Hl(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function Tl(t,e,r){var n=r.revssf[e.z!=null?e.z:"General"],i=60,s=t.length;if(n==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){Za(e.z,i),r.ssf[i]=e.z,r.revssf[e.z]=n=i;break}}for(i=0;i!=s;++i)if(t[i].numFmtId===n)return i;return t[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function pC(t,e,r,n,i,s){try{n.cellNF&&(t.z=pt[e])}catch(o){if(n.WTF)throw o}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=Rr(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(pt[e]==null&&Za(sR[e]||"General",e),t.t==="e")t.w=t.w||mo[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=vf(t.v);else if(t.t==="d"){var a=Nn(t.v);(a|0)===a?t.w=a.toString(10):t.w=vf(a)}else{if(t.v===void 0)return"";t.w=Zl(t.v,cu)}else t.t==="d"?t.w=Bs(e,Nn(t.v),cu):t.w=Bs(e,t.v,cu)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{t.s=s.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=op(i.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=i.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=op(i.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=i.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&s.Fills)throw o}}}function cO(t,e,r){if(t&&t["!ref"]){var n=nr(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function uO(t,e){var r=nr(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=bt(r))}var dO=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,fO=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,hO=/<(?:\w:)?hyperlink [^>]*>/mg,pO=/"(\w*:\w*)"/,gO=/<(?:\w:)?col\b[^>]*[\/]?>/g,mO=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,xO=/<(?:\w:)?pageMargins[^>]*\/>/g,gC=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,vO=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,yO=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function _O(t,e,r,n,i,s,a){if(!t)return t;n||(n={"!id":{}});var o=e.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",f="",p=t.match(fO);p?(u=t.slice(0,p.index),f=t.slice(p.index+p[0].length)):u=f=t;var g=u.match(gC);g?vv(g[0],o,i,r):(g=u.match(vO))&&SO(g[0],g[1]||"",o,i,r);var m=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(m>0){var y=u.slice(m,m+50).match(pO);y&&uO(o,y[1])}var x=u.match(yO);x&&x[1]&&OO(x[1],i);var S=[];if(e.cellStyles){var A=u.match(gO);A&&IO(S,A)}p&&jO(p[1],o,e,l,s,a);var C=f.match(mO);C&&(o["!autofilter"]=RO(C[0]));var E=[],O=f.match(dO);if(O)for(m=0;m!=O.length;++m)E[m]=nr(O[m].slice(O[m].indexOf('"')+1));var q=f.match(hO);q&&kO(o,q,n);var H=f.match(xO);if(H&&(o["!margins"]=FO(mt(H[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=bt(l)),e.sheetRows>0&&o["!ref"]){var T=nr(o["!ref"]);e.sheetRows<=+T.e.r&&(T.e.r=e.sheetRows-1,T.e.r>l.e.r&&(T.e.r=l.e.r),T.e.r<T.s.r&&(T.s.r=T.e.r),T.e.c>l.e.c&&(T.e.c=l.e.c),T.e.c<T.s.c&&(T.s.c=T.e.c),o["!fullref"]=o["!ref"],o["!ref"]=bt(T))}return S.length>0&&(o["!cols"]=S),E.length>0&&(o["!merges"]=E),o}function EO(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+bt(t[r])+'"/>';return e+"</mergeCells>"}function vv(t,e,r,n){var i=mt(t);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=rr(vr(i.codeName)))}function SO(t,e,r,n,i){vv(t.slice(0,t.indexOf(">")),r,n,i)}function wO(t,e,r,n,i){var s=!1,a={},o=null;if(n.bookType!=="xlsx"&&e.vbaraw){var l=e.SheetNames[r];try{e.Workbook&&(l=e.Workbook.Sheets[r].CodeName||l)}catch{}s=!0,a.codeName=Ca(pr(l))}if(t&&t["!outline"]){var u={summaryBelow:1,summaryRight:1};t["!outline"].above&&(u.summaryBelow=0),t["!outline"].left&&(u.summaryRight=0),o=(o||"")+Ge("outlinePr",null,u)}!s&&!o||(i[i.length]=Ge("sheetPr",o,a))}var TO=["objects","scenarios","selectLockedCells","selectUnlockedCells"],AO=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function CO(t){var e={sheet:1};return TO.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),AO.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=dv(t.password).toString(16).toUpperCase()),Ge("sheetProtection",null,e)}function kO(t,e,r){for(var n=Array.isArray(t),i=0;i!=e.length;++i){var s=mt(vr(e[i]),!0);if(!s.ref)return;var a=((r||{})["!id"]||[])[s.id];a?(s.Target=a.Target,s.location&&(s.Target+="#"+rr(s.location))):(s.Target="#"+rr(s.location),a={Target:s.Target,TargetMode:"Internal"}),s.Rel=a,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=nr(s.ref),l=o.s.r;l<=o.e.r;++l)for(var u=o.s.c;u<=o.e.c;++u){var f=gt({c:u,r:l});n?(t[l]||(t[l]=[]),t[l][u]||(t[l][u]={t:"z",v:void 0}),t[l][u].l=s):(t[f]||(t[f]={t:"z",v:void 0}),t[f].l=s)}}}function FO(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function bO(t){return Hl(t),Ge("pageMargins",null,t)}function IO(t,e){for(var r=!1,n=0;n!=e.length;++n){var i=mt(e[n],!0);i.hidden&&(i.hidden=Ir(i.hidden));var s=parseInt(i.min,10)-1,a=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,fv(i.width)),hl(i);s<=a;)t[s++]=Dr(i)}}function NO(t,e){for(var r=["<cols>"],n,i=0;i!=e.length;++i)(n=e[i])&&(r[r.length]=Ge("col",null,Qp(i,n)));return r[r.length]="</cols>",r.join("")}function RO(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}function DO(t,e,r,n){var i=typeof t.ref=="string"?t.ref:bt(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,a=Xi(i);a.s.r==a.e.r&&(a.e.r=Xi(e["!ref"]).e.r,i=bt(a));for(var o=0;o<s.length;++o){var l=s[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+i;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),Ge("autoFilter",null,{ref:i})}var PO=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function OO(t,e){e.Views||(e.Views=[{}]),(t.match(PO)||[]).forEach(function(r,n){var i=mt(r);e.Views[n]||(e.Views[n]={}),+i.zoomScale&&(e.Views[n].zoom=+i.zoomScale),Ir(i.rightToLeft)&&(e.Views[n].RTL=!0)})}function MO(t,e,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Ge("sheetViews",Ge("sheetView",null,i),{})}function BO(t,e,r,n){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var i="",s=t.t,a=t.v;if(t.t!=="z")switch(t.t){case"b":i=t.v?"1":"0";break;case"n":i=""+t.v;break;case"e":i=mo[t.v];break;case"d":n&&n.cellDates?i=Rr(t.v,-1).toISOString():(t=Dr(t),t.t="n",i=""+(t.v=Nn(Rr(t.v)))),typeof t.z>"u"&&(t.z=pt[14]);break;default:i=t.v;break}var o=Qn("v",pr(i)),l={r:e},u=Tl(n.cellXfs,t,n);switch(u!==0&&(l.s=u),t.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=Qn("v",""+xv(n.Strings,t.v,n.revStrings)),l.t="s";break}l.t="str";break}if(t.t!=s&&(t.t=s,t.v=a),typeof t.f=="string"&&t.f){var f=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;o=Ge("f",pr(t.f),f)+(t.v!=null?o:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(l.cm=1),Ge("c",o,l)}var jO=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,s=yf("v"),a=yf("f");return function(l,u,f,p,g,m){for(var y=0,x="",S=[],A=[],C=0,E=0,O=0,q="",H,T,F=0,w=0,N,D,P=0,R=0,qe=Array.isArray(m.CellXf),Se,Oe=[],be=[],ke=Array.isArray(u),ne=[],Ie={},je=!1,K=!!f.sheetStubs,te=l.split(e),re=0,X=te.length;re!=X;++re){x=te[re].trim();var _e=x.length;if(_e!==0){var Ce=0;e:for(y=0;y<_e;++y)switch(x[y]){case">":if(x[y-1]!="/"){++y;break e}if(f&&f.cellStyles){if(T=mt(x.slice(Ce,y),!0),F=T.r!=null?parseInt(T.r,10):F+1,w=-1,f.sheetRows&&f.sheetRows<F)continue;Ie={},je=!1,T.ht&&(je=!0,Ie.hpt=parseFloat(T.ht),Ie.hpx=wu(Ie.hpt)),T.hidden=="1"&&(je=!0,Ie.hidden=!0),T.outlineLevel!=null&&(je=!0,Ie.level=+T.outlineLevel),je&&(ne[F-1]=Ie)}break;case"<":Ce=y;break}if(Ce>=y)break;if(T=mt(x.slice(Ce,y),!0),F=T.r!=null?parseInt(T.r,10):F+1,w=-1,!(f.sheetRows&&f.sheetRows<F)){p.s.r>F-1&&(p.s.r=F-1),p.e.r<F-1&&(p.e.r=F-1),f&&f.cellStyles&&(Ie={},je=!1,T.ht&&(je=!0,Ie.hpt=parseFloat(T.ht),Ie.hpx=wu(Ie.hpt)),T.hidden=="1"&&(je=!0,Ie.hidden=!0),T.outlineLevel!=null&&(je=!0,Ie.level=+T.outlineLevel),je&&(ne[F-1]=Ie)),S=x.slice(y).split(t);for(var Ve=0;Ve!=S.length&&S[Ve].trim().charAt(0)=="<";++Ve);for(S=S.slice(Ve),y=0;y!=S.length;++y)if(x=S[y].trim(),x.length!==0){if(A=x.match(r),C=y,E=0,O=0,x="<c "+(x.slice(0,1)=="<"?">":"")+x,A!=null&&A.length===2){for(C=0,q=A[1],E=0;E!=q.length&&!((O=q.charCodeAt(E)-64)<1||O>26);++E)C=26*C+O;--C,w=C}else++w;for(E=0;E!=x.length&&x.charCodeAt(E)!==62;++E);if(++E,T=mt(x.slice(0,E),!0),T.r||(T.r=gt({r:F-1,c:w})),q=x.slice(E),H={t:""},(A=q.match(s))!=null&&A[1]!==""&&(H.v=rr(A[1])),f.cellFormula){if((A=q.match(a))!=null&&A[1]!==""){if(H.f=rr(vr(A[1])).replace(/\r\n/g,`
`),f.xlfn||(H.f=P_(H.f)),A[0].indexOf('t="array"')>-1)H.F=(q.match(i)||[])[1],H.F.indexOf(":")>-1&&Oe.push([nr(H.F),H.F]);else if(A[0].indexOf('t="shared"')>-1){D=mt(A[0]);var De=rr(vr(A[1]));f.xlfn||(De=P_(De)),be[parseInt(D.si,10)]=[D,De,T.r]}}else(A=q.match(/<f[^>]*\/>/))&&(D=mt(A[0]),be[D.si]&&(H.f=P8(be[D.si][1],be[D.si][2],T.r)));var Ne=Xr(T.r);for(E=0;E<Oe.length;++E)Ne.r>=Oe[E][0].s.r&&Ne.r<=Oe[E][0].e.r&&Ne.c>=Oe[E][0].s.c&&Ne.c<=Oe[E][0].e.c&&(H.F=Oe[E][1])}if(T.t==null&&H.v===void 0)if(H.f||H.F)H.v=0,H.t="n";else if(K)H.t="z";else continue;else H.t=T.t||"n";switch(p.s.c>w&&(p.s.c=w),p.e.c<w&&(p.e.c=w),H.t){case"n":if(H.v==""||H.v==null){if(!K)continue;H.t="z"}else H.v=parseFloat(H.v);break;case"s":if(typeof H.v>"u"){if(!K)continue;H.t="z"}else N=Wd[parseInt(H.v,10)],H.v=N.t,H.r=N.r,f.cellHTML&&(H.h=N.h);break;case"str":H.t="s",H.v=H.v!=null?vr(H.v):"",f.cellHTML&&(H.h=q1(H.v));break;case"inlineStr":A=q.match(n),H.t="s",A!=null&&(N=uv(A[1]))?(H.v=N.t,f.cellHTML&&(H.h=N.h)):H.v="";break;case"b":H.v=Ir(H.v);break;case"d":f.cellDates?H.v=Rr(H.v,1):(H.v=Nn(Rr(H.v,1)),H.t="n");break;case"e":(!f||f.cellText!==!1)&&(H.w=H.v),H.v=xA[H.v];break}if(P=R=0,Se=null,qe&&T.s!==void 0&&(Se=m.CellXf[T.s],Se!=null&&(Se.numFmtId!=null&&(P=Se.numFmtId),f.cellStyles&&Se.fillId!=null&&(R=Se.fillId))),pC(H,P,R,f,g,m),f.cellDates&&qe&&H.t=="n"&&Mu(pt[P])&&(H.t="d",H.v=Kp(H.v)),T.cm&&f.xlmeta){var it=(f.xlmeta.Cell||[])[+T.cm-1];it&&it.type=="XLDAPR"&&(H.D=!0)}if(ke){var Z=Xr(T.r);u[Z.r]||(u[Z.r]=[]),u[Z.r][Z.c]=H}else u[T.r]=H}}}}ne.length>0&&(u["!rows"]=ne)}}();function LO(t,e,r,n){var i=[],s=[],a=nr(t["!ref"]),o="",l,u="",f=[],p=0,g=0,m=t["!rows"],y=Array.isArray(t),x={r:u},S,A=-1;for(g=a.s.c;g<=a.e.c;++g)f[g]=Yr(g);for(p=a.s.r;p<=a.e.r;++p){for(s=[],u=un(p),g=a.s.c;g<=a.e.c;++g){l=f[g]+u;var C=y?(t[p]||[])[g]:t[l];C!==void 0&&(o=BO(C,l,t,e))!=null&&s.push(o)}(s.length>0||m&&m[p])&&(x={r:u},m&&m[p]&&(S=m[p],S.hidden&&(x.hidden=1),A=-1,S.hpx?A=Cf(S.hpx):S.hpt&&(A=S.hpt),A>-1&&(x.ht=A,x.customHeight=1),S.level&&(x.outlineLevel=S.level)),i[i.length]=Ge("row",s.join(""),x))}if(m)for(;p<m.length;++p)m&&m[p]&&(x={r:p+1},S=m[p],S.hidden&&(x.hidden=1),A=-1,S.hpx?A=Cf(S.hpx):S.hpt&&(A=S.hpt),A>-1&&(x.ht=A,x.customHeight=1),S.level&&(x.outlineLevel=S.level),i[i.length]=Ge("row","",x));return i.join("")}function mC(t,e,r,n){var i=[dn,Ge("worksheet",null,{xmlns:fc[0],"xmlns:r":kn.r})],s=r.SheetNames[t],a=0,o="",l=r.Sheets[s];l==null&&(l={});var u=l["!ref"]||"A1",f=nr(u);if(f.e.c>16383||f.e.r>1048575){if(e.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575),u=bt(f)}n||(n={}),l["!comments"]=[];var p=[];wO(l,r,t,e,i),i[i.length]=Ge("dimension",null,{ref:u}),i[i.length]=MO(l,e,t,r),e.sheetFormat&&(i[i.length]=Ge("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(i[i.length]=NO(l,l["!cols"])),i[a=i.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=LO(l,e),o.length>0&&(i[i.length]=o)),i.length>a+1&&(i[i.length]="</sheetData>",i[a]=i[a].replace("/>",">")),l["!protect"]&&(i[i.length]=CO(l["!protect"])),l["!autofilter"]!=null&&(i[i.length]=DO(l["!autofilter"],l,r,t)),l["!merges"]!=null&&l["!merges"].length>0&&(i[i.length]=EO(l["!merges"]));var g=-1,m,y=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(x){x[1].Target&&(m={ref:x[0]},x[1].Target.charAt(0)!="#"&&(y=hr(n,-1,pr(x[1].Target).replace(/#.*$/,""),Bt.HLINK),m["r:id"]="rId"+y),(g=x[1].Target.indexOf("#"))>-1&&(m.location=pr(x[1].Target.slice(g+1))),x[1].Tooltip&&(m.tooltip=pr(x[1].Tooltip)),i[i.length]=Ge("hyperlink",null,m))}),i[i.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(i[i.length]=bO(l["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(i[i.length]=Qn("ignoredErrors",Ge("ignoredError",null,{numberStoredAsText:1,sqref:u}))),p.length>0&&(y=hr(n,-1,"../drawings/drawing"+(t+1)+".xml",Bt.DRAW),i[i.length]=Ge("drawing",null,{"r:id":"rId"+y}),l["!drawing"]=p),l["!comments"].length>0&&(y=hr(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",Bt.VML),i[i.length]=Ge("legacyDrawing",null,{"r:id":"rId"+y}),l["!legacy"]=y),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function UO(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var i=t.read_shift(2);t.l+=1;var s=t.read_shift(1);return t.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=i/20),r}function VO(t,e,r){var n=Ee(145),i=(r["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var s=320;i.hpx?s=Cf(i.hpx)*20:i.hpt&&(s=i.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var a=0;i.level&&(a|=i.level),i.hidden&&(a|=16),(i.hpx||i.hpt)&&(a|=32),n.write_shift(1,a),n.write_shift(1,0);var o=0,l=n.l;n.l+=4;for(var u={r:t,c:0},f=0;f<16;++f)if(!(e.s.c>f+1<<10||e.e.c<f<<10)){for(var p=-1,g=-1,m=f<<10;m<f+1<<10;++m){u.c=m;var y=Array.isArray(r)?(r[u.r]||[])[u.c]:r[gt(u)];y&&(p<0&&(p=m),g=m)}p<0||(++o,n.write_shift(4,p),n.write_shift(4,g))}var x=n.l;return n.l=l,n.write_shift(4,o),n.l=x,n.length>n.l?n.slice(0,n.l):n}function zO(t,e,r,n){var i=VO(n,r,e);(i.length>17||(e["!rows"]||[])[n])&&Fe(t,0,i)}var WO=mc,$O=Lu;function HO(){}function GO(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=XR(t),r}function KO(t,e,r){r==null&&(r=Ee(84+4*t.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),r.write_shift(1,n);for(var i=1;i<3;++i)r.write_shift(1,0);return ip({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),fA(t,r),r.slice(0,r.l)}function YO(t){var e=js(t);return[e]}function XO(t,e,r){return r==null&&(r=Ee(8)),hc(e,r)}function qO(t){var e=pc(t);return[e]}function QO(t,e,r){return r==null&&(r=Ee(4)),gc(e,r)}function JO(t){var e=js(t),r=t.read_shift(1);return[e,r,"b"]}function ZO(t,e,r){return r==null&&(r=Ee(9)),hc(e,r),r.write_shift(1,t.v?1:0),r}function eM(t){var e=pc(t),r=t.read_shift(1);return[e,r,"b"]}function tM(t,e,r){return r==null&&(r=Ee(5)),gc(e,r),r.write_shift(1,t.v?1:0),r}function rM(t){var e=js(t),r=t.read_shift(1);return[e,r,"e"]}function nM(t,e,r){return r==null&&(r=Ee(9)),hc(e,r),r.write_shift(1,t.v),r}function iM(t){var e=pc(t),r=t.read_shift(1);return[e,r,"e"]}function sM(t,e,r){return r==null&&(r=Ee(8)),gc(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function aM(t){var e=js(t),r=t.read_shift(4);return[e,r,"s"]}function oM(t,e,r){return r==null&&(r=Ee(12)),hc(e,r),r.write_shift(4,e.v),r}function lM(t){var e=pc(t),r=t.read_shift(4);return[e,r,"s"]}function cM(t,e,r){return r==null&&(r=Ee(8)),gc(e,r),r.write_shift(4,e.v),r}function uM(t){var e=js(t),r=mi(t);return[e,r,"n"]}function dM(t,e,r){return r==null&&(r=Ee(16)),hc(e,r),tc(t.v,r),r}function xC(t){var e=pc(t),r=mi(t);return[e,r,"n"]}function fM(t,e,r){return r==null&&(r=Ee(12)),gc(e,r),tc(t.v,r),r}function hM(t){var e=js(t),r=sv(t);return[e,r,"n"]}function pM(t,e,r){return r==null&&(r=Ee(12)),hc(e,r),hA(t.v,r),r}function gM(t){var e=pc(t),r=sv(t);return[e,r,"n"]}function mM(t,e,r){return r==null&&(r=Ee(8)),gc(e,r),hA(t.v,r),r}function xM(t){var e=js(t),r=rv(t);return[e,r,"is"]}function vM(t){var e=js(t),r=xi(t);return[e,r,"str"]}function yM(t,e,r){return r==null&&(r=Ee(12+4*t.v.length)),hc(e,r),Un(t.v,r),r.length>r.l?r.slice(0,r.l):r}function _M(t){var e=pc(t),r=xi(t);return[e,r,"str"]}function EM(t,e,r){return r==null&&(r=Ee(8+4*t.v.length)),gc(e,r),Un(t.v,r),r.length>r.l?r.slice(0,r.l):r}function SM(t,e,r){var n=t.l+e,i=js(t);i.r=r["!row"];var s=t.read_shift(1),a=[i,s,"b"];if(r.cellFormula){t.l+=2;var o=qp(t,n-t.l,r);a[3]=fi(o,null,i,r.supbooks,r)}else t.l=n;return a}function wM(t,e,r){var n=t.l+e,i=js(t);i.r=r["!row"];var s=t.read_shift(1),a=[i,s,"e"];if(r.cellFormula){t.l+=2;var o=qp(t,n-t.l,r);a[3]=fi(o,null,i,r.supbooks,r)}else t.l=n;return a}function TM(t,e,r){var n=t.l+e,i=js(t);i.r=r["!row"];var s=mi(t),a=[i,s,"n"];if(r.cellFormula){t.l+=2;var o=qp(t,n-t.l,r);a[3]=fi(o,null,i,r.supbooks,r)}else t.l=n;return a}function AM(t,e,r){var n=t.l+e,i=js(t);i.r=r["!row"];var s=xi(t),a=[i,s,"str"];if(r.cellFormula){t.l+=2;var o=qp(t,n-t.l,r);a[3]=fi(o,null,i,r.supbooks,r)}else t.l=n;return a}var CM=mc,kM=Lu;function FM(t,e){return e==null&&(e=Ee(4)),e.write_shift(4,t),e}function bM(t,e){var r=t.l+e,n=mc(t),i=nv(t),s=xi(t),a=xi(t),o=xi(t);t.l=r;var l={rfx:n,relId:i,loc:s,display:o};return a&&(l.Tooltip=a),l}function IM(t,e){var r=Ee(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));Lu({s:Xr(t[0]),e:Xr(t[0])},r),iv("rId"+e,r);var n=t[1].Target.indexOf("#"),i=n==-1?"":t[1].Target.slice(n+1);return Un(i||"",r),Un(t[1].Tooltip||"",r),Un("",r),r.slice(0,r.l)}function NM(){}function RM(t,e,r){var n=t.l+e,i=pA(t),s=t.read_shift(1),a=[i];if(a[2]=s,r.cellFormula){var o=rO(t,n-t.l,r);a[1]=o}else t.l=n;return a}function DM(t,e,r){var n=t.l+e,i=mc(t),s=[i];if(r.cellFormula){var a=iO(t,n-t.l,r);s[1]=a,t.l=n}else t.l=n;return s}function PM(t,e,r){r==null&&(r=Ee(18));var n=Qp(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var i=0;return e.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),e.level&&(i|=e.level<<8),r.write_shift(2,i),r}var vC=["left","right","top","bottom","header","footer"];function OM(t){var e={};return vC.forEach(function(r){e[r]=mi(t)}),e}function MM(t,e){return e==null&&(e=Ee(6*8)),Hl(t),vC.forEach(function(r){tc(t[r],e)}),e}function BM(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function jM(t,e,r){r==null&&(r=Ee(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function LM(t){var e=Ee(24);return e.write_shift(4,4),e.write_shift(4,1),Lu(t,e),e}function UM(t,e){return e==null&&(e=Ee(16*4+2)),e.write_shift(2,t.password?dv(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function VM(){}function zM(){}function WM(t,e,r,n,i,s,a){if(!t)return t;var o=e||{};n||(n={"!id":{}});var l=o.dense?[]:{},u,f={s:{r:2e6,c:2e6},e:{r:0,c:0}},p=!1,g=!1,m,y,x,S,A,C,E,O,q,H=[];o.biff=12,o["!row"]=0;var T=0,F=!1,w=[],N={},D=o.supbooks||i.supbooks||[[]];if(D.sharedf=N,D.arrayf=w,D.SheetNames=i.SheetNames||i.Sheets.map(function(ke){return ke.name}),!o.supbooks&&(o.supbooks=D,i.Names))for(var P=0;P<i.Names.length;++P)D[0][P+1]=i.Names[P];var R=[],qe=[],Se=!1;kf[16]={n:"BrtShortReal",f:xC};var Oe;if(go(t,function(ne,Ie,je){if(!g)switch(je){case 148:u=ne;break;case 0:m=ne,o.sheetRows&&o.sheetRows<=m.r&&(g=!0),O=un(S=m.r),o["!row"]=m.r,(ne.hidden||ne.hpt||ne.level!=null)&&(ne.hpt&&(ne.hpx=wu(ne.hpt)),qe[ne.r]=ne);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(y={t:ne[2]},ne[2]){case"n":y.v=ne[1];break;case"s":E=Wd[ne[1]],y.v=E.t,y.r=E.r;break;case"b":y.v=!!ne[1];break;case"e":y.v=ne[1],o.cellText!==!1&&(y.w=mo[y.v]);break;case"str":y.t="s",y.v=ne[1];break;case"is":y.t="s",y.v=ne[1].t;break}if((x=a.CellXf[ne[0].iStyleRef])&&pC(y,x.numFmtId,null,o,s,a),A=ne[0].c==-1?A+1:ne[0].c,o.dense?(l[S]||(l[S]=[]),l[S][A]=y):l[Yr(A)+O]=y,o.cellFormula){for(F=!1,T=0;T<w.length;++T){var K=w[T];m.r>=K[0].s.r&&m.r<=K[0].e.r&&A>=K[0].s.c&&A<=K[0].e.c&&(y.F=bt(K[0]),F=!0)}!F&&ne.length>3&&(y.f=ne[3])}if(f.s.r>m.r&&(f.s.r=m.r),f.s.c>A&&(f.s.c=A),f.e.r<m.r&&(f.e.r=m.r),f.e.c<A&&(f.e.c=A),o.cellDates&&x&&y.t=="n"&&Mu(pt[x.numFmtId])){var te=jl(y.v);te&&(y.t="d",y.v=new Date(te.y,te.m-1,te.d,te.H,te.M,te.S,te.u))}Oe&&(Oe.type=="XLDAPR"&&(y.D=!0),Oe=void 0);break;case 1:case 12:if(!o.sheetStubs||p)break;y={t:"z",v:void 0},A=ne[0].c==-1?A+1:ne[0].c,o.dense?(l[S]||(l[S]=[]),l[S][A]=y):l[Yr(A)+O]=y,f.s.r>m.r&&(f.s.r=m.r),f.s.c>A&&(f.s.c=A),f.e.r<m.r&&(f.e.r=m.r),f.e.c<A&&(f.e.c=A),Oe&&(Oe.type=="XLDAPR"&&(y.D=!0),Oe=void 0);break;case 176:H.push(ne);break;case 49:Oe=((o.xlmeta||{}).Cell||[])[ne-1];break;case 494:var re=n["!id"][ne.relId];for(re?(ne.Target=re.Target,ne.loc&&(ne.Target+="#"+ne.loc),ne.Rel=re):ne.relId==""&&(ne.Target="#"+ne.loc),S=ne.rfx.s.r;S<=ne.rfx.e.r;++S)for(A=ne.rfx.s.c;A<=ne.rfx.e.c;++A)o.dense?(l[S]||(l[S]=[]),l[S][A]||(l[S][A]={t:"z",v:void 0}),l[S][A].l=ne):(C=gt({c:A,r:S}),l[C]||(l[C]={t:"z",v:void 0}),l[C].l=ne);break;case 426:if(!o.cellFormula)break;w.push(ne),q=o.dense?l[S][A]:l[Yr(A)+O],q.f=fi(ne[1],f,{r:m.r,c:A},D,o),q.F=bt(ne[0]);break;case 427:if(!o.cellFormula)break;N[gt(ne[0].s)]=ne[1],q=o.dense?l[S][A]:l[Yr(A)+O],q.f=fi(ne[1],f,{r:m.r,c:A},D,o);break;case 60:if(!o.cellStyles)break;for(;ne.e>=ne.s;)R[ne.e--]={width:ne.w/256,hidden:!!(ne.flags&1),level:ne.level},Se||(Se=!0,fv(ne.w/256)),hl(R[ne.e+1]);break;case 161:l["!autofilter"]={ref:bt(ne)};break;case 476:l["!margins"]=ne;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),ne.name&&(i.Sheets[r].CodeName=ne.name),(ne.above||ne.left)&&(l["!outline"]={above:ne.above,left:ne.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),ne.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:p=!0;break;case 36:p=!1;break;case 37:p=!0;break;case 38:p=!1;break;default:if(!Ie.T){if(!p||o.WTF)throw new Error("Unexpected record 0x"+je.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(f.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(l["!ref"]=bt(u||f)),o.sheetRows&&l["!ref"]){var be=nr(l["!ref"]);o.sheetRows<=+be.e.r&&(be.e.r=o.sheetRows-1,be.e.r>f.e.r&&(be.e.r=f.e.r),be.e.r<be.s.r&&(be.s.r=be.e.r),be.e.c>f.e.c&&(be.e.c=f.e.c),be.e.c<be.s.c&&(be.s.c=be.e.c),l["!fullref"]=l["!ref"],l["!ref"]=bt(be))}return H.length>0&&(l["!merges"]=H),R.length>0&&(l["!cols"]=R),qe.length>0&&(l["!rows"]=qe),l}function $M(t,e,r,n,i,s,a){if(e.v===void 0)return!1;var o="";switch(e.t){case"b":o=e.v?"1":"0";break;case"d":e=Dr(e),e.z=e.z||pt[14],e.v=Nn(Rr(e.v)),e.t="n";break;case"n":case"e":o=""+e.v;break;default:o=e.v;break}var l={r,c:n};switch(l.s=Tl(i.cellXfs,e,i),e.l&&s["!links"].push([gt(l),e.l]),e.c&&s["!comments"].push([gt(l),e.c]),e.t){case"s":case"str":return i.bookSST?(o=xv(i.Strings,e.v,i.revStrings),l.t="s",l.v=o,a?Fe(t,18,cM(e,l)):Fe(t,7,oM(e,l))):(l.t="str",a?Fe(t,17,EM(e,l)):Fe(t,6,yM(e,l))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?a?Fe(t,13,mM(e,l)):Fe(t,2,pM(e,l)):a?Fe(t,16,fM(e,l)):Fe(t,5,dM(e,l)),!0;case"b":return l.t="b",a?Fe(t,15,tM(e,l)):Fe(t,4,ZO(e,l)),!0;case"e":return l.t="e",a?Fe(t,14,sM(e,l)):Fe(t,3,nM(e,l)),!0}return a?Fe(t,12,QO(e,l)):Fe(t,1,XO(e,l)),!0}function HM(t,e,r,n){var i=nr(e["!ref"]||"A1"),s,a="",o=[];Fe(t,145);var l=Array.isArray(e),u=i.e.r;e["!rows"]&&(u=Math.max(i.e.r,e["!rows"].length-1));for(var f=i.s.r;f<=u;++f){a=un(f),zO(t,e,i,f);var p=!1;if(f<=i.e.r)for(var g=i.s.c;g<=i.e.c;++g){f===i.s.r&&(o[g]=Yr(g)),s=o[g]+a;var m=l?(e[f]||[])[g]:e[s];if(!m){p=!1;continue}p=$M(t,m,f,g,n,e,p)}}Fe(t,146)}function GM(t,e){!e||!e["!merges"]||(Fe(t,177,FM(e["!merges"].length)),e["!merges"].forEach(function(r){Fe(t,176,kM(r))}),Fe(t,178))}function KM(t,e){!e||!e["!cols"]||(Fe(t,390),e["!cols"].forEach(function(r,n){r&&Fe(t,60,PM(n,r))}),Fe(t,391))}function YM(t,e){!e||!e["!ref"]||(Fe(t,648),Fe(t,649,LM(nr(e["!ref"]))),Fe(t,650))}function XM(t,e,r){e["!links"].forEach(function(n){if(n[1].Target){var i=hr(r,-1,n[1].Target.replace(/#.*$/,""),Bt.HLINK);Fe(t,494,IM(n,i))}}),delete e["!links"]}function qM(t,e,r,n){if(e["!comments"].length>0){var i=hr(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Bt.VML);Fe(t,551,iv("rId"+i)),e["!legacy"]=i}}function QM(t,e,r,n){if(e["!autofilter"]){var i=e["!autofilter"],s=typeof i.ref=="string"?i.ref:bt(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,o=Xi(s);o.s.r==o.e.r&&(o.e.r=Xi(e["!ref"]).e.r,s=bt(o));for(var l=0;l<a.length;++l){var u=a[l];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+s;break}}l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),Fe(t,161,Lu(nr(s))),Fe(t,162)}}function JM(t,e,r){Fe(t,133),Fe(t,137,jM(e,r)),Fe(t,138),Fe(t,134)}function ZM(t,e){e["!protect"]&&Fe(t,535,UM(e["!protect"]))}function eB(t,e,r,n){var i=Yi(),s=r.SheetNames[t],a=r.Sheets[s]||{},o=s;try{r&&r.Workbook&&(o=r.Workbook.Sheets[t].CodeName||o)}catch{}var l=nr(a["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(e.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],Fe(i,129),(r.vbaraw||a["!outline"])&&Fe(i,147,KO(o,a["!outline"])),Fe(i,148,$O(l)),JM(i,a,r.Workbook),KM(i,a),HM(i,a,t,e),ZM(i,a),QM(i,a,r,t),GM(i,a),XM(i,a,n),a["!margins"]&&Fe(i,476,MM(a["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&YM(i,a),qM(i,a,t,n),Fe(i,130),i.end()}function tB(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var a=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);a&&(e[+a[1]]=r?+a[2]:a[2])});var i=rr((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[e,i,n]}function rB(t,e,r,n,i,s){var a=s||{"!type":"chart"};if(!t)return s;var o=0,l=0,u="A",f={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(p){var g=tB(p);f.s.r=f.s.c=0,f.e.c=o,u=Yr(o),g[0].forEach(function(m,y){a[u+un(y)]={t:"n",v:m,z:g[1]},l=y}),f.e.r<l&&(f.e.r=l),++o}),o>0&&(a["!ref"]=bt(f)),a}function nB(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a,o=t.match(gC);return o&&vv(o[0],s,i,r),(a=t.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=a[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function iB(t,e){t.l+=10;var r=xi(t);return{name:r}}function sB(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a=!1;return go(t,function(l,u,f){switch(f){case 550:s["!rel"]=l;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),l.name&&(i.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!a||e.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}},e),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var yv=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],aB=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],oB=[],lB=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function L_(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],i=0;i!=e.length;++i){var s=e[i];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=Ir(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function U_(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=Ir(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function yC(t){U_(t.WBProps,yv),U_(t.CalcPr,lB),L_(t.WBView,aB),L_(t.Sheets,oB),cu.date1904=Ir(t.WBProps.date1904)}function cB(t){return!t.Workbook||!t.Workbook.WBProps?"false":Ir(t.Workbook.WBProps.date1904)?"true":"false"}var uB="][*?/\\".split("");function _C(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return uB.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function dB(t,e,r){t.forEach(function(n,i){_C(n);for(var s=0;s<i;++s)if(n==t[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var a=e&&e[i]&&e[i].CodeName||n;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function fB(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];dB(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)cO(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}var hB=/<\w+:workbook/;function pB(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",s={},a=0;if(t.replace(Ei,function(l,u){var f=mt(l);switch(Oa(f[0])){case"<?xml":break;case"<workbook":l.match(hB)&&(i="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=f[i];break;case"</workbook>":break;case"<fileVersion":delete f[0],r.AppVersion=f;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":yv.forEach(function(p){if(f[p[0]]!=null)switch(p[2]){case"bool":r.WBProps[p[0]]=Ir(f[p[0]]);break;case"int":r.WBProps[p[0]]=parseInt(f[p[0]],10);break;default:r.WBProps[p[0]]=f[p[0]]}}),f.codeName&&(r.WBProps.CodeName=vr(f.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete f[0],r.WBView.push(f);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(f.state){case"hidden":f.Hidden=1;break;case"veryHidden":f.Hidden=2;break;default:f.Hidden=0}delete f.state,f.name=rr(vr(f.name)),delete f[0],r.Sheets.push(f);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=vr(f.name),f.comment&&(s.Comment=f.comment),f.localSheetId&&(s.Sheet=+f.localSheetId),Ir(f.hidden||"0")&&(s.Hidden=!0),a=u+l.length;break;case"</definedName>":s.Ref=rr(vr(t.slice(a,u))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete f[0],r.CalcPr=f;break;case"<calcPr/>":delete f[0],r.CalcPr=f;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+f[0]+" in workbook")}return l}),fc.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return yC(r),r}function EC(t){var e=[dn];e[e.length]=Ge("workbook",null,{xmlns:fc[0],"xmlns:r":kn.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(yv.forEach(function(o){t.Workbook.WBProps[o[0]]!=null&&t.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=t.Workbook.WBProps[o[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=Ge("workbookPr",null,n);var i=t.Workbook&&t.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(e[e.length]="<bookViews>",s=0;s!=t.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==t.SheetNames.length&&(s=0),e[e.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",s=0;s!=t.SheetNames.length;++s){var a={name:pr(t.SheetNames[s].slice(0,31))};if(a.sheetId=""+(s+1),a["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}e[e.length]=Ge("sheet",null,a)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(e[e.length]=Ge("definedName",pr(o.Ref),l))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function gB(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=hx(t),r.name=xi(t),r}function mB(t,e){return e||(e=Ee(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),iv(t.strRelID,e),Un(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function xB(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var i=e>8?xi(t):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function vB(t,e){e||(e=Ee(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),fA(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function yB(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function _B(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var i=t.read_shift(4),s=qR(t),a=nO(t,0,r),o=nv(t);t.l=n;var l={Name:s,Ptg:a};return i<268435455&&(l.Sheet=i),o&&(l.Comment=o),l}function EB(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;e||(e={}),e.biff=12;var s=[],a=[[]];return a.SheetNames=[],a.XTI=[],kf[16]={n:"BrtFRTArchID$",f:yB},go(t,function(l,u,f){switch(f){case 156:a.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(e.SID=l.Sheet),l.Ref=fi(l.Ptg,null,null,a,e),delete e.SID,delete l.Ptg,s.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:a[0].length?a.push([f,l]):a[0]=[f,l],a[a.length-1].XTI=[];break;case 362:a.length===0&&(a[0]=[],a[0].XTI=[]),a[a.length-1].XTI=a[a.length-1].XTI.concat(l),a.XTI=a.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(f),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(f),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!u.T){if(!i||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}},e),yC(r),r.Names=s,r.supbooks=a,r}function SB(t,e){Fe(t,143);for(var r=0;r!=e.SheetNames.length;++r){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,i={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};Fe(t,156,mB(i))}Fe(t,144)}function wB(t,e){e||(e=Ee(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return Un("SheetJS",e),Un(Qh.version,e),Un(Qh.version,e),Un("7262",e),e.length>e.l?e.slice(0,e.l):e}function TB(t,e){e||(e=Ee(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function AB(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,n=0,i=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&i==-1?i=n:r[n].Hidden==1&&s==-1&&(s=n);s>i||(Fe(t,135),Fe(t,158,TB(i)),Fe(t,136))}}function CB(t,e){var r=Yi();return Fe(r,131),Fe(r,128,wB()),Fe(r,153,vB(t.Workbook&&t.Workbook.WBProps||null)),AB(r,t),SB(r,t),Fe(r,132),r.end()}function kB(t,e,r){return e.slice(-4)===".bin"?EB(t,r):pB(t,r)}function FB(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?WM(t,n,r,i,s,a,o):_O(t,n,r,i,s,a,o)}function bB(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?sB(t,n,r,i,s):nB(t,n,r,i,s)}function IB(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?R8():D8()}function NB(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?I8():N8()}function RB(t,e,r,n){return e.slice(-4)===".bin"?kP(t,r,n):gP(t,r,n)}function DB(t,e,r){return tC(t,r)}function PB(t,e,r){return e.slice(-4)===".bin"?P6(t,r):N6(t,r)}function OB(t,e,r){return e.slice(-4)===".bin"?A8(t,r):m8(t,r)}function MB(t,e,r){return e.slice(-4)===".bin"?h8(t):d8(t)}function BB(t,e,r,n){return r.slice(-4)===".bin"?p8(t,e,r,n):void 0}function jB(t,e,r){return e.slice(-4)===".bin"?l8(t,e,r):u8(t,e,r)}function LB(t,e,r){return(e.slice(-4)===".bin"?CB:EC)(t)}function UB(t,e,r,n,i){return(e.slice(-4)===".bin"?eB:mC)(t,r,n,i)}function VB(t,e,r){return(e.slice(-4)===".bin"?BP:ZA)(t,r)}function zB(t,e,r){return(e.slice(-4)===".bin"?B6:HA)(t,r)}function WB(t,e,r){return(e.slice(-4)===".bin"?C8:iC)(t)}function $B(t){return(t.slice(-4)===".bin"?c8:rC)()}var SC=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,wC=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Ks(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var i=t.match(SC),s,a,o,l;if(i)for(l=0;l!=i.length;++l)s=i[l].match(wC),(a=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(a+1),n[o]=s[2].slice(1,s[2].length-1));return n}function HB(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(SC),i,s,a,o;if(n)for(o=0;o!=n.length;++o)i=n[o].match(wC),(s=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?a="xmlns"+i[1].slice(6):a=i[1].slice(s+1),r[a]=i[2].slice(1,i[2].length-1));return r}var Hd;function GB(t,e){var r=Hd[t]||rr(t);return r==="General"?Zl(e):Bs(r,e)}function KB(t,e,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=Ir(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=Rr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[rr(e)]=i}function YB(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||mo[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=vf(t.v):t.w=Zl(t.v):t.w=GB(e||"General",t.v)}catch(s){if(r.WTF)throw s}try{var n=Hd[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&Mu(n)){var i=jl(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(s){if(r.WTF)throw s}}}function XB(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=oP[n.Pattern]||n.Pattern)}t[e.ID]=e}function qB(t,e,r,n,i,s,a,o,l,u){var f="General",p=n.StyleID,g={};u=u||{};var m=[],y=0;for(p===void 0&&o&&(p=o.StyleID),p===void 0&&a&&(p=a.StyleID);s[p]!==void 0&&(s[p].nf&&(f=s[p].nf),s[p].Interior&&m.push(s[p].Interior),!!s[p].Parent);)p=s[p].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Ir(t);break;case"String":n.t="s",n.r=n_(rr(t)),n.v=t.indexOf("<")>-1?rr(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(Rr(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=rr(t):n.v<60&&(n.v=n.v-1),(!f||f=="General")&&(f="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=xA[t],u.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=n_(e||t));break}if(YB(n,f,u),u.cellFormula!==!1)if(n.Formula){var x=rr(n.Formula);x.charCodeAt(0)==61&&(x=x.slice(1)),n.f=lu(x,i),delete n.Formula,n.ArrayRange=="RC"?n.F=lu("RC:RC",i):n.ArrayRange&&(n.F=lu(n.ArrayRange,i),l.push([nr(n.F),n.F]))}else for(y=0;y<l.length;++y)i.r>=l[y][0].s.r&&i.r<=l[y][0].e.r&&i.c>=l[y][0].s.c&&i.c<=l[y][0].e.c&&(n.F=l[y][1]);u.cellStyles&&(m.forEach(function(S){!g.patternType&&S.patternType&&(g.patternType=S.patternType)}),n.s=g),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function QB(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function Jg(t,e){var r=e||{};Bu();var n=wd(Q1(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=vr(n));var i=n.slice(0,1024).toLowerCase(),s=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var a=Dr(r);return a.type="string",Su.to_workbook(n,a)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(xr){i.indexOf("<"+xr)>=0&&(s=!0)}),s)return Mj(n,r);Hd={"General Number":"General","General Date":pt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":pt[15],"Short Date":pt[14],"Long Time":pt[19],"Medium Time":pt[18],"Short Time":pt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:pt[2],Standard:pt[4],Percent:pt[10],Scientific:pt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],u,f={},p=[],g=r.dense?[]:{},m="",y={},x={},S=Ks('<Data ss:Type="String">'),A=0,C=0,E=0,O={s:{r:2e6,c:2e6},e:{r:0,c:0}},q={},H={},T="",F=0,w=[],N={},D={},P=0,R=[],qe=[],Se={},Oe=[],be,ke=!1,ne=[],Ie=[],je={},K=0,te=0,re={Sheets:[],WBProps:{date1904:!1}},X={};Ef.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var _e="";o=Ef.exec(n);)switch(o[3]=(_e=o[3]).toLowerCase()){case"data":if(_e=="data"){if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?qB(n.slice(A,o.index),T,S,l[l.length-1][0]=="comment"?Se:y,{c:C,r:E},q,Oe[C],x,ne,r):(T="",S=Ks(o[0]),A=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(qe.length>0&&(y.c=qe),(!r.sheetRows||r.sheetRows>E)&&y.v!==void 0&&(r.dense?(g[E]||(g[E]=[]),g[E][C]=y):g[Yr(C)+un(E)]=y),y.HRef&&(y.l={Target:rr(y.HRef)},y.HRefScreenTip&&(y.l.Tooltip=y.HRefScreenTip),delete y.HRef,delete y.HRefScreenTip),(y.MergeAcross||y.MergeDown)&&(K=C+(parseInt(y.MergeAcross,10)|0),te=E+(parseInt(y.MergeDown,10)|0),w.push({s:{c:C,r:E},e:{c:K,r:te}})),!r.sheetStubs)y.MergeAcross?C=K+1:++C;else if(y.MergeAcross||y.MergeDown){for(var Ce=C;Ce<=K;++Ce)for(var Ve=E;Ve<=te;++Ve)(Ce>C||Ve>E)&&(r.dense?(g[Ve]||(g[Ve]=[]),g[Ve][Ce]={t:"z"}):g[Yr(Ce)+un(Ve)]={t:"z"});C=K+1}else++C;else y=HB(o[0]),y.Index&&(C=+y.Index-1),C<O.s.c&&(O.s.c=C),C>O.e.c&&(O.e.c=C),o[0].slice(-2)==="/>"&&++C,qe=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(E<O.s.r&&(O.s.r=E),E>O.e.r&&(O.e.r=E),o[0].slice(-2)==="/>"&&(x=Ks(o[0]),x.Index&&(E=+x.Index-1)),C=0,++E):(x=Ks(o[0]),x.Index&&(E=+x.Index-1),je={},(x.AutoFitHeight=="0"||x.Height)&&(je.hpx=parseInt(x.Height,10),je.hpt=Cf(je.hpx),Ie[E]=je),x.Hidden=="1"&&(je.hidden=!0,Ie[E]=je));break;case"worksheet":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));p.push(m),O.s.r<=O.e.r&&O.s.c<=O.e.c&&(g["!ref"]=bt(O),r.sheetRows&&r.sheetRows<=O.e.r&&(g["!fullref"]=g["!ref"],O.e.r=r.sheetRows-1,g["!ref"]=bt(O))),w.length&&(g["!merges"]=w),Oe.length>0&&(g["!cols"]=Oe),Ie.length>0&&(g["!rows"]=Ie),f[m]=g}else O={s:{r:2e6,c:2e6},e:{r:0,c:0}},E=C=0,l.push([o[3],!1]),u=Ks(o[0]),m=rr(u.Name),g=r.dense?[]:{},w=[],ne=[],Ie=[],X={name:m,Hidden:0},re.Sheets.push(X);break;case"table":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),Oe=[],ke=!1}break;case"style":o[1]==="/"?XB(q,H,r):H=Ks(o[0]);break;case"numberformat":H.nf=rr(Ks(o[0]).Format||"General"),Hd[H.nf]&&(H.nf=Hd[H.nf]);for(var De=0;De!=392&&pt[De]!=H.nf;++De);if(De==392){for(De=57;De!=392;++De)if(pt[De]==null){Za(H.nf,De);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(be=Ks(o[0]),be.Hidden&&(be.hidden=!0,delete be.Hidden),be.Width&&(be.wpx=parseInt(be.Width,10)),!ke&&be.wpx>10){ke=!0,pi=QA;for(var Ne=0;Ne<Oe.length;++Ne)Oe[Ne]&&hl(Oe[Ne])}ke&&hl(be),Oe[be.Index-1||Oe.length]=be;for(var it=0;it<+be.Span;++it)Oe[Oe.length]=Dr(be);break;case"namedrange":if(o[1]==="/")break;re.Names||(re.Names=[]);var Z=mt(o[0]),Rt={Name:Z.Name,Ref:lu(Z.RefersTo.slice(1),{r:0,c:0})};re.Sheets.length>0&&(Rt.Sheet=re.Sheets.length-1),re.Names.push(Rt);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?T+=n.slice(F,o.index):F=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;H.Interior=Ks(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?ED(N,_e,n.slice(P,o.index)):P=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));QB(Se),qe.push(Se)}else l.push([o[3],!1]),u=Ks(o[0]),Se={a:u.Author};break;case"autofilter":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var wt=Ks(o[0]);g["!autofilter"]={ref:lu(wt.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return H_(n,r);var Dt=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Dt=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Dt=!1}break;case"excelworkbook":switch(o[3]){case"date1904":re.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Dt=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:Dt=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(P,o.index)){case"SheetHidden":X.Hidden=1;break;case"SheetVeryHidden":X.Hidden=2;break}else P=o.index+o[0].length;break;case"header":g["!margins"]||Hl(g["!margins"]={},"xlml"),isNaN(+mt(o[0]).Margin)||(g["!margins"].header=+mt(o[0]).Margin);break;case"footer":g["!margins"]||Hl(g["!margins"]={},"xlml"),isNaN(+mt(o[0]).Margin)||(g["!margins"].footer=+mt(o[0]).Margin);break;case"pagemargins":var Et=mt(o[0]);g["!margins"]||Hl(g["!margins"]={},"xlml"),isNaN(+Et.Top)||(g["!margins"].top=+Et.Top),isNaN(+Et.Left)||(g["!margins"].left=+Et.Left),isNaN(+Et.Right)||(g["!margins"].right=+Et.Right),isNaN(+Et.Bottom)||(g["!margins"].bottom=+Et.Bottom);break;case"displayrighttoleft":re.Views||(re.Views=[]),re.Views[0]||(re.Views[0]={}),re.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Dt=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Dt=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Dt=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Dt=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Dt=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Dt=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Dt=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Dt=!1}break;case"smarttags":break;default:Dt=!1;break}if(Dt||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?KB(D,_e,R,n.slice(P,o.index)):(R=o,P=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var Ye={};return!r.bookSheets&&!r.bookProps&&(Ye.Sheets=f),Ye.SheetNames=p,Ye.Workbook=re,Ye.SSF=Dr(pt),Ye.Props=N,Ye.Custprops=D,Ye}function _x(t,e){switch(Ev(e=e||{}),e.type||"base64"){case"base64":return Jg(fs(t),e);case"binary":case"buffer":case"file":return Jg(t,e);case"array":return Jg(Sl(t),e)}}function JB(t,e){var r=[];return t.Props&&r.push(SD(t.Props,e)),t.Custprops&&r.push(wD(t.Props,t.Custprops)),r.join("")}function ZB(){return""}function ej(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,i){var s=[];s.push(Ge("NumberFormat",null,{"ss:Format":pr(pt[n.numFmtId])}));var a={"ss:ID":"s"+(21+i)};r.push(Ge("Style",s.join(""),a))}),Ge("Styles",r.join(""))}function TC(t){return Ge("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+gv(t.Ref,{r:0,c:0})})}function tj(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],n=0;n<e.length;++n){var i=e[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(TC(i)))}return Ge("Names",r.join(""))}function rj(t,e,r,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,s=[],a=0;a<i.length;++a){var o=i[a];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||s.push(TC(o)))}return s.join("")}function nj(t,e,r,n){if(!t)return"";var i=[];if(t["!margins"]&&(i.push("<PageSetup>"),t["!margins"].header&&i.push(Ge("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&i.push(Ge("Footer",null,{"x:Margin":t["!margins"].footer})),i.push(Ge("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push(Ge("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),t["!protect"]&&(i.push(Qn("ProtectContents","True")),t["!protect"].objects&&i.push(Qn("ProtectObjects","True")),t["!protect"].scenarios&&i.push(Qn("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?i.push(Qn("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&i.push(Qn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){t["!protect"][a[0]]&&i.push("<"+a[1]+"/>")})),i.length==0?"":Ge("WorksheetOptions",i.join(""),{xmlns:is.x})}function ij(t){return t.map(function(e){var r=AR(e.t||""),n=Ge("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Ge("Comment",n,{"ss:Author":e.a})}).join("")}function sj(t,e,r,n,i,s,a){if(!t||t.v==null&&t.f==null)return"";var o={};if(t.f&&(o["ss:Formula"]="="+pr(gv(t.f,a))),t.F&&t.F.slice(0,e.length)==e){var l=Xr(t.F.slice(e.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==a.r?"":"["+(l.r-a.r)+"]")+"C"+(l.c==a.c?"":"["+(l.c-a.c)+"]")}if(t.l&&t.l.Target&&(o["ss:HRef"]=pr(t.l.Target),t.l.Tooltip&&(o["x:HRefScreenTip"]=pr(t.l.Tooltip))),r["!merges"])for(var u=r["!merges"],f=0;f!=u.length;++f)u[f].s.c!=a.c||u[f].s.r!=a.r||(u[f].e.c>u[f].s.c&&(o["ss:MergeAcross"]=u[f].e.c-u[f].s.c),u[f].e.r>u[f].s.r&&(o["ss:MergeDown"]=u[f].e.r-u[f].s.r));var p="",g="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":p="Number",g=String(t.v);break;case"b":p="Boolean",g=t.v?"1":"0";break;case"e":p="Error",g=mo[t.v];break;case"d":p="DateTime",g=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||pt[14]);break;case"s":p="String",g=TR(t.v||"");break}var m=Tl(n.cellXfs,t,n);o["ss:StyleID"]="s"+(21+m),o["ss:Index"]=a.c+1;var y=t.v!=null?g:"",x=t.t=="z"?"":'<Data ss:Type="'+p+'">'+y+"</Data>";return(t.c||[]).length>0&&(x+=ij(t.c)),Ge("Cell",x,o)}function aj(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=wu(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function oj(t,e,r,n){if(!t["!ref"])return"";var i=nr(t["!ref"]),s=t["!merges"]||[],a=0,o=[];t["!cols"]&&t["!cols"].forEach(function(S,A){hl(S);var C=!!S.width,E=Qp(A,S),O={"ss:Index":A+1};C&&(O["ss:Width"]=Tf(E.width)),S.hidden&&(O["ss:Hidden"]="1"),o.push(Ge("Column",null,O))});for(var l=Array.isArray(t),u=i.s.r;u<=i.e.r;++u){for(var f=[aj(u,(t["!rows"]||[])[u])],p=i.s.c;p<=i.e.c;++p){var g=!1;for(a=0;a!=s.length;++a)if(!(s[a].s.c>p)&&!(s[a].s.r>u)&&!(s[a].e.c<p)&&!(s[a].e.r<u)){(s[a].s.c!=p||s[a].s.r!=u)&&(g=!0);break}if(!g){var m={r:u,c:p},y=gt(m),x=l?(t[u]||[])[p]:t[y];f.push(sj(x,y,t,e,r,n,m))}}f.push("</Row>"),f.length>2&&o.push(f.join(""))}return o.join("")}function lj(t,e,r){var n=[],i=r.SheetNames[t],s=r.Sheets[i],a=s?rj(s,e,t,r):"";return a.length>0&&n.push("<Names>"+a+"</Names>"),a=s?oj(s,e,t,r):"",a.length>0&&n.push("<Table>"+a+"</Table>"),n.push(nj(s,e,t,r)),n.join("")}function cj(t,e){e||(e={}),t.SSF||(t.SSF=Dr(pt)),t.SSF&&(Bu(),$p(t.SSF),e.revssf=Gp(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],Tl(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(JB(t,e)),r.push(ZB()),r.push(""),r.push("");for(var n=0;n<t.SheetNames.length;++n)r.push(Ge("Worksheet",lj(n,e,t),{"ss:Name":pr(t.SheetNames[n])}));return r[2]=ej(t,e),r[3]=tj(t),dn+Ge("Workbook",r.join(""),{xmlns:is.ss,"xmlns:o":is.o,"xmlns:x":is.x,"xmlns:ss":is.ss,"xmlns:dt":is.dt,"xmlns:html":is.html})}function uj(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=tD(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=rD(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var dj=[60,1084,2066,2165,2175];function fj(t,e,r,n,i){var s=n,a=[],o=r.slice(r.l,r.l+s);if(i&&i.enc&&i.enc.insitu&&o.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(o)}a.push(o),r.l+=s;for(var l=Ka(r,r.l),u=Ex[l],f=0;u!=null&&dj.indexOf(l)>-1;)s=Ka(r,r.l+2),f=r.l+4,l==2066?f+=4:(l==2165||l==2175)&&(f+=12),o=r.slice(f,r.l+4+s),a.push(o),r.l+=4+s,u=Ex[l=Ka(r,r.l)];var p=Ln(a);qn(p,0);var g=0;p.lens=[];for(var m=0;m<a.length;++m)p.lens.push(g),g+=a[m].length;if(p.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+p.length+" < "+n;return e.f(p,p.length,i)}function _a(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=pt[n])}catch(s){if(e.WTF)throw s}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||mo[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=vf(t.v):t.w=Zl(t.v):t.w=Bs(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(s){if(e.WTF)throw s}if(e.cellDates&&n&&t.t=="n"&&Mu(pt[n]||String(n))){var i=jl(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function H0(t,e,r){return{v:t,ixfe:e,t:r}}function hj(t,e){var r={opts:{}},n={},i=e.dense?[]:{},s={},a={},o=null,l=[],u="",f={},p,g="",m,y,x,S,A={},C=[],E,O,q=[],H=[],T={Sheets:[],WBProps:{date1904:!1},Views:[{}]},F={},w=function(xt){return xt<8?zl[xt]:xt<64&&H[xt-8]||zl[xt]},N=function(xt,Cr,Pr){var Or=Cr.XF.data;if(!(!Or||!Or.patternType||!Pr||!Pr.cellStyles)){Cr.s={},Cr.s.patternType=Or.patternType;var Rn;(Rn=wf(w(Or.icvFore)))&&(Cr.s.fgColor={rgb:Rn}),(Rn=wf(w(Or.icvBack)))&&(Cr.s.bgColor={rgb:Rn})}},D=function(xt,Cr,Pr){if(!(je>1)&&!(Pr.sheetRows&&xt.r>=Pr.sheetRows)){if(Pr.cellStyles&&Cr.XF&&Cr.XF.data&&N(xt,Cr,Pr),delete Cr.ixfe,delete Cr.XF,p=xt,g=gt(xt),(!a||!a.s||!a.e)&&(a={s:{r:0,c:0},e:{r:0,c:0}}),xt.r<a.s.r&&(a.s.r=xt.r),xt.c<a.s.c&&(a.s.c=xt.c),xt.r+1>a.e.r&&(a.e.r=xt.r+1),xt.c+1>a.e.c&&(a.e.c=xt.c+1),Pr.cellFormula&&Cr.f){for(var Or=0;Or<C.length;++Or)if(!(C[Or][0].s.c>xt.c||C[Or][0].s.r>xt.r)&&!(C[Or][0].e.c<xt.c||C[Or][0].e.r<xt.r)){Cr.F=bt(C[Or][0]),(C[Or][0].s.c!=xt.c||C[Or][0].s.r!=xt.r)&&delete Cr.f,Cr.f&&(Cr.f=""+fi(C[Or][1],a,xt,ne,P));break}}Pr.dense?(i[xt.r]||(i[xt.r]=[]),i[xt.r][xt.c]=Cr):i[g]=Cr}},P={enc:!1,sbcch:0,snames:[],sharedf:A,arrayf:C,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(P.password=e.password);var R,qe=[],Se=[],Oe=[],be=[],ke=!1,ne=[];ne.SheetNames=P.snames,ne.sharedf=P.sharedf,ne.arrayf=P.arrayf,ne.names=[],ne.XTI=[];var Ie=0,je=0,K=0,te=[],re=[],X;P.codepage=1200,Js(1200);for(var _e=!1;t.l<t.length-1;){var Ce=t.l,Ve=t.read_shift(2);if(Ve===0&&Ie===10)break;var De=t.l===t.length?0:t.read_shift(2),Ne=Ex[Ve];if(Ne&&Ne.f){if(e.bookSheets&&Ie===133&&Ve!==133)break;if(Ie=Ve,Ne.r===2||Ne.r==12){var it=t.read_shift(2);if(De-=2,!P.enc&&it!==Ve&&((it&255)<<8|it>>8)!==Ve)throw new Error("rt mismatch: "+it+"!="+Ve);Ne.r==12&&(t.l+=10,De-=10)}var Z={};if(Ve===10?Z=Ne.f(t,De,P):Z=fj(Ve,Ne,t,De,P),je==0&&[9,521,1033,2057].indexOf(Ie)===-1)continue;switch(Ve){case 34:r.opts.Date1904=T.WBProps.date1904=Z;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(P.enc||(t.l=0),P.enc=Z,!e.password)throw new Error("File is password-protected");if(Z.valid==null)throw new Error("Encryption scheme unsupported");if(!Z.valid)throw new Error("Password is incorrect");break;case 92:P.lastuser=Z;break;case 66:var Rt=Number(Z);switch(Rt){case 21010:Rt=1200;break;case 32768:Rt=1e4;break;case 32769:Rt=1252;break}Js(P.codepage=Rt),_e=!0;break;case 317:P.rrtabid=Z;break;case 25:P.winlocked=Z;break;case 439:r.opts.RefreshAll=Z;break;case 12:r.opts.CalcCount=Z;break;case 16:r.opts.CalcDelta=Z;break;case 17:r.opts.CalcIter=Z;break;case 13:r.opts.CalcMode=Z;break;case 14:r.opts.CalcPrecision=Z;break;case 95:r.opts.CalcSaveRecalc=Z;break;case 15:P.CalcRefMode=Z;break;case 2211:r.opts.FullCalc=Z;break;case 129:Z.fDialog&&(i["!type"]="dialog"),Z.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),Z.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:q.push(Z);break;case 430:ne.push([Z]),ne[ne.length-1].XTI=[];break;case 35:case 547:ne[ne.length-1].push(Z);break;case 24:case 536:X={Name:Z.Name,Ref:fi(Z.rgce,a,null,ne,P)},Z.itab>0&&(X.Sheet=Z.itab-1),ne.names.push(X),ne[0]||(ne[0]=[],ne[0].XTI=[]),ne[ne.length-1].push(Z),Z.Name=="_xlnm._FilterDatabase"&&Z.itab>0&&Z.rgce&&Z.rgce[0]&&Z.rgce[0][0]&&Z.rgce[0][0][0]=="PtgArea3d"&&(re[Z.itab-1]={ref:bt(Z.rgce[0][0][1][2])});break;case 22:P.ExternCount=Z;break;case 23:ne.length==0&&(ne[0]=[],ne[0].XTI=[]),ne[ne.length-1].XTI=ne[ne.length-1].XTI.concat(Z),ne.XTI=ne.XTI.concat(Z);break;case 2196:if(P.biff<8)break;X!=null&&(X.Comment=Z[1]);break;case 18:i["!protect"]=Z;break;case 19:Z!==0&&P.WTF&&console.error("Password verifier: "+Z);break;case 133:s[Z.pos]=Z,P.snames.push(Z.name);break;case 10:{if(--je)break;if(a.e){if(a.e.r>0&&a.e.c>0){if(a.e.r--,a.e.c--,i["!ref"]=bt(a),e.sheetRows&&e.sheetRows<=a.e.r){var wt=a.e.r;a.e.r=e.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=bt(a),a.e.r=wt}a.e.r++,a.e.c++}qe.length>0&&(i["!merges"]=qe),Se.length>0&&(i["!objects"]=Se),Oe.length>0&&(i["!cols"]=Oe),be.length>0&&(i["!rows"]=be),T.Sheets.push(F)}u===""?f=i:n[u]=i,i=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(P.biff===8&&(P.biff={9:2,521:3,1033:4}[Ve]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[Z.BIFFVer]||8),P.biffguess=Z.BIFFVer==0,Z.BIFFVer==0&&Z.dt==4096&&(P.biff=5,_e=!0,Js(P.codepage=28591)),P.biff==8&&Z.BIFFVer==0&&Z.dt==16&&(P.biff=2),je++)break;if(i=e.dense?[]:{},P.biff<8&&!_e&&(_e=!0,Js(P.codepage=e.codepage||1252)),P.biff<5||Z.BIFFVer==0&&Z.dt==4096){u===""&&(u="Sheet1"),a={s:{r:0,c:0},e:{r:0,c:0}};var Dt={pos:t.l-De,name:u};s[Dt.pos]=Dt,P.snames.push(u)}else u=(s[Ce]||{name:""}).name;Z.dt==32&&(i["!type"]="chart"),Z.dt==64&&(i["!type"]="macro"),qe=[],Se=[],P.arrayf=C=[],Oe=[],be=[],ke=!1,F={Hidden:(s[Ce]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(e.dense?(i[Z.r]||[])[Z.c]:i[gt({c:Z.c,r:Z.r})])&&++Z.c,E={ixfe:Z.ixfe,XF:q[Z.ixfe]||{},v:Z.val,t:"n"},K>0&&(E.z=te[E.ixfe>>8&63]),_a(E,e,r.opts.Date1904),D({c:Z.c,r:Z.r},E,e);break;case 5:case 517:E={ixfe:Z.ixfe,XF:q[Z.ixfe],v:Z.val,t:Z.t},K>0&&(E.z=te[E.ixfe>>8&63]),_a(E,e,r.opts.Date1904),D({c:Z.c,r:Z.r},E,e);break;case 638:E={ixfe:Z.ixfe,XF:q[Z.ixfe],v:Z.rknum,t:"n"},K>0&&(E.z=te[E.ixfe>>8&63]),_a(E,e,r.opts.Date1904),D({c:Z.c,r:Z.r},E,e);break;case 189:for(var Et=Z.c;Et<=Z.C;++Et){var Ye=Z.rkrec[Et-Z.c][0];E={ixfe:Ye,XF:q[Ye],v:Z.rkrec[Et-Z.c][1],t:"n"},K>0&&(E.z=te[E.ixfe>>8&63]),_a(E,e,r.opts.Date1904),D({c:Et,r:Z.r},E,e)}break;case 6:case 518:case 1030:{if(Z.val=="String"){o=Z;break}if(E=H0(Z.val,Z.cell.ixfe,Z.tt),E.XF=q[E.ixfe],e.cellFormula){var xr=Z.formula;if(xr&&xr[0]&&xr[0][0]&&xr[0][0][0]=="PtgExp"){var Zr=xr[0][0][1][0],En=xr[0][0][1][1],Pi=gt({r:Zr,c:En});A[Pi]?E.f=""+fi(Z.formula,a,Z.cell,ne,P):E.F=((e.dense?(i[Zr]||[])[En]:i[Pi])||{}).F}else E.f=""+fi(Z.formula,a,Z.cell,ne,P)}K>0&&(E.z=te[E.ixfe>>8&63]),_a(E,e,r.opts.Date1904),D(Z.cell,E,e),o=Z}break;case 7:case 519:if(o)o.val=Z,E=H0(Z,o.cell.ixfe,"s"),E.XF=q[E.ixfe],e.cellFormula&&(E.f=""+fi(o.formula,a,o.cell,ne,P)),K>0&&(E.z=te[E.ixfe>>8&63]),_a(E,e,r.opts.Date1904),D(o.cell,E,e),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{C.push(Z);var Oi=gt(Z[0].s);if(m=e.dense?(i[Z[0].s.r]||[])[Z[0].s.c]:i[Oi],e.cellFormula&&m){if(!o||!Oi||!m)break;m.f=""+fi(Z[1],a,Z[0],ne,P),m.F=bt(Z[0])}}break;case 1212:{if(!e.cellFormula)break;if(g){if(!o)break;A[gt(o.cell)]=Z[0],m=e.dense?(i[o.cell.r]||[])[o.cell.c]:i[gt(o.cell)],(m||{}).f=""+fi(Z[0],a,p,ne,P)}}break;case 253:E=H0(l[Z.isst].t,Z.ixfe,"s"),l[Z.isst].h&&(E.h=l[Z.isst].h),E.XF=q[E.ixfe],K>0&&(E.z=te[E.ixfe>>8&63]),_a(E,e,r.opts.Date1904),D({c:Z.c,r:Z.r},E,e);break;case 513:e.sheetStubs&&(E={ixfe:Z.ixfe,XF:q[Z.ixfe],t:"z"},K>0&&(E.z=te[E.ixfe>>8&63]),_a(E,e,r.opts.Date1904),D({c:Z.c,r:Z.r},E,e));break;case 190:if(e.sheetStubs)for(var Mi=Z.c;Mi<=Z.C;++Mi){var Vr=Z.ixfe[Mi-Z.c];E={ixfe:Vr,XF:q[Vr],t:"z"},K>0&&(E.z=te[E.ixfe>>8&63]),_a(E,e,r.opts.Date1904),D({c:Mi,r:Z.r},E,e)}break;case 214:case 516:case 4:E=H0(Z.val,Z.ixfe,"s"),E.XF=q[E.ixfe],K>0&&(E.z=te[E.ixfe>>8&63]),_a(E,e,r.opts.Date1904),D({c:Z.c,r:Z.r},E,e);break;case 0:case 512:je===1&&(a=Z);break;case 252:l=Z;break;case 1054:if(P.biff==4){te[K++]=Z[1];for(var Bi=0;Bi<K+163&&pt[Bi]!=Z[1];++Bi);Bi>=163&&Za(Z[1],K+163)}else Za(Z[1],Z[0]);break;case 30:{te[K++]=Z;for(var cr=0;cr<K+163&&pt[cr]!=Z;++cr);cr>=163&&Za(Z,K+163)}break;case 229:qe=qe.concat(Z);break;case 93:Se[Z.cmo[0]]=P.lastobj=Z;break;case 438:P.lastobj.TxO=Z;break;case 127:P.lastobj.ImData=Z;break;case 440:for(S=Z[0].s.r;S<=Z[0].e.r;++S)for(x=Z[0].s.c;x<=Z[0].e.c;++x)m=e.dense?(i[S]||[])[x]:i[gt({c:x,r:S})],m&&(m.l=Z[1]);break;case 2048:for(S=Z[0].s.r;S<=Z[0].e.r;++S)for(x=Z[0].s.c;x<=Z[0].e.c;++x)m=e.dense?(i[S]||[])[x]:i[gt({c:x,r:S})],m&&m.l&&(m.l.Tooltip=Z[1]);break;case 28:{if(P.biff<=5&&P.biff>=2)break;m=e.dense?(i[Z[0].r]||[])[Z[0].c]:i[gt(Z[0])];var zr=Se[Z[2]];m||(e.dense?(i[Z[0].r]||(i[Z[0].r]=[]),m=i[Z[0].r][Z[0].c]={t:"z"}):m=i[gt(Z[0])]={t:"z"},a.e.r=Math.max(a.e.r,Z[0].r),a.s.r=Math.min(a.s.r,Z[0].r),a.e.c=Math.max(a.e.c,Z[0].c),a.s.c=Math.min(a.s.c,Z[0].c)),m.c||(m.c=[]),y={a:Z[1],t:zr.TxO.t},m.c.push(y)}break;case 2173:e8(q[Z.ixfe],Z.ext);break;case 125:{if(!P.cellStyles)break;for(;Z.e>=Z.s;)Oe[Z.e--]={width:Z.w/256,level:Z.level||0,hidden:!!(Z.flags&1)},ke||(ke=!0,fv(Z.w/256)),hl(Oe[Z.e+1])}break;case 520:{var Ar={};Z.level!=null&&(be[Z.r]=Ar,Ar.level=Z.level),Z.hidden&&(be[Z.r]=Ar,Ar.hidden=!0),Z.hpt&&(be[Z.r]=Ar,Ar.hpt=Z.hpt,Ar.hpx=wu(Z.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||Hl(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Ve]]=Z;break;case 161:i["!margins"]||Hl(i["!margins"]={}),i["!margins"].header=Z.header,i["!margins"].footer=Z.footer;break;case 574:Z.RTL&&(T.Views[0].RTL=!0);break;case 146:H=Z;break;case 2198:R=Z;break;case 140:O=Z;break;case 442:u?F.CodeName=Z||F.name:T.WBProps.CodeName=Z||"ThisWorkbook";break}}else Ne||console.error("Missing Info for XLS Record 0x"+Ve.toString(16)),t.l+=De}return r.SheetNames=sn(s).sort(function(Si,xt){return Number(Si)-Number(xt)}).map(function(Si){return s[Si].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&f["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=f)):r.Preamble=f,r.Sheets&&re.forEach(function(Si,xt){r.Sheets[r.SheetNames[xt]]["!autofilter"]=Si}),r.Strings=l,r.SSF=Dr(pt),P.enc&&(r.Encryption=P.enc),R&&(r.Themes=R),r.Metadata={},O!==void 0&&(r.Metadata.Country=O),ne.names.length>0&&(T.Names=ne.names),r.Workbook=T,r}var Gd={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function pj(t,e,r){var n=st.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=E_(n,px,Gd.DSI);for(var s in i)e[s]=i[s]}catch(u){if(r.WTF)throw u}var a=st.find(t,"/!SummaryInformation");if(a&&a.size>0)try{var o=E_(a,gx,Gd.SI);for(var l in o)e[l]==null&&(e[l]=o[l])}catch(u){if(r.WTF)throw u}e.HeadingPairs&&e.TitlesOfParts&&(wA(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function gj(t,e){var r=[],n=[],i=[],s=0,a,o=Q2(px,"n"),l=Q2(gx,"n");if(t.Props)for(a=sn(t.Props),s=0;s<a.length;++s)(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(l,a[s])?n:i).push([a[s],t.Props[a[s]]]);if(t.Custprops)for(a=sn(t.Custprops),s=0;s<a.length;++s)Object.prototype.hasOwnProperty.call(t.Props||{},a[s])||(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(l,a[s])?n:i).push([a[s],t.Custprops[a[s]]]);var u=[];for(s=0;s<i.length;++s)IA.indexOf(i[s][0])>-1||SA.indexOf(i[s][0])>-1||i[s][1]!=null&&u.push(i[s]);n.length&&st.utils.cfb_add(e,"/SummaryInformation",S_(n,Gd.SI,l,gx)),(r.length||u.length)&&st.utils.cfb_add(e,"/DocumentSummaryInformation",S_(r,Gd.DSI,o,px,u.length?u:null,Gd.UDI))}function AC(t,e){e||(e={}),Ev(e),z1(),e.codepage&&V1(e.codepage);var r,n;if(t.FullPaths){if(st.find(t,"/encryption"))throw new Error("File is password-protected");r=st.find(t,"!CompObj"),n=st.find(t,"/Workbook")||st.find(t,"/Book")}else{switch(e.type){case"base64":t=as(fs(t));break;case"binary":t=as(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}qn(t,0),n={content:t}}var i,s;if(r&&uj(r),e.bookProps&&!e.bookSheets)i={};else{var a=Pt?"buffer":"array";if(n&&n.content)i=hj(n.content,e);else if((s=st.find(t,"PerfectOffice_MAIN"))&&s.content)i=$l.to_workbook(s.content,(e.type=a,e));else if((s=st.find(t,"NativeContent_MAIN"))&&s.content)i=$l.to_workbook(s.content,(e.type=a,e));else throw(s=st.find(t,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&st.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=F8(t))}var o={};return t.FullPaths&&pj(t,o,e),i.Props=i.Custprops=o,e.bookFiles&&(i.cfb=t),i}function mj(t,e){var r=e||{},n=st.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return st.utils.cfb_add(n,i,CC(t,r)),r.biff==8&&(t.Props||t.Custprops)&&gj(t,n),r.biff==8&&t.vbaraw&&b8(n,st.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var kf={0:{f:UO},1:{f:YO},2:{f:hM},3:{f:rM},4:{f:JO},5:{f:uM},6:{f:vM},7:{f:aM},8:{f:AM},9:{f:TM},10:{f:SM},11:{f:wM},12:{f:qO},13:{f:gM},14:{f:iM},15:{f:eM},16:{f:xC},17:{f:_M},18:{f:lM},19:{f:rv},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:_B},40:{},42:{},43:{f:vP},44:{f:mP},45:{f:EP},46:{f:wP},47:{f:SP},48:{},49:{f:WR},50:{},51:{f:n8},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:VA},62:{f:xM},63:{f:f8},64:{f:VM},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:yi,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:BM},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:GO},148:{f:WO,p:16},151:{f:NM},152:{},153:{f:xB},154:{},155:{},156:{f:gB},157:{},158:{},159:{T:1,f:D6},160:{T:-1},161:{T:1,f:mc},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:CM},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:t8},336:{T:-1},337:{f:a8,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:hx},357:{},358:{},359:{},360:{T:1},361:{},362:{f:UA},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:RM},427:{f:DM},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:OM},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:HO},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:bM},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:hx},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:w8},633:{T:1},634:{T:-1},635:{T:1,f:E8},636:{T:-1},637:{f:KR},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:iB},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:zM},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Ex={6:{f:qg},10:{f:Do},12:{f:yn},13:{f:yn},14:{f:on},15:{f:on},16:{f:mi},17:{f:on},18:{f:on},19:{f:yn},20:{f:F_},21:{f:F_},23:{f:UA},24:{f:I_},25:{f:on},26:{},27:{},28:{f:z3},29:{},34:{f:on},35:{f:b_},38:{f:mi},39:{f:mi},40:{f:mi},41:{f:mi},42:{f:on},43:{f:on},47:{f:eP},49:{f:g3},51:{f:yn},60:{},61:{f:u3},64:{f:on},65:{f:p3},66:{f:yn},77:{},80:{},81:{},82:{},85:{f:yn},89:{},90:{},91:{},92:{f:ZD},93:{f:H3},94:{},95:{f:on},96:{},97:{},99:{f:on},125:{f:VA},128:{f:I3},129:{f:t3},130:{f:yn},131:{f:on},132:{f:on},133:{f:r3},134:{},140:{f:Z3},141:{f:yn},144:{},146:{f:r6},151:{},152:{},153:{},154:{},155:{},156:{f:yn},157:{},158:{},160:{f:c6},161:{f:s6},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:C3},190:{f:k3},193:{f:Do},197:{},198:{},199:{},200:{},201:{},202:{f:on},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:yn},220:{},221:{f:on},222:{},224:{f:b3},225:{f:JD},226:{f:Do},227:{},229:{f:W3},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:i3},253:{f:x3},255:{f:a3},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:NA},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:on},353:{f:Do},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:O3},431:{f:on},432:{},433:{},434:{},437:{},438:{f:Y3},439:{f:on},440:{f:X3},441:{},442:{f:Yf},443:{},444:{f:yn},445:{},446:{},448:{f:Do},449:{f:c3,r:2},450:{f:Do},512:{f:A_},513:{f:l6},515:{f:D3},516:{f:y3},517:{f:k_},519:{f:u6},520:{f:o3},523:{},545:{f:N_},549:{f:T_},566:{},574:{f:f3},638:{f:A3},659:{},1048:{},1054:{f:E3},1084:{},1212:{f:L3},2048:{f:Q3},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:z0},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Do},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:n6,r:12},2173:{f:ZP,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:on,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:j3,r:12},2197:{},2198:{f:KP,r:12},2199:{},2200:{},2201:{},2202:{f:U3,r:12},2203:{f:Do},2204:{},2205:{},2206:{},2207:{},2211:{f:l3},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:yn},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:a6},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:t6},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:A_},1:{},2:{f:g6},3:{f:h6},4:{f:f6},5:{f:k_},7:{f:x6},8:{},9:{f:z0},11:{},22:{f:yn},30:{f:w3},31:{},32:{},33:{f:N_},36:{},37:{f:T_},50:{f:v6},62:{},52:{},67:{},68:{f:yn},69:{},86:{},126:{},127:{f:d6},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:y6},223:{},234:{},354:{},421:{},518:{f:qg},521:{f:z0},536:{f:I_},547:{f:b_},561:{},579:{},1030:{f:qg},1033:{f:z0},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Ke(t,e,r,n){var i=e;if(!isNaN(i)){var s=n||(r||[]).length||0,a=t.next(4);a.write_shift(2,i),a.write_shift(2,s),s>0&&Z1(r)&&t.push(r)}}function xj(t,e,r,n){var i=(r||[]).length||0;if(i<=8224)return Ke(t,e,r,i);var s=e;if(!isNaN(s)){for(var a=r.parts||[],o=0,l=0,u=0;u+(a[o]||8224)<=8224;)u+=a[o]||8224,o++;var f=t.next(4);for(f.write_shift(2,s),f.write_shift(2,u),t.push(r.slice(l,l+u)),l+=u;l<i;){for(f=t.next(4),f.write_shift(2,60),u=0;u+(a[o]||8224)<=8224;)u+=a[o]||8224,o++;f.write_shift(2,u),t.push(r.slice(l,l+u)),l+=u}}}function Jf(t,e,r){return t||(t=Ee(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function vj(t,e,r,n){var i=Ee(9);return Jf(i,t,e),RA(r,n||"b",i),i}function yj(t,e,r){var n=Ee(8+2*r.length);return Jf(n,t,e),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function _j(t,e,r,n){if(e.v!=null)switch(e.t){case"d":case"n":var i=e.t=="d"?Nn(Rr(e.v)):e.v;i==(i|0)&&i>=0&&i<65536?Ke(t,2,m6(r,n,i)):Ke(t,3,p6(r,n,i));return;case"b":case"e":Ke(t,5,vj(r,n,e.v,e.t));return;case"s":case"str":Ke(t,4,yj(r,n,(e.v||"").slice(0,255)));return}Ke(t,1,Jf(null,r,n))}function Ej(t,e,r,n){var i=Array.isArray(e),s=nr(e["!ref"]||"A1"),a,o="",l=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),a=bt(s)}for(var u=s.s.r;u<=s.e.r;++u){o=un(u);for(var f=s.s.c;f<=s.e.c;++f){u===s.s.r&&(l[f]=Yr(f)),a=l[f]+o;var p=i?(e[u]||[])[f]:e[a];p&&_j(t,p,u,f)}}}function Sj(t,e){for(var r=e||{},n=Yi(),i=0,s=0;s<t.SheetNames.length;++s)t.SheetNames[s]==r.sheet&&(i=s);if(i==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Ke(n,r.biff==4?1033:r.biff==3?521:9,cv(t,16,r)),Ej(n,t.Sheets[t.SheetNames[i]],i,r),Ke(n,10),n.end()}function wj(t,e,r){Ke(t,49,m3({sz:12,name:"Arial"},r))}function Tj(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&Ke(t,1054,S3(i,e[i],r))})}function Aj(t,e){var r=Ee(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Ke(t,2151,r),r=Ee(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),BA(nr(e["!ref"]||"A1"),r),r.write_shift(4,4),Ke(t,2152,r)}function Cj(t,e){for(var r=0;r<16;++r)Ke(t,224,C_({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){Ke(t,224,C_(n,0,e))})}function kj(t,e){for(var r=0;r<e["!links"].length;++r){var n=e["!links"][r];Ke(t,440,q3(n)),n[1].Tooltip&&Ke(t,2048,J3(n))}delete e["!links"]}function Fj(t,e){if(e){var r=0;e.forEach(function(n,i){++r<=256&&n&&Ke(t,125,i6(Qp(i,n),i))})}}function bj(t,e,r,n,i){var s=16+Tl(i.cellXfs,e,i);if(e.v==null&&!e.bf){Ke(t,513,nc(r,n,s));return}if(e.bf)Ke(t,6,tO(e,r,n,i,s));else switch(e.t){case"d":case"n":var a=e.t=="d"?Nn(Rr(e.v)):e.v;Ke(t,515,P3(r,n,a,s));break;case"b":case"e":Ke(t,517,R3(r,n,e.v,s,i,e.t));break;case"s":case"str":if(i.bookSST){var o=xv(i.Strings,e.v,i.revStrings);Ke(t,253,v3(r,n,o,s))}else Ke(t,516,_3(r,n,(e.v||"").slice(0,255),s,i));break;default:Ke(t,513,nc(r,n,s))}}function Ij(t,e,r){var n=Yi(),i=r.SheetNames[t],s=r.Sheets[i]||{},a=(r||{}).Workbook||{},o=(a.Sheets||[])[t]||{},l=Array.isArray(s),u=e.biff==8,f,p="",g=[],m=nr(s["!ref"]||"A1"),y=u?65536:16384;if(m.e.c>255||m.e.r>=y){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");m.e.c=Math.min(m.e.c,255),m.e.r=Math.min(m.e.c,y-1)}Ke(n,2057,cv(r,16,e)),Ke(n,13,Fs(1)),Ke(n,12,Fs(100)),Ke(n,15,bi(!0)),Ke(n,17,bi(!1)),Ke(n,16,tc(.001)),Ke(n,95,bi(!0)),Ke(n,42,bi(!1)),Ke(n,43,bi(!1)),Ke(n,130,Fs(1)),Ke(n,128,N3()),Ke(n,131,bi(!1)),Ke(n,132,bi(!1)),u&&Fj(n,s["!cols"]),Ke(n,512,T3(m,e)),u&&(s["!links"]=[]);for(var x=m.s.r;x<=m.e.r;++x){p=un(x);for(var S=m.s.c;S<=m.e.c;++S){x===m.s.r&&(g[S]=Yr(S)),f=g[S]+p;var A=l?(s[x]||[])[S]:s[f];A&&(bj(n,A,x,S,e),u&&A.l&&s["!links"].push([f,A.l]))}}var C=o.CodeName||o.name||i;return u&&Ke(n,574,h3((a.Views||[])[0])),u&&(s["!merges"]||[]).length&&Ke(n,229,$3(s["!merges"])),u&&kj(n,s),Ke(n,442,DA(C)),u&&Aj(n,s),Ke(n,10),n.end()}function Nj(t,e,r){var n=Yi(),i=(t||{}).Workbook||{},s=i.Sheets||[],a=i.WBProps||{},o=r.biff==8,l=r.biff==5;if(Ke(n,2057,cv(t,5,r)),r.bookType=="xla"&&Ke(n,135),Ke(n,225,o?Fs(1200):null),Ke(n,193,RD(2)),l&&Ke(n,191),l&&Ke(n,192),Ke(n,226),Ke(n,92,e3("SheetJS",r)),Ke(n,66,Fs(o?1200:1252)),o&&Ke(n,353,Fs(0)),o&&Ke(n,448),Ke(n,317,o6(t.SheetNames.length)),o&&t.vbaraw&&Ke(n,211),o&&t.vbaraw){var u=a.CodeName||"ThisWorkbook";Ke(n,442,DA(u))}Ke(n,156,Fs(17)),Ke(n,25,bi(!1)),Ke(n,18,bi(!1)),Ke(n,19,Fs(0)),o&&Ke(n,431,bi(!1)),o&&Ke(n,444,Fs(0)),Ke(n,61,d3()),Ke(n,64,bi(!1)),Ke(n,141,Fs(0)),Ke(n,34,bi(cB(t)=="true")),Ke(n,14,bi(!0)),o&&Ke(n,439,bi(!1)),Ke(n,218,Fs(0)),wj(n,t,r),Tj(n,t.SSF,r),Cj(n,r),o&&Ke(n,352,bi(!1));var f=n.end(),p=Yi();o&&Ke(p,140,e6()),o&&r.Strings&&xj(p,252,s3(r.Strings)),Ke(p,10);var g=p.end(),m=Yi(),y=0,x=0;for(x=0;x<t.SheetNames.length;++x)y+=(o?12:11)+(o?2:1)*t.SheetNames[x].length;var S=f.length+y+g.length;for(x=0;x<t.SheetNames.length;++x){var A=s[x]||{};Ke(m,133,n3({pos:S,hs:A.Hidden||0,dt:0,name:t.SheetNames[x]},r)),S+=e[x].length}var C=m.end();if(y!=C.length)throw new Error("BS8 "+y+" != "+C.length);var E=[];return f.length&&E.push(f),C.length&&E.push(C),g.length&&E.push(g),Ln(E)}function Rj(t,e){var r=e||{},n=[];t&&!t.SSF&&(t.SSF=Dr(pt)),t&&t.SSF&&(Bu(),$p(t.SSF),r.revssf=Gp(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Sv(r),r.cellXfs=[],Tl(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var i=0;i<t.SheetNames.length;++i)n[n.length]=Ij(i,r,t);return n.unshift(Nj(t,n,r)),Ln(n)}function CC(t,e){for(var r=0;r<=t.SheetNames.length;++r){var n=t.Sheets[t.SheetNames[r]];if(!(!n||!n["!ref"])){var i=Xi(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=e||{};switch(s.biff||2){case 8:case 5:return Rj(t,e);case 4:case 3:case 2:return Sj(t,e)}throw new Error("invalid type "+s.bookType+" for BIFF")}function V_(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var i=t.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var s=t.match(/<\/table/i),a=i.index,o=s&&s.index||t.length,l=mR(t.slice(a,o),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,f=0,p=0,g=0,m={s:{r:1e7,c:1e7},e:{r:0,c:0}},y=[];for(a=0;a<l.length;++a){var x=l[a].trim(),S=x.slice(0,3).toLowerCase();if(S=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}f=0;continue}if(!(S!="<td"&&S!="<th")){var A=x.split(/<\/t[dh]>/i);for(o=0;o<A.length;++o){var C=A[o].trim();if(C.match(/<t[dh]/i)){for(var E=C,O=0;E.charAt(0)=="<"&&(O=E.indexOf(">"))>-1;)E=E.slice(O+1);for(var q=0;q<y.length;++q){var H=y[q];H.s.c==f&&H.s.r<u&&u<=H.e.r&&(f=H.e.c+1,q=-1)}var T=mt(C.slice(0,C.indexOf(">")));g=T.colspan?+T.colspan:1,((p=+T.rowspan)>1||g>1)&&y.push({s:{r:u,c:f},e:{r:u+(p||1)-1,c:f+g-1}});var F=T.t||T["data-t"]||"";if(!E.length){f+=g;continue}if(E=qT(E),m.s.r>u&&(m.s.r=u),m.e.r<u&&(m.e.r=u),m.s.c>f&&(m.s.c=f),m.e.c<f&&(m.e.c=f),!E.length){f+=g;continue}var w={t:"s",v:E};r.raw||!E.trim().length||F=="s"||(E==="TRUE"?w={t:"b",v:!0}:E==="FALSE"?w={t:"b",v:!1}:isNaN(na(E))?isNaN(Eu(E).getDate())||(w={t:"d",v:Rr(E)},r.cellDates||(w={t:"n",v:Nn(w.v)}),w.z=r.dateNF||pt[14]):w={t:"n",v:na(E)}),r.dense?(n[u]||(n[u]=[]),n[u][f]=w):n[gt({r:u,c:f})]=w,f+=g}}}}return n["!ref"]=bt(m),y.length&&(n["!merges"]=y),n}function Dj(t,e,r,n){for(var i=t["!merges"]||[],s=[],a=e.s.c;a<=e.e.c;++a){for(var o=0,l=0,u=0;u<i.length;++u)if(!(i[u].s.r>r||i[u].s.c>a)&&!(i[u].e.r<r||i[u].e.c<a)){if(i[u].s.r<r||i[u].s.c<a){o=-1;break}o=i[u].e.r-i[u].s.r+1,l=i[u].e.c-i[u].s.c+1;break}if(!(o<0)){var f=gt({r,c:a}),p=n.dense?(t[r]||[])[a]:t[f],g=p&&p.v!=null&&(p.h||q1(p.w||(ao(p),p.w)||""))||"",m={};o>1&&(m.rowspan=o),l>1&&(m.colspan=l),n.editable?g='<span contenteditable="true">'+g+"</span>":p&&(m["data-t"]=p&&p.t||"z",p.v!=null&&(m["data-v"]=p.v),p.z!=null&&(m["data-z"]=p.z),p.l&&(p.l.Target||"#").charAt(0)!="#"&&(g='<a href="'+p.l.Target+'">'+g+"</a>")),m.id=(n.id||"sjs")+"-"+f,s.push(Ge("td",g,m))}}var y="<tr>";return y+s.join("")+"</tr>"}var Pj='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',Oj="</body></html>";function Mj(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return wl(V_(r[0],e),e);var n=Av();return r.forEach(function(i,s){Cv(n,V_(i,e),"Sheet"+(s+1))}),n}function Bj(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function kC(t,e){var r=e||{},n=r.header!=null?r.header:Pj,i=r.footer!=null?r.footer:Oj,s=[n],a=Xi(t["!ref"]);r.dense=Array.isArray(t),s.push(Bj(t,a,r));for(var o=a.s.r;o<=a.e.r;++o)s.push(Dj(t,a,o,r));return s.push("</table>"+i),s.join("")}function FC(t,e,r){var n=r||{},i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var a=typeof n.origin=="string"?Xr(n.origin):n.origin;i=a.r,s=a.c}var o=e.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),u={s:{r:0,c:0},e:{r:i,c:s}};if(t["!ref"]){var f=Xi(t["!ref"]);u.s.r=Math.min(u.s.r,f.s.r),u.s.c=Math.min(u.s.c,f.s.c),u.e.r=Math.max(u.e.r,f.e.r),u.e.c=Math.max(u.e.c,f.e.c),i==-1&&(u.e.r=i=f.e.r+1)}var p=[],g=0,m=t["!rows"]||(t["!rows"]=[]),y=0,x=0,S=0,A=0,C=0,E=0;for(t["!cols"]||(t["!cols"]=[]);y<o.length&&x<l;++y){var O=o[y];if(z_(O)){if(n.display)continue;m[x]={hidden:!0}}var q=O.children;for(S=A=0;S<q.length;++S){var H=q[S];if(!(n.display&&z_(H))){var T=H.hasAttribute("data-v")?H.getAttribute("data-v"):H.hasAttribute("v")?H.getAttribute("v"):qT(H.innerHTML),F=H.getAttribute("data-z")||H.getAttribute("z");for(g=0;g<p.length;++g){var w=p[g];w.s.c==A+s&&w.s.r<x+i&&x+i<=w.e.r&&(A=w.e.c+1-s,g=-1)}E=+H.getAttribute("colspan")||1,((C=+H.getAttribute("rowspan")||1)>1||E>1)&&p.push({s:{r:x+i,c:A+s},e:{r:x+i+(C||1)-1,c:A+s+(E||1)-1}});var N={t:"s",v:T},D=H.getAttribute("data-t")||H.getAttribute("t")||"";T!=null&&(T.length==0?N.t=D||"z":n.raw||T.trim().length==0||D=="s"||(T==="TRUE"?N={t:"b",v:!0}:T==="FALSE"?N={t:"b",v:!1}:isNaN(na(T))?isNaN(Eu(T).getDate())||(N={t:"d",v:Rr(T)},n.cellDates||(N={t:"n",v:Nn(N.v)}),N.z=n.dateNF||pt[14]):N={t:"n",v:na(T)})),N.z===void 0&&F!=null&&(N.z=F);var P="",R=H.getElementsByTagName("A");if(R&&R.length)for(var qe=0;qe<R.length&&!(R[qe].hasAttribute("href")&&(P=R[qe].getAttribute("href"),P.charAt(0)!="#"));++qe);P&&P.charAt(0)!="#"&&(N.l={Target:P}),n.dense?(t[x+i]||(t[x+i]=[]),t[x+i][A+s]=N):t[gt({c:A+s,r:x+i})]=N,u.e.c<A+s&&(u.e.c=A+s),A+=E}}++x}return p.length&&(t["!merges"]=(t["!merges"]||[]).concat(p)),u.e.r=Math.max(u.e.r,x-1+i),t["!ref"]=bt(u),x>=l&&(t["!fullref"]=bt((u.e.r=o.length-y+x-1+i,u))),t}function bC(t,e){var r=e||{},n=r.dense?[]:{};return FC(n,t,e)}function jj(t,e){return wl(bC(t,e),e)}function z_(t){var e="",r=Lj(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function Lj(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function Uj(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=rr(e.replace(/<[^>]*>/g,""));return[r]}var W_={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function IC(t,e){var r=e||{},n=Q1(t),i=[],s,a,o={name:""},l="",u=0,f,p,g={},m=[],y=r.dense?[]:{},x,S,A={value:""},C="",E=0,O=[],q=-1,H=-1,T={s:{r:1e6,c:1e7},e:{r:0,c:0}},F=0,w={},N=[],D={},P=0,R=0,qe=[],Se=1,Oe=1,be=[],ke={Names:[]},ne={},Ie=["",""],je=[],K={},te="",re=0,X=!1,_e=!1,Ce=0;for(Ef.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");x=Ef.exec(n);)switch(x[3]=x[3].replace(/_.*$/,"")){case"table":case"":x[1]==="/"?(T.e.c>=T.s.c&&T.e.r>=T.s.r?y["!ref"]=bt(T):y["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=T.e.r&&(y["!fullref"]=y["!ref"],T.e.r=r.sheetRows-1,y["!ref"]=bt(T)),N.length&&(y["!merges"]=N),qe.length&&(y["!rows"]=qe),f.name=f.||f.name,typeof JSON<"u"&&JSON.stringify(f),m.push(f.name),g[f.name]=y,_e=!1):x[0].charAt(x[0].length-2)!=="/"&&(f=mt(x[0],!1),q=H=-1,T.s.r=T.s.c=1e7,T.e.r=T.e.c=0,y=r.dense?[]:{},N=[],qe=[],_e=!0);break;case"table-row-group":x[1]==="/"?--F:++F;break;case"table-row":case"":if(x[1]==="/"){q+=Se,Se=1;break}if(p=mt(x[0],!1),p.?q=p.-1:q==-1&&(q=0),Se=+p["number-rows-repeated"]||1,Se<10)for(Ce=0;Ce<Se;++Ce)F>0&&(qe[q+Ce]={level:F});H=-1;break;case"covered-table-cell":x[1]!=="/"&&++H,r.sheetStubs&&(r.dense?(y[q]||(y[q]=[]),y[q][H]={t:"z"}):y[gt({r:q,c:H})]={t:"z"}),C="",O=[];break;case"table-cell":case"":if(x[0].charAt(x[0].length-2)==="/")++H,A=mt(x[0],!1),Oe=parseInt(A["number-columns-repeated"]||"1",10),S={t:"z",v:null},A.formula&&r.cellFormula!=!1&&(S.f=j_(rr(A.formula))),(A.||A["value-type"])=="string"&&(S.t="s",S.v=rr(A["string-value"]||""),r.dense?(y[q]||(y[q]=[]),y[q][H]=S):y[gt({r:q,c:H})]=S),H+=Oe-1;else if(x[1]!=="/"){++H,C="",E=0,O=[],Oe=1;var Ve=Se?q+Se-1:q;if(H>T.e.c&&(T.e.c=H),H<T.s.c&&(T.s.c=H),q<T.s.r&&(T.s.r=q),Ve>T.e.r&&(T.e.r=Ve),A=mt(x[0],!1),je=[],K={},S={t:A.||A["value-type"],v:null},r.cellFormula)if(A.formula&&(A.formula=rr(A.formula)),A["number-matrix-columns-spanned"]&&A["number-matrix-rows-spanned"]&&(P=parseInt(A["number-matrix-rows-spanned"],10)||0,R=parseInt(A["number-matrix-columns-spanned"],10)||0,D={s:{r:q,c:H},e:{r:q+P-1,c:H+R-1}},S.F=bt(D),be.push([D,S.F])),A.formula)S.f=j_(A.formula);else for(Ce=0;Ce<be.length;++Ce)q>=be[Ce][0].s.r&&q<=be[Ce][0].e.r&&H>=be[Ce][0].s.c&&H<=be[Ce][0].e.c&&(S.F=be[Ce][1]);switch((A["number-columns-spanned"]||A["number-rows-spanned"])&&(P=parseInt(A["number-rows-spanned"],10)||0,R=parseInt(A["number-columns-spanned"],10)||0,D={s:{r:q,c:H},e:{r:q+P-1,c:H+R-1}},N.push(D)),A["number-columns-repeated"]&&(Oe=parseInt(A["number-columns-repeated"],10)),S.t){case"boolean":S.t="b",S.v=Ir(A["boolean-value"]);break;case"float":S.t="n",S.v=parseFloat(A.value);break;case"percentage":S.t="n",S.v=parseFloat(A.value);break;case"currency":S.t="n",S.v=parseFloat(A.value);break;case"date":S.t="d",S.v=Rr(A["date-value"]),r.cellDates||(S.t="n",S.v=Nn(S.v)),S.z="m/d/yy";break;case"time":S.t="n",S.v=hR(A["time-value"])/86400,r.cellDates&&(S.t="d",S.v=Kp(S.v)),S.z="HH:MM:SS";break;case"number":S.t="n",S.v=parseFloat(A.);break;default:if(S.t==="string"||S.t==="text"||!S.t)S.t="s",A["string-value"]!=null&&(C=rr(A["string-value"]),O=[]);else throw new Error("Unsupported value type "+S.t)}}else{if(X=!1,S.t==="s"&&(S.v=C||"",O.length&&(S.R=O),X=E==0),ne.Target&&(S.l=ne),je.length>0&&(S.c=je,je=[]),C&&r.cellText!==!1&&(S.w=C),X&&(S.t="z",delete S.v),(!X||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=q))for(var De=0;De<Se;++De){if(Oe=parseInt(A["number-columns-repeated"]||"1",10),r.dense)for(y[q+De]||(y[q+De]=[]),y[q+De][H]=De==0?S:Dr(S);--Oe>0;)y[q+De][H+Oe]=Dr(S);else for(y[gt({r:q+De,c:H})]=S;--Oe>0;)y[gt({r:q+De,c:H+Oe})]=Dr(S);T.e.c<=H&&(T.e.c=H)}Oe=parseInt(A["number-columns-repeated"]||"1",10),H+=Oe-1,Oe=0,S={},C="",O=[]}ne={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(x[1]==="/"){if((s=i.pop())[0]!==x[3])throw"Bad state: "+s}else x[0].charAt(x[0].length-2)!=="/"&&i.push([x[3],!0]);break;case"annotation":if(x[1]==="/"){if((s=i.pop())[0]!==x[3])throw"Bad state: "+s;K.t=C,O.length&&(K.R=O),K.a=te,je.push(K)}else x[0].charAt(x[0].length-2)!=="/"&&i.push([x[3],!1]);te="",re=0,C="",E=0,O=[];break;case"creator":x[1]==="/"?te=n.slice(re,x.index):re=x.index+x[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(x[1]==="/"){if((s=i.pop())[0]!==x[3])throw"Bad state: "+s}else x[0].charAt(x[0].length-2)!=="/"&&i.push([x[3],!1]);C="",E=0,O=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(x[1]==="/"){if(w[o.name]=l,(s=i.pop())[0]!==x[3])throw"Bad state: "+s}else x[0].charAt(x[0].length-2)!=="/"&&(l="",o=mt(x[0],!1),i.push([x[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":a=mt(x[0],!1),l+=W_[x[3]][a.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":a=mt(x[0],!1),l+=W_[x[3]][a.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(x[0].slice(-2)==="/>")break;if(x[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(u,x.index);break}else u=x.index+x[0].length;break;case"named-range":a=mt(x[0],!1),Ie=Qg(a["cell-range-address"]);var Ne={Name:a.name,Ref:Ie[0]+"!"+Ie[1]};_e&&(Ne.Sheet=m.length),ke.Names.push(Ne);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(x[1]==="/"&&(!A||!A["string-value"])){var it=Uj(n.slice(E,x.index));C=(C.length>0?C+`
`:"")+it[0]}else mt(x[0],!1),E=x.index+x[0].length;break;case"s":break;case"database-range":if(x[1]==="/")break;try{Ie=Qg(mt(x[0])["target-range-address"]),g[Ie[0]]["!autofilter"]={ref:Ie[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(x[1]!=="/"){if(ne=mt(x[0],!1),!ne.href)break;ne.Target=rr(ne.href),delete ne.href,ne.Target.charAt(0)=="#"&&ne.Target.indexOf(".")>-1?(Ie=Qg(ne.Target.slice(1)),ne.Target="#"+Ie[0]+"!"+Ie[1]):ne.Target.match(/^\.\.[\\\/]/)&&(ne.Target=ne.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(x[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(x)}}var Z={Sheets:g,SheetNames:m,Workbook:ke};return r.bookSheets&&delete Z.Sheets,Z}function $_(t,e){e=e||{},ks(t,"META-INF/manifest.xml")&&hD(vn(t,"META-INF/manifest.xml"),e);var r=os(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=IC(vr(r),e);return ks(t,"meta.xml")&&(n.Props=_A(vn(t,"meta.xml"))),n}function H_(t,e){return IC(t,e)}var Vj=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+_f({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return dn+e}}(),G_=function(){var t=function(s){return pr(s).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,a,o){var l=[];l.push('      <table:table table:name="'+pr(a.SheetNames[o])+`" table:style-name="ta1">
`);var u=0,f=0,p=Xi(s["!ref"]||"A1"),g=s["!merges"]||[],m=0,y=Array.isArray(s);if(s["!cols"])for(f=0;f<=p.e.c;++f)l.push("        <table:table-column"+(s["!cols"][f]?' table:style-name="co'+s["!cols"][f].ods+'"':"")+`></table:table-column>
`);var x="",S=s["!rows"]||[];for(u=0;u<p.s.r;++u)x=S[u]?' table:style-name="ro'+S[u].ods+'"':"",l.push("        <table:table-row"+x+`></table:table-row>
`);for(;u<=p.e.r;++u){for(x=S[u]?' table:style-name="ro'+S[u].ods+'"':"",l.push("        <table:table-row"+x+`>
`),f=0;f<p.s.c;++f)l.push(e);for(;f<=p.e.c;++f){var A=!1,C={},E="";for(m=0;m!=g.length;++m)if(!(g[m].s.c>f)&&!(g[m].s.r>u)&&!(g[m].e.c<f)&&!(g[m].e.r<u)){(g[m].s.c!=f||g[m].s.r!=u)&&(A=!0),C["table:number-columns-spanned"]=g[m].e.c-g[m].s.c+1,C["table:number-rows-spanned"]=g[m].e.r-g[m].s.r+1;break}if(A){l.push(r);continue}var O=gt({r:u,c:f}),q=y?(s[u]||[])[f]:s[O];if(q&&q.f&&(C["table:formula"]=pr(oO(q.f)),q.F&&q.F.slice(0,O.length)==O)){var H=Xi(q.F);C["table:number-matrix-columns-spanned"]=H.e.c-H.s.c+1,C["table:number-matrix-rows-spanned"]=H.e.r-H.s.r+1}if(!q){l.push(e);continue}switch(q.t){case"b":E=q.v?"TRUE":"FALSE",C["office:value-type"]="boolean",C["office:boolean-value"]=q.v?"true":"false";break;case"n":E=q.w||String(q.v||0),C["office:value-type"]="float",C["office:value"]=q.v||0;break;case"s":case"str":E=q.v==null?"":q.v,C["office:value-type"]="string";break;case"d":E=q.w||Rr(q.v).toISOString(),C["office:value-type"]="date",C["office:date-value"]=Rr(q.v).toISOString(),C["table:style-name"]="ce1";break;default:l.push(e);continue}var T=t(E);if(q.l&&q.l.Target){var F=q.l.Target;F=F.charAt(0)=="#"?"#"+lO(F.slice(1)):F,F.charAt(0)!="#"&&!F.match(/^\w+:/)&&(F="../"+F),T=Ge("text:a",T,{"xlink:href":F.replace(/&/g,"&amp;")})}l.push("          "+Ge("table:table-cell",Ge("text:p",T,{}),C)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},i=function(s,a){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;a.SheetNames.map(function(u){return a.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var f=0;f<u["!cols"].length;++f)if(u["!cols"][f]){var p=u["!cols"][f];if(p.width==null&&p.wpx==null&&p.wch==null)continue;hl(p),p.ods=o;var g=u["!cols"][f].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+g+`"/>
`),s.push(`  </style:style>
`),++o}}});var l=0;a.SheetNames.map(function(u){return a.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var f=0;f<u["!rows"].length;++f)if(u["!rows"][f]){u["!rows"][f].ods=l;var p=u["!rows"][f].hpx+"px";s.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+p+`"/>
`),s.push(`  </style:style>
`),++l}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(a,o){var l=[dn],u=_f({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),f=_f({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+u+f+`>
`),l.push(yA().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+u+`>
`),i(l,a),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var p=0;p!=a.SheetNames.length;++p)l.push(n(a.Sheets[a.SheetNames[p]],a,p));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function NC(t,e){if(e.bookType=="fods")return G_(t,e);var r=K1(),n="",i=[],s=[];return n="mimetype",It(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",It(r,n,G_(t,e)),i.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",It(r,n,Vj(t,e)),i.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",It(r,n,dn+yA()),i.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",It(r,n,mD(s)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",It(r,n,pD(i)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function ic(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Sx(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):vr(Sl(t))}function zj(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):as(Ca(t))}function Wj(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var n=0;n<e.length;++n)if(t[r+n]!=e[n])continue e;return!0}return!1}function gl(t){var e=t.reduce(function(i,s){return i+s.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(i){r.set(i,n),n+=i.length}),r}function K_(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function $j(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,i=e+13;i>=e;--i)n=n*256+t[i];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function Hj(t,e,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,n-6176);t[e+15]|=n>>7,t[e+14]|=(n&127)<<1;for(var s=0;i>=1;++s,i/=256)t[e+s]=i&255;t[e+15]|=r>=0?0:128}function Ff(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function fr(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function nn(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function sr(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],i=Ff(t,r),s=i&7;i=Math.floor(i/8);var a=0,o;if(i==0)break;switch(s){case 0:{for(var l=r[0];t[r[0]++]>=128;);o=t.slice(l,r[0])}break;case 5:a=4,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 1:a=8,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 2:a=Ff(t,r),o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var u={data:o,type:s};e[i]==null?e[i]=[u]:e[i].push(u)}return e}function Kn(t){var e=[];return t.forEach(function(r,n){r.forEach(function(i){i.data&&(e.push(fr(n*8+i.type)),i.type==2&&e.push(fr(i.data.length)),e.push(i.data))})}),gl(e)}function _v(t,e){return(t==null?void 0:t.map(function(r){return e(r.data)}))||[]}function As(t){for(var e,r=[],n=[0];n[0]<t.length;){var i=Ff(t,n),s=sr(t.slice(n[0],n[0]+i));n[0]+=i;var a={id:nn(s[1][0].data),messages:[]};s[2].forEach(function(o){var l=sr(o.data),u=nn(l[3][0].data);a.messages.push({meta:l,data:t.slice(n[0],n[0]+u)}),n[0]+=u}),(e=s[3])!=null&&e[0]&&(a.merge=nn(s[3][0].data)>>>0>0),r.push(a)}return r}function Rc(t){var e=[];return t.forEach(function(r){var n=[];n[1]=[{data:fr(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:fr(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(a){i.push(a.data),a.meta[3]=[{type:0,data:fr(a.data.length)}],n[2].push({data:Kn(a.meta),type:2})});var s=Kn(n);e.push(fr(s.length)),e.push(s),i.forEach(function(a){return e.push(a)})}),gl(e)}function Gj(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=Ff(e,r),i=[];r[0]<e.length;){var s=e[r[0]]&3;if(s==0){var a=e[r[0]++]>>2;if(a<60)++a;else{var o=a-59;a=e[r[0]],o>1&&(a|=e[r[0]+1]<<8),o>2&&(a|=e[r[0]+2]<<16),o>3&&(a|=e[r[0]+3]<<24),a>>>=0,a++,r[0]+=o}i.push(e.slice(r[0],r[0]+a)),r[0]+=a;continue}else{var l=0,u=0;if(s==1?(u=(e[r[0]]>>2&7)+4,l=(e[r[0]++]&224)<<3,l|=e[r[0]++]):(u=(e[r[0]++]>>2)+1,s==2?(l=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(l=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),i=[gl(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(u>=l)for(i.push(i[0].slice(-l)),u-=l;u>=i[i.length-1].length;)i.push(i[i.length-1]),u-=i[i.length-1].length;i.push(i[0].slice(-l,-l+u))}}var f=gl(i);if(f.length!=n)throw new Error("Unexpected length: ".concat(f.length," != ").concat(n));return f}function Cs(t){for(var e=[],r=0;r<t.length;){var n=t[r++],i=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(Gj(n,t.slice(r,r+i))),r+=i}if(r!==t.length)throw new Error("data is not a valid framed stream!");return gl(e)}function Dc(t){for(var e=[],r=0;r<t.length;){var n=Math.min(t.length-r,268435455),i=new Uint8Array(4);e.push(i);var s=fr(n),a=s.length;e.push(s),n<=60?(a++,e.push(new Uint8Array([n-1<<2]))):n<=256?(a+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(a+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(a+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(a+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(t.slice(r,r+n)),a+=n,i[0]=0,i[1]=a&255,i[2]=a>>8&255,i[3]=a>>16&255,r+=n}return gl(e)}function Kj(t,e,r,n){var i=ic(t),s=i.getUint32(4,!0),a=(n>1?12:8)+K_(s&(n>1?3470:398))*4,o=-1,l=-1,u=NaN,f=new Date(2001,0,1);s&512&&(o=i.getUint32(a,!0),a+=4),a+=K_(s&(n>1?12288:4096))*4,s&16&&(l=i.getUint32(a,!0),a+=4),s&32&&(u=i.getFloat64(a,!0),a+=8),s&64&&(f.setTime(f.getTime()+i.getFloat64(a,!0)*1e3),a+=8);var p;switch(t[2]){case 0:break;case 2:p={t:"n",v:u};break;case 3:p={t:"s",v:e[l]};break;case 5:p={t:"d",v:f};break;case 6:p={t:"b",v:u>0};break;case 7:p={t:"n",v:u/86400};break;case 8:p={t:"e",v:0};break;case 9:if(o>-1)p={t:"s",v:r[o]};else if(l>-1)p={t:"s",v:e[l]};else if(!isNaN(u))p={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return p}function Yj(t,e,r){var n=ic(t),i=n.getUint32(8,!0),s=12,a=-1,o=-1,l=NaN,u=NaN,f=new Date(2001,0,1);i&1&&(l=$j(t,s),s+=16),i&2&&(u=n.getFloat64(s,!0),s+=8),i&4&&(f.setTime(f.getTime()+n.getFloat64(s,!0)*1e3),s+=8),i&8&&(o=n.getUint32(s,!0),s+=4),i&16&&(a=n.getUint32(s,!0),s+=4);var p;switch(t[1]){case 0:break;case 2:p={t:"n",v:l};break;case 3:p={t:"s",v:e[o]};break;case 5:p={t:"d",v:f};break;case 6:p={t:"b",v:u>0};break;case 7:p={t:"n",v:u/86400};break;case 8:p={t:"e",v:0};break;case 9:if(a>-1)p={t:"s",v:r[a]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)));break;case 10:p={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)))}return p}function Zg(t,e){var r=new Uint8Array(32),n=ic(r),i=12,s=0;switch(r[0]=5,t.t){case"n":r[1]=2,Hj(r,i,t.v),s|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,t.v?1:0,!0),s|=2,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,n.setUint32(i,e.indexOf(t.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,s,!0),r.slice(0,i)}function em(t,e){var r=new Uint8Array(32),n=ic(r),i=12,s=0;switch(r[0]=3,t.t){case"n":r[2]=2,n.setFloat64(i,t.v,!0),s|=32,i+=8;break;case"b":r[2]=6,n.setFloat64(i,t.v?1:0,!0),s|=32,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,n.setUint32(i,e.indexOf(t.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,s,!0),r.slice(0,i)}function Xj(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return Kj(t,e,r,t[0]);case 5:return Yj(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function ui(t){var e=sr(t);return Ff(e[1][0].data)}function Y_(t,e){var r=sr(e.data),n=nn(r[1][0].data),i=r[3],s=[];return(i||[]).forEach(function(a){var o=sr(a.data),l=nn(o[1][0].data)>>>0;switch(n){case 1:s[l]=Sx(o[3][0].data);break;case 8:{var u=t[ui(o[9][0].data)][0],f=sr(u.data),p=t[ui(f[1][0].data)][0],g=nn(p.meta[1][0].data);if(g!=2001)throw new Error("2000 unexpected reference to ".concat(g));var m=sr(p.data);s[l]=m[3].map(function(y){return Sx(y.data)}).join("")}break}}),s}function qj(t,e){var r,n,i,s,a,o,l,u,f,p,g,m,y,x,S=sr(t),A=nn(S[1][0].data)>>>0,C=nn(S[2][0].data)>>>0,E=((n=(r=S[8])==null?void 0:r[0])==null?void 0:n.data)&&nn(S[8][0].data)>0||!1,O,q;if((s=(i=S[7])==null?void 0:i[0])!=null&&s.data&&e!=0)O=(o=(a=S[7])==null?void 0:a[0])==null?void 0:o.data,q=(u=(l=S[6])==null?void 0:l[0])==null?void 0:u.data;else if((p=(f=S[4])==null?void 0:f[0])!=null&&p.data&&e!=1)O=(m=(g=S[4])==null?void 0:g[0])==null?void 0:m.data,q=(x=(y=S[3])==null?void 0:y[0])==null?void 0:x.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var H=E?4:1,T=ic(O),F=[],w=0;w<O.length/2;++w){var N=T.getUint16(w*2,!0);N<65535&&F.push([w,N])}if(F.length!=C)throw"Expected ".concat(C," cells, found ").concat(F.length);var D=[];for(w=0;w<F.length-1;++w)D[F[w][0]]=q.subarray(F[w][1]*H,F[w+1][1]*H);return F.length>=1&&(D[F[F.length-1][0]]=q.subarray(F[F.length-1][1]*H)),{R:A,cells:D}}function Qj(t,e){var r,n=sr(e.data),i=(r=n==null?void 0:n[7])!=null&&r[0]?nn(n[7][0].data)>>>0>0?1:0:-1,s=_v(n[5],function(a){return qj(a,i)});return{nrows:nn(n[4][0].data)>>>0,data:s.reduce(function(a,o){return a[o.R]||(a[o.R]=[]),o.cells.forEach(function(l,u){if(a[o.R][u])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(u));a[o.R][u]=l}),a},[])}}function Jj(t,e,r){var n,i=sr(e.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(nn(i[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(s.e.c=(nn(i[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=bt(s);var a=sr(i[4][0].data),o=Y_(t,t[ui(a[4][0].data)][0]),l=(n=a[17])!=null&&n[0]?Y_(t,t[ui(a[17][0].data)][0]):[],u=sr(a[3][0].data),f=0;u[1].forEach(function(p){var g=sr(p.data),m=t[ui(g[2][0].data)][0],y=nn(m.meta[1][0].data);if(y!=6002)throw new Error("6001 unexpected reference to ".concat(y));var x=Qj(t,m);x.data.forEach(function(S,A){S.forEach(function(C,E){var O=gt({r:f+A,c:E}),q=Xj(C,o,l);q&&(r[O]=q)})}),f+=x.nrows})}function Zj(t,e){var r=sr(e.data),n={"!ref":"A1"},i=t[ui(r[2][0].data)],s=nn(i[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return Jj(t,i[0],n),n}function eL(t,e){var r,n=sr(e.data),i={name:(r=n[1])!=null&&r[0]?Sx(n[1][0].data):"",sheets:[]},s=_v(n[2],ui);return s.forEach(function(a){t[a].forEach(function(o){var l=nn(o.meta[1][0].data);l==6e3&&i.sheets.push(Zj(t,o))})}),i}function tL(t,e){var r=Av(),n=sr(e.data),i=_v(n[1],ui);if(i.forEach(function(s){t[s].forEach(function(a){var o=nn(a.meta[1][0].data);if(o==2){var l=eL(t,a);l.sheets.forEach(function(u,f){Cv(r,u,f==0?l.name:l.name+"_"+f,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function tm(t){var e,r,n,i,s={},a=[];if(t.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var u;try{u=Cs(l.content)}catch(p){return console.log("?? "+l.content.length+" "+(p.message||p))}var f;try{f=As(u)}catch(p){return console.log("## "+(p.message||p))}f.forEach(function(p){s[p.id]=p.messages,a.push(p.id)})}}),!a.length)throw new Error("File has no messages");var o=((i=(n=(r=(e=s==null?void 0:s[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&nn(s[1][0].meta[1][0].data)==1&&s[1][0];if(o||a.forEach(function(l){s[l].forEach(function(u){var f=nn(u.meta[1][0].data)>>>0;if(f==1)if(!o)o=u;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return tL(s,o)}function rL(t,e,r){var n,i,s,a;if(!((n=t[6])!=null&&n[0])||!((i=t[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var o=((a=(s=t[8])==null?void 0:s[0])==null?void 0:a.data)&&nn(t[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,u=ic(t[7][0].data),f=0,p=[],g=ic(t[4][0].data),m=0,y=[],x=0;x<e.length;++x){if(e[x]==null){u.setUint16(x*2,65535,!0),g.setUint16(x*2,65535);continue}u.setUint16(x*2,f,!0),g.setUint16(x*2,m,!0);var S,A;switch(typeof e[x]){case"string":S=Zg({t:"s",v:e[x]},r),A=em({t:"s",v:e[x]},r);break;case"number":S=Zg({t:"n",v:e[x]},r),A=em({t:"n",v:e[x]},r);break;case"boolean":S=Zg({t:"b",v:e[x]},r),A=em({t:"b",v:e[x]},r);break;default:throw new Error("Unsupported value "+e[x])}p.push(S),f+=S.length,y.push(A),m+=A.length,++l}for(t[2][0].data=fr(l);x<t[7][0].data.length/2;++x)u.setUint16(x*2,65535,!0),g.setUint16(x*2,65535,!0);return t[6][0].data=gl(p),t[3][0].data=gl(y),l}function nL(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Xi(r["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(bt(n)));var s=cp(r,{range:n,header:1}),a=["~Sh33tJ5~"];s.forEach(function(te){return te.forEach(function(re){typeof re=="string"&&a.push(re)})});var o={},l=[],u=st.read(e.numbers,{type:"base64"});u.FileIndex.map(function(te,re){return[te,u.FullPaths[re]]}).forEach(function(te){var re=te[0],X=te[1];if(re.type==2&&re.name.match(/\.iwa/)){var _e=re.content,Ce=Cs(_e),Ve=As(Ce);Ve.forEach(function(De){l.push(De.id),o[De.id]={deps:[],location:X,type:nn(De.messages[0].meta[1][0].data)}})}}),l.sort(function(te,re){return te-re});var f=l.filter(function(te){return te>1}).map(function(te){return[te,fr(te)]});u.FileIndex.map(function(te,re){return[te,u.FullPaths[re]]}).forEach(function(te){var re=te[0];if(te[1],!!re.name.match(/\.iwa/)){var X=As(Cs(re.content));X.forEach(function(_e){_e.messages.forEach(function(Ce){f.forEach(function(Ve){_e.messages.some(function(De){return nn(De.meta[1][0].data)!=11006&&Wj(De.data,Ve[1])})&&o[Ve[0]].deps.push(_e.id)})})})}});for(var p=st.find(u,o[1].location),g=As(Cs(p.content)),m,y=0;y<g.length;++y){var x=g[y];x.id==1&&(m=x)}var S=ui(sr(m.messages[0].data)[1][0].data);for(p=st.find(u,o[S].location),g=As(Cs(p.content)),y=0;y<g.length;++y)x=g[y],x.id==S&&(m=x);for(S=ui(sr(m.messages[0].data)[2][0].data),p=st.find(u,o[S].location),g=As(Cs(p.content)),y=0;y<g.length;++y)x=g[y],x.id==S&&(m=x);for(S=ui(sr(m.messages[0].data)[2][0].data),p=st.find(u,o[S].location),g=As(Cs(p.content)),y=0;y<g.length;++y)x=g[y],x.id==S&&(m=x);var A=sr(m.messages[0].data);{A[6][0].data=fr(n.e.r+1),A[7][0].data=fr(n.e.c+1);var C=ui(A[46][0].data),E=st.find(u,o[C].location),O=As(Cs(E.content));{for(var q=0;q<O.length&&O[q].id!=C;++q);if(O[q].id!=C)throw"Bad ColumnRowUIDMapArchive";var H=sr(O[q].messages[0].data);H[1]=[],H[2]=[],H[3]=[];for(var T=0;T<=n.e.c;++T){var F=[];F[1]=F[2]=[{type:0,data:fr(T+420690)}],H[1].push({type:2,data:Kn(F)}),H[2].push({type:0,data:fr(T)}),H[3].push({type:0,data:fr(T)})}H[4]=[],H[5]=[],H[6]=[];for(var w=0;w<=n.e.r;++w)F=[],F[1]=F[2]=[{type:0,data:fr(w+726270)}],H[4].push({type:2,data:Kn(F)}),H[5].push({type:0,data:fr(w)}),H[6].push({type:0,data:fr(w)});O[q].messages[0].data=Kn(H)}E.content=Dc(Rc(O)),E.size=E.content.length,delete A[46];var N=sr(A[4][0].data);{N[7][0].data=fr(n.e.r+1);var D=sr(N[1][0].data),P=ui(D[2][0].data);E=st.find(u,o[P].location),O=As(Cs(E.content));{if(O[0].id!=P)throw"Bad HeaderStorageBucket";var R=sr(O[0].messages[0].data);for(w=0;w<s.length;++w){var qe=sr(R[2][0].data);qe[1][0].data=fr(w),qe[4][0].data=fr(s[w].length),R[2][w]={type:R[2][0].type,data:Kn(qe)}}O[0].messages[0].data=Kn(R)}E.content=Dc(Rc(O)),E.size=E.content.length;var Se=ui(N[2][0].data);E=st.find(u,o[Se].location),O=As(Cs(E.content));{if(O[0].id!=Se)throw"Bad HeaderStorageBucket";for(R=sr(O[0].messages[0].data),T=0;T<=n.e.c;++T)qe=sr(R[2][0].data),qe[1][0].data=fr(T),qe[4][0].data=fr(n.e.r+1),R[2][T]={type:R[2][0].type,data:Kn(qe)};O[0].messages[0].data=Kn(R)}E.content=Dc(Rc(O)),E.size=E.content.length;var Oe=ui(N[4][0].data);(function(){for(var te=st.find(u,o[Oe].location),re=As(Cs(te.content)),X,_e=0;_e<re.length;++_e){var Ce=re[_e];Ce.id==Oe&&(X=Ce)}var Ve=sr(X.messages[0].data);{Ve[3]=[];var De=[];a.forEach(function(Z,Rt){De[1]=[{type:0,data:fr(Rt)}],De[2]=[{type:0,data:fr(1)}],De[3]=[{type:2,data:zj(Z)}],Ve[3].push({type:2,data:Kn(De)})})}X.messages[0].data=Kn(Ve);var Ne=Rc(re),it=Dc(Ne);te.content=it,te.size=te.content.length})();var be=sr(N[3][0].data);{var ke=be[1][0];delete be[2];var ne=sr(ke.data);{var Ie=ui(ne[2][0].data);(function(){for(var te=st.find(u,o[Ie].location),re=As(Cs(te.content)),X,_e=0;_e<re.length;++_e){var Ce=re[_e];Ce.id==Ie&&(X=Ce)}var Ve=sr(X.messages[0].data);{delete Ve[6],delete be[7];var De=new Uint8Array(Ve[5][0].data);Ve[5]=[];for(var Ne=0,it=0;it<=n.e.r;++it){var Z=sr(De);Ne+=rL(Z,s[it],a),Z[1][0].data=fr(it),Ve[5].push({data:Kn(Z),type:2})}Ve[1]=[{type:0,data:fr(n.e.c+1)}],Ve[2]=[{type:0,data:fr(n.e.r+1)}],Ve[3]=[{type:0,data:fr(Ne)}],Ve[4]=[{type:0,data:fr(n.e.r+1)}]}X.messages[0].data=Kn(Ve);var Rt=Rc(re),wt=Dc(Rt);te.content=wt,te.size=te.content.length})()}ke.data=Kn(ne)}N[3][0].data=Kn(be)}A[4][0].data=Kn(N)}m.messages[0].data=Kn(A);var je=Rc(g),K=Dc(je);return p.content=K,p.size=p.content.length,u}function RC(t){return function(r){for(var n=0;n!=t.length;++n){var i=t[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function Ev(t){RC([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function Sv(t){RC([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function iL(t){return Bt.WS.indexOf(t)>-1?"sheet":t==Bt.CS?"chart":t==Bt.DS?"dialog":t==Bt.MS?"macro":t&&t.length?t:"sheet"}function sL(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,iL(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function aL(t,e,r,n,i,s,a,o,l,u,f,p){try{s[n]=zd(os(t,r,!0),e);var g=vn(t,e),m;switch(o){case"sheet":m=FB(g,e,i,l,s[n],u,f,p);break;case"chart":if(m=bB(g,e,i,l,s[n],u,f,p),!m||!m["!drawel"])break;var y=Ad(m["!drawel"].Target,e),x=Sf(y),S=g8(os(t,y,!0),zd(os(t,x,!0),y)),A=Ad(S,y),C=Sf(A);m=rB(os(t,A,!0),A,l,zd(os(t,C,!0),A),u,m);break;case"macro":m=IB(g,e,i,l,s[n],u,f,p);break;case"dialog":m=NB(g,e,i,l,s[n],u,f,p);break;default:throw new Error("Unrecognized sheet type "+o)}a[n]=m;var E=[];s&&s[n]&&sn(s[n]).forEach(function(O){var q="";if(s[n][O].Type==Bt.CMNT){q=Ad(s[n][O].Target,e);var H=OB(vn(t,q,!0),q,l);if(!H||!H.length)return;D_(m,H,!1)}s[n][O].Type==Bt.TCMNT&&(q=Ad(s[n][O].Target,e),E=E.concat(x8(vn(t,q,!0),l)))}),E&&E.length&&D_(m,E,!0,l.people||[])}catch(O){if(l.WTF)throw O}}function ws(t){return t.charAt(0)=="/"?t.slice(1):t}function oL(t,e){if(Bu(),e=e||{},Ev(e),ks(t,"META-INF/manifest.xml")||ks(t,"objectdata.xml"))return $_(t,e);if(ks(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof tm<"u"){if(t.FileIndex)return tm(t);var r=st.utils.cfb_new();return e_(t).forEach(function(qe){It(r,qe,vR(t,qe))}),tm(r)}throw new Error("Unsupported NUMBERS file")}if(!ks(t,"[Content_Types].xml"))throw ks(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):ks(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=e_(t),i=dD(os(t,"[Content_Types].xml")),s=!1,a,o;if(i.workbooks.length===0&&(o="xl/workbook.xml",vn(t,o,!0)&&i.workbooks.push(o)),i.workbooks.length===0){if(o="xl/workbook.bin",!vn(t,o,!0))throw new Error("Could not find workbook");i.workbooks.push(o),s=!0}i.workbooks[0].slice(-3)=="bin"&&(s=!0);var l={},u={};if(!e.bookSheets&&!e.bookProps){if(Wd=[],i.sst)try{Wd=PB(vn(t,ws(i.sst)),i.sst,e)}catch(qe){if(e.WTF)throw qe}e.cellStyles&&i.themes.length&&(l=DB(os(t,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],e)),i.style&&(u=RB(vn(t,ws(i.style)),i.style,l,e))}i.links.map(function(qe){try{var Se=zd(os(t,Sf(ws(qe))),qe);return BB(vn(t,ws(qe)),Se,qe,e)}catch{}});var f=kB(vn(t,ws(i.workbooks[0])),i.workbooks[0],e),p={},g="";i.coreprops.length&&(g=vn(t,ws(i.coreprops[0]),!0),g&&(p=_A(g)),i.extprops.length!==0&&(g=vn(t,ws(i.extprops[0]),!0),g&&vD(g,p,e)));var m={};(!e.bookSheets||e.bookProps)&&i.custprops.length!==0&&(g=os(t,ws(i.custprops[0]),!0),g&&(m=_D(g,e)));var y={};if((e.bookSheets||e.bookProps)&&(f.Sheets?a=f.Sheets.map(function(Se){return Se.name}):p.Worksheets&&p.SheetNames.length>0&&(a=p.SheetNames),e.bookProps&&(y.Props=p,y.Custprops=m),e.bookSheets&&typeof a<"u"&&(y.SheetNames=a),e.bookSheets?y.SheetNames:e.bookProps))return y;a={};var x={};e.bookDeps&&i.calcchain&&(x=MB(vn(t,ws(i.calcchain)),i.calcchain));var S=0,A={},C,E;{var O=f.Sheets;p.Worksheets=O.length,p.SheetNames=[];for(var q=0;q!=O.length;++q)p.SheetNames[q]=O[q].name}var H=s?"bin":"xml",T=i.workbooks[0].lastIndexOf("/"),F=(i.workbooks[0].slice(0,T+1)+"_rels/"+i.workbooks[0].slice(T+1)+".rels").replace(/^\//,"");ks(t,F)||(F="xl/_rels/workbook."+H+".rels");var w=zd(os(t,F,!0),F.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(e.xlmeta=jB(vn(t,ws(i.metadata[0])),i.metadata[0],e)),(i.people||[]).length>=1&&(e.people=y8(vn(t,ws(i.people[0])),e)),w&&(w=sL(w,f.Sheets));var N=vn(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(S=0;S!=p.Worksheets;++S){var D="sheet";if(w&&w[S]?(C="xl/"+w[S][1].replace(/[\/]?xl\//,""),ks(t,C)||(C=w[S][1]),ks(t,C)||(C=F.replace(/_rels\/.*$/,"")+w[S][1]),D=w[S][2]):(C="xl/worksheets/sheet"+(S+1-N)+"."+H,C=C.replace(/sheet0\./,"sheet.")),E=C.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(S!=e.sheets)continue e;break;case"string":if(p.SheetNames[S].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var P=!1,R=0;R!=e.sheets.length;++R)typeof e.sheets[R]=="number"&&e.sheets[R]==S&&(P=1),typeof e.sheets[R]=="string"&&e.sheets[R].toLowerCase()==p.SheetNames[S].toLowerCase()&&(P=1);if(!P)continue e}}aL(t,C,E,p.SheetNames[S],S,A,a,D,e,f,l,u)}return y={Directory:i,Workbook:f,Props:p,Custprops:m,Deps:x,Sheets:a,SheetNames:p.SheetNames,Strings:Wd,Styles:u,Themes:l,SSF:Dr(pt)},e&&e.bookFiles&&(t.files?(y.keys=n,y.files=t.files):(y.keys=[],y.files={},t.FullPaths.forEach(function(qe,Se){qe=qe.replace(/^Root Entry[\/]/,""),y.keys.push(qe),y.files[qe]=t.FileIndex[Se]}))),e&&e.bookVBA&&(i.vba.length>0?y.vbaraw=vn(t,ws(i.vba[0]),!0):i.defaults&&i.defaults.bin===k8&&(y.vbaraw=vn(t,"xl/vbaProject.bin",!0))),y}function lL(t,e){var r=e||{},n="Workbook",i=st.find(t,n);try{if(n="/!DataSpaces/Version",i=st.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(j6(i.content),n="/!DataSpaces/DataSpaceMap",i=st.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=U6(i.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=st.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=V6(i.content);if(a.length!=1||a[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=st.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);W6(i.content)}catch{}if(n="/EncryptionInfo",i=st.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=$6(i.content);if(n="/EncryptedPackage",i=st.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],i.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function cL(t,e){return e.bookType=="ods"?NC(t,e):e.bookType=="numbers"?nL(t,e):e.bookType=="xlsb"?uL(t,e):dL(t,e)}function uL(t,e){Jc=1024,t&&!t.SSF&&(t.SSF=Dr(pt)),t&&t.SSF&&(Bu(),$p(t.SSF),e.revssf=Gp(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,$d?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",n=sC.indexOf(e.bookType)>-1,i=ov();Sv(e=e||{});var s=K1(),a="",o=0;if(e.cellXfs=[],Tl(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),a="docProps/core.xml",It(s,a,EA(t.Props,e)),i.coreprops.push(a),hr(e.rels,2,a,Bt.CORE_PROPS),a="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],u=0;u<t.SheetNames.length;++u)(t.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(t.SheetNames[u]);t.Props.SheetNames=l}for(t.Props.Worksheets=t.Props.SheetNames.length,It(s,a,TA(t.Props)),i.extprops.push(a),hr(e.rels,3,a,Bt.EXT_PROPS),t.Custprops!==t.Props&&sn(t.Custprops||{}).length>0&&(a="docProps/custom.xml",It(s,a,AA(t.Custprops)),i.custprops.push(a),hr(e.rels,4,a,Bt.CUST_PROPS)),o=1;o<=t.SheetNames.length;++o){var f={"!id":{}},p=t.Sheets[t.SheetNames[o-1]],g=(p||{})["!type"]||"sheet";switch(g){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,It(s,a,UB(o-1,a,e,t,f)),i.sheets.push(a),hr(e.wbrels,-1,"worksheets/sheet"+o+"."+r,Bt.WS[0])}if(p){var m=p["!comments"],y=!1,x="";m&&m.length>0&&(x="xl/comments"+o+"."+r,It(s,x,WB(m,x)),i.comments.push(x),hr(f,-1,"../comments"+o+"."+r,Bt.CMNT),y=!0),p["!legacy"]&&y&&It(s,"xl/drawings/vmlDrawing"+o+".vml",nC(o,p["!comments"])),delete p["!comments"],delete p["!legacy"]}f["!id"].rId1&&It(s,Sf(a),ou(f))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+r,It(s,a,zB(e.Strings,a,e)),i.strs.push(a),hr(e.wbrels,-1,"sharedStrings."+r,Bt.SST)),a="xl/workbook."+r,It(s,a,LB(t,a)),i.workbooks.push(a),hr(e.rels,1,a,Bt.WB),a="xl/theme/theme1.xml",It(s,a,hv(t.Themes,e)),i.themes.push(a),hr(e.wbrels,-1,"theme/theme1.xml",Bt.THEME),a="xl/styles."+r,It(s,a,VB(t,a,e)),i.styles.push(a),hr(e.wbrels,-1,"styles."+r,Bt.STY),t.vbaraw&&n&&(a="xl/vbaProject.bin",It(s,a,t.vbaraw),i.vba.push(a),hr(e.wbrels,-1,"vbaProject.bin",Bt.VBA)),a="xl/metadata."+r,It(s,a,$B(a)),i.metadata.push(a),hr(e.wbrels,-1,"metadata."+r,Bt.XLMETA),It(s,"[Content_Types].xml",vA(i,e)),It(s,"_rels/.rels",ou(e.rels)),It(s,"xl/_rels/workbook."+r+".rels",ou(e.wbrels)),delete e.revssf,delete e.ssf,s}function dL(t,e){Jc=1024,t&&!t.SSF&&(t.SSF=Dr(pt)),t&&t.SSF&&(Bu(),$p(t.SSF),e.revssf=Gp(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,$d?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",n=sC.indexOf(e.bookType)>-1,i=ov();Sv(e=e||{});var s=K1(),a="",o=0;if(e.cellXfs=[],Tl(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),a="docProps/core.xml",It(s,a,EA(t.Props,e)),i.coreprops.push(a),hr(e.rels,2,a,Bt.CORE_PROPS),a="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],u=0;u<t.SheetNames.length;++u)(t.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(t.SheetNames[u]);t.Props.SheetNames=l}t.Props.Worksheets=t.Props.SheetNames.length,It(s,a,TA(t.Props)),i.extprops.push(a),hr(e.rels,3,a,Bt.EXT_PROPS),t.Custprops!==t.Props&&sn(t.Custprops||{}).length>0&&(a="docProps/custom.xml",It(s,a,AA(t.Custprops)),i.custprops.push(a),hr(e.rels,4,a,Bt.CUST_PROPS));var f=["SheetJ5"];for(e.tcid=0,o=1;o<=t.SheetNames.length;++o){var p={"!id":{}},g=t.Sheets[t.SheetNames[o-1]],m=(g||{})["!type"]||"sheet";switch(m){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,It(s,a,mC(o-1,e,t,p)),i.sheets.push(a),hr(e.wbrels,-1,"worksheets/sheet"+o+"."+r,Bt.WS[0])}if(g){var y=g["!comments"],x=!1,S="";if(y&&y.length>0){var A=!1;y.forEach(function(C){C[1].forEach(function(E){E.T==!0&&(A=!0)})}),A&&(S="xl/threadedComments/threadedComment"+o+"."+r,It(s,S,v8(y,f,e)),i.threadedcomments.push(S),hr(p,-1,"../threadedComments/threadedComment"+o+"."+r,Bt.TCMNT)),S="xl/comments"+o+"."+r,It(s,S,iC(y)),i.comments.push(S),hr(p,-1,"../comments"+o+"."+r,Bt.CMNT),x=!0}g["!legacy"]&&x&&It(s,"xl/drawings/vmlDrawing"+o+".vml",nC(o,g["!comments"])),delete g["!comments"],delete g["!legacy"]}p["!id"].rId1&&It(s,Sf(a),ou(p))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+r,It(s,a,HA(e.Strings,e)),i.strs.push(a),hr(e.wbrels,-1,"sharedStrings."+r,Bt.SST)),a="xl/workbook."+r,It(s,a,EC(t)),i.workbooks.push(a),hr(e.rels,1,a,Bt.WB),a="xl/theme/theme1.xml",It(s,a,hv(t.Themes,e)),i.themes.push(a),hr(e.wbrels,-1,"theme/theme1.xml",Bt.THEME),a="xl/styles."+r,It(s,a,ZA(t,e)),i.styles.push(a),hr(e.wbrels,-1,"styles."+r,Bt.STY),t.vbaraw&&n&&(a="xl/vbaProject.bin",It(s,a,t.vbaraw),i.vba.push(a),hr(e.wbrels,-1,"vbaProject.bin",Bt.VBA)),a="xl/metadata."+r,It(s,a,rC()),i.metadata.push(a),hr(e.wbrels,-1,"metadata."+r,Bt.XLMETA),f.length>1&&(a="xl/persons/person.xml",It(s,a,_8(f)),i.people.push(a),hr(e.wbrels,-1,"persons/person.xml",Bt.PEOPLE)),It(s,"[Content_Types].xml",vA(i,e)),It(s,"_rels/.rels",ou(e.rels)),It(s,"xl/_rels/workbook."+r+".rels",ou(e.wbrels)),delete e.revssf,delete e.ssf,s}function wv(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=fs(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function fL(t,e){return st.find(t,"EncryptedPackage")?lL(t,e):AC(t,e)}function hL(t,e){var r,n=t,i=e||{};return i.type||(i.type=Pt&&Buffer.isBuffer(t)?"buffer":"base64"),r=KT(n,i),oL(r,i)}function DC(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return _x(t.slice(r),e);default:break e}return Su.to_workbook(t,e)}function pL(t,e){var r="",n=wv(t,e);switch(e.type){case"base64":r=fs(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=ec(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=vr(r)),e.type="binary",DC(r,e)}function gL(t,e){var r=t;return e.type=="base64"&&(r=fs(r)),r=mf.utils.decode(1200,r.slice(2),"str"),e.type="binary",DC(r,e)}function mL(t){return t.match(/[^\x00-\x7F]/)?Ca(t):t}function rm(t,e,r,n){return n?(r.type="string",Su.to_workbook(t,r)):Su.to_workbook(e,r)}function Pl(t,e){z1();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return Pl(new Uint8Array(t),(r=Dr(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,i=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),cu={},r.dateNF&&(cu.dateNF=r.dateNF),r.type||(r.type=Pt&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=Pt?"buffer":"binary",n=uR(t),typeof Uint8Array<"u"&&!Pt&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=mL(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var a=new ArrayBuffer(3),o=new Uint8Array(a);if(o.foo="bar",!o.foo)return r=Dr(r),r.type="array",Pl(W1(n),r)}switch((i=wv(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return fL(st.read(n,r),r);break;case 9:if(i[1]<=8)return AC(n,r);break;case 60:return _x(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return E6(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return WA.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?hL(n,r):rm(t,n,r,s);case 239:return i[3]===60?_x(n,r):rm(t,n,r,s);case 255:if(i[1]===254)return gL(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return $l.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return $l.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return yx.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return qA.to_workbook(n,r);break;case 10:case 13:case 32:return pL(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return _6.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?yx.to_workbook(n,r):rm(t,n,r,s)}function PC(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return Hf(e.file,st.write(t,{type:Pt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return st.write(t,e)}function xL(t,e){var r=Dr(e||{}),n=cL(t,r);return vL(n,r)}function vL(t,e){var r={},n=Pt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=n;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var i=t.FullPaths?st.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(e.type=="binary"||e.type=="base64")return i;i=new Uint8Array(Wp(i))}return e.password&&typeof encrypt_agile<"u"?PC(encrypt_agile(i,e.password),e):e.type==="file"?Hf(e.file,i):e.type=="string"?vr(i):i}function yL(t,e){var r=e||{},n=mj(t,r);return PC(n,r)}function Sa(t,e,r){r||(r="");var n=r+t;switch(e.type){case"base64":return xf(Ca(n));case"binary":return Ca(n);case"string":return t;case"file":return Hf(e.file,n,"utf8");case"buffer":return Pt?po(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Sa(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function _L(t,e){switch(e.type){case"base64":return xf(t);case"binary":return t;case"string":return t;case"file":return Hf(e.file,t,"binary");case"buffer":return Pt?po(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function G0(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",n=0;n<t.length;++n)r+=String.fromCharCode(t[n]);return e.type=="base64"?xf(r):e.type=="string"?vr(r):r;case"file":return Hf(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function OC(t,e){z1(),fB(t);var r=Dr(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=OC(t,r);return r.type="array",Wp(n)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=t.SheetNames.indexOf(r.sheet),!t.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Sa(cj(t,r),r);case"slk":case"sylk":return Sa(zA.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"htm":case"html":return Sa(kC(t.Sheets[t.SheetNames[i]],r),r);case"txt":return _L(MC(t.Sheets[t.SheetNames[i]],r),r);case"csv":return Sa(Tv(t.Sheets[t.SheetNames[i]],r),r,"\uFEFF");case"dif":return Sa(WA.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"dbf":return G0(yx.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"prn":return Sa(Su.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"rtf":return Sa(qA.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"eth":return Sa($A.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"fods":return Sa(NC(t,r),r);case"wk1":return G0($l.sheet_to_wk1(t.Sheets[t.SheetNames[i]],r),r);case"wk3":return G0($l.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),G0(CC(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),yL(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return xL(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function EL(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(t.bookType=r.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function Pc(t,e,r){var n={};return n.type="file",n.file=e,EL(n),OC(t,n)}function SL(t,e,r,n,i,s,a,o){var l=un(r),u=o.defval,f=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),p=!0,g=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(g,"__rowNum__",{value:r,enumerable:!1})}catch{g.__rowNum__=r}else g.__rowNum__=r;if(!a||t[r])for(var m=e.s.c;m<=e.e.c;++m){var y=a?t[r][m]:t[n[m]+l];if(y===void 0||y.t===void 0){if(u===void 0)continue;s[m]!=null&&(g[s[m]]=u);continue}var x=y.v;switch(y.t){case"z":if(x==null)break;continue;case"e":x=x==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+y.t)}if(s[m]!=null){if(x==null)if(y.t=="e"&&x===null)g[s[m]]=null;else if(u!==void 0)g[s[m]]=u;else if(f&&x===null)g[s[m]]=null;else continue;else g[s[m]]=f&&(y.t!=="n"||y.t==="n"&&o.rawNumbers!==!1)?x:ao(y,x,o);x!=null&&(p=!1)}}return{row:g,isempty:p}}function cp(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,s=[],a=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},u=e||{},f=u.range!=null?u.range:t["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof f){case"string":l=nr(f);break;case"number":l=nr(t["!ref"]),l.s.r=f;break;default:l=f}n>0&&(i=0);var p=un(l.s.r),g=[],m=[],y=0,x=0,S=Array.isArray(t),A=l.s.r,C=0,E={};S&&!t[A]&&(t[A]=[]);var O=u.skipHidden&&t["!cols"]||[],q=u.skipHidden&&t["!rows"]||[];for(C=l.s.c;C<=l.e.c;++C)if(!(O[C]||{}).hidden)switch(g[C]=Yr(C),r=S?t[A][C]:t[g[C]+p],n){case 1:s[C]=C-l.s.c;break;case 2:s[C]=g[C];break;case 3:s[C]=u.header[C-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=a=ao(r,null,u),x=E[a]||0,!x)E[a]=1;else{do o=a+"_"+x++;while(E[o]);E[a]=x,E[o]=1}s[C]=o}for(A=l.s.r+i;A<=l.e.r;++A)if(!(q[A]||{}).hidden){var H=SL(t,l,A,g,n,s,S,u);(H.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(m[y++]=H.row)}return m.length=y,m}var X_=/"/g;function wL(t,e,r,n,i,s,a,o){for(var l=!0,u=[],f="",p=un(r),g=e.s.c;g<=e.e.c;++g)if(n[g]){var m=o.dense?(t[r]||[])[g]:t[n[g]+p];if(m==null)f="";else if(m.v!=null){l=!1,f=""+(o.rawNumbers&&m.t=="n"?m.v:ao(m,null,o));for(var y=0,x=0;y!==f.length;++y)if((x=f.charCodeAt(y))===i||x===s||x===34||o.forceQuotes){f='"'+f.replace(X_,'""')+'"';break}f=="ID"&&(f='"ID"')}else m.f!=null&&!m.F?(l=!1,f="="+m.f,f.indexOf(",")>=0&&(f='"'+f.replace(X_,'""')+'"')):f="";u.push(f)}return o.blankrows===!1&&l?null:u.join(a)}function Tv(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var i=nr(t["!ref"]),s=n.FS!==void 0?n.FS:",",a=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),u=new RegExp((s=="|"?"\\|":s)+"+$"),f="",p=[];n.dense=Array.isArray(t);for(var g=n.skipHidden&&t["!cols"]||[],m=n.skipHidden&&t["!rows"]||[],y=i.s.c;y<=i.e.c;++y)(g[y]||{}).hidden||(p[y]=Yr(y));for(var x=0,S=i.s.r;S<=i.e.r;++S)(m[S]||{}).hidden||(f=wL(t,i,S,p,a,l,s,n),f!=null&&(n.strip&&(f=f.replace(u,"")),(f||n.blankrows!==!1)&&r.push((x++?o:"")+f)));return delete n.dense,r.join("")}function MC(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=Tv(t,e);return r}function TL(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var i=nr(t["!ref"]),s="",a=[],o,l=[],u=Array.isArray(t);for(o=i.s.c;o<=i.e.c;++o)a[o]=Yr(o);for(var f=i.s.r;f<=i.e.r;++f)for(s=un(f),o=i.s.c;o<=i.e.c;++o)if(e=a[o]+s,r=u?(t[f]||[])[o]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=e+"="+n}return l}function BC(t,e,r){var n=r||{},i=+!n.skipHeader,s=t||{},a=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?Xr(n.origin):n.origin;a=l.r,o=l.c}var u,f={s:{c:0,r:0},e:{c:o,r:a+e.length-1+i}};if(s["!ref"]){var p=nr(s["!ref"]);f.e.c=Math.max(f.e.c,p.e.c),f.e.r=Math.max(f.e.r,p.e.r),a==-1&&(a=p.e.r+1,f.e.r=a+e.length-1+i)}else a==-1&&(a=0,f.e.r=e.length-1+i);var g=n.header||[],m=0;e.forEach(function(x,S){sn(x).forEach(function(A){(m=g.indexOf(A))==-1&&(g[m=g.length]=A);var C=x[A],E="z",O="",q=gt({c:o+m,r:a+S+i});u=bf(s,q),C&&typeof C=="object"&&!(C instanceof Date)?s[q]=C:(typeof C=="number"?E="n":typeof C=="boolean"?E="b":typeof C=="string"?E="s":C instanceof Date?(E="d",n.cellDates||(E="n",C=Nn(C)),O=n.dateNF||pt[14]):C===null&&n.nullError&&(E="e",C=0),u?(u.t=E,u.v=C,delete u.w,delete u.R,O&&(u.z=O)):s[q]=u={t:E,v:C},O&&(u.z=O))})}),f.e.c=Math.max(f.e.c,o+g.length-1);var y=un(a);if(i)for(m=0;m<g.length;++m)s[Yr(m+o)+y]={t:"s",v:g[m]};return s["!ref"]=bt(f),s}function AL(t,e){return BC(null,t,e)}function bf(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=Xr(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?bf(t,gt(e)):bf(t,gt({r:e,c:r||0}))}function CL(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function Av(){return{SheetNames:[],Sheets:{}}}function Cv(t,e,r,n){var i=1;if(!r)for(;i<=65535&&t.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var a=s&&s[1]||r;for(++i;i<=65535&&t.SheetNames.indexOf(r=a+i)!=-1;++i);}if(_C(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function kL(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=CL(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function FL(t,e){return t.z=e,t}function jC(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function bL(t,e,r){return jC(t,"#"+e,r)}function IL(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function NL(t,e,r,n){for(var i=typeof e!="string"?e:nr(e),s=typeof e=="string"?e:bt(e),a=i.s.r;a<=i.e.r;++a)for(var o=i.s.c;o<=i.e.c;++o){var l=bf(t,a,o);l.t="n",l.F=s,delete l.v,a==i.s.r&&o==i.s.c&&(l.f=r,n&&(l.D=!0))}return t}var Er={encode_col:Yr,encode_row:un,encode_cell:gt,encode_range:bt,decode_col:tv,decode_row:ev,split_cell:zR,decode_cell:Xr,decode_range:Xi,format_cell:ao,sheet_add_aoa:dA,sheet_add_json:BC,sheet_add_dom:FC,aoa_to_sheet:ju,json_to_sheet:AL,table_to_sheet:bC,table_to_book:jj,sheet_to_csv:Tv,sheet_to_txt:MC,sheet_to_json:cp,sheet_to_html:kC,sheet_to_formulae:TL,sheet_to_row_object_array:cp,sheet_get_cell:bf,book_new:Av,book_append_sheet:Cv,book_set_sheet_visibility:kL,cell_set_number_format:FL,cell_set_hyperlink:jC,cell_set_internal_link:bL,cell_add_comment:IL,sheet_set_array_formula:NL,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var RL={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DL=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Nt=(t,e)=>{const r=ye.forwardRef(({color:n="currentColor",size:i=24,strokeWidth:s=2,absoluteStrokeWidth:a,className:o="",children:l,...u},f)=>ye.createElement("svg",{ref:f,...RL,width:i,height:i,stroke:n,strokeWidth:a?Number(s)*24/Number(i):s,className:["lucide",`lucide-${DL(t)}`,o].join(" "),...u},[...e.map(([p,g])=>ye.createElement(p,g)),...Array.isArray(l)?l:[l]]));return r.displayName=`${t}`,r};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q_=Nt("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q_=Nt("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PL=Nt("BellRing",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}],["path",{d:"M4 2C2.8 3.7 2 5.7 2 8",key:"tap9e0"}],["path",{d:"M22 8c0-2.3-.8-4.3-2-6",key:"5bb3ad"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J_=Nt("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z_=Nt("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OL=Nt("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eE=Nt("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tE=Nt("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nm=Nt("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ML=Nt("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K0=Nt("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const im=Nt("Clipboard",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BL=Nt("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Po=Nt("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jL=Nt("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oc=Nt("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pd=Nt("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gd=Nt("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sm=Nt("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rE=Nt("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y0=Nt("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X0=Nt("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LL=Nt("Merge",[["path",{d:"m8 6 4-4 4 4",key:"ybng9g"}],["path",{d:"M12 2v10.3a4 4 0 0 1-1.172 2.872L4 22",key:"1hyw0i"}],["path",{d:"m20 22-5-5",key:"1m27yz"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UL=Nt("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q0=Nt("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const am=Nt("PlusCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const md=Nt("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nE=Nt("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oo=Nt("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1-2-1Z",key:"wqdwcb"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17V7",key:"pyj7ub"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VL=Nt("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zL=Nt("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q0=Nt("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iE=Nt("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WL=Nt("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sE=Nt("Table",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $L=Nt("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2h0a3.13 3.13 0 0 1 3 3.88Z",key:"y3tblf"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rs=Nt("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ys=Nt("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aE=Nt("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wa=Nt("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);var oE={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LC=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=i&63|128):(i&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=i&63|128):(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=i&63|128)}return e},HL=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const i=t[r++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[r++];e[n++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[r++],a=t[r++],o=t[r++],l=((i&7)<<18|(s&63)<<12|(a&63)<<6|o&63)-65536;e[n++]=String.fromCharCode(55296+(l>>10)),e[n++]=String.fromCharCode(56320+(l&1023))}else{const s=t[r++],a=t[r++];e[n++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},UC={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<t.length;i+=3){const s=t[i],a=i+1<t.length,o=a?t[i+1]:0,l=i+2<t.length,u=l?t[i+2]:0,f=s>>2,p=(s&3)<<4|o>>4;let g=(o&15)<<2|u>>6,m=u&63;l||(m=64,a||(g=64)),n.push(r[f],r[p],r[g],r[m])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(LC(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):HL(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<t.length;){const s=r[t.charAt(i++)],o=i<t.length?r[t.charAt(i)]:0;++i;const u=i<t.length?r[t.charAt(i)]:64;++i;const p=i<t.length?r[t.charAt(i)]:64;if(++i,s==null||o==null||u==null||p==null)throw new GL;const g=s<<2|o>>4;if(n.push(g),u!==64){const m=o<<4&240|u>>2;if(n.push(m),p!==64){const y=u<<6&192|p;n.push(y)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class GL extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const KL=function(t){const e=LC(t);return UC.encodeByteArray(e,!0)},up=function(t){return KL(t).replace(/\./g,"")},VC=function(t){try{return UC.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YL(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XL=()=>YL().__FIREBASE_DEFAULTS__,qL=()=>{if(typeof process>"u"||typeof oE>"u")return;const t=oE.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},QL=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&VC(t[1]);return e&&JSON.parse(e)},Jp=()=>{try{return XL()||qL()||QL()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},zC=t=>{var e,r;return(r=(e=Jp())===null||e===void 0?void 0:e.emulatorHosts)===null||r===void 0?void 0:r[t]},JL=t=>{const e=zC(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},WC=()=>{var t;return(t=Jp())===null||t===void 0?void 0:t.config},$C=t=>{var e;return(e=Jp())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZL{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e9(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t);return[up(JSON.stringify(r)),up(JSON.stringify(a)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _i(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function t9(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(_i())}function r9(){var t;const e=(t=Jp())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function n9(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function i9(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function s9(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function a9(){const t=_i();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function o9(){return!r9()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function l9(){try{return typeof indexedDB=="object"}catch{return!1}}function c9(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u9="FirebaseError";class xo extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=u9,Object.setPrototypeOf(this,xo.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Zf.prototype.create)}}class Zf{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?d9(s,n):"Error",o=`${this.serviceName}: ${a} (${i}).`;return new xo(i,o,n)}}function d9(t,e){return t.replace(f9,(r,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const f9=/\{\$([^}]+)}/g;function h9(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function dp(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const i of r){if(!n.includes(i))return!1;const s=t[i],a=e[i];if(lE(s)&&lE(a)){if(!dp(s,a))return!1}else if(s!==a)return!1}for(const i of n)if(!r.includes(i))return!1;return!0}function lE(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e0(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function p9(t,e){const r=new g9(t,e);return r.subscribe.bind(r)}class g9{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let i;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");m9(e,["next","error","complete"])?i=e:i={next:e,error:r,complete:n},i.next===void 0&&(i.next=om),i.error===void 0&&(i.error=om),i.complete===void 0&&(i.complete=om);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function m9(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function om(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aa(t){return t&&t._delegate?t._delegate:t}class sc{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rl="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x9{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new ZL;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:r});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){var r;const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(r=e==null?void 0:e.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(y9(e))try{this.getOrInitializeService({instanceIdentifier:Rl})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(r);try{const s=this.getOrInitializeService({instanceIdentifier:i});n.resolve(s)}catch{}}}}clearInstance(e=Rl){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Rl){return this.instances.has(e)}getOptions(e=Rl){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[s,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(s);n===o&&a.resolve(i)}return i}onInit(e,r){var n;const i=this.normalizeInstanceIdentifier(r),s=(n=this.onInitCallbacks.get(i))!==null&&n!==void 0?n:new Set;s.add(e),this.onInitCallbacks.set(i,s);const a=this.instances.get(i);return a&&e(a,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const i of n)try{i(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:v9(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=Rl){return this.component?this.component.multipleInstances?e:Rl:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function v9(t){return t===Rl?void 0:t}function y9(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _9{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new x9(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ht;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Ht||(Ht={}));const E9={debug:Ht.DEBUG,verbose:Ht.VERBOSE,info:Ht.INFO,warn:Ht.WARN,error:Ht.ERROR,silent:Ht.SILENT},S9=Ht.INFO,w9={[Ht.DEBUG]:"log",[Ht.VERBOSE]:"log",[Ht.INFO]:"info",[Ht.WARN]:"warn",[Ht.ERROR]:"error"},T9=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),i=w9[e];if(i)console[i](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class kv{constructor(e){this.name=e,this._logLevel=S9,this._logHandler=T9,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ht))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?E9[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ht.DEBUG,...e),this._logHandler(this,Ht.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ht.VERBOSE,...e),this._logHandler(this,Ht.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ht.INFO,...e),this._logHandler(this,Ht.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ht.WARN,...e),this._logHandler(this,Ht.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ht.ERROR,...e),this._logHandler(this,Ht.ERROR,...e)}}const A9=(t,e)=>e.some(r=>t instanceof r);let cE,uE;function C9(){return cE||(cE=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function k9(){return uE||(uE=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const HC=new WeakMap,wx=new WeakMap,GC=new WeakMap,lm=new WeakMap,Fv=new WeakMap;function F9(t){const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",a)},s=()=>{r(sl(t.result)),i()},a=()=>{n(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",a)});return e.then(r=>{r instanceof IDBCursor&&HC.set(r,t)}).catch(()=>{}),Fv.set(e,t),e}function b9(t){if(wx.has(t))return;const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",a),t.removeEventListener("abort",a)},s=()=>{r(),i()},a=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",a),t.addEventListener("abort",a)});wx.set(t,e)}let Tx={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return wx.get(t);if(e==="objectStoreNames")return t.objectStoreNames||GC.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return sl(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function I9(t){Tx=t(Tx)}function N9(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(cm(this),e,...r);return GC.set(n,e.sort?e.sort():[e]),sl(n)}:k9().includes(t)?function(...e){return t.apply(cm(this),e),sl(HC.get(this))}:function(...e){return sl(t.apply(cm(this),e))}}function R9(t){return typeof t=="function"?N9(t):(t instanceof IDBTransaction&&b9(t),A9(t,C9())?new Proxy(t,Tx):t)}function sl(t){if(t instanceof IDBRequest)return F9(t);if(lm.has(t))return lm.get(t);const e=R9(t);return e!==t&&(lm.set(t,e),Fv.set(e,t)),e}const cm=t=>Fv.get(t);function D9(t,e,{blocked:r,upgrade:n,blocking:i,terminated:s}={}){const a=indexedDB.open(t,e),o=sl(a);return n&&a.addEventListener("upgradeneeded",l=>{n(sl(a.result),l.oldVersion,l.newVersion,sl(a.transaction),l)}),r&&a.addEventListener("blocked",l=>r(l.oldVersion,l.newVersion,l)),o.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),o}const P9=["get","getKey","getAll","getAllKeys","count"],O9=["put","add","delete","clear"],um=new Map;function dE(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(um.get(e))return um.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,i=O9.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||P9.includes(r)))return;const s=async function(a,...o){const l=this.transaction(a,i?"readwrite":"readonly");let u=l.store;return n&&(u=u.index(o.shift())),(await Promise.all([u[r](...o),i&&l.done]))[0]};return um.set(e,s),s}I9(t=>({...t,get:(e,r,n)=>dE(e,r)||t.get(e,r,n),has:(e,r)=>!!dE(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M9{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(B9(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function B9(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Ax="@firebase/app",fE="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oo=new kv("@firebase/app"),j9="@firebase/app-compat",L9="@firebase/analytics-compat",U9="@firebase/analytics",V9="@firebase/app-check-compat",z9="@firebase/app-check",W9="@firebase/auth",$9="@firebase/auth-compat",H9="@firebase/database",G9="@firebase/data-connect",K9="@firebase/database-compat",Y9="@firebase/functions",X9="@firebase/functions-compat",q9="@firebase/installations",Q9="@firebase/installations-compat",J9="@firebase/messaging",Z9="@firebase/messaging-compat",e7="@firebase/performance",t7="@firebase/performance-compat",r7="@firebase/remote-config",n7="@firebase/remote-config-compat",i7="@firebase/storage",s7="@firebase/storage-compat",a7="@firebase/firestore",o7="@firebase/vertexai-preview",l7="@firebase/firestore-compat",c7="firebase",u7="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cx="[DEFAULT]",d7={[Ax]:"fire-core",[j9]:"fire-core-compat",[U9]:"fire-analytics",[L9]:"fire-analytics-compat",[z9]:"fire-app-check",[V9]:"fire-app-check-compat",[W9]:"fire-auth",[$9]:"fire-auth-compat",[H9]:"fire-rtdb",[G9]:"fire-data-connect",[K9]:"fire-rtdb-compat",[Y9]:"fire-fn",[X9]:"fire-fn-compat",[q9]:"fire-iid",[Q9]:"fire-iid-compat",[J9]:"fire-fcm",[Z9]:"fire-fcm-compat",[e7]:"fire-perf",[t7]:"fire-perf-compat",[r7]:"fire-rc",[n7]:"fire-rc-compat",[i7]:"fire-gcs",[s7]:"fire-gcs-compat",[a7]:"fire-fst",[l7]:"fire-fst-compat",[o7]:"fire-vertex","fire-js":"fire-js",[c7]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fp=new Map,f7=new Map,kx=new Map;function hE(t,e){try{t.container.addComponent(e)}catch(r){oo.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function Tu(t){const e=t.name;if(kx.has(e))return oo.debug(`There were multiple attempts to register component ${e}.`),!1;kx.set(e,t);for(const r of fp.values())hE(r,t);for(const r of f7.values())hE(r,t);return!0}function bv(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function Xo(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h7={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},al=new Zf("app","Firebase",h7);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p7{constructor(e,r,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new sc("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw al.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uu=u7;function KC(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n=Object.assign({name:Cx,automaticDataCollectionEnabled:!1},e),i=n.name;if(typeof i!="string"||!i)throw al.create("bad-app-name",{appName:String(i)});if(r||(r=WC()),!r)throw al.create("no-options");const s=fp.get(i);if(s){if(dp(r,s.options)&&dp(n,s.config))return s;throw al.create("duplicate-app",{appName:i})}const a=new _9(i);for(const l of kx.values())a.addComponent(l);const o=new p7(r,n,a);return fp.set(i,o),o}function YC(t=Cx){const e=fp.get(t);if(!e&&t===Cx&&WC())return KC();if(!e)throw al.create("no-app",{appName:t});return e}function ol(t,e,r){var n;let i=(n=d7[t])!==null&&n!==void 0?n:t;r&&(i+=`-${r}`);const s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){const o=[`Unable to register library "${i}" with version "${e}":`];s&&o.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&a&&o.push("and"),a&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),oo.warn(o.join(" "));return}Tu(new sc(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g7="firebase-heartbeat-database",m7=1,If="firebase-heartbeat-store";let dm=null;function XC(){return dm||(dm=D9(g7,m7,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(If)}catch(r){console.warn(r)}}}}).catch(t=>{throw al.create("idb-open",{originalErrorMessage:t.message})})),dm}async function x7(t){try{const r=(await XC()).transaction(If),n=await r.objectStore(If).get(qC(t));return await r.done,n}catch(e){if(e instanceof xo)oo.warn(e.message);else{const r=al.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});oo.warn(r.message)}}}async function pE(t,e){try{const n=(await XC()).transaction(If,"readwrite");await n.objectStore(If).put(e,qC(t)),await n.done}catch(r){if(r instanceof xo)oo.warn(r.message);else{const n=al.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});oo.warn(n.message)}}}function qC(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v7=1024,y7=30*24*60*60*1e3;class _7{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new S7(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=gE();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(a=>a.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const o=new Date(a.date).valueOf();return Date.now()-o<=y7}),this._storage.overwrite(this._heartbeatsCache))}catch(n){oo.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=gE(),{heartbeatsToSend:n,unsentEntries:i}=E7(this._heartbeatsCache.heartbeats),s=up(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(r){return oo.warn(r),""}}}function gE(){return new Date().toISOString().substring(0,10)}function E7(t,e=v7){const r=[];let n=t.slice();for(const i of t){const s=r.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),mE(r)>e){s.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),mE(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class S7{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return l9()?c9().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await x7(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return pE(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return pE(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function mE(t){return up(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w7(t){Tu(new sc("platform-logger",e=>new M9(e),"PRIVATE")),Tu(new sc("heartbeat",e=>new _7(e),"PRIVATE")),ol(Ax,fE,t),ol(Ax,fE,"esm2017"),ol("fire-js","")}w7("");var T7="firebase",A7="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ol(T7,A7,"app");var xE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Gl,QC;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(T,F){function w(){}w.prototype=F.prototype,T.D=F.prototype,T.prototype=new w,T.prototype.constructor=T,T.C=function(N,D,P){for(var R=Array(arguments.length-2),qe=2;qe<arguments.length;qe++)R[qe-2]=arguments[qe];return F.prototype[D].apply(N,R)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(T,F,w){w||(w=0);var N=Array(16);if(typeof F=="string")for(var D=0;16>D;++D)N[D]=F.charCodeAt(w++)|F.charCodeAt(w++)<<8|F.charCodeAt(w++)<<16|F.charCodeAt(w++)<<24;else for(D=0;16>D;++D)N[D]=F[w++]|F[w++]<<8|F[w++]<<16|F[w++]<<24;F=T.g[0],w=T.g[1],D=T.g[2];var P=T.g[3],R=F+(P^w&(D^P))+N[0]+3614090360&4294967295;F=w+(R<<7&4294967295|R>>>25),R=P+(D^F&(w^D))+N[1]+3905402710&4294967295,P=F+(R<<12&4294967295|R>>>20),R=D+(w^P&(F^w))+N[2]+606105819&4294967295,D=P+(R<<17&4294967295|R>>>15),R=w+(F^D&(P^F))+N[3]+3250441966&4294967295,w=D+(R<<22&4294967295|R>>>10),R=F+(P^w&(D^P))+N[4]+4118548399&4294967295,F=w+(R<<7&4294967295|R>>>25),R=P+(D^F&(w^D))+N[5]+1200080426&4294967295,P=F+(R<<12&4294967295|R>>>20),R=D+(w^P&(F^w))+N[6]+2821735955&4294967295,D=P+(R<<17&4294967295|R>>>15),R=w+(F^D&(P^F))+N[7]+4249261313&4294967295,w=D+(R<<22&4294967295|R>>>10),R=F+(P^w&(D^P))+N[8]+1770035416&4294967295,F=w+(R<<7&4294967295|R>>>25),R=P+(D^F&(w^D))+N[9]+2336552879&4294967295,P=F+(R<<12&4294967295|R>>>20),R=D+(w^P&(F^w))+N[10]+4294925233&4294967295,D=P+(R<<17&4294967295|R>>>15),R=w+(F^D&(P^F))+N[11]+2304563134&4294967295,w=D+(R<<22&4294967295|R>>>10),R=F+(P^w&(D^P))+N[12]+1804603682&4294967295,F=w+(R<<7&4294967295|R>>>25),R=P+(D^F&(w^D))+N[13]+4254626195&4294967295,P=F+(R<<12&4294967295|R>>>20),R=D+(w^P&(F^w))+N[14]+2792965006&4294967295,D=P+(R<<17&4294967295|R>>>15),R=w+(F^D&(P^F))+N[15]+1236535329&4294967295,w=D+(R<<22&4294967295|R>>>10),R=F+(D^P&(w^D))+N[1]+4129170786&4294967295,F=w+(R<<5&4294967295|R>>>27),R=P+(w^D&(F^w))+N[6]+3225465664&4294967295,P=F+(R<<9&4294967295|R>>>23),R=D+(F^w&(P^F))+N[11]+643717713&4294967295,D=P+(R<<14&4294967295|R>>>18),R=w+(P^F&(D^P))+N[0]+3921069994&4294967295,w=D+(R<<20&4294967295|R>>>12),R=F+(D^P&(w^D))+N[5]+3593408605&4294967295,F=w+(R<<5&4294967295|R>>>27),R=P+(w^D&(F^w))+N[10]+38016083&4294967295,P=F+(R<<9&4294967295|R>>>23),R=D+(F^w&(P^F))+N[15]+3634488961&4294967295,D=P+(R<<14&4294967295|R>>>18),R=w+(P^F&(D^P))+N[4]+3889429448&4294967295,w=D+(R<<20&4294967295|R>>>12),R=F+(D^P&(w^D))+N[9]+568446438&4294967295,F=w+(R<<5&4294967295|R>>>27),R=P+(w^D&(F^w))+N[14]+3275163606&4294967295,P=F+(R<<9&4294967295|R>>>23),R=D+(F^w&(P^F))+N[3]+4107603335&4294967295,D=P+(R<<14&4294967295|R>>>18),R=w+(P^F&(D^P))+N[8]+1163531501&4294967295,w=D+(R<<20&4294967295|R>>>12),R=F+(D^P&(w^D))+N[13]+2850285829&4294967295,F=w+(R<<5&4294967295|R>>>27),R=P+(w^D&(F^w))+N[2]+4243563512&4294967295,P=F+(R<<9&4294967295|R>>>23),R=D+(F^w&(P^F))+N[7]+1735328473&4294967295,D=P+(R<<14&4294967295|R>>>18),R=w+(P^F&(D^P))+N[12]+2368359562&4294967295,w=D+(R<<20&4294967295|R>>>12),R=F+(w^D^P)+N[5]+4294588738&4294967295,F=w+(R<<4&4294967295|R>>>28),R=P+(F^w^D)+N[8]+2272392833&4294967295,P=F+(R<<11&4294967295|R>>>21),R=D+(P^F^w)+N[11]+1839030562&4294967295,D=P+(R<<16&4294967295|R>>>16),R=w+(D^P^F)+N[14]+4259657740&4294967295,w=D+(R<<23&4294967295|R>>>9),R=F+(w^D^P)+N[1]+2763975236&4294967295,F=w+(R<<4&4294967295|R>>>28),R=P+(F^w^D)+N[4]+1272893353&4294967295,P=F+(R<<11&4294967295|R>>>21),R=D+(P^F^w)+N[7]+4139469664&4294967295,D=P+(R<<16&4294967295|R>>>16),R=w+(D^P^F)+N[10]+3200236656&4294967295,w=D+(R<<23&4294967295|R>>>9),R=F+(w^D^P)+N[13]+681279174&4294967295,F=w+(R<<4&4294967295|R>>>28),R=P+(F^w^D)+N[0]+3936430074&4294967295,P=F+(R<<11&4294967295|R>>>21),R=D+(P^F^w)+N[3]+3572445317&4294967295,D=P+(R<<16&4294967295|R>>>16),R=w+(D^P^F)+N[6]+76029189&4294967295,w=D+(R<<23&4294967295|R>>>9),R=F+(w^D^P)+N[9]+3654602809&4294967295,F=w+(R<<4&4294967295|R>>>28),R=P+(F^w^D)+N[12]+3873151461&4294967295,P=F+(R<<11&4294967295|R>>>21),R=D+(P^F^w)+N[15]+530742520&4294967295,D=P+(R<<16&4294967295|R>>>16),R=w+(D^P^F)+N[2]+3299628645&4294967295,w=D+(R<<23&4294967295|R>>>9),R=F+(D^(w|~P))+N[0]+4096336452&4294967295,F=w+(R<<6&4294967295|R>>>26),R=P+(w^(F|~D))+N[7]+1126891415&4294967295,P=F+(R<<10&4294967295|R>>>22),R=D+(F^(P|~w))+N[14]+2878612391&4294967295,D=P+(R<<15&4294967295|R>>>17),R=w+(P^(D|~F))+N[5]+4237533241&4294967295,w=D+(R<<21&4294967295|R>>>11),R=F+(D^(w|~P))+N[12]+1700485571&4294967295,F=w+(R<<6&4294967295|R>>>26),R=P+(w^(F|~D))+N[3]+2399980690&4294967295,P=F+(R<<10&4294967295|R>>>22),R=D+(F^(P|~w))+N[10]+4293915773&4294967295,D=P+(R<<15&4294967295|R>>>17),R=w+(P^(D|~F))+N[1]+2240044497&4294967295,w=D+(R<<21&4294967295|R>>>11),R=F+(D^(w|~P))+N[8]+1873313359&4294967295,F=w+(R<<6&4294967295|R>>>26),R=P+(w^(F|~D))+N[15]+4264355552&4294967295,P=F+(R<<10&4294967295|R>>>22),R=D+(F^(P|~w))+N[6]+2734768916&4294967295,D=P+(R<<15&4294967295|R>>>17),R=w+(P^(D|~F))+N[13]+1309151649&4294967295,w=D+(R<<21&4294967295|R>>>11),R=F+(D^(w|~P))+N[4]+4149444226&4294967295,F=w+(R<<6&4294967295|R>>>26),R=P+(w^(F|~D))+N[11]+3174756917&4294967295,P=F+(R<<10&4294967295|R>>>22),R=D+(F^(P|~w))+N[2]+718787259&4294967295,D=P+(R<<15&4294967295|R>>>17),R=w+(P^(D|~F))+N[9]+3951481745&4294967295,T.g[0]=T.g[0]+F&4294967295,T.g[1]=T.g[1]+(D+(R<<21&4294967295|R>>>11))&4294967295,T.g[2]=T.g[2]+D&4294967295,T.g[3]=T.g[3]+P&4294967295}n.prototype.u=function(T,F){F===void 0&&(F=T.length);for(var w=F-this.blockSize,N=this.B,D=this.h,P=0;P<F;){if(D==0)for(;P<=w;)i(this,T,P),P+=this.blockSize;if(typeof T=="string"){for(;P<F;)if(N[D++]=T.charCodeAt(P++),D==this.blockSize){i(this,N),D=0;break}}else for(;P<F;)if(N[D++]=T[P++],D==this.blockSize){i(this,N),D=0;break}}this.h=D,this.o+=F},n.prototype.v=function(){var T=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);T[0]=128;for(var F=1;F<T.length-8;++F)T[F]=0;var w=8*this.o;for(F=T.length-8;F<T.length;++F)T[F]=w&255,w/=256;for(this.u(T),T=Array(16),F=w=0;4>F;++F)for(var N=0;32>N;N+=8)T[w++]=this.g[F]>>>N&255;return T};function s(T,F){var w=o;return Object.prototype.hasOwnProperty.call(w,T)?w[T]:w[T]=F(T)}function a(T,F){this.h=F;for(var w=[],N=!0,D=T.length-1;0<=D;D--){var P=T[D]|0;N&&P==F||(w[D]=P,N=!1)}this.g=w}var o={};function l(T){return-128<=T&&128>T?s(T,function(F){return new a([F|0],0>F?-1:0)}):new a([T|0],0>T?-1:0)}function u(T){if(isNaN(T)||!isFinite(T))return p;if(0>T)return S(u(-T));for(var F=[],w=1,N=0;T>=w;N++)F[N]=T/w|0,w*=4294967296;return new a(F,0)}function f(T,F){if(T.length==0)throw Error("number format error: empty string");if(F=F||10,2>F||36<F)throw Error("radix out of range: "+F);if(T.charAt(0)=="-")return S(f(T.substring(1),F));if(0<=T.indexOf("-"))throw Error('number format error: interior "-" character');for(var w=u(Math.pow(F,8)),N=p,D=0;D<T.length;D+=8){var P=Math.min(8,T.length-D),R=parseInt(T.substring(D,D+P),F);8>P?(P=u(Math.pow(F,P)),N=N.j(P).add(u(R))):(N=N.j(w),N=N.add(u(R)))}return N}var p=l(0),g=l(1),m=l(16777216);t=a.prototype,t.m=function(){if(x(this))return-S(this).m();for(var T=0,F=1,w=0;w<this.g.length;w++){var N=this.i(w);T+=(0<=N?N:4294967296+N)*F,F*=4294967296}return T},t.toString=function(T){if(T=T||10,2>T||36<T)throw Error("radix out of range: "+T);if(y(this))return"0";if(x(this))return"-"+S(this).toString(T);for(var F=u(Math.pow(T,6)),w=this,N="";;){var D=O(w,F).g;w=A(w,D.j(F));var P=((0<w.g.length?w.g[0]:w.h)>>>0).toString(T);if(w=D,y(w))return P+N;for(;6>P.length;)P="0"+P;N=P+N}},t.i=function(T){return 0>T?0:T<this.g.length?this.g[T]:this.h};function y(T){if(T.h!=0)return!1;for(var F=0;F<T.g.length;F++)if(T.g[F]!=0)return!1;return!0}function x(T){return T.h==-1}t.l=function(T){return T=A(this,T),x(T)?-1:y(T)?0:1};function S(T){for(var F=T.g.length,w=[],N=0;N<F;N++)w[N]=~T.g[N];return new a(w,~T.h).add(g)}t.abs=function(){return x(this)?S(this):this},t.add=function(T){for(var F=Math.max(this.g.length,T.g.length),w=[],N=0,D=0;D<=F;D++){var P=N+(this.i(D)&65535)+(T.i(D)&65535),R=(P>>>16)+(this.i(D)>>>16)+(T.i(D)>>>16);N=R>>>16,P&=65535,R&=65535,w[D]=R<<16|P}return new a(w,w[w.length-1]&-2147483648?-1:0)};function A(T,F){return T.add(S(F))}t.j=function(T){if(y(this)||y(T))return p;if(x(this))return x(T)?S(this).j(S(T)):S(S(this).j(T));if(x(T))return S(this.j(S(T)));if(0>this.l(m)&&0>T.l(m))return u(this.m()*T.m());for(var F=this.g.length+T.g.length,w=[],N=0;N<2*F;N++)w[N]=0;for(N=0;N<this.g.length;N++)for(var D=0;D<T.g.length;D++){var P=this.i(N)>>>16,R=this.i(N)&65535,qe=T.i(D)>>>16,Se=T.i(D)&65535;w[2*N+2*D]+=R*Se,C(w,2*N+2*D),w[2*N+2*D+1]+=P*Se,C(w,2*N+2*D+1),w[2*N+2*D+1]+=R*qe,C(w,2*N+2*D+1),w[2*N+2*D+2]+=P*qe,C(w,2*N+2*D+2)}for(N=0;N<F;N++)w[N]=w[2*N+1]<<16|w[2*N];for(N=F;N<2*F;N++)w[N]=0;return new a(w,0)};function C(T,F){for(;(T[F]&65535)!=T[F];)T[F+1]+=T[F]>>>16,T[F]&=65535,F++}function E(T,F){this.g=T,this.h=F}function O(T,F){if(y(F))throw Error("division by zero");if(y(T))return new E(p,p);if(x(T))return F=O(S(T),F),new E(S(F.g),S(F.h));if(x(F))return F=O(T,S(F)),new E(S(F.g),F.h);if(30<T.g.length){if(x(T)||x(F))throw Error("slowDivide_ only works with positive integers.");for(var w=g,N=F;0>=N.l(T);)w=q(w),N=q(N);var D=H(w,1),P=H(N,1);for(N=H(N,2),w=H(w,2);!y(N);){var R=P.add(N);0>=R.l(T)&&(D=D.add(w),P=R),N=H(N,1),w=H(w,1)}return F=A(T,D.j(F)),new E(D,F)}for(D=p;0<=T.l(F);){for(w=Math.max(1,Math.floor(T.m()/F.m())),N=Math.ceil(Math.log(w)/Math.LN2),N=48>=N?1:Math.pow(2,N-48),P=u(w),R=P.j(F);x(R)||0<R.l(T);)w-=N,P=u(w),R=P.j(F);y(P)&&(P=g),D=D.add(P),T=A(T,R)}return new E(D,T)}t.A=function(T){return O(this,T).h},t.and=function(T){for(var F=Math.max(this.g.length,T.g.length),w=[],N=0;N<F;N++)w[N]=this.i(N)&T.i(N);return new a(w,this.h&T.h)},t.or=function(T){for(var F=Math.max(this.g.length,T.g.length),w=[],N=0;N<F;N++)w[N]=this.i(N)|T.i(N);return new a(w,this.h|T.h)},t.xor=function(T){for(var F=Math.max(this.g.length,T.g.length),w=[],N=0;N<F;N++)w[N]=this.i(N)^T.i(N);return new a(w,this.h^T.h)};function q(T){for(var F=T.g.length+1,w=[],N=0;N<F;N++)w[N]=T.i(N)<<1|T.i(N-1)>>>31;return new a(w,T.h)}function H(T,F){var w=F>>5;F%=32;for(var N=T.g.length-w,D=[],P=0;P<N;P++)D[P]=0<F?T.i(P+w)>>>F|T.i(P+w+1)<<32-F:T.i(P+w);return new a(D,T.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,QC=n,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=u,a.fromString=f,Gl=a}).apply(typeof xE<"u"?xE:typeof self<"u"?self:typeof window<"u"?window:{});var J0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var JC,Cd,ZC,vh,Fx,ek,tk,rk;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(d,v,k){return d==Array.prototype||d==Object.prototype||(d[v]=k.value),d};function r(d){d=[typeof globalThis=="object"&&globalThis,d,typeof window=="object"&&window,typeof self=="object"&&self,typeof J0=="object"&&J0];for(var v=0;v<d.length;++v){var k=d[v];if(k&&k.Math==Math)return k}throw Error("Cannot find global object")}var n=r(this);function i(d,v){if(v)e:{var k=n;d=d.split(".");for(var M=0;M<d.length-1;M++){var ue=d[M];if(!(ue in k))break e;k=k[ue]}d=d[d.length-1],M=k[d],v=v(M),v!=M&&v!=null&&e(k,d,{configurable:!0,writable:!0,value:v})}}function s(d,v){d instanceof String&&(d+="");var k=0,M=!1,ue={next:function(){if(!M&&k<d.length){var xe=k++;return{value:v(xe,d[xe]),done:!1}}return M=!0,{done:!0,value:void 0}}};return ue[Symbol.iterator]=function(){return ue},ue}i("Array.prototype.values",function(d){return d||function(){return s(this,function(v,k){return k})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},o=this||self;function l(d){var v=typeof d;return v=v!="object"?v:d?Array.isArray(d)?"array":v:"null",v=="array"||v=="object"&&typeof d.length=="number"}function u(d){var v=typeof d;return v=="object"&&d!=null||v=="function"}function f(d,v,k){return d.call.apply(d.bind,arguments)}function p(d,v,k){if(!d)throw Error();if(2<arguments.length){var M=Array.prototype.slice.call(arguments,2);return function(){var ue=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(ue,M),d.apply(v,ue)}}return function(){return d.apply(v,arguments)}}function g(d,v,k){return g=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?f:p,g.apply(null,arguments)}function m(d,v){var k=Array.prototype.slice.call(arguments,1);return function(){var M=k.slice();return M.push.apply(M,arguments),d.apply(this,M)}}function y(d,v){function k(){}k.prototype=v.prototype,d.aa=v.prototype,d.prototype=new k,d.prototype.constructor=d,d.Qb=function(M,ue,xe){for(var He=Array(arguments.length-2),Jt=2;Jt<arguments.length;Jt++)He[Jt-2]=arguments[Jt];return v.prototype[ue].apply(M,He)}}function x(d){const v=d.length;if(0<v){const k=Array(v);for(let M=0;M<v;M++)k[M]=d[M];return k}return[]}function S(d,v){for(let k=1;k<arguments.length;k++){const M=arguments[k];if(l(M)){const ue=d.length||0,xe=M.length||0;d.length=ue+xe;for(let He=0;He<xe;He++)d[ue+He]=M[He]}else d.push(M)}}class A{constructor(v,k){this.i=v,this.j=k,this.h=0,this.g=null}get(){let v;return 0<this.h?(this.h--,v=this.g,this.g=v.next,v.next=null):v=this.i(),v}}function C(d){return/^[\s\xa0]*$/.test(d)}function E(){var d=o.navigator;return d&&(d=d.userAgent)?d:""}function O(d){return O[" "](d),d}O[" "]=function(){};var q=E().indexOf("Gecko")!=-1&&!(E().toLowerCase().indexOf("webkit")!=-1&&E().indexOf("Edge")==-1)&&!(E().indexOf("Trident")!=-1||E().indexOf("MSIE")!=-1)&&E().indexOf("Edge")==-1;function H(d,v,k){for(const M in d)v.call(k,d[M],M,d)}function T(d,v){for(const k in d)v.call(void 0,d[k],k,d)}function F(d){const v={};for(const k in d)v[k]=d[k];return v}const w="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function N(d,v){let k,M;for(let ue=1;ue<arguments.length;ue++){M=arguments[ue];for(k in M)d[k]=M[k];for(let xe=0;xe<w.length;xe++)k=w[xe],Object.prototype.hasOwnProperty.call(M,k)&&(d[k]=M[k])}}function D(d){var v=1;d=d.split(":");const k=[];for(;0<v&&d.length;)k.push(d.shift()),v--;return d.length&&k.push(d.join(":")),k}function P(d){o.setTimeout(()=>{throw d},0)}function R(){var d=ne;let v=null;return d.g&&(v=d.g,d.g=d.g.next,d.g||(d.h=null),v.next=null),v}class qe{constructor(){this.h=this.g=null}add(v,k){const M=Se.get();M.set(v,k),this.h?this.h.next=M:this.g=M,this.h=M}}var Se=new A(()=>new Oe,d=>d.reset());class Oe{constructor(){this.next=this.g=this.h=null}set(v,k){this.h=v,this.g=k,this.next=null}reset(){this.next=this.g=this.h=null}}let be,ke=!1,ne=new qe,Ie=()=>{const d=o.Promise.resolve(void 0);be=()=>{d.then(je)}};var je=()=>{for(var d;d=R();){try{d.h.call(d.g)}catch(k){P(k)}var v=Se;v.j(d),100>v.h&&(v.h++,d.next=v.g,v.g=d)}ke=!1};function K(){this.s=this.s,this.C=this.C}K.prototype.s=!1,K.prototype.ma=function(){this.s||(this.s=!0,this.N())},K.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function te(d,v){this.type=d,this.g=this.target=v,this.defaultPrevented=!1}te.prototype.h=function(){this.defaultPrevented=!0};var re=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var d=!1,v=Object.defineProperty({},"passive",{get:function(){d=!0}});try{const k=()=>{};o.addEventListener("test",k,v),o.removeEventListener("test",k,v)}catch{}return d}();function X(d,v){if(te.call(this,d?d.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,d){var k=this.type=d.type,M=d.changedTouches&&d.changedTouches.length?d.changedTouches[0]:null;if(this.target=d.target||d.srcElement,this.g=v,v=d.relatedTarget){if(q){e:{try{O(v.nodeName);var ue=!0;break e}catch{}ue=!1}ue||(v=null)}}else k=="mouseover"?v=d.fromElement:k=="mouseout"&&(v=d.toElement);this.relatedTarget=v,M?(this.clientX=M.clientX!==void 0?M.clientX:M.pageX,this.clientY=M.clientY!==void 0?M.clientY:M.pageY,this.screenX=M.screenX||0,this.screenY=M.screenY||0):(this.clientX=d.clientX!==void 0?d.clientX:d.pageX,this.clientY=d.clientY!==void 0?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0),this.button=d.button,this.key=d.key||"",this.ctrlKey=d.ctrlKey,this.altKey=d.altKey,this.shiftKey=d.shiftKey,this.metaKey=d.metaKey,this.pointerId=d.pointerId||0,this.pointerType=typeof d.pointerType=="string"?d.pointerType:_e[d.pointerType]||"",this.state=d.state,this.i=d,d.defaultPrevented&&X.aa.h.call(this)}}y(X,te);var _e={2:"touch",3:"pen",4:"mouse"};X.prototype.h=function(){X.aa.h.call(this);var d=this.i;d.preventDefault?d.preventDefault():d.returnValue=!1};var Ce="closure_listenable_"+(1e6*Math.random()|0),Ve=0;function De(d,v,k,M,ue){this.listener=d,this.proxy=null,this.src=v,this.type=k,this.capture=!!M,this.ha=ue,this.key=++Ve,this.da=this.fa=!1}function Ne(d){d.da=!0,d.listener=null,d.proxy=null,d.src=null,d.ha=null}function it(d){this.src=d,this.g={},this.h=0}it.prototype.add=function(d,v,k,M,ue){var xe=d.toString();d=this.g[xe],d||(d=this.g[xe]=[],this.h++);var He=Rt(d,v,M,ue);return-1<He?(v=d[He],k||(v.fa=!1)):(v=new De(v,this.src,xe,!!M,ue),v.fa=k,d.push(v)),v};function Z(d,v){var k=v.type;if(k in d.g){var M=d.g[k],ue=Array.prototype.indexOf.call(M,v,void 0),xe;(xe=0<=ue)&&Array.prototype.splice.call(M,ue,1),xe&&(Ne(v),d.g[k].length==0&&(delete d.g[k],d.h--))}}function Rt(d,v,k,M){for(var ue=0;ue<d.length;++ue){var xe=d[ue];if(!xe.da&&xe.listener==v&&xe.capture==!!k&&xe.ha==M)return ue}return-1}var wt="closure_lm_"+(1e6*Math.random()|0),Dt={};function Et(d,v,k,M,ue){if(Array.isArray(v)){for(var xe=0;xe<v.length;xe++)Et(d,v[xe],k,M,ue);return null}return k=Bi(k),d&&d[Ce]?d.K(v,k,u(M)?!!M.capture:!1,ue):Ye(d,v,k,!1,M,ue)}function Ye(d,v,k,M,ue,xe){if(!v)throw Error("Invalid event type");var He=u(ue)?!!ue.capture:!!ue,Jt=Mi(d);if(Jt||(d[wt]=Jt=new it(d)),k=Jt.add(v,k,M,He,xe),k.proxy)return k;if(M=xr(),k.proxy=M,M.src=d,M.listener=k,d.addEventListener)re||(ue=He),ue===void 0&&(ue=!1),d.addEventListener(v.toString(),M,ue);else if(d.attachEvent)d.attachEvent(Pi(v.toString()),M);else if(d.addListener&&d.removeListener)d.addListener(M);else throw Error("addEventListener and attachEvent are unavailable.");return k}function xr(){function d(k){return v.call(d.src,d.listener,k)}const v=Oi;return d}function Zr(d,v,k,M,ue){if(Array.isArray(v))for(var xe=0;xe<v.length;xe++)Zr(d,v[xe],k,M,ue);else M=u(M)?!!M.capture:!!M,k=Bi(k),d&&d[Ce]?(d=d.i,v=String(v).toString(),v in d.g&&(xe=d.g[v],k=Rt(xe,k,M,ue),-1<k&&(Ne(xe[k]),Array.prototype.splice.call(xe,k,1),xe.length==0&&(delete d.g[v],d.h--)))):d&&(d=Mi(d))&&(v=d.g[v.toString()],d=-1,v&&(d=Rt(v,k,M,ue)),(k=-1<d?v[d]:null)&&En(k))}function En(d){if(typeof d!="number"&&d&&!d.da){var v=d.src;if(v&&v[Ce])Z(v.i,d);else{var k=d.type,M=d.proxy;v.removeEventListener?v.removeEventListener(k,M,d.capture):v.detachEvent?v.detachEvent(Pi(k),M):v.addListener&&v.removeListener&&v.removeListener(M),(k=Mi(v))?(Z(k,d),k.h==0&&(k.src=null,v[wt]=null)):Ne(d)}}}function Pi(d){return d in Dt?Dt[d]:Dt[d]="on"+d}function Oi(d,v){if(d.da)d=!0;else{v=new X(v,this);var k=d.listener,M=d.ha||d.src;d.fa&&En(d),d=k.call(M,v)}return d}function Mi(d){return d=d[wt],d instanceof it?d:null}var Vr="__closure_events_fn_"+(1e9*Math.random()>>>0);function Bi(d){return typeof d=="function"?d:(d[Vr]||(d[Vr]=function(v){return d.handleEvent(v)}),d[Vr])}function cr(){K.call(this),this.i=new it(this),this.M=this,this.F=null}y(cr,K),cr.prototype[Ce]=!0,cr.prototype.removeEventListener=function(d,v,k,M){Zr(this,d,v,k,M)};function zr(d,v){var k,M=d.F;if(M)for(k=[];M;M=M.F)k.push(M);if(d=d.M,M=v.type||v,typeof v=="string")v=new te(v,d);else if(v instanceof te)v.target=v.target||d;else{var ue=v;v=new te(M,d),N(v,ue)}if(ue=!0,k)for(var xe=k.length-1;0<=xe;xe--){var He=v.g=k[xe];ue=Ar(He,M,!0,v)&&ue}if(He=v.g=d,ue=Ar(He,M,!0,v)&&ue,ue=Ar(He,M,!1,v)&&ue,k)for(xe=0;xe<k.length;xe++)He=v.g=k[xe],ue=Ar(He,M,!1,v)&&ue}cr.prototype.N=function(){if(cr.aa.N.call(this),this.i){var d=this.i,v;for(v in d.g){for(var k=d.g[v],M=0;M<k.length;M++)Ne(k[M]);delete d.g[v],d.h--}}this.F=null},cr.prototype.K=function(d,v,k,M){return this.i.add(String(d),v,!1,k,M)},cr.prototype.L=function(d,v,k,M){return this.i.add(String(d),v,!0,k,M)};function Ar(d,v,k,M){if(v=d.i.g[String(v)],!v)return!0;v=v.concat();for(var ue=!0,xe=0;xe<v.length;++xe){var He=v[xe];if(He&&!He.da&&He.capture==k){var Jt=He.listener,Tn=He.ha||He.src;He.fa&&Z(d.i,He),ue=Jt.call(Tn,M)!==!1&&ue}}return ue&&!M.defaultPrevented}function Si(d,v,k){if(typeof d=="function")k&&(d=g(d,k));else if(d&&typeof d.handleEvent=="function")d=g(d.handleEvent,d);else throw Error("Invalid listener argument");return 2147483647<Number(v)?-1:o.setTimeout(d,v||0)}function xt(d){d.g=Si(()=>{d.g=null,d.i&&(d.i=!1,xt(d))},d.l);const v=d.h;d.h=null,d.m.apply(null,v)}class Cr extends K{constructor(v,k){super(),this.m=v,this.l=k,this.h=null,this.i=!1,this.g=null}j(v){this.h=arguments,this.g?this.i=!0:xt(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Pr(d){K.call(this),this.h=d,this.g={}}y(Pr,K);var Or=[];function Rn(d){H(d.g,function(v,k){this.g.hasOwnProperty(k)&&En(v)},d),d.g={}}Pr.prototype.N=function(){Pr.aa.N.call(this),Rn(this)},Pr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var vo=o.JSON.stringify,yo=o.JSON.parse,Gu=class{stringify(d){return o.JSON.stringify(d,void 0)}parse(d){return o.JSON.parse(d,void 0)}};function Ls(){}Ls.prototype.h=null;function Al(d){return d.h||(d.h=d.i())}function oa(){}var Ba={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Us(){te.call(this,"d")}y(Us,te);function le(){te.call(this,"c")}y(le,te);var or={},la=null;function ja(){return la=la||new cr}or.La="serverreachability";function La(d){te.call(this,or.La,d)}y(La,te);function gs(d){const v=ja();zr(v,new La(v))}or.STAT_EVENT="statevent";function ca(d,v){te.call(this,or.STAT_EVENT,d),this.stat=v}y(ca,te);function Mr(d){const v=ja();zr(v,new ca(v,d))}or.Ma="timingevent";function Sn(d,v){te.call(this,or.Ma,d),this.size=v}y(Sn,te);function ms(d,v){if(typeof d!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){d()},v)}function xs(){this.g=!0}xs.prototype.xa=function(){this.g=!1};function Ku(d,v,k,M,ue,xe){d.info(function(){if(d.g)if(xe)for(var He="",Jt=xe.split("&"),Tn=0;Tn<Jt.length;Tn++){var Yt=Jt[Tn].split("=");if(1<Yt.length){var An=Yt[0];Yt=Yt[1];var Pn=An.split("_");He=2<=Pn.length&&Pn[1]=="type"?He+(An+"="+Yt+"&"):He+(An+"=redacted&")}}else He=null;else He=xe;return"XMLHTTP REQ ("+M+") [attempt "+ue+"]: "+v+`
`+k+`
`+He})}function wi(d,v,k,M,ue,xe,He){d.info(function(){return"XMLHTTP RESP ("+M+") [ attempt "+ue+"]: "+v+`
`+k+`
`+xe+" "+He})}function I(d,v,k,M){d.info(function(){return"XMLHTTP TEXT ("+v+"): "+j(d,k)+(M?" "+M:"")})}function G(d,v){d.info(function(){return"TIMEOUT: "+v})}xs.prototype.info=function(){};function j(d,v){if(!d.g)return v;if(!v)return null;try{var k=JSON.parse(v);if(k){for(d=0;d<k.length;d++)if(Array.isArray(k[d])){var M=k[d];if(!(2>M.length)){var ue=M[1];if(Array.isArray(ue)&&!(1>ue.length)){var xe=ue[0];if(xe!="noop"&&xe!="stop"&&xe!="close")for(var He=1;He<ue.length;He++)ue[He]=""}}}}return vo(k)}catch{return v}}var W={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Y={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},J;function pe(){}y(pe,Ls),pe.prototype.g=function(){return new XMLHttpRequest},pe.prototype.i=function(){return{}},J=new pe;function ve(d,v,k,M){this.j=d,this.i=v,this.l=k,this.R=M||1,this.U=new Pr(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new he}function he(){this.i=null,this.g="",this.h=!1}var de={},ge={};function Ae(d,v,k){d.L=1,d.v=ha(ji(v)),d.m=k,d.P=!0,We(d,null)}function We(d,v){d.F=Date.now(),$e(d),d.A=ji(d.v);var k=d.A,M=d.R;Array.isArray(M)||(M=[String(M)]),an(k.i,"t",M),d.C=0,k=d.j.J,d.h=new he,d.g=_s(d.j,k?v:null,!d.m),0<d.O&&(d.M=new Cr(g(d.Y,d,d.g),d.O)),v=d.U,k=d.g,M=d.ca;var ue="readystatechange";Array.isArray(ue)||(ue&&(Or[0]=ue.toString()),ue=Or);for(var xe=0;xe<ue.length;xe++){var He=Et(k,ue[xe],M||v.handleEvent,!1,v.h||v);if(!He)break;v.g[He.key]=He}v=d.H?F(d.H):{},d.m?(d.u||(d.u="POST"),v["Content-Type"]="application/x-www-form-urlencoded",d.g.ea(d.A,d.u,d.m,v)):(d.u="GET",d.g.ea(d.A,d.u,null,v)),gs(),Ku(d.i,d.u,d.A,d.l,d.R,d.m)}ve.prototype.ca=function(d){d=d.target;const v=this.M;v&&$r(d)==3?v.j():this.Y(d)},ve.prototype.Y=function(d){try{if(d==this.g)e:{const Pn=$r(this.g);var v=this.g.Ba();const Io=this.g.Z();if(!(3>Pn)&&(Pn!=3||this.g&&(this.h.h||this.g.oa()||ni(this.g)))){this.J||Pn!=4||v==7||(v==8||0>=Io?gs(3):gs(2)),ur(this);var k=this.g.Z();this.X=k;t:if(Ue(this)){var M=ni(this.g);d="";var ue=M.length,xe=$r(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Gt(this),ir(this);var He="";break t}this.h.i=new o.TextDecoder}for(v=0;v<ue;v++)this.h.h=!0,d+=this.h.i.decode(M[v],{stream:!(xe&&v==ue-1)});M.length=0,this.h.g+=d,this.C=0,He=this.h.g}else He=this.g.oa();if(this.o=k==200,wi(this.i,this.u,this.A,this.l,this.R,Pn,k),this.o){if(this.T&&!this.K){t:{if(this.g){var Jt,Tn=this.g;if((Jt=Tn.g?Tn.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!C(Jt)){var Yt=Jt;break t}}Yt=null}if(k=Yt)I(this.i,this.l,k,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Ti(this,k);else{this.o=!1,this.s=3,Mr(12),Gt(this),ir(this);break e}}if(this.P){k=!0;let Vi;for(;!this.J&&this.C<He.length;)if(Vi=Me(this,He),Vi==ge){Pn==4&&(this.s=4,Mr(14),k=!1),I(this.i,this.l,null,"[Incomplete Response]");break}else if(Vi==de){this.s=4,Mr(15),I(this.i,this.l,He,"[Invalid Chunk]"),k=!1;break}else I(this.i,this.l,Vi,null),Ti(this,Vi);if(Ue(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Pn!=4||He.length!=0||this.h.h||(this.s=1,Mr(16),k=!1),this.o=this.o&&k,!k)I(this.i,this.l,He,"[Invalid Chunked Response]"),Gt(this),ir(this);else if(0<He.length&&!this.W){this.W=!0;var An=this.j;An.g==this&&An.ba&&!An.M&&(An.j.info("Great, no buffering proxy detected. Bytes received: "+He.length),Zu(An),An.M=!0,Mr(11))}}else I(this.i,this.l,He,null),Ti(this,He);Pn==4&&Gt(this),this.o&&!this.J&&(Pn==4?Zi(this.j,this):(this.o=!1,$e(this)))}else f0(this.g),k==400&&0<He.indexOf("Unknown SID")?(this.s=3,Mr(12)):(this.s=0,Mr(13)),Gt(this),ir(this)}}}catch{}finally{}};function Ue(d){return d.g?d.u=="GET"&&d.L!=2&&d.j.Ca:!1}function Me(d,v){var k=d.C,M=v.indexOf(`
`,k);return M==-1?ge:(k=Number(v.substring(k,M)),isNaN(k)?de:(M+=1,M+k>v.length?ge:(v=v.slice(M,M+k),d.C=M+k,v)))}ve.prototype.cancel=function(){this.J=!0,Gt(this)};function $e(d){d.S=Date.now()+d.I,at(d,d.I)}function at(d,v){if(d.B!=null)throw Error("WatchDog timer not null");d.B=ms(g(d.ba,d),v)}function ur(d){d.B&&(o.clearTimeout(d.B),d.B=null)}ve.prototype.ba=function(){this.B=null;const d=Date.now();0<=d-this.S?(G(this.i,this.A),this.L!=2&&(gs(),Mr(17)),Gt(this),this.s=2,ir(this)):at(this,this.S-d)};function ir(d){d.j.G==0||d.J||Zi(d.j,d)}function Gt(d){ur(d);var v=d.M;v&&typeof v.ma=="function"&&v.ma(),d.M=null,Rn(d.U),d.g&&(v=d.g,d.g=null,v.abort(),v.ma())}function Ti(d,v){try{var k=d.j;if(k.G!=0&&(k.g==d||Sr(k.h,d))){if(!d.K&&Sr(k.h,d)&&k.G==3){try{var M=k.Da.g.parse(v)}catch{M=null}if(Array.isArray(M)&&M.length==3){var ue=M;if(ue[0]==0){e:if(!k.u){if(k.g)if(k.g.F+3e3<d.F)Fl(k),$t(k);else break e;Cc(k),Mr(18)}}else k.za=ue[1],0<k.za-k.T&&37500>ue[2]&&k.F&&k.v==0&&!k.C&&(k.C=ms(g(k.Za,k),6e3));if(1>=ua(k.h)&&k.ca){try{k.ca()}catch{}k.ca=void 0}}else za(k,11)}else if((d.K||k.g==d)&&Fl(k),!C(v))for(ue=k.Da.g.parse(v),v=0;v<ue.length;v++){let Yt=ue[v];if(k.T=Yt[0],Yt=Yt[1],k.G==2)if(Yt[0]=="c"){k.K=Yt[1],k.ia=Yt[2];const An=Yt[3];An!=null&&(k.la=An,k.j.info("VER="+k.la));const Pn=Yt[4];Pn!=null&&(k.Aa=Pn,k.j.info("SVER="+k.Aa));const Io=Yt[5];Io!=null&&typeof Io=="number"&&0<Io&&(M=1.5*Io,k.L=M,k.j.info("backChannelRequestTimeoutMs_="+M)),M=k;const Vi=d.g;if(Vi){const kc=Vi.g?Vi.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(kc){var xe=M.h;xe.g||kc.indexOf("spdy")==-1&&kc.indexOf("quic")==-1&&kc.indexOf("h2")==-1||(xe.j=xe.l,xe.g=new Set,xe.h&&(Va(xe,xe.h),xe.h=null))}if(M.D){const Fc=Vi.g?Vi.g.getResponseHeader("X-HTTP-Session-Id"):null;Fc&&(M.ya=Fc,Ft(M.I,M.D,Fc))}}k.G=3,k.l&&k.l.ua(),k.ba&&(k.R=Date.now()-d.F,k.j.info("Handshake RTT: "+k.R+"ms")),M=k;var He=d;if(M.qa=bl(M,M.J?M.ia:null,M.W),He.K){kt(M.h,He);var Jt=He,Tn=M.L;Tn&&(Jt.I=Tn),Jt.B&&(ur(Jt),$e(Jt)),M.g=He}else Ju(M);0<k.i.length&&ko(k)}else Yt[0]!="stop"&&Yt[0]!="close"||za(k,7);else k.G==3&&(Yt[0]=="stop"||Yt[0]=="close"?Yt[0]=="stop"?za(k,7):ma(k):Yt[0]!="noop"&&k.l&&k.l.ta(Yt),k.v=0)}}gs(4)}catch{}}var Ua=class{constructor(d,v){this.g=d,this.map=v}};function qi(d){this.l=d||10,o.PerformanceNavigationTiming?(d=o.performance.getEntriesByType("navigation"),d=0<d.length&&(d[0].nextHopProtocol=="hq"||d[0].nextHopProtocol=="h2")):d=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=d?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function lr(d){return d.h?!0:d.g?d.g.size>=d.j:!1}function ua(d){return d.h?1:d.g?d.g.size:0}function Sr(d,v){return d.h?d.h==v:d.g?d.g.has(v):!1}function Va(d,v){d.g?d.g.add(v):d.h=v}function kt(d,v){d.h&&d.h==v?d.h=null:d.g&&d.g.has(v)&&d.g.delete(v)}qi.prototype.cancel=function(){if(this.i=da(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const d of this.g.values())d.cancel();this.g.clear()}};function da(d){if(d.h!=null)return d.i.concat(d.h.D);if(d.g!=null&&d.g.size!==0){let v=d.i;for(const k of d.g.values())v=v.concat(k.D);return v}return x(d.i)}function Kt(d){if(d.V&&typeof d.V=="function")return d.V();if(typeof Map<"u"&&d instanceof Map||typeof Set<"u"&&d instanceof Set)return Array.from(d.values());if(typeof d=="string")return d.split("");if(l(d)){for(var v=[],k=d.length,M=0;M<k;M++)v.push(d[M]);return v}v=[],k=0;for(M in d)v[k++]=d[M];return v}function Qi(d){if(d.na&&typeof d.na=="function")return d.na();if(!d.V||typeof d.V!="function"){if(typeof Map<"u"&&d instanceof Map)return Array.from(d.keys());if(!(typeof Set<"u"&&d instanceof Set)){if(l(d)||typeof d=="string"){var v=[];d=d.length;for(var k=0;k<d;k++)v.push(k);return v}v=[],k=0;for(const M in d)v[k++]=M;return v}}}function fn(d,v){if(d.forEach&&typeof d.forEach=="function")d.forEach(v,void 0);else if(l(d)||typeof d=="string")Array.prototype.forEach.call(d,v,void 0);else for(var k=Qi(d),M=Kt(d),ue=M.length,xe=0;xe<ue;xe++)v.call(void 0,M[xe],k&&k[xe],d)}var fa=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function _o(d,v){if(d){d=d.split("&");for(var k=0;k<d.length;k++){var M=d[k].indexOf("="),ue=null;if(0<=M){var xe=d[k].substring(0,M);ue=d[k].substring(M+1)}else xe=d[k];v(xe,ue?decodeURIComponent(ue.replace(/\+/g," ")):"")}}}function Ai(d){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,d instanceof Ai){this.h=d.h,Eo(this,d.j),this.o=d.o,this.g=d.g,Li(this,d.s),this.l=d.l;var v=d.i,k=new Dn;k.i=v.i,v.g&&(k.g=new Map(v.g),k.h=v.h),So(this,k),this.m=d.m}else d&&(v=String(d).match(fa))?(this.h=!1,Eo(this,v[1]||"",!0),this.o=zn(v[2]||""),this.g=zn(v[3]||"",!0),Li(this,v[4]),this.l=zn(v[5]||"",!0),So(this,v[6]||"",!0),this.m=zn(v[7]||"")):(this.h=!1,this.i=new Dn(null,this.h))}Ai.prototype.toString=function(){var d=[],v=this.j;v&&d.push(pa(v,Vs,!0),":");var k=this.g;return(k||v=="file")&&(d.push("//"),(v=this.o)&&d.push(pa(v,Vs,!0),"@"),d.push(encodeURIComponent(String(k)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),k=this.s,k!=null&&d.push(":",String(k))),(k=this.l)&&(this.g&&k.charAt(0)!="/"&&d.push("/"),d.push(pa(k,k.charAt(0)=="/"?To:Yu,!0))),(k=this.i.toString())&&d.push("?",k),(k=this.m)&&d.push("#",pa(k,_c)),d.join("")};function ji(d){return new Ai(d)}function Eo(d,v,k){d.j=k?zn(v,!0):v,d.j&&(d.j=d.j.replace(/:$/,""))}function Li(d,v){if(v){if(v=Number(v),isNaN(v)||0>v)throw Error("Bad port number "+v);d.s=v}else d.s=null}function So(d,v,k){v instanceof Dn?(d.i=v,hg(d.i,d.h)):(k||(v=pa(v,Wn)),d.i=new Dn(v,d.h))}function Ft(d,v,k){d.i.set(v,k)}function ha(d){return Ft(d,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),d}function zn(d,v){return d?v?decodeURI(d.replace(/%25/g,"%2525")):decodeURIComponent(d):""}function pa(d,v,k){return typeof d=="string"?(d=encodeURI(d).replace(v,wo),k&&(d=d.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d):null}function wo(d){return d=d.charCodeAt(0),"%"+(d>>4&15).toString(16)+(d&15).toString(16)}var Vs=/[#\/\?@]/g,Yu=/[#\?:]/g,To=/[#\?]/g,Wn=/[#\?@]/g,_c=/#/g;function Dn(d,v){this.h=this.g=null,this.i=d||null,this.j=!!v}function Ji(d){d.g||(d.g=new Map,d.h=0,d.i&&_o(d.i,function(v,k){d.add(decodeURIComponent(v.replace(/\+/g," ")),k)}))}t=Dn.prototype,t.add=function(d,v){Ji(this),this.i=null,d=zs(this,d);var k=this.g.get(d);return k||this.g.set(d,k=[]),k.push(v),this.h+=1,this};function Ui(d,v){Ji(d),v=zs(d,v),d.g.has(v)&&(d.i=null,d.h-=d.g.get(v).length,d.g.delete(v))}function Ec(d,v){return Ji(d),v=zs(d,v),d.g.has(v)}t.forEach=function(d,v){Ji(this),this.g.forEach(function(k,M){k.forEach(function(ue){d.call(v,ue,M,this)},this)},this)},t.na=function(){Ji(this);const d=Array.from(this.g.values()),v=Array.from(this.g.keys()),k=[];for(let M=0;M<v.length;M++){const ue=d[M];for(let xe=0;xe<ue.length;xe++)k.push(v[M])}return k},t.V=function(d){Ji(this);let v=[];if(typeof d=="string")Ec(this,d)&&(v=v.concat(this.g.get(zs(this,d))));else{d=Array.from(this.g.values());for(let k=0;k<d.length;k++)v=v.concat(d[k])}return v},t.set=function(d,v){return Ji(this),this.i=null,d=zs(this,d),Ec(this,d)&&(this.h-=this.g.get(d).length),this.g.set(d,[v]),this.h+=1,this},t.get=function(d,v){return d?(d=this.V(d),0<d.length?String(d[0]):v):v};function an(d,v,k){Ui(d,v),0<k.length&&(d.i=null,d.g.set(zs(d,v),x(k)),d.h+=k.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const d=[],v=Array.from(this.g.keys());for(var k=0;k<v.length;k++){var M=v[k];const xe=encodeURIComponent(String(M)),He=this.V(M);for(M=0;M<He.length;M++){var ue=xe;He[M]!==""&&(ue+="="+encodeURIComponent(String(He[M]))),d.push(ue)}}return this.i=d.join("&")};function zs(d,v){return v=String(v),d.j&&(v=v.toLowerCase()),v}function hg(d,v){v&&!d.j&&(Ji(d),d.i=null,d.g.forEach(function(k,M){var ue=M.toLowerCase();M!=ue&&(Ui(this,M),an(this,ue,k))},d)),d.j=v}function Sc(d,v){const k=new xs;if(o.Image){const M=new Image;M.onload=m(vs,k,"TestLoadImage: loaded",!0,v,M),M.onerror=m(vs,k,"TestLoadImage: error",!1,v,M),M.onabort=m(vs,k,"TestLoadImage: abort",!1,v,M),M.ontimeout=m(vs,k,"TestLoadImage: timeout",!1,v,M),o.setTimeout(function(){M.ontimeout&&M.ontimeout()},1e4),M.src=d}else v(!1)}function u0(d,v){const k=new xs,M=new AbortController,ue=setTimeout(()=>{M.abort(),vs(k,"TestPingServer: timeout",!1,v)},1e4);fetch(d,{signal:M.signal}).then(xe=>{clearTimeout(ue),xe.ok?vs(k,"TestPingServer: ok",!0,v):vs(k,"TestPingServer: server error",!1,v)}).catch(()=>{clearTimeout(ue),vs(k,"TestPingServer: error",!1,v)})}function vs(d,v,k,M,ue){try{ue&&(ue.onload=null,ue.onerror=null,ue.onabort=null,ue.ontimeout=null),M(k)}catch{}}function Tt(){this.g=new Gu}function Cl(d,v,k){const M=k||"";try{fn(d,function(ue,xe){let He=ue;u(ue)&&(He=vo(ue)),v.push(M+xe+"="+encodeURIComponent(He))})}catch(ue){throw v.push(M+"type="+encodeURIComponent("_badmap")),ue}}function yr(d){this.l=d.Ub||null,this.j=d.eb||!1}y(yr,Ls),yr.prototype.g=function(){return new Ws(this.l,this.j)},yr.prototype.i=function(d){return function(){return d}}({});function Ws(d,v){cr.call(this),this.D=d,this.o=v,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}y(Ws,cr),t=Ws.prototype,t.open=function(d,v){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=d,this.A=v,this.readyState=1,Co(this)},t.send=function(d){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const v={headers:this.u,method:this.B,credentials:this.m,cache:void 0};d&&(v.body=d),(this.D||o).fetch(new Request(this.A,v)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ao(this)),this.readyState=0},t.Sa=function(d){if(this.g&&(this.l=d,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=d.headers,this.readyState=2,Co(this)),this.g&&(this.readyState=3,Co(this),this.g)))if(this.responseType==="arraybuffer")d.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in d){if(this.j=d.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Xu(this)}else d.text().then(this.Ra.bind(this),this.ga.bind(this))};function Xu(d){d.j.read().then(d.Pa.bind(d)).catch(d.ga.bind(d))}t.Pa=function(d){if(this.g){if(this.o&&d.value)this.response.push(d.value);else if(!this.o){var v=d.value?d.value:new Uint8Array(0);(v=this.v.decode(v,{stream:!d.done}))&&(this.response=this.responseText+=v)}d.done?Ao(this):Co(this),this.readyState==3&&Xu(this)}},t.Ra=function(d){this.g&&(this.response=this.responseText=d,Ao(this))},t.Qa=function(d){this.g&&(this.response=d,Ao(this))},t.ga=function(){this.g&&Ao(this)};function Ao(d){d.readyState=4,d.l=null,d.j=null,d.v=null,Co(d)}t.setRequestHeader=function(d,v){this.u.append(d,v)},t.getResponseHeader=function(d){return this.h&&this.h.get(d.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const d=[],v=this.h.entries();for(var k=v.next();!k.done;)k=k.value,d.push(k[0]+": "+k[1]),k=v.next();return d.join(`\r
`)};function Co(d){d.onreadystatechange&&d.onreadystatechange.call(d)}Object.defineProperty(Ws.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(d){this.m=d?"include":"same-origin"}});function wc(d){let v="";return H(d,function(k,M){v+=M,v+=":",v+=k,v+=`\r
`}),v}function Tc(d,v,k){e:{for(M in k){var M=!1;break e}M=!0}M||(k=wc(k),typeof d=="string"?k!=null&&encodeURIComponent(String(k)):Ft(d,v,k))}function kr(d){cr.call(this),this.headers=new Map,this.o=d||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}y(kr,cr);var d0=/^https?$/i,kl=["POST","PUT"];t=kr.prototype,t.Ha=function(d){this.J=d},t.ea=function(d,v,k,M){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+d);v=v?v.toUpperCase():"GET",this.D=d,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():J.g(),this.v=this.o?Al(this.o):Al(J),this.g.onreadystatechange=g(this.Ea,this);try{this.B=!0,this.g.open(v,String(d),!0),this.B=!1}catch(xe){qu(this,xe);return}if(d=k||"",k=new Map(this.headers),M)if(Object.getPrototypeOf(M)===Object.prototype)for(var ue in M)k.set(ue,M[ue]);else if(typeof M.keys=="function"&&typeof M.get=="function")for(const xe of M.keys())k.set(xe,M.get(xe));else throw Error("Unknown input type for opt_headers: "+String(M));M=Array.from(k.keys()).find(xe=>xe.toLowerCase()=="content-type"),ue=o.FormData&&d instanceof o.FormData,!(0<=Array.prototype.indexOf.call(kl,v,void 0))||M||ue||k.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[xe,He]of k)this.g.setRequestHeader(xe,He);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{$n(this),this.u=!0,this.g.send(d),this.u=!1}catch(xe){qu(this,xe)}};function qu(d,v){d.h=!1,d.g&&(d.j=!0,d.g.abort(),d.j=!1),d.l=v,d.m=5,Qu(d),Wr(d)}function Qu(d){d.A||(d.A=!0,zr(d,"complete"),zr(d,"error"))}t.abort=function(d){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=d||7,zr(this,"complete"),zr(this,"abort"),Wr(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Wr(this,!0)),kr.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?wn(this):this.bb())},t.bb=function(){wn(this)};function wn(d){if(d.h&&typeof a<"u"&&(!d.v[1]||$r(d)!=4||d.Z()!=2)){if(d.u&&$r(d)==4)Si(d.Ea,0,d);else if(zr(d,"readystatechange"),$r(d)==4){d.h=!1;try{const He=d.Z();e:switch(He){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var v=!0;break e;default:v=!1}var k;if(!(k=v)){var M;if(M=He===0){var ue=String(d.D).match(fa)[1]||null;!ue&&o.self&&o.self.location&&(ue=o.self.location.protocol.slice(0,-1)),M=!d0.test(ue?ue.toLowerCase():"")}k=M}if(k)zr(d,"complete"),zr(d,"success");else{d.m=6;try{var xe=2<$r(d)?d.g.statusText:""}catch{xe=""}d.l=xe+" ["+d.Z()+"]",Qu(d)}}finally{Wr(d)}}}}function Wr(d,v){if(d.g){$n(d);const k=d.g,M=d.v[0]?()=>{}:null;d.g=null,d.v=null,v||zr(d,"ready");try{k.onreadystatechange=M}catch{}}}function $n(d){d.I&&(o.clearTimeout(d.I),d.I=null)}t.isActive=function(){return!!this.g};function $r(d){return d.g?d.g.readyState:0}t.Z=function(){try{return 2<$r(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(d){if(this.g){var v=this.g.responseText;return d&&v.indexOf(d)==0&&(v=v.substring(d.length)),yo(v)}};function ni(d){try{if(!d.g)return null;if("response"in d.g)return d.g.response;switch(d.H){case"":case"text":return d.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in d.g)return d.g.mozResponseArrayBuffer}return null}catch{return null}}function f0(d){const v={};d=(d.g&&2<=$r(d)&&d.g.getAllResponseHeaders()||"").split(`\r
`);for(let M=0;M<d.length;M++){if(C(d[M]))continue;var k=D(d[M]);const ue=k[0];if(k=k[1],typeof k!="string")continue;k=k.trim();const xe=v[ue]||[];v[ue]=xe,xe.push(k)}T(v,function(M){return M.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function ga(d,v,k){return k&&k.internalChannelParams&&k.internalChannelParams[d]||v}function Ut(d){this.Aa=0,this.i=[],this.j=new xs,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=ga("failFast",!1,d),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=ga("baseRetryDelayMs",5e3,d),this.cb=ga("retryDelaySeedMs",1e4,d),this.Wa=ga("forwardChannelMaxRetries",2,d),this.wa=ga("forwardChannelRequestTimeoutMs",2e4,d),this.pa=d&&d.xmlHttpFactory||void 0,this.Xa=d&&d.Tb||void 0,this.Ca=d&&d.useFetchStreams||!1,this.L=void 0,this.J=d&&d.supportsCrossDomainXhr||!1,this.K="",this.h=new qi(d&&d.concurrentRequestLimit),this.Da=new Tt,this.P=d&&d.fastHandshake||!1,this.O=d&&d.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=d&&d.Rb||!1,d&&d.xa&&this.j.xa(),d&&d.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&d&&d.detectBufferingProxy||!1,this.ja=void 0,d&&d.longPollingTimeout&&0<d.longPollingTimeout&&(this.ja=d.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Ut.prototype,t.la=8,t.G=1,t.connect=function(d,v,k,M){Mr(0),this.W=d,this.H=v||{},k&&M!==void 0&&(this.H.OSID=k,this.H.OAID=M),this.F=this.X,this.I=bl(this,null,this.W),ko(this)};function ma(d){if(ii(d),d.G==3){var v=d.U++,k=ji(d.I);if(Ft(k,"SID",d.K),Ft(k,"RID",v),Ft(k,"TYPE","terminate"),ys(d,k),v=new ve(d,d.j,v),v.L=2,v.v=ha(ji(k)),k=!1,o.navigator&&o.navigator.sendBeacon)try{k=o.navigator.sendBeacon(v.v.toString(),"")}catch{}!k&&o.Image&&(new Image().src=v.v,k=!0),k||(v.g=_s(v.j,null),v.g.ea(v.v)),v.F=Date.now(),$e(v)}p0(d)}function $t(d){d.g&&(Zu(d),d.g.cancel(),d.g=null)}function ii(d){$t(d),d.u&&(o.clearTimeout(d.u),d.u=null),Fl(d),d.h.cancel(),d.s&&(typeof d.s=="number"&&o.clearTimeout(d.s),d.s=null)}function ko(d){if(!lr(d.h)&&!d.s){d.s=!0;var v=d.Ga;be||Ie(),ke||(be(),ke=!0),ne.add(v,d),d.B=0}}function Ac(d,v){return ua(d.h)>=d.h.j-(d.s?1:0)?!1:d.s?(d.i=v.D.concat(d.i),!0):d.G==1||d.G==2||d.B>=(d.Va?0:d.Wa)?!1:(d.s=ms(g(d.Ga,d,v),h0(d,d.B)),d.B++,!0)}t.Ga=function(d){if(this.s)if(this.s=null,this.G==1){if(!d){this.U=Math.floor(1e5*Math.random()),d=this.U++;const ue=new ve(this,this.j,d);let xe=this.o;if(this.S&&(xe?(xe=F(xe),N(xe,this.S)):xe=this.S),this.m!==null||this.O||(ue.H=xe,xe=null),this.P)e:{for(var v=0,k=0;k<this.i.length;k++){t:{var M=this.i[k];if("__data__"in M.map&&(M=M.map.__data__,typeof M=="string")){M=M.length;break t}M=void 0}if(M===void 0)break;if(v+=M,4096<v){v=k;break e}if(v===4096||k===this.i.length-1){v=k+1;break e}}v=1e3}else v=1e3;v=xa(this,ue,v),k=ji(this.I),Ft(k,"RID",d),Ft(k,"CVER",22),this.D&&Ft(k,"X-HTTP-Session-Id",this.D),ys(this,k),xe&&(this.O?v="headers="+encodeURIComponent(String(wc(xe)))+"&"+v:this.m&&Tc(k,this.m,xe)),Va(this.h,ue),this.Ua&&Ft(k,"TYPE","init"),this.P?(Ft(k,"$req",v),Ft(k,"SID","null"),ue.T=!0,Ae(ue,k,null)):Ae(ue,k,v),this.G=2}}else this.G==3&&(d?Br(this,d):this.i.length==0||lr(this.h)||Br(this))};function Br(d,v){var k;v?k=v.l:k=d.U++;const M=ji(d.I);Ft(M,"SID",d.K),Ft(M,"RID",k),Ft(M,"AID",d.T),ys(d,M),d.m&&d.o&&Tc(M,d.m,d.o),k=new ve(d,d.j,k,d.B+1),d.m===null&&(k.H=d.o),v&&(d.i=v.D.concat(d.i)),v=xa(d,k,1e3),k.I=Math.round(.5*d.wa)+Math.round(.5*d.wa*Math.random()),Va(d.h,k),Ae(k,M,v)}function ys(d,v){d.H&&H(d.H,function(k,M){Ft(v,M,k)}),d.l&&fn({},function(k,M){Ft(v,M,k)})}function xa(d,v,k){k=Math.min(d.i.length,k);var M=d.l?g(d.l.Na,d.l,d):null;e:{var ue=d.i;let xe=-1;for(;;){const He=["count="+k];xe==-1?0<k?(xe=ue[0].g,He.push("ofs="+xe)):xe=0:He.push("ofs="+xe);let Jt=!0;for(let Tn=0;Tn<k;Tn++){let Yt=ue[Tn].g;const An=ue[Tn].map;if(Yt-=xe,0>Yt)xe=Math.max(0,ue[Tn].g-100),Jt=!1;else try{Cl(An,He,"req"+Yt+"_")}catch{M&&M(An)}}if(Jt){M=He.join("&");break e}}}return d=d.i.splice(0,k),v.D=d,M}function Ju(d){if(!d.g&&!d.u){d.Y=1;var v=d.Fa;be||Ie(),ke||(be(),ke=!0),ne.add(v,d),d.v=0}}function Cc(d){return d.g||d.u||3<=d.v?!1:(d.Y++,d.u=ms(g(d.Fa,d),h0(d,d.v)),d.v++,!0)}t.Fa=function(){if(this.u=null,Fo(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var d=2*this.R;this.j.info("BP detection timer enabled: "+d),this.A=ms(g(this.ab,this),d)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Mr(10),$t(this),Fo(this))};function Zu(d){d.A!=null&&(o.clearTimeout(d.A),d.A=null)}function Fo(d){d.g=new ve(d,d.j,"rpc",d.Y),d.m===null&&(d.g.H=d.o),d.g.O=0;var v=ji(d.qa);Ft(v,"RID","rpc"),Ft(v,"SID",d.K),Ft(v,"AID",d.T),Ft(v,"CI",d.F?"0":"1"),!d.F&&d.ja&&Ft(v,"TO",d.ja),Ft(v,"TYPE","xmlhttp"),ys(d,v),d.m&&d.o&&Tc(v,d.m,d.o),d.L&&(d.g.I=d.L);var k=d.g;d=d.ia,k.L=1,k.v=ha(ji(v)),k.m=null,k.P=!0,We(k,d)}t.Za=function(){this.C!=null&&(this.C=null,$t(this),Cc(this),Mr(19))};function Fl(d){d.C!=null&&(o.clearTimeout(d.C),d.C=null)}function Zi(d,v){var k=null;if(d.g==v){Fl(d),Zu(d),d.g=null;var M=2}else if(Sr(d.h,v))k=v.D,kt(d.h,v),M=1;else return;if(d.G!=0){if(v.o)if(M==1){k=v.m?v.m.length:0,v=Date.now()-v.F;var ue=d.B;M=ja(),zr(M,new Sn(M,k)),ko(d)}else Ju(d);else if(ue=v.s,ue==3||ue==0&&0<v.X||!(M==1&&Ac(d,v)||M==2&&Cc(d)))switch(k&&0<k.length&&(v=d.h,v.i=v.i.concat(k)),ue){case 1:za(d,5);break;case 4:za(d,10);break;case 3:za(d,6);break;default:za(d,2)}}}function h0(d,v){let k=d.Ta+Math.floor(Math.random()*d.cb);return d.isActive()||(k*=2),k*v}function za(d,v){if(d.j.info("Error code "+v),v==2){var k=g(d.fb,d),M=d.Xa;const ue=!M;M=new Ai(M||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||Eo(M,"https"),ha(M),ue?Sc(M.toString(),k):u0(M.toString(),k)}else Mr(2);d.G=0,d.l&&d.l.sa(v),p0(d),ii(d)}t.fb=function(d){d?(this.j.info("Successfully pinged google.com"),Mr(2)):(this.j.info("Failed to ping google.com"),Mr(1))};function p0(d){if(d.G=0,d.ka=[],d.l){const v=da(d.h);(v.length!=0||d.i.length!=0)&&(S(d.ka,v),S(d.ka,d.i),d.h.i.length=0,x(d.i),d.i.length=0),d.l.ra()}}function bl(d,v,k){var M=k instanceof Ai?ji(k):new Ai(k);if(M.g!="")v&&(M.g=v+"."+M.g),Li(M,M.s);else{var ue=o.location;M=ue.protocol,v=v?v+"."+ue.hostname:ue.hostname,ue=+ue.port;var xe=new Ai(null);M&&Eo(xe,M),v&&(xe.g=v),ue&&Li(xe,ue),k&&(xe.l=k),M=xe}return k=d.D,v=d.ya,k&&v&&Ft(M,k,v),Ft(M,"VER",d.la),ys(d,M),M}function _s(d,v,k){if(v&&!d.J)throw Error("Can't create secondary domain capable XhrIo object.");return v=d.Ca&&!d.pa?new kr(new yr({eb:k})):new kr(d.pa),v.Ha(d.J),v}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function ed(){}t=ed.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function bo(){}bo.prototype.g=function(d,v){return new Ci(d,v)};function Ci(d,v){cr.call(this),this.g=new Ut(v),this.l=d,this.h=v&&v.messageUrlParams||null,d=v&&v.messageHeaders||null,v&&v.clientProtocolHeaderRequired&&(d?d["X-Client-Protocol"]="webchannel":d={"X-Client-Protocol":"webchannel"}),this.g.o=d,d=v&&v.initMessageHeaders||null,v&&v.messageContentType&&(d?d["X-WebChannel-Content-Type"]=v.messageContentType:d={"X-WebChannel-Content-Type":v.messageContentType}),v&&v.va&&(d?d["X-WebChannel-Client-Profile"]=v.va:d={"X-WebChannel-Client-Profile":v.va}),this.g.S=d,(d=v&&v.Sb)&&!C(d)&&(this.g.m=d),this.v=v&&v.supportsCrossDomainXhr||!1,this.u=v&&v.sendRawJson||!1,(v=v&&v.httpSessionIdParam)&&!C(v)&&(this.g.D=v,d=this.h,d!==null&&v in d&&(d=this.h,v in d&&delete d[v])),this.j=new $s(this)}y(Ci,cr),Ci.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Ci.prototype.close=function(){ma(this.g)},Ci.prototype.o=function(d){var v=this.g;if(typeof d=="string"){var k={};k.__data__=d,d=k}else this.u&&(k={},k.__data__=vo(d),d=k);v.i.push(new Ua(v.Ya++,d)),v.G==3&&ko(v)},Ci.prototype.N=function(){this.g.l=null,delete this.j,ma(this.g),delete this.g,Ci.aa.N.call(this)};function _r(d){Us.call(this),d.__headers__&&(this.headers=d.__headers__,this.statusCode=d.__status__,delete d.__headers__,delete d.__status__);var v=d.__sm__;if(v){e:{for(const k in v){d=k;break e}d=void 0}(this.i=d)&&(d=this.i,v=v!==null&&d in v?v[d]:void 0),this.data=v}else this.data=d}y(_r,Us);function si(){le.call(this),this.status=1}y(si,le);function $s(d){this.g=d}y($s,ed),$s.prototype.ua=function(){zr(this.g,"a")},$s.prototype.ta=function(d){zr(this.g,new _r(d))},$s.prototype.sa=function(d){zr(this.g,new si)},$s.prototype.ra=function(){zr(this.g,"b")},bo.prototype.createWebChannel=bo.prototype.g,Ci.prototype.send=Ci.prototype.o,Ci.prototype.open=Ci.prototype.m,Ci.prototype.close=Ci.prototype.close,rk=function(){return new bo},tk=function(){return ja()},ek=or,Fx={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},W.NO_ERROR=0,W.TIMEOUT=8,W.HTTP_ERROR=6,vh=W,Y.COMPLETE="complete",ZC=Y,oa.EventType=Ba,Ba.OPEN="a",Ba.CLOSE="b",Ba.ERROR="c",Ba.MESSAGE="d",cr.prototype.listen=cr.prototype.K,Cd=oa,kr.prototype.listenOnce=kr.prototype.L,kr.prototype.getLastError=kr.prototype.Ka,kr.prototype.getLastErrorCode=kr.prototype.Ba,kr.prototype.getStatus=kr.prototype.Z,kr.prototype.getResponseJson=kr.prototype.Oa,kr.prototype.getResponseText=kr.prototype.oa,kr.prototype.send=kr.prototype.ea,kr.prototype.setWithCredentials=kr.prototype.Ha,JC=kr}).apply(typeof J0<"u"?J0:typeof self<"u"?self:typeof window<"u"?window:{});const vE="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class di{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}di.UNAUTHENTICATED=new di(null),di.GOOGLE_CREDENTIALS=new di("google-credentials-uid"),di.FIRST_PARTY=new di("first-party-uid"),di.MOCK_USER=new di("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Vu="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ac=new kv("@firebase/firestore");function xd(){return ac.logLevel}function tt(t,...e){if(ac.logLevel<=Ht.DEBUG){const r=e.map(Iv);ac.debug(`Firestore (${Vu}): ${t}`,...r)}}function lo(t,...e){if(ac.logLevel<=Ht.ERROR){const r=e.map(Iv);ac.error(`Firestore (${Vu}): ${t}`,...r)}}function Au(t,...e){if(ac.logLevel<=Ht.WARN){const r=e.map(Iv);ac.warn(`Firestore (${Vu}): ${t}`,...r)}}function Iv(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _t(t="Unexpected state"){const e=`FIRESTORE (${Vu}) INTERNAL ASSERTION FAILED: `+t;throw lo(e),new Error(e)}function mr(t,e){t||_t()}function Ct(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Be={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ct extends xo{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ll{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nk{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class C7{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(di.UNAUTHENTICATED))}shutdown(){}}class k7{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class F7{constructor(e){this.t=e,this.currentUser=di.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){mr(this.o===void 0);let n=this.i;const i=l=>this.i!==n?(n=this.i,r(l)):Promise.resolve();let s=new ll;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new ll,e.enqueueRetryable(()=>i(this.currentUser))};const a=()=>{const l=s;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},o=l=>{tt("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(l=>o(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?o(l):(tt("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new ll)}},0),a()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(tt("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(mr(typeof n.accessToken=="string"),new nk(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return mr(e===null||typeof e=="string"),new di(e)}}class b7{constructor(e,r,n){this.l=e,this.h=r,this.P=n,this.type="FirstParty",this.user=di.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class I7{constructor(e,r,n){this.l=e,this.h=r,this.P=n}getToken(){return Promise.resolve(new b7(this.l,this.h,this.P))}start(e,r){e.enqueueRetryable(()=>r(di.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class N7{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class R7{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,r){mr(this.o===void 0);const n=s=>{s.error!=null&&tt("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const a=s.token!==this.R;return this.R=s.token,tt("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?r(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>n(s))};const i=s=>{tt("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):tt("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(mr(typeof r.token=="string"),this.R=r.token,new N7(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D7(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ik{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=Math.floor(256/e.length)*e.length;let n="";for(;n.length<20;){const i=D7(40);for(let s=0;s<i.length;++s)n.length<20&&i[s]<r&&(n+=e.charAt(i[s]%e.length))}return n}}function ar(t,e){return t<e?-1:t>e?1:0}function Cu(t,e,r){return t.length===e.length&&t.every((n,i)=>r(n,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class In{constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new ct(Be.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new ct(Be.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<-62135596800)throw new ct(Be.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ct(Be.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return In.fromMillis(Date.now())}static fromDate(e){return In.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*r));return new In(r,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ar(this.nanoseconds,e.nanoseconds):ar(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class At{constructor(e){this.timestamp=e}static fromTimestamp(e){return new At(e)}static min(){return new At(new In(0,0))}static max(){return new At(new In(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nf{constructor(e,r,n){r===void 0?r=0:r>e.length&&_t(),n===void 0?n=e.length-r:n>e.length-r&&_t(),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return Nf.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof Nf?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let i=0;i<n;i++){const s=e.get(i),a=r.get(i);if(s<a)return-1;if(s>a)return 1}return e.length<r.length?-1:e.length>r.length?1:0}}class rn extends Nf{construct(e,r,n){return new rn(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new ct(Be.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(i=>i.length>0))}return new rn(r)}static emptyPath(){return new rn([])}}const P7=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Jn extends Nf{construct(e,r,n){return new Jn(e,r,n)}static isValidIdentifier(e){return P7.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Jn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Jn(["__name__"])}static fromServerFormat(e){const r=[];let n="",i=0;const s=()=>{if(n.length===0)throw new ct(Be.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let a=!1;for(;i<e.length;){const o=e[i];if(o==="\\"){if(i+1===e.length)throw new ct(Be.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new ct(Be.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=l,i+=2}else o==="`"?(a=!a,i++):o!=="."||a?(n+=o,i++):(s(),i++)}if(s(),a)throw new ct(Be.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Jn(r)}static emptyPath(){return new Jn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ft{constructor(e){this.path=e}static fromPath(e){return new ft(rn.fromString(e))}static fromName(e){return new ft(rn.fromString(e).popFirst(5))}static empty(){return new ft(rn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&rn.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return rn.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ft(new rn(e.slice()))}}function O7(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,i=At.fromTimestamp(n===1e9?new In(r+1,0):new In(r,n));return new ml(i,ft.empty(),e)}function M7(t){return new ml(t.readTime,t.key,-1)}class ml{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new ml(At.min(),ft.empty(),-1)}static max(){return new ml(At.max(),ft.empty(),-1)}}function B7(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=ft.comparator(t.documentKey,e.documentKey),r!==0?r:ar(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j7="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class L7{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function t0(t){if(t.code!==Be.FAILED_PRECONDITION||t.message!==j7)throw t;tt("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Re{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&_t(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new Re((n,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(n,i)},this.catchCallback=s=>{this.wrapFailure(r,s).next(n,i)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof Re?r:Re.resolve(r)}catch(r){return Re.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):Re.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):Re.reject(r)}static resolve(e){return new Re((r,n)=>{r(e)})}static reject(e){return new Re((r,n)=>{n(e)})}static waitFor(e){return new Re((r,n)=>{let i=0,s=0,a=!1;e.forEach(o=>{++i,o.next(()=>{++s,a&&s===i&&r()},l=>n(l))}),a=!0,s===i&&r()})}static or(e){let r=Re.resolve(!1);for(const n of e)r=r.next(i=>i?Re.resolve(i):n());return r}static forEach(e,r){const n=[];return e.forEach((i,s)=>{n.push(r.call(this,i,s))}),this.waitFor(n)}static mapArray(e,r){return new Re((n,i)=>{const s=e.length,a=new Array(s);let o=0;for(let l=0;l<s;l++){const u=l;r(e[u]).next(f=>{a[u]=f,++o,o===s&&n(a)},f=>i(f))}})}static doWhile(e,r){return new Re((n,i)=>{const s=()=>{e()===!0?r().next(()=>{s()},i):n()};s()})}}function U7(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function r0(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nv{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ie(n),this.se=n=>r.writeSequenceNumber(n))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Nv.oe=-1;function Zp(t){return t==null}function hp(t){return t===0&&1/t==-1/0}function V7(t){return typeof t=="number"&&Number.isInteger(t)&&!hp(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yE(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function zu(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function sk(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jr{constructor(e,r){this.comparator=e,this.root=r||Xn.EMPTY}insert(e,r){return new Jr(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,Xn.BLACK,null,null))}remove(e){return new Jr(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Xn.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return r+n.left.size;i<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Z0(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Z0(this.root,e,this.comparator,!1)}getReverseIterator(){return new Z0(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Z0(this.root,e,this.comparator,!0)}}class Z0{constructor(e,r,n,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=r?n(e.key,r):1,r&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Xn{constructor(e,r,n,i,s){this.key=e,this.value=r,this.color=n??Xn.RED,this.left=i??Xn.EMPTY,this.right=s??Xn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,i,s){return new Xn(e??this.key,r??this.value,n??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let i=this;const s=n(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,r,n),null):s===0?i.copy(null,r,null,null,null):i.copy(null,null,null,null,i.right.insert(e,r,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Xn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,i=this;if(r(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,r),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),r(e,i.key)===0){if(i.right.isEmpty())return Xn.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,r))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Xn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Xn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw _t();const e=this.left.check();if(e!==this.right.check())throw _t();return e+(this.isRed()?0:1)}}Xn.EMPTY=null,Xn.RED=!0,Xn.BLACK=!1;Xn.EMPTY=new class{constructor(){this.size=0}get key(){throw _t()}get value(){throw _t()}get color(){throw _t()}get left(){throw _t()}get right(){throw _t()}copy(e,r,n,i,s){return this}insert(e,r,n){return new Xn(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ei{constructor(e){this.comparator=e,this.data=new Jr(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;r(i.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new _E(this.data.getIterator())}getIteratorFrom(e){return new _E(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof ei)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const i=r.getNext().key,s=n.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new ei(this.comparator);return r.data=e,r}}class _E{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ea{constructor(e){this.fields=e,e.sort(Jn.comparator)}static empty(){return new ea([])}unionWith(e){let r=new ei(Jn.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new ea(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return Cu(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ak extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ri{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new ak("Invalid base64 string: "+s):s}}(e);return new ri(r)}static fromUint8Array(e){const r=function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s}(e);return new ri(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ar(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ri.EMPTY_BYTE_STRING=new ri("");const z7=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function xl(t){if(mr(!!t),typeof t=="string"){let e=0;const r=z7.exec(t);if(mr(!!r),r[1]){let i=r[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:ln(t.seconds),nanos:ln(t.nanos)}}function ln(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function oc(t){return typeof t=="string"?ri.fromBase64String(t):ri.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rv(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="server_timestamp"}function Dv(t){const e=t.mapValue.fields.__previous_value__;return Rv(e)?Dv(e):e}function Rf(t){const e=xl(t.mapValue.fields.__local_write_time__.timestampValue);return new In(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W7{constructor(e,r,n,i,s,a,o,l,u){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=o,this.longPollingOptions=l,this.useFetchStreams=u}}class Df{constructor(e,r){this.projectId=e,this.database=r||"(default)"}static empty(){return new Df("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Df&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eh={mapValue:{}};function lc(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Rv(t)?4:H7(t)?9007199254740991:$7(t)?10:11:_t()}function Da(t,e){if(t===e)return!0;const r=lc(t);if(r!==lc(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Rf(t).isEqual(Rf(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const a=xl(i.timestampValue),o=xl(s.timestampValue);return a.seconds===o.seconds&&a.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return oc(i.bytesValue).isEqual(oc(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return ln(i.geoPointValue.latitude)===ln(s.geoPointValue.latitude)&&ln(i.geoPointValue.longitude)===ln(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return ln(i.integerValue)===ln(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const a=ln(i.doubleValue),o=ln(s.doubleValue);return a===o?hp(a)===hp(o):isNaN(a)&&isNaN(o)}return!1}(t,e);case 9:return Cu(t.arrayValue.values||[],e.arrayValue.values||[],Da);case 10:case 11:return function(i,s){const a=i.mapValue.fields||{},o=s.mapValue.fields||{};if(yE(a)!==yE(o))return!1;for(const l in a)if(a.hasOwnProperty(l)&&(o[l]===void 0||!Da(a[l],o[l])))return!1;return!0}(t,e);default:return _t()}}function Pf(t,e){return(t.values||[]).find(r=>Da(r,e))!==void 0}function ku(t,e){if(t===e)return 0;const r=lc(t),n=lc(e);if(r!==n)return ar(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return ar(t.booleanValue,e.booleanValue);case 2:return function(s,a){const o=ln(s.integerValue||s.doubleValue),l=ln(a.integerValue||a.doubleValue);return o<l?-1:o>l?1:o===l?0:isNaN(o)?isNaN(l)?0:-1:1}(t,e);case 3:return EE(t.timestampValue,e.timestampValue);case 4:return EE(Rf(t),Rf(e));case 5:return ar(t.stringValue,e.stringValue);case 6:return function(s,a){const o=oc(s),l=oc(a);return o.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(s,a){const o=s.split("/"),l=a.split("/");for(let u=0;u<o.length&&u<l.length;u++){const f=ar(o[u],l[u]);if(f!==0)return f}return ar(o.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,a){const o=ar(ln(s.latitude),ln(a.latitude));return o!==0?o:ar(ln(s.longitude),ln(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return SE(t.arrayValue,e.arrayValue);case 10:return function(s,a){var o,l,u,f;const p=s.fields||{},g=a.fields||{},m=(o=p.value)===null||o===void 0?void 0:o.arrayValue,y=(l=g.value)===null||l===void 0?void 0:l.arrayValue,x=ar(((u=m==null?void 0:m.values)===null||u===void 0?void 0:u.length)||0,((f=y==null?void 0:y.values)===null||f===void 0?void 0:f.length)||0);return x!==0?x:SE(m,y)}(t.mapValue,e.mapValue);case 11:return function(s,a){if(s===eh.mapValue&&a===eh.mapValue)return 0;if(s===eh.mapValue)return 1;if(a===eh.mapValue)return-1;const o=s.fields||{},l=Object.keys(o),u=a.fields||{},f=Object.keys(u);l.sort(),f.sort();for(let p=0;p<l.length&&p<f.length;++p){const g=ar(l[p],f[p]);if(g!==0)return g;const m=ku(o[l[p]],u[f[p]]);if(m!==0)return m}return ar(l.length,f.length)}(t.mapValue,e.mapValue);default:throw _t()}}function EE(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return ar(t,e);const r=xl(t),n=xl(e),i=ar(r.seconds,n.seconds);return i!==0?i:ar(r.nanos,n.nanos)}function SE(t,e){const r=t.values||[],n=e.values||[];for(let i=0;i<r.length&&i<n.length;++i){const s=ku(r[i],n[i]);if(s)return s}return ar(r.length,n.length)}function Fu(t){return bx(t)}function bx(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=xl(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return oc(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return ft.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",i=!0;for(const s of r.values||[])i?i=!1:n+=",",n+=bx(s);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let i="{",s=!0;for(const a of n)s?s=!1:i+=",",i+=`${a}:${bx(r.fields[a])}`;return i+"}"}(t.mapValue):_t()}function Ix(t){return!!t&&"integerValue"in t}function Pv(t){return!!t&&"arrayValue"in t}function wE(t){return!!t&&"nullValue"in t}function TE(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function yh(t){return!!t&&"mapValue"in t}function $7(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="__vector__"}function Kd(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return zu(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=Kd(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=Kd(t.arrayValue.values[r]);return e}return Object.assign({},t)}function H7(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ns{constructor(e){this.value=e}static empty(){return new Ns({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!yh(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=Kd(r)}setAll(e){let r=Jn.emptyPath(),n={},i=[];e.forEach((a,o)=>{if(!r.isImmediateParentOf(o)){const l=this.getFieldsMap(r);this.applyChanges(l,n,i),n={},i=[],r=o.popLast()}a?n[o.lastSegment()]=Kd(a):i.push(o.lastSegment())});const s=this.getFieldsMap(r);this.applyChanges(s,n,i)}delete(e){const r=this.field(e.popLast());yh(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return Da(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=r.mapValue.fields[e.get(n)];yh(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=i),r=i}return r.mapValue.fields}applyChanges(e,r,n){zu(r,(i,s)=>e[i]=s);for(const i of n)delete e[i]}clone(){return new Ns(Kd(this.value))}}function ok(t){const e=[];return zu(t.fields,(r,n)=>{const i=new Jn([r]);if(yh(n)){const s=ok(n.mapValue).fields;if(s.length===0)e.push(i);else for(const a of s)e.push(i.child(a))}else e.push(i)}),new ea(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gi{constructor(e,r,n,i,s,a,o){this.key=e,this.documentType=r,this.version=n,this.readTime=i,this.createTime=s,this.data=a,this.documentState=o}static newInvalidDocument(e){return new gi(e,0,At.min(),At.min(),At.min(),Ns.empty(),0)}static newFoundDocument(e,r,n,i){return new gi(e,1,r,At.min(),n,i,0)}static newNoDocument(e,r){return new gi(e,2,r,At.min(),At.min(),Ns.empty(),0)}static newUnknownDocument(e,r){return new gi(e,3,r,At.min(),At.min(),Ns.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(At.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ns.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ns.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=At.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof gi&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new gi(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pp{constructor(e,r){this.position=e,this.inclusive=r}}function AE(t,e,r){let n=0;for(let i=0;i<t.position.length;i++){const s=e[i],a=t.position[i];if(s.field.isKeyField()?n=ft.comparator(ft.fromName(a.referenceValue),r.key):n=ku(a,r.data.field(s.field)),s.dir==="desc"&&(n*=-1),n!==0)break}return n}function CE(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!Da(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gp{constructor(e,r="asc"){this.field=e,this.dir=r}}function G7(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lk{}class Fn extends lk{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new Y7(e,r,n):r==="array-contains"?new Q7(e,n):r==="in"?new J7(e,n):r==="not-in"?new Z7(e,n):r==="array-contains-any"?new eU(e,n):new Fn(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new X7(e,n):new q7(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&this.matchesComparison(ku(r,this.value)):r!==null&&lc(this.value)===lc(r)&&this.matchesComparison(ku(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return _t()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Pa extends lk{constructor(e,r){super(),this.filters=e,this.op=r,this.ae=null}static create(e,r){return new Pa(e,r)}matches(e){return ck(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function ck(t){return t.op==="and"}function uk(t){return K7(t)&&ck(t)}function K7(t){for(const e of t.filters)if(e instanceof Pa)return!1;return!0}function Nx(t){if(t instanceof Fn)return t.field.canonicalString()+t.op.toString()+Fu(t.value);if(uk(t))return t.filters.map(e=>Nx(e)).join(",");{const e=t.filters.map(r=>Nx(r)).join(",");return`${t.op}(${e})`}}function dk(t,e){return t instanceof Fn?function(n,i){return i instanceof Fn&&n.op===i.op&&n.field.isEqual(i.field)&&Da(n.value,i.value)}(t,e):t instanceof Pa?function(n,i){return i instanceof Pa&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((s,a,o)=>s&&dk(a,i.filters[o]),!0):!1}(t,e):void _t()}function fk(t){return t instanceof Fn?function(r){return`${r.field.canonicalString()} ${r.op} ${Fu(r.value)}`}(t):t instanceof Pa?function(r){return r.op.toString()+" {"+r.getFilters().map(fk).join(" ,")+"}"}(t):"Filter"}class Y7 extends Fn{constructor(e,r,n){super(e,r,n),this.key=ft.fromName(n.referenceValue)}matches(e){const r=ft.comparator(e.key,this.key);return this.matchesComparison(r)}}class X7 extends Fn{constructor(e,r){super(e,"in",r),this.keys=hk("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class q7 extends Fn{constructor(e,r){super(e,"not-in",r),this.keys=hk("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function hk(t,e){var r;return(((r=e.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(n=>ft.fromName(n.referenceValue))}class Q7 extends Fn{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return Pv(r)&&Pf(r.arrayValue,this.value)}}class J7 extends Fn{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&Pf(this.value.arrayValue,r)}}class Z7 extends Fn{constructor(e,r){super(e,"not-in",r)}matches(e){if(Pf(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&!Pf(this.value.arrayValue,r)}}class eU extends Fn{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!Pv(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>Pf(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tU{constructor(e,r=null,n=[],i=[],s=null,a=null,o=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=i,this.limit=s,this.startAt=a,this.endAt=o,this.ue=null}}function kE(t,e=null,r=[],n=[],i=null,s=null,a=null){return new tU(t,e,r,n,i,s,a)}function Ov(t){const e=Ct(t);if(e.ue===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>Nx(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(s){return s.field.canonicalString()+s.dir}(n)).join(","),Zp(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>Fu(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>Fu(n)).join(",")),e.ue=r}return e.ue}function Mv(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!G7(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!dk(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!CE(t.startAt,e.startAt)&&CE(t.endAt,e.endAt)}function Rx(t){return ft.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eg{constructor(e,r=null,n=[],i=[],s=null,a="F",o=null,l=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=i,this.limit=s,this.limitType=a,this.startAt=o,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function rU(t,e,r,n,i,s,a,o){return new eg(t,e,r,n,i,s,a,o)}function tg(t){return new eg(t)}function FE(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function nU(t){return t.collectionGroup!==null}function Yd(t){const e=Ct(t);if(e.ce===null){e.ce=[];const r=new Set;for(const s of e.explicitOrderBy)e.ce.push(s),r.add(s.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let o=new ei(Jn.comparator);return a.filters.forEach(l=>{l.getFlattenedFilters().forEach(u=>{u.isInequality()&&(o=o.add(u.field))})}),o})(e).forEach(s=>{r.has(s.canonicalString())||s.isKeyField()||e.ce.push(new gp(s,n))}),r.has(Jn.keyField().canonicalString())||e.ce.push(new gp(Jn.keyField(),n))}return e.ce}function ba(t){const e=Ct(t);return e.le||(e.le=iU(e,Yd(t))),e.le}function iU(t,e){if(t.limitType==="F")return kE(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new gp(i.field,s)});const r=t.endAt?new pp(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new pp(t.startAt.position,t.startAt.inclusive):null;return kE(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function Dx(t,e,r){return new eg(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function rg(t,e){return Mv(ba(t),ba(e))&&t.limitType===e.limitType}function pk(t){return`${Ov(ba(t))}|lt:${t.limitType}`}function Bc(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(i=>fk(i)).join(", ")}]`),Zp(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(i=>Fu(i)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(i=>Fu(i)).join(",")),`Target(${n})`}(ba(t))}; limitType=${t.limitType})`}function ng(t,e){return e.isFoundDocument()&&function(n,i){const s=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):ft.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)}(t,e)&&function(n,i){for(const s of Yd(n))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(n,i){for(const s of n.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(n,i){return!(n.startAt&&!function(a,o,l){const u=AE(a,o,l);return a.inclusive?u<=0:u<0}(n.startAt,Yd(n),i)||n.endAt&&!function(a,o,l){const u=AE(a,o,l);return a.inclusive?u>=0:u>0}(n.endAt,Yd(n),i))}(t,e)}function sU(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function gk(t){return(e,r)=>{let n=!1;for(const i of Yd(t)){const s=aU(i,e,r);if(s!==0)return s;n=n||i.field.isKeyField()}return 0}}function aU(t,e,r){const n=t.field.isKeyField()?ft.comparator(e.key,r.key):function(s,a,o){const l=a.data.field(s),u=o.data.field(s);return l!==null&&u!==null?ku(l,u):_t()}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return _t()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wu{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[i,s]of n)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,r]);i.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[r]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){zu(this.inner,(r,n)=>{for(const[i,s]of n)e(i,s)})}isEmpty(){return sk(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oU=new Jr(ft.comparator);function co(){return oU}const mk=new Jr(ft.comparator);function kd(...t){let e=mk;for(const r of t)e=e.insert(r.key,r);return e}function xk(t){let e=mk;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function Ll(){return Xd()}function vk(){return Xd()}function Xd(){return new Wu(t=>t.toString(),(t,e)=>t.isEqual(e))}const lU=new Jr(ft.comparator),cU=new ei(ft.comparator);function Wt(...t){let e=cU;for(const r of t)e=e.add(r);return e}const uU=new ei(ar);function dU(){return uU}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bv(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:hp(e)?"-0":e}}function yk(t){return{integerValue:""+t}}function fU(t,e){return V7(e)?yk(e):Bv(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ig{constructor(){this._=void 0}}function hU(t,e,r){return t instanceof mp?function(i,s){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Rv(s)&&(s=Dv(s)),s&&(a.fields.__previous_value__=s),{mapValue:a}}(r,e):t instanceof Of?Ek(t,e):t instanceof Mf?Sk(t,e):function(i,s){const a=_k(i,s),o=bE(a)+bE(i.Pe);return Ix(a)&&Ix(i.Pe)?yk(o):Bv(i.serializer,o)}(t,e)}function pU(t,e,r){return t instanceof Of?Ek(t,e):t instanceof Mf?Sk(t,e):r}function _k(t,e){return t instanceof xp?function(n){return Ix(n)||function(s){return!!s&&"doubleValue"in s}(n)}(e)?e:{integerValue:0}:null}class mp extends ig{}class Of extends ig{constructor(e){super(),this.elements=e}}function Ek(t,e){const r=wk(e);for(const n of t.elements)r.some(i=>Da(i,n))||r.push(n);return{arrayValue:{values:r}}}class Mf extends ig{constructor(e){super(),this.elements=e}}function Sk(t,e){let r=wk(e);for(const n of t.elements)r=r.filter(i=>!Da(i,n));return{arrayValue:{values:r}}}class xp extends ig{constructor(e,r){super(),this.serializer=e,this.Pe=r}}function bE(t){return ln(t.integerValue||t.doubleValue)}function wk(t){return Pv(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function gU(t,e){return t.field.isEqual(e.field)&&function(n,i){return n instanceof Of&&i instanceof Of||n instanceof Mf&&i instanceof Mf?Cu(n.elements,i.elements,Da):n instanceof xp&&i instanceof xp?Da(n.Pe,i.Pe):n instanceof mp&&i instanceof mp}(t.transform,e.transform)}class mU{constructor(e,r){this.version=e,this.transformResults=r}}class to{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new to}static exists(e){return new to(void 0,e)}static updateTime(e){return new to(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function _h(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class sg{}function Tk(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Ck(t.key,to.none()):new n0(t.key,t.data,to.none());{const r=t.data,n=Ns.empty();let i=new ei(Jn.comparator);for(let s of e.fields)if(!i.has(s)){let a=r.field(s);a===null&&s.length>1&&(s=s.popLast(),a=r.field(s)),a===null?n.delete(s):n.set(s,a),i=i.add(s)}return new vc(t.key,n,new ea(i.toArray()),to.none())}}function xU(t,e,r){t instanceof n0?function(i,s,a){const o=i.value.clone(),l=NE(i.fieldTransforms,s,a.transformResults);o.setAll(l),s.convertToFoundDocument(a.version,o).setHasCommittedMutations()}(t,e,r):t instanceof vc?function(i,s,a){if(!_h(i.precondition,s))return void s.convertToUnknownDocument(a.version);const o=NE(i.fieldTransforms,s,a.transformResults),l=s.data;l.setAll(Ak(i)),l.setAll(o),s.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(t,e,r):function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,r)}function qd(t,e,r,n){return t instanceof n0?function(s,a,o,l){if(!_h(s.precondition,a))return o;const u=s.value.clone(),f=RE(s.fieldTransforms,l,a);return u.setAll(f),a.convertToFoundDocument(a.version,u).setHasLocalMutations(),null}(t,e,r,n):t instanceof vc?function(s,a,o,l){if(!_h(s.precondition,a))return o;const u=RE(s.fieldTransforms,l,a),f=a.data;return f.setAll(Ak(s)),f.setAll(u),a.convertToFoundDocument(a.version,f).setHasLocalMutations(),o===null?null:o.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(p=>p.field))}(t,e,r,n):function(s,a,o){return _h(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):o}(t,e,r)}function vU(t,e){let r=null;for(const n of t.fieldTransforms){const i=e.data.field(n.field),s=_k(n.transform,i||null);s!=null&&(r===null&&(r=Ns.empty()),r.set(n.field,s))}return r||null}function IE(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&Cu(n,i,(s,a)=>gU(s,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class n0 extends sg{constructor(e,r,n,i=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class vc extends sg{constructor(e,r,n,i,s=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function Ak(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function NE(t,e,r){const n=new Map;mr(t.length===r.length);for(let i=0;i<r.length;i++){const s=t[i],a=s.transform,o=e.data.field(s.field);n.set(s.field,pU(a,o,r[i]))}return n}function RE(t,e,r){const n=new Map;for(const i of t){const s=i.transform,a=r.data.field(i.field);n.set(i.field,hU(s,a,e))}return n}class Ck extends sg{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class yU extends sg{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _U{constructor(e,r,n,i){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&xU(s,e,n[i])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=qd(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=qd(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=vk();return this.mutations.forEach(i=>{const s=e.get(i.key),a=s.overlayedDocument;let o=this.applyToLocalView(a,s.mutatedFields);o=r.has(i.key)?null:o;const l=Tk(a,o);l!==null&&n.set(i.key,l),a.isValidDocument()||a.convertToNoDocument(At.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),Wt())}isEqual(e){return this.batchId===e.batchId&&Cu(this.mutations,e.mutations,(r,n)=>IE(r,n))&&Cu(this.baseMutations,e.baseMutations,(r,n)=>IE(r,n))}}class jv{constructor(e,r,n,i){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=i}static from(e,r,n){mr(e.mutations.length===n.length);let i=function(){return lU}();const s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,n[a].version);return new jv(e,r,n,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EU{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SU{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var xn,Qt;function wU(t){switch(t){default:return _t();case Be.CANCELLED:case Be.UNKNOWN:case Be.DEADLINE_EXCEEDED:case Be.RESOURCE_EXHAUSTED:case Be.INTERNAL:case Be.UNAVAILABLE:case Be.UNAUTHENTICATED:return!1;case Be.INVALID_ARGUMENT:case Be.NOT_FOUND:case Be.ALREADY_EXISTS:case Be.PERMISSION_DENIED:case Be.FAILED_PRECONDITION:case Be.ABORTED:case Be.OUT_OF_RANGE:case Be.UNIMPLEMENTED:case Be.DATA_LOSS:return!0}}function kk(t){if(t===void 0)return lo("GRPC error has no .code"),Be.UNKNOWN;switch(t){case xn.OK:return Be.OK;case xn.CANCELLED:return Be.CANCELLED;case xn.UNKNOWN:return Be.UNKNOWN;case xn.DEADLINE_EXCEEDED:return Be.DEADLINE_EXCEEDED;case xn.RESOURCE_EXHAUSTED:return Be.RESOURCE_EXHAUSTED;case xn.INTERNAL:return Be.INTERNAL;case xn.UNAVAILABLE:return Be.UNAVAILABLE;case xn.UNAUTHENTICATED:return Be.UNAUTHENTICATED;case xn.INVALID_ARGUMENT:return Be.INVALID_ARGUMENT;case xn.NOT_FOUND:return Be.NOT_FOUND;case xn.ALREADY_EXISTS:return Be.ALREADY_EXISTS;case xn.PERMISSION_DENIED:return Be.PERMISSION_DENIED;case xn.FAILED_PRECONDITION:return Be.FAILED_PRECONDITION;case xn.ABORTED:return Be.ABORTED;case xn.OUT_OF_RANGE:return Be.OUT_OF_RANGE;case xn.UNIMPLEMENTED:return Be.UNIMPLEMENTED;case xn.DATA_LOSS:return Be.DATA_LOSS;default:return _t()}}(Qt=xn||(xn={}))[Qt.OK=0]="OK",Qt[Qt.CANCELLED=1]="CANCELLED",Qt[Qt.UNKNOWN=2]="UNKNOWN",Qt[Qt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Qt[Qt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Qt[Qt.NOT_FOUND=5]="NOT_FOUND",Qt[Qt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Qt[Qt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Qt[Qt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Qt[Qt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Qt[Qt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Qt[Qt.ABORTED=10]="ABORTED",Qt[Qt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Qt[Qt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Qt[Qt.INTERNAL=13]="INTERNAL",Qt[Qt.UNAVAILABLE=14]="UNAVAILABLE",Qt[Qt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TU(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AU=new Gl([4294967295,4294967295],0);function DE(t){const e=TU().encode(t),r=new QC;return r.update(e),new Uint8Array(r.digest())}function PE(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Gl([r,n],0),new Gl([i,s],0)]}class Lv{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new Fd(`Invalid padding: ${r}`);if(n<0)throw new Fd(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Fd(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new Fd(`Invalid padding when bitmap length is 0: ${r}`);this.Ie=8*e.length-r,this.Te=Gl.fromNumber(this.Ie)}Ee(e,r,n){let i=e.add(r.multiply(Gl.fromNumber(n)));return i.compare(AU)===1&&(i=new Gl([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const r=DE(e),[n,i]=PE(r);for(let s=0;s<this.hashCount;s++){const a=this.Ee(n,i,s);if(!this.de(a))return!1}return!0}static create(e,r,n){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new Lv(s,i,r);return n.forEach(o=>a.insert(o)),a}insert(e){if(this.Ie===0)return;const r=DE(e),[n,i]=PE(r);for(let s=0;s<this.hashCount;s++){const a=this.Ee(n,i,s);this.Ae(a)}}Ae(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class Fd extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ag{constructor(e,r,n,i,s){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const i=new Map;return i.set(e,i0.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new ag(At.min(),i,new Jr(ar),co(),Wt())}}class i0{constructor(e,r,n,i,s){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new i0(n,r,Wt(),Wt(),Wt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eh{constructor(e,r,n,i){this.Re=e,this.removedTargetIds=r,this.key=n,this.Ve=i}}class Fk{constructor(e,r){this.targetId=e,this.me=r}}class bk{constructor(e,r,n=ri.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=i}}class OE{constructor(){this.fe=0,this.ge=BE(),this.pe=ri.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Wt(),r=Wt(),n=Wt();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:r=r.add(i);break;case 1:n=n.add(i);break;default:_t()}}),new i0(this.pe,this.ye,e,r,n)}Ce(){this.we=!1,this.ge=BE()}Fe(e,r){this.we=!0,this.ge=this.ge.insert(e,r)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,mr(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class CU{constructor(e){this.Le=e,this.Be=new Map,this.ke=co(),this.qe=ME(),this.Qe=new Jr(ar)}Ke(e){for(const r of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(r,e.Ve):this.Ue(r,e.key,e.Ve);for(const r of e.removedTargetIds)this.Ue(r,e.key,e.Ve)}We(e){this.forEachTarget(e,r=>{const n=this.Ge(r);switch(e.state){case 0:this.ze(r)&&n.De(e.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(e.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(r);break;case 3:this.ze(r)&&(n.Ne(),n.De(e.resumeToken));break;case 4:this.ze(r)&&(this.je(r),n.De(e.resumeToken));break;default:_t()}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.Be.forEach((n,i)=>{this.ze(i)&&r(i)})}He(e){const r=e.targetId,n=e.me.count,i=this.Je(r);if(i){const s=i.target;if(Rx(s))if(n===0){const a=new ft(s.path);this.Ue(r,a,gi.newNoDocument(a,At.min()))}else mr(n===1);else{const a=this.Ye(r);if(a!==n){const o=this.Ze(e),l=o?this.Xe(o,e,a):1;if(l!==0){this.je(r);const u=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(r,u)}}}}}Ze(e){const r=e.me.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:s=0}=r;let a,o;try{a=oc(n).toUint8Array()}catch(l){if(l instanceof ak)return Au("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{o=new Lv(a,i,s)}catch(l){return Au(l instanceof Fd?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return o.Ie===0?null:o}Xe(e,r,n){return r.me.count===n-this.nt(e,r.targetId)?0:2}nt(e,r){const n=this.Le.getRemoteKeysForTarget(r);let i=0;return n.forEach(s=>{const a=this.Le.tt(),o=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(o)||(this.Ue(r,s,null),i++)}),i}rt(e){const r=new Map;this.Be.forEach((s,a)=>{const o=this.Je(a);if(o){if(s.current&&Rx(o.target)){const l=new ft(o.target.path);this.ke.get(l)!==null||this.it(a,l)||this.Ue(a,l,gi.newNoDocument(l,e))}s.be&&(r.set(a,s.ve()),s.Ce())}});let n=Wt();this.qe.forEach((s,a)=>{let o=!0;a.forEachWhile(l=>{const u=this.Je(l);return!u||u.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)}),o&&(n=n.add(s))}),this.ke.forEach((s,a)=>a.setReadTime(e));const i=new ag(e,r,this.Qe,this.ke,n);return this.ke=co(),this.qe=ME(),this.Qe=new Jr(ar),i}$e(e,r){if(!this.ze(e))return;const n=this.it(e,r.key)?2:0;this.Ge(e).Fe(r.key,n),this.ke=this.ke.insert(r.key,r),this.qe=this.qe.insert(r.key,this.st(r.key).add(e))}Ue(e,r,n){if(!this.ze(e))return;const i=this.Ge(e);this.it(e,r)?i.Fe(r,1):i.Me(r),this.qe=this.qe.insert(r,this.st(r).delete(e)),n&&(this.ke=this.ke.insert(r,n))}removeTarget(e){this.Be.delete(e)}Ye(e){const r=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let r=this.Be.get(e);return r||(r=new OE,this.Be.set(e,r)),r}st(e){let r=this.qe.get(e);return r||(r=new ei(ar),this.qe=this.qe.insert(e,r)),r}ze(e){const r=this.Je(e)!==null;return r||tt("WatchChangeAggregator","Detected inactive target",e),r}Je(e){const r=this.Be.get(e);return r&&r.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new OE),this.Le.getRemoteKeysForTarget(e).forEach(r=>{this.Ue(e,r,null)})}it(e,r){return this.Le.getRemoteKeysForTarget(e).has(r)}}function ME(){return new Jr(ft.comparator)}function BE(){return new Jr(ft.comparator)}const kU={asc:"ASCENDING",desc:"DESCENDING"},FU={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},bU={and:"AND",or:"OR"};class IU{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function Px(t,e){return t.useProto3Json||Zp(e)?e:{value:e}}function vp(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Ik(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function NU(t,e){return vp(t,e.toTimestamp())}function Ia(t){return mr(!!t),At.fromTimestamp(function(r){const n=xl(r);return new In(n.seconds,n.nanos)}(t))}function Uv(t,e){return Ox(t,e).canonicalString()}function Ox(t,e){const r=function(i){return new rn(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?r:r.child(e)}function Nk(t){const e=rn.fromString(t);return mr(Mk(e)),e}function Mx(t,e){return Uv(t.databaseId,e.path)}function fm(t,e){const r=Nk(e);if(r.get(1)!==t.databaseId.projectId)throw new ct(Be.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new ct(Be.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new ft(Dk(r))}function Rk(t,e){return Uv(t.databaseId,e)}function RU(t){const e=Nk(t);return e.length===4?rn.emptyPath():Dk(e)}function Bx(t){return new rn(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Dk(t){return mr(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function jE(t,e,r){return{name:Mx(t,e),fields:r.value.mapValue.fields}}function DU(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:_t()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(u,f){return u.useProto3Json?(mr(f===void 0||typeof f=="string"),ri.fromBase64String(f||"")):(mr(f===void 0||f instanceof Buffer||f instanceof Uint8Array),ri.fromUint8Array(f||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,o=a&&function(u){const f=u.code===void 0?Be.UNKNOWN:kk(u.code);return new ct(f,u.message||"")}(a);r=new bk(n,i,s,o||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const i=fm(t,n.document.name),s=Ia(n.document.updateTime),a=n.document.createTime?Ia(n.document.createTime):At.min(),o=new Ns({mapValue:{fields:n.document.fields}}),l=gi.newFoundDocument(i,s,a,o),u=n.targetIds||[],f=n.removedTargetIds||[];r=new Eh(u,f,l.key,l)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const i=fm(t,n.document),s=n.readTime?Ia(n.readTime):At.min(),a=gi.newNoDocument(i,s),o=n.removedTargetIds||[];r=new Eh([],o,a.key,a)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const i=fm(t,n.document),s=n.removedTargetIds||[];r=new Eh([],s,i,null)}else{if(!("filter"in e))return _t();{e.filter;const n=e.filter;n.targetId;const{count:i=0,unchangedNames:s}=n,a=new SU(i,s),o=n.targetId;r=new Fk(o,a)}}return r}function PU(t,e){let r;if(e instanceof n0)r={update:jE(t,e.key,e.value)};else if(e instanceof Ck)r={delete:Mx(t,e.key)};else if(e instanceof vc)r={update:jE(t,e.key,e.data),updateMask:WU(e.fieldMask)};else{if(!(e instanceof yU))return _t();r={verify:Mx(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(s,a){const o=a.transform;if(o instanceof mp)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof Of)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof Mf)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof xp)return{fieldPath:a.field.canonicalString(),increment:o.Pe};throw _t()}(0,n))),e.precondition.isNone||(r.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:NU(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:_t()}(t,e.precondition)),r}function OU(t,e){return t&&t.length>0?(mr(e!==void 0),t.map(r=>function(i,s){let a=i.updateTime?Ia(i.updateTime):Ia(s);return a.isEqual(At.min())&&(a=Ia(s)),new mU(a,i.transformResults||[])}(r,e))):[]}function MU(t,e){return{documents:[Rk(t,e.path)]}}function BU(t,e){const r={structuredQuery:{}},n=e.path;let i;e.collectionGroup!==null?(i=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=Rk(t,i);const s=function(u){if(u.length!==0)return Ok(Pa.create(u,"and"))}(e.filters);s&&(r.structuredQuery.where=s);const a=function(u){if(u.length!==0)return u.map(f=>function(g){return{field:jc(g.field),direction:UU(g.dir)}}(f))}(e.orderBy);a&&(r.structuredQuery.orderBy=a);const o=Px(t,e.limit);return o!==null&&(r.structuredQuery.limit=o),e.startAt&&(r.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{_t:r,parent:i}}function jU(t){let e=RU(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let i=null;if(n>0){mr(n===1);const f=r.from[0];f.allDescendants?i=f.collectionId:e=e.child(f.collectionId)}let s=[];r.where&&(s=function(p){const g=Pk(p);return g instanceof Pa&&uk(g)?g.getFilters():[g]}(r.where));let a=[];r.orderBy&&(a=function(p){return p.map(g=>function(y){return new gp(Lc(y.field),function(S){switch(S){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(y.direction))}(g))}(r.orderBy));let o=null;r.limit&&(o=function(p){let g;return g=typeof p=="object"?p.value:p,Zp(g)?null:g}(r.limit));let l=null;r.startAt&&(l=function(p){const g=!!p.before,m=p.values||[];return new pp(m,g)}(r.startAt));let u=null;return r.endAt&&(u=function(p){const g=!p.before,m=p.values||[];return new pp(m,g)}(r.endAt)),rU(e,i,a,s,o,"F",l,u)}function LU(t,e){const r=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return _t()}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function Pk(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=Lc(r.unaryFilter.field);return Fn.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=Lc(r.unaryFilter.field);return Fn.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Lc(r.unaryFilter.field);return Fn.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=Lc(r.unaryFilter.field);return Fn.create(a,"!=",{nullValue:"NULL_VALUE"});default:return _t()}}(t):t.fieldFilter!==void 0?function(r){return Fn.create(Lc(r.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return _t()}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return Pa.create(r.compositeFilter.filters.map(n=>Pk(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return _t()}}(r.compositeFilter.op))}(t):_t()}function UU(t){return kU[t]}function VU(t){return FU[t]}function zU(t){return bU[t]}function jc(t){return{fieldPath:t.canonicalString()}}function Lc(t){return Jn.fromServerFormat(t.fieldPath)}function Ok(t){return t instanceof Fn?function(r){if(r.op==="=="){if(TE(r.value))return{unaryFilter:{field:jc(r.field),op:"IS_NAN"}};if(wE(r.value))return{unaryFilter:{field:jc(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(TE(r.value))return{unaryFilter:{field:jc(r.field),op:"IS_NOT_NAN"}};if(wE(r.value))return{unaryFilter:{field:jc(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:jc(r.field),op:VU(r.op),value:r.value}}}(t):t instanceof Pa?function(r){const n=r.getFilters().map(i=>Ok(i));return n.length===1?n[0]:{compositeFilter:{op:zU(r.op),filters:n}}}(t):_t()}function WU(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function Mk(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qo{constructor(e,r,n,i,s=At.min(),a=At.min(),o=ri.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=o,this.expectedCount=l}withSequenceNumber(e){return new qo(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new qo(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new qo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new qo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $U{constructor(e){this.ct=e}}function HU(t){const e=jU({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Dx(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GU{constructor(){this.un=new KU}addToCollectionParentIndex(e,r){return this.un.add(r),Re.resolve()}getCollectionParents(e,r){return Re.resolve(this.un.getEntries(r))}addFieldIndex(e,r){return Re.resolve()}deleteFieldIndex(e,r){return Re.resolve()}deleteAllFieldIndexes(e){return Re.resolve()}createTargetIndexes(e,r){return Re.resolve()}getDocumentsMatchingTarget(e,r){return Re.resolve(null)}getIndexType(e,r){return Re.resolve(0)}getFieldIndexes(e,r){return Re.resolve([])}getNextCollectionGroupToUpdate(e){return Re.resolve(null)}getMinOffset(e,r){return Re.resolve(ml.min())}getMinOffsetFromCollectionGroup(e,r){return Re.resolve(ml.min())}updateCollectionGroup(e,r,n){return Re.resolve()}updateIndexEntries(e,r){return Re.resolve()}}class KU{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r]||new ei(rn.comparator),s=!i.has(n);return this.index[r]=i.add(n),s}has(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r];return i&&i.has(n)}getEntries(e){return(this.index[e]||new ei(rn.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bu{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new bu(0)}static kn(){return new bu(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YU{constructor(){this.changes=new Wu(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,gi.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?Re.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XU{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qU{constructor(e,r,n,i){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,r))).next(i=>(n!==null&&qd(n.mutation,i,ea.empty(),In.now()),i))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,Wt()).next(()=>n))}getLocalViewOfDocuments(e,r,n=Wt()){const i=Ll();return this.populateOverlays(e,i,r).next(()=>this.computeViews(e,r,i,n).next(s=>{let a=kd();return s.forEach((o,l)=>{a=a.insert(o,l.overlayedDocument)}),a}))}getOverlayedDocuments(e,r){const n=Ll();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,Wt()))}populateOverlays(e,r,n){const i=[];return n.forEach(s=>{r.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((a,o)=>{r.set(a,o)})})}computeViews(e,r,n,i){let s=co();const a=Xd(),o=function(){return Xd()}();return r.forEach((l,u)=>{const f=n.get(u.key);i.has(u.key)&&(f===void 0||f.mutation instanceof vc)?s=s.insert(u.key,u):f!==void 0?(a.set(u.key,f.mutation.getFieldMask()),qd(f.mutation,u,f.mutation.getFieldMask(),In.now())):a.set(u.key,ea.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((u,f)=>a.set(u,f)),r.forEach((u,f)=>{var p;return o.set(u,new XU(f,(p=a.get(u))!==null&&p!==void 0?p:null))}),o))}recalculateAndSaveOverlays(e,r){const n=Xd();let i=new Jr((a,o)=>a-o),s=Wt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(a=>{for(const o of a)o.keys().forEach(l=>{const u=r.get(l);if(u===null)return;let f=n.get(l)||ea.empty();f=o.applyToLocalView(u,f),n.set(l,f);const p=(i.get(o.batchId)||Wt()).add(l);i=i.insert(o.batchId,p)})}).next(()=>{const a=[],o=i.getReverseIterator();for(;o.hasNext();){const l=o.getNext(),u=l.key,f=l.value,p=vk();f.forEach(g=>{if(!s.has(g)){const m=Tk(r.get(g),n.get(g));m!==null&&p.set(g,m),s=s.add(g)}}),a.push(this.documentOverlayCache.saveOverlays(e,u,p))}return Re.waitFor(a)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,i){return function(a){return ft.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):nU(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,i):this.getDocumentsMatchingCollectionQuery(e,r,n,i)}getNextDocuments(e,r,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,i).next(s=>{const a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,i-s.size):Re.resolve(Ll());let o=-1,l=s;return a.next(u=>Re.forEach(u,(f,p)=>(o<p.largestBatchId&&(o=p.largestBatchId),s.get(f)?Re.resolve():this.remoteDocumentCache.getEntry(e,f).next(g=>{l=l.insert(f,g)}))).next(()=>this.populateOverlays(e,u,s)).next(()=>this.computeViews(e,l,u,Wt())).next(f=>({batchId:o,changes:xk(f)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new ft(r)).next(n=>{let i=kd();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,r,n,i){const s=r.collectionGroup;let a=kd();return this.indexManager.getCollectionParents(e,s).next(o=>Re.forEach(o,l=>{const u=function(p,g){return new eg(g,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)}(r,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,u,n,i).next(f=>{f.forEach((p,g)=>{a=a.insert(p,g)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,r,n,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,s,i))).next(a=>{s.forEach((l,u)=>{const f=u.getKey();a.get(f)===null&&(a=a.insert(f,gi.newInvalidDocument(f)))});let o=kd();return a.forEach((l,u)=>{const f=s.get(l);f!==void 0&&qd(f.mutation,u,ea.empty(),In.now()),ng(r,u)&&(o=o.insert(l,u))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QU{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,r){return Re.resolve(this.hr.get(r))}saveBundleMetadata(e,r){return this.hr.set(r.id,function(i){return{id:i.id,version:i.version,createTime:Ia(i.createTime)}}(r)),Re.resolve()}getNamedQuery(e,r){return Re.resolve(this.Pr.get(r))}saveNamedQuery(e,r){return this.Pr.set(r.name,function(i){return{name:i.name,query:HU(i.bundledQuery),readTime:Ia(i.readTime)}}(r)),Re.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JU{constructor(){this.overlays=new Jr(ft.comparator),this.Ir=new Map}getOverlay(e,r){return Re.resolve(this.overlays.get(r))}getOverlays(e,r){const n=Ll();return Re.forEach(r,i=>this.getOverlay(e,i).next(s=>{s!==null&&n.set(i,s)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((i,s)=>{this.ht(e,r,s)}),Re.resolve()}removeOverlaysForBatchId(e,r,n){const i=this.Ir.get(n);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(n)),Re.resolve()}getOverlaysForCollection(e,r,n){const i=Ll(),s=r.length+1,a=new ft(r.child("")),o=this.overlays.getIteratorFrom(a);for(;o.hasNext();){const l=o.getNext().value,u=l.getKey();if(!r.isPrefixOf(u.path))break;u.path.length===s&&l.largestBatchId>n&&i.set(l.getKey(),l)}return Re.resolve(i)}getOverlaysForCollectionGroup(e,r,n,i){let s=new Jr((u,f)=>u-f);const a=this.overlays.getIterator();for(;a.hasNext();){const u=a.getNext().value;if(u.getKey().getCollectionGroup()===r&&u.largestBatchId>n){let f=s.get(u.largestBatchId);f===null&&(f=Ll(),s=s.insert(u.largestBatchId,f)),f.set(u.getKey(),u)}}const o=Ll(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((u,f)=>o.set(u,f)),!(o.size()>=i)););return Re.resolve(o)}ht(e,r,n){const i=this.overlays.get(n.key);if(i!==null){const a=this.Ir.get(i.largestBatchId).delete(n.key);this.Ir.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(n.key,new EU(r,n));let s=this.Ir.get(r);s===void 0&&(s=Wt(),this.Ir.set(r,s)),this.Ir.set(r,s.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZU{constructor(){this.sessionToken=ri.EMPTY_BYTE_STRING}getSessionToken(e){return Re.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,Re.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vv{constructor(){this.Tr=new ei(Bn.Er),this.dr=new ei(Bn.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,r){const n=new Bn(e,r);this.Tr=this.Tr.add(n),this.dr=this.dr.add(n)}Rr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Vr(new Bn(e,r))}mr(e,r){e.forEach(n=>this.removeReference(n,r))}gr(e){const r=new ft(new rn([])),n=new Bn(r,e),i=new Bn(r,e+1),s=[];return this.dr.forEachInRange([n,i],a=>{this.Vr(a),s.push(a.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const r=new ft(new rn([])),n=new Bn(r,e),i=new Bn(r,e+1);let s=Wt();return this.dr.forEachInRange([n,i],a=>{s=s.add(a.key)}),s}containsKey(e){const r=new Bn(e,0),n=this.Tr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class Bn{constructor(e,r){this.key=e,this.wr=r}static Er(e,r){return ft.comparator(e.key,r.key)||ar(e.wr,r.wr)}static Ar(e,r){return ar(e.wr,r.wr)||ft.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eV{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.Sr=1,this.br=new ei(Bn.Er)}checkEmpty(e){return Re.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,i){const s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new _U(s,r,n,i);this.mutationQueue.push(a);for(const o of i)this.br=this.br.add(new Bn(o.key,s)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return Re.resolve(a)}lookupMutationBatch(e,r){return Re.resolve(this.Dr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,i=this.vr(n),s=i<0?0:i;return Re.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return Re.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return Re.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new Bn(r,0),i=new Bn(r,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([n,i],a=>{const o=this.Dr(a.wr);s.push(o)}),Re.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new ei(ar);return r.forEach(i=>{const s=new Bn(i,0),a=new Bn(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,a],o=>{n=n.add(o.wr)})}),Re.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,i=n.length+1;let s=n;ft.isDocumentKey(s)||(s=s.child(""));const a=new Bn(new ft(s),0);let o=new ei(ar);return this.br.forEachWhile(l=>{const u=l.key.path;return!!n.isPrefixOf(u)&&(u.length===i&&(o=o.add(l.wr)),!0)},a),Re.resolve(this.Cr(o))}Cr(e){const r=[];return e.forEach(n=>{const i=this.Dr(n);i!==null&&r.push(i)}),r}removeMutationBatch(e,r){mr(this.Fr(r.batchId,"removed")===0),this.mutationQueue.shift();let n=this.br;return Re.forEach(r.mutations,i=>{const s=new Bn(i.key,r.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=n})}On(e){}containsKey(e,r){const n=new Bn(r,0),i=this.br.firstAfterOrEqual(n);return Re.resolve(r.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,Re.resolve()}Fr(e,r){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const r=this.vr(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tV{constructor(e){this.Mr=e,this.docs=function(){return new Jr(ft.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,i=this.docs.get(n),s=i?i.size:0,a=this.Mr(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return Re.resolve(n?n.document.mutableCopy():gi.newInvalidDocument(r))}getEntries(e,r){let n=co();return r.forEach(i=>{const s=this.docs.get(i);n=n.insert(i,s?s.document.mutableCopy():gi.newInvalidDocument(i))}),Re.resolve(n)}getDocumentsMatchingQuery(e,r,n,i){let s=co();const a=r.path,o=new ft(a.child("")),l=this.docs.getIteratorFrom(o);for(;l.hasNext();){const{key:u,value:{document:f}}=l.getNext();if(!a.isPrefixOf(u.path))break;u.path.length>a.length+1||B7(M7(f),n)<=0||(i.has(f.key)||ng(r,f))&&(s=s.insert(f.key,f.mutableCopy()))}return Re.resolve(s)}getAllFromCollectionGroup(e,r,n,i){_t()}Or(e,r){return Re.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new rV(this)}getSize(e){return Re.resolve(this.size)}}class rV extends YU{constructor(e){super(),this.cr=e}applyChanges(e){const r=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?r.push(this.cr.addEntry(e,i)):this.cr.removeEntry(n)}),Re.waitFor(r)}getFromCache(e,r){return this.cr.getEntry(e,r)}getAllFromCache(e,r){return this.cr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nV{constructor(e){this.persistence=e,this.Nr=new Wu(r=>Ov(r),Mv),this.lastRemoteSnapshotVersion=At.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Vv,this.targetCount=0,this.kr=bu.Bn()}forEachTarget(e,r){return this.Nr.forEach((n,i)=>r(i)),Re.resolve()}getLastRemoteSnapshotVersion(e){return Re.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Re.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),Re.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.Lr&&(this.Lr=r),Re.resolve()}Kn(e){this.Nr.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.kr=new bu(r),this.highestTargetId=r),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,r){return this.Kn(r),this.targetCount+=1,Re.resolve()}updateTargetData(e,r){return this.Kn(r),Re.resolve()}removeTargetData(e,r){return this.Nr.delete(r.target),this.Br.gr(r.targetId),this.targetCount-=1,Re.resolve()}removeTargets(e,r,n){let i=0;const s=[];return this.Nr.forEach((a,o)=>{o.sequenceNumber<=r&&n.get(o.targetId)===null&&(this.Nr.delete(a),s.push(this.removeMatchingKeysForTargetId(e,o.targetId)),i++)}),Re.waitFor(s).next(()=>i)}getTargetCount(e){return Re.resolve(this.targetCount)}getTargetData(e,r){const n=this.Nr.get(r)||null;return Re.resolve(n)}addMatchingKeys(e,r,n){return this.Br.Rr(r,n),Re.resolve()}removeMatchingKeys(e,r,n){this.Br.mr(r,n);const i=this.persistence.referenceDelegate,s=[];return i&&r.forEach(a=>{s.push(i.markPotentiallyOrphaned(e,a))}),Re.waitFor(s)}removeMatchingKeysForTargetId(e,r){return this.Br.gr(r),Re.resolve()}getMatchingKeysForTargetId(e,r){const n=this.Br.yr(r);return Re.resolve(n)}containsKey(e,r){return Re.resolve(this.Br.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iV{constructor(e,r){this.qr={},this.overlays={},this.Qr=new Nv(0),this.Kr=!1,this.Kr=!0,this.$r=new ZU,this.referenceDelegate=e(this),this.Ur=new nV(this),this.indexManager=new GU,this.remoteDocumentCache=function(i){return new tV(i)}(n=>this.referenceDelegate.Wr(n)),this.serializer=new $U(r),this.Gr=new QU(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new JU,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.qr[e.toKey()];return n||(n=new eV(r,this.referenceDelegate),this.qr[e.toKey()]=n),n}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,r,n){tt("MemoryPersistence","Starting transaction:",e);const i=new sV(this.Qr.next());return this.referenceDelegate.zr(),n(i).next(s=>this.referenceDelegate.jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Hr(e,r){return Re.or(Object.values(this.qr).map(n=>()=>n.containsKey(e,r)))}}class sV extends L7{constructor(e){super(),this.currentSequenceNumber=e}}class zv{constructor(e){this.persistence=e,this.Jr=new Vv,this.Yr=null}static Zr(e){return new zv(e)}get Xr(){if(this.Yr)return this.Yr;throw _t()}addReference(e,r,n){return this.Jr.addReference(n,r),this.Xr.delete(n.toString()),Re.resolve()}removeReference(e,r,n){return this.Jr.removeReference(n,r),this.Xr.add(n.toString()),Re.resolve()}markPotentiallyOrphaned(e,r){return this.Xr.add(r.toString()),Re.resolve()}removeTarget(e,r){this.Jr.gr(r.targetId).forEach(i=>this.Xr.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(i=>{i.forEach(s=>this.Xr.add(s.toString()))}).next(()=>n.removeTargetData(e,r))}zr(){this.Yr=new Set}jr(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Re.forEach(this.Xr,n=>{const i=ft.fromPath(n);return this.ei(e,i).next(s=>{s||r.removeEntry(i,At.min())})}).next(()=>(this.Yr=null,r.apply(e)))}updateLimboDocument(e,r){return this.ei(e,r).next(n=>{n?this.Xr.delete(r.toString()):this.Xr.add(r.toString())})}Wr(e){return 0}ei(e,r){return Re.or([()=>Re.resolve(this.Jr.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Hr(e,r)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wv{constructor(e,r,n,i){this.targetId=e,this.fromCache=r,this.$i=n,this.Ui=i}static Wi(e,r){let n=Wt(),i=Wt();for(const s of r.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new Wv(e,r.fromCache,n,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aV{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oV{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return o9()?8:U7(_i())>0?6:4}()}initialize(e,r){this.Ji=e,this.indexManager=r,this.Gi=!0}getDocumentsMatchingQuery(e,r,n,i){const s={result:null};return this.Yi(e,r).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.Zi(e,r,i,n).next(a=>{s.result=a})}).next(()=>{if(s.result)return;const a=new aV;return this.Xi(e,r,a).next(o=>{if(s.result=o,this.zi)return this.es(e,r,a,o.size)})}).next(()=>s.result)}es(e,r,n,i){return n.documentReadCount<this.ji?(xd()<=Ht.DEBUG&&tt("QueryEngine","SDK will not create cache indexes for query:",Bc(r),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),Re.resolve()):(xd()<=Ht.DEBUG&&tt("QueryEngine","Query:",Bc(r),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.Hi*i?(xd()<=Ht.DEBUG&&tt("QueryEngine","The SDK decides to create cache indexes for query:",Bc(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ba(r))):Re.resolve())}Yi(e,r){if(FE(r))return Re.resolve(null);let n=ba(r);return this.indexManager.getIndexType(e,n).next(i=>i===0?null:(r.limit!==null&&i===1&&(r=Dx(r,null,"F"),n=ba(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(s=>{const a=Wt(...s);return this.Ji.getDocuments(e,a).next(o=>this.indexManager.getMinOffset(e,n).next(l=>{const u=this.ts(r,o);return this.ns(r,u,a,l.readTime)?this.Yi(e,Dx(r,null,"F")):this.rs(e,u,r,l)}))})))}Zi(e,r,n,i){return FE(r)||i.isEqual(At.min())?Re.resolve(null):this.Ji.getDocuments(e,n).next(s=>{const a=this.ts(r,s);return this.ns(r,a,n,i)?Re.resolve(null):(xd()<=Ht.DEBUG&&tt("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Bc(r)),this.rs(e,a,r,O7(i,-1)).next(o=>o))})}ts(e,r){let n=new ei(gk(e));return r.forEach((i,s)=>{ng(e,s)&&(n=n.add(s))}),n}ns(e,r,n,i){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const s=e.limitType==="F"?r.last():r.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Xi(e,r,n){return xd()<=Ht.DEBUG&&tt("QueryEngine","Using full collection scan to execute query:",Bc(r)),this.Ji.getDocumentsMatchingQuery(e,r,ml.min(),n)}rs(e,r,n,i){return this.Ji.getDocumentsMatchingQuery(e,n,i).next(s=>(r.forEach(a=>{s=s.insert(a.key,a)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lV{constructor(e,r,n,i){this.persistence=e,this.ss=r,this.serializer=i,this.os=new Jr(ar),this._s=new Wu(s=>Ov(s),Mv),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(n)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new qU(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.os))}}function cV(t,e,r,n){return new lV(t,e,r,n)}async function Bk(t,e){const r=Ct(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let i;return r.mutationQueue.getAllMutationBatches(n).next(s=>(i=s,r.ls(e),r.mutationQueue.getAllMutationBatches(n))).next(s=>{const a=[],o=[];let l=Wt();for(const u of i){a.push(u.batchId);for(const f of u.mutations)l=l.add(f.key)}for(const u of s){o.push(u.batchId);for(const f of u.mutations)l=l.add(f.key)}return r.localDocuments.getDocuments(n,l).next(u=>({hs:u,removedBatchIds:a,addedBatchIds:o}))})})}function uV(t,e){const r=Ct(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=e.batch.keys(),s=r.cs.newChangeBuffer({trackRemovals:!0});return function(o,l,u,f){const p=u.batch,g=p.keys();let m=Re.resolve();return g.forEach(y=>{m=m.next(()=>f.getEntry(l,y)).next(x=>{const S=u.docVersions.get(y);mr(S!==null),x.version.compareTo(S)<0&&(p.applyToRemoteDocument(x,u),x.isValidDocument()&&(x.setReadTime(u.commitVersion),f.addEntry(x)))})}),m.next(()=>o.mutationQueue.removeMutationBatch(l,p))}(r,n,e,s).next(()=>s.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(o){let l=Wt();for(let u=0;u<o.mutationResults.length;++u)o.mutationResults[u].transformResults.length>0&&(l=l.add(o.batch.mutations[u].key));return l}(e))).next(()=>r.localDocuments.getDocuments(n,i))})}function jk(t){const e=Ct(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Ur.getLastRemoteSnapshotVersion(r))}function dV(t,e){const r=Ct(t),n=e.snapshotVersion;let i=r.os;return r.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const a=r.cs.newChangeBuffer({trackRemovals:!0});i=r.os;const o=[];e.targetChanges.forEach((f,p)=>{const g=i.get(p);if(!g)return;o.push(r.Ur.removeMatchingKeys(s,f.removedDocuments,p).next(()=>r.Ur.addMatchingKeys(s,f.addedDocuments,p)));let m=g.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(p)!==null?m=m.withResumeToken(ri.EMPTY_BYTE_STRING,At.min()).withLastLimboFreeSnapshotVersion(At.min()):f.resumeToken.approximateByteSize()>0&&(m=m.withResumeToken(f.resumeToken,n)),i=i.insert(p,m),function(x,S,A){return x.resumeToken.approximateByteSize()===0||S.snapshotVersion.toMicroseconds()-x.snapshotVersion.toMicroseconds()>=3e8?!0:A.addedDocuments.size+A.modifiedDocuments.size+A.removedDocuments.size>0}(g,m,f)&&o.push(r.Ur.updateTargetData(s,m))});let l=co(),u=Wt();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&o.push(r.persistence.referenceDelegate.updateLimboDocument(s,f))}),o.push(fV(s,a,e.documentUpdates).next(f=>{l=f.Ps,u=f.Is})),!n.isEqual(At.min())){const f=r.Ur.getLastRemoteSnapshotVersion(s).next(p=>r.Ur.setTargetsMetadata(s,s.currentSequenceNumber,n));o.push(f)}return Re.waitFor(o).next(()=>a.apply(s)).next(()=>r.localDocuments.getLocalViewOfDocuments(s,l,u)).next(()=>l)}).then(s=>(r.os=i,s))}function fV(t,e,r){let n=Wt(),i=Wt();return r.forEach(s=>n=n.add(s)),e.getEntries(t,n).next(s=>{let a=co();return r.forEach((o,l)=>{const u=s.get(o);l.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(o)),l.isNoDocument()&&l.version.isEqual(At.min())?(e.removeEntry(o,l.readTime),a=a.insert(o,l)):!u.isValidDocument()||l.version.compareTo(u.version)>0||l.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(l),a=a.insert(o,l)):tt("LocalStore","Ignoring outdated watch update for ",o,". Current version:",u.version," Watch version:",l.version)}),{Ps:a,Is:i}})}function hV(t,e){const r=Ct(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=-1),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function pV(t,e){const r=Ct(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return r.Ur.getTargetData(n,e).next(s=>s?(i=s,Re.resolve(i)):r.Ur.allocateTargetId(n).next(a=>(i=new qo(e,a,"TargetPurposeListen",n.currentSequenceNumber),r.Ur.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=r.os.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(r.os=r.os.insert(n.targetId,n),r._s.set(e,n.targetId)),n})}async function jx(t,e,r){const n=Ct(t),i=n.os.get(e),s=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",s,a=>n.persistence.referenceDelegate.removeTarget(a,i))}catch(a){if(!r0(a))throw a;tt("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}n.os=n.os.remove(e),n._s.delete(i.target)}function LE(t,e,r){const n=Ct(t);let i=At.min(),s=Wt();return n.persistence.runTransaction("Execute query","readwrite",a=>function(l,u,f){const p=Ct(l),g=p._s.get(f);return g!==void 0?Re.resolve(p.os.get(g)):p.Ur.getTargetData(u,f)}(n,a,ba(e)).next(o=>{if(o)return i=o.lastLimboFreeSnapshotVersion,n.Ur.getMatchingKeysForTargetId(a,o.targetId).next(l=>{s=l})}).next(()=>n.ss.getDocumentsMatchingQuery(a,e,r?i:At.min(),r?s:Wt())).next(o=>(gV(n,sU(e),o),{documents:o,Ts:s})))}function gV(t,e,r){let n=t.us.get(e)||At.min();r.forEach((i,s)=>{s.readTime.compareTo(n)>0&&(n=s.readTime)}),t.us.set(e,n)}class UE{constructor(){this.activeTargetIds=dU()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class mV{constructor(){this.so=new UE,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,r,n){this.oo[e]=r}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new UE,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xV{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VE{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){tt("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){tt("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let th=null;function hm(){return th===null?th=function(){return 268435456+Math.round(2147483648*Math.random())}():th++,"0x"+th.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vV={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yV{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ci="WebChannelConnection";class _V extends class{constructor(r){this.databaseInfo=r,this.databaseId=r.databaseId;const n=r.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=n+"://"+r.host,this.vo=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Fo(){return!1}Mo(r,n,i,s,a){const o=hm(),l=this.xo(r,n.toUriEncodedString());tt("RestConnection",`Sending RPC '${r}' ${o}:`,l,i);const u={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(u,s,a),this.No(r,l,u,i).then(f=>(tt("RestConnection",`Received RPC '${r}' ${o}: `,f),f),f=>{throw Au("RestConnection",`RPC '${r}' ${o} failed with error: `,f,"url: ",l,"request:",i),f})}Lo(r,n,i,s,a,o){return this.Mo(r,n,i,s,a)}Oo(r,n,i){r["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Vu}(),r["Content-Type"]="text/plain",this.databaseInfo.appId&&(r["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,a)=>r[a]=s),i&&i.headers.forEach((s,a)=>r[a]=s)}xo(r,n){const i=vV[r];return`${this.Do}/v1/${n}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,r,n,i){const s=hm();return new Promise((a,o)=>{const l=new JC;l.setWithCredentials(!0),l.listenOnce(ZC.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case vh.NO_ERROR:const f=l.getResponseJson();tt(ci,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(f)),a(f);break;case vh.TIMEOUT:tt(ci,`RPC '${e}' ${s} timed out`),o(new ct(Be.DEADLINE_EXCEEDED,"Request time out"));break;case vh.HTTP_ERROR:const p=l.getStatus();if(tt(ci,`RPC '${e}' ${s} failed with status:`,p,"response text:",l.getResponseText()),p>0){let g=l.getResponseJson();Array.isArray(g)&&(g=g[0]);const m=g==null?void 0:g.error;if(m&&m.status&&m.message){const y=function(S){const A=S.toLowerCase().replace(/_/g,"-");return Object.values(Be).indexOf(A)>=0?A:Be.UNKNOWN}(m.status);o(new ct(y,m.message))}else o(new ct(Be.UNKNOWN,"Server responded with status "+l.getStatus()))}else o(new ct(Be.UNAVAILABLE,"Connection failed."));break;default:_t()}}finally{tt(ci,`RPC '${e}' ${s} completed.`)}});const u=JSON.stringify(i);tt(ci,`RPC '${e}' ${s} sending request:`,i),l.send(r,"POST",u,n,15)})}Bo(e,r,n){const i=hm(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=rk(),o=tk(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(l.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Oo(l.initMessageHeaders,r,n),l.encodeInitMessageHeaders=!0;const f=s.join("");tt(ci,`Creating RPC '${e}' stream ${i}: ${f}`,l);const p=a.createWebChannel(f,l);let g=!1,m=!1;const y=new yV({Io:S=>{m?tt(ci,`Not sending because RPC '${e}' stream ${i} is closed:`,S):(g||(tt(ci,`Opening RPC '${e}' stream ${i} transport.`),p.open(),g=!0),tt(ci,`RPC '${e}' stream ${i} sending:`,S),p.send(S))},To:()=>p.close()}),x=(S,A,C)=>{S.listen(A,E=>{try{C(E)}catch(O){setTimeout(()=>{throw O},0)}})};return x(p,Cd.EventType.OPEN,()=>{m||(tt(ci,`RPC '${e}' stream ${i} transport opened.`),y.yo())}),x(p,Cd.EventType.CLOSE,()=>{m||(m=!0,tt(ci,`RPC '${e}' stream ${i} transport closed`),y.So())}),x(p,Cd.EventType.ERROR,S=>{m||(m=!0,Au(ci,`RPC '${e}' stream ${i} transport errored:`,S),y.So(new ct(Be.UNAVAILABLE,"The operation could not be completed")))}),x(p,Cd.EventType.MESSAGE,S=>{var A;if(!m){const C=S.data[0];mr(!!C);const E=C,O=E.error||((A=E[0])===null||A===void 0?void 0:A.error);if(O){tt(ci,`RPC '${e}' stream ${i} received error:`,O);const q=O.status;let H=function(w){const N=xn[w];if(N!==void 0)return kk(N)}(q),T=O.message;H===void 0&&(H=Be.INTERNAL,T="Unknown error status: "+q+" with message "+O.message),m=!0,y.So(new ct(H,T)),p.close()}else tt(ci,`RPC '${e}' stream ${i} received:`,C),y.bo(C)}}),x(o,ek.STAT_EVENT,S=>{S.stat===Fx.PROXY?tt(ci,`RPC '${e}' stream ${i} detected buffering proxy`):S.stat===Fx.NOPROXY&&tt(ci,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{y.wo()},0),y}}function pm(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function og(t){return new IU(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lk{constructor(e,r,n=1e3,i=1.5,s=6e4){this.ui=e,this.timerId=r,this.ko=n,this.qo=i,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const r=Math.floor(this.Ko+this.zo()),n=Math.max(0,Date.now()-this.Uo),i=Math.max(0,r-n);i>0&&tt("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uk{constructor(e,r,n,i,s,a,o,l){this.ui=e,this.Ho=n,this.Jo=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=o,this.listener=l,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new Lk(e,r)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,r){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():r&&r.code===Be.RESOURCE_EXHAUSTED?(lo(r.toString()),lo("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):r&&r.code===Be.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(r)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),r=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.Yo===r&&this.P_(n,i)},n=>{e(()=>{const i=new ct(Be.UNKNOWN,"Fetching auth token failed: "+n.message);return this.I_(i)})})}P_(e,r){const n=this.h_(this.Yo);this.stream=this.T_(e,r),this.stream.Eo(()=>{n(()=>this.listener.Eo())}),this.stream.Ro(()=>{n(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{n(()=>this.I_(i))}),this.stream.onMessage(i=>{n(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return tt("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return r=>{this.ui.enqueueAndForget(()=>this.Yo===e?r():(tt("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class EV extends Uk{constructor(e,r,n,i,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,i,a),this.serializer=s}T_(e,r){return this.connection.Bo("Listen",e,r)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const r=DU(this.serializer,e),n=function(s){if(!("targetChange"in s))return At.min();const a=s.targetChange;return a.targetIds&&a.targetIds.length?At.min():a.readTime?Ia(a.readTime):At.min()}(e);return this.listener.d_(r,n)}A_(e){const r={};r.database=Bx(this.serializer),r.addTarget=function(s,a){let o;const l=a.target;if(o=Rx(l)?{documents:MU(s,l)}:{query:BU(s,l)._t},o.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){o.resumeToken=Ik(s,a.resumeToken);const u=Px(s,a.expectedCount);u!==null&&(o.expectedCount=u)}else if(a.snapshotVersion.compareTo(At.min())>0){o.readTime=vp(s,a.snapshotVersion.toTimestamp());const u=Px(s,a.expectedCount);u!==null&&(o.expectedCount=u)}return o}(this.serializer,e);const n=LU(this.serializer,e);n&&(r.labels=n),this.a_(r)}R_(e){const r={};r.database=Bx(this.serializer),r.removeTarget=e,this.a_(r)}}class SV extends Uk{constructor(e,r,n,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,i,a),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,r){return this.connection.Bo("Write",e,r)}E_(e){return mr(!!e.streamToken),this.lastStreamToken=e.streamToken,mr(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){mr(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const r=OU(e.writeResults,e.commitTime),n=Ia(e.commitTime);return this.listener.g_(n,r)}p_(){const e={};e.database=Bx(this.serializer),this.a_(e)}m_(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>PU(this.serializer,n))};this.a_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wV extends class{}{constructor(e,r,n,i){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new ct(Be.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,r,n,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Mo(e,Ox(r,n),i,s,a)).catch(s=>{throw s.name==="FirebaseError"?(s.code===Be.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new ct(Be.UNKNOWN,s.toString())})}Lo(e,r,n,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,o])=>this.connection.Lo(e,Ox(r,n),i,a,o,s)).catch(a=>{throw a.name==="FirebaseError"?(a.code===Be.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new ct(Be.UNKNOWN,a.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class TV{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(lo(r),this.D_=!1):tt("OnlineStateTracker",r)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AV{constructor(e,r,n,i,s){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(a=>{n.enqueueAndForget(async()=>{yc(this)&&(tt("RemoteStore","Restarting streams for network reachability change."),await async function(l){const u=Ct(l);u.L_.add(4),await s0(u),u.q_.set("Unknown"),u.L_.delete(4),await lg(u)}(this))})}),this.q_=new TV(n,i)}}async function lg(t){if(yc(t))for(const e of t.B_)await e(!0)}async function s0(t){for(const e of t.B_)await e(!1)}function Vk(t,e){const r=Ct(t);r.N_.has(e.targetId)||(r.N_.set(e.targetId,e),Kv(r)?Gv(r):$u(r).r_()&&Hv(r,e))}function $v(t,e){const r=Ct(t),n=$u(r);r.N_.delete(e),n.r_()&&zk(r,e),r.N_.size===0&&(n.r_()?n.o_():yc(r)&&r.q_.set("Unknown"))}function Hv(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(At.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}$u(t).A_(e)}function zk(t,e){t.Q_.xe(e),$u(t).R_(e)}function Gv(t){t.Q_=new CU({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),$u(t).start(),t.q_.v_()}function Kv(t){return yc(t)&&!$u(t).n_()&&t.N_.size>0}function yc(t){return Ct(t).L_.size===0}function Wk(t){t.Q_=void 0}async function CV(t){t.q_.set("Online")}async function kV(t){t.N_.forEach((e,r)=>{Hv(t,e)})}async function FV(t,e){Wk(t),Kv(t)?(t.q_.M_(e),Gv(t)):t.q_.set("Unknown")}async function bV(t,e,r){if(t.q_.set("Online"),e instanceof bk&&e.state===2&&e.cause)try{await async function(i,s){const a=s.cause;for(const o of s.targetIds)i.N_.has(o)&&(await i.remoteSyncer.rejectListen(o,a),i.N_.delete(o),i.Q_.removeTarget(o))}(t,e)}catch(n){tt("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),await yp(t,n)}else if(e instanceof Eh?t.Q_.Ke(e):e instanceof Fk?t.Q_.He(e):t.Q_.We(e),!r.isEqual(At.min()))try{const n=await jk(t.localStore);r.compareTo(n)>=0&&await function(s,a){const o=s.Q_.rt(a);return o.targetChanges.forEach((l,u)=>{if(l.resumeToken.approximateByteSize()>0){const f=s.N_.get(u);f&&s.N_.set(u,f.withResumeToken(l.resumeToken,a))}}),o.targetMismatches.forEach((l,u)=>{const f=s.N_.get(l);if(!f)return;s.N_.set(l,f.withResumeToken(ri.EMPTY_BYTE_STRING,f.snapshotVersion)),zk(s,l);const p=new qo(f.target,l,u,f.sequenceNumber);Hv(s,p)}),s.remoteSyncer.applyRemoteEvent(o)}(t,r)}catch(n){tt("RemoteStore","Failed to raise snapshot:",n),await yp(t,n)}}async function yp(t,e,r){if(!r0(e))throw e;t.L_.add(1),await s0(t),t.q_.set("Offline"),r||(r=()=>jk(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{tt("RemoteStore","Retrying IndexedDB access"),await r(),t.L_.delete(1),await lg(t)})}function $k(t,e){return e().catch(r=>yp(t,r,e))}async function cg(t){const e=Ct(t),r=vl(e);let n=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;IV(e);)try{const i=await hV(e.localStore,n);if(i===null){e.O_.length===0&&r.o_();break}n=i.batchId,NV(e,i)}catch(i){await yp(e,i)}Hk(e)&&Gk(e)}function IV(t){return yc(t)&&t.O_.length<10}function NV(t,e){t.O_.push(e);const r=vl(t);r.r_()&&r.V_&&r.m_(e.mutations)}function Hk(t){return yc(t)&&!vl(t).n_()&&t.O_.length>0}function Gk(t){vl(t).start()}async function RV(t){vl(t).p_()}async function DV(t){const e=vl(t);for(const r of t.O_)e.m_(r.mutations)}async function PV(t,e,r){const n=t.O_.shift(),i=jv.from(n,e,r);await $k(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await cg(t)}async function OV(t,e){e&&vl(t).V_&&await async function(n,i){if(function(a){return wU(a)&&a!==Be.ABORTED}(i.code)){const s=n.O_.shift();vl(n).s_(),await $k(n,()=>n.remoteSyncer.rejectFailedWrite(s.batchId,i)),await cg(n)}}(t,e),Hk(t)&&Gk(t)}async function zE(t,e){const r=Ct(t);r.asyncQueue.verifyOperationInProgress(),tt("RemoteStore","RemoteStore received new credentials");const n=yc(r);r.L_.add(3),await s0(r),n&&r.q_.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.L_.delete(3),await lg(r)}async function MV(t,e){const r=Ct(t);e?(r.L_.delete(2),await lg(r)):e||(r.L_.add(2),await s0(r),r.q_.set("Unknown"))}function $u(t){return t.K_||(t.K_=function(r,n,i){const s=Ct(r);return s.w_(),new EV(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:CV.bind(null,t),Ro:kV.bind(null,t),mo:FV.bind(null,t),d_:bV.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),Kv(t)?Gv(t):t.q_.set("Unknown")):(await t.K_.stop(),Wk(t))})),t.K_}function vl(t){return t.U_||(t.U_=function(r,n,i){const s=Ct(r);return s.w_(),new SV(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:RV.bind(null,t),mo:OV.bind(null,t),f_:DV.bind(null,t),g_:PV.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await cg(t)):(await t.U_.stop(),t.O_.length>0&&(tt("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yv{constructor(e,r,n,i,s){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=i,this.removalCallback=s,this.deferred=new ll,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,i,s){const a=Date.now()+n,o=new Yv(e,r,a,i,s);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ct(Be.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Xv(t,e){if(lo("AsyncQueue",`${e}: ${t}`),r0(t))return new ct(Be.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uu{constructor(e){this.comparator=e?(r,n)=>e(r,n)||ft.comparator(r.key,n.key):(r,n)=>ft.comparator(r.key,n.key),this.keyedMap=kd(),this.sortedSet=new Jr(this.comparator)}static emptySet(e){return new uu(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof uu)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const i=r.getNext().key,s=n.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new uu;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WE{constructor(){this.W_=new Jr(ft.comparator)}track(e){const r=e.doc.key,n=this.W_.get(r);n?e.type!==0&&n.type===3?this.W_=this.W_.insert(r,e):e.type===3&&n.type!==1?this.W_=this.W_.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.W_=this.W_.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.W_=this.W_.remove(r):e.type===1&&n.type===2?this.W_=this.W_.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):_t():this.W_=this.W_.insert(r,e)}G_(){const e=[];return this.W_.inorderTraversal((r,n)=>{e.push(n)}),e}}class Iu{constructor(e,r,n,i,s,a,o,l,u){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=o,this.excludesMetadataChanges=l,this.hasCachedResults=u}static fromInitialDocuments(e,r,n,i,s){const a=[];return r.forEach(o=>{a.push({type:0,doc:o})}),new Iu(e,r,uu.emptySet(r),a,n,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&rg(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let i=0;i<r.length;i++)if(r[i].type!==n[i].type||!r[i].doc.isEqual(n[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BV{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class jV{constructor(){this.queries=$E(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(r,n){const i=Ct(r),s=i.queries;i.queries=$E(),s.forEach((a,o)=>{for(const l of o.j_)l.onError(n)})})(this,new ct(Be.ABORTED,"Firestore shutting down"))}}function $E(){return new Wu(t=>pk(t),rg)}async function Kk(t,e){const r=Ct(t);let n=3;const i=e.query;let s=r.queries.get(i);s?!s.H_()&&e.J_()&&(n=2):(s=new BV,n=e.J_()?0:1);try{switch(n){case 0:s.z_=await r.onListen(i,!0);break;case 1:s.z_=await r.onListen(i,!1);break;case 2:await r.onFirstRemoteStoreListen(i)}}catch(a){const o=Xv(a,`Initialization of query '${Bc(e.query)}' failed`);return void e.onError(o)}r.queries.set(i,s),s.j_.push(e),e.Z_(r.onlineState),s.z_&&e.X_(s.z_)&&qv(r)}async function Yk(t,e){const r=Ct(t),n=e.query;let i=3;const s=r.queries.get(n);if(s){const a=s.j_.indexOf(e);a>=0&&(s.j_.splice(a,1),s.j_.length===0?i=e.J_()?0:1:!s.H_()&&e.J_()&&(i=2))}switch(i){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function LV(t,e){const r=Ct(t);let n=!1;for(const i of e){const s=i.query,a=r.queries.get(s);if(a){for(const o of a.j_)o.X_(i)&&(n=!0);a.z_=i}}n&&qv(r)}function UV(t,e,r){const n=Ct(t),i=n.queries.get(e);if(i)for(const s of i.j_)s.onError(r);n.queries.delete(e)}function qv(t){t.Y_.forEach(e=>{e.next()})}var Lx,HE;(HE=Lx||(Lx={})).ea="default",HE.Cache="cache";class Xk{constructor(e,r,n){this.query=e,this.ta=r,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=n||{}}X_(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)i.type!==3&&n.push(i);e=new Iu(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.na?this.ia(e)&&(this.ta.next(e),r=!0):this.sa(e,this.onlineState)&&(this.oa(e),r=!0),this.ra=e,r}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let r=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),r=!0),r}sa(e,r){if(!e.fromCache||!this.J_())return!0;const n=r!=="Offline";return(!this.options._a||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const r=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}oa(e){e=Iu.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Lx.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qk{constructor(e){this.key=e}}class Qk{constructor(e){this.key=e}}class VV{constructor(e,r){this.query=e,this.Ta=r,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Wt(),this.mutatedKeys=Wt(),this.Aa=gk(e),this.Ra=new uu(this.Aa)}get Va(){return this.Ta}ma(e,r){const n=r?r.fa:new WE,i=r?r.Ra:this.Ra;let s=r?r.mutatedKeys:this.mutatedKeys,a=i,o=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((f,p)=>{const g=i.get(f),m=ng(this.query,p)?p:null,y=!!g&&this.mutatedKeys.has(g.key),x=!!m&&(m.hasLocalMutations||this.mutatedKeys.has(m.key)&&m.hasCommittedMutations);let S=!1;g&&m?g.data.isEqual(m.data)?y!==x&&(n.track({type:3,doc:m}),S=!0):this.ga(g,m)||(n.track({type:2,doc:m}),S=!0,(l&&this.Aa(m,l)>0||u&&this.Aa(m,u)<0)&&(o=!0)):!g&&m?(n.track({type:0,doc:m}),S=!0):g&&!m&&(n.track({type:1,doc:g}),S=!0,(l||u)&&(o=!0)),S&&(m?(a=a.add(m),s=x?s.add(f):s.delete(f)):(a=a.delete(f),s=s.delete(f)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const f=this.query.limitType==="F"?a.last():a.first();a=a.delete(f.key),s=s.delete(f.key),n.track({type:1,doc:f})}return{Ra:a,fa:n,ns:o,mutatedKeys:s}}ga(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,i){const s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const a=e.fa.G_();a.sort((f,p)=>function(m,y){const x=S=>{switch(S){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return _t()}};return x(m)-x(y)}(f.type,p.type)||this.Aa(f.doc,p.doc)),this.pa(n),i=i!=null&&i;const o=r&&!i?this.ya():[],l=this.da.size===0&&this.current&&!i?1:0,u=l!==this.Ea;return this.Ea=l,a.length!==0||u?{snapshot:new Iu(this.query,e.Ra,s,a,e.mutatedKeys,l===0,u,!1,!!n&&n.resumeToken.approximateByteSize()>0),wa:o}:{wa:o}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new WE,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(r=>this.Ta=this.Ta.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ta=this.Ta.delete(r)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=Wt(),this.Ra.forEach(n=>{this.Sa(n.key)&&(this.da=this.da.add(n.key))});const r=[];return e.forEach(n=>{this.da.has(n)||r.push(new Qk(n))}),this.da.forEach(n=>{e.has(n)||r.push(new qk(n))}),r}ba(e){this.Ta=e.Ts,this.da=Wt();const r=this.ma(e.documents);return this.applyChanges(r,!0)}Da(){return Iu.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class zV{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class WV{constructor(e){this.key=e,this.va=!1}}class $V{constructor(e,r,n,i,s,a){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Ca={},this.Fa=new Wu(o=>pk(o),rg),this.Ma=new Map,this.xa=new Set,this.Oa=new Jr(ft.comparator),this.Na=new Map,this.La=new Vv,this.Ba={},this.ka=new Map,this.qa=bu.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function HV(t,e,r=!0){const n=nF(t);let i;const s=n.Fa.get(e);return s?(n.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=await Jk(n,e,r,!0),i}async function GV(t,e){const r=nF(t);await Jk(r,e,!0,!1)}async function Jk(t,e,r,n){const i=await pV(t.localStore,ba(e)),s=i.targetId,a=t.sharedClientState.addLocalQueryTarget(s,r);let o;return n&&(o=await KV(t,e,s,a==="current",i.resumeToken)),t.isPrimaryClient&&r&&Vk(t.remoteStore,i),o}async function KV(t,e,r,n,i){t.Ka=(p,g,m)=>async function(x,S,A,C){let E=S.view.ma(A);E.ns&&(E=await LE(x.localStore,S.query,!1).then(({documents:T})=>S.view.ma(T,E)));const O=C&&C.targetChanges.get(S.targetId),q=C&&C.targetMismatches.get(S.targetId)!=null,H=S.view.applyChanges(E,x.isPrimaryClient,O,q);return KE(x,S.targetId,H.wa),H.snapshot}(t,p,g,m);const s=await LE(t.localStore,e,!0),a=new VV(e,s.Ts),o=a.ma(s.documents),l=i0.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",i),u=a.applyChanges(o,t.isPrimaryClient,l);KE(t,r,u.wa);const f=new zV(e,r,a);return t.Fa.set(e,f),t.Ma.has(r)?t.Ma.get(r).push(e):t.Ma.set(r,[e]),u.snapshot}async function YV(t,e,r){const n=Ct(t),i=n.Fa.get(e),s=n.Ma.get(i.targetId);if(s.length>1)return n.Ma.set(i.targetId,s.filter(a=>!rg(a,e))),void n.Fa.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await jx(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),r&&$v(n.remoteStore,i.targetId),Ux(n,i.targetId)}).catch(t0)):(Ux(n,i.targetId),await jx(n.localStore,i.targetId,!0))}async function XV(t,e){const r=Ct(t),n=r.Fa.get(e),i=r.Ma.get(n.targetId);r.isPrimaryClient&&i.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),$v(r.remoteStore,n.targetId))}async function qV(t,e,r){const n=nz(t);try{const i=await function(a,o){const l=Ct(a),u=In.now(),f=o.reduce((m,y)=>m.add(y.key),Wt());let p,g;return l.persistence.runTransaction("Locally write mutations","readwrite",m=>{let y=co(),x=Wt();return l.cs.getEntries(m,f).next(S=>{y=S,y.forEach((A,C)=>{C.isValidDocument()||(x=x.add(A))})}).next(()=>l.localDocuments.getOverlayedDocuments(m,y)).next(S=>{p=S;const A=[];for(const C of o){const E=vU(C,p.get(C.key).overlayedDocument);E!=null&&A.push(new vc(C.key,E,ok(E.value.mapValue),to.exists(!0)))}return l.mutationQueue.addMutationBatch(m,u,A,o)}).next(S=>{g=S;const A=S.applyToLocalDocumentSet(p,x);return l.documentOverlayCache.saveOverlays(m,S.batchId,A)})}).then(()=>({batchId:g.batchId,changes:xk(p)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(a,o,l){let u=a.Ba[a.currentUser.toKey()];u||(u=new Jr(ar)),u=u.insert(o,l),a.Ba[a.currentUser.toKey()]=u}(n,i.batchId,r),await a0(n,i.changes),await cg(n.remoteStore)}catch(i){const s=Xv(i,"Failed to persist write");r.reject(s)}}async function Zk(t,e){const r=Ct(t);try{const n=await dV(r.localStore,e);e.targetChanges.forEach((i,s)=>{const a=r.Na.get(s);a&&(mr(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?a.va=!0:i.modifiedDocuments.size>0?mr(a.va):i.removedDocuments.size>0&&(mr(a.va),a.va=!1))}),await a0(r,n,e)}catch(n){await t0(n)}}function GE(t,e,r){const n=Ct(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const i=[];n.Fa.forEach((s,a)=>{const o=a.view.Z_(e);o.snapshot&&i.push(o.snapshot)}),function(a,o){const l=Ct(a);l.onlineState=o;let u=!1;l.queries.forEach((f,p)=>{for(const g of p.j_)g.Z_(o)&&(u=!0)}),u&&qv(l)}(n.eventManager,e),i.length&&n.Ca.d_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function QV(t,e,r){const n=Ct(t);n.sharedClientState.updateQueryState(e,"rejected",r);const i=n.Na.get(e),s=i&&i.key;if(s){let a=new Jr(ft.comparator);a=a.insert(s,gi.newNoDocument(s,At.min()));const o=Wt().add(s),l=new ag(At.min(),new Map,new Jr(ar),a,o);await Zk(n,l),n.Oa=n.Oa.remove(s),n.Na.delete(e),Qv(n)}else await jx(n.localStore,e,!1).then(()=>Ux(n,e,r)).catch(t0)}async function JV(t,e){const r=Ct(t),n=e.batch.batchId;try{const i=await uV(r.localStore,e);tF(r,n,null),eF(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await a0(r,i)}catch(i){await t0(i)}}async function ZV(t,e,r){const n=Ct(t);try{const i=await function(a,o){const l=Ct(a);return l.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let f;return l.mutationQueue.lookupMutationBatch(u,o).next(p=>(mr(p!==null),f=p.keys(),l.mutationQueue.removeMutationBatch(u,p))).next(()=>l.mutationQueue.performConsistencyCheck(u)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(u,f,o)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,f)).next(()=>l.localDocuments.getDocuments(u,f))})}(n.localStore,e);tF(n,e,r),eF(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await a0(n,i)}catch(i){await t0(i)}}function eF(t,e){(t.ka.get(e)||[]).forEach(r=>{r.resolve()}),t.ka.delete(e)}function tF(t,e,r){const n=Ct(t);let i=n.Ba[n.currentUser.toKey()];if(i){const s=i.get(e);s&&(r?s.reject(r):s.resolve(),i=i.remove(e)),n.Ba[n.currentUser.toKey()]=i}}function Ux(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Ma.get(e))t.Fa.delete(n),r&&t.Ca.$a(n,r);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(n=>{t.La.containsKey(n)||rF(t,n)})}function rF(t,e){t.xa.delete(e.path.canonicalString());const r=t.Oa.get(e);r!==null&&($v(t.remoteStore,r),t.Oa=t.Oa.remove(e),t.Na.delete(r),Qv(t))}function KE(t,e,r){for(const n of r)n instanceof qk?(t.La.addReference(n.key,e),ez(t,n)):n instanceof Qk?(tt("SyncEngine","Document no longer in limbo: "+n.key),t.La.removeReference(n.key,e),t.La.containsKey(n.key)||rF(t,n.key)):_t()}function ez(t,e){const r=e.key,n=r.path.canonicalString();t.Oa.get(r)||t.xa.has(n)||(tt("SyncEngine","New document in limbo: "+r),t.xa.add(n),Qv(t))}function Qv(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const r=new ft(rn.fromString(e)),n=t.qa.next();t.Na.set(n,new WV(r)),t.Oa=t.Oa.insert(r,n),Vk(t.remoteStore,new qo(ba(tg(r.path)),n,"TargetPurposeLimboResolution",Nv.oe))}}async function a0(t,e,r){const n=Ct(t),i=[],s=[],a=[];n.Fa.isEmpty()||(n.Fa.forEach((o,l)=>{a.push(n.Ka(l,e,r).then(u=>{var f;if((u||r)&&n.isPrimaryClient){const p=u?!u.fromCache:(f=r==null?void 0:r.targetChanges.get(l.targetId))===null||f===void 0?void 0:f.current;n.sharedClientState.updateQueryState(l.targetId,p?"current":"not-current")}if(u){i.push(u);const p=Wv.Wi(l.targetId,u);s.push(p)}}))}),await Promise.all(a),n.Ca.d_(i),await async function(l,u){const f=Ct(l);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>Re.forEach(u,g=>Re.forEach(g.$i,m=>f.persistence.referenceDelegate.addReference(p,g.targetId,m)).next(()=>Re.forEach(g.Ui,m=>f.persistence.referenceDelegate.removeReference(p,g.targetId,m)))))}catch(p){if(!r0(p))throw p;tt("LocalStore","Failed to update sequence numbers: "+p)}for(const p of u){const g=p.targetId;if(!p.fromCache){const m=f.os.get(g),y=m.snapshotVersion,x=m.withLastLimboFreeSnapshotVersion(y);f.os=f.os.insert(g,x)}}}(n.localStore,s))}async function tz(t,e){const r=Ct(t);if(!r.currentUser.isEqual(e)){tt("SyncEngine","User change. New user:",e.toKey());const n=await Bk(r.localStore,e);r.currentUser=e,function(s,a){s.ka.forEach(o=>{o.forEach(l=>{l.reject(new ct(Be.CANCELLED,a))})}),s.ka.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await a0(r,n.hs)}}function rz(t,e){const r=Ct(t),n=r.Na.get(e);if(n&&n.va)return Wt().add(n.key);{let i=Wt();const s=r.Ma.get(e);if(!s)return i;for(const a of s){const o=r.Fa.get(a);i=i.unionWith(o.view.Va)}return i}}function nF(t){const e=Ct(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Zk.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=rz.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=QV.bind(null,e),e.Ca.d_=LV.bind(null,e.eventManager),e.Ca.$a=UV.bind(null,e.eventManager),e}function nz(t){const e=Ct(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=JV.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=ZV.bind(null,e),e}class _p{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=og(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,r){return null}Ha(e,r){return null}za(e){return cV(this.persistence,new oV,e.initialUser,this.serializer)}Ga(e){return new iV(zv.Zr,this.serializer)}Wa(e){return new mV}async terminate(){var e,r;(e=this.gcScheduler)===null||e===void 0||e.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}_p.provider={build:()=>new _p};class Vx{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>GE(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=tz.bind(null,this.syncEngine),await MV(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new jV}()}createDatastore(e){const r=og(e.databaseInfo.databaseId),n=function(s){return new _V(s)}(e.databaseInfo);return function(s,a,o,l){return new wV(s,a,o,l)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,i,s,a,o){return new AV(n,i,s,a,o)}(this.localStore,this.datastore,e.asyncQueue,r=>GE(this.syncEngine,r,0),function(){return VE.D()?new VE:new xV}())}createSyncEngine(e,r){return function(i,s,a,o,l,u,f){const p=new $V(i,s,a,o,l,u);return f&&(p.Qa=!0),p}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await async function(i){const s=Ct(i);tt("RemoteStore","RemoteStore shutting down."),s.L_.add(5),await s0(s),s.k_.shutdown(),s.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}Vx.provider={build:()=>new Vx};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iF{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):lo("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iz{constructor(e,r,n,i,s){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=i,this.user=di.UNAUTHENTICATED,this.clientId=ik.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(n,async a=>{tt("FirestoreClient","Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(n,a=>(tt("FirestoreClient","Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ll;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=Xv(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function gm(t,e){t.asyncQueue.verifyOperationInProgress(),tt("FirestoreClient","Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async i=>{n.isEqual(i)||(await Bk(e.localStore,i),n=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function YE(t,e){t.asyncQueue.verifyOperationInProgress();const r=await sz(t);tt("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>zE(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,i)=>zE(e.remoteStore,i)),t._onlineComponents=e}async function sz(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){tt("FirestoreClient","Using user provided OfflineComponentProvider");try{await gm(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(i){return i.name==="FirebaseError"?i.code===Be.FAILED_PRECONDITION||i.code===Be.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(r))throw r;Au("Error using user provided cache. Falling back to memory cache: "+r),await gm(t,new _p)}}else tt("FirestoreClient","Using default OfflineComponentProvider"),await gm(t,new _p);return t._offlineComponents}async function sF(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(tt("FirestoreClient","Using user provided OnlineComponentProvider"),await YE(t,t._uninitializedComponentsProvider._online)):(tt("FirestoreClient","Using default OnlineComponentProvider"),await YE(t,new Vx))),t._onlineComponents}function az(t){return sF(t).then(e=>e.syncEngine)}async function zx(t){const e=await sF(t),r=e.eventManager;return r.onListen=HV.bind(null,e.syncEngine),r.onUnlisten=YV.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=GV.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=XV.bind(null,e.syncEngine),r}function oz(t,e,r={}){const n=new ll;return t.asyncQueue.enqueueAndForget(async()=>function(s,a,o,l,u){const f=new iF({next:g=>{f.Za(),a.enqueueAndForget(()=>Yk(s,p));const m=g.docs.has(o);!m&&g.fromCache?u.reject(new ct(Be.UNAVAILABLE,"Failed to get document because the client is offline.")):m&&g.fromCache&&l&&l.source==="server"?u.reject(new ct(Be.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(g)},error:g=>u.reject(g)}),p=new Xk(tg(o.path),f,{includeMetadataChanges:!0,_a:!0});return Kk(s,p)}(await zx(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aF(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XE=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lz(t,e,r){if(!r)throw new ct(Be.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function cz(t,e,r,n){if(e===!0&&n===!0)throw new ct(Be.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function qE(t){if(!ft.isDocumentKey(t))throw new ct(Be.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Jv(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":_t()}function cl(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new ct(Be.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=Jv(t);throw new ct(Be.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QE{constructor(e){var r,n;if(e.host===void 0){if(e.ssl!==void 0)throw new ct(Be.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(r=e.ssl)===null||r===void 0||r;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new ct(Be.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}cz("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=aF((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new ct(Be.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new ct(Be.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new ct(Be.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Zv{constructor(e,r,n,i){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new QE({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ct(Be.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ct(Be.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new QE(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new C7;switch(n.type){case"firstParty":return new I7(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new ct(Be.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=XE.get(r);n&&(tt("ComponentProvider","Removing Datastore"),XE.delete(r),n.terminate())}(this),Promise.resolve()}}function uz(t,e,r,n={}){var i;const s=(t=cl(t,Zv))._getSettings(),a=`${e}:${r}`;if(s.host!=="firestore.googleapis.com"&&s.host!==a&&Au("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:a,ssl:!1})),n.mockUserToken){let o,l;if(typeof n.mockUserToken=="string")o=n.mockUserToken,l=di.MOCK_USER;else{o=e9(n.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);const u=n.mockUserToken.sub||n.mockUserToken.user_id;if(!u)throw new ct(Be.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new di(u)}t._authCredentials=new k7(new nk(o,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ug{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new ug(this.firestore,e,this._query)}}class us{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Bf(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new us(this.firestore,e,this._key)}}class Bf extends ug{constructor(e,r,n){super(e,r,tg(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new us(this.firestore,null,new ft(e))}withConverter(e){return new Bf(this.firestore,e,this._path)}}function ey(t,e,...r){if(t=aa(t),arguments.length===1&&(e=ik.newId()),lz("doc","path",e),t instanceof Zv){const n=rn.fromString(e,...r);return qE(n),new us(t,null,new ft(n))}{if(!(t instanceof us||t instanceof Bf))throw new ct(Be.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(rn.fromString(e,...r));return qE(n),new us(t.firestore,t instanceof Bf?t.converter:null,new ft(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JE{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new Lk(this,"async_queue_retry"),this.Vu=()=>{const n=pm();n&&tt("AsyncQueue","Visibility state changed to "+n.visibilityState),this.t_.jo()},this.mu=e;const r=pm();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const r=pm();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const r=new ll;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!r0(e))throw e;tt("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const r=this.mu.then(()=>(this.du=!0,e().catch(n=>{this.Eu=n,this.du=!1;const i=function(a){let o=a.message||"";return a.stack&&(o=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),o}(n);throw lo("INTERNAL UNHANDLED ERROR: ",i),n}).then(n=>(this.du=!1,n))));return this.mu=r,r}enqueueAfterDelay(e,r,n){this.fu(),this.Ru.indexOf(e)>-1&&(r=0);const i=Yv.createAndSchedule(this,e,r,n,s=>this.yu(s));return this.Tu.push(i),i}fu(){this.Eu&&_t()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const r of this.Tu)if(r.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.Tu)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const r=this.Tu.indexOf(e);this.Tu.splice(r,1)}}function ZE(t){return function(r,n){if(typeof r!="object"||r===null)return!1;const i=r;for(const s of n)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}class jf extends Zv{constructor(e,r,n,i){super(e,r,n,i),this.type="firestore",this._queue=new JE,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new JE(e),this._firestoreClient=void 0,await e}}}function dz(t,e){const r=typeof t=="object"?t:YC(),n=typeof t=="string"?t:"(default)",i=bv(r,"firestore").getImmediate({identifier:n});if(!i._initialized){const s=JL("firestore");s&&uz(i,...s)}return i}function ty(t){if(t._terminated)throw new ct(Be.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||fz(t),t._firestoreClient}function fz(t){var e,r,n;const i=t._freezeSettings(),s=function(o,l,u,f){return new W7(o,l,u,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,aF(f.experimentalLongPollingOptions),f.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._componentsProvider||!((r=i.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((n=i.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(t._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),t._firestoreClient=new iz(t._authCredentials,t._appCheckCredentials,t._queue,s,t._componentsProvider&&function(o){const l=o==null?void 0:o._online.build();return{_offline:o==null?void 0:o._offline.build(l),_online:l}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nu{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Nu(ri.fromBase64String(e))}catch(r){throw new ct(Be.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new Nu(ri.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ry{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new ct(Be.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Jn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oF{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ny{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new ct(Be.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new ct(Be.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ar(this._lat,e._lat)||ar(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iy{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,i){if(n.length!==i.length)return!1;for(let s=0;s<n.length;++s)if(n[s]!==i[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hz=/^__.*__$/;class pz{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new vc(e,this.data,this.fieldMask,r,this.fieldTransforms):new n0(e,this.data,r,this.fieldTransforms)}}function lF(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw _t()}}class sy{constructor(e,r,n,i,s,a){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=i,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new sy(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),i=this.Fu({path:n,xu:!1});return i.Ou(e),i}Nu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),i=this.Fu({path:n,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Ep(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(lF(this.Cu)&&hz.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class gz{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||og(e)}Qu(e,r,n,i=!1){return new sy({Cu:e,methodName:r,qu:n,path:Jn.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function mz(t){const e=t._freezeSettings(),r=og(t._databaseId);return new gz(t._databaseId,!!e.ignoreUndefinedProperties,r)}function xz(t,e,r,n,i,s={}){const a=t.Qu(s.merge||s.mergeFields?2:0,e,r,i);fF("Data must be an object, but it was:",a,n);const o=uF(n,a);let l,u;if(s.merge)l=new ea(a.fieldMask),u=a.fieldTransforms;else if(s.mergeFields){const f=[];for(const p of s.mergeFields){const g=vz(e,p,r);if(!a.contains(g))throw new ct(Be.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);_z(f,g)||f.push(g)}l=new ea(f),u=a.fieldTransforms.filter(p=>l.covers(p.field))}else l=null,u=a.fieldTransforms;return new pz(new Ns(o),l,u)}function cF(t,e){if(dF(t=aa(t)))return fF("Unsupported field value:",e,t),uF(t,e);if(t instanceof oF)return function(n,i){if(!lF(i.Cu))throw i.Bu(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${n._methodName}() is not currently supported inside arrays`);const s=n._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(n,i){const s=[];let a=0;for(const o of n){let l=cF(o,i.Lu(a));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),a++}return{arrayValue:{values:s}}}(t,e)}return function(n,i){if((n=aa(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return fU(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const s=In.fromDate(n);return{timestampValue:vp(i.serializer,s)}}if(n instanceof In){const s=new In(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:vp(i.serializer,s)}}if(n instanceof ny)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Nu)return{bytesValue:Ik(i.serializer,n._byteString)};if(n instanceof us){const s=i.databaseId,a=n.firestore._databaseId;if(!a.isEqual(s))throw i.Bu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Uv(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof iy)return function(a,o){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:a.toArray().map(l=>{if(typeof l!="number")throw o.Bu("VectorValues must only contain numeric values.");return Bv(o.serializer,l)})}}}}}}(n,i);throw i.Bu(`Unsupported field value: ${Jv(n)}`)}(t,e)}function uF(t,e){const r={};return sk(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):zu(t,(n,i)=>{const s=cF(i,e.Mu(n));s!=null&&(r[n]=s)}),{mapValue:{fields:r}}}function dF(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof In||t instanceof ny||t instanceof Nu||t instanceof us||t instanceof oF||t instanceof iy)}function fF(t,e,r){if(!dF(r)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(r)){const n=Jv(r);throw n==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+n)}}function vz(t,e,r){if((e=aa(e))instanceof ry)return e._internalPath;if(typeof e=="string")return hF(t,e);throw Ep("Field path arguments must be of type string or ",t,!1,void 0,r)}const yz=new RegExp("[~\\*/\\[\\]]");function hF(t,e,r){if(e.search(yz)>=0)throw Ep(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new ry(...e.split("."))._internalPath}catch{throw Ep(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function Ep(t,e,r,n,i){const s=n&&!n.isEmpty(),a=i!==void 0;let o=`Function ${e}() called with invalid data`;r&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(s||a)&&(l+=" (found",s&&(l+=` in field ${n}`),a&&(l+=` in document ${i}`),l+=")"),new ct(Be.INVALID_ARGUMENT,o+t+l)}function _z(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pF{constructor(e,r,n,i,s){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new us(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new Ez(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(gF("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class Ez extends pF{data(){return super.data()}}function gF(t,e){return typeof e=="string"?hF(t,e):e instanceof ry?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sz(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new ct(Be.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class wz{convertValue(e,r="none"){switch(lc(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ln(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(oc(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw _t()}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return zu(e,(i,s)=>{n[i]=this.convertValue(s,r)}),n}convertVectorValue(e){var r,n,i;const s=(i=(n=(r=e.fields)===null||r===void 0?void 0:r.value.arrayValue)===null||n===void 0?void 0:n.values)===null||i===void 0?void 0:i.map(a=>ln(a.doubleValue));return new iy(s)}convertGeoPoint(e){return new ny(ln(e.latitude),ln(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=Dv(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(Rf(e));default:return null}}convertTimestamp(e){const r=xl(e);return new In(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=rn.fromString(e);mr(Mk(n));const i=new Df(n.get(1),n.get(3)),s=new ft(n.popFirst(5));return i.isEqual(r)||lo(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tz(t,e,r){let n;return n=t?t.toFirestore(e):e,n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bd{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class mF extends pF{constructor(e,r,n,i,s,a){super(e,r,n,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new Sh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(gF("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}}class Sh extends mF{data(e={}){return super.data(e)}}class Az{constructor(e,r,n,i){this._firestore=e,this._userDataWriter=r,this._snapshot=i,this.metadata=new bd(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new Sh(this._firestore,this._userDataWriter,n.key,n,new bd(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new ct(Be.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(o=>{const l=new Sh(i._firestore,i._userDataWriter,o.doc.key,o.doc,new bd(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);return o.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(o=>s||o.type!==3).map(o=>{const l=new Sh(i._firestore,i._userDataWriter,o.doc.key,o.doc,new bd(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);let u=-1,f=-1;return o.type!==0&&(u=a.indexOf(o.doc.key),a=a.delete(o.doc.key)),o.type!==1&&(a=a.add(o.doc),f=a.indexOf(o.doc.key)),{type:Cz(o.type),doc:l,oldIndex:u,newIndex:f}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}}function Cz(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return _t()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kz(t){t=cl(t,us);const e=cl(t.firestore,jf);return oz(ty(e),t._key).then(r=>vF(e,t,r))}class xF extends wz{constructor(e){super(),this.firestore=e}convertBytes(e){return new Nu(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new us(this.firestore,null,r)}}function Fz(t,e,r){t=cl(t,us);const n=cl(t.firestore,jf),i=Tz(t.converter,e);return Iz(n,[xz(mz(n),"setDoc",t._key,i,t.converter!==null,r).toMutation(t._key,to.none())])}function bz(t,...e){var r,n,i;t=aa(t);let s={includeMetadataChanges:!1,source:"default"},a=0;typeof e[a]!="object"||ZE(e[a])||(s=e[a],a++);const o={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(ZE(e[a])){const p=e[a];e[a]=(r=p.next)===null||r===void 0?void 0:r.bind(p),e[a+1]=(n=p.error)===null||n===void 0?void 0:n.bind(p),e[a+2]=(i=p.complete)===null||i===void 0?void 0:i.bind(p)}let l,u,f;if(t instanceof us)u=cl(t.firestore,jf),f=tg(t._key.path),l={next:p=>{e[a]&&e[a](vF(u,t,p))},error:e[a+1],complete:e[a+2]};else{const p=cl(t,ug);u=cl(p.firestore,jf),f=p._query;const g=new xF(u);l={next:m=>{e[a]&&e[a](new Az(u,g,p,m))},error:e[a+1],complete:e[a+2]},Sz(t._query)}return function(g,m,y,x){const S=new iF(x),A=new Xk(m,S,y);return g.asyncQueue.enqueueAndForget(async()=>Kk(await zx(g),A)),()=>{S.Za(),g.asyncQueue.enqueueAndForget(async()=>Yk(await zx(g),A))}}(ty(u),f,o,l)}function Iz(t,e){return function(n,i){const s=new ll;return n.asyncQueue.enqueueAndForget(async()=>qV(await az(n),i,s)),s.promise}(ty(t),e)}function vF(t,e,r){const n=r.docs.get(e._key),i=new xF(t);return new mF(t,i,e._key,n,new bd(r.hasPendingWrites,r.fromCache),e.converter)}(function(e,r=!0){(function(i){Vu=i})(Uu),Tu(new sc("firestore",(n,{instanceIdentifier:i,options:s})=>{const a=n.getProvider("app").getImmediate(),o=new jf(new F7(n.getProvider("auth-internal")),new R7(n.getProvider("app-check-internal")),function(u,f){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new ct(Be.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Df(u.options.projectId,f)}(a,i),a);return s=Object.assign({useFetchStreams:r},s),o._setSettings(s),o},"PUBLIC").setMultipleInstances(!0)),ol(vE,"4.7.3",e),ol(vE,"4.7.3","esm2017")})();function ay(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function yF(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Nz=yF,_F=new Zf("auth","Firebase",yF());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sp=new kv("@firebase/auth");function Rz(t,...e){Sp.logLevel<=Ht.WARN&&Sp.warn(`Auth (${Uu}): ${t}`,...e)}function wh(t,...e){Sp.logLevel<=Ht.ERROR&&Sp.error(`Auth (${Uu}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uo(t,...e){throw oy(t,...e)}function Na(t,...e){return oy(t,...e)}function EF(t,e,r){const n=Object.assign(Object.assign({},Nz()),{[e]:r});return new Zf("auth","Firebase",n).create(e,{appName:t.name})}function Kl(t){return EF(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function oy(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return _F.create(t,...e)}function yt(t,e,...r){if(!t)throw oy(e,...r)}function Ya(t){const e="INTERNAL ASSERTION FAILED: "+t;throw wh(e),new Error(e)}function fo(t,e){t||Ya(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wx(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function Dz(){return eS()==="http:"||eS()==="https:"}function eS(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pz(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Dz()||i9()||"connection"in navigator)?navigator.onLine:!0}function Oz(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o0{constructor(e,r){this.shortDelay=e,this.longDelay=r,fo(r>e,"Short delay should be less than long delay!"),this.isMobile=t9()||s9()}get(){return Pz()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ly(t,e){fo(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SF{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ya("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ya("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ya("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mz={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bz=new o0(3e4,6e4);function cy(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Hu(t,e,r,n,i={}){return wF(t,i,async()=>{let s={},a={};n&&(e==="GET"?a=n:s={body:JSON.stringify(n)});const o=e0(Object.assign({key:t.config.apiKey},a)).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const u=Object.assign({method:e,headers:l},s);return n9()||(u.referrerPolicy="no-referrer"),SF.fetch()(TF(t,t.config.apiHost,r,o),u)})}async function wF(t,e,r){t._canInitEmulator=!1;const n=Object.assign(Object.assign({},Mz),e);try{const i=new Lz(t),s=await Promise.race([r(),i.promise]);i.clearNetworkTimeout();const a=await s.json();if("needConfirmation"in a)throw rh(t,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{const o=s.ok?a.errorMessage:a.error.message,[l,u]=o.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw rh(t,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw rh(t,"email-already-in-use",a);if(l==="USER_DISABLED")throw rh(t,"user-disabled",a);const f=n[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw EF(t,f,u);uo(t,f)}}catch(i){if(i instanceof xo)throw i;uo(t,"network-request-failed",{message:String(i)})}}async function jz(t,e,r,n,i={}){const s=await Hu(t,e,r,n,i);return"mfaPendingCredential"in s&&uo(t,"multi-factor-auth-required",{_serverResponse:s}),s}function TF(t,e,r,n){const i=`${e}${r}?${n}`;return t.config.emulator?ly(t.config,i):`${t.config.apiScheme}://${i}`}class Lz{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(Na(this.auth,"network-request-failed")),Bz.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function rh(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const i=Na(t,e,n);return i.customData._tokenResponse=r,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Uz(t,e){return Hu(t,"POST","/v1/accounts:delete",e)}async function AF(t,e){return Hu(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qd(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Vz(t,e=!1){const r=aa(t),n=await r.getIdToken(e),i=uy(n);yt(i&&i.exp&&i.auth_time&&i.iat,r.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,a=s==null?void 0:s.sign_in_provider;return{claims:i,token:n,authTime:Qd(mm(i.auth_time)),issuedAtTime:Qd(mm(i.iat)),expirationTime:Qd(mm(i.exp)),signInProvider:a||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function mm(t){return Number(t)*1e3}function uy(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return wh("JWT malformed, contained fewer than 3 sections"),null;try{const i=VC(r);return i?JSON.parse(i):(wh("Failed to decode base64 JWT payload"),null)}catch(i){return wh("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function tS(t){const e=uy(t);return yt(e,"internal-error"),yt(typeof e.exp<"u","internal-error"),yt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Lf(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof xo&&zz(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function zz({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wz{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var r;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const i=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $x{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=Qd(this.lastLoginAt),this.creationTime=Qd(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wp(t){var e;const r=t.auth,n=await t.getIdToken(),i=await Lf(t,AF(r,{idToken:n}));yt(i==null?void 0:i.users.length,r,"internal-error");const s=i.users[0];t._notifyReloadListener(s);const a=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?CF(s.providerUserInfo):[],o=Hz(t.providerData,a),l=t.isAnonymous,u=!(t.email&&s.passwordHash)&&!(o!=null&&o.length),f=l?u:!1,p={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new $x(s.createdAt,s.lastLoginAt),isAnonymous:f};Object.assign(t,p)}async function $z(t){const e=aa(t);await wp(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function Hz(t,e){return[...t.filter(n=>!e.some(i=>i.providerId===n.providerId)),...e]}function CF(t){return t.map(e=>{var{providerId:r}=e,n=ay(e,["providerId"]);return{providerId:r,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Gz(t,e){const r=await wF(t,{},async()=>{const n=e0({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,a=TF(t,i,"/v1/token",`key=${s}`),o=await t._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",SF.fetch()(a,{method:"POST",headers:o,body:n})});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function Kz(t,e){return Hu(t,"POST","/v2/accounts:revokeToken",cy(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class du{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){yt(e.idToken,"internal-error"),yt(typeof e.idToken<"u","internal-error"),yt(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):tS(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){yt(e.length!==0,"internal-error");const r=tS(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(yt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:i,expiresIn:s}=await Gz(e,r);this.updateTokensAndExpiration(n,i,Number(s))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:i,expirationTime:s}=r,a=new du;return n&&(yt(typeof n=="string","internal-error",{appName:e}),a.refreshToken=n),i&&(yt(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),s&&(yt(typeof s=="number","internal-error",{appName:e}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new du,this.toJSON())}_performRefresh(){return Ya("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mo(t,e){yt(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Xa{constructor(e){var{uid:r,auth:n,stsTokenManager:i}=e,s=ay(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Wz(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new $x(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const r=await Lf(this,this.stsTokenManager.getToken(this.auth,e));return yt(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return Vz(this,e)}reload(){return $z(this)}_assign(e){this!==e&&(yt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>Object.assign({},r)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new Xa(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(e){yt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await wp(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Xo(this.auth.app))return Promise.reject(Kl(this.auth));const e=await this.getIdToken();return await Lf(this,Uz(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){var n,i,s,a,o,l,u,f;const p=(n=r.displayName)!==null&&n!==void 0?n:void 0,g=(i=r.email)!==null&&i!==void 0?i:void 0,m=(s=r.phoneNumber)!==null&&s!==void 0?s:void 0,y=(a=r.photoURL)!==null&&a!==void 0?a:void 0,x=(o=r.tenantId)!==null&&o!==void 0?o:void 0,S=(l=r._redirectEventId)!==null&&l!==void 0?l:void 0,A=(u=r.createdAt)!==null&&u!==void 0?u:void 0,C=(f=r.lastLoginAt)!==null&&f!==void 0?f:void 0,{uid:E,emailVerified:O,isAnonymous:q,providerData:H,stsTokenManager:T}=r;yt(E&&T,e,"internal-error");const F=du.fromJSON(this.name,T);yt(typeof E=="string",e,"internal-error"),Mo(p,e.name),Mo(g,e.name),yt(typeof O=="boolean",e,"internal-error"),yt(typeof q=="boolean",e,"internal-error"),Mo(m,e.name),Mo(y,e.name),Mo(x,e.name),Mo(S,e.name),Mo(A,e.name),Mo(C,e.name);const w=new Xa({uid:E,auth:e,email:g,emailVerified:O,displayName:p,isAnonymous:q,photoURL:y,phoneNumber:m,tenantId:x,stsTokenManager:F,createdAt:A,lastLoginAt:C});return H&&Array.isArray(H)&&(w.providerData=H.map(N=>Object.assign({},N))),S&&(w._redirectEventId=S),w}static async _fromIdTokenResponse(e,r,n=!1){const i=new du;i.updateFromServerResponse(r);const s=new Xa({uid:r.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await wp(s),s}static async _fromGetAccountInfoResponse(e,r,n){const i=r.users[0];yt(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?CF(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),o=new du;o.updateFromIdToken(n);const l=new Xa({uid:i.localId,auth:e,stsTokenManager:o,isAnonymous:a}),u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new $x(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(l,u),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rS=new Map;function qa(t){fo(t instanceof Function,"Expected a class definition");let e=rS.get(t);return e?(fo(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,rS.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kF{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}kF.type="NONE";const nS=kF;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Th(t,e,r){return`firebase:${t}:${e}:${r}`}class fu{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:i,name:s}=this.auth;this.fullUserKey=Th(this.userKey,i.apiKey,s),this.fullPersistenceKey=Th("persistence",i.apiKey,s),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Xa._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new fu(qa(nS),e,n);const i=(await Promise.all(r.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let s=i[0]||qa(nS);const a=Th(n,e.config.apiKey,e.name);let o=null;for(const u of r)try{const f=await u._get(a);if(f){const p=Xa._fromJSON(e,f);u!==s&&(o=p),s=u;break}}catch{}const l=i.filter(u=>u._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new fu(s,e,n):(s=l[0],o&&await s._set(a,o.toJSON()),await Promise.all(r.map(async u=>{if(u!==s)try{await u._remove(a)}catch{}})),new fu(s,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iS(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(NF(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(FF(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(DF(e))return"Blackberry";if(PF(e))return"Webos";if(bF(e))return"Safari";if((e.includes("chrome/")||IF(e))&&!e.includes("edge/"))return"Chrome";if(RF(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function FF(t=_i()){return/firefox\//i.test(t)}function bF(t=_i()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function IF(t=_i()){return/crios\//i.test(t)}function NF(t=_i()){return/iemobile/i.test(t)}function RF(t=_i()){return/android/i.test(t)}function DF(t=_i()){return/blackberry/i.test(t)}function PF(t=_i()){return/webos/i.test(t)}function dy(t=_i()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function Yz(t=_i()){var e;return dy(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function Xz(){return a9()&&document.documentMode===10}function OF(t=_i()){return dy(t)||RF(t)||PF(t)||DF(t)||/windows phone/i.test(t)||NF(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MF(t,e=[]){let r;switch(t){case"Browser":r=iS(_i());break;case"Worker":r=`${iS(_i())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${Uu}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qz{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=s=>new Promise((a,o)=>{try{const l=e(s);a(l)}catch(l){o(l)}});n.onAbort=r,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const i of r)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Qz(t,e={}){return Hu(t,"GET","/v2/passwordPolicy",cy(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jz=6;class Zz{constructor(e){var r,n,i,s;const a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=a.minPasswordLength)!==null&&r!==void 0?r:Jz,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(n=e.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var r,n,i,s,a,o;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(r=l.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(n=l.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),l.isValid&&(l.isValid=(i=l.containsLowercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(s=l.containsUppercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(a=l.containsNumericCharacter)!==null&&a!==void 0?a:!0),l.isValid&&(l.isValid=(o=l.containsNonAlphanumericCharacter)!==null&&o!==void 0?o:!0),l}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),i&&(r.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eW{constructor(e,r,n,i){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new sS(this),this.idTokenSubscription=new sS(this),this.beforeStateQueue=new qz(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=_F,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=qa(r)),this._initializationPromise=this.queue(async()=>{var n,i;if(!this._deleted&&(this.persistenceManager=await fu.create(this,e),!this._deleted)){if(!((n=this._popupRedirectResolver)===null||n===void 0)&&n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await AF(this,{idToken:e}),n=await Xa._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var r;if(Xo(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(o,o))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let i=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,o=i==null?void 0:i._redirectEventId,l=await this.tryRedirectSignIn(e);(!a||a===o)&&(l!=null&&l.user)&&(i=l.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(a){i=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return yt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await wp(e)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=Oz()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Xo(this.app))return Promise.reject(Kl(this));const r=e?aa(e):null;return r&&yt(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&yt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Xo(this.app)?Promise.reject(Kl(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Xo(this.app)?Promise.reject(Kl(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(qa(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await Qz(this),r=new Zz(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Zf("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await Kz(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&qa(e)||this._popupRedirectResolver;yt(r,this,"argument-error"),this.redirectPersistenceManager=await fu.create(this,[qa(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(r=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,i){if(this._deleted)return()=>{};const s=typeof r=="function"?r:r.next.bind(r);let a=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(yt(o,this,"internal-error"),o.then(()=>{a||s(this.currentUser)}),typeof r=="function"){const l=e.addObserver(r,n,i);return()=>{a=!0,l()}}else{const l=e.addObserver(r);return()=>{a=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return yt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=MF(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);const n=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());n&&(r["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(r["X-Firebase-AppCheck"]=i),r}async _getAppCheckToken(){var e;const r=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return r!=null&&r.error&&Rz(`Error while retrieving App Check token: ${r.error}`),r==null?void 0:r.token}}function fy(t){return aa(t)}class sS{constructor(e){this.auth=e,this.observer=null,this.addObserver=p9(r=>this.observer=r)}get next(){return yt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let hy={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function tW(t){hy=t}function rW(t){return hy.loadJS(t)}function nW(){return hy.gapiScript}function iW(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sW(t,e){const r=bv(t,"auth");if(r.isInitialized()){const i=r.getImmediate(),s=r.getOptions();if(dp(s,e??{}))return i;uo(i,"already-initialized")}return r.initialize({options:e})}function aW(t,e){const r=(e==null?void 0:e.persistence)||[],n=(Array.isArray(r)?r:[r]).map(qa);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function oW(t,e,r){const n=fy(t);yt(n._canInitEmulator,n,"emulator-config-failed"),yt(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const i=!1,s=BF(e),{host:a,port:o}=lW(e),l=o===null?"":`:${o}`;n.config.emulator={url:`${s}//${a}${l}/`},n.settings.appVerificationDisabledForTesting=!0,n.emulatorConfig=Object.freeze({host:a,port:o,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),cW()}function BF(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function lW(t){const e=BF(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const s=i[1];return{host:s,port:aS(n.substr(s.length+1))}}else{const[s,a]=n.split(":");return{host:s,port:aS(a)}}}function aS(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function cW(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jF{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return Ya("not implemented")}_getIdTokenResponse(e){return Ya("not implemented")}_linkToIdToken(e,r){return Ya("not implemented")}_getReauthenticationResolver(e){return Ya("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hu(t,e){return jz(t,"POST","/v1/accounts:signInWithIdp",cy(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uW="http://localhost";class cc extends jF{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new cc(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):uo("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:i}=r,s=ay(r,["providerId","signInMethod"]);if(!n||!i)return null;const a=new cc(n,i);return a.idToken=s.idToken||void 0,a.accessToken=s.accessToken||void 0,a.secret=s.secret,a.nonce=s.nonce,a.pendingToken=s.pendingToken||null,a}_getIdTokenResponse(e){const r=this.buildRequest();return hu(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,hu(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,hu(e,r)}buildRequest(){const e={requestUri:uW,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=e0(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LF{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l0 extends LF{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vo extends l0{constructor(){super("facebook.com")}static credential(e){return cc._fromParams({providerId:Vo.PROVIDER_ID,signInMethod:Vo.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Vo.credentialFromTaggedObject(e)}static credentialFromError(e){return Vo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Vo.credential(e.oauthAccessToken)}catch{return null}}}Vo.FACEBOOK_SIGN_IN_METHOD="facebook.com";Vo.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zo extends l0{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return cc._fromParams({providerId:zo.PROVIDER_ID,signInMethod:zo.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return zo.credentialFromTaggedObject(e)}static credentialFromError(e){return zo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return zo.credential(r,n)}catch{return null}}}zo.GOOGLE_SIGN_IN_METHOD="google.com";zo.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wo extends l0{constructor(){super("github.com")}static credential(e){return cc._fromParams({providerId:Wo.PROVIDER_ID,signInMethod:Wo.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Wo.credentialFromTaggedObject(e)}static credentialFromError(e){return Wo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Wo.credential(e.oauthAccessToken)}catch{return null}}}Wo.GITHUB_SIGN_IN_METHOD="github.com";Wo.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $o extends l0{constructor(){super("twitter.com")}static credential(e,r){return cc._fromParams({providerId:$o.PROVIDER_ID,signInMethod:$o.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return $o.credentialFromTaggedObject(e)}static credentialFromError(e){return $o.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return $o.credential(r,n)}catch{return null}}}$o.TWITTER_SIGN_IN_METHOD="twitter.com";$o.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ru{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,i=!1){const s=await Xa._fromIdTokenResponse(e,n,i),a=oS(n);return new Ru({user:s,providerId:a,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const i=oS(n);return new Ru({user:e,providerId:i,_tokenResponse:n,operationType:r})}}function oS(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tp extends xo{constructor(e,r,n,i){var s;super(r.code,r.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,Tp.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,i){return new Tp(e,r,n,i)}}function UF(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Tp._fromErrorAndOperation(t,s,e,n):s})}async function dW(t,e,r=!1){const n=await Lf(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return Ru._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fW(t,e,r=!1){const{auth:n}=t;if(Xo(n.app))return Promise.reject(Kl(n));const i="reauthenticate";try{const s=await Lf(t,UF(n,i,e,t),r);yt(s.idToken,n,"internal-error");const a=uy(s.idToken);yt(a,n,"internal-error");const{sub:o}=a;return yt(t.uid===o,n,"user-mismatch"),Ru._forOperation(t,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&uo(n,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hW(t,e,r=!1){if(Xo(t.app))return Promise.reject(Kl(t));const n="signIn",i=await UF(t,n,e),s=await Ru._fromIdTokenResponse(t,n,i);return r||await t._updateCurrentUser(s.user),s}function pW(t,e,r,n){return aa(t).onIdTokenChanged(e,r,n)}function gW(t,e,r){return aa(t).beforeAuthStateChanged(e,r)}const Ap="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VF{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(Ap,"1"),this.storage.removeItem(Ap),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mW=1e3,xW=10;class zF extends VF{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=OF(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),i=this.localCache[r];n!==i&&e(r,i,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((a,o,l)=>{this.notifyListeners(a,l)});return}const n=e.key;r?this.detachListener():this.stopPolling();const i=()=>{const a=this.storage.getItem(n);!r&&this.localCache[n]===a||this.notifyListeners(n,a)},s=this.storage.getItem(n);Xz()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,xW):i()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},mW)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}zF.type="LOCAL";const vW=zF;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WF extends VF{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}WF.type="SESSION";const $F=WF;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yW(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dg{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(i=>i.isListeningto(e));if(r)return r;const n=new dg(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:i,data:s}=r.data,a=this.handlersMap[i];if(!(a!=null&&a.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const o=Array.from(a).map(async u=>u(r.origin,s)),l=await yW(o);r.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:l})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}dg.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function py(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _W{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,a;return new Promise((o,l)=>{const u=py("",20);i.port1.start();const f=setTimeout(()=>{l(new Error("unsupported_event"))},n);a={messageChannel:i,onMessage(p){const g=p;if(g.data.eventId===u)switch(g.data.status){case"ack":clearTimeout(f),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),o(g.data.response);break;default:clearTimeout(f),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:u,data:r},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ra(){return window}function EW(t){Ra().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HF(){return typeof Ra().WorkerGlobalScope<"u"&&typeof Ra().importScripts=="function"}async function SW(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function wW(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function TW(){return HF()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GF="firebaseLocalStorageDb",AW=1,Cp="firebaseLocalStorage",KF="fbase_key";class c0{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function fg(t,e){return t.transaction([Cp],e?"readwrite":"readonly").objectStore(Cp)}function CW(){const t=indexedDB.deleteDatabase(GF);return new c0(t).toPromise()}function Hx(){const t=indexedDB.open(GF,AW);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(Cp,{keyPath:KF})}catch(i){r(i)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(Cp)?e(n):(n.close(),await CW(),e(await Hx()))})})}async function lS(t,e,r){const n=fg(t,!0).put({[KF]:e,value:r});return new c0(n).toPromise()}async function kW(t,e){const r=fg(t,!1).get(e),n=await new c0(r).toPromise();return n===void 0?null:n.value}function cS(t,e){const r=fg(t,!0).delete(e);return new c0(r).toPromise()}const FW=800,bW=3;class YF{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Hx(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>bW)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return HF()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=dg._getInstance(TW()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var e,r;if(this.activeServiceWorker=await SW(),!this.activeServiceWorker)return;this.sender=new _W(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((e=n[0])===null||e===void 0)&&e.fulfilled&&!((r=n[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||wW()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Hx();return await lS(e,Ap,"1"),await cS(e,Ap),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>lS(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>kW(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>cS(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=fg(i,!1).getAll();return new c0(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),r.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),r.push(i));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),FW)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}YF.type="LOCAL";const IW=YF;new o0(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NW(t,e){return e?qa(e):(yt(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gy extends jF{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return hu(e,this._buildIdpRequest())}_linkToIdToken(e,r){return hu(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return hu(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function RW(t){return hW(t.auth,new gy(t),t.bypassAuthState)}function DW(t){const{auth:e,user:r}=t;return yt(r,e,"internal-error"),fW(r,new gy(t),t.bypassAuthState)}async function PW(t){const{auth:e,user:r}=t;return yt(r,e,"internal-error"),dW(r,new gy(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XF{constructor(e,r,n,i,s=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:i,tenantId:s,error:a,type:o}=e;if(a){this.reject(a);return}const l={auth:this.auth,requestUri:r,sessionId:n,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(l))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return RW;case"linkViaPopup":case"linkViaRedirect":return PW;case"reauthViaPopup":case"reauthViaRedirect":return DW;default:uo(this.auth,"internal-error")}}resolve(e){fo(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){fo(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OW=new o0(2e3,1e4);class Zc extends XF{constructor(e,r,n,i,s){super(e,r,i,s),this.provider=n,this.authWindow=null,this.pollId=null,Zc.currentPopupAction&&Zc.currentPopupAction.cancel(),Zc.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return yt(e,this.auth,"internal-error"),e}async onExecution(){fo(this.filter.length===1,"Popup operations only handle one event");const e=py();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(Na(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Na(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Zc.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if(!((n=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Na(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,OW.get())};e()}}Zc.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MW="pendingRedirect",Ah=new Map;class BW extends XF{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=Ah.get(this.auth._key());if(!e){try{const n=await jW(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}Ah.set(this.auth._key(),e)}return this.bypassAuthState||Ah.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function jW(t,e){const r=VW(e),n=UW(t);if(!await n._isAvailable())return!1;const i=await n._get(r)==="true";return await n._remove(r),i}function LW(t,e){Ah.set(t._key(),e)}function UW(t){return qa(t._redirectPersistence)}function VW(t){return Th(MW,t.config.apiKey,t.name)}async function zW(t,e,r=!1){if(Xo(t.app))return Promise.reject(Kl(t));const n=fy(t),i=NW(n,e),a=await new BW(n,i,r).execute();return a&&!r&&(delete a.user._redirectEventId,await n._persistUserIfCurrent(a.user),await n._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WW=10*60*1e3;class $W{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!HW(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!qF(e)){const i=((n=e.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";r.onError(Na(this.auth,i))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=WW&&this.cachedEventUids.clear(),this.cachedEventUids.has(uS(e))}saveEventToCache(e){this.cachedEventUids.add(uS(e)),this.lastProcessedEventTime=Date.now()}}function uS(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function qF({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function HW(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return qF(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function GW(t,e={}){return Hu(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KW=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,YW=/^https?/;async function XW(t){if(t.config.emulator)return;const{authorizedDomains:e}=await GW(t);for(const r of e)try{if(qW(r))return}catch{}uo(t,"unauthorized-domain")}function qW(t){const e=Wx(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const a=new URL(t);return a.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&a.hostname===n}if(!YW.test(r))return!1;if(KW.test(t))return n===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QW=new o0(3e4,6e4);function dS(){const t=Ra().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function JW(t){return new Promise((e,r)=>{var n,i,s;function a(){dS(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{dS(),r(Na(t,"network-request-failed"))},timeout:QW.get()})}if(!((i=(n=Ra().gapi)===null||n===void 0?void 0:n.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=Ra().gapi)===null||s===void 0)&&s.load)a();else{const o=iW("iframefcb");return Ra()[o]=()=>{gapi.load?a():r(Na(t,"network-request-failed"))},rW(`${nW()}?onload=${o}`).catch(l=>r(l))}}).catch(e=>{throw Ch=null,e})}let Ch=null;function ZW(t){return Ch=Ch||JW(t),Ch}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e$=new o0(5e3,15e3),t$="__/auth/iframe",r$="emulator/auth/iframe",n$={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},i$=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function s$(t){const e=t.config;yt(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?ly(e,r$):`https://${t.config.authDomain}/${t$}`,n={apiKey:e.apiKey,appName:t.name,v:Uu},i=i$.get(t.config.apiHost);i&&(n.eid=i);const s=t._getFrameworks();return s.length&&(n.fw=s.join(",")),`${r}?${e0(n).slice(1)}`}async function a$(t){const e=await ZW(t),r=Ra().gapi;return yt(r,t,"internal-error"),e.open({where:document.body,url:s$(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:n$,dontclear:!0},n=>new Promise(async(i,s)=>{await n.restyle({setHideOnLeave:!1});const a=Na(t,"network-request-failed"),o=Ra().setTimeout(()=>{s(a)},e$.get());function l(){Ra().clearTimeout(o),i(n)}n.ping(l).then(l,()=>{s(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o$={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},l$=500,c$=600,u$="_blank",d$="http://localhost";class fS{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function f$(t,e,r,n=l$,i=c$){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-n)/2,0).toString();let o="";const l=Object.assign(Object.assign({},o$),{width:n.toString(),height:i.toString(),top:s,left:a}),u=_i().toLowerCase();r&&(o=IF(u)?u$:r),FF(u)&&(e=e||d$,l.scrollbars="yes");const f=Object.entries(l).reduce((g,[m,y])=>`${g}${m}=${y},`,"");if(Yz(u)&&o!=="_self")return h$(e||"",o),new fS(null);const p=window.open(e||"",o,f);yt(p,t,"popup-blocked");try{p.focus()}catch{}return new fS(p)}function h$(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p$="__/auth/handler",g$="emulator/auth/handler",m$=encodeURIComponent("fac");async function hS(t,e,r,n,i,s){yt(t.config.authDomain,t,"auth-domain-config-required"),yt(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:Uu,eventId:i};if(e instanceof LF){e.setDefaultLanguage(t.languageCode),a.providerId=e.providerId||"",h9(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,p]of Object.entries({}))a[f]=p}if(e instanceof l0){const f=e.getScopes().filter(p=>p!=="");f.length>0&&(a.scopes=f.join(","))}t.tenantId&&(a.tid=t.tenantId);const o=a;for(const f of Object.keys(o))o[f]===void 0&&delete o[f];const l=await t._getAppCheckToken(),u=l?`#${m$}=${encodeURIComponent(l)}`:"";return`${x$(t)}?${e0(o).slice(1)}${u}`}function x$({config:t}){return t.emulator?ly(t,g$):`https://${t.authDomain}/${p$}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xm="webStorageSupport";class v${constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=$F,this._completeRedirectFn=zW,this._overrideRedirectResult=LW}async _openPopup(e,r,n,i){var s;fo((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const a=await hS(e,r,n,Wx(),i);return f$(e,a,py())}async _openRedirect(e,r,n,i){await this._originValidation(e);const s=await hS(e,r,n,Wx(),i);return EW(s),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:i,promise:s}=this.eventManagers[r];return i?Promise.resolve(i):(fo(s,"If manager is not set, promise should be"),s)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await a$(e),n=new $W(e);return r.register("authEvent",i=>(yt(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:n.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(xm,{type:xm},i=>{var s;const a=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[xm];a!==void 0&&r(!!a),uo(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=XW(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return OF()||bF()||dy()}}const y$=v$;var pS="@firebase/auth",gS="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _${constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){yt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function E$(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function S$(t){Tu(new sc("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=n.options;yt(a&&!a.includes(":"),"invalid-api-key",{appName:n.name});const l={apiKey:a,authDomain:o,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:MF(t)},u=new eW(n,i,s,l);return aW(u,r),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),Tu(new sc("auth-internal",e=>{const r=fy(e.getProvider("auth").getImmediate());return(n=>new _$(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),ol(pS,gS,E$(t)),ol(pS,gS,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w$=5*60,T$=$C("authIdTokenMaxAge")||w$;let mS=null;const A$=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>T$)return;const i=r==null?void 0:r.token;mS!==i&&(mS=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function C$(t=YC()){const e=bv(t,"auth");if(e.isInitialized())return e.getImmediate();const r=sW(t,{popupRedirectResolver:y$,persistence:[IW,vW,$F]}),n=$C("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(n,location.origin);if(location.origin===s.origin){const a=A$(s.toString());gW(r,a,()=>a(r.currentUser)),pW(r,o=>a(o))}}const i=zC("auth");return i&&oW(r,`http://${i}`),r}function k$(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}tW({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=i=>{const s=Na("internal-error");s.customData=i,r(s)},n.type="text/javascript",n.charset="UTF-8",k$().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});S$("Browser");const F$={apiKey:"AIzaSyAZZ0804o11q-hS6p7XJZNK_FPGJgXpmPc",authDomain:"finance-automation-b28e8.firebaseapp.com",projectId:"finance-automation-b28e8",storageBucket:"finance-automation-b28e8.firebasestorage.app",messagingSenderId:"832501526859",appId:"1:832501526859:web:3a64f40f9db732af1b78ce"},QF=KC(F$),my=dz(QF);C$(QF);const vd=async(t,e)=>{try{return await Fz(ey(my,"appState",t),{masterData:e.masterData||[],servicesData:e.servicesData||[],ledgerEntries:e.ledgerEntries||[],receipts:e.receipts||[],creditNotes:e.creditNotes||[],openingBalances:e.openingBalances||{},mailerImages:e.mailerImages||{},mailerLogo:e.mailerLogo||null,companyConfig:e.companyConfig||{},nextInvoiceNo:e.nextInvoiceNo||1,nextCombineNo:e.nextCombineNo||1,nextReceiptNo:e.nextReceiptNo||1,nextCreditNoteNo:e.nextCreditNoteNo||1,nextServiceInvoiceNo:e.nextServiceInvoiceNo||1,invoiceValues:e.invoiceValues||{},notifications:e.notifications||[],whatsappSettings:e.whatsappSettings||{},partyMaster:e.partyMaster||[],followups:e.followups||[],userPasswords:e.userPasswords||{},updatedAt:new Date().toISOString()}),!0}catch(r){return console.error("Error saving app state:",r),!1}},xS=async t=>{try{const e=await kz(ey(my,"appState",t));return e.exists()?e.data():null}catch(e){return console.error("Error loading app state:",e),null}},b$=(t,e)=>{const r=ey(my,"appState",t);return bz(r,n=>{n.exists()&&e(n.data())},n=>{console.error("Error in real-time listener:",n)})},nt=t=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:2,maximumFractionDigits:2}).format(t||0),zt=t=>""+new Intl.NumberFormat("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2}).format(t||0),St=t=>{if(!t)return"-";const e=new Date(t);if(isNaN(e.getTime()))return t;const r=e.getDate().toString().padStart(2,"0"),n=e.toLocaleString("en-US",{month:"short"}),i=e.getFullYear();return`${r}-${n}-${i}`},I$=t=>{if(!t)return"-";const e=new Date(t);if(isNaN(e.getTime()))return t;const r=e.getDate(),n=e.toLocaleString("en-US",{month:"short"}),i=e.getFullYear();return`${r}${(a=>{if(a>3&&a<21)return"th";switch(a%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}})(r)} ${n}, ${i}`},nh=t=>{const e=["","One","Two","Three","Four","Five","Six","Seven","Eight","Nine","Ten","Eleven","Twelve","Thirteen","Fourteen","Fifteen","Sixteen","Seventeen","Eighteen","Nineteen"],r=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"];if(t===0)return"Zero";const n=l=>l<20?e[l]:l<100?r[Math.floor(l/10)]+(l%10?" "+e[l%10]:""):e[Math.floor(l/100)]+" Hundred"+(l%100?" "+n(l%100):""),i=l=>l<1e3?n(l):l<1e5?n(Math.floor(l/1e3))+" Thousand"+(l%1e3?" "+n(l%1e3):""):l<1e7?n(Math.floor(l/1e5))+" Lakh"+(l%1e5?" "+i(l%1e5):""):n(Math.floor(l/1e7))+" Crore"+(l%1e7?" "+i(l%1e7):""),s=Math.floor(t),a=Math.round((t-s)*100);let o="INR "+i(s);return a>0&&(o+=" and "+i(a)+" Paise"),o+" Only"},N$=t=>{if(!t)return"";const e=/[\w.-]+@[\w.-]+\.\w+/g,r=t.match(e);return r?r[0]:""},R$=t=>({Approved:{bg:"#DCFCE7",text:"#166534",border:"#86EFAC"},Created:{bg:"#DBEAFE",text:"#1E40AF",border:"#93C5FD"},"Need Edits":{bg:"#FEE2E2",text:"#991B1B",border:"#FCA5A5"},Paid:{bg:"#D1FAE5",text:"#065F46",border:"#6EE7B7"},Individual:{bg:"#E0E7FF",text:"#3730A3",border:"#A5B4FC"},Combined:{bg:"#F3E8FF",text:"#6B21A8",border:"#DDD6FE"},Yes:{bg:"#DCFCE7",text:"#166534",border:"#86EFAC"},No:{bg:"#FEF3C7",text:"#92400E",border:"#FCD34D"},"Not Yet":{bg:"#F1F5F9",text:"#475569",border:"#CBD5E1"},Pending:{bg:"#FEF3C7",text:"#92400E",border:"#FCD34D"},Sent:{bg:"#D1FAE5",text:"#065F46",border:"#6EE7B7"}})[t]||{bg:"#F1F5F9",text:"#475569",border:"#CBD5E1"},vm=({status:t,small:e=!1})=>{const r=R$(t);return c.jsx("span",{style:{display:"inline-flex",alignItems:"center",padding:e?"2px 8px":"4px 12px",borderRadius:"6px",fontSize:e?"11px":"12px",fontWeight:"600",backgroundColor:r.bg,color:r.text,border:`1px solid ${r.border}`},children:t})},Xe=({icon:t,label:e,onClick:r,variant:n="default",disabled:i=!1,small:s=!1,title:a})=>{const o={default:{bg:"#F8FAFC",hoverBg:"#E2E8F0",text:"#475569",border:"#CBD5E1"},primary:{bg:"#2874A6",hoverBg:"#1a5276",text:"#FFFFFF",border:"#2874A6"},success:{bg:"#059669",hoverBg:"#047857",text:"#FFFFFF",border:"#059669"},warning:{bg:"#D97706",hoverBg:"#B45309",text:"#FFFFFF",border:"#D97706"},danger:{bg:"#DC2626",hoverBg:"#B91C1C",text:"#FFFFFF",border:"#DC2626"},brand:{bg:"#2874A6",hoverBg:"#1a5276",text:"#FFFFFF",border:"#2874A6"},purple:{bg:"#7C3AED",hoverBg:"#6D28D9",text:"#FFFFFF",border:"#7C3AED"},secondary:{bg:"#F1F5F9",hoverBg:"#E2E8F0",text:"#475569",border:"#CBD5E1"}},l=o[n]||o.default,u=f=>{f&&(f.preventDefault(),f.stopPropagation()),!i&&r&&r(f)};return c.jsxs("button",{type:"button",onClick:u,disabled:i,title:a||e,style:{display:"inline-flex",alignItems:"center",gap:"6px",padding:s?"5px 10px":"8px 14px",borderRadius:"6px",fontSize:s?"11px":"13px",fontWeight:"600",backgroundColor:i?"#F1F5F9":l.bg,color:i?"#94A3B8":l.text,border:`1px solid ${i?"#E2E8F0":l.border}`,cursor:i?"not-allowed":"pointer",transition:"all 0.15s ease",whiteSpace:"nowrap",opacity:i?.6:1},onMouseEnter:f=>!i&&(f.target.style.backgroundColor=l.hoverBg),onMouseLeave:f=>!i&&(f.target.style.backgroundColor=l.bg),children:[t&&c.jsx(t,{size:s?14:16}),e&&c.jsx("span",{children:e})]})},Lr=({label:t,type:e="text",value:r,onChange:n,placeholder:i,disabled:s,small:a})=>c.jsxs("div",{style:{marginBottom:a?"12px":"16px"},children:[t&&c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:t}),c.jsx("input",{type:e,value:r,onChange:n,placeholder:i,disabled:s,style:{width:"100%",padding:a?"8px 12px":"10px 14px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:a?"13px":"14px",backgroundColor:s?"#F9FAFB":"#FFFFFF",boxSizing:"border-box"}})]}),ih=({label:t,value:e,onChange:r,options:n,small:i})=>c.jsxs("div",{style:{marginBottom:i?"12px":"16px"},children:[t&&c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:t}),c.jsx("select",{value:e,onChange:r,style:{width:"100%",padding:i?"8px 12px":"10px 14px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:i?"13px":"14px",backgroundColor:"#FFFFFF",boxSizing:"border-box"},children:n.map(s=>c.jsx("option",{value:s.value,children:s.label},s.value))})]}),mn=({title:t,children:e,actions:r,noPadding:n=!1})=>c.jsxs("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"12px",border:"1px solid #E2E8F0",boxShadow:"0 2px 8px rgba(0,0,0,0.06)",overflow:"hidden"},children:[t&&c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"14px 20px",borderBottom:"1px solid #E2E8F0",backgroundColor:"#FAFBFC"},children:[c.jsx("h3",{style:{margin:0,fontSize:"15px",fontWeight:"700",color:"#1E293B"},children:t}),r&&c.jsx("div",{style:{display:"flex",gap:"10px"},children:r})]}),c.jsx("div",{style:{padding:n?0:"20px"},children:e})]}),On=({isOpen:t,onClose:e,title:r,children:n,width:i="500px"})=>t?c.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(15, 23, 42, 0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,backdropFilter:"blur(4px)"},onClick:e,children:c.jsxs("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"16px",width:i,maxWidth:"95vw",maxHeight:"90vh",overflow:"hidden",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)"},onClick:s=>s.stopPropagation(),children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"16px 20px",borderBottom:"1px solid #E2E8F0",backgroundColor:"#FAFBFC"},children:[c.jsx("h2",{style:{margin:0,fontSize:"16px",fontWeight:"700",color:"#1E293B"},children:r}),c.jsx("button",{onClick:e,style:{background:"none",border:"none",cursor:"pointer",padding:"4px",color:"#64748B"},children:c.jsx(wa,{size:20})})]}),c.jsx("div",{style:{padding:"20px",maxHeight:"calc(90vh - 100px)",overflowY:"auto"},children:n})]})}):null;function D$(){const[t,e]=ye.useState(()=>{const h=localStorage.getItem("financeAppLogin");return h?JSON.parse(h).isLoggedIn:!1}),[r,n]=ye.useState(()=>{const h=localStorage.getItem("financeAppLogin");return h?JSON.parse(h).userRole:null}),[i,s]=ye.useState({username:"",password:""}),[a,o]=ye.useState(""),[l,u]=ye.useState(!1),[f,p]=ye.useState(!1),[g,m]=ye.useState(null),[y,x]=ye.useState({finance:"finance123",director:"director123"}),[S,A]=ye.useState(!1),[C,E]=ye.useState(!1),[O,q]=ye.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[H,T]=ye.useState(""),F={finance:{role:"finance",name:"Finance Team"},director:{role:"director",name:"Director"}};ye.useEffect(()=>{(async()=>{try{const _=await xS("indreesh-media");_&&_.userPasswords&&(x(_.userPasswords),console.log("Passwords loaded from Firebase"))}catch(_){console.error("Error loading passwords:",_)}A(!0)})()},[]);const[w,N]=ye.useState({name:"Indreesh Media LLP",brand:"JAC",address:"A-1701 Sweet Home CHS LTD, SVP, Plot No: 24",addressLine2:"Andheri West, Nr Last Bus St",city:"Mumbai-400053",gstin:"27AAIFI6351A1ZM",stateCode:"27",stateName:"Maharashtra",email:"alliances@mediabrief.com",phone:"+91 7021911036",website:"www.mediabrief.com",pan:"AAIFI6351A",bank:{name:"Axis Bank",account:"921020009075531",branch:"Andheri",ifsc:"UTIB0000020",holder:"Indreesh Media LLP"},invoicePrefix:"MB/2025-26/",hsnCode:"998365",gstRate:18}),[D,P]=ye.useState("master"),[R,qe]=ye.useState(!1),[Se,Oe]=ye.useState([]),[be,ke]=ye.useState([]),[ne,Ie]=ye.useState([]),[je,K]=ye.useState([]),[te,re]=ye.useState([]),[X,_e]=ye.useState(null),[Ce,Ve]=ye.useState(null),[De,Ne]=ye.useState(null),[it,Z]=ye.useState(1),[Rt,wt]=ye.useState(1),[Dt,Et]=ye.useState(1),[Ye,xr]=ye.useState(1),[Zr,En]=ye.useState(1),[Pi,Oi]=ye.useState(!1),[Mi,Vr]=ye.useState(!1),[Bi,cr]=ye.useState(!1),[zr,Ar]=ye.useState(!1),[Si,xt]=ye.useState(!1),[Cr,Pr]=ye.useState(!1),[Or,Rn]=ye.useState(!1),[vo,yo]=ye.useState(!1),[Gu,Ls]=ye.useState(!1),[Al,oa]=ye.useState(!1),[Ba,Us]=ye.useState(!1),[le,or]=ye.useState(null),[la,ja]=ye.useState("reply"),[La,gs]=ye.useState(""),[ca,Mr]=ye.useState(""),[Sn,ms]=ye.useState({fromDate:"2020-01-01",toDate:new Date().toISOString().split("T")[0]}),[xs,Ku]=ye.useState(""),[wi,I]=ye.useState("open"),[G,j]=ye.useState("open"),[W,Y]=ye.useState(!1),[J,pe]=ye.useState(null),[ve,he]=ye.useState(new Set),[de,ge]=ye.useState({party:"",billStatus:"",invoiceStatus:""}),[Ae,We]=ye.useState({party:"",invoiceNo:"",dateFrom:"",dateTo:""}),[Ue,Me]=ye.useState({party:"",invoiceStatus:"",receiptStatus:"",invoiceType:"",searchText:""}),[$e,at]=ye.useState([]),[ur,ir]=ye.useState(!1),[Gt,Ti]=ye.useState([]),[Ua,qi]=ye.useState(!1),[lr,ua]=ye.useState(null),[Sr,Va]=ye.useState({date:new Date().toISOString().split("T")[0],notes:"",nextFollowupDate:"",status:"Pending"}),[kt,da]=ye.useState({enabled:!1,financePhone:"",financeApiKey:"",directorPhone:"",directorApiKey:""}),[Kt,Qi]=ye.useState({amount:"",tds:"",discount:"",narration:"",paymentAdvisory:null,date:new Date().toISOString().split("T")[0],mode:"Bank"}),[fn,fa]=ye.useState({amount:"",gst:"",reason:"",date:new Date().toISOString().split("T")[0]}),[_o,Ai]=ye.useState({particularsApproved:!1,emailApproved:!1,invoiceTypeApproved:!1}),[ji,Eo]=ye.useState(null),[Li,So]=ye.useState(new Set),[Ft,ha]=ye.useState({}),[zn,pa]=ye.useState(null),[wo,Vs]=ye.useState(null),[Yu,To]=ye.useState(!1),[Wn,_c]=ye.useState({}),[Dn,Ji]=ye.useState({partyName:"",amount:"",type:"Dr"}),[Ui,Ec]=ye.useState({}),[an,zs]=ye.useState({}),[hg,Sc]=ye.useState(!1),[u0,vs]=ye.useState(new Set),[Tt,Cl]=ye.useState({party:"",billStatus:"",invoiceStatus:"",mailingStatus:"",invoiceType:"",combinationCode:"",searchText:""}),[yr,Ws]=ye.useState({amount:"",date:new Date().toISOString().split("T")[0],mode:"Bank",tds:"",discount:"",narration:""}),Xu=ye.useRef(null),Ao=ye.useRef(null),Co=ye.useRef(null),wc=ye.useRef(null),Tc=ye.useRef(null),kr=ye.useRef(null),d0=ye.useRef(null),kl=ye.useRef(null),qu=ye.useRef(null),Qu=ye.useRef(null),wn=ye.useMemo(()=>Array.isArray(Se)?Se:[],[Se]),Wr=ye.useMemo(()=>Array.isArray(be)?be:[],[be]),$n=ye.useMemo(()=>Array.isArray(ne)?ne:[],[ne]),$r=ye.useMemo(()=>Array.isArray(je)?je:[],[je]),ni=ye.useMemo(()=>Array.isArray(te)?te:[],[te]),f0=ye.useMemo(()=>Array.isArray($e)?$e:[],[$e]),ga=ye.useMemo(()=>Array.isArray(Gt)?Gt:[],[Gt]),Ut=ye.useMemo(()=>an&&typeof an=="object"&&!Array.isArray(an)?an:{},[an]),ma=ye.useMemo(()=>Wn&&typeof Wn=="object"&&!Array.isArray(Wn)?Wn:{},[Wn]),$t=(h,_)=>!h||!_?!1:h.trim().toUpperCase()===_.trim().toUpperCase(),ii=ye.useCallback(h=>{if(!h)return"";const _=h.toUpperCase().trim();return _.includes("MAHARASHTRA")||_==="MH"?"MAHARASHTRA":_.includes("DELHI")||_==="DL"||_.includes("NEW DELHI")?"DELHI":_.includes("KARNATAKA")||_==="KA"||_.includes("BANGALORE")||_.includes("BENGALURU")?"KARNATAKA":_.includes("TAMIL")||_==="TN"||_.includes("CHENNAI")?"TAMIL NADU":_.includes("TELANGANA")||_==="TG"||_==="TS"||_.includes("HYDERABAD")?"TELANGANA":_.includes("UTTAR PRADESH")||_==="UP"||_.includes("NOIDA")||_.includes("LUCKNOW")?"UTTAR PRADESH":_.includes("WEST BENGAL")||_==="WB"||_.includes("KOLKATA")?"WEST BENGAL":_.includes("GUJARAT")||_==="GJ"||_.includes("AHMEDABAD")?"GUJARAT":_.includes("RAJASTHAN")||_==="RJ"||_.includes("JAIPUR")?"RAJASTHAN":_.includes("PUNJAB")||_==="PB"?"PUNJAB":_.includes("HARYANA")||_==="HR"||_.includes("GURGAON")||_.includes("GURUGRAM")?"HARYANA":_.includes("MADHYA PRADESH")||_==="MP"||_.includes("BHOPAL")?"MADHYA PRADESH":_.includes("ANDHRA")||_==="AP"?"ANDHRA PRADESH":_.includes("KERALA")||_==="KL"?"KERALA":_.includes("ODISHA")||_.includes("ORISSA")||_==="OR"||_==="OD"?"ODISHA":_.includes("BIHAR")||_==="BR"?"BIHAR":_.includes("JHARKHAND")||_==="JH"?"JHARKHAND":_.includes("ASSAM")||_==="AS"?"ASSAM":_.includes("CHHATTISGARH")||_==="CG"?"CHHATTISGARH":_.includes("GOA")||_==="GA"?"GOA":_.includes("HIMACHAL")||_==="HP"?"HIMACHAL PRADESH":_.includes("JAMMU")||_==="JK"?"JAMMU AND KASHMIR":_.includes("UTTARAKHAND")||_.includes("UTTARANCHAL")||_==="UK"?"UTTARAKHAND":_.includes("MUMBAI")?"MAHARASHTRA":_.includes("CHANDIGARH")?"CHANDIGARH":_},[]),ko=ye.useCallback((h,_)=>{var oe;if(!h)return"";const U=ii(_),Q=h.trim().toUpperCase(),B=`${Q}|${U}`;if((oe=Ut[B])!=null&&oe.gstin)return Ut[B].gstin;for(const L in Ut){const V=Ut[L];if((V.partyName||"").trim().toUpperCase()===Q&&V.normalizedState===U)return V.gstin||""}for(const L in Ut){const V=Ut[L];if((V.partyName||"").trim().toUpperCase()===Q&&V.gstin)return V.gstin}return""},[Ut,ii]),Ac=ye.useCallback((h,_)=>{var oe;if(!h)return"";const U=ii(_),Q=h.trim().toUpperCase(),B=`${Q}|${U}`;if((oe=Ut[B])!=null&&oe.address)return Ut[B].address;for(const L in Ut){const V=Ut[L];if((V.partyName||"").trim().toUpperCase()===Q&&V.normalizedState===U)return V.address||""}for(const L in Ut){const V=Ut[L];if((V.partyName||"").trim().toUpperCase()===Q&&V.address)return V.address}return""},[Ut,ii]),Br=ye.useCallback((h,_,U="")=>{var L,V;if(U&&((L=Ut[U])!=null&&L.clientCode))return Ut[U].clientCode;if(!h)return"";const Q=ii(_),B=h.trim().toUpperCase(),oe=`${B}|${Q}`;if((V=Ut[oe])!=null&&V.clientCode)return Ut[oe].clientCode;for(const b in Ut){const z=Ut[b];if((z.partyName||"").trim().toUpperCase()===B&&z.normalizedState===Q)return z.clientCode||""}for(const b in Ut){const z=Ut[b];if((z.partyName||"").trim().toUpperCase()===B&&z.clientCode)return z.clientCode}return""},[Ut,ii]);ye.useCallback(h=>{if(!h)return null;if(Ut[h])return Ut[h];for(const _ in Ut){const U=Ut[_];if(U.clientCode===h)return U}return null},[Ut]);const ys=ye.useRef(!1),xa=ye.useRef(null),Ju=async()=>{u(!0);try{const h=await xS("indreesh-media");h&&(Array.isArray(h.masterData)&&Oe(h.masterData),Array.isArray(h.servicesData)&&ke(h.servicesData),Array.isArray(h.ledgerEntries)&&Ie(h.ledgerEntries),Array.isArray(h.receipts)&&K(h.receipts),Array.isArray(h.creditNotes)&&re(h.creditNotes),Array.isArray(h.notifications)&&at(h.notifications),Array.isArray(h.followups)&&Ti(h.followups),h.openingBalances&&typeof h.openingBalances=="object"&&!Array.isArray(h.openingBalances)&&_c(h.openingBalances),h.mailerImages&&typeof h.mailerImages=="object"&&!Array.isArray(h.mailerImages)&&ha(h.mailerImages),h.partyMaster&&typeof h.partyMaster=="object"&&!Array.isArray(h.partyMaster)&&zs(h.partyMaster),h.userPasswords&&typeof h.userPasswords=="object"&&!Array.isArray(h.userPasswords)&&x(h.userPasswords),h.mailerLogo&&pa(h.mailerLogo),h.companyConfig&&N(_=>({..._,...h.companyConfig,name:"Indreesh Media LLP",bank:{...h.companyConfig.bank||_.bank,holder:"Indreesh Media LLP"}})),h.nextInvoiceNo&&Z(h.nextInvoiceNo),h.nextCombineNo&&wt(h.nextCombineNo),h.nextReceiptNo&&Et(h.nextReceiptNo),h.nextCreditNoteNo&&xr(h.nextCreditNoteNo),h.nextServiceInvoiceNo&&En(h.nextServiceInvoiceNo),h.invoiceValues&&Ec(h.invoiceValues),h.whatsappSettings&&da(_=>({..._,...h.whatsappSettings})),console.log("Data loaded from Firebase"))}catch(h){console.error("Error loading data:",h)}u(!1)},Cc=ye.useCallback(async()=>{p(!0);try{console.log("Saving to Firebase:",{masterDataCount:Se==null?void 0:Se.length,servicesDataCount:be==null?void 0:be.length,servicesDataSample:be==null?void 0:be.slice(0,1),receiptsCount:je==null?void 0:je.length,creditNotesCount:te==null?void 0:te.length}),await vd("indreesh-media",{masterData:Se,servicesData:be,ledgerEntries:ne,receipts:je,creditNotes:te,openingBalances:Wn,mailerImages:Ft,mailerLogo:zn,companyConfig:w,nextInvoiceNo:it,nextCombineNo:Rt,nextReceiptNo:Dt,nextCreditNoteNo:Ye,nextServiceInvoiceNo:Zr,invoiceValues:Ui,notifications:$e,whatsappSettings:kt,partyMaster:an,followups:Gt,userPasswords:y}),m(new Date),console.log("Data saved to Firebase successfully")}catch(h){console.error("Error saving data:",h)}p(!1)},[Se,be,ne,je,te,Wn,Ft,zn,w,it,Rt,Dt,Ye,Zr,Ui,$e,kt,an,Gt,y]);ye.useEffect(()=>{if(t&&!ys.current)return kl.current&&clearTimeout(kl.current),kl.current=setTimeout(()=>{ys.current||Cc()},1e3),()=>{kl.current&&clearTimeout(kl.current)}},[Se,be,ne,je,te,Wn,Ft,zn,w,it,Rt,Dt,Ye,Zr,Ui,$e,kt,an,Gt,y,t]);const Zu=async(h,_,U)=>{if(!kt.enabled){console.log("WhatsApp notifications not enabled");return}U==="finance"&&kt.financePhone&&kt.financeApiKey?Fo(kt.financePhone,kt.financeApiKey,h,_):U==="director"&&kt.directorPhone&&kt.directorApiKey?Fo(kt.directorPhone,kt.directorApiKey,h,_):U==="all"&&(kt.financePhone&&kt.financeApiKey&&Fo(kt.financePhone,kt.financeApiKey,h,_),kt.directorPhone&&kt.directorApiKey&&Fo(kt.directorPhone,kt.directorApiKey,h,_))},Fo=async(h,_,U,Q)=>{try{const oe=`*${{upload:" DATA UPLOAD",invoice:" INVOICE",approval:" APPROVED",edit:" EDIT REQUIRED",receipt:" PAYMENT",info:" UPDATE"}[U]||" NOTIFICATION"}*

${Q}

_${w.name}_
_${new Date().toLocaleString("en-IN",{timeZone:"Asia/Kolkata"})}_`,L=`https://api.callmebot.com/whatsapp.php?phone=${h}&text=${encodeURIComponent(oe)}&apikey=${_}`;fetch(L,{mode:"no-cors"}).then(()=>console.log("WhatsApp notification sent to:",h)).catch(V=>console.log("WhatsApp send attempted:",h))}catch(B){console.error("Failed to send WhatsApp notification:",B)}},Fl=(h,_)=>{if(!h||!_){alert("Please enter phone number and API key first");return}Fo(h,_,"info","Test notification from Indreesh Media LLP. WhatsApp notifications are working!"),alert("Test message sent! Check your WhatsApp.")},Zi=(h,_,U="all")=>{const Q={id:Date.now()+Math.random(),type:h,message:_,forRole:U,createdAt:new Date().toISOString(),createdBy:r,read:{finance:!1,director:!1}};at(B=>[Q,...B].slice(0,50)),Zu(h,_,U)},h0=h=>{at(_=>(Array.isArray(_)?_:[]).map(Q=>Q.id===h?{...Q,read:{...Q.read,[r]:!0}}:Q))},za=()=>{at(h=>(Array.isArray(h)?h:[]).map(U=>({...U,read:{...U.read,[r]:!0}})))},p0=()=>{at([])},bl=ye.useMemo(()=>f0.filter(h=>h.forRole==="all"||h.forRole===r||h.createdBy!==r).map(h=>({...h,read:h.read||{finance:!1,director:!1}})),[f0,r]),_s=ye.useMemo(()=>r?bl.filter(h=>!(h.read&&h.read[r])).length:0,[bl,r]),ed=async()=>{const h=F[i.username.toLowerCase()],_=y[i.username.toLowerCase()];h&&_===i.password?(e(!0),n(h.role),localStorage.setItem("financeAppLogin",JSON.stringify({isLoggedIn:!0,userRole:h.role})),o(""),s({username:"",password:""}),await Ju()):o("Invalid username or password")},bo=async()=>{if(!O.currentPassword||!O.newPassword||!O.confirmPassword){T("Please fill all fields");return}const h=r==="director"?"director":"finance";if(y[h]!==O.currentPassword){T("Current password is incorrect");return}if(O.newPassword!==O.confirmPassword){T("New passwords do not match");return}if(O.newPassword.length<6){T("Password must be at least 6 characters");return}const _={...y,[h]:O.newPassword};x(_);try{await vd("indreesh-media",{masterData:Se,ledgerEntries:ne,receipts:je,creditNotes:te,openingBalances:Wn,mailerImages:Ft,mailerLogo:zn,companyConfig:w,nextInvoiceNo:it,nextCombineNo:Rt,nextReceiptNo:Dt,nextCreditNoteNo:Ye,invoiceValues:Ui,notifications:$e,whatsappSettings:kt,partyMaster:an,followups:Gt,userPasswords:_}),console.log("Password saved to Firebase")}catch(U){console.error("Error saving password:",U),T("Failed to save password. Please try again.");return}E(!1),q({currentPassword:"",newPassword:"",confirmPassword:""}),T(""),alert(" Password changed successfully!")},Ci=()=>{Cc(),e(!1),n(null),P("master"),localStorage.removeItem("financeAppLogin")};ye.useEffect(()=>{const h=localStorage.getItem("financeAppLogin");if(h){const{isLoggedIn:_}=JSON.parse(h);_&&Ju()}},[]),ye.useEffect(()=>{if(!t){xa.current&&(xa.current(),xa.current=null);return}return xa.current=b$("indreesh-media",h=>{h&&(console.log("Firebase data received:",{hasMasterData:Array.isArray(h.masterData)?h.masterData.length:"not array",hasServicesData:Array.isArray(h.servicesData)?h.servicesData.length:"not array",servicesDataRaw:h.servicesData,hasReceipts:Array.isArray(h.receipts)?h.receipts.length:"not array",hasCreditNotes:Array.isArray(h.creditNotes)?h.creditNotes.length:"not array"}),ys.current=!0,Array.isArray(h.masterData)&&Oe(h.masterData),Array.isArray(h.servicesData)&&ke(h.servicesData),Array.isArray(h.ledgerEntries)&&Ie(h.ledgerEntries),Array.isArray(h.receipts)&&K(h.receipts),Array.isArray(h.creditNotes)&&re(h.creditNotes),Array.isArray(h.notifications)&&at(h.notifications),Array.isArray(h.followups)&&Ti(h.followups),h.openingBalances&&typeof h.openingBalances=="object"&&!Array.isArray(h.openingBalances)&&_c(h.openingBalances),h.mailerImages&&typeof h.mailerImages=="object"&&!Array.isArray(h.mailerImages)&&ha(h.mailerImages),h.partyMaster&&typeof h.partyMaster=="object"&&!Array.isArray(h.partyMaster)&&zs(h.partyMaster),h.userPasswords&&typeof h.userPasswords=="object"&&!Array.isArray(h.userPasswords)&&x(h.userPasswords),h.mailerLogo&&pa(h.mailerLogo),h.companyConfig&&N(_=>({..._,...h.companyConfig,name:"Indreesh Media LLP",bank:{...h.companyConfig.bank||_.bank,holder:"Indreesh Media LLP"}})),h.nextInvoiceNo&&Z(h.nextInvoiceNo),h.nextCombineNo&&wt(h.nextCombineNo),h.nextReceiptNo&&Et(h.nextReceiptNo),h.nextCreditNoteNo&&xr(h.nextCreditNoteNo),h.nextServiceInvoiceNo&&En(h.nextServiceInvoiceNo),h.invoiceValues&&Ec(h.invoiceValues),h.whatsappSettings&&da(_=>({..._,...h.whatsappSettings})),setTimeout(()=>{ys.current=!1},500),console.log("Real-time sync: Data updated from Firebase"))}),()=>{xa.current&&(xa.current(),xa.current=null)}},[t]),ye.useEffect(()=>{if(Wr.length>0){const h=new Set(Wr.map(_=>_.partyName).filter(Boolean));he(_=>_.size===0||_.size!==h.size?h:_)}},[Wr]);const _r=r==="finance",si=r==="director",$s=ye.useMemo(()=>{const h=new Set;return wn.forEach(_=>{_.partyName&&h.add(_.partyName)}),Object.values(Ut).forEach(_=>{_.partyName&&h.add(_.partyName)}),$n.forEach(_=>{_.partyName&&h.add(_.partyName)}),Object.keys(ma).forEach(_=>{_&&h.add(_)}),Array.from(h).filter(Boolean).sort()},[wn,Ut,$n,ma]),d=ye.useMemo(()=>{console.log("=== BUILDING PARTIES FOR LEDGER ===");const h=V=>{if(!V)return"";const b=V.toUpperCase().trim();return b.includes("MAHARASHTRA")||b==="MH"||b.includes("MUMBAI")?"MAHARASHTRA":b.includes("DELHI")||b==="DL"||b.includes("NEW DELHI")?"DELHI":b.includes("KARNATAKA")||b==="KA"||b.includes("BANGALORE")||b.includes("BENGALURU")?"KARNATAKA":b.includes("TAMIL")||b==="TN"||b.includes("CHENNAI")?"TAMIL NADU":b.includes("TELANGANA")||b==="TG"||b==="TS"||b.includes("HYDERABAD")?"TELANGANA":b.includes("UTTAR PRADESH")||b==="UP"||b.includes("NOIDA")||b.includes("LUCKNOW")?"UTTAR PRADESH":b.includes("WEST BENGAL")||b==="WB"||b.includes("KOLKATA")?"WEST BENGAL":b.includes("GUJARAT")||b==="GJ"||b.includes("AHMEDABAD")?"GUJARAT":b.includes("RAJASTHAN")||b==="RJ"||b.includes("JAIPUR")?"RAJASTHAN":b.includes("PUNJAB")||b==="PB"?"PUNJAB":b.includes("HARYANA")||b==="HR"||b.includes("GURGAON")||b.includes("GURUGRAM")?"HARYANA":b.includes("MADHYA PRADESH")||b==="MP"||b.includes("BHOPAL")?"MADHYA PRADESH":b.includes("ANDHRA")||b==="AP"?"ANDHRA PRADESH":b.includes("KERALA")||b==="KL"?"KERALA":b.includes("ODISHA")||b.includes("ORISSA")||b==="OR"||b==="OD"?"ODISHA":b.includes("BIHAR")||b==="BR"?"BIHAR":b.includes("JHARKHAND")||b==="JH"?"JHARKHAND":b.includes("ASSAM")||b==="AS"?"ASSAM":b.includes("CHHATTISGARH")||b==="CG"?"CHHATTISGARH":b.includes("GOA")||b==="GA"?"GOA":b.includes("HIMACHAL")||b==="HP"?"HIMACHAL PRADESH":b.includes("JAMMU")||b==="JK"?"JAMMU AND KASHMIR":b.includes("UTTARAKHAND")||b.includes("UTTARANCHAL")||b==="UK"?"UTTARAKHAND":b.includes("CHANDIGARH")?"CHANDIGARH":b},_=new Map,U=new Set;Object.entries(Ut).forEach(([V,b])=>{if(b.partyName&&b.clientCode){const z=b.partyName.trim().toUpperCase();U.add(z),_.has(b.clientCode)||_.set(b.clientCode,{partyName:b.partyName,partyNameUpper:z,state:b.stateName||"",normalizedState:b.normalizedState||h(b.stateName),gstin:b.gstin||"",address:b.address||"",clientCode:b.clientCode,fromPartyMaster:!0})}}),console.log("Party names with codes:",[...U]),console.log("Parties by code:",_.size);const Q=[..._.values()],B=new Set;_.forEach((V,b)=>{B.add(b),B.add(`${V.partyNameUpper}|${V.normalizedState}`)}),Object.entries(Ut).forEach(([V,b])=>{if(b.partyName&&!b.clientCode){const z=b.partyName.trim().toUpperCase(),se=b.normalizedState||h(b.stateName),fe=`${z}|${se}`;if(U.has(z)){console.log("Skipping (name has codes):",b.partyName);return}B.has(fe)||(B.add(fe),Q.push({partyName:b.partyName,partyNameUpper:z,state:b.stateName||"",normalizedState:se,gstin:b.gstin||"",address:b.address||"",clientCode:"",fromPartyMaster:!0}))}});const oe=(V,b)=>{if(!V)return"";const z=V.trim().toUpperCase(),se=h(b);for(const[fe,we]of _.entries())if(we.partyNameUpper===z&&we.normalizedState===se)return fe;for(const[fe,we]of _.entries())if(we.partyNameUpper===z)return fe;return""};wn.forEach(V=>{if(V.partyName){const b=V.partyName.trim().toUpperCase(),z=h(V.statePartyDetails),se=V.clientCode||oe(V.partyName,V.statePartyDetails);if(se&&B.has(se))return;if(!se&&U.has(b)){console.log("Skipping masterData (name has codes):",V.partyName);return}const fe=`${b}|${z}`;if(B.has(fe))return;B.add(se||fe),se&&B.add(fe),Q.push({partyName:V.partyName,partyNameUpper:b,state:V.statePartyDetails||"",normalizedState:z,gstin:"",address:"",clientCode:se,fromPartyMaster:!1})}}),$n.forEach(V=>{if(V.partyName){const b=V.partyName.trim().toUpperCase(),z=h(V.state||V.statePartyDetails||""),se=oe(V.partyName,V.state||V.statePartyDetails);if(se&&B.has(se))return;if(!se&&U.has(b)){console.log("Skipping ledgerEntry (name has codes):",V.partyName);return}const fe=`${b}|${z}`;if(B.has(fe))return;B.add(se||fe),Q.push({partyName:V.partyName,partyNameUpper:b,state:V.state||V.statePartyDetails||"",normalizedState:z,gstin:"",address:"",clientCode:se,fromPartyMaster:!1})}}),Object.keys(ma).forEach(V=>{if(V){const b=V.trim().toUpperCase(),z=oe(V,"");if(z&&B.has(z))return;if(!z&&U.has(b)){console.log("Skipping openingBalance (name has codes):",V);return}const se=`${b}|`;if(B.has(se))return;let fe=!1;for(const we of B)if(we.startsWith(b+"|")){fe=!0;break}if(fe)return;B.add(z||se),Q.push({partyName:V,partyNameUpper:b,state:"",normalizedState:"",gstin:"",address:"",clientCode:z,fromPartyMaster:!1})}}),Wr.forEach(V=>{if(V.partyName){const b=V.partyName.trim().toUpperCase(),z=h(V.statePartyDetails),se=V.clientCode||oe(V.partyName,V.statePartyDetails);if(se&&B.has(se))return;if(!se&&U.has(b)){console.log("Skipping servicesData (name has codes):",V.partyName);return}const fe=`${b}|${z}`;if(B.has(fe))return;B.add(se||fe),Q.push({partyName:V.partyName,partyNameUpper:b,state:V.statePartyDetails||"",normalizedState:z,gstin:V.gstin||"",address:V.address||"",clientCode:se,fromPartyMaster:!1})}});const L=Q.filter(V=>!V.clientCode&&U.has(V.partyNameUpper)?(console.log("FINAL CLEANUP - Removing:",V.partyName,"state:",V.state),!1):!0);return console.log("Final party list:",L.length,"parties"),L.forEach(V=>console.log("  -",V.partyName,V.clientCode||"(no code)",V.state)),L.sort((V,b)=>V.partyName.localeCompare(b.partyName))},[wn,Wr,Ut,$n,ma]);ye.useMemo(()=>[...new Set(wn.filter(_=>_.combinationCode&&_.combinationCode!=="NA").map(_=>_.combinationCode))].sort((_,U)=>parseInt(_)-parseInt(U)),[wn]);const v=ye.useMemo(()=>wn.filter(h=>{var _,U,Q,B,oe,L;if(Tt.party&&h.partyName!==Tt.party||Tt.billStatus&&h.toBeBilled!==Tt.billStatus||Tt.invoiceStatus&&(Tt.invoiceStatus==="Generated"&&!h.invoiceGenerated||Tt.invoiceStatus==="Not Generated"&&h.invoiceGenerated||Tt.invoiceStatus==="Paid"&&h.invoiceStatus!=="Paid")||Tt.mailingStatus&&h.mailingSent!==Tt.mailingStatus||Tt.invoiceType&&h.invoiceType!==Tt.invoiceType||Tt.combinationCode&&h.combinationCode!==Tt.combinationCode)return!1;if(Tt.searchText){const V=Tt.searchText.toLowerCase();if(!(((_=h.senderName)==null?void 0:_.toLowerCase().includes(V))||((U=h.subject)==null?void 0:U.toLowerCase().includes(V))||((Q=h.campaignName)==null?void 0:Q.toLowerCase().includes(V))||((B=h.invoiceNo)==null?void 0:B.toLowerCase().includes(V))||((oe=h.partyName)==null?void 0:oe.toLowerCase().includes(V))||((L=h.emailId)==null?void 0:L.toLowerCase().includes(V))))return!1}return!0}),[wn,Tt]);ye.useMemo(()=>{const h={};return v.forEach(_=>{h[_.partyName]||(h[_.partyName]=[]),h[_.partyName].push(_)}),Object.keys(h).forEach(_=>{h[_].sort((U,Q)=>U.toBeBilled==="Yes"&&Q.toBeBilled!=="Yes"?-1:U.toBeBilled!=="Yes"&&Q.toBeBilled==="Yes"?1:0)}),h},[v]),ye.useMemo(()=>{if(!X)return[];const h=ma[X]||0;let _=h;const U=$n.filter(Q=>$t(Q.partyName,X)).sort((Q,B)=>new Date(Q.date)-new Date(B.date)).map(Q=>(_=_+Q.debit-Q.credit,{...Q,balance:_}));return h!==0?[{id:"opening",date:"",particulars:"Opening Balance",debit:h>0?h:0,credit:h<0?Math.abs(h):0,balance:h,isOpening:!0},...U]:U},[X,$n,ma]);const k=h=>wn.filter(_=>$t(_.partyName,h)&&_.toBeBilled==="Yes"&&!_.invoiceGenerated&&_.invoiceAmount),M=h=>!h||h==="NA"?!1:wn.some(_=>_.combinationCode===h&&_.mailingSent==="Yes"),ue=h=>h.invoiceType==="Combined"&&h.combinationCode!=="NA"?wn.filter(_=>_.combinationCode===h.combinationCode):[h],xe=()=>{Cl({party:"",billStatus:"",invoiceStatus:"",mailingStatus:"",invoiceType:"",combinationCode:"",searchText:""})},He=Object.values(Tt).some(h=>h!==""),Jt=h=>{const _=[];return h.emailId&&_.push(h.emailId),h.additionalEmails&&h.additionalEmails.length>0&&_.push(...h.additionalEmails),_},Tn=(h,_)=>{!_||!_.includes("@")||Oe(U=>U.map(Q=>{if(Q.id===h){const B=Q.additionalEmails||[];if(!B.includes(_)&&_!==Q.emailId)return{...Q,additionalEmails:[...B,_]}}return Q}))},Yt=(h,_)=>{Oe(U=>U.map(Q=>Q.id===h?{...Q,additionalEmails:(Q.additionalEmails||[]).filter(B=>B!==_)}:Q))},An=h=>{or(h),Mr(h.editComments||h.approvalRemarks||""),Ai({particularsApproved:h.particularsApproved||!1,emailApproved:h.emailApproved||!1,invoiceTypeApproved:h.invoiceTypeApproved||!1}),Rn(!0)},Pn=()=>{if(!le)return;if(!_o.particularsApproved||!_o.emailApproved||!_o.invoiceTypeApproved){alert("Please confirm all approval checkboxes before approving.");return}const h={invoiceStatus:"Approved",approvalRemarks:ca.trim()||"",editComments:"",particularsApproved:!0,emailApproved:!0,invoiceTypeApproved:!0,approvedBy:r,approvedDate:new Date().toISOString()};if(le.isService){ke(B=>B.map(oe=>oe.id===le.id?{...oe,...h}:oe));const U=parseFloat(le.invoiceTotalAmount)||0,Q=`${le.invoiceNo} - ${le.serviceType||"Service"}`;Ie(B=>[...B,{id:Date.now(),partyName:le.partyName,date:le.invoiceDate,particulars:le.serviceType||"Service",narration:Q,debit:U,credit:0,type:"invoice",invoiceNo:le.invoiceNo}])}else{let U=[];le.invoiceType==="Combined"&&le.combinationCode!=="NA"?(U=Se.filter(L=>L.combinationCode===le.combinationCode),Oe(L=>L.map(V=>V.combinationCode===le.combinationCode?{...V,...h}:V))):(U=[le],Oe(L=>L.map(V=>V.id===le.id?{...V,...h}:V)));const Q=parseFloat(le.invoiceTotalAmount)||0,B=U.map(L=>{var V,b;return L.senderName||((b=(V=L.campaignName)==null?void 0:V.split("--")[0])==null?void 0:b.trim())}).join(", "),oe=`${le.invoiceNo} - ${B}`;Ie(L=>[...L,{id:Date.now(),partyName:le.partyName,date:le.invoiceDate,particulars:"Promotional Trade Mailer",narration:oe,debit:Q,credit:0,type:"invoice",invoiceNo:le.invoiceNo,combinationCode:le.combinationCode}])}const _=ca.trim()?` | Remarks: "${ca.trim()}"`:"";Zi("approval",` Invoice ${le.invoiceNo} has been APPROVED by Director${_} - ready for mailing`,"finance"),Rn(!1),or(null),Ai({particularsApproved:!1,emailApproved:!1,invoiceTypeApproved:!1}),Mr(""),alert(` Invoice Approved!

The invoice is now ready for mailing.`)},Io=()=>{if(!le)return;const h=ca.trim();le.isService?ke(U=>U.map(Q=>Q.id===le.id?{...Q,invoiceStatus:"Need Edits",editComments:h,approvalRemarks:""}:Q)):le.invoiceType==="Combined"&&le.combinationCode!=="NA"?Oe(U=>U.map(Q=>Q.combinationCode===le.combinationCode?{...Q,invoiceStatus:"Need Edits",editComments:h,approvalRemarks:""}:Q)):Oe(U=>U.map(Q=>Q.id===le.id?{...Q,invoiceStatus:"Need Edits",editComments:h,approvalRemarks:""}:Q));const _=h?`: "${h}"`:"";Zi("edit",` Invoice ${le.invoiceNo} marked as NEED EDITS by Director${_}`,"finance"),Rn(!1),or(null),Mr("")},Vi=h=>{or(h);const _=parseFloat(h.invoiceTotalAmount)||0;Qi({amount:_.toFixed(2),tds:"",discount:"",narration:"",paymentAdvisory:null,date:new Date().toISOString().split("T")[0],mode:"Bank"}),Ls(!0)},kc=()=>{if(!le||!Kt.amount){alert("Please enter receipt amount");return}if(le.invoiceStatus!=="Approved"){alert("Receipt cannot be posted. Invoice must be approved first.");return}if(!le.isHistorical&&le.mailingSent!=="Yes"){alert("Receipt cannot be posted. Invoice must be mailed first.");return}const h=`RCP/${new Date().getFullYear()}-${String(new Date().getFullYear()+1).slice(-2)}/${Dt}`,_=parseFloat(Kt.amount)||0,U=parseFloat(Kt.tds)||0,Q=parseFloat(Kt.discount)||0,B=_+U+Q,oe=ue(le),L=oe.map(ie=>ie.subject||ie.senderName).join(", "),V=L.length>50?L.substring(0,47)+"...":L,b={id:Date.now(),receiptNo:h,invoiceNo:le.invoiceNo,partyName:le.partyName,date:Kt.date,amount:_,tds:U,discount:Q,totalCredit:B,narration:Kt.narration,paymentAdvisory:Kt.paymentAdvisory,mode:Kt.mode,campaigns:oe.map(ie=>({senderName:ie.senderName,subject:ie.subject}))};K(ie=>[...ie,b]);const z=Kt.narration||V;_>0&&Ie(ie=>[...ie,{id:Date.now(),partyName:le.partyName,date:Kt.date,particulars:`Payment Received - ${z}`,narration:`${le.invoiceNo} | ${Kt.mode}`,debit:0,credit:_,type:"receipt",receiptNo:h,invoiceNo:le.invoiceNo,paymentAdvisory:Kt.paymentAdvisory}]),U>0&&Ie(ie=>[...ie,{id:Date.now()+1,partyName:le.partyName,date:Kt.date,particulars:"TDS Deducted",narration:`Against ${le.invoiceNo}`,debit:0,credit:U,type:"tds",receiptNo:h,invoiceNo:le.invoiceNo}]),Q>0&&Ie(ie=>[...ie,{id:Date.now()+2,partyName:le.partyName,date:Kt.date,particulars:"Discount Given",narration:`Against ${le.invoiceNo}`,debit:0,credit:Q,type:"discount",receiptNo:h,invoiceNo:le.invoiceNo}]);const se=parseFloat(le.invoiceTotalAmount)||0,fe=te.find(ie=>ie.invoiceNo===le.invoiceNo),we=fe?Math.abs(parseFloat(fe.totalAmount)||0):0,ce=se-B-we<=0;le.invoiceType==="Combined"&&le.combinationCode!=="NA"?Oe(ie=>ie.map(ee=>ee.combinationCode===le.combinationCode?{...ee,receiptStatus:ce?"Closed":"Received",receiptNo:h,receiptDate:Kt.date}:ee)):le.isHistorical||Oe(ie=>ie.map(ee=>ee.id===le.id?{...ee,receiptStatus:ce?"Closed":"Received",receiptNo:h,receiptDate:Kt.date}:ee)),Et(ie=>ie+1),Zi("receipt",` Payment received for ${le.partyName} - Receipt ${h} - ${nt(B)}`,"director"),Ls(!1),or(null),Qi({amount:"",tds:"",discount:"",narration:"",paymentAdvisory:null,date:new Date().toISOString().split("T")[0],mode:"Bank"}),alert(` Receipt Created!

Receipt No: ${h}
Amount: ${nt(B)}`)},Fc=h=>{or(h),fa({amount:"",tds:"",discount:"",reason:"",date:new Date().toISOString().split("T")[0]}),oa(!0)},JF=()=>{var ie;if(!le||!fn.amount&&!fn.gst||!fn.reason){alert("Please enter Amount and/or GST and reason");return}const h=le.invoiceNo.match(/(\d{4}-\d{2})/),_=h?h[1]:`${new Date().getFullYear()}-${String(new Date().getFullYear()+1).slice(-2)}`,U=le.invoiceNo.split("/").pop(),Q=`CN/${_}/${U}`,B=parseFloat(fn.amount)||0,oe=parseFloat(fn.gst)||0,L=B+oe,b=((ie=le.statePartyDetails)==null?void 0:ie.toUpperCase().includes("MAHARASHTRA"))?"CGST/SGST":"IGST",z={id:Date.now(),creditNoteNo:Q,invoiceNo:le.invoiceNo,partyName:le.partyName,date:fn.date,amount:B,gst:oe,gstType:b,totalAmount:L,reason:fn.reason};re(ee=>[...ee,z]);const se=parseFloat(le.invoiceTotalAmount)||0,fe=je.find(ee=>ee.invoiceNo===le.invoiceNo),we=fe?parseFloat(fe.amount)+parseFloat(fe.tds||0)+parseFloat(fe.discount||0):0,Ze=L>=se-we;le.isHistorical||Oe(ee=>ee.map(Te=>Te.invoiceNo===le.invoiceNo?{...Te,creditNoteNo:Q,receiptStatus:Ze?"Cancelled":Te.receiptStatus}:Te)),xr(ee=>ee+1),oa(!1),or(null),fa({amount:"",gst:"",reason:"",date:new Date().toISOString().split("T")[0]});let ce=` Credit Note Created!

Credit Note No: ${Q}`;B>0&&(ce+=`
Base Amount: ${nt(B)}`),oe>0&&(ce+=`
${b}: ${nt(oe)}`),ce+=`
Total: ${nt(L)}`,Ze&&(ce+=`

 Invoice fully covered by CN - marked as Cancelled`),alert(ce)},ZF=h=>{var Q;const _=(Q=h.target.files)==null?void 0:Q[0];if(!_)return;const U=new FileReader;U.onload=B=>{Qi(oe=>({...oe,paymentAdvisory:B.target.result}))},U.readAsDataURL(_),h.target.value=""},pg=h=>{or(h),yo(!0)},e4=()=>{if(!le)return;const h=le.invoiceNo;le.invoiceType==="Combined"&&le.combinationCode!=="NA"?Oe(Q=>Q.map(B=>B.combinationCode===le.combinationCode?{...B,invoiceNo:"",invoiceDate:"",invoiceTotalAmount:"",invoiceGenerated:!1,invoiceStatus:"Pending",invoiceType:"Individual",combinationCode:"NA",mailingSent:"No",mailDate:"",editComments:"",receiptStatus:"",receiptNo:"",receiptDate:""}:B)):Oe(Q=>Q.map(B=>B.id===le.id?{...B,invoiceNo:"",invoiceDate:"",invoiceTotalAmount:"",invoiceGenerated:!1,invoiceStatus:"Pending",invoiceType:"Individual",combinationCode:"NA",mailingSent:"No",mailDate:"",editComments:"",receiptStatus:"",receiptNo:"",receiptDate:""}:B)),Ie(Q=>Q.filter(B=>B.invoiceNo!==h));const _=je.filter(Q=>Q.invoiceNo===h);_.length>0&&K(Q=>Q.filter(B=>B.invoiceNo!==h)),yo(!1),or(null);const U=_.length>0?`
${_.length} receipt(s) also deleted.`:"";alert(` Invoice ${h} deleted.${U}

You can now regenerate the invoice.`)},t4=h=>{confirm(`Delete Receipt ${h.receiptNo}?

This will also update the invoice status back to Pending.`)&&(K(_=>_.filter(U=>U.id!==h.id)),Oe(_=>_.map(U=>U.invoiceNo===h.invoiceNo?{...U,receiptStatus:"",receiptNo:"",receiptDate:""}:U)),alert(` Receipt ${h.receiptNo} deleted.`))},r4=h=>{confirm(`Delete Credit Note ${h.creditNoteNo}?

This will remove the CN association from the invoice.`)&&(re(_=>_.filter(U=>U.id!==h.id)),Oe(_=>_.map(U=>U.invoiceNo===h.invoiceNo?{...U,creditNoteNo:""}:U)),alert(` Credit Note ${h.creditNoteNo} deleted.`))},n4=h=>{confirm(`Delete historical entry?

Vch No: ${h.vchNo||"N/A"}
Amount: ${h.debit||h.credit}

This action cannot be undone.`)&&(Ie(_=>_.filter(U=>U.id!==h.id)),alert(" Historical entry deleted."))},i4=()=>{if(!X||!confirm(`Delete ALL historical entries for "${X}"?

This will remove all imported historical data for this party.`))return;const h=ne.filter(_=>$t(_.partyName,X)&&_.isHistorical).length;Ie(_=>_.filter(U=>!($t(U.partyName,X)&&U.isHistorical))),alert(` ${h} historical entries deleted for ${X}.`)},s4=h=>{ua(h),Va({date:new Date().toISOString().split("T")[0],notes:"",nextFollowupDate:"",status:"Pending"}),qi(!0)},a4=()=>{var _,U;if(!lr)return;const h={id:Date.now(),invoiceNo:lr.invoiceNo,partyName:lr.partyName,invoiceDate:lr.invoiceDate||lr.date,invoiceAmount:lr.invoiceTotalAmount||lr.totalAmount,subject:((U=(_=lr.campaigns)==null?void 0:_[0])==null?void 0:U.subject)||lr.subject||"",followupDate:Sr.date,notes:Sr.notes,nextFollowupDate:Sr.nextFollowupDate,status:Sr.status};Ti(Q=>[...Q,h]),qi(!1),ua(null),Zi("followup",`Followup added for ${lr.invoiceNo}`,"all"),alert(` Followup recorded for ${lr.invoiceNo}`)},o4=h=>{confirm("Delete this followup entry?")&&Ti(_=>_.filter(U=>U.id!==h))},l4=h=>{var V,b;const _=h.subject||((b=(V=h.campaigns)==null?void 0:V[0])==null?void 0:b.subject)||"",U=h.partyName,Q=h.invoiceNo,B=nt(h.invoiceTotalAmount||h.totalAmount||0),oe=St(h.invoiceDate||h.date);return`Subject: RE: ${_} - Payment Followup for Invoice ${Q}

Dear Sir/Madam,

Greetings from ${w.name}!

This is a gentle reminder regarding the outstanding payment for:

Invoice No: ${Q}
Invoice Date: ${oe}
Amount: ${B}
Party: ${U}

We kindly request you to process the payment at the earliest. If the payment has already been made, please share the payment details for our records.

For any queries, please feel free to reach out.

Thanks & Regards,
Finance Team
${w.name}
Email: ${w.email}
Phone: ${w.phone}`},xy=h=>{const _=l4(h);navigator.clipboard.writeText(_),alert(" Followup email template copied to clipboard!")},vy=h=>{var Q,B;const _=h.subject||((B=(Q=h.campaigns)==null?void 0:Q[0])==null?void 0:B.subject)||"",U=encodeURIComponent(_);window.open(`https://mail.google.com/mail/u/0/#search/${U}`,"_blank")},c4=h=>{var Q;const _=(Q=h.target.files)==null?void 0:Q[0];if(!_)return;const U=new FileReader;U.onload=B=>{const oe=Pl(B.target.result,{type:"binary"}),L=oe.SheetNames[0],V=oe.Sheets[L],b=Er.sheet_to_json(V),z={};b.forEach(se=>{const fe=se["Party Name"]||se["PARTY NAME"]||se.PartyName||"",we=parseFloat(se.Amount||se.AMOUNT||se["Invoice Amount"]||0);fe&&we>0&&(z[fe.trim()]=we)}),Ec(se=>({...se,...z})),alert(` Loaded ${Object.keys(z).length} party invoice values!`)},U.readAsBinaryString(_),h.target.value=""},u4=()=>{const h=Er.json_to_sheet([{"Party Name":"ABC Group Private Limited",Amount:5500},{"Party Name":"XYZ Media Pvt Ltd",Amount:7500}]),_=Er.book_new();Er.book_append_sheet(_,h,"Invoice Values"),Pc(_,"Invoice_Values_Template.xlsx")},d4=h=>{var Q;const _=(Q=h.target.files)==null?void 0:Q[0];if(!_)return;const U=new FileReader;U.onload=B=>{const oe=Pl(B.target.result,{type:"binary"}),L=oe.SheetNames[0],V=oe.Sheets[L],b=Er.sheet_to_json(V),z={...an};let se=0;b.forEach(fe=>{const we=(fe["Name of Ledger"]||fe["Party Name"]||fe["NAME OF LEDGER"]||fe["PARTY NAME"]||"").trim(),Ze=(fe["State Name"]||fe["STATE NAME"]||fe.State||fe.STATE||"").trim(),ce=(fe.Address||fe.ADDRESS||fe["Party Address"]||fe["PARTY ADDRESS"]||"").trim(),ie=(fe["Client Code"]||fe["CLIENT CODE"]||fe.Code||fe.CODE||"").toString().trim();if(we){const ee=ii(Ze),Te=ie||`${we.toUpperCase()}|${ee}`;z[Te]={clientCode:ie,partyName:we,partyNameUpper:we.toUpperCase(),ledgerGroup:fe["Ledger Group"]||fe["LEDGER GROUP"]||"Sundry Debtors",stateName:Ze,normalizedState:ee,gstRegType:fe["GST Registration Type"]||fe["GST REGISTRATION TYPE"]||"Regular",gstin:(fe["GSTIN/UIN"]||fe.GSTIN||fe.GST||"").trim(),address:ce},se++}}),zs(z),alert(` Party Master Updated!

${se} party-state combinations loaded.`)},U.readAsBinaryString(_),h.target.value=""},f4=()=>{const h=Er.json_to_sheet([{"Sl. No.":1,"Client Code":"1.01","Name of Ledger":"ABC PRIVATE LIMITED",Address:"123 Business Park, Andheri East","Ledger Group":"Sundry Debtors","State Name":"Maharashtra","GST Registration Type":"Regular","GSTIN/UIN":"27AAACA1234A1ZQ"},{"Sl. No.":2,"Client Code":"1.02","Name of Ledger":"ABC PRIVATE LIMITED",Address:"456 Tech Hub, Noida","Ledger Group":"Sundry Debtors","State Name":"Uttar Pradesh","GST Registration Type":"Regular","GSTIN/UIN":"09AAACA1234A1ZS"},{"Sl. No.":3,"Client Code":"2.01","Name of Ledger":"XYZ MEDIA PVT LTD",Address:"789 Media Tower, Connaught Place","Ledger Group":"Sundry Debtors","State Name":"Delhi","GST Registration Type":"Regular","GSTIN/UIN":"07AAACX5678B1ZR"}]),_=Er.book_new();Er.book_append_sheet(_,h,"Party Master"),Pc(_,"Party_Master_Template.xlsx")},h4=h=>{var Q;const _=(Q=h.target.files)==null?void 0:Q[0];if(!_)return;if(!X){alert(" Please select a party first from the list, then import their historical ledger."),h.target.value="";return}const U=new FileReader;U.onload=B=>{const oe=Pl(B.target.result,{type:"binary",cellDates:!0}),L=oe.SheetNames[0],V=oe.Sheets[L],b=Er.sheet_to_json(V,{raw:!1}),z=[];let se=0,fe=null;const we=ce=>{if(!ce)return 0;const ie=String(ce).replace(/,/g,"").replace(/[^\d.-]/g,"");return parseFloat(ie)||0},Ze=ce=>{if(!ce||typeof ce!="string")return"";const ie=ce.trim(),ee=ie.split(/[-\/]/);if(ee.length===3){const Te={jan:"01",feb:"02",mar:"03",apr:"04",may:"05",jun:"06",jul:"07",aug:"08",sep:"09",oct:"10",nov:"11",dec:"12"},Je=ee[1].toLowerCase().substring(0,3);if(Te[Je]){const lt=ee[0].padStart(2,"0");return`${ee[2].length===2?parseInt(ee[2])>50?"19"+ee[2]:"20"+ee[2]:ee[2]}-${Te[Je]}-${lt}`}}return ie};b.forEach((ce,ie)=>{const ee=Ze(ce.Date||ce.DATE||ce.date||""),Te=(ce.Particular||ce.PARTICULAR||ce.Particulars||ce.PARTICULARS||"").trim(),Je=(ce["Vch Type"]||ce["VCH TYPE"]||ce["Voucher Type"]||ce["vch type"]||"").trim(),lt=(ce["Vch No."]||ce["VCH NO."]||ce["Voucher No"]||ce["Invoice No"]||ce["Vch No"]||ce["vch no."]||"").trim(),ot=we(ce.Debit||ce.DEBIT||ce.debit),vt=we(ce.Credit||ce.CREDIT||ce.credit),ut=ce["Date of Receipt"]||ce["DATE OF RECEIPT"]||ce["Receipt Date"]||"",Ot=we(ce["Amount Received"]||ce["AMOUNT RECEIVED"]||ce["amount received"]),ze=we(ce["TDS amount Received"]||ce["TDS Received"]||ce.TDS||ce.tds),rt=we(ce.Balance||ce.BALANCE||ce.balance),Mt=(ce["Payment Status"]||ce["PAYMENT STATUS"]||ce.Status||ce.status||"").trim();if(!ee&&(Te.toUpperCase().includes("PROMOTIONAL")||Te.toUpperCase().includes("IGST")||Te.toUpperCase().includes("CGST")||Te.toUpperCase().includes("SGST")||Te.toUpperCase().includes("TRADE EMAILER"))&&fe)fe.subRows||(fe.subRows=[]),fe.subRows.push({particular:Te,debit:ot,credit:vt});else if(ee&&(lt||ot>0||vt>0)){fe&&(z.push(fe),se++);let Pe="invoice";Je.toLowerCase().includes("credit note")||lt.toUpperCase().startsWith("CN")?Pe="creditnote":Je.toLowerCase().includes("receipt")?Pe="receipt":(Je.toLowerCase().includes("sale")||ot>0)&&(Pe="invoice"),fe={id:Date.now()+ie,partyName:X,date:ee,particulars:Te||X,narration:lt,vchType:Je||"Sales",vchNo:lt,debit:ot,credit:vt,receiptDate:ut,amountReceived:Ot,tdsReceived:ze,balance:rt,paymentStatus:Mt,type:Pe,isHistorical:!0,subRows:[]}}}),fe&&(z.push(fe),se++),console.log("Parsed entries with sub-rows:",z),se>0?(Ie(ce=>[...ce,...z]),alert(` Historical Ledger Uploaded!

${se} entries added for "${X}".`)):alert(` No valid ledger entries found in the file.

Make sure your file has these columns:
 Date (e.g., 02-Jun-21)
 Vch Type (e.g., Sales, Credit Note)
 Vch No. (e.g., MB/2022-23/128)
 Debit or Credit amount`)},U.readAsBinaryString(_),h.target.value="",Sc(!1)},p4=()=>{const h=Er.json_to_sheet([{Date:"02-Jun-21",Particular:"ABC Corp Ltd.","Vch Type":"Sales","Vch No.":"MB/2020-21/0411",Debit:6e3,Credit:"","Date of Receipt":"","Amount Received":44371,"TDS amount Received":5880,Balance:"","Payment Status":"Received"},{Date:"",Particular:"PROMOTIONAL TRADE EMAILERS","Vch Type":"","Vch No.":"",Debit:"",Credit:22500,"Date of Receipt":"","Amount Received":"","TDS amount Received":"",Balance:"","Payment Status":""},{Date:"",Particular:"IGST","Vch Type":"","Vch No.":"",Debit:"",Credit:4050,"Date of Receipt":"","Amount Received":"","TDS amount Received":"",Balance:"","Payment Status":""},{Date:"26-Mar-25",Particular:"ABC Corp Ltd.","Vch Type":"Credit Note","Vch No.":"CN/2022-23/128",Debit:"",Credit:26550,"Date of Receipt":"","Amount Received":"","TDS amount Received":"",Balance:"","Payment Status":""}]),_=Er.book_new();Er.book_append_sheet(_,h,"Historical Ledger"),Pc(_,"Historical_Ledger_Template.xlsx")},g4=h=>{const _=Se.find(Q=>Q.invoiceNo===h);if(_){td(_);return}const U=be.find(Q=>Q.invoiceNo===h);if(U){nd(U);return}alert("Invoice not found in system. This may be a historical entry.")},m4=h=>{Se.find(U=>U.invoiceNo===h.invoiceNo);let _=` RECEIPT DETAILS

`;_+=`Receipt No: ${h.receiptNo}
`,_+=`Date: ${St(h.date)}
`,_+=`Party: ${h.partyName}
`,_+=`Invoice: ${h.invoiceNo}

`,_+=`
`,_+=`Amount Received: ${nt(h.amount||0)}
`,_+=`TDS: ${nt(h.tds||0)}
`,_+=`Discount: ${nt(h.discount||0)}
`,_+=`
`,_+=`Total: ${nt((h.amount||0)+(h.tds||0)+(h.discount||0))}
`,h.remarks&&(_+=`
Remarks: ${h.remarks}`),alert(_)},x4=h=>{let _=` CREDIT NOTE DETAILS

`;_+=`Credit Note No: ${h.creditNoteNo}
`,_+=`Date: ${St(h.date)}
`,_+=`Party: ${h.partyName}
`,_+=`Against Invoice: ${h.invoiceNo}

`,_+=`
`,_+=`Base Amount: ${nt(h.amount||0)}
`,_+=`${h.gstType||"GST"}: ${nt(h.gst||0)}
`,_+=`
`,_+=`Total Credit: ${nt(h.totalAmount||(h.amount||0)+(h.gst||0))}
`,h.reason&&(_+=`
Reason: ${h.reason}`),alert(_)},v4=h=>{var Q;const _=(Q=h.target.files)==null?void 0:Q[0];if(!_)return;const U=new FileReader;U.onload=B=>{const oe=Pl(B.target.result,{type:"binary",cellDates:!0}),L=oe.SheetNames[0],V=oe.Sheets[L],b=Er.sheet_to_json(V,{raw:!1}),z=new Set(wn.map(ce=>`${ce.date}|${ce.time||""}|${ce.campaignName||""}|${ce.subject}`.toLowerCase()));let se=0,fe=0;const we=b.map((ce,ie)=>{const ee=ce["CAMPAIGN NAME"]||ce["Campaign Name"]||"",Te=N$(ee);let Je=ce.DATE||ce.Date||new Date;typeof Je=="string"&&(Je=new Date(Je));const lt=(ce["PARTY NAME"]||ce["Party Name"]||"").trim(),ot=ce["SENDER NAME"]||ce["Sender Name"]||"",vt=ce.SUBJECT||ce.Subject||"",ut=ce.TIME||ce.Time||"",Ot=ce["State/Party Details"]||ce["STATE/PARTY DETAILS"]||ce.STATE||ce.State||"",ze=Ui[lt]||"",rt=Je instanceof Date&&!isNaN(Je)?Je.toISOString().split("T")[0]:"",me=(ce["Client Code"]||ce["CLIENT CODE"]||ce.Code||"").toString().trim()||Br(lt,Ot),Pe=ce["PO?"]||ce.PO||ce["WITH PO"]||"",ae=Pe.toLowerCase().includes("with po")||Pe.toLowerCase()==="yes",Qe=ce["PO Number"]||ce["PO NUMBER"]||ce["PO No"]||ce["PO NO"]||"";let ht=ce["PO Date"]||ce["PO DATE"]||"";typeof ht=="object"&&ht instanceof Date&&(ht=ht.toISOString().split("T")[0]);const Vt=`${rt}|${ut}|${ee}|${vt}`.toLowerCase();return z.has(Vt)?(se++,null):(z.add(Vt),fe++,{id:Date.now()+ie+Math.random(),sno:ce.SNO||ce["SNO."]||ce.Sno||ie+1,date:rt,month:ce.Month||ce.MONTH||"",time:ut,statePartyDetails:Ot,partyName:lt,clientCode:me,senderName:ot,campaignName:ee,subject:vt,emailId:Te,additionalEmails:[],toBeBilled:"Not Yet",invoiceAmount:ze,cgst:"",sgst:"",igst:"",totalWithGst:"",invoiceType:"Individual",combinationCode:"NA",invoiceNo:"",invoiceDate:"",invoiceTotalAmount:"",invoiceGenerated:!1,invoiceStatus:"Pending",mailingSent:"No",mailerUploaded:!1,editComments:"",poStatus:ae?"With PO":"Without PO",poNumber:ae?Qe:"",poDate:ae?ht:""})}).filter(ce=>ce!==null);if(we.length>0){Oe(ie=>[...ie,...we]);const ce=[...new Set(we.map(ie=>ie.partyName))];vs(ie=>{const ee=new Set(ie);return ce.forEach(Te=>ee.add(Te)),ee})}let Ze=` Upload Complete!

`;Ze+=` ${fe} new campaigns added
`,se>0&&(Ze+=` ${se} duplicate entries skipped`),fe>0&&Zi("upload",` ${fe} new campaigns uploaded to Master Sheet`,"director"),alert(Ze)},U.readAsBinaryString(_),h.target.value=""},y4=async()=>{Oe([]),ke([]),Ie([]),K([]),re([]),ha({}),_c({}),Z(1),wt(1),Et(1),xr(1),En(1),_e(null),Ve(null),Ne(null),vs(new Set),Ti([]),zs({}),at([]);try{await vd("indreesh-media",{masterData:[],servicesData:[],ledgerEntries:[],receipts:[],creditNotes:[],openingBalances:{},mailerImages:{},mailerLogo:zn,companyConfig:w,nextInvoiceNo:1,nextCombineNo:1,nextReceiptNo:1,nextCreditNoteNo:1,nextServiceInvoiceNo:1,invoiceValues:Ui,notifications:[],whatsappSettings:kt,partyMaster:{},followups:[],userPasswords:y}),console.log("Data cleared and saved to Firebase")}catch(h){console.error("Error clearing data:",h)}Us(!1),alert(" All master data, invoices, receipts, and ledger entries have been cleared!")},yy=h=>{var Q;const _=parseFloat(h.invoiceAmount)||0;if((Q=h.statePartyDetails)==null?void 0:Q.toUpperCase().includes("MAHARASHTRA")){const B=_*.09,oe=_*.09;return{cgst:B,sgst:oe,igst:0,total:_+B+oe}}else{const B=_*.18;return{cgst:0,sgst:0,igst:B,total:_+B}}},_4=(h,_)=>{const U=Se.find(Q=>Q.id===h);Oe(Q=>Q.map(B=>{if(B.id===h){if(_==="Yes"&&B.invoiceAmount){const oe=yy(B);return{...B,toBeBilled:_,cgst:oe.cgst.toFixed(2),sgst:oe.sgst.toFixed(2),igst:oe.igst.toFixed(2),totalWithGst:oe.total.toFixed(2)}}return{...B,toBeBilled:_}}return B})),_==="Yes"&&U&&Zi("info",` Campaign marked for billing: ${U.partyName} - ${U.senderName}`,"finance")},g0=(h,_,U)=>{Oe(Q=>Q.map(B=>{if(B.id===h){const oe={...B,[_]:U};if(_==="invoiceAmount"&&B.toBeBilled==="Yes"){const L=yy(oe);return{...oe,cgst:L.cgst.toFixed(2),sgst:L.sgst.toFixed(2),igst:L.igst.toFixed(2),totalWithGst:L.total.toFixed(2)}}return oe}return B}))},E4=h=>{const _=`${w.invoicePrefix}${it}`,U=new Date().toISOString().split("T")[0],Q=parseFloat(h.totalWithGst)||parseFloat(h.invoiceAmount)*1.18;Oe(B=>B.map(oe=>oe.id===h.id?{...oe,invoiceNo:_,invoiceDate:U,invoiceTotalAmount:Q.toFixed(2),invoiceGenerated:!0,invoiceStatus:"Created",invoiceType:"Individual",combinationCode:"NA"}:oe)),Z(B=>B+1),Zi("invoice",` New Invoice ${_} created for ${h.partyName} - ${nt(Q)}`,"director"),alert(` Invoice Generated!

Invoice No: ${_}
Amount: ${nt(Q)}

Please review and Approve or mark as Need Edits.`)},S4=()=>{if(Li.size<2){alert("Please select at least 2 campaigns to combine");return}const h=`${w.invoicePrefix}${it}`,_=new Date().toISOString().split("T")[0],U=String(Rt);let Q=0;const B=Se.filter(oe=>Li.has(oe.id));B.forEach(oe=>{Q+=parseFloat(oe.totalWithGst)||parseFloat(oe.invoiceAmount)*1.18}),Oe(oe=>oe.map(L=>Li.has(L.id)?{...L,invoiceNo:h,invoiceDate:_,invoiceTotalAmount:Q.toFixed(2),invoiceGenerated:!0,invoiceStatus:"Created",invoiceType:"Combined",combinationCode:U,mailingSent:"No"}:L)),Z(oe=>oe+1),wt(oe=>oe+1),xt(!1),So(new Set),Zi("invoice",` Combined Invoice ${h} created for ${ji} (${B.length} campaigns) - ${nt(Q)}`,"director"),Eo(null),alert(` Combined Invoice Generated!

Invoice No: ${h}
Campaigns: ${Li.size}
Total: ${nt(Q)}

Please review and Approve or mark as Need Edits.`)},w4=h=>{So(_=>{const U=new Set(_);return U.has(h)?U.delete(h):U.add(h),U})},T4=h=>{Eo(h.partyName),So(new Set([h.id])),xt(!0)},A4=h=>{var Q;const _=(Q=h.target.files)==null?void 0:Q[0];if(!_||!le)return;const U=new FileReader;U.onload=B=>_y(B.target.result),U.readAsDataURL(_),h.target.value=""},_y=h=>{if(!le)return;const _=le.id;ha(Yu?U=>({...U,[_]:[h]}):U=>({...U,[_]:[...U[_]||[],h]})),Oe(U=>U.map(Q=>Q.id===le.id?{...Q,mailerUploaded:!0}:Q)),Vs(null),To(!1),Oi(!1),alert(" Mailer image saved!")},C4=h=>{var U;const _=(U=h.clipboardData)==null?void 0:U.items;if(_){for(let Q=0;Q<_.length;Q++)if(_[Q].type.indexOf("image")!==-1){const B=_[Q].getAsFile(),oe=new FileReader;oe.onload=L=>Vs(L.target.result),oe.readAsDataURL(B),h.preventDefault();break}}},k4=h=>{const _=encodeURIComponent(h||"campaign");window.open(`https://mail.google.com/mail/u/0/#search/${_}`,"_blank")},F4=h=>{var Q;const _=(Q=h.target.files)==null?void 0:Q[0];if(!_)return;const U=new FileReader;U.onload=B=>pa(B.target.result),U.readAsDataURL(_),h.target.value=""},Ey=h=>{if(h.serviceType||h.isService)return`Invoice ${h.invoiceNo||""} - ${(h.serviceType||"SERVICE").toUpperCase()}`;const _=ue(h);if(_.length>1){const U=_.map(Q=>Q.senderName).join(", ");return`Invoice ${h.invoiceNo||""} - ${U}`}return`Invoice ${h.invoiceNo||""} - ${h.senderName} - ${h.subject}`},m0=h=>{const _=parseFloat(h.invoiceTotalAmount)||parseFloat(h.totalWithGst)||parseFloat(h.invoiceAmount)*1.18;let U="";if(h.serviceType||h.isService)U=`Type of Service: ${(h.serviceType||"SERVICE").toUpperCase()}`;else{const Q=ue(h);Q.length>1?(U=`Campaigns included in this invoice:
`,Q.forEach((B,oe)=>{U+=`${oe+1}. ${B.senderName} - ${B.subject}
`})):U=`Campaign: ${h.senderName}
Subject: ${h.subject}`}return`Dear Sir/Madam,

Please find attached the invoice for the following:

${U}

Invoice No: ${h.invoiceNo||"To be generated"}
Invoice Amount: ${nt(_)}

Kindly process the payment at your earliest convenience.

Bank Details:
Bank: ${w.bank.name}
A/C No: ${w.bank.account}
IFSC: ${w.bank.ifsc}
Branch: ${w.bank.branch}

Thank you for your business.

Best Regards,
${w.name}
${w.email}`},[b4,Sy]=ye.useState(!1),[wy,Ty]=ye.useState(""),Ay=h=>{var ce;let _=[h],U=parseFloat(h.invoiceAmount)||0;h.invoiceType==="Combined"&&h.combinationCode!=="NA"&&(_=Se.filter(ie=>ie.combinationCode===h.combinationCode),U=_.reduce((ie,ee)=>ie+(parseFloat(ee.invoiceAmount)||0),0));const Q=ko(h.partyName,h.statePartyDetails),B=Ac(h.partyName,h.statePartyDetails),oe=(ce=h.statePartyDetails)==null?void 0:ce.toUpperCase().includes("MAHARASHTRA"),L=oe?U*.09:0,V=oe?U*.09:0,b=oe?0:U*.18,z=L+V+b,se=U+z,fe=_.map((ie,ee)=>`
      <tr>
        <td style="border: 1px solid #000; padding: 8px; text-align: center; font-size: 12px;">${ee+1}</td>
        <td style="border: 1px solid #000; padding: 8px; font-size: 12px;">
          <div style="font-weight: 600;">PROMOTIONAL TRADE EMAILER</div>
          <div style="font-style: italic; color: #555; font-size: 11px; margin-top: 2px;">${ie.senderName||""} - ${St(ie.date)}</div>
          <div style="font-style: italic; color: #555; font-size: 11px;">Subject: ${ie.subject||""}</div>
        </td>
        <td style="border: 1px solid #000; padding: 8px; text-align: center; font-size: 12px;">${w.hsnCode}</td>
        <td style="border: 1px solid #000; padding: 8px; text-align: right; font-size: 12px;">${zt(parseFloat(ie.invoiceAmount)||0)}</td>
      </tr>
    `).join("");let we=[];h.invoiceType==="Combined"&&h.combinationCode!=="NA"?_.forEach(ie=>{(Ft[ie.id]||[]).forEach(Te=>we.push({img:Te,campaign:ie}))}):(Ft[h.id]||[]).forEach(ee=>we.push({img:ee,campaign:h}));const Ze=we.map(({img:ie,campaign:ee})=>`
      <div class="page-break-before" style="page-break-before: always; padding: 40px; text-align: center; background: white;">
        ${zn?`<div style="margin-bottom: 20px;"><img src="${zn}" alt="Logo" style="max-height: 70px;" /></div>`:`
          <div style="text-align: center; margin-bottom: 25px;">
            <span style="font-size: 22px; font-weight: bold; color: #2874A6;">${w.name}</span>
          </div>
        `}
        <h2 style="font-size: 20px; text-decoration: underline; margin: 25px 0;">MAILER SUPPORTING</h2>
        <p style="font-size: 15px; margin: 12px 0; text-align: left;"><strong>MAILER DATE:</strong> ${I$(ee.date)}</p>
        <p style="font-size: 15px; margin: 12px 0; text-align: left;"><strong>CAMPAIGN:</strong> ${ee.senderName}</p>
        <p style="font-size: 15px; margin: 12px 0; text-align: left;"><strong>SUBJECT:</strong> ${ee.subject||"Campaign"}</p>
        <div style="margin-top: 25px;"><img src="${ie}" alt="Mailer" style="max-width: 100%; max-height: 550px; border: 1px solid #ddd;" /></div>
      </div>
    `).join("");return`
  <div style="max-width: 900px; margin: 0 auto; padding: 15px; background: white; font-family: Arial, sans-serif; font-size: 12px; line-height: 1.4;">
    <style>
      @media print {
        @page { size: A4; margin: 8mm; }
        body { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
        .page-break-before { page-break-before: always; }
      }
    </style>
    <div style="border: 2px solid #000; background: white;">
      <div style="text-align: center; padding: 12px; font-size: 18px; font-weight: bold; border-bottom: 2px solid #000; background: #f8f8f8;">Tax Invoice</div>
      <div style="text-align: center; font-size: 11px; font-style: italic; padding: 5px; border-bottom: 1px solid #000; background: #fafafa;">(Original for Recipient)</div>
      <div style="display: flex; border-bottom: 2px solid #000;">
        <div style="flex: 1.5; padding: 12px; border-right: 2px solid #000;">
          <div style="font-size: 16px; font-weight: bold; margin-bottom: 8px; color: #1a5276;">${w.name}</div>
          <div style="font-size: 11px; line-height: 1.5; color: #333;">${w.address}<br>${w.addressLine2}<br>${w.city}<br><strong>GSTIN/UIN:</strong> ${w.gstin}<br><strong>State:</strong> ${w.stateName}, Code: ${w.stateCode}<br><strong>Contact:</strong> ${w.phone}<br><strong>E-Mail:</strong> ${w.email}</div>
        </div>
        <div style="flex: 1; font-size: 12px;">
          <div style="display: flex; border-bottom: 1px solid #000;"><div style="flex: 1; padding: 8px; border-right: 1px solid #000; font-weight: bold; background: #f5f5f5;">Invoice No.</div><div style="flex: 1; padding: 8px; font-weight: 600; color: #1a5276;">${h.invoiceNo||""}</div></div>
          <div style="display: flex;"><div style="flex: 1; padding: 8px; border-right: 1px solid #000; font-weight: bold; background: #f5f5f5;">Dated</div><div style="flex: 1; padding: 8px;">${St(h.invoiceDate||h.date)}</div></div>
        </div>
      </div>
      <div style="padding: 10px 12px; border-bottom: 2px solid #000; background: #fafafa;">
        <div style="font-size: 11px; color: #666; margin-bottom: 3px;">Buyer (Bill to)</div>
        <div style="font-size: 14px; font-weight: bold; margin-bottom: 4px; color: #1a5276;">${h.partyName}</div>
        <div style="font-size: 11px; color: #333;">${B?B+"<br>":""}${h.statePartyDetails||""}${Q?"<br><strong>GSTIN/UIN:</strong> "+Q:""}<br>Place of Supply: ${h.statePartyDetails||w.stateName}</div>
      </div>
      <table style="width: 100%; border-collapse: collapse;">
        <thead><tr style="background: #e8e8e8;"><th style="border: 1px solid #000; padding: 10px; width: 45px; font-size: 12px;">Sl No.</th><th style="border: 1px solid #000; padding: 10px; font-size: 12px;">Particulars</th><th style="border: 1px solid #000; padding: 10px; width: 80px; font-size: 12px;">HSN/SAC</th><th style="border: 1px solid #000; padding: 10px; width: 100px; text-align: right; font-size: 12px;">Amount</th></tr></thead>
        <tbody>
          ${fe}
          ${_.length>1?'<tr style="background: #f5f5f5;"><td colspan="3" style="border: 1px solid #000; padding: 10px; text-align: right; font-weight: bold; font-size: 13px;">Sub Total</td><td style="border: 1px solid #000; padding: 10px; text-align: right; font-weight: bold; font-size: 13px;">'+zt(U)+"</td></tr>":""}
          ${oe?`<tr><td colspan="3" style="border: 1px solid #000; padding: 8px; text-align: right; font-weight: 600; font-size: 12px;">CGST @ 9%</td><td style="border: 1px solid #000; padding: 8px; text-align: right; font-size: 12px;">${zt(L)}</td></tr><tr><td colspan="3" style="border: 1px solid #000; padding: 8px; text-align: right; font-weight: 600; font-size: 12px;">SGST @ 9%</td><td style="border: 1px solid #000; padding: 8px; text-align: right; font-size: 12px;">${zt(V)}</td></tr>`:`<tr><td colspan="3" style="border: 1px solid #000; padding: 8px; text-align: right; font-weight: 600; font-size: 12px;">IGST @ 18%</td><td style="border: 1px solid #000; padding: 8px; text-align: right; font-size: 12px;">${zt(b)}</td></tr>`}
          <tr style="background: #2874A6; color: white;"><td colspan="3" style="border: 1px solid #000; padding: 12px; text-align: right; font-weight: bold; font-size: 14px;">Total</td><td style="border: 1px solid #000; padding: 12px; text-align: right; font-weight: bold; font-size: 14px;"> ${se.toLocaleString("en-IN",{minimumFractionDigits:2})}</td></tr>
        </tbody>
      </table>
      <div style="padding: 10px 12px; border: 1px solid #000; border-top: none; background: #fafafa;"><div style="color: #666; font-size: 11px; margin-bottom: 3px;">Amount Chargeable (in words)</div><div style="font-weight: bold; font-size: 13px;">${nh(se)}</div></div>
      <div style="display: flex; border-top: 2px solid #000;">
        <div style="flex: 1; padding: 10px 12px; border-right: 2px solid #000; font-size: 11px;"><div><strong>Company's PAN:</strong> ${w.pan}</div><div style="margin-top: 4px;"><strong>MSME Reg. No.:</strong> UDYAM-MH-19-0057219</div></div>
        <div style="flex: 1.2; padding: 10px 12px; font-size: 11px;">
          <div style="font-weight: bold; margin-bottom: 6px; color: #1a5276;">Company's Bank Details</div>
          <div style="line-height: 1.5;"><strong>A/c Holder:</strong> ${w.bank.holder}<br><strong>Bank:</strong> ${w.bank.name}<br><strong>A/c No.:</strong> ${w.bank.account}<br><strong>IFSC:</strong> ${w.bank.ifsc}</div>
          <div style="text-align: right; margin-top: 30px;"><div style="font-weight: bold;">for ${w.name}</div><div style="margin-top: 25px; border-top: 1px solid #000; display: inline-block; padding-top: 4px; font-size: 10px;">Authorised Signatory</div></div>
        </div>
      </div>
      <div style="text-align: center; padding: 8px; background: #f0f0f0; border-top: 1px solid #000; font-size: 10px; color: #666; font-style: italic;">This is a Computer Generated Invoice</div>
    </div>
  </div>
  ${Ze}
`},I4=h=>{const _=Ay(h);Ty(_),or(h),Sy(!0)},N4=h=>{const _=`<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Invoice ${h.invoiceNo||""}</title>
  <style>
    @page { size: A4; margin: 10mm; }
    @media print { body { -webkit-print-color-adjust: exact; print-color-adjust: exact; } }
    body { font-family: Arial, sans-serif; margin: 0; padding: 20px; }
  </style>
</head>
<body>
${Ay(h)}
<script>
  // Auto-open print dialog when file is opened
  window.onload = function() { 
    setTimeout(function() { window.print(); }, 500); 
  };
<\/script>
</body>
</html>`,U=new Blob([_],{type:"text/html"}),Q=URL.createObjectURL(U),B=document.createElement("a");B.href=Q,B.download=`Invoice_${(h.invoiceNo||"draft").replace(/\//g,"-")}.html`,document.body.appendChild(B),B.click(),document.body.removeChild(B),URL.revokeObjectURL(Q)},td=h=>{I4(h)},R4=()=>{const h=parseFloat(yr.amount)||0,_=parseFloat(yr.tds)||0,U=parseFloat(yr.discount)||0,Q=h+_+U;let B=parseFloat(le.invoiceTotalAmount)||parseFloat(le.totalWithGst)||parseFloat(le.invoiceAmount)*1.18;const oe=Q>=B?"Paid":"Partially Paid";le.invoiceType==="Combined"&&le.combinationCode!=="NA"?Oe(V=>V.map(b=>b.combinationCode===le.combinationCode?{...b,invoiceStatus:oe}:b)):Oe(V=>V.map(b=>b.id===le.id?{...b,invoiceStatus:oe}:b));const L=[];h>0&&L.push({id:Date.now(),partyName:le.partyName,date:yr.date,particulars:yr.narration?`Payment Received - ${yr.mode} (${yr.narration})`:`Payment Received - ${yr.mode}`,debit:0,credit:h,type:"payment"}),_>0&&L.push({id:Date.now()+1,partyName:le.partyName,date:yr.date,particulars:`TDS Deducted - Inv: ${le.invoiceNo}`,debit:0,credit:_,type:"tds"}),U>0&&L.push({id:Date.now()+2,partyName:le.partyName,date:yr.date,particulars:`Discount Allowed - Inv: ${le.invoiceNo}`,debit:0,credit:U,type:"discount"}),Ie(V=>[...V,...L]),cr(!1),or(null)},Cy=h=>{vs(_=>{const U=new Set(_);return U.has(h)?U.delete(h):U.add(h),U})},D4=()=>{const U=r==="director"?[{id:"master",icon:sE,label:"Master Sheet"},{id:"services",icon:sm,label:"Services Sheet"},{id:"invoices",icon:pd,label:"Invoice Register"},{id:"receipts",icon:Oo,label:"Receipt Register"},{id:"ledgers",icon:Z_,label:"Party Ledgers"},{id:"followups",icon:q0,label:"Followups"},{id:"reports",icon:Q_,label:"Reports"}]:[{id:"master",icon:sE,label:"Master Sheet"},{id:"services",icon:sm,label:"Services Sheet"},{id:"invoices",icon:pd,label:"Invoice Register"},{id:"receipts",icon:Oo,label:"Receipt Register"},{id:"ledgers",icon:Z_,label:"Party Ledgers"},{id:"followups",icon:q0,label:"Followups"},{id:"reports",icon:Q_,label:"Reports"},{id:"settings",icon:WL,label:"Settings"}];return c.jsxs("div",{style:{width:R?"60px":"220px",backgroundColor:"#1E293B",color:"#FFFFFF",display:"flex",flexDirection:"column",transition:"width 0.2s ease",flexShrink:0},children:[c.jsxs("div",{style:{padding:R?"12px":"16px",borderBottom:"1px solid #334155",display:"flex",alignItems:"center",justifyContent:R?"center":"space-between"},children:[!R&&c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[c.jsx("img",{src:"/logo.png",alt:"JAC",style:{width:"32px",height:"auto",borderRadius:"4px",backgroundColor:"white",padding:"2px"}}),c.jsxs("div",{children:[c.jsx("div",{style:{fontSize:"16px",fontWeight:"700"},children:"FinMate"}),c.jsx("div",{style:{fontSize:"10px",color:"#94A3B8"},children:r==="director"?"Director View":"Finance Team"})]})]}),c.jsx("button",{onClick:()=>qe(!R),style:{background:"none",border:"none",color:"#94A3B8",cursor:"pointer",padding:"4px"},children:R?c.jsx(K0,{size:18}):c.jsx(ML,{size:18})})]}),!R&&c.jsx("div",{style:{padding:"8px 16px",borderBottom:"1px solid #334155",fontSize:"11px"},children:f?c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",color:"#FCD34D"},children:[c.jsx(rE,{size:12,style:{animation:"spin 1s linear infinite"}}),c.jsx("span",{children:"Saving..."})]}):g?c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",color:"#86EFAC"},children:[c.jsx(tE,{size:12}),c.jsxs("span",{children:["Saved ",g.toLocaleTimeString()]})]}):c.jsx("div",{style:{color:"#94A3B8"},children:"Cloud Sync Active"})}),c.jsx("div",{style:{padding:"8px",borderBottom:"1px solid #334155"},children:c.jsxs("button",{onClick:()=>ir(!0),style:{width:"100%",display:"flex",alignItems:"center",gap:"10px",padding:R?"12px":"11px 14px",borderRadius:"8px",border:"none",backgroundColor:_s>0?"#FEF3C7":"#334155",color:_s>0?"#92400E":"#94A3B8",cursor:"pointer",fontSize:"14px",fontWeight:_s>0?"700":"500",justifyContent:R?"center":"flex-start",position:"relative"},title:"Notifications",children:[_s>0?c.jsx(PL,{size:18}):c.jsx(J_,{size:18}),!R&&c.jsx("span",{children:"Notifications"}),_s>0&&c.jsx("span",{style:{position:R?"absolute":"static",top:R?"4px":"auto",right:R?"4px":"auto",marginLeft:R?"0":"auto",backgroundColor:"#DC2626",color:"#FFFFFF",padding:"2px 6px",borderRadius:"10px",fontSize:"11px",fontWeight:"700",minWidth:"18px",textAlign:"center"},children:_s})]})}),c.jsx("nav",{style:{flex:1,padding:"8px"},children:U.map(Q=>c.jsxs("button",{onClick:()=>P(Q.id),style:{width:"100%",display:"flex",alignItems:"center",gap:"10px",padding:R?"12px":"11px 14px",marginBottom:"4px",borderRadius:"8px",border:"none",backgroundColor:D===Q.id?"#2874A6":"transparent",color:D===Q.id?"#FFFFFF":"#94A3B8",cursor:"pointer",fontSize:"14px",fontWeight:D===Q.id?"600":"500",justifyContent:R?"center":"flex-start"},title:Q.label,children:[c.jsx(Q.icon,{size:18}),!R&&c.jsx("span",{children:Q.label})]},Q.id))}),c.jsxs("div",{style:{padding:"8px",borderTop:"1px solid #334155"},children:[c.jsxs("button",{onClick:()=>{E(!0),q({currentPassword:"",newPassword:"",confirmPassword:""}),T("")},style:{width:"100%",display:"flex",alignItems:"center",gap:"10px",padding:R?"12px":"11px 14px",marginBottom:"8px",borderRadius:"8px",border:"none",backgroundColor:"#475569",color:"#FFFFFF",cursor:"pointer",fontSize:"14px",fontWeight:"500",justifyContent:R?"center":"flex-start"},title:"Change Password",children:[c.jsx(Y0,{size:18}),!R&&c.jsx("span",{children:"Change Password"})]}),c.jsxs("button",{onClick:Ci,style:{width:"100%",display:"flex",alignItems:"center",gap:"10px",padding:R?"12px":"11px 14px",borderRadius:"8px",border:"none",backgroundColor:"#DC2626",color:"#FFFFFF",cursor:"pointer",fontSize:"14px",fontWeight:"600",justifyContent:R?"center":"flex-start"},title:"Logout",children:[c.jsx(wa,{size:18}),!R&&c.jsx("span",{children:"Logout"})]}),!R&&c.jsx("div",{style:{textAlign:"center",fontSize:"10px",color:"#64748B",marginTop:"8px"},children:"v38-fix17"})]})]})},P4=()=>c.jsx("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"10px",border:"1px solid #E2E8F0",padding:"14px 18px",marginBottom:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"14px",flexWrap:"wrap"},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[c.jsx(gd,{size:18,color:"#64748B"}),c.jsx("span",{style:{fontSize:"13px",fontWeight:"700",color:"#475569"},children:"Filters:"})]}),c.jsxs("div",{style:{position:"relative"},children:[c.jsx(Q0,{size:15,style:{position:"absolute",left:"10px",top:"50%",transform:"translateY(-50%)",color:"#94A3B8"}}),c.jsx("input",{type:"text",placeholder:"Search...",value:Tt.searchText,onChange:h=>Cl(_=>({..._,searchText:h.target.value})),style:{padding:"8px 12px 8px 32px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",width:"160px"}})]}),c.jsxs("select",{value:Tt.party,onChange:h=>Cl(_=>({..._,party:h.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:Tt.party?"#EFF6FF":"#FFFFFF"},children:[c.jsx("option",{value:"",children:"All Parties"}),$s.map(h=>c.jsx("option",{value:h,children:h},h))]}),c.jsxs("select",{value:Tt.billStatus,onChange:h=>Cl(_=>({..._,billStatus:h.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:Tt.billStatus?"#EFF6FF":"#FFFFFF"},children:[c.jsx("option",{value:"",children:"Bill Status"}),c.jsx("option",{value:"Yes",children:"Yes"}),c.jsx("option",{value:"Not Yet",children:"Not Yet"})]}),c.jsxs("select",{value:Tt.invoiceStatus,onChange:h=>Cl(_=>({..._,invoiceStatus:h.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:Tt.invoiceStatus?"#EFF6FF":"#FFFFFF"},children:[c.jsx("option",{value:"",children:"Invoice Status"}),c.jsx("option",{value:"Generated",children:"Generated"}),c.jsx("option",{value:"Not Generated",children:"Not Generated"}),c.jsx("option",{value:"Paid",children:"Paid"})]}),He&&c.jsxs(c.Fragment,{children:[c.jsxs("button",{onClick:xe,style:{padding:"8px 12px",fontSize:"13px",fontWeight:"600",border:"1.5px solid #FCA5A5",borderRadius:"8px",backgroundColor:"#FEE2E2",color:"#991B1B",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},children:[c.jsx(wa,{size:14})," Clear"]}),c.jsxs("span",{style:{fontSize:"13px",color:"#64748B"},children:["Showing ",v.length," of ",Se.length]})]})]})}),ky=()=>{const h=Se.filter(L=>L.toBeBilled==="Yes"&&L.invoiceGenerated&&L.mailingSent==="Yes"&&(L.receiptStatus==="Received"||L.receiptStatus==="Cancelled"||L.receiptStatus==="Closed")),_=Se.filter(L=>!(L.toBeBilled==="Yes"&&L.invoiceGenerated&&L.mailingSent==="Yes"&&(L.receiptStatus==="Received"||L.receiptStatus==="Cancelled"||L.receiptStatus==="Closed"))),U=wi==="open"?_:h,Q=U.filter(L=>{var V,b,z,se,fe;if(Tt.party&&L.partyName!==Tt.party||Tt.billStatus&&L.toBeBilled!==Tt.billStatus||Tt.invoiceType&&L.invoiceType!==Tt.invoiceType||Tt.mailingStatus&&(Tt.mailingStatus==="Sent"&&L.mailingSent!=="Yes"||Tt.mailingStatus==="Not Sent"&&L.mailingSent==="Yes")||Tt.invoiceStatus&&(Tt.invoiceStatus==="Generated"&&!L.invoiceGenerated||Tt.invoiceStatus==="Not Generated"&&L.invoiceGenerated||Tt.invoiceStatus==="Approved"&&L.invoiceStatus!=="Approved"||Tt.invoiceStatus==="Need Edits"&&L.invoiceStatus!=="Need Edits"||Tt.invoiceStatus==="Paid"&&L.invoiceStatus!=="Paid"))return!1;if(Tt.searchText){const we=Tt.searchText.toLowerCase();if(!((V=L.partyName)!=null&&V.toLowerCase().includes(we))&&!((b=L.senderName)!=null&&b.toLowerCase().includes(we))&&!((z=L.campaignName)!=null&&z.toLowerCase().includes(we))&&!((se=L.subject)!=null&&se.toLowerCase().includes(we))&&!((fe=L.invoiceNo)!=null&&fe.toLowerCase().includes(we)))return!1}return!0}),B=Q.reduce((L,V)=>{const b=V.clientCode||Br(V.partyName,V.statePartyDetails)||"",z=`${V.partyName||"Unknown"}|||${b}`;return L[z]||(L[z]={partyName:V.partyName||"Unknown",clientCode:b,rows:[]}),L[z].rows.push(V),L},{}),oe=Object.values(B).sort((L,V)=>{const b=L.partyName.localeCompare(V.partyName);return b!==0?b:(L.clientCode||"").localeCompare(V.clientCode||"")});return c.jsxs("div",{children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[c.jsxs("div",{children:[c.jsx("h1",{style:{margin:0,fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:" Master Sheet"}),c.jsxs("p",{style:{margin:"4px 0 0",fontSize:"14px",color:"#64748B"},children:[Se.length," campaigns  ",$s.length," parties  ",Se.filter(L=>L.invoiceGenerated).length," invoiced"]})]}),c.jsxs("div",{style:{display:"flex",gap:"10px"},children:[c.jsx("input",{type:"file",ref:Xu,accept:".xlsx,.xls,.csv",style:{display:"none"},onChange:v4}),c.jsx(Xe,{icon:Ys,label:"Upload Data",variant:"brand",onClick:()=>{var L;return(L=Xu.current)==null?void 0:L.click()}}),_r&&Se.length>0&&c.jsx(Xe,{icon:rs,label:"Clear All Data",variant:"danger",onClick:()=>Us(!0)})]})]}),c.jsxs("div",{style:{display:"flex",gap:"4px",marginBottom:"16px",backgroundColor:"#F1F5F9",padding:"4px",borderRadius:"10px",width:"fit-content"},children:[c.jsxs("button",{onClick:()=>I("open"),style:{padding:"10px 20px",fontSize:"14px",fontWeight:"600",border:"none",borderRadius:"8px",cursor:"pointer",backgroundColor:wi==="open"?"#FFFFFF":"transparent",color:wi==="open"?"#1E293B":"#64748B",boxShadow:wi==="open"?"0 2px 4px rgba(0,0,0,0.1)":"none"},children:[" Open Invoices (",_.length,")"]}),c.jsxs("button",{onClick:()=>I("closed"),style:{padding:"10px 20px",fontSize:"14px",fontWeight:"600",border:"none",borderRadius:"8px",cursor:"pointer",backgroundColor:wi==="closed"?"#FFFFFF":"transparent",color:wi==="closed"?"#1E293B":"#64748B",boxShadow:wi==="closed"?"0 2px 4px rgba(0,0,0,0.1)":"none"},children:[" Closed Invoices (",h.length,")"]})]}),Se.length>0&&P4(),oe.length===0?c.jsx(mn,{children:c.jsxs("div",{style:{padding:"60px",textAlign:"center",color:"#94A3B8"},children:[c.jsx(Ys,{size:48,style:{marginBottom:"16px",opacity:.5}}),c.jsx("div",{style:{fontSize:"18px",fontWeight:"600"},children:He?"No matching records":wi==="closed"?"No closed invoices yet":"No Data Yet"}),c.jsx("div",{style:{fontSize:"14px",marginTop:"4px"},children:He?"Try adjusting your filters":wi==="closed"?"Invoices will appear here once billed, mailed, and payment received":"Upload an Excel file to get started"})]})}):c.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:oe.map((L,V)=>{const{partyName:b,clientCode:z,rows:se}=L,fe=`${b}|||${z}`,we=u0.has(fe),Ze=se.filter(ee=>ee.toBeBilled==="Yes").length,ce=se.filter(ee=>ee.invoiceGenerated).length,ie=se.filter(ee=>ee.toBeBilled==="Yes").reduce((ee,Te)=>ee+(parseFloat(Te.totalWithGst)||0),0);return c.jsxs("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"12px",border:"1px solid #E2E8F0",overflow:"hidden",boxShadow:"0 2px 8px rgba(0,0,0,0.04)"},children:[c.jsxs("div",{onClick:()=>Cy(fe),style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"16px 20px",backgroundColor:wi==="closed"?"#F0FDF4":"#F8FAFC",cursor:"pointer",borderBottom:we?"3px solid #2874A6":"none"},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[we?c.jsx(nm,{size:22,color:"#2874A6"}):c.jsx(K0,{size:22,color:"#64748B"}),c.jsxs("div",{children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[c.jsx("span",{style:{fontWeight:"700",fontSize:"16px",color:"#1E293B"},children:b}),z&&c.jsx("span",{style:{padding:"2px 8px",backgroundColor:"#F3E8FF",color:"#6B21A8",borderRadius:"6px",fontSize:"12px",fontWeight:"700"},children:z})]}),c.jsxs("div",{style:{fontSize:"13px",color:"#64748B",marginTop:"3px"},children:[se.length," campaigns  ",Ze," billed  ",ce," invoiced"]})]})]}),ie>0&&c.jsxs("div",{style:{textAlign:"right"},children:[c.jsx("div",{style:{fontSize:"11px",color:"#64748B",textTransform:"uppercase"},children:"Total"}),c.jsx("div",{style:{fontSize:"18px",fontWeight:"700",color:"#059669"},children:nt(ie)})]})]}),we&&c.jsx("div",{style:{overflowX:"auto"},children:c.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"13px",minWidth:"2200px"},children:[c.jsx("thead",{children:c.jsxs("tr",{style:{backgroundColor:"#F1F5F9"},children:[c.jsx("th",{style:{padding:"12px 14px",textAlign:"left",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"90px"},children:"Date"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#6B21A8",borderBottom:"2px solid #E2E8F0",backgroundColor:"#FAF5FF",width:"60px"},children:"Code"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"left",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"100px"},children:"Sender"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"left",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",minWidth:"180px"},children:"Campaign / Subject"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"left",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"160px"},children:"Email ID"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"70px"},children:"Mailer"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"70px"},children:"PO?"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"80px"},children:"Bill?"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"right",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"90px"},children:"Amount"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"90px"},children:"Type"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"90px"},children:"Generate"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"left",fontWeight:"700",color:"#1E40AF",borderBottom:"2px solid #E2E8F0",backgroundColor:"#EFF6FF",width:"110px"},children:"Invoice No."}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"left",fontWeight:"700",color:"#1E40AF",borderBottom:"2px solid #E2E8F0",backgroundColor:"#EFF6FF",width:"90px"},children:"Inv Date"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"right",fontWeight:"700",color:"#1E40AF",borderBottom:"2px solid #E2E8F0",backgroundColor:"#EFF6FF",width:"100px"},children:"Inv Amount"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#7C3AED",borderBottom:"2px solid #E2E8F0",backgroundColor:"#FAF5FF",width:"50px"},children:"C#"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"120px"},children:"Status/Approve"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"120px"},children:"Actions"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#059669",borderBottom:"2px solid #E2E8F0",backgroundColor:"#F0FDF4",width:"80px"},children:"Mailed?"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#059669",borderBottom:"2px solid #E2E8F0",backgroundColor:"#F0FDF4",width:"90px"},children:"Mail Date"}),c.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#7C3AED",borderBottom:"2px solid #E2E8F0",backgroundColor:"#FAF5FF",width:"100px"},children:"Receipt"})]})}),c.jsx("tbody",{children:se.map(ee=>{var ot,vt;const Te=ee.invoiceType==="Combined"&&M(ee.combinationCode)&&ee.mailingSent!=="Yes";Jt(ee);const Je=Ft[ee.id]&&Ft[ee.id].length>0,lt=ee.clientCode||Br(ee.partyName,ee.statePartyDetails);return c.jsxs("tr",{style:{backgroundColor:ee.toBeBilled==="Yes"?ee.invoiceGenerated?"#F0FDF4":"#FFFBEB":"#FFFFFF",borderBottom:"1px solid #F1F5F9"},children:[c.jsx("td",{style:{padding:"12px 14px",whiteSpace:"nowrap",fontSize:"13px"},children:St(ee.date)}),c.jsx("td",{style:{padding:"12px 14px",textAlign:"center",backgroundColor:"#FAF5FF"},children:c.jsx("span",{style:{fontWeight:"700",color:"#6B21A8",fontSize:"12px"},children:lt||"-"})}),c.jsx("td",{style:{padding:"12px 14px",fontWeight:"600",fontSize:"13px"},children:ee.senderName}),c.jsxs("td",{style:{padding:"12px 14px"},children:[c.jsx("div",{style:{fontWeight:"600",fontSize:"13px",lineHeight:"1.4",color:"#1E293B"},children:((vt=(ot=ee.campaignName)==null?void 0:ot.split("--")[0])==null?void 0:vt.trim())||ee.senderName}),ee.subject&&c.jsx("div",{style:{fontSize:"12px",color:"#64748B",marginTop:"4px",lineHeight:"1.3"},children:ee.subject})]}),c.jsx("td",{style:{padding:"10px 14px"},children:c.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[ee.emailId&&c.jsx("div",{style:{fontSize:"11px",color:"#1E40AF",backgroundColor:"#EFF6FF",padding:"2px 6px",borderRadius:"4px",display:"inline-block"},children:ee.emailId}),(ee.additionalEmails||[]).map((ut,Ot)=>c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[c.jsx("span",{style:{fontSize:"11px",color:"#059669",backgroundColor:"#F0FDF4",padding:"2px 6px",borderRadius:"4px"},children:ut}),c.jsx("button",{onClick:()=>Yt(ee.id,ut),style:{background:"none",border:"none",cursor:"pointer",padding:"2px",color:"#DC2626"},title:"Remove",children:c.jsx(wa,{size:12})})]},Ot)),c.jsxs("button",{onClick:()=>{or(ee),gs(""),Pr(!0)},style:{display:"flex",alignItems:"center",gap:"4px",fontSize:"11px",color:"#2874A6",background:"none",border:"none",cursor:"pointer",padding:"2px 0"},children:[c.jsx(am,{size:12})," Add"]})]})}),c.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:Je?c.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"2px"},children:[c.jsx("span",{style:{color:"#22C55E",fontWeight:"700",fontSize:"14px"},children:""}),c.jsx("button",{onClick:()=>{or(ee),Vs(null),To(!0),Oi(!0)},style:{fontSize:"10px",color:"#64748B",background:"none",border:"none",cursor:"pointer",textDecoration:"underline"},children:"Replace"})]}):c.jsx(Xe,{icon:eE,small:!0,variant:"default",onClick:()=>{or(ee),Vs(null),To(!1),Oi(!0)}})}),c.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:ee.poStatus==="With PO"?c.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"2px"},children:[c.jsx("span",{style:{color:"#22C55E",fontWeight:"600",fontSize:"10px"},children:" PO"}),c.jsx("span",{style:{fontSize:"9px",color:"#1E40AF",fontWeight:"600"},children:ee.poNumber}),ee.poDate&&c.jsx("span",{style:{fontSize:"9px",color:"#64748B"},children:St(ee.poDate)})]}):c.jsx("span",{style:{color:"#CBD5E1",fontSize:"10px"},children:"No PO"})}),c.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:c.jsxs("select",{value:ee.toBeBilled,onChange:ut=>_4(ee.id,ut.target.value),disabled:ee.invoiceGenerated||!si,style:{padding:"6px 8px",fontSize:"12px",fontWeight:"600",border:"2px solid",borderRadius:"6px",borderColor:ee.toBeBilled==="Yes"?"#22C55E":"#E2E8F0",backgroundColor:ee.toBeBilled==="Yes"?"#DCFCE7":"#FFFFFF",color:ee.toBeBilled==="Yes"?"#166534":"#64748B",cursor:ee.invoiceGenerated||!si?"not-allowed":"pointer",width:"70px",opacity:!si&&!ee.invoiceGenerated?.6:1},children:[c.jsx("option",{value:"Not Yet",children:"Not Yet"}),c.jsx("option",{value:"Yes",children:"Yes"})]})}),c.jsx("td",{style:{padding:"10px 14px"},children:c.jsx("input",{type:"number",value:ee.invoiceAmount||"",onChange:ut=>g0(ee.id,"invoiceAmount",ut.target.value),disabled:ee.invoiceGenerated,placeholder:"0",style:{width:"80px",padding:"6px 8px",fontSize:"13px",fontWeight:"600",border:"1.5px solid #D1D5DB",borderRadius:"6px",textAlign:"right",backgroundColor:ee.invoiceGenerated?"#F3F4F6":"#FFFFFF"}})}),c.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:ee.invoiceGenerated?c.jsx(vm,{status:ee.invoiceType,small:!0}):ee.toBeBilled==="Yes"?c.jsxs("select",{value:ee.invoiceType||"Individual",onChange:ut=>g0(ee.id,"invoiceType",ut.target.value),style:{padding:"6px 6px",fontSize:"11px",fontWeight:"600",border:"2px solid",borderRadius:"6px",borderColor:ee.invoiceType==="Combined"?"#7C3AED":"#A5B4FC",backgroundColor:ee.invoiceType==="Combined"?"#F3E8FF":"#E0E7FF",color:ee.invoiceType==="Combined"?"#6B21A8":"#3730A3",cursor:"pointer",width:"80px"},children:[c.jsx("option",{value:"Individual",children:"Individual"}),c.jsx("option",{value:"Combined",children:"Combined"})]}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),c.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:ee.toBeBilled==="Yes"&&!ee.invoiceGenerated&&ee.invoiceAmount&&_r?ee.invoiceType==="Individual"?c.jsx(Xe,{icon:Oo,label:"Create",small:!0,variant:"warning",onClick:()=>E4(ee)}):c.jsx(Xe,{icon:LL,label:"Combine",small:!0,variant:"purple",onClick:()=>T4(ee)}):ee.toBeBilled==="Yes"&&!ee.invoiceGenerated&&ee.invoiceAmount&&si?c.jsx("span",{style:{fontSize:"10px",color:"#94A3B8"},children:"Finance to create"}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),c.jsx("td",{style:{padding:"10px 14px",backgroundColor:"#EFF6FF"},children:ee.invoiceNo?c.jsx("span",{style:{fontWeight:"700",color:"#1E40AF",fontSize:"12px"},children:ee.invoiceNo}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),c.jsx("td",{style:{padding:"10px 14px",backgroundColor:"#EFF6FF",fontSize:"12px"},children:ee.invoiceDate?St(ee.invoiceDate):"-"}),c.jsx("td",{style:{padding:"10px 14px",backgroundColor:"#EFF6FF",textAlign:"right",fontWeight:"700",color:"#1E40AF",fontSize:"13px"},children:ee.invoiceTotalAmount?zt(ee.invoiceTotalAmount):"-"}),c.jsx("td",{style:{padding:"10px 14px",textAlign:"center",backgroundColor:"#FAF5FF"},children:ee.combinationCode&&ee.combinationCode!=="NA"?c.jsx("span",{style:{fontWeight:"700",color:"#7C3AED",fontSize:"12px"},children:ee.combinationCode}):"-"}),c.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:ee.invoiceGenerated?si?c.jsx("button",{onClick:()=>An(ee),style:{padding:"5px 10px",fontSize:"11px",fontWeight:"700",border:"1.5px solid",borderRadius:"6px",cursor:"pointer",backgroundColor:ee.invoiceStatus==="Approved"?"#DCFCE7":ee.invoiceStatus==="Need Edits"?"#FEE2E2":"#FEF3C7",borderColor:ee.invoiceStatus==="Approved"?"#22C55E":ee.invoiceStatus==="Need Edits"?"#DC2626":"#F59E0B",color:ee.invoiceStatus==="Approved"?"#166534":ee.invoiceStatus==="Need Edits"?"#991B1B":"#92400E"},children:ee.invoiceStatus==="Approved"?" Approved":ee.invoiceStatus==="Need Edits"?" Need Edits":" Review"}):c.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"4px"},children:[c.jsx("span",{style:{padding:"4px 10px",fontSize:"11px",fontWeight:"700",borderRadius:"6px",backgroundColor:ee.invoiceStatus==="Approved"?"#DCFCE7":ee.invoiceStatus==="Need Edits"?"#FEE2E2":"#FEF3C7",color:ee.invoiceStatus==="Approved"?"#166534":ee.invoiceStatus==="Need Edits"?"#991B1B":"#92400E"},children:ee.invoiceStatus==="Approved"?" Approved":ee.invoiceStatus==="Need Edits"?" Need Edits":" Pending"}),(ee.editComments||ee.approvalRemarks)&&c.jsx("button",{onClick:()=>{or(ee),Rn(!0)},style:{fontSize:"9px",color:ee.invoiceStatus==="Need Edits"?"#991B1B":"#166534",background:"none",border:"none",cursor:"pointer",textDecoration:"underline"},title:ee.editComments||ee.approvalRemarks,children:"View Remarks"})]}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),c.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:ee.invoiceGenerated&&ee.invoiceStatus==="Approved"?c.jsxs("div",{style:{display:"flex",gap:"6px",justifyContent:"center"},children:[c.jsx(Xe,{icon:Oc,small:!0,onClick:()=>td(ee),title:"View Invoice"}),_r&&c.jsx(Xe,{icon:X0,small:!0,variant:"brand",onClick:()=>{or(ee),Vr(!0)},title:"Send Email"}),_r&&c.jsx(Xe,{icon:rs,small:!0,variant:"danger",onClick:()=>pg(ee),title:"Delete"})]}):ee.invoiceGenerated?c.jsxs("div",{style:{display:"flex",gap:"6px",justifyContent:"center"},children:[c.jsx(Xe,{icon:Oc,small:!0,onClick:()=>td(ee),title:"View Invoice"}),_r&&c.jsx(Xe,{icon:rs,small:!0,variant:"danger",onClick:()=>pg(ee),title:"Delete"})]}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),c.jsx("td",{style:{padding:"10px 14px",textAlign:"center",backgroundColor:"#F0FDF4"},children:ee.invoiceGenerated&&ee.invoiceStatus==="Approved"&&_r?Te?c.jsx("span",{style:{fontSize:"10px",color:"#94A3B8"},children:"Combined sent"}):c.jsxs("select",{value:ee.mailingSent||"No",onChange:ut=>g0(ee.id,"mailingSent",ut.target.value),style:{padding:"5px 8px",fontSize:"11px",fontWeight:"700",border:"2px solid",borderRadius:"6px",borderColor:ee.mailingSent==="Yes"?"#22C55E":"#E2E8F0",backgroundColor:ee.mailingSent==="Yes"?"#DCFCE7":"#FFFFFF",color:ee.mailingSent==="Yes"?"#166534":"#64748B",cursor:"pointer",width:"60px"},children:[c.jsx("option",{value:"No",children:"No"}),c.jsx("option",{value:"Yes",children:"Yes"})]}):ee.invoiceGenerated&&ee.invoiceStatus==="Approved"&&si?c.jsx("span",{style:{padding:"4px 8px",borderRadius:"6px",fontSize:"11px",fontWeight:"600",backgroundColor:ee.mailingSent==="Yes"?"#DCFCE7":"#FEF3C7",color:ee.mailingSent==="Yes"?"#166534":"#92400E"},children:ee.mailingSent==="Yes"?" Yes":" No"}):ee.invoiceGenerated&&ee.invoiceStatus!=="Approved"?c.jsx("span",{style:{fontSize:"10px",color:"#94A3B8"},children:"Approve first"}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),c.jsx("td",{style:{padding:"10px 14px",textAlign:"center",backgroundColor:"#F0FDF4"},children:ee.mailingSent==="Yes"?_r?c.jsx("input",{type:"date",value:ee.mailDate||ee.invoiceDate||"",onChange:ut=>g0(ee.id,"mailDate",ut.target.value),style:{padding:"4px 6px",fontSize:"11px",border:"1.5px solid #D1D5DB",borderRadius:"6px",width:"100%"}}):c.jsx("span",{style:{fontSize:"11px"},children:St(ee.mailDate||ee.invoiceDate)}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),c.jsx("td",{style:{padding:"10px 14px",textAlign:"center",backgroundColor:"#FAF5FF"},children:ee.receiptStatus==="Received"||ee.receiptStatus==="Closed"?c.jsxs("span",{style:{padding:"4px 8px",borderRadius:"6px",fontSize:"10px",fontWeight:"700",backgroundColor:"#DCFCE7",color:"#166534"},children:[" ",ee.receiptNo||"Received"]}):ee.receiptStatus==="Cancelled"?c.jsx("span",{style:{padding:"4px 8px",borderRadius:"6px",fontSize:"10px",fontWeight:"700",backgroundColor:"#FEE2E2",color:"#991B1B"},children:" Cancelled"}):ee.invoiceGenerated&&ee.invoiceStatus==="Approved"?c.jsx("span",{style:{padding:"4px 8px",borderRadius:"6px",fontSize:"10px",fontWeight:"600",backgroundColor:"#FEF3C7",color:"#92400E"},children:" Pending"}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})})]},ee.id)})})]})})]},fe)})}),U.length>0&&c.jsxs("div",{style:{marginTop:"16px",padding:"16px 20px",backgroundColor:"#FFFFFF",borderRadius:"12px",border:"1px solid #E2E8F0",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[c.jsxs("div",{style:{display:"flex",gap:"24px",fontSize:"14px",color:"#475569"},children:[c.jsxs("span",{children:[" Total: ",c.jsx("strong",{children:Q.length})]}),c.jsxs("span",{children:[" To Bill: ",c.jsx("strong",{children:Q.filter(L=>L.toBeBilled==="Yes").length})]}),c.jsxs("span",{children:[" Invoiced: ",c.jsx("strong",{children:Q.filter(L=>L.invoiceGenerated).length})]}),c.jsxs("span",{children:[" Approved: ",c.jsx("strong",{children:Q.filter(L=>L.invoiceStatus==="Approved").length})]}),wi==="closed"&&c.jsxs("span",{children:[" Closed: ",c.jsx("strong",{children:Q.filter(L=>L.receiptStatus==="Received"||L.receiptStatus==="Cancelled"||L.receiptStatus==="Closed").length})]})]}),c.jsxs("div",{style:{fontSize:"18px",fontWeight:"700",color:"#059669"},children:["Total: ",nt(Q.filter(L=>L.toBeBilled==="Yes").reduce((L,V)=>L+(parseFloat(V.totalWithGst)||0),0))]})]})]})},O4=h=>{var Q;const _=(Q=h.target.files)==null?void 0:Q[0];if(!_)return;const U=new FileReader;U.onload=B=>{const oe=Pl(B.target.result,{type:"binary",cellDates:!0}),L=oe.SheetNames[0],V=oe.Sheets[L],b=Er.sheet_to_json(V,{raw:!1}),z=new Set(Wr.map(ce=>`${ce.date}|${ce.partyName}|${ce.serviceType||ce.campaignName}`.toLowerCase()));let se=0,fe=0;const we=b.map((ce,ie)=>{const ee=(ce["TYPE OF SERVICE"]||ce["Type of Service"]||ce["SERVICE TYPE"]||ce["Service Type"]||ce["CAMPAIGN NAME"]||ce["Campaign Name"]||"").trim().toUpperCase();let Te=ce.DATE||ce.Date||new Date;typeof Te=="string"&&(Te=new Date(Te));const Je=(ce["PARTY NAME"]||ce["Party Name"]||"").trim(),lt=ce.EMAIL||ce.Email||"",ot=ce.STATE||ce.State||ce["State/Party Details"]||ce["STATE/PARTY DETAILS"]||"",vt=ce.AMOUNT||ce.Amount||Ui[Je]||"",ut=Te instanceof Date&&!isNaN(Te)?Te.toISOString().split("T")[0]:"",ze=(ce["Client Code"]||ce["CLIENT CODE"]||ce.Code||"").toString().trim()||Br(Je,ot),rt=ce["PO?"]||ce.PO||ce["WITH PO"]||"",Mt=rt.toLowerCase().includes("with po")||rt.toLowerCase()==="yes",me=ce["PO Number"]||ce["PO NUMBER"]||ce["PO No"]||ce["PO NO"]||"";let Pe=ce["PO Date"]||ce["PO DATE"]||"";typeof Pe=="object"&&Pe instanceof Date&&(Pe=Pe.toISOString().split("T")[0]);const ae=`${ut}|${Je}|${ee}`.toLowerCase();return z.has(ae)?(se++,null):(z.add(ae),fe++,{id:Date.now()+ie+Math.random(),sno:ce.SNO||ce["SNO."]||ce.Sno||ie+1,date:ut,statePartyDetails:ot,partyName:Je,clientCode:ze,serviceType:ee,emailId:lt,additionalEmails:[],toBeBilled:"Not Yet",invoiceAmount:vt,cgst:"",sgst:"",igst:"",totalWithGst:"",invoiceType:"Individual",invoiceNo:"",invoiceDate:"",invoiceTotalAmount:"",invoiceGenerated:!1,invoiceStatus:"Pending",mailingSent:"No",mailDate:"",mailerUploaded:!1,editComments:"",approvalRemarks:"",isService:!0,poStatus:Mt?"With PO":"Without PO",poNumber:Mt?me:"",poDate:Mt?Pe:""})}).filter(ce=>ce!==null);if(we.length>0){const ce=[...Wr,...we];console.log("Setting services data:",ce.length,"entries"),ke(ce);const ie=[...new Set(we.map(ee=>ee.partyName))];he(ee=>{const Te=new Set(ee);return ie.forEach(Je=>Te.add(Je)),Te}),setTimeout(async()=>{console.log("Triggering immediate save for services data..."),ys.current=!1;try{await vd("indreesh-media",{masterData:Se,servicesData:ce,ledgerEntries:ne,receipts:je,creditNotes:te,openingBalances:Wn,mailerImages:Ft,mailerLogo:zn,companyConfig:w,nextInvoiceNo:it,nextCombineNo:Rt,nextReceiptNo:Dt,nextCreditNoteNo:Ye,nextServiceInvoiceNo:Zr,invoiceValues:Ui,notifications:$e,whatsappSettings:kt,partyMaster:an,followups:Gt,userPasswords:y}),console.log("Services data saved successfully!"),m(new Date)}catch(ee){console.error("Error saving services data:",ee)}},100)}let Ze=` Services Upload Complete!

`;Ze+=` ${fe} new entries added
`,se>0&&(Ze+=` ${se} duplicate entries skipped`),fe>0&&Zi("upload",` ${fe} new services uploaded`,"director"),alert(Ze)},U.readAsBinaryString(_),h.target.value=""},rd=(h,_,U)=>{ke(Q=>Q.map(B=>B.id===h?{...B,[_]:U}:B))},M4=h=>{he(_=>{const U=new Set(_);return U.has(h)?U.delete(h):U.add(h),U})},gg=h=>{const _=be.find(U=>U.id===h);if(_!=null&&_.invoiceGenerated&&(_==null?void 0:_.invoiceStatus)==="Approved"){alert("Cannot delete approved invoices. Delete from Invoice Register instead.");return}window.confirm("Delete this service entry?")&&ke(U=>U.filter(Q=>Q.id!==h))},B4=h=>{var se;const _=be.find(fe=>fe.id===h);if(!_)return;if(!_.invoiceAmount||parseFloat(_.invoiceAmount)<=0){alert("Please enter a valid invoice amount");return}const U=`${w.invoicePrefix}${Zr}`,Q=new Date().toISOString().split("T")[0],B=(se=_.statePartyDetails)==null?void 0:se.toUpperCase().includes("MAHARASHTRA"),oe=parseFloat(_.invoiceAmount),L=B?oe*.09:0,V=B?oe*.09:0,b=B?0:oe*.18,z=oe+L+V+b;ke(fe=>fe.map(we=>we.id===h?{...we,invoiceNo:U,invoiceDate:Q,invoiceTotalAmount:z.toFixed(2),cgst:L.toFixed(2),sgst:V.toFixed(2),igst:b.toFixed(2),totalWithGst:z.toFixed(2),invoiceGenerated:!0,invoiceStatus:"Created",isService:!0}:we)),En(fe=>fe+1),Zi("invoice_created",`Service Invoice ${U} created for ${_.partyName}`,"director")},nd=h=>{if(console.log("generateServiceInvoicePDF called with:",h),!h){console.error("No row data provided"),alert("Invoice data not found - no row");return}if(!h.invoiceNo){console.error("No invoice number in row:",h),alert("Invoice not yet generated for this entry");return}const _=getPartyGstinFromMaster(h.partyName,h.statePartyDetails),U=Ac(h.partyName,h.statePartyDetails),Q=h.statePartyDetails,B=parseFloat(h.invoiceAmount)||0,oe=parseFloat(h.cgst)||0,L=parseFloat(h.sgst)||0,V=parseFloat(h.igst)||0,b=parseFloat(h.invoiceTotalAmount)||B+oe+L+V,z=oe>0,se=h.clientCode||Br(h.partyName,h.statePartyDetails)||"";console.log("Generating invoice PDF for:",h.invoiceNo,"Amount:",b);const fe=`
<!DOCTYPE html>
<html>
<head>
  <title>Tax Invoice - ${h.invoiceNo}</title>
  <style>
    @media print { body { -webkit-print-color-adjust: exact !important; } @page { size: A4; margin: 10mm; } }
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: Arial, sans-serif; font-size: 12px; }
    .invoice-container { max-width: 800px; margin: 0 auto; border: 2px solid #000; }
  </style>
</head>
<body>
  <div class="invoice-container">
    <div style="text-align: center; padding: 15px; border-bottom: 2px solid #000; font-size: 20px; font-weight: bold;">Tax Invoice</div>
    <div style="text-align: center; padding: 5px; border-bottom: 1px solid #000; font-style: italic; font-size: 11px; background: #f5f5f5;">(Original for Recipient)</div>
    <div style="display: flex; border-bottom: 2px solid #000;">
      <div style="flex: 1.5; padding: 12px; border-right: 2px solid #000;">
        <div style="font-size: 16px; font-weight: bold; color: #1a5276; margin-bottom: 8px;">${w.name}</div>
        <div style="font-size: 11px; line-height: 1.5;">${w.address}<br>${w.addressLine2}, ${w.city}<br><strong>GSTIN/UIN:</strong> ${w.gstin}<br><strong>State:</strong> ${w.stateName}, Code: ${w.stateCode}<br><strong>Contact:</strong> ${w.phone}<br><strong>E-Mail:</strong> ${w.email}</div>
      </div>
      <div style="flex: 1; padding: 0;">
        <div style="display: flex; border-bottom: 1px solid #000;"><div style="flex: 1; padding: 8px; border-right: 1px solid #000; font-weight: bold; background: #f5f5f5;">Invoice No.</div><div style="flex: 1; padding: 8px; color: #1a5276; font-weight: bold;">${h.invoiceNo}</div></div>
        <div style="display: flex;"><div style="flex: 1; padding: 8px; border-right: 1px solid #000; font-weight: bold; background: #f5f5f5;">Dated</div><div style="flex: 1; padding: 8px;">${St(h.invoiceDate)}</div></div>
      </div>
    </div>
    <div style="padding: 10px 12px; border-bottom: 2px solid #000; background: #fafafa;">
      <div style="font-size: 11px; color: #666; margin-bottom: 3px;">Buyer (Bill to)</div>
      <div style="font-size: 14px; font-weight: bold; margin-bottom: 4px; color: #1a5276;">${h.partyName}${se?' <span style="background:#9333EA;color:white;padding:2px 6px;border-radius:4px;font-size:10px;margin-left:8px;">'+se+"</span>":""}</div>
      <div style="font-size: 11px; color: #333;">${U?U+"<br>":""}${Q||""}${_?"<br><strong>GSTIN/UIN:</strong> "+_:""}<br>Place of Supply: ${Q||w.stateName}</div>
    </div>
    <table style="width: 100%; border-collapse: collapse;">
      <thead><tr style="background: #e8e8e8;"><th style="border: 1px solid #000; padding: 10px; width: 45px;">Sl No.</th><th style="border: 1px solid #000; padding: 10px;">Particulars</th><th style="border: 1px solid #000; padding: 10px; width: 80px;">HSN/SAC</th><th style="border: 1px solid #000; padding: 10px; width: 100px; text-align: right;">Amount</th></tr></thead>
      <tbody>
        <tr>
          <td style="border: 1px solid #000; padding: 8px; text-align: center;">1</td>
          <td style="border: 1px solid #000; padding: 8px;">
            <div style="font-weight: 600;">${(h.serviceType||h.campaignName||"SERVICE").toUpperCase()}</div>
            <div style="font-style: italic; color: #555; font-size: 11px;">Date: ${St(h.date)}</div>
          </td>
          <td style="border: 1px solid #000; padding: 8px; text-align: center;">${w.hsnCode}</td>
          <td style="border: 1px solid #000; padding: 8px; text-align: right;">${zt(B)}</td>
        </tr>
        ${z?`
          <tr><td colspan="3" style="border: 1px solid #000; padding: 8px; text-align: right; font-weight: 600;">CGST @ 9%</td><td style="border: 1px solid #000; padding: 8px; text-align: right;">${zt(oe)}</td></tr>
          <tr><td colspan="3" style="border: 1px solid #000; padding: 8px; text-align: right; font-weight: 600;">SGST @ 9%</td><td style="border: 1px solid #000; padding: 8px; text-align: right;">${zt(L)}</td></tr>
        `:`
          <tr><td colspan="3" style="border: 1px solid #000; padding: 8px; text-align: right; font-weight: 600;">IGST @ 18%</td><td style="border: 1px solid #000; padding: 8px; text-align: right;">${zt(V)}</td></tr>
        `}
        <tr style="background: #2874A6; color: white;"><td colspan="3" style="border: 1px solid #000; padding: 12px; text-align: right; font-weight: bold; font-size: 14px;">Total</td><td style="border: 1px solid #000; padding: 12px; text-align: right; font-weight: bold; font-size: 14px;"> ${b.toLocaleString("en-IN",{minimumFractionDigits:2})}</td></tr>
      </tbody>
    </table>
    <div style="padding: 10px 12px; border: 1px solid #000; border-top: none; background: #fafafa;"><div style="color: #666; font-size: 11px; margin-bottom: 3px;">Amount Chargeable (in words)</div><div style="font-weight: bold; font-size: 13px;">${nh(b)}</div></div>
    <div style="display: flex; border-top: 2px solid #000;">
      <div style="flex: 1; padding: 10px 12px; border-right: 2px solid #000; font-size: 11px;"><div><strong>Company's PAN:</strong> ${w.pan}</div><div style="margin-top: 4px;"><strong>MSME Reg. No.:</strong> UDYAM-MH-19-0057219</div></div>
      <div style="flex: 1.2; padding: 10px 12px; font-size: 11px;">
        <div style="font-weight: bold; margin-bottom: 6px; color: #1a5276;">Company's Bank Details</div>
        <div style="line-height: 1.5;"><strong>A/c Holder:</strong> ${w.bank.holder}<br><strong>Bank:</strong> ${w.bank.name}<br><strong>A/c No.:</strong> ${w.bank.account}<br><strong>IFSC:</strong> ${w.bank.ifsc}</div>
        <div style="text-align: right; margin-top: 30px;"><div style="font-weight: bold;">for ${w.name}</div><div style="margin-top: 25px; border-top: 1px solid #000; display: inline-block; padding-top: 4px; font-size: 10px;">Authorised Signatory</div></div>
      </div>
    </div>
    <div style="text-align: center; padding: 8px; background: #f0f0f0; border-top: 1px solid #000; font-size: 10px; color: #666; font-style: italic;">This is a Computer Generated Invoice</div>
  </div>
</body>
</html>`;try{const we=window.open("","_blank");we?(we.document.write(fe),we.document.close(),we.focus()):alert("Pop-up blocked. Please allow pop-ups for this site to view invoices.")}catch(we){console.error("Error opening invoice:",we),alert("Error opening invoice: "+we.message)}},j4=ye.useMemo(()=>[...new Set(Wr.map(h=>h.partyName).filter(Boolean))].sort(),[Wr]),mg=ye.useMemo(()=>Wr.filter(h=>!(de.party&&h.partyName!==de.party||de.billStatus&&h.toBeBilled!==de.billStatus||de.invoiceStatus&&(de.invoiceStatus==="Pending"&&h.invoiceGenerated||de.invoiceStatus==="Created"&&h.invoiceStatus!=="Created"||de.invoiceStatus==="Approved"&&h.invoiceStatus!=="Approved"||de.invoiceStatus==="Need Edits"&&h.invoiceStatus!=="Need Edits"))),[Wr,de]),L4=()=>{const h=r==="director",_=r==="finance";console.log("Services Render Debug:",{servicesDataType:typeof be,servicesDataIsArray:Array.isArray(be),servicesDataLength:be==null?void 0:be.length,safeServicesDataLength:Wr.length,filteredServicesDataLength:mg.length,role:r,serviceFilters:de,servicesSheetTab:G,rawServicesData:be});const U=mg.filter(V=>!(V.toBeBilled==="Yes"&&V.invoiceGenerated&&V.mailingSent==="Yes"&&(V.receiptStatus==="Received"||V.receiptStatus==="Cancelled"||V.receiptStatus==="Closed"))),Q=mg.filter(V=>V.toBeBilled==="Yes"&&V.invoiceGenerated&&V.mailingSent==="Yes"&&(V.receiptStatus==="Received"||V.receiptStatus==="Cancelled"||V.receiptStatus==="Closed")),B=G==="open"?U:Q;console.log("Services Tab Data:",{openCount:U.length,closedCount:Q.length,currentTab:G});const oe={};B.forEach(V=>{const b=V.clientCode||Br(V.partyName,V.statePartyDetails)||"",z=`${V.partyName||"Unknown"}|||${b}`;oe[z]||(oe[z]={partyName:V.partyName||"Unknown",clientCode:b,rows:[]}),oe[z].rows.push(V)});const L=Object.values(oe).sort((V,b)=>{const z=V.partyName.localeCompare(b.partyName);return z!==0?z:(V.clientCode||"").localeCompare(b.clientCode||"")});if(h&&L.length>0&&ve.size===0){const V=new Set(L.map(b=>`${b.partyName}|||${b.clientCode}`));he(V)}return c.jsxs("div",{style:{padding:"20px"},children:[c.jsx("input",{type:"file",ref:Ao,onChange:O4,accept:".xlsx,.xls,.csv",style:{display:"none"}}),c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[c.jsxs("div",{children:[c.jsx("h1",{style:{fontSize:"22px",fontWeight:"700",color:"#1E293B",marginBottom:"4px"},children:" Services Sheet"}),c.jsxs("p",{style:{fontSize:"13px",color:"#64748B"},children:["Non-campaign invoices  Total: ",Wr.length," entries"]})]}),c.jsx("div",{style:{display:"flex",gap:"10px"},children:_&&c.jsxs(c.Fragment,{children:[c.jsx(Xe,{icon:Ys,label:"Upload Excel",onClick:()=>{var V;return(V=Ao.current)==null?void 0:V.click()}}),c.jsx(Xe,{icon:zL,label:"Force Save",variant:"secondary",onClick:async()=>{try{ys.current=!1,await vd("indreesh-media",{masterData:Se,servicesData:be,ledgerEntries:ne,receipts:je,creditNotes:te,openingBalances:Wn,mailerImages:Ft,mailerLogo:zn,companyConfig:w,nextInvoiceNo:it,nextCombineNo:Rt,nextReceiptNo:Dt,nextCreditNoteNo:Ye,nextServiceInvoiceNo:Zr,invoiceValues:Ui,notifications:$e,whatsappSettings:kt,partyMaster:an,followups:Gt,userPasswords:y}),m(new Date),alert("Data saved successfully!")}catch(V){console.error("Save error:",V),alert("Error saving: "+V.message)}}}),c.jsx(Xe,{icon:md,label:"Add Entry",variant:"primary",onClick:()=>Y(!0)})]})})]}),c.jsx("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"10px",border:"1px solid #E2E8F0",padding:"14px 18px",marginBottom:"16px"},children:c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"14px",flexWrap:"wrap"},children:[c.jsx(gd,{size:18,color:"#64748B"}),c.jsx("span",{style:{fontSize:"13px",fontWeight:"700",color:"#475569"},children:"Filters:"}),c.jsxs("select",{value:de.party,onChange:V=>ge(b=>({...b,party:V.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px"},children:[c.jsx("option",{value:"",children:"All Parties"}),j4.map(V=>c.jsx("option",{value:V,children:V},V))]}),c.jsxs("select",{value:de.billStatus,onChange:V=>ge(b=>({...b,billStatus:V.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px"},children:[c.jsx("option",{value:"",children:"All Bill Status"}),c.jsx("option",{value:"Yes",children:"To Be Billed"}),c.jsx("option",{value:"No",children:"Not Billing"}),c.jsx("option",{value:"Not Yet",children:"Not Yet"})]}),c.jsxs("select",{value:de.invoiceStatus,onChange:V=>ge(b=>({...b,invoiceStatus:V.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px"},children:[c.jsx("option",{value:"",children:"All Invoice Status"}),c.jsx("option",{value:"Pending",children:"Pending"}),c.jsx("option",{value:"Created",children:"Created"}),c.jsx("option",{value:"Approved",children:"Approved"}),c.jsx("option",{value:"Need Edits",children:"Need Edits"})]}),(de.party||de.billStatus||de.invoiceStatus)&&c.jsxs("button",{onClick:()=>ge({party:"",billStatus:"",invoiceStatus:""}),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #FCA5A5",borderRadius:"8px",backgroundColor:"#FEE2E2",color:"#991B1B",cursor:"pointer"},children:[c.jsx(wa,{size:14})," Clear"]})]})}),c.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"20px",justifyContent:"space-between",alignItems:"center"},children:[c.jsxs("div",{style:{display:"flex",gap:"8px"},children:[c.jsxs("button",{onClick:()=>j("open"),style:{padding:"10px 20px",fontSize:"13px",fontWeight:"600",border:"none",borderRadius:"8px",cursor:"pointer",backgroundColor:G==="open"?"#2874A6":"#E2E8F0",color:G==="open"?"#FFFFFF":"#64748B"},children:["Open (",U.length,")"]}),c.jsxs("button",{onClick:()=>j("closed"),style:{padding:"10px 20px",fontSize:"13px",fontWeight:"600",border:"none",borderRadius:"8px",cursor:"pointer",backgroundColor:G==="closed"?"#22C55E":"#E2E8F0",color:G==="closed"?"#FFFFFF":"#64748B"},children:["Closed (",Q.length,")"]})]}),c.jsx("button",{onClick:()=>{ve.size===L.length?he(new Set):he(new Set(L.map(V=>`${V.partyName}|||${V.clientCode}`)))},style:{padding:"8px 16px",fontSize:"12px",fontWeight:"600",border:"1px solid #CBD5E1",borderRadius:"6px",cursor:"pointer",backgroundColor:"#F8FAFC",color:"#475569"},children:ve.size===L.length?"Collapse All":"Expand All"})]}),c.jsx(mn,{title:`Services - ${G==="open"?"Open":"Closed"}`,noPadding:!0,children:L.length===0?c.jsxs("div",{style:{padding:"40px",textAlign:"center",color:"#94A3B8"},children:[c.jsx(sm,{size:40,style:{marginBottom:"10px",opacity:.5}}),c.jsx("p",{children:"No services in this tab"}),_&&c.jsx("p",{style:{marginTop:"10px",fontSize:"13px"},children:"Upload Excel or Add Entry to get started"})]}):L.map((V,b)=>{const{partyName:z,clientCode:se,rows:fe}=V,we=`${z}|||${se}`,Ze=ve.has(we),ce=fe.filter(ie=>ie.toBeBilled==="Yes").reduce((ie,ee)=>ie+(parseFloat(ee.totalWithGst)||parseFloat(ee.invoiceAmount)||0),0);return c.jsxs("div",{style:{borderBottom:"2px solid #E2E8F0"},children:[c.jsxs("div",{onClick:()=>M4(we),style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"16px 20px",backgroundColor:G==="closed"?"#F0FDF4":"#F8FAFC",cursor:"pointer",borderBottom:Ze?"3px solid #2874A6":"none"},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[Ze?c.jsx(nm,{size:20,color:"#2874A6"}):c.jsx(K0,{size:20,color:"#64748B"}),c.jsx("span",{style:{fontWeight:"700",fontSize:"15px",color:"#1E293B"},children:z}),se&&c.jsx("span",{style:{padding:"2px 8px",backgroundColor:"#F3E8FF",color:"#6B21A8",borderRadius:"6px",fontSize:"12px",fontWeight:"700"},children:se}),c.jsxs("span",{style:{padding:"4px 10px",backgroundColor:"#E0E7FF",color:"#3730A3",borderRadius:"9999px",fontSize:"12px",fontWeight:"600"},children:[fe.length," items"]})]}),c.jsx("div",{style:{fontWeight:"700",color:"#059669"},children:nt(ce)})]}),Ze&&c.jsx("div",{style:{overflowX:"auto"},children:c.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"12px"},children:[c.jsx("thead",{children:c.jsxs("tr",{style:{backgroundColor:"#F1F5F9"},children:[c.jsx("th",{style:{padding:"10px 8px",textAlign:"left",fontWeight:"600",color:"#475569"},children:"Date"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"600",color:"#6B21A8",backgroundColor:"#FAF5FF"},children:"Code"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"left",fontWeight:"600",color:"#475569"},children:"State"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"left",fontWeight:"600",color:"#475569"},children:"Type of Service"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"left",fontWeight:"600",color:"#475569"},children:"Emails"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"600",color:"#475569"},children:"Mailer"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"600",color:"#475569"},children:"PO?"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"600",color:"#475569"},children:"To Bill"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"600",color:"#475569"},children:"Amount"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"600",color:"#475569"},children:"Create"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"left",fontWeight:"600",color:"#475569",backgroundColor:"#EFF6FF"},children:"Invoice No"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"left",fontWeight:"600",color:"#475569",backgroundColor:"#EFF6FF"},children:"Inv Date"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"600",color:"#475569",backgroundColor:"#EFF6FF"},children:"Inv Amt"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"600",color:"#475569"},children:"Approval"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"600",color:"#475569"},children:"Actions"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"600",color:"#475569",backgroundColor:"#F0FDF4"},children:"Mailed"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"600",color:"#475569",backgroundColor:"#F0FDF4"},children:"Mail Date"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"600",color:"#475569",backgroundColor:"#FEF3C7"},children:"Status"})]})}),c.jsx("tbody",{children:fe.map(ie=>{const ee=Ft[ie.id]&&Ft[ie.id].length>0;[ie.emailId,...ie.additionalEmails||[]].filter(Boolean);const Te=ie.clientCode||Br(ie.partyName,ie.statePartyDetails),Je=$r.filter(Pe=>Pe.invoiceNo===ie.invoiceNo),lt=ni.filter(Pe=>Pe.invoiceNo===ie.invoiceNo),ot=Je.reduce((Pe,ae)=>Pe+(parseFloat(ae.amount)||0),0),vt=Je.reduce((Pe,ae)=>Pe+(parseFloat(ae.tds)||parseFloat(ae.tdsAmount)||0),0),ut=lt.reduce((Pe,ae)=>Pe+Math.abs(parseFloat(ae.totalAmount)||0),0),Ot=parseFloat(ie.invoiceTotalAmount)||0,ze=Ot-ot-vt-ut;let rt="Pending",Mt="#FEF3C7",me="#92400E";return ut>=Ot?(rt="Cancelled",Mt="#FEE2E2",me="#B91C1C"):ze<=0?(rt="Paid",Mt="#D1FAE5",me="#065F46"):(ot>0||vt>0||ut>0)&&(rt="Partial",Mt="#FEF3C7",me="#92400E"),c.jsxs("tr",{style:{backgroundColor:ie.toBeBilled==="Yes"?ie.invoiceGenerated?"#F0FDF4":"#FFFBEB":"#FFFFFF",borderBottom:"1px solid #F1F5F9"},children:[c.jsx("td",{style:{padding:"10px 8px",whiteSpace:"nowrap"},children:St(ie.date)}),c.jsx("td",{style:{padding:"10px 8px",textAlign:"center",backgroundColor:"#FAF5FF"},children:c.jsx("span",{style:{fontWeight:"700",color:"#6B21A8",fontSize:"11px"},children:Te||"-"})}),c.jsx("td",{style:{padding:"10px 8px",fontSize:"11px",color:"#64748B"},children:ie.statePartyDetails||"-"}),c.jsx("td",{style:{padding:"10px 8px",fontWeight:"600",maxWidth:"180px"},children:c.jsx("div",{style:{color:"#1E293B"},children:ie.serviceType||ie.campaignName||"-"})}),c.jsx("td",{style:{padding:"10px 8px"},children:c.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[ie.emailId&&c.jsx("div",{style:{fontSize:"11px",color:"#1E40AF",backgroundColor:"#EFF6FF",padding:"2px 6px",borderRadius:"4px",display:"inline-block"},children:ie.emailId}),(ie.additionalEmails||[]).map((Pe,ae)=>c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[c.jsx("span",{style:{fontSize:"11px",color:"#059669",backgroundColor:"#F0FDF4",padding:"2px 6px",borderRadius:"4px"},children:Pe}),_&&c.jsx("button",{onClick:()=>rd(ie.id,"additionalEmails",(ie.additionalEmails||[]).filter(Qe=>Qe!==Pe)),style:{background:"none",border:"none",cursor:"pointer",padding:"2px",color:"#DC2626"},title:"Remove",children:c.jsx(wa,{size:12})})]},ae)),_&&c.jsxs("button",{onClick:()=>{or(ie),gs(""),Pr(!0)},style:{display:"flex",alignItems:"center",gap:"4px",fontSize:"11px",color:"#2874A6",background:"none",border:"none",cursor:"pointer",padding:"2px 0"},children:[c.jsx(am,{size:12})," Add"]})]})}),c.jsx("td",{style:{padding:"10px 8px",textAlign:"center"},children:ee?c.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"2px"},children:[c.jsx("span",{style:{color:"#22C55E",fontWeight:"700",fontSize:"14px"},children:""}),_&&c.jsx("button",{onClick:()=>{or(ie),Vs(null),To(!0),Oi(!0)},style:{fontSize:"10px",color:"#64748B",background:"none",border:"none",cursor:"pointer",textDecoration:"underline"},children:"Replace"})]}):_&&c.jsx(Xe,{icon:eE,small:!0,variant:"default",onClick:()=>{or(ie),Vs(null),To(!1),Oi(!0)}})}),c.jsx("td",{style:{padding:"10px 8px",textAlign:"center"},children:ie.poStatus==="With PO"?c.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"2px"},children:[c.jsx("span",{style:{color:"#22C55E",fontWeight:"600",fontSize:"10px"},children:" PO"}),c.jsx("span",{style:{fontSize:"9px",color:"#1E40AF",fontWeight:"600"},children:ie.poNumber}),ie.poDate&&c.jsx("span",{style:{fontSize:"9px",color:"#64748B"},children:St(ie.poDate)})]}):c.jsx("span",{style:{color:"#CBD5E1",fontSize:"10px"},children:"No PO"})}),c.jsx("td",{style:{padding:"10px 8px",textAlign:"center"},children:c.jsxs("select",{value:ie.toBeBilled,onChange:Pe=>rd(ie.id,"toBeBilled",Pe.target.value),disabled:ie.invoiceGenerated||!h,style:{padding:"6px 8px",fontSize:"12px",fontWeight:"600",border:"2px solid",borderRadius:"6px",borderColor:ie.toBeBilled==="Yes"?"#22C55E":"#E2E8F0",backgroundColor:ie.toBeBilled==="Yes"?"#DCFCE7":"#FFFFFF",color:ie.toBeBilled==="Yes"?"#166534":"#64748B",cursor:ie.invoiceGenerated||!h?"not-allowed":"pointer",width:"70px",opacity:!h&&!ie.invoiceGenerated?.6:1},children:[c.jsx("option",{value:"Not Yet",children:"Not Yet"}),c.jsx("option",{value:"Yes",children:"Yes"})]})}),c.jsx("td",{style:{padding:"10px 8px"},children:c.jsx("input",{type:"number",value:ie.invoiceAmount||"",onChange:Pe=>rd(ie.id,"invoiceAmount",Pe.target.value),disabled:ie.invoiceGenerated,placeholder:"0",style:{width:"80px",padding:"6px 8px",fontSize:"13px",fontWeight:"600",border:"1.5px solid #D1D5DB",borderRadius:"6px",textAlign:"right",backgroundColor:ie.invoiceGenerated?"#F3F4F6":"#FFFFFF"}})}),c.jsx("td",{style:{padding:"10px 8px",textAlign:"center"},children:ie.toBeBilled==="Yes"&&!ie.invoiceGenerated&&ie.invoiceAmount&&_?c.jsx(Xe,{icon:Oo,label:"Create",small:!0,variant:"warning",onClick:()=>B4(ie.id)}):ie.toBeBilled==="Yes"&&!ie.invoiceGenerated&&ie.invoiceAmount&&h?c.jsx("span",{style:{fontSize:"10px",color:"#94A3B8"},children:"Finance to create"}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),c.jsx("td",{style:{padding:"10px 8px",backgroundColor:"#EFF6FF"},children:ie.invoiceNo?c.jsx("span",{style:{fontWeight:"700",color:"#1E40AF",fontSize:"12px"},children:ie.invoiceNo}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),c.jsx("td",{style:{padding:"10px 8px",backgroundColor:"#EFF6FF",fontSize:"12px"},children:ie.invoiceDate?St(ie.invoiceDate):"-"}),c.jsx("td",{style:{padding:"10px 8px",backgroundColor:"#EFF6FF",textAlign:"right",fontWeight:"700",color:"#1E40AF",fontSize:"13px"},children:ie.invoiceTotalAmount?zt(ie.invoiceTotalAmount):"-"}),c.jsx("td",{style:{padding:"10px 8px",textAlign:"center"},children:ie.invoiceGenerated?h?c.jsx("button",{onClick:()=>An(ie),style:{padding:"5px 10px",fontSize:"11px",fontWeight:"700",border:"1.5px solid",borderRadius:"6px",cursor:"pointer",backgroundColor:ie.invoiceStatus==="Approved"?"#DCFCE7":ie.invoiceStatus==="Need Edits"?"#FEE2E2":"#FEF3C7",borderColor:ie.invoiceStatus==="Approved"?"#22C55E":ie.invoiceStatus==="Need Edits"?"#DC2626":"#F59E0B",color:ie.invoiceStatus==="Approved"?"#166534":ie.invoiceStatus==="Need Edits"?"#991B1B":"#92400E"},children:ie.invoiceStatus==="Approved"?" Approved":ie.invoiceStatus==="Need Edits"?" Need Edits":" Review"}):c.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"4px"},children:[c.jsx("span",{style:{padding:"4px 10px",fontSize:"11px",fontWeight:"700",borderRadius:"6px",backgroundColor:ie.invoiceStatus==="Approved"?"#DCFCE7":ie.invoiceStatus==="Need Edits"?"#FEE2E2":"#FEF3C7",color:ie.invoiceStatus==="Approved"?"#166534":ie.invoiceStatus==="Need Edits"?"#991B1B":"#92400E"},children:ie.invoiceStatus==="Approved"?" Approved":ie.invoiceStatus==="Need Edits"?" Need Edits":" Pending"}),(ie.editComments||ie.approvalRemarks)&&c.jsx("button",{onClick:()=>{or(ie),Rn(!0)},style:{fontSize:"9px",color:ie.invoiceStatus==="Need Edits"?"#991B1B":"#166534",background:"none",border:"none",cursor:"pointer",textDecoration:"underline"},title:ie.editComments||ie.approvalRemarks,children:"View Remarks"})]}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),c.jsx("td",{style:{padding:"10px 8px",textAlign:"center"},children:ie.invoiceGenerated&&ie.invoiceStatus==="Approved"?c.jsxs("div",{style:{display:"flex",gap:"6px",justifyContent:"center"},children:[c.jsx(Xe,{icon:Oc,small:!0,onClick:()=>nd(ie),title:"View Invoice"}),_&&c.jsx(Xe,{icon:X0,small:!0,variant:"brand",onClick:()=>{or(ie),Vr(!0)},title:"Send Email"}),_&&c.jsx(Xe,{icon:rs,small:!0,variant:"danger",onClick:()=>gg(ie.id),title:"Delete"})]}):ie.invoiceGenerated?c.jsxs("div",{style:{display:"flex",gap:"6px",justifyContent:"center"},children:[c.jsx(Xe,{icon:Oc,small:!0,onClick:()=>nd(ie),title:"View Invoice"}),_&&c.jsx(Xe,{icon:rs,small:!0,variant:"danger",onClick:()=>gg(ie.id),title:"Delete"})]}):_?c.jsx(Xe,{icon:rs,small:!0,variant:"danger",onClick:()=>gg(ie.id),title:"Delete"}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),c.jsx("td",{style:{padding:"10px 8px",textAlign:"center",backgroundColor:"#F0FDF4"},children:ie.invoiceGenerated&&ie.invoiceStatus==="Approved"&&_?c.jsxs("select",{value:ie.mailingSent||"No",onChange:Pe=>rd(ie.id,"mailingSent",Pe.target.value),style:{padding:"5px 8px",fontSize:"11px",fontWeight:"700",border:"2px solid",borderRadius:"6px",borderColor:ie.mailingSent==="Yes"?"#22C55E":"#E2E8F0",backgroundColor:ie.mailingSent==="Yes"?"#DCFCE7":"#FFFFFF",color:ie.mailingSent==="Yes"?"#166534":"#64748B",cursor:"pointer",width:"60px"},children:[c.jsx("option",{value:"No",children:"No"}),c.jsx("option",{value:"Yes",children:"Yes"})]}):ie.invoiceGenerated&&ie.invoiceStatus==="Approved"&&h?c.jsx("span",{style:{padding:"4px 8px",borderRadius:"6px",fontSize:"11px",fontWeight:"600",backgroundColor:ie.mailingSent==="Yes"?"#DCFCE7":"#FEF3C7",color:ie.mailingSent==="Yes"?"#166534":"#92400E"},children:ie.mailingSent==="Yes"?" Yes":" No"}):ie.invoiceGenerated&&ie.invoiceStatus!=="Approved"?c.jsx("span",{style:{fontSize:"10px",color:"#94A3B8"},children:"Approve first"}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),c.jsx("td",{style:{padding:"10px 8px",textAlign:"center",backgroundColor:"#F0FDF4"},children:ie.mailingSent==="Yes"?_?c.jsx("input",{type:"date",value:ie.mailDate||"",onChange:Pe=>rd(ie.id,"mailDate",Pe.target.value),style:{padding:"4px 6px",fontSize:"11px",border:"1px solid #D1D5DB",borderRadius:"4px",width:"110px"}}):c.jsx("span",{style:{fontSize:"11px"},children:ie.mailDate?St(ie.mailDate):"-"}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),c.jsx("td",{style:{padding:"10px 8px",textAlign:"center",backgroundColor:"#FEF3C7"},children:ie.invoiceGenerated&&ie.invoiceStatus==="Approved"?c.jsx("span",{style:{padding:"4px 10px",backgroundColor:Mt,color:me,borderRadius:"9999px",fontSize:"11px",fontWeight:"600"},children:rt}):c.jsx("span",{style:{color:"#CBD5E1"},children:"-"})})]},ie.id)})})]})})]},we)})}),B.length>0&&c.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"16px"},children:c.jsxs("div",{style:{backgroundColor:"#F0FDF4",padding:"16px 24px",borderRadius:"10px",border:"2px solid #86EFAC"},children:[c.jsx("div",{style:{fontSize:"12px",color:"#166534",fontWeight:"600",marginBottom:"4px"},children:"To Be Billed Total"}),c.jsx("div",{style:{fontSize:"18px",fontWeight:"700",color:"#059669"},children:nt(B.filter(V=>V.toBeBilled==="Yes").reduce((V,b)=>V+(parseFloat(b.totalWithGst)||parseFloat(b.invoiceAmount)||0),0))})]})}),c.jsx(On,{isOpen:W,onClose:()=>Y(!1),title:" Add Service Entry",width:"600px",children:c.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[c.jsxs("div",{children:[c.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:"600",marginBottom:"4px"},children:"Date *"}),c.jsx("input",{type:"date",id:"svcDate",defaultValue:new Date().toISOString().split("T")[0],style:{width:"100%",padding:"8px",border:"1.5px solid #E2E8F0",borderRadius:"6px"}})]}),c.jsxs("div",{children:[c.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:"600",marginBottom:"4px"},children:"State *"}),c.jsx("input",{type:"text",id:"svcState",placeholder:"Maharashtra",style:{width:"100%",padding:"8px",border:"1.5px solid #E2E8F0",borderRadius:"6px"}})]})]}),c.jsxs("div",{children:[c.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:"600",marginBottom:"4px"},children:"Party Name *"}),c.jsx("input",{list:"svcPartyList",id:"svcParty",placeholder:"Party name",style:{width:"100%",padding:"8px",border:"1.5px solid #E2E8F0",borderRadius:"6px"}}),c.jsx("datalist",{id:"svcPartyList",children:Object.values(an).map((V,b)=>c.jsx("option",{value:V.partyName},b))})]}),c.jsxs("div",{children:[c.jsxs("label",{style:{display:"block",fontSize:"12px",fontWeight:"600",marginBottom:"4px"},children:["Type of Service * ",c.jsx("span",{style:{color:"#64748B",fontWeight:"400"},children:"(This will appear as narration in invoice)"})]}),c.jsx("input",{type:"text",id:"svcType",placeholder:"e.g. PODCAST PRODUCTION, VIDEO EDITING, SOCIAL MEDIA MANAGEMENT",style:{width:"100%",padding:"8px",border:"1.5px solid #E2E8F0",borderRadius:"6px",textTransform:"uppercase"}})]}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[c.jsxs("div",{children:[c.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:"600",marginBottom:"4px"},children:"Email"}),c.jsx("input",{type:"email",id:"svcEmail",placeholder:"email@example.com",style:{width:"100%",padding:"8px",border:"1.5px solid #E2E8F0",borderRadius:"6px"}})]}),c.jsxs("div",{children:[c.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:"600",marginBottom:"4px"},children:"Amount (without GST)"}),c.jsx("input",{type:"number",id:"svcAmount",placeholder:"0",style:{width:"100%",padding:"8px",border:"1.5px solid #E2E8F0",borderRadius:"6px"}})]})]}),c.jsxs("div",{style:{display:"flex",gap:"12px",marginTop:"8px"},children:[c.jsx(Xe,{label:"Cancel",variant:"secondary",onClick:()=>Y(!1)}),c.jsx(Xe,{label:"Add Entry",icon:md,onClick:()=>{var se,fe,we,Ze,ce,ie,ee,Te,Je;const V=(fe=(se=document.getElementById("svcParty"))==null?void 0:se.value)==null?void 0:fe.trim(),b=(ce=(Ze=(we=document.getElementById("svcType"))==null?void 0:we.value)==null?void 0:Ze.trim())==null?void 0:ce.toUpperCase();if(!V||!b){alert("Fill required fields (Party Name and Type of Service)");return}const z={id:Date.now().toString(),sno:Wr.length+1,date:((ie=document.getElementById("svcDate"))==null?void 0:ie.value)||new Date().toISOString().split("T")[0],statePartyDetails:((ee=document.getElementById("svcState"))==null?void 0:ee.value)||"",partyName:V,serviceType:b,emailId:((Te=document.getElementById("svcEmail"))==null?void 0:Te.value)||"",additionalEmails:[],toBeBilled:"Not Yet",invoiceAmount:((Je=document.getElementById("svcAmount"))==null?void 0:Je.value)||"",cgst:"",sgst:"",igst:"",totalWithGst:"",invoiceType:"Individual",invoiceNo:"",invoiceDate:"",invoiceTotalAmount:"",invoiceGenerated:!1,invoiceStatus:"Pending",mailingSent:"No",mailDate:"",mailerUploaded:!1,editComments:"",approvalRemarks:"",isService:!0};ke(lt=>[...lt,z]),he(lt=>new Set([...lt,V])),Y(!1)}})]})]})})]})},U4=h=>{const _=[],U=b=>{if(!b)return"";const z=b.split("/");return z.length>=3?z.slice(1).join("/"):z.length===2?z.join("/"):z[z.length-1]},Q=$n.filter(b=>{var z;return b.isHistorical&&(b.type==="creditnote"||((z=b.vchNo)==null?void 0:z.toUpperCase().startsWith("CN")))}),B=new Map;ni.forEach(b=>{const z=U(b.invoiceNo);z&&B.set(z,{...b,isSystemCN:!0})}),Q.forEach(b=>{const z=U(b.vchNo);z&&!B.has(z)&&B.set(z,{...b,isHistoricalCN:!0})});const oe={};h.forEach(b=>{const z=b.partyName||"Unknown";oe[z]||(oe[z]=[]),oe[z].push(b)}),Object.keys(oe).sort().forEach(b=>{oe[b].forEach(se=>{const fe=U(se.invoiceNo),we=B.get(fe),Ze=we?Math.abs(parseFloat(we.totalAmount||we.credit||we.debit)||0):0,ce=$r.filter(ot=>ot.invoiceNo===se.invoiceNo),ie=ce.reduce((ot,vt)=>ot+(parseFloat(vt.amount)||0),0),ee=ce.reduce((ot,vt)=>ot+(parseFloat(vt.tds||vt.tdsAmount)||0),0),Te=se.totalAmount-ie-ee-Ze;let Je="Pending";Ze>=se.totalAmount?Je="Cancelled":Te<=0?Je="Paid":(ie>0||ee>0||Ze>0)&&(Je="Partial");let lt=se.poStatus==="With PO"?`${se.poNumber||""}${se.poDate?`
`+St(se.poDate):""}`:"Without PO";_.push({"Client Code":se.clientCode||"","Party Name":b,"Invoice No":se.invoiceNo,Date:St(se.date),Type:se.isService?"Service":se.invoiceType||"Individual","PO?":lt,Amount:se.totalAmount,Received:ie||"",TDS:ee||"","CN Amount":Ze||"",Balance:Te>0?Te:0,"Invoice Status":se.invoiceStatus,"Receipt Status":Je,"Receipt No":ce.map(ot=>ot.receiptNo).join(", "),"CN No":we?we.isSystemCN?we.creditNoteNo:we.vchNo:""})})});const L=Er.json_to_sheet(_),V=Er.book_new();Er.book_append_sheet(V,L,"Invoice Register"),Pc(V,`Invoice_Register_${new Date().toISOString().split("T")[0]}.xlsx`)},V4=()=>{const h=Er.book_new();let _=0;const U=Q=>{if(!Q)return"";const B=Q.split("/");return B.length>=3?B.slice(1).join("/"):B.length===2?B.join("/"):B[B.length-1]};if(d.forEach(Q=>{const B=Q.partyName,oe=Q.normalizedState,L=Q.clientCode||"",V=Wn[B]||0,b=ae=>L?(ae.clientCode||Br(ae.partyName,ae.statePartyDetails))===L:!0,z=[...wn,...Wr].filter(ae=>$t(ae.partyName,B)&&ae.invoiceGenerated&&ae.invoiceStatus==="Approved"&&b(ae)&&(!oe||ii(ae.statePartyDetails)===oe)),se=new Map;z.forEach(ae=>{se.has(ae.invoiceNo)?se.get(ae.invoiceNo).campaigns.push(ae):se.set(ae.invoiceNo,{invoiceNo:ae.invoiceNo,invoiceDate:ae.invoiceDate,campaigns:[ae],statePartyDetails:ae.statePartyDetails})});const fe=new Set(Array.from(se.keys())),we=$r.filter(ae=>$t(ae.partyName,B)&&(!oe||fe.has(ae.invoiceNo))),Ze=ni.filter(ae=>$t(ae.partyName,B)&&(!oe||fe.has(ae.invoiceNo))),ce=oe?[]:$n.filter(ae=>{var Qe;return $t(ae.partyName,B)&&ae.isHistorical&&!((Qe=ae.vchNo)!=null&&Qe.toUpperCase().startsWith("CN"))}),ie=oe?[]:$n.filter(ae=>{var Qe;return $t(ae.partyName,B)&&ae.isHistorical&&((Qe=ae.vchNo)==null?void 0:Qe.toUpperCase().startsWith("CN"))}),ee=new Map;Ze.forEach(ae=>{const Qe=U(ae.invoiceNo);Qe&&ee.set(Qe,{...ae,isSystemCN:!0})}),ie.forEach(ae=>{const Qe=U(ae.vchNo);Qe&&!ee.has(Qe)&&ee.set(Qe,ae)});const Te=[];let Je=V,lt=0,ot=0,vt=0,ut=0;const Ot=new Set;Te.push([L?`[${L}] ${B}`:B]),Te.push(["Ledger Account"]),Q.address&&Te.push([Q.address]),Q.state&&Te.push([Q.state]),Q.gstin&&Te.push(["GSTIN: "+Q.gstin]),Te.push([]),Te.push(["Date","Particular","Vch Type","Vch No.","Debit","Credit","Date of Receipt","Amount Received","TDS Received","Balance","Payment Status"]),V!==0&&(Te.push(["","Opening Balance","","",V>0?V:"",V<0?Math.abs(V):"","","","",V,""]),V>0?lt+=V:ot+=Math.abs(V));const ze=[];if(Array.from(se.values()).forEach(ae=>{ze.push({...ae,entryType:"invoice",sortDate:ae.invoiceDate})}),ce.forEach(ae=>{ze.push({...ae,entryType:"historical",sortDate:ae.date})}),ze.sort((ae,Qe)=>new Date(ae.sortDate)-new Date(Qe.sortDate)),ze.forEach(ae=>{var Qe;if(ae.entryType==="invoice"){const ht=ae,Vt=ht.campaigns.reduce((Fr,pn)=>Fr+(parseFloat(pn.invoiceAmount)||0),0),dt=(Qe=ht.statePartyDetails)==null?void 0:Qe.toUpperCase().includes("MAHARASHTRA"),Xt=dt?Vt*.09:0,qt=dt?Vt*.09:0,Zt=dt?0:Vt*.18,jr=Vt+Xt+qt+Zt,wr=we.filter(Fr=>Fr.invoiceNo===ht.invoiceNo),dr=wr.reduce((Fr,pn)=>Fr+(parseFloat(pn.amount)||0),0),Hr=wr.reduce((Fr,pn)=>Fr+(parseFloat(pn.tds||pn.tdsAmount)||0),0),jt=wr.length>0?St(wr[0].date):"",Gr=U(ht.invoiceNo),er=ee.get(Gr),Hn=er?Math.abs(parseFloat(er.totalAmount||er.credit)||0):0,hn=!!er;let Gn="Pending",Es=jr-dr-Hr;if(hn&&Hn>=jr?(Gn="CN Closed",Es=0):(dr>0||Hr>0)&&(Gn="Received"),Je+=jr,lt+=jr,Te.push([St(ht.invoiceDate),B,"Sales",ht.invoiceNo,jr,"",jt,dr||"",Hr||"",hn?"-":Es,Gn]),Te.push(["","    PROMOTIONAL TRADE EMAILER"+(ht.campaigns.length>1?"S":""),"","","",Vt,"","","","",""]),dt?(Te.push(["","    CGST","","","",Xt,"","","","",""]),Te.push(["","    SGST","","","",qt,"","","","",""])):Te.push(["","    IGST","","","",Zt,"","","","",""]),(dr>0||Hr>0)&&(Je-=dr+Hr,vt+=dr,ut+=Hr),er&&!Ot.has(Gr)){Ot.add(Gr),Je-=Hn,ot+=Hn,Te.push([St(er.date),B,"Credit Note",er.creditNoteNo||er.vchNo,"",Hn,"","","","-",""]);const Fr=Hn/1.18,pn=Hn-Fr;Te.push(["","    PROMOTIONAL TRADE EMAILER","","","",Fr,"","","","",""]),dt?Te.push(["","    CGST/SGST","","","",pn,"","","","",""]):Te.push(["","    IGST","","","",pn,"","","","",""])}}else if(ae.entryType==="historical"){const ht=ae,Vt=parseFloat(ht.debit)||0,dt=U(ht.vchNo),Xt=ee.get(dt),qt=!!Xt;if(Je+=Vt,lt+=Vt,Te.push([St(ht.date),ht.particular||B,ht.vchType||"Sales",ht.vchNo||"",Vt,"",ht.receiptDate?St(ht.receiptDate):"",ht.amountReceived||"",ht.tdsReceived||"",qt?"-":Je,qt?"CN Closed":ht.paymentStatus||""]),Xt&&!Ot.has(dt)){Ot.add(dt);const Zt=Math.abs(parseFloat(Xt.totalAmount||Xt.credit||Xt.debit)||0);Je-=Zt,ot+=Zt,Te.push([St(Xt.date),B,"Credit Note",Xt.creditNoteNo||Xt.vchNo,"",Zt,"","","","-",""])}}}),Te.length<=7)return;Te.push([]),Te.push(["","TOTAL","","",lt,ot,"",vt,ut,"",""]),Te.push(["","Closing Balance","","",Je>0?Je:"",Je<0?Math.abs(Je):"","","","",Je,""]);let rt=B.substring(0,25).replace(/[\\\/\*\?\[\]:]/g,"");oe&&(rt+="-"+oe.substring(0,4));let Mt=rt,me=1;for(;h.SheetNames.includes(Mt);)Mt=rt.substring(0,27)+me++;const Pe=Er.aoa_to_sheet(Te);Er.book_append_sheet(h,Pe,Mt),_++}),_===0){alert("No ledger data to export");return}Pc(h,`All_Ledgers_${new Date().toISOString().split("T")[0]}.xlsx`)},z4=()=>{const h=L=>{const V=parseFloat(L.totalAmount)||0;let b=parseFloat(L.baseAmount)||parseFloat(L.amount)||0,z=parseFloat(L.gst)||(parseFloat(L.cgstAmount)||0)+(parseFloat(L.sgstAmount)||0)+(parseFloat(L.igstAmount)||0);return b===0&&V>0&&(b=V/1.18,z=V-b),{base:b,gst:z,total:V}},_=$r.map(L=>{const V=parseFloat(L.amount)||0,b=parseFloat(L.tds)||parseFloat(L.tdsAmount)||0;return{Type:"Receipt","Client Code":L.clientCode||Br(L.partyName,L.statePartyDetails||""),"Voucher No":L.receiptNo,Date:St(L.date),"Party Name":L.partyName,"Against Invoice":L.invoiceNo,Amount:V,TDS:b,Total:V+b,"Payment Mode":L.paymentMode||L.mode||"Bank Transfer",Narration:L.narration||""}}),U=ni.map(L=>{const V=h(L);return{Type:"Credit Note","Client Code":L.clientCode||Br(L.partyName,L.statePartyDetails||""),"Voucher No":L.creditNoteNo,Date:St(L.date),"Party Name":L.partyName,"Against Invoice":L.invoiceNo,"Base Amount":V.base,GST:V.gst,Total:V.total,Reason:L.reason||""}}),Q=Er.book_new();if(_.length>0){const L=Er.json_to_sheet(_);Er.book_append_sheet(Q,L,"Receipts")}if(U.length>0){const L=Er.json_to_sheet(U);Er.book_append_sheet(Q,L,"Credit Notes")}const B=[..._.map(L=>({...L,"Base Amount":"",GST:"",Reason:""})),...U.map(L=>({Type:L.Type,"Client Code":L["Client Code"],"Voucher No":L["Voucher No"],Date:L.Date,"Party Name":L["Party Name"],"Against Invoice":L["Against Invoice"],Amount:L["Base Amount"],TDS:L.GST,Total:L.Total,"Payment Mode":"",Narration:L.Reason}))],oe=Er.json_to_sheet(B);Er.book_append_sheet(Q,oe,"Combined"),Pc(Q,`Receipt_CN_Register_${new Date().toISOString().split("T")[0]}.xlsx`)},W4=h=>{const _=parseFloat(h.amount)||0,U=parseFloat(h.tds)||parseFloat(h.tdsAmount)||0,Q=_+U,B=h.clientCode||Br(h.partyName,h.statePartyDetails||""),oe=`<!DOCTYPE html><html><head><title>Receipt - ${h.receiptNo}</title><style>@media print{@page{size:A5;margin:10mm}}*{margin:0;padding:0;box-sizing:border-box}body{font-family:Arial,sans-serif;font-size:12px;padding:20px}.voucher{max-width:600px;margin:0 auto;border:2px solid #000}.header{text-align:center;padding:15px;border-bottom:2px solid #000;background:#f5f5f5}.title{font-size:18px;font-weight:bold;color:#1a5276}.company{font-size:14px;font-weight:bold;margin-top:5px}.details{padding:15px}.row{display:flex;margin-bottom:10px}.label{width:140px;font-weight:bold}.value{flex:1}.amount-box{background:#e8f4fd;padding:15px;margin:15px 0;border-radius:8px;text-align:center}.amount{font-size:24px;font-weight:bold;color:#1a5276}.footer{padding:15px;border-top:1px solid #ddd;display:flex;justify-content:space-between}.signature{text-align:center;margin-top:40px}.signature-line{border-top:1px solid #000;width:150px;margin:0 auto;padding-top:5px}.client-code{background:#f3e8ff;color:#6b21a8;padding:3px 8px;border-radius:4px;font-weight:bold;font-size:11px}</style></head><body><div class="voucher"><div class="header"><div class="title">RECEIPT VOUCHER</div><div class="company">${w.name}</div><div style="font-size:10px;color:#666;margin-top:3px">${w.address}, ${w.city}</div></div><div class="details"><div class="row"><div class="label">Receipt No:</div><div class="value" style="font-weight:bold;color:#1a5276">${h.receiptNo}</div></div><div class="row"><div class="label">Date:</div><div class="value">${St(h.date)}</div></div>${B?`<div class="row"><div class="label">Client Code:</div><div class="value"><span class="client-code">${B}</span></div></div>`:""}<div class="row"><div class="label">Received From:</div><div class="value" style="font-weight:bold">${h.partyName}</div></div><div class="row"><div class="label">Against Invoice:</div><div class="value">${h.invoiceNo}</div></div><div class="row"><div class="label">Payment Mode:</div><div class="value">${h.paymentMode||h.mode||"Bank Transfer"}</div></div>${h.narration?`<div class="row"><div class="label">Narration:</div><div class="value">${h.narration}</div></div>`:""}<div class="amount-box"><div style="font-size:12px;color:#666">Amount Received</div><div class="amount">${_.toLocaleString("en-IN",{minimumFractionDigits:2})}</div>${U>0?`<div style="font-size:11px;color:#666;margin-top:5px">TDS: ${U.toLocaleString("en-IN",{minimumFractionDigits:2})}</div>`:""}<div style="font-size:11px;margin-top:8px"><strong>Total:</strong> ${Q.toLocaleString("en-IN",{minimumFractionDigits:2})}</div></div><div style="font-size:11px;color:#666;margin-top:10px"><strong>Amount in words:</strong> ${nh(Q)}</div></div><div class="footer"><div class="signature"><div class="signature-line">Receiver's Signature</div></div><div class="signature"><div class="signature-line">Authorised Signatory</div></div></div></div></body></html>`,L=window.open("","_blank");L.document.write(oe),L.document.close(),L.print()},$4=h=>{const _=parseFloat(h.totalAmount)||0;let U=parseFloat(h.baseAmount)||parseFloat(h.amount)||0,Q=parseFloat(h.gst)||(parseFloat(h.cgstAmount)||0)+(parseFloat(h.sgstAmount)||0)+(parseFloat(h.igstAmount)||0);U===0&&_>0&&(U=_/1.18,Q=_-U);const B=h.clientCode||Br(h.partyName,h.statePartyDetails||""),oe=`<!DOCTYPE html><html><head><title>CN - ${h.creditNoteNo}</title><style>@media print{@page{size:A5;margin:10mm}}*{margin:0;padding:0;box-sizing:border-box}body{font-family:Arial,sans-serif;font-size:12px;padding:20px}.voucher{max-width:600px;margin:0 auto;border:2px solid #000}.header{text-align:center;padding:15px;border-bottom:2px solid #000;background:#fef3c7}.title{font-size:18px;font-weight:bold;color:#92400e}.company{font-size:14px;font-weight:bold;margin-top:5px}.details{padding:15px}.row{display:flex;margin-bottom:10px}.label{width:140px;font-weight:bold}.value{flex:1}.amount-box{background:#fef3c7;padding:15px;margin:15px 0;border-radius:8px;text-align:center}.amount{font-size:24px;font-weight:bold;color:#92400e}.footer{padding:15px;border-top:1px solid #ddd;display:flex;justify-content:space-between}.signature{text-align:center;margin-top:40px}.signature-line{border-top:1px solid #000;width:150px;margin:0 auto;padding-top:5px}.client-code{background:#f3e8ff;color:#6b21a8;padding:3px 8px;border-radius:4px;font-weight:bold;font-size:11px}</style></head><body><div class="voucher"><div class="header"><div class="title">CREDIT NOTE</div><div class="company">${w.name}</div><div style="font-size:10px;color:#666;margin-top:3px">${w.address}, ${w.city}</div></div><div class="details"><div class="row"><div class="label">Credit Note No:</div><div class="value" style="font-weight:bold;color:#92400e">${h.creditNoteNo}</div></div><div class="row"><div class="label">Date:</div><div class="value">${St(h.date)}</div></div>${B?`<div class="row"><div class="label">Client Code:</div><div class="value"><span class="client-code">${B}</span></div></div>`:""}<div class="row"><div class="label">Party Name:</div><div class="value" style="font-weight:bold">${h.partyName}</div></div><div class="row"><div class="label">Against Invoice:</div><div class="value">${h.invoiceNo}</div></div><div class="row"><div class="label">Reason:</div><div class="value">${h.reason||"Adjustment"}</div></div><div class="amount-box"><div style="font-size:12px;color:#666">Credit Amount</div><div class="amount">${_.toLocaleString("en-IN",{minimumFractionDigits:2})}</div><div style="font-size:10px;color:#666;margin-top:5px">Base: ${U.toLocaleString("en-IN",{minimumFractionDigits:2})} | GST: ${Q.toLocaleString("en-IN",{minimumFractionDigits:2})}</div></div><div style="font-size:11px;color:#666;margin-top:10px"><strong>Amount in words:</strong> ${nh(_)}</div></div><div class="footer"><div class="signature"><div class="signature-line">Party Signature</div></div><div class="signature"><div class="signature-line">Authorised Signatory</div></div></div></div></body></html>`,L=window.open("","_blank");L.document.write(oe),L.document.close(),L.print()},H4=()=>{const h=new Map;wn.filter(z=>z.invoiceGenerated).forEach(z=>{if(h.has(z.invoiceNo))h.get(z.invoiceNo).campaigns.push(z);else{const se=z.clientCode||Br(z.partyName,z.statePartyDetails);h.set(z.invoiceNo,{invoiceNo:z.invoiceNo,partyName:z.partyName,clientCode:se,statePartyDetails:z.statePartyDetails,date:z.invoiceDate,invoiceType:z.invoiceType,combinationCode:z.combinationCode,invoiceStatus:z.invoiceStatus,mailingSent:z.mailingSent,receiptStatus:z.receiptStatus||"Pending",receiptNo:z.receiptNo,campaigns:[z],totalAmount:parseFloat(z.invoiceTotalAmount)||0,isFromMaster:!0,source:"Campaign",poStatus:z.poStatus,poNumber:z.poNumber,poDate:z.poDate})}}),Wr.filter(z=>z.invoiceGenerated).forEach(z=>{if(!h.has(z.invoiceNo)){const se=z.clientCode||Br(z.partyName,z.statePartyDetails);h.set(z.invoiceNo,{invoiceNo:z.invoiceNo,partyName:z.partyName,clientCode:se,statePartyDetails:z.statePartyDetails,date:z.invoiceDate,invoiceType:"Service",combinationCode:"NA",invoiceStatus:z.invoiceStatus,mailingSent:z.mailingSent,receiptStatus:z.receiptStatus||"Pending",receiptNo:z.receiptNo,campaigns:[z],totalAmount:parseFloat(z.invoiceTotalAmount)||0,isFromMaster:!1,isService:!0,source:"Service",serviceType:z.serviceType,poStatus:z.poStatus,poNumber:z.poNumber,poDate:z.poDate})}});const _=z=>{if(!z)return"";const se=z.split("/");return se.length>=3?se.slice(1).join("/"):se.length===2?se.join("/"):se[se.length-1]},U=$n.filter(z=>{var se;return z.isHistorical&&(z.type==="creditnote"||((se=z.vchNo)==null?void 0:se.toUpperCase().startsWith("CN")))}),Q=new Map;ni.forEach(z=>{const se=_(z.invoiceNo);se&&Q.set(se,z)}),U.forEach(z=>{const se=_(z.vchNo);se&&!Q.has(se)&&Q.set(se,z)}),$n.filter(z=>{var se;return z.isHistorical&&z.type!=="creditnote"&&!((se=z.vchNo)!=null&&se.toUpperCase().startsWith("CN"))&&z.debit>0}).forEach(z=>{if(!h.has(z.vchNo)){const se=$r.find(Je=>Je.invoiceNo===z.vchNo),fe=_(z.vchNo),we=Q.get(fe),Ze=we?Math.abs(parseFloat(we.totalAmount)||parseFloat(we.credit)||parseFloat(we.debit)||0):0,ce=parseFloat(z.debit)||0;if(we&&Ze>=ce)return;const ee=!se&&!(z.amountReceived>0),Te=we&&Ze>0&&Ze<ce;if(ee||Te){const Je=Te?ce-Ze:ce;h.set(z.vchNo,{invoiceNo:z.vchNo,partyName:z.partyName,date:z.date,invoiceType:"Historical",combinationCode:"",invoiceStatus:"Approved",mailingSent:"Yes",receiptStatus:Te?"Partial CN":"Pending",receiptNo:"",campaigns:[],totalAmount:ce,pendingAmount:Je,hasPartialCN:Te,cnAmount:Ze,isHistorical:!0,historicalEntry:z})}}});let B=Array.from(h.values());if(Ue.party&&(B=B.filter(z=>$t(z.partyName,Ue.party))),Ue.invoiceStatus&&(B=B.filter(z=>z.invoiceStatus===Ue.invoiceStatus)),Ue.receiptStatus&&(Ue.receiptStatus==="Received"?B=B.filter(z=>z.receiptStatus==="Received"):Ue.receiptStatus==="Pending"&&(B=B.filter(z=>z.receiptStatus!=="Received"))),Ue.invoiceType&&(B=B.filter(z=>z.invoiceType===Ue.invoiceType)),Ue.searchText){const z=Ue.searchText.toLowerCase();B=B.filter(se=>{var fe,we;return((fe=se.invoiceNo)==null?void 0:fe.toLowerCase().includes(z))||((we=se.partyName)==null?void 0:we.toLowerCase().includes(z))})}const oe={};B.forEach(z=>{const se=z.clientCode||"",fe=`${z.partyName}|||${se}`;oe[fe]||(oe[fe]={partyName:z.partyName,clientCode:se,invoices:[]}),oe[fe].invoices.push(z)});const L=Object.values(oe).sort((z,se)=>{const fe=z.partyName.localeCompare(se.partyName);return fe!==0?fe:(z.clientCode||"").localeCompare(se.clientCode||"")}),V=Ue.party||Ue.invoiceStatus||Ue.receiptStatus||Ue.invoiceType||Ue.searchText,b=Array.from(h.values());return c.jsxs("div",{children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[c.jsx("h1",{style:{margin:0,fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:" Invoice & Receipt Register"}),c.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[c.jsx(Xe,{icon:Po,label:"Export Excel",variant:"secondary",onClick:()=>U4(B)}),si&&c.jsx("span",{style:{padding:"8px 16px",backgroundColor:"#FEF3C7",borderRadius:"8px",fontSize:"13px",color:"#92400E",fontWeight:"600"},children:" View Only"})]})]}),c.jsx("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"10px",border:"1px solid #E2E8F0",padding:"14px 18px",marginBottom:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"14px",flexWrap:"wrap"},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[c.jsx(gd,{size:18,color:"#64748B"}),c.jsx("span",{style:{fontSize:"13px",fontWeight:"700",color:"#475569"},children:"Filters:"})]}),c.jsxs("div",{style:{position:"relative"},children:[c.jsx(Q0,{size:14,style:{position:"absolute",left:"10px",top:"50%",transform:"translateY(-50%)",color:"#94A3B8"}}),c.jsx("input",{type:"text",placeholder:"Search invoice...",value:Ue.searchText,onChange:z=>Me(se=>({...se,searchText:z.target.value})),style:{padding:"8px 12px 8px 32px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",width:"160px"}})]}),c.jsxs("select",{value:Ue.party,onChange:z=>Me(se=>({...se,party:z.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:"#FFFFFF"},children:[c.jsx("option",{value:"",children:"All Parties"}),$s.map(z=>c.jsx("option",{value:z,children:z},z))]}),c.jsxs("select",{value:Ue.invoiceStatus,onChange:z=>Me(se=>({...se,invoiceStatus:z.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:"#FFFFFF"},children:[c.jsx("option",{value:"",children:"All Status"}),c.jsx("option",{value:"Created",children:"Created"}),c.jsx("option",{value:"Approved",children:"Approved"}),c.jsx("option",{value:"Need Edits",children:"Need Edits"})]}),c.jsxs("select",{value:Ue.receiptStatus,onChange:z=>Me(se=>({...se,receiptStatus:z.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:"#FFFFFF"},children:[c.jsx("option",{value:"",children:"All Receipts"}),c.jsx("option",{value:"Received",children:"Received"}),c.jsx("option",{value:"Pending",children:"Pending"})]}),c.jsxs("select",{value:Ue.invoiceType,onChange:z=>Me(se=>({...se,invoiceType:z.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:"#FFFFFF"},children:[c.jsx("option",{value:"",children:"All Types"}),c.jsx("option",{value:"Individual",children:"Individual"}),c.jsx("option",{value:"Combined",children:"Combined"})]}),V&&c.jsxs(c.Fragment,{children:[c.jsxs("button",{onClick:()=>Me({party:"",invoiceStatus:"",receiptStatus:"",invoiceType:"",searchText:""}),style:{padding:"8px 12px",fontSize:"13px",fontWeight:"600",border:"1.5px solid #FCA5A5",borderRadius:"8px",backgroundColor:"#FEE2E2",color:"#991B1B",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},children:[c.jsx(wa,{size:14})," Clear"]}),c.jsxs("span",{style:{fontSize:"13px",color:"#64748B"},children:["Showing ",B.length," of ",b.length]})]})]})}),c.jsx(mn,{noPadding:!0,children:c.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"12px"},children:[c.jsx("thead",{children:c.jsxs("tr",{style:{backgroundColor:"#F8FAFC",borderBottom:"2px solid #E2E8F0"},children:[c.jsx("th",{style:{padding:"10px 12px",textAlign:"left",fontWeight:"700"},children:"Invoice No"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700",color:"#6B21A8",backgroundColor:"#FAF5FF"},children:"Code"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"left",fontWeight:"700"},children:"Date"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Type"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700"},children:"Amount"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700",backgroundColor:"#F0FDF4",color:"#166534"},children:"Received"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700",backgroundColor:"#FEF3C7",color:"#92400E"},children:"TDS"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700",backgroundColor:"#FEE2E2",color:"#991B1B"},children:"CN Amt"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700",backgroundColor:"#EFF6FF",color:"#1E40AF"},children:"Balance"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Inv. Status"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Receipt No."}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"CN No."}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Actions"})]})}),c.jsx("tbody",{children:L.length===0?c.jsx("tr",{children:c.jsx("td",{colSpan:"13",style:{padding:"50px",textAlign:"center",color:"#94A3B8"},children:V?"No matching invoices":"No invoices generated yet"})}):L.map((z,se)=>{const{partyName:fe,clientCode:we,invoices:Ze}=z,ce=`${fe}|||${we}`,ie=u0.has(ce);let ee=0;return Ze.forEach(Te=>{const Je=je.find(Pe=>Pe.invoiceNo===Te.invoiceNo),lt=te.find(Pe=>Pe.invoiceNo===Te.invoiceNo),ot=ne.find(Pe=>Pe.invoiceNo===Te.invoiceNo&&Pe.type==="tds"),vt=ne.find(Pe=>Pe.invoiceNo===Te.invoiceNo&&Pe.type==="discount"),ut=Te.totalAmount||0,Ot=Je&&parseFloat(Je.amount)||0,ze=ot?parseFloat(ot.credit)||0:Je&&parseFloat(Je.tds)||0,rt=lt?Math.abs(parseFloat(lt.totalAmount)||0):0,Mt=vt&&parseFloat(vt.credit)||0,me=Math.max(0,ut-Ot-ze-rt-Mt);ee+=me}),c.jsxs(oh.Fragment,{children:[c.jsxs("tr",{onClick:()=>Cy(ce),style:{backgroundColor:"#1E3A5F",color:"white",cursor:"pointer",borderBottom:"1px solid #0F2744"},children:[c.jsx("td",{colSpan:"4",style:{padding:"10px 12px",fontWeight:"700",fontSize:"13px"},children:c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[ie?c.jsx(nm,{size:18}):c.jsx(K0,{size:18}),c.jsx(aE,{size:16}),fe,we&&c.jsx("span",{style:{backgroundColor:"#9333EA",padding:"2px 8px",borderRadius:"6px",fontSize:"11px"},children:we}),c.jsxs("span",{style:{backgroundColor:"#2874A6",padding:"2px 10px",borderRadius:"12px",fontSize:"11px",fontWeight:"600"},children:[Ze.length," inv"]})]})}),c.jsx("td",{colSpan:"4",style:{padding:"10px 12px"}}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700",fontSize:"13px",backgroundColor:ee===0?"#22C55E":"#3B82F6"},children:ee===0?" Nil":`Bal: ${nt(ee)}`}),c.jsx("td",{colSpan:"4",style:{padding:"10px 12px"}})]}),ie&&Ze.map(Te=>{const Je=je.find(ae=>ae.invoiceNo===Te.invoiceNo),lt=te.find(ae=>ae.invoiceNo===Te.invoiceNo),ot=ne.find(ae=>ae.invoiceNo===Te.invoiceNo&&ae.type==="tds"),vt=ne.find(ae=>ae.invoiceNo===Te.invoiceNo&&ae.type==="discount"),ut=Te.totalAmount||0,Ot=Je&&parseFloat(Je.amount)||0,ze=ot?parseFloat(ot.credit)||0:Je&&parseFloat(Je.tds)||0,rt=lt?Math.abs(parseFloat(lt.totalAmount)||0):0,Mt=vt&&parseFloat(vt.credit)||0,me=Math.max(0,ut-Ot-ze-rt-Mt),Pe=rt>=ut&&!Je;return c.jsxs("tr",{style:{borderBottom:"1px solid #F1F5F9",backgroundColor:Te.invoiceType==="Combined"?"#FAF5FF":me===0?"#F0FDF4":"transparent"},children:[c.jsx("td",{style:{padding:"10px 12px 10px 36px",fontWeight:"700",color:Te.invoiceType==="Combined"?"#7C3AED":"#2874A6"},children:Te.invoiceNo}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"center",backgroundColor:"#FAF5FF"},children:c.jsx("span",{style:{fontWeight:"700",color:"#6B21A8",fontSize:"11px"},children:Te.clientCode||"-"})}),c.jsx("td",{style:{padding:"10px 12px"},children:St(Te.date)}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:c.jsx(vm,{status:Te.invoiceType,small:!0})}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700"},children:nt(ut)}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"600",backgroundColor:"#F0FDF4",color:Ot>0?"#166534":"#94A3B8"},children:Ot>0?nt(Ot):"-"}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"600",backgroundColor:"#FEF3C7",color:ze>0?"#92400E":"#94A3B8"},children:ze>0?nt(ze):"-"}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"600",backgroundColor:"#FEE2E2",color:rt>0?"#991B1B":"#94A3B8"},children:rt>0?nt(rt):"-"}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700",backgroundColor:"#EFF6FF",color:me>0?"#1E40AF":"#166534"},children:me===0?" Nil":nt(me)}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:c.jsx(vm,{status:Te.invoiceStatus,small:!0})}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:Pe?c.jsx("span",{style:{padding:"4px 10px",borderRadius:"12px",fontSize:"11px",fontWeight:"700",backgroundColor:"#FEE2E2",color:"#991B1B"},children:" Cancelled"}):Je?c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px",justifyContent:"center"},children:[c.jsxs("button",{onClick:()=>m4(Je),style:{padding:"4px 8px",borderRadius:"12px",fontSize:"10px",fontWeight:"700",backgroundColor:"#DCFCE7",color:"#166534",border:"none",cursor:"pointer",textDecoration:"underline"},title:"Click to view receipt",children:[" ",Je.receiptNo]}),_r&&c.jsx("button",{onClick:()=>t4(Je),style:{padding:"2px 4px",borderRadius:"4px",fontSize:"10px",backgroundColor:"#FEE2E2",color:"#991B1B",border:"none",cursor:"pointer"},title:"Delete Receipt",children:""})]}):c.jsx("span",{style:{padding:"4px 10px",borderRadius:"12px",fontSize:"11px",fontWeight:"600",backgroundColor:"#FEF3C7",color:"#92400E"},children:" Pending"})}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:lt?c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px",justifyContent:"center"},children:[c.jsx("button",{onClick:()=>x4(lt),style:{padding:"4px 8px",borderRadius:"12px",fontSize:"10px",fontWeight:"700",backgroundColor:"#FEE2E2",color:"#991B1B",border:"none",cursor:"pointer",textDecoration:"underline"},title:"Click to view credit note",children:lt.creditNoteNo}),_r&&c.jsx("button",{onClick:()=>r4(lt),style:{padding:"2px 4px",borderRadius:"4px",fontSize:"10px",backgroundColor:"#FEE2E2",color:"#991B1B",border:"none",cursor:"pointer"},title:"Delete Credit Note",children:""})]}):c.jsx("span",{style:{color:"#94A3B8",fontSize:"11px"},children:"-"})}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:c.jsx("div",{style:{display:"flex",gap:"4px",justifyContent:"center",flexWrap:"wrap"},children:Te.isHistorical?c.jsxs(c.Fragment,{children:[_r&&!Je&&c.jsx(Xe,{icon:Oo,small:!0,variant:"success",onClick:()=>{const ae={invoiceNo:Te.invoiceNo,partyName:Te.partyName,invoiceDate:Te.date,invoiceTotalAmount:Te.totalAmount,invoiceStatus:"Approved",mailingSent:"Yes",invoiceType:"Historical",isHistorical:!0};Vi(ae)},title:"Create Receipt"}),_r&&!lt&&c.jsx(Xe,{icon:pd,small:!0,variant:"primary",onClick:()=>{const ae={invoiceNo:Te.invoiceNo,partyName:Te.partyName,invoiceDate:Te.date,invoiceTotalAmount:Te.totalAmount,invoiceStatus:"Approved",isHistorical:!0};Fc(ae)},title:"Credit Note"})]}):c.jsxs(c.Fragment,{children:[c.jsx(Xe,{icon:Oc,small:!0,variant:"brand",onClick:()=>{Te.isService||Te.invoiceType==="Service"?nd(Te.campaigns[0]):td(Te.campaigns[0])},title:"View Invoice"}),_r&&Te.invoiceStatus==="Approved"&&Te.mailingSent==="Yes"&&!Je&&c.jsx(Xe,{icon:Oo,small:!0,variant:"success",onClick:()=>Vi(Te.campaigns[0]),title:"Create Receipt"}),_r&&Te.invoiceStatus==="Approved"&&!lt&&c.jsx(Xe,{icon:pd,small:!0,variant:"primary",onClick:()=>Fc(Te.campaigns[0]),title:"Credit Note"}),_r&&c.jsx(Xe,{icon:rs,small:!0,variant:"danger",onClick:()=>pg(Te.campaigns[0]),title:"Delete Invoice"})]})})})]},Te.invoiceNo)})]},ce)})})]})})]})},G4=()=>{if(!X){alert("Please select a party first");return}const h=Wn[X]||0,_=Se.filter(me=>$t(me.partyName,X)&&me.invoiceGenerated&&me.invoiceStatus==="Approved"&&(!Ce||ii(me.statePartyDetails)===Ce)),U=new Map;_.forEach(me=>{U.has(me.invoiceNo)?U.get(me.invoiceNo).campaigns.push(me):U.set(me.invoiceNo,{invoiceNo:me.invoiceNo,invoiceDate:me.invoiceDate,campaigns:[me],isFromMaster:!0})});const Q=new Set(Array.from(U.keys())),B=Ce?[]:ne.filter(me=>{var Pe;return $t(me.partyName,X)&&me.isHistorical&&me.type!=="creditnote"&&!((Pe=me.vchNo)!=null&&Pe.toUpperCase().startsWith("CN"))}),oe=Ce?[]:ne.filter(me=>{var Pe;return $t(me.partyName,X)&&me.isHistorical&&(me.type==="creditnote"||((Pe=me.vchNo)==null?void 0:Pe.toUpperCase().startsWith("CN")))}),L=je.filter(me=>$t(me.partyName,X)&&(!Ce||Q.has(me.invoiceNo))),V=te.filter(me=>$t(me.partyName,X)&&(!Ce||Q.has(me.invoiceNo))),b=me=>{if(!me)return"";const Pe=me.split("/");return Pe.length>=3?Pe.slice(1).join("/"):Pe.length===2?Pe.join("/"):Pe[Pe.length-1]},z=new Map;V.forEach(me=>{const Pe=b(me.invoiceNo);Pe&&!z.has(Pe)&&z.set(Pe,{...me,isSystemCN:!0})}),oe.forEach(me=>{const Pe=b(me.vchNo);Pe&&!z.has(Pe)&&z.set(Pe,{...me,isHistoricalCN:!0})});let se=[],fe=0,we=0,Ze=0,ce=0,ie=h;const ee=new Set;h!==0&&(fe+=h>0?h:0,we+=h<0?Math.abs(h):0,se.push({date:"",particular:"Opening Balance",vchType:"",vchNo:"",debit:h>0?h:0,credit:h<0?Math.abs(h):0,receiptDate:"",amountReceived:0,tds:0,balance:h,status:"",isMain:!0,isOpening:!0}));const Te=[];Array.from(U.values()).filter(me=>{const Pe=new Date(me.invoiceDate);return Pe>=new Date(Sn.fromDate)&&Pe<=new Date(Sn.toDate)}).forEach(me=>{Te.push({...me,entryType:"invoice",sortDate:me.invoiceDate})}),B.filter(me=>{if(!me.date)return!1;const Pe=new Date(me.date);return Pe>=new Date(Sn.fromDate)&&Pe<=new Date(Sn.toDate)}).forEach(me=>{Te.push({...me,entryType:"invoice",sortDate:me.date})}),Te.sort((me,Pe)=>new Date(me.sortDate)-new Date(Pe.sortDate)),Te.forEach(me=>{var Pe,ae;if(me.isFromMaster){const Qe=me;let ht=0;Qe.campaigns.forEach(hn=>ht+=parseFloat(hn.invoiceAmount)||0);const Vt=(ae=(Pe=Qe.campaigns[0])==null?void 0:Pe.statePartyDetails)==null?void 0:ae.toUpperCase().includes("MAHARASHTRA"),dt=Vt?ht*.09:0,Xt=Vt?ht*.09:0,qt=Vt?0:ht*.18,Zt=ht+dt+Xt+qt,jr=b(Qe.invoiceNo),wr=z.get(jr),dr=!!wr,Hr=L.find(hn=>hn.invoiceNo===Qe.invoiceNo);ie+=Zt,fe+=Zt;let jt=0,Gr=0,er="",Hn=dr?"":"Pending";if(Hr&&(Hn="Received",jt=Hr.amount||0,Gr=Hr.tds||0,er=Hr.date,Ze+=jt,ce+=Gr,ie-=jt+Gr+(Hr.discount||0)),se.push({date:Qe.invoiceDate,particular:X,vchType:"Sales",vchNo:Qe.invoiceNo,debit:Zt,credit:0,receiptDate:er,amountReceived:jt,tds:Gr,balance:dr?"-":Hn==="Received"?0:Zt-jt-Gr,status:Hn,isMain:!0,hasCN:dr}),se.push({particular:"PROMOTIONAL TRADE EMAILER"+(Qe.campaigns.length>1?"S":""),credit:ht,isMain:!1,hasCN:dr}),Vt?(se.push({particular:"CGST",credit:dt,isMain:!1,hasCN:dr}),se.push({particular:"SGST",credit:Xt,isMain:!1,hasCN:dr})):se.push({particular:"IGST",credit:qt,isMain:!1,hasCN:dr}),wr&&!ee.has(jr)){ee.add(jr);const hn=Math.abs(wr.totalAmount||wr.credit||0);ie-=hn,we+=hn,se.push({date:wr.date,particular:X,vchType:"Credit Note",vchNo:wr.creditNoteNo||wr.vchNo,debit:0,credit:hn,receiptDate:"",amountReceived:0,tds:0,balance:"-",status:"",isMain:!0,isCreditNote:!0,hasCN:!0});const Gn=Math.abs(wr.amount)||hn/1.18,Es=Math.abs(wr.gst)||hn-Gn;se.push({particular:"PROMOTIONAL TRADE EMAILER",credit:Gn,isMain:!1,isCreditNote:!0,hasCN:!0}),se.push({particular:wr.gstType||(Vt?"CGST + SGST":"IGST"),credit:Es,isMain:!1,isCreditNote:!0,hasCN:!0})}}else if(me.isHistorical){const Qe=me.debit||0,ht=me.credit||0,Vt=b(me.vchNo),dt=z.get(Vt),Xt=!!dt;if(ie+=Qe-ht,fe+=Qe,we+=ht,se.push({date:me.date,particular:me.particulars||X,vchType:me.vchType||"Sales",vchNo:me.vchNo,debit:Qe,credit:ht,receiptDate:me.receiptDate||"",amountReceived:me.amountReceived||0,tds:me.tdsReceived||0,balance:Xt?"-":Qe-(me.amountReceived||0)-(me.tdsReceived||0),status:Xt?"":me.paymentStatus||"",isMain:!0,isHistorical:!0,hasCN:Xt}),me.subRows&&me.subRows.length>0&&me.subRows.forEach(qt=>{se.push({particular:qt.particular,debit:qt.debit,credit:qt.credit,isMain:!1,hasCN:Xt})}),dt&&!ee.has(Vt)){ee.add(Vt);const qt=Math.abs(dt.totalAmount||dt.credit||0);ie-=qt,we+=qt,se.push({date:dt.date,particular:X,vchType:"Credit Note",vchNo:dt.creditNoteNo||dt.vchNo,debit:0,credit:qt,receiptDate:"",amountReceived:0,tds:0,balance:"-",status:"",isMain:!0,isCreditNote:!0,hasCN:!0}),dt.subRows&&dt.subRows.length>0&&dt.subRows.forEach(Zt=>{se.push({particular:Zt.particular,credit:Math.abs(Zt.credit||0),isMain:!1,isCreditNote:!0,hasCN:!0})})}}});const Je=se.reduce((me,Pe)=>Pe.isMain&&typeof Pe.balance=="number"&&Pe.balance>0?me+Pe.balance:me,0),lt=(X||"").trim().toUpperCase();let ot={};Ce&&(ot=d.find(me=>me.partyNameUpper===lt&&me.normalizedState===Ce)||{}),ot.state||(ot=d.find(me=>me.partyNameUpper===lt)||{});const vt=Se.find(me=>{var Pe;return((Pe=me.partyName)==null?void 0:Pe.trim().toUpperCase())===lt}),ut=ot.state||(vt==null?void 0:vt.statePartyDetails)||"",Ot=ot.address||Ac(X,ut)||"",ze=ot.gstin||ko(X,ut),rt=`
<!DOCTYPE html>
<html>
<head>
  <title>Ledger Account - ${X}</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: Arial, sans-serif; font-size: 11px; padding: 20px; }
    .header { text-align: center; margin-bottom: 15px; }
    .firm-name { font-size: 18px; font-weight: bold; color: #1E293B; }
    .firm-address { font-size: 10px; color: #666; margin-top: 2px; }
    .party-section { text-align: center; margin: 15px 0; padding: 10px; border: 1px solid #ddd; background: #f9f9f9; }
    .party-name { font-size: 14px; font-weight: bold; }
    .ledger-title { font-size: 11px; color: #666; }
    .party-address { font-size: 10px; color: #666; margin-top: 5px; }
    .party-gstin { font-size: 10px; color: #1a5276; margin-top: 3px; font-weight: 600; }
    .period { text-align: center; font-size: 11px; margin: 10px 0; font-weight: bold; }
    .totals { display: flex; justify-content: space-around; background: #e8f4fd; padding: 8px; margin-bottom: 10px; font-size: 10px; border: 1px solid #ccc; }
    .totals div { text-align: center; }
    .totals .label { color: #666; }
    .totals .value { font-weight: bold; font-size: 11px; }
    .closing-balance { text-align: center; background: #1E293B; color: white; padding: 10px; margin-bottom: 10px; font-size: 14px; font-weight: bold; }
    table { width: 100%; border-collapse: collapse; font-size: 10px; }
    th { background: #f0f0f0; border: 1px solid #ccc; padding: 6px 4px; text-align: left; font-weight: bold; }
    td { border: 1px solid #ddd; padding: 5px 4px; }
    .text-right { text-align: right; }
    .text-center { text-align: center; }
    .main-row { background: #fff; }
    .main-row-cn { background: #fffbeb; }
    .sub-row { background: #fafafa; }
    .sub-row-cn { background: #fffbeb; }
    .sub-row td { padding-left: 20px; color: #666; font-size: 9px; }
    .opening-row { background: #fef3c7; font-weight: bold; }
    .credit-note-row { background: #fffbeb; }
    .status-received { background: #dcfce7; color: #166534; padding: 2px 6px; border-radius: 3px; font-size: 9px; }
    .status-pending { background: #fef3c7; color: #92400e; padding: 2px 6px; border-radius: 3px; font-size: 9px; }
    .debit { color: #dc2626; }
    .credit { color: #059669; }
    @media print { 
      body { padding: 10px; } 
      @page { size: landscape; margin: 10mm; }
    }
  </style>
</head>
<body>
  <div class="header">
    <div class="firm-name">${w.name}</div>
    <div class="firm-address">${w.address}</div>
    <div class="firm-address">${w.addressLine2}, ${w.city}</div>
    <div class="firm-address">E-Mail: ${w.email}</div>
  </div>
  
  <div class="party-section">
    <div class="party-name">${X}</div>
    <div class="ledger-title">Ledger Account</div>
    ${Ot?`<div class="party-address">${Ot}</div>`:""}
    ${ut?`<div class="party-address"> ${ut}</div>`:""}
    ${ze?`<div class="party-gstin">GSTIN: ${ze}</div>`:""}
  </div>
  
  <div class="period">${St(Sn.fromDate)} to ${St(Sn.toDate)}</div>
  
  <div class="closing-balance">
    Closing Balance: ${zt(Math.abs(Je))} ${Je>0?"(Dr)":Je<0?"(Cr)":""}
  </div>
  
  <div class="totals">
    <div><div class="label">Debit</div><div class="value">${zt(fe)}</div></div>
    <div><div class="label">Credit</div><div class="value">${zt(we)}</div></div>
    <div><div class="label">Amount Received</div><div class="value credit">${zt(Ze)}</div></div>
    <div><div class="label">TDS Received</div><div class="value">${zt(ce)}</div></div>
  </div>
  
  <table>
    <thead>
      <tr>
        <th style="width:65px">Date</th>
        <th>Particular</th>
        <th style="width:70px" class="text-center">Vch Type</th>
        <th style="width:100px">Vch No.</th>
        <th style="width:80px" class="text-right">Debit</th>
        <th style="width:80px" class="text-right">Credit</th>
        <th style="width:70px" class="text-center">Date of Receipt</th>
        <th style="width:85px" class="text-right">Amount Received</th>
        <th style="width:70px" class="text-right">TDS Received</th>
        <th style="width:75px" class="text-right">Balance</th>
        <th style="width:70px" class="text-center">Payment Status</th>
      </tr>
    </thead>
    <tbody>
      ${se.map(me=>me.isMain?`
        <tr class="${me.isOpening?"opening-row":me.hasCN||me.isCreditNote?"main-row-cn":"main-row"}">
          <td>${me.date?St(me.date):""}</td>
          <td style="font-weight:600">${me.particular}</td>
          <td class="text-center">${me.vchType||""}</td>
          <td style="color:#2874A6;font-weight:600">${me.vchNo||""}</td>
          <td class="text-right">${me.debit>0?zt(me.debit):""}</td>
          <td class="text-right" style="color:#DC2626">${me.credit>0?zt(me.credit):""}</td>
          <td class="text-center">${me.receiptDate?St(me.receiptDate):""}</td>
          <td class="text-right credit">${me.amountReceived>0?zt(me.amountReceived):""}</td>
          <td class="text-right">${me.tds>0?zt(me.tds):""}</td>
          <td class="text-right">${me.balance==="-"?"-":me.balance>0?zt(me.balance):""}</td>
          <td class="text-center">${me.status?`<span class="${me.status==="Received"?"status-received":"status-pending"}">${me.status}</span>`:""}</td>
        </tr>
      `:`
        <tr class="${me.hasCN||me.isCreditNote?"sub-row-cn":"sub-row"}">
          <td></td>
          <td style="padding-left:20px;color:#666">${me.particular}</td>
          <td></td>
          <td></td>
          <td class="text-right">${me.debit?zt(me.debit):""}</td>
          <td class="text-right">${me.credit?zt(me.credit):""}</td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
        </tr>
      `).join("")}
    </tbody>
  </table>
  
  <script>window.onload = function() { window.print(); }<\/script>
</body>
</html>`,Mt=window.open("","_blank");Mt.document.write(rt),Mt.document.close()},K4=ye.useMemo(()=>{const h=new Set;return $r.forEach(_=>h.add(_.partyName)),ni.forEach(_=>h.add(_.partyName)),[...h].filter(Boolean).sort()},[$r,ni]),Y4=ye.useMemo(()=>$r.filter(h=>{var _;return!(Ae.party&&h.partyName!==Ae.party||Ae.invoiceNo&&!((_=h.invoiceNo)!=null&&_.toLowerCase().includes(Ae.invoiceNo.toLowerCase()))||Ae.dateFrom&&h.date<Ae.dateFrom||Ae.dateTo&&h.date>Ae.dateTo)}),[$r,Ae]),X4=ye.useMemo(()=>ni.filter(h=>{var _;return!(Ae.party&&h.partyName!==Ae.party||Ae.invoiceNo&&!((_=h.invoiceNo)!=null&&_.toLowerCase().includes(Ae.invoiceNo.toLowerCase()))||Ae.dateFrom&&h.date<Ae.dateFrom||Ae.dateTo&&h.date>Ae.dateTo)}),[ni,Ae]),q4=()=>{const h=[...Y4].sort((L,V)=>new Date(V.date)-new Date(L.date)),_=[...X4].sort((L,V)=>new Date(V.date)-new Date(L.date)),U=h.reduce((L,V)=>L+(parseFloat(V.amount)||0),0),Q=h.reduce((L,V)=>L+(parseFloat(V.tds)||parseFloat(V.tds||V.tdsAmount)||0),0),B=_.reduce((L,V)=>L+(parseFloat(V.totalAmount)||0),0),oe=L=>{const V=parseFloat(L.totalAmount)||0;let b=parseFloat(L.baseAmount)||parseFloat(L.amount)||0,z=parseFloat(L.gst)||(parseFloat(L.cgstAmount)||0)+(parseFloat(L.sgstAmount)||0)+(parseFloat(L.igstAmount)||0);return b===0&&V>0&&(b=V/1.18,z=V-b),{base:b,gst:z,total:V}};return c.jsxs("div",{style:{padding:"20px"},children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[c.jsxs("div",{children:[c.jsx("h1",{style:{fontSize:"22px",fontWeight:"700",color:"#1E293B",marginBottom:"4px"},children:" Receipt Register"}),c.jsx("p",{style:{fontSize:"13px",color:"#64748B"},children:"All receipts, TDS, and credit notes"})]}),c.jsx(Xe,{icon:Po,label:"Export Excel",variant:"secondary",onClick:z4})]}),c.jsx("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"10px",border:"1px solid #E2E8F0",padding:"14px 18px",marginBottom:"16px"},children:c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"14px",flexWrap:"wrap"},children:[c.jsx(gd,{size:18,color:"#64748B"}),c.jsx("span",{style:{fontSize:"13px",fontWeight:"700",color:"#475569"},children:"Filters:"}),c.jsxs("select",{value:Ae.party,onChange:L=>We(V=>({...V,party:L.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px"},children:[c.jsx("option",{value:"",children:"All Parties"}),K4.map(L=>c.jsx("option",{value:L,children:L},L))]}),c.jsx("input",{type:"text",placeholder:"Invoice No",value:Ae.invoiceNo,onChange:L=>We(V=>({...V,invoiceNo:L.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",width:"140px"}}),c.jsx("input",{type:"date",value:Ae.dateFrom,onChange:L=>We(V=>({...V,dateFrom:L.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px"}}),c.jsx("span",{style:{color:"#64748B"},children:"to"}),c.jsx("input",{type:"date",value:Ae.dateTo,onChange:L=>We(V=>({...V,dateTo:L.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px"}}),(Ae.party||Ae.invoiceNo||Ae.dateFrom||Ae.dateTo)&&c.jsxs("button",{onClick:()=>We({party:"",invoiceNo:"",dateFrom:"",dateTo:""}),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #FCA5A5",borderRadius:"8px",backgroundColor:"#FEE2E2",color:"#991B1B",cursor:"pointer"},children:[c.jsx(wa,{size:14})," Clear"]})]})}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"16px",marginBottom:"20px"},children:[c.jsxs("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"12px",padding:"20px",border:"1px solid #E2E8F0"},children:[c.jsx("div",{style:{fontSize:"12px",fontWeight:"600",color:"#64748B",marginBottom:"8px"},children:"Receipts"}),c.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:h.length})]}),c.jsxs("div",{style:{backgroundColor:"#F0FDF4",borderRadius:"12px",padding:"20px",border:"1px solid #BBF7D0"},children:[c.jsx("div",{style:{fontSize:"12px",fontWeight:"600",color:"#166534",marginBottom:"8px"},children:"Amount Received"}),c.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#166534"},children:nt(U)})]}),c.jsxs("div",{style:{backgroundColor:"#FEF3C7",borderRadius:"12px",padding:"20px",border:"1px solid #FDE68A"},children:[c.jsx("div",{style:{fontSize:"12px",fontWeight:"600",color:"#92400E",marginBottom:"8px"},children:"TDS Received"}),c.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#92400E"},children:nt(Q)})]}),c.jsxs("div",{style:{backgroundColor:"#FEE2E2",borderRadius:"12px",padding:"20px",border:"1px solid #FCA5A5"},children:[c.jsx("div",{style:{fontSize:"12px",fontWeight:"600",color:"#991B1B",marginBottom:"8px"},children:"Credit Notes"}),c.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#991B1B"},children:nt(B)})]})]}),c.jsx(mn,{title:`Receipts (${h.length})`,noPadding:!0,children:c.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"12px"},children:[c.jsx("thead",{children:c.jsxs("tr",{style:{backgroundColor:"#F8FAFC",borderBottom:"2px solid #E2E8F0"},children:[c.jsx("th",{style:{padding:"12px",textAlign:"left",fontWeight:"700"},children:"Receipt No"}),c.jsx("th",{style:{padding:"12px",textAlign:"center",fontWeight:"700",color:"#6B21A8",backgroundColor:"#FAF5FF"},children:"Code"}),c.jsx("th",{style:{padding:"12px",textAlign:"left",fontWeight:"700"},children:"Date"}),c.jsx("th",{style:{padding:"12px",textAlign:"left",fontWeight:"700"},children:"Party Name"}),c.jsx("th",{style:{padding:"12px",textAlign:"left",fontWeight:"700"},children:"Invoice No"}),c.jsx("th",{style:{padding:"12px",textAlign:"right",fontWeight:"700",backgroundColor:"#F0FDF4",color:"#166534"},children:"Amount"}),c.jsx("th",{style:{padding:"12px",textAlign:"right",fontWeight:"700",backgroundColor:"#FEF3C7",color:"#92400E"},children:"TDS"}),c.jsx("th",{style:{padding:"12px",textAlign:"right",fontWeight:"700"},children:"Total"}),c.jsx("th",{style:{padding:"12px",textAlign:"center",fontWeight:"700"},children:"Payment Mode"}),c.jsx("th",{style:{padding:"12px",textAlign:"center",fontWeight:"700"},children:"Actions"})]})}),c.jsx("tbody",{children:h.length===0?c.jsx("tr",{children:c.jsx("td",{colSpan:"10",style:{padding:"50px",textAlign:"center",color:"#94A3B8"},children:"No receipts found"})}):h.map(L=>{const V=parseFloat(L.amount)||0,b=parseFloat(L.tds)||parseFloat(L.tdsAmount)||0,z=L.clientCode||Br(L.partyName,L.statePartyDetails||"");return c.jsxs("tr",{style:{borderBottom:"1px solid #F1F5F9"},children:[c.jsx("td",{style:{padding:"12px",fontWeight:"600",color:"#2874A6"},children:L.receiptNo}),c.jsx("td",{style:{padding:"12px",textAlign:"center",backgroundColor:"#FAF5FF"},children:c.jsx("span",{style:{fontWeight:"700",color:"#6B21A8",fontSize:"11px"},children:z||"-"})}),c.jsx("td",{style:{padding:"12px"},children:St(L.date)}),c.jsx("td",{style:{padding:"12px",fontWeight:"500"},children:L.partyName}),c.jsx("td",{style:{padding:"12px",color:"#64748B"},children:L.invoiceNo}),c.jsx("td",{style:{padding:"12px",textAlign:"right",fontWeight:"600",color:"#166534",backgroundColor:"#F0FDF4"},children:nt(V)}),c.jsx("td",{style:{padding:"12px",textAlign:"right",fontWeight:"600",color:"#92400E",backgroundColor:"#FEF3C7"},children:nt(b)}),c.jsx("td",{style:{padding:"12px",textAlign:"right",fontWeight:"700"},children:nt(V+b)}),c.jsx("td",{style:{padding:"12px",textAlign:"center"},children:c.jsx("span",{style:{padding:"4px 8px",fontSize:"10px",fontWeight:"600",borderRadius:"9999px",backgroundColor:"#E0E7FF",color:"#3730A3"},children:L.paymentMode||L.mode||"Bank Transfer"})}),c.jsx("td",{style:{padding:"12px",textAlign:"center"},children:c.jsxs("button",{onClick:()=>W4(L),style:{padding:"6px 10px",fontSize:"11px",backgroundColor:"#2874A6",color:"white",border:"none",borderRadius:"6px",cursor:"pointer"},children:[c.jsx(nE,{size:12})," Print"]})})]},L.id||L.receiptNo)})})]})}),c.jsx("div",{style:{marginTop:"30px"},children:c.jsx(mn,{title:`Credit Notes (${_.length})`,noPadding:!0,children:c.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"12px"},children:[c.jsx("thead",{children:c.jsxs("tr",{style:{backgroundColor:"#FEF3C7",borderBottom:"2px solid #FDE68A"},children:[c.jsx("th",{style:{padding:"12px",textAlign:"left",fontWeight:"700"},children:"CN No"}),c.jsx("th",{style:{padding:"12px",textAlign:"center",fontWeight:"700",color:"#6B21A8",backgroundColor:"#FAF5FF"},children:"Code"}),c.jsx("th",{style:{padding:"12px",textAlign:"left",fontWeight:"700"},children:"Date"}),c.jsx("th",{style:{padding:"12px",textAlign:"left",fontWeight:"700"},children:"Party Name"}),c.jsx("th",{style:{padding:"12px",textAlign:"left",fontWeight:"700"},children:"Against Invoice"}),c.jsx("th",{style:{padding:"12px",textAlign:"right",fontWeight:"700"},children:"Base Amount"}),c.jsx("th",{style:{padding:"12px",textAlign:"right",fontWeight:"700"},children:"GST"}),c.jsx("th",{style:{padding:"12px",textAlign:"right",fontWeight:"700"},children:"Total"}),c.jsx("th",{style:{padding:"12px",textAlign:"left",fontWeight:"700"},children:"Reason"}),c.jsx("th",{style:{padding:"12px",textAlign:"center",fontWeight:"700"},children:"Actions"})]})}),c.jsx("tbody",{children:_.length===0?c.jsx("tr",{children:c.jsx("td",{colSpan:"10",style:{padding:"50px",textAlign:"center",color:"#94A3B8"},children:"No credit notes found"})}):_.map(L=>{const V=oe(L),b=L.clientCode||Br(L.partyName,L.statePartyDetails||"");return c.jsxs("tr",{style:{borderBottom:"1px solid #F1F5F9",backgroundColor:"#FFFBEB"},children:[c.jsx("td",{style:{padding:"12px",fontWeight:"600",color:"#92400E"},children:L.creditNoteNo}),c.jsx("td",{style:{padding:"12px",textAlign:"center",backgroundColor:"#FAF5FF"},children:c.jsx("span",{style:{fontWeight:"700",color:"#6B21A8",fontSize:"11px"},children:b||"-"})}),c.jsx("td",{style:{padding:"12px"},children:St(L.date)}),c.jsx("td",{style:{padding:"12px",fontWeight:"500"},children:L.partyName}),c.jsx("td",{style:{padding:"12px",color:"#64748B"},children:L.invoiceNo}),c.jsx("td",{style:{padding:"12px",textAlign:"right"},children:nt(V.base)}),c.jsx("td",{style:{padding:"12px",textAlign:"right"},children:nt(V.gst)}),c.jsx("td",{style:{padding:"12px",textAlign:"right",fontWeight:"700",color:"#92400E"},children:nt(V.total)}),c.jsx("td",{style:{padding:"12px",fontSize:"11px",color:"#64748B"},children:L.reason||"-"}),c.jsx("td",{style:{padding:"12px",textAlign:"center"},children:c.jsxs("button",{onClick:()=>$4(L),style:{padding:"6px 10px",fontSize:"11px",backgroundColor:"#92400E",color:"white",border:"none",borderRadius:"6px",cursor:"pointer"},children:[c.jsx(nE,{size:12})," Print"]})})]},L.id||L.creditNoteNo)})})]})})})]})},Q4=()=>{const h=(b,z,se)=>{const fe=Wn[b]||0,we=ze=>se?(ze.clientCode||Br(ze.partyName,ze.statePartyDetails))===se:!0,Ze=Se.filter(ze=>$t(ze.partyName,b)&&ze.invoiceGenerated&&ze.invoiceStatus==="Approved"&&we(ze)&&(!z||ii(ze.statePartyDetails)===z)),ce=be.filter(ze=>$t(ze.partyName,b)&&ze.invoiceGenerated&&ze.invoiceStatus==="Approved"&&we(ze)&&(!z||ii(ze.statePartyDetails)===z)),ie=new Map;Ze.forEach(ze=>{ie.has(ze.invoiceNo)?ie.get(ze.invoiceNo).campaigns.push(ze):ie.set(ze.invoiceNo,{invoiceNo:ze.invoiceNo,campaigns:[ze],totalAmount:parseFloat(ze.invoiceTotalAmount)||0})}),ce.forEach(ze=>{ie.has(ze.invoiceNo)||ie.set(ze.invoiceNo,{invoiceNo:ze.invoiceNo,totalAmount:parseFloat(ze.invoiceTotalAmount)||0,isService:!0})});const ee=new Set(Array.from(ie.keys())),Te=je.filter(ze=>$t(ze.partyName,b)&&(!z||ee.has(ze.invoiceNo))),Je=te.filter(ze=>$t(ze.partyName,b)&&(!z||ee.has(ze.invoiceNo))),lt=z?[]:ne.filter(ze=>{var rt;return $t(ze.partyName,b)&&ze.isHistorical&&ze.type!=="creditnote"&&!((rt=ze.vchNo)!=null&&rt.toUpperCase().startsWith("CN"))}),ot=z?[]:ne.filter(ze=>{var rt;return $t(ze.partyName,b)&&ze.isHistorical&&(ze.type==="creditnote"||((rt=ze.vchNo)==null?void 0:rt.toUpperCase().startsWith("CN")))}),vt=ze=>{if(!ze)return"";const rt=ze.split("/");return rt.length>=3?rt.slice(1).join("/"):rt.length===2?rt.join("/"):rt[rt.length-1]},ut=new Map;Je.forEach(ze=>{const rt=vt(ze.invoiceNo);rt&&!ut.has(rt)&&ut.set(rt,ze)}),ot.forEach(ze=>{const rt=vt(ze.vchNo);rt&&!ut.has(rt)&&ut.set(rt,ze)});let Ot=0;return fe>0&&(Ot+=fe),Array.from(ie.values()).forEach(ze=>{const rt=ze.totalAmount,Mt=vt(ze.invoiceNo),me=ut.get(Mt),Pe=me?Math.abs(parseFloat(me.totalAmount)||parseFloat(me.credit)||0):0;if(!(me&&Pe>=rt)){let Qe=me?rt-Pe:rt;const ht=Te.find(Vt=>Vt.invoiceNo===ze.invoiceNo);if(ht){const Vt=Qe-(parseFloat(ht.amount)||0)-(parseFloat(ht.tds)||0)-(parseFloat(ht.discount)||0);Vt>0&&(Ot+=Vt)}else Qe>0&&(Ot+=Qe)}}),lt.forEach(ze=>{const rt=vt(ze.vchNo),Mt=ut.get(rt),me=Mt?Math.abs(parseFloat(Mt.totalAmount)||parseFloat(Mt.credit)||parseFloat(Mt.debit)||0):0,Pe=parseFloat(ze.debit)||0;if(!(Mt&&me>=Pe)){let Qe=Mt?Pe-me:Pe;const ht=parseFloat(ze.amountReceived)||0,Vt=parseFloat(ze.tdsReceived)||0,dt=Qe-ht-Vt;dt>0&&(Ot+=dt)}}),Ot},_=new Set;d.forEach(b=>{b.clientCode&&_.add(b.partyNameUpper)});const U=d.filter(b=>!b.clientCode&&_.has(b.partyNameUpper)?(console.log("RENDER FILTER - Removing party without code:",b.partyName),!1):b.partyName.toLowerCase().includes(xs.toLowerCase())||b.state&&b.state.toLowerCase().includes(xs.toLowerCase()));console.log("filteredParties after render filter:",U.length,U.map(b=>({name:b.partyName,code:b.clientCode})));const Q=b=>{if(Ce){const we=d.find(Ze=>Ze.partyNameUpper===(b||"").trim().toUpperCase()&&Ze.normalizedState===Ce);if(we!=null&&we.state)return we.state}const z=(b||"").trim().toUpperCase(),se=Se.find(we=>{var Ze;return((Ze=we.partyName)==null?void 0:Ze.trim().toUpperCase())===z});if(se!=null&&se.statePartyDetails)return se.statePartyDetails;const fe=d.find(we=>we.partyNameUpper===z);return(fe==null?void 0:fe.state)||""},B=b=>{const z=(b||"").trim().toUpperCase();if(Ce){const fe=d.find(we=>we.partyNameUpper===z&&we.normalizedState===Ce);if(fe!=null&&fe.address)return fe.address}const se=d.find(fe=>fe.partyNameUpper===z);return se!=null&&se.address?se.address:Ac(b,Q(b))},oe=b=>{const z=(b||"").trim().toUpperCase();if(Ce){const we=d.find(Ze=>Ze.partyNameUpper===z&&Ze.normalizedState===Ce);if(we!=null&&we.gstin)return we.gstin}const se=d.find(we=>we.partyNameUpper===z);if(se!=null&&se.gstin)return se.gstin;const fe=Se.find(we=>{var Ze;return((Ze=we.partyName)==null?void 0:Ze.trim().toUpperCase())===z});return fe?ko(b,fe.statePartyDetails):""},V=(()=>{if(!X)return{entries:[],totals:{debit:0,credit:0,received:0,tds:0,balance:0}};const b=Wn[X]||0,z=ae=>{if(!ae)return"";const Qe=ae.split("/");return Qe.length>=3?Qe.slice(1).join("/"):Qe.length===2?Qe.join("/"):Qe[Qe.length-1]},se=ae=>De?(ae.clientCode||Br(ae.partyName,ae.statePartyDetails))===De:!0,fe=Se.filter(ae=>$t(ae.partyName,X)&&ae.invoiceGenerated&&ae.invoiceStatus==="Approved"&&se(ae)&&(!Ce||ii(ae.statePartyDetails)===Ce)),we=be.filter(ae=>$t(ae.partyName,X)&&ae.invoiceGenerated&&ae.invoiceStatus==="Approved"&&se(ae)&&(!Ce||ii(ae.statePartyDetails)===Ce)),Ze=new Map;fe.forEach(ae=>{Ze.has(ae.invoiceNo)?Ze.get(ae.invoiceNo).campaigns.push(ae):Ze.set(ae.invoiceNo,{invoiceNo:ae.invoiceNo,invoiceDate:ae.invoiceDate,invoiceType:ae.invoiceType,combinationCode:ae.combinationCode,receiptStatus:ae.receiptStatus,receiptNo:ae.receiptNo,receiptDate:ae.receiptDate,creditNoteNo:ae.creditNoteNo,campaigns:[ae],isFromMaster:!0})}),we.forEach(ae=>{Ze.has(ae.invoiceNo)||Ze.set(ae.invoiceNo,{invoiceNo:ae.invoiceNo,invoiceDate:ae.invoiceDate,invoiceType:"Service",combinationCode:"NA",receiptStatus:ae.receiptStatus,receiptNo:ae.receiptNo,receiptDate:ae.receiptDate,creditNoteNo:ae.creditNoteNo,campaigns:[ae],isFromMaster:!1,isService:!0,serviceType:ae.serviceType})});const ce=new Set(Array.from(Ze.keys())),ie=Ce?[]:ne.filter(ae=>{var Qe;return $t(ae.partyName,X)&&ae.isHistorical&&ae.type!=="creditnote"&&!((Qe=ae.vchNo)!=null&&Qe.toUpperCase().startsWith("CN"))}),ee=Ce?[]:ne.filter(ae=>{var Qe;return $t(ae.partyName,X)&&ae.isHistorical&&(ae.type==="creditnote"||((Qe=ae.vchNo)==null?void 0:Qe.toUpperCase().startsWith("CN")))}),Te=je.filter(ae=>$t(ae.partyName,X)&&(!Ce||ce.has(ae.invoiceNo))),Je=te.filter(ae=>$t(ae.partyName,X)&&(!Ce||ce.has(ae.invoiceNo))),lt=new Map;Je.forEach(ae=>{const Qe=z(ae.invoiceNo);Qe&&!lt.has(Qe)&&lt.set(Qe,{...ae,isSystemCN:!0})}),ee.forEach(ae=>{const Qe=z(ae.vchNo);Qe&&!lt.has(Qe)&&lt.set(Qe,{...ae,isHistoricalCN:!0})});const ot=[];let vt=b,ut=0,Ot=0,ze=0,rt=0;const Mt=new Set;b!==0&&(ot.push({id:"opening",date:"",particular:"Opening Balance",vchType:"",vchNo:"",debit:b>0?b:0,credit:b<0?Math.abs(b):0,receiptDate:"",amountReceived:0,tdsReceived:0,balance:b,paymentStatus:"",isOpening:!0,subRows:[]}),ut+=b>0?b:0,Ot+=b<0?Math.abs(b):0);const me=[];Array.from(Ze.values()).filter(ae=>{const Qe=new Date(ae.invoiceDate),ht=new Date(Sn.fromDate),Vt=new Date(Sn.toDate);return Qe>=ht&&Qe<=Vt}).forEach(ae=>{me.push({...ae,entryType:"invoice",sortDate:ae.invoiceDate})}),ie.filter(ae=>{if(!ae.date)return!1;const Qe=new Date(ae.date),ht=new Date(Sn.fromDate),Vt=new Date(Sn.toDate);return Qe>=ht&&Qe<=Vt}).forEach(ae=>{me.push({...ae,entryType:ae.type||"invoice",sortDate:ae.date})}),me.sort((ae,Qe)=>new Date(ae.sortDate)-new Date(Qe.sortDate)),me.forEach(ae=>{var Qe,ht,Vt;if(ae.isFromMaster){const dt=ae;let Xt=0;dt.campaigns.forEach(es=>{Xt+=parseFloat(es.invoiceAmount)||0});const qt=(ht=(Qe=dt.campaigns[0])==null?void 0:Qe.statePartyDetails)==null?void 0:ht.toUpperCase().includes("MAHARASHTRA"),Zt=qt?Xt*.09:0,jr=qt?Xt*.09:0,wr=qt?0:Xt*.18,dr=Xt+Zt+jr+wr,Hr=z(dt.invoiceNo),jt=lt.get(Hr),Gr=jt?Math.abs(jt.totalAmount||jt.credit||0):0,er=!!jt,Hn=er&&Gr>=dr,hn=er&&!Hn?dr-Gr:0,Gn=Te.find(es=>es.invoiceNo===dt.invoiceNo);vt+=dr,ut+=dr;const Es=[{particular:"PROMOTIONAL TRADE EMAILER"+(dt.campaigns.length>1?"S":""),credit:Xt}];qt?(Es.push({particular:"CGST",credit:Zt}),Es.push({particular:"SGST",credit:jr})):Es.push({particular:"IGST",credit:wr});let Fr="",pn=0,Hs=0,No="",Ss=dr;if(Gn?(Fr="Received",pn=Gn.amount||0,Hs=Gn.tds||0,No=Gn.date,ze+=pn,rt+=Hs,Ss=dr-pn-Hs-(Gn.discount||0),vt-=pn+Hs+(Gn.discount||0)):dt.receiptStatus==="Received"?(Fr="Received",Ss=0):Hn?(Fr="CN Closed",Ss=0):er&&hn>0?(Fr="Partial CN",Ss=hn):Fr="Pending",ot.push({id:dt.invoiceNo,date:dt.invoiceDate,particular:X,vchType:"Sales",vchNo:dt.invoiceNo,debit:dr,credit:0,receiptDate:No,amountReceived:pn,tdsReceived:Hs,balance:Hn?"-":Ss>0?Ss:0,paymentStatus:Fr,isInvoice:!0,hasCN:er,subRows:Es}),jt&&!Mt.has(Hr)){Mt.add(Hr);const es=Math.abs(jt.totalAmount||jt.credit||0);vt-=es,Ot+=es;const ts=[];if(jt.amount&&ts.push({particular:"PROMOTIONAL TRADE EMAILER",credit:Math.abs(jt.amount)}),jt.gst&&ts.push({particular:jt.gstType||(qt?"CGST + SGST":"IGST"),credit:Math.abs(jt.gst)}),ts.length===0&&es>0){const va=es/1.18,id=es-va;ts.push({particular:"PROMOTIONAL TRADE EMAILER",credit:va}),ts.push({particular:qt?"CGST + SGST":"IGST",credit:id})}ot.push({id:jt.id||jt.creditNoteNo||`cn-${Hr}`,date:jt.date,particular:X,vchType:"Credit Note",vchNo:jt.creditNoteNo||jt.vchNo,debit:0,credit:es,receiptDate:"",amountReceived:0,tdsReceived:0,balance:"-",paymentStatus:"",isCreditNote:!0,hasCN:!0,subRows:jt.isHistoricalCN&&jt.subRows||ts})}}else if(ae.isService){const dt=ae,Xt=dt.campaigns[0]||{},qt=parseFloat(Xt.invoiceAmount)||0,Zt=dt.serviceType||Xt.serviceType||"SERVICE",jr=(Vt=Xt.statePartyDetails)==null?void 0:Vt.toUpperCase().includes("MAHARASHTRA"),wr=jr?qt*.09:0,dr=jr?qt*.09:0,Hr=jr?0:qt*.18,jt=qt+wr+dr+Hr,Gr=z(dt.invoiceNo),er=lt.get(Gr),Hn=er?Math.abs(er.totalAmount||er.credit||0):0,hn=!!er,Gn=hn&&Hn>=jt,Es=hn&&!Gn?jt-Hn:0,Fr=Te.find(va=>va.invoiceNo===dt.invoiceNo);vt+=jt,ut+=jt;const pn=[{particular:Zt.toUpperCase(),credit:qt}];jr?(pn.push({particular:"CGST",credit:wr}),pn.push({particular:"SGST",credit:dr})):pn.push({particular:"IGST",credit:Hr});let Hs="",No=0,Ss=0,es="",ts=jt;if(Fr?(Hs="Received",No=Fr.amount||0,Ss=Fr.tds||Fr.tdsAmount||0,es=Fr.date,ze+=No,rt+=Ss,ts=jt-No-Ss-(Fr.discount||0),vt-=No+Ss+(Fr.discount||0)):Gn?(Hs="CN Closed",ts=0):hn&&Es>0?(Hs="Partial CN",ts=Es):Hs="Pending",ot.push({id:dt.invoiceNo,date:dt.invoiceDate,particular:X,vchType:"Sales",vchNo:dt.invoiceNo,debit:jt,credit:0,receiptDate:es,amountReceived:No,tdsReceived:Ss,balance:Gn?"-":ts>0?ts:0,paymentStatus:Hs,isInvoice:!0,isService:!0,hasCN:hn,subRows:pn}),er&&!Mt.has(Gr)){Mt.add(Gr);const va=Math.abs(er.totalAmount||er.credit||0);vt-=va,Ot+=va;const id=[],Ny=va/1.18,ib=va-Ny;id.push({particular:Zt.toUpperCase(),credit:Ny}),id.push({particular:jr?"CGST + SGST":"IGST",credit:ib}),ot.push({id:er.id||er.creditNoteNo||`cn-${Gr}`,date:er.date,particular:X,vchType:"Credit Note",vchNo:er.creditNoteNo||er.vchNo,debit:0,credit:va,receiptDate:"",amountReceived:0,tdsReceived:0,balance:"-",paymentStatus:"",isCreditNote:!0,hasCN:!0,subRows:id})}}else if(ae.isHistorical){const dt=ae.debit||0,Xt=ae.credit||0,qt=z(ae.vchNo),Zt=lt.get(qt),jr=Zt?Math.abs(Zt.totalAmount||Zt.credit||0):0,wr=!!Zt,dr=wr&&jr>=dt,Hr=wr&&!dr?dt-jr:0;vt+=dt-Xt,ut+=dt,Ot+=Xt,ae.amountReceived&&(ze+=ae.amountReceived),ae.tdsReceived&&(rt+=ae.tdsReceived);const jt=ae.subRows||[];let Gr=dt-(ae.amountReceived||0)-(ae.tdsReceived||0),er=ae.paymentStatus||"";dr?(Gr=0,er="CN Closed"):wr&&Hr>0&&(Gr=Hr-(ae.amountReceived||0)-(ae.tdsReceived||0),Gr>0&&(er="Partial CN")),ot.push({id:ae.id,date:ae.date,particular:ae.particulars||X,vchType:ae.vchType||"Sales",vchNo:ae.vchNo,debit:dt,credit:Xt,receiptDate:ae.receiptDate||"",amountReceived:ae.amountReceived||0,tdsReceived:ae.tdsReceived||0,balance:dr?"-":Gr>0?Gr:0,paymentStatus:er,isInvoice:!0,isHistorical:!0,hasCN:wr,subRows:jt}),Zt&&!Mt.has(qt)&&(Mt.add(qt),vt-=jr,Ot+=jr,ot.push({id:Zt.id||Zt.creditNoteNo||Zt.vchNo||`cn-${qt}`,date:Zt.date,particular:X,vchType:"Credit Note",vchNo:Zt.creditNoteNo||Zt.vchNo,debit:0,credit:jr,receiptDate:"",amountReceived:0,tdsReceived:0,balance:"-",paymentStatus:"",isCreditNote:!0,hasCN:!0,subRows:Zt.subRows||[]}))}});const Pe=ot.reduce((ae,Qe)=>typeof Qe.balance=="number"&&Qe.balance>0?ae+Qe.balance:ae,0);return{entries:ot,totals:{debit:ut,credit:Ot,received:ze,tds:rt,balance:Pe}}})();return c.jsxs("div",{children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[c.jsx("h1",{style:{margin:0,fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:" Party Ledgers"}),c.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[c.jsx(Xe,{icon:Po,label:"Export All",variant:"secondary",onClick:V4}),si&&c.jsx("span",{style:{padding:"8px 16px",backgroundColor:"#FEF3C7",borderRadius:"8px",fontSize:"13px",color:"#92400E",fontWeight:"600"},children:" View Only"}),_r&&c.jsx(Xe,{icon:Ys,label:"Import Historical",variant:"brand",onClick:()=>Sc(!0)}),_r&&X&&ne.some(b=>$t(b.partyName,X)&&b.isHistorical)&&c.jsx(Xe,{icon:rs,label:"Clear Historical",variant:"danger",onClick:i4}),_r&&c.jsx(Xe,{icon:md,label:"Opening Balance",variant:"primary",onClick:()=>Ar(!0)})]})]}),c.jsx("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"10px",border:"1px solid #E2E8F0",padding:"14px 18px",marginBottom:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"14px",flexWrap:"wrap"},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[c.jsx(OL,{size:18,color:"#64748B"}),c.jsx("span",{style:{fontSize:"13px",fontWeight:"700",color:"#475569"},children:"Period:"})]}),c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[c.jsx("input",{type:"date",value:Sn.fromDate,onChange:b=>ms(z=>({...z,fromDate:b.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px"}}),c.jsx("span",{style:{color:"#64748B"},children:"to"}),c.jsx("input",{type:"date",value:Sn.toDate,onChange:b=>ms(z=>({...z,toDate:b.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px"}})]}),c.jsx("div",{style:{marginLeft:"auto",display:"flex",gap:"10px"},children:X&&c.jsx(Xe,{icon:Po,label:"Download PDF",variant:"brand",onClick:G4})})]})}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"280px 1fr",gap:"16px"},children:[c.jsxs(mn,{title:"Parties",noPadding:!0,children:[c.jsx("div",{style:{padding:"12px",borderBottom:"1px solid #E2E8F0"},children:c.jsxs("div",{style:{position:"relative"},children:[c.jsx(Q0,{size:14,style:{position:"absolute",left:"10px",top:"50%",transform:"translateY(-50%)",color:"#94A3B8"}}),c.jsx("input",{type:"text",placeholder:"Search party...",value:xs,onChange:b=>Ku(b.target.value),style:{width:"100%",padding:"8px 12px 8px 32px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",boxSizing:"border-box"}})]})}),c.jsx("div",{style:{maxHeight:"450px",overflowY:"auto"},children:U.length===0?c.jsx("div",{style:{padding:"30px",textAlign:"center",color:"#94A3B8",fontSize:"14px"},children:xs?"No matching parties":"No parties yet"}):U.map((b,z)=>{const se=h(b.partyName,b.normalizedState,b.clientCode),fe=$t(X,b.partyName)&&Ce===b.normalizedState&&De===b.clientCode;return c.jsxs("div",{onClick:()=>{_e(b.partyName),Ve(b.normalizedState||null),Ne(b.clientCode||null)},style:{padding:"14px 18px",borderBottom:"1px solid #F1F5F9",cursor:"pointer",backgroundColor:fe?"#EFF6FF":"transparent",borderLeft:fe?"4px solid #2874A6":"4px solid transparent"},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[b.clientCode&&c.jsx("span",{style:{padding:"2px 6px",backgroundColor:"#F3E8FF",color:"#6B21A8",borderRadius:"4px",fontSize:"10px",fontWeight:"700"},children:b.clientCode}),c.jsx("span",{style:{fontWeight:"600",fontSize:"14px",color:"#1E293B"},children:b.partyName})]}),b.state&&c.jsxs("div",{style:{fontSize:"11px",color:"#64748B",marginTop:"2px"},children:[" ",b.state]}),b.gstin&&c.jsxs("div",{style:{fontSize:"10px",color:"#2874A6",marginTop:"1px"},children:["GST: ",b.gstin]}),c.jsxs("div",{style:{fontSize:"14px",color:se>0?"#DC2626":"#059669",fontWeight:"700",marginTop:"4px"},children:[se>0?"Dr. ":"Cr. ",nt(Math.abs(se))]})]},`${b.partyName}-${b.state}-${b.clientCode}-${z}`)})})]}),c.jsx(mn,{title:X?"Ledger Account":"Select a Party",noPadding:!0,children:X?c.jsxs("div",{style:{fontSize:"12px"},children:[c.jsxs("div",{style:{textAlign:"center",padding:"16px",borderBottom:"2px solid #1E3A5F",backgroundColor:"#F8FAFC"},children:[c.jsx("div",{style:{fontSize:"16px",fontWeight:"700",color:"#1E3A5F"},children:w.name}),c.jsx("div",{style:{fontSize:"11px",color:"#64748B",marginTop:"4px"},children:w.address}),c.jsxs("div",{style:{fontSize:"11px",color:"#64748B"},children:[w.addressLine2,", ",w.city]}),c.jsxs("div",{style:{fontSize:"11px",color:"#64748B"},children:["E-Mail: ",w.email]})]}),c.jsxs("div",{style:{textAlign:"center",padding:"12px",borderBottom:"1px solid #E2E8F0",backgroundColor:"#FFFFFF"},children:[c.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",gap:"8px"},children:[(()=>{const b=U.find(z=>$t(z.partyName,X)&&z.normalizedState===Ce);return b!=null&&b.clientCode?c.jsx("span",{style:{padding:"3px 8px",backgroundColor:"#F3E8FF",color:"#6B21A8",borderRadius:"6px",fontSize:"12px",fontWeight:"700"},children:b.clientCode}):null})(),c.jsx("span",{style:{fontSize:"14px",fontWeight:"700",color:"#1E293B"},children:X})]}),c.jsx("div",{style:{fontSize:"11px",fontWeight:"600",color:"#64748B"},children:"Ledger Account"}),B(X)&&c.jsx("div",{style:{fontSize:"11px",color:"#475569",marginTop:"4px"},children:B(X)}),Q(X)&&c.jsxs("div",{style:{fontSize:"11px",color:"#64748B",marginTop:"2px"},children:[" ",Q(X)]}),oe(X)&&c.jsxs("div",{style:{fontSize:"11px",color:"#2874A6",marginTop:"3px",fontWeight:"600"},children:["GSTIN: ",oe(X)]})]}),c.jsx("div",{style:{textAlign:"center",padding:"8px",backgroundColor:"#F1F5F9",borderBottom:"1px solid #E2E8F0"},children:c.jsxs("span",{style:{fontSize:"11px",fontWeight:"600",color:"#475569"},children:[St(Sn.fromDate)," to ",St(Sn.toDate)]})}),c.jsxs("div",{style:{backgroundColor:"#1E293B",color:"white",padding:"12px 16px",display:"flex",justifyContent:"center",alignItems:"center",gap:"12px",borderBottom:"3px solid #F59E0B"},children:[c.jsx("span",{style:{fontSize:"14px",fontWeight:"600"},children:"Closing Balance:"}),c.jsxs("span",{style:{fontSize:"18px",fontWeight:"700",color:V.totals.balance>0?"#FCA5A5":"#86EFAC"},children:[zt(Math.abs(V.totals.balance))," ",V.totals.balance>0?"(Dr)":V.totals.balance<0?"(Cr)":""]})]}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",backgroundColor:"#EFF6FF",borderBottom:"2px solid #2874A6",fontSize:"11px"},children:[c.jsxs("div",{style:{padding:"8px",textAlign:"center",borderRight:"1px solid #BFDBFE"},children:[c.jsx("div",{style:{color:"#64748B"},children:"Debit"}),c.jsx("div",{style:{fontWeight:"700",color:"#1E293B"},children:zt(V.totals.debit)})]}),c.jsxs("div",{style:{padding:"8px",textAlign:"center",borderRight:"1px solid #BFDBFE"},children:[c.jsx("div",{style:{color:"#64748B"},children:"Credit"}),c.jsx("div",{style:{fontWeight:"700",color:"#DC2626"},children:zt(V.totals.credit)})]}),c.jsxs("div",{style:{padding:"8px",textAlign:"center",borderRight:"1px solid #BFDBFE"},children:[c.jsx("div",{style:{color:"#64748B"},children:"Amount Received"}),c.jsx("div",{style:{fontWeight:"700",color:"#059669"},children:zt(V.totals.received)})]}),c.jsxs("div",{style:{padding:"8px",textAlign:"center"},children:[c.jsx("div",{style:{color:"#64748B"},children:"TDS Received"}),c.jsx("div",{style:{fontWeight:"700",color:"#1E293B"},children:zt(V.totals.tds)})]})]}),c.jsx("div",{style:{overflowX:"auto"},children:c.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"11px",minWidth:"1000px"},children:[c.jsx("thead",{children:c.jsxs("tr",{style:{backgroundColor:"#F8FAFC",borderBottom:"2px solid #E2E8F0"},children:[c.jsx("th",{style:{padding:"10px 8px",textAlign:"left",fontWeight:"700",width:"75px",borderRight:"1px solid #E2E8F0"},children:"Date"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"left",fontWeight:"700",minWidth:"150px",borderRight:"1px solid #E2E8F0"},children:"Particular"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"700",width:"80px",borderRight:"1px solid #E2E8F0"},children:"Vch Type"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"left",fontWeight:"700",width:"110px",borderRight:"1px solid #E2E8F0"},children:"Vch No."}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"700",width:"90px",borderRight:"1px solid #E2E8F0"},children:"Debit"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"700",width:"90px",borderRight:"1px solid #E2E8F0"},children:"Credit"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"700",width:"85px",borderRight:"1px solid #E2E8F0"},children:"Date of Receipt"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"700",width:"90px",borderRight:"1px solid #E2E8F0"},children:"Amount Received"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"700",width:"80px",borderRight:"1px solid #E2E8F0"},children:"TDS Received"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"700",width:"85px",borderRight:"1px solid #E2E8F0"},children:"Balance"}),c.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"700",width:"75px",borderRight:"1px solid #E2E8F0"},children:"Payment Status"}),_r&&c.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"700",width:"50px"},children:"Action"})]})}),c.jsx("tbody",{children:V.entries.length===0?c.jsx("tr",{children:c.jsx("td",{colSpan:_r?"12":"11",style:{padding:"40px",textAlign:"center",color:"#94A3B8"},children:"No entries in selected period"})}):V.entries.map(b=>c.jsxs(oh.Fragment,{children:[c.jsxs("tr",{style:{backgroundColor:b.isOpening?"#FEF3C7":b.hasCN||b.isCreditNote?"#FFFBEB":"#FFFFFF",borderBottom:"1px solid #E2E8F0",borderLeft:b.hasCN||b.isCreditNote?"4px solid #F59E0B":"none"},children:[c.jsx("td",{style:{padding:"8px",borderRight:"1px solid #E2E8F0"},children:b.date?St(b.date):""}),c.jsx("td",{style:{padding:"8px",fontWeight:"600",color:b.isCreditNote?"#DC2626":"#1E293B",borderRight:"1px solid #E2E8F0"},children:b.particular}),c.jsx("td",{style:{padding:"8px",textAlign:"center",borderRight:"1px solid #E2E8F0"},children:b.vchType&&c.jsx("span",{style:{padding:"2px 6px",borderRadius:"4px",fontSize:"10px",fontWeight:"600",backgroundColor:b.vchType==="Sales"?"#DCFCE7":"#FEE2E2",color:b.vchType==="Sales"?"#166534":"#991B1B"},children:b.vchType})}),c.jsx("td",{style:{padding:"8px",borderRight:"1px solid #E2E8F0"},children:b.vchNo&&b.isInvoice&&!b.isHistorical?c.jsx("button",{onClick:()=>g4(b.vchNo),style:{background:"none",border:"none",padding:0,fontWeight:"600",color:"#2874A6",cursor:"pointer",textDecoration:"underline",fontSize:"11px"},title:"Click to view invoice",children:b.vchNo}):c.jsx("span",{style:{fontWeight:"600",color:b.isCreditNote?"#DC2626":"#2874A6"},children:b.vchNo})}),c.jsx("td",{style:{padding:"8px",textAlign:"right",fontWeight:"600",borderRight:"1px solid #E2E8F0"},children:b.debit>0?zt(b.debit):""}),c.jsx("td",{style:{padding:"8px",textAlign:"right",color:"#DC2626",borderRight:"1px solid #E2E8F0"},children:b.credit>0?zt(b.credit):""}),c.jsx("td",{style:{padding:"8px",textAlign:"center",borderRight:"1px solid #E2E8F0"},children:b.receiptDate?St(b.receiptDate):""}),c.jsx("td",{style:{padding:"8px",textAlign:"right",color:"#059669",fontWeight:b.amountReceived>0?"600":"400",borderRight:"1px solid #E2E8F0"},children:b.amountReceived>0?zt(b.amountReceived):""}),c.jsx("td",{style:{padding:"8px",textAlign:"right",borderRight:"1px solid #E2E8F0"},children:b.tdsReceived>0?zt(b.tdsReceived):""}),c.jsx("td",{style:{padding:"8px",textAlign:"right",fontWeight:"600",color:typeof b.balance=="number"&&b.balance>0?"#DC2626":"",borderRight:"1px solid #E2E8F0"},children:b.isOpening?b.balance>0?zt(b.balance):"":b.balance==="-"?"-":typeof b.balance=="number"&&b.balance>0?zt(b.balance):"-"}),c.jsx("td",{style:{padding:"8px",textAlign:"center"},children:b.paymentStatus&&c.jsx("span",{style:{padding:"2px 8px",borderRadius:"4px",fontSize:"10px",fontWeight:"600",backgroundColor:b.paymentStatus==="Received"?"#DCFCE7":"#FEF3C7",color:b.paymentStatus==="Received"?"#166534":"#92400E"},children:b.paymentStatus})}),_r&&c.jsx("td",{style:{padding:"8px",textAlign:"center"},children:b.isHistorical&&!b.isOpening&&c.jsx("button",{onClick:()=>n4(ne.find(z=>z.id===b.id)),style:{padding:"2px 6px",borderRadius:"4px",fontSize:"10px",fontWeight:"600",backgroundColor:"#FEE2E2",color:"#991B1B",border:"none",cursor:"pointer"},title:"Delete historical entry",children:""})})]}),b.subRows&&b.subRows.length>0&&b.subRows.map((z,se)=>c.jsxs("tr",{style:{backgroundColor:b.isOpening?"#FEF3C7":b.hasCN||b.isCreditNote?"#FFFBEB":"#FFFFFF",borderBottom:se===b.subRows.length-1?"2px solid #CBD5E1":"1px solid #E2E8F0",borderLeft:b.hasCN||b.isCreditNote?"4px solid #F59E0B":"none"},children:[c.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),c.jsx("td",{style:{padding:"6px 8px 6px 30px",color:"#475569",fontSize:"12px",borderRight:"1px solid #E2E8F0"},children:z.particular}),c.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),c.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),c.jsx("td",{style:{padding:"6px 8px",textAlign:"right",fontSize:"12px",borderRight:"1px solid #E2E8F0"},children:z.debit?zt(z.debit):""}),c.jsx("td",{style:{padding:"6px 8px",textAlign:"right",fontSize:"12px",borderRight:"1px solid #E2E8F0"},children:z.credit?zt(z.credit):""}),c.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),c.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),c.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),c.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),c.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),_r&&c.jsx("td",{style:{padding:"6px 8px"}})]},`${b.id}-sub-${se}`))]},b.id))})]})})]}):c.jsx("div",{style:{padding:"60px",textAlign:"center",color:"#94A3B8"},children:"Select a party to view ledger"})})]})]})},[bc,Fy]=ye.useState(""),x0=ye.useMemo(()=>{const h=new Map,_=B=>{if(!B)return"";const oe=B.split("/");return oe.length>=3?oe.slice(1).join("/"):oe.length===2?oe.join("/"):oe[oe.length-1]},U=$n.filter(B=>{var oe;return B.isHistorical&&(B.type==="creditnote"||((oe=B.vchNo)==null?void 0:oe.toUpperCase().startsWith("CN")))}),Q=new Map;return ni.forEach(B=>{const oe=_(B.invoiceNo);oe&&Q.set(oe,B)}),U.forEach(B=>{const oe=_(B.vchNo);oe&&!Q.has(oe)&&Q.set(oe,B)}),wn.filter(B=>B.invoiceGenerated&&B.invoiceStatus==="Approved").forEach(B=>{if(h.has(B.invoiceNo))h.has(B.invoiceNo)&&h.get(B.invoiceNo).campaigns.push(B);else{const oe=$r.find(fe=>fe.invoiceNo===B.invoiceNo),L=ni.find(fe=>fe.invoiceNo===B.invoiceNo),V=parseFloat(B.invoiceTotalAmount)||0,b=L?Math.abs(parseFloat(L.totalAmount)||parseFloat(L.credit)||0):0,z=L&&b>=V,se=B.clientCode||Br(B.partyName,B.statePartyDetails);if(!oe&&!z){const fe=L?V-b:V;h.set(B.invoiceNo,{invoiceNo:B.invoiceNo,partyName:B.partyName,clientCode:se,invoiceDate:B.invoiceDate,invoiceTotalAmount:B.invoiceTotalAmount,pendingAmount:fe,hasPartialCN:!!L&&!z&&b>0,cnAmount:b,subject:B.subject,campaigns:[B],isHistorical:!1,invoiceType:B.invoiceType||"Individual",source:"Campaign"})}}}),Wr.filter(B=>B.invoiceGenerated&&B.invoiceStatus==="Approved").forEach(B=>{if(!h.has(B.invoiceNo)){const oe=$r.find(fe=>fe.invoiceNo===B.invoiceNo),L=ni.find(fe=>fe.invoiceNo===B.invoiceNo),V=parseFloat(B.invoiceTotalAmount)||0,b=L?Math.abs(parseFloat(L.totalAmount)||parseFloat(L.credit)||0):0,z=L&&b>=V,se=B.clientCode||Br(B.partyName,B.statePartyDetails);if(!oe&&!z){const fe=L?V-b:V;h.set(B.invoiceNo,{invoiceNo:B.invoiceNo,partyName:B.partyName,clientCode:se,invoiceDate:B.invoiceDate,invoiceTotalAmount:B.invoiceTotalAmount,pendingAmount:fe,hasPartialCN:!!L&&!z&&b>0,cnAmount:b,subject:B.serviceType||"",campaigns:[],isHistorical:!1,invoiceType:"Service",isService:!0,source:"Service"})}}}),$n.filter(B=>{var oe;return B.isHistorical&&B.type!=="creditnote"&&!((oe=B.vchNo)!=null&&oe.toUpperCase().startsWith("CN"))&&B.debit>0}).forEach(B=>{if(!h.has(B.vchNo)){const oe=$r.find(Ze=>Ze.invoiceNo===B.vchNo),L=_(B.vchNo),V=Q.get(L),b=V?Math.abs(parseFloat(V.totalAmount)||parseFloat(V.credit)||parseFloat(V.debit)||0):0,z=parseFloat(B.debit)||0,se=V&&b>=z;if(oe||se)return;const fe=!(B.amountReceived>0),we=V&&b>0&&b<z;if(fe||we){const Ze=we?z-b:z;h.set(B.vchNo,{invoiceNo:B.vchNo,partyName:B.partyName,invoiceDate:B.date,invoiceTotalAmount:z,pendingAmount:Ze,hasPartialCN:we,cnAmount:b,subject:B.particulars||B.narration,campaigns:[],isHistorical:!0,invoiceType:"Historical",source:"Historical"})}}}),Array.from(h.values()).sort((B,oe)=>B.partyName.localeCompare(oe.partyName))},[wn,Wr,$r,ni,$n]),J4=ye.useMemo(()=>{const h={};return ga.forEach(_=>{h[_.invoiceNo]||(h[_.invoiceNo]=[]),h[_.invoiceNo].push(_)}),Object.keys(h).forEach(_=>{h[_].sort((U,Q)=>new Date(Q.followupDate)-new Date(U.followupDate))}),h},[ga]),by=ye.useMemo(()=>{const h=new Date().toISOString().split("T")[0];return ga.filter(_=>_.nextFollowupDate&&_.nextFollowupDate>=h).sort((_,U)=>new Date(_.nextFollowupDate)-new Date(U.nextFollowupDate))},[ga]),v0=ye.useMemo(()=>{let h=x0;if(bc){const U=bc.toLowerCase();h=x0.filter(Q=>{var B,oe,L;return((B=Q.invoiceNo)==null?void 0:B.toLowerCase().includes(U))||((oe=Q.partyName)==null?void 0:oe.toLowerCase().includes(U))||((L=Q.subject)==null?void 0:L.toLowerCase().includes(U))})}const _={};return h.forEach(U=>{const Q=U.clientCode||"",B=`${U.partyName}|||${Q}`;_[B]||(_[B]={partyName:U.partyName,clientCode:Q,invoices:[],totalAmount:0}),_[B].invoices.push(U),_[B].totalAmount+=parseFloat(U.pendingAmount||U.invoiceTotalAmount)||0}),Object.values(_).sort((U,Q)=>{const B=U.partyName.localeCompare(Q.partyName);return B!==0?B:(U.clientCode||"").localeCompare(Q.clientCode||"")})},[x0,bc]),Z4=()=>{const h=v0.reduce((_,U)=>_+U.invoices.length,0);return c.jsxs("div",{children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[c.jsx("h1",{style:{margin:0,fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:" Followups"}),c.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[c.jsxs("span",{style:{padding:"6px 12px",backgroundColor:"#EFF6FF",borderRadius:"6px",fontSize:"12px",color:"#1E40AF",fontWeight:"600"},children:[v0.length," Parties | ",h," Invoices"]}),si&&c.jsx("span",{style:{padding:"8px 16px",backgroundColor:"#FEF3C7",borderRadius:"8px",fontSize:"13px",color:"#92400E",fontWeight:"600"},children:" View Only"})]})]}),c.jsx("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"10px",border:"1px solid #E2E8F0",padding:"14px 18px",marginBottom:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"14px",flexWrap:"wrap"},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[c.jsx(gd,{size:18,color:"#64748B"}),c.jsx("span",{style:{fontSize:"13px",fontWeight:"700",color:"#475569"},children:"Search:"})]}),c.jsxs("div",{style:{position:"relative",flex:1,maxWidth:"300px"},children:[c.jsx(Q0,{size:14,style:{position:"absolute",left:"10px",top:"50%",transform:"translateY(-50%)",color:"#94A3B8"}}),c.jsx("input",{type:"text",placeholder:"Search party, invoice, subject...",value:bc,onChange:_=>Fy(_.target.value),style:{padding:"8px 12px 8px 32px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",width:"100%"}})]}),bc&&c.jsxs("button",{onClick:()=>Fy(""),style:{padding:"8px 12px",fontSize:"13px",fontWeight:"600",border:"1.5px solid #FCA5A5",borderRadius:"8px",backgroundColor:"#FEE2E2",color:"#991B1B",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},children:[c.jsx(wa,{size:14})," Clear"]}),bc&&c.jsxs("span",{style:{fontSize:"13px",color:"#64748B"},children:["Showing ",h," of ",x0.length]})]})}),by.length>0&&c.jsx(mn,{title:" Upcoming Followups",style:{marginBottom:"16px"},children:c.jsx("div",{style:{display:"flex",gap:"12px",flexWrap:"wrap"},children:by.slice(0,5).map(_=>c.jsxs("div",{style:{padding:"10px 14px",backgroundColor:new Date(_.nextFollowupDate).toISOString().split("T")[0]===new Date().toISOString().split("T")[0]?"#FEE2E2":"#FEF3C7",borderRadius:"8px",border:"1px solid #FCD34D"},children:[c.jsx("div",{style:{fontWeight:"600",fontSize:"13px",color:"#92400E"},children:_.invoiceNo}),c.jsx("div",{style:{fontSize:"11px",color:"#78716C"},children:_.partyName}),c.jsxs("div",{style:{fontSize:"12px",fontWeight:"600",color:"#DC2626",marginTop:"4px"},children:[" ",St(_.nextFollowupDate)]})]},_.id))})}),v0.length===0?c.jsx(mn,{children:c.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#94A3B8"},children:" No pending invoices! All payments received."})}):v0.map(_=>c.jsxs(mn,{style:{marginBottom:"16px"},noPadding:!0,children:[c.jsxs("div",{style:{padding:"12px 16px",backgroundColor:"#1E293B",color:"white",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[c.jsxs("span",{style:{fontSize:"15px",fontWeight:"700"},children:[" ",_.partyName]}),_.clientCode&&c.jsx("span",{style:{padding:"2px 8px",backgroundColor:"#9333EA",borderRadius:"6px",fontSize:"11px",fontWeight:"700"},children:_.clientCode}),c.jsxs("span",{style:{padding:"3px 10px",backgroundColor:"#3B82F6",borderRadius:"12px",fontSize:"11px",fontWeight:"600"},children:[_.invoices.length," Invoice",_.invoices.length>1?"s":""]})]}),c.jsxs("div",{style:{fontSize:"14px",fontWeight:"700",color:"#FCD34D"},children:["Total: ",nt(_.totalAmount)]})]}),c.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"12px"},children:[c.jsx("thead",{children:c.jsxs("tr",{style:{backgroundColor:"#F8FAFC",borderBottom:"2px solid #E2E8F0"},children:[c.jsx("th",{style:{padding:"10px 12px",textAlign:"left",fontWeight:"700"},children:"Invoice No"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700",color:"#6B21A8",backgroundColor:"#FAF5FF"},children:"Code"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Type"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Invoice Date"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700"},children:"Amount"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Days Pending"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Last Followup"}),c.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Actions"})]})}),c.jsx("tbody",{children:_.invoices.map(U=>{var b,z,se;const Q=J4[U.invoiceNo]||[],B=Q[0],oe=Math.floor((new Date-new Date(U.invoiceDate))/(1e3*60*60*24)),L=U.isHistorical?"Historical":U.isService?"Service":U.invoiceType||(((b=U.campaigns)==null?void 0:b.length)>1?"Combined":"Individual"),V=U.clientCode||(U.campaigns&&U.campaigns[0]?Br(U.campaigns[0].partyName,U.campaigns[0].statePartyDetails):"");return c.jsxs(oh.Fragment,{children:[c.jsxs("tr",{style:{borderBottom:"1px solid #E2E8F0",backgroundColor:oe>30?"#FEF2F2":oe>15?"#FFFBEB":"#FFFFFF"},children:[c.jsxs("td",{style:{padding:"10px 12px",fontWeight:"600",color:"#2874A6"},children:[U.invoiceNo,U.hasPartialCN&&c.jsx("span",{style:{marginLeft:"6px",padding:"2px 6px",backgroundColor:"#FEF3C7",color:"#92400E",borderRadius:"4px",fontSize:"9px",fontWeight:"700"},children:"Partial CN"})]}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"center",backgroundColor:"#FAF5FF"},children:c.jsx("span",{style:{fontWeight:"700",color:"#6B21A8",fontSize:"11px"},children:V||"-"})}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:c.jsx("span",{style:{padding:"3px 8px",borderRadius:"6px",fontSize:"10px",fontWeight:"600",backgroundColor:L==="Historical"?"#E0E7FF":L==="Service"?"#FEF3C7":L==="Combined"?"#F3E8FF":"#DCFCE7",color:L==="Historical"?"#3730A3":L==="Service"?"#92400E":L==="Combined"?"#7C3AED":"#166534"},children:L})}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:St(U.invoiceDate)}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"600"},children:U.hasPartialCN?c.jsxs("div",{children:[c.jsx("div",{style:{color:"#DC2626"},children:nt(U.pendingAmount)}),c.jsx("div",{style:{fontSize:"9px",color:"#64748B",textDecoration:"line-through"},children:nt(U.invoiceTotalAmount)})]}):nt(U.invoiceTotalAmount)}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:c.jsxs("span",{style:{padding:"3px 10px",borderRadius:"12px",fontSize:"11px",fontWeight:"700",backgroundColor:oe>30?"#FEE2E2":oe>15?"#FEF3C7":"#DCFCE7",color:oe>30?"#991B1B":oe>15?"#92400E":"#166534"},children:[oe," days"]})}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"center",fontSize:"11px"},children:B?c.jsxs("div",{children:[c.jsx("div",{style:{fontWeight:"600"},children:St(B.followupDate)}),c.jsxs("div",{style:{color:"#64748B",fontSize:"10px"},children:[(z=B.notes)==null?void 0:z.substring(0,30),((se=B.notes)==null?void 0:se.length)>30?"...":""]})]}):c.jsx("span",{style:{color:"#DC2626",fontWeight:"600"},children:"No followup yet"})}),c.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:c.jsxs("div",{style:{display:"flex",gap:"4px",justifyContent:"center"},children:[_r&&c.jsx(Xe,{icon:md,small:!0,variant:"primary",onClick:()=>s4(U),title:"Add Followup"}),c.jsx(Xe,{icon:im,small:!0,variant:"brand",onClick:()=>xy(U),title:"Copy Email Template"}),c.jsx(Xe,{icon:X0,small:!0,variant:"success",onClick:()=>vy(U),title:"Search in Gmail"})]})})]}),Q.length>0&&c.jsx("tr",{children:c.jsxs("td",{colSpan:"8",style:{padding:"8px 12px 12px 40px",backgroundColor:"#F8FAFC"},children:[c.jsx("div",{style:{fontSize:"11px",fontWeight:"600",color:"#64748B",marginBottom:"6px"},children:"Followup History:"}),c.jsx("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:Q.map(fe=>c.jsxs("div",{style:{padding:"6px 10px",backgroundColor:"#FFFFFF",borderRadius:"6px",border:"1px solid #E2E8F0",fontSize:"11px"},children:[c.jsx("div",{style:{fontWeight:"600",color:"#2874A6"},children:St(fe.followupDate)}),c.jsx("div",{style:{color:"#475569",marginTop:"2px"},children:fe.notes}),fe.nextFollowupDate&&c.jsxs("div",{style:{color:"#DC2626",marginTop:"2px",fontSize:"10px"},children:["Next: ",St(fe.nextFollowupDate)]}),_r&&c.jsx("button",{onClick:()=>o4(fe.id),style:{background:"none",border:"none",color:"#DC2626",cursor:"pointer",fontSize:"10px",padding:"2px 0",marginTop:"4px"},children:" Delete"})]},fe.id))})]})})]},U.invoiceNo)})})]})]},`${_.partyName}|||${_.clientCode}`))]})},Iy=()=>{const h=Se.filter(B=>B.invoiceGenerated).reduce((B,oe)=>B+(parseFloat(oe.invoiceTotalAmount)||0),0),_=Se.filter(B=>B.invoiceStatus==="Paid").reduce((B,oe)=>B+(parseFloat(oe.invoiceTotalAmount)||0),0),U=Se.filter(B=>B.invoiceStatus==="Approved").reduce((B,oe)=>B+(parseFloat(oe.invoiceTotalAmount)||0),0),Q=Se.filter(B=>B.invoiceStatus==="Need Edits").length;return c.jsxs("div",{children:[c.jsx("h1",{style:{margin:"0 0 16px",fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:" Reports"}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"16px"},children:[c.jsxs(mn,{children:[c.jsx("div",{style:{fontSize:"14px",color:"#64748B",marginBottom:"8px"},children:"Total Invoiced"}),c.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:nt(h)})]}),c.jsxs(mn,{children:[c.jsx("div",{style:{fontSize:"14px",color:"#64748B",marginBottom:"8px"},children:"Approved"}),c.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#059669"},children:nt(U)})]}),c.jsxs(mn,{children:[c.jsx("div",{style:{fontSize:"14px",color:"#64748B",marginBottom:"8px"},children:"Need Edits"}),c.jsxs("div",{style:{fontSize:"24px",fontWeight:"700",color:"#DC2626"},children:[Q," invoices"]})]}),c.jsxs(mn,{children:[c.jsx("div",{style:{fontSize:"14px",color:"#64748B",marginBottom:"8px"},children:"Paid"}),c.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#059669"},children:nt(_)})]})]})]})},eb=()=>c.jsxs("div",{children:[c.jsx("h1",{style:{margin:"0 0 16px",fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:" Settings"}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px"},children:[c.jsxs(mn,{title:" Invoice Series",children:[c.jsx(Lr,{label:"Invoice Prefix",value:w.invoicePrefix,onChange:h=>N(_=>({..._,invoicePrefix:h.target.value})),small:!0}),c.jsx(Lr,{label:"Next Invoice Number",type:"number",value:it,onChange:h=>Z(parseInt(h.target.value)||1),small:!0}),c.jsx(Lr,{label:"Next Combine Code",type:"number",value:Rt,onChange:h=>wt(parseInt(h.target.value)||1),small:!0}),c.jsxs("div",{style:{padding:"10px",backgroundColor:"#EFF6FF",borderRadius:"8px",fontSize:"14px"},children:[c.jsx("strong",{children:"Preview:"})," ",w.invoicePrefix,it]})]}),c.jsxs(mn,{title:" Mailer Logo",children:[c.jsx("input",{type:"file",ref:wc,accept:"image/*",style:{display:"none"},onChange:F4}),zn?c.jsxs("div",{style:{textAlign:"center"},children:[c.jsx("img",{src:zn,alt:"Logo",style:{maxWidth:"250px",maxHeight:"60px",marginBottom:"12px",border:"1px solid #E2E8F0",padding:"8px",borderRadius:"8px"}}),c.jsxs("div",{style:{display:"flex",gap:"8px",justifyContent:"center"},children:[c.jsx(Xe,{icon:VL,label:"Change",small:!0,onClick:()=>{var h;return(h=wc.current)==null?void 0:h.click()}}),c.jsx(Xe,{icon:rs,label:"Remove",variant:"danger",small:!0,onClick:()=>pa(null)})]})]}):c.jsxs("div",{onClick:()=>{var h;return(h=wc.current)==null?void 0:h.click()},style:{border:"2px dashed #CBD5E1",borderRadius:"10px",padding:"30px",textAlign:"center",cursor:"pointer"},children:[c.jsx(Ys,{size:32,color:"#94A3B8",style:{marginBottom:"8px"}}),c.jsx("p",{style:{margin:0,color:"#64748B",fontSize:"14px"},children:"Click to upload"})]})]}),c.jsxs(mn,{title:" WhatsApp Notifications",children:[c.jsx("div",{style:{marginBottom:"16px"},children:c.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"10px",cursor:"pointer"},children:[c.jsx("input",{type:"checkbox",checked:kt.enabled,onChange:h=>da(_=>({..._,enabled:h.target.checked})),style:{width:"18px",height:"18px",cursor:"pointer"}}),c.jsx("span",{style:{fontSize:"14px",fontWeight:"600",color:"#1E293B"},children:"Enable WhatsApp Notifications"})]})}),kt.enabled&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{style:{padding:"12px",backgroundColor:"#DCFCE7",borderRadius:"8px",marginBottom:"16px",fontSize:"12px",color:"#166534",border:"1px solid #86EFAC"},children:[c.jsx("strong",{children:" FREE Setup using CallMeBot:"}),c.jsx("br",{}),"1. Save this number in contacts: ",c.jsx("strong",{children:"+34 644 71 81 99"}),c.jsx("br",{}),"2. Send this message to the number on WhatsApp: ",c.jsx("strong",{children:'"I allow callmebot to send me messages"'}),c.jsx("br",{}),"3. You'll receive an API key - enter it below",c.jsx("br",{}),"4. Repeat for each phone number you want to receive notifications"]}),c.jsxs("div",{style:{padding:"14px",backgroundColor:"#F8FAFC",borderRadius:"8px",marginBottom:"12px",border:"1px solid #E2E8F0"},children:[c.jsxs("div",{style:{fontSize:"13px",fontWeight:"700",color:"#1E293B",marginBottom:"10px",display:"flex",alignItems:"center",gap:"6px"},children:[c.jsx(q0,{size:16})," Finance Team"]}),c.jsx(Lr,{label:"Phone (with country code)",value:kt.financePhone,onChange:h=>da(_=>({..._,financePhone:h.target.value})),placeholder:"919876543210",small:!0}),c.jsx(Lr,{label:"API Key (from CallMeBot)",value:kt.financeApiKey,onChange:h=>da(_=>({..._,financeApiKey:h.target.value})),placeholder:"123456",small:!0}),kt.financePhone&&kt.financeApiKey&&c.jsx(Xe,{icon:iE,label:"Test Finance",variant:"success",small:!0,onClick:()=>Fl(kt.financePhone,kt.financeApiKey)})]}),c.jsxs("div",{style:{padding:"14px",backgroundColor:"#F8FAFC",borderRadius:"8px",border:"1px solid #E2E8F0"},children:[c.jsxs("div",{style:{fontSize:"13px",fontWeight:"700",color:"#1E293B",marginBottom:"10px",display:"flex",alignItems:"center",gap:"6px"},children:[c.jsx(q0,{size:16})," Director"]}),c.jsx(Lr,{label:"Phone (with country code)",value:kt.directorPhone,onChange:h=>da(_=>({..._,directorPhone:h.target.value})),placeholder:"919876543210",small:!0}),c.jsx(Lr,{label:"API Key (from CallMeBot)",value:kt.directorApiKey,onChange:h=>da(_=>({..._,directorApiKey:h.target.value})),placeholder:"123456",small:!0}),kt.directorPhone&&kt.directorApiKey&&c.jsx(Xe,{icon:iE,label:"Test Director",variant:"success",small:!0,onClick:()=>Fl(kt.directorPhone,kt.directorApiKey)})]})]}),!kt.enabled&&c.jsx("div",{style:{padding:"20px",backgroundColor:"#F8FAFC",borderRadius:"8px",textAlign:"center",color:"#64748B",fontSize:"13px"},children:"WhatsApp notifications are disabled. Enable to receive FREE alerts for invoices, approvals, and payments."})]}),c.jsxs(mn,{title:" Default Invoice Values",children:[c.jsx("input",{type:"file",ref:Tc,accept:".xlsx,.xls,.csv",style:{display:"none"},onChange:c4}),c.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"12px"},children:[c.jsx(Xe,{icon:Ys,label:"Upload",variant:"brand",small:!0,onClick:()=>{var h;return(h=Tc.current)==null?void 0:h.click()}}),c.jsx(Xe,{icon:Po,label:"Template",small:!0,onClick:u4})]}),Object.keys(Ui).length>0&&c.jsx("div",{style:{maxHeight:"180px",overflowY:"auto",border:"1px solid #E2E8F0",borderRadius:"8px"},children:Object.entries(Ui).map(([h,_])=>c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"10px 14px",borderBottom:"1px solid #F1F5F9",fontSize:"13px"},children:[c.jsx("span",{children:h}),c.jsx("span",{style:{fontWeight:"700"},children:nt(_)})]},h))})]}),c.jsxs(mn,{title:" Party Master",children:[c.jsx("input",{type:"file",ref:qu,accept:".xlsx,.xls,.csv",style:{display:"none"},onChange:d4}),c.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"12px"},children:[c.jsx(Xe,{icon:Ys,label:"Upload Parties",variant:"brand",small:!0,onClick:()=>{var h;return(h=qu.current)==null?void 0:h.click()}}),c.jsx(Xe,{icon:Po,label:"Template",small:!0,onClick:f4})]}),c.jsxs("div",{style:{padding:"10px",backgroundColor:"#EFF6FF",borderRadius:"8px",fontSize:"12px",color:"#1E40AF",marginBottom:"12px"},children:[c.jsx("strong",{children:"Upload Format:"})," Name of Ledger, Ledger Group, State Name, GST Registration Type, GSTIN/UIN"]}),Object.keys(an).length>0&&c.jsxs("div",{style:{maxHeight:"150px",overflowY:"auto",border:"1px solid #E2E8F0",borderRadius:"8px"},children:[Object.entries(an).slice(0,20).map(([h,_])=>c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px 12px",borderBottom:"1px solid #F1F5F9",fontSize:"11px"},children:[c.jsx("span",{style:{fontWeight:"600"},children:h.length>30?h.substring(0,30)+"...":h}),c.jsxs("span",{style:{color:"#64748B"},children:[_.stateName||"-"," | ",_.gstin?_.gstin.substring(0,10)+"...":"-"]})]},h)),Object.keys(an).length>20&&c.jsxs("div",{style:{padding:"8px 12px",textAlign:"center",color:"#64748B",fontSize:"11px"},children:["... and ",Object.keys(an).length-20," more parties"]})]}),Object.keys(an).length===0&&c.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#94A3B8",fontSize:"13px"},children:"No party master uploaded yet"})]}),c.jsxs(mn,{title:" Data Management",children:[c.jsxs("div",{style:{padding:"16px",backgroundColor:"#FEF2F2",borderRadius:"10px",border:"1px solid #FCA5A5",marginBottom:"16px"},children:[c.jsx("div",{style:{fontWeight:"700",color:"#991B1B",fontSize:"14px",marginBottom:"8px"},children:" Danger Zone"}),c.jsxs("div",{style:{fontSize:"13px",color:"#7F1D1D",marginBottom:"16px"},children:["This will permanently delete all data including:",c.jsxs("ul",{style:{margin:"8px 0 0 16px",padding:0},children:[c.jsx("li",{children:"All campaigns and master data"}),c.jsx("li",{children:"All invoices and receipts"}),c.jsx("li",{children:"All ledger entries"}),c.jsx("li",{children:"All mailer images"}),c.jsx("li",{children:"Opening balances and settings"})]})]}),c.jsx(Xe,{icon:rs,label:"Clear All Data",variant:"danger",onClick:()=>Us(!0)})]}),c.jsxs("div",{style:{fontSize:"12px",color:"#64748B"},children:[c.jsx("strong",{children:"Current Data:"}),c.jsx("br",{})," ",Se.length," campaigns",c.jsx("br",{})," ",ne.length," ledger entries",c.jsx("br",{})," ",je.length," receipts",c.jsx("br",{})," ",Object.keys(Ft).length," mailer images"]})]})]})]}),tb=()=>c.jsxs(c.Fragment,{children:[c.jsx(On,{isOpen:b4,onClose:()=>{Sy(!1),Ty("")},title:" Invoice Preview",width:"950px",children:le&&wy&&c.jsxs("div",{children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px",padding:"14px 18px",backgroundColor:"#DCFCE7",borderRadius:"10px",border:"2px solid #22C55E"},children:[c.jsxs("div",{children:[c.jsxs("span",{style:{fontWeight:"700",fontSize:"16px",color:"#166534"},children:["Invoice: ",le.invoiceNo]}),le.invoiceType==="Combined"&&c.jsxs("span",{style:{marginLeft:"12px",padding:"4px 10px",backgroundColor:"#7C3AED",color:"white",borderRadius:"6px",fontSize:"12px",fontWeight:"600"},children:["Combined - C",le.combinationCode]})]}),c.jsxs("button",{onClick:()=>N4(le),style:{padding:"14px 28px",fontSize:"16px",fontWeight:"bold",border:"none",borderRadius:"10px",cursor:"pointer",backgroundColor:"#22C55E",color:"white",display:"flex",alignItems:"center",gap:"10px",boxShadow:"0 2px 8px rgba(34, 197, 94, 0.4)"},children:[c.jsx(Po,{size:20}),"Download Invoice"]})]}),c.jsx("div",{style:{border:"2px solid #E2E8F0",borderRadius:"10px",overflow:"hidden",backgroundColor:"#f5f5f5"},children:c.jsx("iframe",{id:"invoice-viewer-iframe",srcDoc:wy,style:{width:"100%",height:"480px",border:"none",backgroundColor:"white"},title:"Invoice Preview"})}),c.jsxs("div",{style:{marginTop:"12px",padding:"14px 18px",backgroundColor:"#FEF3C7",borderRadius:"10px",border:"1px solid #FCD34D"},children:[c.jsx("div",{style:{fontSize:"14px",color:"#92400E",fontWeight:"600",marginBottom:"6px"},children:" How to Save as PDF:"}),c.jsxs("ol",{style:{fontSize:"13px",color:"#92400E",margin:"0",paddingLeft:"20px",lineHeight:"1.8"},children:[c.jsxs("li",{children:["Click ",c.jsx("strong",{children:'"Download Invoice"'})," button above"]}),c.jsxs("li",{children:["Open the downloaded ",c.jsx("strong",{children:".html file"})," in Chrome/Edge browser"]}),c.jsxs("li",{children:["Print dialog will open automatically - select ",c.jsx("strong",{children:'"Save as PDF"'})]}),c.jsxs("li",{children:["Click ",c.jsx("strong",{children:"Save"})," to get your PDF!"]})]})]})]})}),c.jsx(On,{isOpen:Or,onClose:()=>{Rn(!1),Mr(""),Ai({particularsApproved:!1,emailApproved:!1,invoiceTypeApproved:!1})},title:si?" Review & Approve Invoice":" Invoice Details",width:"550px",children:le&&c.jsxs("div",{children:[c.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px",borderRadius:"10px",marginBottom:"16px"},children:[c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Invoice:"})," ",le.invoiceNo]}),c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Party:"})," ",le.partyName]}),c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Amount:"})," ",nt(le.invoiceTotalAmount)]}),c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Email:"})," ",le.emailId||"Not set"]}),c.jsxs("div",{style:{fontSize:"14px"},children:[c.jsx("strong",{children:"Invoice Type:"})," ",c.jsx("span",{style:{color:le.invoiceType==="Combined"?"#7C3AED":"#2874A6",fontWeight:"600"},children:le.invoiceType||"Individual"})]}),le.invoiceType==="Combined"&&c.jsxs("div",{style:{marginTop:"8px",fontSize:"13px",color:"#7C3AED"},children:[c.jsx("strong",{children:"Combined Campaigns:"})," ",ue(le).map(h=>h.senderName).join(", ")]})]}),le.editComments&&c.jsxs("div",{style:{backgroundColor:"#FEE2E2",padding:"12px",borderRadius:"8px",marginBottom:"16px",border:"1px solid #FCA5A5"},children:[c.jsx("div",{style:{fontWeight:"600",color:"#991B1B",fontSize:"13px",marginBottom:"4px"},children:" Need Edits - Director Remarks:"}),c.jsx("div",{style:{fontSize:"13px",color:"#7F1D1D"},children:le.editComments})]}),le.approvalRemarks&&le.invoiceStatus==="Approved"&&c.jsxs("div",{style:{backgroundColor:"#DCFCE7",padding:"12px",borderRadius:"8px",marginBottom:"16px",border:"1px solid #86EFAC"},children:[c.jsx("div",{style:{fontWeight:"600",color:"#166534",fontSize:"13px",marginBottom:"4px"},children:" Approved - Director Remarks:"}),c.jsx("div",{style:{fontSize:"13px",color:"#15803D"},children:le.approvalRemarks})]}),si?c.jsxs("div",{style:{backgroundColor:"#F0FDF4",padding:"16px",borderRadius:"10px",marginBottom:"16px",border:"1px solid #86EFAC"},children:[c.jsx("div",{style:{fontWeight:"700",color:"#166534",fontSize:"14px",marginBottom:"12px"},children:" Approval Confirmations"}),c.jsxs("label",{style:{display:"flex",alignItems:"flex-start",gap:"10px",marginBottom:"12px",cursor:"pointer"},children:[c.jsx("input",{type:"checkbox",checked:_o.particularsApproved,onChange:h=>Ai(_=>({..._,particularsApproved:h.target.checked})),style:{marginTop:"2px",width:"18px",height:"18px",accentColor:"#059669"}}),c.jsxs("div",{children:[c.jsx("div",{style:{fontWeight:"600",fontSize:"13px",color:"#166534"},children:"1. Particulars & Amount Approved"}),c.jsxs("div",{style:{fontSize:"12px",color:"#15803D"},children:["I confirm that the invoice particulars and amount (",nt(le.invoiceTotalAmount),") are correct."]})]})]}),c.jsxs("label",{style:{display:"flex",alignItems:"flex-start",gap:"10px",marginBottom:"12px",cursor:"pointer"},children:[c.jsx("input",{type:"checkbox",checked:_o.emailApproved,onChange:h=>Ai(_=>({..._,emailApproved:h.target.checked})),style:{marginTop:"2px",width:"18px",height:"18px",accentColor:"#059669"}}),c.jsxs("div",{children:[c.jsx("div",{style:{fontWeight:"600",fontSize:"13px",color:"#166534"},children:"2. Email ID Approved for Mailing"}),c.jsxs("div",{style:{fontSize:"12px",color:"#15803D"},children:["I confirm that ",c.jsx("strong",{children:le.emailId||"the specified email"})," should be used for mailing."]})]})]}),c.jsxs("label",{style:{display:"flex",alignItems:"flex-start",gap:"10px",cursor:"pointer"},children:[c.jsx("input",{type:"checkbox",checked:_o.invoiceTypeApproved,onChange:h=>Ai(_=>({..._,invoiceTypeApproved:h.target.checked})),style:{marginTop:"2px",width:"18px",height:"18px",accentColor:"#059669"}}),c.jsxs("div",{children:[c.jsx("div",{style:{fontWeight:"600",fontSize:"13px",color:"#166534"},children:"3. Invoice Type Confirmed"}),c.jsx("div",{style:{fontSize:"12px",color:"#15803D"},children:le.invoiceType==="Combined"?`I confirm that a Combined Invoice is required for these ${ue(le).length} campaigns.`:"I confirm that an Individual Invoice is required (not combined with others)."})]})]})]}):c.jsxs("div",{style:{backgroundColor:le.invoiceStatus==="Approved"?"#DCFCE7":le.invoiceStatus==="Need Edits"?"#FEF3C7":"#F8FAFC",padding:"16px",borderRadius:"10px",marginBottom:"16px",border:"1px solid "+(le.invoiceStatus==="Approved"?"#86EFAC":le.invoiceStatus==="Need Edits"?"#FCD34D":"#E2E8F0")},children:[c.jsx("div",{style:{fontWeight:"600",color:le.invoiceStatus==="Approved"?"#166534":le.invoiceStatus==="Need Edits"?"#92400E":"#64748B",fontSize:"14px"},children:le.invoiceStatus==="Approved"?" Approved by Director":le.invoiceStatus==="Need Edits"?" Edits Required by Director":" Pending Director Approval"}),c.jsx("div",{style:{fontSize:"13px",color:le.invoiceStatus==="Approved"?"#15803D":le.invoiceStatus==="Need Edits"?"#A16207":"#64748B",marginTop:"6px"},children:le.invoiceStatus==="Approved"?"This invoice has been approved and is ready for mailing.":le.invoiceStatus==="Need Edits"?"Please make the required changes and resubmit for approval.":"This invoice is awaiting Director approval."})]}),si&&c.jsxs("div",{style:{marginBottom:"16px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:" Remarks (optional for Approve, visible to Finance)"}),c.jsx("textarea",{value:ca,onChange:h=>Mr(h.target.value),placeholder:"Enter remarks or comments...",style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"13px",minHeight:"80px",resize:"vertical",boxSizing:"border-box"}})]}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[c.jsx(Xe,{label:"Close",onClick:()=>{Rn(!1),Mr(""),Ai({particularsApproved:!1,emailApproved:!1,invoiceTypeApproved:!1})}}),si&&c.jsxs(c.Fragment,{children:[c.jsx(Xe,{label:"Need Edits",variant:"danger",icon:UL,onClick:Io}),c.jsx(Xe,{label:"Approve",variant:"success",icon:$L,onClick:Pn})]})]})]})}),c.jsx(On,{isOpen:vo,onClose:()=>yo(!1),title:" Delete Invoice",width:"450px",children:le&&c.jsxs("div",{children:[c.jsxs("div",{style:{backgroundColor:"#FEE2E2",padding:"16px",borderRadius:"10px",marginBottom:"16px",border:"1px solid #FCA5A5"},children:[c.jsx("div",{style:{fontWeight:"700",color:"#991B1B",fontSize:"15px",marginBottom:"8px"},children:" Are you sure?"}),c.jsxs("div",{style:{fontSize:"14px",color:"#7F1D1D",lineHeight:"1.5"},children:["This will delete invoice ",c.jsx("strong",{children:le.invoiceNo})," and reset the campaign(s) to allow re-generation.",le.invoiceType==="Combined"&&c.jsxs("div",{style:{marginTop:"8px"},children:[c.jsxs("strong",{children:["All ",ue(le).length," combined campaigns"]})," will be reset to Individual type for re-selection."]})]})]}),c.jsxs("div",{style:{backgroundColor:"#F8FAFC",padding:"12px",borderRadius:"8px",marginBottom:"16px"},children:[c.jsxs("div",{style:{fontSize:"13px"},children:[c.jsx("strong",{children:"Invoice:"})," ",le.invoiceNo]}),c.jsxs("div",{style:{fontSize:"13px"},children:[c.jsx("strong",{children:"Party:"})," ",le.partyName]}),c.jsxs("div",{style:{fontSize:"13px"},children:[c.jsx("strong",{children:"Amount:"})," ",nt(le.invoiceTotalAmount)]})]}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[c.jsx(Xe,{label:"Cancel",onClick:()=>yo(!1)}),c.jsx(Xe,{label:"Delete Invoice",variant:"danger",icon:rs,onClick:e4})]})]})}),c.jsx(On,{isOpen:Cr,onClose:()=>Pr(!1),title:" Add Email Address",width:"400px",children:le&&c.jsxs("div",{children:[c.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"12px",borderRadius:"8px",marginBottom:"16px"},children:[c.jsxs("div",{style:{fontSize:"13px"},children:[c.jsx("strong",{children:"Campaign:"})," ",le.senderName]}),c.jsxs("div",{style:{fontSize:"13px",marginTop:"4px"},children:[c.jsx("strong",{children:"Current:"})," ",le.emailId||"None"]})]}),c.jsx(Lr,{label:"Additional Email Address",type:"email",value:La,onChange:h=>gs(h.target.value),placeholder:"email@example.com",small:!0}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"16px"},children:[c.jsx(Xe,{label:"Cancel",onClick:()=>Pr(!1)}),c.jsx(Xe,{label:"Add Email",variant:"brand",icon:am,onClick:()=>{La&&La.includes("@")?(Tn(le.id,La),Pr(!1),gs("")):alert("Please enter a valid email address")}})]})]})}),c.jsx(On,{isOpen:C,onClose:()=>{E(!1),q({currentPassword:"",newPassword:"",confirmPassword:""}),T("")},title:" Change Password",width:"400px",children:c.jsxs("div",{children:[c.jsx("div",{style:{backgroundColor:"#EFF6FF",padding:"12px",borderRadius:"8px",marginBottom:"16px"},children:c.jsxs("div",{style:{fontSize:"13px"},children:[c.jsx("strong",{children:"User:"})," ",r==="director"?"Director":"Finance Team"]})}),c.jsxs("div",{style:{marginBottom:"16px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Current Password"}),c.jsx("input",{type:"password",value:O.currentPassword,onChange:h=>q(_=>({..._,currentPassword:h.target.value})),placeholder:"Enter current password",style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"14px",boxSizing:"border-box"}})]}),c.jsxs("div",{style:{marginBottom:"16px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"New Password"}),c.jsx("input",{type:"password",value:O.newPassword,onChange:h=>q(_=>({..._,newPassword:h.target.value})),placeholder:"Enter new password (min 6 characters)",style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"14px",boxSizing:"border-box"}})]}),c.jsxs("div",{style:{marginBottom:"16px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Confirm New Password"}),c.jsx("input",{type:"password",value:O.confirmPassword,onChange:h=>q(_=>({..._,confirmPassword:h.target.value})),placeholder:"Confirm new password",onKeyPress:h=>h.key==="Enter"&&bo(),style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"14px",boxSizing:"border-box"}})]}),H&&c.jsx("div",{style:{marginBottom:"16px",padding:"10px",backgroundColor:"#FEE2E2",borderRadius:"8px",color:"#991B1B",fontSize:"13px"},children:H}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:[c.jsx(Xe,{label:"Cancel",onClick:()=>{E(!1),q({currentPassword:"",newPassword:"",confirmPassword:""}),T("")}}),c.jsx(Xe,{label:"Change Password",variant:"brand",icon:Y0,onClick:bo})]})]})}),c.jsx(On,{isOpen:C,onClose:()=>{E(!1),T(""),q({currentPassword:"",newPassword:"",confirmPassword:""})},title:" Change Password",width:"400px",children:c.jsxs("div",{children:[c.jsx("div",{style:{backgroundColor:"#EFF6FF",padding:"12px",borderRadius:"8px",marginBottom:"16px"},children:c.jsxs("div",{style:{fontSize:"13px",color:"#1E40AF"},children:["Changing password for: ",c.jsx("strong",{children:r==="director"?"Director":"Finance Team"})]})}),c.jsxs("div",{style:{marginBottom:"16px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Current Password"}),c.jsx("input",{type:"password",value:O.currentPassword,onChange:h=>q(_=>({..._,currentPassword:h.target.value})),placeholder:"Enter current password",style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"14px",boxSizing:"border-box"}})]}),c.jsxs("div",{style:{marginBottom:"16px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"New Password"}),c.jsx("input",{type:"password",value:O.newPassword,onChange:h=>q(_=>({..._,newPassword:h.target.value})),placeholder:"Enter new password (min 6 chars)",style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"14px",boxSizing:"border-box"}})]}),c.jsxs("div",{style:{marginBottom:"16px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Confirm New Password"}),c.jsx("input",{type:"password",value:O.confirmPassword,onChange:h=>q(_=>({..._,confirmPassword:h.target.value})),placeholder:"Re-enter new password",style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"14px",boxSizing:"border-box"}})]}),H&&c.jsx("div",{style:{marginBottom:"16px",padding:"10px",backgroundColor:"#FEE2E2",borderRadius:"8px",color:"#991B1B",fontSize:"13px"},children:H}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:[c.jsx(Xe,{label:"Cancel",onClick:()=>{E(!1),T(""),q({currentPassword:"",newPassword:"",confirmPassword:""})}}),c.jsx(Xe,{label:"Change Password",variant:"brand",icon:Y0,onClick:bo})]})]})}),c.jsx(On,{isOpen:Si,onClose:()=>{xt(!1),So(new Set),Eo(null)},title:" Combine Invoices",width:"700px",children:ji&&c.jsxs("div",{children:[c.jsxs("div",{style:{backgroundColor:"#F3E8FF",padding:"14px 18px",borderRadius:"10px",marginBottom:"16px"},children:[c.jsxs("div",{style:{fontSize:"15px",fontWeight:"700",color:"#6B21A8"},children:["Party: ",ji]}),c.jsx("div",{style:{fontSize:"13px",color:"#7C3AED",marginTop:"4px"},children:"Select 2+ campaigns to combine into a single invoice"})]}),c.jsx("div",{style:{maxHeight:"350px",overflowY:"auto",border:"1px solid #E2E8F0",borderRadius:"10px"},children:c.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"13px"},children:[c.jsx("thead",{children:c.jsxs("tr",{style:{backgroundColor:"#F8FAFC",position:"sticky",top:0},children:[c.jsx("th",{style:{padding:"12px",textAlign:"center",width:"50px"},children:""}),c.jsx("th",{style:{padding:"12px",textAlign:"left"},children:"Sender"}),c.jsx("th",{style:{padding:"12px",textAlign:"left"},children:"Subject"}),c.jsx("th",{style:{padding:"12px",textAlign:"left"},children:"Date"}),c.jsx("th",{style:{padding:"12px",textAlign:"right"},children:"Amount"})]})}),c.jsx("tbody",{children:k(ji).map(h=>{var _;return c.jsxs("tr",{style:{borderBottom:"1px solid #F1F5F9",backgroundColor:Li.has(h.id)?"#F3E8FF":"transparent",cursor:"pointer"},onClick:()=>w4(h.id),children:[c.jsx("td",{style:{padding:"12px",textAlign:"center"},children:c.jsx("input",{type:"checkbox",checked:Li.has(h.id),onChange:()=>{},style:{width:"18px",height:"18px",cursor:"pointer"}})}),c.jsx("td",{style:{padding:"12px",fontWeight:"600"},children:h.senderName}),c.jsxs("td",{style:{padding:"12px",color:"#64748B"},children:[(_=h.subject)==null?void 0:_.substring(0,35),"..."]}),c.jsx("td",{style:{padding:"12px"},children:St(h.date)}),c.jsx("td",{style:{padding:"12px",textAlign:"right",fontWeight:"700"},children:nt(h.totalWithGst)})]},h.id)})})]})}),c.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px 18px",borderRadius:"10px",marginTop:"16px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[c.jsxs("div",{style:{fontSize:"14px",color:"#64748B"},children:["Selected: ",c.jsx("strong",{children:Li.size})," | Combine Code: ",c.jsxs("strong",{children:["C",Rt]})]}),c.jsxs("div",{style:{fontSize:"18px",fontWeight:"700",color:"#2874A6"},children:["Total: ",nt(Se.filter(h=>Li.has(h.id)).reduce((h,_)=>h+(parseFloat(_.totalWithGst)||0),0))]})]}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"16px"},children:[c.jsx(Xe,{label:"Cancel",onClick:()=>{xt(!1),So(new Set)}}),c.jsx(Xe,{label:"Create Combined Invoice",variant:"purple",icon:Oo,disabled:Li.size<2,onClick:S4})]})]})}),c.jsxs(On,{isOpen:Pi,onClose:()=>{Oi(!1),Vs(null),To(!1)},title:Yu?" Replace Mailer":" Upload Mailer",width:"550px",children:[c.jsx("input",{type:"file",ref:Co,accept:"image/*",style:{display:"none"},onChange:A4}),le&&c.jsxs("div",{children:[c.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px",borderRadius:"10px",marginBottom:"14px"},children:[c.jsxs("div",{style:{fontSize:"14px"},children:[c.jsx("strong",{children:"Sender:"})," ",le.senderName]}),c.jsxs("div",{style:{fontSize:"14px",marginTop:"4px"},children:[c.jsx("strong",{children:"Subject:"})," ",le.subject]})]}),Yu&&Ft[le.id]&&c.jsx("div",{style:{backgroundColor:"#FEF3C7",padding:"12px",borderRadius:"10px",marginBottom:"14px",border:"1px solid #FCD34D"},children:c.jsxs("div",{style:{fontWeight:"600",color:"#92400E",fontSize:"13px"},children:[" This will replace ",Ft[le.id].length," existing image(s)"]})}),c.jsxs("div",{style:{backgroundColor:"#FEF3C7",padding:"14px",borderRadius:"10px",marginBottom:"14px",border:"1px solid #FCD34D"},children:[c.jsx("div",{style:{fontWeight:"700",color:"#92400E",marginBottom:"8px",fontSize:"14px"},children:"Step 1: Find Mailer in Gmail"}),c.jsxs("button",{onClick:()=>k4(le.subject),style:{display:"flex",alignItems:"center",gap:"8px",padding:"10px 18px",backgroundColor:"#EA4335",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"14px",fontWeight:"600"},children:[c.jsx(jL,{size:16})," Search in Gmail"]})]}),c.jsxs("div",{style:{backgroundColor:"#F0FDF4",padding:"14px",borderRadius:"10px",border:"1px solid #86EFAC"},children:[c.jsx("div",{style:{fontWeight:"700",color:"#166534",marginBottom:"8px",fontSize:"14px"},children:"Step 2: Paste Screenshot"}),c.jsx("div",{ref:kr,tabIndex:0,onPaste:C4,onClick:()=>{var h;return(h=kr.current)==null?void 0:h.focus()},style:{border:wo?"3px solid #22C55E":"3px dashed #22C55E",borderRadius:"10px",padding:wo?"8px":"30px",textAlign:"center",cursor:"pointer",backgroundColor:wo?"#FFFFFF":"#ECFDF5",minHeight:"100px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",outline:"none"},children:wo?c.jsxs(c.Fragment,{children:[c.jsx("img",{src:wo,alt:"Pasted",style:{maxWidth:"100%",maxHeight:"200px",borderRadius:"8px",marginBottom:"10px"}}),c.jsxs("div",{style:{display:"flex",gap:"8px"},children:[c.jsx(Xe,{icon:tE,label:"Save",variant:"success",onClick:()=>_y(wo)}),c.jsx(Xe,{icon:rs,label:"Clear",variant:"danger",onClick:()=>Vs(null)})]})]}):c.jsxs(c.Fragment,{children:[c.jsx(im,{size:36,color:"#22C55E",style:{marginBottom:"8px"}}),c.jsx("div",{style:{fontWeight:"700",fontSize:"14px",color:"#166534"},children:"Click here & Press Ctrl+V"})]})}),c.jsxs("div",{style:{textAlign:"center",marginTop:"12px"},children:[c.jsx("span",{style:{color:"#64748B",fontSize:"13px"},children:" OR "}),c.jsx("div",{style:{marginTop:"8px"},children:c.jsx(Xe,{icon:Ys,label:"Browse Files",onClick:()=>{var h;return(h=Co.current)==null?void 0:h.click()}})})]})]})]})]}),c.jsx(On,{isOpen:Mi,onClose:()=>Vr(!1),title:" Send Invoice Email",width:"600px",children:le&&c.jsxs("div",{children:[c.jsxs("div",{style:{display:"flex",gap:"0",marginBottom:"16px",border:"2px solid #E2E8F0",borderRadius:"8px",overflow:"hidden"},children:[c.jsx("button",{onClick:()=>ja("reply"),style:{flex:1,padding:"12px",backgroundColor:la==="reply"?"#2874A6":"#F8FAFC",color:la==="reply"?"white":"#64748B",border:"none",cursor:"pointer",fontWeight:"700",fontSize:"14px"},children:" Reply to Thread"}),c.jsx("button",{onClick:()=>ja("new"),style:{flex:1,padding:"12px",backgroundColor:la==="new"?"#2874A6":"#F8FAFC",color:la==="new"?"white":"#64748B",border:"none",cursor:"pointer",fontWeight:"700",fontSize:"14px"},children:" New Email"})]}),c.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px",borderRadius:"10px",marginBottom:"16px"},children:[c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Invoice:"})," ",le.invoiceNo]}),c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Amount:"})," ",nt(le.invoiceTotalAmount||le.totalWithGst)]}),le.serviceType||le.isService?c.jsxs("div",{style:{fontSize:"13px",marginTop:"8px",color:"#92400E",backgroundColor:"#FEF3C7",padding:"6px 10px",borderRadius:"6px"},children:[c.jsx("strong",{children:"Type of Service:"})," ",(le.serviceType||"SERVICE").toUpperCase()]}):le.invoiceType==="Combined"&&c.jsxs("div",{style:{fontSize:"13px",marginTop:"8px",color:"#7C3AED"},children:[c.jsx("strong",{children:"Campaigns:"})," ",ue(le).map(h=>h.senderName).join(", ")]}),c.jsx("div",{style:{fontSize:"14px",marginTop:"8px"},children:c.jsx("strong",{children:"Recipients:"})}),c.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"6px",marginTop:"6px"},children:[Jt(le).map((h,_)=>c.jsx("span",{style:{padding:"4px 10px",backgroundColor:"#DBEAFE",borderRadius:"6px",fontSize:"13px",color:"#1E40AF"},children:h},_)),Jt(le).length===0&&c.jsx("span",{style:{color:"#94A3B8"},children:"No email addresses"})]})]}),la==="reply"?c.jsxs("div",{children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"8px"},children:[c.jsx("span",{style:{fontWeight:"700",fontSize:"14px"},children:"Email Body:"}),c.jsx("button",{onClick:()=>{navigator.clipboard.writeText(m0(le)),alert(" Copied!")},style:{padding:"6px 14px",backgroundColor:"#22C55E",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"13px",fontWeight:"600"},children:" Copy"})]}),c.jsx("div",{style:{fontSize:"13px",backgroundColor:"#F8FAFC",padding:"14px",borderRadius:"10px",whiteSpace:"pre-wrap",maxHeight:"200px",overflowY:"auto",fontFamily:"monospace",border:"1px solid #E2E8F0",lineHeight:"1.5"},children:m0(le)})]}):c.jsxs("div",{style:{display:"flex",gap:"10px"},children:[c.jsx("button",{onClick:()=>{const h=Jt(le),_=encodeURIComponent(h.join(",")),U=encodeURIComponent(Ey(le)),Q=encodeURIComponent(m0(le));window.open(`https://mail.google.com/mail/?view=cm&to=${_}&su=${U}&body=${Q}`,"_blank")},style:{padding:"12px 20px",backgroundColor:"#EA4335",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"14px",fontWeight:"700"},children:" Open Gmail"}),c.jsx("button",{onClick:()=>{const h=Jt(le),_=encodeURIComponent(h.join(";")),U=encodeURIComponent(Ey(le)),Q=encodeURIComponent(m0(le));window.open(`https://outlook.live.com/mail/0/deeplink/compose?to=${_}&subject=${U}&body=${Q}`,"_blank")},style:{padding:"12px 20px",backgroundColor:"#0078D4",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"14px",fontWeight:"700"},children:" Open Outlook"})]}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"16px"},children:[c.jsx(Xe,{label:"View Invoice",icon:Oc,onClick:()=>{Vr(!1),le.serviceType||le.isService?nd(le):td(le)}}),c.jsx(Xe,{label:"Close",onClick:()=>Vr(!1)})]})]})}),c.jsx(On,{isOpen:Bi,onClose:()=>cr(!1),title:" Record Payment",width:"500px",children:le&&c.jsxs("div",{children:[c.jsxs("div",{style:{backgroundColor:"#F0FDF4",padding:"14px",borderRadius:"10px",marginBottom:"16px"},children:[c.jsxs("div",{style:{fontSize:"14px"},children:[c.jsx("strong",{children:"Invoice:"})," ",le.invoiceNo]}),c.jsxs("div",{style:{fontSize:"14px",marginTop:"4px"},children:[c.jsx("strong",{children:"Party:"})," ",le.partyName]})]}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[c.jsx(Lr,{label:"Payment Amount",type:"number",value:yr.amount,onChange:h=>Ws({...yr,amount:h.target.value}),small:!0}),c.jsx(Lr,{label:"Date",type:"date",value:yr.date,onChange:h=>Ws({...yr,date:h.target.value}),small:!0})]}),c.jsx(ih,{label:"Payment Mode",value:yr.mode,onChange:h=>Ws({...yr,mode:h.target.value}),options:[{value:"Bank",label:"Bank Transfer"},{value:"UPI",label:"UPI"},{value:"Cheque",label:"Cheque"},{value:"Cash",label:"Cash"}],small:!0}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[c.jsx(Lr,{label:"TDS Deducted",type:"number",value:yr.tds,onChange:h=>Ws({...yr,tds:h.target.value}),placeholder:"0",small:!0}),c.jsx(Lr,{label:"Discount",type:"number",value:yr.discount,onChange:h=>Ws({...yr,discount:h.target.value}),placeholder:"0",small:!0})]}),c.jsx(Lr,{label:"Narration",value:yr.narration,onChange:h=>Ws({...yr,narration:h.target.value}),placeholder:"Reference",small:!0}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"16px"},children:[c.jsx(Xe,{label:"Cancel",onClick:()=>cr(!1)}),c.jsx(Xe,{label:"Record Payment",variant:"success",icon:BL,onClick:R4})]})]})}),c.jsxs(On,{isOpen:zr,onClose:()=>Ar(!1),title:" Set Opening Balance",width:"450px",children:[c.jsx(ih,{label:"Select Party",value:Dn.partyName,onChange:h=>Ji({...Dn,partyName:h.target.value}),options:[{value:"",label:"Choose a party..."},...$s.map(h=>({value:h,label:h}))],small:!0}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr",gap:"12px"},children:[c.jsx(Lr,{label:"Amount",type:"number",value:Dn.amount,onChange:h=>Ji({...Dn,amount:h.target.value}),small:!0}),c.jsx(ih,{label:"Type",value:Dn.type,onChange:h=>Ji({...Dn,type:h.target.value}),options:[{value:"Dr",label:"Debit"},{value:"Cr",label:"Credit"}],small:!0})]}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"16px"},children:[c.jsx(Xe,{label:"Cancel",onClick:()=>Ar(!1)}),c.jsx(Xe,{label:"Save",variant:"brand",onClick:()=>{Dn.partyName&&Dn.amount&&(_c(h=>({...h,[Dn.partyName]:Dn.type==="Dr"?parseFloat(Dn.amount):-parseFloat(Dn.amount)})),Ar(!1),Ji({partyName:"",amount:"",type:"Dr"}))}})]})]}),c.jsxs(On,{isOpen:hg,onClose:()=>Sc(!1),title:" Import Historical Ledger",width:"600px",children:[c.jsx("input",{type:"file",ref:Qu,accept:".xlsx,.xls,.csv",style:{display:"none"},onChange:h4}),c.jsxs("div",{style:{padding:"16px",backgroundColor:"#EFF6FF",borderRadius:"10px",marginBottom:"16px",border:"1px solid #BFDBFE"},children:[c.jsx("div",{style:{fontWeight:"700",color:"#1E40AF",marginBottom:"8px",fontSize:"14px"},children:" How to Import Historical Ledger"}),c.jsxs("div",{style:{fontSize:"12px",color:"#1E3A8A",lineHeight:"1.6"},children:[c.jsx("p",{style:{margin:"0 0 8px 0"},children:"Upload your existing ledger data in the format shown in the template. This will import all historical transactions."}),c.jsxs("p",{style:{margin:0},children:[c.jsx("strong",{children:"Supported columns:"})," Date, Particular, Vch Type, Vch No., Debit, Credit, Date of Receipt, Amount Received, TDS Received, Balance, Payment Status"]})]})]}),X&&c.jsxs("div",{style:{padding:"12px",backgroundColor:"#DCFCE7",borderRadius:"8px",marginBottom:"16px",border:"1px solid #86EFAC"},children:[c.jsxs("div",{style:{fontSize:"13px",color:"#166534"},children:[c.jsx("strong",{children:" Selected Party:"})," ",X]}),c.jsx("div",{style:{fontSize:"11px",color:"#15803D",marginTop:"4px"},children:"All entries from the uploaded file will be imported for this party"})]}),!X&&c.jsxs("div",{style:{padding:"12px",backgroundColor:"#FEE2E2",borderRadius:"8px",marginBottom:"16px",border:"1px solid #FCA5A5"},children:[c.jsx("div",{style:{fontSize:"13px",color:"#991B1B"},children:c.jsx("strong",{children:" No Party Selected"})}),c.jsx("div",{style:{fontSize:"12px",color:"#B91C1C",marginTop:"4px"},children:'Please close this modal and select a party from the Parties list on the left, then click "Import Historical" again.'})]}),c.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center",marginBottom:"16px"},children:[c.jsx(Xe,{icon:Po,label:"Download Template",variant:"brand",onClick:p4}),X?c.jsx(Xe,{icon:Ys,label:"Upload Ledger",variant:"success",onClick:()=>{var h;return(h=Qu.current)==null?void 0:h.click()}}):c.jsxs("button",{disabled:!0,style:{padding:"8px 16px",fontSize:"13px",fontWeight:"600",border:"none",borderRadius:"8px",backgroundColor:"#E2E8F0",color:"#94A3B8",cursor:"not-allowed",display:"flex",alignItems:"center",gap:"6px"},children:[c.jsx(Ys,{size:16})," Upload Ledger"]})]}),c.jsxs("div",{style:{padding:"14px",backgroundColor:"#F8FAFC",borderRadius:"8px",border:"1px solid #E2E8F0"},children:[c.jsx("div",{style:{fontWeight:"600",color:"#475569",marginBottom:"8px",fontSize:"13px"},children:" Expected Format (matches your ledger export):"}),c.jsx("div",{style:{overflowX:"auto"},children:c.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"10px"},children:[c.jsx("thead",{children:c.jsxs("tr",{style:{backgroundColor:"#E2E8F0"},children:[c.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"left"},children:"Date"}),c.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"left"},children:"Particular"}),c.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"left"},children:"Vch Type"}),c.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"left"},children:"Vch No."}),c.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"right"},children:"Debit"}),c.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"right"},children:"Credit"}),c.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"right"},children:"Amt Recd"}),c.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"left"},children:"Status"})]})}),c.jsx("tbody",{children:c.jsxs("tr",{children:[c.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0"},children:"02-Jun-21"}),c.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0"},children:"DB Corp Ltd"}),c.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0"},children:"Sales"}),c.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0"},children:"MB/2020-21/0411"}),c.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0",textAlign:"right"},children:"6,000"}),c.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0"}}),c.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0",textAlign:"right"},children:"44,371"}),c.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0"},children:"Received"})]})})]})})]}),c.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"16px"},children:c.jsx(Xe,{label:"Close",onClick:()=>Sc(!1)})})]}),c.jsx(On,{isOpen:Gu,onClose:()=>{Ls(!1),Qi({amount:"",tds:"",discount:"",narration:"",paymentAdvisory:null,date:new Date().toISOString().split("T")[0],mode:"Bank"})},title:" Create Receipt",width:"550px",children:le&&c.jsxs("div",{children:[c.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px",borderRadius:"10px",marginBottom:"16px"},children:[c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Invoice:"})," ",le.invoiceNo]}),c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Party:"})," ",le.partyName]}),c.jsxs("div",{style:{fontSize:"14px"},children:[c.jsx("strong",{children:"Invoice Amount:"})," ",nt(le.invoiceTotalAmount)]})]}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",marginBottom:"12px"},children:[c.jsx(Lr,{label:"Receipt Date",type:"date",value:Kt.date,onChange:h=>Qi({...Kt,date:h.target.value}),small:!0}),c.jsx(ih,{label:"Payment Mode",value:Kt.mode,onChange:h=>Qi({...Kt,mode:h.target.value}),options:[{value:"Bank",label:"Bank Transfer"},{value:"Cash",label:"Cash"},{value:"Cheque",label:"Cheque"},{value:"UPI",label:"UPI"}],small:!0})]}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"12px",marginBottom:"12px"},children:[c.jsx(Lr,{label:"Amount Received",type:"number",value:Kt.amount,onChange:h=>Qi({...Kt,amount:h.target.value}),placeholder:"0.00",small:!0}),c.jsx(Lr,{label:"TDS Deducted",type:"number",value:Kt.tds,onChange:h=>Qi({...Kt,tds:h.target.value}),placeholder:"0.00",small:!0}),c.jsx(Lr,{label:"Discount",type:"number",value:Kt.discount,onChange:h=>Qi({...Kt,discount:h.target.value}),placeholder:"0.00",small:!0})]}),c.jsx("div",{style:{backgroundColor:"#F0FDF4",padding:"12px",borderRadius:"8px",marginBottom:"16px"},children:c.jsxs("div",{style:{fontSize:"14px",fontWeight:"700",color:"#166534"},children:["Total Credit: ",nt((parseFloat(Kt.amount)||0)+(parseFloat(Kt.tds)||0)+(parseFloat(Kt.discount)||0))]})}),c.jsx(Lr,{label:"Narration",value:Kt.narration,onChange:h=>Qi({...Kt,narration:h.target.value}),placeholder:"Payment reference, remarks...",small:!0}),c.jsxs("div",{style:{marginBottom:"16px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Payment Advisory (Optional)"}),c.jsx("input",{type:"file",ref:d0,accept:"image/*,.pdf",onChange:ZF,style:{display:"none"}}),Kt.paymentAdvisory?c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[c.jsx("div",{style:{flex:1,padding:"10px",backgroundColor:"#F0FDF4",borderRadius:"8px",fontSize:"13px",color:"#166534"},children:" Payment advisory attached"}),c.jsx("button",{onClick:()=>Qi(h=>({...h,paymentAdvisory:null})),style:{padding:"8px",border:"none",backgroundColor:"#FEE2E2",borderRadius:"6px",cursor:"pointer",color:"#991B1B"},children:c.jsx(wa,{size:16})})]}):c.jsxs("button",{onClick:()=>{var h;return(h=d0.current)==null?void 0:h.click()},style:{padding:"10px 16px",border:"1.5px dashed #D1D5DB",borderRadius:"8px",backgroundColor:"#F9FAFB",cursor:"pointer",fontSize:"13px",color:"#6B7280",display:"flex",alignItems:"center",gap:"8px"},children:[c.jsx(Ys,{size:16})," Attach Payment Advisory"]})]}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[c.jsx(Xe,{label:"Cancel",onClick:()=>Ls(!1)}),c.jsx(Xe,{label:"Create Receipt",variant:"success",icon:Oo,onClick:kc})]})]})}),c.jsx(On,{isOpen:Al,onClose:()=>{oa(!1),fa({amount:"",gst:"",reason:"",date:new Date().toISOString().split("T")[0]})},title:" Create Credit Note",width:"500px",children:le&&(()=>{var oe;const h=(oe=le.statePartyDetails)==null?void 0:oe.toUpperCase().includes("MAHARASHTRA"),_=h?"CGST + SGST (9% + 9%)":"IGST (18%)",U=parseFloat(fn.amount)||0,Q=parseFloat(fn.gst)||0,B=U+Q;return c.jsxs("div",{children:[c.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px",borderRadius:"10px",marginBottom:"16px"},children:[c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Invoice:"})," ",le.invoiceNo]}),c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Party:"})," ",le.partyName]}),c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Invoice Amount:"})," ",nt(le.invoiceTotalAmount)]}),c.jsxs("div",{style:{fontSize:"12px",color:"#2563EB"},children:[c.jsx("strong",{children:"GST Type:"})," ",h?"CGST + SGST (Intra-state)":"IGST (Inter-state)"]})]}),c.jsx("div",{style:{marginBottom:"12px"},children:c.jsx(Lr,{label:"Credit Note Date",type:"date",value:fn.date,onChange:L=>fa({...fn,date:L.target.value}),small:!0})}),c.jsxs("div",{style:{backgroundColor:"#FEF2F2",padding:"14px",borderRadius:"10px",marginBottom:"12px",border:"1px solid #FECACA"},children:[c.jsx("div",{style:{fontWeight:"700",color:"#991B1B",marginBottom:"10px",fontSize:"13px"},children:" Credit Note Breakdown"}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[c.jsx(Lr,{label:"Base Amount",type:"number",value:fn.amount,onChange:L=>fa({...fn,amount:L.target.value}),placeholder:"0.00",small:!0}),c.jsx(Lr,{label:_,type:"number",value:fn.gst,onChange:L=>fa({...fn,gst:L.target.value}),placeholder:"0.00",small:!0})]}),c.jsxs("div",{style:{marginTop:"10px",padding:"8px",backgroundColor:"#FEE2E2",borderRadius:"6px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[c.jsx("span",{style:{fontSize:"13px",fontWeight:"600",color:"#991B1B"},children:"Total Credit:"}),c.jsx("span",{style:{fontSize:"15px",fontWeight:"700",color:"#991B1B"},children:nt(B)})]})]}),c.jsxs("div",{style:{marginBottom:"16px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Reason for Credit Note *"}),c.jsx("textarea",{value:fn.reason,onChange:L=>fa({...fn,reason:L.target.value}),placeholder:"Enter reason for issuing credit note...",style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"13px",minHeight:"80px",resize:"vertical",boxSizing:"border-box"}})]}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[c.jsx(Xe,{label:"Cancel",onClick:()=>oa(!1)}),c.jsx(Xe,{label:"Create Credit Note",variant:"danger",icon:pd,onClick:JF})]})]})})()}),c.jsx(On,{isOpen:Ua,onClose:()=>{qi(!1),ua(null)},title:" Add Followup",width:"500px",children:lr&&c.jsxs("div",{children:[c.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px",borderRadius:"10px",marginBottom:"16px"},children:[c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Invoice:"})," ",lr.invoiceNo]}),c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Party:"})," ",lr.partyName]}),c.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[c.jsx("strong",{children:"Amount:"})," ",nt(lr.invoiceTotalAmount||lr.totalAmount)]}),c.jsxs("div",{style:{fontSize:"14px"},children:[c.jsx("strong",{children:"Invoice Date:"})," ",St(lr.invoiceDate||lr.date)]})]}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",marginBottom:"12px"},children:[c.jsx(Lr,{label:"Followup Date",type:"date",value:Sr.date,onChange:h=>Va({...Sr,date:h.target.value}),small:!0}),c.jsx(Lr,{label:"Next Followup Date",type:"date",value:Sr.nextFollowupDate,onChange:h=>Va({...Sr,nextFollowupDate:h.target.value}),small:!0})]}),c.jsxs("div",{style:{marginBottom:"16px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Followup Notes *"}),c.jsx("textarea",{value:Sr.notes,onChange:h=>Va({...Sr,notes:h.target.value}),placeholder:"Enter followup notes (e.g., Spoke with accounts team, payment promised by next week)",style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"13px",minHeight:"80px",resize:"vertical",boxSizing:"border-box"}})]}),c.jsxs("div",{style:{marginBottom:"16px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Status"}),c.jsxs("select",{value:Sr.status,onChange:h=>Va({...Sr,status:h.target.value}),style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"13px"},children:[c.jsx("option",{value:"Pending",children:"Pending"}),c.jsx("option",{value:"Promised",children:"Promised - Payment Expected"}),c.jsx("option",{value:"Disputed",children:"Disputed"}),c.jsx("option",{value:"No Response",children:"No Response"})]})]}),c.jsxs("div",{style:{backgroundColor:"#F0FDF4",padding:"12px",borderRadius:"8px",marginBottom:"16px",border:"1px solid #86EFAC"},children:[c.jsx("div",{style:{fontSize:"12px",fontWeight:"600",color:"#166534",marginBottom:"8px"},children:" Quick Actions"}),c.jsxs("div",{style:{display:"flex",gap:"8px"},children:[c.jsx(Xe,{icon:im,label:"Copy Email Template",small:!0,variant:"brand",onClick:()=>xy(lr)}),c.jsx(Xe,{icon:X0,label:"Search in Gmail",small:!0,variant:"success",onClick:()=>vy(lr)})]})]}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[c.jsx(Xe,{label:"Cancel",onClick:()=>qi(!1)}),c.jsx(Xe,{label:"Save Followup",variant:"primary",icon:md,onClick:a4})]})]})}),c.jsx(On,{isOpen:Ba,onClose:()=>Us(!1),title:" Clear All Data",width:"500px",children:c.jsxs("div",{children:[c.jsxs("div",{style:{backgroundColor:"#FEE2E2",padding:"20px",borderRadius:"12px",marginBottom:"20px",border:"2px solid #FCA5A5"},children:[c.jsxs("div",{style:{fontWeight:"700",color:"#991B1B",fontSize:"18px",marginBottom:"12px",display:"flex",alignItems:"center",gap:"8px"},children:[c.jsx(q_,{size:24})," Warning: This action cannot be undone!"]}),c.jsxs("div",{style:{fontSize:"14px",color:"#7F1D1D",lineHeight:"1.6"},children:["This will permanently delete:",c.jsxs("ul",{style:{margin:"12px 0 0 20px",padding:0},children:[c.jsxs("li",{children:[c.jsx("strong",{children:Se.length})," campaigns from Master Sheet"]}),c.jsxs("li",{children:[c.jsx("strong",{children:Se.filter(h=>h.invoiceGenerated).length})," generated invoices"]}),c.jsxs("li",{children:[c.jsx("strong",{children:je.length})," receipts"]}),c.jsxs("li",{children:[c.jsx("strong",{children:te.length})," credit notes"]}),c.jsxs("li",{children:[c.jsx("strong",{children:ne.length})," ledger entries"]}),c.jsxs("li",{children:[c.jsx("strong",{children:Object.keys(Ft).length})," mailer images"]}),c.jsx("li",{children:"All opening balances"})]})]})]}),c.jsx("div",{style:{backgroundColor:"#FEF3C7",padding:"14px",borderRadius:"8px",marginBottom:"20px",border:"1px solid #FCD34D"},children:c.jsxs("div",{style:{fontSize:"13px",color:"#92400E"},children:[c.jsx("strong",{children:"Note:"})," Invoice series numbers will be reset to 1. Your company settings and mailer logo will be preserved."]})}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:[c.jsx(Xe,{label:"Cancel",onClick:()=>Us(!1)}),c.jsx(Xe,{label:"Yes, Clear All Data",variant:"danger",icon:rs,onClick:y4})]})]})}),c.jsx(On,{isOpen:ur,onClose:()=>ir(!1),title:" Notifications",width:"550px",children:c.jsxs("div",{children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[c.jsx("div",{style:{fontSize:"14px",color:"#64748B"},children:_s>0?`${_s} unread`:"No unread notifications"}),c.jsxs("div",{style:{display:"flex",gap:"8px"},children:[_s>0&&c.jsx("button",{onClick:za,style:{padding:"6px 12px",fontSize:"12px",fontWeight:"600",border:"1px solid #E2E8F0",borderRadius:"6px",backgroundColor:"#F8FAFC",color:"#475569",cursor:"pointer"},children:"Mark all as read"}),$e.length>0&&_r&&c.jsx("button",{onClick:p0,style:{padding:"6px 12px",fontSize:"12px",fontWeight:"600",border:"1px solid #FCA5A5",borderRadius:"6px",backgroundColor:"#FEE2E2",color:"#991B1B",cursor:"pointer"},children:"Clear all"})]})]}),c.jsx("div",{style:{maxHeight:"400px",overflowY:"auto"},children:bl.length===0?c.jsxs("div",{style:{padding:"40px",textAlign:"center",color:"#94A3B8"},children:[c.jsx(J_,{size:40,style:{marginBottom:"12px",opacity:.5}}),c.jsx("div",{style:{fontSize:"16px",fontWeight:"600"},children:"No notifications"}),c.jsx("div",{style:{fontSize:"13px",marginTop:"4px"},children:"You're all caught up!"})]}):bl.map(h=>{const _=!(h.read&&h.read[r]),U=B=>{switch(B){case"upload":return"";case"invoice":return"";case"approval":return"";case"edit":return"";case"receipt":return"";default:return""}},Q=B=>{switch(B){case"upload":return"#EFF6FF";case"invoice":return"#FEF3C7";case"approval":return"#DCFCE7";case"edit":return"#FEE2E2";case"receipt":return"#F0FDF4";default:return"#F8FAFC"}};return c.jsx("div",{onClick:()=>h0(h.id),style:{padding:"14px",borderRadius:"10px",marginBottom:"8px",backgroundColor:_?Q(h.type):"#F8FAFC",border:_?"2px solid #2874A6":"1px solid #E2E8F0",cursor:"pointer",transition:"all 0.2s ease"},children:c.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"12px"},children:[c.jsx("div",{style:{fontSize:"20px"},children:U(h.type)}),c.jsxs("div",{style:{flex:1},children:[c.jsx("div",{style:{fontSize:"14px",fontWeight:_?"600":"500",color:"#1E293B",lineHeight:"1.4"},children:h.message}),c.jsxs("div",{style:{display:"flex",gap:"12px",marginTop:"8px",fontSize:"11px",color:"#64748B"},children:[c.jsxs("span",{children:["By: ",h.createdBy==="finance"?"Finance Team":"Director"]}),c.jsx("span",{children:""}),c.jsx("span",{children:new Date(h.createdAt).toLocaleString()})]})]}),_&&c.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:"#DC2626",flexShrink:0}})]})},h.id)})})]})})]}),rb=()=>{switch(D){case"master":return ky();case"services":return L4();case"invoices":return H4();case"receipts":return q4();case"ledgers":return Q4();case"followups":return Z4();case"reports":return Iy();case"settings":return r==="finance"?eb():Iy();default:return ky()}},nb=()=>c.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, #1E3A5F 0%, #2874A6 50%, #1E3A5F 100%)",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',padding:"20px"},children:c.jsxs("div",{style:{backgroundColor:"#FFFFFF",padding:"0",borderRadius:"24px",boxShadow:"0 25px 50px -12px rgba(0,0,0,0.25)",width:"420px",maxWidth:"95vw",overflow:"hidden"},children:[c.jsxs("div",{style:{background:"linear-gradient(135deg, #1E3A5F 0%, #2874A6 100%)",padding:"32px 40px",textAlign:"center"},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"12px",marginBottom:"8px"},children:[c.jsx("img",{src:"/logo.png",alt:"JAC",style:{width:"60px",height:"auto",borderRadius:"8px",backgroundColor:"white",padding:"4px"}}),c.jsx("span",{style:{fontSize:"36px",fontWeight:"800",color:"#FFFFFF",letterSpacing:"-1px"},children:"FinMate"})]}),c.jsx("p",{style:{margin:0,color:"rgba(255,255,255,0.8)",fontSize:"14px",fontWeight:"500"},children:"Finance Management System"})]}),c.jsxs("div",{style:{padding:"32px 40px"},children:[c.jsxs("div",{style:{marginBottom:"24px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#1E3A5F",marginBottom:"8px",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Username"}),c.jsxs("div",{style:{position:"relative"},children:[c.jsx(aE,{size:18,style:{position:"absolute",left:"14px",top:"50%",transform:"translateY(-50%)",color:"#94A3B8"}}),c.jsx("input",{type:"text",value:i.username,onChange:h=>s(_=>({..._,username:h.target.value})),placeholder:"Enter username",style:{width:"100%",padding:"14px 14px 14px 44px",borderRadius:"12px",border:"2px solid #E2E8F0",fontSize:"15px",boxSizing:"border-box",transition:"border-color 0.2s, box-shadow 0.2s",outline:"none"},onFocus:h=>{h.target.style.borderColor="#2874A6",h.target.style.boxShadow="0 0 0 3px rgba(40,116,166,0.1)"},onBlur:h=>{h.target.style.borderColor="#E2E8F0",h.target.style.boxShadow="none"}})]})]}),c.jsxs("div",{style:{marginBottom:"28px"},children:[c.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#1E3A5F",marginBottom:"8px",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Password"}),c.jsxs("div",{style:{position:"relative"},children:[c.jsx(Y0,{size:18,style:{position:"absolute",left:"14px",top:"50%",transform:"translateY(-50%)",color:"#94A3B8"}}),c.jsx("input",{type:"password",value:i.password,onChange:h=>s(_=>({..._,password:h.target.value})),placeholder:"Enter password",onKeyPress:h=>h.key==="Enter"&&ed(),style:{width:"100%",padding:"14px 14px 14px 44px",borderRadius:"12px",border:"2px solid #E2E8F0",fontSize:"15px",boxSizing:"border-box",transition:"border-color 0.2s, box-shadow 0.2s",outline:"none"},onFocus:h=>{h.target.style.borderColor="#2874A6",h.target.style.boxShadow="0 0 0 3px rgba(40,116,166,0.1)"},onBlur:h=>{h.target.style.borderColor="#E2E8F0",h.target.style.boxShadow="none"}})]})]}),a&&c.jsxs("div",{style:{marginBottom:"20px",padding:"14px",backgroundColor:"#FEF2F2",borderRadius:"12px",color:"#DC2626",fontSize:"14px",textAlign:"center",border:"1px solid #FECACA",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[c.jsx(q_,{size:18}),a]}),c.jsx("button",{onClick:ed,style:{width:"100%",padding:"16px",fontSize:"16px",fontWeight:"700",border:"none",borderRadius:"12px",cursor:S?"pointer":"wait",background:S?"linear-gradient(135deg, #1E3A5F 0%, #2874A6 100%)":"#94A3B8",color:"white",transition:"transform 0.2s, box-shadow 0.2s",boxShadow:S?"0 4px 14px rgba(40,116,166,0.4)":"none",opacity:S?1:.7},disabled:!S,onMouseOver:h=>{S&&(h.target.style.transform="translateY(-2px)",h.target.style.boxShadow="0 6px 20px rgba(40,116,166,0.5)")},onMouseOut:h=>{S&&(h.target.style.transform="translateY(0)",h.target.style.boxShadow="0 4px 14px rgba(40,116,166,0.4)")},children:S?"Sign In":"Loading..."}),c.jsxs("div",{style:{marginTop:"24px",textAlign:"center",color:"#94A3B8",fontSize:"12px"},children:[c.jsx("span",{children:"Powered by "}),c.jsx("span",{style:{fontWeight:"600",color:"#1E3A5F"},children:"JAC"}),c.jsx("span",{children:"  Strategy | Talent | Results"})]})]})]})});return t?l?c.jsxs("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, #1E3A5F 0%, #2874A6 50%, #1E3A5F 100%)",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:[c.jsxs("div",{style:{textAlign:"center"},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"12px",marginBottom:"24px"},children:[c.jsx("img",{src:"/logo.png",alt:"JAC",style:{width:"50px",height:"auto",borderRadius:"8px",backgroundColor:"white",padding:"4px"}}),c.jsx("span",{style:{fontSize:"32px",fontWeight:"800",color:"#FFFFFF",letterSpacing:"-1px"},children:"FinMate"})]}),c.jsx(rE,{size:48,style:{animation:"spin 1s linear infinite",color:"#FFFFFF",marginBottom:"16px"}}),c.jsx("div",{style:{fontSize:"18px",fontWeight:"600",color:"#FFFFFF"},children:"Loading your data..."}),c.jsx("div",{style:{fontSize:"14px",color:"rgba(255,255,255,0.7)",marginTop:"8px"},children:"Please wait while we sync with the cloud"})]}),c.jsx("style",{children:"@keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }"})]}):c.jsxs("div",{style:{display:"flex",height:"100vh",backgroundColor:"#F1F5F9",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:[D4(),c.jsx("main",{style:{flex:1,overflow:"auto",padding:"20px"},children:rb()}),tb(),c.jsx("style",{children:"@keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }"})]}):nb()}ym.createRoot(document.getElementById("root")).render(c.jsx(oh.StrictMode,{children:c.jsx(D$,{})}));
