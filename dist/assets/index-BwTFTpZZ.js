(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();function nF(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var JE={exports:{}},lp={},ZE={exports:{}},Tt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var c0=Symbol.for("react.element"),iF=Symbol.for("react.portal"),sF=Symbol.for("react.fragment"),aF=Symbol.for("react.strict_mode"),oF=Symbol.for("react.profiler"),lF=Symbol.for("react.provider"),cF=Symbol.for("react.context"),uF=Symbol.for("react.forward_ref"),fF=Symbol.for("react.suspense"),dF=Symbol.for("react.memo"),hF=Symbol.for("react.lazy"),dy=Symbol.iterator;function pF(t){return t===null||typeof t!="object"?null:(t=dy&&t[dy]||t["@@iterator"],typeof t=="function"?t:null)}var ew={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},tw=Object.assign,rw={};function au(t,e,r){this.props=t,this.context=e,this.refs=rw,this.updater=r||ew}au.prototype.isReactComponent={};au.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};au.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function nw(){}nw.prototype=au.prototype;function Fx(t,e,r){this.props=t,this.context=e,this.refs=rw,this.updater=r||ew}var Ix=Fx.prototype=new nw;Ix.constructor=Fx;tw(Ix,au.prototype);Ix.isPureReactComponent=!0;var hy=Array.isArray,iw=Object.prototype.hasOwnProperty,bx={current:null},sw={key:!0,ref:!0,__self:!0,__source:!0};function aw(t,e,r){var n,i={},s=null,a=null;if(e!=null)for(n in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(s=""+e.key),e)iw.call(e,n)&&!sw.hasOwnProperty(n)&&(i[n]=e[n]);var o=arguments.length-2;if(o===1)i.children=r;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];i.children=l}if(t&&t.defaultProps)for(n in o=t.defaultProps,o)i[n]===void 0&&(i[n]=o[n]);return{$$typeof:c0,type:t,key:s,ref:a,props:i,_owner:bx.current}}function gF(t,e){return{$$typeof:c0,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Rx(t){return typeof t=="object"&&t!==null&&t.$$typeof===c0}function mF(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var py=/\/+/g;function qp(t,e){return typeof t=="object"&&t!==null&&t.key!=null?mF(""+t.key):e.toString(36)}function Vd(t,e,r,n,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case c0:case iF:a=!0}}if(a)return a=t,i=i(a),t=n===""?"."+qp(a,0):n,hy(i)?(r="",t!=null&&(r=t.replace(py,"$&/")+"/"),Vd(i,e,r,"",function(c){return c})):i!=null&&(Rx(i)&&(i=gF(i,r+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(py,"$&/")+"/")+t)),e.push(i)),1;if(a=0,n=n===""?".":n+":",hy(t))for(var o=0;o<t.length;o++){s=t[o];var l=n+qp(s,o);a+=Vd(s,e,r,l,i)}else if(l=pF(t),typeof l=="function")for(t=l.call(t),o=0;!(s=t.next()).done;)s=s.value,l=n+qp(s,o++),a+=Vd(s,e,r,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function rd(t,e,r){if(t==null)return t;var n=[],i=0;return Vd(t,n,"","",function(s){return e.call(r,s,i++)}),n}function xF(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var oi={current:null},Ud={transition:null},vF={ReactCurrentDispatcher:oi,ReactCurrentBatchConfig:Ud,ReactCurrentOwner:bx};function ow(){throw Error("act(...) is not supported in production builds of React.")}Tt.Children={map:rd,forEach:function(t,e,r){rd(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return rd(t,function(){e++}),e},toArray:function(t){return rd(t,function(e){return e})||[]},only:function(t){if(!Rx(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Tt.Component=au;Tt.Fragment=sF;Tt.Profiler=oF;Tt.PureComponent=Fx;Tt.StrictMode=aF;Tt.Suspense=fF;Tt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=vF;Tt.act=ow;Tt.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=tw({},t.props),i=t.key,s=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,a=bx.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var o=t.type.defaultProps;for(l in e)iw.call(e,l)&&!sw.hasOwnProperty(l)&&(n[l]=e[l]===void 0&&o!==void 0?o[l]:e[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var c=0;c<l;c++)o[c]=arguments[c+2];n.children=o}return{$$typeof:c0,type:t.type,key:i,ref:s,props:n,_owner:a}};Tt.createContext=function(t){return t={$$typeof:cF,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:lF,_context:t},t.Consumer=t};Tt.createElement=aw;Tt.createFactory=function(t){var e=aw.bind(null,t);return e.type=t,e};Tt.createRef=function(){return{current:null}};Tt.forwardRef=function(t){return{$$typeof:uF,render:t}};Tt.isValidElement=Rx;Tt.lazy=function(t){return{$$typeof:hF,_payload:{_status:-1,_result:t},_init:xF}};Tt.memo=function(t,e){return{$$typeof:dF,type:t,compare:e===void 0?null:e}};Tt.startTransition=function(t){var e=Ud.transition;Ud.transition={};try{t()}finally{Ud.transition=e}};Tt.unstable_act=ow;Tt.useCallback=function(t,e){return oi.current.useCallback(t,e)};Tt.useContext=function(t){return oi.current.useContext(t)};Tt.useDebugValue=function(){};Tt.useDeferredValue=function(t){return oi.current.useDeferredValue(t)};Tt.useEffect=function(t,e){return oi.current.useEffect(t,e)};Tt.useId=function(){return oi.current.useId()};Tt.useImperativeHandle=function(t,e,r){return oi.current.useImperativeHandle(t,e,r)};Tt.useInsertionEffect=function(t,e){return oi.current.useInsertionEffect(t,e)};Tt.useLayoutEffect=function(t,e){return oi.current.useLayoutEffect(t,e)};Tt.useMemo=function(t,e){return oi.current.useMemo(t,e)};Tt.useReducer=function(t,e,r){return oi.current.useReducer(t,e,r)};Tt.useRef=function(t){return oi.current.useRef(t)};Tt.useState=function(t){return oi.current.useState(t)};Tt.useSyncExternalStore=function(t,e,r){return oi.current.useSyncExternalStore(t,e,r)};Tt.useTransition=function(){return oi.current.useTransition()};Tt.version="18.3.1";ZE.exports=Tt;var ye=ZE.exports;const zd=nF(ye);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yF=ye,_F=Symbol.for("react.element"),EF=Symbol.for("react.fragment"),wF=Object.prototype.hasOwnProperty,TF=yF.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,SF={key:!0,ref:!0,__self:!0,__source:!0};function lw(t,e,r){var n,i={},s=null,a=null;r!==void 0&&(s=""+r),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(a=e.ref);for(n in e)wF.call(e,n)&&!SF.hasOwnProperty(n)&&(i[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)i[n]===void 0&&(i[n]=e[n]);return{$$typeof:_F,type:t,key:s,ref:a,props:i,_owner:TF.current}}lp.Fragment=EF;lp.jsx=lw;lp.jsxs=lw;JE.exports=lp;var f=JE.exports,tm={},cw={exports:{}},Wi={},uw={exports:{}},fw={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(_e,Q){var ke=_e.length;_e.push(Q);e:for(;0<ke;){var Le=ke-1>>>1,j=_e[Le];if(0<i(j,Q))_e[Le]=Q,_e[ke]=j,ke=Le;else break e}}function r(_e){return _e.length===0?null:_e[0]}function n(_e){if(_e.length===0)return null;var Q=_e[0],ke=_e.pop();if(ke!==Q){_e[0]=ke;e:for(var Le=0,j=_e.length,H=j>>>1;Le<H;){var q=2*(Le+1)-1,Y=_e[q],de=q+1,Se=_e[de];if(0>i(Y,ke))de<j&&0>i(Se,Y)?(_e[Le]=Se,_e[de]=ke,Le=de):(_e[Le]=Y,_e[q]=ke,Le=q);else if(de<j&&0>i(Se,ke))_e[Le]=Se,_e[de]=ke,Le=de;else break e}}return Q}function i(_e,Q){var ke=_e.sortIndex-Q.sortIndex;return ke!==0?ke:_e.id-Q.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();t.unstable_now=function(){return a.now()-o}}var l=[],c=[],d=1,h=null,p=3,m=!1,y=!1,x=!1,E=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,A=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function _(_e){for(var Q=r(c);Q!==null;){if(Q.callback===null)n(c);else if(Q.startTime<=_e)n(c),Q.sortIndex=Q.expirationTime,e(l,Q);else break;Q=r(c)}}function P(_e){if(x=!1,_(_e),!y)if(r(l)!==null)y=!0,Ie(W);else{var Q=r(c);Q!==null&&Te(P,Q.startTime-_e)}}function W(_e,Q){y=!1,x&&(x=!1,T(F),F=-1),m=!0;var ke=p;try{for(_(Q),h=r(l);h!==null&&(!(h.expirationTime>Q)||_e&&!N());){var Le=h.callback;if(typeof Le=="function"){h.callback=null,p=h.priorityLevel;var j=Le(h.expirationTime<=Q);Q=t.unstable_now(),typeof j=="function"?h.callback=j:h===r(l)&&n(l),_(Q)}else n(l);h=r(l)}if(h!==null)var H=!0;else{var q=r(c);q!==null&&Te(P,q.startTime-Q),H=!1}return H}finally{h=null,p=ke,m=!1}}var B=!1,w=null,F=-1,S=5,b=-1;function N(){return!(t.unstable_now()-b<S)}function D(){if(w!==null){var _e=t.unstable_now();b=_e;var Q=!0;try{Q=w(!0,_e)}finally{Q?R():(B=!1,w=null)}}else B=!1}var R;if(typeof A=="function")R=function(){A(D)};else if(typeof MessageChannel<"u"){var Ue=new MessageChannel,me=Ue.port2;Ue.port1.onmessage=D,R=function(){me.postMessage(null)}}else R=function(){E(D,0)};function Ie(_e){w=_e,B||(B=!0,R())}function Te(_e,Q){F=E(function(){_e(t.unstable_now())},Q)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(_e){_e.callback=null},t.unstable_continueExecution=function(){y||m||(y=!0,Ie(W))},t.unstable_forceFrameRate=function(_e){0>_e||125<_e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):S=0<_e?Math.floor(1e3/_e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return r(l)},t.unstable_next=function(_e){switch(p){case 1:case 2:case 3:var Q=3;break;default:Q=p}var ke=p;p=Q;try{return _e()}finally{p=ke}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(_e,Q){switch(_e){case 1:case 2:case 3:case 4:case 5:break;default:_e=3}var ke=p;p=_e;try{return Q()}finally{p=ke}},t.unstable_scheduleCallback=function(_e,Q,ke){var Le=t.unstable_now();switch(typeof ke=="object"&&ke!==null?(ke=ke.delay,ke=typeof ke=="number"&&0<ke?Le+ke:Le):ke=Le,_e){case 1:var j=-1;break;case 2:j=250;break;case 5:j=1073741823;break;case 4:j=1e4;break;default:j=5e3}return j=ke+j,_e={id:d++,callback:Q,priorityLevel:_e,startTime:ke,expirationTime:j,sortIndex:-1},ke>Le?(_e.sortIndex=ke,e(c,_e),r(l)===null&&_e===r(c)&&(x?(T(F),F=-1):x=!0,Te(P,ke-Le))):(_e.sortIndex=j,e(l,_e),y||m||(y=!0,Ie(W))),_e},t.unstable_shouldYield=N,t.unstable_wrapCallback=function(_e){var Q=p;return function(){var ke=p;p=Q;try{return _e.apply(this,arguments)}finally{p=ke}}}})(fw);uw.exports=fw;var AF=uw.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kF=ye,Ui=AF;function Pe(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var dw=new Set,wf={};function Pl(t,e){Uc(t,e),Uc(t+"Capture",e)}function Uc(t,e){for(wf[t]=e,t=0;t<e.length;t++)dw.add(e[t])}var Ia=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),rm=Object.prototype.hasOwnProperty,CF=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,gy={},my={};function FF(t){return rm.call(my,t)?!0:rm.call(gy,t)?!1:CF.test(t)?my[t]=!0:(gy[t]=!0,!1)}function IF(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function bF(t,e,r,n){if(e===null||typeof e>"u"||IF(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function li(t,e,r,n,i,s,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=a}var bn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){bn[t]=new li(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];bn[e]=new li(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){bn[t]=new li(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){bn[t]=new li(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){bn[t]=new li(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){bn[t]=new li(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){bn[t]=new li(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){bn[t]=new li(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){bn[t]=new li(t,5,!1,t.toLowerCase(),null,!1,!1)});var Nx=/[\-:]([a-z])/g;function Dx(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Nx,Dx);bn[e]=new li(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Nx,Dx);bn[e]=new li(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Nx,Dx);bn[e]=new li(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){bn[t]=new li(t,1,!1,t.toLowerCase(),null,!1,!1)});bn.xlinkHref=new li("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){bn[t]=new li(t,1,!1,t.toLowerCase(),null,!0,!0)});function Px(t,e,r,n){var i=bn.hasOwnProperty(e)?bn[e]:null;(i!==null?i.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(bF(e,r,i,n)&&(r=null),n||i===null?FF(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):i.mustUseProperty?t[i.propertyName]=r===null?i.type===3?!1:"":r:(e=i.attributeName,n=i.attributeNamespace,r===null?t.removeAttribute(e):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var ja=kF.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,nd=Symbol.for("react.element"),dc=Symbol.for("react.portal"),hc=Symbol.for("react.fragment"),Ox=Symbol.for("react.strict_mode"),nm=Symbol.for("react.profiler"),hw=Symbol.for("react.provider"),pw=Symbol.for("react.context"),Mx=Symbol.for("react.forward_ref"),im=Symbol.for("react.suspense"),sm=Symbol.for("react.suspense_list"),Lx=Symbol.for("react.memo"),no=Symbol.for("react.lazy"),gw=Symbol.for("react.offscreen"),xy=Symbol.iterator;function Iu(t){return t===null||typeof t!="object"?null:(t=xy&&t[xy]||t["@@iterator"],typeof t=="function"?t:null)}var kr=Object.assign,Qp;function zu(t){if(Qp===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);Qp=e&&e[1]||""}return`
`+Qp+t}var Jp=!1;function Zp(t,e){if(!t||Jp)return"";Jp=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var n=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){n=c}t.call(e.prototype)}else{try{throw Error()}catch(c){n=c}t()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),s=n.stack.split(`
`),a=i.length-1,o=s.length-1;1<=a&&0<=o&&i[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(i[a]!==s[o]){if(a!==1||o!==1)do if(a--,o--,0>o||i[a]!==s[o]){var l=`
`+i[a].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=a&&0<=o);break}}}finally{Jp=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?zu(t):""}function RF(t){switch(t.tag){case 5:return zu(t.type);case 16:return zu("Lazy");case 13:return zu("Suspense");case 19:return zu("SuspenseList");case 0:case 2:case 15:return t=Zp(t.type,!1),t;case 11:return t=Zp(t.type.render,!1),t;case 1:return t=Zp(t.type,!0),t;default:return""}}function am(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case hc:return"Fragment";case dc:return"Portal";case nm:return"Profiler";case Ox:return"StrictMode";case im:return"Suspense";case sm:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case pw:return(t.displayName||"Context")+".Consumer";case hw:return(t._context.displayName||"Context")+".Provider";case Mx:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Lx:return e=t.displayName||null,e!==null?e:am(t.type)||"Memo";case no:e=t._payload,t=t._init;try{return am(t(e))}catch{}}return null}function NF(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return am(e);case 8:return e===Ox?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Ro(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function mw(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function DF(t){var e=mw(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,s=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(a){n=""+a,s.call(this,a)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(a){n=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function id(t){t._valueTracker||(t._valueTracker=DF(t))}function xw(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=mw(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function lh(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function om(t,e){var r=e.checked;return kr({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function vy(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=Ro(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function vw(t,e){e=e.checked,e!=null&&Px(t,"checked",e,!1)}function lm(t,e){vw(t,e);var r=Ro(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?cm(t,e.type,r):e.hasOwnProperty("defaultValue")&&cm(t,e.type,Ro(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function yy(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function cm(t,e,r){(e!=="number"||lh(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var Wu=Array.isArray;function Cc(t,e,r,n){if(t=t.options,e){e={};for(var i=0;i<r.length;i++)e["$"+r[i]]=!0;for(r=0;r<t.length;r++)i=e.hasOwnProperty("$"+t[r].value),t[r].selected!==i&&(t[r].selected=i),i&&n&&(t[r].defaultSelected=!0)}else{for(r=""+Ro(r),e=null,i=0;i<t.length;i++){if(t[i].value===r){t[i].selected=!0,n&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function um(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Pe(91));return kr({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function _y(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(Pe(92));if(Wu(r)){if(1<r.length)throw Error(Pe(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:Ro(r)}}function yw(t,e){var r=Ro(e.value),n=Ro(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function Ey(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function _w(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function fm(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?_w(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var sd,Ew=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,i){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(sd=sd||document.createElement("div"),sd.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=sd.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Tf(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var Zu={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},PF=["Webkit","ms","Moz","O"];Object.keys(Zu).forEach(function(t){PF.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Zu[e]=Zu[t]})});function ww(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||Zu.hasOwnProperty(t)&&Zu[t]?(""+e).trim():e+"px"}function Tw(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=ww(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,i):t[r]=i}}var OF=kr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function dm(t,e){if(e){if(OF[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Pe(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Pe(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Pe(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Pe(62))}}function hm(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var pm=null;function Bx(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var gm=null,Fc=null,Ic=null;function wy(t){if(t=d0(t)){if(typeof gm!="function")throw Error(Pe(280));var e=t.stateNode;e&&(e=hp(e),gm(t.stateNode,t.type,e))}}function Sw(t){Fc?Ic?Ic.push(t):Ic=[t]:Fc=t}function Aw(){if(Fc){var t=Fc,e=Ic;if(Ic=Fc=null,wy(t),e)for(t=0;t<e.length;t++)wy(e[t])}}function kw(t,e){return t(e)}function Cw(){}var eg=!1;function Fw(t,e,r){if(eg)return t(e,r);eg=!0;try{return kw(t,e,r)}finally{eg=!1,(Fc!==null||Ic!==null)&&(Cw(),Aw())}}function Sf(t,e){var r=t.stateNode;if(r===null)return null;var n=hp(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(Pe(231,e,typeof r));return r}var mm=!1;if(Ia)try{var bu={};Object.defineProperty(bu,"passive",{get:function(){mm=!0}}),window.addEventListener("test",bu,bu),window.removeEventListener("test",bu,bu)}catch{mm=!1}function MF(t,e,r,n,i,s,a,o,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(r,c)}catch(d){this.onError(d)}}var ef=!1,ch=null,uh=!1,xm=null,LF={onError:function(t){ef=!0,ch=t}};function BF(t,e,r,n,i,s,a,o,l){ef=!1,ch=null,MF.apply(LF,arguments)}function jF(t,e,r,n,i,s,a,o,l){if(BF.apply(this,arguments),ef){if(ef){var c=ch;ef=!1,ch=null}else throw Error(Pe(198));uh||(uh=!0,xm=c)}}function Ol(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function Iw(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Ty(t){if(Ol(t)!==t)throw Error(Pe(188))}function VF(t){var e=t.alternate;if(!e){if(e=Ol(t),e===null)throw Error(Pe(188));return e!==t?null:t}for(var r=t,n=e;;){var i=r.return;if(i===null)break;var s=i.alternate;if(s===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return Ty(i),t;if(s===n)return Ty(i),e;s=s.sibling}throw Error(Pe(188))}if(r.return!==n.return)r=i,n=s;else{for(var a=!1,o=i.child;o;){if(o===r){a=!0,r=i,n=s;break}if(o===n){a=!0,n=i,r=s;break}o=o.sibling}if(!a){for(o=s.child;o;){if(o===r){a=!0,r=s,n=i;break}if(o===n){a=!0,n=s,r=i;break}o=o.sibling}if(!a)throw Error(Pe(189))}}if(r.alternate!==n)throw Error(Pe(190))}if(r.tag!==3)throw Error(Pe(188));return r.stateNode.current===r?t:e}function bw(t){return t=VF(t),t!==null?Rw(t):null}function Rw(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Rw(t);if(e!==null)return e;t=t.sibling}return null}var Nw=Ui.unstable_scheduleCallback,Sy=Ui.unstable_cancelCallback,UF=Ui.unstable_shouldYield,zF=Ui.unstable_requestPaint,Mr=Ui.unstable_now,WF=Ui.unstable_getCurrentPriorityLevel,jx=Ui.unstable_ImmediatePriority,Dw=Ui.unstable_UserBlockingPriority,fh=Ui.unstable_NormalPriority,HF=Ui.unstable_LowPriority,Pw=Ui.unstable_IdlePriority,cp=null,qs=null;function $F(t){if(qs&&typeof qs.onCommitFiberRoot=="function")try{qs.onCommitFiberRoot(cp,t,void 0,(t.current.flags&128)===128)}catch{}}var Fs=Math.clz32?Math.clz32:XF,GF=Math.log,KF=Math.LN2;function XF(t){return t>>>=0,t===0?32:31-(GF(t)/KF|0)|0}var ad=64,od=4194304;function Hu(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function dh(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,i=t.suspendedLanes,s=t.pingedLanes,a=r&268435455;if(a!==0){var o=a&~i;o!==0?n=Hu(o):(s&=a,s!==0&&(n=Hu(s)))}else a=r&~i,a!==0?n=Hu(a):s!==0&&(n=Hu(s));if(n===0)return 0;if(e!==0&&e!==n&&!(e&i)&&(i=n&-n,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-Fs(e),i=1<<r,n|=t[r],e&=~i;return n}function YF(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function qF(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var a=31-Fs(s),o=1<<a,l=i[a];l===-1?(!(o&r)||o&n)&&(i[a]=YF(o,e)):l<=e&&(t.expiredLanes|=o),s&=~o}}function vm(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Ow(){var t=ad;return ad<<=1,!(ad&4194240)&&(ad=64),t}function tg(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function u0(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Fs(e),t[e]=r}function QF(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var i=31-Fs(r),s=1<<i;e[i]=0,n[i]=-1,t[i]=-1,r&=~s}}function Vx(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-Fs(r),i=1<<n;i&e|t[n]&e&&(t[n]|=e),r&=~i}}var Kt=0;function Mw(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Lw,Ux,Bw,jw,Vw,ym=!1,ld=[],vo=null,yo=null,_o=null,Af=new Map,kf=new Map,so=[],JF="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ay(t,e){switch(t){case"focusin":case"focusout":vo=null;break;case"dragenter":case"dragleave":yo=null;break;case"mouseover":case"mouseout":_o=null;break;case"pointerover":case"pointerout":Af.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":kf.delete(e.pointerId)}}function Ru(t,e,r,n,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},e!==null&&(e=d0(e),e!==null&&Ux(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function ZF(t,e,r,n,i){switch(e){case"focusin":return vo=Ru(vo,t,e,r,n,i),!0;case"dragenter":return yo=Ru(yo,t,e,r,n,i),!0;case"mouseover":return _o=Ru(_o,t,e,r,n,i),!0;case"pointerover":var s=i.pointerId;return Af.set(s,Ru(Af.get(s)||null,t,e,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,kf.set(s,Ru(kf.get(s)||null,t,e,r,n,i)),!0}return!1}function Uw(t){var e=sl(t.target);if(e!==null){var r=Ol(e);if(r!==null){if(e=r.tag,e===13){if(e=Iw(r),e!==null){t.blockedOn=e,Vw(t.priority,function(){Bw(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Wd(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=_m(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);pm=n,r.target.dispatchEvent(n),pm=null}else return e=d0(r),e!==null&&Ux(e),t.blockedOn=r,!1;e.shift()}return!0}function ky(t,e,r){Wd(t)&&r.delete(e)}function eI(){ym=!1,vo!==null&&Wd(vo)&&(vo=null),yo!==null&&Wd(yo)&&(yo=null),_o!==null&&Wd(_o)&&(_o=null),Af.forEach(ky),kf.forEach(ky)}function Nu(t,e){t.blockedOn===e&&(t.blockedOn=null,ym||(ym=!0,Ui.unstable_scheduleCallback(Ui.unstable_NormalPriority,eI)))}function Cf(t){function e(i){return Nu(i,t)}if(0<ld.length){Nu(ld[0],t);for(var r=1;r<ld.length;r++){var n=ld[r];n.blockedOn===t&&(n.blockedOn=null)}}for(vo!==null&&Nu(vo,t),yo!==null&&Nu(yo,t),_o!==null&&Nu(_o,t),Af.forEach(e),kf.forEach(e),r=0;r<so.length;r++)n=so[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<so.length&&(r=so[0],r.blockedOn===null);)Uw(r),r.blockedOn===null&&so.shift()}var bc=ja.ReactCurrentBatchConfig,hh=!0;function tI(t,e,r,n){var i=Kt,s=bc.transition;bc.transition=null;try{Kt=1,zx(t,e,r,n)}finally{Kt=i,bc.transition=s}}function rI(t,e,r,n){var i=Kt,s=bc.transition;bc.transition=null;try{Kt=4,zx(t,e,r,n)}finally{Kt=i,bc.transition=s}}function zx(t,e,r,n){if(hh){var i=_m(t,e,r,n);if(i===null)fg(t,e,n,ph,r),Ay(t,n);else if(ZF(i,t,e,r,n))n.stopPropagation();else if(Ay(t,n),e&4&&-1<JF.indexOf(t)){for(;i!==null;){var s=d0(i);if(s!==null&&Lw(s),s=_m(t,e,r,n),s===null&&fg(t,e,n,ph,r),s===i)break;i=s}i!==null&&n.stopPropagation()}else fg(t,e,n,null,r)}}var ph=null;function _m(t,e,r,n){if(ph=null,t=Bx(n),t=sl(t),t!==null)if(e=Ol(t),e===null)t=null;else if(r=e.tag,r===13){if(t=Iw(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return ph=t,null}function zw(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(WF()){case jx:return 1;case Dw:return 4;case fh:case HF:return 16;case Pw:return 536870912;default:return 16}default:return 16}}var fo=null,Wx=null,Hd=null;function Ww(){if(Hd)return Hd;var t,e=Wx,r=e.length,n,i="value"in fo?fo.value:fo.textContent,s=i.length;for(t=0;t<r&&e[t]===i[t];t++);var a=r-t;for(n=1;n<=a&&e[r-n]===i[s-n];n++);return Hd=i.slice(t,1<n?1-n:void 0)}function $d(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function cd(){return!0}function Cy(){return!1}function Hi(t){function e(r,n,i,s,a){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(r=t[o],this[o]=r?r(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?cd:Cy,this.isPropagationStopped=Cy,this}return kr(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=cd)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=cd)},persist:function(){},isPersistent:cd}),e}var ou={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Hx=Hi(ou),f0=kr({},ou,{view:0,detail:0}),nI=Hi(f0),rg,ng,Du,up=kr({},f0,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:$x,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Du&&(Du&&t.type==="mousemove"?(rg=t.screenX-Du.screenX,ng=t.screenY-Du.screenY):ng=rg=0,Du=t),rg)},movementY:function(t){return"movementY"in t?t.movementY:ng}}),Fy=Hi(up),iI=kr({},up,{dataTransfer:0}),sI=Hi(iI),aI=kr({},f0,{relatedTarget:0}),ig=Hi(aI),oI=kr({},ou,{animationName:0,elapsedTime:0,pseudoElement:0}),lI=Hi(oI),cI=kr({},ou,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),uI=Hi(cI),fI=kr({},ou,{data:0}),Iy=Hi(fI),dI={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},hI={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},pI={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function gI(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=pI[t])?!!e[t]:!1}function $x(){return gI}var mI=kr({},f0,{key:function(t){if(t.key){var e=dI[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=$d(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?hI[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:$x,charCode:function(t){return t.type==="keypress"?$d(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?$d(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),xI=Hi(mI),vI=kr({},up,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),by=Hi(vI),yI=kr({},f0,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:$x}),_I=Hi(yI),EI=kr({},ou,{propertyName:0,elapsedTime:0,pseudoElement:0}),wI=Hi(EI),TI=kr({},up,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),SI=Hi(TI),AI=[9,13,27,32],Gx=Ia&&"CompositionEvent"in window,tf=null;Ia&&"documentMode"in document&&(tf=document.documentMode);var kI=Ia&&"TextEvent"in window&&!tf,Hw=Ia&&(!Gx||tf&&8<tf&&11>=tf),Ry=" ",Ny=!1;function $w(t,e){switch(t){case"keyup":return AI.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Gw(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var pc=!1;function CI(t,e){switch(t){case"compositionend":return Gw(e);case"keypress":return e.which!==32?null:(Ny=!0,Ry);case"textInput":return t=e.data,t===Ry&&Ny?null:t;default:return null}}function FI(t,e){if(pc)return t==="compositionend"||!Gx&&$w(t,e)?(t=Ww(),Hd=Wx=fo=null,pc=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Hw&&e.locale!=="ko"?null:e.data;default:return null}}var II={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Dy(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!II[t.type]:e==="textarea"}function Kw(t,e,r,n){Sw(n),e=gh(e,"onChange"),0<e.length&&(r=new Hx("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var rf=null,Ff=null;function bI(t){iT(t,0)}function fp(t){var e=xc(t);if(xw(e))return t}function RI(t,e){if(t==="change")return e}var Xw=!1;if(Ia){var sg;if(Ia){var ag="oninput"in document;if(!ag){var Py=document.createElement("div");Py.setAttribute("oninput","return;"),ag=typeof Py.oninput=="function"}sg=ag}else sg=!1;Xw=sg&&(!document.documentMode||9<document.documentMode)}function Oy(){rf&&(rf.detachEvent("onpropertychange",Yw),Ff=rf=null)}function Yw(t){if(t.propertyName==="value"&&fp(Ff)){var e=[];Kw(e,Ff,t,Bx(t)),Fw(bI,e)}}function NI(t,e,r){t==="focusin"?(Oy(),rf=e,Ff=r,rf.attachEvent("onpropertychange",Yw)):t==="focusout"&&Oy()}function DI(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return fp(Ff)}function PI(t,e){if(t==="click")return fp(e)}function OI(t,e){if(t==="input"||t==="change")return fp(e)}function MI(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Ns=typeof Object.is=="function"?Object.is:MI;function If(t,e){if(Ns(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!rm.call(e,i)||!Ns(t[i],e[i]))return!1}return!0}function My(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Ly(t,e){var r=My(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=My(r)}}function qw(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?qw(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Qw(){for(var t=window,e=lh();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=lh(t.document)}return e}function Kx(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function LI(t){var e=Qw(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&qw(r.ownerDocument.documentElement,r)){if(n!==null&&Kx(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=r.textContent.length,s=Math.min(n.start,i);n=n.end===void 0?s:Math.min(n.end,i),!t.extend&&s>n&&(i=n,n=s,s=i),i=Ly(r,s);var a=Ly(r,n);i&&a&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>n?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var BI=Ia&&"documentMode"in document&&11>=document.documentMode,gc=null,Em=null,nf=null,wm=!1;function By(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;wm||gc==null||gc!==lh(n)||(n=gc,"selectionStart"in n&&Kx(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),nf&&If(nf,n)||(nf=n,n=gh(Em,"onSelect"),0<n.length&&(e=new Hx("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=gc)))}function ud(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var mc={animationend:ud("Animation","AnimationEnd"),animationiteration:ud("Animation","AnimationIteration"),animationstart:ud("Animation","AnimationStart"),transitionend:ud("Transition","TransitionEnd")},og={},Jw={};Ia&&(Jw=document.createElement("div").style,"AnimationEvent"in window||(delete mc.animationend.animation,delete mc.animationiteration.animation,delete mc.animationstart.animation),"TransitionEvent"in window||delete mc.transitionend.transition);function dp(t){if(og[t])return og[t];if(!mc[t])return t;var e=mc[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in Jw)return og[t]=e[r];return t}var Zw=dp("animationend"),eT=dp("animationiteration"),tT=dp("animationstart"),rT=dp("transitionend"),nT=new Map,jy="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Vo(t,e){nT.set(t,e),Pl(e,[t])}for(var lg=0;lg<jy.length;lg++){var cg=jy[lg],jI=cg.toLowerCase(),VI=cg[0].toUpperCase()+cg.slice(1);Vo(jI,"on"+VI)}Vo(Zw,"onAnimationEnd");Vo(eT,"onAnimationIteration");Vo(tT,"onAnimationStart");Vo("dblclick","onDoubleClick");Vo("focusin","onFocus");Vo("focusout","onBlur");Vo(rT,"onTransitionEnd");Uc("onMouseEnter",["mouseout","mouseover"]);Uc("onMouseLeave",["mouseout","mouseover"]);Uc("onPointerEnter",["pointerout","pointerover"]);Uc("onPointerLeave",["pointerout","pointerover"]);Pl("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Pl("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Pl("onBeforeInput",["compositionend","keypress","textInput","paste"]);Pl("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Pl("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Pl("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var $u="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),UI=new Set("cancel close invalid load scroll toggle".split(" ").concat($u));function Vy(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,jF(n,e,void 0,t),t.currentTarget=null}function iT(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],i=n.event;n=n.listeners;e:{var s=void 0;if(e)for(var a=n.length-1;0<=a;a--){var o=n[a],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==s&&i.isPropagationStopped())break e;Vy(i,o,c),s=l}else for(a=0;a<n.length;a++){if(o=n[a],l=o.instance,c=o.currentTarget,o=o.listener,l!==s&&i.isPropagationStopped())break e;Vy(i,o,c),s=l}}}if(uh)throw t=xm,uh=!1,xm=null,t}function or(t,e){var r=e[Cm];r===void 0&&(r=e[Cm]=new Set);var n=t+"__bubble";r.has(n)||(sT(e,t,2,!1),r.add(n))}function ug(t,e,r){var n=0;e&&(n|=4),sT(r,t,n,e)}var fd="_reactListening"+Math.random().toString(36).slice(2);function bf(t){if(!t[fd]){t[fd]=!0,dw.forEach(function(r){r!=="selectionchange"&&(UI.has(r)||ug(r,!1,t),ug(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[fd]||(e[fd]=!0,ug("selectionchange",!1,e))}}function sT(t,e,r,n){switch(zw(e)){case 1:var i=tI;break;case 4:i=rI;break;default:i=zx}r=i.bind(null,e,r,t),i=void 0,!mm||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),n?i!==void 0?t.addEventListener(e,r,{capture:!0,passive:i}):t.addEventListener(e,r,!0):i!==void 0?t.addEventListener(e,r,{passive:i}):t.addEventListener(e,r,!1)}function fg(t,e,r,n,i){var s=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var a=n.tag;if(a===3||a===4){var o=n.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(a===4)for(a=n.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;a=a.return}for(;o!==null;){if(a=sl(o),a===null)return;if(l=a.tag,l===5||l===6){n=s=a;continue e}o=o.parentNode}}n=n.return}Fw(function(){var c=s,d=Bx(r),h=[];e:{var p=nT.get(t);if(p!==void 0){var m=Hx,y=t;switch(t){case"keypress":if($d(r)===0)break e;case"keydown":case"keyup":m=xI;break;case"focusin":y="focus",m=ig;break;case"focusout":y="blur",m=ig;break;case"beforeblur":case"afterblur":m=ig;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=Fy;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=sI;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=_I;break;case Zw:case eT:case tT:m=lI;break;case rT:m=wI;break;case"scroll":m=nI;break;case"wheel":m=SI;break;case"copy":case"cut":case"paste":m=uI;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=by}var x=(e&4)!==0,E=!x&&t==="scroll",T=x?p!==null?p+"Capture":null:p;x=[];for(var A=c,_;A!==null;){_=A;var P=_.stateNode;if(_.tag===5&&P!==null&&(_=P,T!==null&&(P=Sf(A,T),P!=null&&x.push(Rf(A,P,_)))),E)break;A=A.return}0<x.length&&(p=new m(p,y,null,r,d),h.push({event:p,listeners:x}))}}if(!(e&7)){e:{if(p=t==="mouseover"||t==="pointerover",m=t==="mouseout"||t==="pointerout",p&&r!==pm&&(y=r.relatedTarget||r.fromElement)&&(sl(y)||y[ba]))break e;if((m||p)&&(p=d.window===d?d:(p=d.ownerDocument)?p.defaultView||p.parentWindow:window,m?(y=r.relatedTarget||r.toElement,m=c,y=y?sl(y):null,y!==null&&(E=Ol(y),y!==E||y.tag!==5&&y.tag!==6)&&(y=null)):(m=null,y=c),m!==y)){if(x=Fy,P="onMouseLeave",T="onMouseEnter",A="mouse",(t==="pointerout"||t==="pointerover")&&(x=by,P="onPointerLeave",T="onPointerEnter",A="pointer"),E=m==null?p:xc(m),_=y==null?p:xc(y),p=new x(P,A+"leave",m,r,d),p.target=E,p.relatedTarget=_,P=null,sl(d)===c&&(x=new x(T,A+"enter",y,r,d),x.target=_,x.relatedTarget=E,P=x),E=P,m&&y)t:{for(x=m,T=y,A=0,_=x;_;_=ic(_))A++;for(_=0,P=T;P;P=ic(P))_++;for(;0<A-_;)x=ic(x),A--;for(;0<_-A;)T=ic(T),_--;for(;A--;){if(x===T||T!==null&&x===T.alternate)break t;x=ic(x),T=ic(T)}x=null}else x=null;m!==null&&Uy(h,p,m,x,!1),y!==null&&E!==null&&Uy(h,E,y,x,!0)}}e:{if(p=c?xc(c):window,m=p.nodeName&&p.nodeName.toLowerCase(),m==="select"||m==="input"&&p.type==="file")var W=RI;else if(Dy(p))if(Xw)W=OI;else{W=DI;var B=NI}else(m=p.nodeName)&&m.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(W=PI);if(W&&(W=W(t,c))){Kw(h,W,r,d);break e}B&&B(t,p,c),t==="focusout"&&(B=p._wrapperState)&&B.controlled&&p.type==="number"&&cm(p,"number",p.value)}switch(B=c?xc(c):window,t){case"focusin":(Dy(B)||B.contentEditable==="true")&&(gc=B,Em=c,nf=null);break;case"focusout":nf=Em=gc=null;break;case"mousedown":wm=!0;break;case"contextmenu":case"mouseup":case"dragend":wm=!1,By(h,r,d);break;case"selectionchange":if(BI)break;case"keydown":case"keyup":By(h,r,d)}var w;if(Gx)e:{switch(t){case"compositionstart":var F="onCompositionStart";break e;case"compositionend":F="onCompositionEnd";break e;case"compositionupdate":F="onCompositionUpdate";break e}F=void 0}else pc?$w(t,r)&&(F="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(F="onCompositionStart");F&&(Hw&&r.locale!=="ko"&&(pc||F!=="onCompositionStart"?F==="onCompositionEnd"&&pc&&(w=Ww()):(fo=d,Wx="value"in fo?fo.value:fo.textContent,pc=!0)),B=gh(c,F),0<B.length&&(F=new Iy(F,t,null,r,d),h.push({event:F,listeners:B}),w?F.data=w:(w=Gw(r),w!==null&&(F.data=w)))),(w=kI?CI(t,r):FI(t,r))&&(c=gh(c,"onBeforeInput"),0<c.length&&(d=new Iy("onBeforeInput","beforeinput",null,r,d),h.push({event:d,listeners:c}),d.data=w))}iT(h,e)})}function Rf(t,e,r){return{instance:t,listener:e,currentTarget:r}}function gh(t,e){for(var r=e+"Capture",n=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Sf(t,r),s!=null&&n.unshift(Rf(t,s,i)),s=Sf(t,e),s!=null&&n.push(Rf(t,s,i))),t=t.return}return n}function ic(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Uy(t,e,r,n,i){for(var s=e._reactName,a=[];r!==null&&r!==n;){var o=r,l=o.alternate,c=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&c!==null&&(o=c,i?(l=Sf(r,s),l!=null&&a.unshift(Rf(r,l,o))):i||(l=Sf(r,s),l!=null&&a.push(Rf(r,l,o)))),r=r.return}a.length!==0&&t.push({event:e,listeners:a})}var zI=/\r\n?/g,WI=/\u0000|\uFFFD/g;function zy(t){return(typeof t=="string"?t:""+t).replace(zI,`
`).replace(WI,"")}function dd(t,e,r){if(e=zy(e),zy(t)!==e&&r)throw Error(Pe(425))}function mh(){}var Tm=null,Sm=null;function Am(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var km=typeof setTimeout=="function"?setTimeout:void 0,HI=typeof clearTimeout=="function"?clearTimeout:void 0,Wy=typeof Promise=="function"?Promise:void 0,$I=typeof queueMicrotask=="function"?queueMicrotask:typeof Wy<"u"?function(t){return Wy.resolve(null).then(t).catch(GI)}:km;function GI(t){setTimeout(function(){throw t})}function dg(t,e){var r=e,n=0;do{var i=r.nextSibling;if(t.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){t.removeChild(i),Cf(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);Cf(e)}function Eo(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Hy(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var lu=Math.random().toString(36).slice(2),Xs="__reactFiber$"+lu,Nf="__reactProps$"+lu,ba="__reactContainer$"+lu,Cm="__reactEvents$"+lu,KI="__reactListeners$"+lu,XI="__reactHandles$"+lu;function sl(t){var e=t[Xs];if(e)return e;for(var r=t.parentNode;r;){if(e=r[ba]||r[Xs]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=Hy(t);t!==null;){if(r=t[Xs])return r;t=Hy(t)}return e}t=r,r=t.parentNode}return null}function d0(t){return t=t[Xs]||t[ba],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function xc(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Pe(33))}function hp(t){return t[Nf]||null}var Fm=[],vc=-1;function Uo(t){return{current:t}}function cr(t){0>vc||(t.current=Fm[vc],Fm[vc]=null,vc--)}function tr(t,e){vc++,Fm[vc]=t.current,t.current=e}var No={},Gn=Uo(No),Ei=Uo(!1),vl=No;function zc(t,e){var r=t.type.contextTypes;if(!r)return No;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in r)i[s]=e[s];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function wi(t){return t=t.childContextTypes,t!=null}function xh(){cr(Ei),cr(Gn)}function $y(t,e,r){if(Gn.current!==No)throw Error(Pe(168));tr(Gn,e),tr(Ei,r)}function aT(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in e))throw Error(Pe(108,NF(t)||"Unknown",i));return kr({},r,n)}function vh(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||No,vl=Gn.current,tr(Gn,t),tr(Ei,Ei.current),!0}function Gy(t,e,r){var n=t.stateNode;if(!n)throw Error(Pe(169));r?(t=aT(t,e,vl),n.__reactInternalMemoizedMergedChildContext=t,cr(Ei),cr(Gn),tr(Gn,t)):cr(Ei),tr(Ei,r)}var xa=null,pp=!1,hg=!1;function oT(t){xa===null?xa=[t]:xa.push(t)}function YI(t){pp=!0,oT(t)}function zo(){if(!hg&&xa!==null){hg=!0;var t=0,e=Kt;try{var r=xa;for(Kt=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}xa=null,pp=!1}catch(i){throw xa!==null&&(xa=xa.slice(t+1)),Nw(jx,zo),i}finally{Kt=e,hg=!1}}return null}var yc=[],_c=0,yh=null,_h=0,ns=[],is=0,yl=null,va=1,ya="";function el(t,e){yc[_c++]=_h,yc[_c++]=yh,yh=t,_h=e}function lT(t,e,r){ns[is++]=va,ns[is++]=ya,ns[is++]=yl,yl=t;var n=va;t=ya;var i=32-Fs(n)-1;n&=~(1<<i),r+=1;var s=32-Fs(e)+i;if(30<s){var a=i-i%5;s=(n&(1<<a)-1).toString(32),n>>=a,i-=a,va=1<<32-Fs(e)+i|r<<i|n,ya=s+t}else va=1<<s|r<<i|n,ya=t}function Xx(t){t.return!==null&&(el(t,1),lT(t,1,0))}function Yx(t){for(;t===yh;)yh=yc[--_c],yc[_c]=null,_h=yc[--_c],yc[_c]=null;for(;t===yl;)yl=ns[--is],ns[is]=null,ya=ns[--is],ns[is]=null,va=ns[--is],ns[is]=null}var ji=null,Bi=null,xr=!1,Ss=null;function cT(t,e){var r=as(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function Ky(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,ji=t,Bi=Eo(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,ji=t,Bi=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=yl!==null?{id:va,overflow:ya}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=as(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,ji=t,Bi=null,!0):!1;default:return!1}}function Im(t){return(t.mode&1)!==0&&(t.flags&128)===0}function bm(t){if(xr){var e=Bi;if(e){var r=e;if(!Ky(t,e)){if(Im(t))throw Error(Pe(418));e=Eo(r.nextSibling);var n=ji;e&&Ky(t,e)?cT(n,r):(t.flags=t.flags&-4097|2,xr=!1,ji=t)}}else{if(Im(t))throw Error(Pe(418));t.flags=t.flags&-4097|2,xr=!1,ji=t}}}function Xy(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;ji=t}function hd(t){if(t!==ji)return!1;if(!xr)return Xy(t),xr=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Am(t.type,t.memoizedProps)),e&&(e=Bi)){if(Im(t))throw uT(),Error(Pe(418));for(;e;)cT(t,e),e=Eo(e.nextSibling)}if(Xy(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Pe(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){Bi=Eo(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}Bi=null}}else Bi=ji?Eo(t.stateNode.nextSibling):null;return!0}function uT(){for(var t=Bi;t;)t=Eo(t.nextSibling)}function Wc(){Bi=ji=null,xr=!1}function qx(t){Ss===null?Ss=[t]:Ss.push(t)}var qI=ja.ReactCurrentBatchConfig;function Pu(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Pe(309));var n=r.stateNode}if(!n)throw Error(Pe(147,t));var i=n,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(a){var o=i.refs;a===null?delete o[s]:o[s]=a},e._stringRef=s,e)}if(typeof t!="string")throw Error(Pe(284));if(!r._owner)throw Error(Pe(290,t))}return t}function pd(t,e){throw t=Object.prototype.toString.call(e),Error(Pe(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Yy(t){var e=t._init;return e(t._payload)}function fT(t){function e(T,A){if(t){var _=T.deletions;_===null?(T.deletions=[A],T.flags|=16):_.push(A)}}function r(T,A){if(!t)return null;for(;A!==null;)e(T,A),A=A.sibling;return null}function n(T,A){for(T=new Map;A!==null;)A.key!==null?T.set(A.key,A):T.set(A.index,A),A=A.sibling;return T}function i(T,A){return T=Ao(T,A),T.index=0,T.sibling=null,T}function s(T,A,_){return T.index=_,t?(_=T.alternate,_!==null?(_=_.index,_<A?(T.flags|=2,A):_):(T.flags|=2,A)):(T.flags|=1048576,A)}function a(T){return t&&T.alternate===null&&(T.flags|=2),T}function o(T,A,_,P){return A===null||A.tag!==6?(A=_g(_,T.mode,P),A.return=T,A):(A=i(A,_),A.return=T,A)}function l(T,A,_,P){var W=_.type;return W===hc?d(T,A,_.props.children,P,_.key):A!==null&&(A.elementType===W||typeof W=="object"&&W!==null&&W.$$typeof===no&&Yy(W)===A.type)?(P=i(A,_.props),P.ref=Pu(T,A,_),P.return=T,P):(P=Jd(_.type,_.key,_.props,null,T.mode,P),P.ref=Pu(T,A,_),P.return=T,P)}function c(T,A,_,P){return A===null||A.tag!==4||A.stateNode.containerInfo!==_.containerInfo||A.stateNode.implementation!==_.implementation?(A=Eg(_,T.mode,P),A.return=T,A):(A=i(A,_.children||[]),A.return=T,A)}function d(T,A,_,P,W){return A===null||A.tag!==7?(A=fl(_,T.mode,P,W),A.return=T,A):(A=i(A,_),A.return=T,A)}function h(T,A,_){if(typeof A=="string"&&A!==""||typeof A=="number")return A=_g(""+A,T.mode,_),A.return=T,A;if(typeof A=="object"&&A!==null){switch(A.$$typeof){case nd:return _=Jd(A.type,A.key,A.props,null,T.mode,_),_.ref=Pu(T,null,A),_.return=T,_;case dc:return A=Eg(A,T.mode,_),A.return=T,A;case no:var P=A._init;return h(T,P(A._payload),_)}if(Wu(A)||Iu(A))return A=fl(A,T.mode,_,null),A.return=T,A;pd(T,A)}return null}function p(T,A,_,P){var W=A!==null?A.key:null;if(typeof _=="string"&&_!==""||typeof _=="number")return W!==null?null:o(T,A,""+_,P);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case nd:return _.key===W?l(T,A,_,P):null;case dc:return _.key===W?c(T,A,_,P):null;case no:return W=_._init,p(T,A,W(_._payload),P)}if(Wu(_)||Iu(_))return W!==null?null:d(T,A,_,P,null);pd(T,_)}return null}function m(T,A,_,P,W){if(typeof P=="string"&&P!==""||typeof P=="number")return T=T.get(_)||null,o(A,T,""+P,W);if(typeof P=="object"&&P!==null){switch(P.$$typeof){case nd:return T=T.get(P.key===null?_:P.key)||null,l(A,T,P,W);case dc:return T=T.get(P.key===null?_:P.key)||null,c(A,T,P,W);case no:var B=P._init;return m(T,A,_,B(P._payload),W)}if(Wu(P)||Iu(P))return T=T.get(_)||null,d(A,T,P,W,null);pd(A,P)}return null}function y(T,A,_,P){for(var W=null,B=null,w=A,F=A=0,S=null;w!==null&&F<_.length;F++){w.index>F?(S=w,w=null):S=w.sibling;var b=p(T,w,_[F],P);if(b===null){w===null&&(w=S);break}t&&w&&b.alternate===null&&e(T,w),A=s(b,A,F),B===null?W=b:B.sibling=b,B=b,w=S}if(F===_.length)return r(T,w),xr&&el(T,F),W;if(w===null){for(;F<_.length;F++)w=h(T,_[F],P),w!==null&&(A=s(w,A,F),B===null?W=w:B.sibling=w,B=w);return xr&&el(T,F),W}for(w=n(T,w);F<_.length;F++)S=m(w,T,F,_[F],P),S!==null&&(t&&S.alternate!==null&&w.delete(S.key===null?F:S.key),A=s(S,A,F),B===null?W=S:B.sibling=S,B=S);return t&&w.forEach(function(N){return e(T,N)}),xr&&el(T,F),W}function x(T,A,_,P){var W=Iu(_);if(typeof W!="function")throw Error(Pe(150));if(_=W.call(_),_==null)throw Error(Pe(151));for(var B=W=null,w=A,F=A=0,S=null,b=_.next();w!==null&&!b.done;F++,b=_.next()){w.index>F?(S=w,w=null):S=w.sibling;var N=p(T,w,b.value,P);if(N===null){w===null&&(w=S);break}t&&w&&N.alternate===null&&e(T,w),A=s(N,A,F),B===null?W=N:B.sibling=N,B=N,w=S}if(b.done)return r(T,w),xr&&el(T,F),W;if(w===null){for(;!b.done;F++,b=_.next())b=h(T,b.value,P),b!==null&&(A=s(b,A,F),B===null?W=b:B.sibling=b,B=b);return xr&&el(T,F),W}for(w=n(T,w);!b.done;F++,b=_.next())b=m(w,T,F,b.value,P),b!==null&&(t&&b.alternate!==null&&w.delete(b.key===null?F:b.key),A=s(b,A,F),B===null?W=b:B.sibling=b,B=b);return t&&w.forEach(function(D){return e(T,D)}),xr&&el(T,F),W}function E(T,A,_,P){if(typeof _=="object"&&_!==null&&_.type===hc&&_.key===null&&(_=_.props.children),typeof _=="object"&&_!==null){switch(_.$$typeof){case nd:e:{for(var W=_.key,B=A;B!==null;){if(B.key===W){if(W=_.type,W===hc){if(B.tag===7){r(T,B.sibling),A=i(B,_.props.children),A.return=T,T=A;break e}}else if(B.elementType===W||typeof W=="object"&&W!==null&&W.$$typeof===no&&Yy(W)===B.type){r(T,B.sibling),A=i(B,_.props),A.ref=Pu(T,B,_),A.return=T,T=A;break e}r(T,B);break}else e(T,B);B=B.sibling}_.type===hc?(A=fl(_.props.children,T.mode,P,_.key),A.return=T,T=A):(P=Jd(_.type,_.key,_.props,null,T.mode,P),P.ref=Pu(T,A,_),P.return=T,T=P)}return a(T);case dc:e:{for(B=_.key;A!==null;){if(A.key===B)if(A.tag===4&&A.stateNode.containerInfo===_.containerInfo&&A.stateNode.implementation===_.implementation){r(T,A.sibling),A=i(A,_.children||[]),A.return=T,T=A;break e}else{r(T,A);break}else e(T,A);A=A.sibling}A=Eg(_,T.mode,P),A.return=T,T=A}return a(T);case no:return B=_._init,E(T,A,B(_._payload),P)}if(Wu(_))return y(T,A,_,P);if(Iu(_))return x(T,A,_,P);pd(T,_)}return typeof _=="string"&&_!==""||typeof _=="number"?(_=""+_,A!==null&&A.tag===6?(r(T,A.sibling),A=i(A,_),A.return=T,T=A):(r(T,A),A=_g(_,T.mode,P),A.return=T,T=A),a(T)):r(T,A)}return E}var Hc=fT(!0),dT=fT(!1),Eh=Uo(null),wh=null,Ec=null,Qx=null;function Jx(){Qx=Ec=wh=null}function Zx(t){var e=Eh.current;cr(Eh),t._currentValue=e}function Rm(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function Rc(t,e){wh=t,Qx=Ec=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(_i=!0),t.firstContext=null)}function cs(t){var e=t._currentValue;if(Qx!==t)if(t={context:t,memoizedValue:e,next:null},Ec===null){if(wh===null)throw Error(Pe(308));Ec=t,wh.dependencies={lanes:0,firstContext:t}}else Ec=Ec.next=t;return e}var al=null;function e1(t){al===null?al=[t]:al.push(t)}function hT(t,e,r,n){var i=e.interleaved;return i===null?(r.next=r,e1(e)):(r.next=i.next,i.next=r),e.interleaved=r,Ra(t,n)}function Ra(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var io=!1;function t1(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function pT(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Sa(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function wo(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,Nt&2){var i=n.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),n.pending=e,Ra(t,r)}return i=n.interleaved,i===null?(e.next=e,e1(n)):(e.next=i.next,i.next=e),n.interleaved=e,Ra(t,r)}function Gd(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,Vx(t,r)}}function qy(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?i=s=a:s=s.next=a,r=r.next}while(r!==null);s===null?i=s=e:s=s.next=e}else i=s=e;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function Th(t,e,r,n){var i=t.updateQueue;io=!1;var s=i.firstBaseUpdate,a=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var l=o,c=l.next;l.next=null,a===null?s=c:a.next=c,a=l;var d=t.alternate;d!==null&&(d=d.updateQueue,o=d.lastBaseUpdate,o!==a&&(o===null?d.firstBaseUpdate=c:o.next=c,d.lastBaseUpdate=l))}if(s!==null){var h=i.baseState;a=0,d=c=l=null,o=s;do{var p=o.lane,m=o.eventTime;if((n&p)===p){d!==null&&(d=d.next={eventTime:m,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var y=t,x=o;switch(p=e,m=r,x.tag){case 1:if(y=x.payload,typeof y=="function"){h=y.call(m,h,p);break e}h=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=x.payload,p=typeof y=="function"?y.call(m,h,p):y,p==null)break e;h=kr({},h,p);break e;case 2:io=!0}}o.callback!==null&&o.lane!==0&&(t.flags|=64,p=i.effects,p===null?i.effects=[o]:p.push(o))}else m={eventTime:m,lane:p,tag:o.tag,payload:o.payload,callback:o.callback,next:null},d===null?(c=d=m,l=h):d=d.next=m,a|=p;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;p=o,o=p.next,p.next=null,i.lastBaseUpdate=p,i.shared.pending=null}}while(!0);if(d===null&&(l=h),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=d,e=i.shared.interleaved,e!==null){i=e;do a|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);El|=a,t.lanes=a,t.memoizedState=h}}function Qy(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(Pe(191,i));i.call(n)}}}var h0={},Qs=Uo(h0),Df=Uo(h0),Pf=Uo(h0);function ol(t){if(t===h0)throw Error(Pe(174));return t}function r1(t,e){switch(tr(Pf,e),tr(Df,t),tr(Qs,h0),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:fm(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=fm(e,t)}cr(Qs),tr(Qs,e)}function $c(){cr(Qs),cr(Df),cr(Pf)}function gT(t){ol(Pf.current);var e=ol(Qs.current),r=fm(e,t.type);e!==r&&(tr(Df,t),tr(Qs,r))}function n1(t){Df.current===t&&(cr(Qs),cr(Df))}var wr=Uo(0);function Sh(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var pg=[];function i1(){for(var t=0;t<pg.length;t++)pg[t]._workInProgressVersionPrimary=null;pg.length=0}var Kd=ja.ReactCurrentDispatcher,gg=ja.ReactCurrentBatchConfig,_l=0,Ar=null,qr=null,cn=null,Ah=!1,sf=!1,Of=0,QI=0;function Pn(){throw Error(Pe(321))}function s1(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!Ns(t[r],e[r]))return!1;return!0}function a1(t,e,r,n,i,s){if(_l=s,Ar=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Kd.current=t===null||t.memoizedState===null?tb:rb,t=r(n,i),sf){s=0;do{if(sf=!1,Of=0,25<=s)throw Error(Pe(301));s+=1,cn=qr=null,e.updateQueue=null,Kd.current=nb,t=r(n,i)}while(sf)}if(Kd.current=kh,e=qr!==null&&qr.next!==null,_l=0,cn=qr=Ar=null,Ah=!1,e)throw Error(Pe(300));return t}function o1(){var t=Of!==0;return Of=0,t}function Ks(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return cn===null?Ar.memoizedState=cn=t:cn=cn.next=t,cn}function us(){if(qr===null){var t=Ar.alternate;t=t!==null?t.memoizedState:null}else t=qr.next;var e=cn===null?Ar.memoizedState:cn.next;if(e!==null)cn=e,qr=t;else{if(t===null)throw Error(Pe(310));qr=t,t={memoizedState:qr.memoizedState,baseState:qr.baseState,baseQueue:qr.baseQueue,queue:qr.queue,next:null},cn===null?Ar.memoizedState=cn=t:cn=cn.next=t}return cn}function Mf(t,e){return typeof e=="function"?e(t):e}function mg(t){var e=us(),r=e.queue;if(r===null)throw Error(Pe(311));r.lastRenderedReducer=t;var n=qr,i=n.baseQueue,s=r.pending;if(s!==null){if(i!==null){var a=i.next;i.next=s.next,s.next=a}n.baseQueue=i=s,r.pending=null}if(i!==null){s=i.next,n=n.baseState;var o=a=null,l=null,c=s;do{var d=c.lane;if((_l&d)===d)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:t(n,c.action);else{var h={lane:d,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(o=l=h,a=n):l=l.next=h,Ar.lanes|=d,El|=d}c=c.next}while(c!==null&&c!==s);l===null?a=n:l.next=o,Ns(n,e.memoizedState)||(_i=!0),e.memoizedState=n,e.baseState=a,e.baseQueue=l,r.lastRenderedState=n}if(t=r.interleaved,t!==null){i=t;do s=i.lane,Ar.lanes|=s,El|=s,i=i.next;while(i!==t)}else i===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function xg(t){var e=us(),r=e.queue;if(r===null)throw Error(Pe(311));r.lastRenderedReducer=t;var n=r.dispatch,i=r.pending,s=e.memoizedState;if(i!==null){r.pending=null;var a=i=i.next;do s=t(s,a.action),a=a.next;while(a!==i);Ns(s,e.memoizedState)||(_i=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),r.lastRenderedState=s}return[s,n]}function mT(){}function xT(t,e){var r=Ar,n=us(),i=e(),s=!Ns(n.memoizedState,i);if(s&&(n.memoizedState=i,_i=!0),n=n.queue,l1(_T.bind(null,r,n,t),[t]),n.getSnapshot!==e||s||cn!==null&&cn.memoizedState.tag&1){if(r.flags|=2048,Lf(9,yT.bind(null,r,n,i,e),void 0,null),dn===null)throw Error(Pe(349));_l&30||vT(r,e,i)}return i}function vT(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=Ar.updateQueue,e===null?(e={lastEffect:null,stores:null},Ar.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function yT(t,e,r,n){e.value=r,e.getSnapshot=n,ET(e)&&wT(t)}function _T(t,e,r){return r(function(){ET(e)&&wT(t)})}function ET(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!Ns(t,r)}catch{return!0}}function wT(t){var e=Ra(t,1);e!==null&&Is(e,t,1,-1)}function Jy(t){var e=Ks();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Mf,lastRenderedState:t},e.queue=t,t=t.dispatch=eb.bind(null,Ar,t),[e.memoizedState,t]}function Lf(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=Ar.updateQueue,e===null?(e={lastEffect:null,stores:null},Ar.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function TT(){return us().memoizedState}function Xd(t,e,r,n){var i=Ks();Ar.flags|=t,i.memoizedState=Lf(1|e,r,void 0,n===void 0?null:n)}function gp(t,e,r,n){var i=us();n=n===void 0?null:n;var s=void 0;if(qr!==null){var a=qr.memoizedState;if(s=a.destroy,n!==null&&s1(n,a.deps)){i.memoizedState=Lf(e,r,s,n);return}}Ar.flags|=t,i.memoizedState=Lf(1|e,r,s,n)}function Zy(t,e){return Xd(8390656,8,t,e)}function l1(t,e){return gp(2048,8,t,e)}function ST(t,e){return gp(4,2,t,e)}function AT(t,e){return gp(4,4,t,e)}function kT(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function CT(t,e,r){return r=r!=null?r.concat([t]):null,gp(4,4,kT.bind(null,e,t),r)}function c1(){}function FT(t,e){var r=us();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&s1(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function IT(t,e){var r=us();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&s1(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function bT(t,e,r){return _l&21?(Ns(r,e)||(r=Ow(),Ar.lanes|=r,El|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,_i=!0),t.memoizedState=r)}function JI(t,e){var r=Kt;Kt=r!==0&&4>r?r:4,t(!0);var n=gg.transition;gg.transition={};try{t(!1),e()}finally{Kt=r,gg.transition=n}}function RT(){return us().memoizedState}function ZI(t,e,r){var n=So(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},NT(t))DT(e,r);else if(r=hT(t,e,r,n),r!==null){var i=si();Is(r,t,n,i),PT(r,e,n)}}function eb(t,e,r){var n=So(t),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(NT(t))DT(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var a=e.lastRenderedState,o=s(a,r);if(i.hasEagerState=!0,i.eagerState=o,Ns(o,a)){var l=e.interleaved;l===null?(i.next=i,e1(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}r=hT(t,e,i,n),r!==null&&(i=si(),Is(r,t,n,i),PT(r,e,n))}}function NT(t){var e=t.alternate;return t===Ar||e!==null&&e===Ar}function DT(t,e){sf=Ah=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function PT(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,Vx(t,r)}}var kh={readContext:cs,useCallback:Pn,useContext:Pn,useEffect:Pn,useImperativeHandle:Pn,useInsertionEffect:Pn,useLayoutEffect:Pn,useMemo:Pn,useReducer:Pn,useRef:Pn,useState:Pn,useDebugValue:Pn,useDeferredValue:Pn,useTransition:Pn,useMutableSource:Pn,useSyncExternalStore:Pn,useId:Pn,unstable_isNewReconciler:!1},tb={readContext:cs,useCallback:function(t,e){return Ks().memoizedState=[t,e===void 0?null:e],t},useContext:cs,useEffect:Zy,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,Xd(4194308,4,kT.bind(null,e,t),r)},useLayoutEffect:function(t,e){return Xd(4194308,4,t,e)},useInsertionEffect:function(t,e){return Xd(4,2,t,e)},useMemo:function(t,e){var r=Ks();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=Ks();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=ZI.bind(null,Ar,t),[n.memoizedState,t]},useRef:function(t){var e=Ks();return t={current:t},e.memoizedState=t},useState:Jy,useDebugValue:c1,useDeferredValue:function(t){return Ks().memoizedState=t},useTransition:function(){var t=Jy(!1),e=t[0];return t=JI.bind(null,t[1]),Ks().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=Ar,i=Ks();if(xr){if(r===void 0)throw Error(Pe(407));r=r()}else{if(r=e(),dn===null)throw Error(Pe(349));_l&30||vT(n,e,r)}i.memoizedState=r;var s={value:r,getSnapshot:e};return i.queue=s,Zy(_T.bind(null,n,s,t),[t]),n.flags|=2048,Lf(9,yT.bind(null,n,s,r,e),void 0,null),r},useId:function(){var t=Ks(),e=dn.identifierPrefix;if(xr){var r=ya,n=va;r=(n&~(1<<32-Fs(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=Of++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=QI++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},rb={readContext:cs,useCallback:FT,useContext:cs,useEffect:l1,useImperativeHandle:CT,useInsertionEffect:ST,useLayoutEffect:AT,useMemo:IT,useReducer:mg,useRef:TT,useState:function(){return mg(Mf)},useDebugValue:c1,useDeferredValue:function(t){var e=us();return bT(e,qr.memoizedState,t)},useTransition:function(){var t=mg(Mf)[0],e=us().memoizedState;return[t,e]},useMutableSource:mT,useSyncExternalStore:xT,useId:RT,unstable_isNewReconciler:!1},nb={readContext:cs,useCallback:FT,useContext:cs,useEffect:l1,useImperativeHandle:CT,useInsertionEffect:ST,useLayoutEffect:AT,useMemo:IT,useReducer:xg,useRef:TT,useState:function(){return xg(Mf)},useDebugValue:c1,useDeferredValue:function(t){var e=us();return qr===null?e.memoizedState=t:bT(e,qr.memoizedState,t)},useTransition:function(){var t=xg(Mf)[0],e=us().memoizedState;return[t,e]},useMutableSource:mT,useSyncExternalStore:xT,useId:RT,unstable_isNewReconciler:!1};function ws(t,e){if(t&&t.defaultProps){e=kr({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function Nm(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:kr({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var mp={isMounted:function(t){return(t=t._reactInternals)?Ol(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=si(),i=So(t),s=Sa(n,i);s.payload=e,r!=null&&(s.callback=r),e=wo(t,s,i),e!==null&&(Is(e,t,i,n),Gd(e,t,i))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=si(),i=So(t),s=Sa(n,i);s.tag=1,s.payload=e,r!=null&&(s.callback=r),e=wo(t,s,i),e!==null&&(Is(e,t,i,n),Gd(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=si(),n=So(t),i=Sa(r,n);i.tag=2,e!=null&&(i.callback=e),e=wo(t,i,n),e!==null&&(Is(e,t,n,r),Gd(e,t,n))}};function e_(t,e,r,n,i,s,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,s,a):e.prototype&&e.prototype.isPureReactComponent?!If(r,n)||!If(i,s):!0}function OT(t,e,r){var n=!1,i=No,s=e.contextType;return typeof s=="object"&&s!==null?s=cs(s):(i=wi(e)?vl:Gn.current,n=e.contextTypes,s=(n=n!=null)?zc(t,i):No),e=new e(r,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=mp,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function t_(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&mp.enqueueReplaceState(e,e.state,null)}function Dm(t,e,r,n){var i=t.stateNode;i.props=r,i.state=t.memoizedState,i.refs={},t1(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=cs(s):(s=wi(e)?vl:Gn.current,i.context=zc(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(Nm(t,e,s,r),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&mp.enqueueReplaceState(i,i.state,null),Th(t,r,i,n),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Gc(t,e){try{var r="",n=e;do r+=RF(n),n=n.return;while(n);var i=r}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function vg(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function Pm(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var ib=typeof WeakMap=="function"?WeakMap:Map;function MT(t,e,r){r=Sa(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){Fh||(Fh=!0,Hm=n),Pm(t,e)},r}function LT(t,e,r){r=Sa(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var i=e.value;r.payload=function(){return n(i)},r.callback=function(){Pm(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){Pm(t,e),typeof n!="function"&&(To===null?To=new Set([this]):To.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),r}function r_(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new ib;var i=new Set;n.set(e,i)}else i=n.get(e),i===void 0&&(i=new Set,n.set(e,i));i.has(r)||(i.add(r),t=vb.bind(null,t,e,r),e.then(t,t))}function n_(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function i_(t,e,r,n,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=Sa(-1,1),e.tag=2,wo(r,e,1))),r.lanes|=1),t)}var sb=ja.ReactCurrentOwner,_i=!1;function ri(t,e,r,n){e.child=t===null?dT(e,null,r,n):Hc(e,t.child,r,n)}function s_(t,e,r,n,i){r=r.render;var s=e.ref;return Rc(e,i),n=a1(t,e,r,n,s,i),r=o1(),t!==null&&!_i?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Na(t,e,i)):(xr&&r&&Xx(e),e.flags|=1,ri(t,e,n,i),e.child)}function a_(t,e,r,n,i){if(t===null){var s=r.type;return typeof s=="function"&&!x1(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=s,BT(t,e,s,n,i)):(t=Jd(r.type,null,n,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var a=s.memoizedProps;if(r=r.compare,r=r!==null?r:If,r(a,n)&&t.ref===e.ref)return Na(t,e,i)}return e.flags|=1,t=Ao(s,n),t.ref=e.ref,t.return=e,e.child=t}function BT(t,e,r,n,i){if(t!==null){var s=t.memoizedProps;if(If(s,n)&&t.ref===e.ref)if(_i=!1,e.pendingProps=n=s,(t.lanes&i)!==0)t.flags&131072&&(_i=!0);else return e.lanes=t.lanes,Na(t,e,i)}return Om(t,e,r,n,i)}function jT(t,e,r){var n=e.pendingProps,i=n.children,s=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},tr(Tc,Di),Di|=r;else{if(!(r&1073741824))return t=s!==null?s.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,tr(Tc,Di),Di|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,tr(Tc,Di),Di|=n}else s!==null?(n=s.baseLanes|r,e.memoizedState=null):n=r,tr(Tc,Di),Di|=n;return ri(t,e,i,r),e.child}function VT(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function Om(t,e,r,n,i){var s=wi(r)?vl:Gn.current;return s=zc(e,s),Rc(e,i),r=a1(t,e,r,n,s,i),n=o1(),t!==null&&!_i?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Na(t,e,i)):(xr&&n&&Xx(e),e.flags|=1,ri(t,e,r,i),e.child)}function o_(t,e,r,n,i){if(wi(r)){var s=!0;vh(e)}else s=!1;if(Rc(e,i),e.stateNode===null)Yd(t,e),OT(e,r,n),Dm(e,r,n,i),n=!0;else if(t===null){var a=e.stateNode,o=e.memoizedProps;a.props=o;var l=a.context,c=r.contextType;typeof c=="object"&&c!==null?c=cs(c):(c=wi(r)?vl:Gn.current,c=zc(e,c));var d=r.getDerivedStateFromProps,h=typeof d=="function"||typeof a.getSnapshotBeforeUpdate=="function";h||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==n||l!==c)&&t_(e,a,n,c),io=!1;var p=e.memoizedState;a.state=p,Th(e,n,a,i),l=e.memoizedState,o!==n||p!==l||Ei.current||io?(typeof d=="function"&&(Nm(e,r,d,n),l=e.memoizedState),(o=io||e_(e,r,o,n,p,l,c))?(h||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=l),a.props=n,a.state=l,a.context=c,n=o):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{a=e.stateNode,pT(t,e),o=e.memoizedProps,c=e.type===e.elementType?o:ws(e.type,o),a.props=c,h=e.pendingProps,p=a.context,l=r.contextType,typeof l=="object"&&l!==null?l=cs(l):(l=wi(r)?vl:Gn.current,l=zc(e,l));var m=r.getDerivedStateFromProps;(d=typeof m=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==h||p!==l)&&t_(e,a,n,l),io=!1,p=e.memoizedState,a.state=p,Th(e,n,a,i);var y=e.memoizedState;o!==h||p!==y||Ei.current||io?(typeof m=="function"&&(Nm(e,r,m,n),y=e.memoizedState),(c=io||e_(e,r,c,n,p,y,l)||!1)?(d||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(n,y,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(n,y,l)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=y),a.props=n,a.state=y,a.context=l,n=c):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),n=!1)}return Mm(t,e,r,n,s,i)}function Mm(t,e,r,n,i,s){VT(t,e);var a=(e.flags&128)!==0;if(!n&&!a)return i&&Gy(e,r,!1),Na(t,e,s);n=e.stateNode,sb.current=e;var o=a&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&a?(e.child=Hc(e,t.child,null,s),e.child=Hc(e,null,o,s)):ri(t,e,o,s),e.memoizedState=n.state,i&&Gy(e,r,!0),e.child}function UT(t){var e=t.stateNode;e.pendingContext?$y(t,e.pendingContext,e.pendingContext!==e.context):e.context&&$y(t,e.context,!1),r1(t,e.containerInfo)}function l_(t,e,r,n,i){return Wc(),qx(i),e.flags|=256,ri(t,e,r,n),e.child}var Lm={dehydrated:null,treeContext:null,retryLane:0};function Bm(t){return{baseLanes:t,cachePool:null,transitions:null}}function zT(t,e,r){var n=e.pendingProps,i=wr.current,s=!1,a=(e.flags&128)!==0,o;if((o=a)||(o=t!==null&&t.memoizedState===null?!1:(i&2)!==0),o?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),tr(wr,i&1),t===null)return bm(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=n.children,t=n.fallback,s?(n=e.mode,s=e.child,a={mode:"hidden",children:a},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=yp(a,n,0,null),t=fl(t,n,r,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=Bm(r),e.memoizedState=Lm,t):u1(e,a));if(i=t.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return ab(t,e,a,n,o,i,r);if(s){s=n.fallback,a=e.mode,i=t.child,o=i.sibling;var l={mode:"hidden",children:n.children};return!(a&1)&&e.child!==i?(n=e.child,n.childLanes=0,n.pendingProps=l,e.deletions=null):(n=Ao(i,l),n.subtreeFlags=i.subtreeFlags&14680064),o!==null?s=Ao(o,s):(s=fl(s,a,r,null),s.flags|=2),s.return=e,n.return=e,n.sibling=s,e.child=n,n=s,s=e.child,a=t.child.memoizedState,a=a===null?Bm(r):{baseLanes:a.baseLanes|r,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=t.childLanes&~r,e.memoizedState=Lm,n}return s=t.child,t=s.sibling,n=Ao(s,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function u1(t,e){return e=yp({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function gd(t,e,r,n){return n!==null&&qx(n),Hc(e,t.child,null,r),t=u1(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function ab(t,e,r,n,i,s,a){if(r)return e.flags&256?(e.flags&=-257,n=vg(Error(Pe(422))),gd(t,e,a,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=n.fallback,i=e.mode,n=yp({mode:"visible",children:n.children},i,0,null),s=fl(s,i,a,null),s.flags|=2,n.return=e,s.return=e,n.sibling=s,e.child=n,e.mode&1&&Hc(e,t.child,null,a),e.child.memoizedState=Bm(a),e.memoizedState=Lm,s);if(!(e.mode&1))return gd(t,e,a,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var o=n.dgst;return n=o,s=Error(Pe(419)),n=vg(s,n,void 0),gd(t,e,a,n)}if(o=(a&t.childLanes)!==0,_i||o){if(n=dn,n!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|a)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Ra(t,i),Is(n,t,i,-1))}return m1(),n=vg(Error(Pe(421))),gd(t,e,a,n)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=yb.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,Bi=Eo(i.nextSibling),ji=e,xr=!0,Ss=null,t!==null&&(ns[is++]=va,ns[is++]=ya,ns[is++]=yl,va=t.id,ya=t.overflow,yl=e),e=u1(e,n.children),e.flags|=4096,e)}function c_(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),Rm(t.return,e,r)}function yg(t,e,r,n,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function WT(t,e,r){var n=e.pendingProps,i=n.revealOrder,s=n.tail;if(ri(t,e,n.children,r),n=wr.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&c_(t,r,e);else if(t.tag===19)c_(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(tr(wr,n),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(r=e.child,i=null;r!==null;)t=r.alternate,t!==null&&Sh(t)===null&&(i=r),r=r.sibling;r=i,r===null?(i=e.child,e.child=null):(i=r.sibling,r.sibling=null),yg(e,!1,i,r,s);break;case"backwards":for(r=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Sh(t)===null){e.child=i;break}t=i.sibling,i.sibling=r,r=i,i=t}yg(e,!0,r,null,s);break;case"together":yg(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Yd(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Na(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),El|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Pe(153));if(e.child!==null){for(t=e.child,r=Ao(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=Ao(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function ob(t,e,r){switch(e.tag){case 3:UT(e),Wc();break;case 5:gT(e);break;case 1:wi(e.type)&&vh(e);break;case 4:r1(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,i=e.memoizedProps.value;tr(Eh,n._currentValue),n._currentValue=i;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(tr(wr,wr.current&1),e.flags|=128,null):r&e.child.childLanes?zT(t,e,r):(tr(wr,wr.current&1),t=Na(t,e,r),t!==null?t.sibling:null);tr(wr,wr.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return WT(t,e,r);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),tr(wr,wr.current),n)break;return null;case 22:case 23:return e.lanes=0,jT(t,e,r)}return Na(t,e,r)}var HT,jm,$T,GT;HT=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};jm=function(){};$T=function(t,e,r,n){var i=t.memoizedProps;if(i!==n){t=e.stateNode,ol(Qs.current);var s=null;switch(r){case"input":i=om(t,i),n=om(t,n),s=[];break;case"select":i=kr({},i,{value:void 0}),n=kr({},n,{value:void 0}),s=[];break;case"textarea":i=um(t,i),n=um(t,n),s=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=mh)}dm(r,n);var a;r=null;for(c in i)if(!n.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var o=i[c];for(a in o)o.hasOwnProperty(a)&&(r||(r={}),r[a]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(wf.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in n){var l=n[c];if(o=i!=null?i[c]:void 0,n.hasOwnProperty(c)&&l!==o&&(l!=null||o!=null))if(c==="style")if(o){for(a in o)!o.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(r||(r={}),r[a]="");for(a in l)l.hasOwnProperty(a)&&o[a]!==l[a]&&(r||(r={}),r[a]=l[a])}else r||(s||(s=[]),s.push(c,r)),r=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(wf.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&or("scroll",t),s||o===l||(s=[])):(s=s||[]).push(c,l))}r&&(s=s||[]).push("style",r);var c=s;(e.updateQueue=c)&&(e.flags|=4)}};GT=function(t,e,r,n){r!==n&&(e.flags|=4)};function Ou(t,e){if(!xr)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function On(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function lb(t,e,r){var n=e.pendingProps;switch(Yx(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return On(e),null;case 1:return wi(e.type)&&xh(),On(e),null;case 3:return n=e.stateNode,$c(),cr(Ei),cr(Gn),i1(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(hd(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Ss!==null&&(Km(Ss),Ss=null))),jm(t,e),On(e),null;case 5:n1(e);var i=ol(Pf.current);if(r=e.type,t!==null&&e.stateNode!=null)$T(t,e,r,n,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(Pe(166));return On(e),null}if(t=ol(Qs.current),hd(e)){n=e.stateNode,r=e.type;var s=e.memoizedProps;switch(n[Xs]=e,n[Nf]=s,t=(e.mode&1)!==0,r){case"dialog":or("cancel",n),or("close",n);break;case"iframe":case"object":case"embed":or("load",n);break;case"video":case"audio":for(i=0;i<$u.length;i++)or($u[i],n);break;case"source":or("error",n);break;case"img":case"image":case"link":or("error",n),or("load",n);break;case"details":or("toggle",n);break;case"input":vy(n,s),or("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},or("invalid",n);break;case"textarea":_y(n,s),or("invalid",n)}dm(r,s),i=null;for(var a in s)if(s.hasOwnProperty(a)){var o=s[a];a==="children"?typeof o=="string"?n.textContent!==o&&(s.suppressHydrationWarning!==!0&&dd(n.textContent,o,t),i=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&dd(n.textContent,o,t),i=["children",""+o]):wf.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&or("scroll",n)}switch(r){case"input":id(n),yy(n,s,!0);break;case"textarea":id(n),Ey(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=mh)}n=i,e.updateQueue=n,n!==null&&(e.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=_w(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=a.createElement(r,{is:n.is}):(t=a.createElement(r),r==="select"&&(a=t,n.multiple?a.multiple=!0:n.size&&(a.size=n.size))):t=a.createElementNS(t,r),t[Xs]=e,t[Nf]=n,HT(t,e,!1,!1),e.stateNode=t;e:{switch(a=hm(r,n),r){case"dialog":or("cancel",t),or("close",t),i=n;break;case"iframe":case"object":case"embed":or("load",t),i=n;break;case"video":case"audio":for(i=0;i<$u.length;i++)or($u[i],t);i=n;break;case"source":or("error",t),i=n;break;case"img":case"image":case"link":or("error",t),or("load",t),i=n;break;case"details":or("toggle",t),i=n;break;case"input":vy(t,n),i=om(t,n),or("invalid",t);break;case"option":i=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},i=kr({},n,{value:void 0}),or("invalid",t);break;case"textarea":_y(t,n),i=um(t,n),or("invalid",t);break;default:i=n}dm(r,i),o=i;for(s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="style"?Tw(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&Ew(t,l)):s==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&Tf(t,l):typeof l=="number"&&Tf(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(wf.hasOwnProperty(s)?l!=null&&s==="onScroll"&&or("scroll",t):l!=null&&Px(t,s,l,a))}switch(r){case"input":id(t),yy(t,n,!1);break;case"textarea":id(t),Ey(t);break;case"option":n.value!=null&&t.setAttribute("value",""+Ro(n.value));break;case"select":t.multiple=!!n.multiple,s=n.value,s!=null?Cc(t,!!n.multiple,s,!1):n.defaultValue!=null&&Cc(t,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=mh)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return On(e),null;case 6:if(t&&e.stateNode!=null)GT(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(Pe(166));if(r=ol(Pf.current),ol(Qs.current),hd(e)){if(n=e.stateNode,r=e.memoizedProps,n[Xs]=e,(s=n.nodeValue!==r)&&(t=ji,t!==null))switch(t.tag){case 3:dd(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&dd(n.nodeValue,r,(t.mode&1)!==0)}s&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Xs]=e,e.stateNode=n}return On(e),null;case 13:if(cr(wr),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(xr&&Bi!==null&&e.mode&1&&!(e.flags&128))uT(),Wc(),e.flags|=98560,s=!1;else if(s=hd(e),n!==null&&n.dehydrated!==null){if(t===null){if(!s)throw Error(Pe(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Pe(317));s[Xs]=e}else Wc(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;On(e),s=!1}else Ss!==null&&(Km(Ss),Ss=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||wr.current&1?Zr===0&&(Zr=3):m1())),e.updateQueue!==null&&(e.flags|=4),On(e),null);case 4:return $c(),jm(t,e),t===null&&bf(e.stateNode.containerInfo),On(e),null;case 10:return Zx(e.type._context),On(e),null;case 17:return wi(e.type)&&xh(),On(e),null;case 19:if(cr(wr),s=e.memoizedState,s===null)return On(e),null;if(n=(e.flags&128)!==0,a=s.rendering,a===null)if(n)Ou(s,!1);else{if(Zr!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=Sh(t),a!==null){for(e.flags|=128,Ou(s,!1),n=a.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)s=r,t=n,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,t=a.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return tr(wr,wr.current&1|2),e.child}t=t.sibling}s.tail!==null&&Mr()>Kc&&(e.flags|=128,n=!0,Ou(s,!1),e.lanes=4194304)}else{if(!n)if(t=Sh(a),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),Ou(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!xr)return On(e),null}else 2*Mr()-s.renderingStartTime>Kc&&r!==1073741824&&(e.flags|=128,n=!0,Ou(s,!1),e.lanes=4194304);s.isBackwards?(a.sibling=e.child,e.child=a):(r=s.last,r!==null?r.sibling=a:e.child=a,s.last=a)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Mr(),e.sibling=null,r=wr.current,tr(wr,n?r&1|2:r&1),e):(On(e),null);case 22:case 23:return g1(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?Di&1073741824&&(On(e),e.subtreeFlags&6&&(e.flags|=8192)):On(e),null;case 24:return null;case 25:return null}throw Error(Pe(156,e.tag))}function cb(t,e){switch(Yx(e),e.tag){case 1:return wi(e.type)&&xh(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return $c(),cr(Ei),cr(Gn),i1(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return n1(e),null;case 13:if(cr(wr),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Pe(340));Wc()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return cr(wr),null;case 4:return $c(),null;case 10:return Zx(e.type._context),null;case 22:case 23:return g1(),null;case 24:return null;default:return null}}var md=!1,Un=!1,ub=typeof WeakSet=="function"?WeakSet:Set,qe=null;function wc(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Ir(t,e,n)}else r.current=null}function Vm(t,e,r){try{r()}catch(n){Ir(t,e,n)}}var u_=!1;function fb(t,e){if(Tm=hh,t=Qw(),Kx(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var a=0,o=-1,l=-1,c=0,d=0,h=t,p=null;t:for(;;){for(var m;h!==r||i!==0&&h.nodeType!==3||(o=a+i),h!==s||n!==0&&h.nodeType!==3||(l=a+n),h.nodeType===3&&(a+=h.nodeValue.length),(m=h.firstChild)!==null;)p=h,h=m;for(;;){if(h===t)break t;if(p===r&&++c===i&&(o=a),p===s&&++d===n&&(l=a),(m=h.nextSibling)!==null)break;h=p,p=h.parentNode}h=m}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(Sm={focusedElem:t,selectionRange:r},hh=!1,qe=e;qe!==null;)if(e=qe,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,qe=t;else for(;qe!==null;){e=qe;try{var y=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var x=y.memoizedProps,E=y.memoizedState,T=e.stateNode,A=T.getSnapshotBeforeUpdate(e.elementType===e.type?x:ws(e.type,x),E);T.__reactInternalSnapshotBeforeUpdate=A}break;case 3:var _=e.stateNode.containerInfo;_.nodeType===1?_.textContent="":_.nodeType===9&&_.documentElement&&_.removeChild(_.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Pe(163))}}catch(P){Ir(e,e.return,P)}if(t=e.sibling,t!==null){t.return=e.return,qe=t;break}qe=e.return}return y=u_,u_=!1,y}function af(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&Vm(e,r,s)}i=i.next}while(i!==n)}}function xp(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function Um(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function KT(t){var e=t.alternate;e!==null&&(t.alternate=null,KT(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Xs],delete e[Nf],delete e[Cm],delete e[KI],delete e[XI])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function XT(t){return t.tag===5||t.tag===3||t.tag===4}function f_(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||XT(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function zm(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=mh));else if(n!==4&&(t=t.child,t!==null))for(zm(t,e,r),t=t.sibling;t!==null;)zm(t,e,r),t=t.sibling}function Wm(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(Wm(t,e,r),t=t.sibling;t!==null;)Wm(t,e,r),t=t.sibling}var Tn=null,Ts=!1;function eo(t,e,r){for(r=r.child;r!==null;)YT(t,e,r),r=r.sibling}function YT(t,e,r){if(qs&&typeof qs.onCommitFiberUnmount=="function")try{qs.onCommitFiberUnmount(cp,r)}catch{}switch(r.tag){case 5:Un||wc(r,e);case 6:var n=Tn,i=Ts;Tn=null,eo(t,e,r),Tn=n,Ts=i,Tn!==null&&(Ts?(t=Tn,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):Tn.removeChild(r.stateNode));break;case 18:Tn!==null&&(Ts?(t=Tn,r=r.stateNode,t.nodeType===8?dg(t.parentNode,r):t.nodeType===1&&dg(t,r),Cf(t)):dg(Tn,r.stateNode));break;case 4:n=Tn,i=Ts,Tn=r.stateNode.containerInfo,Ts=!0,eo(t,e,r),Tn=n,Ts=i;break;case 0:case 11:case 14:case 15:if(!Un&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var s=i,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&Vm(r,e,a),i=i.next}while(i!==n)}eo(t,e,r);break;case 1:if(!Un&&(wc(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){Ir(r,e,o)}eo(t,e,r);break;case 21:eo(t,e,r);break;case 22:r.mode&1?(Un=(n=Un)||r.memoizedState!==null,eo(t,e,r),Un=n):eo(t,e,r);break;default:eo(t,e,r)}}function d_(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new ub),e.forEach(function(n){var i=_b.bind(null,t,n);r.has(n)||(r.add(n),n.then(i,i))})}}function _s(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var s=t,a=e,o=a;e:for(;o!==null;){switch(o.tag){case 5:Tn=o.stateNode,Ts=!1;break e;case 3:Tn=o.stateNode.containerInfo,Ts=!0;break e;case 4:Tn=o.stateNode.containerInfo,Ts=!0;break e}o=o.return}if(Tn===null)throw Error(Pe(160));YT(s,a,i),Tn=null,Ts=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(c){Ir(i,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)qT(e,t),e=e.sibling}function qT(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(_s(e,t),Us(t),n&4){try{af(3,t,t.return),xp(3,t)}catch(x){Ir(t,t.return,x)}try{af(5,t,t.return)}catch(x){Ir(t,t.return,x)}}break;case 1:_s(e,t),Us(t),n&512&&r!==null&&wc(r,r.return);break;case 5:if(_s(e,t),Us(t),n&512&&r!==null&&wc(r,r.return),t.flags&32){var i=t.stateNode;try{Tf(i,"")}catch(x){Ir(t,t.return,x)}}if(n&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,a=r!==null?r.memoizedProps:s,o=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&vw(i,s),hm(o,a);var c=hm(o,s);for(a=0;a<l.length;a+=2){var d=l[a],h=l[a+1];d==="style"?Tw(i,h):d==="dangerouslySetInnerHTML"?Ew(i,h):d==="children"?Tf(i,h):Px(i,d,h,c)}switch(o){case"input":lm(i,s);break;case"textarea":yw(i,s);break;case"select":var p=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var m=s.value;m!=null?Cc(i,!!s.multiple,m,!1):p!==!!s.multiple&&(s.defaultValue!=null?Cc(i,!!s.multiple,s.defaultValue,!0):Cc(i,!!s.multiple,s.multiple?[]:"",!1))}i[Nf]=s}catch(x){Ir(t,t.return,x)}}break;case 6:if(_s(e,t),Us(t),n&4){if(t.stateNode===null)throw Error(Pe(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(x){Ir(t,t.return,x)}}break;case 3:if(_s(e,t),Us(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Cf(e.containerInfo)}catch(x){Ir(t,t.return,x)}break;case 4:_s(e,t),Us(t);break;case 13:_s(e,t),Us(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(h1=Mr())),n&4&&d_(t);break;case 22:if(d=r!==null&&r.memoizedState!==null,t.mode&1?(Un=(c=Un)||d,_s(e,t),Un=c):_s(e,t),Us(t),n&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!d&&t.mode&1)for(qe=t,d=t.child;d!==null;){for(h=qe=d;qe!==null;){switch(p=qe,m=p.child,p.tag){case 0:case 11:case 14:case 15:af(4,p,p.return);break;case 1:wc(p,p.return);var y=p.stateNode;if(typeof y.componentWillUnmount=="function"){n=p,r=p.return;try{e=n,y.props=e.memoizedProps,y.state=e.memoizedState,y.componentWillUnmount()}catch(x){Ir(n,r,x)}}break;case 5:wc(p,p.return);break;case 22:if(p.memoizedState!==null){p_(h);continue}}m!==null?(m.return=p,qe=m):p_(h)}d=d.sibling}e:for(d=null,h=t;;){if(h.tag===5){if(d===null){d=h;try{i=h.stateNode,c?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=h.stateNode,l=h.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=ww("display",a))}catch(x){Ir(t,t.return,x)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(x){Ir(t,t.return,x)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:_s(e,t),Us(t),n&4&&d_(t);break;case 21:break;default:_s(e,t),Us(t)}}function Us(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(XT(r)){var n=r;break e}r=r.return}throw Error(Pe(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(Tf(i,""),n.flags&=-33);var s=f_(t);Wm(t,s,i);break;case 3:case 4:var a=n.stateNode.containerInfo,o=f_(t);zm(t,o,a);break;default:throw Error(Pe(161))}}catch(l){Ir(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function db(t,e,r){qe=t,QT(t)}function QT(t,e,r){for(var n=(t.mode&1)!==0;qe!==null;){var i=qe,s=i.child;if(i.tag===22&&n){var a=i.memoizedState!==null||md;if(!a){var o=i.alternate,l=o!==null&&o.memoizedState!==null||Un;o=md;var c=Un;if(md=a,(Un=l)&&!c)for(qe=i;qe!==null;)a=qe,l=a.child,a.tag===22&&a.memoizedState!==null?g_(i):l!==null?(l.return=a,qe=l):g_(i);for(;s!==null;)qe=s,QT(s),s=s.sibling;qe=i,md=o,Un=c}h_(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,qe=s):h_(t)}}function h_(t){for(;qe!==null;){var e=qe;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Un||xp(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!Un)if(r===null)n.componentDidMount();else{var i=e.elementType===e.type?r.memoizedProps:ws(e.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&Qy(e,s,n);break;case 3:var a=e.updateQueue;if(a!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}Qy(e,a,r)}break;case 5:var o=e.stateNode;if(r===null&&e.flags&4){r=o;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var d=c.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&Cf(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Pe(163))}Un||e.flags&512&&Um(e)}catch(p){Ir(e,e.return,p)}}if(e===t){qe=null;break}if(r=e.sibling,r!==null){r.return=e.return,qe=r;break}qe=e.return}}function p_(t){for(;qe!==null;){var e=qe;if(e===t){qe=null;break}var r=e.sibling;if(r!==null){r.return=e.return,qe=r;break}qe=e.return}}function g_(t){for(;qe!==null;){var e=qe;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{xp(4,e)}catch(l){Ir(e,r,l)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var i=e.return;try{n.componentDidMount()}catch(l){Ir(e,i,l)}}var s=e.return;try{Um(e)}catch(l){Ir(e,s,l)}break;case 5:var a=e.return;try{Um(e)}catch(l){Ir(e,a,l)}}}catch(l){Ir(e,e.return,l)}if(e===t){qe=null;break}var o=e.sibling;if(o!==null){o.return=e.return,qe=o;break}qe=e.return}}var hb=Math.ceil,Ch=ja.ReactCurrentDispatcher,f1=ja.ReactCurrentOwner,os=ja.ReactCurrentBatchConfig,Nt=0,dn=null,Hr=null,Fn=0,Di=0,Tc=Uo(0),Zr=0,Bf=null,El=0,vp=0,d1=0,of=null,yi=null,h1=0,Kc=1/0,ma=null,Fh=!1,Hm=null,To=null,xd=!1,ho=null,Ih=0,lf=0,$m=null,qd=-1,Qd=0;function si(){return Nt&6?Mr():qd!==-1?qd:qd=Mr()}function So(t){return t.mode&1?Nt&2&&Fn!==0?Fn&-Fn:qI.transition!==null?(Qd===0&&(Qd=Ow()),Qd):(t=Kt,t!==0||(t=window.event,t=t===void 0?16:zw(t.type)),t):1}function Is(t,e,r,n){if(50<lf)throw lf=0,$m=null,Error(Pe(185));u0(t,r,n),(!(Nt&2)||t!==dn)&&(t===dn&&(!(Nt&2)&&(vp|=r),Zr===4&&ao(t,Fn)),Ti(t,n),r===1&&Nt===0&&!(e.mode&1)&&(Kc=Mr()+500,pp&&zo()))}function Ti(t,e){var r=t.callbackNode;qF(t,e);var n=dh(t,t===dn?Fn:0);if(n===0)r!==null&&Sy(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&Sy(r),e===1)t.tag===0?YI(m_.bind(null,t)):oT(m_.bind(null,t)),$I(function(){!(Nt&6)&&zo()}),r=null;else{switch(Mw(n)){case 1:r=jx;break;case 4:r=Dw;break;case 16:r=fh;break;case 536870912:r=Pw;break;default:r=fh}r=sS(r,JT.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function JT(t,e){if(qd=-1,Qd=0,Nt&6)throw Error(Pe(327));var r=t.callbackNode;if(Nc()&&t.callbackNode!==r)return null;var n=dh(t,t===dn?Fn:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=bh(t,n);else{e=n;var i=Nt;Nt|=2;var s=eS();(dn!==t||Fn!==e)&&(ma=null,Kc=Mr()+500,ul(t,e));do try{mb();break}catch(o){ZT(t,o)}while(!0);Jx(),Ch.current=s,Nt=i,Hr!==null?e=0:(dn=null,Fn=0,e=Zr)}if(e!==0){if(e===2&&(i=vm(t),i!==0&&(n=i,e=Gm(t,i))),e===1)throw r=Bf,ul(t,0),ao(t,n),Ti(t,Mr()),r;if(e===6)ao(t,n);else{if(i=t.current.alternate,!(n&30)&&!pb(i)&&(e=bh(t,n),e===2&&(s=vm(t),s!==0&&(n=s,e=Gm(t,s))),e===1))throw r=Bf,ul(t,0),ao(t,n),Ti(t,Mr()),r;switch(t.finishedWork=i,t.finishedLanes=n,e){case 0:case 1:throw Error(Pe(345));case 2:tl(t,yi,ma);break;case 3:if(ao(t,n),(n&130023424)===n&&(e=h1+500-Mr(),10<e)){if(dh(t,0)!==0)break;if(i=t.suspendedLanes,(i&n)!==n){si(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=km(tl.bind(null,t,yi,ma),e);break}tl(t,yi,ma);break;case 4:if(ao(t,n),(n&4194240)===n)break;for(e=t.eventTimes,i=-1;0<n;){var a=31-Fs(n);s=1<<a,a=e[a],a>i&&(i=a),n&=~s}if(n=i,n=Mr()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*hb(n/1960))-n,10<n){t.timeoutHandle=km(tl.bind(null,t,yi,ma),n);break}tl(t,yi,ma);break;case 5:tl(t,yi,ma);break;default:throw Error(Pe(329))}}}return Ti(t,Mr()),t.callbackNode===r?JT.bind(null,t):null}function Gm(t,e){var r=of;return t.current.memoizedState.isDehydrated&&(ul(t,e).flags|=256),t=bh(t,e),t!==2&&(e=yi,yi=r,e!==null&&Km(e)),t}function Km(t){yi===null?yi=t:yi.push.apply(yi,t)}function pb(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!Ns(s(),i))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function ao(t,e){for(e&=~d1,e&=~vp,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-Fs(e),n=1<<r;t[r]=-1,e&=~n}}function m_(t){if(Nt&6)throw Error(Pe(327));Nc();var e=dh(t,0);if(!(e&1))return Ti(t,Mr()),null;var r=bh(t,e);if(t.tag!==0&&r===2){var n=vm(t);n!==0&&(e=n,r=Gm(t,n))}if(r===1)throw r=Bf,ul(t,0),ao(t,e),Ti(t,Mr()),r;if(r===6)throw Error(Pe(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,tl(t,yi,ma),Ti(t,Mr()),null}function p1(t,e){var r=Nt;Nt|=1;try{return t(e)}finally{Nt=r,Nt===0&&(Kc=Mr()+500,pp&&zo())}}function wl(t){ho!==null&&ho.tag===0&&!(Nt&6)&&Nc();var e=Nt;Nt|=1;var r=os.transition,n=Kt;try{if(os.transition=null,Kt=1,t)return t()}finally{Kt=n,os.transition=r,Nt=e,!(Nt&6)&&zo()}}function g1(){Di=Tc.current,cr(Tc)}function ul(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,HI(r)),Hr!==null)for(r=Hr.return;r!==null;){var n=r;switch(Yx(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&xh();break;case 3:$c(),cr(Ei),cr(Gn),i1();break;case 5:n1(n);break;case 4:$c();break;case 13:cr(wr);break;case 19:cr(wr);break;case 10:Zx(n.type._context);break;case 22:case 23:g1()}r=r.return}if(dn=t,Hr=t=Ao(t.current,null),Fn=Di=e,Zr=0,Bf=null,d1=vp=El=0,yi=of=null,al!==null){for(e=0;e<al.length;e++)if(r=al[e],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,s=r.pending;if(s!==null){var a=s.next;s.next=i,n.next=a}r.pending=n}al=null}return t}function ZT(t,e){do{var r=Hr;try{if(Jx(),Kd.current=kh,Ah){for(var n=Ar.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}Ah=!1}if(_l=0,cn=qr=Ar=null,sf=!1,Of=0,f1.current=null,r===null||r.return===null){Zr=1,Bf=e,Hr=null;break}e:{var s=t,a=r.return,o=r,l=e;if(e=Fn,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,d=o,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var m=n_(a);if(m!==null){m.flags&=-257,i_(m,a,o,s,e),m.mode&1&&r_(s,c,e),e=m,l=c;var y=e.updateQueue;if(y===null){var x=new Set;x.add(l),e.updateQueue=x}else y.add(l);break e}else{if(!(e&1)){r_(s,c,e),m1();break e}l=Error(Pe(426))}}else if(xr&&o.mode&1){var E=n_(a);if(E!==null){!(E.flags&65536)&&(E.flags|=256),i_(E,a,o,s,e),qx(Gc(l,o));break e}}s=l=Gc(l,o),Zr!==4&&(Zr=2),of===null?of=[s]:of.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var T=MT(s,l,e);qy(s,T);break e;case 1:o=l;var A=s.type,_=s.stateNode;if(!(s.flags&128)&&(typeof A.getDerivedStateFromError=="function"||_!==null&&typeof _.componentDidCatch=="function"&&(To===null||!To.has(_)))){s.flags|=65536,e&=-e,s.lanes|=e;var P=LT(s,o,e);qy(s,P);break e}}s=s.return}while(s!==null)}rS(r)}catch(W){e=W,Hr===r&&r!==null&&(Hr=r=r.return);continue}break}while(!0)}function eS(){var t=Ch.current;return Ch.current=kh,t===null?kh:t}function m1(){(Zr===0||Zr===3||Zr===2)&&(Zr=4),dn===null||!(El&268435455)&&!(vp&268435455)||ao(dn,Fn)}function bh(t,e){var r=Nt;Nt|=2;var n=eS();(dn!==t||Fn!==e)&&(ma=null,ul(t,e));do try{gb();break}catch(i){ZT(t,i)}while(!0);if(Jx(),Nt=r,Ch.current=n,Hr!==null)throw Error(Pe(261));return dn=null,Fn=0,Zr}function gb(){for(;Hr!==null;)tS(Hr)}function mb(){for(;Hr!==null&&!UF();)tS(Hr)}function tS(t){var e=iS(t.alternate,t,Di);t.memoizedProps=t.pendingProps,e===null?rS(t):Hr=e,f1.current=null}function rS(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=cb(r,e),r!==null){r.flags&=32767,Hr=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Zr=6,Hr=null;return}}else if(r=lb(r,e,Di),r!==null){Hr=r;return}if(e=e.sibling,e!==null){Hr=e;return}Hr=e=t}while(e!==null);Zr===0&&(Zr=5)}function tl(t,e,r){var n=Kt,i=os.transition;try{os.transition=null,Kt=1,xb(t,e,r,n)}finally{os.transition=i,Kt=n}return null}function xb(t,e,r,n){do Nc();while(ho!==null);if(Nt&6)throw Error(Pe(327));r=t.finishedWork;var i=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(Pe(177));t.callbackNode=null,t.callbackPriority=0;var s=r.lanes|r.childLanes;if(QF(t,s),t===dn&&(Hr=dn=null,Fn=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||xd||(xd=!0,sS(fh,function(){return Nc(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=os.transition,os.transition=null;var a=Kt;Kt=1;var o=Nt;Nt|=4,f1.current=null,fb(t,r),qT(r,t),LI(Sm),hh=!!Tm,Sm=Tm=null,t.current=r,db(r),zF(),Nt=o,Kt=a,os.transition=s}else t.current=r;if(xd&&(xd=!1,ho=t,Ih=i),s=t.pendingLanes,s===0&&(To=null),$F(r.stateNode),Ti(t,Mr()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)i=e[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(Fh)throw Fh=!1,t=Hm,Hm=null,t;return Ih&1&&t.tag!==0&&Nc(),s=t.pendingLanes,s&1?t===$m?lf++:(lf=0,$m=t):lf=0,zo(),null}function Nc(){if(ho!==null){var t=Mw(Ih),e=os.transition,r=Kt;try{if(os.transition=null,Kt=16>t?16:t,ho===null)var n=!1;else{if(t=ho,ho=null,Ih=0,Nt&6)throw Error(Pe(331));var i=Nt;for(Nt|=4,qe=t.current;qe!==null;){var s=qe,a=s.child;if(qe.flags&16){var o=s.deletions;if(o!==null){for(var l=0;l<o.length;l++){var c=o[l];for(qe=c;qe!==null;){var d=qe;switch(d.tag){case 0:case 11:case 15:af(8,d,s)}var h=d.child;if(h!==null)h.return=d,qe=h;else for(;qe!==null;){d=qe;var p=d.sibling,m=d.return;if(KT(d),d===c){qe=null;break}if(p!==null){p.return=m,qe=p;break}qe=m}}}var y=s.alternate;if(y!==null){var x=y.child;if(x!==null){y.child=null;do{var E=x.sibling;x.sibling=null,x=E}while(x!==null)}}qe=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,qe=a;else e:for(;qe!==null;){if(s=qe,s.flags&2048)switch(s.tag){case 0:case 11:case 15:af(9,s,s.return)}var T=s.sibling;if(T!==null){T.return=s.return,qe=T;break e}qe=s.return}}var A=t.current;for(qe=A;qe!==null;){a=qe;var _=a.child;if(a.subtreeFlags&2064&&_!==null)_.return=a,qe=_;else e:for(a=A;qe!==null;){if(o=qe,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:xp(9,o)}}catch(W){Ir(o,o.return,W)}if(o===a){qe=null;break e}var P=o.sibling;if(P!==null){P.return=o.return,qe=P;break e}qe=o.return}}if(Nt=i,zo(),qs&&typeof qs.onPostCommitFiberRoot=="function")try{qs.onPostCommitFiberRoot(cp,t)}catch{}n=!0}return n}finally{Kt=r,os.transition=e}}return!1}function x_(t,e,r){e=Gc(r,e),e=MT(t,e,1),t=wo(t,e,1),e=si(),t!==null&&(u0(t,1,e),Ti(t,e))}function Ir(t,e,r){if(t.tag===3)x_(t,t,r);else for(;e!==null;){if(e.tag===3){x_(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(To===null||!To.has(n))){t=Gc(r,t),t=LT(e,t,1),e=wo(e,t,1),t=si(),e!==null&&(u0(e,1,t),Ti(e,t));break}}e=e.return}}function vb(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=si(),t.pingedLanes|=t.suspendedLanes&r,dn===t&&(Fn&r)===r&&(Zr===4||Zr===3&&(Fn&130023424)===Fn&&500>Mr()-h1?ul(t,0):d1|=r),Ti(t,e)}function nS(t,e){e===0&&(t.mode&1?(e=od,od<<=1,!(od&130023424)&&(od=4194304)):e=1);var r=si();t=Ra(t,e),t!==null&&(u0(t,e,r),Ti(t,r))}function yb(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),nS(t,r)}function _b(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,i=t.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(Pe(314))}n!==null&&n.delete(e),nS(t,r)}var iS;iS=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||Ei.current)_i=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return _i=!1,ob(t,e,r);_i=!!(t.flags&131072)}else _i=!1,xr&&e.flags&1048576&&lT(e,_h,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;Yd(t,e),t=e.pendingProps;var i=zc(e,Gn.current);Rc(e,r),i=a1(null,e,n,t,i,r);var s=o1();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,wi(n)?(s=!0,vh(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,t1(e),i.updater=mp,e.stateNode=i,i._reactInternals=e,Dm(e,n,t,r),e=Mm(null,e,n,!0,s,r)):(e.tag=0,xr&&s&&Xx(e),ri(null,e,i,r),e=e.child),e;case 16:n=e.elementType;e:{switch(Yd(t,e),t=e.pendingProps,i=n._init,n=i(n._payload),e.type=n,i=e.tag=wb(n),t=ws(n,t),i){case 0:e=Om(null,e,n,t,r);break e;case 1:e=o_(null,e,n,t,r);break e;case 11:e=s_(null,e,n,t,r);break e;case 14:e=a_(null,e,n,ws(n.type,t),r);break e}throw Error(Pe(306,n,""))}return e;case 0:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:ws(n,i),Om(t,e,n,i,r);case 1:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:ws(n,i),o_(t,e,n,i,r);case 3:e:{if(UT(e),t===null)throw Error(Pe(387));n=e.pendingProps,s=e.memoizedState,i=s.element,pT(t,e),Th(e,n,null,r);var a=e.memoizedState;if(n=a.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=Gc(Error(Pe(423)),e),e=l_(t,e,n,r,i);break e}else if(n!==i){i=Gc(Error(Pe(424)),e),e=l_(t,e,n,r,i);break e}else for(Bi=Eo(e.stateNode.containerInfo.firstChild),ji=e,xr=!0,Ss=null,r=dT(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Wc(),n===i){e=Na(t,e,r);break e}ri(t,e,n,r)}e=e.child}return e;case 5:return gT(e),t===null&&bm(e),n=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,a=i.children,Am(n,i)?a=null:s!==null&&Am(n,s)&&(e.flags|=32),VT(t,e),ri(t,e,a,r),e.child;case 6:return t===null&&bm(e),null;case 13:return zT(t,e,r);case 4:return r1(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=Hc(e,null,n,r):ri(t,e,n,r),e.child;case 11:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:ws(n,i),s_(t,e,n,i,r);case 7:return ri(t,e,e.pendingProps,r),e.child;case 8:return ri(t,e,e.pendingProps.children,r),e.child;case 12:return ri(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,i=e.pendingProps,s=e.memoizedProps,a=i.value,tr(Eh,n._currentValue),n._currentValue=a,s!==null)if(Ns(s.value,a)){if(s.children===i.children&&!Ei.current){e=Na(t,e,r);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var o=s.dependencies;if(o!==null){a=s.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(s.tag===1){l=Sa(-1,r&-r),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var d=c.pending;d===null?l.next=l:(l.next=d.next,d.next=l),c.pending=l}}s.lanes|=r,l=s.alternate,l!==null&&(l.lanes|=r),Rm(s.return,r,e),o.lanes|=r;break}l=l.next}}else if(s.tag===10)a=s.type===e.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(Pe(341));a.lanes|=r,o=a.alternate,o!==null&&(o.lanes|=r),Rm(a,r,e),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===e){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}ri(t,e,i.children,r),e=e.child}return e;case 9:return i=e.type,n=e.pendingProps.children,Rc(e,r),i=cs(i),n=n(i),e.flags|=1,ri(t,e,n,r),e.child;case 14:return n=e.type,i=ws(n,e.pendingProps),i=ws(n.type,i),a_(t,e,n,i,r);case 15:return BT(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:ws(n,i),Yd(t,e),e.tag=1,wi(n)?(t=!0,vh(e)):t=!1,Rc(e,r),OT(e,n,i),Dm(e,n,i,r),Mm(null,e,n,!0,t,r);case 19:return WT(t,e,r);case 22:return jT(t,e,r)}throw Error(Pe(156,e.tag))};function sS(t,e){return Nw(t,e)}function Eb(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function as(t,e,r,n){return new Eb(t,e,r,n)}function x1(t){return t=t.prototype,!(!t||!t.isReactComponent)}function wb(t){if(typeof t=="function")return x1(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Mx)return 11;if(t===Lx)return 14}return 2}function Ao(t,e){var r=t.alternate;return r===null?(r=as(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function Jd(t,e,r,n,i,s){var a=2;if(n=t,typeof t=="function")x1(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case hc:return fl(r.children,i,s,e);case Ox:a=8,i|=8;break;case nm:return t=as(12,r,e,i|2),t.elementType=nm,t.lanes=s,t;case im:return t=as(13,r,e,i),t.elementType=im,t.lanes=s,t;case sm:return t=as(19,r,e,i),t.elementType=sm,t.lanes=s,t;case gw:return yp(r,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case hw:a=10;break e;case pw:a=9;break e;case Mx:a=11;break e;case Lx:a=14;break e;case no:a=16,n=null;break e}throw Error(Pe(130,t==null?t:typeof t,""))}return e=as(a,r,e,i),e.elementType=t,e.type=n,e.lanes=s,e}function fl(t,e,r,n){return t=as(7,t,n,e),t.lanes=r,t}function yp(t,e,r,n){return t=as(22,t,n,e),t.elementType=gw,t.lanes=r,t.stateNode={isHidden:!1},t}function _g(t,e,r){return t=as(6,t,null,e),t.lanes=r,t}function Eg(t,e,r){return e=as(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Tb(t,e,r,n,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=tg(0),this.expirationTimes=tg(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=tg(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function v1(t,e,r,n,i,s,a,o,l){return t=new Tb(t,e,r,o,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=as(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},t1(s),t}function Sb(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:dc,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function aS(t){if(!t)return No;t=t._reactInternals;e:{if(Ol(t)!==t||t.tag!==1)throw Error(Pe(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(wi(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Pe(171))}if(t.tag===1){var r=t.type;if(wi(r))return aT(t,r,e)}return e}function oS(t,e,r,n,i,s,a,o,l){return t=v1(r,n,!0,t,i,s,a,o,l),t.context=aS(null),r=t.current,n=si(),i=So(r),s=Sa(n,i),s.callback=e??null,wo(r,s,i),t.current.lanes=i,u0(t,i,n),Ti(t,n),t}function _p(t,e,r,n){var i=e.current,s=si(),a=So(i);return r=aS(r),e.context===null?e.context=r:e.pendingContext=r,e=Sa(s,a),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=wo(i,e,a),t!==null&&(Is(t,i,a,s),Gd(t,i,a)),a}function Rh(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function v_(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function y1(t,e){v_(t,e),(t=t.alternate)&&v_(t,e)}function Ab(){return null}var lS=typeof reportError=="function"?reportError:function(t){console.error(t)};function _1(t){this._internalRoot=t}Ep.prototype.render=_1.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Pe(409));_p(t,e,null,null)};Ep.prototype.unmount=_1.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;wl(function(){_p(null,t,null,null)}),e[ba]=null}};function Ep(t){this._internalRoot=t}Ep.prototype.unstable_scheduleHydration=function(t){if(t){var e=jw();t={blockedOn:null,target:t,priority:e};for(var r=0;r<so.length&&e!==0&&e<so[r].priority;r++);so.splice(r,0,t),r===0&&Uw(t)}};function E1(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function wp(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function y_(){}function kb(t,e,r,n,i){if(i){if(typeof n=="function"){var s=n;n=function(){var c=Rh(a);s.call(c)}}var a=oS(e,n,t,0,null,!1,!1,"",y_);return t._reactRootContainer=a,t[ba]=a.current,bf(t.nodeType===8?t.parentNode:t),wl(),a}for(;i=t.lastChild;)t.removeChild(i);if(typeof n=="function"){var o=n;n=function(){var c=Rh(l);o.call(c)}}var l=v1(t,0,!1,null,null,!1,!1,"",y_);return t._reactRootContainer=l,t[ba]=l.current,bf(t.nodeType===8?t.parentNode:t),wl(function(){_p(e,l,r,n)}),l}function Tp(t,e,r,n,i){var s=r._reactRootContainer;if(s){var a=s;if(typeof i=="function"){var o=i;i=function(){var l=Rh(a);o.call(l)}}_p(e,a,t,i)}else a=kb(r,e,t,i,n);return Rh(a)}Lw=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=Hu(e.pendingLanes);r!==0&&(Vx(e,r|1),Ti(e,Mr()),!(Nt&6)&&(Kc=Mr()+500,zo()))}break;case 13:wl(function(){var n=Ra(t,1);if(n!==null){var i=si();Is(n,t,1,i)}}),y1(t,1)}};Ux=function(t){if(t.tag===13){var e=Ra(t,134217728);if(e!==null){var r=si();Is(e,t,134217728,r)}y1(t,134217728)}};Bw=function(t){if(t.tag===13){var e=So(t),r=Ra(t,e);if(r!==null){var n=si();Is(r,t,e,n)}y1(t,e)}};jw=function(){return Kt};Vw=function(t,e){var r=Kt;try{return Kt=t,e()}finally{Kt=r}};gm=function(t,e,r){switch(e){case"input":if(lm(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var i=hp(n);if(!i)throw Error(Pe(90));xw(n),lm(n,i)}}}break;case"textarea":yw(t,r);break;case"select":e=r.value,e!=null&&Cc(t,!!r.multiple,e,!1)}};kw=p1;Cw=wl;var Cb={usingClientEntryPoint:!1,Events:[d0,xc,hp,Sw,Aw,p1]},Mu={findFiberByHostInstance:sl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Fb={bundleType:Mu.bundleType,version:Mu.version,rendererPackageName:Mu.rendererPackageName,rendererConfig:Mu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ja.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=bw(t),t===null?null:t.stateNode},findFiberByHostInstance:Mu.findFiberByHostInstance||Ab,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var vd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!vd.isDisabled&&vd.supportsFiber)try{cp=vd.inject(Fb),qs=vd}catch{}}Wi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Cb;Wi.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!E1(e))throw Error(Pe(200));return Sb(t,e,null,r)};Wi.createRoot=function(t,e){if(!E1(t))throw Error(Pe(299));var r=!1,n="",i=lS;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=v1(t,1,!1,null,null,r,!1,n,i),t[ba]=e.current,bf(t.nodeType===8?t.parentNode:t),new _1(e)};Wi.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Pe(188)):(t=Object.keys(t).join(","),Error(Pe(268,t)));return t=bw(e),t=t===null?null:t.stateNode,t};Wi.flushSync=function(t){return wl(t)};Wi.hydrate=function(t,e,r){if(!wp(e))throw Error(Pe(200));return Tp(null,t,e,!0,r)};Wi.hydrateRoot=function(t,e,r){if(!E1(t))throw Error(Pe(405));var n=r!=null&&r.hydratedSources||null,i=!1,s="",a=lS;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(a=r.onRecoverableError)),e=oS(e,null,t,1,r??null,i,!1,s,a),t[ba]=e.current,bf(t),n)for(t=0;t<n.length;t++)r=n[t],i=r._getVersion,i=i(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,i]:e.mutableSourceEagerHydrationData.push(r,i);return new Ep(e)};Wi.render=function(t,e,r){if(!wp(e))throw Error(Pe(200));return Tp(null,t,e,!1,r)};Wi.unmountComponentAtNode=function(t){if(!wp(t))throw Error(Pe(40));return t._reactRootContainer?(wl(function(){Tp(null,null,t,!1,function(){t._reactRootContainer=null,t[ba]=null})}),!0):!1};Wi.unstable_batchedUpdates=p1;Wi.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!wp(r))throw Error(Pe(200));if(t==null||t._reactInternals===void 0)throw Error(Pe(38));return Tp(t,e,r,!1,n)};Wi.version="18.3.1-next-f1338f8080-20240426";function cS(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(cS)}catch(t){console.error(t)}}cS(),cw.exports=Wi;var Ib=cw.exports,__=Ib;tm.createRoot=__.createRoot,tm.hydrateRoot=__.hydrateRoot;/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Nh={};Nh.version="0.18.5";var uS=1252,bb=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],w1={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},T1=function(t){bb.indexOf(t)!=-1&&(uS=w1[0]=t)};function Rb(){T1(1252)}var As=function(t){T1(t)};function S1(){As(1200),Rb()}function E_(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function Nb(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function fS(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var Gu=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?Nb(t.slice(2)):e==254&&r==255?fS(t.slice(2)):e==65279?t.slice(1):t},yd=function(e){return String.fromCharCode(e)},w_=function(e){return String.fromCharCode(e)},jf,po="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Vf(t){for(var e="",r=0,n=0,i=0,s=0,a=0,o=0,l=0,c=0;c<t.length;)r=t.charCodeAt(c++),s=r>>2,n=t.charCodeAt(c++),a=(r&3)<<4|n>>4,i=t.charCodeAt(c++),o=(n&15)<<2|i>>6,l=i&63,isNaN(n)?o=l=64:isNaN(i)&&(l=64),e+=po.charAt(s)+po.charAt(a)+po.charAt(o)+po.charAt(l);return e}function zi(t){var e="",r=0,n=0,i=0,s=0,a=0,o=0,l=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<t.length;)s=po.indexOf(t.charAt(c++)),a=po.indexOf(t.charAt(c++)),r=s<<2|a>>4,e+=String.fromCharCode(r),o=po.indexOf(t.charAt(c++)),n=(a&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(n)),l=po.indexOf(t.charAt(c++)),i=(o&3)<<6|l,l!==64&&(e+=String.fromCharCode(i));return e}var yt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Va=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function Do(t){return yt?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function T_(t){return yt?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var Mi=function(e){return yt?Va(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function Sp(t){if(typeof ArrayBuffer>"u")return Mi(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n!=t.length;++n)r[n]=t.charCodeAt(n)&255;return e}function Wo(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function Db(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}function A1(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return A1(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var un=yt?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:Va(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),i=0;for(e=0,r=0;e<t.length;r+=i,++e)if(i=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function Pb(t){for(var e=[],r=0,n=t.length+250,i=Do(t.length+255),s=0;s<t.length;++s){var a=t.charCodeAt(s);if(a<128)i[r++]=a;else if(a<2048)i[r++]=192|a>>6&31,i[r++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=t.charCodeAt(++s)&1023;i[r++]=240|a>>8&7,i[r++]=128|a>>2&63,i[r++]=128|o>>6&15|(a&3)<<4,i[r++]=128|o&63}else i[r++]=224|a>>12&15,i[r++]=128|a>>6&63,i[r++]=128|a&63;r>n&&(e.push(i.slice(0,r)),r=0,i=Do(65535),n=65530)}return e.push(i.slice(0,r)),un(e)}var ai=/\u0000/g,Ku=/[\u0001-\u0006]/g;function Dc(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function ks(t,e){var r=""+t;return r.length>=e?r:br("0",e-r.length)+r}function k1(t,e){var r=""+t;return r.length>=e?r:br(" ",e-r.length)+r}function Dh(t,e){var r=""+t;return r.length>=e?r:r+br(" ",e-r.length)}function Ob(t,e){var r=""+Math.round(t);return r.length>=e?r:br("0",e-r.length)+r}function Mb(t,e){var r=""+t;return r.length>=e?r:br("0",e-r.length)+r}var S_=Math.pow(2,32);function sc(t,e){if(t>S_||t<-S_)return Ob(t,e);var r=Math.round(t);return Mb(r,e)}function Ph(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var A_=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],wg=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Lb(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var at={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},k_={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Bb={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Oh(t,e,r){for(var n=t<0?-1:1,i=t*n,s=0,a=1,o=0,l=1,c=0,d=0,h=Math.floor(i);c<e&&(h=Math.floor(i),o=h*a+s,d=h*c+l,!(i-h<5e-8));)i=1/(i-h),s=a,a=o,l=c,c=d;if(d>e&&(c>e?(d=l,o=s):(d=c,o=a)),!r)return[0,n*o,d];var p=Math.floor(n*o/d);return[p,n*o-p*d,d]}function ll(t,e,r){if(t>2958465||t<0)return null;var n=t|0,i=Math.floor(86400*(t-n)),s=0,a=[],o={D:n,T:i,u:86400*(t-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++n,++o.D)),n===60)a=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)a=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),a=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),n<60&&(s=(s+6)%7),r&&(s=Hb(l,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=s,o}var dS=new Date(1899,11,31,0,0,0),jb=dS.getTime(),Vb=new Date(1900,2,1,0,0,0);function hS(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=Vb&&(r+=24*60*60*1e3),(r-(jb+(t.getTimezoneOffset()-dS.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function C1(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Ub(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function zb(t){var e=t<0?12:11,r=C1(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function Wb(t){var e=C1(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function Uf(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=zb(t):e===10?r=t.toFixed(10).substr(0,12):r=Wb(t),C1(Ub(r.toUpperCase()))}function Tl(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):Uf(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return fs(14,hS(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function Hb(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function $b(t,e,r,n){var i="",s=0,a=0,o=r.y,l,c=0;switch(t){case 98:o=r.y+543;case 121:switch(e.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(e.length){case 1:case 2:l=r.m,c=e.length;break;case 3:return wg[r.m-1][1];case 5:return wg[r.m-1][0];default:return wg[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:l=r.d,c=e.length;break;case 3:return A_[r.q][0];default:return A_[r.q][1]}break;case 104:switch(e.length){case 1:case 2:l=1+(r.H+11)%12,c=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:l=r.H,c=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:l=r.M,c=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?ks(r.S,e.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,s=Math.round(a*(r.S+r.u)),s>=60*a&&(s=0),e==="s"?s===0?"0":""+s/a:(i=ks(s,2+n),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}c=e.length===3?1:2;break;case 101:l=o,c=1;break}var d=c>0?ks(l,c):"";return d}function go(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var pS=/%/g;function Gb(t,e,r){var n=e.replace(pS,""),i=e.length-n.length;return Aa(t,n,r*Math.pow(10,2*i))+br("%",i)}function Kb(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Aa(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function gS(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+gS(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),r.indexOf("e")===-1){var a=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,d){return l+c+d.substr(0,(i+s)%i)+"."+d.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var mS=/# (\?+)( ?)\/( ?)(\d+)/;function Xb(t,e,r){var n=parseInt(t[4],10),i=Math.round(e*n),s=Math.floor(i/n),a=i-s*n,o=n;return r+(s===0?"":""+s)+" "+(a===0?br(" ",t[1].length+1+t[4].length):k1(a,t[1].length)+t[2]+"/"+t[3]+ks(o,t[4].length))}function Yb(t,e,r){return r+(e===0?"":""+e)+br(" ",t[1].length+2+t[4].length)}var xS=/^#*0*\.([0#]+)/,vS=/\).*[0#]/,yS=/\(###\) ###\\?-####/;function ni(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function C_(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function F_(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function qb(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function Qb(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Ji(t,e,r){if(t.charCodeAt(0)===40&&!e.match(vS)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ji("n",n,r):"("+Ji("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return Kb(t,e,r);if(e.indexOf("%")!==-1)return Gb(t,e,r);if(e.indexOf("E")!==-1)return gS(e,r);if(e.charCodeAt(0)===36)return"$"+Ji(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),c=r<0?"-":"";if(e.match(/^00+$/))return c+sc(l,e.length);if(e.match(/^[#?]+$/))return i=sc(r,0),i==="0"&&(i=""),i.length>e.length?i:ni(e.substr(0,e.length-i.length))+i;if(s=e.match(mS))return Xb(s,l,c);if(e.match(/^#+0+$/))return c+sc(l,e.length-e.indexOf("0"));if(s=e.match(xS))return i=C_(r,s[1].length).replace(/^([^\.]+)$/,"$1."+ni(s[1])).replace(/\.$/,"."+ni(s[1])).replace(/\.(\d*)$/,function(y,x){return"."+x+br("0",ni(s[1]).length-x.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return c+C_(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return c+go(sc(l,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ji(t,e,-r):go(""+(Math.floor(r)+qb(r,s[1].length)))+"."+ks(F_(r,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return Ji(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Dc(Ji(t,e.replace(/[\\-]/g,""),r)),a=0,Dc(Dc(e.replace(/\\/g,"")).replace(/[0#]/g,function(y){return a<i.length?i.charAt(a++):y==="0"?"0":""}));if(e.match(yS))return i=Ji(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=Oh(l,Math.pow(10,a)-1,!1),i=""+c,d=Aa("n",s[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),i+=d+s[2]+"/"+s[3],d=Dh(o[2],a),d.length<s[4].length&&(d=ni(s[4].substr(s[4].length-d.length))+d),i+=d,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=Oh(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?k1(o[1],a)+s[2]+"/"+s[3]+Dh(o[2],a):br(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=sc(r,0),e.length<=i.length?i:ni(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var h=e.indexOf(".")-a,p=e.length-i.length-h;return ni(e.substr(0,h)+i+e.substr(e.length-p))}if(s=e.match(/^00,000\.([#0]*0)$/))return a=F_(r,s[1].length),r<0?"-"+Ji(t,e,-r):go(Qb(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?ks(0,3-y.length):"")+y})+"."+ks(a,s[1].length);switch(e){case"###,##0.00":return Ji(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var m=go(sc(l,0));return m!=="0"?c+m:"";case"###,###.00":return Ji(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Ji(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function Jb(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Aa(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function Zb(t,e,r){var n=e.replace(pS,""),i=e.length-n.length;return Aa(t,n,r*Math.pow(10,2*i))+br("%",i)}function _S(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+_S(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!r.match(/[Ee]/)){var a=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,d){return l+c+d.substr(0,(i+s)%i)+"."+d.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function $s(t,e,r){if(t.charCodeAt(0)===40&&!e.match(vS)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?$s("n",n,r):"("+$s("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return Jb(t,e,r);if(e.indexOf("%")!==-1)return Zb(t,e,r);if(e.indexOf("E")!==-1)return _S(e,r);if(e.charCodeAt(0)===36)return"$"+$s(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),c=r<0?"-":"";if(e.match(/^00+$/))return c+ks(l,e.length);if(e.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>e.length?i:ni(e.substr(0,e.length-i.length))+i;if(s=e.match(mS))return Yb(s,l,c);if(e.match(/^#+0+$/))return c+ks(l,e.length-e.indexOf("0"));if(s=e.match(xS))return i=(""+r).replace(/^([^\.]+)$/,"$1."+ni(s[1])).replace(/\.$/,"."+ni(s[1])),i=i.replace(/\.(\d*)$/,function(y,x){return"."+x+br("0",ni(s[1]).length-x.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return c+go(""+l);if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+$s(t,e,-r):go(""+r)+"."+br("0",s[1].length);if(s=e.match(/^#,#*,#0/))return $s(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Dc($s(t,e.replace(/[\\-]/g,""),r)),a=0,Dc(Dc(e.replace(/\\/g,"")).replace(/[0#]/g,function(y){return a<i.length?i.charAt(a++):y==="0"?"0":""}));if(e.match(yS))return i=$s(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=Oh(l,Math.pow(10,a)-1,!1),i=""+c,d=Aa("n",s[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),i+=d+s[2]+"/"+s[3],d=Dh(o[2],a),d.length<s[4].length&&(d=ni(s[4].substr(s[4].length-d.length))+d),i+=d,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=Oh(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?k1(o[1],a)+s[2]+"/"+s[3]+Dh(o[2],a):br(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=""+r,e.length<=i.length?i:ni(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var h=e.indexOf(".")-a,p=e.length-i.length-h;return ni(e.substr(0,h)+i+e.substr(e.length-p))}if(s=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+$s(t,e,-r):go(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?ks(0,3-y.length):"")+y})+"."+ks(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var m=go(""+l);return m!=="0"?c+m:"";default:if(e.match(/\.[0#?]*$/))return $s(t,e.slice(0,e.lastIndexOf(".")),r)+ni(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Aa(t,e,r){return(r|0)===r?$s(t,e,r):Ji(t,e,r)}function eR(t){for(var e=[],r=!1,n=0,i=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(i,n-i),i=n+1}if(e[e.length]=t.substr(i),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var ES=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function cu(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":Ph(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(ES))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function tR(t,e,r,n){for(var i=[],s="",a=0,o="",l="t",c,d,h,p="H";a<t.length;)switch(o=t.charAt(a)){case"G":if(!Ph(t,a))throw new Error("unrecognized character "+o+" in "+t);i[i.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(h=t.charCodeAt(++a))!==34&&a<t.length;)s+=String.fromCharCode(h);i[i.length]={t:"t",v:s},++a;break;case"\\":var m=t.charAt(++a),y=m==="("||m===")"?m:"t";i[i.length]={t:y,v:m},++a;break;case"_":i[i.length]={t:"t",v:" "},a+=2;break;case"@":i[i.length]={t:"T",v:e},++a;break;case"B":case"b":if(t.charAt(a+1)==="1"||t.charAt(a+1)==="2"){if(c==null&&(c=ll(e,r,t.charAt(a+1)==="2"),c==null))return"";i[i.length]={t:"X",v:t.substr(a,2)},l=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||c==null&&(c=ll(e,r),c==null))return"";for(s=o;++a<t.length&&t.charAt(a).toLowerCase()===o;)s+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=p),i[i.length]={t:o,v:s},l=o;break;case"A":case"a":case"":var x={t:o,v:o};if(c==null&&(c=ll(e,r)),t.substr(a,3).toUpperCase()==="A/P"?(c!=null&&(x.v=c.H>=12?"P":"A"),x.t="T",p="h",a+=3):t.substr(a,5).toUpperCase()==="AM/PM"?(c!=null&&(x.v=c.H>=12?"PM":"AM"),x.t="T",a+=5,p="h"):t.substr(a,5).toUpperCase()==="/"?(c!=null&&(x.v=c.H>=12?"":""),x.t="T",a+=5,p="h"):(x.t="t",++a),c==null&&x.t==="T")return"";i[i.length]=x,l=o;break;case"[":for(s=o;t.charAt(a++)!=="]"&&a<t.length;)s+=t.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(ES)){if(c==null&&(c=ll(e,r),c==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",cu(t)||(i[i.length]={t:"t",v:s}));break;case".":if(c!=null){for(s=o;++a<t.length&&(o=t.charAt(a))==="0";)s+=o;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++a<t.length&&"0#?.,E+-%".indexOf(o=t.charAt(a))>-1;)s+=o;i[i.length]={t:"n",v:s};break;case"?":for(s=o;t.charAt(++a)===o;)s+=o;i[i.length]={t:o,v:s},l=o;break;case"*":++a,(t.charAt(a)==" "||t.charAt(a)=="*")&&++a;break;case"(":case")":i[i.length]={t:n===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;a<t.length&&"0123456789".indexOf(t.charAt(++a))>-1;)s+=t.charAt(a);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:o,v:o},++a;break;case"$":i[i.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+t);i[i.length]={t:"t",v:o},++a;break}var E=0,T=0,A;for(a=i.length-1,l="t";a>=0;--a)switch(i[a].t){case"h":case"H":i[a].t=p,l="h",E<1&&(E=1);break;case"s":(A=i[a].v.match(/\.0+$/))&&(T=Math.max(T,A[0].length-1)),E<3&&(E=3);case"d":case"y":case"M":case"e":l=i[a].t;break;case"m":l==="s"&&(i[a].t="M",E<2&&(E=2));break;case"X":break;case"Z":E<1&&i[a].v.match(/[Hh]/)&&(E=1),E<2&&i[a].v.match(/[Mm]/)&&(E=2),E<3&&i[a].v.match(/[Ss]/)&&(E=3)}switch(E){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var _="",P;for(a=0;a<i.length;++a)switch(i[a].t){case"t":case"T":case" ":case"D":break;case"X":i[a].v="",i[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[a].v=$b(i[a].t.charCodeAt(0),i[a].v,c,T),i[a].t="t";break;case"n":case"?":for(P=a+1;i[P]!=null&&((o=i[P].t)==="?"||o==="D"||(o===" "||o==="t")&&i[P+1]!=null&&(i[P+1].t==="?"||i[P+1].t==="t"&&i[P+1].v==="/")||i[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[P].v==="/"||i[P].v===" "&&i[P+1]!=null&&i[P+1].t=="?"));)i[a].v+=i[P].v,i[P]={v:"",t:";"},++P;_+=i[a].v,a=P-1;break;case"G":i[a].t="t",i[a].v=Tl(e,r);break}var W="",B,w;if(_.length>0){_.charCodeAt(0)==40?(B=e<0&&_.charCodeAt(0)===45?-e:e,w=Aa("n",_,B)):(B=e<0&&n>1?-e:e,w=Aa("n",_,B),B<0&&i[0]&&i[0].t=="t"&&(w=w.substr(1),i[0].v="-"+i[0].v)),P=w.length-1;var F=i.length;for(a=0;a<i.length;++a)if(i[a]!=null&&i[a].t!="t"&&i[a].v.indexOf(".")>-1){F=a;break}var S=i.length;if(F===i.length&&w.indexOf("E")===-1){for(a=i.length-1;a>=0;--a)i[a]==null||"n?".indexOf(i[a].t)===-1||(P>=i[a].v.length-1?(P-=i[a].v.length,i[a].v=w.substr(P+1,i[a].v.length)):P<0?i[a].v="":(i[a].v=w.substr(0,P+1),P=-1),i[a].t="t",S=a);P>=0&&S<i.length&&(i[S].v=w.substr(0,P+1)+i[S].v)}else if(F!==i.length&&w.indexOf("E")===-1){for(P=w.indexOf(".")-1,a=F;a>=0;--a)if(!(i[a]==null||"n?".indexOf(i[a].t)===-1)){for(d=i[a].v.indexOf(".")>-1&&a===F?i[a].v.indexOf(".")-1:i[a].v.length-1,W=i[a].v.substr(d+1);d>=0;--d)P>=0&&(i[a].v.charAt(d)==="0"||i[a].v.charAt(d)==="#")&&(W=w.charAt(P--)+W);i[a].v=W,i[a].t="t",S=a}for(P>=0&&S<i.length&&(i[S].v=w.substr(0,P+1)+i[S].v),P=w.indexOf(".")+1,a=F;a<i.length;++a)if(!(i[a]==null||"n?(".indexOf(i[a].t)===-1&&a!==F)){for(d=i[a].v.indexOf(".")>-1&&a===F?i[a].v.indexOf(".")+1:0,W=i[a].v.substr(0,d);d<i[a].v.length;++d)P<w.length&&(W+=w.charAt(P++));i[a].v=W,i[a].t="t",S=a}}}for(a=0;a<i.length;++a)i[a]!=null&&"n?".indexOf(i[a].t)>-1&&(B=n>1&&e<0&&a>0&&i[a-1].v==="-"?-e:e,i[a].v=Aa(i[a].t,i[a].v,B),i[a].t="t");var b="";for(a=0;a!==i.length;++a)i[a]!=null&&(b+=i[a].v);return b}var I_=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function b_(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function rR(t,e){var r=eR(t),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var a=r[0].match(I_),o=r[1].match(I_);return b_(e,a)?[n,r[0]]:b_(e,o)?[n,r[1]]:[n,r[a!=null&&o!=null?2:1]]}return[n,s]}function fs(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:at)[t],n==null&&(n=r.table&&r.table[k_[t]]||at[k_[t]]),n==null&&(n=Bb[t]||"General");break}if(Ph(n,0))return Tl(e,r);e instanceof Date&&(e=hS(e,r.date1904));var i=rR(n,e);if(Ph(i[1]))return Tl(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return tR(i[1],e,r,i[0])}function ka(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(at[r]==null){e<0&&(e=r);continue}if(at[r]==t){e=r;break}}e<0&&(e=391)}return at[e]=t,e}function Ap(t){for(var e=0;e!=392;++e)t[e]!==void 0&&ka(t[e],e)}function uu(){at=Lb()}var nR={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},wS=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function iR(t){var e=typeof t=="number"?at[t]:t;return e=e.replace(wS,"(\\d+)"),new RegExp("^"+e+"$")}function sR(t,e,r){var n=-1,i=-1,s=-1,a=-1,o=-1,l=-1;(e.match(wS)||[]).forEach(function(h,p){var m=parseInt(r[p+1],10);switch(h.toLowerCase().charAt(0)){case"y":n=m;break;case"d":s=m;break;case"h":a=m;break;case"s":l=m;break;case"m":a>=0?o=m:i=m;break}}),l>=0&&o==-1&&i>=0&&(o=i,i=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var d=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return a==-1&&o==-1&&l==-1?c:n==-1&&i==-1&&s==-1?d:c+"T"+d}var aR=function(){var t={};t.version="1.2.0";function e(){for(var w=0,F=new Array(256),S=0;S!=256;++S)w=S,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,F[S]=w;return typeof Int32Array<"u"?new Int32Array(F):F}var r=e();function n(w){var F=0,S=0,b=0,N=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(b=0;b!=256;++b)N[b]=w[b];for(b=0;b!=256;++b)for(S=w[b],F=256+b;F<4096;F+=256)S=N[F]=S>>>8^w[S&255];var D=[];for(b=1;b!=16;++b)D[b-1]=typeof Int32Array<"u"?N.subarray(b*256,b*256+256):N.slice(b*256,b*256+256);return D}var i=n(r),s=i[0],a=i[1],o=i[2],l=i[3],c=i[4],d=i[5],h=i[6],p=i[7],m=i[8],y=i[9],x=i[10],E=i[11],T=i[12],A=i[13],_=i[14];function P(w,F){for(var S=F^-1,b=0,N=w.length;b<N;)S=S>>>8^r[(S^w.charCodeAt(b++))&255];return~S}function W(w,F){for(var S=F^-1,b=w.length-15,N=0;N<b;)S=_[w[N++]^S&255]^A[w[N++]^S>>8&255]^T[w[N++]^S>>16&255]^E[w[N++]^S>>>24]^x[w[N++]]^y[w[N++]]^m[w[N++]]^p[w[N++]]^h[w[N++]]^d[w[N++]]^c[w[N++]]^l[w[N++]]^o[w[N++]]^a[w[N++]]^s[w[N++]]^r[w[N++]];for(b+=15;N<b;)S=S>>>8^r[(S^w[N++])&255];return~S}function B(w,F){for(var S=F^-1,b=0,N=w.length,D=0,R=0;b<N;)D=w.charCodeAt(b++),D<128?S=S>>>8^r[(S^D)&255]:D<2048?(S=S>>>8^r[(S^(192|D>>6&31))&255],S=S>>>8^r[(S^(128|D&63))&255]):D>=55296&&D<57344?(D=(D&1023)+64,R=w.charCodeAt(b++)&1023,S=S>>>8^r[(S^(240|D>>8&7))&255],S=S>>>8^r[(S^(128|D>>2&63))&255],S=S>>>8^r[(S^(128|R>>6&15|(D&3)<<4))&255],S=S>>>8^r[(S^(128|R&63))&255]):(S=S>>>8^r[(S^(224|D>>12&15))&255],S=S>>>8^r[(S^(128|D>>6&63))&255],S=S>>>8^r[(S^(128|D&63))&255]);return~S}return t.table=r,t.bstr=P,t.buf=W,t.str=B,t}(),tt=function(){var e={};e.version="1.2.1";function r(I,U){for(var L=I.split("/"),M=U.split("/"),z=0,V=0,ae=Math.min(L.length,M.length);z<ae;++z){if(V=L[z].length-M[z].length)return V;if(L[z]!=M[z])return L[z]<M[z]?-1:1}return L.length-M.length}function n(I){if(I.charAt(I.length-1)=="/")return I.slice(0,-1).indexOf("/")===-1?I:n(I.slice(0,-1));var U=I.lastIndexOf("/");return U===-1?I:I.slice(0,U+1)}function i(I){if(I.charAt(I.length-1)=="/")return i(I.slice(0,-1));var U=I.lastIndexOf("/");return U===-1?I:I.slice(U+1)}function s(I,U){typeof U=="string"&&(U=new Date(U));var L=U.getHours();L=L<<6|U.getMinutes(),L=L<<5|U.getSeconds()>>>1,I.write_shift(2,L);var M=U.getFullYear()-1980;M=M<<4|U.getMonth()+1,M=M<<5|U.getDate(),I.write_shift(2,M)}function a(I){var U=I.read_shift(2)&65535,L=I.read_shift(2)&65535,M=new Date,z=L&31;L>>>=5;var V=L&15;L>>>=4,M.setMilliseconds(0),M.setFullYear(L+1980),M.setMonth(V-1),M.setDate(z);var ae=U&31;U>>>=5;var re=U&63;return U>>>=6,M.setHours(U),M.setMinutes(re),M.setSeconds(ae<<1),M}function o(I){An(I,0);for(var U={},L=0;I.l<=I.length-4;){var M=I.read_shift(2),z=I.read_shift(2),V=I.l+z,ae={};switch(M){case 21589:L=I.read_shift(1),L&1&&(ae.mtime=I.read_shift(4)),z>5&&(L&2&&(ae.atime=I.read_shift(4)),L&4&&(ae.ctime=I.read_shift(4))),ae.mtime&&(ae.mt=new Date(ae.mtime*1e3));break}I.l=V,U[M]=ae}return U}var l;function c(){return l||(l={})}function d(I,U){if(I[0]==80&&I[1]==75)return la(I,U);if((I[0]|32)==109&&(I[1]|32)==105)return Zt(I,U);if(I.length<512)throw new Error("CFB file size "+I.length+" < 512");var L=3,M=512,z=0,V=0,ae=0,re=0,se=0,ee=[],oe=I.slice(0,512);An(oe,0);var ve=h(oe);switch(L=ve[0],L){case 3:M=512;break;case 4:M=4096;break;case 0:if(ve[1]==0)return la(I,U);default:throw new Error("Major Version: Expected 3 or 4 saw "+L)}M!==512&&(oe=I.slice(0,M),An(oe,28));var Oe=I.slice(0,M);p(oe,L);var He=oe.read_shift(4,"i");if(L===3&&He!==0)throw new Error("# Directory Sectors: Expected 0 saw "+He);oe.l+=4,ae=oe.read_shift(4,"i"),oe.l+=4,oe.chk("00100000","Mini Stream Cutoff Size: "),re=oe.read_shift(4,"i"),z=oe.read_shift(4,"i"),se=oe.read_shift(4,"i"),V=oe.read_shift(4,"i");for(var Fe=-1,ze=0;ze<109&&(Fe=oe.read_shift(4,"i"),!(Fe<0));++ze)ee[ze]=Fe;var st=m(I,M);E(se,V,st,M,ee);var Et=A(st,ae,ee,M);Et[ae].name="!Directory",z>0&&re!==R&&(Et[re].name="!MiniFAT"),Et[ee[0]].name="!FAT",Et.fat_addrs=ee,Et.ssz=M;var kt={},wt=[],Qn=[],gn=[];_(ae,Et,st,wt,z,kt,Qn,re),y(Qn,gn,wt),wt.shift();var Fi={FileIndex:Qn,FullPaths:gn};return U&&U.raw&&(Fi.raw={header:Oe,sectors:st}),Fi}function h(I){if(I[I.l]==80&&I[I.l+1]==75)return[0,0];I.chk(Ue,"Header Signature: "),I.l+=16;var U=I.read_shift(2,"u");return[I.read_shift(2,"u"),U]}function p(I,U){var L=9;switch(I.l+=2,L=I.read_shift(2)){case 9:if(U!=3)throw new Error("Sector Shift: Expected 9 saw "+L);break;case 12:if(U!=4)throw new Error("Sector Shift: Expected 12 saw "+L);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+L)}I.chk("0600","Mini Sector Shift: "),I.chk("000000000000","Reserved: ")}function m(I,U){for(var L=Math.ceil(I.length/U)-1,M=[],z=1;z<L;++z)M[z-1]=I.slice(z*U,(z+1)*U);return M[L-1]=I.slice(L*U),M}function y(I,U,L){for(var M=0,z=0,V=0,ae=0,re=0,se=L.length,ee=[],oe=[];M<se;++M)ee[M]=oe[M]=M,U[M]=L[M];for(;re<oe.length;++re)M=oe[re],z=I[M].L,V=I[M].R,ae=I[M].C,ee[M]===M&&(z!==-1&&ee[z]!==z&&(ee[M]=ee[z]),V!==-1&&ee[V]!==V&&(ee[M]=ee[V])),ae!==-1&&(ee[ae]=M),z!==-1&&M!=ee[M]&&(ee[z]=ee[M],oe.lastIndexOf(z)<re&&oe.push(z)),V!==-1&&M!=ee[M]&&(ee[V]=ee[M],oe.lastIndexOf(V)<re&&oe.push(V));for(M=1;M<se;++M)ee[M]===M&&(V!==-1&&ee[V]!==V?ee[M]=ee[V]:z!==-1&&ee[z]!==z&&(ee[M]=ee[z]));for(M=1;M<se;++M)if(I[M].type!==0){if(re=M,re!=ee[re])do re=ee[re],U[M]=U[re]+"/"+U[M];while(re!==0&&ee[re]!==-1&&re!=ee[re]);ee[M]=-1}for(U[0]+="/",M=1;M<se;++M)I[M].type!==2&&(U[M]+="/")}function x(I,U,L){for(var M=I.start,z=I.size,V=[],ae=M;L&&z>0&&ae>=0;)V.push(U.slice(ae*D,ae*D+D)),z-=D,ae=il(L,ae*4);return V.length===0?pe(0):un(V).slice(0,I.size)}function E(I,U,L,M,z){var V=R;if(I===R){if(U!==0)throw new Error("DIFAT chain shorter than expected")}else if(I!==-1){var ae=L[I],re=(M>>>2)-1;if(!ae)return;for(var se=0;se<re&&(V=il(ae,se*4))!==R;++se)z.push(V);E(il(ae,M-4),U-1,L,M,z)}}function T(I,U,L,M,z){var V=[],ae=[];z||(z=[]);var re=M-1,se=0,ee=0;for(se=U;se>=0;){z[se]=!0,V[V.length]=se,ae.push(I[se]);var oe=L[Math.floor(se*4/M)];if(ee=se*4&re,M<4+ee)throw new Error("FAT boundary crossed: "+se+" 4 "+M);if(!I[oe])break;se=il(I[oe],ee)}return{nodes:V,data:z_([ae])}}function A(I,U,L,M){var z=I.length,V=[],ae=[],re=[],se=[],ee=M-1,oe=0,ve=0,Oe=0,He=0;for(oe=0;oe<z;++oe)if(re=[],Oe=oe+U,Oe>=z&&(Oe-=z),!ae[Oe]){se=[];var Fe=[];for(ve=Oe;ve>=0;){Fe[ve]=!0,ae[ve]=!0,re[re.length]=ve,se.push(I[ve]);var ze=L[Math.floor(ve*4/M)];if(He=ve*4&ee,M<4+He)throw new Error("FAT boundary crossed: "+ve+" 4 "+M);if(!I[ze]||(ve=il(I[ze],He),Fe[ve]))break}V[Oe]={nodes:re,data:z_([se])}}return V}function _(I,U,L,M,z,V,ae,re){for(var se=0,ee=M.length?2:0,oe=U[I].data,ve=0,Oe=0,He;ve<oe.length;ve+=128){var Fe=oe.slice(ve,ve+128);An(Fe,64),Oe=Fe.read_shift(2),He=P1(Fe,0,Oe-ee),M.push(He);var ze={name:He,type:Fe.read_shift(1),color:Fe.read_shift(1),L:Fe.read_shift(4,"i"),R:Fe.read_shift(4,"i"),C:Fe.read_shift(4,"i"),clsid:Fe.read_shift(16),state:Fe.read_shift(4,"i"),start:0,size:0},st=Fe.read_shift(2)+Fe.read_shift(2)+Fe.read_shift(2)+Fe.read_shift(2);st!==0&&(ze.ct=P(Fe,Fe.l-8));var Et=Fe.read_shift(2)+Fe.read_shift(2)+Fe.read_shift(2)+Fe.read_shift(2);Et!==0&&(ze.mt=P(Fe,Fe.l-8)),ze.start=Fe.read_shift(4,"i"),ze.size=Fe.read_shift(4,"i"),ze.size<0&&ze.start<0&&(ze.size=ze.type=0,ze.start=R,ze.name=""),ze.type===5?(se=ze.start,z>0&&se!==R&&(U[se].name="!StreamData")):ze.size>=4096?(ze.storage="fat",U[ze.start]===void 0&&(U[ze.start]=T(L,ze.start,U.fat_addrs,U.ssz)),U[ze.start].name=ze.name,ze.content=U[ze.start].data.slice(0,ze.size)):(ze.storage="minifat",ze.size<0?ze.size=0:se!==R&&ze.start!==R&&U[se]&&(ze.content=x(ze,U[se].data,(U[re]||{}).data))),ze.content&&An(ze.content,0),V[He]=ze,ae.push(ze)}}function P(I,U){return new Date((Oi(I,U+4)/1e7*Math.pow(2,32)+Oi(I,U)/1e7-11644473600)*1e3)}function W(I,U){return c(),d(l.readFileSync(I),U)}function B(I,U){var L=U&&U.type;switch(L||yt&&Buffer.isBuffer(I)&&(L="buffer"),L||"base64"){case"file":return W(I,U);case"base64":return d(Mi(zi(I)),U);case"binary":return d(Mi(I),U)}return d(I,U)}function w(I,U){var L=U||{},M=L.root||"Root Entry";if(I.FullPaths||(I.FullPaths=[]),I.FileIndex||(I.FileIndex=[]),I.FullPaths.length!==I.FileIndex.length)throw new Error("inconsistent CFB structure");I.FullPaths.length===0&&(I.FullPaths[0]=M+"/",I.FileIndex[0]={name:M,type:5}),L.CLSID&&(I.FileIndex[0].clsid=L.CLSID),F(I)}function F(I){var U="Sh33tJ5";if(!tt.find(I,"/"+U)){var L=pe(4);L[0]=55,L[1]=L[3]=50,L[2]=54,I.FileIndex.push({name:U,type:2,content:L,size:4,L:69,R:69,C:69}),I.FullPaths.push(I.FullPaths[0]+U),S(I)}}function S(I,U){w(I);for(var L=!1,M=!1,z=I.FullPaths.length-1;z>=0;--z){var V=I.FileIndex[z];switch(V.type){case 0:M?L=!0:(I.FileIndex.pop(),I.FullPaths.pop());break;case 1:case 2:case 5:M=!0,isNaN(V.R*V.L*V.C)&&(L=!0),V.R>-1&&V.L>-1&&V.R==V.L&&(L=!0);break;default:L=!0;break}}if(!(!L&&!U)){var ae=new Date(1987,1,19),re=0,se=Object.create?Object.create(null):{},ee=[];for(z=0;z<I.FullPaths.length;++z)se[I.FullPaths[z]]=!0,I.FileIndex[z].type!==0&&ee.push([I.FullPaths[z],I.FileIndex[z]]);for(z=0;z<ee.length;++z){var oe=n(ee[z][0]);M=se[oe],M||(ee.push([oe,{name:i(oe).replace("/",""),type:1,clsid:Ie,ct:ae,mt:ae,content:null}]),se[oe]=!0)}for(ee.sort(function(He,Fe){return r(He[0],Fe[0])}),I.FullPaths=[],I.FileIndex=[],z=0;z<ee.length;++z)I.FullPaths[z]=ee[z][0],I.FileIndex[z]=ee[z][1];for(z=0;z<ee.length;++z){var ve=I.FileIndex[z],Oe=I.FullPaths[z];if(ve.name=i(Oe).replace("/",""),ve.L=ve.R=ve.C=-(ve.color=1),ve.size=ve.content?ve.content.length:0,ve.start=0,ve.clsid=ve.clsid||Ie,z===0)ve.C=ee.length>1?1:-1,ve.size=0,ve.type=5;else if(Oe.slice(-1)=="/"){for(re=z+1;re<ee.length&&n(I.FullPaths[re])!=Oe;++re);for(ve.C=re>=ee.length?-1:re,re=z+1;re<ee.length&&n(I.FullPaths[re])!=n(Oe);++re);ve.R=re>=ee.length?-1:re,ve.type=1}else n(I.FullPaths[z+1]||"")==n(Oe)&&(ve.R=z+1),ve.type=2}}}function b(I,U){var L=U||{};if(L.fileType=="mad")return hr(I,L);switch(S(I),L.fileType){case"zip":return Gi(I,L)}var M=function(He){for(var Fe=0,ze=0,st=0;st<He.FileIndex.length;++st){var Et=He.FileIndex[st];if(Et.content){var kt=Et.content.length;kt>0&&(kt<4096?Fe+=kt+63>>6:ze+=kt+511>>9)}}for(var wt=He.FullPaths.length+3>>2,Qn=Fe+7>>3,gn=Fe+127>>7,Fi=Qn+ze+wt+gn,mn=Fi+127>>7,Ii=mn<=109?0:Math.ceil((mn-109)/127);Fi+mn+Ii+127>>7>mn;)Ii=++mn<=109?0:Math.ceil((mn-109)/127);var xn=[1,Ii,mn,gn,wt,ze,Fe,0];return He.FileIndex[0].size=Fe<<6,xn[7]=(He.FileIndex[0].start=xn[0]+xn[1]+xn[2]+xn[3]+xn[4]+xn[5])+(xn[6]+7>>3),xn}(I),z=pe(M[7]<<9),V=0,ae=0;{for(V=0;V<8;++V)z.write_shift(1,me[V]);for(V=0;V<8;++V)z.write_shift(2,0);for(z.write_shift(2,62),z.write_shift(2,3),z.write_shift(2,65534),z.write_shift(2,9),z.write_shift(2,6),V=0;V<3;++V)z.write_shift(2,0);for(z.write_shift(4,0),z.write_shift(4,M[2]),z.write_shift(4,M[0]+M[1]+M[2]+M[3]-1),z.write_shift(4,0),z.write_shift(4,4096),z.write_shift(4,M[3]?M[0]+M[1]+M[2]-1:R),z.write_shift(4,M[3]),z.write_shift(-4,M[1]?M[0]-1:R),z.write_shift(4,M[1]),V=0;V<109;++V)z.write_shift(-4,V<M[2]?M[1]+V:-1)}if(M[1])for(ae=0;ae<M[1];++ae){for(;V<236+ae*127;++V)z.write_shift(-4,V<M[2]?M[1]+V:-1);z.write_shift(-4,ae===M[1]-1?R:ae+1)}var re=function(He){for(ae+=He;V<ae-1;++V)z.write_shift(-4,V+1);He&&(++V,z.write_shift(-4,R))};for(ae=V=0,ae+=M[1];V<ae;++V)z.write_shift(-4,Te.DIFSECT);for(ae+=M[2];V<ae;++V)z.write_shift(-4,Te.FATSECT);re(M[3]),re(M[4]);for(var se=0,ee=0,oe=I.FileIndex[0];se<I.FileIndex.length;++se)oe=I.FileIndex[se],oe.content&&(ee=oe.content.length,!(ee<4096)&&(oe.start=ae,re(ee+511>>9)));for(re(M[6]+7>>3);z.l&511;)z.write_shift(-4,Te.ENDOFCHAIN);for(ae=V=0,se=0;se<I.FileIndex.length;++se)oe=I.FileIndex[se],oe.content&&(ee=oe.content.length,!(!ee||ee>=4096)&&(oe.start=ae,re(ee+63>>6)));for(;z.l&511;)z.write_shift(-4,Te.ENDOFCHAIN);for(V=0;V<M[4]<<2;++V){var ve=I.FullPaths[V];if(!ve||ve.length===0){for(se=0;se<17;++se)z.write_shift(4,0);for(se=0;se<3;++se)z.write_shift(4,-1);for(se=0;se<12;++se)z.write_shift(4,0);continue}oe=I.FileIndex[V],V===0&&(oe.start=oe.size?oe.start-1:R);var Oe=V===0&&L.root||oe.name;if(ee=2*(Oe.length+1),z.write_shift(64,Oe,"utf16le"),z.write_shift(2,ee),z.write_shift(1,oe.type),z.write_shift(1,oe.color),z.write_shift(-4,oe.L),z.write_shift(-4,oe.R),z.write_shift(-4,oe.C),oe.clsid)z.write_shift(16,oe.clsid,"hex");else for(se=0;se<4;++se)z.write_shift(4,0);z.write_shift(4,oe.state||0),z.write_shift(4,0),z.write_shift(4,0),z.write_shift(4,0),z.write_shift(4,0),z.write_shift(4,oe.start),z.write_shift(4,oe.size),z.write_shift(4,0)}for(V=1;V<I.FileIndex.length;++V)if(oe=I.FileIndex[V],oe.size>=4096)if(z.l=oe.start+1<<9,yt&&Buffer.isBuffer(oe.content))oe.content.copy(z,z.l,0,oe.size),z.l+=oe.size+511&-512;else{for(se=0;se<oe.size;++se)z.write_shift(1,oe.content[se]);for(;se&511;++se)z.write_shift(1,0)}for(V=1;V<I.FileIndex.length;++V)if(oe=I.FileIndex[V],oe.size>0&&oe.size<4096)if(yt&&Buffer.isBuffer(oe.content))oe.content.copy(z,z.l,0,oe.size),z.l+=oe.size+63&-64;else{for(se=0;se<oe.size;++se)z.write_shift(1,oe.content[se]);for(;se&63;++se)z.write_shift(1,0)}if(yt)z.l=z.length;else for(;z.l<z.length;)z.write_shift(1,0);return z}function N(I,U){var L=I.FullPaths.map(function(se){return se.toUpperCase()}),M=L.map(function(se){var ee=se.split("/");return ee[ee.length-(se.slice(-1)=="/"?2:1)]}),z=!1;U.charCodeAt(0)===47?(z=!0,U=L[0].slice(0,-1)+U):z=U.indexOf("/")!==-1;var V=U.toUpperCase(),ae=z===!0?L.indexOf(V):M.indexOf(V);if(ae!==-1)return I.FileIndex[ae];var re=!V.match(Ku);for(V=V.replace(ai,""),re&&(V=V.replace(Ku,"!")),ae=0;ae<L.length;++ae)if((re?L[ae].replace(Ku,"!"):L[ae]).replace(ai,"")==V||(re?M[ae].replace(Ku,"!"):M[ae]).replace(ai,"")==V)return I.FileIndex[ae];return null}var D=64,R=-2,Ue="d0cf11e0a1b11ae1",me=[208,207,17,224,161,177,26,225],Ie="00000000000000000000000000000000",Te={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:R,FREESECT:-1,HEADER_SIGNATURE:Ue,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Ie,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function _e(I,U,L){c();var M=b(I,L);l.writeFileSync(U,M)}function Q(I){for(var U=new Array(I.length),L=0;L<I.length;++L)U[L]=String.fromCharCode(I[L]);return U.join("")}function ke(I,U){var L=b(I,U);switch(U&&U.type||"buffer"){case"file":return c(),l.writeFileSync(U.filename,L),L;case"binary":return typeof L=="string"?L:Q(L);case"base64":return Vf(typeof L=="string"?L:Q(L));case"buffer":if(yt)return Buffer.isBuffer(L)?L:Va(L);case"array":return typeof L=="string"?Mi(L):L}return L}var Le;function j(I){try{var U=I.InflateRaw,L=new U;if(L._processChunk(new Uint8Array([3,0]),L._finishFlushFlag),L.bytesRead)Le=I;else throw new Error("zlib does not expose bytesRead")}catch(M){console.error("cannot use native zlib: "+(M.message||M))}}function H(I,U){if(!Le)return oa(I,U);var L=Le.InflateRaw,M=new L,z=M._processChunk(I.slice(I.l),M._finishFlushFlag);return I.l+=M.bytesRead,z}function q(I){return Le?Le.deflateRawSync(I):ct(I)}var Y=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],de=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Se=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Ne(I){var U=(I<<1|I<<11)&139536|(I<<5|I<<15)&558144;return(U>>16|U>>8|U)&255}for(var Ae=typeof Uint8Array<"u",we=Ae?new Uint8Array(256):[],it=0;it<256;++it)we[it]=Ne(it);function G(I,U){var L=we[I&255];return U<=8?L>>>8-U:(L=L<<8|we[I>>8&255],U<=16?L>>>16-U:(L=L<<8|we[I>>16&255],L>>>24-U))}function jt(I,U){var L=U&7,M=U>>>3;return(I[M]|(L<=6?0:I[M+1]<<8))>>>L&3}function mt(I,U){var L=U&7,M=U>>>3;return(I[M]|(L<=5?0:I[M+1]<<8))>>>L&7}function bt(I,U){var L=U&7,M=U>>>3;return(I[M]|(L<=4?0:I[M+1]<<8))>>>L&15}function ht(I,U){var L=U&7,M=U>>>3;return(I[M]|(L<=3?0:I[M+1]<<8))>>>L&31}function We(I,U){var L=U&7,M=U>>>3;return(I[M]|(L<=1?0:I[M+1]<<8))>>>L&127}function Jt(I,U,L){var M=U&7,z=U>>>3,V=(1<<L)-1,ae=I[z]>>>M;return L<8-M||(ae|=I[z+1]<<8-M,L<16-M)||(ae|=I[z+2]<<16-M,L<24-M)||(ae|=I[z+3]<<24-M),ae&V}function hn(I,U,L){var M=U&7,z=U>>>3;return M<=5?I[z]|=(L&7)<<M:(I[z]|=L<<M&255,I[z+1]=(L&7)>>8-M),U+3}function $r(I,U,L){var M=U&7,z=U>>>3;return L=(L&1)<<M,I[z]|=L,U+1}function ci(I,U,L){var M=U&7,z=U>>>3;return L<<=M,I[z]|=L&255,L>>>=8,I[z+1]=L,U+8}function $i(I,U,L){var M=U&7,z=U>>>3;return L<<=M,I[z]|=L&255,L>>>=8,I[z+1]=L&255,I[z+2]=L>>>8,U+16}function ui(I,U){var L=I.length,M=2*L>U?2*L:U+5,z=0;if(L>=U)return I;if(yt){var V=T_(M);if(I.copy)I.copy(V);else for(;z<I.length;++z)V[z]=I[z];return V}else if(Ae){var ae=new Uint8Array(M);if(ae.set)ae.set(I);else for(;z<L;++z)ae[z]=I[z];return ae}return I.length=M,I}function Fr(I){for(var U=new Array(I),L=0;L<I;++L)U[L]=0;return U}function fi(I,U,L){var M=1,z=0,V=0,ae=0,re=0,se=I.length,ee=Ae?new Uint16Array(32):Fr(32);for(V=0;V<32;++V)ee[V]=0;for(V=se;V<L;++V)I[V]=0;se=I.length;var oe=Ae?new Uint16Array(se):Fr(se);for(V=0;V<se;++V)ee[z=I[V]]++,M<z&&(M=z),oe[V]=0;for(ee[0]=0,V=1;V<=M;++V)ee[V+16]=re=re+ee[V-1]<<1;for(V=0;V<se;++V)re=I[V],re!=0&&(oe[V]=ee[re+16]++);var ve=0;for(V=0;V<se;++V)if(ve=I[V],ve!=0)for(re=G(oe[V],M)>>M-ve,ae=(1<<M+4-ve)-1;ae>=0;--ae)U[re|ae<<ve]=ve&15|V<<4;return M}var Ot=Ae?new Uint16Array(512):Fr(512),vr=Ae?new Uint16Array(32):Fr(32);if(!Ae){for(var rr=0;rr<512;++rr)Ot[rr]=0;for(rr=0;rr<32;++rr)vr[rr]=0}(function(){for(var I=[],U=0;U<32;U++)I.push(5);fi(I,vr,32);var L=[];for(U=0;U<=143;U++)L.push(8);for(;U<=255;U++)L.push(9);for(;U<=279;U++)L.push(7);for(;U<=287;U++)L.push(8);fi(L,Ot,288)})();var qn=function(){for(var U=Ae?new Uint8Array(32768):[],L=0,M=0;L<Se.length-1;++L)for(;M<Se[L+1];++M)U[M]=L;for(;M<32768;++M)U[M]=29;var z=Ae?new Uint8Array(259):[];for(L=0,M=0;L<de.length-1;++L)for(;M<de[L+1];++M)z[M]=L;function V(re,se){for(var ee=0;ee<re.length;){var oe=Math.min(65535,re.length-ee),ve=ee+oe==re.length;for(se.write_shift(1,+ve),se.write_shift(2,oe),se.write_shift(2,~oe&65535);oe-- >0;)se[se.l++]=re[ee++]}return se.l}function ae(re,se){for(var ee=0,oe=0,ve=Ae?new Uint16Array(32768):[];oe<re.length;){var Oe=Math.min(65535,re.length-oe);if(Oe<10){for(ee=hn(se,ee,+(oe+Oe==re.length)),ee&7&&(ee+=8-(ee&7)),se.l=ee/8|0,se.write_shift(2,Oe),se.write_shift(2,~Oe&65535);Oe-- >0;)se[se.l++]=re[oe++];ee=se.l*8;continue}ee=hn(se,ee,+(oe+Oe==re.length)+2);for(var He=0;Oe-- >0;){var Fe=re[oe];He=(He<<5^Fe)&32767;var ze=-1,st=0;if((ze=ve[He])&&(ze|=oe&-32768,ze>oe&&(ze-=32768),ze<oe))for(;re[ze+st]==re[oe+st]&&st<250;)++st;if(st>2){Fe=z[st],Fe<=22?ee=ci(se,ee,we[Fe+1]>>1)-1:(ci(se,ee,3),ee+=5,ci(se,ee,we[Fe-23]>>5),ee+=3);var Et=Fe<8?0:Fe-4>>2;Et>0&&($i(se,ee,st-de[Fe]),ee+=Et),Fe=U[oe-ze],ee=ci(se,ee,we[Fe]>>3),ee-=3;var kt=Fe<4?0:Fe-2>>1;kt>0&&($i(se,ee,oe-ze-Se[Fe]),ee+=kt);for(var wt=0;wt<st;++wt)ve[He]=oe&32767,He=(He<<5^re[oe])&32767,++oe;Oe-=st-1}else Fe<=143?Fe=Fe+48:ee=$r(se,ee,1),ee=ci(se,ee,we[Fe]),ve[He]=oe&32767,++oe}ee=ci(se,ee,0)-1}return se.l=(ee+7)/8|0,se.l}return function(se,ee){return se.length<8?V(se,ee):ae(se,ee)}}();function ct(I){var U=pe(50+Math.floor(I.length*1.1)),L=qn(I,U);return U.slice(0,L)}var nr=Ae?new Uint16Array(32768):Fr(32768),yr=Ae?new Uint16Array(32768):Fr(32768),dr=Ae?new Uint16Array(128):Fr(128),Nn=1,ie=1;function jr(I,U){var L=ht(I,U)+257;U+=5;var M=ht(I,U)+1;U+=5;var z=bt(I,U)+4;U+=4;for(var V=0,ae=Ae?new Uint8Array(19):Fr(19),re=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],se=1,ee=Ae?new Uint8Array(8):Fr(8),oe=Ae?new Uint8Array(8):Fr(8),ve=ae.length,Oe=0;Oe<z;++Oe)ae[Y[Oe]]=V=mt(I,U),se<V&&(se=V),ee[V]++,U+=3;var He=0;for(ee[0]=0,Oe=1;Oe<=se;++Oe)oe[Oe]=He=He+ee[Oe-1]<<1;for(Oe=0;Oe<ve;++Oe)(He=ae[Oe])!=0&&(re[Oe]=oe[He]++);var Fe=0;for(Oe=0;Oe<ve;++Oe)if(Fe=ae[Oe],Fe!=0){He=we[re[Oe]]>>8-Fe;for(var ze=(1<<7-Fe)-1;ze>=0;--ze)dr[He|ze<<Fe]=Fe&7|Oe<<3}var st=[];for(se=1;st.length<L+M;)switch(He=dr[We(I,U)],U+=He&7,He>>>=3){case 16:for(V=3+jt(I,U),U+=2,He=st[st.length-1];V-- >0;)st.push(He);break;case 17:for(V=3+mt(I,U),U+=3;V-- >0;)st.push(0);break;case 18:for(V=11+We(I,U),U+=7;V-- >0;)st.push(0);break;default:st.push(He),se<He&&(se=He);break}var Et=st.slice(0,L),kt=st.slice(L);for(Oe=L;Oe<286;++Oe)Et[Oe]=0;for(Oe=M;Oe<30;++Oe)kt[Oe]=0;return Nn=fi(Et,nr,286),ie=fi(kt,yr,30),U}function aa(I,U){if(I[0]==3&&!(I[1]&3))return[Do(U),2];for(var L=0,M=0,z=T_(U||1<<18),V=0,ae=z.length>>>0,re=0,se=0;!(M&1);){if(M=mt(I,L),L+=3,M>>>1)M>>1==1?(re=9,se=5):(L=jr(I,L),re=Nn,se=ie);else{L&7&&(L+=8-(L&7));var ee=I[L>>>3]|I[(L>>>3)+1]<<8;if(L+=32,ee>0)for(!U&&ae<V+ee&&(z=ui(z,V+ee),ae=z.length);ee-- >0;)z[V++]=I[L>>>3],L+=8;continue}for(;;){!U&&ae<V+32767&&(z=ui(z,V+32767),ae=z.length);var oe=Jt(I,L,re),ve=M>>>1==1?Ot[oe]:nr[oe];if(L+=ve&15,ve>>>=4,!(ve>>>8&255))z[V++]=ve;else{if(ve==256)break;ve-=257;var Oe=ve<8?0:ve-4>>2;Oe>5&&(Oe=0);var He=V+de[ve];Oe>0&&(He+=Jt(I,L,Oe),L+=Oe),oe=Jt(I,L,se),ve=M>>>1==1?vr[oe]:yr[oe],L+=ve&15,ve>>>=4;var Fe=ve<4?0:ve-2>>1,ze=Se[ve];for(Fe>0&&(ze+=Jt(I,L,Fe),L+=Fe),!U&&ae<He&&(z=ui(z,He+100),ae=z.length);V<He;)z[V]=z[V-ze],++V}}}return U?[z,L+7>>>3]:[z.slice(0,V),L+7>>>3]}function oa(I,U){var L=I.slice(I.l||0),M=aa(L,U);return I.l+=M[1],M[0]}function Ps(I,U){if(I)typeof console<"u"&&console.error(U);else throw new Error(U)}function la(I,U){var L=I;An(L,0);var M=[],z=[],V={FileIndex:M,FullPaths:z};w(V,{root:U.root});for(var ae=L.length-4;(L[ae]!=80||L[ae+1]!=75||L[ae+2]!=5||L[ae+3]!=6)&&ae>=0;)--ae;L.l=ae+4,L.l+=4;var re=L.read_shift(2);L.l+=6;var se=L.read_shift(4);for(L.l=se,ae=0;ae<re;++ae){L.l+=20;var ee=L.read_shift(4),oe=L.read_shift(4),ve=L.read_shift(2),Oe=L.read_shift(2),He=L.read_shift(2);L.l+=8;var Fe=L.read_shift(4),ze=o(L.slice(L.l+ve,L.l+ve+Oe));L.l+=ve+Oe+He;var st=L.l;L.l=Fe+4,ki(L,ee,oe,V,ze),L.l=st}return V}function ki(I,U,L,M,z){I.l+=2;var V=I.read_shift(2),ae=I.read_shift(2),re=a(I);if(V&8257)throw new Error("Unsupported ZIP encryption");for(var se=I.read_shift(4),ee=I.read_shift(4),oe=I.read_shift(4),ve=I.read_shift(2),Oe=I.read_shift(2),He="",Fe=0;Fe<ve;++Fe)He+=String.fromCharCode(I[I.l++]);if(Oe){var ze=o(I.slice(I.l,I.l+Oe));(ze[21589]||{}).mt&&(re=ze[21589].mt),((z||{})[21589]||{}).mt&&(re=z[21589].mt)}I.l+=Oe;var st=I.slice(I.l,I.l+ee);switch(ae){case 8:st=H(I,oe);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ae)}var Et=!1;V&8&&(se=I.read_shift(4),se==134695760&&(se=I.read_shift(4),Et=!0),ee=I.read_shift(4),oe=I.read_shift(4)),ee!=U&&Ps(Et,"Bad compressed size: "+U+" != "+ee),oe!=L&&Ps(Et,"Bad uncompressed size: "+L+" != "+oe),pn(M,He,st,{unsafe:!0,mt:re})}function Gi(I,U){var L=U||{},M=[],z=[],V=pe(1),ae=L.compression?8:0,re=0,se=0,ee=0,oe=0,ve=0,Oe=I.FullPaths[0],He=Oe,Fe=I.FileIndex[0],ze=[],st=0;for(se=1;se<I.FullPaths.length;++se)if(He=I.FullPaths[se].slice(Oe.length),Fe=I.FileIndex[se],!(!Fe.size||!Fe.content||He=="Sh33tJ5")){var Et=oe,kt=pe(He.length);for(ee=0;ee<He.length;++ee)kt.write_shift(1,He.charCodeAt(ee)&127);kt=kt.slice(0,kt.l),ze[ve]=aR.buf(Fe.content,0);var wt=Fe.content;ae==8&&(wt=q(wt)),V=pe(30),V.write_shift(4,67324752),V.write_shift(2,20),V.write_shift(2,re),V.write_shift(2,ae),Fe.mt?s(V,Fe.mt):V.write_shift(4,0),V.write_shift(-4,ze[ve]),V.write_shift(4,wt.length),V.write_shift(4,Fe.content.length),V.write_shift(2,kt.length),V.write_shift(2,0),oe+=V.length,M.push(V),oe+=kt.length,M.push(kt),oe+=wt.length,M.push(wt),V=pe(46),V.write_shift(4,33639248),V.write_shift(2,0),V.write_shift(2,20),V.write_shift(2,re),V.write_shift(2,ae),V.write_shift(4,0),V.write_shift(-4,ze[ve]),V.write_shift(4,wt.length),V.write_shift(4,Fe.content.length),V.write_shift(2,kt.length),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(4,0),V.write_shift(4,Et),st+=V.l,z.push(V),st+=kt.length,z.push(kt),++ve}return V=pe(22),V.write_shift(4,101010256),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(2,ve),V.write_shift(2,ve),V.write_shift(4,st),V.write_shift(4,oe),V.write_shift(2,0),un([un(M),un(z),V])}var _r={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Ki(I,U){if(I.ctype)return I.ctype;var L=I.name||"",M=L.match(/\.([^\.]+)$/);return M&&_r[M[1]]||U&&(M=(L=U).match(/[\.\\]([^\.\\])+$/),M&&_r[M[1]])?_r[M[1]]:"application/octet-stream"}function Ha(I){for(var U=Vf(I),L=[],M=0;M<U.length;M+=76)L.push(U.slice(M,M+76));return L.join(`\r
`)+`\r
`}function $a(I){var U=I.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ee){var oe=ee.charCodeAt(0).toString(16).toUpperCase();return"="+(oe.length==1?"0"+oe:oe)});U=U.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),U.charAt(0)==`
`&&(U="=0D"+U.slice(1)),U=U.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var L=[],M=U.split(`\r
`),z=0;z<M.length;++z){var V=M[z];if(V.length==0){L.push("");continue}for(var ae=0;ae<V.length;){var re=76,se=V.slice(ae,ae+re);se.charAt(re-1)=="="?re--:se.charAt(re-2)=="="?re-=2:se.charAt(re-3)=="="&&(re-=3),se=V.slice(ae,ae+re),ae+=re,ae<V.length&&(se+="="),L.push(se)}}return L.join(`\r
`)}function Dn(I){for(var U=[],L=0;L<I.length;++L){for(var M=I[L];L<=I.length&&M.charAt(M.length-1)=="=";)M=M.slice(0,M.length-1)+I[++L];U.push(M)}for(var z=0;z<U.length;++z)U[z]=U[z].replace(/[=][0-9A-Fa-f]{2}/g,function(V){return String.fromCharCode(parseInt(V.slice(1),16))});return Mi(U.join(`\r
`))}function Os(I,U,L){for(var M="",z="",V="",ae,re=0;re<10;++re){var se=U[re];if(!se||se.match(/^\s*$/))break;var ee=se.match(/^(.*?):\s*([^\s].*)$/);if(ee)switch(ee[1].toLowerCase()){case"content-location":M=ee[2].trim();break;case"content-type":V=ee[2].trim();break;case"content-transfer-encoding":z=ee[2].trim();break}}switch(++re,z.toLowerCase()){case"base64":ae=Mi(zi(U.slice(re).join("")));break;case"quoted-printable":ae=Dn(U.slice(re));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+z)}var oe=pn(I,M.slice(L.length),ae,{unsafe:!0});V&&(oe.ctype=V)}function Zt(I,U){if(Q(I.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var L=U&&U.root||"",M=(yt&&Buffer.isBuffer(I)?I.toString("binary"):Q(I)).split(`\r
`),z=0,V="";for(z=0;z<M.length;++z)if(V=M[z],!!/^Content-Location:/i.test(V)&&(V=V.slice(V.indexOf("file")),L||(L=V.slice(0,V.lastIndexOf("/")+1)),V.slice(0,L.length)!=L))for(;L.length>0&&(L=L.slice(0,L.length-1),L=L.slice(0,L.lastIndexOf("/")+1),V.slice(0,L.length)!=L););var ae=(M[1]||"").match(/boundary="(.*?)"/);if(!ae)throw new Error("MAD cannot find boundary");var re="--"+(ae[1]||""),se=[],ee=[],oe={FileIndex:se,FullPaths:ee};w(oe);var ve,Oe=0;for(z=0;z<M.length;++z){var He=M[z];He!==re&&He!==re+"--"||(Oe++&&Os(oe,M.slice(ve,z),L),ve=z)}return oe}function hr(I,U){var L=U||{},M=L.boundary||"SheetJS";M="------="+M;for(var z=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+M.slice(2)+'"',"","",""],V=I.FullPaths[0],ae=V,re=I.FileIndex[0],se=1;se<I.FullPaths.length;++se)if(ae=I.FullPaths[se].slice(V.length),re=I.FileIndex[se],!(!re.size||!re.content||ae=="Sh33tJ5")){ae=ae.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(st){return"_x"+st.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(st){return"_u"+st.charCodeAt(0).toString(16)+"_"});for(var ee=re.content,oe=yt&&Buffer.isBuffer(ee)?ee.toString("binary"):Q(ee),ve=0,Oe=Math.min(1024,oe.length),He=0,Fe=0;Fe<=Oe;++Fe)(He=oe.charCodeAt(Fe))>=32&&He<128&&++ve;var ze=ve>=Oe*4/5;z.push(M),z.push("Content-Location: "+(L.root||"file:///C:/SheetJS/")+ae),z.push("Content-Transfer-Encoding: "+(ze?"quoted-printable":"base64")),z.push("Content-Type: "+Ki(re,ae)),z.push(""),z.push(ze?$a(oe):Ha(oe))}return z.push(M+`--\r
`),z.join(`\r
`)}function Ci(I){var U={};return w(U,I),U}function pn(I,U,L,M){var z=M&&M.unsafe;z||w(I);var V=!z&&tt.find(I,U);if(!V){var ae=I.FullPaths[0];U.slice(0,ae.length)==ae?ae=U:(ae.slice(-1)!="/"&&(ae+="/"),ae=(ae+U).replace("//","/")),V={name:i(U),type:2},I.FileIndex.push(V),I.FullPaths.push(ae),z||tt.utils.cfb_gc(I)}return V.content=L,V.size=L?L.length:0,M&&(M.CLSID&&(V.clsid=M.CLSID),M.mt&&(V.mt=M.mt),M.ct&&(V.ct=M.ct)),V}function ca(I,U){w(I);var L=tt.find(I,U);if(L){for(var M=0;M<I.FileIndex.length;++M)if(I.FileIndex[M]==L)return I.FileIndex.splice(M,1),I.FullPaths.splice(M,1),!0}return!1}function Hl(I,U,L){w(I);var M=tt.find(I,U);if(M){for(var z=0;z<I.FileIndex.length;++z)if(I.FileIndex[z]==M)return I.FileIndex[z].name=i(L),I.FullPaths[z]=L,!0}return!1}function hs(I){S(I,!0)}return e.find=N,e.read=B,e.parse=d,e.write=ke,e.writeFile=_e,e.utils={cfb_new:Ci,cfb_add:pn,cfb_del:ca,cfb_mov:Hl,cfb_gc:hs,ReadShift:cf,CheckField:HS,prep_blob:An,bconcat:un,use_zlib:j,_deflateRaw:ct,_inflateRaw:oa,consts:Te},e}();function oR(t){return typeof t=="string"?Sp(t):Array.isArray(t)?Db(t):t}function p0(t,e,r){if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=Sp(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var n=r=="utf8"?Ys(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var i=new Blob([oR(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,t);if(typeof saveAs<"u")return saveAs(i,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:t,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=t,a.href=s,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(t);return o.open("w"),o.encoding="binary",Array.isArray(e)&&(e=Wo(e)),o.write(e),o.close(),e}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+t)}function lR(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function Dr(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function R_(t,e){for(var r=[],n=Dr(t),i=0;i!==n.length;++i)r[t[n[i]][e]]==null&&(r[t[n[i]][e]]=n[i]);return r}function kp(t){for(var e=[],r=Dr(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}function Cp(t){for(var e=[],r=Dr(t),n=0;n!==r.length;++n)e[t[r[n]]]=parseInt(r[n],10);return e}function cR(t){for(var e=[],r=Dr(t),n=0;n!==r.length;++n)e[t[r[n]]]==null&&(e[t[r[n]]]=[]),e[t[r[n]]].push(r[n]);return e}var Mh=new Date(1899,11,30,0,0,0);function tn(t,e){var r=t.getTime(),n=Mh.getTime()+(t.getTimezoneOffset()-Mh.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var TS=new Date,uR=Mh.getTime()+(TS.getTimezoneOffset()-Mh.getTimezoneOffset())*6e4,N_=TS.getTimezoneOffset();function Fp(t){var e=new Date;return e.setTime(t*24*60*60*1e3+uR),e.getTimezoneOffset()!==N_&&e.setTime(e.getTime()+(e.getTimezoneOffset()-N_)*6e4),e}function fR(t){var e=0,r=0,n=!1,i=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var s=1;s!=i.length;++s)if(i[s]){switch(r=1,s>3&&(n=!0),i[s].slice(i[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[s].slice(i[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(i[s],10)}return e}var D_=new Date("2017-02-19T19:06:09.000Z"),SS=isNaN(D_.getFullYear())?new Date("2/19/17"):D_,dR=SS.getFullYear()==2017;function ur(t,e){var r=new Date(t);if(dR)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(SS.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=t.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return t.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function Sl(t,e){if(yt&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return Ys(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return Ys(fS(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return Ys(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return Ys(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],i=0;i!=t.length;++i)n.push(String.fromCharCode(t[i]));return n.join("")}function fr(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=fr(t[r]));return e}function br(t,e){for(var r="";r.length<e;)r+=t;return r}function bs(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return r=-r,s}),!isNaN(e=Number(n)))?e/r:e}var hR=["january","february","march","april","may","june","july","august","september","october","november","december"];function Xc(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),i=e.getMonth(),s=e.getDate();if(isNaN(s))return r;var a=t.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&hR.indexOf(a)==-1)return r}else if(a.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||s>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var pR=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(t||typeof n=="string")return r.split(n);for(var s=r.split(n),a=[s[0]],o=1;o<s.length;++o)a.push(i),a.push(s[o]);return a}}();function AS(t){return t?t.content&&t.type?Sl(t.content,!0):t.data?Gu(t.data):t.asNodeBuffer&&yt?Gu(t.asNodeBuffer().toString("binary")):t.asBinary?Gu(t.asBinary()):t._data&&t._data.getContent?Gu(Sl(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function kS(t){if(!t)return null;if(t.data)return E_(t.data);if(t.asNodeBuffer&&yt)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?E_(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function gR(t){return t&&t.name.slice(-4)===".bin"?kS(t):AS(t)}function ts(t,e){for(var r=t.FullPaths||Dr(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var a=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==a||i==a)return t.files?t.files[r[s]]:t.FileIndex[s]}return null}function F1(t,e){var r=ts(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function zr(t,e,r){if(!r)return gR(F1(t,e));if(!e)return null;try{return zr(t,e)}catch{return null}}function Li(t,e,r){if(!r)return AS(F1(t,e));if(!e)return null;try{return Li(t,e)}catch{return null}}function mR(t,e,r){return kS(F1(t,e))}function P_(t){for(var e=t.FullPaths||Dr(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function vt(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return yt?n=Va(r):n=Pb(r),tt.utils.cfb_add(t,e,n)}tt.utils.cfb_add(t,e,r)}else t.file(e,r)}function I1(){return tt.utils.cfb_new()}function CS(t,e){switch(e.type){case"base64":return tt.read(t,{type:"base64"});case"binary":return tt.read(t,{type:"binary"});case"buffer":case"array":return tt.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function Xu(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var Br=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,xR=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,O_=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,vR=/<[^>]*>/g,Yn=Br.match(O_)?O_:vR,yR=/<\w*:/,_R=/<(\/?)\w+:/;function lt(t,e,r){for(var n={},i=0,s=0;i!==t.length&&!((s=t.charCodeAt(i))===32||s===10||s===13);++i);if(e||(n[0]=t.slice(0,i)),i===t.length)return n;var a=t.match(xR),o=0,l="",c=0,d="",h="",p=1;if(a)for(c=0;c!=a.length;++c){for(h=a[c],s=0;s!=h.length&&h.charCodeAt(s)!==61;++s);for(d=h.slice(0,s).trim();h.charCodeAt(s+1)==32;)++s;for(p=(i=h.charCodeAt(s+1))==34||i==39?1:0,l=h.slice(s+1+p,h.length-p),o=0;o!=d.length&&d.charCodeAt(o)!==58;++o);if(o===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),n[d]=l,n[d.toLowerCase()]=l;else{var m=(o===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(o+1);if(n[m]&&d.slice(o-3,o)=="ext")continue;n[m]=l,n[m.toLowerCase()]=l}}return n}function ia(t){return t.replace(_R,"<$1")}var FS={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},b1=kp(FS),Dt=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",s=i.indexOf("<![CDATA[");if(s==-1)return i.replace(t,function(o,l){return FS[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(e,function(o,l){return String.fromCharCode(parseInt(l,16))});var a=i.indexOf("]]>");return r(i.slice(0,s))+i.slice(s+9,a)+r(i.slice(a+3))}}(),R1=/[&<>'"]/g,ER=/[\u0000-\u0008\u000b-\u001f]/g;function Gt(t){var e=t+"";return e.replace(R1,function(r){return b1[r]}).replace(ER,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function M_(t){return Gt(t).replace(/ /g,"_x0020_")}var IS=/[\u0000-\u001f]/g;function N1(t){var e=t+"";return e.replace(R1,function(r){return b1[r]}).replace(/\n/g,"<br/>").replace(IS,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function wR(t){var e=t+"";return e.replace(R1,function(r){return b1[r]}).replace(IS,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var L_=function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}}();function TR(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function lr(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Tg(t){for(var e="",r=0,n=0,i=0,s=0,a=0,o=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(i=t.charCodeAt(r++),n>191&&n<224){a=(n&31)<<6,a|=i&63,e+=String.fromCharCode(a);continue}if(s=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}a=t.charCodeAt(r++),o=((n&7)<<18|(i&63)<<12|(s&63)<<6|a&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function B_(t){var e=Do(2*t.length),r,n,i=1,s=0,a=0,o;for(n=0;n<t.length;n+=i)i=1,(o=t.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(t.charCodeAt(n+1)&63),i=2):o<240?(r=(o&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),i=3):(i=4,r=(o&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,a=55296+(r>>>10&1023),r=56320+(r&1023)),a!==0&&(e[s++]=a&255,e[s++]=a>>>8,a=0),e[s++]=r%256,e[s++]=r>>>8;return e.slice(0,s).toString("ucs2")}function j_(t){return Va(t,"binary").toString("utf8")}var _d="foo bar baz",Qt=yt&&(j_(_d)==Tg(_d)&&j_||B_(_d)==Tg(_d)&&B_)||Tg,Ys=yt?function(t){return Va(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,i=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},zf=function(){var t={};return function(r,n){var i=r+"|"+(n||"");return t[i]?t[i]:t[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),bS=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<t.length;++i)n=n.replace(t[i][0],t[i][1]);return n}}(),SR=function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),AR=/<\/?(?:vt:)?variant>/g,kR=/<(?:vt:)([^>]*)>([\s\S]*)</;function V_(t,e){var r=lt(t),n=t.match(SR(r.baseType))||[],i=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(s){var a=s.replace(AR,"").match(kR);a&&i.push({v:Qt(a[2]),t:a[1]})}),i}var RS=/(^\s|\s$|\n)/;function kn(t,e){return"<"+t+(e.match(RS)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function Wf(t){return Dr(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function Be(t,e,r){return"<"+t+(r!=null?Wf(r):"")+(e!=null?(e.match(RS)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function Xm(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function CR(t,e){switch(typeof t){case"string":var r=Be("vt:lpwstr",Gt(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Be((t|0)==t?"vt:i4":"vt:r8",Gt(String(t)));case"boolean":return Be("vt:bool",t?"true":"false")}if(t instanceof Date)return Be("vt:filetime",Xm(t));throw new Error("Unable to serialize "+t)}function D1(t){if(yt&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return Qt(Wo(A1(t)));throw new Error("Bad input format: expected Buffer or string")}var Hf=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Qr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Ml=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Pi={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function FR(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),i=t[e+6]&15,s=5;s>=0;--s)i=i*256+t[e+s];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function IR(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,i=0,s=0,a=n?-e:e;isFinite(a)?a==0?i=s=0:(i=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(e)?26985:0);for(var o=0;o<=5;++o,s/=256)t[r+o]=s&255;t[r+6]=(i&15)<<4|s&15,t[r+7]=i>>4|n}var U_=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var i=0,s=t[0][n].length;i<s;i+=r)e.push.apply(e,t[0][n].slice(i,i+r));return e},z_=yt?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:Va(e)})):U_(t)}:U_,W_=function(t,e,r){for(var n=[],i=e;i<r;i+=2)n.push(String.fromCharCode(_a(t,i)));return n.join("").replace(ai,"")},P1=yt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(ai,""):W_(t,e,r)}:W_,H_=function(t,e,r){for(var n=[],i=e;i<e+r;++i)n.push(("0"+t[i].toString(16)).slice(-2));return n.join("")},NS=yt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):H_(t,e,r)}:H_,$_=function(t,e,r){for(var n=[],i=e;i<r;i++)n.push(String.fromCharCode(lc(t,i)));return n.join("")},g0=yt?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):$_(e,r,n)}:$_,DS=function(t,e){var r=Oi(t,e);return r>0?g0(t,e+4,e+4+r-1):""},PS=DS,OS=function(t,e){var r=Oi(t,e);return r>0?g0(t,e+4,e+4+r-1):""},MS=OS,LS=function(t,e){var r=2*Oi(t,e);return r>0?g0(t,e+4,e+4+r-1):""},BS=LS,jS=function(e,r){var n=Oi(e,r);return n>0?P1(e,r+4,r+4+n):""},VS=jS,US=function(t,e){var r=Oi(t,e);return r>0?g0(t,e+4,e+4+r):""},zS=US,WS=function(t,e){return FR(t,e)},Lh=WS,O1=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};yt&&(PS=function(e,r){if(!Buffer.isBuffer(e))return DS(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},MS=function(e,r){if(!Buffer.isBuffer(e))return OS(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},BS=function(e,r){if(!Buffer.isBuffer(e))return LS(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},VS=function(e,r){if(!Buffer.isBuffer(e))return jS(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},zS=function(e,r){if(!Buffer.isBuffer(e))return US(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},Lh=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):WS(e,r)},O1=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var lc=function(t,e){return t[e]},_a=function(t,e){return t[e+1]*256+t[e]},bR=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},Oi=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},il=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},RR=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function cf(t,e){var r="",n,i,s=[],a,o,l,c;switch(e){case"dbcs":if(c=this.l,yt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(l=0;l<t;++l)r+=String.fromCharCode(_a(this,c)),c+=2;t*=2;break;case"utf8":r=g0(this,this.l,this.l+t);break;case"utf16le":t*=2,r=P1(this,this.l,this.l+t);break;case"wstr":return cf.call(this,t,"dbcs");case"lpstr-ansi":r=PS(this,this.l),t=4+Oi(this,this.l);break;case"lpstr-cp":r=MS(this,this.l),t=4+Oi(this,this.l);break;case"lpwstr":r=BS(this,this.l),t=4+2*Oi(this,this.l);break;case"lpp4":t=4+Oi(this,this.l),r=VS(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+Oi(this,this.l),r=zS(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(a=lc(this,this.l+t++))!==0;)s.push(yd(a));r=s.join("");break;case"_wstr":for(t=0,r="";(a=_a(this,this.l+t))!==0;)s.push(yd(a)),t+=2;t+=2,r=s.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=lc(this,c),this.l=c+1,o=cf.call(this,t-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(yd(_a(this,c))),c+=2}r=s.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,l=0;l!=t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=lc(this,c),this.l=c+1,o=cf.call(this,t-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(yd(lc(this,c))),c+=1}r=s.join("");break;default:switch(t){case 1:return n=lc(this,this.l),this.l++,n;case 2:return n=(e==="i"?bR:_a)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(t>0?il:RR)(this,this.l),this.l+=4,n):(i=Oi(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return t==8?i=Lh(this,this.l):i=Lh([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;t=8;case 16:r=NS(this,this.l,t);break}}return this.l+=t,r}var NR=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},DR=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},PR=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function OR(t,e,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=e.length;++i)PR(this,e.charCodeAt(i),this.l+2*i);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;n=e.length}else if(r==="hex"){for(;i<t;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+t,this.length);for(i=0;i<Math.min(e.length,t);++i){var a=e.charCodeAt(i);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,NR(this,e,this.l);break;case 8:if(n=8,r==="f"){IR(this,e,this.l);break}case 16:break;case-4:n=4,DR(this,e,this.l);break}return this.l+=n,this}function HS(t,e){var r=NS(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function An(t,e){t.l=e,t.read_shift=cf,t.chk=HS,t.write_shift=OR}function Kn(t,e){t.l+=e}function pe(t){var e=Do(t);return An(e,0),e}function Ua(t,e,r){if(t){var n,i,s;An(t,t.l||0);for(var a=t.length,o=0,l=0;t.l<a;){o=t.read_shift(1),o&128&&(o=(o&127)+((t.read_shift(1)&127)<<7));var c=qf[o]||qf[65535];for(n=t.read_shift(1),s=n&127,i=1;i<4&&n&128;++i)s+=((n=t.read_shift(1))&127)<<7*i;l=t.l+s;var d=c.f&&c.f(t,s,r);if(t.l=l,e(d,c,o))return}}}function Si(){var t=[],e=yt?256:2048,r=function(c){var d=pe(c);return An(d,0),d},n=r(e),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},s=function(c){return n&&c<n.length-n.l?n:(i(),n=r(Math.max(c+1,e)))},a=function(){return i(),un(t)},o=function(c){i(),n=c,n.l==null&&(n.l=n.length),s(e)};return{next:s,push:o,end:a,_bufs:t}}function Ee(t,e,r,n){var i=+e,s;if(!isNaN(i)){n||(n=qf[i].p||(r||[]).length||0),s=1+(i>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var a=t.next(s);i<=127?a.write_shift(1,i):(a.write_shift(1,(i&127)+128),a.write_shift(1,i>>7));for(var o=0;o!=4;++o)if(n>=128)a.write_shift(1,(n&127)+128),n>>=7;else{a.write_shift(1,n);break}n>0&&O1(r)&&t.push(r)}}function uf(t,e,r){var n=fr(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function G_(t,e,r){var n=fr(t);return n.s=uf(n.s,e.s,r),n.e=uf(n.e,e.s,r),n}function ff(t,e){if(t.cRel&&t.c<0)for(t=fr(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=fr(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=ot(t);return!t.cRel&&t.cRel!=null&&(r=BR(r)),!t.rRel&&t.rRel!=null&&(r=MR(r)),r}function Sg(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+Tr(t.s.c)+":"+(t.e.cRel?"":"$")+Tr(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+Lr(t.s.r)+":"+(t.e.rRel?"":"$")+Lr(t.e.r):ff(t.s,e.biff)+":"+ff(t.e,e.biff)}function M1(t){return parseInt(LR(t),10)-1}function Lr(t){return""+(t+1)}function MR(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function LR(t){return t.replace(/\$(\d+)$/,"$1")}function L1(t){for(var e=jR(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function Tr(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function BR(t){return t.replace(/^([A-Z])/,"$$$1")}function jR(t){return t.replace(/^\$([A-Z])/,"$1")}function VR(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Sr(t){for(var e=0,r=0,n=0;n<t.length;++n){var i=t.charCodeAt(n);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:e-1}}function ot(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function Ai(t){var e=t.indexOf(":");return e==-1?{s:Sr(t),e:Sr(t)}:{s:Sr(t.slice(0,e)),e:Sr(t.slice(e+1))}}function xt(t,e){return typeof e>"u"||typeof e=="number"?xt(t.s,t.e):(typeof t!="string"&&(t=ot(t)),typeof e!="string"&&(e=ot(e)),t==e?t:t+":"+e)}function Pt(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,s=t.length;for(r=0;n<s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.s.c=--r,r=0;n<s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(e.s.r=--r,n===s||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.e.c=--r,r=0;n!=s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return e.e.r=--r,e}function K_(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=fs(t.z,r?tn(e):e)}catch{}try{return t.w=fs((t.XF||{}).numFmtId||(r?14:0),r?tn(e):e)}catch{return""+e}}function Da(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?za[t.v]||t.v:e==null?K_(t,t.v):K_(t,e))}function Ho(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function $S(t,e,r){var n=r||{},i=t?Array.isArray(t):n.dense,s=t||(i?[]:{}),a=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?Sr(n.origin):n.origin;a=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var d=Pt(s["!ref"]);c.s.c=d.s.c,c.s.r=d.s.r,c.e.c=Math.max(c.e.c,d.e.c),c.e.r=Math.max(c.e.r,d.e.r),a==-1&&(c.e.r=a=d.e.r+1)}for(var h=0;h!=e.length;++h)if(e[h]){if(!Array.isArray(e[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var p=0;p!=e[h].length;++p)if(!(typeof e[h][p]>"u")){var m={v:e[h][p]},y=a+h,x=o+p;if(c.s.r>y&&(c.s.r=y),c.s.c>x&&(c.s.c=x),c.e.r<y&&(c.e.r=y),c.e.c<x&&(c.e.c=x),e[h][p]&&typeof e[h][p]=="object"&&!Array.isArray(e[h][p])&&!(e[h][p]instanceof Date))m=e[h][p];else if(Array.isArray(m.v)&&(m.f=e[h][p][1],m.v=m.v[0]),m.v===null)if(m.f)m.t="n";else if(n.nullError)m.t="e",m.v=0;else if(n.sheetStubs)m.t="z";else continue;else typeof m.v=="number"?m.t="n":typeof m.v=="boolean"?m.t="b":m.v instanceof Date?(m.z=n.dateNF||at[14],n.cellDates?(m.t="d",m.w=fs(m.z,tn(m.v))):(m.t="n",m.v=tn(m.v),m.w=fs(m.z,m.v))):m.t="s";if(i)s[y]||(s[y]=[]),s[y][x]&&s[y][x].z&&(m.z=s[y][x].z),s[y][x]=m;else{var E=ot({c:x,r:y});s[E]&&s[E].z&&(m.z=s[E].z),s[E]=m}}}return c.s.c<1e7&&(s["!ref"]=xt(c)),s}function fu(t,e){return $S(null,t,e)}function UR(t){return t.read_shift(4,"i")}function Rs(t,e){return e||(e=pe(4)),e.write_shift(4,t),e}function $n(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function fn(t,e){var r=!1;return e==null&&(r=!0,e=pe(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function zR(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function WR(t,e){return e||(e=pe(4)),e.write_shift(2,0),e.write_shift(2,0),e}function B1(t,e){var r=t.l,n=t.read_shift(1),i=$n(t),s=[],a={t:i,h:i};if(n&1){for(var o=t.read_shift(4),l=0;l!=o;++l)s.push(zR(t));a.r=s}else a.r=[{ich:0,ifnt:0}];return t.l=r+e,a}function HR(t,e){var r=!1;return e==null&&(r=!0,e=pe(15+4*t.t.length)),e.write_shift(1,0),fn(t.t,e),r?e.slice(0,e.l):e}var $R=B1;function GR(t,e){var r=!1;return e==null&&(r=!0,e=pe(23+4*t.t.length)),e.write_shift(1,1),fn(t.t,e),e.write_shift(4,1),WR({},e),r?e.slice(0,e.l):e}function ds(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function Ll(t,e){return e==null&&(e=pe(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function Bl(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function jl(t,e){return e==null&&(e=pe(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var KR=$n,GS=fn;function j1(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function Bh(t,e){var r=!1;return e==null&&(r=!0,e=pe(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var XR=$n,Ym=j1,V1=Bh;function U1(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var i=n===0?Lh([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):il(e,0)>>2;return r?i/100:i}function KS(t,e){e==null&&(e=pe(4));var r=0,n=0,i=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?n=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(n=1,r=1),n)e.write_shift(-4,((r?i:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function XS(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function YR(t,e){return e||(e=pe(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var Vl=XS,du=YR;function Hn(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function Al(t,e){return(e||pe(8)).write_shift(8,t,"f")}function qR(t){var e={},r=t.read_shift(1),n=r>>>1,i=t.read_shift(1),s=t.read_shift(2,"i"),a=t.read_shift(1),o=t.read_shift(1),l=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=i;var c=dl[i];c&&(e.rgb=Gf(c));break;case 2:e.rgb=Gf([a,o,l]);break;case 3:e.theme=i;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function jh(t,e){if(e||(e=pe(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function QR(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function JR(t,e){e||(e=pe(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}function YS(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function ZR(t){return YS(t,1)}function eN(t){return YS(t,2)}var z1=2,vi=3,Ed=11,X_=12,Vh=19,wd=64,tN=65,rN=71,nN=4108,iN=4126,on=80,qS=81,sN=[on,qS],qm={1:{n:"CodePage",t:z1},2:{n:"Category",t:on},3:{n:"PresentationFormat",t:on},4:{n:"ByteCount",t:vi},5:{n:"LineCount",t:vi},6:{n:"ParagraphCount",t:vi},7:{n:"SlideCount",t:vi},8:{n:"NoteCount",t:vi},9:{n:"HiddenCount",t:vi},10:{n:"MultimediaClipCount",t:vi},11:{n:"ScaleCrop",t:Ed},12:{n:"HeadingPairs",t:nN},13:{n:"TitlesOfParts",t:iN},14:{n:"Manager",t:on},15:{n:"Company",t:on},16:{n:"LinksUpToDate",t:Ed},17:{n:"CharacterCount",t:vi},19:{n:"SharedDoc",t:Ed},22:{n:"HyperlinksChanged",t:Ed},23:{n:"AppVersion",t:vi,p:"version"},24:{n:"DigSig",t:tN},26:{n:"ContentType",t:on},27:{n:"ContentStatus",t:on},28:{n:"Language",t:on},29:{n:"Version",t:on},255:{},2147483648:{n:"Locale",t:Vh},2147483651:{n:"Behavior",t:Vh},1919054434:{}},Qm={1:{n:"CodePage",t:z1},2:{n:"Title",t:on},3:{n:"Subject",t:on},4:{n:"Author",t:on},5:{n:"Keywords",t:on},6:{n:"Comments",t:on},7:{n:"Template",t:on},8:{n:"LastAuthor",t:on},9:{n:"RevNumber",t:on},10:{n:"EditTime",t:wd},11:{n:"LastPrinted",t:wd},12:{n:"CreatedDate",t:wd},13:{n:"ModifiedDate",t:wd},14:{n:"PageCount",t:vi},15:{n:"WordCount",t:vi},16:{n:"CharCount",t:vi},17:{n:"Thumbnail",t:rN},18:{n:"Application",t:on},19:{n:"DocSecurity",t:vi},255:{},2147483648:{n:"Locale",t:Vh},2147483651:{n:"Behavior",t:Vh},1919054434:{}},Y_={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},aN=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function oN(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var lN=oN([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),dl=fr(lN),za={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},QS={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Jm={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Td={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function W1(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function cN(t){var e=W1();if(!t||!t.match)return e;var r={};if((t.match(Yn)||[]).forEach(function(n){var i=lt(n);switch(i[0].replace(yR,"<")){case"<?xml":break;case"<Types":e.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":e[Jm[i.ContentType]]!==void 0&&e[Jm[i.ContentType]].push(i.PartName);break}}),e.xmlns!==Qr.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}function JS(t,e){var r=cR(Jm),n=[],i;n[n.length]=Br,n[n.length]=Be("Types",null,{xmlns:Qr.CT,"xmlns:xsd":Qr.xsd,"xmlns:xsi":Qr.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return Be("Default",null,{Extension:l[0],ContentType:l[1]})}));var s=function(l){t[l]&&t[l].length>0&&(i=t[l][0],n[n.length]=Be("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:Td[l][e.bookType]||Td[l].xlsx}))},a=function(l){(t[l]||[]).forEach(function(c){n[n.length]=Be("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:Td[l][e.bookType]||Td[l].xlsx})})},o=function(l){(t[l]||[]).forEach(function(c){n[n.length]=Be("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:r[l][0]})})};return s("workbooks"),a("sheets"),a("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),a("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var _t={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function $f(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function df(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(Yn)||[]).forEach(function(i){var s=lt(i);if(s[0]==="<Relationship"){var a={};a.Type=s.Type,a.Target=s.Target,a.Id=s.Id,s.TargetMode&&(a.TargetMode=s.TargetMode);var o=s.TargetMode==="External"?s.Target:Xu(s.Target,e);r[o]=a,n[s.Id]=a}}),r["!id"]=n,r}function Pc(t){var e=[Br,Be("Relationships",null,{xmlns:Qr.RELS})];return Dr(t["!id"]).forEach(function(r){e[e.length]=Be("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function $t(t,e,r,n,i,s){if(i||(i={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,i.Id="rId"+e,i.Type=n,i.Target=r,[_t.HLINK,_t.XPATH,_t.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),t["!id"][i.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][i.Id]=i,t[("/"+i.Target).replace("//","/")]=i,e}var uN="application/vnd.oasis.opendocument.spreadsheet";function fN(t,e){for(var r=D1(t),n,i;n=Hf.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=lt(n[0],!1),i.path=="/"&&i.type!==uN)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}function dN(t){var e=[Br];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function q_(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function hN(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function pN(t){var e=[Br];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(q_(t[r][0],t[r][1])),e.push(hN("",t[r][0]));return e.push(q_("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function ZS(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Nh.version+"</meta:generator></office:meta></office:document-meta>"}var ls=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],gN=function(){for(var t=new Array(ls.length),e=0;e<ls.length;++e){var r=ls[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function eA(t){var e={};t=Qt(t);for(var r=0;r<ls.length;++r){var n=ls[r],i=t.match(gN[r]);i!=null&&i.length>0&&(e[n[1]]=Dt(i[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=ur(e[n[1]]))}return e}function Ag(t,e,r,n,i){i[t]!=null||e==null||e===""||(i[t]=e,e=Gt(e),n[n.length]=r?Be(t,e,r):kn(t,e))}function tA(t,e){var r=e||{},n=[Br,Be("cp:coreProperties",null,{"xmlns:cp":Qr.CORE_PROPS,"xmlns:dc":Qr.dc,"xmlns:dcterms":Qr.dcterms,"xmlns:dcmitype":Qr.dcmitype,"xmlns:xsi":Qr.xsi})],i={};if(!t&&!r.Props)return n.join("");t&&(t.CreatedDate!=null&&Ag("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:Xm(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),t.ModifiedDate!=null&&Ag("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:Xm(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var s=0;s!=ls.length;++s){var a=ls[s],o=r.Props&&r.Props[a[1]]!=null?r.Props[a[1]]:t?t[a[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&Ag(a[0],o,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var hl=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],rA=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function nA(t,e,r,n){var i=[];if(typeof t=="string")i=V_(t,n);else for(var s=0;s<t.length;++s)i=i.concat(t[s].map(function(d){return{v:d}}));var a=typeof e=="string"?V_(e,n).map(function(d){return d.v}):e,o=0,l=0;if(a.length>0)for(var c=0;c!==i.length;c+=2){switch(l=+i[c+1].v,i[c].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=a.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=l,r.DefinedNames=a.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=a.slice(o,o+l);break}o+=l}}function mN(t,e,r){var n={};return e||(e={}),t=Qt(t),hl.forEach(function(i){var s=(t.match(zf(i[0]))||[])[1];switch(i[2]){case"string":s&&(e[i[1]]=Dt(s));break;case"bool":e[i[1]]=s==="true";break;case"raw":var a=t.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));a&&a.length>0&&(n[i[1]]=a[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&nA(n.HeadingPairs,n.TitlesOfParts,e,r),e}function iA(t){var e=[],r=Be;return t||(t={}),t.Application="SheetJS",e[e.length]=Br,e[e.length]=Be("Properties",null,{xmlns:Qr.EXT_PROPS,"xmlns:vt":Qr.vt}),hl.forEach(function(n){if(t[n[1]]!==void 0){var i;switch(n[2]){case"string":i=Gt(String(t[n[1]]));break;case"bool":i=t[n[1]]?"true":"false";break}i!==void 0&&(e[e.length]=r(n[0],i))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+Gt(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var xN=/<[^>]+>[^<]*/g;function vN(t,e){var r={},n="",i=t.match(xN);if(i)for(var s=0;s!=i.length;++s){var a=i[s],o=lt(a);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Dt(o.name);break;case"</property>":n=null;break;default:if(a.indexOf("<vt:")===0){var l=a.split(">"),c=l[0].slice(4),d=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":r[n]=Dt(d);break;case"bool":r[n]=lr(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(d);break;case"filetime":case"date":r[n]=ur(d);break;case"cy":case"error":r[n]=Dt(d);break;default:if(c.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",a,c,l)}}else if(a.slice(0,2)!=="</"){if(e.WTF)throw new Error(a)}}}return r}function sA(t){var e=[Br,Be("Properties",null,{xmlns:Qr.CUST_PROPS,"xmlns:vt":Qr.vt})];if(!t)return e.join("");var r=1;return Dr(t).forEach(function(i){++r,e[e.length]=Be("property",CR(t[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Gt(i)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var Zm={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},kg;function yN(t,e,r){kg||(kg=kp(Zm)),e=kg[e]||e,t[e]=r}function _N(t,e){var r=[];return Dr(Zm).map(function(n){for(var i=0;i<ls.length;++i)if(ls[i][1]==n)return ls[i];for(i=0;i<hl.length;++i)if(hl[i][1]==n)return hl[i];throw n}).forEach(function(n){if(t[n[1]]!=null){var i=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:t[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(kn(Zm[n[1]]||n[1],i))}}),Be("DocumentProperties",r.join(""),{xmlns:Pi.o})}function EN(t,e){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return t&&Dr(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)){for(var a=0;a<ls.length;++a)if(s==ls[a][1])return;for(a=0;a<hl.length;++a)if(s==hl[a][1])return;for(a=0;a<r.length;++a)if(s==r[a])return;var o=t[s],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),i.push(Be(M_(s),o,{"dt:dt":l}))}}),e&&Dr(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)&&!(t&&Object.prototype.hasOwnProperty.call(t,s))){var a=e[s],o="string";typeof a=="number"?(o="float",a=String(a)):a===!0||a===!1?(o="boolean",a=a?"1":"0"):a instanceof Date?(o="dateTime.tz",a=a.toISOString()):a=String(a),i.push(Be(M_(s),a,{"dt:dt":o}))}}),"<"+n+' xmlns="'+Pi.o+'">'+i.join("")+"</"+n+">"}function H1(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function wN(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,n=r%Math.pow(2,32),i=(r-n)/Math.pow(2,32);n*=1e7,i*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),i+=s);var a=pe(8);return a.write_shift(4,n),a.write_shift(4,i),a}function aA(t,e,r){var n=t.l,i=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return i}function oA(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function lA(t,e,r){return e===31?oA(t):aA(t,e,r)}function ex(t,e,r){return lA(t,e,r===!1?0:4)}function TN(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return lA(t,e,0)}function SN(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var i=t.l;r[n]=t.read_shift(0,"lpwstr").replace(ai,""),t.l-i&2&&(t.l+=2)}return r}function AN(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(ai,"");return r}function kN(t){var e=t.l,r=Uh(t,qS);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=Uh(t,vi);return[r,n]}function CN(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(kN(t));return r}function Q_(t,e){for(var r=t.read_shift(4),n={},i=0;i!=r;++i){var s=t.read_shift(4),a=t.read_shift(4);n[s]=t.read_shift(a,e===1200?"utf16le":"utf8").replace(ai,"").replace(Ku,"!"),e===1200&&a%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function cA(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function FN(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function Uh(t,e,r){var n=t.read_shift(2),i,s=r||{};if(t.l+=2,e!==X_&&n!==e&&sN.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===X_?n:e){case 2:return i=t.read_shift(2,"i"),s.raw||(t.l+=2),i;case 3:return i=t.read_shift(4,"i"),i;case 11:return t.read_shift(4)!==0;case 19:return i=t.read_shift(4),i;case 30:return aA(t,n,4).replace(ai,"");case 31:return oA(t);case 64:return H1(t);case 65:return cA(t);case 71:return FN(t);case 80:return ex(t,n,!s.raw).replace(ai,"");case 81:return TN(t,n).replace(ai,"");case 4108:return CN(t);case 4126:case 4127:return n==4127?SN(t):AN(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function J_(t,e){var r=pe(4),n=pe(4);switch(r.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,e);break;case 5:n=pe(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=wN(e);break;case 31:case 80:for(n=pe(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return un([r,n])}function Z_(t,e){var r=t.l,n=t.read_shift(4),i=t.read_shift(4),s=[],a=0,o=0,l=-1,c={};for(a=0;a!=i;++a){var d=t.read_shift(4),h=t.read_shift(4);s[a]=[d,h+r]}s.sort(function(A,_){return A[1]-_[1]});var p={};for(a=0;a!=i;++a){if(t.l!==s[a][1]){var m=!0;if(a>0&&e)switch(e[s[a-1][0]].t){case 2:t.l+2===s[a][1]&&(t.l+=2,m=!1);break;case 80:t.l<=s[a][1]&&(t.l=s[a][1],m=!1);break;case 4108:t.l<=s[a][1]&&(t.l=s[a][1],m=!1);break}if((!e||a==0)&&t.l<=s[a][1]&&(m=!1,t.l=s[a][1]),m)throw new Error("Read Error: Expected address "+s[a][1]+" at "+t.l+" :"+a)}if(e){var y=e[s[a][0]];if(p[y.n]=Uh(t,y.t,{raw:!0}),y.p==="version"&&(p[y.n]=String(p[y.n]>>16)+"."+("0000"+String(p[y.n]&65535)).slice(-4)),y.n=="CodePage")switch(p[y.n]){case 0:p[y.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:As(o=p[y.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+p[y.n])}}else if(s[a][0]===1){if(o=p.CodePage=Uh(t,z1),As(o),l!==-1){var x=t.l;t.l=s[l][1],c=Q_(t,o),t.l=x}}else if(s[a][0]===0){if(o===0){l=a,t.l=s[a+1][1];continue}c=Q_(t,o)}else{var E=c[s[a][0]],T;switch(t[t.l]){case 65:t.l+=4,T=cA(t);break;case 30:t.l+=4,T=ex(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,T=ex(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,T=t.read_shift(4,"i");break;case 19:t.l+=4,T=t.read_shift(4);break;case 5:t.l+=4,T=t.read_shift(8,"f");break;case 11:t.l+=4,T=Pr(t,4);break;case 64:t.l+=4,T=ur(H1(t));break;default:throw new Error("unparsed value: "+t[t.l])}p[E]=T}}return t.l=r+n,p}var uA=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function IN(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function e2(t,e,r){var n=pe(8),i=[],s=[],a=8,o=0,l=pe(8),c=pe(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),s.push(l),i.push(c),a+=8+l.length,!e){c=pe(8),c.write_shift(4,0),i.unshift(c);var d=[pe(4)];for(d[0].write_shift(4,t.length),o=0;o<t.length;++o){var h=t[o][0];for(l=pe(8+2*(h.length+1)+(h.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,h.length+1),l.write_shift(0,h,"dbcs");l.l!=l.length;)l.write_shift(1,0);d.push(l)}l=un(d),s.unshift(l),a+=8+l.length}for(o=0;o<t.length;++o)if(!(e&&!e[t[o][0]])&&!(uA.indexOf(t[o][0])>-1||rA.indexOf(t[o][0])>-1)&&t[o][1]!=null){var p=t[o][1],m=0;if(e){m=+e[t[o][0]];var y=r[m];if(y.p=="version"&&typeof p=="string"){var x=p.split(".");p=(+x[0]<<16)+(+x[1]||0)}l=J_(y.t,p)}else{var E=IN(p);E==-1&&(E=31,p=String(p)),l=J_(E,p)}s.push(l),c=pe(8),c.write_shift(4,e?m:2+o),i.push(c),a+=8+l.length}var T=8*(s.length+1);for(o=0;o<s.length;++o)i[o].write_shift(4,T),T+=s[o].length;return n.write_shift(4,a),n.write_shift(4,s.length),un([n].concat(i).concat(s))}function t2(t,e,r){var n=t.content;if(!n)return{};An(n,0);var i,s,a,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),d=n.read_shift(16);if(d!==tt.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(s=n.read_shift(16),o=n.read_shift(4),i===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);i===2&&(a=n.read_shift(16),l=n.read_shift(4));var h=Z_(n,e),p={SystemIdentifier:c};for(var m in h)p[m]=h[m];if(p.FMTID=s,i===1)return p;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var y;try{y=Z_(n,null)}catch{}for(m in y)p[m]=y[m];return p.FMTID=[s,a],p}function r2(t,e,r,n,i,s){var a=pe(i?68:48),o=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,tt.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,i?2:1),a.write_shift(16,e,"hex"),a.write_shift(4,i?68:48);var l=e2(t,r,n);if(o.push(l),i){var c=e2(i,null,null);a.write_shift(16,s,"hex"),a.write_shift(4,68+l.length),o.push(c)}return un(o)}function to(t,e){return t.read_shift(e),null}function bN(t,e){e||(e=pe(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function RN(t,e,r){for(var n=[],i=t.l+e;t.l<i;)n.push(r(t,i-t.l));if(i!==t.l)throw new Error("Slurp error");return n}function Pr(t,e){return t.read_shift(e)===1}function ii(t,e){return e||(e=pe(2)),e.write_shift(2,+!!t),e}function Wr(t){return t.read_shift(2,"u")}function rs(t,e){return e||(e=pe(2)),e.write_shift(2,t),e}function fA(t,e){return RN(t,e,Wr)}function NN(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function dA(t,e,r){return r||(r=pe(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function m0(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=t.read_shift(1);s&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var a=n?t.read_shift(n,i):"";return a}function DN(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,i=r&8,s=1+(r&1),a=0,o,l={};i&&(a=t.read_shift(2)),n&&(o=t.read_shift(4));var c=s==2?"dbcs-cont":"sbcs-cont",d=e===0?"":t.read_shift(e,c);return i&&(t.l+=4*a),n&&(t.l+=o),l.t=d,i||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function PN(t){var e=t.t||"",r=pe(3);r.write_shift(2,e.length),r.write_shift(1,1);var n=pe(2*e.length);n.write_shift(2*e.length,e,"utf16le");var i=[r,n];return un(i)}function kl(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var i=t.read_shift(1);return i===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function x0(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):kl(t,n,r)}function Ul(t,e,r){if(r.biff>5)return x0(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function hA(t,e,r){return r||(r=pe(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function ON(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function MN(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var i=t.read_shift((n?e-24:e)>>1,"utf16le").replace(ai,"");return n&&(t.l+=24),i}function LN(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=t.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var s=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var a=t.read_shift(s>>1,"utf16le").replace(ai,"");return r+a}function BN(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return MN(t);case"0303000000000000c000000000000046":return LN(t);default:throw new Error("Unsupported Moniker "+r)}}function Sd(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(ai,""):"";return r}function n2(t,e){e||(e=pe(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function jN(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=t.read_shift(2);t.l+=2;var s,a,o,l,c="",d,h;i&16&&(s=Sd(t,r-t.l)),i&128&&(a=Sd(t,r-t.l)),(i&257)===257&&(o=Sd(t,r-t.l)),(i&257)===1&&(l=BN(t,r-t.l)),i&8&&(c=Sd(t,r-t.l)),i&32&&(d=t.read_shift(16)),i&64&&(h=H1(t)),t.l=r;var p=a||o||l||"";p&&c&&(p+="#"+c),p||(p="#"+c),i&2&&p.charAt(0)=="/"&&p.charAt(1)!="/"&&(p="file://"+p);var m={Target:p};return d&&(m.guid=d),h&&(m.time=h),s&&(m.Tooltip=s),m}function VN(t){var e=pe(512),r=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),s=i>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}e.write_shift(4,2),e.write_shift(4,s);var a=[8,6815827,6619237,4849780,83];for(r=0;r<a.length;++r)e.write_shift(4,a[r]);if(s==28)n=n.slice(1),n2(n,e);else if(s&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<a.length;++r)e.write_shift(1,parseInt(a[r],16));var o=i>-1?n.slice(0,i):n;for(e.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)e.write_shift(2,o.charCodeAt(r));e.write_shift(2,0),s&8&&n2(i>-1?n.slice(i+1):"",e)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<a.length;++r)e.write_shift(1,parseInt(a[r],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(e.write_shift(2,l),e.write_shift(4,n.length-3*l+1),r=0;r<n.length-3*l;++r)e.write_shift(1,n.charCodeAt(r+3*l)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function pA(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),i=t.read_shift(1);return[e,r,n,i]}function gA(t,e){var r=pA(t);return r[3]=0,r}function sa(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function Cl(t,e,r,n){return n||(n=pe(6)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r||0),n}function UN(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function zN(t,e,r){return e===0?"":Ul(t,e,r)}function WN(t,e,r){var n=r.biff>8?4:2,i=t.read_shift(n),s=t.read_shift(n,"i"),a=t.read_shift(n,"i");return[i,s,a]}function mA(t){var e=t.read_shift(2),r=U1(t);return[e,r]}function HN(t,e,r){t.l+=4,e-=4;var n=t.l+e,i=m0(t,e,r),s=t.read_shift(2);if(n-=t.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return t.l+=s,i}function Ip(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2);return{s:{c:n,r:e},e:{c:i,r}}}function xA(t,e){return e||(e=pe(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function vA(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),i=t.read_shift(1);return{s:{c:n,r:e},e:{c:i,r}}}var $N=vA;function yA(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function GN(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function KN(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function Mn(t){t.l+=2,t.l+=t.read_shift(2)}var XN={0:Mn,4:Mn,5:Mn,6:Mn,7:KN,8:Mn,9:Mn,10:Mn,11:Mn,12:Mn,13:GN,14:Mn,15:Mn,16:Mn,17:Mn,18:Mn,19:Mn,20:Mn,21:yA};function YN(t,e){for(var r=t.l+e,n=[];t.l<r;){var i=t.read_shift(2);t.l-=2;try{n.push(XN[i](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function Ad(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function $1(t,e,r){var n=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=pe(i);return s.write_shift(2,n),s.write_shift(2,e),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function qN(t,e){return e===0||t.read_shift(2),1200}function QN(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,i=Ul(t,0,r);return t.read_shift(e+n-t.l),i}function JN(t,e){var r=!e||e.biff==8,n=pe(r?112:54);for(n.write_shift(e.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function ZN(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function e3(t,e,r){var n=t.read_shift(4),i=t.read_shift(1)&3,s=t.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var a=m0(t,0,r);return a.length===0&&(a="Sheet1"),{pos:n,hs:i,dt:s,name:a}}function t3(t,e){var r=!e||e.biff>=8?2:1,n=pe(8+r*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function r3(t,e){for(var r=t.l+e,n=t.read_shift(4),i=t.read_shift(4),s=[],a=0;a!=i&&t.l<r;++a)s.push(DN(t));return s.Count=n,s.Unique=i,s}function n3(t,e){var r=pe(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var n=[],i=0;i<t.length;++i)n[i]=PN(t[i]);var s=un([r].concat(n));return s.parts=[r.length].concat(n.map(function(a){return a.length})),s}function i3(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function s3(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function a3(t){var e=UN(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function o3(t){return t.read_shift(2),t.read_shift(4)}function i2(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var i=t.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,i]}function l3(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2),l=t.read_shift(2),c=t.read_shift(2);return{Pos:[e,r],Dim:[n,i],Flags:s,CurTab:a,FirstTab:o,Selected:l,TabRatio:c}}function c3(){var t=pe(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function u3(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function f3(t){var e=pe(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function d3(){}function h3(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=m0(t,0,r),n}function p3(t,e){var r=t.name||"Arial",n=e&&e.biff==5,i=n?15+r.length:16+2*r.length,s=pe(i);return s.write_shift(2,t.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function g3(t){var e=sa(t);return e.isst=t.read_shift(4),e}function m3(t,e,r,n){var i=pe(10);return Cl(t,e,n,i),i.write_shift(4,r),i}function x3(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,i=sa(t);r.biff==2&&t.l++;var s=x0(t,n-t.l,r);return i.val=s,i}function v3(t,e,r,n,i){var s=!i||i.biff==8,a=pe(8+ +s+(1+s)*r.length);return Cl(t,e,n,a),a.write_shift(2,r.length),s&&a.write_shift(1,1),a.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),a}function y3(t,e,r){var n=t.read_shift(2),i=Ul(t,0,r);return[n,i]}function _3(t,e,r,n){var i=r&&r.biff==5;n||(n=pe(i?3+e.length:5+2*e.length)),n.write_shift(2,t),n.write_shift(i?1:2,e.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}var E3=Ul;function s2(t,e,r){var n=t.l+e,i=r.biff==8||!r.biff?4:2,s=t.read_shift(i),a=t.read_shift(i),o=t.read_shift(2),l=t.read_shift(2);return t.l=n,{s:{r:s,c:o},e:{r:a,c:l}}}function w3(t,e){var r=e.biff==8||!e.biff?4:2,n=pe(2*r+6);return n.write_shift(r,t.s.r),n.write_shift(r,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function T3(t){var e=t.read_shift(2),r=t.read_shift(2),n=mA(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function S3(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),s=[];t.l<r;)s.push(mA(t));if(t.l!==r)throw new Error("MulRK read error");var a=t.read_shift(2);if(s.length!=a-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:a,rkrec:s}}function A3(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),s=[];t.l<r;)s.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var a=t.read_shift(2);if(s.length!=a-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:a,ixfe:s}}function k3(t,e,r,n){var i={},s=t.read_shift(4),a=t.read_shift(4),o=t.read_shift(4),l=t.read_shift(2);return i.patternType=aN[o>>26],n.cellStyles&&(i.alc=s&7,i.fWrap=s>>3&1,i.alcV=s>>4&7,i.fJustLast=s>>7&1,i.trot=s>>8&255,i.cIndent=s>>16&15,i.fShrinkToFit=s>>20&1,i.iReadOrder=s>>22&2,i.fAtrNum=s>>26&1,i.fAtrFnt=s>>27&1,i.fAtrAlc=s>>28&1,i.fAtrBdr=s>>29&1,i.fAtrPat=s>>30&1,i.fAtrProt=s>>31&1,i.dgLeft=a&15,i.dgRight=a>>4&15,i.dgTop=a>>8&15,i.dgBottom=a>>12&15,i.icvLeft=a>>16&127,i.icvRight=a>>23&127,i.grbitDiag=a>>30&3,i.icvTop=o&127,i.icvBottom=o>>7&127,i.icvDiag=o>>14&127,i.dgDiag=o>>21&15,i.icvFore=l&127,i.icvBack=l>>7&127,i.fsxButton=l>>14&1),i}function C3(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=k3(t,e,n.fStyle,r),n}function a2(t,e,r,n){var i=r&&r.biff==5;n||(n=pe(i?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,e<<4));var s=0;return t.numFmtId>0&&i&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function F3(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function I3(t){var e=pe(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function o2(t,e,r){var n=sa(t);(r.biff==2||e==9)&&++t.l;var i=NN(t);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function b3(t,e,r,n,i,s){var a=pe(8);return Cl(t,e,n,a),dA(r,s,a),a}function R3(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=sa(t),i=Hn(t);return n.val=i,n}function N3(t,e,r,n){var i=pe(14);return Cl(t,e,n,i),Al(r,i),i}var l2=zN;function D3(t,e,r){var n=t.l+e,i=t.read_shift(2),s=t.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,i];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var a=kl(t,s),o=[];n>t.l;)o.push(x0(t));return[s,i,a,o]}function c2(t,e,r){var n=t.read_shift(2),i,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=HN(t,e-2,r)),s.body=i||t.read_shift(e-2),typeof i=="string"&&(s.Name=i),s}var P3=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function u2(t,e,r){var n=t.l+e,i=t.read_shift(2),s=t.read_shift(1),a=t.read_shift(1),o=t.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),l=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var c=kl(t,a,r);i&32&&(c=P3[c.charCodeAt(0)]);var d=n-t.l;r&&r.biff==2&&--d;var h=n==t.l||o===0||!(d>0)?[]:Y8(t,d,r,o);return{chKey:s,Name:c,itab:l,rgce:h}}function _A(t,e,r){if(r.biff<8)return O3(t,e,r);for(var n=[],i=t.l+e,s=t.read_shift(r.biff>8?4:2);s--!==0;)n.push(WN(t,r.biff>8?12:6,r));if(t.l!=i)throw new Error("Bad ExternSheet: "+t.l+" != "+i);return n}function O3(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=m0(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function M3(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),i=t.read_shift(2),s=kl(t,n,r),a=kl(t,i,r);return[s,a]}function L3(t,e,r){var n=vA(t);t.l++;var i=t.read_shift(1);return e-=8,[q8(t,e,r),i,n]}function f2(t,e,r){var n=$N(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,K8(t,e,r)]}function B3(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function j3(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),o=Ul(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:i},o,a,s]}}function V3(t,e,r){return j3(t,e,r)}function U3(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(Ip(t));return r}function z3(t){var e=pe(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)xA(t[r],e);return e}function W3(t,e,r){if(r&&r.biff<8)return $3(t,e,r);var n=yA(t),i=YN(t,e-22,n[1]);return{cmo:n,ft:i}}var H3={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var i=t.read_shift(1);return t.l+=i,t.l=r,{fmt:n}}};function $3(t,e,r){t.l+=4;var n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var a=[];return a.push((H3[n]||Kn)(t,e,r)),{cmo:[i,n,s],ft:a}}function G3(t,e,r){var n=t.l,i="";try{t.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],a;[0,5,7,11,12,14].indexOf(s)==-1?t.l+=6:a=ON(t,6,r);var o=t.read_shift(2);t.read_shift(2),Wr(t,2);var l=t.read_shift(2);t.l+=l;for(var c=1;c<t.lens.length-1;++c){if(t.l-n!=t.lens[c])throw new Error("TxO: bad continue record");var d=t[t.l],h=kl(t,t.lens[c+1]-t.lens[c]-1);if(i+=h,i.length>=(d?o:2*o))break}if(i.length!==o&&i.length!==o*2)throw new Error("cchText: "+o+" != "+i.length);return t.l=n+e,{t:i}}catch{return t.l=n+e,{t:i}}}function K3(t,e){var r=Ip(t);t.l+=16;var n=jN(t,e-24);return[r,n]}function X3(t){var e=pe(24),r=Sr(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)e.write_shift(1,parseInt(n[i],16));return un([e,VN(t[1])])}function Y3(t,e){t.read_shift(2);var r=Ip(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(ai,""),[r,n]}function q3(t){var e=t[1].Tooltip,r=pe(10+2*(e.length+1));r.write_shift(2,2048);var n=Sr(t[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<e.length;++i)r.write_shift(2,e.charCodeAt(i));return r.write_shift(2,0),r}function Q3(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=Y_[r]||r,r=t.read_shift(2),e[1]=Y_[r]||r,e}function J3(t){return t||(t=pe(4)),t.write_shift(2,1),t.write_shift(2,1),t}function Z3(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(gA(t));return r}function eD(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(gA(t));return r}function tD(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function EA(t,e,r){if(!r.cellStyles)return Kn(t,e);var n=r&&r.biff>=12?4:2,i=t.read_shift(n),s=t.read_shift(n),a=t.read_shift(n),o=t.read_shift(n),l=t.read_shift(2);n==2&&(t.l+=2);var c={s:i,e:s,w:a,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function rD(t,e){var r=pe(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var n=0;return t.hidden&&(n|=1),r.write_shift(1,n),n=t.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function nD(t,e){var r={};return e<32||(t.l+=16,r.header=Hn(t),r.footer=Hn(t),t.l+=2),r}function iD(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var i=t.read_shift(1);return t.l+=3,i&16&&(n.area=!0),n}function sD(t){for(var e=pe(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}var aD=sa,oD=fA,lD=x0;function cD(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,i}function uD(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=sa(t);++t.l;var i=Ul(t,e-7,r);return n.t="str",n.val=i,n}function fD(t){var e=sa(t);++t.l;var r=Hn(t);return e.t="n",e.val=r,e}function dD(t,e,r){var n=pe(15);return E0(n,t,e),n.write_shift(8,r,"f"),n}function hD(t){var e=sa(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function pD(t,e,r){var n=pe(9);return E0(n,t,e),n.write_shift(2,r),n}function gD(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function mD(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function xD(t,e,r){var n=t.l+e,i=sa(t),s=t.read_shift(2),a=kl(t,s,r);return t.l=n,i.t="str",i.val=a,i}var vD=[2,3,48,49,131,139,140,245],tx=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=kp({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var c=[],d=Do(1);switch(l.type){case"base64":d=Mi(zi(o));break;case"binary":d=Mi(o);break;case"buffer":case"array":d=o;break}An(d,0);var h=d.read_shift(1),p=!!(h&136),m=!1,y=!1;switch(h){case 2:break;case 3:break;case 48:m=!0,p=!0;break;case 49:m=!0,p=!0;break;case 131:break;case 139:break;case 140:y=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var x=0,E=521;h==2&&(x=d.read_shift(2)),d.l+=3,h!=2&&(x=d.read_shift(4)),x>1048576&&(x=1e6),h!=2&&(E=d.read_shift(2));var T=d.read_shift(2),A=l.codepage||1252;h!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(A=t[d[d.l]]),d.l+=1,d.l+=2),y&&(d.l+=36);for(var _=[],P={},W=Math.min(d.length,h==2?521:E-10-(m?264:0)),B=y?32:11;d.l<W&&d[d.l]!=13;)switch(P={},P.name=jf.utils.decode(A,d.slice(d.l,d.l+B)).replace(/[\u0000\r\n].*$/g,""),d.l+=B,P.type=String.fromCharCode(d.read_shift(1)),h!=2&&!y&&(P.offset=d.read_shift(4)),P.len=d.read_shift(1),h==2&&(P.offset=d.read_shift(2)),P.dec=d.read_shift(1),P.name.length&&_.push(P),h!=2&&(d.l+=y?13:14),P.type){case"B":(!m||P.len!=8)&&l.WTF&&console.log("Skipping "+P.name+":"+P.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+P.name+":"+P.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+P.type)}if(d[d.l]!==13&&(d.l=E-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=E;var w=0,F=0;for(c[0]=[],F=0;F!=_.length;++F)c[0][F]=_[F].name;for(;x-- >0;){if(d[d.l]===42){d.l+=T;continue}for(++d.l,c[++w]=[],F=0,F=0;F!=_.length;++F){var S=d.slice(d.l,d.l+_[F].len);d.l+=_[F].len,An(S,0);var b=jf.utils.decode(A,S);switch(_[F].type){case"C":b.trim().length&&(c[w][F]=b.replace(/\s+$/,""));break;case"D":b.length===8?c[w][F]=new Date(+b.slice(0,4),+b.slice(4,6)-1,+b.slice(6,8)):c[w][F]=b;break;case"F":c[w][F]=parseFloat(b.trim());break;case"+":case"I":c[w][F]=y?S.read_shift(-4,"i")^2147483648:S.read_shift(4,"i");break;case"L":switch(b.trim().toUpperCase()){case"Y":case"T":c[w][F]=!0;break;case"N":case"F":c[w][F]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+b+"|")}break;case"M":if(!p)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));c[w][F]="##MEMO##"+(y?parseInt(b.trim(),10):S.read_shift(4));break;case"N":b=b.replace(/\u0000/g,"").trim(),b&&b!="."&&(c[w][F]=+b||0);break;case"@":c[w][F]=new Date(S.read_shift(-8,"f")-621356832e5);break;case"T":c[w][F]=new Date((S.read_shift(4)-2440588)*864e5+S.read_shift(4));break;case"Y":c[w][F]=S.read_shift(4,"i")/1e4+S.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[w][F]=-S.read_shift(-8,"f");break;case"B":if(m&&_[F].len==8){c[w][F]=S.read_shift(8,"f");break}case"G":case"P":S.l+=_[F].len;break;case"0":if(_[F].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+_[F].type)}}}if(h!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=_,c}function n(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var d=fu(r(o,c),c);return d["!cols"]=c.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete c.DBF,d}function i(o,l){try{return Ho(n(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,l){var c=l||{};if(+c.codepage>=0&&As(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var d=Si(),h=Hh(o,{header:1,raw:!0,cellDates:!0}),p=h[0],m=h.slice(1),y=o["!cols"]||[],x=0,E=0,T=0,A=1;for(x=0;x<p.length;++x){if(((y[x]||{}).DBF||{}).name){p[x]=y[x].DBF.name,++T;continue}if(p[x]!=null){if(++T,typeof p[x]=="number"&&(p[x]=p[x].toString(10)),typeof p[x]!="string")throw new Error("DBF Invalid column name "+p[x]+" |"+typeof p[x]+"|");if(p.indexOf(p[x])!==x){for(E=0;E<1024;++E)if(p.indexOf(p[x]+"_"+E)==-1){p[x]+="_"+E;break}}}}var _=Pt(o["!ref"]),P=[],W=[],B=[];for(x=0;x<=_.e.c-_.s.c;++x){var w="",F="",S=0,b=[];for(E=0;E<m.length;++E)m[E][x]!=null&&b.push(m[E][x]);if(b.length==0||p[x]==null){P[x]="?";continue}for(E=0;E<b.length;++E){switch(typeof b[E]){case"number":F="B";break;case"string":F="C";break;case"boolean":F="L";break;case"object":F=b[E]instanceof Date?"D":"C";break;default:F="C"}S=Math.max(S,String(b[E]).length),w=w&&w!=F?"C":F}S>250&&(S=250),F=((y[x]||{}).DBF||{}).type,F=="C"&&y[x].DBF.len>S&&(S=y[x].DBF.len),w=="B"&&F=="N"&&(w="N",B[x]=y[x].DBF.dec,S=y[x].DBF.len),W[x]=w=="C"||F=="N"?S:s[w]||0,A+=W[x],P[x]=w}var N=d.next(32);for(N.write_shift(4,318902576),N.write_shift(4,m.length),N.write_shift(2,296+32*T),N.write_shift(2,A),x=0;x<4;++x)N.write_shift(4,0);for(N.write_shift(4,0|(+e[uS]||3)<<8),x=0,E=0;x<p.length;++x)if(p[x]!=null){var D=d.next(32),R=(p[x].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);D.write_shift(1,R,"sbcs"),D.write_shift(1,P[x]=="?"?"C":P[x],"sbcs"),D.write_shift(4,E),D.write_shift(1,W[x]||s[P[x]]||0),D.write_shift(1,B[x]||0),D.write_shift(1,2),D.write_shift(4,0),D.write_shift(1,0),D.write_shift(4,0),D.write_shift(4,0),E+=W[x]||s[P[x]]||0}var Ue=d.next(264);for(Ue.write_shift(4,13),x=0;x<65;++x)Ue.write_shift(4,0);for(x=0;x<m.length;++x){var me=d.next(A);for(me.write_shift(1,0),E=0;E<p.length;++E)if(p[E]!=null)switch(P[E]){case"L":me.write_shift(1,m[x][E]==null?63:m[x][E]?84:70);break;case"B":me.write_shift(8,m[x][E]||0,"f");break;case"N":var Ie="0";for(typeof m[x][E]=="number"&&(Ie=m[x][E].toFixed(B[E]||0)),T=0;T<W[E]-Ie.length;++T)me.write_shift(1,32);me.write_shift(1,Ie,"sbcs");break;case"D":m[x][E]?(me.write_shift(4,("0000"+m[x][E].getFullYear()).slice(-4),"sbcs"),me.write_shift(2,("00"+(m[x][E].getMonth()+1)).slice(-2),"sbcs"),me.write_shift(2,("00"+m[x][E].getDate()).slice(-2),"sbcs")):me.write_shift(8,"00000000","sbcs");break;case"C":var Te=String(m[x][E]!=null?m[x][E]:"").slice(0,W[E]);for(me.write_shift(1,Te,"sbcs"),T=0;T<W[E]-Te.length;++T)me.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:i,to_sheet:n,from_sheet:a}}(),wA=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Dr(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(p,m){var y=t[m];return typeof y=="number"?w_(y):y},n=function(p,m,y){var x=m.charCodeAt(0)-32<<4|y.charCodeAt(0)-48;return x==59?p:w_(x)};t["|"]=254;function i(p,m){switch(m.type){case"base64":return s(zi(p),m);case"binary":return s(p,m);case"buffer":return s(yt&&Buffer.isBuffer(p)?p.toString("binary"):Wo(p),m);case"array":return s(Sl(p),m)}throw new Error("Unrecognized type "+m.type)}function s(p,m){var y=p.split(/[\n\r]+/),x=-1,E=-1,T=0,A=0,_=[],P=[],W=null,B={},w=[],F=[],S=[],b=0,N;for(+m.codepage>=0&&As(+m.codepage);T!==y.length;++T){b=0;var D=y[T].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),R=D.replace(/;;/g,"\0").split(";").map(function(Y){return Y.replace(/\u0000/g,";")}),Ue=R[0],me;if(D.length>0)switch(Ue){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":R[1].charAt(0)=="P"&&P.push(D.slice(3).replace(/;;/g,";"));break;case"C":var Ie=!1,Te=!1,_e=!1,Q=!1,ke=-1,Le=-1;for(A=1;A<R.length;++A)switch(R[A].charAt(0)){case"A":break;case"X":E=parseInt(R[A].slice(1))-1,Te=!0;break;case"Y":for(x=parseInt(R[A].slice(1))-1,Te||(E=0),N=_.length;N<=x;++N)_[N]=[];break;case"K":me=R[A].slice(1),me.charAt(0)==='"'?me=me.slice(1,me.length-1):me==="TRUE"?me=!0:me==="FALSE"?me=!1:isNaN(bs(me))?isNaN(Xc(me).getDate())||(me=ur(me)):(me=bs(me),W!==null&&cu(W)&&(me=Fp(me))),Ie=!0;break;case"E":Q=!0;var j=Oc(R[A].slice(1),{r:x,c:E});_[x][E]=[_[x][E],j];break;case"S":_e=!0,_[x][E]=[_[x][E],"S5S"];break;case"G":break;case"R":ke=parseInt(R[A].slice(1))-1;break;case"C":Le=parseInt(R[A].slice(1))-1;break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+D)}if(Ie&&(_[x][E]&&_[x][E].length==2?_[x][E][0]=me:_[x][E]=me,W=null),_e){if(Q)throw new Error("SYLK shared formula cannot have own formula");var H=ke>-1&&_[ke][Le];if(!H||!H[1])throw new Error("SYLK shared formula cannot find base");_[x][E][1]=VA(H[1],{r:x-ke,c:E-Le})}break;case"F":var q=0;for(A=1;A<R.length;++A)switch(R[A].charAt(0)){case"X":E=parseInt(R[A].slice(1))-1,++q;break;case"Y":for(x=parseInt(R[A].slice(1))-1,N=_.length;N<=x;++N)_[N]=[];break;case"M":b=parseInt(R[A].slice(1))/20;break;case"F":break;case"G":break;case"P":W=P[parseInt(R[A].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(S=R[A].slice(1).split(" "),N=parseInt(S[0],10);N<=parseInt(S[1],10);++N)b=parseInt(S[2],10),F[N-1]=b===0?{hidden:!0}:{wch:b},Po(F[N-1]);break;case"C":E=parseInt(R[A].slice(1))-1,F[E]||(F[E]={});break;case"R":x=parseInt(R[A].slice(1))-1,w[x]||(w[x]={}),b>0?(w[x].hpt=b,w[x].hpx=qc(b)):b===0&&(w[x].hidden=!0);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+D)}q<1&&(W=null);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+D)}}return w.length>0&&(B["!rows"]=w),F.length>0&&(B["!cols"]=F),m&&m.sheetRows&&(_=_.slice(0,m.sheetRows)),[_,B]}function a(p,m){var y=i(p,m),x=y[0],E=y[1],T=fu(x,m);return Dr(E).forEach(function(A){T[A]=E[A]}),T}function o(p,m){return Ho(a(p,m),m)}function l(p,m,y,x){var E="C;Y"+(y+1)+";X"+(x+1)+";K";switch(p.t){case"n":E+=p.v||0,p.f&&!p.F&&(E+=";E"+Q1(p.f,{r:y,c:x}));break;case"b":E+=p.v?"TRUE":"FALSE";break;case"e":E+=p.w||p.v;break;case"d":E+='"'+(p.w||p.v)+'"';break;case"s":E+='"'+p.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return E}function c(p,m){m.forEach(function(y,x){var E="F;W"+(x+1)+" "+(x+1)+" ";y.hidden?E+="0":(typeof y.width=="number"&&!y.wpx&&(y.wpx=Kf(y.width)),typeof y.wpx=="number"&&!y.wch&&(y.wch=Xf(y.wpx)),typeof y.wch=="number"&&(E+=Math.round(y.wch))),E.charAt(E.length-1)!=" "&&p.push(E)})}function d(p,m){m.forEach(function(y,x){var E="F;";y.hidden?E+="M0;":y.hpt?E+="M"+20*y.hpt+";":y.hpx&&(E+="M"+20*Yf(y.hpx)+";"),E.length>2&&p.push(E+"R"+(x+1))})}function h(p,m){var y=["ID;PWXL;N;E"],x=[],E=Pt(p["!ref"]),T,A=Array.isArray(p),_=`\r
`;y.push("P;PGeneral"),y.push("F;P0;DG0G8;M255"),p["!cols"]&&c(y,p["!cols"]),p["!rows"]&&d(y,p["!rows"]),y.push("B;Y"+(E.e.r-E.s.r+1)+";X"+(E.e.c-E.s.c+1)+";D"+[E.s.c,E.s.r,E.e.c,E.e.r].join(" "));for(var P=E.s.r;P<=E.e.r;++P)for(var W=E.s.c;W<=E.e.c;++W){var B=ot({r:P,c:W});T=A?(p[P]||[])[W]:p[B],!(!T||T.v==null&&(!T.f||T.F))&&x.push(l(T,p,P,W))}return y.join(_)+_+x.join(_)+_+"E"+_}return{to_workbook:o,to_sheet:a,from_sheet:h}}(),TA=function(){function t(s,a){switch(a.type){case"base64":return e(zi(s),a);case"binary":return e(s,a);case"buffer":return e(yt&&Buffer.isBuffer(s)?s.toString("binary"):Wo(s),a);case"array":return e(Sl(s),a)}throw new Error("Unrecognized type "+a.type)}function e(s,a){for(var o=s.split(`
`),l=-1,c=-1,d=0,h=[];d!==o.length;++d){if(o[d].trim()==="BOT"){h[++l]=[],c=0;continue}if(!(l<0)){var p=o[d].trim().split(","),m=p[0],y=p[1];++d;for(var x=o[d]||"";(x.match(/["]/g)||[]).length&1&&d<o.length-1;)x+=`
`+o[++d];switch(x=x.trim(),+m){case-1:if(x==="BOT"){h[++l]=[],c=0;continue}else if(x!=="EOD")throw new Error("Unrecognized DIF special command "+x);break;case 0:x==="TRUE"?h[l][c]=!0:x==="FALSE"?h[l][c]=!1:isNaN(bs(y))?isNaN(Xc(y).getDate())?h[l][c]=y:h[l][c]=ur(y):h[l][c]=bs(y),++c;break;case 1:x=x.slice(1,x.length-1),x=x.replace(/""/g,'"'),x&&x.match(/^=".*"$/)&&(x=x.slice(2,-1)),h[l][c++]=x!==""?x:null;break}if(x==="EOD")break}}return a&&a.sheetRows&&(h=h.slice(0,a.sheetRows)),h}function r(s,a){return fu(t(s,a),a)}function n(s,a){return Ho(r(s,a),a)}var i=function(){var s=function(l,c,d,h,p){l.push(c),l.push(d+","+h),l.push('"'+p.replace(/"/g,'""')+'"')},a=function(l,c,d,h){l.push(c+","+d),l.push(c==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(l){var c=[],d=Pt(l["!ref"]),h,p=Array.isArray(l);s(c,"TABLE",0,1,"sheetjs"),s(c,"VECTORS",0,d.e.r-d.s.r+1,""),s(c,"TUPLES",0,d.e.c-d.s.c+1,""),s(c,"DATA",0,0,"");for(var m=d.s.r;m<=d.e.r;++m){a(c,-1,0,"BOT");for(var y=d.s.c;y<=d.e.c;++y){var x=ot({r:m,c:y});if(h=p?(l[m]||[])[y]:l[x],!h){a(c,1,0,"");continue}switch(h.t){case"n":var E=h.w;!E&&h.v!=null&&(E=h.v),E==null?h.f&&!h.F?a(c,1,0,"="+h.f):a(c,1,0,""):a(c,0,E,"V");break;case"b":a(c,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":a(c,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=fs(h.z||at[14],tn(ur(h.v)))),a(c,0,h.w,"V");break;default:a(c,1,0,"")}}}a(c,-1,0,"EOD");var T=`\r
`,A=c.join(T);return A}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),SA=function(){function t(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(h,p){for(var m=h.split(`
`),y=-1,x=-1,E=0,T=[];E!==m.length;++E){var A=m[E].trim().split(":");if(A[0]==="cell"){var _=Sr(A[1]);if(T.length<=_.r)for(y=T.length;y<=_.r;++y)T[y]||(T[y]=[]);switch(y=_.r,x=_.c,A[2]){case"t":T[y][x]=t(A[3]);break;case"v":T[y][x]=+A[3];break;case"vtf":var P=A[A.length-1];case"vtc":switch(A[3]){case"nl":T[y][x]=!!+A[4];break;default:T[y][x]=+A[4];break}A[2]=="vtf"&&(T[y][x]=[T[y][x],P])}}}return p&&p.sheetRows&&(T=T.slice(0,p.sheetRows)),T}function n(h,p){return fu(r(h,p),p)}function i(h,p){return Ho(n(h,p),p)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(h){if(!h||!h["!ref"])return"";for(var p=[],m=[],y,x="",E=Ai(h["!ref"]),T=Array.isArray(h),A=E.s.r;A<=E.e.r;++A)for(var _=E.s.c;_<=E.e.c;++_)if(x=ot({r:A,c:_}),y=T?(h[A]||[])[_]:h[x],!(!y||y.v==null||y.t==="z")){switch(m=["cell",x,"t"],y.t){case"s":case"str":m.push(e(y.v));break;case"n":y.f?(m[2]="vtf",m[3]="n",m[4]=y.v,m[5]=e(y.f)):(m[2]="v",m[3]=y.v);break;case"b":m[2]="vt"+(y.f?"f":"c"),m[3]="nl",m[4]=y.v?"1":"0",m[5]=e(y.f||(y.v?"TRUE":"FALSE"));break;case"d":var P=tn(ur(y.v));m[2]="vtc",m[3]="nd",m[4]=""+P,m[5]=y.w||fs(y.z||at[14],P);break;case"e":continue}p.push(m.join(":"))}return p.push("sheet:c:"+(E.e.c-E.s.c+1)+":r:"+(E.e.r-E.s.r+1)+":tvf:1"),p.push("valueformat:1:text-wiki"),p.join(`
`)}function d(h){return[s,a,o,a,c(h),l].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:d}}(),Yc=function(){function t(d,h,p,m,y){y.raw?h[p][m]=d:d===""||(d==="TRUE"?h[p][m]=!0:d==="FALSE"?h[p][m]=!1:isNaN(bs(d))?isNaN(Xc(d).getDate())?h[p][m]=d:h[p][m]=ur(d):h[p][m]=bs(d))}function e(d,h){var p=h||{},m=[];if(!d||d.length===0)return m;for(var y=d.split(/[\r\n]/),x=y.length-1;x>=0&&y[x].length===0;)--x;for(var E=10,T=0,A=0;A<=x;++A)T=y[A].indexOf(" "),T==-1?T=y[A].length:T++,E=Math.max(E,T);for(A=0;A<=x;++A){m[A]=[];var _=0;for(t(y[A].slice(0,E).trim(),m,A,_,p),_=1;_<=(y[A].length-E)/10+1;++_)t(y[A].slice(E+(_-1)*10,E+_*10).trim(),m,A,_,p)}return p.sheetRows&&(m=m.slice(0,p.sheetRows)),m}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(d){for(var h={},p=!1,m=0,y=0;m<d.length;++m)(y=d.charCodeAt(m))==34?p=!p:!p&&y in r&&(h[y]=(h[y]||0)+1);y=[];for(m in h)Object.prototype.hasOwnProperty.call(h,m)&&y.push([h[m],m]);if(!y.length){h=n;for(m in h)Object.prototype.hasOwnProperty.call(h,m)&&y.push([h[m],m])}return y.sort(function(x,E){return x[0]-E[0]||n[x[1]]-n[E[1]]}),r[y.pop()[1]]||44}function s(d,h){var p=h||{},m="",y=p.dense?[]:{},x={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(m=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(m=d.charAt(4),d=d.slice(6)):m=i(d.slice(0,1024)):p&&p.FS?m=p.FS:m=i(d.slice(0,1024));var E=0,T=0,A=0,_=0,P=0,W=m.charCodeAt(0),B=!1,w=0,F=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var S=p.dateNF!=null?iR(p.dateNF):null;function b(){var N=d.slice(_,P),D={};if(N.charAt(0)=='"'&&N.charAt(N.length-1)=='"'&&(N=N.slice(1,-1).replace(/""/g,'"')),N.length===0)D.t="z";else if(p.raw)D.t="s",D.v=N;else if(N.trim().length===0)D.t="s",D.v=N;else if(N.charCodeAt(0)==61)N.charCodeAt(1)==34&&N.charCodeAt(N.length-1)==34?(D.t="s",D.v=N.slice(2,-1).replace(/""/g,'"')):D6(N)?(D.t="n",D.f=N.slice(1)):(D.t="s",D.v=N);else if(N=="TRUE")D.t="b",D.v=!0;else if(N=="FALSE")D.t="b",D.v=!1;else if(!isNaN(A=bs(N)))D.t="n",p.cellText!==!1&&(D.w=N),D.v=A;else if(!isNaN(Xc(N).getDate())||S&&N.match(S)){D.z=p.dateNF||at[14];var R=0;S&&N.match(S)&&(N=sR(N,p.dateNF,N.match(S)||[]),R=1),p.cellDates?(D.t="d",D.v=ur(N,R)):(D.t="n",D.v=tn(ur(N,R))),p.cellText!==!1&&(D.w=fs(D.z,D.v instanceof Date?tn(D.v):D.v)),p.cellNF||delete D.z}else D.t="s",D.v=N;if(D.t=="z"||(p.dense?(y[E]||(y[E]=[]),y[E][T]=D):y[ot({c:T,r:E})]=D),_=P+1,F=d.charCodeAt(_),x.e.c<T&&(x.e.c=T),x.e.r<E&&(x.e.r=E),w==W)++T;else if(T=0,++E,p.sheetRows&&p.sheetRows<=E)return!0}e:for(;P<d.length;++P)switch(w=d.charCodeAt(P)){case 34:F===34&&(B=!B);break;case W:case 10:case 13:if(!B&&b())break e;break}return P-_>0&&b(),y["!ref"]=xt(x),y}function a(d,h){return!(h&&h.PRN)||h.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?s(d,h):fu(e(d,h),h)}function o(d,h){var p="",m=h.type=="string"?[0,0,0,0]:sv(d,h);switch(h.type){case"base64":p=zi(d);break;case"binary":p=d;break;case"buffer":h.codepage==65001?p=d.toString("utf8"):h.codepage&&typeof jf<"u"||(p=yt&&Buffer.isBuffer(d)?d.toString("binary"):Wo(d));break;case"array":p=Sl(d);break;case"string":p=d;break;default:throw new Error("Unrecognized type "+h.type)}return m[0]==239&&m[1]==187&&m[2]==191?p=Qt(p.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?p=Qt(p):h.type=="binary"&&typeof jf<"u",p.slice(0,19)=="socialcalc:version:"?SA.to_sheet(h.type=="string"?p:Qt(p),h):a(p,h)}function l(d,h){return Ho(o(d,h),h)}function c(d){for(var h=[],p=Pt(d["!ref"]),m,y=Array.isArray(d),x=p.s.r;x<=p.e.r;++x){for(var E=[],T=p.s.c;T<=p.e.c;++T){var A=ot({r:x,c:T});if(m=y?(d[x]||[])[T]:d[A],!m||m.v==null){E.push("          ");continue}for(var _=(m.w||(Da(m),m.w)||"").slice(0,10);_.length<10;)_+=" ";E.push(_+(T===0?" ":""))}h.push(E.join(""))}return h.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}}();function yD(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var i=wA.to_workbook(t,r);return r.WTF=n,i}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return Yc.to_workbook(t,e)}}var pl=function(){function t(j,H,q){if(j){An(j,j.l||0);for(var Y=q.Enum||ke;j.l<j.length;){var de=j.read_shift(2),Se=Y[de]||Y[65535],Ne=j.read_shift(2),Ae=j.l+Ne,we=Se.f&&Se.f(j,Ne,q);if(j.l=Ae,H(we,Se,de))return}}}function e(j,H){switch(H.type){case"base64":return r(Mi(zi(j)),H);case"binary":return r(Mi(j),H);case"buffer":case"array":return r(j,H)}throw"Unsupported type "+H.type}function r(j,H){if(!j)return j;var q=H||{},Y=q.dense?[]:{},de="Sheet1",Se="",Ne=0,Ae={},we=[],it=[],G={s:{r:0,c:0},e:{r:0,c:0}},jt=q.sheetRows||0;if(j[2]==0&&(j[3]==8||j[3]==9)&&j.length>=16&&j[14]==5&&j[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(j[2]==2)q.Enum=ke,t(j,function(We,Jt,hn){switch(hn){case 0:q.vers=We,We>=4096&&(q.qpro=!0);break;case 6:G=We;break;case 204:We&&(Se=We);break;case 222:Se=We;break;case 15:case 51:q.qpro||(We[1].v=We[1].v.slice(1));case 13:case 14:case 16:hn==14&&(We[2]&112)==112&&(We[2]&15)>1&&(We[2]&15)<15&&(We[1].z=q.dateNF||at[14],q.cellDates&&(We[1].t="d",We[1].v=Fp(We[1].v))),q.qpro&&We[3]>Ne&&(Y["!ref"]=xt(G),Ae[de]=Y,we.push(de),Y=q.dense?[]:{},G={s:{r:0,c:0},e:{r:0,c:0}},Ne=We[3],de=Se||"Sheet"+(Ne+1),Se="");var $r=q.dense?(Y[We[0].r]||[])[We[0].c]:Y[ot(We[0])];if($r){$r.t=We[1].t,$r.v=We[1].v,We[1].z!=null&&($r.z=We[1].z),We[1].f!=null&&($r.f=We[1].f);break}q.dense?(Y[We[0].r]||(Y[We[0].r]=[]),Y[We[0].r][We[0].c]=We[1]):Y[ot(We[0])]=We[1];break}},q);else if(j[2]==26||j[2]==14)q.Enum=Le,j[2]==14&&(q.qpro=!0,j.l=0),t(j,function(We,Jt,hn){switch(hn){case 204:de=We;break;case 22:We[1].v=We[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(We[3]>Ne&&(Y["!ref"]=xt(G),Ae[de]=Y,we.push(de),Y=q.dense?[]:{},G={s:{r:0,c:0},e:{r:0,c:0}},Ne=We[3],de="Sheet"+(Ne+1)),jt>0&&We[0].r>=jt)break;q.dense?(Y[We[0].r]||(Y[We[0].r]=[]),Y[We[0].r][We[0].c]=We[1]):Y[ot(We[0])]=We[1],G.e.c<We[0].c&&(G.e.c=We[0].c),G.e.r<We[0].r&&(G.e.r=We[0].r);break;case 27:We[14e3]&&(it[We[14e3][0]]=We[14e3][1]);break;case 1537:it[We[0]]=We[1],We[0]==Ne&&(de=We[1]);break}},q);else throw new Error("Unrecognized LOTUS BOF "+j[2]);if(Y["!ref"]=xt(G),Ae[Se||de]=Y,we.push(Se||de),!it.length)return{SheetNames:we,Sheets:Ae};for(var mt={},bt=[],ht=0;ht<it.length;++ht)Ae[we[ht]]?(bt.push(it[ht]||we[ht]),mt[it[ht]]=Ae[it[ht]]||Ae[we[ht]]):(bt.push(it[ht]),mt[it[ht]]={"!ref":"A1"});return{SheetNames:bt,Sheets:mt}}function n(j,H){var q=H||{};if(+q.codepage>=0&&As(+q.codepage),q.type=="string")throw new Error("Cannot write WK1 to JS string");var Y=Si(),de=Pt(j["!ref"]),Se=Array.isArray(j),Ne=[];je(Y,0,s(1030)),je(Y,6,l(de));for(var Ae=Math.min(de.e.r,8191),we=de.s.r;we<=Ae;++we)for(var it=Lr(we),G=de.s.c;G<=de.e.c;++G){we===de.s.r&&(Ne[G]=Tr(G));var jt=Ne[G]+it,mt=Se?(j[we]||[])[G]:j[jt];if(!(!mt||mt.t=="z"))if(mt.t=="n")(mt.v|0)==mt.v&&mt.v>=-32768&&mt.v<=32767?je(Y,13,m(we,G,mt.v)):je(Y,14,x(we,G,mt.v));else{var bt=Da(mt);je(Y,15,h(we,G,bt.slice(0,239)))}}return je(Y,1),Y.end()}function i(j,H){var q=H||{};if(+q.codepage>=0&&As(+q.codepage),q.type=="string")throw new Error("Cannot write WK3 to JS string");var Y=Si();je(Y,0,a(j));for(var de=0,Se=0;de<j.SheetNames.length;++de)(j.Sheets[j.SheetNames[de]]||{})["!ref"]&&je(Y,27,Q(j.SheetNames[de],Se++));var Ne=0;for(de=0;de<j.SheetNames.length;++de){var Ae=j.Sheets[j.SheetNames[de]];if(!(!Ae||!Ae["!ref"])){for(var we=Pt(Ae["!ref"]),it=Array.isArray(Ae),G=[],jt=Math.min(we.e.r,8191),mt=we.s.r;mt<=jt;++mt)for(var bt=Lr(mt),ht=we.s.c;ht<=we.e.c;++ht){mt===we.s.r&&(G[ht]=Tr(ht));var We=G[ht]+bt,Jt=it?(Ae[mt]||[])[ht]:Ae[We];if(!(!Jt||Jt.t=="z"))if(Jt.t=="n")je(Y,23,b(mt,ht,Ne,Jt.v));else{var hn=Da(Jt);je(Y,22,w(mt,ht,Ne,hn.slice(0,239)))}}++Ne}}return je(Y,1),Y.end()}function s(j){var H=pe(2);return H.write_shift(2,j),H}function a(j){var H=pe(26);H.write_shift(2,4096),H.write_shift(2,4),H.write_shift(4,0);for(var q=0,Y=0,de=0,Se=0;Se<j.SheetNames.length;++Se){var Ne=j.SheetNames[Se],Ae=j.Sheets[Ne];if(!(!Ae||!Ae["!ref"])){++de;var we=Ai(Ae["!ref"]);q<we.e.r&&(q=we.e.r),Y<we.e.c&&(Y=we.e.c)}}return q>8191&&(q=8191),H.write_shift(2,q),H.write_shift(1,de),H.write_shift(1,Y),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(1,1),H.write_shift(1,2),H.write_shift(4,0),H.write_shift(4,0),H}function o(j,H,q){var Y={s:{c:0,r:0},e:{c:0,r:0}};return H==8&&q.qpro?(Y.s.c=j.read_shift(1),j.l++,Y.s.r=j.read_shift(2),Y.e.c=j.read_shift(1),j.l++,Y.e.r=j.read_shift(2),Y):(Y.s.c=j.read_shift(2),Y.s.r=j.read_shift(2),H==12&&q.qpro&&(j.l+=2),Y.e.c=j.read_shift(2),Y.e.r=j.read_shift(2),H==12&&q.qpro&&(j.l+=2),Y.s.c==65535&&(Y.s.c=Y.e.c=Y.s.r=Y.e.r=0),Y)}function l(j){var H=pe(8);return H.write_shift(2,j.s.c),H.write_shift(2,j.s.r),H.write_shift(2,j.e.c),H.write_shift(2,j.e.r),H}function c(j,H,q){var Y=[{c:0,r:0},{t:"n",v:0},0,0];return q.qpro&&q.vers!=20768?(Y[0].c=j.read_shift(1),Y[3]=j.read_shift(1),Y[0].r=j.read_shift(2),j.l+=2):(Y[2]=j.read_shift(1),Y[0].c=j.read_shift(2),Y[0].r=j.read_shift(2)),Y}function d(j,H,q){var Y=j.l+H,de=c(j,H,q);if(de[1].t="s",q.vers==20768){j.l++;var Se=j.read_shift(1);return de[1].v=j.read_shift(Se,"utf8"),de}return q.qpro&&j.l++,de[1].v=j.read_shift(Y-j.l,"cstr"),de}function h(j,H,q){var Y=pe(7+q.length);Y.write_shift(1,255),Y.write_shift(2,H),Y.write_shift(2,j),Y.write_shift(1,39);for(var de=0;de<Y.length;++de){var Se=q.charCodeAt(de);Y.write_shift(1,Se>=128?95:Se)}return Y.write_shift(1,0),Y}function p(j,H,q){var Y=c(j,H,q);return Y[1].v=j.read_shift(2,"i"),Y}function m(j,H,q){var Y=pe(7);return Y.write_shift(1,255),Y.write_shift(2,H),Y.write_shift(2,j),Y.write_shift(2,q,"i"),Y}function y(j,H,q){var Y=c(j,H,q);return Y[1].v=j.read_shift(8,"f"),Y}function x(j,H,q){var Y=pe(13);return Y.write_shift(1,255),Y.write_shift(2,H),Y.write_shift(2,j),Y.write_shift(8,q,"f"),Y}function E(j,H,q){var Y=j.l+H,de=c(j,H,q);if(de[1].v=j.read_shift(8,"f"),q.qpro)j.l=Y;else{var Se=j.read_shift(2);P(j.slice(j.l,j.l+Se),de),j.l+=Se}return de}function T(j,H,q){var Y=H&32768;return H&=-32769,H=(Y?j:0)+(H>=8192?H-16384:H),(Y?"":"$")+(q?Tr(H):Lr(H))}var A={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},_=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function P(j,H){An(j,0);for(var q=[],Y=0,de="",Se="",Ne="",Ae="";j.l<j.length;){var we=j[j.l++];switch(we){case 0:q.push(j.read_shift(8,"f"));break;case 1:Se=T(H[0].c,j.read_shift(2),!0),de=T(H[0].r,j.read_shift(2),!1),q.push(Se+de);break;case 2:{var it=T(H[0].c,j.read_shift(2),!0),G=T(H[0].r,j.read_shift(2),!1);Se=T(H[0].c,j.read_shift(2),!0),de=T(H[0].r,j.read_shift(2),!1),q.push(it+G+":"+Se+de)}break;case 3:if(j.l<j.length){console.error("WK1 premature formula end");return}break;case 4:q.push("("+q.pop()+")");break;case 5:q.push(j.read_shift(2));break;case 6:{for(var jt="";we=j[j.l++];)jt+=String.fromCharCode(we);q.push('"'+jt.replace(/"/g,'""')+'"')}break;case 8:q.push("-"+q.pop());break;case 23:q.push("+"+q.pop());break;case 22:q.push("NOT("+q.pop()+")");break;case 20:case 21:Ae=q.pop(),Ne=q.pop(),q.push(["AND","OR"][we-20]+"("+Ne+","+Ae+")");break;default:if(we<32&&_[we])Ae=q.pop(),Ne=q.pop(),q.push(Ne+_[we]+Ae);else if(A[we]){if(Y=A[we][1],Y==69&&(Y=j[j.l++]),Y>q.length){console.error("WK1 bad formula parse 0x"+we.toString(16)+":|"+q.join("|")+"|");return}var mt=q.slice(-Y);q.length-=Y,q.push(A[we][0]+"("+mt.join(",")+")")}else return we<=7?console.error("WK1 invalid opcode "+we.toString(16)):we<=24?console.error("WK1 unsupported op "+we.toString(16)):we<=30?console.error("WK1 invalid opcode "+we.toString(16)):we<=115?console.error("WK1 unsupported function opcode "+we.toString(16)):console.error("WK1 unrecognized opcode "+we.toString(16))}}q.length==1?H[1].f=""+q[0]:console.error("WK1 bad formula parse |"+q.join("|")+"|")}function W(j){var H=[{c:0,r:0},{t:"n",v:0},0];return H[0].r=j.read_shift(2),H[3]=j[j.l++],H[0].c=j[j.l++],H}function B(j,H){var q=W(j);return q[1].t="s",q[1].v=j.read_shift(H-4,"cstr"),q}function w(j,H,q,Y){var de=pe(6+Y.length);de.write_shift(2,j),de.write_shift(1,q),de.write_shift(1,H),de.write_shift(1,39);for(var Se=0;Se<Y.length;++Se){var Ne=Y.charCodeAt(Se);de.write_shift(1,Ne>=128?95:Ne)}return de.write_shift(1,0),de}function F(j,H){var q=W(j);q[1].v=j.read_shift(2);var Y=q[1].v>>1;if(q[1].v&1)switch(Y&7){case 0:Y=(Y>>3)*5e3;break;case 1:Y=(Y>>3)*500;break;case 2:Y=(Y>>3)/20;break;case 3:Y=(Y>>3)/200;break;case 4:Y=(Y>>3)/2e3;break;case 5:Y=(Y>>3)/2e4;break;case 6:Y=(Y>>3)/16;break;case 7:Y=(Y>>3)/64;break}return q[1].v=Y,q}function S(j,H){var q=W(j),Y=j.read_shift(4),de=j.read_shift(4),Se=j.read_shift(2);if(Se==65535)return Y===0&&de===3221225472?(q[1].t="e",q[1].v=15):Y===0&&de===3489660928?(q[1].t="e",q[1].v=42):q[1].v=0,q;var Ne=Se&32768;return Se=(Se&32767)-16446,q[1].v=(1-Ne*2)*(de*Math.pow(2,Se+32)+Y*Math.pow(2,Se)),q}function b(j,H,q,Y){var de=pe(14);if(de.write_shift(2,j),de.write_shift(1,q),de.write_shift(1,H),Y==0)return de.write_shift(4,0),de.write_shift(4,0),de.write_shift(2,65535),de;var Se=0,Ne=0,Ae=0,we=0;return Y<0&&(Se=1,Y=-Y),Ne=Math.log2(Y)|0,Y/=Math.pow(2,Ne-31),we=Y>>>0,we&2147483648||(Y/=2,++Ne,we=Y>>>0),Y-=we,we|=2147483648,we>>>=0,Y*=Math.pow(2,32),Ae=Y>>>0,de.write_shift(4,Ae),de.write_shift(4,we),Ne+=16383+(Se?32768:0),de.write_shift(2,Ne),de}function N(j,H){var q=S(j);return j.l+=H-14,q}function D(j,H){var q=W(j),Y=j.read_shift(4);return q[1].v=Y>>6,q}function R(j,H){var q=W(j),Y=j.read_shift(8,"f");return q[1].v=Y,q}function Ue(j,H){var q=R(j);return j.l+=H-10,q}function me(j,H){return j[j.l+H-1]==0?j.read_shift(H,"cstr"):""}function Ie(j,H){var q=j[j.l++];q>H-1&&(q=H-1);for(var Y="";Y.length<q;)Y+=String.fromCharCode(j[j.l++]);return Y}function Te(j,H,q){if(!(!q.qpro||H<21)){var Y=j.read_shift(1);j.l+=17,j.l+=1,j.l+=2;var de=j.read_shift(H-21,"cstr");return[Y,de]}}function _e(j,H){for(var q={},Y=j.l+H;j.l<Y;){var de=j.read_shift(2);if(de==14e3){for(q[de]=[0,""],q[de][0]=j.read_shift(2);j[j.l];)q[de][1]+=String.fromCharCode(j[j.l]),j.l++;j.l++}}return q}function Q(j,H){var q=pe(5+j.length);q.write_shift(2,14e3),q.write_shift(2,H);for(var Y=0;Y<j.length;++Y){var de=j.charCodeAt(Y);q[q.l++]=de>127?95:de}return q[q.l++]=0,q}var ke={0:{n:"BOF",f:Wr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:p},14:{n:"NUMBER",f:y},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:E},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:me},222:{n:"SHEETNAMELP",f:Ie},65535:{n:""}},Le={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:B},23:{n:"NUMBER17",f:S},24:{n:"NUMBER18",f:F},25:{n:"FORMULA19",f:N},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:_e},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:D},38:{n:"??"},39:{n:"NUMBER27",f:R},40:{n:"FORMULA28",f:Ue},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:me},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Te},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:e}}();function _D(t){var e={},r=t.match(Yn),n=0,i=!1;if(r)for(;n!=r.length;++n){var s=lt(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;e.cp=w1[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=s.val;break;case"<sz":e.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":s.rgb&&(e.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+s[0])}}return e}var ED=function(){var t=zf("t"),e=zf("rPr");function r(s){var a=s.match(t);if(!a)return{t:"s",v:""};var o={t:"s",v:Dt(a[1])},l=s.match(e);return l&&(o.s=_D(l[1])),o}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(a){return a.replace(n,"").split(i).map(r).filter(function(o){return o.v})}}(),wD=function(){var e=/(\r\n|\n)/g;function r(i,s,a){var o=[];i.u&&o.push("text-decoration: underline;"),i.uval&&o.push("text-underline-style:"+i.uval+";"),i.sz&&o.push("font-size:"+i.sz+"pt;"),i.outline&&o.push("text-effect: outline;"),i.shadow&&o.push("text-shadow: auto;"),s.push('<span style="'+o.join("")+'">'),i.b&&(s.push("<b>"),a.push("</b>")),i.i&&(s.push("<i>"),a.push("</i>")),i.strike&&(s.push("<s>"),a.push("</s>"));var l=i.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(s.push("<"+l+">"),a.push("</"+l+">")),a.push("</span>"),i}function n(i){var s=[[],i.v,[]];return i.v?(i.s&&r(i.s,s[0],s[2]),s[0].join("")+s[1].replace(e,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),TD=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,SD=/<(?:\w+:)?r>/,AD=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function G1(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Dt(Qt(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Qt(t),r&&(n.h=N1(n.t))):t.match(SD)&&(n.r=Qt(t),n.t=Dt(Qt((t.replace(AD,"").match(TD)||[]).join("").replace(Yn,""))),r&&(n.h=wD(ED(n.r)))),n):{t:""}}var kD=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,CD=/<(?:\w+:)?(?:si|sstItem)>/g,FD=/<\/(?:\w+:)?(?:si|sstItem)>/;function ID(t,e){var r=[],n="";if(!t)return r;var i=t.match(kD);if(i){n=i[2].replace(CD,"").split(FD);for(var s=0;s!=n.length;++s){var a=G1(n[s].trim(),e);a!=null&&(r[r.length]=a)}i=lt(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}var bD=/^\s|\s$|[\t\n\r]/;function AA(t,e){if(!e.bookSST)return"";var r=[Br];r[r.length]=Be("sst",null,{xmlns:Ml[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var i=t[n],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(bD)&&(s+=' xml:space="preserve"'),s+=">"+Gt(i.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function RD(t){return[t.read_shift(4),t.read_shift(4)]}function ND(t,e){var r=[],n=!1;return Ua(t,function(s,a,o){switch(o){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(a.T,!n||e.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function DD(t,e){return e||(e=pe(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var PD=HR;function OD(t){var e=Si();Ee(e,159,DD(t));for(var r=0;r<t.length;++r)Ee(e,19,PD(t[r]));return Ee(e,160),e.end()}function kA(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function Ca(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function MD(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=Ca(t,4),e.U=Ca(t,4),e.W=Ca(t,4),e}function LD(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},i=t.read_shift(4),s=[];i-- >0;)s.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=s,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function BD(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(LD(t));return e}function jD(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function VD(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=Ca(t,4),e.U=Ca(t,4),e.W=Ca(t,4),e}function UD(t){var e=VD(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function CA(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function FA(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function zD(t){var e=Ca(t);switch(e.Minor){case 2:return[e.Minor,WD(t)];case 3:return[e.Minor,HD()];case 4:return[e.Minor,$D(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function WD(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=CA(t,r),i=FA(t,t.length-t.l);return{t:"Std",h:n,v:i}}function HD(){throw new Error("File is password-protected: ECMA-376 Extensible")}function $D(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(Yn,function(s){var a=lt(s);switch(ia(a[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(o){n[o]=a[o]});break;case"<dataIntegrity":n.encryptedHmacKey=a.encryptedHmacKey,n.encryptedHmacValue=a.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=a.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(a);break;default:throw a[0]}}),n}function GD(t,e){var r={},n=r.EncryptionVersionInfo=Ca(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var i=t.read_shift(4);return e-=4,r.EncryptionHeader=CA(t,i),e-=i,r.EncryptionVerifier=FA(t,e),r}function KD(t){var e={},r=e.EncryptionVersionInfo=Ca(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function K1(t){var e=0,r,n=kA(t),i=n.length+1,s,a,o,l,c;for(r=Do(i),r[0]=n.length,s=1;s!=i;++s)r[s]=n[s-1];for(s=i-1;s>=0;--s)a=r[s],o=e&16384?1:0,l=e<<1&32767,c=o|l,e=c^a;return e^52811}var IA=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(a){return(a/2|a*128)&255},i=function(a,o){return n(a^o)},s=function(a){for(var o=e[a.length-1],l=104,c=a.length-1;c>=0;--c)for(var d=a[c],h=0;h!=7;++h)d&64&&(o^=r[l]),d*=2,--l;return o};return function(a){for(var o=kA(a),l=s(o),c=o.length,d=Do(16),h=0;h!=16;++h)d[h]=0;var p,m,y;for((c&1)===1&&(p=l>>8,d[c]=i(t[0],p),--c,p=l&255,m=o[o.length-1],d[c]=i(m,p));c>0;)--c,p=l>>8,d[c]=i(o[c],p),--c,p=l&255,d[c]=i(o[c],p);for(c=15,y=15-o.length;y>0;)p=l>>8,d[c]=i(t[y],p),--c,--y,p=l&255,d[c]=i(o[c],p),--c,--y;return d}}(),XD=function(t,e,r,n,i){i||(i=e),n||(n=IA(t));var s,a;for(s=0;s!=e.length;++s)a=e[s],a^=n[r],a=(a>>5|a<<3)&255,i[s]=a,++r;return[i,r,n]},YD=function(t){var e=0,r=IA(t);return function(n){var i=XD("",n,e,r);return e=i[1],i[0]}};function qD(t,e,r,n){var i={key:Wr(t),verificationBytes:Wr(t)};return r.password&&(i.verifier=K1(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=YD(r.password)),i}function QD(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=KD(t):n.Data=GD(t,e),n}function JD(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?QD(t,e-2,n):qD(t,r.biff>=8?e:e-2,r,n),n}var bA=function(){function t(i,s){switch(s.type){case"base64":return e(zi(i),s);case"binary":return e(i,s);case"buffer":return e(yt&&Buffer.isBuffer(i)?i.toString("binary"):Wo(i),s);case"array":return e(Sl(i),s)}throw new Error("Unrecognized type "+s.type)}function e(i,s){var a=s||{},o=a.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(d,h){Array.isArray(o)&&(o[h]=[]);for(var p=/\\\w+\b/g,m=0,y,x=-1;y=p.exec(d);){switch(y[0]){case"\\cell":var E=d.slice(m,p.lastIndex-y[0].length);if(E[0]==" "&&(E=E.slice(1)),++x,E.length){var T={v:E,t:"s"};Array.isArray(o)?o[h][x]=T:o[ot({r:h,c:x})]=T}break}m=p.lastIndex}x>c.e.c&&(c.e.c=x)}),o["!ref"]=xt(c),o}function r(i,s){return Ho(t(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],a=Pt(i["!ref"]),o,l=Array.isArray(i),c=a.s.r;c<=a.e.r;++c){s.push("\\trowd\\trautofit1");for(var d=a.s.c;d<=a.e.c;++d)s.push("\\cellx"+(d+1));for(s.push("\\pard\\intbl"),d=a.s.c;d<=a.e.c;++d){var h=ot({r:c,c:d});o=l?(i[c]||[])[d]:i[h],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(Da(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function ZD(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function Gf(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function eP(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,i=Math.max(e,r,n),s=Math.min(e,r,n),a=i-s;if(a===0)return[0,0,e];var o=0,l=0,c=i+s;switch(l=a/(c>1?2-c:c),i){case e:o=((r-n)/a+6)%6;break;case r:o=(n-e)/a+2;break;case n:o=(e-r)/a+4;break}return[o/6,l,c/2]}function tP(t){var e=t[0],r=t[1],n=t[2],i=r*2*(n<.5?n:1-n),s=n-i/2,a=[s,s,s],o=6*e,l;if(r!==0)switch(o|0){case 0:case 6:l=i*o,a[0]+=i,a[1]+=l;break;case 1:l=i*(2-o),a[0]+=l,a[1]+=i;break;case 2:l=i*(o-2),a[1]+=i,a[2]+=l;break;case 3:l=i*(4-o),a[1]+=l,a[2]+=i;break;case 4:l=i*(o-4),a[2]+=i,a[0]+=l;break;case 5:l=i*(6-o),a[2]+=l,a[0]+=i;break}for(var c=0;c!=3;++c)a[c]=Math.round(a[c]*255);return a}function zh(t,e){if(e===0)return t;var r=eP(ZD(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),Gf(tP(r))}var RA=6,rP=15,nP=1,zn=RA;function Kf(t){return Math.floor((t+Math.round(128/zn)/256)*zn)}function Xf(t){return Math.floor((t-5)/zn*100+.5)/100}function Wh(t){return Math.round((t*zn+5)/zn*256)/256}function Cg(t){return Wh(Xf(Kf(t)))}function X1(t){var e=Math.abs(t-Cg(t)),r=zn;if(e>.005)for(zn=nP;zn<rP;++zn)Math.abs(t-Cg(t))<=e&&(e=Math.abs(t-Cg(t)),r=zn);zn=r}function Po(t){t.width?(t.wpx=Kf(t.width),t.wch=Xf(t.wpx),t.MDW=zn):t.wpx?(t.wch=Xf(t.wpx),t.width=Wh(t.wch),t.MDW=zn):typeof t.wch=="number"&&(t.width=Wh(t.wch),t.wpx=Kf(t.width),t.MDW=zn),t.customWidth&&delete t.customWidth}var iP=96,NA=iP;function Yf(t){return t*96/NA}function qc(t){return t*NA/96}var sP={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function aP(t,e,r,n){e.Borders=[];var i={},s=!1;(t[0].match(Yn)||[]).forEach(function(a){var o=lt(a);switch(ia(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},o.diagonalUp&&(i.diagonalUp=lr(o.diagonalUp)),o.diagonalDown&&(i.diagonalDown=lr(o.diagonalDown)),e.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in borders")}})}function oP(t,e,r,n){e.Fills=[];var i={},s=!1;(t[0].match(Yn)||[]).forEach(function(a){var o=lt(a);switch(ia(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},e.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":o.patternType&&(i.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),o.indexed&&(i.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(i.bgColor.theme=parseInt(o.theme,10)),o.tint&&(i.bgColor.tint=parseFloat(o.tint)),o.rgb&&(i.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),o.theme&&(i.fgColor.theme=parseInt(o.theme,10)),o.tint&&(i.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(i.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fills")}})}function lP(t,e,r,n){e.Fonts=[];var i={},s=!1;(t[0].match(Yn)||[]).forEach(function(a){var o=lt(a);switch(ia(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(i),i={};break;case"<name":o.val&&(i.name=Qt(o.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=o.val?lr(o.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=o.val?lr(o.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(o.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=o.val?lr(o.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=o.val?lr(o.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=o.val?lr(o.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=o.val?lr(o.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=o.val?lr(o.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":o.val&&(i.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(i.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(i.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(i.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=w1[parseInt(o.val,10)];break;case"<color":if(i.color||(i.color={}),o.auto&&(i.color.auto=lr(o.auto)),o.rgb)i.color.rgb=o.rgb.slice(-6);else if(o.indexed){i.color.index=parseInt(o.indexed,10);var l=dl[i.color.index];i.color.index==81&&(l=dl[1]),l||(l=dl[1]),i.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(i.color.theme=parseInt(o.theme,10),o.tint&&(i.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=zh(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fonts")}})}function cP(t,e,r){e.NumberFmt=[];for(var n=Dr(at),i=0;i<n.length;++i)e.NumberFmt[n[i]]=at[n[i]];var s=t[0].match(Yn);if(s)for(i=0;i<s.length;++i){var a=lt(s[i]);switch(ia(a[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=Dt(Qt(a.formatCode)),l=parseInt(a.numFmtId,10);if(e.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&e.NumberFmt[l]!=null;--l);e.NumberFmt[l]=o}ka(o,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+a[0]+" in numFmts")}}}function uP(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)t[n]!=null&&(e[e.length]=Be("numFmt",null,{numFmtId:n,formatCode:Gt(t[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=Be("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var kd=["numFmtId","fillId","fontId","borderId","xfId"],Cd=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function fP(t,e,r){e.CellXf=[];var n,i=!1;(t[0].match(Yn)||[]).forEach(function(s){var a=lt(s),o=0;switch(ia(a[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=a,delete n[0],o=0;o<kd.length;++o)n[kd[o]]&&(n[kd[o]]=parseInt(n[kd[o]],10));for(o=0;o<Cd.length;++o)n[Cd[o]]&&(n[Cd[o]]=lr(n[Cd[o]]));if(e.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[o]){n.numFmtId=o;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};a.vertical&&(l.vertical=a.vertical),a.horizontal&&(l.horizontal=a.horizontal),a.textRotation!=null&&(l.textRotation=a.textRotation),a.indent&&(l.indent=a.indent),a.wrapText&&(l.wrapText=lr(a.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+a[0]+" in cellXfs")}})}function dP(t){var e=[];return e[e.length]=Be("cellXfs",null),t.forEach(function(r){e[e.length]=Be("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=Be("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var hP=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,c){var d={};if(!o)return d;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var h;return(h=o.match(e))&&cP(h,d,c),(h=o.match(i))&&lP(h,d,l,c),(h=o.match(n))&&oP(h,d,l,c),(h=o.match(s))&&aP(h,d,l,c),(h=o.match(r))&&fP(h,d,c),d}}();function DA(t,e){var r=[Br,Be("styleSheet",null,{xmlns:Ml[0],"xmlns:vt":Qr.vt})],n;return t.SSF&&(n=uP(t.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=dP(e.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function pP(t,e){var r=t.read_shift(2),n=$n(t);return[r,n]}function gP(t,e,r){r||(r=pe(6+4*e.length)),r.write_shift(2,t),fn(e,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function mP(t,e,r){var n={};n.sz=t.read_shift(2)/20;var i=QR(t);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=t.read_shift(2);switch(s===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=t.read_shift(1);a!=0&&(n.underline=a);var o=t.read_shift(1);o>0&&(n.family=o);var l=t.read_shift(1);switch(l>0&&(n.charset=l),t.l++,n.color=qR(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=$n(t),n}function xP(t,e){e||(e=pe(25+4*32)),e.write_shift(2,t.sz*20),JR(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),jh(t.color,e);var n=0;return n=2,e.write_shift(1,n),fn(t.name,e),e.length>e.l?e.slice(0,e.l):e}var vP=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Fg,yP=Kn;function d2(t,e){e||(e=pe(4*3+8*7+16*1)),Fg||(Fg=kp(vP));var r=Fg[t.patternType];r==null&&(r=40),e.write_shift(4,r);var n=0;if(r!=40)for(jh({auto:1},e),jh({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function _P(t,e){var r=t.l+e,n=t.read_shift(2),i=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:i}}function PA(t,e,r){r||(r=pe(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Lu(t,e){return e||(e=pe(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var EP=Kn;function wP(t,e){return e||(e=pe(51)),e.write_shift(1,0),Lu(null,e),Lu(null,e),Lu(null,e),Lu(null,e),Lu(null,e),e.length>e.l?e.slice(0,e.l):e}function TP(t,e){return e||(e=pe(12+4*10)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),Bh(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function SP(t,e,r){var n=pe(2052);return n.write_shift(4,t),Bh(e,n),Bh(r,n),n.length>n.l?n.slice(0,n.l):n}function AP(t,e,r){var n={};n.NumberFmt=[];for(var i in at)n.NumberFmt[i]=at[i];n.CellXf=[],n.Fonts=[];var s=[],a=!1;return Ua(t,function(l,c,d){switch(d){case 44:n.NumberFmt[l[0]]=l[1],ka(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(l.color.rgb=zh(e.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:s.push(d),a=!0;break;case 38:s.pop(),a=!1;break;default:if(c.T>0)s.push(d);else if(c.T<0)s.pop();else if(!a||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),n}function kP(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&++r}),r!=0&&(Ee(t,615,Rs(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&Ee(t,44,gP(i,e[i]))}),Ee(t,616))}}function CP(t){var e=1;Ee(t,611,Rs(e)),Ee(t,43,xP({sz:12,color:{theme:1},name:"Calibri",family:2})),Ee(t,612)}function FP(t){var e=2;Ee(t,603,Rs(e)),Ee(t,45,d2({patternType:"none"})),Ee(t,45,d2({patternType:"gray125"})),Ee(t,604)}function IP(t){var e=1;Ee(t,613,Rs(e)),Ee(t,46,wP()),Ee(t,614)}function bP(t){var e=1;Ee(t,626,Rs(e)),Ee(t,47,PA({numFmtId:0},65535)),Ee(t,627)}function RP(t,e){Ee(t,617,Rs(e.length)),e.forEach(function(r){Ee(t,47,PA(r,0))}),Ee(t,618)}function NP(t){var e=1;Ee(t,619,Rs(e)),Ee(t,48,TP({xfId:0,name:"Normal"})),Ee(t,620)}function DP(t){var e=0;Ee(t,505,Rs(e)),Ee(t,506)}function PP(t){var e=0;Ee(t,508,SP(e,"TableStyleMedium9","PivotStyleMedium4")),Ee(t,509)}function OP(t,e){var r=Si();return Ee(r,278),kP(r,t.SSF),CP(r),FP(r),IP(r),bP(r),RP(r,e.cellXfs),NP(r),DP(r),PP(r),Ee(r,279),r.end()}var MP=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function LP(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(Yn)||[]).forEach(function(i){var s=lt(i);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(e.themeElements.clrScheme[MP.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function BP(){}function jP(){}var VP=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,UP=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,zP=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function WP(t,e,r){e.themeElements={};var n;[["clrScheme",VP,LP],["fontScheme",UP,BP],["fmtScheme",zP,jP]].forEach(function(i){if(!(n=t.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,e,r)})}var HP=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function OA(t,e){(!t||t.length===0)&&(t=Y1());var r,n={};if(!(r=t.match(HP)))throw new Error("themeElements not found in theme");return WP(r[0],n,e),n.raw=t,n}function Y1(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[Br];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function $P(t,e,r){var n=t.l+e,i=t.read_shift(4);if(i!==124226){if(!r.cellStyles){t.l=n;return}var s=t.slice(t.l);t.l=n;var a;try{a=CS(s,{type:"array"})}catch{return}var o=Li(a,"theme/theme/theme1.xml",!0);if(o)return OA(o,r)}}function GP(t){return t.read_shift(4)}function KP(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=XP(t,4);break;case 2:e.xclrValue=pA(t);break;case 3:e.xclrValue=GP(t);break;case 4:t.l+=4;break}return t.l+=8,e}function XP(t,e){return Kn(t,e)}function YP(t,e){return Kn(t,e)}function qP(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=KP(t);break;case 6:n[1]=YP(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function QP(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var i=t.read_shift(2),s=[];i-- >0;)s.push(qP(t,r-t.l));return{ixfe:n,ext:s}}function JP(t,e){e.forEach(function(r){switch(r[0]){}})}function ZP(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:$n(t)}}function e6(t){var e=pe(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),fn(t.name,e),e.slice(0,e.l)}function t6(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function r6(t){var e=pe(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function n6(t,e){var r=pe(8+2*e.length);return r.write_shift(4,t),fn(e,r),r.slice(0,r.l)}function i6(t){return t.l+=4,t.read_shift(4)!=0}function s6(t,e){var r=pe(8);return r.write_shift(4,t),r.write_shift(4,1),r}function a6(t,e,r){var n={Types:[],Cell:[],Value:[]},i=r||{},s=[],a=!1,o=2;return Ua(t,function(l,c,d){switch(d){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(h){o==1?n.Cell.push({type:n.Types[h[0]-1].name,index:h[1]}):o==0&&n.Value.push({type:n.Types[h[0]-1].name,index:h[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:s.push(d),a=!0;break;case 36:s.pop(),a=!1;break;default:if(!c.T){if(!a||i.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),n}function o6(){var t=Si();return Ee(t,332),Ee(t,334,Rs(1)),Ee(t,335,e6({name:"XLDAPR",version:12e4,flags:3496657072})),Ee(t,336),Ee(t,339,n6(1,"XLDAPR")),Ee(t,52),Ee(t,35,Rs(514)),Ee(t,4096,Rs(0)),Ee(t,4097,rs(1)),Ee(t,36),Ee(t,53),Ee(t,340),Ee(t,337,s6(1)),Ee(t,51,r6([[1,0]])),Ee(t,338),Ee(t,333),t.end()}function l6(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var i=!1,s=2,a;return t.replace(Yn,function(o){var l=lt(o);switch(ia(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<n.Types.length;++c)n.Types[c].name==l.name&&(a=n.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):s==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!a)break;a.offsets||(a.offsets=[]),a.offsets.push(+l.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function MA(){var t=[Br];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function c6(t){var e=[];if(!t)return e;var r=1;return(t.match(Yn)||[]).forEach(function(n){var i=lt(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,e.push(i);break}}),e}function u6(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=ot(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function f6(t,e,r){var n=[];return Ua(t,function(s,a,o){switch(o){case 63:n.push(s);break;default:if(!a.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function d6(t,e,r,n){if(!t)return t;var i=n||{},s=!1;Ua(t,function(o,l,c){switch(c){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!l.T){if(!s||i.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}},i)}function h6(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}var Sc=1024;function LA(t,e){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[Be("xml",null,{"xmlns:v":Pi.v,"xmlns:o":Pi.o,"xmlns:x":Pi.x,"xmlns:mv":Pi.mv}).replace(/\/>/,">"),Be("o:shapelayout",Be("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),Be("v:shapetype",[Be("v:stroke",null,{joinstyle:"miter"}),Be("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Sc<t*1e3;)Sc+=1e3;return e.forEach(function(s){var a=Sr(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?Be("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=Be("v:fill",l,o),d={on:"t",obscured:"t"};++Sc,i=i.concat(["<v:shape"+Wf({id:"_x0000_s"+Sc,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,Be("v:shadow",null,d),Be("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",kn("x:Anchor",[a.c+1,0,a.r+1,0,a.c+3,20,a.r+5,20].join(",")),kn("x:AutoFill","False"),kn("x:Row",String(a.r)),kn("x:Column",String(a.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function h2(t,e,r,n){var i=Array.isArray(t),s;e.forEach(function(a){var o=Sr(a.ref);if(i?(t[o.r]||(t[o.r]=[]),s=t[o.r][o.c]):s=t[a.ref],!s){s={t:"z"},i?t[o.r][o.c]=s:t[a.ref]=s;var l=Pt(t["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var c=xt(l);c!==t["!ref"]&&(t["!ref"]=c)}s.c||(s.c=[]);var d={a:a.author,t:a.t,r:a.r,T:r};a.h&&(d.h=a.h);for(var h=s.c.length-1;h>=0;--h){if(!r&&s.c[h].T)return;r&&!s.c[h].T&&s.c.splice(h,1)}if(r&&n){for(h=0;h<n.length;++h)if(d.a==n[h].id){d.a=n[h].name||d.a;break}}s.c.push(d)})}function p6(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var s=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=lt(o[0]),c={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},d=Sr(l.ref);if(!(e.sheetRows&&e.sheetRows<=d.r)){var h=a.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),p=!!h&&!!h[1]&&G1(h[1])||{r:"",t:"",h:""};c.r=p.r,p.r=="<t></t>"&&(p.t=p.h=""),c.t=(p.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(c.h=p.h),n.push(c)}}}}),n}function BA(t){var e=[Br,Be("comments",null,{xmlns:Ml[0]})],r=[];return e.push("<authors>"),t.forEach(function(n){n[1].forEach(function(i){var s=Gt(i.a);r.indexOf(s)==-1&&(r.push(s),e.push("<author>"+s+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),e.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(n){var i=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(l){l.a&&(i=r.indexOf(Gt(l.a))),s.push(l.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),s.length<=1)e.push(kn("t",Gt(s[0]||"")));else{for(var a=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)a+=`Reply:
    `+s[o]+`
`;e.push(kn("t",Gt(a)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function g6(t,e){var r=[],n=!1,i={},s=0;return t.replace(Yn,function(o,l){var c=lt(o);switch(ia(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":s=l+o.length;break;case"</text>":i.t=t.slice(s,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),r}function m6(t,e,r){var n=[Br,Be("ThreadedComments",null,{xmlns:Qr.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(i){var s="";(i[1]||[]).forEach(function(a,o){if(!a.T){delete a.ID;return}a.a&&e.indexOf(a.a)==-1&&e.push(a.a);var l={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?s=l.id:l.parentId=s,a.ID=l.id,a.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(a.a)).slice(-12)+"}"),n.push(Be("threadedComment",kn("text",a.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function x6(t,e){var r=[],n=!1;return t.replace(Yn,function(s){var a=lt(s);switch(ia(a[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:a.displayname,id:a.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+a[0]+" in threaded comments")}return s}),r}function v6(t){var e=[Br,Be("personList",null,{xmlns:Qr.TCMNT,"xmlns:x":Ml[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,n){e.push(Be("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function y6(t){var e={};e.iauthor=t.read_shift(4);var r=Vl(t);return e.rfx=r.s,e.ref=ot(r.s),t.l+=16,e}function _6(t,e){return e==null&&(e=pe(36)),e.write_shift(4,t[1].iauthor),du(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var E6=$n;function w6(t){return fn(t.slice(0,54))}function T6(t,e){var r=[],n=[],i={},s=!1;return Ua(t,function(o,l,c){switch(c){case 632:n.push(o);break;case 635:i=o;break;case 637:i.t=o.t,i.h=o.h,i.r=o.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,e.sheetRows&&i.rfx&&e.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!s||e.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),r}function S6(t){var e=Si(),r=[];return Ee(e,628),Ee(e,630),t.forEach(function(n){n[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),Ee(e,632,w6(i.a)))})}),Ee(e,631),Ee(e,633),t.forEach(function(n){n[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var s={s:Sr(n[0]),e:Sr(n[0])};Ee(e,635,_6([s,i])),i.t&&i.t.length>0&&Ee(e,637,GR(i)),Ee(e,636),delete i.iauthor})}),Ee(e,634),Ee(e,629),e.end()}var A6="application/vnd.ms-office.vbaProject";function k6(t){var e=tt.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");tt.utils.cfb_add(e,i,t.FileIndex[n].content)}}),tt.write(e)}function C6(t,e){e.FullPaths.forEach(function(r,n){if(n!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&tt.utils.cfb_add(t,i,e.FileIndex[n].content)}})}var jA=["xlsb","xlsm","xlam","biff8","xla"];function F6(){return{"!type":"dialog"}}function I6(){return{"!type":"dialog"}}function b6(){return{"!type":"macro"}}function R6(){return{"!type":"macro"}}var Oc=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,i,s,a){var o=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var c=s.length>0?parseInt(s,10)|0:0,d=a.length>0?parseInt(a,10)|0:0;return o?d+=e.c:--d,l?c+=e.r:--c,i+(o?"":"$")+Tr(d)+(l?"":"$")+Lr(c)}return function(i,s){return e=s,i.replace(t,r)}}(),q1=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Q1=function(){return function(e,r){return e.replace(q1,function(n,i,s,a,o,l){var c=L1(a)-(s?0:r.c),d=M1(l)-(o?0:r.r),h=d==0?"":o?d+1:"["+d+"]",p=c==0?"":s?c+1:"["+c+"]";return i+"R"+h+"C"+p})}}();function VA(t,e){return t.replace(q1,function(r,n,i,s,a,o){return n+(i=="$"?i+s:Tr(L1(s)+e.c))+(a=="$"?a+o:Lr(M1(o)+e.r))})}function N6(t,e,r){var n=Ai(e),i=n.s,s=Sr(r),a={r:s.r-i.r,c:s.c-i.c};return VA(t,a)}function D6(t){return t.length!=1}function p2(t){return t.replace(/_xlfn\./g,"")}function Vr(t){t.l+=1}function Oo(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function UA(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return zA(t);r.biff==12&&(n=4)}var i=t.read_shift(n),s=t.read_shift(n),a=Oo(t),o=Oo(t);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function zA(t){var e=Oo(t),r=Oo(t),n=t.read_shift(1),i=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function P6(t,e,r){if(r.biff<8)return zA(t);var n=t.read_shift(r.biff==12?4:2),i=t.read_shift(r.biff==12?4:2),s=Oo(t),a=Oo(t);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}function WA(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return O6(t);var n=t.read_shift(r&&r.biff==12?4:2),i=Oo(t);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function O6(t){var e=Oo(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function M6(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function L6(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return B6(t);var i=t.read_shift(n>=12?4:2),s=t.read_shift(2),a=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;i>524287;)i-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:a,rRel:o}}function B6(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),i==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:i,rRel:n}}function j6(t,e,r){var n=(t[t.l++]&96)>>5,i=UA(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function V6(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}var a=UA(t,s,r);return[n,i,a]}function U6(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function z6(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}return t.l+=s,[n,i]}function W6(t,e,r){var n=(t[t.l++]&96)>>5,i=P6(t,e-1,r);return[n,i]}function H6(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function g2(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function $6(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(t.read_shift(r&&r.biff==2?1:2));return i}function G6(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function K6(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function X6(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function Y6(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function HA(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function q6(t){return t.read_shift(2),HA(t)}function Q6(t){return t.read_shift(2),HA(t)}function J6(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=WA(t,0,r);return[n,i]}function Z6(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=L6(t,0,r);return[n,i]}function e8(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var s=WA(t,0,r);return[n,i,s]}function t8(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(r&&r.biff<=3?1:2);return[i5[i],KA[i],n]}function r8(t,e,r){var n=t[t.l++],i=t.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:n8(t);return[i,(s[0]===0?KA:n5)[s[1]]]}function n8(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function i8(t,e,r){t.l+=r&&r.biff==2?3:4}function s8(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function a8(t){return t.l++,za[t.read_shift(1)]}function o8(t){return t.l++,t.read_shift(2)}function l8(t){return t.l++,t.read_shift(1)!==0}function c8(t){return t.l++,Hn(t)}function u8(t,e,r){return t.l++,m0(t,e-1,r)}function f8(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Pr(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=za[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=Hn(t);break;case 2:r[1]=Ul(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function d8(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((r.biff==12?Vl:Ip)(t));return i}function h8(t,e,r){var n=0,i=0;r.biff==12?(n=t.read_shift(4),i=t.read_shift(4)):(i=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var s=0,a=[];s!=n&&(a[s]=[]);++s)for(var o=0;o!=i;++o)a[s][o]=f8(t,r.biff);return a}function p8(t,e,r){var n=t.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,s=t.read_shift(i);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,s]}function g8(t,e,r){if(r.biff==5)return m8(t);var n=t.read_shift(1)>>>5&3,i=t.read_shift(2),s=t.read_shift(4);return[n,i,s]}function m8(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function x8(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function v8(t,e,r){var n=t.read_shift(1)>>>5&3,i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function y8(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function _8(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return t.l+=s,[n,i]}var E8=Kn,w8=Kn,T8=Kn;function v0(t,e,r){return t.l+=2,[M6(t)]}function J1(t){return t.l+=6,[]}var S8=v0,A8=J1,k8=J1,C8=v0;function $A(t){return t.l+=2,[Wr(t),t.read_shift(2)&1]}var F8=v0,I8=$A,b8=J1,R8=v0,N8=v0,D8=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function P8(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i=t.read_shift(2),s=t.read_shift(2),a=D8[r>>2&31];return{ixti:e,coltype:r&3,rt:a,idx:n,c:i,C:s}}function O8(t){return t.l+=2,[t.read_shift(4)]}function M8(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function L8(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function B8(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function j8(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function V8(t){return t.l+=4,[0,0]}var m2={1:{n:"PtgExp",f:s8},2:{n:"PtgTbl",f:T8},3:{n:"PtgAdd",f:Vr},4:{n:"PtgSub",f:Vr},5:{n:"PtgMul",f:Vr},6:{n:"PtgDiv",f:Vr},7:{n:"PtgPower",f:Vr},8:{n:"PtgConcat",f:Vr},9:{n:"PtgLt",f:Vr},10:{n:"PtgLe",f:Vr},11:{n:"PtgEq",f:Vr},12:{n:"PtgGe",f:Vr},13:{n:"PtgGt",f:Vr},14:{n:"PtgNe",f:Vr},15:{n:"PtgIsect",f:Vr},16:{n:"PtgUnion",f:Vr},17:{n:"PtgRange",f:Vr},18:{n:"PtgUplus",f:Vr},19:{n:"PtgUminus",f:Vr},20:{n:"PtgPercent",f:Vr},21:{n:"PtgParen",f:Vr},22:{n:"PtgMissArg",f:Vr},23:{n:"PtgStr",f:u8},26:{n:"PtgSheet",f:M8},27:{n:"PtgEndSheet",f:L8},28:{n:"PtgErr",f:a8},29:{n:"PtgBool",f:l8},30:{n:"PtgInt",f:o8},31:{n:"PtgNum",f:c8},32:{n:"PtgArray",f:H6},33:{n:"PtgFunc",f:t8},34:{n:"PtgFuncVar",f:r8},35:{n:"PtgName",f:p8},36:{n:"PtgRef",f:J6},37:{n:"PtgArea",f:j6},38:{n:"PtgMemArea",f:x8},39:{n:"PtgMemErr",f:E8},40:{n:"PtgMemNoMem",f:w8},41:{n:"PtgMemFunc",f:v8},42:{n:"PtgRefErr",f:y8},43:{n:"PtgAreaErr",f:U6},44:{n:"PtgRefN",f:Z6},45:{n:"PtgAreaN",f:W6},46:{n:"PtgMemAreaN",f:B8},47:{n:"PtgMemNoMemN",f:j8},57:{n:"PtgNameX",f:g8},58:{n:"PtgRef3d",f:e8},59:{n:"PtgArea3d",f:V6},60:{n:"PtgRefErr3d",f:_8},61:{n:"PtgAreaErr3d",f:z6},255:{}},U8={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},z8={1:{n:"PtgElfLel",f:$A},2:{n:"PtgElfRw",f:R8},3:{n:"PtgElfCol",f:S8},6:{n:"PtgElfRwV",f:N8},7:{n:"PtgElfColV",f:C8},10:{n:"PtgElfRadical",f:F8},11:{n:"PtgElfRadicalS",f:b8},13:{n:"PtgElfColS",f:A8},15:{n:"PtgElfColSV",f:k8},16:{n:"PtgElfRadicalLel",f:I8},25:{n:"PtgList",f:P8},29:{n:"PtgSxName",f:O8},255:{}},W8={0:{n:"PtgAttrNoop",f:V8},1:{n:"PtgAttrSemi",f:Y6},2:{n:"PtgAttrIf",f:K6},4:{n:"PtgAttrChoose",f:$6},8:{n:"PtgAttrGoto",f:G6},16:{n:"PtgAttrSum",f:i8},32:{n:"PtgAttrBaxcel",f:g2},33:{n:"PtgAttrBaxcel",f:g2},64:{n:"PtgAttrSpace",f:q6},65:{n:"PtgAttrSpaceSemi",f:Q6},128:{n:"PtgAttrIfError",f:X6},255:{}};function y0(t,e,r,n){if(n.biff<8)return Kn(t,e);for(var i=t.l+e,s=[],a=0;a!==r.length;++a)switch(r[a][0]){case"PtgArray":r[a][1]=h8(t,0,n),s.push(r[a][1]);break;case"PtgMemArea":r[a][2]=d8(t,r[a][1],n),s.push(r[a][2]);break;case"PtgExp":n&&n.biff==12&&(r[a][1][1]=t.read_shift(4),s.push(r[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[a][0]}return e=i-t.l,e!==0&&s.push(Kn(t,e)),s}function _0(t,e,r){for(var n=t.l+e,i,s,a=[];n!=t.l;)e=n-t.l,s=t[t.l],i=m2[s]||m2[U8[s]],(s===24||s===25)&&(i=(s===24?z8:W8)[t[t.l+1]]),!i||!i.f?Kn(t,e):a.push([i.n,i.f(t,e,r)]);return a}function H8(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],i=[],s=0;s<n.length;++s){var a=n[s];if(a)switch(a[0]){case 2:i.push('"'+a[1].replace(/"/g,'""')+'"');break;default:i.push(a[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var $8={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function G8(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function GA(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(t[n[0]][0]){case 357:return i=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return t[n[0]][0][3]?(i=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function x2(t,e,r){var n=GA(t,e,r);return n=="#REF"?n:G8(n,r)}function Vn(t,e,r,n,i){var s=i&&i.biff||8,a={s:{c:0,r:0}},o=[],l,c,d,h=0,p=0,m,y="";if(!t[0]||!t[0][0])return"";for(var x=-1,E="",T=0,A=t[0].length;T<A;++T){var _=t[0][T];switch(_[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),x>=0){switch(t[0][x][1][0]){case 0:E=br(" ",t[0][x][1][1]);break;case 1:E=br("\r",t[0][x][1][1]);break;default:if(E="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][x][1][0])}c=c+E,x=-1}o.push(c+$8[_[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=uf(_[1][1],a,i),o.push(ff(d,s));break;case"PtgRefN":d=r?uf(_[1][1],r,i):_[1][1],o.push(ff(d,s));break;case"PtgRef3d":h=_[1][1],d=uf(_[1][2],a,i),y=x2(n,h,i),o.push(y+"!"+ff(d,s));break;case"PtgFunc":case"PtgFuncVar":var P=_[1][0],W=_[1][1];P||(P=0),P&=127;var B=P==0?[]:o.slice(-P);o.length-=P,W==="User"&&(W=B.shift()),o.push(W+"("+B.join(",")+")");break;case"PtgBool":o.push(_[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(_[1]);break;case"PtgNum":o.push(String(_[1]));break;case"PtgStr":o.push('"'+_[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(_[1]);break;case"PtgAreaN":m=G_(_[1][1],r?{s:r}:a,i),o.push(Sg(m,i));break;case"PtgArea":m=G_(_[1][1],a,i),o.push(Sg(m,i));break;case"PtgArea3d":h=_[1][1],m=_[1][2],y=x2(n,h,i),o.push(y+"!"+Sg(m,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":p=_[1][2];var w=(n.names||[])[p-1]||(n[0]||[])[p],F=w?w.Name:"SH33TJSNAME"+String(p);F&&F.slice(0,6)=="_xlfn."&&!i.xlfn&&(F=F.slice(6)),o.push(F);break;case"PtgNameX":var S=_[1][1];p=_[1][2];var b;if(i.biff<=5)S<0&&(S=-S),n[S]&&(b=n[S][p]);else{var N="";if(((n[S]||[])[0]||[])[0]==14849||(((n[S]||[])[0]||[])[0]==1025?n[S][p]&&n[S][p].itab>0&&(N=n.SheetNames[n[S][p].itab-1]+"!"):N=n.SheetNames[p-1]+"!"),n[S]&&n[S][p])N+=n[S][p].Name;else if(n[0]&&n[0][p])N+=n[0][p].Name;else{var D=(GA(n,S,i)||"").split(";;");D[p-1]?N=D[p-1]:N+="SH33TJSERRX"}o.push(N);break}b||(b={Name:"SH33TJSERRY"}),o.push(b.Name);break;case"PtgParen":var R="(",Ue=")";if(x>=0){switch(E="",t[0][x][1][0]){case 2:R=br(" ",t[0][x][1][1])+R;break;case 3:R=br("\r",t[0][x][1][1])+R;break;case 4:Ue=br(" ",t[0][x][1][1])+Ue;break;case 5:Ue=br("\r",t[0][x][1][1])+Ue;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][x][1][0])}x=-1}o.push(R+o.pop()+Ue);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":d={c:_[1][1],r:_[1][0]};var me={c:r.c,r:r.r};if(n.sharedf[ot(d)]){var Ie=n.sharedf[ot(d)];o.push(Vn(Ie,a,me,n,i))}else{var Te=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(d.c<c[0].s.c||d.c>c[0].e.c)&&!(d.r<c[0].s.r||d.r>c[0].e.r)){o.push(Vn(c[1],a,me,n,i)),Te=!0;break}Te||o.push(_[1])}break;case"PtgArray":o.push("{"+H8(_[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":x=T;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+_[1].idx+"[#"+_[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(_));default:throw new Error("Unrecognized Formula Token: "+String(_))}var _e=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&x>=0&&_e.indexOf(t[0][T][0])==-1){_=t[0][x];var Q=!0;switch(_[1][0]){case 4:Q=!1;case 0:E=br(" ",_[1][1]);break;case 5:Q=!1;case 1:E=br("\r",_[1][1]);break;default:if(E="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+_[1][0])}o.push((Q?E:"")+o.pop()+(Q?"":E)),x=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function K8(t,e,r){var n=t.l+e,i=r.biff==2?1:2,s,a=t.read_shift(i);if(a==65535)return[[],Kn(t,e-2)];var o=_0(t,a,r);return e!==a+i&&(s=y0(t,e-a-i,o,r)),t.l=n,[o,s]}function X8(t,e,r){var n=t.l+e,i=r.biff==2?1:2,s,a=t.read_shift(i);if(a==65535)return[[],Kn(t,e-2)];var o=_0(t,a,r);return e!==a+i&&(s=y0(t,e-a-i,o,r)),t.l=n,[o,s]}function Y8(t,e,r,n){var i=t.l+e,s=_0(t,n,r),a;return i!==t.l&&(a=y0(t,i-t.l,s,r)),[s,a]}function q8(t,e,r){var n=t.l+e,i,s=t.read_shift(2),a=_0(t,s,r);return s==65535?[[],Kn(t,e-2)]:(e!==s+2&&(i=y0(t,n-s-2,a,r)),[a,i])}function Q8(t){var e;if(_a(t,t.l+6)!==65535)return[Hn(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function J8(t){if(t==null){var e=pe(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return Al(t);return Al(0)}function Ig(t,e,r){var n=t.l+e,i=sa(t);r.biff==2&&++t.l;var s=Q8(t),a=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var o=X8(t,n-t.l,r);return{cell:i,val:s[0],formula:o,shared:a>>3&1,tt:s[1]}}function Z8(t,e,r,n,i){var s=Cl(e,r,i),a=J8(t.v),o=pe(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var c=pe(t.bf.length),d=0;d<t.bf.length;++d)c[d]=t.bf[d];var h=un([s,a,o,c]);return h}function bp(t,e,r){var n=t.read_shift(4),i=_0(t,n,r),s=t.read_shift(4),a=s>0?y0(t,s,i,r):null;return[i,a]}var e5=bp,Rp=bp,t5=bp,r5=bp,n5={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},KA={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},i5={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function v2(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function s5(t){var e="of:="+t.replace(q1,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function bg(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function a5(t){return t.replace(/\./,"!")}var hf={},Mc={},pf=typeof Map<"u";function Z1(t,e,r){var n=0,i=t.length;if(r){if(pf?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var s=pf?r.get(e):r[e];n<s.length;++n)if(t[s[n]].t===e)return t.Count++,s[n]}}else for(;n<i;++n)if(t[n].t===e)return t.Count++,n;return t[i]={t:e},t.Count++,t.Unique++,r&&(pf?(r.has(e)||r.set(e,[]),r.get(e).push(i)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(i))),i}function Np(t,e){var r={min:t+1,max:t+1},n=-1;return e.MDW&&(zn=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?n=Xf(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(r.width=Wh(n),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function gl(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function $o(t,e,r){var n=r.revssf[e.z!=null?e.z:"General"],i=60,s=t.length;if(n==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){ka(e.z,i),r.ssf[i]=e.z,r.revssf[e.z]=n=i;break}}for(i=0;i!=s;++i)if(t[i].numFmtId===n)return i;return t[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function XA(t,e,r,n,i,s){try{n.cellNF&&(t.z=at[e])}catch(o){if(n.WTF)throw o}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=ur(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(at[e]==null&&ka(nR[e]||"General",e),t.t==="e")t.w=t.w||za[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Uf(t.v);else if(t.t==="d"){var a=tn(t.v);(a|0)===a?t.w=a.toString(10):t.w=Uf(a)}else{if(t.v===void 0)return"";t.w=Tl(t.v,Mc)}else t.t==="d"?t.w=fs(e,tn(t.v),Mc):t.w=fs(e,t.v,Mc)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{t.s=s.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=zh(i.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=i.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=zh(i.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=i.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&s.Fills)throw o}}}function o5(t,e,r){if(t&&t["!ref"]){var n=Pt(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function l5(t,e){var r=Pt(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=xt(r))}var c5=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,u5=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,f5=/<(?:\w:)?hyperlink [^>]*>/mg,d5=/"(\w*:\w*)"/,h5=/<(?:\w:)?col\b[^>]*[\/]?>/g,p5=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,g5=/<(?:\w:)?pageMargins[^>]*\/>/g,YA=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,m5=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,x5=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function v5(t,e,r,n,i,s,a){if(!t)return t;n||(n={"!id":{}});var o=e.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",d="",h=t.match(u5);h?(c=t.slice(0,h.index),d=t.slice(h.index+h[0].length)):c=d=t;var p=c.match(YA);p?ev(p[0],o,i,r):(p=c.match(m5))&&_5(p[0],p[1]||"",o,i,r);var m=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(m>0){var y=c.slice(m,m+50).match(d5);y&&l5(o,y[1])}var x=c.match(x5);x&&x[1]&&D5(x[1],i);var E=[];if(e.cellStyles){var T=c.match(h5);T&&F5(E,T)}h&&M5(h[1],o,e,l,s,a);var A=d.match(p5);A&&(o["!autofilter"]=b5(A[0]));var _=[],P=d.match(c5);if(P)for(m=0;m!=P.length;++m)_[m]=Pt(P[m].slice(P[m].indexOf('"')+1));var W=d.match(f5);W&&A5(o,W,n);var B=d.match(g5);if(B&&(o["!margins"]=k5(lt(B[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=xt(l)),e.sheetRows>0&&o["!ref"]){var w=Pt(o["!ref"]);e.sheetRows<=+w.e.r&&(w.e.r=e.sheetRows-1,w.e.r>l.e.r&&(w.e.r=l.e.r),w.e.r<w.s.r&&(w.s.r=w.e.r),w.e.c>l.e.c&&(w.e.c=l.e.c),w.e.c<w.s.c&&(w.s.c=w.e.c),o["!fullref"]=o["!ref"],o["!ref"]=xt(w))}return E.length>0&&(o["!cols"]=E),_.length>0&&(o["!merges"]=_),o}function y5(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+xt(t[r])+'"/>';return e+"</mergeCells>"}function ev(t,e,r,n){var i=lt(t);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=Dt(Qt(i.codeName)))}function _5(t,e,r,n,i){ev(t.slice(0,t.indexOf(">")),r,n,i)}function E5(t,e,r,n,i){var s=!1,a={},o=null;if(n.bookType!=="xlsx"&&e.vbaraw){var l=e.SheetNames[r];try{e.Workbook&&(l=e.Workbook.Sheets[r].CodeName||l)}catch{}s=!0,a.codeName=Ys(Gt(l))}if(t&&t["!outline"]){var c={summaryBelow:1,summaryRight:1};t["!outline"].above&&(c.summaryBelow=0),t["!outline"].left&&(c.summaryRight=0),o=(o||"")+Be("outlinePr",null,c)}!s&&!o||(i[i.length]=Be("sheetPr",o,a))}var w5=["objects","scenarios","selectLockedCells","selectUnlockedCells"],T5=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function S5(t){var e={sheet:1};return w5.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),T5.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=K1(t.password).toString(16).toUpperCase()),Be("sheetProtection",null,e)}function A5(t,e,r){for(var n=Array.isArray(t),i=0;i!=e.length;++i){var s=lt(Qt(e[i]),!0);if(!s.ref)return;var a=((r||{})["!id"]||[])[s.id];a?(s.Target=a.Target,s.location&&(s.Target+="#"+Dt(s.location))):(s.Target="#"+Dt(s.location),a={Target:s.Target,TargetMode:"Internal"}),s.Rel=a,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=Pt(s.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var d=ot({c,r:l});n?(t[l]||(t[l]=[]),t[l][c]||(t[l][c]={t:"z",v:void 0}),t[l][c].l=s):(t[d]||(t[d]={t:"z",v:void 0}),t[d].l=s)}}}function k5(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function C5(t){return gl(t),Be("pageMargins",null,t)}function F5(t,e){for(var r=!1,n=0;n!=e.length;++n){var i=lt(e[n],!0);i.hidden&&(i.hidden=lr(i.hidden));var s=parseInt(i.min,10)-1,a=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,X1(i.width)),Po(i);s<=a;)t[s++]=fr(i)}}function I5(t,e){for(var r=["<cols>"],n,i=0;i!=e.length;++i)(n=e[i])&&(r[r.length]=Be("col",null,Np(i,n)));return r[r.length]="</cols>",r.join("")}function b5(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}function R5(t,e,r,n){var i=typeof t.ref=="string"?t.ref:xt(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,a=Ai(i);a.s.r==a.e.r&&(a.e.r=Ai(e["!ref"]).e.r,i=xt(a));for(var o=0;o<s.length;++o){var l=s[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+i;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),Be("autoFilter",null,{ref:i})}var N5=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function D5(t,e){e.Views||(e.Views=[{}]),(t.match(N5)||[]).forEach(function(r,n){var i=lt(r);e.Views[n]||(e.Views[n]={}),+i.zoomScale&&(e.Views[n].zoom=+i.zoomScale),lr(i.rightToLeft)&&(e.Views[n].RTL=!0)})}function P5(t,e,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Be("sheetViews",Be("sheetView",null,i),{})}function O5(t,e,r,n){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var i="",s=t.t,a=t.v;if(t.t!=="z")switch(t.t){case"b":i=t.v?"1":"0";break;case"n":i=""+t.v;break;case"e":i=za[t.v];break;case"d":n&&n.cellDates?i=ur(t.v,-1).toISOString():(t=fr(t),t.t="n",i=""+(t.v=tn(ur(t.v)))),typeof t.z>"u"&&(t.z=at[14]);break;default:i=t.v;break}var o=kn("v",Gt(i)),l={r:e},c=$o(n.cellXfs,t,n);switch(c!==0&&(l.s=c),t.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=kn("v",""+Z1(n.Strings,t.v,n.revStrings)),l.t="s";break}l.t="str";break}if(t.t!=s&&(t.t=s,t.v=a),typeof t.f=="string"&&t.f){var d=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;o=Be("f",Gt(t.f),d)+(t.v!=null?o:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(l.cm=1),Be("c",o,l)}var M5=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,s=zf("v"),a=zf("f");return function(l,c,d,h,p,m){for(var y=0,x="",E=[],T=[],A=0,_=0,P=0,W="",B,w,F=0,S=0,b,N,D=0,R=0,Ue=Array.isArray(m.CellXf),me,Ie=[],Te=[],_e=Array.isArray(c),Q=[],ke={},Le=!1,j=!!d.sheetStubs,H=l.split(e),q=0,Y=H.length;q!=Y;++q){x=H[q].trim();var de=x.length;if(de!==0){var Se=0;e:for(y=0;y<de;++y)switch(x[y]){case">":if(x[y-1]!="/"){++y;break e}if(d&&d.cellStyles){if(w=lt(x.slice(Se,y),!0),F=w.r!=null?parseInt(w.r,10):F+1,S=-1,d.sheetRows&&d.sheetRows<F)continue;ke={},Le=!1,w.ht&&(Le=!0,ke.hpt=parseFloat(w.ht),ke.hpx=qc(ke.hpt)),w.hidden=="1"&&(Le=!0,ke.hidden=!0),w.outlineLevel!=null&&(Le=!0,ke.level=+w.outlineLevel),Le&&(Q[F-1]=ke)}break;case"<":Se=y;break}if(Se>=y)break;if(w=lt(x.slice(Se,y),!0),F=w.r!=null?parseInt(w.r,10):F+1,S=-1,!(d.sheetRows&&d.sheetRows<F)){h.s.r>F-1&&(h.s.r=F-1),h.e.r<F-1&&(h.e.r=F-1),d&&d.cellStyles&&(ke={},Le=!1,w.ht&&(Le=!0,ke.hpt=parseFloat(w.ht),ke.hpx=qc(ke.hpt)),w.hidden=="1"&&(Le=!0,ke.hidden=!0),w.outlineLevel!=null&&(Le=!0,ke.level=+w.outlineLevel),Le&&(Q[F-1]=ke)),E=x.slice(y).split(t);for(var Ne=0;Ne!=E.length&&E[Ne].trim().charAt(0)=="<";++Ne);for(E=E.slice(Ne),y=0;y!=E.length;++y)if(x=E[y].trim(),x.length!==0){if(T=x.match(r),A=y,_=0,P=0,x="<c "+(x.slice(0,1)=="<"?">":"")+x,T!=null&&T.length===2){for(A=0,W=T[1],_=0;_!=W.length&&!((P=W.charCodeAt(_)-64)<1||P>26);++_)A=26*A+P;--A,S=A}else++S;for(_=0;_!=x.length&&x.charCodeAt(_)!==62;++_);if(++_,w=lt(x.slice(0,_),!0),w.r||(w.r=ot({r:F-1,c:S})),W=x.slice(_),B={t:""},(T=W.match(s))!=null&&T[1]!==""&&(B.v=Dt(T[1])),d.cellFormula){if((T=W.match(a))!=null&&T[1]!==""){if(B.f=Dt(Qt(T[1])).replace(/\r\n/g,`
`),d.xlfn||(B.f=p2(B.f)),T[0].indexOf('t="array"')>-1)B.F=(W.match(i)||[])[1],B.F.indexOf(":")>-1&&Ie.push([Pt(B.F),B.F]);else if(T[0].indexOf('t="shared"')>-1){N=lt(T[0]);var Ae=Dt(Qt(T[1]));d.xlfn||(Ae=p2(Ae)),Te[parseInt(N.si,10)]=[N,Ae,w.r]}}else(T=W.match(/<f[^>]*\/>/))&&(N=lt(T[0]),Te[N.si]&&(B.f=N6(Te[N.si][1],Te[N.si][2],w.r)));var we=Sr(w.r);for(_=0;_<Ie.length;++_)we.r>=Ie[_][0].s.r&&we.r<=Ie[_][0].e.r&&we.c>=Ie[_][0].s.c&&we.c<=Ie[_][0].e.c&&(B.F=Ie[_][1])}if(w.t==null&&B.v===void 0)if(B.f||B.F)B.v=0,B.t="n";else if(j)B.t="z";else continue;else B.t=w.t||"n";switch(h.s.c>S&&(h.s.c=S),h.e.c<S&&(h.e.c=S),B.t){case"n":if(B.v==""||B.v==null){if(!j)continue;B.t="z"}else B.v=parseFloat(B.v);break;case"s":if(typeof B.v>"u"){if(!j)continue;B.t="z"}else b=hf[parseInt(B.v,10)],B.v=b.t,B.r=b.r,d.cellHTML&&(B.h=b.h);break;case"str":B.t="s",B.v=B.v!=null?Qt(B.v):"",d.cellHTML&&(B.h=N1(B.v));break;case"inlineStr":T=W.match(n),B.t="s",T!=null&&(b=G1(T[1]))?(B.v=b.t,d.cellHTML&&(B.h=b.h)):B.v="";break;case"b":B.v=lr(B.v);break;case"d":d.cellDates?B.v=ur(B.v,1):(B.v=tn(ur(B.v,1)),B.t="n");break;case"e":(!d||d.cellText!==!1)&&(B.w=B.v),B.v=QS[B.v];break}if(D=R=0,me=null,Ue&&w.s!==void 0&&(me=m.CellXf[w.s],me!=null&&(me.numFmtId!=null&&(D=me.numFmtId),d.cellStyles&&me.fillId!=null&&(R=me.fillId))),XA(B,D,R,d,p,m),d.cellDates&&Ue&&B.t=="n"&&cu(at[D])&&(B.t="d",B.v=Fp(B.v)),w.cm&&d.xlmeta){var it=(d.xlmeta.Cell||[])[+w.cm-1];it&&it.type=="XLDAPR"&&(B.D=!0)}if(_e){var G=Sr(w.r);c[G.r]||(c[G.r]=[]),c[G.r][G.c]=B}else c[w.r]=B}}}}Q.length>0&&(c["!rows"]=Q)}}();function L5(t,e,r,n){var i=[],s=[],a=Pt(t["!ref"]),o="",l,c="",d=[],h=0,p=0,m=t["!rows"],y=Array.isArray(t),x={r:c},E,T=-1;for(p=a.s.c;p<=a.e.c;++p)d[p]=Tr(p);for(h=a.s.r;h<=a.e.r;++h){for(s=[],c=Lr(h),p=a.s.c;p<=a.e.c;++p){l=d[p]+c;var A=y?(t[h]||[])[p]:t[l];A!==void 0&&(o=O5(A,l,t,e))!=null&&s.push(o)}(s.length>0||m&&m[h])&&(x={r:c},m&&m[h]&&(E=m[h],E.hidden&&(x.hidden=1),T=-1,E.hpx?T=Yf(E.hpx):E.hpt&&(T=E.hpt),T>-1&&(x.ht=T,x.customHeight=1),E.level&&(x.outlineLevel=E.level)),i[i.length]=Be("row",s.join(""),x))}if(m)for(;h<m.length;++h)m&&m[h]&&(x={r:h+1},E=m[h],E.hidden&&(x.hidden=1),T=-1,E.hpx?T=Yf(E.hpx):E.hpt&&(T=E.hpt),T>-1&&(x.ht=T,x.customHeight=1),E.level&&(x.outlineLevel=E.level),i[i.length]=Be("row","",x));return i.join("")}function qA(t,e,r,n){var i=[Br,Be("worksheet",null,{xmlns:Ml[0],"xmlns:r":Qr.r})],s=r.SheetNames[t],a=0,o="",l=r.Sheets[s];l==null&&(l={});var c=l["!ref"]||"A1",d=Pt(c);if(d.e.c>16383||d.e.r>1048575){if(e.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),c=xt(d)}n||(n={}),l["!comments"]=[];var h=[];E5(l,r,t,e,i),i[i.length]=Be("dimension",null,{ref:c}),i[i.length]=P5(l,e,t,r),e.sheetFormat&&(i[i.length]=Be("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(i[i.length]=I5(l,l["!cols"])),i[a=i.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=L5(l,e),o.length>0&&(i[i.length]=o)),i.length>a+1&&(i[i.length]="</sheetData>",i[a]=i[a].replace("/>",">")),l["!protect"]&&(i[i.length]=S5(l["!protect"])),l["!autofilter"]!=null&&(i[i.length]=R5(l["!autofilter"],l,r,t)),l["!merges"]!=null&&l["!merges"].length>0&&(i[i.length]=y5(l["!merges"]));var p=-1,m,y=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(x){x[1].Target&&(m={ref:x[0]},x[1].Target.charAt(0)!="#"&&(y=$t(n,-1,Gt(x[1].Target).replace(/#.*$/,""),_t.HLINK),m["r:id"]="rId"+y),(p=x[1].Target.indexOf("#"))>-1&&(m.location=Gt(x[1].Target.slice(p+1))),x[1].Tooltip&&(m.tooltip=Gt(x[1].Tooltip)),i[i.length]=Be("hyperlink",null,m))}),i[i.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(i[i.length]=C5(l["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(i[i.length]=kn("ignoredErrors",Be("ignoredError",null,{numberStoredAsText:1,sqref:c}))),h.length>0&&(y=$t(n,-1,"../drawings/drawing"+(t+1)+".xml",_t.DRAW),i[i.length]=Be("drawing",null,{"r:id":"rId"+y}),l["!drawing"]=h),l["!comments"].length>0&&(y=$t(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",_t.VML),i[i.length]=Be("legacyDrawing",null,{"r:id":"rId"+y}),l["!legacy"]=y),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function B5(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var i=t.read_shift(2);t.l+=1;var s=t.read_shift(1);return t.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=i/20),r}function j5(t,e,r){var n=pe(145),i=(r["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var s=320;i.hpx?s=Yf(i.hpx)*20:i.hpt&&(s=i.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var a=0;i.level&&(a|=i.level),i.hidden&&(a|=16),(i.hpx||i.hpt)&&(a|=32),n.write_shift(1,a),n.write_shift(1,0);var o=0,l=n.l;n.l+=4;for(var c={r:t,c:0},d=0;d<16;++d)if(!(e.s.c>d+1<<10||e.e.c<d<<10)){for(var h=-1,p=-1,m=d<<10;m<d+1<<10;++m){c.c=m;var y=Array.isArray(r)?(r[c.r]||[])[c.c]:r[ot(c)];y&&(h<0&&(h=m),p=m)}h<0||(++o,n.write_shift(4,h),n.write_shift(4,p))}var x=n.l;return n.l=l,n.write_shift(4,o),n.l=x,n.length>n.l?n.slice(0,n.l):n}function V5(t,e,r,n){var i=j5(n,r,e);(i.length>17||(e["!rows"]||[])[n])&&Ee(t,0,i)}var U5=Vl,z5=du;function W5(){}function H5(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=KR(t),r}function $5(t,e,r){r==null&&(r=pe(84+4*t.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),r.write_shift(1,n);for(var i=1;i<3;++i)r.write_shift(1,0);return jh({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),GS(t,r),r.slice(0,r.l)}function G5(t){var e=ds(t);return[e]}function K5(t,e,r){return r==null&&(r=pe(8)),Ll(e,r)}function X5(t){var e=Bl(t);return[e]}function Y5(t,e,r){return r==null&&(r=pe(4)),jl(e,r)}function q5(t){var e=ds(t),r=t.read_shift(1);return[e,r,"b"]}function Q5(t,e,r){return r==null&&(r=pe(9)),Ll(e,r),r.write_shift(1,t.v?1:0),r}function J5(t){var e=Bl(t),r=t.read_shift(1);return[e,r,"b"]}function Z5(t,e,r){return r==null&&(r=pe(5)),jl(e,r),r.write_shift(1,t.v?1:0),r}function eO(t){var e=ds(t),r=t.read_shift(1);return[e,r,"e"]}function tO(t,e,r){return r==null&&(r=pe(9)),Ll(e,r),r.write_shift(1,t.v),r}function rO(t){var e=Bl(t),r=t.read_shift(1);return[e,r,"e"]}function nO(t,e,r){return r==null&&(r=pe(8)),jl(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function iO(t){var e=ds(t),r=t.read_shift(4);return[e,r,"s"]}function sO(t,e,r){return r==null&&(r=pe(12)),Ll(e,r),r.write_shift(4,e.v),r}function aO(t){var e=Bl(t),r=t.read_shift(4);return[e,r,"s"]}function oO(t,e,r){return r==null&&(r=pe(8)),jl(e,r),r.write_shift(4,e.v),r}function lO(t){var e=ds(t),r=Hn(t);return[e,r,"n"]}function cO(t,e,r){return r==null&&(r=pe(16)),Ll(e,r),Al(t.v,r),r}function QA(t){var e=Bl(t),r=Hn(t);return[e,r,"n"]}function uO(t,e,r){return r==null&&(r=pe(12)),jl(e,r),Al(t.v,r),r}function fO(t){var e=ds(t),r=U1(t);return[e,r,"n"]}function dO(t,e,r){return r==null&&(r=pe(12)),Ll(e,r),KS(t.v,r),r}function hO(t){var e=Bl(t),r=U1(t);return[e,r,"n"]}function pO(t,e,r){return r==null&&(r=pe(8)),jl(e,r),KS(t.v,r),r}function gO(t){var e=ds(t),r=B1(t);return[e,r,"is"]}function mO(t){var e=ds(t),r=$n(t);return[e,r,"str"]}function xO(t,e,r){return r==null&&(r=pe(12+4*t.v.length)),Ll(e,r),fn(t.v,r),r.length>r.l?r.slice(0,r.l):r}function vO(t){var e=Bl(t),r=$n(t);return[e,r,"str"]}function yO(t,e,r){return r==null&&(r=pe(8+4*t.v.length)),jl(e,r),fn(t.v,r),r.length>r.l?r.slice(0,r.l):r}function _O(t,e,r){var n=t.l+e,i=ds(t);i.r=r["!row"];var s=t.read_shift(1),a=[i,s,"b"];if(r.cellFormula){t.l+=2;var o=Rp(t,n-t.l,r);a[3]=Vn(o,null,i,r.supbooks,r)}else t.l=n;return a}function EO(t,e,r){var n=t.l+e,i=ds(t);i.r=r["!row"];var s=t.read_shift(1),a=[i,s,"e"];if(r.cellFormula){t.l+=2;var o=Rp(t,n-t.l,r);a[3]=Vn(o,null,i,r.supbooks,r)}else t.l=n;return a}function wO(t,e,r){var n=t.l+e,i=ds(t);i.r=r["!row"];var s=Hn(t),a=[i,s,"n"];if(r.cellFormula){t.l+=2;var o=Rp(t,n-t.l,r);a[3]=Vn(o,null,i,r.supbooks,r)}else t.l=n;return a}function TO(t,e,r){var n=t.l+e,i=ds(t);i.r=r["!row"];var s=$n(t),a=[i,s,"str"];if(r.cellFormula){t.l+=2;var o=Rp(t,n-t.l,r);a[3]=Vn(o,null,i,r.supbooks,r)}else t.l=n;return a}var SO=Vl,AO=du;function kO(t,e){return e==null&&(e=pe(4)),e.write_shift(4,t),e}function CO(t,e){var r=t.l+e,n=Vl(t),i=j1(t),s=$n(t),a=$n(t),o=$n(t);t.l=r;var l={rfx:n,relId:i,loc:s,display:o};return a&&(l.Tooltip=a),l}function FO(t,e){var r=pe(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));du({s:Sr(t[0]),e:Sr(t[0])},r),V1("rId"+e,r);var n=t[1].Target.indexOf("#"),i=n==-1?"":t[1].Target.slice(n+1);return fn(i||"",r),fn(t[1].Tooltip||"",r),fn("",r),r.slice(0,r.l)}function IO(){}function bO(t,e,r){var n=t.l+e,i=XS(t),s=t.read_shift(1),a=[i];if(a[2]=s,r.cellFormula){var o=e5(t,n-t.l,r);a[1]=o}else t.l=n;return a}function RO(t,e,r){var n=t.l+e,i=Vl(t),s=[i];if(r.cellFormula){var a=r5(t,n-t.l,r);s[1]=a,t.l=n}else t.l=n;return s}function NO(t,e,r){r==null&&(r=pe(18));var n=Np(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var i=0;return e.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),e.level&&(i|=e.level<<8),r.write_shift(2,i),r}var JA=["left","right","top","bottom","header","footer"];function DO(t){var e={};return JA.forEach(function(r){e[r]=Hn(t)}),e}function PO(t,e){return e==null&&(e=pe(6*8)),gl(t),JA.forEach(function(r){Al(t[r],e)}),e}function OO(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function MO(t,e,r){r==null&&(r=pe(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function LO(t){var e=pe(24);return e.write_shift(4,4),e.write_shift(4,1),du(t,e),e}function BO(t,e){return e==null&&(e=pe(16*4+2)),e.write_shift(2,t.password?K1(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function jO(){}function VO(){}function UO(t,e,r,n,i,s,a){if(!t)return t;var o=e||{};n||(n={"!id":{}});var l=o.dense?[]:{},c,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},h=!1,p=!1,m,y,x,E,T,A,_,P,W,B=[];o.biff=12,o["!row"]=0;var w=0,F=!1,S=[],b={},N=o.supbooks||i.supbooks||[[]];if(N.sharedf=b,N.arrayf=S,N.SheetNames=i.SheetNames||i.Sheets.map(function(_e){return _e.name}),!o.supbooks&&(o.supbooks=N,i.Names))for(var D=0;D<i.Names.length;++D)N[0][D+1]=i.Names[D];var R=[],Ue=[],me=!1;qf[16]={n:"BrtShortReal",f:QA};var Ie;if(Ua(t,function(Q,ke,Le){if(!p)switch(Le){case 148:c=Q;break;case 0:m=Q,o.sheetRows&&o.sheetRows<=m.r&&(p=!0),P=Lr(E=m.r),o["!row"]=m.r,(Q.hidden||Q.hpt||Q.level!=null)&&(Q.hpt&&(Q.hpx=qc(Q.hpt)),Ue[Q.r]=Q);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(y={t:Q[2]},Q[2]){case"n":y.v=Q[1];break;case"s":_=hf[Q[1]],y.v=_.t,y.r=_.r;break;case"b":y.v=!!Q[1];break;case"e":y.v=Q[1],o.cellText!==!1&&(y.w=za[y.v]);break;case"str":y.t="s",y.v=Q[1];break;case"is":y.t="s",y.v=Q[1].t;break}if((x=a.CellXf[Q[0].iStyleRef])&&XA(y,x.numFmtId,null,o,s,a),T=Q[0].c==-1?T+1:Q[0].c,o.dense?(l[E]||(l[E]=[]),l[E][T]=y):l[Tr(T)+P]=y,o.cellFormula){for(F=!1,w=0;w<S.length;++w){var j=S[w];m.r>=j[0].s.r&&m.r<=j[0].e.r&&T>=j[0].s.c&&T<=j[0].e.c&&(y.F=xt(j[0]),F=!0)}!F&&Q.length>3&&(y.f=Q[3])}if(d.s.r>m.r&&(d.s.r=m.r),d.s.c>T&&(d.s.c=T),d.e.r<m.r&&(d.e.r=m.r),d.e.c<T&&(d.e.c=T),o.cellDates&&x&&y.t=="n"&&cu(at[x.numFmtId])){var H=ll(y.v);H&&(y.t="d",y.v=new Date(H.y,H.m-1,H.d,H.H,H.M,H.S,H.u))}Ie&&(Ie.type=="XLDAPR"&&(y.D=!0),Ie=void 0);break;case 1:case 12:if(!o.sheetStubs||h)break;y={t:"z",v:void 0},T=Q[0].c==-1?T+1:Q[0].c,o.dense?(l[E]||(l[E]=[]),l[E][T]=y):l[Tr(T)+P]=y,d.s.r>m.r&&(d.s.r=m.r),d.s.c>T&&(d.s.c=T),d.e.r<m.r&&(d.e.r=m.r),d.e.c<T&&(d.e.c=T),Ie&&(Ie.type=="XLDAPR"&&(y.D=!0),Ie=void 0);break;case 176:B.push(Q);break;case 49:Ie=((o.xlmeta||{}).Cell||[])[Q-1];break;case 494:var q=n["!id"][Q.relId];for(q?(Q.Target=q.Target,Q.loc&&(Q.Target+="#"+Q.loc),Q.Rel=q):Q.relId==""&&(Q.Target="#"+Q.loc),E=Q.rfx.s.r;E<=Q.rfx.e.r;++E)for(T=Q.rfx.s.c;T<=Q.rfx.e.c;++T)o.dense?(l[E]||(l[E]=[]),l[E][T]||(l[E][T]={t:"z",v:void 0}),l[E][T].l=Q):(A=ot({c:T,r:E}),l[A]||(l[A]={t:"z",v:void 0}),l[A].l=Q);break;case 426:if(!o.cellFormula)break;S.push(Q),W=o.dense?l[E][T]:l[Tr(T)+P],W.f=Vn(Q[1],d,{r:m.r,c:T},N,o),W.F=xt(Q[0]);break;case 427:if(!o.cellFormula)break;b[ot(Q[0].s)]=Q[1],W=o.dense?l[E][T]:l[Tr(T)+P],W.f=Vn(Q[1],d,{r:m.r,c:T},N,o);break;case 60:if(!o.cellStyles)break;for(;Q.e>=Q.s;)R[Q.e--]={width:Q.w/256,hidden:!!(Q.flags&1),level:Q.level},me||(me=!0,X1(Q.w/256)),Po(R[Q.e+1]);break;case 161:l["!autofilter"]={ref:xt(Q)};break;case 476:l["!margins"]=Q;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),Q.name&&(i.Sheets[r].CodeName=Q.name),(Q.above||Q.left)&&(l["!outline"]={above:Q.above,left:Q.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),Q.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:h=!0;break;case 36:h=!1;break;case 37:h=!0;break;case 38:h=!1;break;default:if(!ke.T){if(!h||o.WTF)throw new Error("Unexpected record 0x"+Le.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(d.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(l["!ref"]=xt(c||d)),o.sheetRows&&l["!ref"]){var Te=Pt(l["!ref"]);o.sheetRows<=+Te.e.r&&(Te.e.r=o.sheetRows-1,Te.e.r>d.e.r&&(Te.e.r=d.e.r),Te.e.r<Te.s.r&&(Te.s.r=Te.e.r),Te.e.c>d.e.c&&(Te.e.c=d.e.c),Te.e.c<Te.s.c&&(Te.s.c=Te.e.c),l["!fullref"]=l["!ref"],l["!ref"]=xt(Te))}return B.length>0&&(l["!merges"]=B),R.length>0&&(l["!cols"]=R),Ue.length>0&&(l["!rows"]=Ue),l}function zO(t,e,r,n,i,s,a){if(e.v===void 0)return!1;var o="";switch(e.t){case"b":o=e.v?"1":"0";break;case"d":e=fr(e),e.z=e.z||at[14],e.v=tn(ur(e.v)),e.t="n";break;case"n":case"e":o=""+e.v;break;default:o=e.v;break}var l={r,c:n};switch(l.s=$o(i.cellXfs,e,i),e.l&&s["!links"].push([ot(l),e.l]),e.c&&s["!comments"].push([ot(l),e.c]),e.t){case"s":case"str":return i.bookSST?(o=Z1(i.Strings,e.v,i.revStrings),l.t="s",l.v=o,a?Ee(t,18,oO(e,l)):Ee(t,7,sO(e,l))):(l.t="str",a?Ee(t,17,yO(e,l)):Ee(t,6,xO(e,l))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?a?Ee(t,13,pO(e,l)):Ee(t,2,dO(e,l)):a?Ee(t,16,uO(e,l)):Ee(t,5,cO(e,l)),!0;case"b":return l.t="b",a?Ee(t,15,Z5(e,l)):Ee(t,4,Q5(e,l)),!0;case"e":return l.t="e",a?Ee(t,14,nO(e,l)):Ee(t,3,tO(e,l)),!0}return a?Ee(t,12,Y5(e,l)):Ee(t,1,K5(e,l)),!0}function WO(t,e,r,n){var i=Pt(e["!ref"]||"A1"),s,a="",o=[];Ee(t,145);var l=Array.isArray(e),c=i.e.r;e["!rows"]&&(c=Math.max(i.e.r,e["!rows"].length-1));for(var d=i.s.r;d<=c;++d){a=Lr(d),V5(t,e,i,d);var h=!1;if(d<=i.e.r)for(var p=i.s.c;p<=i.e.c;++p){d===i.s.r&&(o[p]=Tr(p)),s=o[p]+a;var m=l?(e[d]||[])[p]:e[s];if(!m){h=!1;continue}h=zO(t,m,d,p,n,e,h)}}Ee(t,146)}function HO(t,e){!e||!e["!merges"]||(Ee(t,177,kO(e["!merges"].length)),e["!merges"].forEach(function(r){Ee(t,176,AO(r))}),Ee(t,178))}function $O(t,e){!e||!e["!cols"]||(Ee(t,390),e["!cols"].forEach(function(r,n){r&&Ee(t,60,NO(n,r))}),Ee(t,391))}function GO(t,e){!e||!e["!ref"]||(Ee(t,648),Ee(t,649,LO(Pt(e["!ref"]))),Ee(t,650))}function KO(t,e,r){e["!links"].forEach(function(n){if(n[1].Target){var i=$t(r,-1,n[1].Target.replace(/#.*$/,""),_t.HLINK);Ee(t,494,FO(n,i))}}),delete e["!links"]}function XO(t,e,r,n){if(e["!comments"].length>0){var i=$t(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",_t.VML);Ee(t,551,V1("rId"+i)),e["!legacy"]=i}}function YO(t,e,r,n){if(e["!autofilter"]){var i=e["!autofilter"],s=typeof i.ref=="string"?i.ref:xt(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,o=Ai(s);o.s.r==o.e.r&&(o.e.r=Ai(e["!ref"]).e.r,s=xt(o));for(var l=0;l<a.length;++l){var c=a[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+s;break}}l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),Ee(t,161,du(Pt(s))),Ee(t,162)}}function qO(t,e,r){Ee(t,133),Ee(t,137,MO(e,r)),Ee(t,138),Ee(t,134)}function QO(t,e){e["!protect"]&&Ee(t,535,BO(e["!protect"]))}function JO(t,e,r,n){var i=Si(),s=r.SheetNames[t],a=r.Sheets[s]||{},o=s;try{r&&r.Workbook&&(o=r.Workbook.Sheets[t].CodeName||o)}catch{}var l=Pt(a["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(e.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],Ee(i,129),(r.vbaraw||a["!outline"])&&Ee(i,147,$5(o,a["!outline"])),Ee(i,148,z5(l)),qO(i,a,r.Workbook),$O(i,a),WO(i,a,t,e),QO(i,a),YO(i,a,r,t),HO(i,a),KO(i,a,n),a["!margins"]&&Ee(i,476,PO(a["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&GO(i,a),XO(i,a,t,n),Ee(i,130),i.end()}function ZO(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var a=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);a&&(e[+a[1]]=r?+a[2]:a[2])});var i=Dt((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[e,i,n]}function eM(t,e,r,n,i,s){var a=s||{"!type":"chart"};if(!t)return s;var o=0,l=0,c="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(h){var p=ZO(h);d.s.r=d.s.c=0,d.e.c=o,c=Tr(o),p[0].forEach(function(m,y){a[c+Lr(y)]={t:"n",v:m,z:p[1]},l=y}),d.e.r<l&&(d.e.r=l),++o}),o>0&&(a["!ref"]=xt(d)),a}function tM(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a,o=t.match(YA);return o&&ev(o[0],s,i,r),(a=t.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=a[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function rM(t,e){t.l+=10;var r=$n(t);return{name:r}}function nM(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a=!1;return Ua(t,function(l,c,d){switch(d){case 550:s["!rel"]=l;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),l.name&&(i.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!(c.T>0)){if(!(c.T<0)){if(!a||e.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},e),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var tv=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],iM=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],sM=[],aM=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function y2(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],i=0;i!=e.length;++i){var s=e[i];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=lr(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function _2(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=lr(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function ZA(t){_2(t.WBProps,tv),_2(t.CalcPr,aM),y2(t.WBView,iM),y2(t.Sheets,sM),Mc.date1904=lr(t.WBProps.date1904)}function oM(t){return!t.Workbook||!t.Workbook.WBProps?"false":lr(t.Workbook.WBProps.date1904)?"true":"false"}var lM="][*?/\\".split("");function ek(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return lM.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function cM(t,e,r){t.forEach(function(n,i){ek(n);for(var s=0;s<i;++s)if(n==t[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var a=e&&e[i]&&e[i].CodeName||n;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function uM(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];cM(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)o5(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}var fM=/<\w+:workbook/;function dM(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",s={},a=0;if(t.replace(Yn,function(l,c){var d=lt(l);switch(ia(d[0])){case"<?xml":break;case"<workbook":l.match(fM)&&(i="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=d[i];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":tv.forEach(function(h){if(d[h[0]]!=null)switch(h[2]){case"bool":r.WBProps[h[0]]=lr(d[h[0]]);break;case"int":r.WBProps[h[0]]=parseInt(d[h[0]],10);break;default:r.WBProps[h[0]]=d[h[0]]}}),d.codeName&&(r.WBProps.CodeName=Qt(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=Dt(Qt(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=Qt(d.name),d.comment&&(s.Comment=d.comment),d.localSheetId&&(s.Sheet=+d.localSheetId),lr(d.hidden||"0")&&(s.Hidden=!0),a=c+l.length;break;case"</definedName>":s.Ref=Dt(Qt(t.slice(a,c))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return l}),Ml.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return ZA(r),r}function tk(t){var e=[Br];e[e.length]=Be("workbook",null,{xmlns:Ml[0],"xmlns:r":Qr.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(tv.forEach(function(o){t.Workbook.WBProps[o[0]]!=null&&t.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=t.Workbook.WBProps[o[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=Be("workbookPr",null,n);var i=t.Workbook&&t.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(e[e.length]="<bookViews>",s=0;s!=t.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==t.SheetNames.length&&(s=0),e[e.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",s=0;s!=t.SheetNames.length;++s){var a={name:Gt(t.SheetNames[s].slice(0,31))};if(a.sheetId=""+(s+1),a["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}e[e.length]=Be("sheet",null,a)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(e[e.length]=Be("definedName",Gt(o.Ref),l))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function hM(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=Ym(t),r.name=$n(t),r}function pM(t,e){return e||(e=pe(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),V1(t.strRelID,e),fn(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function gM(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var i=e>8?$n(t):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function mM(t,e){e||(e=pe(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),GS(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function xM(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function vM(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var i=t.read_shift(4),s=XR(t),a=t5(t,0,r),o=j1(t);t.l=n;var l={Name:s,Ptg:a};return i<268435455&&(l.Sheet=i),o&&(l.Comment=o),l}function yM(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;e||(e={}),e.biff=12;var s=[],a=[[]];return a.SheetNames=[],a.XTI=[],qf[16]={n:"BrtFRTArchID$",f:xM},Ua(t,function(l,c,d){switch(d){case 156:a.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(e.SID=l.Sheet),l.Ref=Vn(l.Ptg,null,null,a,e),delete e.SID,delete l.Ptg,s.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:a[0].length?a.push([d,l]):a[0]=[d,l],a[a.length-1].XTI=[];break;case 362:a.length===0&&(a[0]=[],a[0].XTI=[]),a[a.length-1].XTI=a[a.length-1].XTI.concat(l),a.XTI=a.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(d),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(d),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!c.T){if(!i||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},e),ZA(r),r.Names=s,r.supbooks=a,r}function _M(t,e){Ee(t,143);for(var r=0;r!=e.SheetNames.length;++r){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,i={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};Ee(t,156,pM(i))}Ee(t,144)}function EM(t,e){e||(e=pe(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return fn("SheetJS",e),fn(Nh.version,e),fn(Nh.version,e),fn("7262",e),e.length>e.l?e.slice(0,e.l):e}function wM(t,e){e||(e=pe(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function TM(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,n=0,i=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&i==-1?i=n:r[n].Hidden==1&&s==-1&&(s=n);s>i||(Ee(t,135),Ee(t,158,wM(i)),Ee(t,136))}}function SM(t,e){var r=Si();return Ee(r,131),Ee(r,128,EM()),Ee(r,153,mM(t.Workbook&&t.Workbook.WBProps||null)),TM(r,t),_M(r,t),Ee(r,132),r.end()}function AM(t,e,r){return e.slice(-4)===".bin"?yM(t,r):dM(t,r)}function kM(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?UO(t,n,r,i,s,a,o):v5(t,n,r,i,s,a,o)}function CM(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?nM(t,n,r,i,s):tM(t,n,r,i,s)}function FM(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?b6():R6()}function IM(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?F6():I6()}function bM(t,e,r,n){return e.slice(-4)===".bin"?AP(t,r,n):hP(t,r,n)}function RM(t,e,r){return OA(t,r)}function NM(t,e,r){return e.slice(-4)===".bin"?ND(t,r):ID(t,r)}function DM(t,e,r){return e.slice(-4)===".bin"?T6(t,r):p6(t,r)}function PM(t,e,r){return e.slice(-4)===".bin"?f6(t):c6(t)}function OM(t,e,r,n){return r.slice(-4)===".bin"?d6(t,e,r,n):void 0}function MM(t,e,r){return e.slice(-4)===".bin"?a6(t,e,r):l6(t,e,r)}function LM(t,e,r){return(e.slice(-4)===".bin"?SM:tk)(t)}function BM(t,e,r,n,i){return(e.slice(-4)===".bin"?JO:qA)(t,r,n,i)}function jM(t,e,r){return(e.slice(-4)===".bin"?OP:DA)(t,r)}function VM(t,e,r){return(e.slice(-4)===".bin"?OD:AA)(t,r)}function UM(t,e,r){return(e.slice(-4)===".bin"?S6:BA)(t)}function zM(t){return(t.slice(-4)===".bin"?o6:MA)()}var rk=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,nk=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Es(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var i=t.match(rk),s,a,o,l;if(i)for(l=0;l!=i.length;++l)s=i[l].match(nk),(a=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(a+1),n[o]=s[2].slice(1,s[2].length-1));return n}function WM(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(rk),i,s,a,o;if(n)for(o=0;o!=n.length;++o)i=n[o].match(nk),(s=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?a="xmlns"+i[1].slice(6):a=i[1].slice(s+1),r[a]=i[2].slice(1,i[2].length-1));return r}var gf;function HM(t,e){var r=gf[t]||Dt(t);return r==="General"?Tl(e):fs(r,e)}function $M(t,e,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=lr(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=ur(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[Dt(e)]=i}function GM(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||za[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Uf(t.v):t.w=Tl(t.v):t.w=HM(e||"General",t.v)}catch(s){if(r.WTF)throw s}try{var n=gf[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&cu(n)){var i=ll(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(s){if(r.WTF)throw s}}}function KM(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=sP[n.Pattern]||n.Pattern)}t[e.ID]=e}function XM(t,e,r,n,i,s,a,o,l,c){var d="General",h=n.StyleID,p={};c=c||{};var m=[],y=0;for(h===void 0&&o&&(h=o.StyleID),h===void 0&&a&&(h=a.StyleID);s[h]!==void 0&&(s[h].nf&&(d=s[h].nf),s[h].Interior&&m.push(s[h].Interior),!!s[h].Parent);)h=s[h].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=lr(t);break;case"String":n.t="s",n.r=L_(Dt(t)),n.v=t.indexOf("<")>-1?Dt(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(ur(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=Dt(t):n.v<60&&(n.v=n.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=QS[t],c.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=L_(e||t));break}if(GM(n,d,c),c.cellFormula!==!1)if(n.Formula){var x=Dt(n.Formula);x.charCodeAt(0)==61&&(x=x.slice(1)),n.f=Oc(x,i),delete n.Formula,n.ArrayRange=="RC"?n.F=Oc("RC:RC",i):n.ArrayRange&&(n.F=Oc(n.ArrayRange,i),l.push([Pt(n.F),n.F]))}else for(y=0;y<l.length;++y)i.r>=l[y][0].s.r&&i.r<=l[y][0].e.r&&i.c>=l[y][0].s.c&&i.c<=l[y][0].e.c&&(n.F=l[y][1]);c.cellStyles&&(m.forEach(function(E){!p.patternType&&E.patternType&&(p.patternType=E.patternType)}),n.s=p),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function YM(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function Rg(t,e){var r=e||{};uu();var n=Gu(D1(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Qt(n));var i=n.slice(0,1024).toLowerCase(),s=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var a=fr(r);return a.type="string",Yc.to_workbook(n,a)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Jt){i.indexOf("<"+Jt)>=0&&(s=!0)}),s)return PL(n,r);gf={"General Number":"General","General Date":at[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":at[15],"Short Date":at[14],"Long Time":at[19],"Medium Time":at[18],"Short Time":at[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:at[2],Standard:at[4],Percent:at[10],Scientific:at[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],c,d={},h=[],p=r.dense?[]:{},m="",y={},x={},E=Es('<Data ss:Type="String">'),T=0,A=0,_=0,P={s:{r:2e6,c:2e6},e:{r:0,c:0}},W={},B={},w="",F=0,S=[],b={},N={},D=0,R=[],Ue=[],me={},Ie=[],Te,_e=!1,Q=[],ke=[],Le={},j=0,H=0,q={Sheets:[],WBProps:{date1904:!1}},Y={};Hf.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var de="";o=Hf.exec(n);)switch(o[3]=(de=o[3]).toLowerCase()){case"data":if(de=="data"){if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?XM(n.slice(T,o.index),w,E,l[l.length-1][0]=="comment"?me:y,{c:A,r:_},W,Ie[A],x,Q,r):(w="",E=Es(o[0]),T=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(Ue.length>0&&(y.c=Ue),(!r.sheetRows||r.sheetRows>_)&&y.v!==void 0&&(r.dense?(p[_]||(p[_]=[]),p[_][A]=y):p[Tr(A)+Lr(_)]=y),y.HRef&&(y.l={Target:Dt(y.HRef)},y.HRefScreenTip&&(y.l.Tooltip=y.HRefScreenTip),delete y.HRef,delete y.HRefScreenTip),(y.MergeAcross||y.MergeDown)&&(j=A+(parseInt(y.MergeAcross,10)|0),H=_+(parseInt(y.MergeDown,10)|0),S.push({s:{c:A,r:_},e:{c:j,r:H}})),!r.sheetStubs)y.MergeAcross?A=j+1:++A;else if(y.MergeAcross||y.MergeDown){for(var Se=A;Se<=j;++Se)for(var Ne=_;Ne<=H;++Ne)(Se>A||Ne>_)&&(r.dense?(p[Ne]||(p[Ne]=[]),p[Ne][Se]={t:"z"}):p[Tr(Se)+Lr(Ne)]={t:"z"});A=j+1}else++A;else y=WM(o[0]),y.Index&&(A=+y.Index-1),A<P.s.c&&(P.s.c=A),A>P.e.c&&(P.e.c=A),o[0].slice(-2)==="/>"&&++A,Ue=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(_<P.s.r&&(P.s.r=_),_>P.e.r&&(P.e.r=_),o[0].slice(-2)==="/>"&&(x=Es(o[0]),x.Index&&(_=+x.Index-1)),A=0,++_):(x=Es(o[0]),x.Index&&(_=+x.Index-1),Le={},(x.AutoFitHeight=="0"||x.Height)&&(Le.hpx=parseInt(x.Height,10),Le.hpt=Yf(Le.hpx),ke[_]=Le),x.Hidden=="1"&&(Le.hidden=!0,ke[_]=Le));break;case"worksheet":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));h.push(m),P.s.r<=P.e.r&&P.s.c<=P.e.c&&(p["!ref"]=xt(P),r.sheetRows&&r.sheetRows<=P.e.r&&(p["!fullref"]=p["!ref"],P.e.r=r.sheetRows-1,p["!ref"]=xt(P))),S.length&&(p["!merges"]=S),Ie.length>0&&(p["!cols"]=Ie),ke.length>0&&(p["!rows"]=ke),d[m]=p}else P={s:{r:2e6,c:2e6},e:{r:0,c:0}},_=A=0,l.push([o[3],!1]),c=Es(o[0]),m=Dt(c.Name),p=r.dense?[]:{},S=[],Q=[],ke=[],Y={name:m,Hidden:0},q.Sheets.push(Y);break;case"table":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),Ie=[],_e=!1}break;case"style":o[1]==="/"?KM(W,B,r):B=Es(o[0]);break;case"numberformat":B.nf=Dt(Es(o[0]).Format||"General"),gf[B.nf]&&(B.nf=gf[B.nf]);for(var Ae=0;Ae!=392&&at[Ae]!=B.nf;++Ae);if(Ae==392){for(Ae=57;Ae!=392;++Ae)if(at[Ae]==null){ka(B.nf,Ae);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(Te=Es(o[0]),Te.Hidden&&(Te.hidden=!0,delete Te.Hidden),Te.Width&&(Te.wpx=parseInt(Te.Width,10)),!_e&&Te.wpx>10){_e=!0,zn=RA;for(var we=0;we<Ie.length;++we)Ie[we]&&Po(Ie[we])}_e&&Po(Te),Ie[Te.Index-1||Ie.length]=Te;for(var it=0;it<+Te.Span;++it)Ie[Ie.length]=fr(Te);break;case"namedrange":if(o[1]==="/")break;q.Names||(q.Names=[]);var G=lt(o[0]),jt={Name:G.Name,Ref:Oc(G.RefersTo.slice(1),{r:0,c:0})};q.Sheets.length>0&&(jt.Sheet=q.Sheets.length-1),q.Names.push(jt);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?w+=n.slice(F,o.index):F=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;B.Interior=Es(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?yN(b,de,n.slice(D,o.index)):D=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));YM(me),Ue.push(me)}else l.push([o[3],!1]),c=Es(o[0]),me={a:c.Author};break;case"autofilter":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var mt=Es(o[0]);p["!autofilter"]={ref:Oc(mt.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return A2(n,r);var bt=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:bt=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:bt=!1}break;case"excelworkbook":switch(o[3]){case"date1904":q.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:bt=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:bt=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(D,o.index)){case"SheetHidden":Y.Hidden=1;break;case"SheetVeryHidden":Y.Hidden=2;break}else D=o.index+o[0].length;break;case"header":p["!margins"]||gl(p["!margins"]={},"xlml"),isNaN(+lt(o[0]).Margin)||(p["!margins"].header=+lt(o[0]).Margin);break;case"footer":p["!margins"]||gl(p["!margins"]={},"xlml"),isNaN(+lt(o[0]).Margin)||(p["!margins"].footer=+lt(o[0]).Margin);break;case"pagemargins":var ht=lt(o[0]);p["!margins"]||gl(p["!margins"]={},"xlml"),isNaN(+ht.Top)||(p["!margins"].top=+ht.Top),isNaN(+ht.Left)||(p["!margins"].left=+ht.Left),isNaN(+ht.Right)||(p["!margins"].right=+ht.Right),isNaN(+ht.Bottom)||(p["!margins"].bottom=+ht.Bottom);break;case"displayrighttoleft":q.Views||(q.Views=[]),q.Views[0]||(q.Views[0]={}),q.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":p["!outline"]||(p["!outline"]={}),p["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":p["!outline"]||(p["!outline"]={}),p["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:bt=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:bt=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:bt=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:bt=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:bt=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:bt=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:bt=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:bt=!1}break;case"smarttags":break;default:bt=!1;break}if(bt||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?$M(N,de,R,n.slice(D,o.index)):(R=o,D=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var We={};return!r.bookSheets&&!r.bookProps&&(We.Sheets=d),We.SheetNames=h,We.Workbook=q,We.SSF=fr(at),We.Props=b,We.Custprops=N,We}function rx(t,e){switch(nv(e=e||{}),e.type||"base64"){case"base64":return Rg(zi(t),e);case"binary":case"buffer":case"file":return Rg(t,e);case"array":return Rg(Wo(t),e)}}function qM(t,e){var r=[];return t.Props&&r.push(_N(t.Props,e)),t.Custprops&&r.push(EN(t.Props,t.Custprops)),r.join("")}function QM(){return""}function JM(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,i){var s=[];s.push(Be("NumberFormat",null,{"ss:Format":Gt(at[n.numFmtId])}));var a={"ss:ID":"s"+(21+i)};r.push(Be("Style",s.join(""),a))}),Be("Styles",r.join(""))}function ik(t){return Be("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+Q1(t.Ref,{r:0,c:0})})}function ZM(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],n=0;n<e.length;++n){var i=e[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(ik(i)))}return Be("Names",r.join(""))}function eL(t,e,r,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,s=[],a=0;a<i.length;++a){var o=i[a];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||s.push(ik(o)))}return s.join("")}function tL(t,e,r,n){if(!t)return"";var i=[];if(t["!margins"]&&(i.push("<PageSetup>"),t["!margins"].header&&i.push(Be("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&i.push(Be("Footer",null,{"x:Margin":t["!margins"].footer})),i.push(Be("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push(Be("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),t["!protect"]&&(i.push(kn("ProtectContents","True")),t["!protect"].objects&&i.push(kn("ProtectObjects","True")),t["!protect"].scenarios&&i.push(kn("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?i.push(kn("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&i.push(kn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){t["!protect"][a[0]]&&i.push("<"+a[1]+"/>")})),i.length==0?"":Be("WorksheetOptions",i.join(""),{xmlns:Pi.x})}function rL(t){return t.map(function(e){var r=TR(e.t||""),n=Be("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Be("Comment",n,{"ss:Author":e.a})}).join("")}function nL(t,e,r,n,i,s,a){if(!t||t.v==null&&t.f==null)return"";var o={};if(t.f&&(o["ss:Formula"]="="+Gt(Q1(t.f,a))),t.F&&t.F.slice(0,e.length)==e){var l=Sr(t.F.slice(e.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==a.r?"":"["+(l.r-a.r)+"]")+"C"+(l.c==a.c?"":"["+(l.c-a.c)+"]")}if(t.l&&t.l.Target&&(o["ss:HRef"]=Gt(t.l.Target),t.l.Tooltip&&(o["x:HRefScreenTip"]=Gt(t.l.Tooltip))),r["!merges"])for(var c=r["!merges"],d=0;d!=c.length;++d)c[d].s.c!=a.c||c[d].s.r!=a.r||(c[d].e.c>c[d].s.c&&(o["ss:MergeAcross"]=c[d].e.c-c[d].s.c),c[d].e.r>c[d].s.r&&(o["ss:MergeDown"]=c[d].e.r-c[d].s.r));var h="",p="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":h="Number",p=String(t.v);break;case"b":h="Boolean",p=t.v?"1":"0";break;case"e":h="Error",p=za[t.v];break;case"d":h="DateTime",p=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||at[14]);break;case"s":h="String",p=wR(t.v||"");break}var m=$o(n.cellXfs,t,n);o["ss:StyleID"]="s"+(21+m),o["ss:Index"]=a.c+1;var y=t.v!=null?p:"",x=t.t=="z"?"":'<Data ss:Type="'+h+'">'+y+"</Data>";return(t.c||[]).length>0&&(x+=rL(t.c)),Be("Cell",x,o)}function iL(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=qc(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function sL(t,e,r,n){if(!t["!ref"])return"";var i=Pt(t["!ref"]),s=t["!merges"]||[],a=0,o=[];t["!cols"]&&t["!cols"].forEach(function(E,T){Po(E);var A=!!E.width,_=Np(T,E),P={"ss:Index":T+1};A&&(P["ss:Width"]=Kf(_.width)),E.hidden&&(P["ss:Hidden"]="1"),o.push(Be("Column",null,P))});for(var l=Array.isArray(t),c=i.s.r;c<=i.e.r;++c){for(var d=[iL(c,(t["!rows"]||[])[c])],h=i.s.c;h<=i.e.c;++h){var p=!1;for(a=0;a!=s.length;++a)if(!(s[a].s.c>h)&&!(s[a].s.r>c)&&!(s[a].e.c<h)&&!(s[a].e.r<c)){(s[a].s.c!=h||s[a].s.r!=c)&&(p=!0);break}if(!p){var m={r:c,c:h},y=ot(m),x=l?(t[c]||[])[h]:t[y];d.push(nL(x,y,t,e,r,n,m))}}d.push("</Row>"),d.length>2&&o.push(d.join(""))}return o.join("")}function aL(t,e,r){var n=[],i=r.SheetNames[t],s=r.Sheets[i],a=s?eL(s,e,t,r):"";return a.length>0&&n.push("<Names>"+a+"</Names>"),a=s?sL(s,e,t,r):"",a.length>0&&n.push("<Table>"+a+"</Table>"),n.push(tL(s,e,t,r)),n.join("")}function oL(t,e){e||(e={}),t.SSF||(t.SSF=fr(at)),t.SSF&&(uu(),Ap(t.SSF),e.revssf=Cp(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],$o(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(qM(t,e)),r.push(QM()),r.push(""),r.push("");for(var n=0;n<t.SheetNames.length;++n)r.push(Be("Worksheet",aL(n,e,t),{"ss:Name":Gt(t.SheetNames[n])}));return r[2]=JM(t,e),r[3]=ZM(t),Br+Be("Workbook",r.join(""),{xmlns:Pi.ss,"xmlns:o":Pi.o,"xmlns:x":Pi.x,"xmlns:ss":Pi.ss,"xmlns:dt":Pi.dt,"xmlns:html":Pi.html})}function lL(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=ZR(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=eN(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var cL=[60,1084,2066,2165,2175];function uL(t,e,r,n,i){var s=n,a=[],o=r.slice(r.l,r.l+s);if(i&&i.enc&&i.enc.insitu&&o.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(o)}a.push(o),r.l+=s;for(var l=_a(r,r.l),c=nx[l],d=0;c!=null&&cL.indexOf(l)>-1;)s=_a(r,r.l+2),d=r.l+4,l==2066?d+=4:(l==2165||l==2175)&&(d+=12),o=r.slice(d,r.l+4+s),a.push(o),r.l+=4+s,c=nx[l=_a(r,r.l)];var h=un(a);An(h,0);var p=0;h.lens=[];for(var m=0;m<a.length;++m)h.lens.push(p),p+=a[m].length;if(h.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+h.length+" < "+n;return e.f(h,h.length,i)}function zs(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=at[n])}catch(s){if(e.WTF)throw s}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||za[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Uf(t.v):t.w=Tl(t.v):t.w=fs(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(s){if(e.WTF)throw s}if(e.cellDates&&n&&t.t=="n"&&cu(at[n]||String(n))){var i=ll(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function Fd(t,e,r){return{v:t,ixfe:e,t:r}}function fL(t,e){var r={opts:{}},n={},i=e.dense?[]:{},s={},a={},o=null,l=[],c="",d={},h,p="",m,y,x,E,T={},A=[],_,P,W=[],B=[],w={Sheets:[],WBProps:{date1904:!1},Views:[{}]},F={},S=function(ct){return ct<8?dl[ct]:ct<64&&B[ct-8]||dl[ct]},b=function(ct,nr,yr){var dr=nr.XF.data;if(!(!dr||!dr.patternType||!yr||!yr.cellStyles)){nr.s={},nr.s.patternType=dr.patternType;var Nn;(Nn=Gf(S(dr.icvFore)))&&(nr.s.fgColor={rgb:Nn}),(Nn=Gf(S(dr.icvBack)))&&(nr.s.bgColor={rgb:Nn})}},N=function(ct,nr,yr){if(!(Le>1)&&!(yr.sheetRows&&ct.r>=yr.sheetRows)){if(yr.cellStyles&&nr.XF&&nr.XF.data&&b(ct,nr,yr),delete nr.ixfe,delete nr.XF,h=ct,p=ot(ct),(!a||!a.s||!a.e)&&(a={s:{r:0,c:0},e:{r:0,c:0}}),ct.r<a.s.r&&(a.s.r=ct.r),ct.c<a.s.c&&(a.s.c=ct.c),ct.r+1>a.e.r&&(a.e.r=ct.r+1),ct.c+1>a.e.c&&(a.e.c=ct.c+1),yr.cellFormula&&nr.f){for(var dr=0;dr<A.length;++dr)if(!(A[dr][0].s.c>ct.c||A[dr][0].s.r>ct.r)&&!(A[dr][0].e.c<ct.c||A[dr][0].e.r<ct.r)){nr.F=xt(A[dr][0]),(A[dr][0].s.c!=ct.c||A[dr][0].s.r!=ct.r)&&delete nr.f,nr.f&&(nr.f=""+Vn(A[dr][1],a,ct,Q,D));break}}yr.dense?(i[ct.r]||(i[ct.r]=[]),i[ct.r][ct.c]=nr):i[p]=nr}},D={enc:!1,sbcch:0,snames:[],sharedf:T,arrayf:A,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(D.password=e.password);var R,Ue=[],me=[],Ie=[],Te=[],_e=!1,Q=[];Q.SheetNames=D.snames,Q.sharedf=D.sharedf,Q.arrayf=D.arrayf,Q.names=[],Q.XTI=[];var ke=0,Le=0,j=0,H=[],q=[],Y;D.codepage=1200,As(1200);for(var de=!1;t.l<t.length-1;){var Se=t.l,Ne=t.read_shift(2);if(Ne===0&&ke===10)break;var Ae=t.l===t.length?0:t.read_shift(2),we=nx[Ne];if(we&&we.f){if(e.bookSheets&&ke===133&&Ne!==133)break;if(ke=Ne,we.r===2||we.r==12){var it=t.read_shift(2);if(Ae-=2,!D.enc&&it!==Ne&&((it&255)<<8|it>>8)!==Ne)throw new Error("rt mismatch: "+it+"!="+Ne);we.r==12&&(t.l+=10,Ae-=10)}var G={};if(Ne===10?G=we.f(t,Ae,D):G=uL(Ne,we,t,Ae,D),Le==0&&[9,521,1033,2057].indexOf(ke)===-1)continue;switch(Ne){case 34:r.opts.Date1904=w.WBProps.date1904=G;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(D.enc||(t.l=0),D.enc=G,!e.password)throw new Error("File is password-protected");if(G.valid==null)throw new Error("Encryption scheme unsupported");if(!G.valid)throw new Error("Password is incorrect");break;case 92:D.lastuser=G;break;case 66:var jt=Number(G);switch(jt){case 21010:jt=1200;break;case 32768:jt=1e4;break;case 32769:jt=1252;break}As(D.codepage=jt),de=!0;break;case 317:D.rrtabid=G;break;case 25:D.winlocked=G;break;case 439:r.opts.RefreshAll=G;break;case 12:r.opts.CalcCount=G;break;case 16:r.opts.CalcDelta=G;break;case 17:r.opts.CalcIter=G;break;case 13:r.opts.CalcMode=G;break;case 14:r.opts.CalcPrecision=G;break;case 95:r.opts.CalcSaveRecalc=G;break;case 15:D.CalcRefMode=G;break;case 2211:r.opts.FullCalc=G;break;case 129:G.fDialog&&(i["!type"]="dialog"),G.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),G.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:W.push(G);break;case 430:Q.push([G]),Q[Q.length-1].XTI=[];break;case 35:case 547:Q[Q.length-1].push(G);break;case 24:case 536:Y={Name:G.Name,Ref:Vn(G.rgce,a,null,Q,D)},G.itab>0&&(Y.Sheet=G.itab-1),Q.names.push(Y),Q[0]||(Q[0]=[],Q[0].XTI=[]),Q[Q.length-1].push(G),G.Name=="_xlnm._FilterDatabase"&&G.itab>0&&G.rgce&&G.rgce[0]&&G.rgce[0][0]&&G.rgce[0][0][0]=="PtgArea3d"&&(q[G.itab-1]={ref:xt(G.rgce[0][0][1][2])});break;case 22:D.ExternCount=G;break;case 23:Q.length==0&&(Q[0]=[],Q[0].XTI=[]),Q[Q.length-1].XTI=Q[Q.length-1].XTI.concat(G),Q.XTI=Q.XTI.concat(G);break;case 2196:if(D.biff<8)break;Y!=null&&(Y.Comment=G[1]);break;case 18:i["!protect"]=G;break;case 19:G!==0&&D.WTF&&console.error("Password verifier: "+G);break;case 133:s[G.pos]=G,D.snames.push(G.name);break;case 10:{if(--Le)break;if(a.e){if(a.e.r>0&&a.e.c>0){if(a.e.r--,a.e.c--,i["!ref"]=xt(a),e.sheetRows&&e.sheetRows<=a.e.r){var mt=a.e.r;a.e.r=e.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=xt(a),a.e.r=mt}a.e.r++,a.e.c++}Ue.length>0&&(i["!merges"]=Ue),me.length>0&&(i["!objects"]=me),Ie.length>0&&(i["!cols"]=Ie),Te.length>0&&(i["!rows"]=Te),w.Sheets.push(F)}c===""?d=i:n[c]=i,i=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(D.biff===8&&(D.biff={9:2,521:3,1033:4}[Ne]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[G.BIFFVer]||8),D.biffguess=G.BIFFVer==0,G.BIFFVer==0&&G.dt==4096&&(D.biff=5,de=!0,As(D.codepage=28591)),D.biff==8&&G.BIFFVer==0&&G.dt==16&&(D.biff=2),Le++)break;if(i=e.dense?[]:{},D.biff<8&&!de&&(de=!0,As(D.codepage=e.codepage||1252)),D.biff<5||G.BIFFVer==0&&G.dt==4096){c===""&&(c="Sheet1"),a={s:{r:0,c:0},e:{r:0,c:0}};var bt={pos:t.l-Ae,name:c};s[bt.pos]=bt,D.snames.push(c)}else c=(s[Se]||{name:""}).name;G.dt==32&&(i["!type"]="chart"),G.dt==64&&(i["!type"]="macro"),Ue=[],me=[],D.arrayf=A=[],Ie=[],Te=[],_e=!1,F={Hidden:(s[Se]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(e.dense?(i[G.r]||[])[G.c]:i[ot({c:G.c,r:G.r})])&&++G.c,_={ixfe:G.ixfe,XF:W[G.ixfe]||{},v:G.val,t:"n"},j>0&&(_.z=H[_.ixfe>>8&63]),zs(_,e,r.opts.Date1904),N({c:G.c,r:G.r},_,e);break;case 5:case 517:_={ixfe:G.ixfe,XF:W[G.ixfe],v:G.val,t:G.t},j>0&&(_.z=H[_.ixfe>>8&63]),zs(_,e,r.opts.Date1904),N({c:G.c,r:G.r},_,e);break;case 638:_={ixfe:G.ixfe,XF:W[G.ixfe],v:G.rknum,t:"n"},j>0&&(_.z=H[_.ixfe>>8&63]),zs(_,e,r.opts.Date1904),N({c:G.c,r:G.r},_,e);break;case 189:for(var ht=G.c;ht<=G.C;++ht){var We=G.rkrec[ht-G.c][0];_={ixfe:We,XF:W[We],v:G.rkrec[ht-G.c][1],t:"n"},j>0&&(_.z=H[_.ixfe>>8&63]),zs(_,e,r.opts.Date1904),N({c:ht,r:G.r},_,e)}break;case 6:case 518:case 1030:{if(G.val=="String"){o=G;break}if(_=Fd(G.val,G.cell.ixfe,G.tt),_.XF=W[_.ixfe],e.cellFormula){var Jt=G.formula;if(Jt&&Jt[0]&&Jt[0][0]&&Jt[0][0][0]=="PtgExp"){var hn=Jt[0][0][1][0],$r=Jt[0][0][1][1],ci=ot({r:hn,c:$r});T[ci]?_.f=""+Vn(G.formula,a,G.cell,Q,D):_.F=((e.dense?(i[hn]||[])[$r]:i[ci])||{}).F}else _.f=""+Vn(G.formula,a,G.cell,Q,D)}j>0&&(_.z=H[_.ixfe>>8&63]),zs(_,e,r.opts.Date1904),N(G.cell,_,e),o=G}break;case 7:case 519:if(o)o.val=G,_=Fd(G,o.cell.ixfe,"s"),_.XF=W[_.ixfe],e.cellFormula&&(_.f=""+Vn(o.formula,a,o.cell,Q,D)),j>0&&(_.z=H[_.ixfe>>8&63]),zs(_,e,r.opts.Date1904),N(o.cell,_,e),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{A.push(G);var $i=ot(G[0].s);if(m=e.dense?(i[G[0].s.r]||[])[G[0].s.c]:i[$i],e.cellFormula&&m){if(!o||!$i||!m)break;m.f=""+Vn(G[1],a,G[0],Q,D),m.F=xt(G[0])}}break;case 1212:{if(!e.cellFormula)break;if(p){if(!o)break;T[ot(o.cell)]=G[0],m=e.dense?(i[o.cell.r]||[])[o.cell.c]:i[ot(o.cell)],(m||{}).f=""+Vn(G[0],a,h,Q,D)}}break;case 253:_=Fd(l[G.isst].t,G.ixfe,"s"),l[G.isst].h&&(_.h=l[G.isst].h),_.XF=W[_.ixfe],j>0&&(_.z=H[_.ixfe>>8&63]),zs(_,e,r.opts.Date1904),N({c:G.c,r:G.r},_,e);break;case 513:e.sheetStubs&&(_={ixfe:G.ixfe,XF:W[G.ixfe],t:"z"},j>0&&(_.z=H[_.ixfe>>8&63]),zs(_,e,r.opts.Date1904),N({c:G.c,r:G.r},_,e));break;case 190:if(e.sheetStubs)for(var ui=G.c;ui<=G.C;++ui){var Fr=G.ixfe[ui-G.c];_={ixfe:Fr,XF:W[Fr],t:"z"},j>0&&(_.z=H[_.ixfe>>8&63]),zs(_,e,r.opts.Date1904),N({c:ui,r:G.r},_,e)}break;case 214:case 516:case 4:_=Fd(G.val,G.ixfe,"s"),_.XF=W[_.ixfe],j>0&&(_.z=H[_.ixfe>>8&63]),zs(_,e,r.opts.Date1904),N({c:G.c,r:G.r},_,e);break;case 0:case 512:Le===1&&(a=G);break;case 252:l=G;break;case 1054:if(D.biff==4){H[j++]=G[1];for(var fi=0;fi<j+163&&at[fi]!=G[1];++fi);fi>=163&&ka(G[1],j+163)}else ka(G[1],G[0]);break;case 30:{H[j++]=G;for(var Ot=0;Ot<j+163&&at[Ot]!=G;++Ot);Ot>=163&&ka(G,j+163)}break;case 229:Ue=Ue.concat(G);break;case 93:me[G.cmo[0]]=D.lastobj=G;break;case 438:D.lastobj.TxO=G;break;case 127:D.lastobj.ImData=G;break;case 440:for(E=G[0].s.r;E<=G[0].e.r;++E)for(x=G[0].s.c;x<=G[0].e.c;++x)m=e.dense?(i[E]||[])[x]:i[ot({c:x,r:E})],m&&(m.l=G[1]);break;case 2048:for(E=G[0].s.r;E<=G[0].e.r;++E)for(x=G[0].s.c;x<=G[0].e.c;++x)m=e.dense?(i[E]||[])[x]:i[ot({c:x,r:E})],m&&m.l&&(m.l.Tooltip=G[1]);break;case 28:{if(D.biff<=5&&D.biff>=2)break;m=e.dense?(i[G[0].r]||[])[G[0].c]:i[ot(G[0])];var vr=me[G[2]];m||(e.dense?(i[G[0].r]||(i[G[0].r]=[]),m=i[G[0].r][G[0].c]={t:"z"}):m=i[ot(G[0])]={t:"z"},a.e.r=Math.max(a.e.r,G[0].r),a.s.r=Math.min(a.s.r,G[0].r),a.e.c=Math.max(a.e.c,G[0].c),a.s.c=Math.min(a.s.c,G[0].c)),m.c||(m.c=[]),y={a:G[1],t:vr.TxO.t},m.c.push(y)}break;case 2173:JP(W[G.ixfe],G.ext);break;case 125:{if(!D.cellStyles)break;for(;G.e>=G.s;)Ie[G.e--]={width:G.w/256,level:G.level||0,hidden:!!(G.flags&1)},_e||(_e=!0,X1(G.w/256)),Po(Ie[G.e+1])}break;case 520:{var rr={};G.level!=null&&(Te[G.r]=rr,rr.level=G.level),G.hidden&&(Te[G.r]=rr,rr.hidden=!0),G.hpt&&(Te[G.r]=rr,rr.hpt=G.hpt,rr.hpx=qc(G.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||gl(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Ne]]=G;break;case 161:i["!margins"]||gl(i["!margins"]={}),i["!margins"].header=G.header,i["!margins"].footer=G.footer;break;case 574:G.RTL&&(w.Views[0].RTL=!0);break;case 146:B=G;break;case 2198:R=G;break;case 140:P=G;break;case 442:c?F.CodeName=G||F.name:w.WBProps.CodeName=G||"ThisWorkbook";break}}else we||console.error("Missing Info for XLS Record 0x"+Ne.toString(16)),t.l+=Ae}return r.SheetNames=Dr(s).sort(function(qn,ct){return Number(qn)-Number(ct)}).map(function(qn){return s[qn].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&q.forEach(function(qn,ct){r.Sheets[r.SheetNames[ct]]["!autofilter"]=qn}),r.Strings=l,r.SSF=fr(at),D.enc&&(r.Encryption=D.enc),R&&(r.Themes=R),r.Metadata={},P!==void 0&&(r.Metadata.Country=P),Q.names.length>0&&(w.Names=Q.names),r.Workbook=w,r}var mf={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function dL(t,e,r){var n=tt.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=t2(n,qm,mf.DSI);for(var s in i)e[s]=i[s]}catch(c){if(r.WTF)throw c}var a=tt.find(t,"/!SummaryInformation");if(a&&a.size>0)try{var o=t2(a,Qm,mf.SI);for(var l in o)e[l]==null&&(e[l]=o[l])}catch(c){if(r.WTF)throw c}e.HeadingPairs&&e.TitlesOfParts&&(nA(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function hL(t,e){var r=[],n=[],i=[],s=0,a,o=R_(qm,"n"),l=R_(Qm,"n");if(t.Props)for(a=Dr(t.Props),s=0;s<a.length;++s)(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(l,a[s])?n:i).push([a[s],t.Props[a[s]]]);if(t.Custprops)for(a=Dr(t.Custprops),s=0;s<a.length;++s)Object.prototype.hasOwnProperty.call(t.Props||{},a[s])||(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(l,a[s])?n:i).push([a[s],t.Custprops[a[s]]]);var c=[];for(s=0;s<i.length;++s)uA.indexOf(i[s][0])>-1||rA.indexOf(i[s][0])>-1||i[s][1]!=null&&c.push(i[s]);n.length&&tt.utils.cfb_add(e,"/SummaryInformation",r2(n,mf.SI,l,Qm)),(r.length||c.length)&&tt.utils.cfb_add(e,"/DocumentSummaryInformation",r2(r,mf.DSI,o,qm,c.length?c:null,mf.UDI))}function sk(t,e){e||(e={}),nv(e),S1(),e.codepage&&T1(e.codepage);var r,n;if(t.FullPaths){if(tt.find(t,"/encryption"))throw new Error("File is password-protected");r=tt.find(t,"!CompObj"),n=tt.find(t,"/Workbook")||tt.find(t,"/Book")}else{switch(e.type){case"base64":t=Mi(zi(t));break;case"binary":t=Mi(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}An(t,0),n={content:t}}var i,s;if(r&&lL(r),e.bookProps&&!e.bookSheets)i={};else{var a=yt?"buffer":"array";if(n&&n.content)i=fL(n.content,e);else if((s=tt.find(t,"PerfectOffice_MAIN"))&&s.content)i=pl.to_workbook(s.content,(e.type=a,e));else if((s=tt.find(t,"NativeContent_MAIN"))&&s.content)i=pl.to_workbook(s.content,(e.type=a,e));else throw(s=tt.find(t,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&tt.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=k6(t))}var o={};return t.FullPaths&&dL(t,o,e),i.Props=i.Custprops=o,e.bookFiles&&(i.cfb=t),i}function pL(t,e){var r=e||{},n=tt.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return tt.utils.cfb_add(n,i,ak(t,r)),r.biff==8&&(t.Props||t.Custprops)&&hL(t,n),r.biff==8&&t.vbaraw&&C6(n,tt.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var qf={0:{f:B5},1:{f:G5},2:{f:fO},3:{f:eO},4:{f:q5},5:{f:lO},6:{f:mO},7:{f:iO},8:{f:TO},9:{f:wO},10:{f:_O},11:{f:EO},12:{f:X5},13:{f:hO},14:{f:rO},15:{f:J5},16:{f:QA},17:{f:vO},18:{f:aO},19:{f:B1},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:vM},40:{},42:{},43:{f:mP},44:{f:pP},45:{f:yP},46:{f:EP},47:{f:_P},48:{},49:{f:UR},50:{},51:{f:t6},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:EA},62:{f:gO},63:{f:u6},64:{f:jO},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Kn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:OO},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:H5},148:{f:U5,p:16},151:{f:IO},152:{},153:{f:gM},154:{},155:{},156:{f:hM},157:{},158:{},159:{T:1,f:RD},160:{T:-1},161:{T:1,f:Vl},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:SO},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:ZP},336:{T:-1},337:{f:i6,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Ym},357:{},358:{},359:{},360:{T:1},361:{},362:{f:_A},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:bO},427:{f:RO},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:DO},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:W5},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:CO},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Ym},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:E6},633:{T:1},634:{T:-1},635:{T:1,f:y6},636:{T:-1},637:{f:$R},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:rM},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:VO},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},nx={6:{f:Ig},10:{f:to},12:{f:Wr},13:{f:Wr},14:{f:Pr},15:{f:Pr},16:{f:Hn},17:{f:Pr},18:{f:Pr},19:{f:Wr},20:{f:l2},21:{f:l2},23:{f:_A},24:{f:u2},25:{f:Pr},26:{},27:{},28:{f:V3},29:{},34:{f:Pr},35:{f:c2},38:{f:Hn},39:{f:Hn},40:{f:Hn},41:{f:Hn},42:{f:Pr},43:{f:Pr},47:{f:JD},49:{f:h3},51:{f:Wr},60:{},61:{f:l3},64:{f:Pr},65:{f:d3},66:{f:Wr},77:{},80:{},81:{},82:{},85:{f:Wr},89:{},90:{},91:{},92:{f:QN},93:{f:W3},94:{},95:{f:Pr},96:{},97:{},99:{f:Pr},125:{f:EA},128:{f:F3},129:{f:ZN},130:{f:Wr},131:{f:Pr},132:{f:Pr},133:{f:e3},134:{},140:{f:Q3},141:{f:Wr},144:{},146:{f:eD},151:{},152:{},153:{},154:{},155:{},156:{f:Wr},157:{},158:{},160:{f:oD},161:{f:nD},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:S3},190:{f:A3},193:{f:to},197:{},198:{},199:{},200:{},201:{},202:{f:Pr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Wr},220:{},221:{f:Pr},222:{},224:{f:C3},225:{f:qN},226:{f:to},227:{},229:{f:U3},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:r3},253:{f:g3},255:{f:i3},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:fA},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Pr},353:{f:to},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:D3},431:{f:Pr},432:{},433:{},434:{},437:{},438:{f:G3},439:{f:Pr},440:{f:K3},441:{},442:{f:x0},443:{},444:{f:Wr},445:{},446:{},448:{f:to},449:{f:o3,r:2},450:{f:to},512:{f:s2},513:{f:aD},515:{f:R3},516:{f:x3},517:{f:o2},519:{f:lD},520:{f:s3},523:{},545:{f:f2},549:{f:i2},566:{},574:{f:u3},638:{f:T3},659:{},1048:{},1054:{f:y3},1084:{},1212:{f:L3},2048:{f:Y3},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Ad},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:to},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:tD,r:12},2173:{f:QP,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Pr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:M3,r:12},2197:{},2198:{f:$P,r:12},2199:{},2200:{},2201:{},2202:{f:B3,r:12},2203:{f:to},2204:{},2205:{},2206:{},2207:{},2211:{f:a3},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Wr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:iD},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:Z3},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:s2},1:{},2:{f:hD},3:{f:fD},4:{f:uD},5:{f:o2},7:{f:gD},8:{},9:{f:Ad},11:{},22:{f:Wr},30:{f:E3},31:{},32:{},33:{f:f2},36:{},37:{f:i2},50:{f:mD},62:{},52:{},67:{},68:{f:Wr},69:{},86:{},126:{},127:{f:cD},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:xD},223:{},234:{},354:{},421:{},518:{f:Ig},521:{f:Ad},536:{f:u2},547:{f:c2},561:{},579:{},1030:{f:Ig},1033:{f:Ad},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function je(t,e,r,n){var i=e;if(!isNaN(i)){var s=n||(r||[]).length||0,a=t.next(4);a.write_shift(2,i),a.write_shift(2,s),s>0&&O1(r)&&t.push(r)}}function gL(t,e,r,n){var i=(r||[]).length||0;if(i<=8224)return je(t,e,r,i);var s=e;if(!isNaN(s)){for(var a=r.parts||[],o=0,l=0,c=0;c+(a[o]||8224)<=8224;)c+=a[o]||8224,o++;var d=t.next(4);for(d.write_shift(2,s),d.write_shift(2,c),t.push(r.slice(l,l+c)),l+=c;l<i;){for(d=t.next(4),d.write_shift(2,60),c=0;c+(a[o]||8224)<=8224;)c+=a[o]||8224,o++;d.write_shift(2,c),t.push(r.slice(l,l+c)),l+=c}}}function E0(t,e,r){return t||(t=pe(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function mL(t,e,r,n){var i=pe(9);return E0(i,t,e),dA(r,n||"b",i),i}function xL(t,e,r){var n=pe(8+2*r.length);return E0(n,t,e),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function vL(t,e,r,n){if(e.v!=null)switch(e.t){case"d":case"n":var i=e.t=="d"?tn(ur(e.v)):e.v;i==(i|0)&&i>=0&&i<65536?je(t,2,pD(r,n,i)):je(t,3,dD(r,n,i));return;case"b":case"e":je(t,5,mL(r,n,e.v,e.t));return;case"s":case"str":je(t,4,xL(r,n,(e.v||"").slice(0,255)));return}je(t,1,E0(null,r,n))}function yL(t,e,r,n){var i=Array.isArray(e),s=Pt(e["!ref"]||"A1"),a,o="",l=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),a=xt(s)}for(var c=s.s.r;c<=s.e.r;++c){o=Lr(c);for(var d=s.s.c;d<=s.e.c;++d){c===s.s.r&&(l[d]=Tr(d)),a=l[d]+o;var h=i?(e[c]||[])[d]:e[a];h&&vL(t,h,c,d)}}}function _L(t,e){for(var r=e||{},n=Si(),i=0,s=0;s<t.SheetNames.length;++s)t.SheetNames[s]==r.sheet&&(i=s);if(i==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return je(n,r.biff==4?1033:r.biff==3?521:9,$1(t,16,r)),yL(n,t.Sheets[t.SheetNames[i]],i,r),je(n,10),n.end()}function EL(t,e,r){je(t,49,p3({sz:12,name:"Arial"},r))}function wL(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&je(t,1054,_3(i,e[i],r))})}function TL(t,e){var r=pe(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),je(t,2151,r),r=pe(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),xA(Pt(e["!ref"]||"A1"),r),r.write_shift(4,4),je(t,2152,r)}function SL(t,e){for(var r=0;r<16;++r)je(t,224,a2({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){je(t,224,a2(n,0,e))})}function AL(t,e){for(var r=0;r<e["!links"].length;++r){var n=e["!links"][r];je(t,440,X3(n)),n[1].Tooltip&&je(t,2048,q3(n))}delete e["!links"]}function kL(t,e){if(e){var r=0;e.forEach(function(n,i){++r<=256&&n&&je(t,125,rD(Np(i,n),i))})}}function CL(t,e,r,n,i){var s=16+$o(i.cellXfs,e,i);if(e.v==null&&!e.bf){je(t,513,Cl(r,n,s));return}if(e.bf)je(t,6,Z8(e,r,n,i,s));else switch(e.t){case"d":case"n":var a=e.t=="d"?tn(ur(e.v)):e.v;je(t,515,N3(r,n,a,s));break;case"b":case"e":je(t,517,b3(r,n,e.v,s,i,e.t));break;case"s":case"str":if(i.bookSST){var o=Z1(i.Strings,e.v,i.revStrings);je(t,253,m3(r,n,o,s))}else je(t,516,v3(r,n,(e.v||"").slice(0,255),s,i));break;default:je(t,513,Cl(r,n,s))}}function FL(t,e,r){var n=Si(),i=r.SheetNames[t],s=r.Sheets[i]||{},a=(r||{}).Workbook||{},o=(a.Sheets||[])[t]||{},l=Array.isArray(s),c=e.biff==8,d,h="",p=[],m=Pt(s["!ref"]||"A1"),y=c?65536:16384;if(m.e.c>255||m.e.r>=y){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");m.e.c=Math.min(m.e.c,255),m.e.r=Math.min(m.e.c,y-1)}je(n,2057,$1(r,16,e)),je(n,13,rs(1)),je(n,12,rs(100)),je(n,15,ii(!0)),je(n,17,ii(!1)),je(n,16,Al(.001)),je(n,95,ii(!0)),je(n,42,ii(!1)),je(n,43,ii(!1)),je(n,130,rs(1)),je(n,128,I3()),je(n,131,ii(!1)),je(n,132,ii(!1)),c&&kL(n,s["!cols"]),je(n,512,w3(m,e)),c&&(s["!links"]=[]);for(var x=m.s.r;x<=m.e.r;++x){h=Lr(x);for(var E=m.s.c;E<=m.e.c;++E){x===m.s.r&&(p[E]=Tr(E)),d=p[E]+h;var T=l?(s[x]||[])[E]:s[d];T&&(CL(n,T,x,E,e),c&&T.l&&s["!links"].push([d,T.l]))}}var A=o.CodeName||o.name||i;return c&&je(n,574,f3((a.Views||[])[0])),c&&(s["!merges"]||[]).length&&je(n,229,z3(s["!merges"])),c&&AL(n,s),je(n,442,hA(A)),c&&TL(n,s),je(n,10),n.end()}function IL(t,e,r){var n=Si(),i=(t||{}).Workbook||{},s=i.Sheets||[],a=i.WBProps||{},o=r.biff==8,l=r.biff==5;if(je(n,2057,$1(t,5,r)),r.bookType=="xla"&&je(n,135),je(n,225,o?rs(1200):null),je(n,193,bN(2)),l&&je(n,191),l&&je(n,192),je(n,226),je(n,92,JN("SheetJS",r)),je(n,66,rs(o?1200:1252)),o&&je(n,353,rs(0)),o&&je(n,448),je(n,317,sD(t.SheetNames.length)),o&&t.vbaraw&&je(n,211),o&&t.vbaraw){var c=a.CodeName||"ThisWorkbook";je(n,442,hA(c))}je(n,156,rs(17)),je(n,25,ii(!1)),je(n,18,ii(!1)),je(n,19,rs(0)),o&&je(n,431,ii(!1)),o&&je(n,444,rs(0)),je(n,61,c3()),je(n,64,ii(!1)),je(n,141,rs(0)),je(n,34,ii(oM(t)=="true")),je(n,14,ii(!0)),o&&je(n,439,ii(!1)),je(n,218,rs(0)),EL(n,t,r),wL(n,t.SSF,r),SL(n,r),o&&je(n,352,ii(!1));var d=n.end(),h=Si();o&&je(h,140,J3()),o&&r.Strings&&gL(h,252,n3(r.Strings)),je(h,10);var p=h.end(),m=Si(),y=0,x=0;for(x=0;x<t.SheetNames.length;++x)y+=(o?12:11)+(o?2:1)*t.SheetNames[x].length;var E=d.length+y+p.length;for(x=0;x<t.SheetNames.length;++x){var T=s[x]||{};je(m,133,t3({pos:E,hs:T.Hidden||0,dt:0,name:t.SheetNames[x]},r)),E+=e[x].length}var A=m.end();if(y!=A.length)throw new Error("BS8 "+y+" != "+A.length);var _=[];return d.length&&_.push(d),A.length&&_.push(A),p.length&&_.push(p),un(_)}function bL(t,e){var r=e||{},n=[];t&&!t.SSF&&(t.SSF=fr(at)),t&&t.SSF&&(uu(),Ap(t.SSF),r.revssf=Cp(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,iv(r),r.cellXfs=[],$o(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var i=0;i<t.SheetNames.length;++i)n[n.length]=FL(i,r,t);return n.unshift(IL(t,n,r)),un(n)}function ak(t,e){for(var r=0;r<=t.SheetNames.length;++r){var n=t.Sheets[t.SheetNames[r]];if(!(!n||!n["!ref"])){var i=Ai(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=e||{};switch(s.biff||2){case 8:case 5:return bL(t,e);case 4:case 3:case 2:return _L(t,e)}throw new Error("invalid type "+s.bookType+" for BIFF")}function E2(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var i=t.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var s=t.match(/<\/table/i),a=i.index,o=s&&s.index||t.length,l=pR(t.slice(a,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,d=0,h=0,p=0,m={s:{r:1e7,c:1e7},e:{r:0,c:0}},y=[];for(a=0;a<l.length;++a){var x=l[a].trim(),E=x.slice(0,3).toLowerCase();if(E=="<tr"){if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}d=0;continue}if(!(E!="<td"&&E!="<th")){var T=x.split(/<\/t[dh]>/i);for(o=0;o<T.length;++o){var A=T[o].trim();if(A.match(/<t[dh]/i)){for(var _=A,P=0;_.charAt(0)=="<"&&(P=_.indexOf(">"))>-1;)_=_.slice(P+1);for(var W=0;W<y.length;++W){var B=y[W];B.s.c==d&&B.s.r<c&&c<=B.e.r&&(d=B.e.c+1,W=-1)}var w=lt(A.slice(0,A.indexOf(">")));p=w.colspan?+w.colspan:1,((h=+w.rowspan)>1||p>1)&&y.push({s:{r:c,c:d},e:{r:c+(h||1)-1,c:d+p-1}});var F=w.t||w["data-t"]||"";if(!_.length){d+=p;continue}if(_=bS(_),m.s.r>c&&(m.s.r=c),m.e.r<c&&(m.e.r=c),m.s.c>d&&(m.s.c=d),m.e.c<d&&(m.e.c=d),!_.length){d+=p;continue}var S={t:"s",v:_};r.raw||!_.trim().length||F=="s"||(_==="TRUE"?S={t:"b",v:!0}:_==="FALSE"?S={t:"b",v:!1}:isNaN(bs(_))?isNaN(Xc(_).getDate())||(S={t:"d",v:ur(_)},r.cellDates||(S={t:"n",v:tn(S.v)}),S.z=r.dateNF||at[14]):S={t:"n",v:bs(_)}),r.dense?(n[c]||(n[c]=[]),n[c][d]=S):n[ot({r:c,c:d})]=S,d+=p}}}}return n["!ref"]=xt(m),y.length&&(n["!merges"]=y),n}function RL(t,e,r,n){for(var i=t["!merges"]||[],s=[],a=e.s.c;a<=e.e.c;++a){for(var o=0,l=0,c=0;c<i.length;++c)if(!(i[c].s.r>r||i[c].s.c>a)&&!(i[c].e.r<r||i[c].e.c<a)){if(i[c].s.r<r||i[c].s.c<a){o=-1;break}o=i[c].e.r-i[c].s.r+1,l=i[c].e.c-i[c].s.c+1;break}if(!(o<0)){var d=ot({r,c:a}),h=n.dense?(t[r]||[])[a]:t[d],p=h&&h.v!=null&&(h.h||N1(h.w||(Da(h),h.w)||""))||"",m={};o>1&&(m.rowspan=o),l>1&&(m.colspan=l),n.editable?p='<span contenteditable="true">'+p+"</span>":h&&(m["data-t"]=h&&h.t||"z",h.v!=null&&(m["data-v"]=h.v),h.z!=null&&(m["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(p='<a href="'+h.l.Target+'">'+p+"</a>")),m.id=(n.id||"sjs")+"-"+d,s.push(Be("td",p,m))}}var y="<tr>";return y+s.join("")+"</tr>"}var NL='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',DL="</body></html>";function PL(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Ho(E2(r[0],e),e);var n=ov();return r.forEach(function(i,s){lv(n,E2(i,e),"Sheet"+(s+1))}),n}function OL(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function ok(t,e){var r=e||{},n=r.header!=null?r.header:NL,i=r.footer!=null?r.footer:DL,s=[n],a=Ai(t["!ref"]);r.dense=Array.isArray(t),s.push(OL(t,a,r));for(var o=a.s.r;o<=a.e.r;++o)s.push(RL(t,a,o,r));return s.push("</table>"+i),s.join("")}function lk(t,e,r){var n=r||{},i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var a=typeof n.origin=="string"?Sr(n.origin):n.origin;i=a.r,s=a.c}var o=e.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:i,c:s}};if(t["!ref"]){var d=Ai(t["!ref"]);c.s.r=Math.min(c.s.r,d.s.r),c.s.c=Math.min(c.s.c,d.s.c),c.e.r=Math.max(c.e.r,d.e.r),c.e.c=Math.max(c.e.c,d.e.c),i==-1&&(c.e.r=i=d.e.r+1)}var h=[],p=0,m=t["!rows"]||(t["!rows"]=[]),y=0,x=0,E=0,T=0,A=0,_=0;for(t["!cols"]||(t["!cols"]=[]);y<o.length&&x<l;++y){var P=o[y];if(w2(P)){if(n.display)continue;m[x]={hidden:!0}}var W=P.children;for(E=T=0;E<W.length;++E){var B=W[E];if(!(n.display&&w2(B))){var w=B.hasAttribute("data-v")?B.getAttribute("data-v"):B.hasAttribute("v")?B.getAttribute("v"):bS(B.innerHTML),F=B.getAttribute("data-z")||B.getAttribute("z");for(p=0;p<h.length;++p){var S=h[p];S.s.c==T+s&&S.s.r<x+i&&x+i<=S.e.r&&(T=S.e.c+1-s,p=-1)}_=+B.getAttribute("colspan")||1,((A=+B.getAttribute("rowspan")||1)>1||_>1)&&h.push({s:{r:x+i,c:T+s},e:{r:x+i+(A||1)-1,c:T+s+(_||1)-1}});var b={t:"s",v:w},N=B.getAttribute("data-t")||B.getAttribute("t")||"";w!=null&&(w.length==0?b.t=N||"z":n.raw||w.trim().length==0||N=="s"||(w==="TRUE"?b={t:"b",v:!0}:w==="FALSE"?b={t:"b",v:!1}:isNaN(bs(w))?isNaN(Xc(w).getDate())||(b={t:"d",v:ur(w)},n.cellDates||(b={t:"n",v:tn(b.v)}),b.z=n.dateNF||at[14]):b={t:"n",v:bs(w)})),b.z===void 0&&F!=null&&(b.z=F);var D="",R=B.getElementsByTagName("A");if(R&&R.length)for(var Ue=0;Ue<R.length&&!(R[Ue].hasAttribute("href")&&(D=R[Ue].getAttribute("href"),D.charAt(0)!="#"));++Ue);D&&D.charAt(0)!="#"&&(b.l={Target:D}),n.dense?(t[x+i]||(t[x+i]=[]),t[x+i][T+s]=b):t[ot({c:T+s,r:x+i})]=b,c.e.c<T+s&&(c.e.c=T+s),T+=_}}++x}return h.length&&(t["!merges"]=(t["!merges"]||[]).concat(h)),c.e.r=Math.max(c.e.r,x-1+i),t["!ref"]=xt(c),x>=l&&(t["!fullref"]=xt((c.e.r=o.length-y+x-1+i,c))),t}function ck(t,e){var r=e||{},n=r.dense?[]:{};return lk(n,t,e)}function ML(t,e){return Ho(ck(t,e),e)}function w2(t){var e="",r=LL(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function LL(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function BL(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Dt(e.replace(/<[^>]*>/g,""));return[r]}var T2={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function uk(t,e){var r=e||{},n=D1(t),i=[],s,a,o={name:""},l="",c=0,d,h,p={},m=[],y=r.dense?[]:{},x,E,T={value:""},A="",_=0,P=[],W=-1,B=-1,w={s:{r:1e6,c:1e7},e:{r:0,c:0}},F=0,S={},b=[],N={},D=0,R=0,Ue=[],me=1,Ie=1,Te=[],_e={Names:[]},Q={},ke=["",""],Le=[],j={},H="",q=0,Y=!1,de=!1,Se=0;for(Hf.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");x=Hf.exec(n);)switch(x[3]=x[3].replace(/_.*$/,"")){case"table":case"":x[1]==="/"?(w.e.c>=w.s.c&&w.e.r>=w.s.r?y["!ref"]=xt(w):y["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=w.e.r&&(y["!fullref"]=y["!ref"],w.e.r=r.sheetRows-1,y["!ref"]=xt(w)),b.length&&(y["!merges"]=b),Ue.length&&(y["!rows"]=Ue),d.name=d.||d.name,typeof JSON<"u"&&JSON.stringify(d),m.push(d.name),p[d.name]=y,de=!1):x[0].charAt(x[0].length-2)!=="/"&&(d=lt(x[0],!1),W=B=-1,w.s.r=w.s.c=1e7,w.e.r=w.e.c=0,y=r.dense?[]:{},b=[],Ue=[],de=!0);break;case"table-row-group":x[1]==="/"?--F:++F;break;case"table-row":case"":if(x[1]==="/"){W+=me,me=1;break}if(h=lt(x[0],!1),h.?W=h.-1:W==-1&&(W=0),me=+h["number-rows-repeated"]||1,me<10)for(Se=0;Se<me;++Se)F>0&&(Ue[W+Se]={level:F});B=-1;break;case"covered-table-cell":x[1]!=="/"&&++B,r.sheetStubs&&(r.dense?(y[W]||(y[W]=[]),y[W][B]={t:"z"}):y[ot({r:W,c:B})]={t:"z"}),A="",P=[];break;case"table-cell":case"":if(x[0].charAt(x[0].length-2)==="/")++B,T=lt(x[0],!1),Ie=parseInt(T["number-columns-repeated"]||"1",10),E={t:"z",v:null},T.formula&&r.cellFormula!=!1&&(E.f=v2(Dt(T.formula))),(T.||T["value-type"])=="string"&&(E.t="s",E.v=Dt(T["string-value"]||""),r.dense?(y[W]||(y[W]=[]),y[W][B]=E):y[ot({r:W,c:B})]=E),B+=Ie-1;else if(x[1]!=="/"){++B,A="",_=0,P=[],Ie=1;var Ne=me?W+me-1:W;if(B>w.e.c&&(w.e.c=B),B<w.s.c&&(w.s.c=B),W<w.s.r&&(w.s.r=W),Ne>w.e.r&&(w.e.r=Ne),T=lt(x[0],!1),Le=[],j={},E={t:T.||T["value-type"],v:null},r.cellFormula)if(T.formula&&(T.formula=Dt(T.formula)),T["number-matrix-columns-spanned"]&&T["number-matrix-rows-spanned"]&&(D=parseInt(T["number-matrix-rows-spanned"],10)||0,R=parseInt(T["number-matrix-columns-spanned"],10)||0,N={s:{r:W,c:B},e:{r:W+D-1,c:B+R-1}},E.F=xt(N),Te.push([N,E.F])),T.formula)E.f=v2(T.formula);else for(Se=0;Se<Te.length;++Se)W>=Te[Se][0].s.r&&W<=Te[Se][0].e.r&&B>=Te[Se][0].s.c&&B<=Te[Se][0].e.c&&(E.F=Te[Se][1]);switch((T["number-columns-spanned"]||T["number-rows-spanned"])&&(D=parseInt(T["number-rows-spanned"],10)||0,R=parseInt(T["number-columns-spanned"],10)||0,N={s:{r:W,c:B},e:{r:W+D-1,c:B+R-1}},b.push(N)),T["number-columns-repeated"]&&(Ie=parseInt(T["number-columns-repeated"],10)),E.t){case"boolean":E.t="b",E.v=lr(T["boolean-value"]);break;case"float":E.t="n",E.v=parseFloat(T.value);break;case"percentage":E.t="n",E.v=parseFloat(T.value);break;case"currency":E.t="n",E.v=parseFloat(T.value);break;case"date":E.t="d",E.v=ur(T["date-value"]),r.cellDates||(E.t="n",E.v=tn(E.v)),E.z="m/d/yy";break;case"time":E.t="n",E.v=fR(T["time-value"])/86400,r.cellDates&&(E.t="d",E.v=Fp(E.v)),E.z="HH:MM:SS";break;case"number":E.t="n",E.v=parseFloat(T.);break;default:if(E.t==="string"||E.t==="text"||!E.t)E.t="s",T["string-value"]!=null&&(A=Dt(T["string-value"]),P=[]);else throw new Error("Unsupported value type "+E.t)}}else{if(Y=!1,E.t==="s"&&(E.v=A||"",P.length&&(E.R=P),Y=_==0),Q.Target&&(E.l=Q),Le.length>0&&(E.c=Le,Le=[]),A&&r.cellText!==!1&&(E.w=A),Y&&(E.t="z",delete E.v),(!Y||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=W))for(var Ae=0;Ae<me;++Ae){if(Ie=parseInt(T["number-columns-repeated"]||"1",10),r.dense)for(y[W+Ae]||(y[W+Ae]=[]),y[W+Ae][B]=Ae==0?E:fr(E);--Ie>0;)y[W+Ae][B+Ie]=fr(E);else for(y[ot({r:W+Ae,c:B})]=E;--Ie>0;)y[ot({r:W+Ae,c:B+Ie})]=fr(E);w.e.c<=B&&(w.e.c=B)}Ie=parseInt(T["number-columns-repeated"]||"1",10),B+=Ie-1,Ie=0,E={},A="",P=[]}Q={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(x[1]==="/"){if((s=i.pop())[0]!==x[3])throw"Bad state: "+s}else x[0].charAt(x[0].length-2)!=="/"&&i.push([x[3],!0]);break;case"annotation":if(x[1]==="/"){if((s=i.pop())[0]!==x[3])throw"Bad state: "+s;j.t=A,P.length&&(j.R=P),j.a=H,Le.push(j)}else x[0].charAt(x[0].length-2)!=="/"&&i.push([x[3],!1]);H="",q=0,A="",_=0,P=[];break;case"creator":x[1]==="/"?H=n.slice(q,x.index):q=x.index+x[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(x[1]==="/"){if((s=i.pop())[0]!==x[3])throw"Bad state: "+s}else x[0].charAt(x[0].length-2)!=="/"&&i.push([x[3],!1]);A="",_=0,P=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(x[1]==="/"){if(S[o.name]=l,(s=i.pop())[0]!==x[3])throw"Bad state: "+s}else x[0].charAt(x[0].length-2)!=="/"&&(l="",o=lt(x[0],!1),i.push([x[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":a=lt(x[0],!1),l+=T2[x[3]][a.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":a=lt(x[0],!1),l+=T2[x[3]][a.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(x[0].slice(-2)==="/>")break;if(x[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(c,x.index);break}else c=x.index+x[0].length;break;case"named-range":a=lt(x[0],!1),ke=bg(a["cell-range-address"]);var we={Name:a.name,Ref:ke[0]+"!"+ke[1]};de&&(we.Sheet=m.length),_e.Names.push(we);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(x[1]==="/"&&(!T||!T["string-value"])){var it=BL(n.slice(_,x.index));A=(A.length>0?A+`
`:"")+it[0]}else lt(x[0],!1),_=x.index+x[0].length;break;case"s":break;case"database-range":if(x[1]==="/")break;try{ke=bg(lt(x[0])["target-range-address"]),p[ke[0]]["!autofilter"]={ref:ke[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(x[1]!=="/"){if(Q=lt(x[0],!1),!Q.href)break;Q.Target=Dt(Q.href),delete Q.href,Q.Target.charAt(0)=="#"&&Q.Target.indexOf(".")>-1?(ke=bg(Q.Target.slice(1)),Q.Target="#"+ke[0]+"!"+ke[1]):Q.Target.match(/^\.\.[\\\/]/)&&(Q.Target=Q.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(x[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(x)}}var G={Sheets:p,SheetNames:m,Workbook:_e};return r.bookSheets&&delete G.Sheets,G}function S2(t,e){e=e||{},ts(t,"META-INF/manifest.xml")&&fN(zr(t,"META-INF/manifest.xml"),e);var r=Li(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=uk(Qt(r),e);return ts(t,"meta.xml")&&(n.Props=eA(zr(t,"meta.xml"))),n}function A2(t,e){return uk(t,e)}var jL=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+Wf({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return Br+e}}(),k2=function(){var t=function(s){return Gt(s).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,a,o){var l=[];l.push('      <table:table table:name="'+Gt(a.SheetNames[o])+`" table:style-name="ta1">
`);var c=0,d=0,h=Ai(s["!ref"]||"A1"),p=s["!merges"]||[],m=0,y=Array.isArray(s);if(s["!cols"])for(d=0;d<=h.e.c;++d)l.push("        <table:table-column"+(s["!cols"][d]?' table:style-name="co'+s["!cols"][d].ods+'"':"")+`></table:table-column>
`);var x="",E=s["!rows"]||[];for(c=0;c<h.s.r;++c)x=E[c]?' table:style-name="ro'+E[c].ods+'"':"",l.push("        <table:table-row"+x+`></table:table-row>
`);for(;c<=h.e.r;++c){for(x=E[c]?' table:style-name="ro'+E[c].ods+'"':"",l.push("        <table:table-row"+x+`>
`),d=0;d<h.s.c;++d)l.push(e);for(;d<=h.e.c;++d){var T=!1,A={},_="";for(m=0;m!=p.length;++m)if(!(p[m].s.c>d)&&!(p[m].s.r>c)&&!(p[m].e.c<d)&&!(p[m].e.r<c)){(p[m].s.c!=d||p[m].s.r!=c)&&(T=!0),A["table:number-columns-spanned"]=p[m].e.c-p[m].s.c+1,A["table:number-rows-spanned"]=p[m].e.r-p[m].s.r+1;break}if(T){l.push(r);continue}var P=ot({r:c,c:d}),W=y?(s[c]||[])[d]:s[P];if(W&&W.f&&(A["table:formula"]=Gt(s5(W.f)),W.F&&W.F.slice(0,P.length)==P)){var B=Ai(W.F);A["table:number-matrix-columns-spanned"]=B.e.c-B.s.c+1,A["table:number-matrix-rows-spanned"]=B.e.r-B.s.r+1}if(!W){l.push(e);continue}switch(W.t){case"b":_=W.v?"TRUE":"FALSE",A["office:value-type"]="boolean",A["office:boolean-value"]=W.v?"true":"false";break;case"n":_=W.w||String(W.v||0),A["office:value-type"]="float",A["office:value"]=W.v||0;break;case"s":case"str":_=W.v==null?"":W.v,A["office:value-type"]="string";break;case"d":_=W.w||ur(W.v).toISOString(),A["office:value-type"]="date",A["office:date-value"]=ur(W.v).toISOString(),A["table:style-name"]="ce1";break;default:l.push(e);continue}var w=t(_);if(W.l&&W.l.Target){var F=W.l.Target;F=F.charAt(0)=="#"?"#"+a5(F.slice(1)):F,F.charAt(0)!="#"&&!F.match(/^\w+:/)&&(F="../"+F),w=Be("text:a",w,{"xlink:href":F.replace(/&/g,"&amp;")})}l.push("          "+Be("table:table-cell",Be("text:p",w,{}),A)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},i=function(s,a){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;a.SheetNames.map(function(c){return a.Sheets[c]}).forEach(function(c){if(c&&c["!cols"]){for(var d=0;d<c["!cols"].length;++d)if(c["!cols"][d]){var h=c["!cols"][d];if(h.width==null&&h.wpx==null&&h.wch==null)continue;Po(h),h.ods=o;var p=c["!cols"][d].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+p+`"/>
`),s.push(`  </style:style>
`),++o}}});var l=0;a.SheetNames.map(function(c){return a.Sheets[c]}).forEach(function(c){if(c&&c["!rows"]){for(var d=0;d<c["!rows"].length;++d)if(c["!rows"][d]){c["!rows"][d].ods=l;var h=c["!rows"][d].hpx+"px";s.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h+`"/>
`),s.push(`  </style:style>
`),++l}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(a,o){var l=[Br],c=Wf({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=Wf({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+c+d+`>
`),l.push(ZS().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+c+`>
`),i(l,a),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var h=0;h!=a.SheetNames.length;++h)l.push(n(a.Sheets[a.SheetNames[h]],a,h));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function fk(t,e){if(e.bookType=="fods")return k2(t,e);var r=I1(),n="",i=[],s=[];return n="mimetype",vt(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",vt(r,n,k2(t,e)),i.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",vt(r,n,jL(t,e)),i.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",vt(r,n,Br+ZS()),i.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",vt(r,n,pN(s)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",vt(r,n,dN(i)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Fl(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function ix(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):Qt(Wo(t))}function VL(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):Mi(Ys(t))}function UL(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var n=0;n<e.length;++n)if(t[r+n]!=e[n])continue e;return!0}return!1}function Mo(t){var e=t.reduce(function(i,s){return i+s.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(i){r.set(i,n),n+=i.length}),r}function C2(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function zL(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,i=e+13;i>=e;--i)n=n*256+t[i];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function WL(t,e,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,n-6176);t[e+15]|=n>>7,t[e+14]|=(n&127)<<1;for(var s=0;i>=1;++s,i/=256)t[e+s]=i&255;t[e+15]|=r>=0?0:128}function Qf(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function Ht(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function Nr(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function Lt(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],i=Qf(t,r),s=i&7;i=Math.floor(i/8);var a=0,o;if(i==0)break;switch(s){case 0:{for(var l=r[0];t[r[0]++]>=128;);o=t.slice(l,r[0])}break;case 5:a=4,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 1:a=8,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 2:a=Qf(t,r),o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var c={data:o,type:s};e[i]==null?e[i]=[c]:e[i].push(c)}return e}function wn(t){var e=[];return t.forEach(function(r,n){r.forEach(function(i){i.data&&(e.push(Ht(n*8+i.type)),i.type==2&&e.push(Ht(i.data.length)),e.push(i.data))})}),Mo(e)}function rv(t,e){return(t==null?void 0:t.map(function(r){return e(r.data)}))||[]}function Zi(t){for(var e,r=[],n=[0];n[0]<t.length;){var i=Qf(t,n),s=Lt(t.slice(n[0],n[0]+i));n[0]+=i;var a={id:Nr(s[1][0].data),messages:[]};s[2].forEach(function(o){var l=Lt(o.data),c=Nr(l[3][0].data);a.messages.push({meta:l,data:t.slice(n[0],n[0]+c)}),n[0]+=c}),(e=s[3])!=null&&e[0]&&(a.merge=Nr(s[3][0].data)>>>0>0),r.push(a)}return r}function ac(t){var e=[];return t.forEach(function(r){var n=[];n[1]=[{data:Ht(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Ht(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(a){i.push(a.data),a.meta[3]=[{type:0,data:Ht(a.data.length)}],n[2].push({data:wn(a.meta),type:2})});var s=wn(n);e.push(Ht(s.length)),e.push(s),i.forEach(function(a){return e.push(a)})}),Mo(e)}function HL(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=Qf(e,r),i=[];r[0]<e.length;){var s=e[r[0]]&3;if(s==0){var a=e[r[0]++]>>2;if(a<60)++a;else{var o=a-59;a=e[r[0]],o>1&&(a|=e[r[0]+1]<<8),o>2&&(a|=e[r[0]+2]<<16),o>3&&(a|=e[r[0]+3]<<24),a>>>=0,a++,r[0]+=o}i.push(e.slice(r[0],r[0]+a)),r[0]+=a;continue}else{var l=0,c=0;if(s==1?(c=(e[r[0]]>>2&7)+4,l=(e[r[0]++]&224)<<3,l|=e[r[0]++]):(c=(e[r[0]++]>>2)+1,s==2?(l=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(l=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),i=[Mo(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(i.push(i[0].slice(-l)),c-=l;c>=i[i.length-1].length;)i.push(i[i.length-1]),c-=i[i.length-1].length;i.push(i[0].slice(-l,-l+c))}}var d=Mo(i);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function es(t){for(var e=[],r=0;r<t.length;){var n=t[r++],i=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(HL(n,t.slice(r,r+i))),r+=i}if(r!==t.length)throw new Error("data is not a valid framed stream!");return Mo(e)}function oc(t){for(var e=[],r=0;r<t.length;){var n=Math.min(t.length-r,268435455),i=new Uint8Array(4);e.push(i);var s=Ht(n),a=s.length;e.push(s),n<=60?(a++,e.push(new Uint8Array([n-1<<2]))):n<=256?(a+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(a+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(a+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(a+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(t.slice(r,r+n)),a+=n,i[0]=0,i[1]=a&255,i[2]=a>>8&255,i[3]=a>>16&255,r+=n}return Mo(e)}function $L(t,e,r,n){var i=Fl(t),s=i.getUint32(4,!0),a=(n>1?12:8)+C2(s&(n>1?3470:398))*4,o=-1,l=-1,c=NaN,d=new Date(2001,0,1);s&512&&(o=i.getUint32(a,!0),a+=4),a+=C2(s&(n>1?12288:4096))*4,s&16&&(l=i.getUint32(a,!0),a+=4),s&32&&(c=i.getFloat64(a,!0),a+=8),s&64&&(d.setTime(d.getTime()+i.getFloat64(a,!0)*1e3),a+=8);var h;switch(t[2]){case 0:break;case 2:h={t:"n",v:c};break;case 3:h={t:"s",v:e[l]};break;case 5:h={t:"d",v:d};break;case 6:h={t:"b",v:c>0};break;case 7:h={t:"n",v:c/86400};break;case 8:h={t:"e",v:0};break;case 9:if(o>-1)h={t:"s",v:r[o]};else if(l>-1)h={t:"s",v:e[l]};else if(!isNaN(c))h={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return h}function GL(t,e,r){var n=Fl(t),i=n.getUint32(8,!0),s=12,a=-1,o=-1,l=NaN,c=NaN,d=new Date(2001,0,1);i&1&&(l=zL(t,s),s+=16),i&2&&(c=n.getFloat64(s,!0),s+=8),i&4&&(d.setTime(d.getTime()+n.getFloat64(s,!0)*1e3),s+=8),i&8&&(o=n.getUint32(s,!0),s+=4),i&16&&(a=n.getUint32(s,!0),s+=4);var h;switch(t[1]){case 0:break;case 2:h={t:"n",v:l};break;case 3:h={t:"s",v:e[o]};break;case 5:h={t:"d",v:d};break;case 6:h={t:"b",v:c>0};break;case 7:h={t:"n",v:c/86400};break;case 8:h={t:"e",v:0};break;case 9:if(a>-1)h={t:"s",v:r[a]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)));break;case 10:h={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)))}return h}function Ng(t,e){var r=new Uint8Array(32),n=Fl(r),i=12,s=0;switch(r[0]=5,t.t){case"n":r[1]=2,WL(r,i,t.v),s|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,t.v?1:0,!0),s|=2,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,n.setUint32(i,e.indexOf(t.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,s,!0),r.slice(0,i)}function Dg(t,e){var r=new Uint8Array(32),n=Fl(r),i=12,s=0;switch(r[0]=3,t.t){case"n":r[2]=2,n.setFloat64(i,t.v,!0),s|=32,i+=8;break;case"b":r[2]=6,n.setFloat64(i,t.v?1:0,!0),s|=32,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,n.setUint32(i,e.indexOf(t.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,s,!0),r.slice(0,i)}function KL(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return $L(t,e,r,t[0]);case 5:return GL(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function Bn(t){var e=Lt(t);return Qf(e[1][0].data)}function F2(t,e){var r=Lt(e.data),n=Nr(r[1][0].data),i=r[3],s=[];return(i||[]).forEach(function(a){var o=Lt(a.data),l=Nr(o[1][0].data)>>>0;switch(n){case 1:s[l]=ix(o[3][0].data);break;case 8:{var c=t[Bn(o[9][0].data)][0],d=Lt(c.data),h=t[Bn(d[1][0].data)][0],p=Nr(h.meta[1][0].data);if(p!=2001)throw new Error("2000 unexpected reference to ".concat(p));var m=Lt(h.data);s[l]=m[3].map(function(y){return ix(y.data)}).join("")}break}}),s}function XL(t,e){var r,n,i,s,a,o,l,c,d,h,p,m,y,x,E=Lt(t),T=Nr(E[1][0].data)>>>0,A=Nr(E[2][0].data)>>>0,_=((n=(r=E[8])==null?void 0:r[0])==null?void 0:n.data)&&Nr(E[8][0].data)>0||!1,P,W;if((s=(i=E[7])==null?void 0:i[0])!=null&&s.data&&e!=0)P=(o=(a=E[7])==null?void 0:a[0])==null?void 0:o.data,W=(c=(l=E[6])==null?void 0:l[0])==null?void 0:c.data;else if((h=(d=E[4])==null?void 0:d[0])!=null&&h.data&&e!=1)P=(m=(p=E[4])==null?void 0:p[0])==null?void 0:m.data,W=(x=(y=E[3])==null?void 0:y[0])==null?void 0:x.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var B=_?4:1,w=Fl(P),F=[],S=0;S<P.length/2;++S){var b=w.getUint16(S*2,!0);b<65535&&F.push([S,b])}if(F.length!=A)throw"Expected ".concat(A," cells, found ").concat(F.length);var N=[];for(S=0;S<F.length-1;++S)N[F[S][0]]=W.subarray(F[S][1]*B,F[S+1][1]*B);return F.length>=1&&(N[F[F.length-1][0]]=W.subarray(F[F.length-1][1]*B)),{R:T,cells:N}}function YL(t,e){var r,n=Lt(e.data),i=(r=n==null?void 0:n[7])!=null&&r[0]?Nr(n[7][0].data)>>>0>0?1:0:-1,s=rv(n[5],function(a){return XL(a,i)});return{nrows:Nr(n[4][0].data)>>>0,data:s.reduce(function(a,o){return a[o.R]||(a[o.R]=[]),o.cells.forEach(function(l,c){if(a[o.R][c])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(c));a[o.R][c]=l}),a},[])}}function qL(t,e,r){var n,i=Lt(e.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Nr(i[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(s.e.c=(Nr(i[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=xt(s);var a=Lt(i[4][0].data),o=F2(t,t[Bn(a[4][0].data)][0]),l=(n=a[17])!=null&&n[0]?F2(t,t[Bn(a[17][0].data)][0]):[],c=Lt(a[3][0].data),d=0;c[1].forEach(function(h){var p=Lt(h.data),m=t[Bn(p[2][0].data)][0],y=Nr(m.meta[1][0].data);if(y!=6002)throw new Error("6001 unexpected reference to ".concat(y));var x=YL(t,m);x.data.forEach(function(E,T){E.forEach(function(A,_){var P=ot({r:d+T,c:_}),W=KL(A,o,l);W&&(r[P]=W)})}),d+=x.nrows})}function QL(t,e){var r=Lt(e.data),n={"!ref":"A1"},i=t[Bn(r[2][0].data)],s=Nr(i[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return qL(t,i[0],n),n}function JL(t,e){var r,n=Lt(e.data),i={name:(r=n[1])!=null&&r[0]?ix(n[1][0].data):"",sheets:[]},s=rv(n[2],Bn);return s.forEach(function(a){t[a].forEach(function(o){var l=Nr(o.meta[1][0].data);l==6e3&&i.sheets.push(QL(t,o))})}),i}function ZL(t,e){var r=ov(),n=Lt(e.data),i=rv(n[1],Bn);if(i.forEach(function(s){t[s].forEach(function(a){var o=Nr(a.meta[1][0].data);if(o==2){var l=JL(t,a);l.sheets.forEach(function(c,d){lv(r,c,d==0?l.name:l.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Pg(t){var e,r,n,i,s={},a=[];if(t.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var c;try{c=es(l.content)}catch(h){return console.log("?? "+l.content.length+" "+(h.message||h))}var d;try{d=Zi(c)}catch(h){return console.log("## "+(h.message||h))}d.forEach(function(h){s[h.id]=h.messages,a.push(h.id)})}}),!a.length)throw new Error("File has no messages");var o=((i=(n=(r=(e=s==null?void 0:s[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&Nr(s[1][0].meta[1][0].data)==1&&s[1][0];if(o||a.forEach(function(l){s[l].forEach(function(c){var d=Nr(c.meta[1][0].data)>>>0;if(d==1)if(!o)o=c;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return ZL(s,o)}function eB(t,e,r){var n,i,s,a;if(!((n=t[6])!=null&&n[0])||!((i=t[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var o=((a=(s=t[8])==null?void 0:s[0])==null?void 0:a.data)&&Nr(t[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,c=Fl(t[7][0].data),d=0,h=[],p=Fl(t[4][0].data),m=0,y=[],x=0;x<e.length;++x){if(e[x]==null){c.setUint16(x*2,65535,!0),p.setUint16(x*2,65535);continue}c.setUint16(x*2,d,!0),p.setUint16(x*2,m,!0);var E,T;switch(typeof e[x]){case"string":E=Ng({t:"s",v:e[x]},r),T=Dg({t:"s",v:e[x]},r);break;case"number":E=Ng({t:"n",v:e[x]},r),T=Dg({t:"n",v:e[x]},r);break;case"boolean":E=Ng({t:"b",v:e[x]},r),T=Dg({t:"b",v:e[x]},r);break;default:throw new Error("Unsupported value "+e[x])}h.push(E),d+=E.length,y.push(T),m+=T.length,++l}for(t[2][0].data=Ht(l);x<t[7][0].data.length/2;++x)c.setUint16(x*2,65535,!0),p.setUint16(x*2,65535,!0);return t[6][0].data=Mo(h),t[3][0].data=Mo(y),l}function tB(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Ai(r["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(xt(n)));var s=Hh(r,{range:n,header:1}),a=["~Sh33tJ5~"];s.forEach(function(H){return H.forEach(function(q){typeof q=="string"&&a.push(q)})});var o={},l=[],c=tt.read(e.numbers,{type:"base64"});c.FileIndex.map(function(H,q){return[H,c.FullPaths[q]]}).forEach(function(H){var q=H[0],Y=H[1];if(q.type==2&&q.name.match(/\.iwa/)){var de=q.content,Se=es(de),Ne=Zi(Se);Ne.forEach(function(Ae){l.push(Ae.id),o[Ae.id]={deps:[],location:Y,type:Nr(Ae.messages[0].meta[1][0].data)}})}}),l.sort(function(H,q){return H-q});var d=l.filter(function(H){return H>1}).map(function(H){return[H,Ht(H)]});c.FileIndex.map(function(H,q){return[H,c.FullPaths[q]]}).forEach(function(H){var q=H[0];if(H[1],!!q.name.match(/\.iwa/)){var Y=Zi(es(q.content));Y.forEach(function(de){de.messages.forEach(function(Se){d.forEach(function(Ne){de.messages.some(function(Ae){return Nr(Ae.meta[1][0].data)!=11006&&UL(Ae.data,Ne[1])})&&o[Ne[0]].deps.push(de.id)})})})}});for(var h=tt.find(c,o[1].location),p=Zi(es(h.content)),m,y=0;y<p.length;++y){var x=p[y];x.id==1&&(m=x)}var E=Bn(Lt(m.messages[0].data)[1][0].data);for(h=tt.find(c,o[E].location),p=Zi(es(h.content)),y=0;y<p.length;++y)x=p[y],x.id==E&&(m=x);for(E=Bn(Lt(m.messages[0].data)[2][0].data),h=tt.find(c,o[E].location),p=Zi(es(h.content)),y=0;y<p.length;++y)x=p[y],x.id==E&&(m=x);for(E=Bn(Lt(m.messages[0].data)[2][0].data),h=tt.find(c,o[E].location),p=Zi(es(h.content)),y=0;y<p.length;++y)x=p[y],x.id==E&&(m=x);var T=Lt(m.messages[0].data);{T[6][0].data=Ht(n.e.r+1),T[7][0].data=Ht(n.e.c+1);var A=Bn(T[46][0].data),_=tt.find(c,o[A].location),P=Zi(es(_.content));{for(var W=0;W<P.length&&P[W].id!=A;++W);if(P[W].id!=A)throw"Bad ColumnRowUIDMapArchive";var B=Lt(P[W].messages[0].data);B[1]=[],B[2]=[],B[3]=[];for(var w=0;w<=n.e.c;++w){var F=[];F[1]=F[2]=[{type:0,data:Ht(w+420690)}],B[1].push({type:2,data:wn(F)}),B[2].push({type:0,data:Ht(w)}),B[3].push({type:0,data:Ht(w)})}B[4]=[],B[5]=[],B[6]=[];for(var S=0;S<=n.e.r;++S)F=[],F[1]=F[2]=[{type:0,data:Ht(S+726270)}],B[4].push({type:2,data:wn(F)}),B[5].push({type:0,data:Ht(S)}),B[6].push({type:0,data:Ht(S)});P[W].messages[0].data=wn(B)}_.content=oc(ac(P)),_.size=_.content.length,delete T[46];var b=Lt(T[4][0].data);{b[7][0].data=Ht(n.e.r+1);var N=Lt(b[1][0].data),D=Bn(N[2][0].data);_=tt.find(c,o[D].location),P=Zi(es(_.content));{if(P[0].id!=D)throw"Bad HeaderStorageBucket";var R=Lt(P[0].messages[0].data);for(S=0;S<s.length;++S){var Ue=Lt(R[2][0].data);Ue[1][0].data=Ht(S),Ue[4][0].data=Ht(s[S].length),R[2][S]={type:R[2][0].type,data:wn(Ue)}}P[0].messages[0].data=wn(R)}_.content=oc(ac(P)),_.size=_.content.length;var me=Bn(b[2][0].data);_=tt.find(c,o[me].location),P=Zi(es(_.content));{if(P[0].id!=me)throw"Bad HeaderStorageBucket";for(R=Lt(P[0].messages[0].data),w=0;w<=n.e.c;++w)Ue=Lt(R[2][0].data),Ue[1][0].data=Ht(w),Ue[4][0].data=Ht(n.e.r+1),R[2][w]={type:R[2][0].type,data:wn(Ue)};P[0].messages[0].data=wn(R)}_.content=oc(ac(P)),_.size=_.content.length;var Ie=Bn(b[4][0].data);(function(){for(var H=tt.find(c,o[Ie].location),q=Zi(es(H.content)),Y,de=0;de<q.length;++de){var Se=q[de];Se.id==Ie&&(Y=Se)}var Ne=Lt(Y.messages[0].data);{Ne[3]=[];var Ae=[];a.forEach(function(G,jt){Ae[1]=[{type:0,data:Ht(jt)}],Ae[2]=[{type:0,data:Ht(1)}],Ae[3]=[{type:2,data:VL(G)}],Ne[3].push({type:2,data:wn(Ae)})})}Y.messages[0].data=wn(Ne);var we=ac(q),it=oc(we);H.content=it,H.size=H.content.length})();var Te=Lt(b[3][0].data);{var _e=Te[1][0];delete Te[2];var Q=Lt(_e.data);{var ke=Bn(Q[2][0].data);(function(){for(var H=tt.find(c,o[ke].location),q=Zi(es(H.content)),Y,de=0;de<q.length;++de){var Se=q[de];Se.id==ke&&(Y=Se)}var Ne=Lt(Y.messages[0].data);{delete Ne[6],delete Te[7];var Ae=new Uint8Array(Ne[5][0].data);Ne[5]=[];for(var we=0,it=0;it<=n.e.r;++it){var G=Lt(Ae);we+=eB(G,s[it],a),G[1][0].data=Ht(it),Ne[5].push({data:wn(G),type:2})}Ne[1]=[{type:0,data:Ht(n.e.c+1)}],Ne[2]=[{type:0,data:Ht(n.e.r+1)}],Ne[3]=[{type:0,data:Ht(we)}],Ne[4]=[{type:0,data:Ht(n.e.r+1)}]}Y.messages[0].data=wn(Ne);var jt=ac(q),mt=oc(jt);H.content=mt,H.size=H.content.length})()}_e.data=wn(Q)}b[3][0].data=wn(Te)}T[4][0].data=wn(b)}m.messages[0].data=wn(T);var Le=ac(p),j=oc(Le);return h.content=j,h.size=h.content.length,c}function dk(t){return function(r){for(var n=0;n!=t.length;++n){var i=t[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function nv(t){dk([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function iv(t){dk([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function rB(t){return _t.WS.indexOf(t)>-1?"sheet":t==_t.CS?"chart":t==_t.DS?"dialog":t==_t.MS?"macro":t&&t.length?t:"sheet"}function nB(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,rB(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function iB(t,e,r,n,i,s,a,o,l,c,d,h){try{s[n]=df(Li(t,r,!0),e);var p=zr(t,e),m;switch(o){case"sheet":m=kM(p,e,i,l,s[n],c,d,h);break;case"chart":if(m=CM(p,e,i,l,s[n],c,d,h),!m||!m["!drawel"])break;var y=Xu(m["!drawel"].Target,e),x=$f(y),E=h6(Li(t,y,!0),df(Li(t,x,!0),y)),T=Xu(E,y),A=$f(T);m=eM(Li(t,T,!0),T,l,df(Li(t,A,!0),T),c,m);break;case"macro":m=FM(p,e,i,l,s[n],c,d,h);break;case"dialog":m=IM(p,e,i,l,s[n],c,d,h);break;default:throw new Error("Unrecognized sheet type "+o)}a[n]=m;var _=[];s&&s[n]&&Dr(s[n]).forEach(function(P){var W="";if(s[n][P].Type==_t.CMNT){W=Xu(s[n][P].Target,e);var B=DM(zr(t,W,!0),W,l);if(!B||!B.length)return;h2(m,B,!1)}s[n][P].Type==_t.TCMNT&&(W=Xu(s[n][P].Target,e),_=_.concat(g6(zr(t,W,!0),l)))}),_&&_.length&&h2(m,_,!0,l.people||[])}catch(P){if(l.WTF)throw P}}function Qi(t){return t.charAt(0)=="/"?t.slice(1):t}function sB(t,e){if(uu(),e=e||{},nv(e),ts(t,"META-INF/manifest.xml")||ts(t,"objectdata.xml"))return S2(t,e);if(ts(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Pg<"u"){if(t.FileIndex)return Pg(t);var r=tt.utils.cfb_new();return P_(t).forEach(function(Ue){vt(r,Ue,mR(t,Ue))}),Pg(r)}throw new Error("Unsupported NUMBERS file")}if(!ts(t,"[Content_Types].xml"))throw ts(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):ts(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=P_(t),i=cN(Li(t,"[Content_Types].xml")),s=!1,a,o;if(i.workbooks.length===0&&(o="xl/workbook.xml",zr(t,o,!0)&&i.workbooks.push(o)),i.workbooks.length===0){if(o="xl/workbook.bin",!zr(t,o,!0))throw new Error("Could not find workbook");i.workbooks.push(o),s=!0}i.workbooks[0].slice(-3)=="bin"&&(s=!0);var l={},c={};if(!e.bookSheets&&!e.bookProps){if(hf=[],i.sst)try{hf=NM(zr(t,Qi(i.sst)),i.sst,e)}catch(Ue){if(e.WTF)throw Ue}e.cellStyles&&i.themes.length&&(l=RM(Li(t,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],e)),i.style&&(c=bM(zr(t,Qi(i.style)),i.style,l,e))}i.links.map(function(Ue){try{var me=df(Li(t,$f(Qi(Ue))),Ue);return OM(zr(t,Qi(Ue)),me,Ue,e)}catch{}});var d=AM(zr(t,Qi(i.workbooks[0])),i.workbooks[0],e),h={},p="";i.coreprops.length&&(p=zr(t,Qi(i.coreprops[0]),!0),p&&(h=eA(p)),i.extprops.length!==0&&(p=zr(t,Qi(i.extprops[0]),!0),p&&mN(p,h,e)));var m={};(!e.bookSheets||e.bookProps)&&i.custprops.length!==0&&(p=Li(t,Qi(i.custprops[0]),!0),p&&(m=vN(p,e)));var y={};if((e.bookSheets||e.bookProps)&&(d.Sheets?a=d.Sheets.map(function(me){return me.name}):h.Worksheets&&h.SheetNames.length>0&&(a=h.SheetNames),e.bookProps&&(y.Props=h,y.Custprops=m),e.bookSheets&&typeof a<"u"&&(y.SheetNames=a),e.bookSheets?y.SheetNames:e.bookProps))return y;a={};var x={};e.bookDeps&&i.calcchain&&(x=PM(zr(t,Qi(i.calcchain)),i.calcchain));var E=0,T={},A,_;{var P=d.Sheets;h.Worksheets=P.length,h.SheetNames=[];for(var W=0;W!=P.length;++W)h.SheetNames[W]=P[W].name}var B=s?"bin":"xml",w=i.workbooks[0].lastIndexOf("/"),F=(i.workbooks[0].slice(0,w+1)+"_rels/"+i.workbooks[0].slice(w+1)+".rels").replace(/^\//,"");ts(t,F)||(F="xl/_rels/workbook."+B+".rels");var S=df(Li(t,F,!0),F.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(e.xlmeta=MM(zr(t,Qi(i.metadata[0])),i.metadata[0],e)),(i.people||[]).length>=1&&(e.people=x6(zr(t,Qi(i.people[0])),e)),S&&(S=nB(S,d.Sheets));var b=zr(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(E=0;E!=h.Worksheets;++E){var N="sheet";if(S&&S[E]?(A="xl/"+S[E][1].replace(/[\/]?xl\//,""),ts(t,A)||(A=S[E][1]),ts(t,A)||(A=F.replace(/_rels\/.*$/,"")+S[E][1]),N=S[E][2]):(A="xl/worksheets/sheet"+(E+1-b)+"."+B,A=A.replace(/sheet0\./,"sheet.")),_=A.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(E!=e.sheets)continue e;break;case"string":if(h.SheetNames[E].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var D=!1,R=0;R!=e.sheets.length;++R)typeof e.sheets[R]=="number"&&e.sheets[R]==E&&(D=1),typeof e.sheets[R]=="string"&&e.sheets[R].toLowerCase()==h.SheetNames[E].toLowerCase()&&(D=1);if(!D)continue e}}iB(t,A,_,h.SheetNames[E],E,T,a,N,e,d,l,c)}return y={Directory:i,Workbook:d,Props:h,Custprops:m,Deps:x,Sheets:a,SheetNames:h.SheetNames,Strings:hf,Styles:c,Themes:l,SSF:fr(at)},e&&e.bookFiles&&(t.files?(y.keys=n,y.files=t.files):(y.keys=[],y.files={},t.FullPaths.forEach(function(Ue,me){Ue=Ue.replace(/^Root Entry[\/]/,""),y.keys.push(Ue),y.files[Ue]=t.FileIndex[me]}))),e&&e.bookVBA&&(i.vba.length>0?y.vbaraw=zr(t,Qi(i.vba[0]),!0):i.defaults&&i.defaults.bin===A6&&(y.vbaraw=zr(t,"xl/vbaProject.bin",!0))),y}function aB(t,e){var r=e||{},n="Workbook",i=tt.find(t,n);try{if(n="/!DataSpaces/Version",i=tt.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(MD(i.content),n="/!DataSpaces/DataSpaceMap",i=tt.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=BD(i.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=tt.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=jD(i.content);if(a.length!=1||a[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=tt.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);UD(i.content)}catch{}if(n="/EncryptionInfo",i=tt.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=zD(i.content);if(n="/EncryptedPackage",i=tt.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],i.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function oB(t,e){return e.bookType=="ods"?fk(t,e):e.bookType=="numbers"?tB(t,e):e.bookType=="xlsb"?lB(t,e):cB(t,e)}function lB(t,e){Sc=1024,t&&!t.SSF&&(t.SSF=fr(at)),t&&t.SSF&&(uu(),Ap(t.SSF),e.revssf=Cp(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,pf?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",n=jA.indexOf(e.bookType)>-1,i=W1();iv(e=e||{});var s=I1(),a="",o=0;if(e.cellXfs=[],$o(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),a="docProps/core.xml",vt(s,a,tA(t.Props,e)),i.coreprops.push(a),$t(e.rels,2,a,_t.CORE_PROPS),a="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],c=0;c<t.SheetNames.length;++c)(t.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(t.SheetNames[c]);t.Props.SheetNames=l}for(t.Props.Worksheets=t.Props.SheetNames.length,vt(s,a,iA(t.Props)),i.extprops.push(a),$t(e.rels,3,a,_t.EXT_PROPS),t.Custprops!==t.Props&&Dr(t.Custprops||{}).length>0&&(a="docProps/custom.xml",vt(s,a,sA(t.Custprops)),i.custprops.push(a),$t(e.rels,4,a,_t.CUST_PROPS)),o=1;o<=t.SheetNames.length;++o){var d={"!id":{}},h=t.Sheets[t.SheetNames[o-1]],p=(h||{})["!type"]||"sheet";switch(p){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,vt(s,a,BM(o-1,a,e,t,d)),i.sheets.push(a),$t(e.wbrels,-1,"worksheets/sheet"+o+"."+r,_t.WS[0])}if(h){var m=h["!comments"],y=!1,x="";m&&m.length>0&&(x="xl/comments"+o+"."+r,vt(s,x,UM(m,x)),i.comments.push(x),$t(d,-1,"../comments"+o+"."+r,_t.CMNT),y=!0),h["!legacy"]&&y&&vt(s,"xl/drawings/vmlDrawing"+o+".vml",LA(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}d["!id"].rId1&&vt(s,$f(a),Pc(d))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+r,vt(s,a,VM(e.Strings,a,e)),i.strs.push(a),$t(e.wbrels,-1,"sharedStrings."+r,_t.SST)),a="xl/workbook."+r,vt(s,a,LM(t,a)),i.workbooks.push(a),$t(e.rels,1,a,_t.WB),a="xl/theme/theme1.xml",vt(s,a,Y1(t.Themes,e)),i.themes.push(a),$t(e.wbrels,-1,"theme/theme1.xml",_t.THEME),a="xl/styles."+r,vt(s,a,jM(t,a,e)),i.styles.push(a),$t(e.wbrels,-1,"styles."+r,_t.STY),t.vbaraw&&n&&(a="xl/vbaProject.bin",vt(s,a,t.vbaraw),i.vba.push(a),$t(e.wbrels,-1,"vbaProject.bin",_t.VBA)),a="xl/metadata."+r,vt(s,a,zM(a)),i.metadata.push(a),$t(e.wbrels,-1,"metadata."+r,_t.XLMETA),vt(s,"[Content_Types].xml",JS(i,e)),vt(s,"_rels/.rels",Pc(e.rels)),vt(s,"xl/_rels/workbook."+r+".rels",Pc(e.wbrels)),delete e.revssf,delete e.ssf,s}function cB(t,e){Sc=1024,t&&!t.SSF&&(t.SSF=fr(at)),t&&t.SSF&&(uu(),Ap(t.SSF),e.revssf=Cp(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,pf?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",n=jA.indexOf(e.bookType)>-1,i=W1();iv(e=e||{});var s=I1(),a="",o=0;if(e.cellXfs=[],$o(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),a="docProps/core.xml",vt(s,a,tA(t.Props,e)),i.coreprops.push(a),$t(e.rels,2,a,_t.CORE_PROPS),a="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],c=0;c<t.SheetNames.length;++c)(t.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(t.SheetNames[c]);t.Props.SheetNames=l}t.Props.Worksheets=t.Props.SheetNames.length,vt(s,a,iA(t.Props)),i.extprops.push(a),$t(e.rels,3,a,_t.EXT_PROPS),t.Custprops!==t.Props&&Dr(t.Custprops||{}).length>0&&(a="docProps/custom.xml",vt(s,a,sA(t.Custprops)),i.custprops.push(a),$t(e.rels,4,a,_t.CUST_PROPS));var d=["SheetJ5"];for(e.tcid=0,o=1;o<=t.SheetNames.length;++o){var h={"!id":{}},p=t.Sheets[t.SheetNames[o-1]],m=(p||{})["!type"]||"sheet";switch(m){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,vt(s,a,qA(o-1,e,t,h)),i.sheets.push(a),$t(e.wbrels,-1,"worksheets/sheet"+o+"."+r,_t.WS[0])}if(p){var y=p["!comments"],x=!1,E="";if(y&&y.length>0){var T=!1;y.forEach(function(A){A[1].forEach(function(_){_.T==!0&&(T=!0)})}),T&&(E="xl/threadedComments/threadedComment"+o+"."+r,vt(s,E,m6(y,d,e)),i.threadedcomments.push(E),$t(h,-1,"../threadedComments/threadedComment"+o+"."+r,_t.TCMNT)),E="xl/comments"+o+"."+r,vt(s,E,BA(y)),i.comments.push(E),$t(h,-1,"../comments"+o+"."+r,_t.CMNT),x=!0}p["!legacy"]&&x&&vt(s,"xl/drawings/vmlDrawing"+o+".vml",LA(o,p["!comments"])),delete p["!comments"],delete p["!legacy"]}h["!id"].rId1&&vt(s,$f(a),Pc(h))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+r,vt(s,a,AA(e.Strings,e)),i.strs.push(a),$t(e.wbrels,-1,"sharedStrings."+r,_t.SST)),a="xl/workbook."+r,vt(s,a,tk(t)),i.workbooks.push(a),$t(e.rels,1,a,_t.WB),a="xl/theme/theme1.xml",vt(s,a,Y1(t.Themes,e)),i.themes.push(a),$t(e.wbrels,-1,"theme/theme1.xml",_t.THEME),a="xl/styles."+r,vt(s,a,DA(t,e)),i.styles.push(a),$t(e.wbrels,-1,"styles."+r,_t.STY),t.vbaraw&&n&&(a="xl/vbaProject.bin",vt(s,a,t.vbaraw),i.vba.push(a),$t(e.wbrels,-1,"vbaProject.bin",_t.VBA)),a="xl/metadata."+r,vt(s,a,MA()),i.metadata.push(a),$t(e.wbrels,-1,"metadata."+r,_t.XLMETA),d.length>1&&(a="xl/persons/person.xml",vt(s,a,v6(d)),i.people.push(a),$t(e.wbrels,-1,"persons/person.xml",_t.PEOPLE)),vt(s,"[Content_Types].xml",JS(i,e)),vt(s,"_rels/.rels",Pc(e.rels)),vt(s,"xl/_rels/workbook."+r+".rels",Pc(e.wbrels)),delete e.revssf,delete e.ssf,s}function sv(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=zi(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function uB(t,e){return tt.find(t,"EncryptedPackage")?aB(t,e):sk(t,e)}function fB(t,e){var r,n=t,i=e||{};return i.type||(i.type=yt&&Buffer.isBuffer(t)?"buffer":"base64"),r=CS(n,i),sB(r,i)}function hk(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return rx(t.slice(r),e);default:break e}return Yc.to_workbook(t,e)}function dB(t,e){var r="",n=sv(t,e);switch(e.type){case"base64":r=zi(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=Sl(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Qt(r)),e.type="binary",hk(r,e)}function hB(t,e){var r=t;return e.type=="base64"&&(r=zi(r)),r=jf.utils.decode(1200,r.slice(2),"str"),e.type="binary",hk(r,e)}function pB(t){return t.match(/[^\x00-\x7F]/)?Ys(t):t}function Og(t,e,r,n){return n?(r.type="string",Yc.to_workbook(t,r)):Yc.to_workbook(e,r)}function Ac(t,e){S1();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return Ac(new Uint8Array(t),(r=fr(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,i=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Mc={},r.dateNF&&(Mc.dateNF=r.dateNF),r.type||(r.type=yt&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=yt?"buffer":"binary",n=lR(t),typeof Uint8Array<"u"&&!yt&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=pB(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var a=new ArrayBuffer(3),o=new Uint8Array(a);if(o.foo="bar",!o.foo)return r=fr(r),r.type="array",Ac(A1(n),r)}switch((i=sv(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return uB(tt.read(n,r),r);break;case 9:if(i[1]<=8)return sk(n,r);break;case 60:return rx(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return yD(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return TA.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?fB(n,r):Og(t,n,r,s);case 239:return i[3]===60?rx(n,r):Og(t,n,r,s);case 255:if(i[1]===254)return hB(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return pl.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return pl.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return tx.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return bA.to_workbook(n,r);break;case 10:case 13:case 32:return dB(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return vD.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?tx.to_workbook(n,r):Og(t,n,r,s)}function pk(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return p0(e.file,tt.write(t,{type:yt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return tt.write(t,e)}function gB(t,e){var r=fr(e||{}),n=oB(t,r);return mB(n,r)}function mB(t,e){var r={},n=yt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=n;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var i=t.FullPaths?tt.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(e.type=="binary"||e.type=="base64")return i;i=new Uint8Array(Sp(i))}return e.password&&typeof encrypt_agile<"u"?pk(encrypt_agile(i,e.password),e):e.type==="file"?p0(e.file,i):e.type=="string"?Qt(i):i}function xB(t,e){var r=e||{},n=pL(t,r);return pk(n,r)}function Gs(t,e,r){r||(r="");var n=r+t;switch(e.type){case"base64":return Vf(Ys(n));case"binary":return Ys(n);case"string":return t;case"file":return p0(e.file,n,"utf8");case"buffer":return yt?Va(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Gs(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function vB(t,e){switch(e.type){case"base64":return Vf(t);case"binary":return t;case"string":return t;case"file":return p0(e.file,t,"binary");case"buffer":return yt?Va(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function Id(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",n=0;n<t.length;++n)r+=String.fromCharCode(t[n]);return e.type=="base64"?Vf(r):e.type=="string"?Qt(r):r;case"file":return p0(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function gk(t,e){S1(),uM(t);var r=fr(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=gk(t,r);return r.type="array",Sp(n)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=t.SheetNames.indexOf(r.sheet),!t.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Gs(oL(t,r),r);case"slk":case"sylk":return Gs(wA.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"htm":case"html":return Gs(ok(t.Sheets[t.SheetNames[i]],r),r);case"txt":return vB(mk(t.Sheets[t.SheetNames[i]],r),r);case"csv":return Gs(av(t.Sheets[t.SheetNames[i]],r),r,"\uFEFF");case"dif":return Gs(TA.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"dbf":return Id(tx.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"prn":return Gs(Yc.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"rtf":return Gs(bA.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"eth":return Gs(SA.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"fods":return Gs(fk(t,r),r);case"wk1":return Id(pl.sheet_to_wk1(t.Sheets[t.SheetNames[i]],r),r);case"wk3":return Id(pl.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Id(ak(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),xB(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return gB(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function yB(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(t.bookType=r.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function Mg(t,e,r){var n={};return n.type="file",n.file=e,yB(n),gk(t,n)}function _B(t,e,r,n,i,s,a,o){var l=Lr(r),c=o.defval,d=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),h=!0,p=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(p,"__rowNum__",{value:r,enumerable:!1})}catch{p.__rowNum__=r}else p.__rowNum__=r;if(!a||t[r])for(var m=e.s.c;m<=e.e.c;++m){var y=a?t[r][m]:t[n[m]+l];if(y===void 0||y.t===void 0){if(c===void 0)continue;s[m]!=null&&(p[s[m]]=c);continue}var x=y.v;switch(y.t){case"z":if(x==null)break;continue;case"e":x=x==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+y.t)}if(s[m]!=null){if(x==null)if(y.t=="e"&&x===null)p[s[m]]=null;else if(c!==void 0)p[s[m]]=c;else if(d&&x===null)p[s[m]]=null;else continue;else p[s[m]]=d&&(y.t!=="n"||y.t==="n"&&o.rawNumbers!==!1)?x:Da(y,x,o);x!=null&&(h=!1)}}return{row:p,isempty:h}}function Hh(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,s=[],a=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=e||{},d=c.range!=null?c.range:t["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof d){case"string":l=Pt(d);break;case"number":l=Pt(t["!ref"]),l.s.r=d;break;default:l=d}n>0&&(i=0);var h=Lr(l.s.r),p=[],m=[],y=0,x=0,E=Array.isArray(t),T=l.s.r,A=0,_={};E&&!t[T]&&(t[T]=[]);var P=c.skipHidden&&t["!cols"]||[],W=c.skipHidden&&t["!rows"]||[];for(A=l.s.c;A<=l.e.c;++A)if(!(P[A]||{}).hidden)switch(p[A]=Tr(A),r=E?t[T][A]:t[p[A]+h],n){case 1:s[A]=A-l.s.c;break;case 2:s[A]=p[A];break;case 3:s[A]=c.header[A-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=a=Da(r,null,c),x=_[a]||0,!x)_[a]=1;else{do o=a+"_"+x++;while(_[o]);_[a]=x,_[o]=1}s[A]=o}for(T=l.s.r+i;T<=l.e.r;++T)if(!(W[T]||{}).hidden){var B=_B(t,l,T,p,n,s,E,c);(B.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(m[y++]=B.row)}return m.length=y,m}var I2=/"/g;function EB(t,e,r,n,i,s,a,o){for(var l=!0,c=[],d="",h=Lr(r),p=e.s.c;p<=e.e.c;++p)if(n[p]){var m=o.dense?(t[r]||[])[p]:t[n[p]+h];if(m==null)d="";else if(m.v!=null){l=!1,d=""+(o.rawNumbers&&m.t=="n"?m.v:Da(m,null,o));for(var y=0,x=0;y!==d.length;++y)if((x=d.charCodeAt(y))===i||x===s||x===34||o.forceQuotes){d='"'+d.replace(I2,'""')+'"';break}d=="ID"&&(d='"ID"')}else m.f!=null&&!m.F?(l=!1,d="="+m.f,d.indexOf(",")>=0&&(d='"'+d.replace(I2,'""')+'"')):d="";c.push(d)}return o.blankrows===!1&&l?null:c.join(a)}function av(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var i=Pt(t["!ref"]),s=n.FS!==void 0?n.FS:",",a=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),c=new RegExp((s=="|"?"\\|":s)+"+$"),d="",h=[];n.dense=Array.isArray(t);for(var p=n.skipHidden&&t["!cols"]||[],m=n.skipHidden&&t["!rows"]||[],y=i.s.c;y<=i.e.c;++y)(p[y]||{}).hidden||(h[y]=Tr(y));for(var x=0,E=i.s.r;E<=i.e.r;++E)(m[E]||{}).hidden||(d=EB(t,i,E,h,a,l,s,n),d!=null&&(n.strip&&(d=d.replace(c,"")),(d||n.blankrows!==!1)&&r.push((x++?o:"")+d)));return delete n.dense,r.join("")}function mk(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=av(t,e);return r}function wB(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var i=Pt(t["!ref"]),s="",a=[],o,l=[],c=Array.isArray(t);for(o=i.s.c;o<=i.e.c;++o)a[o]=Tr(o);for(var d=i.s.r;d<=i.e.r;++d)for(s=Lr(d),o=i.s.c;o<=i.e.c;++o)if(e=a[o]+s,r=c?(t[d]||[])[o]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=e+"="+n}return l}function xk(t,e,r){var n=r||{},i=+!n.skipHeader,s=t||{},a=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?Sr(n.origin):n.origin;a=l.r,o=l.c}var c,d={s:{c:0,r:0},e:{c:o,r:a+e.length-1+i}};if(s["!ref"]){var h=Pt(s["!ref"]);d.e.c=Math.max(d.e.c,h.e.c),d.e.r=Math.max(d.e.r,h.e.r),a==-1&&(a=h.e.r+1,d.e.r=a+e.length-1+i)}else a==-1&&(a=0,d.e.r=e.length-1+i);var p=n.header||[],m=0;e.forEach(function(x,E){Dr(x).forEach(function(T){(m=p.indexOf(T))==-1&&(p[m=p.length]=T);var A=x[T],_="z",P="",W=ot({c:o+m,r:a+E+i});c=Jf(s,W),A&&typeof A=="object"&&!(A instanceof Date)?s[W]=A:(typeof A=="number"?_="n":typeof A=="boolean"?_="b":typeof A=="string"?_="s":A instanceof Date?(_="d",n.cellDates||(_="n",A=tn(A)),P=n.dateNF||at[14]):A===null&&n.nullError&&(_="e",A=0),c?(c.t=_,c.v=A,delete c.w,delete c.R,P&&(c.z=P)):s[W]=c={t:_,v:A},P&&(c.z=P))})}),d.e.c=Math.max(d.e.c,o+p.length-1);var y=Lr(a);if(i)for(m=0;m<p.length;++m)s[Tr(m+o)+y]={t:"s",v:p[m]};return s["!ref"]=xt(d),s}function TB(t,e){return xk(null,t,e)}function Jf(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=Sr(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?Jf(t,ot(e)):Jf(t,ot({r:e,c:r||0}))}function SB(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function ov(){return{SheetNames:[],Sheets:{}}}function lv(t,e,r,n){var i=1;if(!r)for(;i<=65535&&t.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var a=s&&s[1]||r;for(++i;i<=65535&&t.SheetNames.indexOf(r=a+i)!=-1;++i);}if(ek(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function AB(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=SB(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function kB(t,e){return t.z=e,t}function vk(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function CB(t,e,r){return vk(t,"#"+e,r)}function FB(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function IB(t,e,r,n){for(var i=typeof e!="string"?e:Pt(e),s=typeof e=="string"?e:xt(e),a=i.s.r;a<=i.e.r;++a)for(var o=i.s.c;o<=i.e.c;++o){var l=Jf(t,a,o);l.t="n",l.F=s,delete l.v,a==i.s.r&&o==i.s.c&&(l.f=r,n&&(l.D=!0))}return t}var Ni={encode_col:Tr,encode_row:Lr,encode_cell:ot,encode_range:xt,decode_col:L1,decode_row:M1,split_cell:VR,decode_cell:Sr,decode_range:Ai,format_cell:Da,sheet_add_aoa:$S,sheet_add_json:xk,sheet_add_dom:lk,aoa_to_sheet:fu,json_to_sheet:TB,table_to_sheet:ck,table_to_book:ML,sheet_to_csv:av,sheet_to_txt:mk,sheet_to_json:Hh,sheet_to_html:ok,sheet_to_formulae:wB,sheet_to_row_object_array:Hh,sheet_get_cell:Jf,book_new:ov,book_append_sheet:lv,book_set_sheet_visibility:AB,cell_set_number_format:kB,cell_set_hyperlink:vk,cell_set_internal_link:CB,cell_add_comment:FB,sheet_set_array_formula:IB,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var bB={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RB=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),St=(t,e)=>{const r=ye.forwardRef(({color:n="currentColor",size:i=24,strokeWidth:s=2,absoluteStrokeWidth:a,className:o="",children:l,...c},d)=>ye.createElement("svg",{ref:d,...bB,width:i,height:i,stroke:n,strokeWidth:a?Number(s)*24/Number(i):s,className:["lucide",`lucide-${RB(t)}`,o].join(" "),...c},[...e.map(([h,p])=>ye.createElement(h,p)),...Array.isArray(l)?l:[l]]));return r.displayName=`${t}`,r};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b2=St("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R2=St("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NB=St("BellRing",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}],["path",{d:"M4 2C2.8 3.7 2 5.7 2 8",key:"tap9e0"}],["path",{d:"M22 8c0-2.3-.8-4.3-2-6",key:"5bb3ad"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N2=St("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D2=St("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DB=St("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PB=St("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P2=St("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O2=St("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OB=St("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lg=St("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bg=St("Clipboard",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MB=St("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bu=St("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LB=St("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bd=St("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ju=St("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jg=St("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M2=St("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rd=St("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vg=St("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BB=St("Merge",[["path",{d:"m8 6 4-4 4 4",key:"ybng9g"}],["path",{d:"M12 2v10.3a4 4 0 0 1-1.172 2.872L4 22",key:"1hyw0i"}],["path",{d:"m20 22-5-5",key:"1m27yz"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jB=St("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nd=St("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L2=St("PlusCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ug=St("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vu=St("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1-2-1Z",key:"wqdwcb"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17V7",key:"pyj7ub"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VB=St("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dd=St("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B2=St("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UB=St("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j2=St("Table",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zB=St("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2h0a3.13 3.13 0 0 1 3 3.88Z",key:"y3tblf"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ws=St("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hs=St("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V2=St("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rl=St("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);var U2={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yk=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=i&63|128):(i&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=i&63|128):(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=i&63|128)}return e},WB=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const i=t[r++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[r++];e[n++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[r++],a=t[r++],o=t[r++],l=((i&7)<<18|(s&63)<<12|(a&63)<<6|o&63)-65536;e[n++]=String.fromCharCode(55296+(l>>10)),e[n++]=String.fromCharCode(56320+(l&1023))}else{const s=t[r++],a=t[r++];e[n++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},_k={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<t.length;i+=3){const s=t[i],a=i+1<t.length,o=a?t[i+1]:0,l=i+2<t.length,c=l?t[i+2]:0,d=s>>2,h=(s&3)<<4|o>>4;let p=(o&15)<<2|c>>6,m=c&63;l||(m=64,a||(p=64)),n.push(r[d],r[h],r[p],r[m])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(yk(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):WB(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<t.length;){const s=r[t.charAt(i++)],o=i<t.length?r[t.charAt(i)]:0;++i;const c=i<t.length?r[t.charAt(i)]:64;++i;const h=i<t.length?r[t.charAt(i)]:64;if(++i,s==null||o==null||c==null||h==null)throw new HB;const p=s<<2|o>>4;if(n.push(p),c!==64){const m=o<<4&240|c>>2;if(n.push(m),h!==64){const y=c<<6&192|h;n.push(y)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class HB extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const $B=function(t){const e=yk(t);return _k.encodeByteArray(e,!0)},$h=function(t){return $B(t).replace(/\./g,"")},Ek=function(t){try{return _k.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GB(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KB=()=>GB().__FIREBASE_DEFAULTS__,XB=()=>{if(typeof process>"u"||typeof U2>"u")return;const t=U2.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},YB=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&Ek(t[1]);return e&&JSON.parse(e)},Dp=()=>{try{return KB()||XB()||YB()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},wk=t=>{var e,r;return(r=(e=Dp())===null||e===void 0?void 0:e.emulatorHosts)===null||r===void 0?void 0:r[t]},qB=t=>{const e=wk(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},Tk=()=>{var t;return(t=Dp())===null||t===void 0?void 0:t.config},Sk=t=>{var e;return(e=Dp())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QB{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JB(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t);return[$h(JSON.stringify(r)),$h(JSON.stringify(a)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function ZB(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Xn())}function e9(){var t;const e=(t=Dp())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function t9(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function r9(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function n9(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function i9(){const t=Xn();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function s9(){return!e9()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function a9(){try{return typeof indexedDB=="object"}catch{return!1}}function o9(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l9="FirebaseError";class Wa extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=l9,Object.setPrototypeOf(this,Wa.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,w0.prototype.create)}}class w0{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?c9(s,n):"Error",o=`${this.serviceName}: ${a} (${i}).`;return new Wa(i,o,n)}}function c9(t,e){return t.replace(u9,(r,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const u9=/\{\$([^}]+)}/g;function f9(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Gh(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const i of r){if(!n.includes(i))return!1;const s=t[i],a=e[i];if(z2(s)&&z2(a)){if(!Gh(s,a))return!1}else if(s!==a)return!1}for(const i of n)if(!r.includes(i))return!1;return!0}function z2(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T0(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function d9(t,e){const r=new h9(t,e);return r.subscribe.bind(r)}class h9{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let i;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");p9(e,["next","error","complete"])?i=e:i={next:e,error:r,complete:n},i.next===void 0&&(i.next=zg),i.error===void 0&&(i.error=zg),i.complete===void 0&&(i.complete=zg);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function p9(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function zg(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ds(t){return t&&t._delegate?t._delegate:t}class Il{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nl="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g9{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new QB;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:r});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){var r;const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(r=e==null?void 0:e.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(x9(e))try{this.getOrInitializeService({instanceIdentifier:nl})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(r);try{const s=this.getOrInitializeService({instanceIdentifier:i});n.resolve(s)}catch{}}}}clearInstance(e=nl){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=nl){return this.instances.has(e)}getOptions(e=nl){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[s,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(s);n===o&&a.resolve(i)}return i}onInit(e,r){var n;const i=this.normalizeInstanceIdentifier(r),s=(n=this.onInitCallbacks.get(i))!==null&&n!==void 0?n:new Set;s.add(e),this.onInitCallbacks.set(i,s);const a=this.instances.get(i);return a&&e(a,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const i of n)try{i(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:m9(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=nl){return this.component?this.component.multipleInstances?e:nl:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function m9(t){return t===nl?void 0:t}function x9(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v9{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new g9(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ct;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Ct||(Ct={}));const y9={debug:Ct.DEBUG,verbose:Ct.VERBOSE,info:Ct.INFO,warn:Ct.WARN,error:Ct.ERROR,silent:Ct.SILENT},_9=Ct.INFO,E9={[Ct.DEBUG]:"log",[Ct.VERBOSE]:"log",[Ct.INFO]:"info",[Ct.WARN]:"warn",[Ct.ERROR]:"error"},w9=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),i=E9[e];if(i)console[i](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class cv{constructor(e){this.name=e,this._logLevel=_9,this._logHandler=w9,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ct))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?y9[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ct.DEBUG,...e),this._logHandler(this,Ct.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ct.VERBOSE,...e),this._logHandler(this,Ct.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ct.INFO,...e),this._logHandler(this,Ct.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ct.WARN,...e),this._logHandler(this,Ct.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ct.ERROR,...e),this._logHandler(this,Ct.ERROR,...e)}}const T9=(t,e)=>e.some(r=>t instanceof r);let W2,H2;function S9(){return W2||(W2=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function A9(){return H2||(H2=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Ak=new WeakMap,sx=new WeakMap,kk=new WeakMap,Wg=new WeakMap,uv=new WeakMap;function k9(t){const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",a)},s=()=>{r(ko(t.result)),i()},a=()=>{n(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",a)});return e.then(r=>{r instanceof IDBCursor&&Ak.set(r,t)}).catch(()=>{}),uv.set(e,t),e}function C9(t){if(sx.has(t))return;const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",a),t.removeEventListener("abort",a)},s=()=>{r(),i()},a=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",a),t.addEventListener("abort",a)});sx.set(t,e)}let ax={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return sx.get(t);if(e==="objectStoreNames")return t.objectStoreNames||kk.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return ko(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function F9(t){ax=t(ax)}function I9(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(Hg(this),e,...r);return kk.set(n,e.sort?e.sort():[e]),ko(n)}:A9().includes(t)?function(...e){return t.apply(Hg(this),e),ko(Ak.get(this))}:function(...e){return ko(t.apply(Hg(this),e))}}function b9(t){return typeof t=="function"?I9(t):(t instanceof IDBTransaction&&C9(t),T9(t,S9())?new Proxy(t,ax):t)}function ko(t){if(t instanceof IDBRequest)return k9(t);if(Wg.has(t))return Wg.get(t);const e=b9(t);return e!==t&&(Wg.set(t,e),uv.set(e,t)),e}const Hg=t=>uv.get(t);function R9(t,e,{blocked:r,upgrade:n,blocking:i,terminated:s}={}){const a=indexedDB.open(t,e),o=ko(a);return n&&a.addEventListener("upgradeneeded",l=>{n(ko(a.result),l.oldVersion,l.newVersion,ko(a.transaction),l)}),r&&a.addEventListener("blocked",l=>r(l.oldVersion,l.newVersion,l)),o.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",c=>i(c.oldVersion,c.newVersion,c))}).catch(()=>{}),o}const N9=["get","getKey","getAll","getAllKeys","count"],D9=["put","add","delete","clear"],$g=new Map;function $2(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if($g.get(e))return $g.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,i=D9.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||N9.includes(r)))return;const s=async function(a,...o){const l=this.transaction(a,i?"readwrite":"readonly");let c=l.store;return n&&(c=c.index(o.shift())),(await Promise.all([c[r](...o),i&&l.done]))[0]};return $g.set(e,s),s}F9(t=>({...t,get:(e,r,n)=>$2(e,r)||t.get(e,r,n),has:(e,r)=>!!$2(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P9{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(O9(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function O9(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const ox="@firebase/app",G2="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pa=new cv("@firebase/app"),M9="@firebase/app-compat",L9="@firebase/analytics-compat",B9="@firebase/analytics",j9="@firebase/app-check-compat",V9="@firebase/app-check",U9="@firebase/auth",z9="@firebase/auth-compat",W9="@firebase/database",H9="@firebase/data-connect",$9="@firebase/database-compat",G9="@firebase/functions",K9="@firebase/functions-compat",X9="@firebase/installations",Y9="@firebase/installations-compat",q9="@firebase/messaging",Q9="@firebase/messaging-compat",J9="@firebase/performance",Z9="@firebase/performance-compat",ej="@firebase/remote-config",tj="@firebase/remote-config-compat",rj="@firebase/storage",nj="@firebase/storage-compat",ij="@firebase/firestore",sj="@firebase/vertexai-preview",aj="@firebase/firestore-compat",oj="firebase",lj="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lx="[DEFAULT]",cj={[ox]:"fire-core",[M9]:"fire-core-compat",[B9]:"fire-analytics",[L9]:"fire-analytics-compat",[V9]:"fire-app-check",[j9]:"fire-app-check-compat",[U9]:"fire-auth",[z9]:"fire-auth-compat",[W9]:"fire-rtdb",[H9]:"fire-data-connect",[$9]:"fire-rtdb-compat",[G9]:"fire-fn",[K9]:"fire-fn-compat",[X9]:"fire-iid",[Y9]:"fire-iid-compat",[q9]:"fire-fcm",[Q9]:"fire-fcm-compat",[J9]:"fire-perf",[Z9]:"fire-perf-compat",[ej]:"fire-rc",[tj]:"fire-rc-compat",[rj]:"fire-gcs",[nj]:"fire-gcs-compat",[ij]:"fire-fst",[aj]:"fire-fst-compat",[sj]:"fire-vertex","fire-js":"fire-js",[oj]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kh=new Map,uj=new Map,cx=new Map;function K2(t,e){try{t.container.addComponent(e)}catch(r){Pa.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function Qc(t){const e=t.name;if(cx.has(e))return Pa.debug(`There were multiple attempts to register component ${e}.`),!1;cx.set(e,t);for(const r of Kh.values())K2(r,t);for(const r of uj.values())K2(r,t);return!0}function fv(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function mo(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fj={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Co=new w0("app","Firebase",fj);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dj{constructor(e,r,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Il("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Co.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hu=lj;function Ck(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n=Object.assign({name:lx,automaticDataCollectionEnabled:!1},e),i=n.name;if(typeof i!="string"||!i)throw Co.create("bad-app-name",{appName:String(i)});if(r||(r=Tk()),!r)throw Co.create("no-options");const s=Kh.get(i);if(s){if(Gh(r,s.options)&&Gh(n,s.config))return s;throw Co.create("duplicate-app",{appName:i})}const a=new v9(i);for(const l of cx.values())a.addComponent(l);const o=new dj(r,n,a);return Kh.set(i,o),o}function Fk(t=lx){const e=Kh.get(t);if(!e&&t===lx&&Tk())return Ck();if(!e)throw Co.create("no-app",{appName:t});return e}function Fo(t,e,r){var n;let i=(n=cj[t])!==null&&n!==void 0?n:t;r&&(i+=`-${r}`);const s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){const o=[`Unable to register library "${i}" with version "${e}":`];s&&o.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&a&&o.push("and"),a&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Pa.warn(o.join(" "));return}Qc(new Il(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hj="firebase-heartbeat-database",pj=1,Zf="firebase-heartbeat-store";let Gg=null;function Ik(){return Gg||(Gg=R9(hj,pj,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Zf)}catch(r){console.warn(r)}}}}).catch(t=>{throw Co.create("idb-open",{originalErrorMessage:t.message})})),Gg}async function gj(t){try{const r=(await Ik()).transaction(Zf),n=await r.objectStore(Zf).get(bk(t));return await r.done,n}catch(e){if(e instanceof Wa)Pa.warn(e.message);else{const r=Co.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Pa.warn(r.message)}}}async function X2(t,e){try{const n=(await Ik()).transaction(Zf,"readwrite");await n.objectStore(Zf).put(e,bk(t)),await n.done}catch(r){if(r instanceof Wa)Pa.warn(r.message);else{const n=Co.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});Pa.warn(n.message)}}}function bk(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mj=1024,xj=30*24*60*60*1e3;class vj{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new _j(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=Y2();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(a=>a.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const o=new Date(a.date).valueOf();return Date.now()-o<=xj}),this._storage.overwrite(this._heartbeatsCache))}catch(n){Pa.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=Y2(),{heartbeatsToSend:n,unsentEntries:i}=yj(this._heartbeatsCache.heartbeats),s=$h(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(r){return Pa.warn(r),""}}}function Y2(){return new Date().toISOString().substring(0,10)}function yj(t,e=mj){const r=[];let n=t.slice();for(const i of t){const s=r.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),q2(r)>e){s.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),q2(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class _j{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return a9()?o9().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await gj(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return X2(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return X2(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function q2(t){return $h(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ej(t){Qc(new Il("platform-logger",e=>new P9(e),"PRIVATE")),Qc(new Il("heartbeat",e=>new vj(e),"PRIVATE")),Fo(ox,G2,t),Fo(ox,G2,"esm2017"),Fo("fire-js","")}Ej("");var wj="firebase",Tj="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Fo(wj,Tj,"app");var Q2=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var ml,Rk;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(w,F){function S(){}S.prototype=F.prototype,w.D=F.prototype,w.prototype=new S,w.prototype.constructor=w,w.C=function(b,N,D){for(var R=Array(arguments.length-2),Ue=2;Ue<arguments.length;Ue++)R[Ue-2]=arguments[Ue];return F.prototype[N].apply(b,R)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(w,F,S){S||(S=0);var b=Array(16);if(typeof F=="string")for(var N=0;16>N;++N)b[N]=F.charCodeAt(S++)|F.charCodeAt(S++)<<8|F.charCodeAt(S++)<<16|F.charCodeAt(S++)<<24;else for(N=0;16>N;++N)b[N]=F[S++]|F[S++]<<8|F[S++]<<16|F[S++]<<24;F=w.g[0],S=w.g[1],N=w.g[2];var D=w.g[3],R=F+(D^S&(N^D))+b[0]+3614090360&4294967295;F=S+(R<<7&4294967295|R>>>25),R=D+(N^F&(S^N))+b[1]+3905402710&4294967295,D=F+(R<<12&4294967295|R>>>20),R=N+(S^D&(F^S))+b[2]+606105819&4294967295,N=D+(R<<17&4294967295|R>>>15),R=S+(F^N&(D^F))+b[3]+3250441966&4294967295,S=N+(R<<22&4294967295|R>>>10),R=F+(D^S&(N^D))+b[4]+4118548399&4294967295,F=S+(R<<7&4294967295|R>>>25),R=D+(N^F&(S^N))+b[5]+1200080426&4294967295,D=F+(R<<12&4294967295|R>>>20),R=N+(S^D&(F^S))+b[6]+2821735955&4294967295,N=D+(R<<17&4294967295|R>>>15),R=S+(F^N&(D^F))+b[7]+4249261313&4294967295,S=N+(R<<22&4294967295|R>>>10),R=F+(D^S&(N^D))+b[8]+1770035416&4294967295,F=S+(R<<7&4294967295|R>>>25),R=D+(N^F&(S^N))+b[9]+2336552879&4294967295,D=F+(R<<12&4294967295|R>>>20),R=N+(S^D&(F^S))+b[10]+4294925233&4294967295,N=D+(R<<17&4294967295|R>>>15),R=S+(F^N&(D^F))+b[11]+2304563134&4294967295,S=N+(R<<22&4294967295|R>>>10),R=F+(D^S&(N^D))+b[12]+1804603682&4294967295,F=S+(R<<7&4294967295|R>>>25),R=D+(N^F&(S^N))+b[13]+4254626195&4294967295,D=F+(R<<12&4294967295|R>>>20),R=N+(S^D&(F^S))+b[14]+2792965006&4294967295,N=D+(R<<17&4294967295|R>>>15),R=S+(F^N&(D^F))+b[15]+1236535329&4294967295,S=N+(R<<22&4294967295|R>>>10),R=F+(N^D&(S^N))+b[1]+4129170786&4294967295,F=S+(R<<5&4294967295|R>>>27),R=D+(S^N&(F^S))+b[6]+3225465664&4294967295,D=F+(R<<9&4294967295|R>>>23),R=N+(F^S&(D^F))+b[11]+643717713&4294967295,N=D+(R<<14&4294967295|R>>>18),R=S+(D^F&(N^D))+b[0]+3921069994&4294967295,S=N+(R<<20&4294967295|R>>>12),R=F+(N^D&(S^N))+b[5]+3593408605&4294967295,F=S+(R<<5&4294967295|R>>>27),R=D+(S^N&(F^S))+b[10]+38016083&4294967295,D=F+(R<<9&4294967295|R>>>23),R=N+(F^S&(D^F))+b[15]+3634488961&4294967295,N=D+(R<<14&4294967295|R>>>18),R=S+(D^F&(N^D))+b[4]+3889429448&4294967295,S=N+(R<<20&4294967295|R>>>12),R=F+(N^D&(S^N))+b[9]+568446438&4294967295,F=S+(R<<5&4294967295|R>>>27),R=D+(S^N&(F^S))+b[14]+3275163606&4294967295,D=F+(R<<9&4294967295|R>>>23),R=N+(F^S&(D^F))+b[3]+4107603335&4294967295,N=D+(R<<14&4294967295|R>>>18),R=S+(D^F&(N^D))+b[8]+1163531501&4294967295,S=N+(R<<20&4294967295|R>>>12),R=F+(N^D&(S^N))+b[13]+2850285829&4294967295,F=S+(R<<5&4294967295|R>>>27),R=D+(S^N&(F^S))+b[2]+4243563512&4294967295,D=F+(R<<9&4294967295|R>>>23),R=N+(F^S&(D^F))+b[7]+1735328473&4294967295,N=D+(R<<14&4294967295|R>>>18),R=S+(D^F&(N^D))+b[12]+2368359562&4294967295,S=N+(R<<20&4294967295|R>>>12),R=F+(S^N^D)+b[5]+4294588738&4294967295,F=S+(R<<4&4294967295|R>>>28),R=D+(F^S^N)+b[8]+2272392833&4294967295,D=F+(R<<11&4294967295|R>>>21),R=N+(D^F^S)+b[11]+1839030562&4294967295,N=D+(R<<16&4294967295|R>>>16),R=S+(N^D^F)+b[14]+4259657740&4294967295,S=N+(R<<23&4294967295|R>>>9),R=F+(S^N^D)+b[1]+2763975236&4294967295,F=S+(R<<4&4294967295|R>>>28),R=D+(F^S^N)+b[4]+1272893353&4294967295,D=F+(R<<11&4294967295|R>>>21),R=N+(D^F^S)+b[7]+4139469664&4294967295,N=D+(R<<16&4294967295|R>>>16),R=S+(N^D^F)+b[10]+3200236656&4294967295,S=N+(R<<23&4294967295|R>>>9),R=F+(S^N^D)+b[13]+681279174&4294967295,F=S+(R<<4&4294967295|R>>>28),R=D+(F^S^N)+b[0]+3936430074&4294967295,D=F+(R<<11&4294967295|R>>>21),R=N+(D^F^S)+b[3]+3572445317&4294967295,N=D+(R<<16&4294967295|R>>>16),R=S+(N^D^F)+b[6]+76029189&4294967295,S=N+(R<<23&4294967295|R>>>9),R=F+(S^N^D)+b[9]+3654602809&4294967295,F=S+(R<<4&4294967295|R>>>28),R=D+(F^S^N)+b[12]+3873151461&4294967295,D=F+(R<<11&4294967295|R>>>21),R=N+(D^F^S)+b[15]+530742520&4294967295,N=D+(R<<16&4294967295|R>>>16),R=S+(N^D^F)+b[2]+3299628645&4294967295,S=N+(R<<23&4294967295|R>>>9),R=F+(N^(S|~D))+b[0]+4096336452&4294967295,F=S+(R<<6&4294967295|R>>>26),R=D+(S^(F|~N))+b[7]+1126891415&4294967295,D=F+(R<<10&4294967295|R>>>22),R=N+(F^(D|~S))+b[14]+2878612391&4294967295,N=D+(R<<15&4294967295|R>>>17),R=S+(D^(N|~F))+b[5]+4237533241&4294967295,S=N+(R<<21&4294967295|R>>>11),R=F+(N^(S|~D))+b[12]+1700485571&4294967295,F=S+(R<<6&4294967295|R>>>26),R=D+(S^(F|~N))+b[3]+2399980690&4294967295,D=F+(R<<10&4294967295|R>>>22),R=N+(F^(D|~S))+b[10]+4293915773&4294967295,N=D+(R<<15&4294967295|R>>>17),R=S+(D^(N|~F))+b[1]+2240044497&4294967295,S=N+(R<<21&4294967295|R>>>11),R=F+(N^(S|~D))+b[8]+1873313359&4294967295,F=S+(R<<6&4294967295|R>>>26),R=D+(S^(F|~N))+b[15]+4264355552&4294967295,D=F+(R<<10&4294967295|R>>>22),R=N+(F^(D|~S))+b[6]+2734768916&4294967295,N=D+(R<<15&4294967295|R>>>17),R=S+(D^(N|~F))+b[13]+1309151649&4294967295,S=N+(R<<21&4294967295|R>>>11),R=F+(N^(S|~D))+b[4]+4149444226&4294967295,F=S+(R<<6&4294967295|R>>>26),R=D+(S^(F|~N))+b[11]+3174756917&4294967295,D=F+(R<<10&4294967295|R>>>22),R=N+(F^(D|~S))+b[2]+718787259&4294967295,N=D+(R<<15&4294967295|R>>>17),R=S+(D^(N|~F))+b[9]+3951481745&4294967295,w.g[0]=w.g[0]+F&4294967295,w.g[1]=w.g[1]+(N+(R<<21&4294967295|R>>>11))&4294967295,w.g[2]=w.g[2]+N&4294967295,w.g[3]=w.g[3]+D&4294967295}n.prototype.u=function(w,F){F===void 0&&(F=w.length);for(var S=F-this.blockSize,b=this.B,N=this.h,D=0;D<F;){if(N==0)for(;D<=S;)i(this,w,D),D+=this.blockSize;if(typeof w=="string"){for(;D<F;)if(b[N++]=w.charCodeAt(D++),N==this.blockSize){i(this,b),N=0;break}}else for(;D<F;)if(b[N++]=w[D++],N==this.blockSize){i(this,b),N=0;break}}this.h=N,this.o+=F},n.prototype.v=function(){var w=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);w[0]=128;for(var F=1;F<w.length-8;++F)w[F]=0;var S=8*this.o;for(F=w.length-8;F<w.length;++F)w[F]=S&255,S/=256;for(this.u(w),w=Array(16),F=S=0;4>F;++F)for(var b=0;32>b;b+=8)w[S++]=this.g[F]>>>b&255;return w};function s(w,F){var S=o;return Object.prototype.hasOwnProperty.call(S,w)?S[w]:S[w]=F(w)}function a(w,F){this.h=F;for(var S=[],b=!0,N=w.length-1;0<=N;N--){var D=w[N]|0;b&&D==F||(S[N]=D,b=!1)}this.g=S}var o={};function l(w){return-128<=w&&128>w?s(w,function(F){return new a([F|0],0>F?-1:0)}):new a([w|0],0>w?-1:0)}function c(w){if(isNaN(w)||!isFinite(w))return h;if(0>w)return E(c(-w));for(var F=[],S=1,b=0;w>=S;b++)F[b]=w/S|0,S*=4294967296;return new a(F,0)}function d(w,F){if(w.length==0)throw Error("number format error: empty string");if(F=F||10,2>F||36<F)throw Error("radix out of range: "+F);if(w.charAt(0)=="-")return E(d(w.substring(1),F));if(0<=w.indexOf("-"))throw Error('number format error: interior "-" character');for(var S=c(Math.pow(F,8)),b=h,N=0;N<w.length;N+=8){var D=Math.min(8,w.length-N),R=parseInt(w.substring(N,N+D),F);8>D?(D=c(Math.pow(F,D)),b=b.j(D).add(c(R))):(b=b.j(S),b=b.add(c(R)))}return b}var h=l(0),p=l(1),m=l(16777216);t=a.prototype,t.m=function(){if(x(this))return-E(this).m();for(var w=0,F=1,S=0;S<this.g.length;S++){var b=this.i(S);w+=(0<=b?b:4294967296+b)*F,F*=4294967296}return w},t.toString=function(w){if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(y(this))return"0";if(x(this))return"-"+E(this).toString(w);for(var F=c(Math.pow(w,6)),S=this,b="";;){var N=P(S,F).g;S=T(S,N.j(F));var D=((0<S.g.length?S.g[0]:S.h)>>>0).toString(w);if(S=N,y(S))return D+b;for(;6>D.length;)D="0"+D;b=D+b}},t.i=function(w){return 0>w?0:w<this.g.length?this.g[w]:this.h};function y(w){if(w.h!=0)return!1;for(var F=0;F<w.g.length;F++)if(w.g[F]!=0)return!1;return!0}function x(w){return w.h==-1}t.l=function(w){return w=T(this,w),x(w)?-1:y(w)?0:1};function E(w){for(var F=w.g.length,S=[],b=0;b<F;b++)S[b]=~w.g[b];return new a(S,~w.h).add(p)}t.abs=function(){return x(this)?E(this):this},t.add=function(w){for(var F=Math.max(this.g.length,w.g.length),S=[],b=0,N=0;N<=F;N++){var D=b+(this.i(N)&65535)+(w.i(N)&65535),R=(D>>>16)+(this.i(N)>>>16)+(w.i(N)>>>16);b=R>>>16,D&=65535,R&=65535,S[N]=R<<16|D}return new a(S,S[S.length-1]&-2147483648?-1:0)};function T(w,F){return w.add(E(F))}t.j=function(w){if(y(this)||y(w))return h;if(x(this))return x(w)?E(this).j(E(w)):E(E(this).j(w));if(x(w))return E(this.j(E(w)));if(0>this.l(m)&&0>w.l(m))return c(this.m()*w.m());for(var F=this.g.length+w.g.length,S=[],b=0;b<2*F;b++)S[b]=0;for(b=0;b<this.g.length;b++)for(var N=0;N<w.g.length;N++){var D=this.i(b)>>>16,R=this.i(b)&65535,Ue=w.i(N)>>>16,me=w.i(N)&65535;S[2*b+2*N]+=R*me,A(S,2*b+2*N),S[2*b+2*N+1]+=D*me,A(S,2*b+2*N+1),S[2*b+2*N+1]+=R*Ue,A(S,2*b+2*N+1),S[2*b+2*N+2]+=D*Ue,A(S,2*b+2*N+2)}for(b=0;b<F;b++)S[b]=S[2*b+1]<<16|S[2*b];for(b=F;b<2*F;b++)S[b]=0;return new a(S,0)};function A(w,F){for(;(w[F]&65535)!=w[F];)w[F+1]+=w[F]>>>16,w[F]&=65535,F++}function _(w,F){this.g=w,this.h=F}function P(w,F){if(y(F))throw Error("division by zero");if(y(w))return new _(h,h);if(x(w))return F=P(E(w),F),new _(E(F.g),E(F.h));if(x(F))return F=P(w,E(F)),new _(E(F.g),F.h);if(30<w.g.length){if(x(w)||x(F))throw Error("slowDivide_ only works with positive integers.");for(var S=p,b=F;0>=b.l(w);)S=W(S),b=W(b);var N=B(S,1),D=B(b,1);for(b=B(b,2),S=B(S,2);!y(b);){var R=D.add(b);0>=R.l(w)&&(N=N.add(S),D=R),b=B(b,1),S=B(S,1)}return F=T(w,N.j(F)),new _(N,F)}for(N=h;0<=w.l(F);){for(S=Math.max(1,Math.floor(w.m()/F.m())),b=Math.ceil(Math.log(S)/Math.LN2),b=48>=b?1:Math.pow(2,b-48),D=c(S),R=D.j(F);x(R)||0<R.l(w);)S-=b,D=c(S),R=D.j(F);y(D)&&(D=p),N=N.add(D),w=T(w,R)}return new _(N,w)}t.A=function(w){return P(this,w).h},t.and=function(w){for(var F=Math.max(this.g.length,w.g.length),S=[],b=0;b<F;b++)S[b]=this.i(b)&w.i(b);return new a(S,this.h&w.h)},t.or=function(w){for(var F=Math.max(this.g.length,w.g.length),S=[],b=0;b<F;b++)S[b]=this.i(b)|w.i(b);return new a(S,this.h|w.h)},t.xor=function(w){for(var F=Math.max(this.g.length,w.g.length),S=[],b=0;b<F;b++)S[b]=this.i(b)^w.i(b);return new a(S,this.h^w.h)};function W(w){for(var F=w.g.length+1,S=[],b=0;b<F;b++)S[b]=w.i(b)<<1|w.i(b-1)>>>31;return new a(S,w.h)}function B(w,F){var S=F>>5;F%=32;for(var b=w.g.length-S,N=[],D=0;D<b;D++)N[D]=0<F?w.i(D+S)>>>F|w.i(D+S+1)<<32-F:w.i(D+S);return new a(N,w.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,Rk=n,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=c,a.fromString=d,ml=a}).apply(typeof Q2<"u"?Q2:typeof self<"u"?self:typeof window<"u"?window:{});var Pd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Nk,Yu,Dk,Zd,ux,Pk,Ok,Mk;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(u,v,k){return u==Array.prototype||u==Object.prototype||(u[v]=k.value),u};function r(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof Pd=="object"&&Pd];for(var v=0;v<u.length;++v){var k=u[v];if(k&&k.Math==Math)return k}throw Error("Cannot find global object")}var n=r(this);function i(u,v){if(v)e:{var k=n;u=u.split(".");for(var O=0;O<u.length-1;O++){var ne=u[O];if(!(ne in k))break e;k=k[ne]}u=u[u.length-1],O=k[u],v=v(O),v!=O&&v!=null&&e(k,u,{configurable:!0,writable:!0,value:v})}}function s(u,v){u instanceof String&&(u+="");var k=0,O=!1,ne={next:function(){if(!O&&k<u.length){var he=k++;return{value:v(he,u[he]),done:!1}}return O=!0,{done:!0,value:void 0}}};return ne[Symbol.iterator]=function(){return ne},ne}i("Array.prototype.values",function(u){return u||function(){return s(this,function(v,k){return k})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},o=this||self;function l(u){var v=typeof u;return v=v!="object"?v:u?Array.isArray(u)?"array":v:"null",v=="array"||v=="object"&&typeof u.length=="number"}function c(u){var v=typeof u;return v=="object"&&u!=null||v=="function"}function d(u,v,k){return u.call.apply(u.bind,arguments)}function h(u,v,k){if(!u)throw Error();if(2<arguments.length){var O=Array.prototype.slice.call(arguments,2);return function(){var ne=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(ne,O),u.apply(v,ne)}}return function(){return u.apply(v,arguments)}}function p(u,v,k){return p=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:h,p.apply(null,arguments)}function m(u,v){var k=Array.prototype.slice.call(arguments,1);return function(){var O=k.slice();return O.push.apply(O,arguments),u.apply(this,O)}}function y(u,v){function k(){}k.prototype=v.prototype,u.aa=v.prototype,u.prototype=new k,u.prototype.constructor=u,u.Qb=function(O,ne,he){for(var Ve=Array(arguments.length-2),zt=2;zt<arguments.length;zt++)Ve[zt-2]=arguments[zt];return v.prototype[ne].apply(O,Ve)}}function x(u){const v=u.length;if(0<v){const k=Array(v);for(let O=0;O<v;O++)k[O]=u[O];return k}return[]}function E(u,v){for(let k=1;k<arguments.length;k++){const O=arguments[k];if(l(O)){const ne=u.length||0,he=O.length||0;u.length=ne+he;for(let Ve=0;Ve<he;Ve++)u[ne+Ve]=O[Ve]}else u.push(O)}}class T{constructor(v,k){this.i=v,this.j=k,this.h=0,this.g=null}get(){let v;return 0<this.h?(this.h--,v=this.g,this.g=v.next,v.next=null):v=this.i(),v}}function A(u){return/^[\s\xa0]*$/.test(u)}function _(){var u=o.navigator;return u&&(u=u.userAgent)?u:""}function P(u){return P[" "](u),u}P[" "]=function(){};var W=_().indexOf("Gecko")!=-1&&!(_().toLowerCase().indexOf("webkit")!=-1&&_().indexOf("Edge")==-1)&&!(_().indexOf("Trident")!=-1||_().indexOf("MSIE")!=-1)&&_().indexOf("Edge")==-1;function B(u,v,k){for(const O in u)v.call(k,u[O],O,u)}function w(u,v){for(const k in u)v.call(void 0,u[k],k,u)}function F(u){const v={};for(const k in u)v[k]=u[k];return v}const S="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function b(u,v){let k,O;for(let ne=1;ne<arguments.length;ne++){O=arguments[ne];for(k in O)u[k]=O[k];for(let he=0;he<S.length;he++)k=S[he],Object.prototype.hasOwnProperty.call(O,k)&&(u[k]=O[k])}}function N(u){var v=1;u=u.split(":");const k=[];for(;0<v&&u.length;)k.push(u.shift()),v--;return u.length&&k.push(u.join(":")),k}function D(u){o.setTimeout(()=>{throw u},0)}function R(){var u=Q;let v=null;return u.g&&(v=u.g,u.g=u.g.next,u.g||(u.h=null),v.next=null),v}class Ue{constructor(){this.h=this.g=null}add(v,k){const O=me.get();O.set(v,k),this.h?this.h.next=O:this.g=O,this.h=O}}var me=new T(()=>new Ie,u=>u.reset());class Ie{constructor(){this.next=this.g=this.h=null}set(v,k){this.h=v,this.g=k,this.next=null}reset(){this.next=this.g=this.h=null}}let Te,_e=!1,Q=new Ue,ke=()=>{const u=o.Promise.resolve(void 0);Te=()=>{u.then(Le)}};var Le=()=>{for(var u;u=R();){try{u.h.call(u.g)}catch(k){D(k)}var v=me;v.j(u),100>v.h&&(v.h++,u.next=v.g,v.g=u)}_e=!1};function j(){this.s=this.s,this.C=this.C}j.prototype.s=!1,j.prototype.ma=function(){this.s||(this.s=!0,this.N())},j.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function H(u,v){this.type=u,this.g=this.target=v,this.defaultPrevented=!1}H.prototype.h=function(){this.defaultPrevented=!0};var q=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var u=!1,v=Object.defineProperty({},"passive",{get:function(){u=!0}});try{const k=()=>{};o.addEventListener("test",k,v),o.removeEventListener("test",k,v)}catch{}return u}();function Y(u,v){if(H.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u){var k=this.type=u.type,O=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=v,v=u.relatedTarget){if(W){e:{try{P(v.nodeName);var ne=!0;break e}catch{}ne=!1}ne||(v=null)}}else k=="mouseover"?v=u.fromElement:k=="mouseout"&&(v=u.toElement);this.relatedTarget=v,O?(this.clientX=O.clientX!==void 0?O.clientX:O.pageX,this.clientY=O.clientY!==void 0?O.clientY:O.pageY,this.screenX=O.screenX||0,this.screenY=O.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=typeof u.pointerType=="string"?u.pointerType:de[u.pointerType]||"",this.state=u.state,this.i=u,u.defaultPrevented&&Y.aa.h.call(this)}}y(Y,H);var de={2:"touch",3:"pen",4:"mouse"};Y.prototype.h=function(){Y.aa.h.call(this);var u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var Se="closure_listenable_"+(1e6*Math.random()|0),Ne=0;function Ae(u,v,k,O,ne){this.listener=u,this.proxy=null,this.src=v,this.type=k,this.capture=!!O,this.ha=ne,this.key=++Ne,this.da=this.fa=!1}function we(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function it(u){this.src=u,this.g={},this.h=0}it.prototype.add=function(u,v,k,O,ne){var he=u.toString();u=this.g[he],u||(u=this.g[he]=[],this.h++);var Ve=jt(u,v,O,ne);return-1<Ve?(v=u[Ve],k||(v.fa=!1)):(v=new Ae(v,this.src,he,!!O,ne),v.fa=k,u.push(v)),v};function G(u,v){var k=v.type;if(k in u.g){var O=u.g[k],ne=Array.prototype.indexOf.call(O,v,void 0),he;(he=0<=ne)&&Array.prototype.splice.call(O,ne,1),he&&(we(v),u.g[k].length==0&&(delete u.g[k],u.h--))}}function jt(u,v,k,O){for(var ne=0;ne<u.length;++ne){var he=u[ne];if(!he.da&&he.listener==v&&he.capture==!!k&&he.ha==O)return ne}return-1}var mt="closure_lm_"+(1e6*Math.random()|0),bt={};function ht(u,v,k,O,ne){if(Array.isArray(v)){for(var he=0;he<v.length;he++)ht(u,v[he],k,O,ne);return null}return k=fi(k),u&&u[Se]?u.K(v,k,c(O)?!!O.capture:!1,ne):We(u,v,k,!1,O,ne)}function We(u,v,k,O,ne,he){if(!v)throw Error("Invalid event type");var Ve=c(ne)?!!ne.capture:!!ne,zt=ui(u);if(zt||(u[mt]=zt=new it(u)),k=zt.add(v,k,O,Ve,he),k.proxy)return k;if(O=Jt(),k.proxy=O,O.src=u,O.listener=k,u.addEventListener)q||(ne=Ve),ne===void 0&&(ne=!1),u.addEventListener(v.toString(),O,ne);else if(u.attachEvent)u.attachEvent(ci(v.toString()),O);else if(u.addListener&&u.removeListener)u.addListener(O);else throw Error("addEventListener and attachEvent are unavailable.");return k}function Jt(){function u(k){return v.call(u.src,u.listener,k)}const v=$i;return u}function hn(u,v,k,O,ne){if(Array.isArray(v))for(var he=0;he<v.length;he++)hn(u,v[he],k,O,ne);else O=c(O)?!!O.capture:!!O,k=fi(k),u&&u[Se]?(u=u.i,v=String(v).toString(),v in u.g&&(he=u.g[v],k=jt(he,k,O,ne),-1<k&&(we(he[k]),Array.prototype.splice.call(he,k,1),he.length==0&&(delete u.g[v],u.h--)))):u&&(u=ui(u))&&(v=u.g[v.toString()],u=-1,v&&(u=jt(v,k,O,ne)),(k=-1<u?v[u]:null)&&$r(k))}function $r(u){if(typeof u!="number"&&u&&!u.da){var v=u.src;if(v&&v[Se])G(v.i,u);else{var k=u.type,O=u.proxy;v.removeEventListener?v.removeEventListener(k,O,u.capture):v.detachEvent?v.detachEvent(ci(k),O):v.addListener&&v.removeListener&&v.removeListener(O),(k=ui(v))?(G(k,u),k.h==0&&(k.src=null,v[mt]=null)):we(u)}}}function ci(u){return u in bt?bt[u]:bt[u]="on"+u}function $i(u,v){if(u.da)u=!0;else{v=new Y(v,this);var k=u.listener,O=u.ha||u.src;u.fa&&$r(u),u=k.call(O,v)}return u}function ui(u){return u=u[mt],u instanceof it?u:null}var Fr="__closure_events_fn_"+(1e9*Math.random()>>>0);function fi(u){return typeof u=="function"?u:(u[Fr]||(u[Fr]=function(v){return u.handleEvent(v)}),u[Fr])}function Ot(){j.call(this),this.i=new it(this),this.M=this,this.F=null}y(Ot,j),Ot.prototype[Se]=!0,Ot.prototype.removeEventListener=function(u,v,k,O){hn(this,u,v,k,O)};function vr(u,v){var k,O=u.F;if(O)for(k=[];O;O=O.F)k.push(O);if(u=u.M,O=v.type||v,typeof v=="string")v=new H(v,u);else if(v instanceof H)v.target=v.target||u;else{var ne=v;v=new H(O,u),b(v,ne)}if(ne=!0,k)for(var he=k.length-1;0<=he;he--){var Ve=v.g=k[he];ne=rr(Ve,O,!0,v)&&ne}if(Ve=v.g=u,ne=rr(Ve,O,!0,v)&&ne,ne=rr(Ve,O,!1,v)&&ne,k)for(he=0;he<k.length;he++)Ve=v.g=k[he],ne=rr(Ve,O,!1,v)&&ne}Ot.prototype.N=function(){if(Ot.aa.N.call(this),this.i){var u=this.i,v;for(v in u.g){for(var k=u.g[v],O=0;O<k.length;O++)we(k[O]);delete u.g[v],u.h--}}this.F=null},Ot.prototype.K=function(u,v,k,O){return this.i.add(String(u),v,!1,k,O)},Ot.prototype.L=function(u,v,k,O){return this.i.add(String(u),v,!0,k,O)};function rr(u,v,k,O){if(v=u.i.g[String(v)],!v)return!0;v=v.concat();for(var ne=!0,he=0;he<v.length;++he){var Ve=v[he];if(Ve&&!Ve.da&&Ve.capture==k){var zt=Ve.listener,Xr=Ve.ha||Ve.src;Ve.fa&&G(u.i,Ve),ne=zt.call(Xr,O)!==!1&&ne}}return ne&&!O.defaultPrevented}function qn(u,v,k){if(typeof u=="function")k&&(u=p(u,k));else if(u&&typeof u.handleEvent=="function")u=p(u.handleEvent,u);else throw Error("Invalid listener argument");return 2147483647<Number(v)?-1:o.setTimeout(u,v||0)}function ct(u){u.g=qn(()=>{u.g=null,u.i&&(u.i=!1,ct(u))},u.l);const v=u.h;u.h=null,u.m.apply(null,v)}class nr extends j{constructor(v,k){super(),this.m=v,this.l=k,this.h=null,this.i=!1,this.g=null}j(v){this.h=arguments,this.g?this.i=!0:ct(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function yr(u){j.call(this),this.h=u,this.g={}}y(yr,j);var dr=[];function Nn(u){B(u.g,function(v,k){this.g.hasOwnProperty(k)&&$r(v)},u),u.g={}}yr.prototype.N=function(){yr.aa.N.call(this),Nn(this)},yr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ie=o.JSON.stringify,jr=o.JSON.parse,aa=class{stringify(u){return o.JSON.stringify(u,void 0)}parse(u){return o.JSON.parse(u,void 0)}};function oa(){}oa.prototype.h=null;function Ps(u){return u.h||(u.h=u.i())}function la(){}var ki={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Gi(){H.call(this,"d")}y(Gi,H);function _r(){H.call(this,"c")}y(_r,H);var Ki={},Ha=null;function $a(){return Ha=Ha||new Ot}Ki.La="serverreachability";function Dn(u){H.call(this,Ki.La,u)}y(Dn,H);function Os(u){const v=$a();vr(v,new Dn(v))}Ki.STAT_EVENT="statevent";function Zt(u,v){H.call(this,Ki.STAT_EVENT,u),this.stat=v}y(Zt,H);function hr(u){const v=$a();vr(v,new Zt(v,u))}Ki.Ma="timingevent";function Ci(u,v){H.call(this,Ki.Ma,u),this.size=v}y(Ci,H);function pn(u,v){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){u()},v)}function ca(){this.g=!0}ca.prototype.xa=function(){this.g=!1};function Hl(u,v,k,O,ne,he){u.info(function(){if(u.g)if(he)for(var Ve="",zt=he.split("&"),Xr=0;Xr<zt.length;Xr++){var Ft=zt[Xr].split("=");if(1<Ft.length){var nn=Ft[0];Ft=Ft[1];var sn=nn.split("_");Ve=2<=sn.length&&sn[1]=="type"?Ve+(nn+"="+Ft+"&"):Ve+(nn+"=redacted&")}}else Ve=null;else Ve=he;return"XMLHTTP REQ ("+O+") [attempt "+ne+"]: "+v+`
`+k+`
`+Ve})}function hs(u,v,k,O,ne,he,Ve){u.info(function(){return"XMLHTTP RESP ("+O+") [ attempt "+ne+"]: "+v+`
`+k+`
`+he+" "+Ve})}function I(u,v,k,O){u.info(function(){return"XMLHTTP TEXT ("+v+"): "+L(u,k)+(O?" "+O:"")})}function U(u,v){u.info(function(){return"TIMEOUT: "+v})}ca.prototype.info=function(){};function L(u,v){if(!u.g)return v;if(!v)return null;try{var k=JSON.parse(v);if(k){for(u=0;u<k.length;u++)if(Array.isArray(k[u])){var O=k[u];if(!(2>O.length)){var ne=O[1];if(Array.isArray(ne)&&!(1>ne.length)){var he=ne[0];if(he!="noop"&&he!="stop"&&he!="close")for(var Ve=1;Ve<ne.length;Ve++)ne[Ve]=""}}}}return ie(k)}catch{return v}}var M={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},z={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},V;function ae(){}y(ae,oa),ae.prototype.g=function(){return new XMLHttpRequest},ae.prototype.i=function(){return{}},V=new ae;function re(u,v,k,O){this.j=u,this.i=v,this.l=k,this.R=O||1,this.U=new yr(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new se}function se(){this.i=null,this.g="",this.h=!1}var ee={},oe={};function ve(u,v,k){u.L=1,u.v=Ms(gs(v)),u.m=k,u.P=!0,Oe(u,null)}function Oe(u,v){u.F=Date.now(),ze(u),u.A=gs(u.v);var k=u.A,O=u.R;Array.isArray(O)||(O=[String(O)]),hi(k.i,"t",O),u.C=0,k=u.j.J,u.h=new se,u.g=X0(u.j,k?v:null,!u.m),0<u.O&&(u.M=new nr(p(u.Y,u,u.g),u.O)),v=u.U,k=u.g,O=u.ca;var ne="readystatechange";Array.isArray(ne)||(ne&&(dr[0]=ne.toString()),ne=dr);for(var he=0;he<ne.length;he++){var Ve=ht(k,ne[he],O||v.handleEvent,!1,v.h||v);if(!Ve)break;v.g[Ve.key]=Ve}v=u.H?F(u.H):{},u.m?(u.u||(u.u="POST"),v["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.A,u.u,u.m,v)):(u.u="GET",u.g.ea(u.A,u.u,null,v)),Os(),Hl(u.i,u.u,u.A,u.l,u.R,u.m)}re.prototype.ca=function(u){u=u.target;const v=this.M;v&&bi(u)==3?v.j():this.Y(u)},re.prototype.Y=function(u){try{if(u==this.g)e:{const sn=bi(this.g);var v=this.g.Ba();const Za=this.g.Z();if(!(3>sn)&&(sn!=3||this.g&&(this.h.h||this.g.oa()||U0(this.g)))){this.J||sn!=4||v==7||(v==8||0>=Za?Os(3):Os(2)),Et(this);var k=this.g.Z();this.X=k;t:if(He(this)){var O=U0(this.g);u="";var ne=O.length,he=bi(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){wt(this),kt(this);var Ve="";break t}this.h.i=new o.TextDecoder}for(v=0;v<ne;v++)this.h.h=!0,u+=this.h.i.decode(O[v],{stream:!(he&&v==ne-1)});O.length=0,this.h.g+=u,this.C=0,Ve=this.h.g}else Ve=this.g.oa();if(this.o=k==200,hs(this.i,this.u,this.A,this.l,this.R,sn,k),this.o){if(this.T&&!this.K){t:{if(this.g){var zt,Xr=this.g;if((zt=Xr.g?Xr.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!A(zt)){var Ft=zt;break t}}Ft=null}if(k=Ft)I(this.i,this.l,k,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Qn(this,k);else{this.o=!1,this.s=3,hr(12),wt(this),kt(this);break e}}if(this.P){k=!0;let Ri;for(;!this.J&&this.C<Ve.length;)if(Ri=Fe(this,Ve),Ri==oe){sn==4&&(this.s=4,hr(14),k=!1),I(this.i,this.l,null,"[Incomplete Response]");break}else if(Ri==ee){this.s=4,hr(15),I(this.i,this.l,Ve,"[Invalid Chunk]"),k=!1;break}else I(this.i,this.l,Ri,null),Qn(this,Ri);if(He(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),sn!=4||Ve.length!=0||this.h.h||(this.s=1,hr(16),k=!1),this.o=this.o&&k,!k)I(this.i,this.l,Ve,"[Invalid Chunked Response]"),wt(this),kt(this);else if(0<Ve.length&&!this.W){this.W=!0;var nn=this.j;nn.g==this&&nn.ba&&!nn.M&&(nn.j.info("Great, no buffering proxy detected. Bytes received: "+Ve.length),Su(nn),nn.M=!0,hr(11))}}else I(this.i,this.l,Ve,null),Qn(this,Ve);sn==4&&wt(this),this.o&&!this.J&&(sn==4?G0(this.j,this):(this.o=!1,ze(this)))}else er(this.g),k==400&&0<Ve.indexOf("Unknown SID")?(this.s=3,hr(12)):(this.s=0,hr(13)),wt(this),kt(this)}}}catch{}finally{}};function He(u){return u.g?u.u=="GET"&&u.L!=2&&u.j.Ca:!1}function Fe(u,v){var k=u.C,O=v.indexOf(`
`,k);return O==-1?oe:(k=Number(v.substring(k,O)),isNaN(k)?ee:(O+=1,O+k>v.length?oe:(v=v.slice(O,O+k),u.C=O+k,v)))}re.prototype.cancel=function(){this.J=!0,wt(this)};function ze(u){u.S=Date.now()+u.I,st(u,u.I)}function st(u,v){if(u.B!=null)throw Error("WatchDog timer not null");u.B=pn(p(u.ba,u),v)}function Et(u){u.B&&(o.clearTimeout(u.B),u.B=null)}re.prototype.ba=function(){this.B=null;const u=Date.now();0<=u-this.S?(U(this.i,this.A),this.L!=2&&(Os(),hr(17)),wt(this),this.s=2,kt(this)):st(this,this.S-u)};function kt(u){u.j.G==0||u.J||G0(u.j,u)}function wt(u){Et(u);var v=u.M;v&&typeof v.ma=="function"&&v.ma(),u.M=null,Nn(u.U),u.g&&(v=u.g,u.g=null,v.abort(),v.ma())}function Qn(u,v){try{var k=u.j;if(k.G!=0&&(k.g==u||xn(k.h,u))){if(!u.K&&xn(k.h,u)&&k.G==3){try{var O=k.Da.g.parse(v)}catch{O=null}if(Array.isArray(O)&&O.length==3){var ne=O;if(ne[0]==0){e:if(!k.u){if(k.g)if(k.g.F+3e3<u.F)Qo(k),ql(k);else break e;Tu(k),hr(18)}}else k.za=ne[1],0<k.za-k.T&&37500>ne[2]&&k.F&&k.v==0&&!k.C&&(k.C=pn(p(k.Za,k),6e3));if(1>=Ii(k.h)&&k.ca){try{k.ca()}catch{}k.ca=void 0}}else ha(k,11)}else if((u.K||k.g==u)&&Qo(k),!A(v))for(ne=k.Da.g.parse(v),v=0;v<ne.length;v++){let Ft=ne[v];if(k.T=Ft[0],Ft=Ft[1],k.G==2)if(Ft[0]=="c"){k.K=Ft[1],k.ia=Ft[2];const nn=Ft[3];nn!=null&&(k.la=nn,k.j.info("VER="+k.la));const sn=Ft[4];sn!=null&&(k.Aa=sn,k.j.info("SVER="+k.Aa));const Za=Ft[5];Za!=null&&typeof Za=="number"&&0<Za&&(O=1.5*Za,k.L=O,k.j.info("backChannelRequestTimeoutMs_="+O)),O=k;const Ri=u.g;if(Ri){const ec=Ri.g?Ri.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ec){var he=O.h;he.g||ec.indexOf("spdy")==-1&&ec.indexOf("quic")==-1&&ec.indexOf("h2")==-1||(he.j=he.l,he.g=new Set,he.h&&(Ga(he,he.h),he.h=null))}if(O.D){const tc=Ri.g?Ri.g.getResponseHeader("X-HTTP-Session-Id"):null;tc&&(O.ya=tc,Xe(O.I,O.D,tc))}}k.G=3,k.l&&k.l.ua(),k.ba&&(k.R=Date.now()-u.F,k.j.info("Handshake RTT: "+k.R+"ms")),O=k;var Ve=u;if(O.qa=Jl(O,O.J?O.ia:null,O.W),Ve.K){Jn(O.h,Ve);var zt=Ve,Xr=O.L;Xr&&(zt.I=Xr),zt.B&&(Et(zt),ze(zt)),O.g=Ve}else H0(O);0<k.i.length&&qi(k)}else Ft[0]!="stop"&&Ft[0]!="close"||ha(k,7);else k.G==3&&(Ft[0]=="stop"||Ft[0]=="close"?Ft[0]=="stop"?ha(k,7):qo(k):Ft[0]!="noop"&&k.l&&k.l.ta(Ft),k.v=0)}}Os(4)}catch{}}var gn=class{constructor(u,v){this.g=u,this.map=v}};function Fi(u){this.l=u||10,o.PerformanceNavigationTiming?(u=o.performance.getEntriesByType("navigation"),u=0<u.length&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function mn(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function Ii(u){return u.h?1:u.g?u.g.size:0}function xn(u,v){return u.h?u.h==v:u.g?u.g.has(v):!1}function Ga(u,v){u.g?u.g.add(v):u.h=v}function Jn(u,v){u.h&&u.h==v?u.h=null:u.g&&u.g.has(v)&&u.g.delete(v)}Fi.prototype.cancel=function(){if(this.i=Go(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const u of this.g.values())u.cancel();this.g.clear()}};function Go(u){if(u.h!=null)return u.i.concat(u.h.D);if(u.g!=null&&u.g.size!==0){let v=u.i;for(const k of u.g.values())v=v.concat(k.D);return v}return x(u.i)}function di(u){if(u.V&&typeof u.V=="function")return u.V();if(typeof Map<"u"&&u instanceof Map||typeof Set<"u"&&u instanceof Set)return Array.from(u.values());if(typeof u=="string")return u.split("");if(l(u)){for(var v=[],k=u.length,O=0;O<k;O++)v.push(u[O]);return v}v=[],k=0;for(O in u)v[k++]=u[O];return v}function $l(u){if(u.na&&typeof u.na=="function")return u.na();if(!u.V||typeof u.V!="function"){if(typeof Map<"u"&&u instanceof Map)return Array.from(u.keys());if(!(typeof Set<"u"&&u instanceof Set)){if(l(u)||typeof u=="string"){var v=[];u=u.length;for(var k=0;k<u;k++)v.push(k);return v}v=[],k=0;for(const O in u)v[k++]=O;return v}}}function ps(u,v){if(u.forEach&&typeof u.forEach=="function")u.forEach(v,void 0);else if(l(u)||typeof u=="string")Array.prototype.forEach.call(u,v,void 0);else for(var k=$l(u),O=di(u),ne=O.length,he=0;he<ne;he++)v.call(void 0,O[he],k&&k[he],u)}var Gl=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function vn(u,v){if(u){u=u.split("&");for(var k=0;k<u.length;k++){var O=u[k].indexOf("="),ne=null;if(0<=O){var he=u[k].substring(0,O);ne=u[k].substring(O+1)}else he=u[k];v(he,ne?decodeURIComponent(ne.replace(/\+/g," ")):"")}}}function Xi(u){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,u instanceof Xi){this.h=u.h,ua(this,u.j),this.o=u.o,this.g=u.g,Ko(this,u.s),this.l=u.l;var v=u.i,k=new ms;k.i=v.i,v.g&&(k.g=new Map(v.g),k.h=v.h),Kl(this,k),this.m=u.m}else u&&(v=String(u).match(Gl))?(this.h=!1,ua(this,v[1]||"",!0),this.o=Yt(v[2]||""),this.g=Yt(v[3]||"",!0),Ko(this,v[4]),this.l=Yt(v[5]||"",!0),Kl(this,v[6]||"",!0),this.m=Yt(v[7]||"")):(this.h=!1,this.i=new ms(null,this.h))}Xi.prototype.toString=function(){var u=[],v=this.j;v&&u.push(Yi(v,yu,!0),":");var k=this.g;return(k||v=="file")&&(u.push("//"),(v=this.o)&&u.push(Yi(v,yu,!0),"@"),u.push(encodeURIComponent(String(k)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),k=this.s,k!=null&&u.push(":",String(k))),(k=this.l)&&(this.g&&k.charAt(0)!="/"&&u.push("/"),u.push(Yi(k,k.charAt(0)=="/"?P0:_u,!0))),(k=this.i.toString())&&u.push("?",k),(k=this.m)&&u.push("#",Yi(k,M0)),u.join("")};function gs(u){return new Xi(u)}function ua(u,v,k){u.j=k?Yt(v,!0):v,u.j&&(u.j=u.j.replace(/:$/,""))}function Ko(u,v){if(v){if(v=Number(v),isNaN(v)||0>v)throw Error("Bad port number "+v);u.s=v}else u.s=null}function Kl(u,v,k){v instanceof ms?(u.i=v,Xl(u.i,u.h)):(k||(v=Yi(v,O0)),u.i=new ms(v,u.h))}function Xe(u,v,k){u.i.set(v,k)}function Ms(u){return Xe(u,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),u}function Yt(u,v){return u?v?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function Yi(u,v,k){return typeof u=="string"?(u=encodeURI(u).replace(v,D0),k&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function D0(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var yu=/[#\/\?@]/g,_u=/[#\?:]/g,P0=/[#\?]/g,O0=/[#\?@]/g,M0=/#/g;function ms(u,v){this.h=this.g=null,this.i=u||null,this.j=!!v}function xs(u){u.g||(u.g=new Map,u.h=0,u.i&&vn(u.i,function(v,k){u.add(decodeURIComponent(v.replace(/\+/g," ")),k)}))}t=ms.prototype,t.add=function(u,v){xs(this),this.i=null,u=vs(this,u);var k=this.g.get(u);return k||this.g.set(u,k=[]),k.push(v),this.h+=1,this};function Eu(u,v){xs(u),v=vs(u,v),u.g.has(v)&&(u.i=null,u.h-=u.g.get(v).length,u.g.delete(v))}function rn(u,v){return xs(u),v=vs(u,v),u.g.has(v)}t.forEach=function(u,v){xs(this),this.g.forEach(function(k,O){k.forEach(function(ne){u.call(v,ne,O,this)},this)},this)},t.na=function(){xs(this);const u=Array.from(this.g.values()),v=Array.from(this.g.keys()),k=[];for(let O=0;O<v.length;O++){const ne=u[O];for(let he=0;he<ne.length;he++)k.push(v[O])}return k},t.V=function(u){xs(this);let v=[];if(typeof u=="string")rn(this,u)&&(v=v.concat(this.g.get(vs(this,u))));else{u=Array.from(this.g.values());for(let k=0;k<u.length;k++)v=v.concat(u[k])}return v},t.set=function(u,v){return xs(this),this.i=null,u=vs(this,u),rn(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[v]),this.h+=1,this},t.get=function(u,v){return u?(u=this.V(u),0<u.length?String(u[0]):v):v};function hi(u,v,k){Eu(u,v),0<k.length&&(u.i=null,u.g.set(vs(u,v),x(k)),u.h+=k.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const u=[],v=Array.from(this.g.keys());for(var k=0;k<v.length;k++){var O=v[k];const he=encodeURIComponent(String(O)),Ve=this.V(O);for(O=0;O<Ve.length;O++){var ne=he;Ve[O]!==""&&(ne+="="+encodeURIComponent(String(Ve[O]))),u.push(ne)}}return this.i=u.join("&")};function vs(u,v){return v=String(v),u.j&&(v=v.toLowerCase()),v}function Xl(u,v){v&&!u.j&&(xs(u),u.i=null,u.g.forEach(function(k,O){var ne=O.toLowerCase();O!=ne&&(Eu(this,O),hi(this,ne,k))},u)),u.j=v}function L0(u,v){const k=new ca;if(o.Image){const O=new Image;O.onload=m(Gr,k,"TestLoadImage: loaded",!0,v,O),O.onerror=m(Gr,k,"TestLoadImage: error",!1,v,O),O.onabort=m(Gr,k,"TestLoadImage: abort",!1,v,O),O.ontimeout=m(Gr,k,"TestLoadImage: timeout",!1,v,O),o.setTimeout(function(){O.ontimeout&&O.ontimeout()},1e4),O.src=u}else v(!1)}function Yl(u,v){const k=new ca,O=new AbortController,ne=setTimeout(()=>{O.abort(),Gr(k,"TestPingServer: timeout",!1,v)},1e4);fetch(u,{signal:O.signal}).then(he=>{clearTimeout(ne),he.ok?Gr(k,"TestPingServer: ok",!0,v):Gr(k,"TestPingServer: server error",!1,v)}).catch(()=>{clearTimeout(ne),Gr(k,"TestPingServer: error",!1,v)})}function Gr(u,v,k,O,ne){try{ne&&(ne.onload=null,ne.onerror=null,ne.onabort=null,ne.ontimeout=null),O(k)}catch{}}function Ka(){this.g=new aa}function Xo(u,v,k){const O=k||"";try{ps(u,function(ne,he){let Ve=ne;c(ne)&&(Ve=ie(ne)),v.push(O+he+"="+encodeURIComponent(Ve))})}catch(ne){throw v.push(O+"type="+encodeURIComponent("_badmap")),ne}}function Xa(u){this.l=u.Ub||null,this.j=u.eb||!1}y(Xa,oa),Xa.prototype.g=function(){return new fa(this.l,this.j)},Xa.prototype.i=function(u){return function(){return u}}({});function fa(u,v){Ot.call(this),this.D=u,this.o=v,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}y(fa,Ot),t=fa.prototype,t.open=function(u,v){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=u,this.A=v,this.readyState=1,qa(this)},t.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const v={headers:this.u,method:this.B,credentials:this.m,cache:void 0};u&&(v.body=u),(this.D||o).fetch(new Request(this.A,v)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ya(this)),this.readyState=0},t.Sa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,qa(this)),this.g&&(this.readyState=3,qa(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Ls(this)}else u.text().then(this.Ra.bind(this),this.ga.bind(this))};function Ls(u){u.j.read().then(u.Pa.bind(u)).catch(u.ga.bind(u))}t.Pa=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var v=u.value?u.value:new Uint8Array(0);(v=this.v.decode(v,{stream:!u.done}))&&(this.response=this.responseText+=v)}u.done?Ya(this):qa(this),this.readyState==3&&Ls(this)}},t.Ra=function(u){this.g&&(this.response=this.responseText=u,Ya(this))},t.Qa=function(u){this.g&&(this.response=u,Ya(this))},t.ga=function(){this.g&&Ya(this)};function Ya(u){u.readyState=4,u.l=null,u.j=null,u.v=null,qa(u)}t.setRequestHeader=function(u,v){this.u.append(u,v)},t.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const u=[],v=this.h.entries();for(var k=v.next();!k.done;)k=k.value,u.push(k[0]+": "+k[1]),k=v.next();return u.join(`\r
`)};function qa(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(fa.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function B0(u){let v="";return B(u,function(k,O){v+=O,v+=":",v+=k,v+=`\r
`}),v}function da(u,v,k){e:{for(O in k){var O=!1;break e}O=!0}O||(k=B0(k),typeof u=="string"?k!=null&&encodeURIComponent(String(k)):Xe(u,v,k))}function ir(u){Ot.call(this),this.headers=new Map,this.o=u||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}y(ir,Ot);var Bs=/^https?$/i,Xp=["POST","PUT"];t=ir.prototype,t.Ha=function(u){this.J=u},t.ea=function(u,v,k,O){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);v=v?v.toUpperCase():"GET",this.D=u,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():V.g(),this.v=this.o?Ps(this.o):Ps(V),this.g.onreadystatechange=p(this.Ea,this);try{this.B=!0,this.g.open(v,String(u),!0),this.B=!1}catch(he){j0(this,he);return}if(u=k||"",k=new Map(this.headers),O)if(Object.getPrototypeOf(O)===Object.prototype)for(var ne in O)k.set(ne,O[ne]);else if(typeof O.keys=="function"&&typeof O.get=="function")for(const he of O.keys())k.set(he,O.get(he));else throw Error("Unknown input type for opt_headers: "+String(O));O=Array.from(k.keys()).find(he=>he.toLowerCase()=="content-type"),ne=o.FormData&&u instanceof o.FormData,!(0<=Array.prototype.indexOf.call(Xp,v,void 0))||O||ne||k.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[he,Ve]of k)this.g.setRequestHeader(he,Ve);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{wu(this),this.u=!0,this.g.send(u),this.u=!1}catch(he){j0(this,he)}};function j0(u,v){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=v,u.m=5,V0(u),pi(u)}function V0(u){u.A||(u.A=!0,vr(u,"complete"),vr(u,"error"))}t.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=u||7,vr(this,"complete"),vr(this,"abort"),pi(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),pi(this,!0)),ir.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Yo(this):this.bb())},t.bb=function(){Yo(this)};function Yo(u){if(u.h&&typeof a<"u"&&(!u.v[1]||bi(u)!=4||u.Z()!=2)){if(u.u&&bi(u)==4)qn(u.Ea,0,u);else if(vr(u,"readystatechange"),bi(u)==4){u.h=!1;try{const Ve=u.Z();e:switch(Ve){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var v=!0;break e;default:v=!1}var k;if(!(k=v)){var O;if(O=Ve===0){var ne=String(u.D).match(Gl)[1]||null;!ne&&o.self&&o.self.location&&(ne=o.self.location.protocol.slice(0,-1)),O=!Bs.test(ne?ne.toLowerCase():"")}k=O}if(k)vr(u,"complete"),vr(u,"success");else{u.m=6;try{var he=2<bi(u)?u.g.statusText:""}catch{he=""}u.l=he+" ["+u.Z()+"]",V0(u)}}finally{pi(u)}}}}function pi(u,v){if(u.g){wu(u);const k=u.g,O=u.v[0]?()=>{}:null;u.g=null,u.v=null,v||vr(u,"ready");try{k.onreadystatechange=O}catch{}}}function wu(u){u.I&&(o.clearTimeout(u.I),u.I=null)}t.isActive=function(){return!!this.g};function bi(u){return u.g?u.g.readyState:0}t.Z=function(){try{return 2<bi(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(u){if(this.g){var v=this.g.responseText;return u&&v.indexOf(u)==0&&(v=v.substring(u.length)),jr(v)}};function U0(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.H){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function er(u){const v={};u=(u.g&&2<=bi(u)&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let O=0;O<u.length;O++){if(A(u[O]))continue;var k=N(u[O]);const ne=k[0];if(k=k[1],typeof k!="string")continue;k=k.trim();const he=v[ne]||[];v[ne]=he,he.push(k)}w(v,function(O){return O.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Kr(u,v,k){return k&&k.internalChannelParams&&k.internalChannelParams[u]||v}function Qa(u){this.Aa=0,this.i=[],this.j=new ca,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Kr("failFast",!1,u),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Kr("baseRetryDelayMs",5e3,u),this.cb=Kr("retryDelaySeedMs",1e4,u),this.Wa=Kr("forwardChannelMaxRetries",2,u),this.wa=Kr("forwardChannelRequestTimeoutMs",2e4,u),this.pa=u&&u.xmlHttpFactory||void 0,this.Xa=u&&u.Tb||void 0,this.Ca=u&&u.useFetchStreams||!1,this.L=void 0,this.J=u&&u.supportsCrossDomainXhr||!1,this.K="",this.h=new Fi(u&&u.concurrentRequestLimit),this.Da=new Ka,this.P=u&&u.fastHandshake||!1,this.O=u&&u.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=u&&u.Rb||!1,u&&u.xa&&this.j.xa(),u&&u.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&u&&u.detectBufferingProxy||!1,this.ja=void 0,u&&u.longPollingTimeout&&0<u.longPollingTimeout&&(this.ja=u.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Qa.prototype,t.la=8,t.G=1,t.connect=function(u,v,k,O){hr(0),this.W=u,this.H=v||{},k&&O!==void 0&&(this.H.OSID=k,this.H.OAID=O),this.F=this.X,this.I=Jl(this,null,this.W),qi(this)};function qo(u){if(z0(u),u.G==3){var v=u.U++,k=gs(u.I);if(Xe(k,"SID",u.K),Xe(k,"RID",v),Xe(k,"TYPE","terminate"),ys(u,k),v=new re(u,u.j,v),v.L=2,v.v=Ms(gs(k)),k=!1,o.navigator&&o.navigator.sendBeacon)try{k=o.navigator.sendBeacon(v.v.toString(),"")}catch{}!k&&o.Image&&(new Image().src=v.v,k=!0),k||(v.g=X0(v.j,null),v.g.ea(v.v)),v.F=Date.now(),ze(v)}K0(u)}function ql(u){u.g&&(Su(u),u.g.cancel(),u.g=null)}function z0(u){ql(u),u.u&&(o.clearTimeout(u.u),u.u=null),Qo(u),u.h.cancel(),u.s&&(typeof u.s=="number"&&o.clearTimeout(u.s),u.s=null)}function qi(u){if(!mn(u.h)&&!u.s){u.s=!0;var v=u.Ga;Te||ke(),_e||(Te(),_e=!0),Q.add(v,u),u.B=0}}function Yp(u,v){return Ii(u.h)>=u.h.j-(u.s?1:0)?!1:u.s?(u.i=v.D.concat(u.i),!0):u.G==1||u.G==2||u.B>=(u.Va?0:u.Wa)?!1:(u.s=pn(p(u.Ga,u,v),Au(u,u.B)),u.B++,!0)}t.Ga=function(u){if(this.s)if(this.s=null,this.G==1){if(!u){this.U=Math.floor(1e5*Math.random()),u=this.U++;const ne=new re(this,this.j,u);let he=this.o;if(this.S&&(he?(he=F(he),b(he,this.S)):he=this.S),this.m!==null||this.O||(ne.H=he,he=null),this.P)e:{for(var v=0,k=0;k<this.i.length;k++){t:{var O=this.i[k];if("__data__"in O.map&&(O=O.map.__data__,typeof O=="string")){O=O.length;break t}O=void 0}if(O===void 0)break;if(v+=O,4096<v){v=k;break e}if(v===4096||k===this.i.length-1){v=k+1;break e}}v=1e3}else v=1e3;v=W0(this,ne,v),k=gs(this.I),Xe(k,"RID",u),Xe(k,"CVER",22),this.D&&Xe(k,"X-HTTP-Session-Id",this.D),ys(this,k),he&&(this.O?v="headers="+encodeURIComponent(String(B0(he)))+"&"+v:this.m&&da(k,this.m,he)),Ga(this.h,ne),this.Ua&&Xe(k,"TYPE","init"),this.P?(Xe(k,"$req",v),Xe(k,"SID","null"),ne.T=!0,ve(ne,k,null)):ve(ne,k,v),this.G=2}}else this.G==3&&(u?Ql(this,u):this.i.length==0||mn(this.h)||Ql(this))};function Ql(u,v){var k;v?k=v.l:k=u.U++;const O=gs(u.I);Xe(O,"SID",u.K),Xe(O,"RID",k),Xe(O,"AID",u.T),ys(u,O),u.m&&u.o&&da(O,u.m,u.o),k=new re(u,u.j,k,u.B+1),u.m===null&&(k.H=u.o),v&&(u.i=v.D.concat(u.i)),v=W0(u,k,1e3),k.I=Math.round(.5*u.wa)+Math.round(.5*u.wa*Math.random()),Ga(u.h,k),ve(k,O,v)}function ys(u,v){u.H&&B(u.H,function(k,O){Xe(v,O,k)}),u.l&&ps({},function(k,O){Xe(v,O,k)})}function W0(u,v,k){k=Math.min(u.i.length,k);var O=u.l?p(u.l.Na,u.l,u):null;e:{var ne=u.i;let he=-1;for(;;){const Ve=["count="+k];he==-1?0<k?(he=ne[0].g,Ve.push("ofs="+he)):he=0:Ve.push("ofs="+he);let zt=!0;for(let Xr=0;Xr<k;Xr++){let Ft=ne[Xr].g;const nn=ne[Xr].map;if(Ft-=he,0>Ft)he=Math.max(0,ne[Xr].g-100),zt=!1;else try{Xo(nn,Ve,"req"+Ft+"_")}catch{O&&O(nn)}}if(zt){O=Ve.join("&");break e}}}return u=u.i.splice(0,k),v.D=u,O}function H0(u){if(!u.g&&!u.u){u.Y=1;var v=u.Fa;Te||ke(),_e||(Te(),_e=!0),Q.add(v,u),u.v=0}}function Tu(u){return u.g||u.u||3<=u.v?!1:(u.Y++,u.u=pn(p(u.Fa,u),Au(u,u.v)),u.v++,!0)}t.Fa=function(){if(this.u=null,$0(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var u=2*this.R;this.j.info("BP detection timer enabled: "+u),this.A=pn(p(this.ab,this),u)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,hr(10),ql(this),$0(this))};function Su(u){u.A!=null&&(o.clearTimeout(u.A),u.A=null)}function $0(u){u.g=new re(u,u.j,"rpc",u.Y),u.m===null&&(u.g.H=u.o),u.g.O=0;var v=gs(u.qa);Xe(v,"RID","rpc"),Xe(v,"SID",u.K),Xe(v,"AID",u.T),Xe(v,"CI",u.F?"0":"1"),!u.F&&u.ja&&Xe(v,"TO",u.ja),Xe(v,"TYPE","xmlhttp"),ys(u,v),u.m&&u.o&&da(v,u.m,u.o),u.L&&(u.g.I=u.L);var k=u.g;u=u.ia,k.L=1,k.v=Ms(gs(v)),k.m=null,k.P=!0,Oe(k,u)}t.Za=function(){this.C!=null&&(this.C=null,ql(this),Tu(this),hr(19))};function Qo(u){u.C!=null&&(o.clearTimeout(u.C),u.C=null)}function G0(u,v){var k=null;if(u.g==v){Qo(u),Su(u),u.g=null;var O=2}else if(xn(u.h,v))k=v.D,Jn(u.h,v),O=1;else return;if(u.G!=0){if(v.o)if(O==1){k=v.m?v.m.length:0,v=Date.now()-v.F;var ne=u.B;O=$a(),vr(O,new Ci(O,k)),qi(u)}else H0(u);else if(ne=v.s,ne==3||ne==0&&0<v.X||!(O==1&&Yp(u,v)||O==2&&Tu(u)))switch(k&&0<k.length&&(v=u.h,v.i=v.i.concat(k)),ne){case 1:ha(u,5);break;case 4:ha(u,10);break;case 3:ha(u,6);break;default:ha(u,2)}}}function Au(u,v){let k=u.Ta+Math.floor(Math.random()*u.cb);return u.isActive()||(k*=2),k*v}function ha(u,v){if(u.j.info("Error code "+v),v==2){var k=p(u.fb,u),O=u.Xa;const ne=!O;O=new Xi(O||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||ua(O,"https"),Ms(O),ne?L0(O.toString(),k):Yl(O.toString(),k)}else hr(2);u.G=0,u.l&&u.l.sa(v),K0(u),z0(u)}t.fb=function(u){u?(this.j.info("Successfully pinged google.com"),hr(2)):(this.j.info("Failed to ping google.com"),hr(1))};function K0(u){if(u.G=0,u.ka=[],u.l){const v=Go(u.h);(v.length!=0||u.i.length!=0)&&(E(u.ka,v),E(u.ka,u.i),u.h.i.length=0,x(u.i),u.i.length=0),u.l.ra()}}function Jl(u,v,k){var O=k instanceof Xi?gs(k):new Xi(k);if(O.g!="")v&&(O.g=v+"."+O.g),Ko(O,O.s);else{var ne=o.location;O=ne.protocol,v=v?v+"."+ne.hostname:ne.hostname,ne=+ne.port;var he=new Xi(null);O&&ua(he,O),v&&(he.g=v),ne&&Ko(he,ne),k&&(he.l=k),O=he}return k=u.D,v=u.ya,k&&v&&Xe(O,k,v),Xe(O,"VER",u.la),ys(u,O),O}function X0(u,v,k){if(v&&!u.J)throw Error("Can't create secondary domain capable XhrIo object.");return v=u.Ca&&!u.pa?new ir(new Xa({eb:k})):new ir(u.pa),v.Ha(u.J),v}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Y0(){}t=Y0.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Zl(){}Zl.prototype.g=function(u,v){return new Zn(u,v)};function Zn(u,v){Ot.call(this),this.g=new Qa(v),this.l=u,this.h=v&&v.messageUrlParams||null,u=v&&v.messageHeaders||null,v&&v.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=v&&v.initMessageHeaders||null,v&&v.messageContentType&&(u?u["X-WebChannel-Content-Type"]=v.messageContentType:u={"X-WebChannel-Content-Type":v.messageContentType}),v&&v.va&&(u?u["X-WebChannel-Client-Profile"]=v.va:u={"X-WebChannel-Client-Profile":v.va}),this.g.S=u,(u=v&&v.Sb)&&!A(u)&&(this.g.m=u),this.v=v&&v.supportsCrossDomainXhr||!1,this.u=v&&v.sendRawJson||!1,(v=v&&v.httpSessionIdParam)&&!A(v)&&(this.g.D=v,u=this.h,u!==null&&v in u&&(u=this.h,v in u&&delete u[v])),this.j=new Ja(this)}y(Zn,Ot),Zn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Zn.prototype.close=function(){qo(this.g)},Zn.prototype.o=function(u){var v=this.g;if(typeof u=="string"){var k={};k.__data__=u,u=k}else this.u&&(k={},k.__data__=ie(u),u=k);v.i.push(new gn(v.Ya++,u)),v.G==3&&qi(v)},Zn.prototype.N=function(){this.g.l=null,delete this.j,qo(this.g),delete this.g,Zn.aa.N.call(this)};function q0(u){Gi.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var v=u.__sm__;if(v){e:{for(const k in v){u=k;break e}u=void 0}(this.i=u)&&(u=this.i,v=v!==null&&u in v?v[u]:void 0),this.data=v}else this.data=u}y(q0,Gi);function Q0(){_r.call(this),this.status=1}y(Q0,_r);function Ja(u){this.g=u}y(Ja,Y0),Ja.prototype.ua=function(){vr(this.g,"a")},Ja.prototype.ta=function(u){vr(this.g,new q0(u))},Ja.prototype.sa=function(u){vr(this.g,new Q0)},Ja.prototype.ra=function(){vr(this.g,"b")},Zl.prototype.createWebChannel=Zl.prototype.g,Zn.prototype.send=Zn.prototype.o,Zn.prototype.open=Zn.prototype.m,Zn.prototype.close=Zn.prototype.close,Mk=function(){return new Zl},Ok=function(){return $a()},Pk=Ki,ux={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},M.NO_ERROR=0,M.TIMEOUT=8,M.HTTP_ERROR=6,Zd=M,z.COMPLETE="complete",Dk=z,la.EventType=ki,ki.OPEN="a",ki.CLOSE="b",ki.ERROR="c",ki.MESSAGE="d",Ot.prototype.listen=Ot.prototype.K,Yu=la,ir.prototype.listenOnce=ir.prototype.L,ir.prototype.getLastError=ir.prototype.Ka,ir.prototype.getLastErrorCode=ir.prototype.Ba,ir.prototype.getStatus=ir.prototype.Z,ir.prototype.getResponseJson=ir.prototype.Oa,ir.prototype.getResponseText=ir.prototype.oa,ir.prototype.send=ir.prototype.ea,ir.prototype.setWithCredentials=ir.prototype.Ha,Nk=ir}).apply(typeof Pd<"u"?Pd:typeof self<"u"?self:typeof window<"u"?window:{});const J2="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}jn.UNAUTHENTICATED=new jn(null),jn.GOOGLE_CREDENTIALS=new jn("google-credentials-uid"),jn.FIRST_PARTY=new jn("first-party-uid"),jn.MOCK_USER=new jn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let pu="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bl=new cv("@firebase/firestore");function Uu(){return bl.logLevel}function et(t,...e){if(bl.logLevel<=Ct.DEBUG){const r=e.map(dv);bl.debug(`Firestore (${pu}): ${t}`,...r)}}function Oa(t,...e){if(bl.logLevel<=Ct.ERROR){const r=e.map(dv);bl.error(`Firestore (${pu}): ${t}`,...r)}}function Jc(t,...e){if(bl.logLevel<=Ct.WARN){const r=e.map(dv);bl.warn(`Firestore (${pu}): ${t}`,...r)}}function dv(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dt(t="Unexpected state"){const e=`FIRESTORE (${pu}) INTERNAL ASSERTION FAILED: `+t;throw Oa(e),new Error(e)}function Xt(t,e){t||dt()}function gt(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Re={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class rt extends Wa{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Io{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lk{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Sj{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(jn.UNAUTHENTICATED))}shutdown(){}}class Aj{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class kj{constructor(e){this.t=e,this.currentUser=jn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){Xt(this.o===void 0);let n=this.i;const i=l=>this.i!==n?(n=this.i,r(l)):Promise.resolve();let s=new Io;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Io,e.enqueueRetryable(()=>i(this.currentUser))};const a=()=>{const l=s;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},o=l=>{et("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(l=>o(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?o(l):(et("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Io)}},0),a()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(et("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Xt(typeof n.accessToken=="string"),new Lk(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Xt(e===null||typeof e=="string"),new jn(e)}}class Cj{constructor(e,r,n){this.l=e,this.h=r,this.P=n,this.type="FirstParty",this.user=jn.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class Fj{constructor(e,r,n){this.l=e,this.h=r,this.P=n}getToken(){return Promise.resolve(new Cj(this.l,this.h,this.P))}start(e,r){e.enqueueRetryable(()=>r(jn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Ij{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class bj{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,r){Xt(this.o===void 0);const n=s=>{s.error!=null&&et("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const a=s.token!==this.R;return this.R=s.token,et("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?r(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>n(s))};const i=s=>{et("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):et("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(Xt(typeof r.token=="string"),this.R=r.token,new Ij(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rj(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bk{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=Math.floor(256/e.length)*e.length;let n="";for(;n.length<20;){const i=Rj(40);for(let s=0;s<i.length;++s)n.length<20&&i[s]<r&&(n+=e.charAt(i[s]%e.length))}return n}}function Bt(t,e){return t<e?-1:t>e?1:0}function Zc(t,e,r){return t.length===e.length&&t.every((n,i)=>r(n,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class en{constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new rt(Re.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new rt(Re.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<-62135596800)throw new rt(Re.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new rt(Re.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return en.fromMillis(Date.now())}static fromDate(e){return en.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*r));return new en(r,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Bt(this.nanoseconds,e.nanoseconds):Bt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pt{constructor(e){this.timestamp=e}static fromTimestamp(e){return new pt(e)}static min(){return new pt(new en(0,0))}static max(){return new pt(new en(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e0{constructor(e,r,n){r===void 0?r=0:r>e.length&&dt(),n===void 0?n=e.length-r:n>e.length-r&&dt(),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return e0.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof e0?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let i=0;i<n;i++){const s=e.get(i),a=r.get(i);if(s<a)return-1;if(s>a)return 1}return e.length<r.length?-1:e.length>r.length?1:0}}class Rr extends e0{construct(e,r,n){return new Rr(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new rt(Re.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(i=>i.length>0))}return new Rr(r)}static emptyPath(){return new Rr([])}}const Nj=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Cn extends e0{construct(e,r,n){return new Cn(e,r,n)}static isValidIdentifier(e){return Nj.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Cn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Cn(["__name__"])}static fromServerFormat(e){const r=[];let n="",i=0;const s=()=>{if(n.length===0)throw new rt(Re.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let a=!1;for(;i<e.length;){const o=e[i];if(o==="\\"){if(i+1===e.length)throw new rt(Re.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new rt(Re.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=l,i+=2}else o==="`"?(a=!a,i++):o!=="."||a?(n+=o,i++):(s(),i++)}if(s(),a)throw new rt(Re.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Cn(r)}static emptyPath(){return new Cn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nt{constructor(e){this.path=e}static fromPath(e){return new nt(Rr.fromString(e))}static fromName(e){return new nt(Rr.fromString(e).popFirst(5))}static empty(){return new nt(Rr.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Rr.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return Rr.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new nt(new Rr(e.slice()))}}function Dj(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,i=pt.fromTimestamp(n===1e9?new en(r+1,0):new en(r,n));return new Lo(i,nt.empty(),e)}function Pj(t){return new Lo(t.readTime,t.key,-1)}class Lo{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new Lo(pt.min(),nt.empty(),-1)}static max(){return new Lo(pt.max(),nt.empty(),-1)}}function Oj(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=nt.comparator(t.documentKey,e.documentKey),r!==0?r:Bt(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mj="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Lj{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function S0(t){if(t.code!==Re.FAILED_PRECONDITION||t.message!==Mj)throw t;et("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ce{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&dt(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new Ce((n,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(n,i)},this.catchCallback=s=>{this.wrapFailure(r,s).next(n,i)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof Ce?r:Ce.resolve(r)}catch(r){return Ce.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):Ce.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):Ce.reject(r)}static resolve(e){return new Ce((r,n)=>{r(e)})}static reject(e){return new Ce((r,n)=>{n(e)})}static waitFor(e){return new Ce((r,n)=>{let i=0,s=0,a=!1;e.forEach(o=>{++i,o.next(()=>{++s,a&&s===i&&r()},l=>n(l))}),a=!0,s===i&&r()})}static or(e){let r=Ce.resolve(!1);for(const n of e)r=r.next(i=>i?Ce.resolve(i):n());return r}static forEach(e,r){const n=[];return e.forEach((i,s)=>{n.push(r.call(this,i,s))}),this.waitFor(n)}static mapArray(e,r){return new Ce((n,i)=>{const s=e.length,a=new Array(s);let o=0;for(let l=0;l<s;l++){const c=l;r(e[c]).next(d=>{a[c]=d,++o,o===s&&n(a)},d=>i(d))}})}static doWhile(e,r){return new Ce((n,i)=>{const s=()=>{e()===!0?r().next(()=>{s()},i):n()};s()})}}function Bj(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function A0(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hv{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ie(n),this.se=n=>r.writeSequenceNumber(n))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}hv.oe=-1;function Pp(t){return t==null}function Xh(t){return t===0&&1/t==-1/0}function jj(t){return typeof t=="number"&&Number.isInteger(t)&&!Xh(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z2(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function gu(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function jk(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cr{constructor(e,r){this.comparator=e,this.root=r||Sn.EMPTY}insert(e,r){return new Cr(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,Sn.BLACK,null,null))}remove(e){return new Cr(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Sn.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return r+n.left.size;i<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Od(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Od(this.root,e,this.comparator,!1)}getReverseIterator(){return new Od(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Od(this.root,e,this.comparator,!0)}}class Od{constructor(e,r,n,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=r?n(e.key,r):1,r&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Sn{constructor(e,r,n,i,s){this.key=e,this.value=r,this.color=n??Sn.RED,this.left=i??Sn.EMPTY,this.right=s??Sn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,i,s){return new Sn(e??this.key,r??this.value,n??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let i=this;const s=n(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,r,n),null):s===0?i.copy(null,r,null,null,null):i.copy(null,null,null,null,i.right.insert(e,r,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Sn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,i=this;if(r(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,r),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),r(e,i.key)===0){if(i.right.isEmpty())return Sn.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,r))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Sn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Sn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw dt();const e=this.left.check();if(e!==this.right.check())throw dt();return e+(this.isRed()?0:1)}}Sn.EMPTY=null,Sn.RED=!0,Sn.BLACK=!1;Sn.EMPTY=new class{constructor(){this.size=0}get key(){throw dt()}get value(){throw dt()}get color(){throw dt()}get left(){throw dt()}get right(){throw dt()}copy(e,r,n,i,s){return this}insert(e,r,n){return new Sn(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class In{constructor(e){this.comparator=e,this.data=new Cr(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;r(i.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new eE(this.data.getIterator())}getIteratorFrom(e){return new eE(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof In)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const i=r.getNext().key,s=n.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new In(this.comparator);return r.data=e,r}}class eE{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cs{constructor(e){this.fields=e,e.sort(Cn.comparator)}static empty(){return new Cs([])}unionWith(e){let r=new In(Cn.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new Cs(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return Zc(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vk extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rn{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new Vk("Invalid base64 string: "+s):s}}(e);return new Rn(r)}static fromUint8Array(e){const r=function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s}(e);return new Rn(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Bt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Rn.EMPTY_BYTE_STRING=new Rn("");const Vj=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Bo(t){if(Xt(!!t),typeof t=="string"){let e=0;const r=Vj.exec(t);if(Xt(!!r),r[1]){let i=r[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Or(t.seconds),nanos:Or(t.nanos)}}function Or(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Rl(t){return typeof t=="string"?Rn.fromBase64String(t):Rn.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pv(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="server_timestamp"}function gv(t){const e=t.mapValue.fields.__previous_value__;return pv(e)?gv(e):e}function t0(t){const e=Bo(t.mapValue.fields.__local_write_time__.timestampValue);return new en(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uj{constructor(e,r,n,i,s,a,o,l,c){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=o,this.longPollingOptions=l,this.useFetchStreams=c}}class r0{constructor(e,r){this.projectId=e,this.database=r||"(default)"}static empty(){return new r0("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof r0&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Md={mapValue:{}};function Nl(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?pv(t)?4:Wj(t)?9007199254740991:zj(t)?10:11:dt()}function ra(t,e){if(t===e)return!0;const r=Nl(t);if(r!==Nl(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return t0(t).isEqual(t0(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const a=Bo(i.timestampValue),o=Bo(s.timestampValue);return a.seconds===o.seconds&&a.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return Rl(i.bytesValue).isEqual(Rl(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return Or(i.geoPointValue.latitude)===Or(s.geoPointValue.latitude)&&Or(i.geoPointValue.longitude)===Or(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return Or(i.integerValue)===Or(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const a=Or(i.doubleValue),o=Or(s.doubleValue);return a===o?Xh(a)===Xh(o):isNaN(a)&&isNaN(o)}return!1}(t,e);case 9:return Zc(t.arrayValue.values||[],e.arrayValue.values||[],ra);case 10:case 11:return function(i,s){const a=i.mapValue.fields||{},o=s.mapValue.fields||{};if(Z2(a)!==Z2(o))return!1;for(const l in a)if(a.hasOwnProperty(l)&&(o[l]===void 0||!ra(a[l],o[l])))return!1;return!0}(t,e);default:return dt()}}function n0(t,e){return(t.values||[]).find(r=>ra(r,e))!==void 0}function eu(t,e){if(t===e)return 0;const r=Nl(t),n=Nl(e);if(r!==n)return Bt(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return Bt(t.booleanValue,e.booleanValue);case 2:return function(s,a){const o=Or(s.integerValue||s.doubleValue),l=Or(a.integerValue||a.doubleValue);return o<l?-1:o>l?1:o===l?0:isNaN(o)?isNaN(l)?0:-1:1}(t,e);case 3:return tE(t.timestampValue,e.timestampValue);case 4:return tE(t0(t),t0(e));case 5:return Bt(t.stringValue,e.stringValue);case 6:return function(s,a){const o=Rl(s),l=Rl(a);return o.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(s,a){const o=s.split("/"),l=a.split("/");for(let c=0;c<o.length&&c<l.length;c++){const d=Bt(o[c],l[c]);if(d!==0)return d}return Bt(o.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,a){const o=Bt(Or(s.latitude),Or(a.latitude));return o!==0?o:Bt(Or(s.longitude),Or(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return rE(t.arrayValue,e.arrayValue);case 10:return function(s,a){var o,l,c,d;const h=s.fields||{},p=a.fields||{},m=(o=h.value)===null||o===void 0?void 0:o.arrayValue,y=(l=p.value)===null||l===void 0?void 0:l.arrayValue,x=Bt(((c=m==null?void 0:m.values)===null||c===void 0?void 0:c.length)||0,((d=y==null?void 0:y.values)===null||d===void 0?void 0:d.length)||0);return x!==0?x:rE(m,y)}(t.mapValue,e.mapValue);case 11:return function(s,a){if(s===Md.mapValue&&a===Md.mapValue)return 0;if(s===Md.mapValue)return 1;if(a===Md.mapValue)return-1;const o=s.fields||{},l=Object.keys(o),c=a.fields||{},d=Object.keys(c);l.sort(),d.sort();for(let h=0;h<l.length&&h<d.length;++h){const p=Bt(l[h],d[h]);if(p!==0)return p;const m=eu(o[l[h]],c[d[h]]);if(m!==0)return m}return Bt(l.length,d.length)}(t.mapValue,e.mapValue);default:throw dt()}}function tE(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Bt(t,e);const r=Bo(t),n=Bo(e),i=Bt(r.seconds,n.seconds);return i!==0?i:Bt(r.nanos,n.nanos)}function rE(t,e){const r=t.values||[],n=e.values||[];for(let i=0;i<r.length&&i<n.length;++i){const s=eu(r[i],n[i]);if(s)return s}return Bt(r.length,n.length)}function tu(t){return fx(t)}function fx(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=Bo(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return Rl(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return nt.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",i=!0;for(const s of r.values||[])i?i=!1:n+=",",n+=fx(s);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let i="{",s=!0;for(const a of n)s?s=!1:i+=",",i+=`${a}:${fx(r.fields[a])}`;return i+"}"}(t.mapValue):dt()}function dx(t){return!!t&&"integerValue"in t}function mv(t){return!!t&&"arrayValue"in t}function nE(t){return!!t&&"nullValue"in t}function iE(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function eh(t){return!!t&&"mapValue"in t}function zj(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="__vector__"}function xf(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return gu(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=xf(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=xf(t.arrayValue.values[r]);return e}return Object.assign({},t)}function Wj(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ss{constructor(e){this.value=e}static empty(){return new ss({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!eh(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=xf(r)}setAll(e){let r=Cn.emptyPath(),n={},i=[];e.forEach((a,o)=>{if(!r.isImmediateParentOf(o)){const l=this.getFieldsMap(r);this.applyChanges(l,n,i),n={},i=[],r=o.popLast()}a?n[o.lastSegment()]=xf(a):i.push(o.lastSegment())});const s=this.getFieldsMap(r);this.applyChanges(s,n,i)}delete(e){const r=this.field(e.popLast());eh(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return ra(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=r.mapValue.fields[e.get(n)];eh(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=i),r=i}return r.mapValue.fields}applyChanges(e,r,n){gu(r,(i,s)=>e[i]=s);for(const i of n)delete e[i]}clone(){return new ss(xf(this.value))}}function Uk(t){const e=[];return gu(t.fields,(r,n)=>{const i=new Cn([r]);if(eh(n)){const s=Uk(n.mapValue).fields;if(s.length===0)e.push(i);else for(const a of s)e.push(i.child(a))}else e.push(i)}),new Cs(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wn{constructor(e,r,n,i,s,a,o){this.key=e,this.documentType=r,this.version=n,this.readTime=i,this.createTime=s,this.data=a,this.documentState=o}static newInvalidDocument(e){return new Wn(e,0,pt.min(),pt.min(),pt.min(),ss.empty(),0)}static newFoundDocument(e,r,n,i){return new Wn(e,1,r,pt.min(),n,i,0)}static newNoDocument(e,r){return new Wn(e,2,r,pt.min(),pt.min(),ss.empty(),0)}static newUnknownDocument(e,r){return new Wn(e,3,r,pt.min(),pt.min(),ss.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(pt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ss.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ss.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=pt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Wn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Wn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yh{constructor(e,r){this.position=e,this.inclusive=r}}function sE(t,e,r){let n=0;for(let i=0;i<t.position.length;i++){const s=e[i],a=t.position[i];if(s.field.isKeyField()?n=nt.comparator(nt.fromName(a.referenceValue),r.key):n=eu(a,r.data.field(s.field)),s.dir==="desc"&&(n*=-1),n!==0)break}return n}function aE(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!ra(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qh{constructor(e,r="asc"){this.field=e,this.dir=r}}function Hj(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zk{}class Jr extends zk{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new Gj(e,r,n):r==="array-contains"?new Yj(e,n):r==="in"?new qj(e,n):r==="not-in"?new Qj(e,n):r==="array-contains-any"?new Jj(e,n):new Jr(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new Kj(e,n):new Xj(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&this.matchesComparison(eu(r,this.value)):r!==null&&Nl(this.value)===Nl(r)&&this.matchesComparison(eu(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return dt()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class na extends zk{constructor(e,r){super(),this.filters=e,this.op=r,this.ae=null}static create(e,r){return new na(e,r)}matches(e){return Wk(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function Wk(t){return t.op==="and"}function Hk(t){return $j(t)&&Wk(t)}function $j(t){for(const e of t.filters)if(e instanceof na)return!1;return!0}function hx(t){if(t instanceof Jr)return t.field.canonicalString()+t.op.toString()+tu(t.value);if(Hk(t))return t.filters.map(e=>hx(e)).join(",");{const e=t.filters.map(r=>hx(r)).join(",");return`${t.op}(${e})`}}function $k(t,e){return t instanceof Jr?function(n,i){return i instanceof Jr&&n.op===i.op&&n.field.isEqual(i.field)&&ra(n.value,i.value)}(t,e):t instanceof na?function(n,i){return i instanceof na&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((s,a,o)=>s&&$k(a,i.filters[o]),!0):!1}(t,e):void dt()}function Gk(t){return t instanceof Jr?function(r){return`${r.field.canonicalString()} ${r.op} ${tu(r.value)}`}(t):t instanceof na?function(r){return r.op.toString()+" {"+r.getFilters().map(Gk).join(" ,")+"}"}(t):"Filter"}class Gj extends Jr{constructor(e,r,n){super(e,r,n),this.key=nt.fromName(n.referenceValue)}matches(e){const r=nt.comparator(e.key,this.key);return this.matchesComparison(r)}}class Kj extends Jr{constructor(e,r){super(e,"in",r),this.keys=Kk("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class Xj extends Jr{constructor(e,r){super(e,"not-in",r),this.keys=Kk("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function Kk(t,e){var r;return(((r=e.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(n=>nt.fromName(n.referenceValue))}class Yj extends Jr{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return mv(r)&&n0(r.arrayValue,this.value)}}class qj extends Jr{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&n0(this.value.arrayValue,r)}}class Qj extends Jr{constructor(e,r){super(e,"not-in",r)}matches(e){if(n0(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&!n0(this.value.arrayValue,r)}}class Jj extends Jr{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!mv(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>n0(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zj{constructor(e,r=null,n=[],i=[],s=null,a=null,o=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=i,this.limit=s,this.startAt=a,this.endAt=o,this.ue=null}}function oE(t,e=null,r=[],n=[],i=null,s=null,a=null){return new Zj(t,e,r,n,i,s,a)}function xv(t){const e=gt(t);if(e.ue===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>hx(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(s){return s.field.canonicalString()+s.dir}(n)).join(","),Pp(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>tu(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>tu(n)).join(",")),e.ue=r}return e.ue}function vv(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!Hj(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!$k(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!aE(t.startAt,e.startAt)&&aE(t.endAt,e.endAt)}function px(t){return nt.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Op{constructor(e,r=null,n=[],i=[],s=null,a="F",o=null,l=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=i,this.limit=s,this.limitType=a,this.startAt=o,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function e7(t,e,r,n,i,s,a,o){return new Op(t,e,r,n,i,s,a,o)}function Mp(t){return new Op(t)}function lE(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function t7(t){return t.collectionGroup!==null}function vf(t){const e=gt(t);if(e.ce===null){e.ce=[];const r=new Set;for(const s of e.explicitOrderBy)e.ce.push(s),r.add(s.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let o=new In(Cn.comparator);return a.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(o=o.add(c.field))})}),o})(e).forEach(s=>{r.has(s.canonicalString())||s.isKeyField()||e.ce.push(new qh(s,n))}),r.has(Cn.keyField().canonicalString())||e.ce.push(new qh(Cn.keyField(),n))}return e.ce}function Js(t){const e=gt(t);return e.le||(e.le=r7(e,vf(t))),e.le}function r7(t,e){if(t.limitType==="F")return oE(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new qh(i.field,s)});const r=t.endAt?new Yh(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new Yh(t.startAt.position,t.startAt.inclusive):null;return oE(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function gx(t,e,r){return new Op(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function Lp(t,e){return vv(Js(t),Js(e))&&t.limitType===e.limitType}function Xk(t){return`${xv(Js(t))}|lt:${t.limitType}`}function cc(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(i=>Gk(i)).join(", ")}]`),Pp(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(i=>tu(i)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(i=>tu(i)).join(",")),`Target(${n})`}(Js(t))}; limitType=${t.limitType})`}function Bp(t,e){return e.isFoundDocument()&&function(n,i){const s=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):nt.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)}(t,e)&&function(n,i){for(const s of vf(n))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(n,i){for(const s of n.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(n,i){return!(n.startAt&&!function(a,o,l){const c=sE(a,o,l);return a.inclusive?c<=0:c<0}(n.startAt,vf(n),i)||n.endAt&&!function(a,o,l){const c=sE(a,o,l);return a.inclusive?c>=0:c>0}(n.endAt,vf(n),i))}(t,e)}function n7(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function Yk(t){return(e,r)=>{let n=!1;for(const i of vf(t)){const s=i7(i,e,r);if(s!==0)return s;n=n||i.field.isKeyField()}return 0}}function i7(t,e,r){const n=t.field.isKeyField()?nt.comparator(e.key,r.key):function(s,a,o){const l=a.data.field(s),c=o.data.field(s);return l!==null&&c!==null?eu(l,c):dt()}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return dt()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mu{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[i,s]of n)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,r]);i.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[r]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){gu(this.inner,(r,n)=>{for(const[i,s]of n)e(i,s)})}isEmpty(){return jk(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s7=new Cr(nt.comparator);function Ma(){return s7}const qk=new Cr(nt.comparator);function qu(...t){let e=qk;for(const r of t)e=e.insert(r.key,r);return e}function Qk(t){let e=qk;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function cl(){return yf()}function Jk(){return yf()}function yf(){return new mu(t=>t.toString(),(t,e)=>t.isEqual(e))}const a7=new Cr(nt.comparator),o7=new In(nt.comparator);function At(...t){let e=o7;for(const r of t)e=e.add(r);return e}const l7=new In(Bt);function c7(){return l7}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yv(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Xh(e)?"-0":e}}function Zk(t){return{integerValue:""+t}}function u7(t,e){return jj(e)?Zk(e):yv(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jp{constructor(){this._=void 0}}function f7(t,e,r){return t instanceof Qh?function(i,s){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&pv(s)&&(s=gv(s)),s&&(a.fields.__previous_value__=s),{mapValue:a}}(r,e):t instanceof i0?tC(t,e):t instanceof s0?rC(t,e):function(i,s){const a=eC(i,s),o=cE(a)+cE(i.Pe);return dx(a)&&dx(i.Pe)?Zk(o):yv(i.serializer,o)}(t,e)}function d7(t,e,r){return t instanceof i0?tC(t,e):t instanceof s0?rC(t,e):r}function eC(t,e){return t instanceof Jh?function(n){return dx(n)||function(s){return!!s&&"doubleValue"in s}(n)}(e)?e:{integerValue:0}:null}class Qh extends jp{}class i0 extends jp{constructor(e){super(),this.elements=e}}function tC(t,e){const r=nC(e);for(const n of t.elements)r.some(i=>ra(i,n))||r.push(n);return{arrayValue:{values:r}}}class s0 extends jp{constructor(e){super(),this.elements=e}}function rC(t,e){let r=nC(e);for(const n of t.elements)r=r.filter(i=>!ra(i,n));return{arrayValue:{values:r}}}class Jh extends jp{constructor(e,r){super(),this.serializer=e,this.Pe=r}}function cE(t){return Or(t.integerValue||t.doubleValue)}function nC(t){return mv(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function h7(t,e){return t.field.isEqual(e.field)&&function(n,i){return n instanceof i0&&i instanceof i0||n instanceof s0&&i instanceof s0?Zc(n.elements,i.elements,ra):n instanceof Jh&&i instanceof Jh?ra(n.Pe,i.Pe):n instanceof Qh&&i instanceof Qh}(t.transform,e.transform)}class p7{constructor(e,r){this.version=e,this.transformResults=r}}class Fa{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new Fa}static exists(e){return new Fa(void 0,e)}static updateTime(e){return new Fa(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function th(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Vp{}function iC(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new aC(t.key,Fa.none()):new k0(t.key,t.data,Fa.none());{const r=t.data,n=ss.empty();let i=new In(Cn.comparator);for(let s of e.fields)if(!i.has(s)){let a=r.field(s);a===null&&s.length>1&&(s=s.popLast(),a=r.field(s)),a===null?n.delete(s):n.set(s,a),i=i.add(s)}return new zl(t.key,n,new Cs(i.toArray()),Fa.none())}}function g7(t,e,r){t instanceof k0?function(i,s,a){const o=i.value.clone(),l=fE(i.fieldTransforms,s,a.transformResults);o.setAll(l),s.convertToFoundDocument(a.version,o).setHasCommittedMutations()}(t,e,r):t instanceof zl?function(i,s,a){if(!th(i.precondition,s))return void s.convertToUnknownDocument(a.version);const o=fE(i.fieldTransforms,s,a.transformResults),l=s.data;l.setAll(sC(i)),l.setAll(o),s.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(t,e,r):function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,r)}function _f(t,e,r,n){return t instanceof k0?function(s,a,o,l){if(!th(s.precondition,a))return o;const c=s.value.clone(),d=dE(s.fieldTransforms,l,a);return c.setAll(d),a.convertToFoundDocument(a.version,c).setHasLocalMutations(),null}(t,e,r,n):t instanceof zl?function(s,a,o,l){if(!th(s.precondition,a))return o;const c=dE(s.fieldTransforms,l,a),d=a.data;return d.setAll(sC(s)),d.setAll(c),a.convertToFoundDocument(a.version,d).setHasLocalMutations(),o===null?null:o.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(h=>h.field))}(t,e,r,n):function(s,a,o){return th(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):o}(t,e,r)}function m7(t,e){let r=null;for(const n of t.fieldTransforms){const i=e.data.field(n.field),s=eC(n.transform,i||null);s!=null&&(r===null&&(r=ss.empty()),r.set(n.field,s))}return r||null}function uE(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&Zc(n,i,(s,a)=>h7(s,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class k0 extends Vp{constructor(e,r,n,i=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class zl extends Vp{constructor(e,r,n,i,s=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function sC(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function fE(t,e,r){const n=new Map;Xt(t.length===r.length);for(let i=0;i<r.length;i++){const s=t[i],a=s.transform,o=e.data.field(s.field);n.set(s.field,d7(a,o,r[i]))}return n}function dE(t,e,r){const n=new Map;for(const i of t){const s=i.transform,a=r.data.field(i.field);n.set(i.field,f7(s,a,e))}return n}class aC extends Vp{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class x7 extends Vp{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v7{constructor(e,r,n,i){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&g7(s,e,n[i])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=_f(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=_f(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=Jk();return this.mutations.forEach(i=>{const s=e.get(i.key),a=s.overlayedDocument;let o=this.applyToLocalView(a,s.mutatedFields);o=r.has(i.key)?null:o;const l=iC(a,o);l!==null&&n.set(i.key,l),a.isValidDocument()||a.convertToNoDocument(pt.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),At())}isEqual(e){return this.batchId===e.batchId&&Zc(this.mutations,e.mutations,(r,n)=>uE(r,n))&&Zc(this.baseMutations,e.baseMutations,(r,n)=>uE(r,n))}}class _v{constructor(e,r,n,i){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=i}static from(e,r,n){Xt(e.mutations.length===n.length);let i=function(){return a7}();const s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,n[a].version);return new _v(e,r,n,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y7{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _7{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ur,It;function E7(t){switch(t){default:return dt();case Re.CANCELLED:case Re.UNKNOWN:case Re.DEADLINE_EXCEEDED:case Re.RESOURCE_EXHAUSTED:case Re.INTERNAL:case Re.UNAVAILABLE:case Re.UNAUTHENTICATED:return!1;case Re.INVALID_ARGUMENT:case Re.NOT_FOUND:case Re.ALREADY_EXISTS:case Re.PERMISSION_DENIED:case Re.FAILED_PRECONDITION:case Re.ABORTED:case Re.OUT_OF_RANGE:case Re.UNIMPLEMENTED:case Re.DATA_LOSS:return!0}}function oC(t){if(t===void 0)return Oa("GRPC error has no .code"),Re.UNKNOWN;switch(t){case Ur.OK:return Re.OK;case Ur.CANCELLED:return Re.CANCELLED;case Ur.UNKNOWN:return Re.UNKNOWN;case Ur.DEADLINE_EXCEEDED:return Re.DEADLINE_EXCEEDED;case Ur.RESOURCE_EXHAUSTED:return Re.RESOURCE_EXHAUSTED;case Ur.INTERNAL:return Re.INTERNAL;case Ur.UNAVAILABLE:return Re.UNAVAILABLE;case Ur.UNAUTHENTICATED:return Re.UNAUTHENTICATED;case Ur.INVALID_ARGUMENT:return Re.INVALID_ARGUMENT;case Ur.NOT_FOUND:return Re.NOT_FOUND;case Ur.ALREADY_EXISTS:return Re.ALREADY_EXISTS;case Ur.PERMISSION_DENIED:return Re.PERMISSION_DENIED;case Ur.FAILED_PRECONDITION:return Re.FAILED_PRECONDITION;case Ur.ABORTED:return Re.ABORTED;case Ur.OUT_OF_RANGE:return Re.OUT_OF_RANGE;case Ur.UNIMPLEMENTED:return Re.UNIMPLEMENTED;case Ur.DATA_LOSS:return Re.DATA_LOSS;default:return dt()}}(It=Ur||(Ur={}))[It.OK=0]="OK",It[It.CANCELLED=1]="CANCELLED",It[It.UNKNOWN=2]="UNKNOWN",It[It.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",It[It.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",It[It.NOT_FOUND=5]="NOT_FOUND",It[It.ALREADY_EXISTS=6]="ALREADY_EXISTS",It[It.PERMISSION_DENIED=7]="PERMISSION_DENIED",It[It.UNAUTHENTICATED=16]="UNAUTHENTICATED",It[It.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",It[It.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",It[It.ABORTED=10]="ABORTED",It[It.OUT_OF_RANGE=11]="OUT_OF_RANGE",It[It.UNIMPLEMENTED=12]="UNIMPLEMENTED",It[It.INTERNAL=13]="INTERNAL",It[It.UNAVAILABLE=14]="UNAVAILABLE",It[It.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w7(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T7=new ml([4294967295,4294967295],0);function hE(t){const e=w7().encode(t),r=new Rk;return r.update(e),new Uint8Array(r.digest())}function pE(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new ml([r,n],0),new ml([i,s],0)]}class Ev{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new Qu(`Invalid padding: ${r}`);if(n<0)throw new Qu(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Qu(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new Qu(`Invalid padding when bitmap length is 0: ${r}`);this.Ie=8*e.length-r,this.Te=ml.fromNumber(this.Ie)}Ee(e,r,n){let i=e.add(r.multiply(ml.fromNumber(n)));return i.compare(T7)===1&&(i=new ml([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const r=hE(e),[n,i]=pE(r);for(let s=0;s<this.hashCount;s++){const a=this.Ee(n,i,s);if(!this.de(a))return!1}return!0}static create(e,r,n){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new Ev(s,i,r);return n.forEach(o=>a.insert(o)),a}insert(e){if(this.Ie===0)return;const r=hE(e),[n,i]=pE(r);for(let s=0;s<this.hashCount;s++){const a=this.Ee(n,i,s);this.Ae(a)}}Ae(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class Qu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Up{constructor(e,r,n,i,s){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const i=new Map;return i.set(e,C0.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new Up(pt.min(),i,new Cr(Bt),Ma(),At())}}class C0{constructor(e,r,n,i,s){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new C0(n,r,At(),At(),At())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rh{constructor(e,r,n,i){this.Re=e,this.removedTargetIds=r,this.key=n,this.Ve=i}}class lC{constructor(e,r){this.targetId=e,this.me=r}}class cC{constructor(e,r,n=Rn.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=i}}class gE{constructor(){this.fe=0,this.ge=xE(),this.pe=Rn.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=At(),r=At(),n=At();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:r=r.add(i);break;case 1:n=n.add(i);break;default:dt()}}),new C0(this.pe,this.ye,e,r,n)}Ce(){this.we=!1,this.ge=xE()}Fe(e,r){this.we=!0,this.ge=this.ge.insert(e,r)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Xt(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class S7{constructor(e){this.Le=e,this.Be=new Map,this.ke=Ma(),this.qe=mE(),this.Qe=new Cr(Bt)}Ke(e){for(const r of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(r,e.Ve):this.Ue(r,e.key,e.Ve);for(const r of e.removedTargetIds)this.Ue(r,e.key,e.Ve)}We(e){this.forEachTarget(e,r=>{const n=this.Ge(r);switch(e.state){case 0:this.ze(r)&&n.De(e.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(e.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(r);break;case 3:this.ze(r)&&(n.Ne(),n.De(e.resumeToken));break;case 4:this.ze(r)&&(this.je(r),n.De(e.resumeToken));break;default:dt()}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.Be.forEach((n,i)=>{this.ze(i)&&r(i)})}He(e){const r=e.targetId,n=e.me.count,i=this.Je(r);if(i){const s=i.target;if(px(s))if(n===0){const a=new nt(s.path);this.Ue(r,a,Wn.newNoDocument(a,pt.min()))}else Xt(n===1);else{const a=this.Ye(r);if(a!==n){const o=this.Ze(e),l=o?this.Xe(o,e,a):1;if(l!==0){this.je(r);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(r,c)}}}}}Ze(e){const r=e.me.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:s=0}=r;let a,o;try{a=Rl(n).toUint8Array()}catch(l){if(l instanceof Vk)return Jc("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{o=new Ev(a,i,s)}catch(l){return Jc(l instanceof Qu?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return o.Ie===0?null:o}Xe(e,r,n){return r.me.count===n-this.nt(e,r.targetId)?0:2}nt(e,r){const n=this.Le.getRemoteKeysForTarget(r);let i=0;return n.forEach(s=>{const a=this.Le.tt(),o=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(o)||(this.Ue(r,s,null),i++)}),i}rt(e){const r=new Map;this.Be.forEach((s,a)=>{const o=this.Je(a);if(o){if(s.current&&px(o.target)){const l=new nt(o.target.path);this.ke.get(l)!==null||this.it(a,l)||this.Ue(a,l,Wn.newNoDocument(l,e))}s.be&&(r.set(a,s.ve()),s.Ce())}});let n=At();this.qe.forEach((s,a)=>{let o=!0;a.forEachWhile(l=>{const c=this.Je(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)}),o&&(n=n.add(s))}),this.ke.forEach((s,a)=>a.setReadTime(e));const i=new Up(e,r,this.Qe,this.ke,n);return this.ke=Ma(),this.qe=mE(),this.Qe=new Cr(Bt),i}$e(e,r){if(!this.ze(e))return;const n=this.it(e,r.key)?2:0;this.Ge(e).Fe(r.key,n),this.ke=this.ke.insert(r.key,r),this.qe=this.qe.insert(r.key,this.st(r.key).add(e))}Ue(e,r,n){if(!this.ze(e))return;const i=this.Ge(e);this.it(e,r)?i.Fe(r,1):i.Me(r),this.qe=this.qe.insert(r,this.st(r).delete(e)),n&&(this.ke=this.ke.insert(r,n))}removeTarget(e){this.Be.delete(e)}Ye(e){const r=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let r=this.Be.get(e);return r||(r=new gE,this.Be.set(e,r)),r}st(e){let r=this.qe.get(e);return r||(r=new In(Bt),this.qe=this.qe.insert(e,r)),r}ze(e){const r=this.Je(e)!==null;return r||et("WatchChangeAggregator","Detected inactive target",e),r}Je(e){const r=this.Be.get(e);return r&&r.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new gE),this.Le.getRemoteKeysForTarget(e).forEach(r=>{this.Ue(e,r,null)})}it(e,r){return this.Le.getRemoteKeysForTarget(e).has(r)}}function mE(){return new Cr(nt.comparator)}function xE(){return new Cr(nt.comparator)}const A7={asc:"ASCENDING",desc:"DESCENDING"},k7={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},C7={and:"AND",or:"OR"};class F7{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function mx(t,e){return t.useProto3Json||Pp(e)?e:{value:e}}function Zh(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function uC(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function I7(t,e){return Zh(t,e.toTimestamp())}function Zs(t){return Xt(!!t),pt.fromTimestamp(function(r){const n=Bo(r);return new en(n.seconds,n.nanos)}(t))}function wv(t,e){return xx(t,e).canonicalString()}function xx(t,e){const r=function(i){return new Rr(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?r:r.child(e)}function fC(t){const e=Rr.fromString(t);return Xt(mC(e)),e}function vx(t,e){return wv(t.databaseId,e.path)}function Kg(t,e){const r=fC(e);if(r.get(1)!==t.databaseId.projectId)throw new rt(Re.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new rt(Re.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new nt(hC(r))}function dC(t,e){return wv(t.databaseId,e)}function b7(t){const e=fC(t);return e.length===4?Rr.emptyPath():hC(e)}function yx(t){return new Rr(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function hC(t){return Xt(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function vE(t,e,r){return{name:vx(t,e),fields:r.value.mapValue.fields}}function R7(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:dt()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(c,d){return c.useProto3Json?(Xt(d===void 0||typeof d=="string"),Rn.fromBase64String(d||"")):(Xt(d===void 0||d instanceof Buffer||d instanceof Uint8Array),Rn.fromUint8Array(d||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,o=a&&function(c){const d=c.code===void 0?Re.UNKNOWN:oC(c.code);return new rt(d,c.message||"")}(a);r=new cC(n,i,s,o||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const i=Kg(t,n.document.name),s=Zs(n.document.updateTime),a=n.document.createTime?Zs(n.document.createTime):pt.min(),o=new ss({mapValue:{fields:n.document.fields}}),l=Wn.newFoundDocument(i,s,a,o),c=n.targetIds||[],d=n.removedTargetIds||[];r=new rh(c,d,l.key,l)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const i=Kg(t,n.document),s=n.readTime?Zs(n.readTime):pt.min(),a=Wn.newNoDocument(i,s),o=n.removedTargetIds||[];r=new rh([],o,a.key,a)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const i=Kg(t,n.document),s=n.removedTargetIds||[];r=new rh([],s,i,null)}else{if(!("filter"in e))return dt();{e.filter;const n=e.filter;n.targetId;const{count:i=0,unchangedNames:s}=n,a=new _7(i,s),o=n.targetId;r=new lC(o,a)}}return r}function N7(t,e){let r;if(e instanceof k0)r={update:vE(t,e.key,e.value)};else if(e instanceof aC)r={delete:vx(t,e.key)};else if(e instanceof zl)r={update:vE(t,e.key,e.data),updateMask:U7(e.fieldMask)};else{if(!(e instanceof x7))return dt();r={verify:vx(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(s,a){const o=a.transform;if(o instanceof Qh)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof i0)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof s0)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof Jh)return{fieldPath:a.field.canonicalString(),increment:o.Pe};throw dt()}(0,n))),e.precondition.isNone||(r.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:I7(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:dt()}(t,e.precondition)),r}function D7(t,e){return t&&t.length>0?(Xt(e!==void 0),t.map(r=>function(i,s){let a=i.updateTime?Zs(i.updateTime):Zs(s);return a.isEqual(pt.min())&&(a=Zs(s)),new p7(a,i.transformResults||[])}(r,e))):[]}function P7(t,e){return{documents:[dC(t,e.path)]}}function O7(t,e){const r={structuredQuery:{}},n=e.path;let i;e.collectionGroup!==null?(i=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=dC(t,i);const s=function(c){if(c.length!==0)return gC(na.create(c,"and"))}(e.filters);s&&(r.structuredQuery.where=s);const a=function(c){if(c.length!==0)return c.map(d=>function(p){return{field:uc(p.field),direction:B7(p.dir)}}(d))}(e.orderBy);a&&(r.structuredQuery.orderBy=a);const o=mx(t,e.limit);return o!==null&&(r.structuredQuery.limit=o),e.startAt&&(r.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{_t:r,parent:i}}function M7(t){let e=b7(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let i=null;if(n>0){Xt(n===1);const d=r.from[0];d.allDescendants?i=d.collectionId:e=e.child(d.collectionId)}let s=[];r.where&&(s=function(h){const p=pC(h);return p instanceof na&&Hk(p)?p.getFilters():[p]}(r.where));let a=[];r.orderBy&&(a=function(h){return h.map(p=>function(y){return new qh(fc(y.field),function(E){switch(E){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(y.direction))}(p))}(r.orderBy));let o=null;r.limit&&(o=function(h){let p;return p=typeof h=="object"?h.value:h,Pp(p)?null:p}(r.limit));let l=null;r.startAt&&(l=function(h){const p=!!h.before,m=h.values||[];return new Yh(m,p)}(r.startAt));let c=null;return r.endAt&&(c=function(h){const p=!h.before,m=h.values||[];return new Yh(m,p)}(r.endAt)),e7(e,i,a,s,o,"F",l,c)}function L7(t,e){const r=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return dt()}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function pC(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=fc(r.unaryFilter.field);return Jr.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=fc(r.unaryFilter.field);return Jr.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=fc(r.unaryFilter.field);return Jr.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=fc(r.unaryFilter.field);return Jr.create(a,"!=",{nullValue:"NULL_VALUE"});default:return dt()}}(t):t.fieldFilter!==void 0?function(r){return Jr.create(fc(r.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return dt()}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return na.create(r.compositeFilter.filters.map(n=>pC(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return dt()}}(r.compositeFilter.op))}(t):dt()}function B7(t){return A7[t]}function j7(t){return k7[t]}function V7(t){return C7[t]}function uc(t){return{fieldPath:t.canonicalString()}}function fc(t){return Cn.fromServerFormat(t.fieldPath)}function gC(t){return t instanceof Jr?function(r){if(r.op==="=="){if(iE(r.value))return{unaryFilter:{field:uc(r.field),op:"IS_NAN"}};if(nE(r.value))return{unaryFilter:{field:uc(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(iE(r.value))return{unaryFilter:{field:uc(r.field),op:"IS_NOT_NAN"}};if(nE(r.value))return{unaryFilter:{field:uc(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:uc(r.field),op:j7(r.op),value:r.value}}}(t):t instanceof na?function(r){const n=r.getFilters().map(i=>gC(i));return n.length===1?n[0]:{compositeFilter:{op:V7(r.op),filters:n}}}(t):dt()}function U7(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function mC(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xo{constructor(e,r,n,i,s=pt.min(),a=pt.min(),o=Rn.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=o,this.expectedCount=l}withSequenceNumber(e){return new xo(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new xo(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new xo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new xo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z7{constructor(e){this.ct=e}}function W7(t){const e=M7({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?gx(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H7{constructor(){this.un=new $7}addToCollectionParentIndex(e,r){return this.un.add(r),Ce.resolve()}getCollectionParents(e,r){return Ce.resolve(this.un.getEntries(r))}addFieldIndex(e,r){return Ce.resolve()}deleteFieldIndex(e,r){return Ce.resolve()}deleteAllFieldIndexes(e){return Ce.resolve()}createTargetIndexes(e,r){return Ce.resolve()}getDocumentsMatchingTarget(e,r){return Ce.resolve(null)}getIndexType(e,r){return Ce.resolve(0)}getFieldIndexes(e,r){return Ce.resolve([])}getNextCollectionGroupToUpdate(e){return Ce.resolve(null)}getMinOffset(e,r){return Ce.resolve(Lo.min())}getMinOffsetFromCollectionGroup(e,r){return Ce.resolve(Lo.min())}updateCollectionGroup(e,r,n){return Ce.resolve()}updateIndexEntries(e,r){return Ce.resolve()}}class $7{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r]||new In(Rr.comparator),s=!i.has(n);return this.index[r]=i.add(n),s}has(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r];return i&&i.has(n)}getEntries(e){return(this.index[e]||new In(Rr.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ru{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new ru(0)}static kn(){return new ru(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G7{constructor(){this.changes=new mu(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,Wn.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?Ce.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K7{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X7{constructor(e,r,n,i){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,r))).next(i=>(n!==null&&_f(n.mutation,i,Cs.empty(),en.now()),i))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,At()).next(()=>n))}getLocalViewOfDocuments(e,r,n=At()){const i=cl();return this.populateOverlays(e,i,r).next(()=>this.computeViews(e,r,i,n).next(s=>{let a=qu();return s.forEach((o,l)=>{a=a.insert(o,l.overlayedDocument)}),a}))}getOverlayedDocuments(e,r){const n=cl();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,At()))}populateOverlays(e,r,n){const i=[];return n.forEach(s=>{r.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((a,o)=>{r.set(a,o)})})}computeViews(e,r,n,i){let s=Ma();const a=yf(),o=function(){return yf()}();return r.forEach((l,c)=>{const d=n.get(c.key);i.has(c.key)&&(d===void 0||d.mutation instanceof zl)?s=s.insert(c.key,c):d!==void 0?(a.set(c.key,d.mutation.getFieldMask()),_f(d.mutation,c,d.mutation.getFieldMask(),en.now())):a.set(c.key,Cs.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((c,d)=>a.set(c,d)),r.forEach((c,d)=>{var h;return o.set(c,new K7(d,(h=a.get(c))!==null&&h!==void 0?h:null))}),o))}recalculateAndSaveOverlays(e,r){const n=yf();let i=new Cr((a,o)=>a-o),s=At();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(a=>{for(const o of a)o.keys().forEach(l=>{const c=r.get(l);if(c===null)return;let d=n.get(l)||Cs.empty();d=o.applyToLocalView(c,d),n.set(l,d);const h=(i.get(o.batchId)||At()).add(l);i=i.insert(o.batchId,h)})}).next(()=>{const a=[],o=i.getReverseIterator();for(;o.hasNext();){const l=o.getNext(),c=l.key,d=l.value,h=Jk();d.forEach(p=>{if(!s.has(p)){const m=iC(r.get(p),n.get(p));m!==null&&h.set(p,m),s=s.add(p)}}),a.push(this.documentOverlayCache.saveOverlays(e,c,h))}return Ce.waitFor(a)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,i){return function(a){return nt.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):t7(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,i):this.getDocumentsMatchingCollectionQuery(e,r,n,i)}getNextDocuments(e,r,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,i).next(s=>{const a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,i-s.size):Ce.resolve(cl());let o=-1,l=s;return a.next(c=>Ce.forEach(c,(d,h)=>(o<h.largestBatchId&&(o=h.largestBatchId),s.get(d)?Ce.resolve():this.remoteDocumentCache.getEntry(e,d).next(p=>{l=l.insert(d,p)}))).next(()=>this.populateOverlays(e,c,s)).next(()=>this.computeViews(e,l,c,At())).next(d=>({batchId:o,changes:Qk(d)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new nt(r)).next(n=>{let i=qu();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,r,n,i){const s=r.collectionGroup;let a=qu();return this.indexManager.getCollectionParents(e,s).next(o=>Ce.forEach(o,l=>{const c=function(h,p){return new Op(p,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(r,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,c,n,i).next(d=>{d.forEach((h,p)=>{a=a.insert(h,p)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,r,n,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,s,i))).next(a=>{s.forEach((l,c)=>{const d=c.getKey();a.get(d)===null&&(a=a.insert(d,Wn.newInvalidDocument(d)))});let o=qu();return a.forEach((l,c)=>{const d=s.get(l);d!==void 0&&_f(d.mutation,c,Cs.empty(),en.now()),Bp(r,c)&&(o=o.insert(l,c))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y7{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,r){return Ce.resolve(this.hr.get(r))}saveBundleMetadata(e,r){return this.hr.set(r.id,function(i){return{id:i.id,version:i.version,createTime:Zs(i.createTime)}}(r)),Ce.resolve()}getNamedQuery(e,r){return Ce.resolve(this.Pr.get(r))}saveNamedQuery(e,r){return this.Pr.set(r.name,function(i){return{name:i.name,query:W7(i.bundledQuery),readTime:Zs(i.readTime)}}(r)),Ce.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q7{constructor(){this.overlays=new Cr(nt.comparator),this.Ir=new Map}getOverlay(e,r){return Ce.resolve(this.overlays.get(r))}getOverlays(e,r){const n=cl();return Ce.forEach(r,i=>this.getOverlay(e,i).next(s=>{s!==null&&n.set(i,s)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((i,s)=>{this.ht(e,r,s)}),Ce.resolve()}removeOverlaysForBatchId(e,r,n){const i=this.Ir.get(n);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(n)),Ce.resolve()}getOverlaysForCollection(e,r,n){const i=cl(),s=r.length+1,a=new nt(r.child("")),o=this.overlays.getIteratorFrom(a);for(;o.hasNext();){const l=o.getNext().value,c=l.getKey();if(!r.isPrefixOf(c.path))break;c.path.length===s&&l.largestBatchId>n&&i.set(l.getKey(),l)}return Ce.resolve(i)}getOverlaysForCollectionGroup(e,r,n,i){let s=new Cr((c,d)=>c-d);const a=this.overlays.getIterator();for(;a.hasNext();){const c=a.getNext().value;if(c.getKey().getCollectionGroup()===r&&c.largestBatchId>n){let d=s.get(c.largestBatchId);d===null&&(d=cl(),s=s.insert(c.largestBatchId,d)),d.set(c.getKey(),c)}}const o=cl(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,d)=>o.set(c,d)),!(o.size()>=i)););return Ce.resolve(o)}ht(e,r,n){const i=this.overlays.get(n.key);if(i!==null){const a=this.Ir.get(i.largestBatchId).delete(n.key);this.Ir.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(n.key,new y7(r,n));let s=this.Ir.get(r);s===void 0&&(s=At(),this.Ir.set(r,s)),this.Ir.set(r,s.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q7{constructor(){this.sessionToken=Rn.EMPTY_BYTE_STRING}getSessionToken(e){return Ce.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,Ce.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tv{constructor(){this.Tr=new In(ln.Er),this.dr=new In(ln.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,r){const n=new ln(e,r);this.Tr=this.Tr.add(n),this.dr=this.dr.add(n)}Rr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Vr(new ln(e,r))}mr(e,r){e.forEach(n=>this.removeReference(n,r))}gr(e){const r=new nt(new Rr([])),n=new ln(r,e),i=new ln(r,e+1),s=[];return this.dr.forEachInRange([n,i],a=>{this.Vr(a),s.push(a.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const r=new nt(new Rr([])),n=new ln(r,e),i=new ln(r,e+1);let s=At();return this.dr.forEachInRange([n,i],a=>{s=s.add(a.key)}),s}containsKey(e){const r=new ln(e,0),n=this.Tr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class ln{constructor(e,r){this.key=e,this.wr=r}static Er(e,r){return nt.comparator(e.key,r.key)||Bt(e.wr,r.wr)}static Ar(e,r){return Bt(e.wr,r.wr)||nt.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J7{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.Sr=1,this.br=new In(ln.Er)}checkEmpty(e){return Ce.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,i){const s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new v7(s,r,n,i);this.mutationQueue.push(a);for(const o of i)this.br=this.br.add(new ln(o.key,s)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return Ce.resolve(a)}lookupMutationBatch(e,r){return Ce.resolve(this.Dr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,i=this.vr(n),s=i<0?0:i;return Ce.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return Ce.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return Ce.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new ln(r,0),i=new ln(r,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([n,i],a=>{const o=this.Dr(a.wr);s.push(o)}),Ce.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new In(Bt);return r.forEach(i=>{const s=new ln(i,0),a=new ln(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,a],o=>{n=n.add(o.wr)})}),Ce.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,i=n.length+1;let s=n;nt.isDocumentKey(s)||(s=s.child(""));const a=new ln(new nt(s),0);let o=new In(Bt);return this.br.forEachWhile(l=>{const c=l.key.path;return!!n.isPrefixOf(c)&&(c.length===i&&(o=o.add(l.wr)),!0)},a),Ce.resolve(this.Cr(o))}Cr(e){const r=[];return e.forEach(n=>{const i=this.Dr(n);i!==null&&r.push(i)}),r}removeMutationBatch(e,r){Xt(this.Fr(r.batchId,"removed")===0),this.mutationQueue.shift();let n=this.br;return Ce.forEach(r.mutations,i=>{const s=new ln(i.key,r.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=n})}On(e){}containsKey(e,r){const n=new ln(r,0),i=this.br.firstAfterOrEqual(n);return Ce.resolve(r.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,Ce.resolve()}Fr(e,r){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const r=this.vr(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z7{constructor(e){this.Mr=e,this.docs=function(){return new Cr(nt.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,i=this.docs.get(n),s=i?i.size:0,a=this.Mr(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return Ce.resolve(n?n.document.mutableCopy():Wn.newInvalidDocument(r))}getEntries(e,r){let n=Ma();return r.forEach(i=>{const s=this.docs.get(i);n=n.insert(i,s?s.document.mutableCopy():Wn.newInvalidDocument(i))}),Ce.resolve(n)}getDocumentsMatchingQuery(e,r,n,i){let s=Ma();const a=r.path,o=new nt(a.child("")),l=this.docs.getIteratorFrom(o);for(;l.hasNext();){const{key:c,value:{document:d}}=l.getNext();if(!a.isPrefixOf(c.path))break;c.path.length>a.length+1||Oj(Pj(d),n)<=0||(i.has(d.key)||Bp(r,d))&&(s=s.insert(d.key,d.mutableCopy()))}return Ce.resolve(s)}getAllFromCollectionGroup(e,r,n,i){dt()}Or(e,r){return Ce.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new eV(this)}getSize(e){return Ce.resolve(this.size)}}class eV extends G7{constructor(e){super(),this.cr=e}applyChanges(e){const r=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?r.push(this.cr.addEntry(e,i)):this.cr.removeEntry(n)}),Ce.waitFor(r)}getFromCache(e,r){return this.cr.getEntry(e,r)}getAllFromCache(e,r){return this.cr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tV{constructor(e){this.persistence=e,this.Nr=new mu(r=>xv(r),vv),this.lastRemoteSnapshotVersion=pt.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Tv,this.targetCount=0,this.kr=ru.Bn()}forEachTarget(e,r){return this.Nr.forEach((n,i)=>r(i)),Ce.resolve()}getLastRemoteSnapshotVersion(e){return Ce.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Ce.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),Ce.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.Lr&&(this.Lr=r),Ce.resolve()}Kn(e){this.Nr.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.kr=new ru(r),this.highestTargetId=r),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,r){return this.Kn(r),this.targetCount+=1,Ce.resolve()}updateTargetData(e,r){return this.Kn(r),Ce.resolve()}removeTargetData(e,r){return this.Nr.delete(r.target),this.Br.gr(r.targetId),this.targetCount-=1,Ce.resolve()}removeTargets(e,r,n){let i=0;const s=[];return this.Nr.forEach((a,o)=>{o.sequenceNumber<=r&&n.get(o.targetId)===null&&(this.Nr.delete(a),s.push(this.removeMatchingKeysForTargetId(e,o.targetId)),i++)}),Ce.waitFor(s).next(()=>i)}getTargetCount(e){return Ce.resolve(this.targetCount)}getTargetData(e,r){const n=this.Nr.get(r)||null;return Ce.resolve(n)}addMatchingKeys(e,r,n){return this.Br.Rr(r,n),Ce.resolve()}removeMatchingKeys(e,r,n){this.Br.mr(r,n);const i=this.persistence.referenceDelegate,s=[];return i&&r.forEach(a=>{s.push(i.markPotentiallyOrphaned(e,a))}),Ce.waitFor(s)}removeMatchingKeysForTargetId(e,r){return this.Br.gr(r),Ce.resolve()}getMatchingKeysForTargetId(e,r){const n=this.Br.yr(r);return Ce.resolve(n)}containsKey(e,r){return Ce.resolve(this.Br.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rV{constructor(e,r){this.qr={},this.overlays={},this.Qr=new hv(0),this.Kr=!1,this.Kr=!0,this.$r=new Q7,this.referenceDelegate=e(this),this.Ur=new tV(this),this.indexManager=new H7,this.remoteDocumentCache=function(i){return new Z7(i)}(n=>this.referenceDelegate.Wr(n)),this.serializer=new z7(r),this.Gr=new Y7(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new q7,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.qr[e.toKey()];return n||(n=new J7(r,this.referenceDelegate),this.qr[e.toKey()]=n),n}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,r,n){et("MemoryPersistence","Starting transaction:",e);const i=new nV(this.Qr.next());return this.referenceDelegate.zr(),n(i).next(s=>this.referenceDelegate.jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Hr(e,r){return Ce.or(Object.values(this.qr).map(n=>()=>n.containsKey(e,r)))}}class nV extends Lj{constructor(e){super(),this.currentSequenceNumber=e}}class Sv{constructor(e){this.persistence=e,this.Jr=new Tv,this.Yr=null}static Zr(e){return new Sv(e)}get Xr(){if(this.Yr)return this.Yr;throw dt()}addReference(e,r,n){return this.Jr.addReference(n,r),this.Xr.delete(n.toString()),Ce.resolve()}removeReference(e,r,n){return this.Jr.removeReference(n,r),this.Xr.add(n.toString()),Ce.resolve()}markPotentiallyOrphaned(e,r){return this.Xr.add(r.toString()),Ce.resolve()}removeTarget(e,r){this.Jr.gr(r.targetId).forEach(i=>this.Xr.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(i=>{i.forEach(s=>this.Xr.add(s.toString()))}).next(()=>n.removeTargetData(e,r))}zr(){this.Yr=new Set}jr(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Ce.forEach(this.Xr,n=>{const i=nt.fromPath(n);return this.ei(e,i).next(s=>{s||r.removeEntry(i,pt.min())})}).next(()=>(this.Yr=null,r.apply(e)))}updateLimboDocument(e,r){return this.ei(e,r).next(n=>{n?this.Xr.delete(r.toString()):this.Xr.add(r.toString())})}Wr(e){return 0}ei(e,r){return Ce.or([()=>Ce.resolve(this.Jr.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Hr(e,r)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Av{constructor(e,r,n,i){this.targetId=e,this.fromCache=r,this.$i=n,this.Ui=i}static Wi(e,r){let n=At(),i=At();for(const s of r.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new Av(e,r.fromCache,n,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iV{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sV{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return s9()?8:Bj(Xn())>0?6:4}()}initialize(e,r){this.Ji=e,this.indexManager=r,this.Gi=!0}getDocumentsMatchingQuery(e,r,n,i){const s={result:null};return this.Yi(e,r).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.Zi(e,r,i,n).next(a=>{s.result=a})}).next(()=>{if(s.result)return;const a=new iV;return this.Xi(e,r,a).next(o=>{if(s.result=o,this.zi)return this.es(e,r,a,o.size)})}).next(()=>s.result)}es(e,r,n,i){return n.documentReadCount<this.ji?(Uu()<=Ct.DEBUG&&et("QueryEngine","SDK will not create cache indexes for query:",cc(r),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),Ce.resolve()):(Uu()<=Ct.DEBUG&&et("QueryEngine","Query:",cc(r),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.Hi*i?(Uu()<=Ct.DEBUG&&et("QueryEngine","The SDK decides to create cache indexes for query:",cc(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Js(r))):Ce.resolve())}Yi(e,r){if(lE(r))return Ce.resolve(null);let n=Js(r);return this.indexManager.getIndexType(e,n).next(i=>i===0?null:(r.limit!==null&&i===1&&(r=gx(r,null,"F"),n=Js(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(s=>{const a=At(...s);return this.Ji.getDocuments(e,a).next(o=>this.indexManager.getMinOffset(e,n).next(l=>{const c=this.ts(r,o);return this.ns(r,c,a,l.readTime)?this.Yi(e,gx(r,null,"F")):this.rs(e,c,r,l)}))})))}Zi(e,r,n,i){return lE(r)||i.isEqual(pt.min())?Ce.resolve(null):this.Ji.getDocuments(e,n).next(s=>{const a=this.ts(r,s);return this.ns(r,a,n,i)?Ce.resolve(null):(Uu()<=Ct.DEBUG&&et("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),cc(r)),this.rs(e,a,r,Dj(i,-1)).next(o=>o))})}ts(e,r){let n=new In(Yk(e));return r.forEach((i,s)=>{Bp(e,s)&&(n=n.add(s))}),n}ns(e,r,n,i){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const s=e.limitType==="F"?r.last():r.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Xi(e,r,n){return Uu()<=Ct.DEBUG&&et("QueryEngine","Using full collection scan to execute query:",cc(r)),this.Ji.getDocumentsMatchingQuery(e,r,Lo.min(),n)}rs(e,r,n,i){return this.Ji.getDocumentsMatchingQuery(e,n,i).next(s=>(r.forEach(a=>{s=s.insert(a.key,a)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aV{constructor(e,r,n,i){this.persistence=e,this.ss=r,this.serializer=i,this.os=new Cr(Bt),this._s=new mu(s=>xv(s),vv),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(n)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new X7(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.os))}}function oV(t,e,r,n){return new aV(t,e,r,n)}async function xC(t,e){const r=gt(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let i;return r.mutationQueue.getAllMutationBatches(n).next(s=>(i=s,r.ls(e),r.mutationQueue.getAllMutationBatches(n))).next(s=>{const a=[],o=[];let l=At();for(const c of i){a.push(c.batchId);for(const d of c.mutations)l=l.add(d.key)}for(const c of s){o.push(c.batchId);for(const d of c.mutations)l=l.add(d.key)}return r.localDocuments.getDocuments(n,l).next(c=>({hs:c,removedBatchIds:a,addedBatchIds:o}))})})}function lV(t,e){const r=gt(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=e.batch.keys(),s=r.cs.newChangeBuffer({trackRemovals:!0});return function(o,l,c,d){const h=c.batch,p=h.keys();let m=Ce.resolve();return p.forEach(y=>{m=m.next(()=>d.getEntry(l,y)).next(x=>{const E=c.docVersions.get(y);Xt(E!==null),x.version.compareTo(E)<0&&(h.applyToRemoteDocument(x,c),x.isValidDocument()&&(x.setReadTime(c.commitVersion),d.addEntry(x)))})}),m.next(()=>o.mutationQueue.removeMutationBatch(l,h))}(r,n,e,s).next(()=>s.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(o){let l=At();for(let c=0;c<o.mutationResults.length;++c)o.mutationResults[c].transformResults.length>0&&(l=l.add(o.batch.mutations[c].key));return l}(e))).next(()=>r.localDocuments.getDocuments(n,i))})}function vC(t){const e=gt(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Ur.getLastRemoteSnapshotVersion(r))}function cV(t,e){const r=gt(t),n=e.snapshotVersion;let i=r.os;return r.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const a=r.cs.newChangeBuffer({trackRemovals:!0});i=r.os;const o=[];e.targetChanges.forEach((d,h)=>{const p=i.get(h);if(!p)return;o.push(r.Ur.removeMatchingKeys(s,d.removedDocuments,h).next(()=>r.Ur.addMatchingKeys(s,d.addedDocuments,h)));let m=p.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(h)!==null?m=m.withResumeToken(Rn.EMPTY_BYTE_STRING,pt.min()).withLastLimboFreeSnapshotVersion(pt.min()):d.resumeToken.approximateByteSize()>0&&(m=m.withResumeToken(d.resumeToken,n)),i=i.insert(h,m),function(x,E,T){return x.resumeToken.approximateByteSize()===0||E.snapshotVersion.toMicroseconds()-x.snapshotVersion.toMicroseconds()>=3e8?!0:T.addedDocuments.size+T.modifiedDocuments.size+T.removedDocuments.size>0}(p,m,d)&&o.push(r.Ur.updateTargetData(s,m))});let l=Ma(),c=At();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&o.push(r.persistence.referenceDelegate.updateLimboDocument(s,d))}),o.push(uV(s,a,e.documentUpdates).next(d=>{l=d.Ps,c=d.Is})),!n.isEqual(pt.min())){const d=r.Ur.getLastRemoteSnapshotVersion(s).next(h=>r.Ur.setTargetsMetadata(s,s.currentSequenceNumber,n));o.push(d)}return Ce.waitFor(o).next(()=>a.apply(s)).next(()=>r.localDocuments.getLocalViewOfDocuments(s,l,c)).next(()=>l)}).then(s=>(r.os=i,s))}function uV(t,e,r){let n=At(),i=At();return r.forEach(s=>n=n.add(s)),e.getEntries(t,n).next(s=>{let a=Ma();return r.forEach((o,l)=>{const c=s.get(o);l.isFoundDocument()!==c.isFoundDocument()&&(i=i.add(o)),l.isNoDocument()&&l.version.isEqual(pt.min())?(e.removeEntry(o,l.readTime),a=a.insert(o,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),a=a.insert(o,l)):et("LocalStore","Ignoring outdated watch update for ",o,". Current version:",c.version," Watch version:",l.version)}),{Ps:a,Is:i}})}function fV(t,e){const r=gt(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=-1),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function dV(t,e){const r=gt(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return r.Ur.getTargetData(n,e).next(s=>s?(i=s,Ce.resolve(i)):r.Ur.allocateTargetId(n).next(a=>(i=new xo(e,a,"TargetPurposeListen",n.currentSequenceNumber),r.Ur.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=r.os.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(r.os=r.os.insert(n.targetId,n),r._s.set(e,n.targetId)),n})}async function _x(t,e,r){const n=gt(t),i=n.os.get(e),s=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",s,a=>n.persistence.referenceDelegate.removeTarget(a,i))}catch(a){if(!A0(a))throw a;et("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}n.os=n.os.remove(e),n._s.delete(i.target)}function yE(t,e,r){const n=gt(t);let i=pt.min(),s=At();return n.persistence.runTransaction("Execute query","readwrite",a=>function(l,c,d){const h=gt(l),p=h._s.get(d);return p!==void 0?Ce.resolve(h.os.get(p)):h.Ur.getTargetData(c,d)}(n,a,Js(e)).next(o=>{if(o)return i=o.lastLimboFreeSnapshotVersion,n.Ur.getMatchingKeysForTargetId(a,o.targetId).next(l=>{s=l})}).next(()=>n.ss.getDocumentsMatchingQuery(a,e,r?i:pt.min(),r?s:At())).next(o=>(hV(n,n7(e),o),{documents:o,Ts:s})))}function hV(t,e,r){let n=t.us.get(e)||pt.min();r.forEach((i,s)=>{s.readTime.compareTo(n)>0&&(n=s.readTime)}),t.us.set(e,n)}class _E{constructor(){this.activeTargetIds=c7()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class pV{constructor(){this.so=new _E,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,r,n){this.oo[e]=r}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new _E,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gV{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EE{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){et("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){et("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ld=null;function Xg(){return Ld===null?Ld=function(){return 268435456+Math.round(2147483648*Math.random())}():Ld++,"0x"+Ld.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mV={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xV{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ln="WebChannelConnection";class vV extends class{constructor(r){this.databaseInfo=r,this.databaseId=r.databaseId;const n=r.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=n+"://"+r.host,this.vo=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Fo(){return!1}Mo(r,n,i,s,a){const o=Xg(),l=this.xo(r,n.toUriEncodedString());et("RestConnection",`Sending RPC '${r}' ${o}:`,l,i);const c={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(c,s,a),this.No(r,l,c,i).then(d=>(et("RestConnection",`Received RPC '${r}' ${o}: `,d),d),d=>{throw Jc("RestConnection",`RPC '${r}' ${o} failed with error: `,d,"url: ",l,"request:",i),d})}Lo(r,n,i,s,a,o){return this.Mo(r,n,i,s,a)}Oo(r,n,i){r["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+pu}(),r["Content-Type"]="text/plain",this.databaseInfo.appId&&(r["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,a)=>r[a]=s),i&&i.headers.forEach((s,a)=>r[a]=s)}xo(r,n){const i=mV[r];return`${this.Do}/v1/${n}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,r,n,i){const s=Xg();return new Promise((a,o)=>{const l=new Nk;l.setWithCredentials(!0),l.listenOnce(Dk.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case Zd.NO_ERROR:const d=l.getResponseJson();et(Ln,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(d)),a(d);break;case Zd.TIMEOUT:et(Ln,`RPC '${e}' ${s} timed out`),o(new rt(Re.DEADLINE_EXCEEDED,"Request time out"));break;case Zd.HTTP_ERROR:const h=l.getStatus();if(et(Ln,`RPC '${e}' ${s} failed with status:`,h,"response text:",l.getResponseText()),h>0){let p=l.getResponseJson();Array.isArray(p)&&(p=p[0]);const m=p==null?void 0:p.error;if(m&&m.status&&m.message){const y=function(E){const T=E.toLowerCase().replace(/_/g,"-");return Object.values(Re).indexOf(T)>=0?T:Re.UNKNOWN}(m.status);o(new rt(y,m.message))}else o(new rt(Re.UNKNOWN,"Server responded with status "+l.getStatus()))}else o(new rt(Re.UNAVAILABLE,"Connection failed."));break;default:dt()}}finally{et(Ln,`RPC '${e}' ${s} completed.`)}});const c=JSON.stringify(i);et(Ln,`RPC '${e}' ${s} sending request:`,i),l.send(r,"POST",c,n,15)})}Bo(e,r,n){const i=Xg(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=Mk(),o=Ok(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Oo(l.initMessageHeaders,r,n),l.encodeInitMessageHeaders=!0;const d=s.join("");et(Ln,`Creating RPC '${e}' stream ${i}: ${d}`,l);const h=a.createWebChannel(d,l);let p=!1,m=!1;const y=new xV({Io:E=>{m?et(Ln,`Not sending because RPC '${e}' stream ${i} is closed:`,E):(p||(et(Ln,`Opening RPC '${e}' stream ${i} transport.`),h.open(),p=!0),et(Ln,`RPC '${e}' stream ${i} sending:`,E),h.send(E))},To:()=>h.close()}),x=(E,T,A)=>{E.listen(T,_=>{try{A(_)}catch(P){setTimeout(()=>{throw P},0)}})};return x(h,Yu.EventType.OPEN,()=>{m||(et(Ln,`RPC '${e}' stream ${i} transport opened.`),y.yo())}),x(h,Yu.EventType.CLOSE,()=>{m||(m=!0,et(Ln,`RPC '${e}' stream ${i} transport closed`),y.So())}),x(h,Yu.EventType.ERROR,E=>{m||(m=!0,Jc(Ln,`RPC '${e}' stream ${i} transport errored:`,E),y.So(new rt(Re.UNAVAILABLE,"The operation could not be completed")))}),x(h,Yu.EventType.MESSAGE,E=>{var T;if(!m){const A=E.data[0];Xt(!!A);const _=A,P=_.error||((T=_[0])===null||T===void 0?void 0:T.error);if(P){et(Ln,`RPC '${e}' stream ${i} received error:`,P);const W=P.status;let B=function(S){const b=Ur[S];if(b!==void 0)return oC(b)}(W),w=P.message;B===void 0&&(B=Re.INTERNAL,w="Unknown error status: "+W+" with message "+P.message),m=!0,y.So(new rt(B,w)),h.close()}else et(Ln,`RPC '${e}' stream ${i} received:`,A),y.bo(A)}}),x(o,Pk.STAT_EVENT,E=>{E.stat===ux.PROXY?et(Ln,`RPC '${e}' stream ${i} detected buffering proxy`):E.stat===ux.NOPROXY&&et(Ln,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{y.wo()},0),y}}function Yg(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zp(t){return new F7(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yC{constructor(e,r,n=1e3,i=1.5,s=6e4){this.ui=e,this.timerId=r,this.ko=n,this.qo=i,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const r=Math.floor(this.Ko+this.zo()),n=Math.max(0,Date.now()-this.Uo),i=Math.max(0,r-n);i>0&&et("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _C{constructor(e,r,n,i,s,a,o,l){this.ui=e,this.Ho=n,this.Jo=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=o,this.listener=l,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new yC(e,r)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,r){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():r&&r.code===Re.RESOURCE_EXHAUSTED?(Oa(r.toString()),Oa("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):r&&r.code===Re.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(r)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),r=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.Yo===r&&this.P_(n,i)},n=>{e(()=>{const i=new rt(Re.UNKNOWN,"Fetching auth token failed: "+n.message);return this.I_(i)})})}P_(e,r){const n=this.h_(this.Yo);this.stream=this.T_(e,r),this.stream.Eo(()=>{n(()=>this.listener.Eo())}),this.stream.Ro(()=>{n(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{n(()=>this.I_(i))}),this.stream.onMessage(i=>{n(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return et("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return r=>{this.ui.enqueueAndForget(()=>this.Yo===e?r():(et("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class yV extends _C{constructor(e,r,n,i,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,i,a),this.serializer=s}T_(e,r){return this.connection.Bo("Listen",e,r)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const r=R7(this.serializer,e),n=function(s){if(!("targetChange"in s))return pt.min();const a=s.targetChange;return a.targetIds&&a.targetIds.length?pt.min():a.readTime?Zs(a.readTime):pt.min()}(e);return this.listener.d_(r,n)}A_(e){const r={};r.database=yx(this.serializer),r.addTarget=function(s,a){let o;const l=a.target;if(o=px(l)?{documents:P7(s,l)}:{query:O7(s,l)._t},o.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){o.resumeToken=uC(s,a.resumeToken);const c=mx(s,a.expectedCount);c!==null&&(o.expectedCount=c)}else if(a.snapshotVersion.compareTo(pt.min())>0){o.readTime=Zh(s,a.snapshotVersion.toTimestamp());const c=mx(s,a.expectedCount);c!==null&&(o.expectedCount=c)}return o}(this.serializer,e);const n=L7(this.serializer,e);n&&(r.labels=n),this.a_(r)}R_(e){const r={};r.database=yx(this.serializer),r.removeTarget=e,this.a_(r)}}class _V extends _C{constructor(e,r,n,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,i,a),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,r){return this.connection.Bo("Write",e,r)}E_(e){return Xt(!!e.streamToken),this.lastStreamToken=e.streamToken,Xt(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){Xt(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const r=D7(e.writeResults,e.commitTime),n=Zs(e.commitTime);return this.listener.g_(n,r)}p_(){const e={};e.database=yx(this.serializer),this.a_(e)}m_(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>N7(this.serializer,n))};this.a_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EV extends class{}{constructor(e,r,n,i){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new rt(Re.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,r,n,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Mo(e,xx(r,n),i,s,a)).catch(s=>{throw s.name==="FirebaseError"?(s.code===Re.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new rt(Re.UNKNOWN,s.toString())})}Lo(e,r,n,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,o])=>this.connection.Lo(e,xx(r,n),i,a,o,s)).catch(a=>{throw a.name==="FirebaseError"?(a.code===Re.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new rt(Re.UNKNOWN,a.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class wV{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Oa(r),this.D_=!1):et("OnlineStateTracker",r)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TV{constructor(e,r,n,i,s){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(a=>{n.enqueueAndForget(async()=>{Wl(this)&&(et("RemoteStore","Restarting streams for network reachability change."),await async function(l){const c=gt(l);c.L_.add(4),await F0(c),c.q_.set("Unknown"),c.L_.delete(4),await Wp(c)}(this))})}),this.q_=new wV(n,i)}}async function Wp(t){if(Wl(t))for(const e of t.B_)await e(!0)}async function F0(t){for(const e of t.B_)await e(!1)}function EC(t,e){const r=gt(t);r.N_.has(e.targetId)||(r.N_.set(e.targetId,e),Iv(r)?Fv(r):xu(r).r_()&&Cv(r,e))}function kv(t,e){const r=gt(t),n=xu(r);r.N_.delete(e),n.r_()&&wC(r,e),r.N_.size===0&&(n.r_()?n.o_():Wl(r)&&r.q_.set("Unknown"))}function Cv(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(pt.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}xu(t).A_(e)}function wC(t,e){t.Q_.xe(e),xu(t).R_(e)}function Fv(t){t.Q_=new S7({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),xu(t).start(),t.q_.v_()}function Iv(t){return Wl(t)&&!xu(t).n_()&&t.N_.size>0}function Wl(t){return gt(t).L_.size===0}function TC(t){t.Q_=void 0}async function SV(t){t.q_.set("Online")}async function AV(t){t.N_.forEach((e,r)=>{Cv(t,e)})}async function kV(t,e){TC(t),Iv(t)?(t.q_.M_(e),Fv(t)):t.q_.set("Unknown")}async function CV(t,e,r){if(t.q_.set("Online"),e instanceof cC&&e.state===2&&e.cause)try{await async function(i,s){const a=s.cause;for(const o of s.targetIds)i.N_.has(o)&&(await i.remoteSyncer.rejectListen(o,a),i.N_.delete(o),i.Q_.removeTarget(o))}(t,e)}catch(n){et("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),await ep(t,n)}else if(e instanceof rh?t.Q_.Ke(e):e instanceof lC?t.Q_.He(e):t.Q_.We(e),!r.isEqual(pt.min()))try{const n=await vC(t.localStore);r.compareTo(n)>=0&&await function(s,a){const o=s.Q_.rt(a);return o.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const d=s.N_.get(c);d&&s.N_.set(c,d.withResumeToken(l.resumeToken,a))}}),o.targetMismatches.forEach((l,c)=>{const d=s.N_.get(l);if(!d)return;s.N_.set(l,d.withResumeToken(Rn.EMPTY_BYTE_STRING,d.snapshotVersion)),wC(s,l);const h=new xo(d.target,l,c,d.sequenceNumber);Cv(s,h)}),s.remoteSyncer.applyRemoteEvent(o)}(t,r)}catch(n){et("RemoteStore","Failed to raise snapshot:",n),await ep(t,n)}}async function ep(t,e,r){if(!A0(e))throw e;t.L_.add(1),await F0(t),t.q_.set("Offline"),r||(r=()=>vC(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{et("RemoteStore","Retrying IndexedDB access"),await r(),t.L_.delete(1),await Wp(t)})}function SC(t,e){return e().catch(r=>ep(t,r,e))}async function Hp(t){const e=gt(t),r=jo(e);let n=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;FV(e);)try{const i=await fV(e.localStore,n);if(i===null){e.O_.length===0&&r.o_();break}n=i.batchId,IV(e,i)}catch(i){await ep(e,i)}AC(e)&&kC(e)}function FV(t){return Wl(t)&&t.O_.length<10}function IV(t,e){t.O_.push(e);const r=jo(t);r.r_()&&r.V_&&r.m_(e.mutations)}function AC(t){return Wl(t)&&!jo(t).n_()&&t.O_.length>0}function kC(t){jo(t).start()}async function bV(t){jo(t).p_()}async function RV(t){const e=jo(t);for(const r of t.O_)e.m_(r.mutations)}async function NV(t,e,r){const n=t.O_.shift(),i=_v.from(n,e,r);await SC(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await Hp(t)}async function DV(t,e){e&&jo(t).V_&&await async function(n,i){if(function(a){return E7(a)&&a!==Re.ABORTED}(i.code)){const s=n.O_.shift();jo(n).s_(),await SC(n,()=>n.remoteSyncer.rejectFailedWrite(s.batchId,i)),await Hp(n)}}(t,e),AC(t)&&kC(t)}async function wE(t,e){const r=gt(t);r.asyncQueue.verifyOperationInProgress(),et("RemoteStore","RemoteStore received new credentials");const n=Wl(r);r.L_.add(3),await F0(r),n&&r.q_.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.L_.delete(3),await Wp(r)}async function PV(t,e){const r=gt(t);e?(r.L_.delete(2),await Wp(r)):e||(r.L_.add(2),await F0(r),r.q_.set("Unknown"))}function xu(t){return t.K_||(t.K_=function(r,n,i){const s=gt(r);return s.w_(),new yV(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:SV.bind(null,t),Ro:AV.bind(null,t),mo:kV.bind(null,t),d_:CV.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),Iv(t)?Fv(t):t.q_.set("Unknown")):(await t.K_.stop(),TC(t))})),t.K_}function jo(t){return t.U_||(t.U_=function(r,n,i){const s=gt(r);return s.w_(),new _V(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:bV.bind(null,t),mo:DV.bind(null,t),f_:RV.bind(null,t),g_:NV.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await Hp(t)):(await t.U_.stop(),t.O_.length>0&&(et("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bv{constructor(e,r,n,i,s){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=i,this.removalCallback=s,this.deferred=new Io,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,i,s){const a=Date.now()+n,o=new bv(e,r,a,i,s);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new rt(Re.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Rv(t,e){if(Oa("AsyncQueue",`${e}: ${t}`),A0(t))return new rt(Re.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lc{constructor(e){this.comparator=e?(r,n)=>e(r,n)||nt.comparator(r.key,n.key):(r,n)=>nt.comparator(r.key,n.key),this.keyedMap=qu(),this.sortedSet=new Cr(this.comparator)}static emptySet(e){return new Lc(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof Lc)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const i=r.getNext().key,s=n.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new Lc;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TE{constructor(){this.W_=new Cr(nt.comparator)}track(e){const r=e.doc.key,n=this.W_.get(r);n?e.type!==0&&n.type===3?this.W_=this.W_.insert(r,e):e.type===3&&n.type!==1?this.W_=this.W_.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.W_=this.W_.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.W_=this.W_.remove(r):e.type===1&&n.type===2?this.W_=this.W_.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):dt():this.W_=this.W_.insert(r,e)}G_(){const e=[];return this.W_.inorderTraversal((r,n)=>{e.push(n)}),e}}class nu{constructor(e,r,n,i,s,a,o,l,c){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=o,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,r,n,i,s){const a=[];return r.forEach(o=>{a.push({type:0,doc:o})}),new nu(e,r,Lc.emptySet(r),a,n,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Lp(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let i=0;i<r.length;i++)if(r[i].type!==n[i].type||!r[i].doc.isEqual(n[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OV{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class MV{constructor(){this.queries=SE(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(r,n){const i=gt(r),s=i.queries;i.queries=SE(),s.forEach((a,o)=>{for(const l of o.j_)l.onError(n)})})(this,new rt(Re.ABORTED,"Firestore shutting down"))}}function SE(){return new mu(t=>Xk(t),Lp)}async function CC(t,e){const r=gt(t);let n=3;const i=e.query;let s=r.queries.get(i);s?!s.H_()&&e.J_()&&(n=2):(s=new OV,n=e.J_()?0:1);try{switch(n){case 0:s.z_=await r.onListen(i,!0);break;case 1:s.z_=await r.onListen(i,!1);break;case 2:await r.onFirstRemoteStoreListen(i)}}catch(a){const o=Rv(a,`Initialization of query '${cc(e.query)}' failed`);return void e.onError(o)}r.queries.set(i,s),s.j_.push(e),e.Z_(r.onlineState),s.z_&&e.X_(s.z_)&&Nv(r)}async function FC(t,e){const r=gt(t),n=e.query;let i=3;const s=r.queries.get(n);if(s){const a=s.j_.indexOf(e);a>=0&&(s.j_.splice(a,1),s.j_.length===0?i=e.J_()?0:1:!s.H_()&&e.J_()&&(i=2))}switch(i){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function LV(t,e){const r=gt(t);let n=!1;for(const i of e){const s=i.query,a=r.queries.get(s);if(a){for(const o of a.j_)o.X_(i)&&(n=!0);a.z_=i}}n&&Nv(r)}function BV(t,e,r){const n=gt(t),i=n.queries.get(e);if(i)for(const s of i.j_)s.onError(r);n.queries.delete(e)}function Nv(t){t.Y_.forEach(e=>{e.next()})}var Ex,AE;(AE=Ex||(Ex={})).ea="default",AE.Cache="cache";class IC{constructor(e,r,n){this.query=e,this.ta=r,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=n||{}}X_(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)i.type!==3&&n.push(i);e=new nu(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.na?this.ia(e)&&(this.ta.next(e),r=!0):this.sa(e,this.onlineState)&&(this.oa(e),r=!0),this.ra=e,r}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let r=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),r=!0),r}sa(e,r){if(!e.fromCache||!this.J_())return!0;const n=r!=="Offline";return(!this.options._a||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const r=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}oa(e){e=nu.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Ex.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bC{constructor(e){this.key=e}}class RC{constructor(e){this.key=e}}class jV{constructor(e,r){this.query=e,this.Ta=r,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=At(),this.mutatedKeys=At(),this.Aa=Yk(e),this.Ra=new Lc(this.Aa)}get Va(){return this.Ta}ma(e,r){const n=r?r.fa:new TE,i=r?r.Ra:this.Ra;let s=r?r.mutatedKeys:this.mutatedKeys,a=i,o=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,c=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((d,h)=>{const p=i.get(d),m=Bp(this.query,h)?h:null,y=!!p&&this.mutatedKeys.has(p.key),x=!!m&&(m.hasLocalMutations||this.mutatedKeys.has(m.key)&&m.hasCommittedMutations);let E=!1;p&&m?p.data.isEqual(m.data)?y!==x&&(n.track({type:3,doc:m}),E=!0):this.ga(p,m)||(n.track({type:2,doc:m}),E=!0,(l&&this.Aa(m,l)>0||c&&this.Aa(m,c)<0)&&(o=!0)):!p&&m?(n.track({type:0,doc:m}),E=!0):p&&!m&&(n.track({type:1,doc:p}),E=!0,(l||c)&&(o=!0)),E&&(m?(a=a.add(m),s=x?s.add(d):s.delete(d)):(a=a.delete(d),s=s.delete(d)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const d=this.query.limitType==="F"?a.last():a.first();a=a.delete(d.key),s=s.delete(d.key),n.track({type:1,doc:d})}return{Ra:a,fa:n,ns:o,mutatedKeys:s}}ga(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,i){const s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const a=e.fa.G_();a.sort((d,h)=>function(m,y){const x=E=>{switch(E){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return dt()}};return x(m)-x(y)}(d.type,h.type)||this.Aa(d.doc,h.doc)),this.pa(n),i=i!=null&&i;const o=r&&!i?this.ya():[],l=this.da.size===0&&this.current&&!i?1:0,c=l!==this.Ea;return this.Ea=l,a.length!==0||c?{snapshot:new nu(this.query,e.Ra,s,a,e.mutatedKeys,l===0,c,!1,!!n&&n.resumeToken.approximateByteSize()>0),wa:o}:{wa:o}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new TE,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(r=>this.Ta=this.Ta.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ta=this.Ta.delete(r)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=At(),this.Ra.forEach(n=>{this.Sa(n.key)&&(this.da=this.da.add(n.key))});const r=[];return e.forEach(n=>{this.da.has(n)||r.push(new RC(n))}),this.da.forEach(n=>{e.has(n)||r.push(new bC(n))}),r}ba(e){this.Ta=e.Ts,this.da=At();const r=this.ma(e.documents);return this.applyChanges(r,!0)}Da(){return nu.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class VV{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class UV{constructor(e){this.key=e,this.va=!1}}class zV{constructor(e,r,n,i,s,a){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Ca={},this.Fa=new mu(o=>Xk(o),Lp),this.Ma=new Map,this.xa=new Set,this.Oa=new Cr(nt.comparator),this.Na=new Map,this.La=new Tv,this.Ba={},this.ka=new Map,this.qa=ru.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function WV(t,e,r=!0){const n=LC(t);let i;const s=n.Fa.get(e);return s?(n.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=await NC(n,e,r,!0),i}async function HV(t,e){const r=LC(t);await NC(r,e,!0,!1)}async function NC(t,e,r,n){const i=await dV(t.localStore,Js(e)),s=i.targetId,a=t.sharedClientState.addLocalQueryTarget(s,r);let o;return n&&(o=await $V(t,e,s,a==="current",i.resumeToken)),t.isPrimaryClient&&r&&EC(t.remoteStore,i),o}async function $V(t,e,r,n,i){t.Ka=(h,p,m)=>async function(x,E,T,A){let _=E.view.ma(T);_.ns&&(_=await yE(x.localStore,E.query,!1).then(({documents:w})=>E.view.ma(w,_)));const P=A&&A.targetChanges.get(E.targetId),W=A&&A.targetMismatches.get(E.targetId)!=null,B=E.view.applyChanges(_,x.isPrimaryClient,P,W);return CE(x,E.targetId,B.wa),B.snapshot}(t,h,p,m);const s=await yE(t.localStore,e,!0),a=new jV(e,s.Ts),o=a.ma(s.documents),l=C0.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",i),c=a.applyChanges(o,t.isPrimaryClient,l);CE(t,r,c.wa);const d=new VV(e,r,a);return t.Fa.set(e,d),t.Ma.has(r)?t.Ma.get(r).push(e):t.Ma.set(r,[e]),c.snapshot}async function GV(t,e,r){const n=gt(t),i=n.Fa.get(e),s=n.Ma.get(i.targetId);if(s.length>1)return n.Ma.set(i.targetId,s.filter(a=>!Lp(a,e))),void n.Fa.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await _x(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),r&&kv(n.remoteStore,i.targetId),wx(n,i.targetId)}).catch(S0)):(wx(n,i.targetId),await _x(n.localStore,i.targetId,!0))}async function KV(t,e){const r=gt(t),n=r.Fa.get(e),i=r.Ma.get(n.targetId);r.isPrimaryClient&&i.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),kv(r.remoteStore,n.targetId))}async function XV(t,e,r){const n=tU(t);try{const i=await function(a,o){const l=gt(a),c=en.now(),d=o.reduce((m,y)=>m.add(y.key),At());let h,p;return l.persistence.runTransaction("Locally write mutations","readwrite",m=>{let y=Ma(),x=At();return l.cs.getEntries(m,d).next(E=>{y=E,y.forEach((T,A)=>{A.isValidDocument()||(x=x.add(T))})}).next(()=>l.localDocuments.getOverlayedDocuments(m,y)).next(E=>{h=E;const T=[];for(const A of o){const _=m7(A,h.get(A.key).overlayedDocument);_!=null&&T.push(new zl(A.key,_,Uk(_.value.mapValue),Fa.exists(!0)))}return l.mutationQueue.addMutationBatch(m,c,T,o)}).next(E=>{p=E;const T=E.applyToLocalDocumentSet(h,x);return l.documentOverlayCache.saveOverlays(m,E.batchId,T)})}).then(()=>({batchId:p.batchId,changes:Qk(h)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(a,o,l){let c=a.Ba[a.currentUser.toKey()];c||(c=new Cr(Bt)),c=c.insert(o,l),a.Ba[a.currentUser.toKey()]=c}(n,i.batchId,r),await I0(n,i.changes),await Hp(n.remoteStore)}catch(i){const s=Rv(i,"Failed to persist write");r.reject(s)}}async function DC(t,e){const r=gt(t);try{const n=await cV(r.localStore,e);e.targetChanges.forEach((i,s)=>{const a=r.Na.get(s);a&&(Xt(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?a.va=!0:i.modifiedDocuments.size>0?Xt(a.va):i.removedDocuments.size>0&&(Xt(a.va),a.va=!1))}),await I0(r,n,e)}catch(n){await S0(n)}}function kE(t,e,r){const n=gt(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const i=[];n.Fa.forEach((s,a)=>{const o=a.view.Z_(e);o.snapshot&&i.push(o.snapshot)}),function(a,o){const l=gt(a);l.onlineState=o;let c=!1;l.queries.forEach((d,h)=>{for(const p of h.j_)p.Z_(o)&&(c=!0)}),c&&Nv(l)}(n.eventManager,e),i.length&&n.Ca.d_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function YV(t,e,r){const n=gt(t);n.sharedClientState.updateQueryState(e,"rejected",r);const i=n.Na.get(e),s=i&&i.key;if(s){let a=new Cr(nt.comparator);a=a.insert(s,Wn.newNoDocument(s,pt.min()));const o=At().add(s),l=new Up(pt.min(),new Map,new Cr(Bt),a,o);await DC(n,l),n.Oa=n.Oa.remove(s),n.Na.delete(e),Dv(n)}else await _x(n.localStore,e,!1).then(()=>wx(n,e,r)).catch(S0)}async function qV(t,e){const r=gt(t),n=e.batch.batchId;try{const i=await lV(r.localStore,e);OC(r,n,null),PC(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await I0(r,i)}catch(i){await S0(i)}}async function QV(t,e,r){const n=gt(t);try{const i=await function(a,o){const l=gt(a);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let d;return l.mutationQueue.lookupMutationBatch(c,o).next(h=>(Xt(h!==null),d=h.keys(),l.mutationQueue.removeMutationBatch(c,h))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,d,o)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,d)).next(()=>l.localDocuments.getDocuments(c,d))})}(n.localStore,e);OC(n,e,r),PC(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await I0(n,i)}catch(i){await S0(i)}}function PC(t,e){(t.ka.get(e)||[]).forEach(r=>{r.resolve()}),t.ka.delete(e)}function OC(t,e,r){const n=gt(t);let i=n.Ba[n.currentUser.toKey()];if(i){const s=i.get(e);s&&(r?s.reject(r):s.resolve(),i=i.remove(e)),n.Ba[n.currentUser.toKey()]=i}}function wx(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Ma.get(e))t.Fa.delete(n),r&&t.Ca.$a(n,r);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(n=>{t.La.containsKey(n)||MC(t,n)})}function MC(t,e){t.xa.delete(e.path.canonicalString());const r=t.Oa.get(e);r!==null&&(kv(t.remoteStore,r),t.Oa=t.Oa.remove(e),t.Na.delete(r),Dv(t))}function CE(t,e,r){for(const n of r)n instanceof bC?(t.La.addReference(n.key,e),JV(t,n)):n instanceof RC?(et("SyncEngine","Document no longer in limbo: "+n.key),t.La.removeReference(n.key,e),t.La.containsKey(n.key)||MC(t,n.key)):dt()}function JV(t,e){const r=e.key,n=r.path.canonicalString();t.Oa.get(r)||t.xa.has(n)||(et("SyncEngine","New document in limbo: "+r),t.xa.add(n),Dv(t))}function Dv(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const r=new nt(Rr.fromString(e)),n=t.qa.next();t.Na.set(n,new UV(r)),t.Oa=t.Oa.insert(r,n),EC(t.remoteStore,new xo(Js(Mp(r.path)),n,"TargetPurposeLimboResolution",hv.oe))}}async function I0(t,e,r){const n=gt(t),i=[],s=[],a=[];n.Fa.isEmpty()||(n.Fa.forEach((o,l)=>{a.push(n.Ka(l,e,r).then(c=>{var d;if((c||r)&&n.isPrimaryClient){const h=c?!c.fromCache:(d=r==null?void 0:r.targetChanges.get(l.targetId))===null||d===void 0?void 0:d.current;n.sharedClientState.updateQueryState(l.targetId,h?"current":"not-current")}if(c){i.push(c);const h=Av.Wi(l.targetId,c);s.push(h)}}))}),await Promise.all(a),n.Ca.d_(i),await async function(l,c){const d=gt(l);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>Ce.forEach(c,p=>Ce.forEach(p.$i,m=>d.persistence.referenceDelegate.addReference(h,p.targetId,m)).next(()=>Ce.forEach(p.Ui,m=>d.persistence.referenceDelegate.removeReference(h,p.targetId,m)))))}catch(h){if(!A0(h))throw h;et("LocalStore","Failed to update sequence numbers: "+h)}for(const h of c){const p=h.targetId;if(!h.fromCache){const m=d.os.get(p),y=m.snapshotVersion,x=m.withLastLimboFreeSnapshotVersion(y);d.os=d.os.insert(p,x)}}}(n.localStore,s))}async function ZV(t,e){const r=gt(t);if(!r.currentUser.isEqual(e)){et("SyncEngine","User change. New user:",e.toKey());const n=await xC(r.localStore,e);r.currentUser=e,function(s,a){s.ka.forEach(o=>{o.forEach(l=>{l.reject(new rt(Re.CANCELLED,a))})}),s.ka.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await I0(r,n.hs)}}function eU(t,e){const r=gt(t),n=r.Na.get(e);if(n&&n.va)return At().add(n.key);{let i=At();const s=r.Ma.get(e);if(!s)return i;for(const a of s){const o=r.Fa.get(a);i=i.unionWith(o.view.Va)}return i}}function LC(t){const e=gt(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=DC.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=eU.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=YV.bind(null,e),e.Ca.d_=LV.bind(null,e.eventManager),e.Ca.$a=BV.bind(null,e.eventManager),e}function tU(t){const e=gt(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=qV.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=QV.bind(null,e),e}class tp{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=zp(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,r){return null}Ha(e,r){return null}za(e){return oV(this.persistence,new sV,e.initialUser,this.serializer)}Ga(e){return new rV(Sv.Zr,this.serializer)}Wa(e){return new pV}async terminate(){var e,r;(e=this.gcScheduler)===null||e===void 0||e.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}tp.provider={build:()=>new tp};class Tx{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>kE(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=ZV.bind(null,this.syncEngine),await PV(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new MV}()}createDatastore(e){const r=zp(e.databaseInfo.databaseId),n=function(s){return new vV(s)}(e.databaseInfo);return function(s,a,o,l){return new EV(s,a,o,l)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,i,s,a,o){return new TV(n,i,s,a,o)}(this.localStore,this.datastore,e.asyncQueue,r=>kE(this.syncEngine,r,0),function(){return EE.D()?new EE:new gV}())}createSyncEngine(e,r){return function(i,s,a,o,l,c,d){const h=new zV(i,s,a,o,l,c);return d&&(h.Qa=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await async function(i){const s=gt(i);et("RemoteStore","RemoteStore shutting down."),s.L_.add(5),await F0(s),s.k_.shutdown(),s.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}Tx.provider={build:()=>new Tx};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BC{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Oa("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rU{constructor(e,r,n,i,s){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=i,this.user=jn.UNAUTHENTICATED,this.clientId=Bk.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(n,async a=>{et("FirestoreClient","Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(n,a=>(et("FirestoreClient","Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Io;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=Rv(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function qg(t,e){t.asyncQueue.verifyOperationInProgress(),et("FirestoreClient","Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async i=>{n.isEqual(i)||(await xC(e.localStore,i),n=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function FE(t,e){t.asyncQueue.verifyOperationInProgress();const r=await nU(t);et("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>wE(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,i)=>wE(e.remoteStore,i)),t._onlineComponents=e}async function nU(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){et("FirestoreClient","Using user provided OfflineComponentProvider");try{await qg(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(i){return i.name==="FirebaseError"?i.code===Re.FAILED_PRECONDITION||i.code===Re.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(r))throw r;Jc("Error using user provided cache. Falling back to memory cache: "+r),await qg(t,new tp)}}else et("FirestoreClient","Using default OfflineComponentProvider"),await qg(t,new tp);return t._offlineComponents}async function jC(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(et("FirestoreClient","Using user provided OnlineComponentProvider"),await FE(t,t._uninitializedComponentsProvider._online)):(et("FirestoreClient","Using default OnlineComponentProvider"),await FE(t,new Tx))),t._onlineComponents}function iU(t){return jC(t).then(e=>e.syncEngine)}async function Sx(t){const e=await jC(t),r=e.eventManager;return r.onListen=WV.bind(null,e.syncEngine),r.onUnlisten=GV.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=HV.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=KV.bind(null,e.syncEngine),r}function sU(t,e,r={}){const n=new Io;return t.asyncQueue.enqueueAndForget(async()=>function(s,a,o,l,c){const d=new BC({next:p=>{d.Za(),a.enqueueAndForget(()=>FC(s,h));const m=p.docs.has(o);!m&&p.fromCache?c.reject(new rt(Re.UNAVAILABLE,"Failed to get document because the client is offline.")):m&&p.fromCache&&l&&l.source==="server"?c.reject(new rt(Re.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(p)},error:p=>c.reject(p)}),h=new IC(Mp(o.path),d,{includeMetadataChanges:!0,_a:!0});return CC(s,h)}(await Sx(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VC(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IE=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aU(t,e,r){if(!r)throw new rt(Re.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function oU(t,e,r,n){if(e===!0&&n===!0)throw new rt(Re.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function bE(t){if(!nt.isDocumentKey(t))throw new rt(Re.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Pv(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":dt()}function bo(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new rt(Re.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=Pv(t);throw new rt(Re.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RE{constructor(e){var r,n;if(e.host===void 0){if(e.ssl!==void 0)throw new rt(Re.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(r=e.ssl)===null||r===void 0||r;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new rt(Re.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}oU("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=VC((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new rt(Re.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new rt(Re.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new rt(Re.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Ov{constructor(e,r,n,i){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new RE({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new rt(Re.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new rt(Re.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new RE(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new Sj;switch(n.type){case"firstParty":return new Fj(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new rt(Re.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=IE.get(r);n&&(et("ComponentProvider","Removing Datastore"),IE.delete(r),n.terminate())}(this),Promise.resolve()}}function lU(t,e,r,n={}){var i;const s=(t=bo(t,Ov))._getSettings(),a=`${e}:${r}`;if(s.host!=="firestore.googleapis.com"&&s.host!==a&&Jc("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:a,ssl:!1})),n.mockUserToken){let o,l;if(typeof n.mockUserToken=="string")o=n.mockUserToken,l=jn.MOCK_USER;else{o=JB(n.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);const c=n.mockUserToken.sub||n.mockUserToken.user_id;if(!c)throw new rt(Re.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new jn(c)}t._authCredentials=new Aj(new Lk(o,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $p{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new $p(this.firestore,e,this._query)}}class Vi{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new a0(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Vi(this.firestore,e,this._key)}}class a0 extends $p{constructor(e,r,n){super(e,r,Mp(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Vi(this.firestore,null,new nt(e))}withConverter(e){return new a0(this.firestore,e,this._path)}}function Mv(t,e,...r){if(t=Ds(t),arguments.length===1&&(e=Bk.newId()),aU("doc","path",e),t instanceof Ov){const n=Rr.fromString(e,...r);return bE(n),new Vi(t,null,new nt(n))}{if(!(t instanceof Vi||t instanceof a0))throw new rt(Re.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Rr.fromString(e,...r));return bE(n),new Vi(t.firestore,t instanceof a0?t.converter:null,new nt(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NE{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new yC(this,"async_queue_retry"),this.Vu=()=>{const n=Yg();n&&et("AsyncQueue","Visibility state changed to "+n.visibilityState),this.t_.jo()},this.mu=e;const r=Yg();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const r=Yg();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const r=new Io;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!A0(e))throw e;et("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const r=this.mu.then(()=>(this.du=!0,e().catch(n=>{this.Eu=n,this.du=!1;const i=function(a){let o=a.message||"";return a.stack&&(o=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),o}(n);throw Oa("INTERNAL UNHANDLED ERROR: ",i),n}).then(n=>(this.du=!1,n))));return this.mu=r,r}enqueueAfterDelay(e,r,n){this.fu(),this.Ru.indexOf(e)>-1&&(r=0);const i=bv.createAndSchedule(this,e,r,n,s=>this.yu(s));return this.Tu.push(i),i}fu(){this.Eu&&dt()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const r of this.Tu)if(r.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.Tu)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const r=this.Tu.indexOf(e);this.Tu.splice(r,1)}}function DE(t){return function(r,n){if(typeof r!="object"||r===null)return!1;const i=r;for(const s of n)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}class o0 extends Ov{constructor(e,r,n,i){super(e,r,n,i),this.type="firestore",this._queue=new NE,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new NE(e),this._firestoreClient=void 0,await e}}}function cU(t,e){const r=typeof t=="object"?t:Fk(),n=typeof t=="string"?t:"(default)",i=fv(r,"firestore").getImmediate({identifier:n});if(!i._initialized){const s=qB("firestore");s&&lU(i,...s)}return i}function Lv(t){if(t._terminated)throw new rt(Re.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||uU(t),t._firestoreClient}function uU(t){var e,r,n;const i=t._freezeSettings(),s=function(o,l,c,d){return new Uj(o,l,c,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,VC(d.experimentalLongPollingOptions),d.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._componentsProvider||!((r=i.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((n=i.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(t._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),t._firestoreClient=new rU(t._authCredentials,t._appCheckCredentials,t._queue,s,t._componentsProvider&&function(o){const l=o==null?void 0:o._online.build();return{_offline:o==null?void 0:o._offline.build(l),_online:l}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iu{constructor(e){this._byteString=e}static fromBase64String(e){try{return new iu(Rn.fromBase64String(e))}catch(r){throw new rt(Re.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new iu(Rn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bv{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new rt(Re.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Cn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UC{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jv{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new rt(Re.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new rt(Re.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Bt(this._lat,e._lat)||Bt(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vv{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,i){if(n.length!==i.length)return!1;for(let s=0;s<n.length;++s)if(n[s]!==i[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fU=/^__.*__$/;class dU{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new zl(e,this.data,this.fieldMask,r,this.fieldTransforms):new k0(e,this.data,r,this.fieldTransforms)}}function zC(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw dt()}}class Uv{constructor(e,r,n,i,s,a){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=i,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new Uv(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),i=this.Fu({path:n,xu:!1});return i.Ou(e),i}Nu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),i=this.Fu({path:n,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return rp(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(zC(this.Cu)&&fU.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class hU{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||zp(e)}Qu(e,r,n,i=!1){return new Uv({Cu:e,methodName:r,qu:n,path:Cn.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function pU(t){const e=t._freezeSettings(),r=zp(t._databaseId);return new hU(t._databaseId,!!e.ignoreUndefinedProperties,r)}function gU(t,e,r,n,i,s={}){const a=t.Qu(s.merge||s.mergeFields?2:0,e,r,i);GC("Data must be an object, but it was:",a,n);const o=HC(n,a);let l,c;if(s.merge)l=new Cs(a.fieldMask),c=a.fieldTransforms;else if(s.mergeFields){const d=[];for(const h of s.mergeFields){const p=mU(e,h,r);if(!a.contains(p))throw new rt(Re.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);vU(d,p)||d.push(p)}l=new Cs(d),c=a.fieldTransforms.filter(h=>l.covers(h.field))}else l=null,c=a.fieldTransforms;return new dU(new ss(o),l,c)}function WC(t,e){if($C(t=Ds(t)))return GC("Unsupported field value:",e,t),HC(t,e);if(t instanceof UC)return function(n,i){if(!zC(i.Cu))throw i.Bu(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${n._methodName}() is not currently supported inside arrays`);const s=n._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(n,i){const s=[];let a=0;for(const o of n){let l=WC(o,i.Lu(a));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),a++}return{arrayValue:{values:s}}}(t,e)}return function(n,i){if((n=Ds(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return u7(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const s=en.fromDate(n);return{timestampValue:Zh(i.serializer,s)}}if(n instanceof en){const s=new en(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Zh(i.serializer,s)}}if(n instanceof jv)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof iu)return{bytesValue:uC(i.serializer,n._byteString)};if(n instanceof Vi){const s=i.databaseId,a=n.firestore._databaseId;if(!a.isEqual(s))throw i.Bu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:wv(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof Vv)return function(a,o){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:a.toArray().map(l=>{if(typeof l!="number")throw o.Bu("VectorValues must only contain numeric values.");return yv(o.serializer,l)})}}}}}}(n,i);throw i.Bu(`Unsupported field value: ${Pv(n)}`)}(t,e)}function HC(t,e){const r={};return jk(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):gu(t,(n,i)=>{const s=WC(i,e.Mu(n));s!=null&&(r[n]=s)}),{mapValue:{fields:r}}}function $C(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof en||t instanceof jv||t instanceof iu||t instanceof Vi||t instanceof UC||t instanceof Vv)}function GC(t,e,r){if(!$C(r)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(r)){const n=Pv(r);throw n==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+n)}}function mU(t,e,r){if((e=Ds(e))instanceof Bv)return e._internalPath;if(typeof e=="string")return KC(t,e);throw rp("Field path arguments must be of type string or ",t,!1,void 0,r)}const xU=new RegExp("[~\\*/\\[\\]]");function KC(t,e,r){if(e.search(xU)>=0)throw rp(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new Bv(...e.split("."))._internalPath}catch{throw rp(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function rp(t,e,r,n,i){const s=n&&!n.isEmpty(),a=i!==void 0;let o=`Function ${e}() called with invalid data`;r&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(s||a)&&(l+=" (found",s&&(l+=` in field ${n}`),a&&(l+=` in document ${i}`),l+=")"),new rt(Re.INVALID_ARGUMENT,o+t+l)}function vU(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XC{constructor(e,r,n,i,s){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Vi(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new yU(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(YC("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class yU extends XC{data(){return super.data()}}function YC(t,e){return typeof e=="string"?KC(t,e):e instanceof Bv?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _U(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new rt(Re.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class EU{convertValue(e,r="none"){switch(Nl(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Or(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(Rl(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw dt()}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return gu(e,(i,s)=>{n[i]=this.convertValue(s,r)}),n}convertVectorValue(e){var r,n,i;const s=(i=(n=(r=e.fields)===null||r===void 0?void 0:r.value.arrayValue)===null||n===void 0?void 0:n.values)===null||i===void 0?void 0:i.map(a=>Or(a.doubleValue));return new Vv(s)}convertGeoPoint(e){return new jv(Or(e.latitude),Or(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=gv(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(t0(e));default:return null}}convertTimestamp(e){const r=Bo(e);return new en(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=Rr.fromString(e);Xt(mC(n));const i=new r0(n.get(1),n.get(3)),s=new nt(n.popFirst(5));return i.isEqual(r)||Oa(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wU(t,e,r){let n;return n=t?t.toFirestore(e):e,n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ju{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class qC extends XC{constructor(e,r,n,i,s,a){super(e,r,n,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new nh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(YC("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}}class nh extends qC{data(e={}){return super.data(e)}}class TU{constructor(e,r,n,i){this._firestore=e,this._userDataWriter=r,this._snapshot=i,this.metadata=new Ju(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new nh(this._firestore,this._userDataWriter,n.key,n,new Ju(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new rt(Re.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(o=>{const l=new nh(i._firestore,i._userDataWriter,o.doc.key,o.doc,new Ju(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);return o.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(o=>s||o.type!==3).map(o=>{const l=new nh(i._firestore,i._userDataWriter,o.doc.key,o.doc,new Ju(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);let c=-1,d=-1;return o.type!==0&&(c=a.indexOf(o.doc.key),a=a.delete(o.doc.key)),o.type!==1&&(a=a.add(o.doc),d=a.indexOf(o.doc.key)),{type:SU(o.type),doc:l,oldIndex:c,newIndex:d}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}}function SU(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return dt()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AU(t){t=bo(t,Vi);const e=bo(t.firestore,o0);return sU(Lv(e),t._key).then(r=>JC(e,t,r))}class QC extends EU{constructor(e){super(),this.firestore=e}convertBytes(e){return new iu(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new Vi(this.firestore,null,r)}}function kU(t,e,r){t=bo(t,Vi);const n=bo(t.firestore,o0),i=wU(t.converter,e);return FU(n,[gU(pU(n),"setDoc",t._key,i,t.converter!==null,r).toMutation(t._key,Fa.none())])}function CU(t,...e){var r,n,i;t=Ds(t);let s={includeMetadataChanges:!1,source:"default"},a=0;typeof e[a]!="object"||DE(e[a])||(s=e[a],a++);const o={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(DE(e[a])){const h=e[a];e[a]=(r=h.next)===null||r===void 0?void 0:r.bind(h),e[a+1]=(n=h.error)===null||n===void 0?void 0:n.bind(h),e[a+2]=(i=h.complete)===null||i===void 0?void 0:i.bind(h)}let l,c,d;if(t instanceof Vi)c=bo(t.firestore,o0),d=Mp(t._key.path),l={next:h=>{e[a]&&e[a](JC(c,t,h))},error:e[a+1],complete:e[a+2]};else{const h=bo(t,$p);c=bo(h.firestore,o0),d=h._query;const p=new QC(c);l={next:m=>{e[a]&&e[a](new TU(c,p,h,m))},error:e[a+1],complete:e[a+2]},_U(t._query)}return function(p,m,y,x){const E=new BC(x),T=new IC(m,E,y);return p.asyncQueue.enqueueAndForget(async()=>CC(await Sx(p),T)),()=>{E.Za(),p.asyncQueue.enqueueAndForget(async()=>FC(await Sx(p),T))}}(Lv(c),d,o,l)}function FU(t,e){return function(n,i){const s=new Io;return n.asyncQueue.enqueueAndForget(async()=>XV(await iU(n),i,s)),s.promise}(Lv(t),e)}function JC(t,e,r){const n=r.docs.get(e._key),i=new QC(t);return new qC(t,i,e._key,n,new Ju(r.hasPendingWrites,r.fromCache),e.converter)}(function(e,r=!0){(function(i){pu=i})(hu),Qc(new Il("firestore",(n,{instanceIdentifier:i,options:s})=>{const a=n.getProvider("app").getImmediate(),o=new o0(new kj(n.getProvider("auth-internal")),new bj(n.getProvider("app-check-internal")),function(c,d){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new rt(Re.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new r0(c.options.projectId,d)}(a,i),a);return s=Object.assign({useFetchStreams:r},s),o._setSettings(s),o},"PUBLIC").setMultipleInstances(!0)),Fo(J2,"4.7.3",e),Fo(J2,"4.7.3","esm2017")})();function zv(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function ZC(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const IU=ZC,e4=new w0("auth","Firebase",ZC());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const np=new cv("@firebase/auth");function bU(t,...e){np.logLevel<=Ct.WARN&&np.warn(`Auth (${hu}): ${t}`,...e)}function ih(t,...e){np.logLevel<=Ct.ERROR&&np.error(`Auth (${hu}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function La(t,...e){throw Wv(t,...e)}function ea(t,...e){return Wv(t,...e)}function t4(t,e,r){const n=Object.assign(Object.assign({},IU()),{[e]:r});return new w0("auth","Firebase",n).create(e,{appName:t.name})}function xl(t){return t4(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Wv(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return e4.create(t,...e)}function ft(t,e,...r){if(!t)throw Wv(e,...r)}function Ea(t){const e="INTERNAL ASSERTION FAILED: "+t;throw ih(e),new Error(e)}function Ba(t,e){t||Ea(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ax(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function RU(){return PE()==="http:"||PE()==="https:"}function PE(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NU(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(RU()||r9()||"connection"in navigator)?navigator.onLine:!0}function DU(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b0{constructor(e,r){this.shortDelay=e,this.longDelay=r,Ba(r>e,"Short delay should be less than long delay!"),this.isMobile=ZB()||n9()}get(){return NU()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hv(t,e){Ba(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r4{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ea("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ea("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ea("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PU={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OU=new b0(3e4,6e4);function $v(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function vu(t,e,r,n,i={}){return n4(t,i,async()=>{let s={},a={};n&&(e==="GET"?a=n:s={body:JSON.stringify(n)});const o=T0(Object.assign({key:t.config.apiKey},a)).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const c=Object.assign({method:e,headers:l},s);return t9()||(c.referrerPolicy="no-referrer"),r4.fetch()(i4(t,t.config.apiHost,r,o),c)})}async function n4(t,e,r){t._canInitEmulator=!1;const n=Object.assign(Object.assign({},PU),e);try{const i=new LU(t),s=await Promise.race([r(),i.promise]);i.clearNetworkTimeout();const a=await s.json();if("needConfirmation"in a)throw Bd(t,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{const o=s.ok?a.errorMessage:a.error.message,[l,c]=o.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Bd(t,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw Bd(t,"email-already-in-use",a);if(l==="USER_DISABLED")throw Bd(t,"user-disabled",a);const d=n[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw t4(t,d,c);La(t,d)}}catch(i){if(i instanceof Wa)throw i;La(t,"network-request-failed",{message:String(i)})}}async function MU(t,e,r,n,i={}){const s=await vu(t,e,r,n,i);return"mfaPendingCredential"in s&&La(t,"multi-factor-auth-required",{_serverResponse:s}),s}function i4(t,e,r,n){const i=`${e}${r}?${n}`;return t.config.emulator?Hv(t.config,i):`${t.config.apiScheme}://${i}`}class LU{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(ea(this.auth,"network-request-failed")),OU.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Bd(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const i=ea(t,e,n);return i.customData._tokenResponse=r,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function BU(t,e){return vu(t,"POST","/v1/accounts:delete",e)}async function s4(t,e){return vu(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ef(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function jU(t,e=!1){const r=Ds(t),n=await r.getIdToken(e),i=Gv(n);ft(i&&i.exp&&i.auth_time&&i.iat,r.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,a=s==null?void 0:s.sign_in_provider;return{claims:i,token:n,authTime:Ef(Qg(i.auth_time)),issuedAtTime:Ef(Qg(i.iat)),expirationTime:Ef(Qg(i.exp)),signInProvider:a||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function Qg(t){return Number(t)*1e3}function Gv(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return ih("JWT malformed, contained fewer than 3 sections"),null;try{const i=Ek(r);return i?JSON.parse(i):(ih("Failed to decode base64 JWT payload"),null)}catch(i){return ih("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function OE(t){const e=Gv(t);return ft(e,"internal-error"),ft(typeof e.exp<"u","internal-error"),ft(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function l0(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof Wa&&VU(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function VU({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UU{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var r;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const i=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kx{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=Ef(this.lastLoginAt),this.creationTime=Ef(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ip(t){var e;const r=t.auth,n=await t.getIdToken(),i=await l0(t,s4(r,{idToken:n}));ft(i==null?void 0:i.users.length,r,"internal-error");const s=i.users[0];t._notifyReloadListener(s);const a=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?a4(s.providerUserInfo):[],o=WU(t.providerData,a),l=t.isAnonymous,c=!(t.email&&s.passwordHash)&&!(o!=null&&o.length),d=l?c:!1,h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new kx(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(t,h)}async function zU(t){const e=Ds(t);await ip(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function WU(t,e){return[...t.filter(n=>!e.some(i=>i.providerId===n.providerId)),...e]}function a4(t){return t.map(e=>{var{providerId:r}=e,n=zv(e,["providerId"]);return{providerId:r,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function HU(t,e){const r=await n4(t,{},async()=>{const n=T0({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,a=i4(t,i,"/v1/token",`key=${s}`),o=await t._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",r4.fetch()(a,{method:"POST",headers:o,body:n})});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function $U(t,e){return vu(t,"POST","/v2/accounts:revokeToken",$v(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bc{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ft(e.idToken,"internal-error"),ft(typeof e.idToken<"u","internal-error"),ft(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):OE(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){ft(e.length!==0,"internal-error");const r=OE(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(ft(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:i,expiresIn:s}=await HU(e,r);this.updateTokensAndExpiration(n,i,Number(s))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:i,expirationTime:s}=r,a=new Bc;return n&&(ft(typeof n=="string","internal-error",{appName:e}),a.refreshToken=n),i&&(ft(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),s&&(ft(typeof s=="number","internal-error",{appName:e}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Bc,this.toJSON())}_performRefresh(){return Ea("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ro(t,e){ft(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class wa{constructor(e){var{uid:r,auth:n,stsTokenManager:i}=e,s=zv(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new UU(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new kx(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const r=await l0(this,this.stsTokenManager.getToken(this.auth,e));return ft(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return jU(this,e)}reload(){return zU(this)}_assign(e){this!==e&&(ft(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>Object.assign({},r)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new wa(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(e){ft(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await ip(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(mo(this.auth.app))return Promise.reject(xl(this.auth));const e=await this.getIdToken();return await l0(this,BU(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){var n,i,s,a,o,l,c,d;const h=(n=r.displayName)!==null&&n!==void 0?n:void 0,p=(i=r.email)!==null&&i!==void 0?i:void 0,m=(s=r.phoneNumber)!==null&&s!==void 0?s:void 0,y=(a=r.photoURL)!==null&&a!==void 0?a:void 0,x=(o=r.tenantId)!==null&&o!==void 0?o:void 0,E=(l=r._redirectEventId)!==null&&l!==void 0?l:void 0,T=(c=r.createdAt)!==null&&c!==void 0?c:void 0,A=(d=r.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:_,emailVerified:P,isAnonymous:W,providerData:B,stsTokenManager:w}=r;ft(_&&w,e,"internal-error");const F=Bc.fromJSON(this.name,w);ft(typeof _=="string",e,"internal-error"),ro(h,e.name),ro(p,e.name),ft(typeof P=="boolean",e,"internal-error"),ft(typeof W=="boolean",e,"internal-error"),ro(m,e.name),ro(y,e.name),ro(x,e.name),ro(E,e.name),ro(T,e.name),ro(A,e.name);const S=new wa({uid:_,auth:e,email:p,emailVerified:P,displayName:h,isAnonymous:W,photoURL:y,phoneNumber:m,tenantId:x,stsTokenManager:F,createdAt:T,lastLoginAt:A});return B&&Array.isArray(B)&&(S.providerData=B.map(b=>Object.assign({},b))),E&&(S._redirectEventId=E),S}static async _fromIdTokenResponse(e,r,n=!1){const i=new Bc;i.updateFromServerResponse(r);const s=new wa({uid:r.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await ip(s),s}static async _fromGetAccountInfoResponse(e,r,n){const i=r.users[0];ft(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?a4(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),o=new Bc;o.updateFromIdToken(n);const l=new wa({uid:i.localId,auth:e,stsTokenManager:o,isAnonymous:a}),c={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new kx(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(l,c),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ME=new Map;function Ta(t){Ba(t instanceof Function,"Expected a class definition");let e=ME.get(t);return e?(Ba(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,ME.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o4{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}o4.type="NONE";const LE=o4;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sh(t,e,r){return`firebase:${t}:${e}:${r}`}class jc{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:i,name:s}=this.auth;this.fullUserKey=sh(this.userKey,i.apiKey,s),this.fullPersistenceKey=sh("persistence",i.apiKey,s),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?wa._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new jc(Ta(LE),e,n);const i=(await Promise.all(r.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let s=i[0]||Ta(LE);const a=sh(n,e.config.apiKey,e.name);let o=null;for(const c of r)try{const d=await c._get(a);if(d){const h=wa._fromJSON(e,d);c!==s&&(o=h),s=c;break}}catch{}const l=i.filter(c=>c._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new jc(s,e,n):(s=l[0],o&&await s._set(a,o.toJSON()),await Promise.all(r.map(async c=>{if(c!==s)try{await c._remove(a)}catch{}})),new jc(s,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BE(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(f4(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(l4(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(h4(e))return"Blackberry";if(p4(e))return"Webos";if(c4(e))return"Safari";if((e.includes("chrome/")||u4(e))&&!e.includes("edge/"))return"Chrome";if(d4(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function l4(t=Xn()){return/firefox\//i.test(t)}function c4(t=Xn()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function u4(t=Xn()){return/crios\//i.test(t)}function f4(t=Xn()){return/iemobile/i.test(t)}function d4(t=Xn()){return/android/i.test(t)}function h4(t=Xn()){return/blackberry/i.test(t)}function p4(t=Xn()){return/webos/i.test(t)}function Kv(t=Xn()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function GU(t=Xn()){var e;return Kv(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function KU(){return i9()&&document.documentMode===10}function g4(t=Xn()){return Kv(t)||d4(t)||p4(t)||h4(t)||/windows phone/i.test(t)||f4(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m4(t,e=[]){let r;switch(t){case"Browser":r=BE(Xn());break;case"Worker":r=`${BE(Xn())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${hu}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XU{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=s=>new Promise((a,o)=>{try{const l=e(s);a(l)}catch(l){o(l)}});n.onAbort=r,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const i of r)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function YU(t,e={}){return vu(t,"GET","/v2/passwordPolicy",$v(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qU=6;class QU{constructor(e){var r,n,i,s;const a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=a.minPasswordLength)!==null&&r!==void 0?r:qU,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(n=e.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var r,n,i,s,a,o;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(r=l.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(n=l.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),l.isValid&&(l.isValid=(i=l.containsLowercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(s=l.containsUppercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(a=l.containsNumericCharacter)!==null&&a!==void 0?a:!0),l.isValid&&(l.isValid=(o=l.containsNonAlphanumericCharacter)!==null&&o!==void 0?o:!0),l}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),i&&(r.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JU{constructor(e,r,n,i){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new jE(this),this.idTokenSubscription=new jE(this),this.beforeStateQueue=new XU(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=e4,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=Ta(r)),this._initializationPromise=this.queue(async()=>{var n,i;if(!this._deleted&&(this.persistenceManager=await jc.create(this,e),!this._deleted)){if(!((n=this._popupRedirectResolver)===null||n===void 0)&&n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await s4(this,{idToken:e}),n=await wa._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var r;if(mo(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(o,o))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let i=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,o=i==null?void 0:i._redirectEventId,l=await this.tryRedirectSignIn(e);(!a||a===o)&&(l!=null&&l.user)&&(i=l.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(a){i=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return ft(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await ip(e)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=DU()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(mo(this.app))return Promise.reject(xl(this));const r=e?Ds(e):null;return r&&ft(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&ft(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return mo(this.app)?Promise.reject(xl(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return mo(this.app)?Promise.reject(xl(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ta(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await YU(this),r=new QU(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new w0("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await $U(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&Ta(e)||this._popupRedirectResolver;ft(r,this,"argument-error"),this.redirectPersistenceManager=await jc.create(this,[Ta(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(r=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,i){if(this._deleted)return()=>{};const s=typeof r=="function"?r:r.next.bind(r);let a=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(ft(o,this,"internal-error"),o.then(()=>{a||s(this.currentUser)}),typeof r=="function"){const l=e.addObserver(r,n,i);return()=>{a=!0,l()}}else{const l=e.addObserver(r);return()=>{a=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ft(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=m4(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);const n=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());n&&(r["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(r["X-Firebase-AppCheck"]=i),r}async _getAppCheckToken(){var e;const r=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return r!=null&&r.error&&bU(`Error while retrieving App Check token: ${r.error}`),r==null?void 0:r.token}}function Xv(t){return Ds(t)}class jE{constructor(e){this.auth=e,this.observer=null,this.addObserver=d9(r=>this.observer=r)}get next(){return ft(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Yv={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function ZU(t){Yv=t}function ez(t){return Yv.loadJS(t)}function tz(){return Yv.gapiScript}function rz(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nz(t,e){const r=fv(t,"auth");if(r.isInitialized()){const i=r.getImmediate(),s=r.getOptions();if(Gh(s,e??{}))return i;La(i,"already-initialized")}return r.initialize({options:e})}function iz(t,e){const r=(e==null?void 0:e.persistence)||[],n=(Array.isArray(r)?r:[r]).map(Ta);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function sz(t,e,r){const n=Xv(t);ft(n._canInitEmulator,n,"emulator-config-failed"),ft(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const i=!1,s=x4(e),{host:a,port:o}=az(e),l=o===null?"":`:${o}`;n.config.emulator={url:`${s}//${a}${l}/`},n.settings.appVerificationDisabledForTesting=!0,n.emulatorConfig=Object.freeze({host:a,port:o,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),oz()}function x4(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function az(t){const e=x4(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const s=i[1];return{host:s,port:VE(n.substr(s.length+1))}}else{const[s,a]=n.split(":");return{host:s,port:VE(a)}}}function VE(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function oz(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v4{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return Ea("not implemented")}_getIdTokenResponse(e){return Ea("not implemented")}_linkToIdToken(e,r){return Ea("not implemented")}_getReauthenticationResolver(e){return Ea("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vc(t,e){return MU(t,"POST","/v1/accounts:signInWithIdp",$v(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lz="http://localhost";class Dl extends v4{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new Dl(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):La("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:i}=r,s=zv(r,["providerId","signInMethod"]);if(!n||!i)return null;const a=new Dl(n,i);return a.idToken=s.idToken||void 0,a.accessToken=s.accessToken||void 0,a.secret=s.secret,a.nonce=s.nonce,a.pendingToken=s.pendingToken||null,a}_getIdTokenResponse(e){const r=this.buildRequest();return Vc(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,Vc(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,Vc(e,r)}buildRequest(){const e={requestUri:lz,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=T0(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y4{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R0 extends y4{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oo extends R0{constructor(){super("facebook.com")}static credential(e){return Dl._fromParams({providerId:oo.PROVIDER_ID,signInMethod:oo.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return oo.credentialFromTaggedObject(e)}static credentialFromError(e){return oo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return oo.credential(e.oauthAccessToken)}catch{return null}}}oo.FACEBOOK_SIGN_IN_METHOD="facebook.com";oo.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lo extends R0{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return Dl._fromParams({providerId:lo.PROVIDER_ID,signInMethod:lo.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return lo.credentialFromTaggedObject(e)}static credentialFromError(e){return lo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return lo.credential(r,n)}catch{return null}}}lo.GOOGLE_SIGN_IN_METHOD="google.com";lo.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class co extends R0{constructor(){super("github.com")}static credential(e){return Dl._fromParams({providerId:co.PROVIDER_ID,signInMethod:co.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return co.credentialFromTaggedObject(e)}static credentialFromError(e){return co.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return co.credential(e.oauthAccessToken)}catch{return null}}}co.GITHUB_SIGN_IN_METHOD="github.com";co.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uo extends R0{constructor(){super("twitter.com")}static credential(e,r){return Dl._fromParams({providerId:uo.PROVIDER_ID,signInMethod:uo.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return uo.credentialFromTaggedObject(e)}static credentialFromError(e){return uo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return uo.credential(r,n)}catch{return null}}}uo.TWITTER_SIGN_IN_METHOD="twitter.com";uo.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class su{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,i=!1){const s=await wa._fromIdTokenResponse(e,n,i),a=UE(n);return new su({user:s,providerId:a,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const i=UE(n);return new su({user:e,providerId:i,_tokenResponse:n,operationType:r})}}function UE(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sp extends Wa{constructor(e,r,n,i){var s;super(r.code,r.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,sp.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,i){return new sp(e,r,n,i)}}function _4(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?sp._fromErrorAndOperation(t,s,e,n):s})}async function cz(t,e,r=!1){const n=await l0(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return su._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uz(t,e,r=!1){const{auth:n}=t;if(mo(n.app))return Promise.reject(xl(n));const i="reauthenticate";try{const s=await l0(t,_4(n,i,e,t),r);ft(s.idToken,n,"internal-error");const a=Gv(s.idToken);ft(a,n,"internal-error");const{sub:o}=a;return ft(t.uid===o,n,"user-mismatch"),su._forOperation(t,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&La(n,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fz(t,e,r=!1){if(mo(t.app))return Promise.reject(xl(t));const n="signIn",i=await _4(t,n,e),s=await su._fromIdTokenResponse(t,n,i);return r||await t._updateCurrentUser(s.user),s}function dz(t,e,r,n){return Ds(t).onIdTokenChanged(e,r,n)}function hz(t,e,r){return Ds(t).beforeAuthStateChanged(e,r)}const ap="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E4{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(ap,"1"),this.storage.removeItem(ap),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pz=1e3,gz=10;class w4 extends E4{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=g4(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),i=this.localCache[r];n!==i&&e(r,i,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((a,o,l)=>{this.notifyListeners(a,l)});return}const n=e.key;r?this.detachListener():this.stopPolling();const i=()=>{const a=this.storage.getItem(n);!r&&this.localCache[n]===a||this.notifyListeners(n,a)},s=this.storage.getItem(n);KU()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,gz):i()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},pz)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}w4.type="LOCAL";const mz=w4;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T4 extends E4{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}T4.type="SESSION";const S4=T4;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xz(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gp{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(i=>i.isListeningto(e));if(r)return r;const n=new Gp(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:i,data:s}=r.data,a=this.handlersMap[i];if(!(a!=null&&a.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const o=Array.from(a).map(async c=>c(r.origin,s)),l=await xz(o);r.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:l})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Gp.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qv(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vz{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,a;return new Promise((o,l)=>{const c=qv("",20);i.port1.start();const d=setTimeout(()=>{l(new Error("unsupported_event"))},n);a={messageChannel:i,onMessage(h){const p=h;if(p.data.eventId===c)switch(p.data.status){case"ack":clearTimeout(d),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),o(p.data.response);break;default:clearTimeout(d),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:c,data:r},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ta(){return window}function yz(t){ta().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A4(){return typeof ta().WorkerGlobalScope<"u"&&typeof ta().importScripts=="function"}async function _z(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Ez(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function wz(){return A4()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k4="firebaseLocalStorageDb",Tz=1,op="firebaseLocalStorage",C4="fbase_key";class N0{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function Kp(t,e){return t.transaction([op],e?"readwrite":"readonly").objectStore(op)}function Sz(){const t=indexedDB.deleteDatabase(k4);return new N0(t).toPromise()}function Cx(){const t=indexedDB.open(k4,Tz);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(op,{keyPath:C4})}catch(i){r(i)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(op)?e(n):(n.close(),await Sz(),e(await Cx()))})})}async function zE(t,e,r){const n=Kp(t,!0).put({[C4]:e,value:r});return new N0(n).toPromise()}async function Az(t,e){const r=Kp(t,!1).get(e),n=await new N0(r).toPromise();return n===void 0?null:n.value}function WE(t,e){const r=Kp(t,!0).delete(e);return new N0(r).toPromise()}const kz=800,Cz=3;class F4{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Cx(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>Cz)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return A4()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Gp._getInstance(wz()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var e,r;if(this.activeServiceWorker=await _z(),!this.activeServiceWorker)return;this.sender=new vz(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((e=n[0])===null||e===void 0)&&e.fulfilled&&!((r=n[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Ez()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Cx();return await zE(e,ap,"1"),await WE(e,ap),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>zE(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>Az(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>WE(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=Kp(i,!1).getAll();return new N0(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),r.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),r.push(i));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),kz)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}F4.type="LOCAL";const Fz=F4;new b0(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Iz(t,e){return e?Ta(e):(ft(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qv extends v4{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Vc(e,this._buildIdpRequest())}_linkToIdToken(e,r){return Vc(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return Vc(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function bz(t){return fz(t.auth,new Qv(t),t.bypassAuthState)}function Rz(t){const{auth:e,user:r}=t;return ft(r,e,"internal-error"),uz(r,new Qv(t),t.bypassAuthState)}async function Nz(t){const{auth:e,user:r}=t;return ft(r,e,"internal-error"),cz(r,new Qv(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I4{constructor(e,r,n,i,s=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:i,tenantId:s,error:a,type:o}=e;if(a){this.reject(a);return}const l={auth:this.auth,requestUri:r,sessionId:n,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return bz;case"linkViaPopup":case"linkViaRedirect":return Nz;case"reauthViaPopup":case"reauthViaRedirect":return Rz;default:La(this.auth,"internal-error")}}resolve(e){Ba(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ba(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dz=new b0(2e3,1e4);class kc extends I4{constructor(e,r,n,i,s){super(e,r,i,s),this.provider=n,this.authWindow=null,this.pollId=null,kc.currentPopupAction&&kc.currentPopupAction.cancel(),kc.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ft(e,this.auth,"internal-error"),e}async onExecution(){Ba(this.filter.length===1,"Popup operations only handle one event");const e=qv();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(ea(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(ea(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,kc.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if(!((n=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(ea(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Dz.get())};e()}}kc.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pz="pendingRedirect",ah=new Map;class Oz extends I4{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=ah.get(this.auth._key());if(!e){try{const n=await Mz(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}ah.set(this.auth._key(),e)}return this.bypassAuthState||ah.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function Mz(t,e){const r=jz(e),n=Bz(t);if(!await n._isAvailable())return!1;const i=await n._get(r)==="true";return await n._remove(r),i}function Lz(t,e){ah.set(t._key(),e)}function Bz(t){return Ta(t._redirectPersistence)}function jz(t){return sh(Pz,t.config.apiKey,t.name)}async function Vz(t,e,r=!1){if(mo(t.app))return Promise.reject(xl(t));const n=Xv(t),i=Iz(n,e),a=await new Oz(n,i,r).execute();return a&&!r&&(delete a.user._redirectEventId,await n._persistUserIfCurrent(a.user),await n._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uz=10*60*1e3;class zz{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Wz(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!b4(e)){const i=((n=e.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";r.onError(ea(this.auth,i))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Uz&&this.cachedEventUids.clear(),this.cachedEventUids.has(HE(e))}saveEventToCache(e){this.cachedEventUids.add(HE(e)),this.lastProcessedEventTime=Date.now()}}function HE(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function b4({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function Wz(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return b4(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Hz(t,e={}){return vu(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $z=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Gz=/^https?/;async function Kz(t){if(t.config.emulator)return;const{authorizedDomains:e}=await Hz(t);for(const r of e)try{if(Xz(r))return}catch{}La(t,"unauthorized-domain")}function Xz(t){const e=Ax(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const a=new URL(t);return a.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&a.hostname===n}if(!Gz.test(r))return!1;if($z.test(t))return n===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yz=new b0(3e4,6e4);function $E(){const t=ta().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function qz(t){return new Promise((e,r)=>{var n,i,s;function a(){$E(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{$E(),r(ea(t,"network-request-failed"))},timeout:Yz.get()})}if(!((i=(n=ta().gapi)===null||n===void 0?void 0:n.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=ta().gapi)===null||s===void 0)&&s.load)a();else{const o=rz("iframefcb");return ta()[o]=()=>{gapi.load?a():r(ea(t,"network-request-failed"))},ez(`${tz()}?onload=${o}`).catch(l=>r(l))}}).catch(e=>{throw oh=null,e})}let oh=null;function Qz(t){return oh=oh||qz(t),oh}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jz=new b0(5e3,15e3),Zz="__/auth/iframe",eW="emulator/auth/iframe",tW={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},rW=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function nW(t){const e=t.config;ft(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?Hv(e,eW):`https://${t.config.authDomain}/${Zz}`,n={apiKey:e.apiKey,appName:t.name,v:hu},i=rW.get(t.config.apiHost);i&&(n.eid=i);const s=t._getFrameworks();return s.length&&(n.fw=s.join(",")),`${r}?${T0(n).slice(1)}`}async function iW(t){const e=await Qz(t),r=ta().gapi;return ft(r,t,"internal-error"),e.open({where:document.body,url:nW(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:tW,dontclear:!0},n=>new Promise(async(i,s)=>{await n.restyle({setHideOnLeave:!1});const a=ea(t,"network-request-failed"),o=ta().setTimeout(()=>{s(a)},Jz.get());function l(){ta().clearTimeout(o),i(n)}n.ping(l).then(l,()=>{s(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sW={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},aW=500,oW=600,lW="_blank",cW="http://localhost";class GE{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function uW(t,e,r,n=aW,i=oW){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-n)/2,0).toString();let o="";const l=Object.assign(Object.assign({},sW),{width:n.toString(),height:i.toString(),top:s,left:a}),c=Xn().toLowerCase();r&&(o=u4(c)?lW:r),l4(c)&&(e=e||cW,l.scrollbars="yes");const d=Object.entries(l).reduce((p,[m,y])=>`${p}${m}=${y},`,"");if(GU(c)&&o!=="_self")return fW(e||"",o),new GE(null);const h=window.open(e||"",o,d);ft(h,t,"popup-blocked");try{h.focus()}catch{}return new GE(h)}function fW(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dW="__/auth/handler",hW="emulator/auth/handler",pW=encodeURIComponent("fac");async function KE(t,e,r,n,i,s){ft(t.config.authDomain,t,"auth-domain-config-required"),ft(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:hu,eventId:i};if(e instanceof y4){e.setDefaultLanguage(t.languageCode),a.providerId=e.providerId||"",f9(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,h]of Object.entries({}))a[d]=h}if(e instanceof R0){const d=e.getScopes().filter(h=>h!=="");d.length>0&&(a.scopes=d.join(","))}t.tenantId&&(a.tid=t.tenantId);const o=a;for(const d of Object.keys(o))o[d]===void 0&&delete o[d];const l=await t._getAppCheckToken(),c=l?`#${pW}=${encodeURIComponent(l)}`:"";return`${gW(t)}?${T0(o).slice(1)}${c}`}function gW({config:t}){return t.emulator?Hv(t,hW):`https://${t.authDomain}/${dW}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jg="webStorageSupport";class mW{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=S4,this._completeRedirectFn=Vz,this._overrideRedirectResult=Lz}async _openPopup(e,r,n,i){var s;Ba((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const a=await KE(e,r,n,Ax(),i);return uW(e,a,qv())}async _openRedirect(e,r,n,i){await this._originValidation(e);const s=await KE(e,r,n,Ax(),i);return yz(s),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:i,promise:s}=this.eventManagers[r];return i?Promise.resolve(i):(Ba(s,"If manager is not set, promise should be"),s)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await iW(e),n=new zz(e);return r.register("authEvent",i=>(ft(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:n.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(Jg,{type:Jg},i=>{var s;const a=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[Jg];a!==void 0&&r(!!a),La(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=Kz(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return g4()||c4()||Kv()}}const xW=mW;var XE="@firebase/auth",YE="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vW{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){ft(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yW(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function _W(t){Qc(new Il("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=n.options;ft(a&&!a.includes(":"),"invalid-api-key",{appName:n.name});const l={apiKey:a,authDomain:o,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:m4(t)},c=new JU(n,i,s,l);return iz(c,r),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),Qc(new Il("auth-internal",e=>{const r=Xv(e.getProvider("auth").getImmediate());return(n=>new vW(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),Fo(XE,YE,yW(t)),Fo(XE,YE,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EW=5*60,wW=Sk("authIdTokenMaxAge")||EW;let qE=null;const TW=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>wW)return;const i=r==null?void 0:r.token;qE!==i&&(qE=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function SW(t=Fk()){const e=fv(t,"auth");if(e.isInitialized())return e.getImmediate();const r=nz(t,{popupRedirectResolver:xW,persistence:[Fz,mz,S4]}),n=Sk("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(n,location.origin);if(location.origin===s.origin){const a=TW(s.toString());hz(r,a,()=>a(r.currentUser)),dz(r,o=>a(o))}}const i=wk("auth");return i&&sz(r,`http://${i}`),r}function AW(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}ZU({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=i=>{const s=ea("internal-error");s.customData=i,r(s)},n.type="text/javascript",n.charset="UTF-8",AW().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});_W("Browser");const kW={apiKey:"AIzaSyAZZ0804o11q-hS6p7XJZNK_FPGJgXpmPc",authDomain:"finance-automation-b28e8.firebaseapp.com",projectId:"finance-automation-b28e8",storageBucket:"finance-automation-b28e8.firebasestorage.app",messagingSenderId:"832501526859",appId:"1:832501526859:web:3a64f40f9db732af1b78ce"},R4=Ck(kW),Jv=cU(R4);SW(R4);const Zg=async(t,e)=>{try{return await kU(Mv(Jv,"appState",t),{masterData:e.masterData||[],ledgerEntries:e.ledgerEntries||[],receipts:e.receipts||[],creditNotes:e.creditNotes||[],openingBalances:e.openingBalances||{},mailerImages:e.mailerImages||{},mailerLogo:e.mailerLogo||null,companyConfig:e.companyConfig||{},nextInvoiceNo:e.nextInvoiceNo||1,nextCombineNo:e.nextCombineNo||1,nextReceiptNo:e.nextReceiptNo||1,nextCreditNoteNo:e.nextCreditNoteNo||1,invoiceValues:e.invoiceValues||{},notifications:e.notifications||[],whatsappSettings:e.whatsappSettings||{},partyMaster:e.partyMaster||[],followups:e.followups||[],updatedAt:new Date().toISOString()}),!0}catch(r){return console.error("Error saving app state:",r),!1}},QE=async t=>{try{const e=await AU(Mv(Jv,"appState",t));return e.exists()?e.data():null}catch(e){return console.error("Error loading app state:",e),null}},CW=(t,e)=>{const r=Mv(Jv,"appState",t);return CU(r,n=>{n.exists()&&e(n.data())},n=>{console.error("Error in real-time listener:",n)})},ut=t=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:2,maximumFractionDigits:2}).format(t||0),Vt=t=>""+new Intl.NumberFormat("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2}).format(t||0),gr=t=>{if(!t)return"-";const e=new Date(t);if(isNaN(e.getTime()))return t;const r=e.getDate().toString().padStart(2,"0"),n=e.toLocaleString("en-US",{month:"short"}),i=e.getFullYear();return`${r}-${n}-${i}`},FW=t=>{if(!t)return"-";const e=new Date(t);if(isNaN(e.getTime()))return t;const r=e.getDate(),n=e.toLocaleString("en-US",{month:"short"}),i=e.getFullYear();return`${r}${(a=>{if(a>3&&a<21)return"th";switch(a%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}})(r)} ${n}, ${i}`},IW=t=>{const e=["","One","Two","Three","Four","Five","Six","Seven","Eight","Nine","Ten","Eleven","Twelve","Thirteen","Fourteen","Fifteen","Sixteen","Seventeen","Eighteen","Nineteen"],r=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"];if(t===0)return"Zero";const n=l=>l<20?e[l]:l<100?r[Math.floor(l/10)]+(l%10?" "+e[l%10]:""):e[Math.floor(l/100)]+" Hundred"+(l%100?" "+n(l%100):""),i=l=>l<1e3?n(l):l<1e5?n(Math.floor(l/1e3))+" Thousand"+(l%1e3?" "+n(l%1e3):""):l<1e7?n(Math.floor(l/1e5))+" Lakh"+(l%1e5?" "+i(l%1e5):""):n(Math.floor(l/1e7))+" Crore"+(l%1e7?" "+i(l%1e7):""),s=Math.floor(t),a=Math.round((t-s)*100);let o="INR "+i(s);return a>0&&(o+=" and "+i(a)+" Paise"),o+" Only"},bW=t=>{if(!t)return"";const e=/[\w.-]+@[\w.-]+\.\w+/g,r=t.match(e);return r?r[0]:""},RW=t=>({Approved:{bg:"#DCFCE7",text:"#166534",border:"#86EFAC"},Created:{bg:"#DBEAFE",text:"#1E40AF",border:"#93C5FD"},"Need Edits":{bg:"#FEE2E2",text:"#991B1B",border:"#FCA5A5"},Paid:{bg:"#D1FAE5",text:"#065F46",border:"#6EE7B7"},Individual:{bg:"#E0E7FF",text:"#3730A3",border:"#A5B4FC"},Combined:{bg:"#F3E8FF",text:"#6B21A8",border:"#DDD6FE"},Yes:{bg:"#DCFCE7",text:"#166534",border:"#86EFAC"},No:{bg:"#FEF3C7",text:"#92400E",border:"#FCD34D"},"Not Yet":{bg:"#F1F5F9",text:"#475569",border:"#CBD5E1"},Pending:{bg:"#FEF3C7",text:"#92400E",border:"#FCD34D"},Sent:{bg:"#D1FAE5",text:"#065F46",border:"#6EE7B7"}})[t]||{bg:"#F1F5F9",text:"#475569",border:"#CBD5E1"},em=({status:t,small:e=!1})=>{const r=RW(t);return f.jsx("span",{style:{display:"inline-flex",alignItems:"center",padding:e?"2px 8px":"4px 12px",borderRadius:"6px",fontSize:e?"11px":"12px",fontWeight:"600",backgroundColor:r.bg,color:r.text,border:`1px solid ${r.border}`},children:t})},Ye=({icon:t,label:e,onClick:r,variant:n="default",disabled:i=!1,small:s=!1})=>{const o={default:{bg:"#F8FAFC",hoverBg:"#E2E8F0",text:"#475569",border:"#CBD5E1"},primary:{bg:"#2874A6",hoverBg:"#1a5276",text:"#FFFFFF",border:"#2874A6"},success:{bg:"#059669",hoverBg:"#047857",text:"#FFFFFF",border:"#059669"},warning:{bg:"#D97706",hoverBg:"#B45309",text:"#FFFFFF",border:"#D97706"},danger:{bg:"#DC2626",hoverBg:"#B91C1C",text:"#FFFFFF",border:"#DC2626"},brand:{bg:"#2874A6",hoverBg:"#1a5276",text:"#FFFFFF",border:"#2874A6"},purple:{bg:"#7C3AED",hoverBg:"#6D28D9",text:"#FFFFFF",border:"#7C3AED"}}[n];return f.jsxs("button",{onClick:r,disabled:i,title:e,style:{display:"inline-flex",alignItems:"center",gap:"6px",padding:s?"5px 10px":"8px 14px",borderRadius:"6px",fontSize:s?"11px":"13px",fontWeight:"600",backgroundColor:i?"#F1F5F9":o.bg,color:i?"#94A3B8":o.text,border:`1px solid ${i?"#E2E8F0":o.border}`,cursor:i?"not-allowed":"pointer",transition:"all 0.15s ease",whiteSpace:"nowrap",opacity:i?.6:1},onMouseEnter:l=>!i&&(l.target.style.backgroundColor=o.hoverBg),onMouseLeave:l=>!i&&(l.target.style.backgroundColor=o.bg),children:[t&&f.jsx(t,{size:s?14:16}),e&&f.jsx("span",{children:e})]})},mr=({label:t,type:e="text",value:r,onChange:n,placeholder:i,disabled:s,small:a})=>f.jsxs("div",{style:{marginBottom:a?"12px":"16px"},children:[t&&f.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:t}),f.jsx("input",{type:e,value:r,onChange:n,placeholder:i,disabled:s,style:{width:"100%",padding:a?"8px 12px":"10px 14px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:a?"13px":"14px",backgroundColor:s?"#F9FAFB":"#FFFFFF",boxSizing:"border-box"}})]}),jd=({label:t,value:e,onChange:r,options:n,small:i})=>f.jsxs("div",{style:{marginBottom:i?"12px":"16px"},children:[t&&f.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:t}),f.jsx("select",{value:e,onChange:r,style:{width:"100%",padding:i?"8px 12px":"10px 14px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:i?"13px":"14px",backgroundColor:"#FFFFFF",boxSizing:"border-box"},children:n.map(s=>f.jsx("option",{value:s.value,children:s.label},s.value))})]}),_n=({title:t,children:e,actions:r,noPadding:n=!1})=>f.jsxs("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"12px",border:"1px solid #E2E8F0",boxShadow:"0 2px 8px rgba(0,0,0,0.06)",overflow:"hidden"},children:[t&&f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"14px 20px",borderBottom:"1px solid #E2E8F0",backgroundColor:"#FAFBFC"},children:[f.jsx("h3",{style:{margin:0,fontSize:"15px",fontWeight:"700",color:"#1E293B"},children:t}),r&&f.jsx("div",{style:{display:"flex",gap:"10px"},children:r})]}),f.jsx("div",{style:{padding:n?0:"20px"},children:e})]}),En=({isOpen:t,onClose:e,title:r,children:n,width:i="500px"})=>t?f.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(15, 23, 42, 0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,backdropFilter:"blur(4px)"},onClick:e,children:f.jsxs("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"16px",width:i,maxWidth:"95vw",maxHeight:"90vh",overflow:"hidden",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)"},onClick:s=>s.stopPropagation(),children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"16px 20px",borderBottom:"1px solid #E2E8F0",backgroundColor:"#FAFBFC"},children:[f.jsx("h2",{style:{margin:0,fontSize:"16px",fontWeight:"700",color:"#1E293B"},children:r}),f.jsx("button",{onClick:e,style:{background:"none",border:"none",cursor:"pointer",padding:"4px",color:"#64748B"},children:f.jsx(rl,{size:20})})]}),f.jsx("div",{style:{padding:"20px",maxHeight:"calc(90vh - 100px)",overflowY:"auto"},children:n})]})}):null;function NW(){const[t,e]=ye.useState(()=>{const g=localStorage.getItem("financeAppLogin");return g?JSON.parse(g).isLoggedIn:!1}),[r,n]=ye.useState(()=>{const g=localStorage.getItem("financeAppLogin");return g?JSON.parse(g).userRole:null}),[i,s]=ye.useState({username:"",password:""}),[a,o]=ye.useState(""),[l,c]=ye.useState(!1),[d,h]=ye.useState(!1),[p,m]=ye.useState(null),[y,x]=ye.useState({finance:"finance123",director:"director123"}),[E,T]=ye.useState(!1),[A,_]=ye.useState(!1),[P,W]=ye.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[B,w]=ye.useState(""),F={finance:{role:"finance",name:"Finance Team"},director:{role:"director",name:"Director"}};ye.useEffect(()=>{(async()=>{try{const C=await QE("indreesh-media");C&&C.userPasswords&&(x(C.userPasswords),console.log("Passwords loaded from Firebase"))}catch(C){console.error("Error loading passwords:",C)}T(!0)})()},[]);const[S,b]=ye.useState({name:"Indreesh Media LLP",brand:"JAC",address:"A-1701 Sweet Home CHS LTD, SVP, Plot No: 24",addressLine2:"Andheri West, Nr Last Bus St",city:"Mumbai-400053",gstin:"27AAIFI6351A1ZM",stateCode:"27",stateName:"Maharashtra",email:"alliances@mediabrief.com",phone:"+91 7021911036",website:"www.mediabrief.com",pan:"AAIFI6351A",bank:{name:"Axis Bank",account:"921020009075531",branch:"Andheri",ifsc:"UTIB0000020",holder:"Indreesh Media LLP"},invoicePrefix:"MB/2025-26/",hsnCode:"998365",gstRate:18}),[N,D]=ye.useState("master"),[R,Ue]=ye.useState(!1),[me,Ie]=ye.useState([]),[Te,_e]=ye.useState([]),[Q,ke]=ye.useState([]),[Le,j]=ye.useState([]),[H,q]=ye.useState(null),[Y,de]=ye.useState(1),[Se,Ne]=ye.useState(1),[Ae,we]=ye.useState(1),[it,G]=ye.useState(1),[jt,mt]=ye.useState(!1),[bt,ht]=ye.useState(!1),[We,Jt]=ye.useState(!1),[hn,$r]=ye.useState(!1),[ci,$i]=ye.useState(!1),[ui,Fr]=ye.useState(!1),[fi,Ot]=ye.useState(!1),[vr,rr]=ye.useState(!1),[qn,ct]=ye.useState(!1),[nr,yr]=ye.useState(!1),[dr,Nn]=ye.useState(!1),[ie,jr]=ye.useState(null),[aa,oa]=ye.useState("reply"),[Ps,la]=ye.useState(""),[ki,Gi]=ye.useState(""),[_r,Ki]=ye.useState({fromDate:"2020-01-01",toDate:new Date().toISOString().split("T")[0]}),[Ha,$a]=ye.useState(""),[Dn,Os]=ye.useState("open"),[Zt,hr]=ye.useState({party:"",invoiceStatus:"",receiptStatus:"",invoiceType:"",searchText:""}),[Ci,pn]=ye.useState([]),[ca,Hl]=ye.useState(!1),[hs,I]=ye.useState([]),[U,L]=ye.useState(!1),[M,z]=ye.useState(null),[V,ae]=ye.useState({date:new Date().toISOString().split("T")[0],notes:"",nextFollowupDate:"",status:"Pending"}),[re,se]=ye.useState({enabled:!1,financePhone:"",financeApiKey:"",directorPhone:"",directorApiKey:""}),[ee,oe]=ye.useState({amount:"",tds:"",discount:"",narration:"",paymentAdvisory:null,date:new Date().toISOString().split("T")[0],mode:"Bank"}),[ve,Oe]=ye.useState({amount:"",gst:"",reason:"",date:new Date().toISOString().split("T")[0]}),[He,Fe]=ye.useState({particularsApproved:!1,emailApproved:!1,invoiceTypeApproved:!1}),[ze,st]=ye.useState(null),[Et,kt]=ye.useState(new Set),[wt,Qn]=ye.useState({}),[gn,Fi]=ye.useState(null),[mn,Ii]=ye.useState(null),[xn,Ga]=ye.useState(!1),[Jn,Go]=ye.useState({}),[di,$l]=ye.useState({partyName:"",amount:"",type:"Dr"}),[ps,Gl]=ye.useState({}),[vn,Xi]=ye.useState({}),[gs,ua]=ye.useState(!1),[Ko,Kl]=ye.useState(new Set),[Xe,Ms]=ye.useState({party:"",billStatus:"",invoiceStatus:"",mailingStatus:"",invoiceType:"",combinationCode:"",searchText:""}),[Yt,Yi]=ye.useState({amount:"",date:new Date().toISOString().split("T")[0],mode:"Bank",tds:"",discount:"",narration:""}),D0=ye.useRef(null),yu=ye.useRef(null),_u=ye.useRef(null),P0=ye.useRef(null),O0=ye.useRef(null),M0=ye.useRef(null),ms=ye.useRef(null),xs=ye.useRef(null),Eu=ye.useRef(null),rn=ye.useMemo(()=>Array.isArray(me)?me:[],[me]),hi=ye.useMemo(()=>Array.isArray(Te)?Te:[],[Te]),vs=ye.useMemo(()=>Array.isArray(Q)?Q:[],[Q]),Xl=ye.useMemo(()=>Array.isArray(Le)?Le:[],[Le]),L0=ye.useMemo(()=>Array.isArray(Ci)?Ci:[],[Ci]),Yl=ye.useMemo(()=>Array.isArray(hs)?hs:[],[hs]),Gr=ye.useMemo(()=>vn&&typeof vn=="object"&&!Array.isArray(vn)?vn:{},[vn]),Ka=ye.useMemo(()=>Jn&&typeof Jn=="object"&&!Array.isArray(Jn)?Jn:{},[Jn]),Xo=ye.useCallback(g=>{if(!g)return"";const C=g.toUpperCase().trim();return C.includes("MAHARASHTRA")||C==="MH"?"MAHARASHTRA":C.includes("DELHI")||C==="DL"||C.includes("NEW DELHI")?"DELHI":C.includes("KARNATAKA")||C==="KA"||C.includes("BANGALORE")||C.includes("BENGALURU")?"KARNATAKA":C.includes("TAMIL")||C==="TN"||C.includes("CHENNAI")?"TAMIL NADU":C.includes("TELANGANA")||C==="TG"||C==="TS"||C.includes("HYDERABAD")?"TELANGANA":C.includes("UTTAR PRADESH")||C==="UP"||C.includes("NOIDA")||C.includes("LUCKNOW")?"UTTAR PRADESH":C.includes("WEST BENGAL")||C==="WB"||C.includes("KOLKATA")?"WEST BENGAL":C.includes("GUJARAT")||C==="GJ"||C.includes("AHMEDABAD")?"GUJARAT":C.includes("RAJASTHAN")||C==="RJ"||C.includes("JAIPUR")?"RAJASTHAN":C.includes("PUNJAB")||C==="PB"?"PUNJAB":C.includes("HARYANA")||C==="HR"||C.includes("GURGAON")||C.includes("GURUGRAM")?"HARYANA":C.includes("MADHYA PRADESH")||C==="MP"||C.includes("BHOPAL")?"MADHYA PRADESH":C.includes("ANDHRA")||C==="AP"?"ANDHRA PRADESH":C.includes("KERALA")||C==="KL"?"KERALA":C.includes("ODISHA")||C.includes("ORISSA")||C==="OR"||C==="OD"?"ODISHA":C.includes("BIHAR")||C==="BR"?"BIHAR":C.includes("JHARKHAND")||C==="JH"?"JHARKHAND":C.includes("ASSAM")||C==="AS"?"ASSAM":C.includes("CHHATTISGARH")||C==="CG"?"CHHATTISGARH":C.includes("GOA")||C==="GA"?"GOA":C.includes("HIMACHAL")||C==="HP"?"HIMACHAL PRADESH":C.includes("JAMMU")||C==="JK"?"JAMMU AND KASHMIR":C.includes("UTTARAKHAND")||C.includes("UTTARANCHAL")||C==="UK"?"UTTARAKHAND":C.includes("MUMBAI")?"MAHARASHTRA":C.includes("CHANDIGARH")?"CHANDIGARH":C},[]),Xa=ye.useCallback((g,C)=>{var J,fe;if(!g)return"";const X=Xo(C),Z=`${g.trim()}|${X}`;if((J=Gr[Z])!=null&&J.gstin)return Gr[Z].gstin;for(const K in Gr){const xe=Gr[K];if(xe.partyName===g.trim()&&xe.normalizedState===X)return xe.gstin||""}return(fe=Gr[g.trim()])!=null&&fe.gstin?Gr[g.trim()].gstin:""},[Gr,Xo]),fa=ye.useRef(!1),Ls=ye.useRef(null),Ya=async()=>{c(!0);try{const g=await QE("indreesh-media");g&&(Array.isArray(g.masterData)&&Ie(g.masterData),Array.isArray(g.ledgerEntries)&&_e(g.ledgerEntries),Array.isArray(g.receipts)&&ke(g.receipts),Array.isArray(g.creditNotes)&&j(g.creditNotes),Array.isArray(g.notifications)&&pn(g.notifications),Array.isArray(g.followups)&&I(g.followups),g.openingBalances&&typeof g.openingBalances=="object"&&!Array.isArray(g.openingBalances)&&Go(g.openingBalances),g.mailerImages&&typeof g.mailerImages=="object"&&!Array.isArray(g.mailerImages)&&Qn(g.mailerImages),g.partyMaster&&typeof g.partyMaster=="object"&&!Array.isArray(g.partyMaster)&&Xi(g.partyMaster),g.userPasswords&&typeof g.userPasswords=="object"&&!Array.isArray(g.userPasswords)&&x(g.userPasswords),g.mailerLogo&&Fi(g.mailerLogo),g.companyConfig&&b(C=>({...C,...g.companyConfig,name:"Indreesh Media LLP",bank:{...g.companyConfig.bank||C.bank,holder:"Indreesh Media LLP"}})),g.nextInvoiceNo&&de(g.nextInvoiceNo),g.nextCombineNo&&Ne(g.nextCombineNo),g.nextReceiptNo&&we(g.nextReceiptNo),g.nextCreditNoteNo&&G(g.nextCreditNoteNo),g.invoiceValues&&Gl(g.invoiceValues),g.whatsappSettings&&se(C=>({...C,...g.whatsappSettings})),console.log("Data loaded from Firebase"))}catch(g){console.error("Error loading data:",g)}c(!1)},qa=ye.useCallback(async()=>{h(!0);try{await Zg("indreesh-media",{masterData:me,ledgerEntries:Te,receipts:Q,creditNotes:Le,openingBalances:Jn,mailerImages:wt,mailerLogo:gn,companyConfig:S,nextInvoiceNo:Y,nextCombineNo:Se,nextReceiptNo:Ae,nextCreditNoteNo:it,invoiceValues:ps,notifications:Ci,whatsappSettings:re,partyMaster:vn,followups:hs,userPasswords:y}),m(new Date),console.log("Data saved to Firebase")}catch(g){console.error("Error saving data:",g)}h(!1)},[me,Te,Q,Le,Jn,wt,gn,S,Y,Se,Ae,it,ps,Ci,re,vn,hs,y]);ye.useEffect(()=>{if(t&&!fa.current)return ms.current&&clearTimeout(ms.current),ms.current=setTimeout(()=>{fa.current||qa()},1e3),()=>{ms.current&&clearTimeout(ms.current)}},[me,Te,Q,Le,Jn,wt,gn,S,Y,Se,Ae,it,ps,Ci,re,vn,hs,y,t]);const B0=async(g,C,X)=>{if(!re.enabled){console.log("WhatsApp notifications not enabled");return}X==="finance"&&re.financePhone&&re.financeApiKey?da(re.financePhone,re.financeApiKey,g,C):X==="director"&&re.directorPhone&&re.directorApiKey?da(re.directorPhone,re.directorApiKey,g,C):X==="all"&&(re.financePhone&&re.financeApiKey&&da(re.financePhone,re.financeApiKey,g,C),re.directorPhone&&re.directorApiKey&&da(re.directorPhone,re.directorApiKey,g,C))},da=async(g,C,X,Z)=>{try{const fe=`*${{upload:" DATA UPLOAD",invoice:" INVOICE",approval:" APPROVED",edit:" EDIT REQUIRED",receipt:" PAYMENT",info:" UPDATE"}[X]||" NOTIFICATION"}*

${Z}

_${S.name}_
_${new Date().toLocaleString("en-IN",{timeZone:"Asia/Kolkata"})}_`,K=`https://api.callmebot.com/whatsapp.php?phone=${g}&text=${encodeURIComponent(fe)}&apikey=${C}`;fetch(K,{mode:"no-cors"}).then(()=>console.log("WhatsApp notification sent to:",g)).catch(xe=>console.log("WhatsApp send attempted:",g))}catch(J){console.error("Failed to send WhatsApp notification:",J)}},ir=(g,C)=>{if(!g||!C){alert("Please enter phone number and API key first");return}da(g,C,"info","Test notification from Indreesh Media LLP. WhatsApp notifications are working!"),alert("Test message sent! Check your WhatsApp.")},Bs=(g,C,X="all")=>{const Z={id:Date.now()+Math.random(),type:g,message:C,forRole:X,createdAt:new Date().toISOString(),createdBy:r,read:{finance:!1,director:!1}};pn(J=>[Z,...J].slice(0,50)),B0(g,C,X)},Xp=g=>{pn(C=>(Array.isArray(C)?C:[]).map(Z=>Z.id===g?{...Z,read:{...Z.read,[r]:!0}}:Z))},j0=()=>{pn(g=>(Array.isArray(g)?g:[]).map(X=>({...X,read:{...X.read,[r]:!0}})))},V0=()=>{pn([])},Yo=ye.useMemo(()=>L0.filter(g=>g.forRole==="all"||g.forRole===r||g.createdBy!==r).map(g=>({...g,read:g.read||{finance:!1,director:!1}})),[L0,r]),pi=ye.useMemo(()=>r?Yo.filter(g=>!(g.read&&g.read[r])).length:0,[Yo,r]),wu=async()=>{const g=F[i.username.toLowerCase()],C=y[i.username.toLowerCase()];g&&C===i.password?(e(!0),n(g.role),localStorage.setItem("financeAppLogin",JSON.stringify({isLoggedIn:!0,userRole:g.role})),o(""),s({username:"",password:""}),await Ya()):o("Invalid username or password")},bi=async()=>{if(!P.currentPassword||!P.newPassword||!P.confirmPassword){w("Please fill all fields");return}const g=r==="director"?"director":"finance";if(y[g]!==P.currentPassword){w("Current password is incorrect");return}if(P.newPassword!==P.confirmPassword){w("New passwords do not match");return}if(P.newPassword.length<6){w("Password must be at least 6 characters");return}const C={...y,[g]:P.newPassword};x(C);try{await Zg("indreesh-media",{masterData:me,ledgerEntries:Te,receipts:Q,creditNotes:Le,openingBalances:Jn,mailerImages:wt,mailerLogo:gn,companyConfig:S,nextInvoiceNo:Y,nextCombineNo:Se,nextReceiptNo:Ae,nextCreditNoteNo:it,invoiceValues:ps,notifications:Ci,whatsappSettings:re,partyMaster:vn,followups:hs,userPasswords:C}),console.log("Password saved to Firebase")}catch(X){console.error("Error saving password:",X),w("Failed to save password. Please try again.");return}_(!1),W({currentPassword:"",newPassword:"",confirmPassword:""}),w(""),alert(" Password changed successfully!")},U0=()=>{qa(),e(!1),n(null),D("master"),localStorage.removeItem("financeAppLogin")};ye.useEffect(()=>{const g=localStorage.getItem("financeAppLogin");if(g){const{isLoggedIn:C}=JSON.parse(g);C&&Ya()}},[]),ye.useEffect(()=>{if(!t){Ls.current&&(Ls.current(),Ls.current=null);return}return Ls.current=CW("indreesh-media",g=>{g&&(fa.current=!0,Array.isArray(g.masterData)&&Ie(g.masterData),Array.isArray(g.ledgerEntries)&&_e(g.ledgerEntries),Array.isArray(g.receipts)&&ke(g.receipts),Array.isArray(g.creditNotes)&&j(g.creditNotes),Array.isArray(g.notifications)&&pn(g.notifications),Array.isArray(g.followups)&&I(g.followups),g.openingBalances&&typeof g.openingBalances=="object"&&!Array.isArray(g.openingBalances)&&Go(g.openingBalances),g.mailerImages&&typeof g.mailerImages=="object"&&!Array.isArray(g.mailerImages)&&Qn(g.mailerImages),g.partyMaster&&typeof g.partyMaster=="object"&&!Array.isArray(g.partyMaster)&&Xi(g.partyMaster),g.userPasswords&&typeof g.userPasswords=="object"&&!Array.isArray(g.userPasswords)&&x(g.userPasswords),g.mailerLogo&&Fi(g.mailerLogo),g.companyConfig&&b(C=>({...C,...g.companyConfig,name:"Indreesh Media LLP",bank:{...g.companyConfig.bank||C.bank,holder:"Indreesh Media LLP"}})),g.nextInvoiceNo&&de(g.nextInvoiceNo),g.nextCombineNo&&Ne(g.nextCombineNo),g.nextReceiptNo&&we(g.nextReceiptNo),g.nextCreditNoteNo&&G(g.nextCreditNoteNo),g.invoiceValues&&Gl(g.invoiceValues),g.whatsappSettings&&se(C=>({...C,...g.whatsappSettings})),setTimeout(()=>{fa.current=!1},500),console.log("Real-time sync: Data updated from Firebase"))}),()=>{Ls.current&&(Ls.current(),Ls.current=null)}},[t]);const er=r==="finance",Kr=r==="director",Qa=ye.useMemo(()=>{const g=rn.map(xe=>xe.partyName),C=Object.values(Gr).map(xe=>xe.partyName||"").filter(Boolean),X=Object.keys(Gr).filter(xe=>!xe.includes("|")).map(xe=>xe),Z=hi.map(xe=>xe.partyName),J=Object.keys(Ka),fe=[...g,...C,...X,...Z,...J];return[...new Set(fe)].filter(Boolean).sort()},[rn,Gr,hi,Ka]);ye.useMemo(()=>{const g=new Map;return rn.forEach(C=>{if(C.partyName){const X=Xo(C.statePartyDetails),Z=`${C.partyName}|${X}`;g.has(Z)||g.set(Z,{partyName:C.partyName,state:C.statePartyDetails||X||"",normalizedState:X,displayName:X?`${C.partyName} (${C.statePartyDetails||X})`:C.partyName})}}),hi.forEach(C=>{if(C.partyName){const X=Xo(C.state||C.statePartyDetails||""),Z=`${C.partyName}|${X}`;g.has(Z)||g.set(Z,{partyName:C.partyName,state:C.state||C.statePartyDetails||"",normalizedState:X,displayName:X?`${C.partyName} (${C.state||C.statePartyDetails})`:C.partyName})}}),Object.keys(Ka).forEach(C=>{const X=`${C}|`;!g.has(X)&&!Array.from(g.keys()).some(Z=>Z.startsWith(C+"|"))&&g.set(X,{partyName:C,state:"",normalizedState:"",displayName:C})}),Array.from(g.values()).sort((C,X)=>C.displayName.localeCompare(X.displayName))},[rn,hi,Ka]),ye.useMemo(()=>[...new Set(rn.filter(C=>C.combinationCode&&C.combinationCode!=="NA").map(C=>C.combinationCode))].sort((C,X)=>parseInt(C)-parseInt(X)),[rn]);const qo=ye.useMemo(()=>rn.filter(g=>{var C,X,Z,J,fe,K;if(Xe.party&&g.partyName!==Xe.party||Xe.billStatus&&g.toBeBilled!==Xe.billStatus||Xe.invoiceStatus&&(Xe.invoiceStatus==="Generated"&&!g.invoiceGenerated||Xe.invoiceStatus==="Not Generated"&&g.invoiceGenerated||Xe.invoiceStatus==="Paid"&&g.invoiceStatus!=="Paid")||Xe.mailingStatus&&g.mailingSent!==Xe.mailingStatus||Xe.invoiceType&&g.invoiceType!==Xe.invoiceType||Xe.combinationCode&&g.combinationCode!==Xe.combinationCode)return!1;if(Xe.searchText){const xe=Xe.searchText.toLowerCase();if(!(((C=g.senderName)==null?void 0:C.toLowerCase().includes(xe))||((X=g.subject)==null?void 0:X.toLowerCase().includes(xe))||((Z=g.campaignName)==null?void 0:Z.toLowerCase().includes(xe))||((J=g.invoiceNo)==null?void 0:J.toLowerCase().includes(xe))||((fe=g.partyName)==null?void 0:fe.toLowerCase().includes(xe))||((K=g.emailId)==null?void 0:K.toLowerCase().includes(xe))))return!1}return!0}),[rn,Xe]);ye.useMemo(()=>{const g={};return qo.forEach(C=>{g[C.partyName]||(g[C.partyName]=[]),g[C.partyName].push(C)}),Object.keys(g).forEach(C=>{g[C].sort((X,Z)=>X.toBeBilled==="Yes"&&Z.toBeBilled!=="Yes"?-1:X.toBeBilled!=="Yes"&&Z.toBeBilled==="Yes"?1:0)}),g},[qo]),ye.useMemo(()=>{if(!H)return[];const g=Ka[H]||0;let C=g;const X=hi.filter(Z=>Z.partyName===H).sort((Z,J)=>new Date(Z.date)-new Date(J.date)).map(Z=>(C=C+Z.debit-Z.credit,{...Z,balance:C}));return g!==0?[{id:"opening",date:"",particulars:"Opening Balance",debit:g>0?g:0,credit:g<0?Math.abs(g):0,balance:g,isOpening:!0},...X]:X},[H,hi,Ka]);const ql=g=>rn.filter(C=>C.partyName===g&&C.toBeBilled==="Yes"&&!C.invoiceGenerated&&C.invoiceAmount),z0=g=>!g||g==="NA"?!1:rn.some(C=>C.combinationCode===g&&C.mailingSent==="Yes"),qi=g=>g.invoiceType==="Combined"&&g.combinationCode!=="NA"?rn.filter(C=>C.combinationCode===g.combinationCode):[g],Yp=()=>{Ms({party:"",billStatus:"",invoiceStatus:"",mailingStatus:"",invoiceType:"",combinationCode:"",searchText:""})},Ql=Object.values(Xe).some(g=>g!==""),ys=g=>{const C=[];return g.emailId&&C.push(g.emailId),g.additionalEmails&&g.additionalEmails.length>0&&C.push(...g.additionalEmails),C},W0=(g,C)=>{!C||!C.includes("@")||Ie(X=>X.map(Z=>{if(Z.id===g){const J=Z.additionalEmails||[];if(!J.includes(C)&&C!==Z.emailId)return{...Z,additionalEmails:[...J,C]}}return Z}))},H0=(g,C)=>{Ie(X=>X.map(Z=>Z.id===g?{...Z,additionalEmails:(Z.additionalEmails||[]).filter(J=>J!==C)}:Z))},Tu=g=>{jr(g),Gi(g.editComments||g.approvalRemarks||""),Fe({particularsApproved:g.particularsApproved||!1,emailApproved:g.emailApproved||!1,invoiceTypeApproved:g.invoiceTypeApproved||!1}),Ot(!0)},Su=()=>{if(!ie)return;if(!He.particularsApproved||!He.emailApproved||!He.invoiceTypeApproved){alert("Please confirm all approval checkboxes before approving.");return}const g={invoiceStatus:"Approved",approvalRemarks:ki.trim()||"",editComments:"",particularsApproved:!0,emailApproved:!0,invoiceTypeApproved:!0,approvedBy:r,approvedDate:new Date().toISOString()};let C=[];ie.invoiceType==="Combined"&&ie.combinationCode!=="NA"?(C=me.filter(K=>K.combinationCode===ie.combinationCode),Ie(K=>K.map(xe=>xe.combinationCode===ie.combinationCode?{...xe,...g}:xe))):(C=[ie],Ie(K=>K.map(xe=>xe.id===ie.id?{...xe,...g}:xe)));const X=parseFloat(ie.invoiceTotalAmount)||0,Z=C.map(K=>{var xe,$e;return K.senderName||(($e=(xe=K.campaignName)==null?void 0:xe.split("--")[0])==null?void 0:$e.trim())}).join(", "),J=`${ie.invoiceNo} - ${Z}`;_e(K=>[...K,{id:Date.now(),partyName:ie.partyName,date:ie.invoiceDate,particulars:"Promotional Trade Mailer",narration:J,debit:X,credit:0,type:"invoice",invoiceNo:ie.invoiceNo,combinationCode:ie.combinationCode}]);const fe=ki.trim()?` | Remarks: "${ki.trim()}"`:"";Bs("approval",` Invoice ${ie.invoiceNo} has been APPROVED by Director${fe} - ready for mailing`,"finance"),Ot(!1),jr(null),Fe({particularsApproved:!1,emailApproved:!1,invoiceTypeApproved:!1}),Gi(""),alert(` Invoice Approved!

The invoice is now ready for mailing.`)},$0=()=>{if(!ie)return;const g=ki.trim();ie.invoiceType==="Combined"&&ie.combinationCode!=="NA"?Ie(X=>X.map(Z=>Z.combinationCode===ie.combinationCode?{...Z,invoiceStatus:"Need Edits",editComments:g,approvalRemarks:""}:Z)):Ie(X=>X.map(Z=>Z.id===ie.id?{...Z,invoiceStatus:"Need Edits",editComments:g,approvalRemarks:""}:Z));const C=g?`: "${g}"`:"";Bs("edit",` Invoice ${ie.invoiceNo} marked as NEED EDITS by Director${C}`,"finance"),Ot(!1),jr(null),Gi("")},Qo=g=>{jr(g);const C=parseFloat(g.invoiceTotalAmount)||0;oe({amount:C.toFixed(2),tds:"",discount:"",narration:"",paymentAdvisory:null,date:new Date().toISOString().split("T")[0],mode:"Bank"}),ct(!0)},G0=()=>{if(!ie||!ee.amount){alert("Please enter receipt amount");return}if(ie.invoiceStatus!=="Approved"){alert("Receipt cannot be posted. Invoice must be approved first.");return}if(!ie.isHistorical&&ie.mailingSent!=="Yes"){alert("Receipt cannot be posted. Invoice must be mailed first.");return}const g=`RCP/${new Date().getFullYear()}-${String(new Date().getFullYear()+1).slice(-2)}/${Ae}`,C=parseFloat(ee.amount)||0,X=parseFloat(ee.tds)||0,Z=parseFloat(ee.discount)||0,J=C+X+Z,fe=qi(ie),K=fe.map(Me=>Me.subject||Me.senderName).join(", "),xe=K.length>50?K.substring(0,47)+"...":K,$e={id:Date.now(),receiptNo:g,invoiceNo:ie.invoiceNo,partyName:ie.partyName,date:ee.date,amount:C,tds:X,discount:Z,totalCredit:J,narration:ee.narration,paymentAdvisory:ee.paymentAdvisory,mode:ee.mode,campaigns:fe.map(Me=>({senderName:Me.senderName,subject:Me.subject}))};ke(Me=>[...Me,$e]);const le=ee.narration||xe;C>0&&_e(Me=>[...Me,{id:Date.now(),partyName:ie.partyName,date:ee.date,particulars:`Payment Received - ${le}`,narration:`${ie.invoiceNo} | ${ee.mode}`,debit:0,credit:C,type:"receipt",receiptNo:g,invoiceNo:ie.invoiceNo,paymentAdvisory:ee.paymentAdvisory}]),X>0&&_e(Me=>[...Me,{id:Date.now()+1,partyName:ie.partyName,date:ee.date,particulars:"TDS Deducted",narration:`Against ${ie.invoiceNo}`,debit:0,credit:X,type:"tds",receiptNo:g,invoiceNo:ie.invoiceNo}]),Z>0&&_e(Me=>[...Me,{id:Date.now()+2,partyName:ie.partyName,date:ee.date,particulars:"Discount Given",narration:`Against ${ie.invoiceNo}`,debit:0,credit:Z,type:"discount",receiptNo:g,invoiceNo:ie.invoiceNo}]);const De=parseFloat(ie.invoiceTotalAmount)||0,Ge=Le.find(Me=>Me.invoiceNo===ie.invoiceNo),te=Ge?Math.abs(parseFloat(Ge.totalAmount)||0):0,ce=De-J-te<=0;ie.invoiceType==="Combined"&&ie.combinationCode!=="NA"?Ie(Me=>Me.map(Qe=>Qe.combinationCode===ie.combinationCode?{...Qe,receiptStatus:ce?"Closed":"Received",receiptNo:g,receiptDate:ee.date}:Qe)):ie.isHistorical||Ie(Me=>Me.map(Qe=>Qe.id===ie.id?{...Qe,receiptStatus:ce?"Closed":"Received",receiptNo:g,receiptDate:ee.date}:Qe)),we(Me=>Me+1),Bs("receipt",` Payment received for ${ie.partyName} - Receipt ${g} - ${ut(J)}`,"director"),ct(!1),jr(null),oe({amount:"",tds:"",discount:"",narration:"",paymentAdvisory:null,date:new Date().toISOString().split("T")[0],mode:"Bank"}),alert(` Receipt Created!

Receipt No: ${g}
Amount: ${ut(J)}`)},Au=g=>{jr(g),Oe({amount:"",tds:"",discount:"",reason:"",date:new Date().toISOString().split("T")[0]}),yr(!0)},ha=()=>{var Me;if(!ie||!ve.amount&&!ve.gst||!ve.reason){alert("Please enter Amount and/or GST and reason");return}const g=ie.invoiceNo.match(/(\d{4}-\d{2})/),C=g?g[1]:`${new Date().getFullYear()}-${String(new Date().getFullYear()+1).slice(-2)}`,X=ie.invoiceNo.split("/").pop(),Z=`CN/${C}/${X}`,J=parseFloat(ve.amount)||0,fe=parseFloat(ve.gst)||0,K=J+fe,$e=((Me=ie.statePartyDetails)==null?void 0:Me.toUpperCase().includes("MAHARASHTRA"))?"CGST/SGST":"IGST",le={id:Date.now(),creditNoteNo:Z,invoiceNo:ie.invoiceNo,partyName:ie.partyName,date:ve.date,amount:J,gst:fe,gstType:$e,totalAmount:K,reason:ve.reason};j(Qe=>[...Qe,le]);const De=parseFloat(ie.invoiceTotalAmount)||0,Ge=Q.find(Qe=>Qe.invoiceNo===ie.invoiceNo),te=Ge?parseFloat(Ge.amount)+parseFloat(Ge.tds||0)+parseFloat(Ge.discount||0):0,Ke=K>=De-te;ie.isHistorical||Ie(Qe=>Qe.map(be=>be.invoiceNo===ie.invoiceNo?{...be,creditNoteNo:Z,receiptStatus:Ke?"Cancelled":be.receiptStatus}:be)),G(Qe=>Qe+1),yr(!1),jr(null),Oe({amount:"",gst:"",reason:"",date:new Date().toISOString().split("T")[0]});let ce=` Credit Note Created!

Credit Note No: ${Z}`;J>0&&(ce+=`
Base Amount: ${ut(J)}`),fe>0&&(ce+=`
${$e}: ${ut(fe)}`),ce+=`
Total: ${ut(K)}`,Ke&&(ce+=`

 Invoice fully covered by CN - marked as Cancelled`),alert(ce)},K0=g=>{var Z;const C=(Z=g.target.files)==null?void 0:Z[0];if(!C)return;const X=new FileReader;X.onload=J=>{oe(fe=>({...fe,paymentAdvisory:J.target.result}))},X.readAsDataURL(C),g.target.value=""},Jl=g=>{jr(g),rr(!0)},X0=()=>{if(!ie)return;const g=ie.invoiceNo;ie.invoiceType==="Combined"&&ie.combinationCode!=="NA"?Ie(Z=>Z.map(J=>J.combinationCode===ie.combinationCode?{...J,invoiceNo:"",invoiceDate:"",invoiceTotalAmount:"",invoiceGenerated:!1,invoiceStatus:"Pending",invoiceType:"Individual",combinationCode:"NA",mailingSent:"No",mailDate:"",editComments:"",receiptStatus:"",receiptNo:"",receiptDate:""}:J)):Ie(Z=>Z.map(J=>J.id===ie.id?{...J,invoiceNo:"",invoiceDate:"",invoiceTotalAmount:"",invoiceGenerated:!1,invoiceStatus:"Pending",invoiceType:"Individual",combinationCode:"NA",mailingSent:"No",mailDate:"",editComments:"",receiptStatus:"",receiptNo:"",receiptDate:""}:J)),_e(Z=>Z.filter(J=>J.invoiceNo!==g));const C=Q.filter(Z=>Z.invoiceNo===g);C.length>0&&ke(Z=>Z.filter(J=>J.invoiceNo!==g)),rr(!1),jr(null);const X=C.length>0?`
${C.length} receipt(s) also deleted.`:"";alert(` Invoice ${g} deleted.${X}

You can now regenerate the invoice.`)},Y0=g=>{confirm(`Delete Receipt ${g.receiptNo}?

This will also update the invoice status back to Pending.`)&&(ke(C=>C.filter(X=>X.id!==g.id)),Ie(C=>C.map(X=>X.invoiceNo===g.invoiceNo?{...X,receiptStatus:"",receiptNo:"",receiptDate:""}:X)),alert(` Receipt ${g.receiptNo} deleted.`))},Zl=g=>{confirm(`Delete Credit Note ${g.creditNoteNo}?

This will remove the CN association from the invoice.`)&&(j(C=>C.filter(X=>X.id!==g.id)),Ie(C=>C.map(X=>X.invoiceNo===g.invoiceNo?{...X,creditNoteNo:""}:X)),alert(` Credit Note ${g.creditNoteNo} deleted.`))},Zn=g=>{confirm(`Delete historical entry?

Vch No: ${g.vchNo||"N/A"}
Amount: ${g.debit||g.credit}

This action cannot be undone.`)&&(_e(C=>C.filter(X=>X.id!==g.id)),alert(" Historical entry deleted."))},q0=()=>{if(!H||!confirm(`Delete ALL historical entries for "${H}"?

This will remove all imported historical data for this party.`))return;const g=Te.filter(C=>C.partyName===H&&C.isHistorical).length;_e(C=>C.filter(X=>!(X.partyName===H&&X.isHistorical))),alert(` ${g} historical entries deleted for ${H}.`)},Q0=g=>{z(g),ae({date:new Date().toISOString().split("T")[0],notes:"",nextFollowupDate:"",status:"Pending"}),L(!0)},Ja=()=>{var C,X;if(!M)return;const g={id:Date.now(),invoiceNo:M.invoiceNo,partyName:M.partyName,invoiceDate:M.invoiceDate||M.date,invoiceAmount:M.invoiceTotalAmount||M.totalAmount,subject:((X=(C=M.campaigns)==null?void 0:C[0])==null?void 0:X.subject)||M.subject||"",followupDate:V.date,notes:V.notes,nextFollowupDate:V.nextFollowupDate,status:V.status};I(Z=>[...Z,g]),L(!1),z(null),Bs("followup",`Followup added for ${M.invoiceNo}`,"all"),alert(` Followup recorded for ${M.invoiceNo}`)},u=g=>{confirm("Delete this followup entry?")&&I(C=>C.filter(X=>X.id!==g))},v=g=>{var xe,$e;const C=g.subject||(($e=(xe=g.campaigns)==null?void 0:xe[0])==null?void 0:$e.subject)||"",X=g.partyName,Z=g.invoiceNo,J=ut(g.invoiceTotalAmount||g.totalAmount||0),fe=gr(g.invoiceDate||g.date);return`Subject: RE: ${C} - Payment Followup for Invoice ${Z}

Dear Sir/Madam,

Greetings from ${S.name}!

This is a gentle reminder regarding the outstanding payment for:

Invoice No: ${Z}
Invoice Date: ${fe}
Amount: ${J}
Party: ${X}

We kindly request you to process the payment at the earliest. If the payment has already been made, please share the payment details for our records.

For any queries, please feel free to reach out.

Thanks & Regards,
Finance Team
${S.name}
Email: ${S.email}
Phone: ${S.phone}`},k=g=>{const C=v(g);navigator.clipboard.writeText(C),alert(" Followup email template copied to clipboard!")},O=g=>{var Z,J;const C=g.subject||((J=(Z=g.campaigns)==null?void 0:Z[0])==null?void 0:J.subject)||"",X=encodeURIComponent(C);window.open(`https://mail.google.com/mail/u/0/#search/${X}`,"_blank")},ne=g=>{var Z;const C=(Z=g.target.files)==null?void 0:Z[0];if(!C)return;const X=new FileReader;X.onload=J=>{const fe=Ac(J.target.result,{type:"binary"}),K=fe.SheetNames[0],xe=fe.Sheets[K],$e=Ni.sheet_to_json(xe),le={};$e.forEach(De=>{const Ge=De["Party Name"]||De["PARTY NAME"]||De.PartyName||"",te=parseFloat(De.Amount||De.AMOUNT||De["Invoice Amount"]||0);Ge&&te>0&&(le[Ge.trim()]=te)}),Gl(De=>({...De,...le})),alert(` Loaded ${Object.keys(le).length} party invoice values!`)},X.readAsBinaryString(C),g.target.value=""},he=()=>{const g=Ni.json_to_sheet([{"Party Name":"ABC Group Private Limited",Amount:5500},{"Party Name":"XYZ Media Pvt Ltd",Amount:7500}]),C=Ni.book_new();Ni.book_append_sheet(C,g,"Invoice Values"),Mg(C,"Invoice_Values_Template.xlsx")},Ve=g=>{var Z;const C=(Z=g.target.files)==null?void 0:Z[0];if(!C)return;const X=new FileReader;X.onload=J=>{const fe=Ac(J.target.result,{type:"binary"}),K=fe.SheetNames[0],xe=fe.Sheets[K],$e=Ni.sheet_to_json(xe),le={...vn};let De=0;$e.forEach(Ge=>{const te=(Ge["Name of Ledger"]||Ge["Party Name"]||Ge["NAME OF LEDGER"]||Ge["PARTY NAME"]||"").trim(),Ke=(Ge["State Name"]||Ge["STATE NAME"]||Ge.State||Ge.STATE||"").trim();if(te){const ce=Xo(Ke),Me=`${te}|${ce}`;le[Me]={partyName:te,ledgerGroup:Ge["Ledger Group"]||Ge["LEDGER GROUP"]||"Sundry Debtors",stateName:Ke,normalizedState:ce,gstRegType:Ge["GST Registration Type"]||Ge["GST REGISTRATION TYPE"]||"Regular",gstin:Ge["GSTIN/UIN"]||Ge.GSTIN||Ge.GST||""},De++}}),Xi(le),alert(` Party Master Updated!

${De} party-state combinations loaded.`)},X.readAsBinaryString(C),g.target.value=""},zt=()=>{const g=Ni.json_to_sheet([{"Sl. No.":1,"Name of Ledger":"ABC PRIVATE LIMITED","Ledger Group":"Sundry Debtors","State Name":"Maharashtra","GST Registration Type":"Regular","GSTIN/UIN":"27AAACA1234A1ZQ"},{"Sl. No.":2,"Name of Ledger":"XYZ MEDIA PVT LTD","Ledger Group":"Sundry Debtors","State Name":"Delhi","GST Registration Type":"Regular","GSTIN/UIN":"07AAACX5678B1ZR"}]),C=Ni.book_new();Ni.book_append_sheet(C,g,"Party Master"),Mg(C,"Party_Master_Template.xlsx")},Xr=g=>{var Z;const C=(Z=g.target.files)==null?void 0:Z[0];if(!C)return;if(!H){alert(" Please select a party first from the list, then import their historical ledger."),g.target.value="";return}const X=new FileReader;X.onload=J=>{const fe=Ac(J.target.result,{type:"binary",cellDates:!0}),K=fe.SheetNames[0],xe=fe.Sheets[K],$e=Ni.sheet_to_json(xe,{raw:!1}),le=[];let De=0,Ge=null;const te=ce=>{if(!ce)return 0;const Me=String(ce).replace(/,/g,"").replace(/[^\d.-]/g,"");return parseFloat(Me)||0},Ke=ce=>{if(!ce||typeof ce!="string")return"";const Me=ce.trim(),Qe=Me.split(/[-\/]/);if(Qe.length===3){const be={jan:"01",feb:"02",mar:"03",apr:"04",may:"05",jun:"06",jul:"07",aug:"08",sep:"09",oct:"10",nov:"11",dec:"12"},Ze=Qe[1].toLowerCase().substring(0,3);if(be[Ze]){const Rt=Qe[0].padStart(2,"0");return`${Qe[2].length===2?parseInt(Qe[2])>50?"19"+Qe[2]:"20"+Qe[2]:Qe[2]}-${be[Ze]}-${Rt}`}}return Me};$e.forEach((ce,Me)=>{const Qe=Ke(ce.Date||ce.DATE||ce.date||""),be=(ce.Particular||ce.PARTICULAR||ce.Particulars||ce.PARTICULARS||"").trim(),Ze=(ce["Vch Type"]||ce["VCH TYPE"]||ce["Voucher Type"]||ce["vch type"]||"").trim(),Rt=(ce["Vch No."]||ce["VCH NO."]||ce["Voucher No"]||ce["Invoice No"]||ce["Vch No"]||ce["vch no."]||"").trim(),Ut=te(ce.Debit||ce.DEBIT||ce.debit),qt=te(ce.Credit||ce.CREDIT||ce.credit),yn=ce["Date of Receipt"]||ce["DATE OF RECEIPT"]||ce["Receipt Date"]||"",ge=te(ce["Amount Received"]||ce["AMOUNT RECEIVED"]||ce["amount received"]),ue=te(ce["TDS amount Received"]||ce["TDS Received"]||ce.TDS||ce.tds),Je=te(ce.Balance||ce.BALANCE||ce.balance),pr=(ce["Payment Status"]||ce["PAYMENT STATUS"]||ce.Status||ce.status||"").trim();if(!Qe&&(be.toUpperCase().includes("PROMOTIONAL")||be.toUpperCase().includes("IGST")||be.toUpperCase().includes("CGST")||be.toUpperCase().includes("SGST")||be.toUpperCase().includes("TRADE EMAILER"))&&Ge)Ge.subRows||(Ge.subRows=[]),Ge.subRows.push({particular:be,debit:Ut,credit:qt});else if(Qe&&(Rt||Ut>0||qt>0)){Ge&&(le.push(Ge),De++);let sr="invoice";Ze.toLowerCase().includes("credit note")||Rt.toUpperCase().startsWith("CN")?sr="creditnote":Ze.toLowerCase().includes("receipt")?sr="receipt":(Ze.toLowerCase().includes("sale")||Ut>0)&&(sr="invoice"),Ge={id:Date.now()+Me,partyName:H,date:Qe,particulars:be||H,narration:Rt,vchType:Ze||"Sales",vchNo:Rt,debit:Ut,credit:qt,receiptDate:yn,amountReceived:ge,tdsReceived:ue,balance:Je,paymentStatus:pr,type:sr,isHistorical:!0,subRows:[]}}}),Ge&&(le.push(Ge),De++),console.log("Parsed entries with sub-rows:",le),De>0?(_e(ce=>[...ce,...le]),alert(` Historical Ledger Uploaded!

${De} entries added for "${H}".`)):alert(` No valid ledger entries found in the file.

Make sure your file has these columns:
 Date (e.g., 02-Jun-21)
 Vch Type (e.g., Sales, Credit Note)
 Vch No. (e.g., MB/2022-23/128)
 Debit or Credit amount`)},X.readAsBinaryString(C),g.target.value="",ua(!1)},Ft=()=>{const g=Ni.json_to_sheet([{Date:"02-Jun-21",Particular:"ABC Corp Ltd.","Vch Type":"Sales","Vch No.":"MB/2020-21/0411",Debit:6e3,Credit:"","Date of Receipt":"","Amount Received":44371,"TDS amount Received":5880,Balance:"","Payment Status":"Received"},{Date:"",Particular:"PROMOTIONAL TRADE EMAILERS","Vch Type":"","Vch No.":"",Debit:"",Credit:22500,"Date of Receipt":"","Amount Received":"","TDS amount Received":"",Balance:"","Payment Status":""},{Date:"",Particular:"IGST","Vch Type":"","Vch No.":"",Debit:"",Credit:4050,"Date of Receipt":"","Amount Received":"","TDS amount Received":"",Balance:"","Payment Status":""},{Date:"26-Mar-25",Particular:"ABC Corp Ltd.","Vch Type":"Credit Note","Vch No.":"CN/2022-23/128",Debit:"",Credit:26550,"Date of Receipt":"","Amount Received":"","TDS amount Received":"",Balance:"","Payment Status":""}]),C=Ni.book_new();Ni.book_append_sheet(C,g,"Historical Ledger"),Mg(C,"Historical_Ledger_Template.xlsx")},nn=g=>{const C=me.find(X=>X.invoiceNo===g);C?ku(C):alert("Invoice not found in system. This may be a historical entry.")},sn=g=>{me.find(X=>X.invoiceNo===g.invoiceNo);let C=` RECEIPT DETAILS

`;C+=`Receipt No: ${g.receiptNo}
`,C+=`Date: ${gr(g.date)}
`,C+=`Party: ${g.partyName}
`,C+=`Invoice: ${g.invoiceNo}

`,C+=`
`,C+=`Amount Received: ${ut(g.amount||0)}
`,C+=`TDS: ${ut(g.tds||0)}
`,C+=`Discount: ${ut(g.discount||0)}
`,C+=`
`,C+=`Total: ${ut((g.amount||0)+(g.tds||0)+(g.discount||0))}
`,g.remarks&&(C+=`
Remarks: ${g.remarks}`),alert(C)},Za=g=>{let C=` CREDIT NOTE DETAILS

`;C+=`Credit Note No: ${g.creditNoteNo}
`,C+=`Date: ${gr(g.date)}
`,C+=`Party: ${g.partyName}
`,C+=`Against Invoice: ${g.invoiceNo}

`,C+=`
`,C+=`Base Amount: ${ut(g.amount||0)}
`,C+=`${g.gstType||"GST"}: ${ut(g.gst||0)}
`,C+=`
`,C+=`Total Credit: ${ut(g.totalAmount||(g.amount||0)+(g.gst||0))}
`,g.reason&&(C+=`
Reason: ${g.reason}`),alert(C)},Ri=g=>{var Z;const C=(Z=g.target.files)==null?void 0:Z[0];if(!C)return;const X=new FileReader;X.onload=J=>{const fe=Ac(J.target.result,{type:"binary",cellDates:!0}),K=fe.SheetNames[0],xe=fe.Sheets[K],$e=Ni.sheet_to_json(xe,{raw:!1}),le=new Set(rn.map(ce=>`${ce.date}|${ce.time||""}|${ce.campaignName||""}|${ce.subject}`.toLowerCase()));let De=0,Ge=0;const te=$e.map((ce,Me)=>{const Qe=ce["CAMPAIGN NAME"]||ce["Campaign Name"]||"",be=bW(Qe);let Ze=ce.DATE||ce.Date||new Date;typeof Ze=="string"&&(Ze=new Date(Ze));const Rt=(ce["PARTY NAME"]||ce["Party Name"]||"").trim(),Ut=ce["SENDER NAME"]||ce["Sender Name"]||"",qt=ce.SUBJECT||ce.Subject||"",yn=ce.TIME||ce.Time||"",ge=ps[Rt]||"",ue=Ze instanceof Date&&!isNaN(Ze)?Ze.toISOString().split("T")[0]:"",Je=`${ue}|${yn}|${Qe}|${qt}`.toLowerCase();return le.has(Je)?(De++,null):(le.add(Je),Ge++,{id:Date.now()+Me+Math.random(),sno:ce.SNO||ce["SNO."]||ce.Sno||Me+1,date:ue,month:ce.Month||ce.MONTH||"",statePartyDetails:ce["State/Party Details"]||ce["STATE/PARTY DETAILS"]||"",partyName:Rt,senderName:Ut,campaignName:Qe,subject:qt,emailId:be,additionalEmails:[],toBeBilled:"Not Yet",invoiceAmount:ge,cgst:"",sgst:"",igst:"",totalWithGst:"",invoiceType:"Individual",combinationCode:"NA",invoiceNo:"",invoiceDate:"",invoiceTotalAmount:"",invoiceGenerated:!1,invoiceStatus:"Pending",mailingSent:"No",mailerUploaded:!1,editComments:""})}).filter(ce=>ce!==null);if(te.length>0){Ie(Me=>[...Me,...te]);const ce=[...new Set(te.map(Me=>Me.partyName))];Kl(Me=>{const Qe=new Set(Me);return ce.forEach(be=>Qe.add(be)),Qe})}let Ke=` Upload Complete!

`;Ke+=` ${Ge} new campaigns added
`,De>0&&(Ke+=` ${De} duplicate entries skipped`),Ge>0&&Bs("upload",` ${Ge} new campaigns uploaded to Master Sheet`,"director"),alert(Ke)},X.readAsBinaryString(C),g.target.value=""},ec=async()=>{Ie([]),_e([]),ke([]),j([]),Qn({}),Go({}),de(1),Ne(1),we(1),G(1),q(null),Kl(new Set),I([]),Xi({}),pn([]);try{await Zg("indreesh-media",{masterData:[],ledgerEntries:[],receipts:[],creditNotes:[],openingBalances:{},mailerImages:{},mailerLogo:gn,companyConfig:S,nextInvoiceNo:1,nextCombineNo:1,nextReceiptNo:1,nextCreditNoteNo:1,invoiceValues:ps,notifications:[],whatsappSettings:re,partyMaster:{},followups:[],userPasswords:y}),console.log("Data cleared and saved to Firebase")}catch(g){console.error("Error clearing data:",g)}Nn(!1),alert(" All master data, invoices, receipts, and ledger entries have been cleared!")},tc=g=>{var Z;const C=parseFloat(g.invoiceAmount)||0;if((Z=g.statePartyDetails)==null?void 0:Z.toUpperCase().includes("MAHARASHTRA")){const J=C*.09,fe=C*.09;return{cgst:J,sgst:fe,igst:0,total:C+J+fe}}else{const J=C*.18;return{cgst:0,sgst:0,igst:J,total:C+J}}},N4=(g,C)=>{const X=me.find(Z=>Z.id===g);Ie(Z=>Z.map(J=>{if(J.id===g){if(C==="Yes"&&J.invoiceAmount){const fe=tc(J);return{...J,toBeBilled:C,cgst:fe.cgst.toFixed(2),sgst:fe.sgst.toFixed(2),igst:fe.igst.toFixed(2),totalWithGst:fe.total.toFixed(2)}}return{...J,toBeBilled:C}}return J})),C==="Yes"&&X&&Bs("info",` Campaign marked for billing: ${X.partyName} - ${X.senderName}`,"finance")},J0=(g,C,X)=>{Ie(Z=>Z.map(J=>{if(J.id===g){const fe={...J,[C]:X};if(C==="invoiceAmount"&&J.toBeBilled==="Yes"){const K=tc(fe);return{...fe,cgst:K.cgst.toFixed(2),sgst:K.sgst.toFixed(2),igst:K.igst.toFixed(2),totalWithGst:K.total.toFixed(2)}}return fe}return J}))},D4=g=>{const C=`${S.invoicePrefix}${Y}`,X=new Date().toISOString().split("T")[0],Z=parseFloat(g.totalWithGst)||parseFloat(g.invoiceAmount)*1.18;Ie(J=>J.map(fe=>fe.id===g.id?{...fe,invoiceNo:C,invoiceDate:X,invoiceTotalAmount:Z.toFixed(2),invoiceGenerated:!0,invoiceStatus:"Created",invoiceType:"Individual",combinationCode:"NA"}:fe)),de(J=>J+1),Bs("invoice",` New Invoice ${C} created for ${g.partyName} - ${ut(Z)}`,"director"),alert(` Invoice Generated!

Invoice No: ${C}
Amount: ${ut(Z)}

Please review and Approve or mark as Need Edits.`)},P4=()=>{if(Et.size<2){alert("Please select at least 2 campaigns to combine");return}const g=`${S.invoicePrefix}${Y}`,C=new Date().toISOString().split("T")[0],X=String(Se);let Z=0;const J=me.filter(fe=>Et.has(fe.id));J.forEach(fe=>{Z+=parseFloat(fe.totalWithGst)||parseFloat(fe.invoiceAmount)*1.18}),Ie(fe=>fe.map(K=>Et.has(K.id)?{...K,invoiceNo:g,invoiceDate:C,invoiceTotalAmount:Z.toFixed(2),invoiceGenerated:!0,invoiceStatus:"Created",invoiceType:"Combined",combinationCode:X,mailingSent:"No"}:K)),de(fe=>fe+1),Ne(fe=>fe+1),$i(!1),kt(new Set),Bs("invoice",` Combined Invoice ${g} created for ${ze} (${J.length} campaigns) - ${ut(Z)}`,"director"),st(null),alert(` Combined Invoice Generated!

Invoice No: ${g}
Campaigns: ${Et.size}
Total: ${ut(Z)}

Please review and Approve or mark as Need Edits.`)},O4=g=>{kt(C=>{const X=new Set(C);return X.has(g)?X.delete(g):X.add(g),X})},M4=g=>{st(g.partyName),kt(new Set([g.id])),$i(!0)},L4=g=>{var Z;const C=(Z=g.target.files)==null?void 0:Z[0];if(!C||!ie)return;const X=new FileReader;X.onload=J=>Zv(J.target.result),X.readAsDataURL(C),g.target.value=""},Zv=g=>{if(!ie)return;const C=ie.id;Qn(xn?X=>({...X,[C]:[g]}):X=>({...X,[C]:[...X[C]||[],g]})),Ie(X=>X.map(Z=>Z.id===ie.id?{...Z,mailerUploaded:!0}:Z)),Ii(null),Ga(!1),mt(!1),alert(" Mailer image saved!")},B4=g=>{var X;const C=(X=g.clipboardData)==null?void 0:X.items;if(C){for(let Z=0;Z<C.length;Z++)if(C[Z].type.indexOf("image")!==-1){const J=C[Z].getAsFile(),fe=new FileReader;fe.onload=K=>Ii(K.target.result),fe.readAsDataURL(J),g.preventDefault();break}}},j4=g=>{const C=encodeURIComponent(g||"campaign");window.open(`https://mail.google.com/mail/u/0/#search/${C}`,"_blank")},V4=g=>{var Z;const C=(Z=g.target.files)==null?void 0:Z[0];if(!C)return;const X=new FileReader;X.onload=J=>Fi(J.target.result),X.readAsDataURL(C),g.target.value=""},ey=g=>{const C=qi(g);if(C.length>1){const X=C.map(Z=>Z.senderName).join(", ");return`Invoice ${g.invoiceNo||""} - ${X}`}return`Invoice ${g.invoiceNo||""} - ${g.senderName} - ${g.subject}`},Z0=g=>{const C=qi(g),X=parseFloat(g.invoiceTotalAmount)||parseFloat(g.totalWithGst)||parseFloat(g.invoiceAmount)*1.18;let Z="";return C.length>1?(Z=`Campaigns included in this invoice:
`,C.forEach((J,fe)=>{Z+=`${fe+1}. ${J.senderName} - ${J.subject}
`})):Z=`Campaign: ${g.senderName}
Subject: ${g.subject}`,`Dear Sir/Madam,

Please find attached the invoice for the following:

${Z}

Invoice No: ${g.invoiceNo||"To be generated"}
Invoice Amount: ${ut(X)}

Kindly process the payment at your earliest convenience.

Bank Details:
Bank: ${S.bank.name}
A/C No: ${S.bank.account}
IFSC: ${S.bank.ifsc}
Branch: ${S.bank.branch}

Thank you for your business.

Best Regards,
${S.name}
${S.email}`},[U4,ty]=ye.useState(!1),[ry,ny]=ye.useState(""),iy=g=>{var Ke;let C=[g],X=parseFloat(g.invoiceAmount)||0;g.invoiceType==="Combined"&&g.combinationCode!=="NA"&&(C=me.filter(ce=>ce.combinationCode===g.combinationCode),X=C.reduce((ce,Me)=>ce+(parseFloat(Me.invoiceAmount)||0),0));const Z=Xa(g.partyName,g.statePartyDetails),J=(Ke=g.statePartyDetails)==null?void 0:Ke.toUpperCase().includes("MAHARASHTRA"),fe=J?X*.09:0,K=J?X*.09:0,xe=J?0:X*.18,$e=fe+K+xe,le=X+$e,De=C.map((ce,Me)=>`
      <tr>
        <td style="border: 1px solid #000; padding: 8px; text-align: center; font-size: 12px;">${Me+1}</td>
        <td style="border: 1px solid #000; padding: 8px; font-size: 12px;">
          <div style="font-weight: 600;">PROMOTIONAL TRADE EMAILER</div>
          <div style="font-style: italic; color: #555; font-size: 11px; margin-top: 2px;">${ce.senderName||""} - ${gr(ce.date)}</div>
          <div style="font-style: italic; color: #555; font-size: 11px;">Subject: ${ce.subject||""}</div>
        </td>
        <td style="border: 1px solid #000; padding: 8px; text-align: center; font-size: 12px;">${S.hsnCode}</td>
        <td style="border: 1px solid #000; padding: 8px; text-align: right; font-size: 12px;">${Vt(parseFloat(ce.invoiceAmount)||0)}</td>
      </tr>
    `).join("");let Ge=[];g.invoiceType==="Combined"&&g.combinationCode!=="NA"?C.forEach(ce=>{(wt[ce.id]||[]).forEach(Qe=>Ge.push({img:Qe,campaign:ce}))}):(wt[g.id]||[]).forEach(Me=>Ge.push({img:Me,campaign:g}));const te=Ge.map(({img:ce,campaign:Me})=>`
      <div class="page-break-before" style="page-break-before: always; padding: 40px; text-align: center; background: white;">
        ${gn?`<div style="margin-bottom: 20px;"><img src="${gn}" alt="Logo" style="max-height: 70px;" /></div>`:`
          <div style="text-align: center; margin-bottom: 25px;">
            <span style="font-size: 22px; font-weight: bold; color: #2874A6;">${S.name}</span>
          </div>
        `}
        <h2 style="font-size: 20px; text-decoration: underline; margin: 25px 0;">MAILER SUPPORTING</h2>
        <p style="font-size: 15px; margin: 12px 0; text-align: left;"><strong>MAILER DATE:</strong> ${FW(Me.date)}</p>
        <p style="font-size: 15px; margin: 12px 0; text-align: left;"><strong>CAMPAIGN:</strong> ${Me.senderName}</p>
        <p style="font-size: 15px; margin: 12px 0; text-align: left;"><strong>SUBJECT:</strong> ${Me.subject||"Campaign"}</p>
        <div style="margin-top: 25px;"><img src="${ce}" alt="Mailer" style="max-width: 100%; max-height: 550px; border: 1px solid #ddd;" /></div>
      </div>
    `).join("");return`
  <div style="max-width: 900px; margin: 0 auto; padding: 15px; background: white; font-family: Arial, sans-serif; font-size: 12px; line-height: 1.4;">
    <style>
      @media print {
        @page { size: A4; margin: 8mm; }
        body { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
        .page-break-before { page-break-before: always; }
      }
    </style>
    <div style="border: 2px solid #000; background: white;">
      <div style="text-align: center; padding: 12px; font-size: 18px; font-weight: bold; border-bottom: 2px solid #000; background: #f8f8f8;">Tax Invoice</div>
      <div style="text-align: center; font-size: 11px; font-style: italic; padding: 5px; border-bottom: 1px solid #000; background: #fafafa;">(Original for Recipient)</div>
      <div style="display: flex; border-bottom: 2px solid #000;">
        <div style="flex: 1.5; padding: 12px; border-right: 2px solid #000;">
          <div style="font-size: 16px; font-weight: bold; margin-bottom: 8px; color: #1a5276;">${S.name}</div>
          <div style="font-size: 11px; line-height: 1.5; color: #333;">${S.address}<br>${S.addressLine2}<br>${S.city}<br><strong>GSTIN/UIN:</strong> ${S.gstin}<br><strong>State:</strong> ${S.stateName}, Code: ${S.stateCode}<br><strong>Contact:</strong> ${S.phone}<br><strong>E-Mail:</strong> ${S.email}</div>
        </div>
        <div style="flex: 1; font-size: 12px;">
          <div style="display: flex; border-bottom: 1px solid #000;"><div style="flex: 1; padding: 8px; border-right: 1px solid #000; font-weight: bold; background: #f5f5f5;">Invoice No.</div><div style="flex: 1; padding: 8px; font-weight: 600; color: #1a5276;">${g.invoiceNo||""}</div></div>
          <div style="display: flex;"><div style="flex: 1; padding: 8px; border-right: 1px solid #000; font-weight: bold; background: #f5f5f5;">Dated</div><div style="flex: 1; padding: 8px;">${gr(g.invoiceDate||g.date)}</div></div>
        </div>
      </div>
      <div style="padding: 10px 12px; border-bottom: 2px solid #000; background: #fafafa;">
        <div style="font-size: 11px; color: #666; margin-bottom: 3px;">Buyer (Bill to)</div>
        <div style="font-size: 14px; font-weight: bold; margin-bottom: 4px; color: #1a5276;">${g.partyName}</div>
        <div style="font-size: 11px; color: #333;">${g.statePartyDetails||""}${Z?"<br><strong>GSTIN/UIN:</strong> "+Z:""}<br>Place of Supply: ${g.statePartyDetails||S.stateName}</div>
      </div>
      <table style="width: 100%; border-collapse: collapse;">
        <thead><tr style="background: #e8e8e8;"><th style="border: 1px solid #000; padding: 10px; width: 45px; font-size: 12px;">Sl No.</th><th style="border: 1px solid #000; padding: 10px; font-size: 12px;">Particulars</th><th style="border: 1px solid #000; padding: 10px; width: 80px; font-size: 12px;">HSN/SAC</th><th style="border: 1px solid #000; padding: 10px; width: 100px; text-align: right; font-size: 12px;">Amount</th></tr></thead>
        <tbody>
          ${De}
          ${C.length>1?'<tr style="background: #f5f5f5;"><td colspan="3" style="border: 1px solid #000; padding: 10px; text-align: right; font-weight: bold; font-size: 13px;">Sub Total</td><td style="border: 1px solid #000; padding: 10px; text-align: right; font-weight: bold; font-size: 13px;">'+Vt(X)+"</td></tr>":""}
          ${J?`<tr><td colspan="3" style="border: 1px solid #000; padding: 8px; text-align: right; font-weight: 600; font-size: 12px;">CGST @ 9%</td><td style="border: 1px solid #000; padding: 8px; text-align: right; font-size: 12px;">${Vt(fe)}</td></tr><tr><td colspan="3" style="border: 1px solid #000; padding: 8px; text-align: right; font-weight: 600; font-size: 12px;">SGST @ 9%</td><td style="border: 1px solid #000; padding: 8px; text-align: right; font-size: 12px;">${Vt(K)}</td></tr>`:`<tr><td colspan="3" style="border: 1px solid #000; padding: 8px; text-align: right; font-weight: 600; font-size: 12px;">IGST @ 18%</td><td style="border: 1px solid #000; padding: 8px; text-align: right; font-size: 12px;">${Vt(xe)}</td></tr>`}
          <tr style="background: #2874A6; color: white;"><td colspan="3" style="border: 1px solid #000; padding: 12px; text-align: right; font-weight: bold; font-size: 14px;">Total</td><td style="border: 1px solid #000; padding: 12px; text-align: right; font-weight: bold; font-size: 14px;"> ${le.toLocaleString("en-IN",{minimumFractionDigits:2})}</td></tr>
        </tbody>
      </table>
      <div style="padding: 10px 12px; border: 1px solid #000; border-top: none; background: #fafafa;"><div style="color: #666; font-size: 11px; margin-bottom: 3px;">Amount Chargeable (in words)</div><div style="font-weight: bold; font-size: 13px;">${IW(le)}</div></div>
      <div style="display: flex; border-top: 2px solid #000;">
        <div style="flex: 1; padding: 10px 12px; border-right: 2px solid #000; font-size: 11px;"><div><strong>Company's PAN:</strong> ${S.pan}</div></div>
        <div style="flex: 1.2; padding: 10px 12px; font-size: 11px;">
          <div style="font-weight: bold; margin-bottom: 6px; color: #1a5276;">Company's Bank Details</div>
          <div style="line-height: 1.5;"><strong>A/c Holder:</strong> ${S.bank.holder}<br><strong>Bank:</strong> ${S.bank.name}<br><strong>A/c No.:</strong> ${S.bank.account}<br><strong>IFSC:</strong> ${S.bank.ifsc}</div>
          <div style="text-align: right; margin-top: 30px;"><div style="font-weight: bold;">for ${S.name}</div><div style="margin-top: 25px; border-top: 1px solid #000; display: inline-block; padding-top: 4px; font-size: 10px;">Authorised Signatory</div></div>
        </div>
      </div>
      <div style="text-align: center; padding: 8px; background: #f0f0f0; border-top: 1px solid #000; font-size: 10px; color: #666; font-style: italic;">This is a Computer Generated Invoice</div>
    </div>
  </div>
  ${te}
`},z4=g=>{const C=iy(g);ny(C),jr(g),ty(!0)},W4=g=>{const C=`<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Invoice ${g.invoiceNo||""}</title>
  <style>
    @page { size: A4; margin: 10mm; }
    @media print { body { -webkit-print-color-adjust: exact; print-color-adjust: exact; } }
    body { font-family: Arial, sans-serif; margin: 0; padding: 20px; }
  </style>
</head>
<body>
${iy(g)}
<script>
  // Auto-open print dialog when file is opened
  window.onload = function() { 
    setTimeout(function() { window.print(); }, 500); 
  };
<\/script>
</body>
</html>`,X=new Blob([C],{type:"text/html"}),Z=URL.createObjectURL(X),J=document.createElement("a");J.href=Z,J.download=`Invoice_${(g.invoiceNo||"draft").replace(/\//g,"-")}.html`,document.body.appendChild(J),J.click(),document.body.removeChild(J),URL.revokeObjectURL(Z)},ku=g=>{z4(g)},H4=()=>{const g=parseFloat(Yt.amount)||0,C=parseFloat(Yt.tds)||0,X=parseFloat(Yt.discount)||0,Z=g+C+X;let J=parseFloat(ie.invoiceTotalAmount)||parseFloat(ie.totalWithGst)||parseFloat(ie.invoiceAmount)*1.18;const fe=Z>=J?"Paid":"Partially Paid";ie.invoiceType==="Combined"&&ie.combinationCode!=="NA"?Ie(xe=>xe.map($e=>$e.combinationCode===ie.combinationCode?{...$e,invoiceStatus:fe}:$e)):Ie(xe=>xe.map($e=>$e.id===ie.id?{...$e,invoiceStatus:fe}:$e));const K=[];g>0&&K.push({id:Date.now(),partyName:ie.partyName,date:Yt.date,particulars:Yt.narration?`Payment Received - ${Yt.mode} (${Yt.narration})`:`Payment Received - ${Yt.mode}`,debit:0,credit:g,type:"payment"}),C>0&&K.push({id:Date.now()+1,partyName:ie.partyName,date:Yt.date,particulars:`TDS Deducted - Inv: ${ie.invoiceNo}`,debit:0,credit:C,type:"tds"}),X>0&&K.push({id:Date.now()+2,partyName:ie.partyName,date:Yt.date,particulars:`Discount Allowed - Inv: ${ie.invoiceNo}`,debit:0,credit:X,type:"discount"}),_e(xe=>[...xe,...K]),Jt(!1),jr(null)},sy=g=>{Kl(C=>{const X=new Set(C);return X.has(g)?X.delete(g):X.add(g),X})},$4=()=>{const X=r==="director"?[{id:"master",icon:j2,label:"Master Sheet"},{id:"invoices",icon:ju,label:"Invoice Register"},{id:"ledgers",icon:D2,label:"Party Ledgers"},{id:"followups",icon:Nd,label:"Followups"},{id:"reports",icon:R2,label:"Reports"}]:[{id:"master",icon:j2,label:"Master Sheet"},{id:"invoices",icon:ju,label:"Invoice Register"},{id:"ledgers",icon:D2,label:"Party Ledgers"},{id:"followups",icon:Nd,label:"Followups"},{id:"reports",icon:R2,label:"Reports"},{id:"settings",icon:UB,label:"Settings"}];return f.jsxs("div",{style:{width:R?"60px":"220px",backgroundColor:"#1E293B",color:"#FFFFFF",display:"flex",flexDirection:"column",transition:"width 0.2s ease",flexShrink:0},children:[f.jsxs("div",{style:{padding:R?"12px":"16px",borderBottom:"1px solid #334155",display:"flex",alignItems:"center",justifyContent:R?"center":"space-between"},children:[!R&&f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[f.jsx("img",{src:"/logo.png",alt:"JAC",style:{width:"32px",height:"auto",borderRadius:"4px",backgroundColor:"white",padding:"2px"}}),f.jsxs("div",{children:[f.jsx("div",{style:{fontSize:"16px",fontWeight:"700"},children:"FinMate"}),f.jsx("div",{style:{fontSize:"10px",color:"#94A3B8"},children:r==="director"?"Director View":"Finance Team"})]})]}),f.jsx("button",{onClick:()=>Ue(!R),style:{background:"none",border:"none",color:"#94A3B8",cursor:"pointer",padding:"4px"},children:R?f.jsx(Lg,{size:18}):f.jsx(OB,{size:18})})]}),!R&&f.jsx("div",{style:{padding:"8px 16px",borderBottom:"1px solid #334155",fontSize:"11px"},children:d?f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",color:"#FCD34D"},children:[f.jsx(M2,{size:12,style:{animation:"spin 1s linear infinite"}}),f.jsx("span",{children:"Saving..."})]}):p?f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",color:"#86EFAC"},children:[f.jsx(P2,{size:12}),f.jsxs("span",{children:["Saved ",p.toLocaleTimeString()]})]}):f.jsx("div",{style:{color:"#94A3B8"},children:"Cloud Sync Active"})}),f.jsx("div",{style:{padding:"8px",borderBottom:"1px solid #334155"},children:f.jsxs("button",{onClick:()=>Hl(!0),style:{width:"100%",display:"flex",alignItems:"center",gap:"10px",padding:R?"12px":"11px 14px",borderRadius:"8px",border:"none",backgroundColor:pi>0?"#FEF3C7":"#334155",color:pi>0?"#92400E":"#94A3B8",cursor:"pointer",fontSize:"14px",fontWeight:pi>0?"700":"500",justifyContent:R?"center":"flex-start",position:"relative"},title:"Notifications",children:[pi>0?f.jsx(NB,{size:18}):f.jsx(N2,{size:18}),!R&&f.jsx("span",{children:"Notifications"}),pi>0&&f.jsx("span",{style:{position:R?"absolute":"static",top:R?"4px":"auto",right:R?"4px":"auto",marginLeft:R?"0":"auto",backgroundColor:"#DC2626",color:"#FFFFFF",padding:"2px 6px",borderRadius:"10px",fontSize:"11px",fontWeight:"700",minWidth:"18px",textAlign:"center"},children:pi})]})}),f.jsx("nav",{style:{flex:1,padding:"8px"},children:X.map(Z=>f.jsxs("button",{onClick:()=>D(Z.id),style:{width:"100%",display:"flex",alignItems:"center",gap:"10px",padding:R?"12px":"11px 14px",marginBottom:"4px",borderRadius:"8px",border:"none",backgroundColor:N===Z.id?"#2874A6":"transparent",color:N===Z.id?"#FFFFFF":"#94A3B8",cursor:"pointer",fontSize:"14px",fontWeight:N===Z.id?"600":"500",justifyContent:R?"center":"flex-start"},title:Z.label,children:[f.jsx(Z.icon,{size:18}),!R&&f.jsx("span",{children:Z.label})]},Z.id))}),f.jsxs("div",{style:{padding:"8px",borderTop:"1px solid #334155"},children:[f.jsxs("button",{onClick:()=>{_(!0),W({currentPassword:"",newPassword:"",confirmPassword:""}),w("")},style:{width:"100%",display:"flex",alignItems:"center",gap:"10px",padding:R?"12px":"11px 14px",marginBottom:"8px",borderRadius:"8px",border:"none",backgroundColor:"#475569",color:"#FFFFFF",cursor:"pointer",fontSize:"14px",fontWeight:"500",justifyContent:R?"center":"flex-start"},title:"Change Password",children:[f.jsx(Rd,{size:18}),!R&&f.jsx("span",{children:"Change Password"})]}),f.jsxs("button",{onClick:U0,style:{width:"100%",display:"flex",alignItems:"center",gap:"10px",padding:R?"12px":"11px 14px",borderRadius:"8px",border:"none",backgroundColor:"#DC2626",color:"#FFFFFF",cursor:"pointer",fontSize:"14px",fontWeight:"600",justifyContent:R?"center":"flex-start"},title:"Logout",children:[f.jsx(rl,{size:18}),!R&&f.jsx("span",{children:"Logout"})]})]})]})},G4=()=>f.jsx("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"10px",border:"1px solid #E2E8F0",padding:"14px 18px",marginBottom:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"14px",flexWrap:"wrap"},children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[f.jsx(jg,{size:18,color:"#64748B"}),f.jsx("span",{style:{fontSize:"13px",fontWeight:"700",color:"#475569"},children:"Filters:"})]}),f.jsxs("div",{style:{position:"relative"},children:[f.jsx(Dd,{size:15,style:{position:"absolute",left:"10px",top:"50%",transform:"translateY(-50%)",color:"#94A3B8"}}),f.jsx("input",{type:"text",placeholder:"Search...",value:Xe.searchText,onChange:g=>Ms(C=>({...C,searchText:g.target.value})),style:{padding:"8px 12px 8px 32px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",width:"160px"}})]}),f.jsxs("select",{value:Xe.party,onChange:g=>Ms(C=>({...C,party:g.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:Xe.party?"#EFF6FF":"#FFFFFF"},children:[f.jsx("option",{value:"",children:"All Parties"}),Qa.map(g=>f.jsx("option",{value:g,children:g},g))]}),f.jsxs("select",{value:Xe.billStatus,onChange:g=>Ms(C=>({...C,billStatus:g.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:Xe.billStatus?"#EFF6FF":"#FFFFFF"},children:[f.jsx("option",{value:"",children:"Bill Status"}),f.jsx("option",{value:"Yes",children:"Yes"}),f.jsx("option",{value:"Not Yet",children:"Not Yet"})]}),f.jsxs("select",{value:Xe.invoiceStatus,onChange:g=>Ms(C=>({...C,invoiceStatus:g.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:Xe.invoiceStatus?"#EFF6FF":"#FFFFFF"},children:[f.jsx("option",{value:"",children:"Invoice Status"}),f.jsx("option",{value:"Generated",children:"Generated"}),f.jsx("option",{value:"Not Generated",children:"Not Generated"}),f.jsx("option",{value:"Paid",children:"Paid"})]}),Ql&&f.jsxs(f.Fragment,{children:[f.jsxs("button",{onClick:Yp,style:{padding:"8px 12px",fontSize:"13px",fontWeight:"600",border:"1.5px solid #FCA5A5",borderRadius:"8px",backgroundColor:"#FEE2E2",color:"#991B1B",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},children:[f.jsx(rl,{size:14})," Clear"]}),f.jsxs("span",{style:{fontSize:"13px",color:"#64748B"},children:["Showing ",qo.length," of ",me.length]})]})]})}),ay=()=>{const g=me.filter(K=>K.toBeBilled==="Yes"&&K.invoiceGenerated&&K.mailingSent==="Yes"&&(K.receiptStatus==="Received"||K.receiptStatus==="Cancelled"||K.receiptStatus==="Closed")),C=me.filter(K=>!(K.toBeBilled==="Yes"&&K.invoiceGenerated&&K.mailingSent==="Yes"&&(K.receiptStatus==="Received"||K.receiptStatus==="Cancelled"||K.receiptStatus==="Closed"))),X=Dn==="open"?C:g,Z=X.filter(K=>{var xe,$e,le,De,Ge;if(Xe.party&&K.partyName!==Xe.party||Xe.billStatus&&K.toBeBilled!==Xe.billStatus||Xe.invoiceType&&K.invoiceType!==Xe.invoiceType||Xe.mailingStatus&&(Xe.mailingStatus==="Sent"&&K.mailingSent!=="Yes"||Xe.mailingStatus==="Not Sent"&&K.mailingSent==="Yes")||Xe.invoiceStatus&&(Xe.invoiceStatus==="Generated"&&!K.invoiceGenerated||Xe.invoiceStatus==="Not Generated"&&K.invoiceGenerated||Xe.invoiceStatus==="Approved"&&K.invoiceStatus!=="Approved"||Xe.invoiceStatus==="Need Edits"&&K.invoiceStatus!=="Need Edits"||Xe.invoiceStatus==="Paid"&&K.invoiceStatus!=="Paid"))return!1;if(Xe.searchText){const te=Xe.searchText.toLowerCase();if(!((xe=K.partyName)!=null&&xe.toLowerCase().includes(te))&&!(($e=K.senderName)!=null&&$e.toLowerCase().includes(te))&&!((le=K.campaignName)!=null&&le.toLowerCase().includes(te))&&!((De=K.subject)!=null&&De.toLowerCase().includes(te))&&!((Ge=K.invoiceNo)!=null&&Ge.toLowerCase().includes(te)))return!1}return!0}),J=Z.reduce((K,xe)=>{const $e=xe.partyName||"Unknown";return K[$e]||(K[$e]=[]),K[$e].push(xe),K},{}),fe=Object.keys(J).sort();return f.jsxs("div",{children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[f.jsxs("div",{children:[f.jsx("h1",{style:{margin:0,fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:" Master Sheet"}),f.jsxs("p",{style:{margin:"4px 0 0",fontSize:"14px",color:"#64748B"},children:[me.length," campaigns  ",Qa.length," parties  ",me.filter(K=>K.invoiceGenerated).length," invoiced"]})]}),f.jsxs("div",{style:{display:"flex",gap:"10px"},children:[f.jsx("input",{type:"file",ref:D0,accept:".xlsx,.xls,.csv",style:{display:"none"},onChange:Ri}),f.jsx(Ye,{icon:Hs,label:"Upload Data",variant:"brand",onClick:()=>{var K;return(K=D0.current)==null?void 0:K.click()}}),er&&me.length>0&&f.jsx(Ye,{icon:Ws,label:"Clear All Data",variant:"danger",onClick:()=>Nn(!0)})]})]}),f.jsxs("div",{style:{display:"flex",gap:"4px",marginBottom:"16px",backgroundColor:"#F1F5F9",padding:"4px",borderRadius:"10px",width:"fit-content"},children:[f.jsxs("button",{onClick:()=>Os("open"),style:{padding:"10px 20px",fontSize:"14px",fontWeight:"600",border:"none",borderRadius:"8px",cursor:"pointer",backgroundColor:Dn==="open"?"#FFFFFF":"transparent",color:Dn==="open"?"#1E293B":"#64748B",boxShadow:Dn==="open"?"0 2px 4px rgba(0,0,0,0.1)":"none"},children:[" Open Invoices (",C.length,")"]}),f.jsxs("button",{onClick:()=>Os("closed"),style:{padding:"10px 20px",fontSize:"14px",fontWeight:"600",border:"none",borderRadius:"8px",cursor:"pointer",backgroundColor:Dn==="closed"?"#FFFFFF":"transparent",color:Dn==="closed"?"#1E293B":"#64748B",boxShadow:Dn==="closed"?"0 2px 4px rgba(0,0,0,0.1)":"none"},children:[" Closed Invoices (",g.length,")"]})]}),me.length>0&&G4(),fe.length===0?f.jsx(_n,{children:f.jsxs("div",{style:{padding:"60px",textAlign:"center",color:"#94A3B8"},children:[f.jsx(Hs,{size:48,style:{marginBottom:"16px",opacity:.5}}),f.jsx("div",{style:{fontSize:"18px",fontWeight:"600"},children:Ql?"No matching records":Dn==="closed"?"No closed invoices yet":"No Data Yet"}),f.jsx("div",{style:{fontSize:"14px",marginTop:"4px"},children:Ql?"Try adjusting your filters":Dn==="closed"?"Invoices will appear here once billed, mailed, and payment received":"Upload an Excel file to get started"})]})}):f.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:fe.map(K=>{const xe=J[K],$e=Ko.has(K),le=xe.filter(te=>te.toBeBilled==="Yes").length,De=xe.filter(te=>te.invoiceGenerated).length,Ge=xe.filter(te=>te.toBeBilled==="Yes").reduce((te,Ke)=>te+(parseFloat(Ke.totalWithGst)||0),0);return f.jsxs("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"12px",border:"1px solid #E2E8F0",overflow:"hidden",boxShadow:"0 2px 8px rgba(0,0,0,0.04)"},children:[f.jsxs("div",{onClick:()=>sy(K),style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"16px 20px",backgroundColor:Dn==="closed"?"#F0FDF4":"#F8FAFC",cursor:"pointer",borderBottom:$e?"3px solid #2874A6":"none"},children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[$e?f.jsx(O2,{size:22,color:"#2874A6"}):f.jsx(Lg,{size:22,color:"#64748B"}),f.jsxs("div",{children:[f.jsx("div",{style:{fontWeight:"700",fontSize:"16px",color:"#1E293B"},children:K}),f.jsxs("div",{style:{fontSize:"13px",color:"#64748B",marginTop:"3px"},children:[xe.length," campaigns  ",le," billed  ",De," invoiced"]})]})]}),Ge>0&&f.jsxs("div",{style:{textAlign:"right"},children:[f.jsx("div",{style:{fontSize:"11px",color:"#64748B",textTransform:"uppercase"},children:"Total"}),f.jsx("div",{style:{fontSize:"18px",fontWeight:"700",color:"#059669"},children:ut(Ge)})]})]}),$e&&f.jsx("div",{style:{overflowX:"auto"},children:f.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"13px",minWidth:"2100px"},children:[f.jsx("thead",{children:f.jsxs("tr",{style:{backgroundColor:"#F1F5F9"},children:[f.jsx("th",{style:{padding:"12px 14px",textAlign:"left",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"90px"},children:"Date"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"left",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"100px"},children:"Sender"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"left",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",minWidth:"180px"},children:"Campaign / Subject"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"left",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"160px"},children:"Email ID"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"70px"},children:"Mailer"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"80px"},children:"Bill?"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"right",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"90px"},children:"Amount"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"90px"},children:"Type"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"90px"},children:"Generate"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"left",fontWeight:"700",color:"#1E40AF",borderBottom:"2px solid #E2E8F0",backgroundColor:"#EFF6FF",width:"110px"},children:"Invoice No."}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"left",fontWeight:"700",color:"#1E40AF",borderBottom:"2px solid #E2E8F0",backgroundColor:"#EFF6FF",width:"90px"},children:"Inv Date"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"right",fontWeight:"700",color:"#1E40AF",borderBottom:"2px solid #E2E8F0",backgroundColor:"#EFF6FF",width:"100px"},children:"Inv Amount"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#7C3AED",borderBottom:"2px solid #E2E8F0",backgroundColor:"#FAF5FF",width:"50px"},children:"C#"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"120px"},children:"Status/Approve"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#475569",borderBottom:"2px solid #E2E8F0",width:"120px"},children:"Actions"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#059669",borderBottom:"2px solid #E2E8F0",backgroundColor:"#F0FDF4",width:"80px"},children:"Mailed?"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#059669",borderBottom:"2px solid #E2E8F0",backgroundColor:"#F0FDF4",width:"90px"},children:"Mail Date"}),f.jsx("th",{style:{padding:"12px 14px",textAlign:"center",fontWeight:"700",color:"#7C3AED",borderBottom:"2px solid #E2E8F0",backgroundColor:"#FAF5FF",width:"100px"},children:"Receipt"})]})}),f.jsx("tbody",{children:xe.map(te=>{var Me,Qe;const Ke=te.invoiceType==="Combined"&&z0(te.combinationCode)&&te.mailingSent!=="Yes";ys(te);const ce=wt[te.id]&&wt[te.id].length>0;return f.jsxs("tr",{style:{backgroundColor:te.toBeBilled==="Yes"?te.invoiceGenerated?"#F0FDF4":"#FFFBEB":"#FFFFFF",borderBottom:"1px solid #F1F5F9"},children:[f.jsx("td",{style:{padding:"12px 14px",whiteSpace:"nowrap",fontSize:"13px"},children:gr(te.date)}),f.jsx("td",{style:{padding:"12px 14px",fontWeight:"600",fontSize:"13px"},children:te.senderName}),f.jsxs("td",{style:{padding:"12px 14px"},children:[f.jsx("div",{style:{fontWeight:"600",fontSize:"13px",lineHeight:"1.4",color:"#1E293B"},children:((Qe=(Me=te.campaignName)==null?void 0:Me.split("--")[0])==null?void 0:Qe.trim())||te.senderName}),te.subject&&f.jsx("div",{style:{fontSize:"12px",color:"#64748B",marginTop:"4px",lineHeight:"1.3"},children:te.subject})]}),f.jsx("td",{style:{padding:"10px 14px"},children:f.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[te.emailId&&f.jsx("div",{style:{fontSize:"11px",color:"#1E40AF",backgroundColor:"#EFF6FF",padding:"2px 6px",borderRadius:"4px",display:"inline-block"},children:te.emailId}),(te.additionalEmails||[]).map((be,Ze)=>f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[f.jsx("span",{style:{fontSize:"11px",color:"#059669",backgroundColor:"#F0FDF4",padding:"2px 6px",borderRadius:"4px"},children:be}),f.jsx("button",{onClick:()=>H0(te.id,be),style:{background:"none",border:"none",cursor:"pointer",padding:"2px",color:"#DC2626"},title:"Remove",children:f.jsx(rl,{size:12})})]},Ze)),f.jsxs("button",{onClick:()=>{jr(te),la(""),Fr(!0)},style:{display:"flex",alignItems:"center",gap:"4px",fontSize:"11px",color:"#2874A6",background:"none",border:"none",cursor:"pointer",padding:"2px 0"},children:[f.jsx(L2,{size:12})," Add"]})]})}),f.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:ce?f.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"2px"},children:[f.jsx("span",{style:{color:"#22C55E",fontWeight:"700",fontSize:"14px"},children:""}),f.jsx("button",{onClick:()=>{jr(te),Ii(null),Ga(!0),mt(!0)},style:{fontSize:"10px",color:"#64748B",background:"none",border:"none",cursor:"pointer",textDecoration:"underline"},children:"Replace"})]}):f.jsx(Ye,{icon:PB,small:!0,variant:"default",onClick:()=>{jr(te),Ii(null),Ga(!1),mt(!0)}})}),f.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:f.jsxs("select",{value:te.toBeBilled,onChange:be=>N4(te.id,be.target.value),disabled:te.invoiceGenerated||!Kr,style:{padding:"6px 8px",fontSize:"12px",fontWeight:"600",border:"2px solid",borderRadius:"6px",borderColor:te.toBeBilled==="Yes"?"#22C55E":"#E2E8F0",backgroundColor:te.toBeBilled==="Yes"?"#DCFCE7":"#FFFFFF",color:te.toBeBilled==="Yes"?"#166534":"#64748B",cursor:te.invoiceGenerated||!Kr?"not-allowed":"pointer",width:"70px",opacity:!Kr&&!te.invoiceGenerated?.6:1},children:[f.jsx("option",{value:"Not Yet",children:"Not Yet"}),f.jsx("option",{value:"Yes",children:"Yes"})]})}),f.jsx("td",{style:{padding:"10px 14px"},children:f.jsx("input",{type:"number",value:te.invoiceAmount||"",onChange:be=>J0(te.id,"invoiceAmount",be.target.value),disabled:te.invoiceGenerated,placeholder:"0",style:{width:"80px",padding:"6px 8px",fontSize:"13px",fontWeight:"600",border:"1.5px solid #D1D5DB",borderRadius:"6px",textAlign:"right",backgroundColor:te.invoiceGenerated?"#F3F4F6":"#FFFFFF"}})}),f.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:te.invoiceGenerated?f.jsx(em,{status:te.invoiceType,small:!0}):te.toBeBilled==="Yes"?f.jsxs("select",{value:te.invoiceType||"Individual",onChange:be=>J0(te.id,"invoiceType",be.target.value),style:{padding:"6px 6px",fontSize:"11px",fontWeight:"600",border:"2px solid",borderRadius:"6px",borderColor:te.invoiceType==="Combined"?"#7C3AED":"#A5B4FC",backgroundColor:te.invoiceType==="Combined"?"#F3E8FF":"#E0E7FF",color:te.invoiceType==="Combined"?"#6B21A8":"#3730A3",cursor:"pointer",width:"80px"},children:[f.jsx("option",{value:"Individual",children:"Individual"}),f.jsx("option",{value:"Combined",children:"Combined"})]}):f.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),f.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:te.toBeBilled==="Yes"&&!te.invoiceGenerated&&te.invoiceAmount&&er?te.invoiceType==="Individual"?f.jsx(Ye,{icon:Vu,label:"Create",small:!0,variant:"warning",onClick:()=>D4(te)}):f.jsx(Ye,{icon:BB,label:"Combine",small:!0,variant:"purple",onClick:()=>M4(te)}):te.toBeBilled==="Yes"&&!te.invoiceGenerated&&te.invoiceAmount&&Kr?f.jsx("span",{style:{fontSize:"10px",color:"#94A3B8"},children:"Finance to create"}):f.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),f.jsx("td",{style:{padding:"10px 14px",backgroundColor:"#EFF6FF"},children:te.invoiceNo?f.jsx("span",{style:{fontWeight:"700",color:"#1E40AF",fontSize:"12px"},children:te.invoiceNo}):f.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),f.jsx("td",{style:{padding:"10px 14px",backgroundColor:"#EFF6FF",fontSize:"12px"},children:te.invoiceDate?gr(te.invoiceDate):"-"}),f.jsx("td",{style:{padding:"10px 14px",backgroundColor:"#EFF6FF",textAlign:"right",fontWeight:"700",color:"#1E40AF",fontSize:"13px"},children:te.invoiceTotalAmount?Vt(te.invoiceTotalAmount):"-"}),f.jsx("td",{style:{padding:"10px 14px",textAlign:"center",backgroundColor:"#FAF5FF"},children:te.combinationCode&&te.combinationCode!=="NA"?f.jsx("span",{style:{fontWeight:"700",color:"#7C3AED",fontSize:"12px"},children:te.combinationCode}):"-"}),f.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:te.invoiceGenerated?Kr?f.jsx("button",{onClick:()=>Tu(te),style:{padding:"5px 10px",fontSize:"11px",fontWeight:"700",border:"1.5px solid",borderRadius:"6px",cursor:"pointer",backgroundColor:te.invoiceStatus==="Approved"?"#DCFCE7":te.invoiceStatus==="Need Edits"?"#FEE2E2":"#FEF3C7",borderColor:te.invoiceStatus==="Approved"?"#22C55E":te.invoiceStatus==="Need Edits"?"#DC2626":"#F59E0B",color:te.invoiceStatus==="Approved"?"#166534":te.invoiceStatus==="Need Edits"?"#991B1B":"#92400E"},children:te.invoiceStatus==="Approved"?" Approved":te.invoiceStatus==="Need Edits"?" Need Edits":" Review"}):f.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"4px"},children:[f.jsx("span",{style:{padding:"4px 10px",fontSize:"11px",fontWeight:"700",borderRadius:"6px",backgroundColor:te.invoiceStatus==="Approved"?"#DCFCE7":te.invoiceStatus==="Need Edits"?"#FEE2E2":"#FEF3C7",color:te.invoiceStatus==="Approved"?"#166534":te.invoiceStatus==="Need Edits"?"#991B1B":"#92400E"},children:te.invoiceStatus==="Approved"?" Approved":te.invoiceStatus==="Need Edits"?" Need Edits":" Pending"}),(te.editComments||te.approvalRemarks)&&f.jsx("button",{onClick:()=>{jr(te),Ot(!0)},style:{fontSize:"9px",color:te.invoiceStatus==="Need Edits"?"#991B1B":"#166534",background:"none",border:"none",cursor:"pointer",textDecoration:"underline"},title:te.editComments||te.approvalRemarks,children:"View Remarks"})]}):f.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),f.jsx("td",{style:{padding:"10px 14px",textAlign:"center"},children:te.invoiceGenerated&&te.invoiceStatus==="Approved"?f.jsxs("div",{style:{display:"flex",gap:"6px",justifyContent:"center"},children:[f.jsx(Ye,{icon:bd,small:!0,onClick:()=>ku(te),title:"View Invoice"}),er&&f.jsx(Ye,{icon:Vg,small:!0,variant:"brand",onClick:()=>{jr(te),ht(!0)},title:"Send Email"}),er&&f.jsx(Ye,{icon:Ws,small:!0,variant:"danger",onClick:()=>Jl(te),title:"Delete"})]}):te.invoiceGenerated?f.jsxs("div",{style:{display:"flex",gap:"6px",justifyContent:"center"},children:[f.jsx(Ye,{icon:bd,small:!0,onClick:()=>ku(te),title:"View Invoice"}),er&&f.jsx(Ye,{icon:Ws,small:!0,variant:"danger",onClick:()=>Jl(te),title:"Delete"})]}):f.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),f.jsx("td",{style:{padding:"10px 14px",textAlign:"center",backgroundColor:"#F0FDF4"},children:te.invoiceGenerated&&te.invoiceStatus==="Approved"&&er?Ke?f.jsx("span",{style:{fontSize:"10px",color:"#94A3B8"},children:"Combined sent"}):f.jsxs("select",{value:te.mailingSent||"No",onChange:be=>J0(te.id,"mailingSent",be.target.value),style:{padding:"5px 8px",fontSize:"11px",fontWeight:"700",border:"2px solid",borderRadius:"6px",borderColor:te.mailingSent==="Yes"?"#22C55E":"#E2E8F0",backgroundColor:te.mailingSent==="Yes"?"#DCFCE7":"#FFFFFF",color:te.mailingSent==="Yes"?"#166534":"#64748B",cursor:"pointer",width:"60px"},children:[f.jsx("option",{value:"No",children:"No"}),f.jsx("option",{value:"Yes",children:"Yes"})]}):te.invoiceGenerated&&te.invoiceStatus==="Approved"&&Kr?f.jsx("span",{style:{padding:"4px 8px",borderRadius:"6px",fontSize:"11px",fontWeight:"600",backgroundColor:te.mailingSent==="Yes"?"#DCFCE7":"#FEF3C7",color:te.mailingSent==="Yes"?"#166534":"#92400E"},children:te.mailingSent==="Yes"?" Yes":" No"}):te.invoiceGenerated&&te.invoiceStatus!=="Approved"?f.jsx("span",{style:{fontSize:"10px",color:"#94A3B8"},children:"Approve first"}):f.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),f.jsx("td",{style:{padding:"10px 14px",textAlign:"center",backgroundColor:"#F0FDF4"},children:te.mailingSent==="Yes"?er?f.jsx("input",{type:"date",value:te.mailDate||te.invoiceDate||"",onChange:be=>J0(te.id,"mailDate",be.target.value),style:{padding:"4px 6px",fontSize:"11px",border:"1.5px solid #D1D5DB",borderRadius:"6px",width:"100%"}}):f.jsx("span",{style:{fontSize:"11px"},children:gr(te.mailDate||te.invoiceDate)}):f.jsx("span",{style:{color:"#CBD5E1"},children:"-"})}),f.jsx("td",{style:{padding:"10px 14px",textAlign:"center",backgroundColor:"#FAF5FF"},children:te.receiptStatus==="Received"||te.receiptStatus==="Closed"?f.jsxs("span",{style:{padding:"4px 8px",borderRadius:"6px",fontSize:"10px",fontWeight:"700",backgroundColor:"#DCFCE7",color:"#166534"},children:[" ",te.receiptNo||"Received"]}):te.receiptStatus==="Cancelled"?f.jsx("span",{style:{padding:"4px 8px",borderRadius:"6px",fontSize:"10px",fontWeight:"700",backgroundColor:"#FEE2E2",color:"#991B1B"},children:" Cancelled"}):te.invoiceGenerated&&te.invoiceStatus==="Approved"?f.jsx("span",{style:{padding:"4px 8px",borderRadius:"6px",fontSize:"10px",fontWeight:"600",backgroundColor:"#FEF3C7",color:"#92400E"},children:" Pending"}):f.jsx("span",{style:{color:"#CBD5E1"},children:"-"})})]},te.id)})})]})})]},K)})}),X.length>0&&f.jsxs("div",{style:{marginTop:"16px",padding:"16px 20px",backgroundColor:"#FFFFFF",borderRadius:"12px",border:"1px solid #E2E8F0",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[f.jsxs("div",{style:{display:"flex",gap:"24px",fontSize:"14px",color:"#475569"},children:[f.jsxs("span",{children:[" Total: ",f.jsx("strong",{children:Z.length})]}),f.jsxs("span",{children:[" To Bill: ",f.jsx("strong",{children:Z.filter(K=>K.toBeBilled==="Yes").length})]}),f.jsxs("span",{children:[" Invoiced: ",f.jsx("strong",{children:Z.filter(K=>K.invoiceGenerated).length})]}),f.jsxs("span",{children:[" Approved: ",f.jsx("strong",{children:Z.filter(K=>K.invoiceStatus==="Approved").length})]}),Dn==="closed"&&f.jsxs("span",{children:[" Closed: ",f.jsx("strong",{children:Z.filter(K=>K.receiptStatus==="Received"||K.receiptStatus==="Cancelled"||K.receiptStatus==="Closed").length})]})]}),f.jsxs("div",{style:{fontSize:"18px",fontWeight:"700",color:"#059669"},children:["Total: ",ut(Z.filter(K=>K.toBeBilled==="Yes").reduce((K,xe)=>K+(parseFloat(xe.totalWithGst)||0),0))]})]})]})},K4=()=>{const g=new Map;rn.filter(le=>le.invoiceGenerated).forEach(le=>{g.has(le.invoiceNo)?g.get(le.invoiceNo).campaigns.push(le):g.set(le.invoiceNo,{invoiceNo:le.invoiceNo,partyName:le.partyName,date:le.invoiceDate,invoiceType:le.invoiceType,combinationCode:le.combinationCode,invoiceStatus:le.invoiceStatus,mailingSent:le.mailingSent,receiptStatus:le.receiptStatus||"Pending",receiptNo:le.receiptNo,campaigns:[le],totalAmount:parseFloat(le.invoiceTotalAmount)||0,isFromMaster:!0})});const C=le=>{if(!le)return"";const De=le.split("/");return De.length>=3?De.slice(1).join("/"):De.length===2?De.join("/"):De[De.length-1]},X=hi.filter(le=>{var De;return le.isHistorical&&(le.type==="creditnote"||((De=le.vchNo)==null?void 0:De.toUpperCase().startsWith("CN")))}),Z=new Map;Xl.forEach(le=>{const De=C(le.invoiceNo);De&&Z.set(De,le)}),X.forEach(le=>{const De=C(le.vchNo);De&&!Z.has(De)&&Z.set(De,le)}),hi.filter(le=>{var De;return le.isHistorical&&le.type!=="creditnote"&&!((De=le.vchNo)!=null&&De.toUpperCase().startsWith("CN"))&&le.debit>0}).forEach(le=>{if(!g.has(le.vchNo)){const De=vs.find(Ze=>Ze.invoiceNo===le.vchNo),Ge=C(le.vchNo),te=Z.get(Ge),Ke=te?Math.abs(parseFloat(te.totalAmount)||parseFloat(te.credit)||parseFloat(te.debit)||0):0,ce=parseFloat(le.debit)||0;if(te&&Ke>=ce)return;const Qe=!De&&!(le.amountReceived>0),be=te&&Ke>0&&Ke<ce;if(Qe||be){const Ze=be?ce-Ke:ce;g.set(le.vchNo,{invoiceNo:le.vchNo,partyName:le.partyName,date:le.date,invoiceType:"Historical",combinationCode:"",invoiceStatus:"Approved",mailingSent:"Yes",receiptStatus:be?"Partial CN":"Pending",receiptNo:"",campaigns:[],totalAmount:ce,pendingAmount:Ze,hasPartialCN:be,cnAmount:Ke,isHistorical:!0,historicalEntry:le})}}});let J=Array.from(g.values());if(Zt.party&&(J=J.filter(le=>le.partyName===Zt.party)),Zt.invoiceStatus&&(J=J.filter(le=>le.invoiceStatus===Zt.invoiceStatus)),Zt.receiptStatus&&(Zt.receiptStatus==="Received"?J=J.filter(le=>le.receiptStatus==="Received"):Zt.receiptStatus==="Pending"&&(J=J.filter(le=>le.receiptStatus!=="Received"))),Zt.invoiceType&&(J=J.filter(le=>le.invoiceType===Zt.invoiceType)),Zt.searchText){const le=Zt.searchText.toLowerCase();J=J.filter(De=>{var Ge,te;return((Ge=De.invoiceNo)==null?void 0:Ge.toLowerCase().includes(le))||((te=De.partyName)==null?void 0:te.toLowerCase().includes(le))})}const fe={};J.forEach(le=>{fe[le.partyName]||(fe[le.partyName]=[]),fe[le.partyName].push(le)});const K=Object.keys(fe).sort(),xe=Zt.party||Zt.invoiceStatus||Zt.receiptStatus||Zt.invoiceType||Zt.searchText,$e=Array.from(g.values());return f.jsxs("div",{children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[f.jsx("h1",{style:{margin:0,fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:" Invoice & Receipt Register"}),Kr&&f.jsx("span",{style:{padding:"8px 16px",backgroundColor:"#FEF3C7",borderRadius:"8px",fontSize:"13px",color:"#92400E",fontWeight:"600"},children:" View Only"})]}),f.jsx("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"10px",border:"1px solid #E2E8F0",padding:"14px 18px",marginBottom:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"14px",flexWrap:"wrap"},children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[f.jsx(jg,{size:18,color:"#64748B"}),f.jsx("span",{style:{fontSize:"13px",fontWeight:"700",color:"#475569"},children:"Filters:"})]}),f.jsxs("div",{style:{position:"relative"},children:[f.jsx(Dd,{size:14,style:{position:"absolute",left:"10px",top:"50%",transform:"translateY(-50%)",color:"#94A3B8"}}),f.jsx("input",{type:"text",placeholder:"Search invoice...",value:Zt.searchText,onChange:le=>hr(De=>({...De,searchText:le.target.value})),style:{padding:"8px 12px 8px 32px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",width:"160px"}})]}),f.jsxs("select",{value:Zt.party,onChange:le=>hr(De=>({...De,party:le.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:"#FFFFFF"},children:[f.jsx("option",{value:"",children:"All Parties"}),Qa.map(le=>f.jsx("option",{value:le,children:le},le))]}),f.jsxs("select",{value:Zt.invoiceStatus,onChange:le=>hr(De=>({...De,invoiceStatus:le.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:"#FFFFFF"},children:[f.jsx("option",{value:"",children:"All Status"}),f.jsx("option",{value:"Created",children:"Created"}),f.jsx("option",{value:"Approved",children:"Approved"}),f.jsx("option",{value:"Need Edits",children:"Need Edits"})]}),f.jsxs("select",{value:Zt.receiptStatus,onChange:le=>hr(De=>({...De,receiptStatus:le.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:"#FFFFFF"},children:[f.jsx("option",{value:"",children:"All Receipts"}),f.jsx("option",{value:"Received",children:"Received"}),f.jsx("option",{value:"Pending",children:"Pending"})]}),f.jsxs("select",{value:Zt.invoiceType,onChange:le=>hr(De=>({...De,invoiceType:le.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",backgroundColor:"#FFFFFF"},children:[f.jsx("option",{value:"",children:"All Types"}),f.jsx("option",{value:"Individual",children:"Individual"}),f.jsx("option",{value:"Combined",children:"Combined"})]}),xe&&f.jsxs(f.Fragment,{children:[f.jsxs("button",{onClick:()=>hr({party:"",invoiceStatus:"",receiptStatus:"",invoiceType:"",searchText:""}),style:{padding:"8px 12px",fontSize:"13px",fontWeight:"600",border:"1.5px solid #FCA5A5",borderRadius:"8px",backgroundColor:"#FEE2E2",color:"#991B1B",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},children:[f.jsx(rl,{size:14})," Clear"]}),f.jsxs("span",{style:{fontSize:"13px",color:"#64748B"},children:["Showing ",J.length," of ",$e.length]})]})]})}),f.jsx(_n,{noPadding:!0,children:f.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"12px"},children:[f.jsx("thead",{children:f.jsxs("tr",{style:{backgroundColor:"#F8FAFC",borderBottom:"2px solid #E2E8F0"},children:[f.jsx("th",{style:{padding:"10px 12px",textAlign:"left",fontWeight:"700"},children:"Invoice No"}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"left",fontWeight:"700"},children:"Date"}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Type"}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700"},children:"Amount"}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700",backgroundColor:"#F0FDF4",color:"#166534"},children:"Received"}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700",backgroundColor:"#FEF3C7",color:"#92400E"},children:"TDS"}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700",backgroundColor:"#FEE2E2",color:"#991B1B"},children:"CN Amt"}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700",backgroundColor:"#EFF6FF",color:"#1E40AF"},children:"Balance"}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Inv. Status"}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Receipt No."}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"CN No."}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Actions"})]})}),f.jsx("tbody",{children:K.length===0?f.jsx("tr",{children:f.jsx("td",{colSpan:"12",style:{padding:"50px",textAlign:"center",color:"#94A3B8"},children:xe?"No matching invoices":"No invoices generated yet"})}):K.map(le=>{const De=fe[le],Ge=Ko.has(le);let te=0;return De.forEach(Ke=>{const ce=Q.find(ue=>ue.invoiceNo===Ke.invoiceNo),Me=Le.find(ue=>ue.invoiceNo===Ke.invoiceNo),Qe=Te.find(ue=>ue.invoiceNo===Ke.invoiceNo&&ue.type==="tds"),be=Te.find(ue=>ue.invoiceNo===Ke.invoiceNo&&ue.type==="discount"),Ze=Ke.totalAmount||0,Rt=ce&&parseFloat(ce.amount)||0,Ut=Qe?parseFloat(Qe.credit)||0:ce&&parseFloat(ce.tds)||0,qt=Me?Math.abs(parseFloat(Me.totalAmount)||0):0,yn=be&&parseFloat(be.credit)||0,ge=Math.max(0,Ze-Rt-Ut-qt-yn);te+=ge}),f.jsxs(zd.Fragment,{children:[f.jsxs("tr",{onClick:()=>sy(le),style:{backgroundColor:"#1E3A5F",color:"white",cursor:"pointer",borderBottom:"1px solid #0F2744"},children:[f.jsx("td",{colSpan:"3",style:{padding:"10px 12px",fontWeight:"700",fontSize:"13px"},children:f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[Ge?f.jsx(O2,{size:18}):f.jsx(Lg,{size:18}),f.jsx(V2,{size:16}),le,f.jsxs("span",{style:{backgroundColor:"#2874A6",padding:"2px 10px",borderRadius:"12px",fontSize:"11px",fontWeight:"600"},children:[De.length," inv"]})]})}),f.jsx("td",{colSpan:"4",style:{padding:"10px 12px"}}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700",fontSize:"13px",backgroundColor:te===0?"#22C55E":"#3B82F6"},children:te===0?" Nil":`Bal: ${ut(te)}`}),f.jsx("td",{colSpan:"4",style:{padding:"10px 12px"}})]}),Ge&&De.map(Ke=>{const ce=Q.find(Je=>Je.invoiceNo===Ke.invoiceNo),Me=Le.find(Je=>Je.invoiceNo===Ke.invoiceNo),Qe=Te.find(Je=>Je.invoiceNo===Ke.invoiceNo&&Je.type==="tds"),be=Te.find(Je=>Je.invoiceNo===Ke.invoiceNo&&Je.type==="discount"),Ze=Ke.totalAmount||0,Rt=ce&&parseFloat(ce.amount)||0,Ut=Qe?parseFloat(Qe.credit)||0:ce&&parseFloat(ce.tds)||0,qt=Me?Math.abs(parseFloat(Me.totalAmount)||0):0,yn=be&&parseFloat(be.credit)||0,ge=Math.max(0,Ze-Rt-Ut-qt-yn),ue=qt>=Ze&&!ce;return f.jsxs("tr",{style:{borderBottom:"1px solid #F1F5F9",backgroundColor:Ke.invoiceType==="Combined"?"#FAF5FF":ge===0?"#F0FDF4":"transparent"},children:[f.jsx("td",{style:{padding:"10px 12px 10px 36px",fontWeight:"700",color:Ke.invoiceType==="Combined"?"#7C3AED":"#2874A6"},children:Ke.invoiceNo}),f.jsx("td",{style:{padding:"10px 12px"},children:gr(Ke.date)}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:f.jsx(em,{status:Ke.invoiceType,small:!0})}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700"},children:ut(Ze)}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"600",backgroundColor:"#F0FDF4",color:Rt>0?"#166534":"#94A3B8"},children:Rt>0?ut(Rt):"-"}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"600",backgroundColor:"#FEF3C7",color:Ut>0?"#92400E":"#94A3B8"},children:Ut>0?ut(Ut):"-"}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"600",backgroundColor:"#FEE2E2",color:qt>0?"#991B1B":"#94A3B8"},children:qt>0?ut(qt):"-"}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700",backgroundColor:"#EFF6FF",color:ge>0?"#1E40AF":"#166534"},children:ge===0?" Nil":ut(ge)}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:f.jsx(em,{status:Ke.invoiceStatus,small:!0})}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:ue?f.jsx("span",{style:{padding:"4px 10px",borderRadius:"12px",fontSize:"11px",fontWeight:"700",backgroundColor:"#FEE2E2",color:"#991B1B"},children:" Cancelled"}):ce?f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px",justifyContent:"center"},children:[f.jsxs("button",{onClick:()=>sn(ce),style:{padding:"4px 8px",borderRadius:"12px",fontSize:"10px",fontWeight:"700",backgroundColor:"#DCFCE7",color:"#166534",border:"none",cursor:"pointer",textDecoration:"underline"},title:"Click to view receipt",children:[" ",ce.receiptNo]}),er&&f.jsx("button",{onClick:()=>Y0(ce),style:{padding:"2px 4px",borderRadius:"4px",fontSize:"10px",backgroundColor:"#FEE2E2",color:"#991B1B",border:"none",cursor:"pointer"},title:"Delete Receipt",children:""})]}):f.jsx("span",{style:{padding:"4px 10px",borderRadius:"12px",fontSize:"11px",fontWeight:"600",backgroundColor:"#FEF3C7",color:"#92400E"},children:" Pending"})}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:Me?f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px",justifyContent:"center"},children:[f.jsx("button",{onClick:()=>Za(Me),style:{padding:"4px 8px",borderRadius:"12px",fontSize:"10px",fontWeight:"700",backgroundColor:"#FEE2E2",color:"#991B1B",border:"none",cursor:"pointer",textDecoration:"underline"},title:"Click to view credit note",children:Me.creditNoteNo}),er&&f.jsx("button",{onClick:()=>Zl(Me),style:{padding:"2px 4px",borderRadius:"4px",fontSize:"10px",backgroundColor:"#FEE2E2",color:"#991B1B",border:"none",cursor:"pointer"},title:"Delete Credit Note",children:""})]}):f.jsx("span",{style:{color:"#94A3B8",fontSize:"11px"},children:"-"})}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:f.jsx("div",{style:{display:"flex",gap:"4px",justifyContent:"center",flexWrap:"wrap"},children:Ke.isHistorical?f.jsxs(f.Fragment,{children:[er&&!ce&&f.jsx(Ye,{icon:Vu,small:!0,variant:"success",onClick:()=>{const Je={invoiceNo:Ke.invoiceNo,partyName:Ke.partyName,invoiceDate:Ke.date,invoiceTotalAmount:Ke.totalAmount,invoiceStatus:"Approved",mailingSent:"Yes",invoiceType:"Historical",isHistorical:!0};Qo(Je)},title:"Create Receipt"}),er&&!Me&&f.jsx(Ye,{icon:ju,small:!0,variant:"primary",onClick:()=>{const Je={invoiceNo:Ke.invoiceNo,partyName:Ke.partyName,invoiceDate:Ke.date,invoiceTotalAmount:Ke.totalAmount,invoiceStatus:"Approved",isHistorical:!0};Au(Je)},title:"Credit Note"})]}):f.jsxs(f.Fragment,{children:[f.jsx(Ye,{icon:bd,small:!0,variant:"brand",onClick:()=>ku(Ke.campaigns[0]),title:"View Invoice"}),er&&Ke.invoiceStatus==="Approved"&&Ke.mailingSent==="Yes"&&!ce&&f.jsx(Ye,{icon:Vu,small:!0,variant:"success",onClick:()=>Qo(Ke.campaigns[0]),title:"Create Receipt"}),er&&Ke.invoiceStatus==="Approved"&&!Me&&f.jsx(Ye,{icon:ju,small:!0,variant:"primary",onClick:()=>Au(Ke.campaigns[0]),title:"Credit Note"}),er&&f.jsx(Ye,{icon:Ws,small:!0,variant:"danger",onClick:()=>Jl(Ke.campaigns[0]),title:"Delete Invoice"})]})})})]},Ke.invoiceNo)})]},le)})})]})})]})},X4=()=>{if(!H){alert("Please select a party first");return}const g=Jn[H]||0,C=me.filter(ge=>ge.partyName===H&&ge.invoiceGenerated&&ge.invoiceStatus==="Approved"),X=new Map;C.forEach(ge=>{X.has(ge.invoiceNo)?X.get(ge.invoiceNo).campaigns.push(ge):X.set(ge.invoiceNo,{invoiceNo:ge.invoiceNo,invoiceDate:ge.invoiceDate,campaigns:[ge],isFromMaster:!0})});const Z=Te.filter(ge=>{var ue;return ge.partyName===H&&ge.isHistorical&&ge.type!=="creditnote"&&!((ue=ge.vchNo)!=null&&ue.toUpperCase().startsWith("CN"))}),J=Te.filter(ge=>{var ue;return ge.partyName===H&&ge.isHistorical&&(ge.type==="creditnote"||((ue=ge.vchNo)==null?void 0:ue.toUpperCase().startsWith("CN")))}),fe=Q.filter(ge=>ge.partyName===H),K=Le.filter(ge=>ge.partyName===H),xe=ge=>{if(!ge)return"";const ue=ge.split("/");return ue.length>=3?ue.slice(1).join("/"):ue.length===2?ue.join("/"):ue[ue.length-1]},$e=new Map;K.forEach(ge=>{const ue=xe(ge.invoiceNo);ue&&!$e.has(ue)&&$e.set(ue,{...ge,isSystemCN:!0})}),J.forEach(ge=>{const ue=xe(ge.vchNo);ue&&!$e.has(ue)&&$e.set(ue,{...ge,isHistoricalCN:!0})});let le=[],De=0,Ge=0,te=0,Ke=0,ce=g;const Me=new Set;g!==0&&(De+=g>0?g:0,Ge+=g<0?Math.abs(g):0,le.push({date:"",particular:"Opening Balance",vchType:"",vchNo:"",debit:g>0?g:0,credit:g<0?Math.abs(g):0,receiptDate:"",amountReceived:0,tds:0,balance:g,status:"",isMain:!0,isOpening:!0}));const Qe=[];Array.from(X.values()).filter(ge=>{const ue=new Date(ge.invoiceDate);return ue>=new Date(_r.fromDate)&&ue<=new Date(_r.toDate)}).forEach(ge=>{Qe.push({...ge,entryType:"invoice",sortDate:ge.invoiceDate})}),Z.filter(ge=>{if(!ge.date)return!1;const ue=new Date(ge.date);return ue>=new Date(_r.fromDate)&&ue<=new Date(_r.toDate)}).forEach(ge=>{Qe.push({...ge,entryType:"invoice",sortDate:ge.date})}),Qe.sort((ge,ue)=>new Date(ge.sortDate)-new Date(ue.sortDate)),Qe.forEach(ge=>{var ue,Je;if(ge.isFromMaster){const pr=ge;let Mt=0;pr.campaigns.forEach(xi=>Mt+=parseFloat(xi.invoiceAmount)||0);const sr=(Je=(ue=pr.campaigns[0])==null?void 0:ue.statePartyDetails)==null?void 0:Je.toUpperCase().includes("MAHARASHTRA"),ar=sr?Mt*.09:0,Er=sr?Mt*.09:0,Yr=sr?0:Mt*.18,ei=Mt+ar+Er+Yr,ti=xe(pr.invoiceNo),an=$e.get(ti),Wt=!!an,gi=fe.find(xi=>xi.invoiceNo===pr.invoiceNo);ce+=ei,De+=ei;let mi=0,pa=0,Cu="",js=Wt?"":"Pending";if(gi&&(js="Received",mi=gi.amount||0,pa=gi.tds||0,Cu=gi.date,te+=mi,Ke+=pa,ce-=mi+pa+(gi.discount||0)),le.push({date:pr.invoiceDate,particular:H,vchType:"Sales",vchNo:pr.invoiceNo,debit:ei,credit:0,receiptDate:Cu,amountReceived:mi,tds:pa,balance:Wt?"-":js==="Received"?0:ei-mi-pa,status:js,isMain:!0,hasCN:Wt}),le.push({particular:"PROMOTIONAL TRADE EMAILER"+(pr.campaigns.length>1?"S":""),credit:Mt,isMain:!1,hasCN:Wt}),sr?(le.push({particular:"CGST",credit:ar,isMain:!1,hasCN:Wt}),le.push({particular:"SGST",credit:Er,isMain:!1,hasCN:Wt})):le.push({particular:"IGST",credit:Yr,isMain:!1,hasCN:Wt}),an&&!Me.has(ti)){Me.add(ti);const xi=Math.abs(an.totalAmount||an.credit||0);ce-=xi,Ge+=xi,le.push({date:an.date,particular:H,vchType:"Credit Note",vchNo:an.creditNoteNo||an.vchNo,debit:0,credit:xi,receiptDate:"",amountReceived:0,tds:0,balance:"-",status:"",isMain:!0,isCreditNote:!0,hasCN:!0});const ga=Math.abs(an.amount)||xi/1.18,Jo=Math.abs(an.gst)||xi-ga;le.push({particular:"PROMOTIONAL TRADE EMAILER",credit:ga,isMain:!1,isCreditNote:!0,hasCN:!0}),le.push({particular:an.gstType||(sr?"CGST + SGST":"IGST"),credit:Jo,isMain:!1,isCreditNote:!0,hasCN:!0})}}else if(ge.isHistorical){const pr=ge.debit||0,Mt=ge.credit||0,sr=xe(ge.vchNo),ar=$e.get(sr),Er=!!ar;if(ce+=pr-Mt,De+=pr,Ge+=Mt,le.push({date:ge.date,particular:ge.particulars||H,vchType:ge.vchType||"Sales",vchNo:ge.vchNo,debit:pr,credit:Mt,receiptDate:ge.receiptDate||"",amountReceived:ge.amountReceived||0,tds:ge.tdsReceived||0,balance:Er?"-":pr-(ge.amountReceived||0)-(ge.tdsReceived||0),status:Er?"":ge.paymentStatus||"",isMain:!0,isHistorical:!0,hasCN:Er}),ge.subRows&&ge.subRows.length>0&&ge.subRows.forEach(Yr=>{le.push({particular:Yr.particular,debit:Yr.debit,credit:Yr.credit,isMain:!1,hasCN:Er})}),ar&&!Me.has(sr)){Me.add(sr);const Yr=Math.abs(ar.totalAmount||ar.credit||0);ce-=Yr,Ge+=Yr,le.push({date:ar.date,particular:H,vchType:"Credit Note",vchNo:ar.creditNoteNo||ar.vchNo,debit:0,credit:Yr,receiptDate:"",amountReceived:0,tds:0,balance:"-",status:"",isMain:!0,isCreditNote:!0,hasCN:!0}),ar.subRows&&ar.subRows.length>0&&ar.subRows.forEach(ei=>{le.push({particular:ei.particular,credit:Math.abs(ei.credit||0),isMain:!1,isCreditNote:!0,hasCN:!0})})}}});const be=le.reduce((ge,ue)=>ue.isMain&&typeof ue.balance=="number"&&ue.balance>0?ge+ue.balance:ge,0),Ze=me.find(ge=>ge.partyName===H),Rt=(Ze==null?void 0:Ze.statePartyDetails)||"",Ut=Xa(H,Rt),qt=`
<!DOCTYPE html>
<html>
<head>
  <title>Ledger Account - ${H}</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: Arial, sans-serif; font-size: 11px; padding: 20px; }
    .header { text-align: center; margin-bottom: 15px; }
    .firm-name { font-size: 18px; font-weight: bold; color: #1E293B; }
    .firm-address { font-size: 10px; color: #666; margin-top: 2px; }
    .party-section { text-align: center; margin: 15px 0; padding: 10px; border: 1px solid #ddd; background: #f9f9f9; }
    .party-name { font-size: 14px; font-weight: bold; }
    .ledger-title { font-size: 11px; color: #666; }
    .party-address { font-size: 10px; color: #666; margin-top: 5px; }
    .party-gstin { font-size: 10px; color: #1a5276; margin-top: 3px; font-weight: 600; }
    .period { text-align: center; font-size: 11px; margin: 10px 0; font-weight: bold; }
    .totals { display: flex; justify-content: space-around; background: #e8f4fd; padding: 8px; margin-bottom: 10px; font-size: 10px; border: 1px solid #ccc; }
    .totals div { text-align: center; }
    .totals .label { color: #666; }
    .totals .value { font-weight: bold; font-size: 11px; }
    .closing-balance { text-align: center; background: #1E293B; color: white; padding: 10px; margin-bottom: 10px; font-size: 14px; font-weight: bold; }
    table { width: 100%; border-collapse: collapse; font-size: 10px; }
    th { background: #f0f0f0; border: 1px solid #ccc; padding: 6px 4px; text-align: left; font-weight: bold; }
    td { border: 1px solid #ddd; padding: 5px 4px; }
    .text-right { text-align: right; }
    .text-center { text-align: center; }
    .main-row { background: #fff; }
    .main-row-cn { background: #fffbeb; }
    .sub-row { background: #fafafa; }
    .sub-row-cn { background: #fffbeb; }
    .sub-row td { padding-left: 20px; color: #666; font-size: 9px; }
    .opening-row { background: #fef3c7; font-weight: bold; }
    .credit-note-row { background: #fffbeb; }
    .status-received { background: #dcfce7; color: #166534; padding: 2px 6px; border-radius: 3px; font-size: 9px; }
    .status-pending { background: #fef3c7; color: #92400e; padding: 2px 6px; border-radius: 3px; font-size: 9px; }
    .debit { color: #dc2626; }
    .credit { color: #059669; }
    @media print { 
      body { padding: 10px; } 
      @page { size: landscape; margin: 10mm; }
    }
  </style>
</head>
<body>
  <div class="header">
    <div class="firm-name">${S.name}</div>
    <div class="firm-address">${S.address}</div>
    <div class="firm-address">${S.addressLine2}, ${S.city}</div>
    <div class="firm-address">E-Mail: ${S.email}</div>
  </div>
  
  <div class="party-section">
    <div class="party-name">${H}</div>
    <div class="ledger-title">Ledger Account</div>
    ${Rt?`<div class="party-address">${Rt}</div>`:""}
    ${Ut?`<div class="party-gstin">GSTIN: ${Ut}</div>`:""}
  </div>
  
  <div class="period">${gr(_r.fromDate)} to ${gr(_r.toDate)}</div>
  
  <div class="closing-balance">
    Closing Balance: ${Vt(Math.abs(be))} ${be>0?"(Dr)":be<0?"(Cr)":""}
  </div>
  
  <div class="totals">
    <div><div class="label">Debit</div><div class="value">${Vt(De)}</div></div>
    <div><div class="label">Credit</div><div class="value">${Vt(Ge)}</div></div>
    <div><div class="label">Amount Received</div><div class="value credit">${Vt(te)}</div></div>
    <div><div class="label">TDS Received</div><div class="value">${Vt(Ke)}</div></div>
  </div>
  
  <table>
    <thead>
      <tr>
        <th style="width:65px">Date</th>
        <th>Particular</th>
        <th style="width:70px" class="text-center">Vch Type</th>
        <th style="width:100px">Vch No.</th>
        <th style="width:80px" class="text-right">Debit</th>
        <th style="width:80px" class="text-right">Credit</th>
        <th style="width:70px" class="text-center">Date of Receipt</th>
        <th style="width:85px" class="text-right">Amount Received</th>
        <th style="width:70px" class="text-right">TDS Received</th>
        <th style="width:75px" class="text-right">Balance</th>
        <th style="width:70px" class="text-center">Payment Status</th>
      </tr>
    </thead>
    <tbody>
      ${le.map(ge=>ge.isMain?`
        <tr class="${ge.isOpening?"opening-row":ge.hasCN||ge.isCreditNote?"main-row-cn":"main-row"}">
          <td>${ge.date?gr(ge.date):""}</td>
          <td style="font-weight:600">${ge.particular}</td>
          <td class="text-center">${ge.vchType||""}</td>
          <td style="color:#2874A6;font-weight:600">${ge.vchNo||""}</td>
          <td class="text-right">${ge.debit>0?Vt(ge.debit):""}</td>
          <td class="text-right" style="color:#DC2626">${ge.credit>0?Vt(ge.credit):""}</td>
          <td class="text-center">${ge.receiptDate?gr(ge.receiptDate):""}</td>
          <td class="text-right credit">${ge.amountReceived>0?Vt(ge.amountReceived):""}</td>
          <td class="text-right">${ge.tds>0?Vt(ge.tds):""}</td>
          <td class="text-right">${ge.balance==="-"?"-":ge.balance>0?Vt(ge.balance):""}</td>
          <td class="text-center">${ge.status?`<span class="${ge.status==="Received"?"status-received":"status-pending"}">${ge.status}</span>`:""}</td>
        </tr>
      `:`
        <tr class="${ge.hasCN||ge.isCreditNote?"sub-row-cn":"sub-row"}">
          <td></td>
          <td style="padding-left:20px;color:#666">${ge.particular}</td>
          <td></td>
          <td></td>
          <td class="text-right">${ge.debit?Vt(ge.debit):""}</td>
          <td class="text-right">${ge.credit?Vt(ge.credit):""}</td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
        </tr>
      `).join("")}
    </tbody>
  </table>
  
  <script>window.onload = function() { window.print(); }<\/script>
</body>
</html>`,yn=window.open("","_blank");yn.document.write(qt),yn.document.close()},Y4=()=>{const g=K=>{const xe=Jn[K]||0,$e=me.filter(be=>be.partyName===K&&be.invoiceGenerated&&be.invoiceStatus==="Approved"),le=new Map;$e.forEach(be=>{le.has(be.invoiceNo)?le.get(be.invoiceNo).campaigns.push(be):le.set(be.invoiceNo,{invoiceNo:be.invoiceNo,campaigns:[be],totalAmount:parseFloat(be.invoiceTotalAmount)||0})});const De=Q.filter(be=>be.partyName===K),Ge=Le.filter(be=>be.partyName===K),te=Te.filter(be=>{var Ze;return be.partyName===K&&be.isHistorical&&be.type!=="creditnote"&&!((Ze=be.vchNo)!=null&&Ze.toUpperCase().startsWith("CN"))}),Ke=Te.filter(be=>{var Ze;return be.partyName===K&&be.isHistorical&&(be.type==="creditnote"||((Ze=be.vchNo)==null?void 0:Ze.toUpperCase().startsWith("CN")))}),ce=be=>{if(!be)return"";const Ze=be.split("/");return Ze.length>=3?Ze.slice(1).join("/"):Ze.length===2?Ze.join("/"):Ze[Ze.length-1]},Me=new Map;Ge.forEach(be=>{const Ze=ce(be.invoiceNo);Ze&&!Me.has(Ze)&&Me.set(Ze,be)}),Ke.forEach(be=>{const Ze=ce(be.vchNo);Ze&&!Me.has(Ze)&&Me.set(Ze,be)});let Qe=0;return xe>0&&(Qe+=xe),Array.from(le.values()).forEach(be=>{const Ze=be.totalAmount,Rt=ce(be.invoiceNo),Ut=Me.get(Rt),qt=Ut?Math.abs(parseFloat(Ut.totalAmount)||parseFloat(Ut.credit)||0):0;if(!(Ut&&qt>=Ze)){let ge=Ut?Ze-qt:Ze;const ue=De.find(Je=>Je.invoiceNo===be.invoiceNo);if(ue){const Je=ge-(parseFloat(ue.amount)||0)-(parseFloat(ue.tds)||0)-(parseFloat(ue.discount)||0);Je>0&&(Qe+=Je)}else ge>0&&(Qe+=ge)}}),te.forEach(be=>{const Ze=ce(be.vchNo),Rt=Me.get(Ze),Ut=Rt?Math.abs(parseFloat(Rt.totalAmount)||parseFloat(Rt.credit)||parseFloat(Rt.debit)||0):0,qt=parseFloat(be.debit)||0;if(!(Rt&&Ut>=qt)){let ge=Rt?qt-Ut:qt;const ue=parseFloat(be.amountReceived)||0,Je=parseFloat(be.tdsReceived)||0,pr=ge-ue-Je;pr>0&&(Qe+=pr)}}),Qe},C=Qa.filter(K=>K.toLowerCase().includes(Ha.toLowerCase())),X=K=>{const xe=me.find($e=>$e.partyName===K);return(xe==null?void 0:xe.statePartyDetails)||""},Z=K=>{const xe=me.find($e=>$e.partyName===K);return xe?Xa(K,xe.statePartyDetails):""},fe=(()=>{if(!H)return{entries:[],totals:{debit:0,credit:0,received:0,tds:0,balance:0}};const K=Jn[H]||0,xe=ue=>{if(!ue)return"";const Je=ue.split("/");return Je.length>=3?Je.slice(1).join("/"):Je.length===2?Je.join("/"):Je[Je.length-1]},$e=me.filter(ue=>ue.partyName===H&&ue.invoiceGenerated&&ue.invoiceStatus==="Approved"),le=new Map;$e.forEach(ue=>{le.has(ue.invoiceNo)?le.get(ue.invoiceNo).campaigns.push(ue):le.set(ue.invoiceNo,{invoiceNo:ue.invoiceNo,invoiceDate:ue.invoiceDate,invoiceType:ue.invoiceType,combinationCode:ue.combinationCode,receiptStatus:ue.receiptStatus,receiptNo:ue.receiptNo,receiptDate:ue.receiptDate,creditNoteNo:ue.creditNoteNo,campaigns:[ue],isFromMaster:!0})});const De=Te.filter(ue=>{var Je;return ue.partyName===H&&ue.isHistorical&&ue.type!=="creditnote"&&!((Je=ue.vchNo)!=null&&Je.toUpperCase().startsWith("CN"))}),Ge=Te.filter(ue=>{var Je;return ue.partyName===H&&ue.isHistorical&&(ue.type==="creditnote"||((Je=ue.vchNo)==null?void 0:Je.toUpperCase().startsWith("CN")))}),te=Q.filter(ue=>ue.partyName===H),Ke=Le.filter(ue=>ue.partyName===H),ce=new Map;Ke.forEach(ue=>{const Je=xe(ue.invoiceNo);Je&&!ce.has(Je)&&ce.set(Je,{...ue,isSystemCN:!0})}),Ge.forEach(ue=>{const Je=xe(ue.vchNo);Je&&!ce.has(Je)&&ce.set(Je,{...ue,isHistoricalCN:!0})});const Me=[];let Qe=K,be=0,Ze=0,Rt=0,Ut=0;const qt=new Set;K!==0&&(Me.push({id:"opening",date:"",particular:"Opening Balance",vchType:"",vchNo:"",debit:K>0?K:0,credit:K<0?Math.abs(K):0,receiptDate:"",amountReceived:0,tdsReceived:0,balance:K,paymentStatus:"",isOpening:!0,subRows:[]}),be+=K>0?K:0,Ze+=K<0?Math.abs(K):0);const yn=[];Array.from(le.values()).filter(ue=>{const Je=new Date(ue.invoiceDate),pr=new Date(_r.fromDate),Mt=new Date(_r.toDate);return Je>=pr&&Je<=Mt}).forEach(ue=>{yn.push({...ue,entryType:"invoice",sortDate:ue.invoiceDate})}),De.filter(ue=>{if(!ue.date)return!1;const Je=new Date(ue.date),pr=new Date(_r.fromDate),Mt=new Date(_r.toDate);return Je>=pr&&Je<=Mt}).forEach(ue=>{yn.push({...ue,entryType:ue.type||"invoice",sortDate:ue.date})}),yn.sort((ue,Je)=>new Date(ue.sortDate)-new Date(Je.sortDate)),yn.forEach(ue=>{var Je,pr;if(ue.isFromMaster){const Mt=ue;let sr=0;Mt.campaigns.forEach(Vs=>{sr+=parseFloat(Vs.invoiceAmount)||0});const ar=(pr=(Je=Mt.campaigns[0])==null?void 0:Je.statePartyDetails)==null?void 0:pr.toUpperCase().includes("MAHARASHTRA"),Er=ar?sr*.09:0,Yr=ar?sr*.09:0,ei=ar?0:sr*.18,ti=sr+Er+Yr+ei,an=xe(Mt.invoiceNo),Wt=ce.get(an),gi=Wt?Math.abs(Wt.totalAmount||Wt.credit||0):0,mi=!!Wt,pa=mi&&gi>=ti,Cu=mi&&!pa?ti-gi:0,js=te.find(Vs=>Vs.invoiceNo===Mt.invoiceNo);Qe+=ti,be+=ti;const xi=[{particular:"PROMOTIONAL TRADE EMAILER"+(Mt.campaigns.length>1?"S":""),credit:sr}];ar?(xi.push({particular:"CGST",credit:Er}),xi.push({particular:"SGST",credit:Yr})):xi.push({particular:"IGST",credit:ei});let ga="",Jo=0,Fu=0,uy="",nc=ti;if(js?(ga="Received",Jo=js.amount||0,Fu=js.tds||0,uy=js.date,Rt+=Jo,Ut+=Fu,nc=ti-Jo-Fu-(js.discount||0),Qe-=Jo+Fu+(js.discount||0)):Mt.receiptStatus==="Received"?(ga="Received",nc=0):pa?(ga="CN Closed",nc=0):mi&&Cu>0?(ga="Partial CN",nc=Cu):ga="Pending",Me.push({id:Mt.invoiceNo,date:Mt.invoiceDate,particular:H,vchType:"Sales",vchNo:Mt.invoiceNo,debit:ti,credit:0,receiptDate:uy,amountReceived:Jo,tdsReceived:Fu,balance:pa?"-":nc>0?nc:0,paymentStatus:ga,isInvoice:!0,hasCN:mi,subRows:xi}),Wt&&!qt.has(an)){qt.add(an);const Vs=Math.abs(Wt.totalAmount||Wt.credit||0);Qe-=Vs,Ze+=Vs;const Zo=[];if(Wt.amount&&Zo.push({particular:"PROMOTIONAL TRADE EMAILER",credit:Math.abs(Wt.amount)}),Wt.gst&&Zo.push({particular:Wt.gstType||(ar?"CGST + SGST":"IGST"),credit:Math.abs(Wt.gst)}),Zo.length===0&&Vs>0){const fy=Vs/1.18,rF=Vs-fy;Zo.push({particular:"PROMOTIONAL TRADE EMAILER",credit:fy}),Zo.push({particular:ar?"CGST + SGST":"IGST",credit:rF})}Me.push({id:Wt.id||Wt.creditNoteNo||`cn-${an}`,date:Wt.date,particular:H,vchType:"Credit Note",vchNo:Wt.creditNoteNo||Wt.vchNo,debit:0,credit:Vs,receiptDate:"",amountReceived:0,tdsReceived:0,balance:"-",paymentStatus:"",isCreditNote:!0,hasCN:!0,subRows:Wt.isHistoricalCN&&Wt.subRows||Zo})}}else if(ue.isHistorical){const Mt=ue.debit||0,sr=ue.credit||0,ar=xe(ue.vchNo),Er=ce.get(ar),Yr=Er?Math.abs(Er.totalAmount||Er.credit||0):0,ei=!!Er,ti=ei&&Yr>=Mt,an=ei&&!ti?Mt-Yr:0;Qe+=Mt-sr,be+=Mt,Ze+=sr,ue.amountReceived&&(Rt+=ue.amountReceived),ue.tdsReceived&&(Ut+=ue.tdsReceived);const Wt=ue.subRows||[];let gi=Mt-(ue.amountReceived||0)-(ue.tdsReceived||0),mi=ue.paymentStatus||"";ti?(gi=0,mi="CN Closed"):ei&&an>0&&(gi=an-(ue.amountReceived||0)-(ue.tdsReceived||0),gi>0&&(mi="Partial CN")),Me.push({id:ue.id,date:ue.date,particular:ue.particulars||H,vchType:ue.vchType||"Sales",vchNo:ue.vchNo,debit:Mt,credit:sr,receiptDate:ue.receiptDate||"",amountReceived:ue.amountReceived||0,tdsReceived:ue.tdsReceived||0,balance:ti?"-":gi>0?gi:0,paymentStatus:mi,isInvoice:!0,isHistorical:!0,hasCN:ei,subRows:Wt}),Er&&!qt.has(ar)&&(qt.add(ar),Qe-=Yr,Ze+=Yr,Me.push({id:Er.id||Er.creditNoteNo||Er.vchNo||`cn-${ar}`,date:Er.date,particular:H,vchType:"Credit Note",vchNo:Er.creditNoteNo||Er.vchNo,debit:0,credit:Yr,receiptDate:"",amountReceived:0,tdsReceived:0,balance:"-",paymentStatus:"",isCreditNote:!0,hasCN:!0,subRows:Er.subRows||[]}))}});const ge=Me.reduce((ue,Je)=>typeof Je.balance=="number"&&Je.balance>0?ue+Je.balance:ue,0);return{entries:Me,totals:{debit:be,credit:Ze,received:Rt,tds:Ut,balance:ge}}})();return f.jsxs("div",{children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[f.jsx("h1",{style:{margin:0,fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:" Party Ledgers"}),f.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[Kr&&f.jsx("span",{style:{padding:"8px 16px",backgroundColor:"#FEF3C7",borderRadius:"8px",fontSize:"13px",color:"#92400E",fontWeight:"600"},children:" View Only"}),er&&f.jsx(Ye,{icon:Hs,label:"Import Historical",variant:"brand",onClick:()=>ua(!0)}),er&&H&&Te.some(K=>K.partyName===H&&K.isHistorical)&&f.jsx(Ye,{icon:Ws,label:"Clear Historical",variant:"danger",onClick:q0}),er&&f.jsx(Ye,{icon:Ug,label:"Opening Balance",variant:"primary",onClick:()=>$r(!0)})]})]}),f.jsx("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"10px",border:"1px solid #E2E8F0",padding:"14px 18px",marginBottom:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"14px",flexWrap:"wrap"},children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[f.jsx(DB,{size:18,color:"#64748B"}),f.jsx("span",{style:{fontSize:"13px",fontWeight:"700",color:"#475569"},children:"Period:"})]}),f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[f.jsx("input",{type:"date",value:_r.fromDate,onChange:K=>Ki(xe=>({...xe,fromDate:K.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px"}}),f.jsx("span",{style:{color:"#64748B"},children:"to"}),f.jsx("input",{type:"date",value:_r.toDate,onChange:K=>Ki(xe=>({...xe,toDate:K.target.value})),style:{padding:"8px 12px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px"}})]}),f.jsx("div",{style:{marginLeft:"auto",display:"flex",gap:"10px"},children:H&&f.jsx(Ye,{icon:Bu,label:"Download PDF",variant:"brand",onClick:X4})})]})}),f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"280px 1fr",gap:"16px"},children:[f.jsxs(_n,{title:"Parties",noPadding:!0,children:[f.jsx("div",{style:{padding:"12px",borderBottom:"1px solid #E2E8F0"},children:f.jsxs("div",{style:{position:"relative"},children:[f.jsx(Dd,{size:14,style:{position:"absolute",left:"10px",top:"50%",transform:"translateY(-50%)",color:"#94A3B8"}}),f.jsx("input",{type:"text",placeholder:"Search party...",value:Ha,onChange:K=>$a(K.target.value),style:{width:"100%",padding:"8px 12px 8px 32px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",boxSizing:"border-box"}})]})}),f.jsx("div",{style:{maxHeight:"450px",overflowY:"auto"},children:C.length===0?f.jsx("div",{style:{padding:"30px",textAlign:"center",color:"#94A3B8",fontSize:"14px"},children:Ha?"No matching parties":"No parties yet"}):C.map(K=>{const xe=g(K),$e=X(K);return f.jsxs("div",{onClick:()=>q(K),style:{padding:"14px 18px",borderBottom:"1px solid #F1F5F9",cursor:"pointer",backgroundColor:H===K?"#EFF6FF":"transparent",borderLeft:H===K?"4px solid #2874A6":"4px solid transparent"},children:[f.jsx("div",{style:{fontWeight:"600",fontSize:"14px",color:"#1E293B"},children:K}),$e&&f.jsxs("div",{style:{fontSize:"11px",color:"#64748B",marginTop:"2px"},children:[" ",$e]}),f.jsxs("div",{style:{fontSize:"14px",color:xe>0?"#DC2626":"#059669",fontWeight:"700",marginTop:"4px"},children:[xe>0?"Dr. ":"Cr. ",ut(Math.abs(xe))]})]},K)})})]}),f.jsx(_n,{title:H?"Ledger Account":"Select a Party",noPadding:!0,children:H?f.jsxs("div",{style:{fontSize:"12px"},children:[f.jsxs("div",{style:{textAlign:"center",padding:"16px",borderBottom:"2px solid #1E3A5F",backgroundColor:"#F8FAFC"},children:[f.jsx("div",{style:{fontSize:"16px",fontWeight:"700",color:"#1E3A5F"},children:S.name}),f.jsx("div",{style:{fontSize:"11px",color:"#64748B",marginTop:"4px"},children:S.address}),f.jsxs("div",{style:{fontSize:"11px",color:"#64748B"},children:[S.addressLine2,", ",S.city]}),f.jsxs("div",{style:{fontSize:"11px",color:"#64748B"},children:["E-Mail: ",S.email]})]}),f.jsxs("div",{style:{textAlign:"center",padding:"12px",borderBottom:"1px solid #E2E8F0",backgroundColor:"#FFFFFF"},children:[f.jsx("div",{style:{fontSize:"14px",fontWeight:"700",color:"#1E293B"},children:H}),f.jsx("div",{style:{fontSize:"11px",fontWeight:"600",color:"#64748B"},children:"Ledger Account"}),X(H)&&f.jsxs("div",{style:{fontSize:"11px",color:"#64748B",marginTop:"4px"},children:[" ",X(H)]}),Z(H)&&f.jsxs("div",{style:{fontSize:"11px",color:"#2874A6",marginTop:"3px",fontWeight:"600"},children:["GSTIN: ",Z(H)]})]}),f.jsx("div",{style:{textAlign:"center",padding:"8px",backgroundColor:"#F1F5F9",borderBottom:"1px solid #E2E8F0"},children:f.jsxs("span",{style:{fontSize:"11px",fontWeight:"600",color:"#475569"},children:[gr(_r.fromDate)," to ",gr(_r.toDate)]})}),f.jsxs("div",{style:{backgroundColor:"#1E293B",color:"white",padding:"12px 16px",display:"flex",justifyContent:"center",alignItems:"center",gap:"12px",borderBottom:"3px solid #F59E0B"},children:[f.jsx("span",{style:{fontSize:"14px",fontWeight:"600"},children:"Closing Balance:"}),f.jsxs("span",{style:{fontSize:"18px",fontWeight:"700",color:fe.totals.balance>0?"#FCA5A5":"#86EFAC"},children:[Vt(Math.abs(fe.totals.balance))," ",fe.totals.balance>0?"(Dr)":fe.totals.balance<0?"(Cr)":""]})]}),f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",backgroundColor:"#EFF6FF",borderBottom:"2px solid #2874A6",fontSize:"11px"},children:[f.jsxs("div",{style:{padding:"8px",textAlign:"center",borderRight:"1px solid #BFDBFE"},children:[f.jsx("div",{style:{color:"#64748B"},children:"Debit"}),f.jsx("div",{style:{fontWeight:"700",color:"#1E293B"},children:Vt(fe.totals.debit)})]}),f.jsxs("div",{style:{padding:"8px",textAlign:"center",borderRight:"1px solid #BFDBFE"},children:[f.jsx("div",{style:{color:"#64748B"},children:"Credit"}),f.jsx("div",{style:{fontWeight:"700",color:"#DC2626"},children:Vt(fe.totals.credit)})]}),f.jsxs("div",{style:{padding:"8px",textAlign:"center",borderRight:"1px solid #BFDBFE"},children:[f.jsx("div",{style:{color:"#64748B"},children:"Amount Received"}),f.jsx("div",{style:{fontWeight:"700",color:"#059669"},children:Vt(fe.totals.received)})]}),f.jsxs("div",{style:{padding:"8px",textAlign:"center"},children:[f.jsx("div",{style:{color:"#64748B"},children:"TDS Received"}),f.jsx("div",{style:{fontWeight:"700",color:"#1E293B"},children:Vt(fe.totals.tds)})]})]}),f.jsx("div",{style:{overflowX:"auto"},children:f.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"11px",minWidth:"1000px"},children:[f.jsx("thead",{children:f.jsxs("tr",{style:{backgroundColor:"#F8FAFC",borderBottom:"2px solid #E2E8F0"},children:[f.jsx("th",{style:{padding:"10px 8px",textAlign:"left",fontWeight:"700",width:"75px",borderRight:"1px solid #E2E8F0"},children:"Date"}),f.jsx("th",{style:{padding:"10px 8px",textAlign:"left",fontWeight:"700",minWidth:"150px",borderRight:"1px solid #E2E8F0"},children:"Particular"}),f.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"700",width:"80px",borderRight:"1px solid #E2E8F0"},children:"Vch Type"}),f.jsx("th",{style:{padding:"10px 8px",textAlign:"left",fontWeight:"700",width:"110px",borderRight:"1px solid #E2E8F0"},children:"Vch No."}),f.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"700",width:"90px",borderRight:"1px solid #E2E8F0"},children:"Debit"}),f.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"700",width:"90px",borderRight:"1px solid #E2E8F0"},children:"Credit"}),f.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"700",width:"85px",borderRight:"1px solid #E2E8F0"},children:"Date of Receipt"}),f.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"700",width:"90px",borderRight:"1px solid #E2E8F0"},children:"Amount Received"}),f.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"700",width:"80px",borderRight:"1px solid #E2E8F0"},children:"TDS Received"}),f.jsx("th",{style:{padding:"10px 8px",textAlign:"right",fontWeight:"700",width:"85px",borderRight:"1px solid #E2E8F0"},children:"Balance"}),f.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"700",width:"75px",borderRight:"1px solid #E2E8F0"},children:"Payment Status"}),er&&f.jsx("th",{style:{padding:"10px 8px",textAlign:"center",fontWeight:"700",width:"50px"},children:"Action"})]})}),f.jsx("tbody",{children:fe.entries.length===0?f.jsx("tr",{children:f.jsx("td",{colSpan:er?"12":"11",style:{padding:"40px",textAlign:"center",color:"#94A3B8"},children:"No entries in selected period"})}):fe.entries.map(K=>f.jsxs(zd.Fragment,{children:[f.jsxs("tr",{style:{backgroundColor:K.isOpening?"#FEF3C7":K.hasCN||K.isCreditNote?"#FFFBEB":"#FFFFFF",borderBottom:"1px solid #E2E8F0",borderLeft:K.hasCN||K.isCreditNote?"4px solid #F59E0B":"none"},children:[f.jsx("td",{style:{padding:"8px",borderRight:"1px solid #E2E8F0"},children:K.date?gr(K.date):""}),f.jsx("td",{style:{padding:"8px",fontWeight:"600",color:K.isCreditNote?"#DC2626":"#1E293B",borderRight:"1px solid #E2E8F0"},children:K.particular}),f.jsx("td",{style:{padding:"8px",textAlign:"center",borderRight:"1px solid #E2E8F0"},children:K.vchType&&f.jsx("span",{style:{padding:"2px 6px",borderRadius:"4px",fontSize:"10px",fontWeight:"600",backgroundColor:K.vchType==="Sales"?"#DCFCE7":"#FEE2E2",color:K.vchType==="Sales"?"#166534":"#991B1B"},children:K.vchType})}),f.jsx("td",{style:{padding:"8px",borderRight:"1px solid #E2E8F0"},children:K.vchNo&&K.isInvoice&&!K.isHistorical?f.jsx("button",{onClick:()=>nn(K.vchNo),style:{background:"none",border:"none",padding:0,fontWeight:"600",color:"#2874A6",cursor:"pointer",textDecoration:"underline",fontSize:"11px"},title:"Click to view invoice",children:K.vchNo}):f.jsx("span",{style:{fontWeight:"600",color:K.isCreditNote?"#DC2626":"#2874A6"},children:K.vchNo})}),f.jsx("td",{style:{padding:"8px",textAlign:"right",fontWeight:"600",borderRight:"1px solid #E2E8F0"},children:K.debit>0?Vt(K.debit):""}),f.jsx("td",{style:{padding:"8px",textAlign:"right",color:"#DC2626",borderRight:"1px solid #E2E8F0"},children:K.credit>0?Vt(K.credit):""}),f.jsx("td",{style:{padding:"8px",textAlign:"center",borderRight:"1px solid #E2E8F0"},children:K.receiptDate?gr(K.receiptDate):""}),f.jsx("td",{style:{padding:"8px",textAlign:"right",color:"#059669",fontWeight:K.amountReceived>0?"600":"400",borderRight:"1px solid #E2E8F0"},children:K.amountReceived>0?Vt(K.amountReceived):""}),f.jsx("td",{style:{padding:"8px",textAlign:"right",borderRight:"1px solid #E2E8F0"},children:K.tdsReceived>0?Vt(K.tdsReceived):""}),f.jsx("td",{style:{padding:"8px",textAlign:"right",fontWeight:"600",color:typeof K.balance=="number"&&K.balance>0?"#DC2626":"",borderRight:"1px solid #E2E8F0"},children:K.isOpening?K.balance>0?Vt(K.balance):"":K.balance==="-"?"-":typeof K.balance=="number"&&K.balance>0?Vt(K.balance):"-"}),f.jsx("td",{style:{padding:"8px",textAlign:"center"},children:K.paymentStatus&&f.jsx("span",{style:{padding:"2px 8px",borderRadius:"4px",fontSize:"10px",fontWeight:"600",backgroundColor:K.paymentStatus==="Received"?"#DCFCE7":"#FEF3C7",color:K.paymentStatus==="Received"?"#166534":"#92400E"},children:K.paymentStatus})}),er&&f.jsx("td",{style:{padding:"8px",textAlign:"center"},children:K.isHistorical&&!K.isOpening&&f.jsx("button",{onClick:()=>Zn(Te.find(xe=>xe.id===K.id)),style:{padding:"2px 6px",borderRadius:"4px",fontSize:"10px",fontWeight:"600",backgroundColor:"#FEE2E2",color:"#991B1B",border:"none",cursor:"pointer"},title:"Delete historical entry",children:""})})]}),K.subRows&&K.subRows.length>0&&K.subRows.map((xe,$e)=>f.jsxs("tr",{style:{backgroundColor:K.isOpening?"#FEF3C7":K.hasCN||K.isCreditNote?"#FFFBEB":"#FFFFFF",borderBottom:$e===K.subRows.length-1?"2px solid #CBD5E1":"1px solid #E2E8F0",borderLeft:K.hasCN||K.isCreditNote?"4px solid #F59E0B":"none"},children:[f.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),f.jsx("td",{style:{padding:"6px 8px 6px 30px",color:"#475569",fontSize:"12px",borderRight:"1px solid #E2E8F0"},children:xe.particular}),f.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),f.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),f.jsx("td",{style:{padding:"6px 8px",textAlign:"right",fontSize:"12px",borderRight:"1px solid #E2E8F0"},children:xe.debit?Vt(xe.debit):""}),f.jsx("td",{style:{padding:"6px 8px",textAlign:"right",fontSize:"12px",borderRight:"1px solid #E2E8F0"},children:xe.credit?Vt(xe.credit):""}),f.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),f.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),f.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),f.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),f.jsx("td",{style:{padding:"6px 8px",borderRight:"1px solid #E2E8F0"}}),er&&f.jsx("td",{style:{padding:"6px 8px"}})]},`${K.id}-sub-${$e}`))]},K.id))})]})})]}):f.jsx("div",{style:{padding:"60px",textAlign:"center",color:"#94A3B8"},children:"Select a party to view ledger"})})]})]})},[rc,oy]=ye.useState(""),ed=ye.useMemo(()=>{const g=new Map,C=J=>{if(!J)return"";const fe=J.split("/");return fe.length>=3?fe.slice(1).join("/"):fe.length===2?fe.join("/"):fe[fe.length-1]},X=hi.filter(J=>{var fe;return J.isHistorical&&(J.type==="creditnote"||((fe=J.vchNo)==null?void 0:fe.toUpperCase().startsWith("CN")))}),Z=new Map;return Xl.forEach(J=>{const fe=C(J.invoiceNo);fe&&Z.set(fe,J)}),X.forEach(J=>{const fe=C(J.vchNo);fe&&!Z.has(fe)&&Z.set(fe,J)}),rn.filter(J=>J.invoiceGenerated&&J.invoiceStatus==="Approved").forEach(J=>{if(g.has(J.invoiceNo))g.has(J.invoiceNo)&&g.get(J.invoiceNo).campaigns.push(J);else{const fe=vs.find(De=>De.invoiceNo===J.invoiceNo),K=Xl.find(De=>De.invoiceNo===J.invoiceNo),xe=parseFloat(J.invoiceTotalAmount)||0,$e=K?Math.abs(parseFloat(K.totalAmount)||parseFloat(K.credit)||0):0,le=K&&$e>=xe;if(!fe&&!le){const De=K?xe-$e:xe;g.set(J.invoiceNo,{invoiceNo:J.invoiceNo,partyName:J.partyName,invoiceDate:J.invoiceDate,invoiceTotalAmount:J.invoiceTotalAmount,pendingAmount:De,hasPartialCN:!!K&&!le&&$e>0,cnAmount:$e,subject:J.subject,campaigns:[J],isHistorical:!1,invoiceType:J.invoiceType||"Individual"})}}}),hi.filter(J=>{var fe;return J.isHistorical&&J.type!=="creditnote"&&!((fe=J.vchNo)!=null&&fe.toUpperCase().startsWith("CN"))&&J.debit>0}).forEach(J=>{if(!g.has(J.vchNo)){const fe=vs.find(Ke=>Ke.invoiceNo===J.vchNo),K=C(J.vchNo),xe=Z.get(K),$e=xe?Math.abs(parseFloat(xe.totalAmount)||parseFloat(xe.credit)||parseFloat(xe.debit)||0):0,le=parseFloat(J.debit)||0,De=xe&&$e>=le;if(fe||De)return;const Ge=!(J.amountReceived>0),te=xe&&$e>0&&$e<le;if(Ge||te){const Ke=te?le-$e:le;g.set(J.vchNo,{invoiceNo:J.vchNo,partyName:J.partyName,invoiceDate:J.date,invoiceTotalAmount:le,pendingAmount:Ke,hasPartialCN:te,cnAmount:$e,subject:J.particulars||J.narration,campaigns:[],isHistorical:!0})}}}),Array.from(g.values()).sort((J,fe)=>J.partyName.localeCompare(fe.partyName))},[rn,vs,Xl,hi]),q4=ye.useMemo(()=>{const g={};return Yl.forEach(C=>{g[C.invoiceNo]||(g[C.invoiceNo]=[]),g[C.invoiceNo].push(C)}),Object.keys(g).forEach(C=>{g[C].sort((X,Z)=>new Date(Z.followupDate)-new Date(X.followupDate))}),g},[Yl]),ly=ye.useMemo(()=>{const g=new Date().toISOString().split("T")[0];return Yl.filter(C=>C.nextFollowupDate&&C.nextFollowupDate>=g).sort((C,X)=>new Date(C.nextFollowupDate)-new Date(X.nextFollowupDate))},[Yl]),td=ye.useMemo(()=>{let g=ed;if(rc){const X=rc.toLowerCase();g=ed.filter(Z=>{var J,fe,K;return((J=Z.invoiceNo)==null?void 0:J.toLowerCase().includes(X))||((fe=Z.partyName)==null?void 0:fe.toLowerCase().includes(X))||((K=Z.subject)==null?void 0:K.toLowerCase().includes(X))})}const C={};return g.forEach(X=>{C[X.partyName]||(C[X.partyName]={partyName:X.partyName,invoices:[],totalAmount:0}),C[X.partyName].invoices.push(X),C[X.partyName].totalAmount+=parseFloat(X.pendingAmount||X.invoiceTotalAmount)||0}),Object.values(C).sort((X,Z)=>X.partyName.localeCompare(Z.partyName))},[ed,rc]),Q4=()=>{const g=td.reduce((C,X)=>C+X.invoices.length,0);return f.jsxs("div",{children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[f.jsx("h1",{style:{margin:0,fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:" Followups"}),f.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[f.jsxs("span",{style:{padding:"6px 12px",backgroundColor:"#EFF6FF",borderRadius:"6px",fontSize:"12px",color:"#1E40AF",fontWeight:"600"},children:[td.length," Parties | ",g," Invoices"]}),Kr&&f.jsx("span",{style:{padding:"8px 16px",backgroundColor:"#FEF3C7",borderRadius:"8px",fontSize:"13px",color:"#92400E",fontWeight:"600"},children:" View Only"})]})]}),f.jsx("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"10px",border:"1px solid #E2E8F0",padding:"14px 18px",marginBottom:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"14px",flexWrap:"wrap"},children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[f.jsx(jg,{size:18,color:"#64748B"}),f.jsx("span",{style:{fontSize:"13px",fontWeight:"700",color:"#475569"},children:"Search:"})]}),f.jsxs("div",{style:{position:"relative",flex:1,maxWidth:"300px"},children:[f.jsx(Dd,{size:14,style:{position:"absolute",left:"10px",top:"50%",transform:"translateY(-50%)",color:"#94A3B8"}}),f.jsx("input",{type:"text",placeholder:"Search party, invoice, subject...",value:rc,onChange:C=>oy(C.target.value),style:{padding:"8px 12px 8px 32px",fontSize:"13px",border:"1.5px solid #E2E8F0",borderRadius:"8px",width:"100%"}})]}),rc&&f.jsxs("button",{onClick:()=>oy(""),style:{padding:"8px 12px",fontSize:"13px",fontWeight:"600",border:"1.5px solid #FCA5A5",borderRadius:"8px",backgroundColor:"#FEE2E2",color:"#991B1B",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},children:[f.jsx(rl,{size:14})," Clear"]}),rc&&f.jsxs("span",{style:{fontSize:"13px",color:"#64748B"},children:["Showing ",g," of ",ed.length]})]})}),ly.length>0&&f.jsx(_n,{title:" Upcoming Followups",style:{marginBottom:"16px"},children:f.jsx("div",{style:{display:"flex",gap:"12px",flexWrap:"wrap"},children:ly.slice(0,5).map(C=>f.jsxs("div",{style:{padding:"10px 14px",backgroundColor:new Date(C.nextFollowupDate).toISOString().split("T")[0]===new Date().toISOString().split("T")[0]?"#FEE2E2":"#FEF3C7",borderRadius:"8px",border:"1px solid #FCD34D"},children:[f.jsx("div",{style:{fontWeight:"600",fontSize:"13px",color:"#92400E"},children:C.invoiceNo}),f.jsx("div",{style:{fontSize:"11px",color:"#78716C"},children:C.partyName}),f.jsxs("div",{style:{fontSize:"12px",fontWeight:"600",color:"#DC2626",marginTop:"4px"},children:[" ",gr(C.nextFollowupDate)]})]},C.id))})}),td.length===0?f.jsx(_n,{children:f.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#94A3B8"},children:" No pending invoices! All payments received."})}):td.map(C=>f.jsxs(_n,{style:{marginBottom:"16px"},noPadding:!0,children:[f.jsxs("div",{style:{padding:"12px 16px",backgroundColor:"#1E293B",color:"white",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[f.jsxs("span",{style:{fontSize:"15px",fontWeight:"700"},children:[" ",C.partyName]}),f.jsxs("span",{style:{padding:"3px 10px",backgroundColor:"#3B82F6",borderRadius:"12px",fontSize:"11px",fontWeight:"600"},children:[C.invoices.length," Invoice",C.invoices.length>1?"s":""]})]}),f.jsxs("div",{style:{fontSize:"14px",fontWeight:"700",color:"#FCD34D"},children:["Total: ",ut(C.totalAmount)]})]}),f.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"12px"},children:[f.jsx("thead",{children:f.jsxs("tr",{style:{backgroundColor:"#F8FAFC",borderBottom:"2px solid #E2E8F0"},children:[f.jsx("th",{style:{padding:"10px 12px",textAlign:"left",fontWeight:"700"},children:"Invoice No"}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Type"}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Invoice Date"}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"700"},children:"Amount"}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Days Pending"}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Last Followup"}),f.jsx("th",{style:{padding:"10px 12px",textAlign:"center",fontWeight:"700"},children:"Actions"})]})}),f.jsx("tbody",{children:C.invoices.map(X=>{var xe,$e,le;const Z=q4[X.invoiceNo]||[],J=Z[0],fe=Math.floor((new Date-new Date(X.invoiceDate))/(1e3*60*60*24)),K=X.isHistorical?"Historical":X.invoiceType||(((xe=X.campaigns)==null?void 0:xe.length)>1?"Combined":"Individual");return f.jsxs(zd.Fragment,{children:[f.jsxs("tr",{style:{borderBottom:"1px solid #E2E8F0",backgroundColor:fe>30?"#FEF2F2":fe>15?"#FFFBEB":"#FFFFFF"},children:[f.jsxs("td",{style:{padding:"10px 12px",fontWeight:"600",color:"#2874A6"},children:[X.invoiceNo,X.hasPartialCN&&f.jsx("span",{style:{marginLeft:"6px",padding:"2px 6px",backgroundColor:"#FEF3C7",color:"#92400E",borderRadius:"4px",fontSize:"9px",fontWeight:"700"},children:"Partial CN"})]}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:f.jsx("span",{style:{padding:"3px 8px",borderRadius:"6px",fontSize:"10px",fontWeight:"600",backgroundColor:K==="Historical"?"#E0E7FF":K==="Combined"?"#F3E8FF":"#DCFCE7",color:K==="Historical"?"#3730A3":K==="Combined"?"#7C3AED":"#166534"},children:K})}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:gr(X.invoiceDate)}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"right",fontWeight:"600"},children:X.hasPartialCN?f.jsxs("div",{children:[f.jsx("div",{style:{color:"#DC2626"},children:ut(X.pendingAmount)}),f.jsx("div",{style:{fontSize:"9px",color:"#64748B",textDecoration:"line-through"},children:ut(X.invoiceTotalAmount)})]}):ut(X.invoiceTotalAmount)}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:f.jsxs("span",{style:{padding:"3px 10px",borderRadius:"12px",fontSize:"11px",fontWeight:"700",backgroundColor:fe>30?"#FEE2E2":fe>15?"#FEF3C7":"#DCFCE7",color:fe>30?"#991B1B":fe>15?"#92400E":"#166534"},children:[fe," days"]})}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"center",fontSize:"11px"},children:J?f.jsxs("div",{children:[f.jsx("div",{style:{fontWeight:"600"},children:gr(J.followupDate)}),f.jsxs("div",{style:{color:"#64748B",fontSize:"10px"},children:[($e=J.notes)==null?void 0:$e.substring(0,30),((le=J.notes)==null?void 0:le.length)>30?"...":""]})]}):f.jsx("span",{style:{color:"#DC2626",fontWeight:"600"},children:"No followup yet"})}),f.jsx("td",{style:{padding:"10px 12px",textAlign:"center"},children:f.jsxs("div",{style:{display:"flex",gap:"4px",justifyContent:"center"},children:[er&&f.jsx(Ye,{icon:Ug,small:!0,variant:"primary",onClick:()=>Q0(X),title:"Add Followup"}),f.jsx(Ye,{icon:Bg,small:!0,variant:"brand",onClick:()=>k(X),title:"Copy Email Template"}),f.jsx(Ye,{icon:Vg,small:!0,variant:"success",onClick:()=>O(X),title:"Search in Gmail"})]})})]}),Z.length>0&&f.jsx("tr",{children:f.jsxs("td",{colSpan:"7",style:{padding:"8px 12px 12px 40px",backgroundColor:"#F8FAFC"},children:[f.jsx("div",{style:{fontSize:"11px",fontWeight:"600",color:"#64748B",marginBottom:"6px"},children:"Followup History:"}),f.jsx("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:Z.map(De=>f.jsxs("div",{style:{padding:"6px 10px",backgroundColor:"#FFFFFF",borderRadius:"6px",border:"1px solid #E2E8F0",fontSize:"11px"},children:[f.jsx("div",{style:{fontWeight:"600",color:"#2874A6"},children:gr(De.followupDate)}),f.jsx("div",{style:{color:"#475569",marginTop:"2px"},children:De.notes}),De.nextFollowupDate&&f.jsxs("div",{style:{color:"#DC2626",marginTop:"2px",fontSize:"10px"},children:["Next: ",gr(De.nextFollowupDate)]}),er&&f.jsx("button",{onClick:()=>u(De.id),style:{background:"none",border:"none",color:"#DC2626",cursor:"pointer",fontSize:"10px",padding:"2px 0",marginTop:"4px"},children:" Delete"})]},De.id))})]})})]},X.invoiceNo)})})]})]},C.partyName))]})},cy=()=>{const g=me.filter(J=>J.invoiceGenerated).reduce((J,fe)=>J+(parseFloat(fe.invoiceTotalAmount)||0),0),C=me.filter(J=>J.invoiceStatus==="Paid").reduce((J,fe)=>J+(parseFloat(fe.invoiceTotalAmount)||0),0),X=me.filter(J=>J.invoiceStatus==="Approved").reduce((J,fe)=>J+(parseFloat(fe.invoiceTotalAmount)||0),0),Z=me.filter(J=>J.invoiceStatus==="Need Edits").length;return f.jsxs("div",{children:[f.jsx("h1",{style:{margin:"0 0 16px",fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:" Reports"}),f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"16px"},children:[f.jsxs(_n,{children:[f.jsx("div",{style:{fontSize:"14px",color:"#64748B",marginBottom:"8px"},children:"Total Invoiced"}),f.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:ut(g)})]}),f.jsxs(_n,{children:[f.jsx("div",{style:{fontSize:"14px",color:"#64748B",marginBottom:"8px"},children:"Approved"}),f.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#059669"},children:ut(X)})]}),f.jsxs(_n,{children:[f.jsx("div",{style:{fontSize:"14px",color:"#64748B",marginBottom:"8px"},children:"Need Edits"}),f.jsxs("div",{style:{fontSize:"24px",fontWeight:"700",color:"#DC2626"},children:[Z," invoices"]})]}),f.jsxs(_n,{children:[f.jsx("div",{style:{fontSize:"14px",color:"#64748B",marginBottom:"8px"},children:"Paid"}),f.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#059669"},children:ut(C)})]})]})]})},J4=()=>f.jsxs("div",{children:[f.jsx("h1",{style:{margin:"0 0 16px",fontSize:"24px",fontWeight:"700",color:"#1E293B"},children:" Settings"}),f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px"},children:[f.jsxs(_n,{title:" Invoice Series",children:[f.jsx(mr,{label:"Invoice Prefix",value:S.invoicePrefix,onChange:g=>b(C=>({...C,invoicePrefix:g.target.value})),small:!0}),f.jsx(mr,{label:"Next Invoice Number",type:"number",value:Y,onChange:g=>de(parseInt(g.target.value)||1),small:!0}),f.jsx(mr,{label:"Next Combine Code",type:"number",value:Se,onChange:g=>Ne(parseInt(g.target.value)||1),small:!0}),f.jsxs("div",{style:{padding:"10px",backgroundColor:"#EFF6FF",borderRadius:"8px",fontSize:"14px"},children:[f.jsx("strong",{children:"Preview:"})," ",S.invoicePrefix,Y]})]}),f.jsxs(_n,{title:" Mailer Logo",children:[f.jsx("input",{type:"file",ref:_u,accept:"image/*",style:{display:"none"},onChange:V4}),gn?f.jsxs("div",{style:{textAlign:"center"},children:[f.jsx("img",{src:gn,alt:"Logo",style:{maxWidth:"250px",maxHeight:"60px",marginBottom:"12px",border:"1px solid #E2E8F0",padding:"8px",borderRadius:"8px"}}),f.jsxs("div",{style:{display:"flex",gap:"8px",justifyContent:"center"},children:[f.jsx(Ye,{icon:VB,label:"Change",small:!0,onClick:()=>{var g;return(g=_u.current)==null?void 0:g.click()}}),f.jsx(Ye,{icon:Ws,label:"Remove",variant:"danger",small:!0,onClick:()=>Fi(null)})]})]}):f.jsxs("div",{onClick:()=>{var g;return(g=_u.current)==null?void 0:g.click()},style:{border:"2px dashed #CBD5E1",borderRadius:"10px",padding:"30px",textAlign:"center",cursor:"pointer"},children:[f.jsx(Hs,{size:32,color:"#94A3B8",style:{marginBottom:"8px"}}),f.jsx("p",{style:{margin:0,color:"#64748B",fontSize:"14px"},children:"Click to upload"})]})]}),f.jsxs(_n,{title:" WhatsApp Notifications",children:[f.jsx("div",{style:{marginBottom:"16px"},children:f.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"10px",cursor:"pointer"},children:[f.jsx("input",{type:"checkbox",checked:re.enabled,onChange:g=>se(C=>({...C,enabled:g.target.checked})),style:{width:"18px",height:"18px",cursor:"pointer"}}),f.jsx("span",{style:{fontSize:"14px",fontWeight:"600",color:"#1E293B"},children:"Enable WhatsApp Notifications"})]})}),re.enabled&&f.jsxs(f.Fragment,{children:[f.jsxs("div",{style:{padding:"12px",backgroundColor:"#DCFCE7",borderRadius:"8px",marginBottom:"16px",fontSize:"12px",color:"#166534",border:"1px solid #86EFAC"},children:[f.jsx("strong",{children:" FREE Setup using CallMeBot:"}),f.jsx("br",{}),"1. Save this number in contacts: ",f.jsx("strong",{children:"+34 644 71 81 99"}),f.jsx("br",{}),"2. Send this message to the number on WhatsApp: ",f.jsx("strong",{children:'"I allow callmebot to send me messages"'}),f.jsx("br",{}),"3. You'll receive an API key - enter it below",f.jsx("br",{}),"4. Repeat for each phone number you want to receive notifications"]}),f.jsxs("div",{style:{padding:"14px",backgroundColor:"#F8FAFC",borderRadius:"8px",marginBottom:"12px",border:"1px solid #E2E8F0"},children:[f.jsxs("div",{style:{fontSize:"13px",fontWeight:"700",color:"#1E293B",marginBottom:"10px",display:"flex",alignItems:"center",gap:"6px"},children:[f.jsx(Nd,{size:16})," Finance Team"]}),f.jsx(mr,{label:"Phone (with country code)",value:re.financePhone,onChange:g=>se(C=>({...C,financePhone:g.target.value})),placeholder:"919876543210",small:!0}),f.jsx(mr,{label:"API Key (from CallMeBot)",value:re.financeApiKey,onChange:g=>se(C=>({...C,financeApiKey:g.target.value})),placeholder:"123456",small:!0}),re.financePhone&&re.financeApiKey&&f.jsx(Ye,{icon:B2,label:"Test Finance",variant:"success",small:!0,onClick:()=>ir(re.financePhone,re.financeApiKey)})]}),f.jsxs("div",{style:{padding:"14px",backgroundColor:"#F8FAFC",borderRadius:"8px",border:"1px solid #E2E8F0"},children:[f.jsxs("div",{style:{fontSize:"13px",fontWeight:"700",color:"#1E293B",marginBottom:"10px",display:"flex",alignItems:"center",gap:"6px"},children:[f.jsx(Nd,{size:16})," Director"]}),f.jsx(mr,{label:"Phone (with country code)",value:re.directorPhone,onChange:g=>se(C=>({...C,directorPhone:g.target.value})),placeholder:"919876543210",small:!0}),f.jsx(mr,{label:"API Key (from CallMeBot)",value:re.directorApiKey,onChange:g=>se(C=>({...C,directorApiKey:g.target.value})),placeholder:"123456",small:!0}),re.directorPhone&&re.directorApiKey&&f.jsx(Ye,{icon:B2,label:"Test Director",variant:"success",small:!0,onClick:()=>ir(re.directorPhone,re.directorApiKey)})]})]}),!re.enabled&&f.jsx("div",{style:{padding:"20px",backgroundColor:"#F8FAFC",borderRadius:"8px",textAlign:"center",color:"#64748B",fontSize:"13px"},children:"WhatsApp notifications are disabled. Enable to receive FREE alerts for invoices, approvals, and payments."})]}),f.jsxs(_n,{title:" Default Invoice Values",children:[f.jsx("input",{type:"file",ref:P0,accept:".xlsx,.xls,.csv",style:{display:"none"},onChange:ne}),f.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"12px"},children:[f.jsx(Ye,{icon:Hs,label:"Upload",variant:"brand",small:!0,onClick:()=>{var g;return(g=P0.current)==null?void 0:g.click()}}),f.jsx(Ye,{icon:Bu,label:"Template",small:!0,onClick:he})]}),Object.keys(ps).length>0&&f.jsx("div",{style:{maxHeight:"180px",overflowY:"auto",border:"1px solid #E2E8F0",borderRadius:"8px"},children:Object.entries(ps).map(([g,C])=>f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"10px 14px",borderBottom:"1px solid #F1F5F9",fontSize:"13px"},children:[f.jsx("span",{children:g}),f.jsx("span",{style:{fontWeight:"700"},children:ut(C)})]},g))})]}),f.jsxs(_n,{title:" Party Master",children:[f.jsx("input",{type:"file",ref:xs,accept:".xlsx,.xls,.csv",style:{display:"none"},onChange:Ve}),f.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"12px"},children:[f.jsx(Ye,{icon:Hs,label:"Upload Parties",variant:"brand",small:!0,onClick:()=>{var g;return(g=xs.current)==null?void 0:g.click()}}),f.jsx(Ye,{icon:Bu,label:"Template",small:!0,onClick:zt})]}),f.jsxs("div",{style:{padding:"10px",backgroundColor:"#EFF6FF",borderRadius:"8px",fontSize:"12px",color:"#1E40AF",marginBottom:"12px"},children:[f.jsx("strong",{children:"Upload Format:"})," Name of Ledger, Ledger Group, State Name, GST Registration Type, GSTIN/UIN"]}),Object.keys(vn).length>0&&f.jsxs("div",{style:{maxHeight:"150px",overflowY:"auto",border:"1px solid #E2E8F0",borderRadius:"8px"},children:[Object.entries(vn).slice(0,20).map(([g,C])=>f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px 12px",borderBottom:"1px solid #F1F5F9",fontSize:"11px"},children:[f.jsx("span",{style:{fontWeight:"600"},children:g.length>30?g.substring(0,30)+"...":g}),f.jsxs("span",{style:{color:"#64748B"},children:[C.stateName||"-"," | ",C.gstin?C.gstin.substring(0,10)+"...":"-"]})]},g)),Object.keys(vn).length>20&&f.jsxs("div",{style:{padding:"8px 12px",textAlign:"center",color:"#64748B",fontSize:"11px"},children:["... and ",Object.keys(vn).length-20," more parties"]})]}),Object.keys(vn).length===0&&f.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#94A3B8",fontSize:"13px"},children:"No party master uploaded yet"})]}),f.jsxs(_n,{title:" Data Management",children:[f.jsxs("div",{style:{padding:"16px",backgroundColor:"#FEF2F2",borderRadius:"10px",border:"1px solid #FCA5A5",marginBottom:"16px"},children:[f.jsx("div",{style:{fontWeight:"700",color:"#991B1B",fontSize:"14px",marginBottom:"8px"},children:" Danger Zone"}),f.jsxs("div",{style:{fontSize:"13px",color:"#7F1D1D",marginBottom:"16px"},children:["This will permanently delete all data including:",f.jsxs("ul",{style:{margin:"8px 0 0 16px",padding:0},children:[f.jsx("li",{children:"All campaigns and master data"}),f.jsx("li",{children:"All invoices and receipts"}),f.jsx("li",{children:"All ledger entries"}),f.jsx("li",{children:"All mailer images"}),f.jsx("li",{children:"Opening balances and settings"})]})]}),f.jsx(Ye,{icon:Ws,label:"Clear All Data",variant:"danger",onClick:()=>Nn(!0)})]}),f.jsxs("div",{style:{fontSize:"12px",color:"#64748B"},children:[f.jsx("strong",{children:"Current Data:"}),f.jsx("br",{})," ",me.length," campaigns",f.jsx("br",{})," ",Te.length," ledger entries",f.jsx("br",{})," ",Q.length," receipts",f.jsx("br",{})," ",Object.keys(wt).length," mailer images"]})]})]})]}),Z4=()=>f.jsxs(f.Fragment,{children:[f.jsx(En,{isOpen:U4,onClose:()=>{ty(!1),ny("")},title:" Invoice Preview",width:"950px",children:ie&&ry&&f.jsxs("div",{children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px",padding:"14px 18px",backgroundColor:"#DCFCE7",borderRadius:"10px",border:"2px solid #22C55E"},children:[f.jsxs("div",{children:[f.jsxs("span",{style:{fontWeight:"700",fontSize:"16px",color:"#166534"},children:["Invoice: ",ie.invoiceNo]}),ie.invoiceType==="Combined"&&f.jsxs("span",{style:{marginLeft:"12px",padding:"4px 10px",backgroundColor:"#7C3AED",color:"white",borderRadius:"6px",fontSize:"12px",fontWeight:"600"},children:["Combined - C",ie.combinationCode]})]}),f.jsxs("button",{onClick:()=>W4(ie),style:{padding:"14px 28px",fontSize:"16px",fontWeight:"bold",border:"none",borderRadius:"10px",cursor:"pointer",backgroundColor:"#22C55E",color:"white",display:"flex",alignItems:"center",gap:"10px",boxShadow:"0 2px 8px rgba(34, 197, 94, 0.4)"},children:[f.jsx(Bu,{size:20}),"Download Invoice"]})]}),f.jsx("div",{style:{border:"2px solid #E2E8F0",borderRadius:"10px",overflow:"hidden",backgroundColor:"#f5f5f5"},children:f.jsx("iframe",{id:"invoice-viewer-iframe",srcDoc:ry,style:{width:"100%",height:"480px",border:"none",backgroundColor:"white"},title:"Invoice Preview"})}),f.jsxs("div",{style:{marginTop:"12px",padding:"14px 18px",backgroundColor:"#FEF3C7",borderRadius:"10px",border:"1px solid #FCD34D"},children:[f.jsx("div",{style:{fontSize:"14px",color:"#92400E",fontWeight:"600",marginBottom:"6px"},children:" How to Save as PDF:"}),f.jsxs("ol",{style:{fontSize:"13px",color:"#92400E",margin:"0",paddingLeft:"20px",lineHeight:"1.8"},children:[f.jsxs("li",{children:["Click ",f.jsx("strong",{children:'"Download Invoice"'})," button above"]}),f.jsxs("li",{children:["Open the downloaded ",f.jsx("strong",{children:".html file"})," in Chrome/Edge browser"]}),f.jsxs("li",{children:["Print dialog will open automatically - select ",f.jsx("strong",{children:'"Save as PDF"'})]}),f.jsxs("li",{children:["Click ",f.jsx("strong",{children:"Save"})," to get your PDF!"]})]})]})]})}),f.jsx(En,{isOpen:fi,onClose:()=>{Ot(!1),Gi(""),Fe({particularsApproved:!1,emailApproved:!1,invoiceTypeApproved:!1})},title:Kr?" Review & Approve Invoice":" Invoice Details",width:"550px",children:ie&&f.jsxs("div",{children:[f.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px",borderRadius:"10px",marginBottom:"16px"},children:[f.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[f.jsx("strong",{children:"Invoice:"})," ",ie.invoiceNo]}),f.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[f.jsx("strong",{children:"Party:"})," ",ie.partyName]}),f.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[f.jsx("strong",{children:"Amount:"})," ",ut(ie.invoiceTotalAmount)]}),f.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[f.jsx("strong",{children:"Email:"})," ",ie.emailId||"Not set"]}),f.jsxs("div",{style:{fontSize:"14px"},children:[f.jsx("strong",{children:"Invoice Type:"})," ",f.jsx("span",{style:{color:ie.invoiceType==="Combined"?"#7C3AED":"#2874A6",fontWeight:"600"},children:ie.invoiceType||"Individual"})]}),ie.invoiceType==="Combined"&&f.jsxs("div",{style:{marginTop:"8px",fontSize:"13px",color:"#7C3AED"},children:[f.jsx("strong",{children:"Combined Campaigns:"})," ",qi(ie).map(g=>g.senderName).join(", ")]})]}),ie.editComments&&f.jsxs("div",{style:{backgroundColor:"#FEE2E2",padding:"12px",borderRadius:"8px",marginBottom:"16px",border:"1px solid #FCA5A5"},children:[f.jsx("div",{style:{fontWeight:"600",color:"#991B1B",fontSize:"13px",marginBottom:"4px"},children:" Need Edits - Director Remarks:"}),f.jsx("div",{style:{fontSize:"13px",color:"#7F1D1D"},children:ie.editComments})]}),ie.approvalRemarks&&ie.invoiceStatus==="Approved"&&f.jsxs("div",{style:{backgroundColor:"#DCFCE7",padding:"12px",borderRadius:"8px",marginBottom:"16px",border:"1px solid #86EFAC"},children:[f.jsx("div",{style:{fontWeight:"600",color:"#166534",fontSize:"13px",marginBottom:"4px"},children:" Approved - Director Remarks:"}),f.jsx("div",{style:{fontSize:"13px",color:"#15803D"},children:ie.approvalRemarks})]}),Kr?f.jsxs("div",{style:{backgroundColor:"#F0FDF4",padding:"16px",borderRadius:"10px",marginBottom:"16px",border:"1px solid #86EFAC"},children:[f.jsx("div",{style:{fontWeight:"700",color:"#166534",fontSize:"14px",marginBottom:"12px"},children:" Approval Confirmations"}),f.jsxs("label",{style:{display:"flex",alignItems:"flex-start",gap:"10px",marginBottom:"12px",cursor:"pointer"},children:[f.jsx("input",{type:"checkbox",checked:He.particularsApproved,onChange:g=>Fe(C=>({...C,particularsApproved:g.target.checked})),style:{marginTop:"2px",width:"18px",height:"18px",accentColor:"#059669"}}),f.jsxs("div",{children:[f.jsx("div",{style:{fontWeight:"600",fontSize:"13px",color:"#166534"},children:"1. Particulars & Amount Approved"}),f.jsxs("div",{style:{fontSize:"12px",color:"#15803D"},children:["I confirm that the invoice particulars and amount (",ut(ie.invoiceTotalAmount),") are correct."]})]})]}),f.jsxs("label",{style:{display:"flex",alignItems:"flex-start",gap:"10px",marginBottom:"12px",cursor:"pointer"},children:[f.jsx("input",{type:"checkbox",checked:He.emailApproved,onChange:g=>Fe(C=>({...C,emailApproved:g.target.checked})),style:{marginTop:"2px",width:"18px",height:"18px",accentColor:"#059669"}}),f.jsxs("div",{children:[f.jsx("div",{style:{fontWeight:"600",fontSize:"13px",color:"#166534"},children:"2. Email ID Approved for Mailing"}),f.jsxs("div",{style:{fontSize:"12px",color:"#15803D"},children:["I confirm that ",f.jsx("strong",{children:ie.emailId||"the specified email"})," should be used for mailing."]})]})]}),f.jsxs("label",{style:{display:"flex",alignItems:"flex-start",gap:"10px",cursor:"pointer"},children:[f.jsx("input",{type:"checkbox",checked:He.invoiceTypeApproved,onChange:g=>Fe(C=>({...C,invoiceTypeApproved:g.target.checked})),style:{marginTop:"2px",width:"18px",height:"18px",accentColor:"#059669"}}),f.jsxs("div",{children:[f.jsx("div",{style:{fontWeight:"600",fontSize:"13px",color:"#166534"},children:"3. Invoice Type Confirmed"}),f.jsx("div",{style:{fontSize:"12px",color:"#15803D"},children:ie.invoiceType==="Combined"?`I confirm that a Combined Invoice is required for these ${qi(ie).length} campaigns.`:"I confirm that an Individual Invoice is required (not combined with others)."})]})]})]}):f.jsxs("div",{style:{backgroundColor:ie.invoiceStatus==="Approved"?"#DCFCE7":ie.invoiceStatus==="Need Edits"?"#FEF3C7":"#F8FAFC",padding:"16px",borderRadius:"10px",marginBottom:"16px",border:"1px solid "+(ie.invoiceStatus==="Approved"?"#86EFAC":ie.invoiceStatus==="Need Edits"?"#FCD34D":"#E2E8F0")},children:[f.jsx("div",{style:{fontWeight:"600",color:ie.invoiceStatus==="Approved"?"#166534":ie.invoiceStatus==="Need Edits"?"#92400E":"#64748B",fontSize:"14px"},children:ie.invoiceStatus==="Approved"?" Approved by Director":ie.invoiceStatus==="Need Edits"?" Edits Required by Director":" Pending Director Approval"}),f.jsx("div",{style:{fontSize:"13px",color:ie.invoiceStatus==="Approved"?"#15803D":ie.invoiceStatus==="Need Edits"?"#A16207":"#64748B",marginTop:"6px"},children:ie.invoiceStatus==="Approved"?"This invoice has been approved and is ready for mailing.":ie.invoiceStatus==="Need Edits"?"Please make the required changes and resubmit for approval.":"This invoice is awaiting Director approval."})]}),Kr&&f.jsxs("div",{style:{marginBottom:"16px"},children:[f.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:" Remarks (optional for Approve, visible to Finance)"}),f.jsx("textarea",{value:ki,onChange:g=>Gi(g.target.value),placeholder:"Enter remarks or comments...",style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"13px",minHeight:"80px",resize:"vertical",boxSizing:"border-box"}})]}),f.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[f.jsx(Ye,{label:"Close",onClick:()=>{Ot(!1),Gi(""),Fe({particularsApproved:!1,emailApproved:!1,invoiceTypeApproved:!1})}}),Kr&&f.jsxs(f.Fragment,{children:[f.jsx(Ye,{label:"Need Edits",variant:"danger",icon:jB,onClick:$0}),f.jsx(Ye,{label:"Approve",variant:"success",icon:zB,onClick:Su})]})]})]})}),f.jsx(En,{isOpen:vr,onClose:()=>rr(!1),title:" Delete Invoice",width:"450px",children:ie&&f.jsxs("div",{children:[f.jsxs("div",{style:{backgroundColor:"#FEE2E2",padding:"16px",borderRadius:"10px",marginBottom:"16px",border:"1px solid #FCA5A5"},children:[f.jsx("div",{style:{fontWeight:"700",color:"#991B1B",fontSize:"15px",marginBottom:"8px"},children:" Are you sure?"}),f.jsxs("div",{style:{fontSize:"14px",color:"#7F1D1D",lineHeight:"1.5"},children:["This will delete invoice ",f.jsx("strong",{children:ie.invoiceNo})," and reset the campaign(s) to allow re-generation.",ie.invoiceType==="Combined"&&f.jsxs("div",{style:{marginTop:"8px"},children:[f.jsxs("strong",{children:["All ",qi(ie).length," combined campaigns"]})," will be reset to Individual type for re-selection."]})]})]}),f.jsxs("div",{style:{backgroundColor:"#F8FAFC",padding:"12px",borderRadius:"8px",marginBottom:"16px"},children:[f.jsxs("div",{style:{fontSize:"13px"},children:[f.jsx("strong",{children:"Invoice:"})," ",ie.invoiceNo]}),f.jsxs("div",{style:{fontSize:"13px"},children:[f.jsx("strong",{children:"Party:"})," ",ie.partyName]}),f.jsxs("div",{style:{fontSize:"13px"},children:[f.jsx("strong",{children:"Amount:"})," ",ut(ie.invoiceTotalAmount)]})]}),f.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[f.jsx(Ye,{label:"Cancel",onClick:()=>rr(!1)}),f.jsx(Ye,{label:"Delete Invoice",variant:"danger",icon:Ws,onClick:X0})]})]})}),f.jsx(En,{isOpen:ui,onClose:()=>Fr(!1),title:" Add Email Address",width:"400px",children:ie&&f.jsxs("div",{children:[f.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"12px",borderRadius:"8px",marginBottom:"16px"},children:[f.jsxs("div",{style:{fontSize:"13px"},children:[f.jsx("strong",{children:"Campaign:"})," ",ie.senderName]}),f.jsxs("div",{style:{fontSize:"13px",marginTop:"4px"},children:[f.jsx("strong",{children:"Current:"})," ",ie.emailId||"None"]})]}),f.jsx(mr,{label:"Additional Email Address",type:"email",value:Ps,onChange:g=>la(g.target.value),placeholder:"email@example.com",small:!0}),f.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"16px"},children:[f.jsx(Ye,{label:"Cancel",onClick:()=>Fr(!1)}),f.jsx(Ye,{label:"Add Email",variant:"brand",icon:L2,onClick:()=>{Ps&&Ps.includes("@")?(W0(ie.id,Ps),Fr(!1),la("")):alert("Please enter a valid email address")}})]})]})}),f.jsx(En,{isOpen:A,onClose:()=>{_(!1),W({currentPassword:"",newPassword:"",confirmPassword:""}),w("")},title:" Change Password",width:"400px",children:f.jsxs("div",{children:[f.jsx("div",{style:{backgroundColor:"#EFF6FF",padding:"12px",borderRadius:"8px",marginBottom:"16px"},children:f.jsxs("div",{style:{fontSize:"13px"},children:[f.jsx("strong",{children:"User:"})," ",r==="director"?"Director":"Finance Team"]})}),f.jsxs("div",{style:{marginBottom:"16px"},children:[f.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Current Password"}),f.jsx("input",{type:"password",value:P.currentPassword,onChange:g=>W(C=>({...C,currentPassword:g.target.value})),placeholder:"Enter current password",style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"14px",boxSizing:"border-box"}})]}),f.jsxs("div",{style:{marginBottom:"16px"},children:[f.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"New Password"}),f.jsx("input",{type:"password",value:P.newPassword,onChange:g=>W(C=>({...C,newPassword:g.target.value})),placeholder:"Enter new password (min 6 characters)",style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"14px",boxSizing:"border-box"}})]}),f.jsxs("div",{style:{marginBottom:"16px"},children:[f.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Confirm New Password"}),f.jsx("input",{type:"password",value:P.confirmPassword,onChange:g=>W(C=>({...C,confirmPassword:g.target.value})),placeholder:"Confirm new password",onKeyPress:g=>g.key==="Enter"&&bi(),style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"14px",boxSizing:"border-box"}})]}),B&&f.jsx("div",{style:{marginBottom:"16px",padding:"10px",backgroundColor:"#FEE2E2",borderRadius:"8px",color:"#991B1B",fontSize:"13px"},children:B}),f.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:[f.jsx(Ye,{label:"Cancel",onClick:()=>{_(!1),W({currentPassword:"",newPassword:"",confirmPassword:""}),w("")}}),f.jsx(Ye,{label:"Change Password",variant:"brand",icon:Rd,onClick:bi})]})]})}),f.jsx(En,{isOpen:A,onClose:()=>{_(!1),w(""),W({currentPassword:"",newPassword:"",confirmPassword:""})},title:" Change Password",width:"400px",children:f.jsxs("div",{children:[f.jsx("div",{style:{backgroundColor:"#EFF6FF",padding:"12px",borderRadius:"8px",marginBottom:"16px"},children:f.jsxs("div",{style:{fontSize:"13px",color:"#1E40AF"},children:["Changing password for: ",f.jsx("strong",{children:r==="director"?"Director":"Finance Team"})]})}),f.jsxs("div",{style:{marginBottom:"16px"},children:[f.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Current Password"}),f.jsx("input",{type:"password",value:P.currentPassword,onChange:g=>W(C=>({...C,currentPassword:g.target.value})),placeholder:"Enter current password",style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"14px",boxSizing:"border-box"}})]}),f.jsxs("div",{style:{marginBottom:"16px"},children:[f.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"New Password"}),f.jsx("input",{type:"password",value:P.newPassword,onChange:g=>W(C=>({...C,newPassword:g.target.value})),placeholder:"Enter new password (min 6 chars)",style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"14px",boxSizing:"border-box"}})]}),f.jsxs("div",{style:{marginBottom:"16px"},children:[f.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Confirm New Password"}),f.jsx("input",{type:"password",value:P.confirmPassword,onChange:g=>W(C=>({...C,confirmPassword:g.target.value})),placeholder:"Re-enter new password",style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"14px",boxSizing:"border-box"}})]}),B&&f.jsx("div",{style:{marginBottom:"16px",padding:"10px",backgroundColor:"#FEE2E2",borderRadius:"8px",color:"#991B1B",fontSize:"13px"},children:B}),f.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:[f.jsx(Ye,{label:"Cancel",onClick:()=>{_(!1),w(""),W({currentPassword:"",newPassword:"",confirmPassword:""})}}),f.jsx(Ye,{label:"Change Password",variant:"brand",icon:Rd,onClick:bi})]})]})}),f.jsx(En,{isOpen:ci,onClose:()=>{$i(!1),kt(new Set),st(null)},title:" Combine Invoices",width:"700px",children:ze&&f.jsxs("div",{children:[f.jsxs("div",{style:{backgroundColor:"#F3E8FF",padding:"14px 18px",borderRadius:"10px",marginBottom:"16px"},children:[f.jsxs("div",{style:{fontSize:"15px",fontWeight:"700",color:"#6B21A8"},children:["Party: ",ze]}),f.jsx("div",{style:{fontSize:"13px",color:"#7C3AED",marginTop:"4px"},children:"Select 2+ campaigns to combine into a single invoice"})]}),f.jsx("div",{style:{maxHeight:"350px",overflowY:"auto",border:"1px solid #E2E8F0",borderRadius:"10px"},children:f.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"13px"},children:[f.jsx("thead",{children:f.jsxs("tr",{style:{backgroundColor:"#F8FAFC",position:"sticky",top:0},children:[f.jsx("th",{style:{padding:"12px",textAlign:"center",width:"50px"},children:""}),f.jsx("th",{style:{padding:"12px",textAlign:"left"},children:"Sender"}),f.jsx("th",{style:{padding:"12px",textAlign:"left"},children:"Subject"}),f.jsx("th",{style:{padding:"12px",textAlign:"left"},children:"Date"}),f.jsx("th",{style:{padding:"12px",textAlign:"right"},children:"Amount"})]})}),f.jsx("tbody",{children:ql(ze).map(g=>{var C;return f.jsxs("tr",{style:{borderBottom:"1px solid #F1F5F9",backgroundColor:Et.has(g.id)?"#F3E8FF":"transparent",cursor:"pointer"},onClick:()=>O4(g.id),children:[f.jsx("td",{style:{padding:"12px",textAlign:"center"},children:f.jsx("input",{type:"checkbox",checked:Et.has(g.id),onChange:()=>{},style:{width:"18px",height:"18px",cursor:"pointer"}})}),f.jsx("td",{style:{padding:"12px",fontWeight:"600"},children:g.senderName}),f.jsxs("td",{style:{padding:"12px",color:"#64748B"},children:[(C=g.subject)==null?void 0:C.substring(0,35),"..."]}),f.jsx("td",{style:{padding:"12px"},children:gr(g.date)}),f.jsx("td",{style:{padding:"12px",textAlign:"right",fontWeight:"700"},children:ut(g.totalWithGst)})]},g.id)})})]})}),f.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px 18px",borderRadius:"10px",marginTop:"16px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[f.jsxs("div",{style:{fontSize:"14px",color:"#64748B"},children:["Selected: ",f.jsx("strong",{children:Et.size})," | Combine Code: ",f.jsxs("strong",{children:["C",Se]})]}),f.jsxs("div",{style:{fontSize:"18px",fontWeight:"700",color:"#2874A6"},children:["Total: ",ut(me.filter(g=>Et.has(g.id)).reduce((g,C)=>g+(parseFloat(C.totalWithGst)||0),0))]})]}),f.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"16px"},children:[f.jsx(Ye,{label:"Cancel",onClick:()=>{$i(!1),kt(new Set)}}),f.jsx(Ye,{label:"Create Combined Invoice",variant:"purple",icon:Vu,disabled:Et.size<2,onClick:P4})]})]})}),f.jsxs(En,{isOpen:jt,onClose:()=>{mt(!1),Ii(null),Ga(!1)},title:xn?" Replace Mailer":" Upload Mailer",width:"550px",children:[f.jsx("input",{type:"file",ref:yu,accept:"image/*",style:{display:"none"},onChange:L4}),ie&&f.jsxs("div",{children:[f.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px",borderRadius:"10px",marginBottom:"14px"},children:[f.jsxs("div",{style:{fontSize:"14px"},children:[f.jsx("strong",{children:"Sender:"})," ",ie.senderName]}),f.jsxs("div",{style:{fontSize:"14px",marginTop:"4px"},children:[f.jsx("strong",{children:"Subject:"})," ",ie.subject]})]}),xn&&wt[ie.id]&&f.jsx("div",{style:{backgroundColor:"#FEF3C7",padding:"12px",borderRadius:"10px",marginBottom:"14px",border:"1px solid #FCD34D"},children:f.jsxs("div",{style:{fontWeight:"600",color:"#92400E",fontSize:"13px"},children:[" This will replace ",wt[ie.id].length," existing image(s)"]})}),f.jsxs("div",{style:{backgroundColor:"#FEF3C7",padding:"14px",borderRadius:"10px",marginBottom:"14px",border:"1px solid #FCD34D"},children:[f.jsx("div",{style:{fontWeight:"700",color:"#92400E",marginBottom:"8px",fontSize:"14px"},children:"Step 1: Find Mailer in Gmail"}),f.jsxs("button",{onClick:()=>j4(ie.subject),style:{display:"flex",alignItems:"center",gap:"8px",padding:"10px 18px",backgroundColor:"#EA4335",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"14px",fontWeight:"600"},children:[f.jsx(LB,{size:16})," Search in Gmail"]})]}),f.jsxs("div",{style:{backgroundColor:"#F0FDF4",padding:"14px",borderRadius:"10px",border:"1px solid #86EFAC"},children:[f.jsx("div",{style:{fontWeight:"700",color:"#166534",marginBottom:"8px",fontSize:"14px"},children:"Step 2: Paste Screenshot"}),f.jsx("div",{ref:O0,tabIndex:0,onPaste:B4,onClick:()=>{var g;return(g=O0.current)==null?void 0:g.focus()},style:{border:mn?"3px solid #22C55E":"3px dashed #22C55E",borderRadius:"10px",padding:mn?"8px":"30px",textAlign:"center",cursor:"pointer",backgroundColor:mn?"#FFFFFF":"#ECFDF5",minHeight:"100px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",outline:"none"},children:mn?f.jsxs(f.Fragment,{children:[f.jsx("img",{src:mn,alt:"Pasted",style:{maxWidth:"100%",maxHeight:"200px",borderRadius:"8px",marginBottom:"10px"}}),f.jsxs("div",{style:{display:"flex",gap:"8px"},children:[f.jsx(Ye,{icon:P2,label:"Save",variant:"success",onClick:()=>Zv(mn)}),f.jsx(Ye,{icon:Ws,label:"Clear",variant:"danger",onClick:()=>Ii(null)})]})]}):f.jsxs(f.Fragment,{children:[f.jsx(Bg,{size:36,color:"#22C55E",style:{marginBottom:"8px"}}),f.jsx("div",{style:{fontWeight:"700",fontSize:"14px",color:"#166534"},children:"Click here & Press Ctrl+V"})]})}),f.jsxs("div",{style:{textAlign:"center",marginTop:"12px"},children:[f.jsx("span",{style:{color:"#64748B",fontSize:"13px"},children:" OR "}),f.jsx("div",{style:{marginTop:"8px"},children:f.jsx(Ye,{icon:Hs,label:"Browse Files",onClick:()=>{var g;return(g=yu.current)==null?void 0:g.click()}})})]})]})]})]}),f.jsx(En,{isOpen:bt,onClose:()=>ht(!1),title:" Send Invoice Email",width:"600px",children:ie&&f.jsxs("div",{children:[f.jsxs("div",{style:{display:"flex",gap:"0",marginBottom:"16px",border:"2px solid #E2E8F0",borderRadius:"8px",overflow:"hidden"},children:[f.jsx("button",{onClick:()=>oa("reply"),style:{flex:1,padding:"12px",backgroundColor:aa==="reply"?"#2874A6":"#F8FAFC",color:aa==="reply"?"white":"#64748B",border:"none",cursor:"pointer",fontWeight:"700",fontSize:"14px"},children:" Reply to Thread"}),f.jsx("button",{onClick:()=>oa("new"),style:{flex:1,padding:"12px",backgroundColor:aa==="new"?"#2874A6":"#F8FAFC",color:aa==="new"?"white":"#64748B",border:"none",cursor:"pointer",fontWeight:"700",fontSize:"14px"},children:" New Email"})]}),f.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px",borderRadius:"10px",marginBottom:"16px"},children:[f.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[f.jsx("strong",{children:"Invoice:"})," ",ie.invoiceNo]}),f.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[f.jsx("strong",{children:"Amount:"})," ",ut(ie.invoiceTotalAmount||ie.totalWithGst)]}),ie.invoiceType==="Combined"&&f.jsxs("div",{style:{fontSize:"13px",marginTop:"8px",color:"#7C3AED"},children:[f.jsx("strong",{children:"Campaigns:"})," ",qi(ie).map(g=>g.senderName).join(", ")]}),f.jsx("div",{style:{fontSize:"14px",marginTop:"8px"},children:f.jsx("strong",{children:"Recipients:"})}),f.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"6px",marginTop:"6px"},children:[ys(ie).map((g,C)=>f.jsx("span",{style:{padding:"4px 10px",backgroundColor:"#DBEAFE",borderRadius:"6px",fontSize:"13px",color:"#1E40AF"},children:g},C)),ys(ie).length===0&&f.jsx("span",{style:{color:"#94A3B8"},children:"No email addresses"})]})]}),aa==="reply"?f.jsxs("div",{children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"8px"},children:[f.jsx("span",{style:{fontWeight:"700",fontSize:"14px"},children:"Email Body:"}),f.jsx("button",{onClick:()=>{navigator.clipboard.writeText(Z0(ie)),alert(" Copied!")},style:{padding:"6px 14px",backgroundColor:"#22C55E",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"13px",fontWeight:"600"},children:" Copy"})]}),f.jsx("div",{style:{fontSize:"13px",backgroundColor:"#F8FAFC",padding:"14px",borderRadius:"10px",whiteSpace:"pre-wrap",maxHeight:"200px",overflowY:"auto",fontFamily:"monospace",border:"1px solid #E2E8F0",lineHeight:"1.5"},children:Z0(ie)})]}):f.jsxs("div",{style:{display:"flex",gap:"10px"},children:[f.jsx("button",{onClick:()=>{const g=ys(ie),C=encodeURIComponent(g.join(",")),X=encodeURIComponent(ey(ie)),Z=encodeURIComponent(Z0(ie));window.open(`https://mail.google.com/mail/?view=cm&to=${C}&su=${X}&body=${Z}`,"_blank")},style:{padding:"12px 20px",backgroundColor:"#EA4335",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"14px",fontWeight:"700"},children:" Open Gmail"}),f.jsx("button",{onClick:()=>{const g=ys(ie),C=encodeURIComponent(g.join(";")),X=encodeURIComponent(ey(ie)),Z=encodeURIComponent(Z0(ie));window.open(`https://outlook.live.com/mail/0/deeplink/compose?to=${C}&subject=${X}&body=${Z}`,"_blank")},style:{padding:"12px 20px",backgroundColor:"#0078D4",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"14px",fontWeight:"700"},children:" Open Outlook"})]}),f.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"16px"},children:[f.jsx(Ye,{label:"View Invoice",icon:bd,onClick:()=>{ht(!1),ku(ie)}}),f.jsx(Ye,{label:"Close",onClick:()=>ht(!1)})]})]})}),f.jsx(En,{isOpen:We,onClose:()=>Jt(!1),title:" Record Payment",width:"500px",children:ie&&f.jsxs("div",{children:[f.jsxs("div",{style:{backgroundColor:"#F0FDF4",padding:"14px",borderRadius:"10px",marginBottom:"16px"},children:[f.jsxs("div",{style:{fontSize:"14px"},children:[f.jsx("strong",{children:"Invoice:"})," ",ie.invoiceNo]}),f.jsxs("div",{style:{fontSize:"14px",marginTop:"4px"},children:[f.jsx("strong",{children:"Party:"})," ",ie.partyName]})]}),f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[f.jsx(mr,{label:"Payment Amount",type:"number",value:Yt.amount,onChange:g=>Yi({...Yt,amount:g.target.value}),small:!0}),f.jsx(mr,{label:"Date",type:"date",value:Yt.date,onChange:g=>Yi({...Yt,date:g.target.value}),small:!0})]}),f.jsx(jd,{label:"Payment Mode",value:Yt.mode,onChange:g=>Yi({...Yt,mode:g.target.value}),options:[{value:"Bank",label:"Bank Transfer"},{value:"UPI",label:"UPI"},{value:"Cheque",label:"Cheque"},{value:"Cash",label:"Cash"}],small:!0}),f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[f.jsx(mr,{label:"TDS Deducted",type:"number",value:Yt.tds,onChange:g=>Yi({...Yt,tds:g.target.value}),placeholder:"0",small:!0}),f.jsx(mr,{label:"Discount",type:"number",value:Yt.discount,onChange:g=>Yi({...Yt,discount:g.target.value}),placeholder:"0",small:!0})]}),f.jsx(mr,{label:"Narration",value:Yt.narration,onChange:g=>Yi({...Yt,narration:g.target.value}),placeholder:"Reference",small:!0}),f.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"16px"},children:[f.jsx(Ye,{label:"Cancel",onClick:()=>Jt(!1)}),f.jsx(Ye,{label:"Record Payment",variant:"success",icon:MB,onClick:H4})]})]})}),f.jsxs(En,{isOpen:hn,onClose:()=>$r(!1),title:" Set Opening Balance",width:"450px",children:[f.jsx(jd,{label:"Select Party",value:di.partyName,onChange:g=>$l({...di,partyName:g.target.value}),options:[{value:"",label:"Choose a party..."},...Qa.map(g=>({value:g,label:g}))],small:!0}),f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr",gap:"12px"},children:[f.jsx(mr,{label:"Amount",type:"number",value:di.amount,onChange:g=>$l({...di,amount:g.target.value}),small:!0}),f.jsx(jd,{label:"Type",value:di.type,onChange:g=>$l({...di,type:g.target.value}),options:[{value:"Dr",label:"Debit"},{value:"Cr",label:"Credit"}],small:!0})]}),f.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"16px"},children:[f.jsx(Ye,{label:"Cancel",onClick:()=>$r(!1)}),f.jsx(Ye,{label:"Save",variant:"brand",onClick:()=>{di.partyName&&di.amount&&(Go(g=>({...g,[di.partyName]:di.type==="Dr"?parseFloat(di.amount):-parseFloat(di.amount)})),$r(!1),$l({partyName:"",amount:"",type:"Dr"}))}})]})]}),f.jsxs(En,{isOpen:gs,onClose:()=>ua(!1),title:" Import Historical Ledger",width:"600px",children:[f.jsx("input",{type:"file",ref:Eu,accept:".xlsx,.xls,.csv",style:{display:"none"},onChange:Xr}),f.jsxs("div",{style:{padding:"16px",backgroundColor:"#EFF6FF",borderRadius:"10px",marginBottom:"16px",border:"1px solid #BFDBFE"},children:[f.jsx("div",{style:{fontWeight:"700",color:"#1E40AF",marginBottom:"8px",fontSize:"14px"},children:" How to Import Historical Ledger"}),f.jsxs("div",{style:{fontSize:"12px",color:"#1E3A8A",lineHeight:"1.6"},children:[f.jsx("p",{style:{margin:"0 0 8px 0"},children:"Upload your existing ledger data in the format shown in the template. This will import all historical transactions."}),f.jsxs("p",{style:{margin:0},children:[f.jsx("strong",{children:"Supported columns:"})," Date, Particular, Vch Type, Vch No., Debit, Credit, Date of Receipt, Amount Received, TDS Received, Balance, Payment Status"]})]})]}),H&&f.jsxs("div",{style:{padding:"12px",backgroundColor:"#DCFCE7",borderRadius:"8px",marginBottom:"16px",border:"1px solid #86EFAC"},children:[f.jsxs("div",{style:{fontSize:"13px",color:"#166534"},children:[f.jsx("strong",{children:" Selected Party:"})," ",H]}),f.jsx("div",{style:{fontSize:"11px",color:"#15803D",marginTop:"4px"},children:"All entries from the uploaded file will be imported for this party"})]}),!H&&f.jsxs("div",{style:{padding:"12px",backgroundColor:"#FEE2E2",borderRadius:"8px",marginBottom:"16px",border:"1px solid #FCA5A5"},children:[f.jsx("div",{style:{fontSize:"13px",color:"#991B1B"},children:f.jsx("strong",{children:" No Party Selected"})}),f.jsx("div",{style:{fontSize:"12px",color:"#B91C1C",marginTop:"4px"},children:'Please close this modal and select a party from the Parties list on the left, then click "Import Historical" again.'})]}),f.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center",marginBottom:"16px"},children:[f.jsx(Ye,{icon:Bu,label:"Download Template",variant:"brand",onClick:Ft}),H?f.jsx(Ye,{icon:Hs,label:"Upload Ledger",variant:"success",onClick:()=>{var g;return(g=Eu.current)==null?void 0:g.click()}}):f.jsxs("button",{disabled:!0,style:{padding:"8px 16px",fontSize:"13px",fontWeight:"600",border:"none",borderRadius:"8px",backgroundColor:"#E2E8F0",color:"#94A3B8",cursor:"not-allowed",display:"flex",alignItems:"center",gap:"6px"},children:[f.jsx(Hs,{size:16})," Upload Ledger"]})]}),f.jsxs("div",{style:{padding:"14px",backgroundColor:"#F8FAFC",borderRadius:"8px",border:"1px solid #E2E8F0"},children:[f.jsx("div",{style:{fontWeight:"600",color:"#475569",marginBottom:"8px",fontSize:"13px"},children:" Expected Format (matches your ledger export):"}),f.jsx("div",{style:{overflowX:"auto"},children:f.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"10px"},children:[f.jsx("thead",{children:f.jsxs("tr",{style:{backgroundColor:"#E2E8F0"},children:[f.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"left"},children:"Date"}),f.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"left"},children:"Particular"}),f.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"left"},children:"Vch Type"}),f.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"left"},children:"Vch No."}),f.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"right"},children:"Debit"}),f.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"right"},children:"Credit"}),f.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"right"},children:"Amt Recd"}),f.jsx("th",{style:{padding:"6px",border:"1px solid #CBD5E1",textAlign:"left"},children:"Status"})]})}),f.jsx("tbody",{children:f.jsxs("tr",{children:[f.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0"},children:"02-Jun-21"}),f.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0"},children:"DB Corp Ltd"}),f.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0"},children:"Sales"}),f.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0"},children:"MB/2020-21/0411"}),f.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0",textAlign:"right"},children:"6,000"}),f.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0"}}),f.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0",textAlign:"right"},children:"44,371"}),f.jsx("td",{style:{padding:"4px 6px",border:"1px solid #E2E8F0"},children:"Received"})]})})]})})]}),f.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"16px"},children:f.jsx(Ye,{label:"Close",onClick:()=>ua(!1)})})]}),f.jsx(En,{isOpen:qn,onClose:()=>{ct(!1),oe({amount:"",tds:"",discount:"",narration:"",paymentAdvisory:null,date:new Date().toISOString().split("T")[0],mode:"Bank"})},title:" Create Receipt",width:"550px",children:ie&&f.jsxs("div",{children:[f.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px",borderRadius:"10px",marginBottom:"16px"},children:[f.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[f.jsx("strong",{children:"Invoice:"})," ",ie.invoiceNo]}),f.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[f.jsx("strong",{children:"Party:"})," ",ie.partyName]}),f.jsxs("div",{style:{fontSize:"14px"},children:[f.jsx("strong",{children:"Invoice Amount:"})," ",ut(ie.invoiceTotalAmount)]})]}),f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",marginBottom:"12px"},children:[f.jsx(mr,{label:"Receipt Date",type:"date",value:ee.date,onChange:g=>oe({...ee,date:g.target.value}),small:!0}),f.jsx(jd,{label:"Payment Mode",value:ee.mode,onChange:g=>oe({...ee,mode:g.target.value}),options:[{value:"Bank",label:"Bank Transfer"},{value:"Cash",label:"Cash"},{value:"Cheque",label:"Cheque"},{value:"UPI",label:"UPI"}],small:!0})]}),f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"12px",marginBottom:"12px"},children:[f.jsx(mr,{label:"Amount Received",type:"number",value:ee.amount,onChange:g=>oe({...ee,amount:g.target.value}),placeholder:"0.00",small:!0}),f.jsx(mr,{label:"TDS Deducted",type:"number",value:ee.tds,onChange:g=>oe({...ee,tds:g.target.value}),placeholder:"0.00",small:!0}),f.jsx(mr,{label:"Discount",type:"number",value:ee.discount,onChange:g=>oe({...ee,discount:g.target.value}),placeholder:"0.00",small:!0})]}),f.jsx("div",{style:{backgroundColor:"#F0FDF4",padding:"12px",borderRadius:"8px",marginBottom:"16px"},children:f.jsxs("div",{style:{fontSize:"14px",fontWeight:"700",color:"#166534"},children:["Total Credit: ",ut((parseFloat(ee.amount)||0)+(parseFloat(ee.tds)||0)+(parseFloat(ee.discount)||0))]})}),f.jsx(mr,{label:"Narration",value:ee.narration,onChange:g=>oe({...ee,narration:g.target.value}),placeholder:"Payment reference, remarks...",small:!0}),f.jsxs("div",{style:{marginBottom:"16px"},children:[f.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Payment Advisory (Optional)"}),f.jsx("input",{type:"file",ref:M0,accept:"image/*,.pdf",onChange:K0,style:{display:"none"}}),ee.paymentAdvisory?f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[f.jsx("div",{style:{flex:1,padding:"10px",backgroundColor:"#F0FDF4",borderRadius:"8px",fontSize:"13px",color:"#166534"},children:" Payment advisory attached"}),f.jsx("button",{onClick:()=>oe(g=>({...g,paymentAdvisory:null})),style:{padding:"8px",border:"none",backgroundColor:"#FEE2E2",borderRadius:"6px",cursor:"pointer",color:"#991B1B"},children:f.jsx(rl,{size:16})})]}):f.jsxs("button",{onClick:()=>{var g;return(g=M0.current)==null?void 0:g.click()},style:{padding:"10px 16px",border:"1.5px dashed #D1D5DB",borderRadius:"8px",backgroundColor:"#F9FAFB",cursor:"pointer",fontSize:"13px",color:"#6B7280",display:"flex",alignItems:"center",gap:"8px"},children:[f.jsx(Hs,{size:16})," Attach Payment Advisory"]})]}),f.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[f.jsx(Ye,{label:"Cancel",onClick:()=>ct(!1)}),f.jsx(Ye,{label:"Create Receipt",variant:"success",icon:Vu,onClick:G0})]})]})}),f.jsx(En,{isOpen:nr,onClose:()=>{yr(!1),Oe({amount:"",gst:"",reason:"",date:new Date().toISOString().split("T")[0]})},title:" Create Credit Note",width:"500px",children:ie&&(()=>{var fe;const g=(fe=ie.statePartyDetails)==null?void 0:fe.toUpperCase().includes("MAHARASHTRA"),C=g?"CGST + SGST (9% + 9%)":"IGST (18%)",X=parseFloat(ve.amount)||0,Z=parseFloat(ve.gst)||0,J=X+Z;return f.jsxs("div",{children:[f.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px",borderRadius:"10px",marginBottom:"16px"},children:[f.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[f.jsx("strong",{children:"Invoice:"})," ",ie.invoiceNo]}),f.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[f.jsx("strong",{children:"Party:"})," ",ie.partyName]}),f.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[f.jsx("strong",{children:"Invoice Amount:"})," ",ut(ie.invoiceTotalAmount)]}),f.jsxs("div",{style:{fontSize:"12px",color:"#2563EB"},children:[f.jsx("strong",{children:"GST Type:"})," ",g?"CGST + SGST (Intra-state)":"IGST (Inter-state)"]})]}),f.jsx("div",{style:{marginBottom:"12px"},children:f.jsx(mr,{label:"Credit Note Date",type:"date",value:ve.date,onChange:K=>Oe({...ve,date:K.target.value}),small:!0})}),f.jsxs("div",{style:{backgroundColor:"#FEF2F2",padding:"14px",borderRadius:"10px",marginBottom:"12px",border:"1px solid #FECACA"},children:[f.jsx("div",{style:{fontWeight:"700",color:"#991B1B",marginBottom:"10px",fontSize:"13px"},children:" Credit Note Breakdown"}),f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[f.jsx(mr,{label:"Base Amount",type:"number",value:ve.amount,onChange:K=>Oe({...ve,amount:K.target.value}),placeholder:"0.00",small:!0}),f.jsx(mr,{label:C,type:"number",value:ve.gst,onChange:K=>Oe({...ve,gst:K.target.value}),placeholder:"0.00",small:!0})]}),f.jsxs("div",{style:{marginTop:"10px",padding:"8px",backgroundColor:"#FEE2E2",borderRadius:"6px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[f.jsx("span",{style:{fontSize:"13px",fontWeight:"600",color:"#991B1B"},children:"Total Credit:"}),f.jsx("span",{style:{fontSize:"15px",fontWeight:"700",color:"#991B1B"},children:ut(J)})]})]}),f.jsxs("div",{style:{marginBottom:"16px"},children:[f.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Reason for Credit Note *"}),f.jsx("textarea",{value:ve.reason,onChange:K=>Oe({...ve,reason:K.target.value}),placeholder:"Enter reason for issuing credit note...",style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"13px",minHeight:"80px",resize:"vertical",boxSizing:"border-box"}})]}),f.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[f.jsx(Ye,{label:"Cancel",onClick:()=>yr(!1)}),f.jsx(Ye,{label:"Create Credit Note",variant:"danger",icon:ju,onClick:ha})]})]})})()}),f.jsx(En,{isOpen:U,onClose:()=>{L(!1),z(null)},title:" Add Followup",width:"500px",children:M&&f.jsxs("div",{children:[f.jsxs("div",{style:{backgroundColor:"#EFF6FF",padding:"14px",borderRadius:"10px",marginBottom:"16px"},children:[f.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[f.jsx("strong",{children:"Invoice:"})," ",M.invoiceNo]}),f.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[f.jsx("strong",{children:"Party:"})," ",M.partyName]}),f.jsxs("div",{style:{fontSize:"14px",marginBottom:"4px"},children:[f.jsx("strong",{children:"Amount:"})," ",ut(M.invoiceTotalAmount||M.totalAmount)]}),f.jsxs("div",{style:{fontSize:"14px"},children:[f.jsx("strong",{children:"Invoice Date:"})," ",gr(M.invoiceDate||M.date)]})]}),f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",marginBottom:"12px"},children:[f.jsx(mr,{label:"Followup Date",type:"date",value:V.date,onChange:g=>ae({...V,date:g.target.value}),small:!0}),f.jsx(mr,{label:"Next Followup Date",type:"date",value:V.nextFollowupDate,onChange:g=>ae({...V,nextFollowupDate:g.target.value}),small:!0})]}),f.jsxs("div",{style:{marginBottom:"16px"},children:[f.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Followup Notes *"}),f.jsx("textarea",{value:V.notes,onChange:g=>ae({...V,notes:g.target.value}),placeholder:"Enter followup notes (e.g., Spoke with accounts team, payment promised by next week)",style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"13px",minHeight:"80px",resize:"vertical",boxSizing:"border-box"}})]}),f.jsxs("div",{style:{marginBottom:"16px"},children:[f.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#374151",marginBottom:"6px"},children:"Status"}),f.jsxs("select",{value:V.status,onChange:g=>ae({...V,status:g.target.value}),style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1.5px solid #D1D5DB",fontSize:"13px"},children:[f.jsx("option",{value:"Pending",children:"Pending"}),f.jsx("option",{value:"Promised",children:"Promised - Payment Expected"}),f.jsx("option",{value:"Disputed",children:"Disputed"}),f.jsx("option",{value:"No Response",children:"No Response"})]})]}),f.jsxs("div",{style:{backgroundColor:"#F0FDF4",padding:"12px",borderRadius:"8px",marginBottom:"16px",border:"1px solid #86EFAC"},children:[f.jsx("div",{style:{fontSize:"12px",fontWeight:"600",color:"#166534",marginBottom:"8px"},children:" Quick Actions"}),f.jsxs("div",{style:{display:"flex",gap:"8px"},children:[f.jsx(Ye,{icon:Bg,label:"Copy Email Template",small:!0,variant:"brand",onClick:()=>k(M)}),f.jsx(Ye,{icon:Vg,label:"Search in Gmail",small:!0,variant:"success",onClick:()=>O(M)})]})]}),f.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[f.jsx(Ye,{label:"Cancel",onClick:()=>L(!1)}),f.jsx(Ye,{label:"Save Followup",variant:"primary",icon:Ug,onClick:Ja})]})]})}),f.jsx(En,{isOpen:dr,onClose:()=>Nn(!1),title:" Clear All Data",width:"500px",children:f.jsxs("div",{children:[f.jsxs("div",{style:{backgroundColor:"#FEE2E2",padding:"20px",borderRadius:"12px",marginBottom:"20px",border:"2px solid #FCA5A5"},children:[f.jsxs("div",{style:{fontWeight:"700",color:"#991B1B",fontSize:"18px",marginBottom:"12px",display:"flex",alignItems:"center",gap:"8px"},children:[f.jsx(b2,{size:24})," Warning: This action cannot be undone!"]}),f.jsxs("div",{style:{fontSize:"14px",color:"#7F1D1D",lineHeight:"1.6"},children:["This will permanently delete:",f.jsxs("ul",{style:{margin:"12px 0 0 20px",padding:0},children:[f.jsxs("li",{children:[f.jsx("strong",{children:me.length})," campaigns from Master Sheet"]}),f.jsxs("li",{children:[f.jsx("strong",{children:me.filter(g=>g.invoiceGenerated).length})," generated invoices"]}),f.jsxs("li",{children:[f.jsx("strong",{children:Q.length})," receipts"]}),f.jsxs("li",{children:[f.jsx("strong",{children:Le.length})," credit notes"]}),f.jsxs("li",{children:[f.jsx("strong",{children:Te.length})," ledger entries"]}),f.jsxs("li",{children:[f.jsx("strong",{children:Object.keys(wt).length})," mailer images"]}),f.jsx("li",{children:"All opening balances"})]})]})]}),f.jsx("div",{style:{backgroundColor:"#FEF3C7",padding:"14px",borderRadius:"8px",marginBottom:"20px",border:"1px solid #FCD34D"},children:f.jsxs("div",{style:{fontSize:"13px",color:"#92400E"},children:[f.jsx("strong",{children:"Note:"})," Invoice series numbers will be reset to 1. Your company settings and mailer logo will be preserved."]})}),f.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:[f.jsx(Ye,{label:"Cancel",onClick:()=>Nn(!1)}),f.jsx(Ye,{label:"Yes, Clear All Data",variant:"danger",icon:Ws,onClick:ec})]})]})}),f.jsx(En,{isOpen:ca,onClose:()=>Hl(!1),title:" Notifications",width:"550px",children:f.jsxs("div",{children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[f.jsx("div",{style:{fontSize:"14px",color:"#64748B"},children:pi>0?`${pi} unread`:"No unread notifications"}),f.jsxs("div",{style:{display:"flex",gap:"8px"},children:[pi>0&&f.jsx("button",{onClick:j0,style:{padding:"6px 12px",fontSize:"12px",fontWeight:"600",border:"1px solid #E2E8F0",borderRadius:"6px",backgroundColor:"#F8FAFC",color:"#475569",cursor:"pointer"},children:"Mark all as read"}),Ci.length>0&&er&&f.jsx("button",{onClick:V0,style:{padding:"6px 12px",fontSize:"12px",fontWeight:"600",border:"1px solid #FCA5A5",borderRadius:"6px",backgroundColor:"#FEE2E2",color:"#991B1B",cursor:"pointer"},children:"Clear all"})]})]}),f.jsx("div",{style:{maxHeight:"400px",overflowY:"auto"},children:Yo.length===0?f.jsxs("div",{style:{padding:"40px",textAlign:"center",color:"#94A3B8"},children:[f.jsx(N2,{size:40,style:{marginBottom:"12px",opacity:.5}}),f.jsx("div",{style:{fontSize:"16px",fontWeight:"600"},children:"No notifications"}),f.jsx("div",{style:{fontSize:"13px",marginTop:"4px"},children:"You're all caught up!"})]}):Yo.map(g=>{const C=!(g.read&&g.read[r]),X=J=>{switch(J){case"upload":return"";case"invoice":return"";case"approval":return"";case"edit":return"";case"receipt":return"";default:return""}},Z=J=>{switch(J){case"upload":return"#EFF6FF";case"invoice":return"#FEF3C7";case"approval":return"#DCFCE7";case"edit":return"#FEE2E2";case"receipt":return"#F0FDF4";default:return"#F8FAFC"}};return f.jsx("div",{onClick:()=>Xp(g.id),style:{padding:"14px",borderRadius:"10px",marginBottom:"8px",backgroundColor:C?Z(g.type):"#F8FAFC",border:C?"2px solid #2874A6":"1px solid #E2E8F0",cursor:"pointer",transition:"all 0.2s ease"},children:f.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"12px"},children:[f.jsx("div",{style:{fontSize:"20px"},children:X(g.type)}),f.jsxs("div",{style:{flex:1},children:[f.jsx("div",{style:{fontSize:"14px",fontWeight:C?"600":"500",color:"#1E293B",lineHeight:"1.4"},children:g.message}),f.jsxs("div",{style:{display:"flex",gap:"12px",marginTop:"8px",fontSize:"11px",color:"#64748B"},children:[f.jsxs("span",{children:["By: ",g.createdBy==="finance"?"Finance Team":"Director"]}),f.jsx("span",{children:""}),f.jsx("span",{children:new Date(g.createdAt).toLocaleString()})]})]}),C&&f.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:"#DC2626",flexShrink:0}})]})},g.id)})})]})})]}),eF=()=>{switch(N){case"master":return ay();case"invoices":return K4();case"ledgers":return Y4();case"followups":return Q4();case"reports":return cy();case"settings":return r==="finance"?J4():cy();default:return ay()}},tF=()=>f.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, #1E3A5F 0%, #2874A6 50%, #1E3A5F 100%)",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',padding:"20px"},children:f.jsxs("div",{style:{backgroundColor:"#FFFFFF",padding:"0",borderRadius:"24px",boxShadow:"0 25px 50px -12px rgba(0,0,0,0.25)",width:"420px",maxWidth:"95vw",overflow:"hidden"},children:[f.jsxs("div",{style:{background:"linear-gradient(135deg, #1E3A5F 0%, #2874A6 100%)",padding:"32px 40px",textAlign:"center"},children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"12px",marginBottom:"8px"},children:[f.jsx("img",{src:"/logo.png",alt:"JAC",style:{width:"60px",height:"auto",borderRadius:"8px",backgroundColor:"white",padding:"4px"}}),f.jsx("span",{style:{fontSize:"36px",fontWeight:"800",color:"#FFFFFF",letterSpacing:"-1px"},children:"FinMate"})]}),f.jsx("p",{style:{margin:0,color:"rgba(255,255,255,0.8)",fontSize:"14px",fontWeight:"500"},children:"Finance Management System"})]}),f.jsxs("div",{style:{padding:"32px 40px"},children:[f.jsxs("div",{style:{marginBottom:"24px"},children:[f.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#1E3A5F",marginBottom:"8px",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Username"}),f.jsxs("div",{style:{position:"relative"},children:[f.jsx(V2,{size:18,style:{position:"absolute",left:"14px",top:"50%",transform:"translateY(-50%)",color:"#94A3B8"}}),f.jsx("input",{type:"text",value:i.username,onChange:g=>s(C=>({...C,username:g.target.value})),placeholder:"Enter username",style:{width:"100%",padding:"14px 14px 14px 44px",borderRadius:"12px",border:"2px solid #E2E8F0",fontSize:"15px",boxSizing:"border-box",transition:"border-color 0.2s, box-shadow 0.2s",outline:"none"},onFocus:g=>{g.target.style.borderColor="#2874A6",g.target.style.boxShadow="0 0 0 3px rgba(40,116,166,0.1)"},onBlur:g=>{g.target.style.borderColor="#E2E8F0",g.target.style.boxShadow="none"}})]})]}),f.jsxs("div",{style:{marginBottom:"28px"},children:[f.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#1E3A5F",marginBottom:"8px",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Password"}),f.jsxs("div",{style:{position:"relative"},children:[f.jsx(Rd,{size:18,style:{position:"absolute",left:"14px",top:"50%",transform:"translateY(-50%)",color:"#94A3B8"}}),f.jsx("input",{type:"password",value:i.password,onChange:g=>s(C=>({...C,password:g.target.value})),placeholder:"Enter password",onKeyPress:g=>g.key==="Enter"&&wu(),style:{width:"100%",padding:"14px 14px 14px 44px",borderRadius:"12px",border:"2px solid #E2E8F0",fontSize:"15px",boxSizing:"border-box",transition:"border-color 0.2s, box-shadow 0.2s",outline:"none"},onFocus:g=>{g.target.style.borderColor="#2874A6",g.target.style.boxShadow="0 0 0 3px rgba(40,116,166,0.1)"},onBlur:g=>{g.target.style.borderColor="#E2E8F0",g.target.style.boxShadow="none"}})]})]}),a&&f.jsxs("div",{style:{marginBottom:"20px",padding:"14px",backgroundColor:"#FEF2F2",borderRadius:"12px",color:"#DC2626",fontSize:"14px",textAlign:"center",border:"1px solid #FECACA",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[f.jsx(b2,{size:18}),a]}),f.jsx("button",{onClick:wu,style:{width:"100%",padding:"16px",fontSize:"16px",fontWeight:"700",border:"none",borderRadius:"12px",cursor:E?"pointer":"wait",background:E?"linear-gradient(135deg, #1E3A5F 0%, #2874A6 100%)":"#94A3B8",color:"white",transition:"transform 0.2s, box-shadow 0.2s",boxShadow:E?"0 4px 14px rgba(40,116,166,0.4)":"none",opacity:E?1:.7},disabled:!E,onMouseOver:g=>{E&&(g.target.style.transform="translateY(-2px)",g.target.style.boxShadow="0 6px 20px rgba(40,116,166,0.5)")},onMouseOut:g=>{E&&(g.target.style.transform="translateY(0)",g.target.style.boxShadow="0 4px 14px rgba(40,116,166,0.4)")},children:E?"Sign In":"Loading..."}),f.jsxs("div",{style:{marginTop:"24px",textAlign:"center",color:"#94A3B8",fontSize:"12px"},children:[f.jsx("span",{children:"Powered by "}),f.jsx("span",{style:{fontWeight:"600",color:"#1E3A5F"},children:"JAC"}),f.jsx("span",{children:"  Strategy | Talent | Results"})]})]})]})});return t?l?f.jsxs("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, #1E3A5F 0%, #2874A6 50%, #1E3A5F 100%)",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:[f.jsxs("div",{style:{textAlign:"center"},children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"12px",marginBottom:"24px"},children:[f.jsx("img",{src:"/logo.png",alt:"JAC",style:{width:"50px",height:"auto",borderRadius:"8px",backgroundColor:"white",padding:"4px"}}),f.jsx("span",{style:{fontSize:"32px",fontWeight:"800",color:"#FFFFFF",letterSpacing:"-1px"},children:"FinMate"})]}),f.jsx(M2,{size:48,style:{animation:"spin 1s linear infinite",color:"#FFFFFF",marginBottom:"16px"}}),f.jsx("div",{style:{fontSize:"18px",fontWeight:"600",color:"#FFFFFF"},children:"Loading your data..."}),f.jsx("div",{style:{fontSize:"14px",color:"rgba(255,255,255,0.7)",marginTop:"8px"},children:"Please wait while we sync with the cloud"})]}),f.jsx("style",{children:"@keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }"})]}):f.jsxs("div",{style:{display:"flex",height:"100vh",backgroundColor:"#F1F5F9",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:[$4(),f.jsx("main",{style:{flex:1,overflow:"auto",padding:"20px"},children:eF()}),Z4(),f.jsx("style",{children:"@keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }"})]}):tF()}tm.createRoot(document.getElementById("root")).render(f.jsx(zd.StrictMode,{children:f.jsx(NW,{})}));
